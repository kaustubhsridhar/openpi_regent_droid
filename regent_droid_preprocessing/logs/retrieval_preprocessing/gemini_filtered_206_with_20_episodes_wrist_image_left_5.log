2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3485794757_marker_into_cup [chosen_id count 0/196]
2025-03-13 14:35:02: [retrieval_preprocessing] we have num_total=6058 embedding_dim=49152
[retrieval_preprocessing] for episode 12817 [episode count 0/20], we have num_retrieval=np.int64(5779) num_query=np.int64(279)
2025-03-13 14:35:02,502 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:03,392 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:03
2025-03-13 14:35:03,392 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 661.88it/s]
2025-03-13 14:35:03,436 [INFO]: There are 5779 embeddings of dim 49152
2025-03-13 14:35:03,436 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0438 secs
2025-03-13 14:35:03,436 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:03,436 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:35:03,436 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:03,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:35:03,436 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,437 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:03,437 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:35:03,437 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:03
2025-03-13 14:35:03,437 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:03,437 [INFO]: 	Creating the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,437 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:03
2025-03-13 14:35:03,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:35:03,438 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,438 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:35:03,438 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.12it/s] 21%|██        | 5/24 [00:00<00:00, 21.13it/s] 38%|███▊      | 9/24 [00:00<00:00, 27.51it/s] 54%|█████▍    | 13/24 [00:00<00:00, 30.95it/s] 71%|███████   | 17/24 [00:00<00:00, 32.90it/s] 88%|████████▊ | 21/24 [00:06<00:01,  1.74it/s]100%|██████████| 24/24 [00:08<00:00,  1.69it/s]100%|██████████| 24/24 [00:08<00:00,  2.74it/s]
2025-03-13 14:35:12,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:12
2025-03-13 14:36:17,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.6138 secs
2025-03-13 14:36:17,814 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 14:36:17,814 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 14:36:37,794 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9806 secs
2025-03-13 14:36:37,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.3582 secs
2025-03-13 14:36:37,797 [INFO]: {
2025-03-13 14:36:37,797 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:37,797 [INFO]: 	index_param: efSearch=210
2025-03-13 14:36:37,797 [INFO]: 	index_path: knn.index
2025-03-13 14:36:37,797 [INFO]: 	size in bytes: 1136984230
2025-03-13 14:36:37,797 [INFO]: 	avg_search_speed_ms: 11.959351365550301
2025-03-13 14:36:37,797 [INFO]: 	99p_search_speed_ms: 16.166459419764568
2025-03-13 14:36:37,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:37,797 [INFO]: 	nb vectors: 5779
2025-03-13 14:36:37,797 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:37,797 [INFO]: 	compression ratio: 0.9993081715829955
2025-03-13 14:36:37,797 [INFO]: }
2025-03-13 14:36:37,797 [INFO]: 	>>> Finished "Creating the index" in 94.3601 secs
2025-03-13 14:36:37,797 [INFO]: >>> Finished "Launching the whole pipeline" in 94.4049 secs
2025-03-13 14:36:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 12817 [episode count 0/20]
[retrieval_preprocessing] for episode 13851 [episode count 1/20], we have num_retrieval=np.int64(5784) num_query=np.int64(274)
2025-03-13 14:36:42,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:43,210 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:43
2025-03-13 14:36:43,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.35it/s]
2025-03-13 14:36:43,239 [INFO]: There are 5784 embeddings of dim 49152
2025-03-13 14:36:43,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 14:36:43,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:43
2025-03-13 14:36:43,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:43,239 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:36:43,239 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:43,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:36:43,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:43
2025-03-13 14:36:43,240 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:43,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:43,240 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:43
2025-03-13 14:36:43,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:43,240 [INFO]: 	Creating the index 03/13/2025, 14:36:43
2025-03-13 14:36:43,240 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:43
2025-03-13 14:36:43,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:36:43,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:43
2025-03-13 14:36:43,242 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:36:43,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.81it/s] 21%|██        | 5/24 [00:00<00:00, 19.94it/s] 38%|███▊      | 9/24 [00:00<00:00, 26.22it/s] 54%|█████▍    | 13/24 [00:00<00:00, 29.63it/s] 71%|███████   | 17/24 [00:00<00:00, 31.37it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.31it/s]100%|██████████| 24/24 [00:06<00:00,  2.28it/s]100%|██████████| 24/24 [00:06<00:00,  3.62it/s]
2025-03-13 14:36:49,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:49
2025-03-13 14:37:48,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1749 secs
2025-03-13 14:37:48,045 [INFO]: The best hyperparameters are: efSearch=80
2025-03-13 14:37:48,045 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-13 14:38:12,016 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9715 secs
2025-03-13 14:38:12,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.8596 secs
2025-03-13 14:38:12,101 [INFO]: {
2025-03-13 14:38:12,102 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:12,102 [INFO]: 	index_param: efSearch=80
2025-03-13 14:38:12,102 [INFO]: 	index_path: knn.index
2025-03-13 14:38:12,102 [INFO]: 	size in bytes: 1137967930
2025-03-13 14:38:12,102 [INFO]: 	avg_search_speed_ms: 5.559678397942189
2025-03-13 14:38:12,102 [INFO]: 	99p_search_speed_ms: 8.817953416146338
2025-03-13 14:38:12,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:12,102 [INFO]: 	nb vectors: 5784
2025-03-13 14:38:12,102 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:12,102 [INFO]: 	compression ratio: 0.999308189642919
2025-03-13 14:38:12,102 [INFO]: }
2025-03-13 14:38:12,102 [INFO]: 	>>> Finished "Creating the index" in 88.8623 secs
2025-03-13 14:38:12,102 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8923 secs
2025-03-13 14:38:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 13851 [episode count 1/20]
[retrieval_preprocessing] for episode 18461 [episode count 2/20], we have num_retrieval=np.int64(5823) num_query=np.int64(235)
2025-03-13 14:38:14,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:15,142 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:15
2025-03-13 14:38:15,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1007.52it/s]
2025-03-13 14:38:15,168 [INFO]: There are 5823 embeddings of dim 49152
2025-03-13 14:38:15,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 14:38:15,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:15
2025-03-13 14:38:15,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:15,168 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:38:15,168 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:15,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:15,168 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:15
2025-03-13 14:38:15,168 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:15,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:15,168 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:15
2025-03-13 14:38:15,168 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:15,169 [INFO]: 	Creating the index 03/13/2025, 14:38:15
2025-03-13 14:38:15,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:15
2025-03-13 14:38:15,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:38:15,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:15
2025-03-13 14:38:15,170 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:38:15,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.22it/s] 21%|██        | 5/24 [00:00<00:00, 22.82it/s] 38%|███▊      | 9/24 [00:00<00:00, 29.65it/s] 54%|█████▍    | 13/24 [00:00<00:00, 32.94it/s] 71%|███████   | 17/24 [00:00<00:00, 33.82it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.13it/s]100%|██████████| 24/24 [00:07<00:00,  2.05it/s]100%|██████████| 24/24 [00:07<00:00,  3.31it/s]
2025-03-13 14:38:22,423 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:22
2025-03-13 14:39:25,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3620 secs
2025-03-13 14:39:25,786 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 14:39:25,786 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 14:39:51,872 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0854 secs
2025-03-13 14:39:51,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.7033 secs
2025-03-13 14:39:51,873 [INFO]: {
2025-03-13 14:39:51,873 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:51,873 [INFO]: 	index_param: efSearch=161
2025-03-13 14:39:51,873 [INFO]: 	index_path: knn.index
2025-03-13 14:39:51,873 [INFO]: 	size in bytes: 1145640910
2025-03-13 14:39:51,873 [INFO]: 	avg_search_speed_ms: 9.763032336422839
2025-03-13 14:39:51,873 [INFO]: 	99p_search_speed_ms: 15.585048659704626
2025-03-13 14:39:51,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:51,873 [INFO]: 	nb vectors: 5823
2025-03-13 14:39:51,873 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:51,873 [INFO]: 	compression ratio: 0.9993082247735026
2025-03-13 14:39:51,873 [INFO]: }
2025-03-13 14:39:51,873 [INFO]: 	>>> Finished "Creating the index" in 96.7048 secs
2025-03-13 14:39:51,873 [INFO]: >>> Finished "Launching the whole pipeline" in 96.7315 secs
2025-03-13 14:39:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 18461 [episode count 2/20]
[retrieval_preprocessing] for episode 36 [episode count 3/20], we have num_retrieval=np.int64(5706) num_query=np.int64(352)
2025-03-13 14:39:54,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:55,665 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:55
2025-03-13 14:39:55,665 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.24it/s]
2025-03-13 14:39:55,693 [INFO]: There are 5706 embeddings of dim 49152
2025-03-13 14:39:55,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 14:39:55,694 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:55,694 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 14:39:55,694 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:55,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:55,694 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,694 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:55,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:39:55,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:55
2025-03-13 14:39:55,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:55,694 [INFO]: 	Creating the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:55
2025-03-13 14:39:55,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:39:55,696 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,696 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:39:55,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.48it/s] 17%|█▋        | 4/24 [00:00<00:01, 16.15it/s] 33%|███▎      | 8/24 [00:00<00:00, 24.56it/s] 50%|█████     | 12/24 [00:00<00:00, 28.86it/s] 67%|██████▋   | 16/24 [00:00<00:00, 31.49it/s] 83%|████████▎ | 20/24 [00:00<00:00, 32.75it/s]100%|██████████| 24/24 [00:07<00:00,  1.56it/s]100%|██████████| 24/24 [00:07<00:00,  3.00it/s]
2025-03-13 14:40:03,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:03
2025-03-13 14:41:07,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3484 secs
2025-03-13 14:41:07,048 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 14:41:07,048 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.75it/s]
2025-03-13 14:41:43,907 [INFO]: 	>>> Finished "Compute fast metrics" in 36.8586 secs
2025-03-13 14:41:43,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.2123 secs
2025-03-13 14:41:43,908 [INFO]: {
2025-03-13 14:41:43,908 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:43,908 [INFO]: 	index_param: efSearch=182
2025-03-13 14:41:43,908 [INFO]: 	index_path: knn.index
2025-03-13 14:41:43,908 [INFO]: 	size in bytes: 1122621970
2025-03-13 14:41:43,908 [INFO]: 	avg_search_speed_ms: 9.579801220327287
2025-03-13 14:41:43,908 [INFO]: 	99p_search_speed_ms: 14.193843267858027
2025-03-13 14:41:43,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:43,908 [INFO]: 	nb vectors: 5706
2025-03-13 14:41:43,908 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:43,908 [INFO]: 	compression ratio: 0.9993081179410732
2025-03-13 14:41:43,908 [INFO]: }
2025-03-13 14:41:43,908 [INFO]: 	>>> Finished "Creating the index" in 108.2141 secs
2025-03-13 14:41:43,908 [INFO]: >>> Finished "Launching the whole pipeline" in 108.2431 secs
2025-03-13 14:41:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 36 [episode count 3/20]
[retrieval_preprocessing] for episode 60967 [episode count 4/20], we have num_retrieval=np.int64(5788) num_query=np.int64(270)
2025-03-13 14:41:47,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:48,327 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:48
2025-03-13 14:41:48,327 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.49it/s]
2025-03-13 14:41:48,354 [INFO]: There are 5788 embeddings of dim 49152
2025-03-13 14:41:48,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 14:41:48,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:48,355 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:41:48,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:48,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:48,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,355 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:48,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:48,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:48
2025-03-13 14:41:48,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:48,355 [INFO]: 	Creating the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:48
2025-03-13 14:41:48,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:41:48,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,357 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:41:48,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.14it/s] 25%|██▌       | 6/24 [00:00<00:00, 26.78it/s] 46%|████▌     | 11/24 [00:00<00:00, 34.80it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.05it/s] 88%|████████▊ | 21/24 [00:04<00:01,  2.98it/s]100%|██████████| 24/24 [00:07<00:00,  2.17it/s]100%|██████████| 24/24 [00:07<00:00,  3.38it/s]
2025-03-13 14:41:55,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:55
2025-03-13 14:42:45,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4513 secs
2025-03-13 14:42:45,925 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 14:42:45,925 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.28it/s]
2025-03-13 14:43:06,908 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9822 secs
2025-03-13 14:43:06,909 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5528 secs
2025-03-13 14:43:06,910 [INFO]: {
2025-03-13 14:43:06,910 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:06,910 [INFO]: 	index_param: efSearch=128
2025-03-13 14:43:06,910 [INFO]: 	index_path: knn.index
2025-03-13 14:43:06,910 [INFO]: 	size in bytes: 1138754890
2025-03-13 14:43:06,910 [INFO]: 	avg_search_speed_ms: 11.962171852016047
2025-03-13 14:43:06,910 [INFO]: 	99p_search_speed_ms: 19.60793960606679
2025-03-13 14:43:06,910 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:06,910 [INFO]: 	nb vectors: 5788
2025-03-13 14:43:06,910 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:06,910 [INFO]: 	compression ratio: 0.9993082040683926
2025-03-13 14:43:06,910 [INFO]: }
2025-03-13 14:43:06,910 [INFO]: 	>>> Finished "Creating the index" in 78.5546 secs
2025-03-13 14:43:06,910 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5830 secs
2025-03-13 14:43:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 60967 [episode count 4/20]
[retrieval_preprocessing] for episode 15930 [episode count 5/20], we have num_retrieval=np.int64(5690) num_query=np.int64(368)
2025-03-13 14:43:09,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:10,858 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:10
2025-03-13 14:43:10,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.82it/s]
2025-03-13 14:43:10,889 [INFO]: There are 5690 embeddings of dim 49152
2025-03-13 14:43:10,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 14:43:10,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:10
2025-03-13 14:43:10,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:10,890 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 14:43:10,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:10,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:43:10,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:10
2025-03-13 14:43:10,890 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:10,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:10,890 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:10
2025-03-13 14:43:10,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:10,891 [INFO]: 	Creating the index 03/13/2025, 14:43:10
2025-03-13 14:43:10,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:10
2025-03-13 14:43:10,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:43:10,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:10
2025-03-13 14:43:10,892 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:43:10,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.02it/s] 21%|██        | 5/24 [00:00<00:00, 21.07it/s] 38%|███▊      | 9/24 [00:00<00:00, 27.83it/s] 54%|█████▍    | 13/24 [00:00<00:00, 31.37it/s] 71%|███████   | 17/24 [00:00<00:00, 33.60it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.09it/s]100%|██████████| 24/24 [00:07<00:00,  1.93it/s]100%|██████████| 24/24 [00:07<00:00,  3.14it/s]
2025-03-13 14:43:18,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:18
2025-03-13 14:44:18,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6462 secs
2025-03-13 14:44:18,180 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 14:44:18,180 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 14:44:45,966 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7854 secs
2025-03-13 14:44:45,967 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0750 secs
2025-03-13 14:44:45,967 [INFO]: {
2025-03-13 14:44:45,967 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:45,967 [INFO]: 	index_param: efSearch=151
2025-03-13 14:44:45,967 [INFO]: 	index_path: knn.index
2025-03-13 14:44:45,967 [INFO]: 	size in bytes: 1119474070
2025-03-13 14:44:45,967 [INFO]: 	avg_search_speed_ms: 9.008526222713224
2025-03-13 14:44:45,967 [INFO]: 	99p_search_speed_ms: 12.8775792918168
2025-03-13 14:44:45,967 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:45,967 [INFO]: 	nb vectors: 5690
2025-03-13 14:44:45,967 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:45,967 [INFO]: 	compression ratio: 0.9993081126032691
2025-03-13 14:44:45,967 [INFO]: }
2025-03-13 14:44:45,967 [INFO]: 	>>> Finished "Creating the index" in 95.0768 secs
2025-03-13 14:44:45,967 [INFO]: >>> Finished "Launching the whole pipeline" in 95.1091 secs
2025-03-13 14:44:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 15930 [episode count 5/20]
[retrieval_preprocessing] for episode 43077 [episode count 6/20], we have num_retrieval=np.int64(5750) num_query=np.int64(308)
2025-03-13 14:44:49,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:50,589 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:50
2025-03-13 14:44:50,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 14:44:50,619 [INFO]: There are 5750 embeddings of dim 49152
2025-03-13 14:44:50,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 14:44:50,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:50,620 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:44:50,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:50,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:44:50,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,621 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:50,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:50,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:50
2025-03-13 14:44:50,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:50,622 [INFO]: 	Creating the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,622 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:50
2025-03-13 14:44:50,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:44:50,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,626 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:44:50,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 16.92it/s] 29%|██▉       | 7/24 [00:00<00:00, 32.69it/s] 50%|█████     | 12/24 [00:00<00:00, 37.99it/s] 71%|███████   | 17/24 [00:00<00:00, 40.35it/s] 92%|█████████▏| 22/24 [00:05<00:00,  2.75it/s]100%|██████████| 24/24 [00:06<00:00,  3.65it/s]
2025-03-13 14:44:57,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:57
2025-03-13 14:45:54,940 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7261 secs
2025-03-13 14:45:54,940 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 14:45:54,940 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.28it/s]
2025-03-13 14:46:25,120 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1791 secs
2025-03-13 14:46:25,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.4954 secs
2025-03-13 14:46:25,121 [INFO]: {
2025-03-13 14:46:25,121 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:25,121 [INFO]: 	index_param: efSearch=180
2025-03-13 14:46:25,121 [INFO]: 	index_path: knn.index
2025-03-13 14:46:25,121 [INFO]: 	size in bytes: 1131278650
2025-03-13 14:46:25,121 [INFO]: 	avg_search_speed_ms: 10.167014532877753
2025-03-13 14:46:25,121 [INFO]: 	99p_search_speed_ms: 14.020422019530082
2025-03-13 14:46:25,121 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:25,121 [INFO]: 	nb vectors: 5750
2025-03-13 14:46:25,121 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:25,121 [INFO]: 	compression ratio: 0.9993081722173401
2025-03-13 14:46:25,121 [INFO]: }
2025-03-13 14:46:25,121 [INFO]: 	>>> Finished "Creating the index" in 94.4996 secs
2025-03-13 14:46:25,121 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5326 secs
2025-03-13 14:46:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 43077 [episode count 6/20]
[retrieval_preprocessing] for episode 19014 [episode count 7/20], we have num_retrieval=np.int64(5816) num_query=np.int64(242)
2025-03-13 14:46:29,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:30,764 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:30
2025-03-13 14:46:30,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1729.61it/s]
2025-03-13 14:46:30,797 [INFO]: There are 5816 embeddings of dim 49152
2025-03-13 14:46:30,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 14:46:30,797 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,797 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:30,798 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:46:30,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:30,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:46:30,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,798 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:30,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:46:30,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:30
2025-03-13 14:46:30,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:30,799 [INFO]: 	Creating the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:30
2025-03-13 14:46:30,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 14:46:30,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,802 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:46:30,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  7.97it/s] 25%|██▌       | 6/24 [00:00<00:00, 27.07it/s] 46%|████▌     | 11/24 [00:00<00:00, 32.83it/s] 62%|██████▎   | 15/24 [00:00<00:00, 33.10it/s] 79%|███████▉  | 19/24 [00:00<00:00, 33.57it/s] 96%|█████████▌| 23/24 [00:08<00:00,  1.52it/s]100%|██████████| 24/24 [00:10<00:00,  2.38it/s]
2025-03-13 14:46:40,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:40
2025-03-13 14:47:43,117 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2035 secs
2025-03-13 14:47:43,117 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 14:47:43,117 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-13 14:48:12,787 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6695 secs
2025-03-13 14:48:12,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.9862 secs
2025-03-13 14:48:12,788 [INFO]: {
2025-03-13 14:48:12,788 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:12,788 [INFO]: 	index_param: efSearch=170
2025-03-13 14:48:12,788 [INFO]: 	index_path: knn.index
2025-03-13 14:48:12,788 [INFO]: 	size in bytes: 1144263730
2025-03-13 14:48:12,788 [INFO]: 	avg_search_speed_ms: 10.857353181083738
2025-03-13 14:48:12,788 [INFO]: 	99p_search_speed_ms: 15.82439453341066
2025-03-13 14:48:12,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:12,788 [INFO]: 	nb vectors: 5816
2025-03-13 14:48:12,788 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:12,788 [INFO]: 	compression ratio: 0.9993081996927404
2025-03-13 14:48:12,788 [INFO]: }
2025-03-13 14:48:12,788 [INFO]: 	>>> Finished "Creating the index" in 101.9895 secs
2025-03-13 14:48:12,788 [INFO]: >>> Finished "Launching the whole pipeline" in 102.0244 secs
2025-03-13 14:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 19014 [episode count 7/20]
[retrieval_preprocessing] for episode 54344 [episode count 8/20], we have num_retrieval=np.int64(5690) num_query=np.int64(368)
2025-03-13 14:48:15,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:17,255 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:17
2025-03-13 14:48:17,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.73it/s]
2025-03-13 14:48:17,286 [INFO]: There are 5690 embeddings of dim 49152
2025-03-13 14:48:17,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 14:48:17,287 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:17
2025-03-13 14:48:17,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:17,288 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 14:48:17,288 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:17,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:48:17,288 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:17
2025-03-13 14:48:17,288 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:17,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:48:17,289 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:17
2025-03-13 14:48:17,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:17,289 [INFO]: 	Creating the index 03/13/2025, 14:48:17
2025-03-13 14:48:17,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:17
2025-03-13 14:48:17,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:48:17,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:17
2025-03-13 14:48:17,293 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:48:17,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 16.20it/s] 29%|██▉       | 7/24 [00:00<00:00, 30.89it/s] 50%|█████     | 12/24 [00:00<00:00, 36.24it/s] 71%|███████   | 17/24 [00:00<00:00, 37.98it/s] 88%|████████▊ | 21/24 [00:06<00:01,  1.89it/s]100%|██████████| 24/24 [00:08<00:00,  1.93it/s]100%|██████████| 24/24 [00:08<00:00,  2.94it/s]
2025-03-13 14:48:25,452 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:25
2025-03-13 14:49:23,594 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1411 secs
2025-03-13 14:49:23,594 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 14:49:23,594 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.38it/s]
2025-03-13 14:50:03,914 [INFO]: 	>>> Finished "Compute fast metrics" in 40.3200 secs
2025-03-13 14:50:03,915 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.6219 secs
2025-03-13 14:50:03,915 [INFO]: {
2025-03-13 14:50:03,915 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:03,915 [INFO]: 	index_param: efSearch=211
2025-03-13 14:50:03,915 [INFO]: 	index_path: knn.index
2025-03-13 14:50:03,915 [INFO]: 	size in bytes: 1119474070
2025-03-13 14:50:03,915 [INFO]: 	avg_search_speed_ms: 11.30388394198091
2025-03-13 14:50:03,915 [INFO]: 	99p_search_speed_ms: 17.748718047514558
2025-03-13 14:50:03,915 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:03,915 [INFO]: 	nb vectors: 5690
2025-03-13 14:50:03,915 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:03,915 [INFO]: 	compression ratio: 0.9993081126032691
2025-03-13 14:50:03,915 [INFO]: }
2025-03-13 14:50:03,915 [INFO]: 	>>> Finished "Creating the index" in 106.6262 secs
2025-03-13 14:50:03,915 [INFO]: >>> Finished "Launching the whole pipeline" in 106.6605 secs
2025-03-13 14:50:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 54344 [episode count 8/20]
[retrieval_preprocessing] for episode 12361 [episode count 9/20], we have num_retrieval=np.int64(5761) num_query=np.int64(297)
2025-03-13 14:50:07,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:08,266 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:08
2025-03-13 14:50:08,267 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.84it/s]
2025-03-13 14:50:08,292 [INFO]: There are 5761 embeddings of dim 49152
2025-03-13 14:50:08,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 14:50:08,293 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:08
2025-03-13 14:50:08,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:08,293 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:50:08,293 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:08,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:08,293 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:08
2025-03-13 14:50:08,293 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:08,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:50:08,293 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:08
2025-03-13 14:50:08,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:08,293 [INFO]: 	Creating the index 03/13/2025, 14:50:08
2025-03-13 14:50:08,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:08
2025-03-13 14:50:08,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:50:08,294 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:08
2025-03-13 14:50:08,294 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:50:08,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.57it/s] 25%|██▌       | 6/24 [00:00<00:00, 27.63it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.24it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.04it/s] 88%|████████▊ | 21/24 [00:04<00:01,  2.90it/s]100%|██████████| 24/24 [00:06<00:00,  2.44it/s]100%|██████████| 24/24 [00:06<00:00,  3.68it/s]
2025-03-13 14:50:14,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:14
2025-03-13 14:51:24,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.1629 secs
2025-03-13 14:51:24,990 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 14:51:24,990 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.47it/s]
2025-03-13 14:51:50,567 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5766 secs
2025-03-13 14:51:50,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.2743 secs
2025-03-13 14:51:50,568 [INFO]: {
2025-03-13 14:51:50,568 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:50,568 [INFO]: 	index_param: efSearch=174
2025-03-13 14:51:50,568 [INFO]: 	index_path: knn.index
2025-03-13 14:51:50,568 [INFO]: 	size in bytes: 1133442790
2025-03-13 14:51:50,569 [INFO]: 	avg_search_speed_ms: 10.55266372987191
2025-03-13 14:51:50,569 [INFO]: 	99p_search_speed_ms: 15.313962006475776
2025-03-13 14:51:50,569 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:50,569 [INFO]: 	nb vectors: 5761
2025-03-13 14:51:50,569 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:50,569 [INFO]: 	compression ratio: 0.9993082121065855
2025-03-13 14:51:50,569 [INFO]: }
2025-03-13 14:51:50,569 [INFO]: 	>>> Finished "Creating the index" in 102.2756 secs
2025-03-13 14:51:50,569 [INFO]: >>> Finished "Launching the whole pipeline" in 102.3020 secs
2025-03-13 14:51:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 12361 [episode count 9/20]
[retrieval_preprocessing] for episode 30796 [episode count 10/20], we have num_retrieval=np.int64(5804) num_query=np.int64(254)
2025-03-13 14:51:53,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:54,659 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:54
2025-03-13 14:51:54,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.48it/s]
2025-03-13 14:51:54,690 [INFO]: There are 5804 embeddings of dim 49152
2025-03-13 14:51:54,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 14:51:54,690 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:54
2025-03-13 14:51:54,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:54,690 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:51:54,690 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:54,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:54,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:54
2025-03-13 14:51:54,690 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:54,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:51:54,691 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:54
2025-03-13 14:51:54,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:54,691 [INFO]: 	Creating the index 03/13/2025, 14:51:54
2025-03-13 14:51:54,691 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:54
2025-03-13 14:51:54,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:51:54,692 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:54
2025-03-13 14:51:54,692 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:51:54,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.74it/s] 17%|█▋        | 4/24 [00:00<00:01, 18.12it/s] 33%|███▎      | 8/24 [00:00<00:00, 26.82it/s] 50%|█████     | 12/24 [00:00<00:00, 31.08it/s] 67%|██████▋   | 16/24 [00:00<00:00, 33.52it/s] 83%|████████▎ | 20/24 [00:00<00:00, 35.17it/s]100%|██████████| 24/24 [00:06<00:00,  1.88it/s]100%|██████████| 24/24 [00:06<00:00,  3.59it/s]
2025-03-13 14:52:01,386 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:01
2025-03-13 14:53:02,259 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8728 secs
2025-03-13 14:53:02,259 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:53:02,260 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 14:53:33,452 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1924 secs
2025-03-13 14:53:33,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.7613 secs
2025-03-13 14:53:33,453 [INFO]: {
2025-03-13 14:53:33,453 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:33,453 [INFO]: 	index_param: efSearch=156
2025-03-13 14:53:33,453 [INFO]: 	index_path: knn.index
2025-03-13 14:53:33,453 [INFO]: 	size in bytes: 1141902790
2025-03-13 14:53:33,454 [INFO]: 	avg_search_speed_ms: 10.646924951249641
2025-03-13 14:53:33,454 [INFO]: 	99p_search_speed_ms: 14.66859770938754
2025-03-13 14:53:33,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:33,454 [INFO]: 	nb vectors: 5804
2025-03-13 14:53:33,454 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:33,454 [INFO]: 	compression ratio: 0.9993082090639257
2025-03-13 14:53:33,454 [INFO]: }
2025-03-13 14:53:33,454 [INFO]: 	>>> Finished "Creating the index" in 98.7630 secs
2025-03-13 14:53:33,454 [INFO]: >>> Finished "Launching the whole pipeline" in 98.7945 secs
2025-03-13 14:53:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 30796 [episode count 10/20]
[retrieval_preprocessing] for episode 77418 [episode count 11/20], we have num_retrieval=np.int64(5664) num_query=np.int64(394)
2025-03-13 14:53:36,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:37,085 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:37
2025-03-13 14:53:37,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.17it/s]
2025-03-13 14:53:37,114 [INFO]: There are 5664 embeddings of dim 49152
2025-03-13 14:53:37,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 14:53:37,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:37
2025-03-13 14:53:37,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:37,116 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 14:53:37,116 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:37,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:53:37,116 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:37
2025-03-13 14:53:37,116 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:37,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:53:37,116 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:37
2025-03-13 14:53:37,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:37,117 [INFO]: 	Creating the index 03/13/2025, 14:53:37
2025-03-13 14:53:37,117 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:37
2025-03-13 14:53:37,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 14:53:37,120 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:37
2025-03-13 14:53:37,120 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:53:37,121 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.00it/s] 29%|██▉       | 7/24 [00:00<00:00, 33.73it/s] 50%|█████     | 12/24 [00:00<00:00, 39.80it/s] 71%|███████   | 17/24 [00:00<00:00, 42.67it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.42it/s]100%|██████████| 24/24 [00:05<00:00,  4.54it/s]
2025-03-13 14:53:42,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:42
2025-03-13 14:54:38,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0148 secs
2025-03-13 14:54:38,642 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 14:54:38,642 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.79s/it] 50%|█████     | 2/4 [00:02<00:02,  1.33s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.66s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.24s/it]
2025-03-13 14:55:29,601 [INFO]: 	>>> Finished "Compute fast metrics" in 50.9590 secs
2025-03-13 14:55:29,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.4819 secs
2025-03-13 14:55:29,602 [INFO]: {
2025-03-13 14:55:29,602 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:29,602 [INFO]: 	index_param: efSearch=131
2025-03-13 14:55:29,602 [INFO]: 	index_path: knn.index
2025-03-13 14:55:29,602 [INFO]: 	size in bytes: 1114358770
2025-03-13 14:55:29,602 [INFO]: 	avg_search_speed_ms: 7.153610431240107
2025-03-13 14:55:29,603 [INFO]: 	99p_search_speed_ms: 9.7577677317895
2025-03-13 14:55:29,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:29,603 [INFO]: 	nb vectors: 5664
2025-03-13 14:55:29,603 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:29,603 [INFO]: 	compression ratio: 0.9993080702366618
2025-03-13 14:55:29,603 [INFO]: }
2025-03-13 14:55:29,603 [INFO]: 	>>> Finished "Creating the index" in 112.4859 secs
2025-03-13 14:55:29,603 [INFO]: >>> Finished "Launching the whole pipeline" in 112.5171 secs
2025-03-13 14:55:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 77418 [episode count 11/20]
[retrieval_preprocessing] for episode 19586 [episode count 12/20], we have num_retrieval=np.int64(5765) num_query=np.int64(293)
2025-03-13 14:55:33,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:34,867 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:34
2025-03-13 14:55:34,867 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 849.91it/s]
2025-03-13 14:55:34,898 [INFO]: There are 5765 embeddings of dim 49152
2025-03-13 14:55:34,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 14:55:34,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:34
2025-03-13 14:55:34,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:34,899 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:55:34,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:34,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:55:34,899 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:34
2025-03-13 14:55:34,899 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:34,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:55:34,899 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:34
2025-03-13 14:55:34,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:34,899 [INFO]: 	Creating the index 03/13/2025, 14:55:34
2025-03-13 14:55:34,899 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:34
2025-03-13 14:55:34,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:55:34,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:34
2025-03-13 14:55:34,901 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:55:34,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.32it/s]  8%|▊         | 2/24 [00:01<00:12,  1.76it/s] 29%|██▉       | 7/24 [00:01<00:02,  7.92it/s] 50%|█████     | 12/24 [00:01<00:00, 14.40it/s] 75%|███████▌  | 18/24 [00:01<00:00, 21.78it/s] 92%|█████████▏| 22/24 [00:05<00:00,  2.77it/s]100%|██████████| 24/24 [00:07<00:00,  3.29it/s]
2025-03-13 14:55:42,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:42
2025-03-13 14:56:49,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.1172 secs
2025-03-13 14:56:49,329 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 14:56:49,329 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.85it/s]
2025-03-13 14:57:14,054 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7244 secs
2025-03-13 14:57:14,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.1542 secs
2025-03-13 14:57:14,055 [INFO]: {
2025-03-13 14:57:14,055 [INFO]: 	index_key: HNSW15
2025-03-13 14:57:14,055 [INFO]: 	index_param: efSearch=190
2025-03-13 14:57:14,055 [INFO]: 	index_path: knn.index
2025-03-13 14:57:14,055 [INFO]: 	size in bytes: 1134229750
2025-03-13 14:57:14,055 [INFO]: 	avg_search_speed_ms: 10.969634841322867
2025-03-13 14:57:14,055 [INFO]: 	99p_search_speed_ms: 19.461413812823594
2025-03-13 14:57:14,055 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:57:14,055 [INFO]: 	nb vectors: 5765
2025-03-13 14:57:14,055 [INFO]: 	vectors dimension: 49152
2025-03-13 14:57:14,055 [INFO]: 	compression ratio: 0.9993082265740252
2025-03-13 14:57:14,055 [INFO]: }
2025-03-13 14:57:14,055 [INFO]: 	>>> Finished "Creating the index" in 99.1560 secs
2025-03-13 14:57:14,055 [INFO]: >>> Finished "Launching the whole pipeline" in 99.1882 secs
2025-03-13 14:57:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 19586 [episode count 12/20]
[retrieval_preprocessing] for episode 38039 [episode count 13/20], we have num_retrieval=np.int64(5719) num_query=np.int64(339)
2025-03-13 14:57:22,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:22,876 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:22
2025-03-13 14:57:22,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-13 14:57:22,903 [INFO]: There are 5719 embeddings of dim 49152
2025-03-13 14:57:22,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 14:57:22,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:22
2025-03-13 14:57:22,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:22,904 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 14:57:22,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:22,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:57:22,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:22
2025-03-13 14:57:22,904 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:22,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:57:22,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:22
2025-03-13 14:57:22,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:22,904 [INFO]: 	Creating the index 03/13/2025, 14:57:22
2025-03-13 14:57:22,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:22
2025-03-13 14:57:22,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:57:22,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:22
2025-03-13 14:57:22,906 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:57:22,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.98it/s] 25%|██▌       | 6/24 [00:00<00:00, 31.00it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.23it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.69it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.03it/s]100%|██████████| 24/24 [00:07<00:00,  2.11it/s]100%|██████████| 24/24 [00:07<00:00,  3.32it/s]
2025-03-13 14:57:30,146 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:30
2025-03-13 14:58:28,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9183 secs
2025-03-13 14:58:28,065 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 14:58:28,065 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.31it/s] 50%|█████     | 2/4 [00:00<00:00,  5.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 14:58:51,050 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9838 secs
2025-03-13 14:58:51,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.7977 secs
2025-03-13 14:58:51,704 [INFO]: {
2025-03-13 14:58:51,704 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:51,704 [INFO]: 	index_param: efSearch=103
2025-03-13 14:58:51,704 [INFO]: 	index_path: knn.index
2025-03-13 14:58:51,704 [INFO]: 	size in bytes: 1125179590
2025-03-13 14:58:51,704 [INFO]: 	avg_search_speed_ms: 11.083653621311544
2025-03-13 14:58:51,705 [INFO]: 	99p_search_speed_ms: 15.383843281306326
2025-03-13 14:58:51,705 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:51,705 [INFO]: 	nb vectors: 5719
2025-03-13 14:58:51,705 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:51,705 [INFO]: 	compression ratio: 0.9993081655524875
2025-03-13 14:58:51,705 [INFO]: }
2025-03-13 14:58:51,705 [INFO]: 	>>> Finished "Creating the index" in 88.8004 secs
2025-03-13 14:58:51,705 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8287 secs
2025-03-13 14:58:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 38039 [episode count 13/20]
[retrieval_preprocessing] for episode 44176 [episode count 14/20], we have num_retrieval=np.int64(5773) num_query=np.int64(285)
2025-03-13 14:58:55,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:56,755 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:56
2025-03-13 14:58:56,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1067.52it/s]
2025-03-13 14:58:56,785 [INFO]: There are 5773 embeddings of dim 49152
2025-03-13 14:58:56,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 14:58:56,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:56
2025-03-13 14:58:56,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:56,786 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 14:58:56,786 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:56,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:58:56,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:56
2025-03-13 14:58:56,787 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:56,787 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:58:56,787 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:56
2025-03-13 14:58:56,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:56,788 [INFO]: 	Creating the index 03/13/2025, 14:58:56
2025-03-13 14:58:56,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:56
2025-03-13 14:58:56,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:58:56,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:56
2025-03-13 14:58:56,792 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 14:58:56,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.35it/s] 29%|██▉       | 7/24 [00:00<00:00, 33.98it/s] 50%|█████     | 12/24 [00:00<00:00, 37.90it/s] 71%|███████   | 17/24 [00:00<00:00, 41.41it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.50it/s]100%|██████████| 24/24 [00:05<00:00,  4.49it/s]
2025-03-13 14:59:02,141 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:02
2025-03-13 14:59:52,961 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8197 secs
2025-03-13 14:59:52,962 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 14:59:52,962 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 15:00:19,598 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6358 secs
2025-03-13 15:00:19,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8082 secs
2025-03-13 15:00:19,600 [INFO]: {
2025-03-13 15:00:19,600 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:19,600 [INFO]: 	index_param: efSearch=97
2025-03-13 15:00:19,600 [INFO]: 	index_path: knn.index
2025-03-13 15:00:19,600 [INFO]: 	size in bytes: 1135803670
2025-03-13 15:00:19,600 [INFO]: 	avg_search_speed_ms: 6.9808283750508915
2025-03-13 15:00:19,600 [INFO]: 	99p_search_speed_ms: 11.741959932260217
2025-03-13 15:00:19,600 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:19,600 [INFO]: 	nb vectors: 5773
2025-03-13 15:00:19,600 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:19,600 [INFO]: 	compression ratio: 0.9993082554487608
2025-03-13 15:00:19,600 [INFO]: }
2025-03-13 15:00:19,600 [INFO]: 	>>> Finished "Creating the index" in 82.8125 secs
2025-03-13 15:00:19,600 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8448 secs
2025-03-13 15:00:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 44176 [episode count 14/20]
[retrieval_preprocessing] for episode 58550 [episode count 15/20], we have num_retrieval=np.int64(5672) num_query=np.int64(386)
2025-03-13 15:00:21,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:22,584 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:22
2025-03-13 15:00:22,584 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.59it/s]
2025-03-13 15:00:22,610 [INFO]: There are 5672 embeddings of dim 49152
2025-03-13 15:00:22,611 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:00:22,611 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:22
2025-03-13 15:00:22,611 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:22,611 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:00:22,611 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:22,611 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:00:22,611 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:22
2025-03-13 15:00:22,611 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:22,611 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:00:22,611 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:22
2025-03-13 15:00:22,611 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:22,611 [INFO]: 	Creating the index 03/13/2025, 15:00:22
2025-03-13 15:00:22,611 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:22
2025-03-13 15:00:22,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:00:22,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:22
2025-03-13 15:00:22,612 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:00:22,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.00it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.56it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.15it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.27it/s] 88%|████████▊ | 21/24 [00:04<00:01,  2.92it/s]100%|██████████| 24/24 [00:06<00:00,  2.68it/s]100%|██████████| 24/24 [00:06<00:00,  3.96it/s]
2025-03-13 15:00:28,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:28
2025-03-13 15:01:25,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7064 secs
2025-03-13 15:01:25,385 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:01:25,385 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 15:02:04,878 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4929 secs
2025-03-13 15:02:04,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.2664 secs
2025-03-13 15:02:04,879 [INFO]: {
2025-03-13 15:02:04,879 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:04,879 [INFO]: 	index_param: efSearch=211
2025-03-13 15:02:04,879 [INFO]: 	index_path: knn.index
2025-03-13 15:02:04,879 [INFO]: 	size in bytes: 1115932690
2025-03-13 15:02:04,879 [INFO]: 	avg_search_speed_ms: 11.231522613354487
2025-03-13 15:02:04,879 [INFO]: 	99p_search_speed_ms: 16.34329471271486
2025-03-13 15:02:04,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:04,879 [INFO]: 	nb vectors: 5672
2025-03-13 15:02:04,879 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:04,879 [INFO]: 	compression ratio: 0.999308099846058
2025-03-13 15:02:04,879 [INFO]: }
2025-03-13 15:02:04,879 [INFO]: 	>>> Finished "Creating the index" in 102.2678 secs
2025-03-13 15:02:04,879 [INFO]: >>> Finished "Launching the whole pipeline" in 102.2950 secs
2025-03-13 15:02:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 58550 [episode count 15/20]
[retrieval_preprocessing] for episode 60596 [episode count 16/20], we have num_retrieval=np.int64(5779) num_query=np.int64(279)
2025-03-13 15:02:08,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:09,502 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:09
2025-03-13 15:02:09,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.21it/s]
2025-03-13 15:02:09,526 [INFO]: There are 5779 embeddings of dim 49152
2025-03-13 15:02:09,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 15:02:09,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:09
2025-03-13 15:02:09,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:09,526 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 15:02:09,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:09,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:09,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:09
2025-03-13 15:02:09,526 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:09,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:02:09,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:09
2025-03-13 15:02:09,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:09,527 [INFO]: 	Creating the index 03/13/2025, 15:02:09
2025-03-13 15:02:09,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:09
2025-03-13 15:02:09,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:02:09,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:09
2025-03-13 15:02:09,528 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 15:02:09,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.43it/s] 25%|██▌       | 6/24 [00:00<00:00, 32.32it/s] 50%|█████     | 12/24 [00:00<00:00, 41.28it/s] 75%|███████▌  | 18/24 [00:00<00:00, 44.98it/s] 96%|█████████▌| 23/24 [00:04<00:00,  3.74it/s]100%|██████████| 24/24 [00:05<00:00,  4.47it/s]
2025-03-13 15:02:14,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:14
2025-03-13 15:03:12,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4201 secs
2025-03-13 15:03:12,315 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 15:03:12,316 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.67it/s]
2025-03-13 15:03:43,851 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5349 secs
2025-03-13 15:03:43,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.3238 secs
2025-03-13 15:03:43,852 [INFO]: {
2025-03-13 15:03:43,852 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:43,852 [INFO]: 	index_param: efSearch=133
2025-03-13 15:03:43,852 [INFO]: 	index_path: knn.index
2025-03-13 15:03:43,852 [INFO]: 	size in bytes: 1136984230
2025-03-13 15:03:43,852 [INFO]: 	avg_search_speed_ms: 9.084180195170449
2025-03-13 15:03:43,852 [INFO]: 	99p_search_speed_ms: 13.977695954963565
2025-03-13 15:03:43,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:43,852 [INFO]: 	nb vectors: 5779
2025-03-13 15:03:43,852 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:43,852 [INFO]: 	compression ratio: 0.9993081715829955
2025-03-13 15:03:43,852 [INFO]: }
2025-03-13 15:03:43,852 [INFO]: 	>>> Finished "Creating the index" in 94.3255 secs
2025-03-13 15:03:43,852 [INFO]: >>> Finished "Launching the whole pipeline" in 94.3502 secs
2025-03-13 15:03:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 60596 [episode count 16/20]
[retrieval_preprocessing] for episode 50869 [episode count 17/20], we have num_retrieval=np.int64(5803) num_query=np.int64(255)
2025-03-13 15:03:46,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:47,355 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:47
2025-03-13 15:03:47,355 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 740.26it/s]
2025-03-13 15:03:47,386 [INFO]: There are 5803 embeddings of dim 49152
2025-03-13 15:03:47,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 15:03:47,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:47
2025-03-13 15:03:47,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:47,388 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 15:03:47,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:47,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:03:47,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:47
2025-03-13 15:03:47,389 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:47,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:03:47,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:47
2025-03-13 15:03:47,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:47,389 [INFO]: 	Creating the index 03/13/2025, 15:03:47
2025-03-13 15:03:47,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:47
2025-03-13 15:03:47,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:03:47,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:47
2025-03-13 15:03:47,393 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 15:03:47,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.81it/s] 17%|█▋        | 4/24 [00:00<00:01, 18.24it/s] 33%|███▎      | 8/24 [00:00<00:00, 25.39it/s] 50%|█████     | 12/24 [00:00<00:00, 28.88it/s] 67%|██████▋   | 16/24 [00:00<00:00, 30.56it/s] 83%|████████▎ | 20/24 [00:00<00:00, 32.07it/s]100%|██████████| 24/24 [00:07<00:00,  1.72it/s]100%|██████████| 24/24 [00:07<00:00,  3.29it/s]
2025-03-13 15:03:54,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:54
2025-03-13 15:04:59,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1449 secs
2025-03-13 15:04:59,844 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 15:04:59,844 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-13 15:05:29,848 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0040 secs
2025-03-13 15:05:29,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.4567 secs
2025-03-13 15:05:29,850 [INFO]: {
2025-03-13 15:05:29,850 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:29,850 [INFO]: 	index_param: efSearch=161
2025-03-13 15:05:29,850 [INFO]: 	index_path: knn.index
2025-03-13 15:05:29,850 [INFO]: 	size in bytes: 1141706050
2025-03-13 15:05:29,850 [INFO]: 	avg_search_speed_ms: 10.48756140334028
2025-03-13 15:05:29,850 [INFO]: 	99p_search_speed_ms: 15.310262800194325
2025-03-13 15:05:29,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:29,850 [INFO]: 	nb vectors: 5803
2025-03-13 15:05:29,850 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:29,850 [INFO]: 	compression ratio: 0.9993082054702259
2025-03-13 15:05:29,850 [INFO]: }
2025-03-13 15:05:29,850 [INFO]: 	>>> Finished "Creating the index" in 102.4606 secs
2025-03-13 15:05:29,850 [INFO]: >>> Finished "Launching the whole pipeline" in 102.4953 secs
2025-03-13 15:05:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 50869 [episode count 17/20]
[retrieval_preprocessing] for episode 54462 [episode count 18/20], we have num_retrieval=np.int64(5715) num_query=np.int64(343)
2025-03-13 15:05:32,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:34,430 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:34
2025-03-13 15:05:34,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 793.02it/s]
2025-03-13 15:05:34,456 [INFO]: There are 5715 embeddings of dim 49152
2025-03-13 15:05:34,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:05:34,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:34
2025-03-13 15:05:34,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:34,456 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:05:34,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:34,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:05:34,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:34
2025-03-13 15:05:34,456 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:34,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:05:34,456 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:34
2025-03-13 15:05:34,456 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:34,456 [INFO]: 	Creating the index 03/13/2025, 15:05:34
2025-03-13 15:05:34,456 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:34
2025-03-13 15:05:34,457 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:05:34,458 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:34
2025-03-13 15:05:34,458 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:05:34,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.01it/s] 21%|██        | 5/24 [00:00<00:01, 18.37it/s] 38%|███▊      | 9/24 [00:00<00:00, 24.15it/s] 54%|█████▍    | 13/24 [00:00<00:00, 26.81it/s] 71%|███████   | 17/24 [00:00<00:00, 28.96it/s] 88%|████████▊ | 21/24 [00:06<00:01,  1.79it/s]100%|██████████| 24/24 [00:10<00:00,  1.30it/s]100%|██████████| 24/24 [00:10<00:00,  2.24it/s]
2025-03-13 15:05:45,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:45
2025-03-13 15:06:46,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.9641 secs
2025-03-13 15:06:46,119 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:06:46,119 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.27it/s] 50%|█████     | 2/4 [00:00<00:00,  2.48it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.26it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.22it/s]
2025-03-13 15:07:28,272 [INFO]: 	>>> Finished "Compute fast metrics" in 42.1529 secs
2025-03-13 15:07:28,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.8179 secs
2025-03-13 15:07:28,276 [INFO]: {
2025-03-13 15:07:28,276 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:28,276 [INFO]: 	index_param: efSearch=159
2025-03-13 15:07:28,276 [INFO]: 	index_path: knn.index
2025-03-13 15:07:28,276 [INFO]: 	size in bytes: 1124392630
2025-03-13 15:07:28,276 [INFO]: 	avg_search_speed_ms: 10.529187405972104
2025-03-13 15:07:28,276 [INFO]: 	99p_search_speed_ms: 15.883985890541224
2025-03-13 15:07:28,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:28,276 [INFO]: 	nb vectors: 5715
2025-03-13 15:07:28,276 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:28,276 [INFO]: 	compression ratio: 0.9993081509258914
2025-03-13 15:07:28,276 [INFO]: }
2025-03-13 15:07:28,276 [INFO]: 	>>> Finished "Creating the index" in 113.8196 secs
2025-03-13 15:07:28,276 [INFO]: >>> Finished "Launching the whole pipeline" in 113.8461 secs
2025-03-13 15:07:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 54462 [episode count 18/20]
[retrieval_preprocessing] for episode 11973 [episode count 19/20], we have num_retrieval=np.int64(5821) num_query=np.int64(237)
2025-03-13 15:07:33,348 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:34,590 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:34
2025-03-13 15:07:34,590 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1573.26it/s]
2025-03-13 15:07:34,620 [INFO]: There are 5821 embeddings of dim 49152
2025-03-13 15:07:34,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:07:34,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:34
2025-03-13 15:07:34,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:34,620 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 15:07:34,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:34,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:34,620 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:34
2025-03-13 15:07:34,620 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:34,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:34,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:34
2025-03-13 15:07:34,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:34,621 [INFO]: 	Creating the index 03/13/2025, 15:07:34
2025-03-13 15:07:34,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:34
2025-03-13 15:07:34,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:07:34,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:34
2025-03-13 15:07:34,622 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 15:07:34,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.00it/s] 21%|██        | 5/24 [00:00<00:00, 22.99it/s] 38%|███▊      | 9/24 [00:00<00:00, 29.88it/s] 54%|█████▍    | 13/24 [00:00<00:00, 32.92it/s] 71%|███████   | 17/24 [00:00<00:00, 33.99it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.29it/s]100%|██████████| 24/24 [00:07<00:00,  1.80it/s]100%|██████████| 24/24 [00:07<00:00,  3.05it/s]
2025-03-13 15:07:42,502 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:42
2025-03-13 15:08:48,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.8874 secs
2025-03-13 15:08:48,390 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:08:48,391 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 15:09:15,421 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0294 secs
2025-03-13 15:09:15,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.8000 secs
2025-03-13 15:09:15,423 [INFO]: {
2025-03-13 15:09:15,423 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:15,423 [INFO]: 	index_param: efSearch=154
2025-03-13 15:09:15,423 [INFO]: 	index_path: knn.index
2025-03-13 15:09:15,423 [INFO]: 	size in bytes: 1145247430
2025-03-13 15:09:15,423 [INFO]: 	avg_search_speed_ms: 11.70538612341846
2025-03-13 15:09:15,423 [INFO]: 	99p_search_speed_ms: 19.183226739987745
2025-03-13 15:09:15,423 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:15,423 [INFO]: 	nb vectors: 5821
2025-03-13 15:09:15,423 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:15,423 [INFO]: 	compression ratio: 0.9993082176137256
2025-03-13 15:09:15,423 [INFO]: }
2025-03-13 15:09:15,423 [INFO]: 	>>> Finished "Creating the index" in 100.8021 secs
2025-03-13 15:09:15,423 [INFO]: >>> Finished "Launching the whole pipeline" in 100.8325 secs
2025-03-13 15:09:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 11973 [episode count 19/20]
2025-03-13 15:09:18: [retrieval_preprocessing] finished for 3485794757_marker_into_cup [chosen_id count 0/196]
2025-03-13 15:09:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3727693504_press_button_coffeemaker [chosen_id count 1/196]
2025-03-13 15:09:19: [retrieval_preprocessing] we have num_total=1981 embedding_dim=49152
[retrieval_preprocessing] for episode 55332 [episode count 0/20], we have num_retrieval=np.int64(1889) num_query=np.int64(92)
2025-03-13 15:09:20,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:20,538 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:20
2025-03-13 15:09:20,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.44it/s]
2025-03-13 15:09:20,570 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 15:09:20,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 15:09:20,571 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:20
2025-03-13 15:09:20,571 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:20,571 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:09:20,571 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:20,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:09:20,571 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:20
2025-03-13 15:09:20,571 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:20,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:09:20,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:20
2025-03-13 15:09:20,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:20,572 [INFO]: 	Creating the index 03/13/2025, 15:09:20
2025-03-13 15:09:20,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:20
2025-03-13 15:09:20,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:09:20,574 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:20
2025-03-13 15:09:20,574 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:09:20,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.94it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.41it/s]100%|██████████| 8/8 [00:02<00:00,  3.11it/s]100%|██████████| 8/8 [00:02<00:00,  3.78it/s]
2025-03-13 15:09:22,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:22
2025-03-13 15:09:50,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9262 secs
2025-03-13 15:09:50,623 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 15:09:50,623 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.92it/s]
2025-03-13 15:10:06,541 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9168 secs
2025-03-13 15:10:06,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9690 secs
2025-03-13 15:10:06,543 [INFO]: {
2025-03-13 15:10:06,543 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:06,543 [INFO]: 	index_param: efSearch=262
2025-03-13 15:10:06,543 [INFO]: 	index_path: knn.index
2025-03-13 15:10:06,543 [INFO]: 	size in bytes: 371649490
2025-03-13 15:10:06,543 [INFO]: 	avg_search_speed_ms: 11.128975835486882
2025-03-13 15:10:06,543 [INFO]: 	99p_search_speed_ms: 17.963448902592063
2025-03-13 15:10:06,543 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:06,543 [INFO]: 	nb vectors: 1889
2025-03-13 15:10:06,543 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:06,543 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 15:10:06,543 [INFO]: }
2025-03-13 15:10:06,543 [INFO]: 	>>> Finished "Creating the index" in 45.9713 secs
2025-03-13 15:10:06,543 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0045 secs
2025-03-13 15:10:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 55332 [episode count 0/20]
[retrieval_preprocessing] for episode 60983 [episode count 1/20], we have num_retrieval=np.int64(1902) num_query=np.int64(79)
2025-03-13 15:10:10,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:11,303 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:11
2025-03-13 15:10:11,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.62it/s]
2025-03-13 15:10:11,334 [INFO]: There are 1902 embeddings of dim 49152
2025-03-13 15:10:11,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:10:11,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:11
2025-03-13 15:10:11,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:11,335 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:10:11,335 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:11,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:10:11,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:11
2025-03-13 15:10:11,335 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:11,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:11,335 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:11
2025-03-13 15:10:11,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:11,335 [INFO]: 	Creating the index 03/13/2025, 15:10:11
2025-03-13 15:10:11,335 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:11
2025-03-13 15:10:11,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:10:11,337 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:11
2025-03-13 15:10:11,337 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:10:11,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.42it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.61it/s]100%|██████████| 8/8 [00:01<00:00,  4.34it/s]
2025-03-13 15:10:13,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:13
2025-03-13 15:10:39,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5178 secs
2025-03-13 15:10:39,702 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 15:10:39,702 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 15:10:54,838 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1352 secs
2025-03-13 15:10:54,840 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5029 secs
2025-03-13 15:10:54,840 [INFO]: {
2025-03-13 15:10:54,840 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:54,841 [INFO]: 	index_param: efSearch=227
2025-03-13 15:10:54,841 [INFO]: 	index_path: knn.index
2025-03-13 15:10:54,841 [INFO]: 	size in bytes: 374207170
2025-03-13 15:10:54,841 [INFO]: 	avg_search_speed_ms: 9.59668950925826
2025-03-13 15:10:54,841 [INFO]: 	99p_search_speed_ms: 14.035735733341422
2025-03-13 15:10:54,841 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:54,841 [INFO]: 	nb vectors: 1902
2025-03-13 15:10:54,841 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:54,841 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-13 15:10:54,841 [INFO]: }
2025-03-13 15:10:54,841 [INFO]: 	>>> Finished "Creating the index" in 43.5053 secs
2025-03-13 15:10:54,841 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5372 secs
2025-03-13 15:10:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 60983 [episode count 1/20]
[retrieval_preprocessing] for episode 65645 [episode count 2/20], we have num_retrieval=np.int64(1891) num_query=np.int64(90)
2025-03-13 15:10:55,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:56,133 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:56
2025-03-13 15:10:56,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 934.35it/s]
2025-03-13 15:10:56,160 [INFO]: There are 1891 embeddings of dim 49152
2025-03-13 15:10:56,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:10:56,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:56,161 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:10:56,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:56,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:10:56,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,162 [INFO]: 390.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:56,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:10:56,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:56
2025-03-13 15:10:56,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:56,163 [INFO]: 	Creating the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:56
2025-03-13 15:10:56,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:10:56,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,166 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:10:56,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.80it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.29it/s]100%|██████████| 8/8 [00:01<00:00,  5.15it/s]
2025-03-13 15:10:57,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:57
2025-03-13 15:11:27,144 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4178 secs
2025-03-13 15:11:27,144 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:11:27,144 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.41it/s]
2025-03-13 15:11:42,765 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6210 secs
2025-03-13 15:11:42,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6003 secs
2025-03-13 15:11:42,767 [INFO]: {
2025-03-13 15:11:42,767 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:42,767 [INFO]: 	index_param: efSearch=205
2025-03-13 15:11:42,767 [INFO]: 	index_path: knn.index
2025-03-13 15:11:42,767 [INFO]: 	size in bytes: 372042970
2025-03-13 15:11:42,767 [INFO]: 	avg_search_speed_ms: 12.573721218121767
2025-03-13 15:11:42,767 [INFO]: 	99p_search_speed_ms: 27.426336763892305
2025-03-13 15:11:42,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:42,767 [INFO]: 	nb vectors: 1891
2025-03-13 15:11:42,767 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:42,767 [INFO]: 	compression ratio: 0.9993085691150138
2025-03-13 15:11:42,767 [INFO]: }
2025-03-13 15:11:42,767 [INFO]: 	>>> Finished "Creating the index" in 46.6041 secs
2025-03-13 15:11:42,767 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6339 secs
2025-03-13 15:11:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 65645 [episode count 2/20]
[retrieval_preprocessing] for episode 53362 [episode count 3/20], we have num_retrieval=np.int64(1871) num_query=np.int64(110)
2025-03-13 15:11:43,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:44,688 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:44
2025-03-13 15:11:44,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-13 15:11:44,715 [INFO]: There are 1871 embeddings of dim 49152
2025-03-13 15:11:44,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:11:44,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:44
2025-03-13 15:11:44,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:44,715 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:11:44,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:44,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:44,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:44
2025-03-13 15:11:44,715 [INFO]: 386.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:44,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:44,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:44
2025-03-13 15:11:44,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:44,716 [INFO]: 	Creating the index 03/13/2025, 15:11:44
2025-03-13 15:11:44,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:44
2025-03-13 15:11:44,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:11:44,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:44
2025-03-13 15:11:44,717 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:11:44,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.34it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.45it/s]100%|██████████| 8/8 [00:01<00:00,  3.82it/s]100%|██████████| 8/8 [00:01<00:00,  4.58it/s]
2025-03-13 15:11:46,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:46
2025-03-13 15:12:13,288 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8203 secs
2025-03-13 15:12:13,289 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:12:13,289 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.72it/s]
2025-03-13 15:12:28,997 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7079 secs
2025-03-13 15:12:28,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2820 secs
2025-03-13 15:12:28,999 [INFO]: {
2025-03-13 15:12:28,999 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:28,999 [INFO]: 	index_param: efSearch=190
2025-03-13 15:12:28,999 [INFO]: 	index_path: knn.index
2025-03-13 15:12:28,999 [INFO]: 	size in bytes: 368107990
2025-03-13 15:12:28,999 [INFO]: 	avg_search_speed_ms: 10.673539647673483
2025-03-13 15:12:28,999 [INFO]: 	99p_search_speed_ms: 18.435466680675738
2025-03-13 15:12:28,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:28,999 [INFO]: 	nb vectors: 1871
2025-03-13 15:12:28,999 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:28,999 [INFO]: 	compression ratio: 0.9993088386916025
2025-03-13 15:12:28,999 [INFO]: }
2025-03-13 15:12:28,999 [INFO]: 	>>> Finished "Creating the index" in 44.2836 secs
2025-03-13 15:12:28,999 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3109 secs
2025-03-13 15:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 53362 [episode count 3/20]
[retrieval_preprocessing] for episode 35964 [episode count 4/20], we have num_retrieval=np.int64(1896) num_query=np.int64(85)
2025-03-13 15:12:30,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:30,808 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:30
2025-03-13 15:12:30,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.49it/s]
2025-03-13 15:12:30,837 [INFO]: There are 1896 embeddings of dim 49152
2025-03-13 15:12:30,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:12:30,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:30
2025-03-13 15:12:30,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:30,837 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:12:30,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:30,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:30,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:30
2025-03-13 15:12:30,837 [INFO]: 391.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:30,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:30,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:30
2025-03-13 15:12:30,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:30,838 [INFO]: 	Creating the index 03/13/2025, 15:12:30
2025-03-13 15:12:30,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:30
2025-03-13 15:12:30,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:12:30,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:30
2025-03-13 15:12:30,839 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:12:30,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.79it/s] 50%|█████     | 4/8 [00:00<00:00, 15.99it/s] 88%|████████▊ | 7/8 [00:00<00:00, 20.96it/s]100%|██████████| 8/8 [00:02<00:00,  2.82it/s]
2025-03-13 15:12:33,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:33
2025-03-13 15:13:01,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6573 secs
2025-03-13 15:13:01,343 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 15:13:01,343 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 15:13:18,563 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2200 secs
2025-03-13 15:13:18,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7260 secs
2025-03-13 15:13:18,565 [INFO]: {
2025-03-13 15:13:18,565 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:18,565 [INFO]: 	index_param: efSearch=174
2025-03-13 15:13:18,565 [INFO]: 	index_path: knn.index
2025-03-13 15:13:18,565 [INFO]: 	size in bytes: 373026670
2025-03-13 15:13:18,565 [INFO]: 	avg_search_speed_ms: 8.454675017442753
2025-03-13 15:13:18,565 [INFO]: 	99p_search_speed_ms: 13.66222687065605
2025-03-13 15:13:18,565 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:18,565 [INFO]: 	nb vectors: 1896
2025-03-13 15:13:18,565 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:18,565 [INFO]: 	compression ratio: 0.9993086231609123
2025-03-13 15:13:18,565 [INFO]: }
2025-03-13 15:13:18,565 [INFO]: 	>>> Finished "Creating the index" in 47.7275 secs
2025-03-13 15:13:18,565 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7569 secs
2025-03-13 15:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 35964 [episode count 4/20]
[retrieval_preprocessing] for episode 92305 [episode count 5/20], we have num_retrieval=np.int64(1893) num_query=np.int64(88)
2025-03-13 15:13:19,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:20,100 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:20
2025-03-13 15:13:20,100 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.12it/s]
2025-03-13 15:13:20,125 [INFO]: There are 1893 embeddings of dim 49152
2025-03-13 15:13:20,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:13:20,125 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:20
2025-03-13 15:13:20,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:20,125 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:13:20,125 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:20,125 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:20,125 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:20
2025-03-13 15:13:20,125 [INFO]: 390.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:20,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:20,125 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:20
2025-03-13 15:13:20,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:20,125 [INFO]: 	Creating the index 03/13/2025, 15:13:20
2025-03-13 15:13:20,125 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:20
2025-03-13 15:13:20,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:13:20,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:20
2025-03-13 15:13:20,127 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:13:20,127 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.62it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.27it/s]100%|██████████| 8/8 [00:01<00:00,  3.83it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 15:13:21,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:21
2025-03-13 15:13:46,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8641 secs
2025-03-13 15:13:46,734 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:13:46,734 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.06it/s]
2025-03-13 15:14:07,720 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9861 secs
2025-03-13 15:14:07,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5948 secs
2025-03-13 15:14:07,721 [INFO]: {
2025-03-13 15:14:07,721 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:07,721 [INFO]: 	index_param: efSearch=224
2025-03-13 15:14:07,721 [INFO]: 	index_path: knn.index
2025-03-13 15:14:07,721 [INFO]: 	size in bytes: 372436450
2025-03-13 15:14:07,722 [INFO]: 	avg_search_speed_ms: 9.588877119977573
2025-03-13 15:14:07,722 [INFO]: 	99p_search_speed_ms: 13.817494064569457
2025-03-13 15:14:07,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:07,722 [INFO]: 	nb vectors: 1893
2025-03-13 15:14:07,722 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:07,722 [INFO]: 	compression ratio: 0.999308590767633
2025-03-13 15:14:07,722 [INFO]: }
2025-03-13 15:14:07,722 [INFO]: 	>>> Finished "Creating the index" in 47.5962 secs
2025-03-13 15:14:07,722 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6216 secs
2025-03-13 15:14:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 92305 [episode count 5/20]
[retrieval_preprocessing] for episode 65688 [episode count 6/20], we have num_retrieval=np.int64(1871) num_query=np.int64(110)
2025-03-13 15:14:08,405 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:08,635 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:08
2025-03-13 15:14:08,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-13 15:14:08,657 [INFO]: There are 1871 embeddings of dim 49152
2025-03-13 15:14:08,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 15:14:08,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:08
2025-03-13 15:14:08,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:08,657 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:14:08,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:08,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:08,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:08
2025-03-13 15:14:08,658 [INFO]: 386.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:08,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:14:08,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:08
2025-03-13 15:14:08,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:08,658 [INFO]: 	Creating the index 03/13/2025, 15:14:08
2025-03-13 15:14:08,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:08
2025-03-13 15:14:08,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:14:08,659 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:08
2025-03-13 15:14:08,659 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:14:08,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.70it/s] 88%|████████▊ | 7/8 [00:00<00:00, 37.55it/s]100%|██████████| 8/8 [00:01<00:00,  6.99it/s]
2025-03-13 15:14:09,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:09
2025-03-13 15:14:31,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.2039 secs
2025-03-13 15:14:31,011 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 15:14:31,011 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.19it/s] 50%|█████     | 2/4 [00:00<00:00,  5.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.42it/s]
2025-03-13 15:14:51,004 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9928 secs
2025-03-13 15:14:51,006 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3474 secs
2025-03-13 15:14:51,006 [INFO]: {
2025-03-13 15:14:51,006 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:51,006 [INFO]: 	index_param: efSearch=262
2025-03-13 15:14:51,006 [INFO]: 	index_path: knn.index
2025-03-13 15:14:51,006 [INFO]: 	size in bytes: 368107990
2025-03-13 15:14:51,006 [INFO]: 	avg_search_speed_ms: 13.77277433315482
2025-03-13 15:14:51,006 [INFO]: 	99p_search_speed_ms: 19.782765884883702
2025-03-13 15:14:51,006 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:51,006 [INFO]: 	nb vectors: 1871
2025-03-13 15:14:51,006 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:51,006 [INFO]: 	compression ratio: 0.9993088386916025
2025-03-13 15:14:51,006 [INFO]: }
2025-03-13 15:14:51,006 [INFO]: 	>>> Finished "Creating the index" in 42.3487 secs
2025-03-13 15:14:51,007 [INFO]: >>> Finished "Launching the whole pipeline" in 42.3718 secs
2025-03-13 15:14:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 65688 [episode count 6/20]
[retrieval_preprocessing] for episode 44205 [episode count 7/20], we have num_retrieval=np.int64(1871) num_query=np.int64(110)
2025-03-13 15:14:52,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:52,587 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:52
2025-03-13 15:14:52,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.85it/s]
2025-03-13 15:14:52,615 [INFO]: There are 1871 embeddings of dim 49152
2025-03-13 15:14:52,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:14:52,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:52,616 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:14:52,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:52,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:52,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,616 [INFO]: 386.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:52,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:14:52,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:52
2025-03-13 15:14:52,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:52,616 [INFO]: 	Creating the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:52
2025-03-13 15:14:52,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:14:52,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,618 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:14:52,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.95it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.42it/s]100%|██████████| 8/8 [00:01<00:00,  5.75it/s]
2025-03-13 15:14:54,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:54
2025-03-13 15:15:20,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9759 secs
2025-03-13 15:15:20,989 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:15:20,989 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.16it/s]
2025-03-13 15:15:35,552 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5623 secs
2025-03-13 15:15:35,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9369 secs
2025-03-13 15:15:35,555 [INFO]: {
2025-03-13 15:15:35,555 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:35,555 [INFO]: 	index_param: efSearch=191
2025-03-13 15:15:35,555 [INFO]: 	index_path: knn.index
2025-03-13 15:15:35,555 [INFO]: 	size in bytes: 368107990
2025-03-13 15:15:35,555 [INFO]: 	avg_search_speed_ms: 9.512105475505061
2025-03-13 15:15:35,555 [INFO]: 	99p_search_speed_ms: 15.24211058858782
2025-03-13 15:15:35,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:35,555 [INFO]: 	nb vectors: 1871
2025-03-13 15:15:35,555 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:35,555 [INFO]: 	compression ratio: 0.9993088386916025
2025-03-13 15:15:35,555 [INFO]: }
2025-03-13 15:15:35,555 [INFO]: 	>>> Finished "Creating the index" in 42.9388 secs
2025-03-13 15:15:35,555 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9676 secs
2025-03-13 15:15:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 44205 [episode count 7/20]
[retrieval_preprocessing] for episode 28376 [episode count 8/20], we have num_retrieval=np.int64(1901) num_query=np.int64(80)
2025-03-13 15:15:37,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:37,694 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:37
2025-03-13 15:15:37,694 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.60it/s]
2025-03-13 15:15:37,730 [INFO]: There are 1901 embeddings of dim 49152
2025-03-13 15:15:37,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 15:15:37,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:37
2025-03-13 15:15:37,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:37,730 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:15:37,730 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:37,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:37,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:37
2025-03-13 15:15:37,731 [INFO]: 392.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:37,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:15:37,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:37
2025-03-13 15:15:37,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:37,731 [INFO]: 	Creating the index 03/13/2025, 15:15:37
2025-03-13 15:15:37,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:37
2025-03-13 15:15:37,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:15:37,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:37
2025-03-13 15:15:37,733 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:15:37,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.86it/s] 50%|█████     | 4/8 [00:00<00:00, 17.51it/s] 88%|████████▊ | 7/8 [00:00<00:00, 20.59it/s]100%|██████████| 8/8 [00:02<00:00,  3.35it/s]
2025-03-13 15:15:40,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:40
2025-03-13 15:16:15,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8794 secs
2025-03-13 15:16:15,004 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:16:15,004 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-13 15:16:29,896 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8911 secs
2025-03-13 15:16:29,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1645 secs
2025-03-13 15:16:29,897 [INFO]: {
2025-03-13 15:16:29,897 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:29,897 [INFO]: 	index_param: efSearch=202
2025-03-13 15:16:29,897 [INFO]: 	index_path: knn.index
2025-03-13 15:16:29,897 [INFO]: 	size in bytes: 374010430
2025-03-13 15:16:29,897 [INFO]: 	avg_search_speed_ms: 8.089601503787593
2025-03-13 15:16:29,897 [INFO]: 	99p_search_speed_ms: 11.751741694752134
2025-03-13 15:16:29,897 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:29,897 [INFO]: 	nb vectors: 1901
2025-03-13 15:16:29,897 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:29,898 [INFO]: 	compression ratio: 0.9993085166100849
2025-03-13 15:16:29,898 [INFO]: }
2025-03-13 15:16:29,898 [INFO]: 	>>> Finished "Creating the index" in 52.1664 secs
2025-03-13 15:16:29,898 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2037 secs
2025-03-13 15:16:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 28376 [episode count 8/20]
[retrieval_preprocessing] for episode 14569 [episode count 9/20], we have num_retrieval=np.int64(1879) num_query=np.int64(102)
2025-03-13 15:16:30,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:31,028 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:31
2025-03-13 15:16:31,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2246.55it/s]
2025-03-13 15:16:31,052 [INFO]: There are 1879 embeddings of dim 49152
2025-03-13 15:16:31,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 15:16:31,052 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:31
2025-03-13 15:16:31,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:31,052 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:16:31,052 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:31,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:31,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:31
2025-03-13 15:16:31,052 [INFO]: 387.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:31,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:16:31,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:31
2025-03-13 15:16:31,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:31,053 [INFO]: 	Creating the index 03/13/2025, 15:16:31
2025-03-13 15:16:31,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:31
2025-03-13 15:16:31,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:16:31,054 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:31
2025-03-13 15:16:31,054 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:16:31,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.20it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.14it/s]100%|██████████| 8/8 [00:01<00:00,  5.93it/s]
2025-03-13 15:16:32,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:32
2025-03-13 15:17:00,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8180 secs
2025-03-13 15:17:00,223 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:17:00,223 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 15:17:19,677 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4544 secs
2025-03-13 15:17:19,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6256 secs
2025-03-13 15:17:19,679 [INFO]: {
2025-03-13 15:17:19,679 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:19,679 [INFO]: 	index_param: efSearch=214
2025-03-13 15:17:19,679 [INFO]: 	index_path: knn.index
2025-03-13 15:17:19,679 [INFO]: 	size in bytes: 369682030
2025-03-13 15:17:19,679 [INFO]: 	avg_search_speed_ms: 8.69000701498334
2025-03-13 15:17:19,680 [INFO]: 	99p_search_speed_ms: 11.236235499382019
2025-03-13 15:17:19,680 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:19,680 [INFO]: 	nb vectors: 1879
2025-03-13 15:17:19,680 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:19,680 [INFO]: 	compression ratio: 0.9993086004207453
2025-03-13 15:17:19,680 [INFO]: }
2025-03-13 15:17:19,680 [INFO]: 	>>> Finished "Creating the index" in 48.6270 secs
2025-03-13 15:17:19,680 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6519 secs
2025-03-13 15:17:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 14569 [episode count 9/20]
[retrieval_preprocessing] for episode 76530 [episode count 10/20], we have num_retrieval=np.int64(1871) num_query=np.int64(110)
2025-03-13 15:17:20,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:21,041 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:21
2025-03-13 15:17:21,042 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 686.35it/s]
2025-03-13 15:17:21,074 [INFO]: There are 1871 embeddings of dim 49152
2025-03-13 15:17:21,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 15:17:21,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:21,076 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:17:21,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:21,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:17:21,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,077 [INFO]: 386.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:21,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:21,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:21
2025-03-13 15:17:21,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:21,078 [INFO]: 	Creating the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:21
2025-03-13 15:17:21,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:17:21,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,081 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:17:21,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.06it/s] 50%|█████     | 4/8 [00:00<00:00, 20.53it/s]100%|██████████| 8/8 [00:01<00:00,  4.30it/s]100%|██████████| 8/8 [00:01<00:00,  4.93it/s]
2025-03-13 15:17:22,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:22
2025-03-13 15:17:57,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2123 secs
2025-03-13 15:17:57,922 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:17:57,922 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 15:18:18,116 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1947 secs
2025-03-13 15:18:18,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0377 secs
2025-03-13 15:18:18,118 [INFO]: {
2025-03-13 15:18:18,118 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:18,118 [INFO]: 	index_param: efSearch=205
2025-03-13 15:18:18,118 [INFO]: 	index_path: knn.index
2025-03-13 15:18:18,118 [INFO]: 	size in bytes: 368107990
2025-03-13 15:18:18,118 [INFO]: 	avg_search_speed_ms: 8.546594497110917
2025-03-13 15:18:18,118 [INFO]: 	99p_search_speed_ms: 12.37080910708755
2025-03-13 15:18:18,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:18,118 [INFO]: 	nb vectors: 1871
2025-03-13 15:18:18,118 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:18,118 [INFO]: 	compression ratio: 0.9993088386916025
2025-03-13 15:18:18,118 [INFO]: }
2025-03-13 15:18:18,118 [INFO]: 	>>> Finished "Creating the index" in 57.0407 secs
2025-03-13 15:18:18,118 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0768 secs
2025-03-13 15:18:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 76530 [episode count 10/20]
[retrieval_preprocessing] for episode 38718 [episode count 11/20], we have num_retrieval=np.int64(1854) num_query=np.int64(127)
2025-03-13 15:18:19,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:19,358 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:19
2025-03-13 15:18:19,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2130.17it/s]
2025-03-13 15:18:19,383 [INFO]: There are 1854 embeddings of dim 49152
2025-03-13 15:18:19,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 15:18:19,383 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:19
2025-03-13 15:18:19,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:19,383 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:18:19,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:19,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:19,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:19
2025-03-13 15:18:19,383 [INFO]: 382.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:19,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:18:19,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:19
2025-03-13 15:18:19,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:19,384 [INFO]: 	Creating the index 03/13/2025, 15:18:19
2025-03-13 15:18:19,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:19
2025-03-13 15:18:19,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:18:19,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:19
2025-03-13 15:18:19,385 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:18:19,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.35it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.83it/s]100%|██████████| 8/8 [00:01<00:00,  5.54it/s]
2025-03-13 15:18:20,833 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:20
2025-03-13 15:18:53,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8849 secs
2025-03-13 15:18:53,718 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:18:53,718 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s]
2025-03-13 15:19:12,693 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9750 secs
2025-03-13 15:19:12,771 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3861 secs
2025-03-13 15:19:12,771 [INFO]: {
2025-03-13 15:19:12,771 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:12,772 [INFO]: 	index_param: efSearch=206
2025-03-13 15:19:12,772 [INFO]: 	index_path: knn.index
2025-03-13 15:19:12,772 [INFO]: 	size in bytes: 364763230
2025-03-13 15:19:12,772 [INFO]: 	avg_search_speed_ms: 8.977898492693527
2025-03-13 15:19:12,772 [INFO]: 	99p_search_speed_ms: 12.533782816026358
2025-03-13 15:19:12,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:12,772 [INFO]: 	nb vectors: 1854
2025-03-13 15:19:12,772 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:12,772 [INFO]: 	compression ratio: 0.999309146374211
2025-03-13 15:19:12,772 [INFO]: }
2025-03-13 15:19:12,772 [INFO]: 	>>> Finished "Creating the index" in 53.3885 secs
2025-03-13 15:19:12,772 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4141 secs
2025-03-13 15:19:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 38718 [episode count 11/20]
[retrieval_preprocessing] for episode 27014 [episode count 12/20], we have num_retrieval=np.int64(1900) num_query=np.int64(81)
2025-03-13 15:19:14,103 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:14,449 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:14
2025-03-13 15:19:14,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1049.63it/s]
2025-03-13 15:19:14,477 [INFO]: There are 1900 embeddings of dim 49152
2025-03-13 15:19:14,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:19:14,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:14,478 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:19:14,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:14,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:14,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,478 [INFO]: 392.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:14,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:19:14,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:14
2025-03-13 15:19:14,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:14,478 [INFO]: 	Creating the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:14
2025-03-13 15:19:14,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:19:14,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,479 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:19:14,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.55it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.40it/s]100%|██████████| 8/8 [00:01<00:00,  5.71it/s]
2025-03-13 15:19:15,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:15
2025-03-13 15:19:41,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9836 secs
2025-03-13 15:19:41,869 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:19:41,869 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.20it/s]
2025-03-13 15:20:00,334 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4646 secs
2025-03-13 15:20:00,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8568 secs
2025-03-13 15:20:00,336 [INFO]: {
2025-03-13 15:20:00,336 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:00,336 [INFO]: 	index_param: efSearch=209
2025-03-13 15:20:00,336 [INFO]: 	index_path: knn.index
2025-03-13 15:20:00,336 [INFO]: 	size in bytes: 373813690
2025-03-13 15:20:00,337 [INFO]: 	avg_search_speed_ms: 11.165214777065557
2025-03-13 15:20:00,337 [INFO]: 	99p_search_speed_ms: 17.204624216537923
2025-03-13 15:20:00,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:00,337 [INFO]: 	nb vectors: 1900
2025-03-13 15:20:00,337 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:00,337 [INFO]: 	compression ratio: 0.999308505796029
2025-03-13 15:20:00,337 [INFO]: }
2025-03-13 15:20:00,337 [INFO]: 	>>> Finished "Creating the index" in 45.8586 secs
2025-03-13 15:20:00,337 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8875 secs
2025-03-13 15:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 27014 [episode count 12/20]
[retrieval_preprocessing] for episode 409 [episode count 13/20], we have num_retrieval=np.int64(1889) num_query=np.int64(92)
2025-03-13 15:20:01,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:02,050 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:02
2025-03-13 15:20:02,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-13 15:20:02,078 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 15:20:02,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 15:20:02,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:02
2025-03-13 15:20:02,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:02,079 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:20:02,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:02,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:20:02,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:02
2025-03-13 15:20:02,079 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:02,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:20:02,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:02
2025-03-13 15:20:02,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:02,079 [INFO]: 	Creating the index 03/13/2025, 15:20:02
2025-03-13 15:20:02,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:02
2025-03-13 15:20:02,081 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:20:02,081 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:02
2025-03-13 15:20:02,082 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:20:02,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 15.49it/s] 75%|███████▌  | 6/8 [00:00<00:00, 25.16it/s]100%|██████████| 8/8 [00:01<00:00,  4.77it/s]
2025-03-13 15:20:03,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:03
2025-03-13 15:20:34,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7102 secs
2025-03-13 15:20:34,474 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:20:34,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 15:20:49,422 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9476 secs
2025-03-13 15:20:49,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3420 secs
2025-03-13 15:20:49,424 [INFO]: {
2025-03-13 15:20:49,424 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:49,424 [INFO]: 	index_param: efSearch=156
2025-03-13 15:20:49,424 [INFO]: 	index_path: knn.index
2025-03-13 15:20:49,424 [INFO]: 	size in bytes: 371649490
2025-03-13 15:20:49,424 [INFO]: 	avg_search_speed_ms: 6.729882426245306
2025-03-13 15:20:49,424 [INFO]: 	99p_search_speed_ms: 11.270879523362979
2025-03-13 15:20:49,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:49,424 [INFO]: 	nb vectors: 1889
2025-03-13 15:20:49,424 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:49,424 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 15:20:49,424 [INFO]: }
2025-03-13 15:20:49,424 [INFO]: 	>>> Finished "Creating the index" in 47.3451 secs
2025-03-13 15:20:49,424 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3747 secs
2025-03-13 15:20:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 409 [episode count 13/20]
[retrieval_preprocessing] for episode 60853 [episode count 14/20], we have num_retrieval=np.int64(1888) num_query=np.int64(93)
2025-03-13 15:20:50,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:50,538 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:50
2025-03-13 15:20:50,538 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 15:20:50,564 [INFO]: There are 1888 embeddings of dim 49152
2025-03-13 15:20:50,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:20:50,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:50
2025-03-13 15:20:50,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:50,564 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:20:50,564 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:50,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:50,564 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:50
2025-03-13 15:20:50,564 [INFO]: 389.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:50,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:20:50,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:50
2025-03-13 15:20:50,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:50,565 [INFO]: 	Creating the index 03/13/2025, 15:20:50
2025-03-13 15:20:50,565 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:50
2025-03-13 15:20:50,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:20:50,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:50
2025-03-13 15:20:50,566 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:20:50,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.52it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.93it/s]
2025-03-13 15:20:51,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:51
2025-03-13 15:21:19,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5792 secs
2025-03-13 15:21:19,498 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:21:19,498 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.54it/s]
2025-03-13 15:21:37,171 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6728 secs
2025-03-13 15:21:37,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6072 secs
2025-03-13 15:21:37,173 [INFO]: {
2025-03-13 15:21:37,173 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:37,173 [INFO]: 	index_param: efSearch=245
2025-03-13 15:21:37,173 [INFO]: 	index_path: knn.index
2025-03-13 15:21:37,173 [INFO]: 	size in bytes: 371452750
2025-03-13 15:21:37,173 [INFO]: 	avg_search_speed_ms: 10.7120222223093
2025-03-13 15:21:37,173 [INFO]: 	99p_search_speed_ms: 15.39083586540073
2025-03-13 15:21:37,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:37,174 [INFO]: 	nb vectors: 1888
2025-03-13 15:21:37,174 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:37,174 [INFO]: 	compression ratio: 0.9993085365500727
2025-03-13 15:21:37,174 [INFO]: }
2025-03-13 15:21:37,174 [INFO]: 	>>> Finished "Creating the index" in 46.6090 secs
2025-03-13 15:21:37,174 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6359 secs
2025-03-13 15:21:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 60853 [episode count 14/20]
[retrieval_preprocessing] for episode 83415 [episode count 15/20], we have num_retrieval=np.int64(1870) num_query=np.int64(111)
2025-03-13 15:21:38,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:39,023 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:39
2025-03-13 15:21:39,024 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.92it/s]
2025-03-13 15:21:39,054 [INFO]: There are 1870 embeddings of dim 49152
2025-03-13 15:21:39,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 15:21:39,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:39
2025-03-13 15:21:39,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:39,055 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:21:39,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:39,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:39,055 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:39
2025-03-13 15:21:39,055 [INFO]: 385.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:39,055 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:21:39,055 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:39
2025-03-13 15:21:39,055 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:39,055 [INFO]: 	Creating the index 03/13/2025, 15:21:39
2025-03-13 15:21:39,056 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:39
2025-03-13 15:21:39,057 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:21:39,057 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:39
2025-03-13 15:21:39,057 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:21:39,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.95it/s] 50%|█████     | 4/8 [00:00<00:00, 18.97it/s]100%|██████████| 8/8 [00:02<00:00,  3.25it/s]100%|██████████| 8/8 [00:02<00:00,  3.76it/s]
2025-03-13 15:21:41,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:41
2025-03-13 15:22:07,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2753 secs
2025-03-13 15:22:07,463 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 15:22:07,463 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 15:22:27,131 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6674 secs
2025-03-13 15:22:27,133 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0756 secs
2025-03-13 15:22:27,133 [INFO]: {
2025-03-13 15:22:27,133 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:27,133 [INFO]: 	index_param: efSearch=274
2025-03-13 15:22:27,133 [INFO]: 	index_path: knn.index
2025-03-13 15:22:27,133 [INFO]: 	size in bytes: 367911190
2025-03-13 15:22:27,133 [INFO]: 	avg_search_speed_ms: 10.498845784857494
2025-03-13 15:22:27,133 [INFO]: 	99p_search_speed_ms: 14.12345675751567
2025-03-13 15:22:27,133 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:27,133 [INFO]: 	nb vectors: 1870
2025-03-13 15:22:27,133 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:27,133 [INFO]: 	compression ratio: 0.9993089908464051
2025-03-13 15:22:27,133 [INFO]: }
2025-03-13 15:22:27,133 [INFO]: 	>>> Finished "Creating the index" in 48.0773 secs
2025-03-13 15:22:27,133 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1092 secs
2025-03-13 15:22:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 83415 [episode count 15/20]
[retrieval_preprocessing] for episode 42993 [episode count 16/20], we have num_retrieval=np.int64(1877) num_query=np.int64(104)
2025-03-13 15:22:28,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:28,780 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:28
2025-03-13 15:22:28,780 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.72it/s]
2025-03-13 15:22:28,805 [INFO]: There are 1877 embeddings of dim 49152
2025-03-13 15:22:28,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:22:28,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:28
2025-03-13 15:22:28,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:28,806 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:22:28,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:28,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:28,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:28
2025-03-13 15:22:28,806 [INFO]: 387.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:28,806 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:22:28,806 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:28
2025-03-13 15:22:28,806 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:28,806 [INFO]: 	Creating the index 03/13/2025, 15:22:28
2025-03-13 15:22:28,806 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:28
2025-03-13 15:22:28,807 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:22:28,807 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:28
2025-03-13 15:22:28,807 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:22:28,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.16it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.49it/s]100%|██████████| 8/8 [00:01<00:00,  6.00it/s]
2025-03-13 15:22:30,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:30
2025-03-13 15:23:00,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0696 secs
2025-03-13 15:23:00,214 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:23:00,214 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.01it/s]
2025-03-13 15:23:18,819 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6052 secs
2025-03-13 15:23:18,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0133 secs
2025-03-13 15:23:18,821 [INFO]: {
2025-03-13 15:23:18,821 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:18,821 [INFO]: 	index_param: efSearch=186
2025-03-13 15:23:18,821 [INFO]: 	index_path: knn.index
2025-03-13 15:23:18,821 [INFO]: 	size in bytes: 369288490
2025-03-13 15:23:18,821 [INFO]: 	avg_search_speed_ms: 9.743982520940229
2025-03-13 15:23:18,821 [INFO]: 	99p_search_speed_ms: 16.362636524718255
2025-03-13 15:23:18,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:18,821 [INFO]: 	nb vectors: 1877
2025-03-13 15:23:18,821 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:18,821 [INFO]: 	compression ratio: 0.9993087409791732
2025-03-13 15:23:18,821 [INFO]: }
2025-03-13 15:23:18,821 [INFO]: 	>>> Finished "Creating the index" in 50.0148 secs
2025-03-13 15:23:18,821 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0405 secs
2025-03-13 15:23:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 42993 [episode count 16/20]
[retrieval_preprocessing] for episode 84470 [episode count 17/20], we have num_retrieval=np.int64(1878) num_query=np.int64(103)
2025-03-13 15:23:19,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:20,088 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:20
2025-03-13 15:23:20,088 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1931.97it/s]
2025-03-13 15:23:20,114 [INFO]: There are 1878 embeddings of dim 49152
2025-03-13 15:23:20,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 15:23:20,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:20
2025-03-13 15:23:20,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:20,115 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:23:20,115 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:20,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:20,115 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:20
2025-03-13 15:23:20,115 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:20,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:23:20,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:20
2025-03-13 15:23:20,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:20,115 [INFO]: 	Creating the index 03/13/2025, 15:23:20
2025-03-13 15:23:20,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:20
2025-03-13 15:23:20,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:23:20,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:20
2025-03-13 15:23:20,116 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:23:20,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.64it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.13it/s]100%|██████████| 8/8 [00:01<00:00,  5.33it/s]
2025-03-13 15:23:21,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:21
2025-03-13 15:23:47,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7919 secs
2025-03-13 15:23:47,414 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 15:23:47,414 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.40it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 15:24:05,108 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6942 secs
2025-03-13 15:24:05,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9943 secs
2025-03-13 15:24:05,111 [INFO]: {
2025-03-13 15:24:05,111 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:05,111 [INFO]: 	index_param: efSearch=232
2025-03-13 15:24:05,111 [INFO]: 	index_path: knn.index
2025-03-13 15:24:05,111 [INFO]: 	size in bytes: 369485230
2025-03-13 15:24:05,111 [INFO]: 	avg_search_speed_ms: 10.647603125669482
2025-03-13 15:24:05,111 [INFO]: 	99p_search_speed_ms: 14.57887539640069
2025-03-13 15:24:05,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:05,111 [INFO]: 	nb vectors: 1878
2025-03-13 15:24:05,111 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:05,111 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-13 15:24:05,111 [INFO]: }
2025-03-13 15:24:05,111 [INFO]: 	>>> Finished "Creating the index" in 44.9960 secs
2025-03-13 15:24:05,111 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0232 secs
2025-03-13 15:24:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 84470 [episode count 17/20]
[retrieval_preprocessing] for episode 62811 [episode count 18/20], we have num_retrieval=np.int64(1883) num_query=np.int64(98)
2025-03-13 15:24:06,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:07,126 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:07
2025-03-13 15:24:07,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.58it/s]
2025-03-13 15:24:07,157 [INFO]: There are 1883 embeddings of dim 49152
2025-03-13 15:24:07,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:24:07,157 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:07
2025-03-13 15:24:07,157 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:07,157 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:24:07,157 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:07,157 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:07,157 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:07
2025-03-13 15:24:07,157 [INFO]: 388.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:07,157 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:24:07,157 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:07
2025-03-13 15:24:07,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:07,157 [INFO]: 	Creating the index 03/13/2025, 15:24:07
2025-03-13 15:24:07,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:07
2025-03-13 15:24:07,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:24:07,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:07
2025-03-13 15:24:07,159 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:24:07,159 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.89it/s] 62%|██████▎   | 5/8 [00:00<00:00, 22.40it/s]100%|██████████| 8/8 [00:01<00:00,  3.60it/s]100%|██████████| 8/8 [00:01<00:00,  4.32it/s]
2025-03-13 15:24:09,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:09
2025-03-13 15:24:40,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2974 secs
2025-03-13 15:24:40,311 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:24:40,311 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 15:24:59,520 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2089 secs
2025-03-13 15:24:59,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3631 secs
2025-03-13 15:24:59,522 [INFO]: {
2025-03-13 15:24:59,522 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:59,522 [INFO]: 	index_param: efSearch=212
2025-03-13 15:24:59,522 [INFO]: 	index_path: knn.index
2025-03-13 15:24:59,522 [INFO]: 	size in bytes: 370468990
2025-03-13 15:24:59,522 [INFO]: 	avg_search_speed_ms: 8.468366798193246
2025-03-13 15:24:59,522 [INFO]: 	99p_search_speed_ms: 11.488261865451934
2025-03-13 15:24:59,522 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:59,522 [INFO]: 	nb vectors: 1883
2025-03-13 15:24:59,522 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:59,522 [INFO]: 	compression ratio: 0.9993086438894656
2025-03-13 15:24:59,522 [INFO]: }
2025-03-13 15:24:59,522 [INFO]: 	>>> Finished "Creating the index" in 52.3647 secs
2025-03-13 15:24:59,522 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3965 secs
2025-03-13 15:24:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 62811 [episode count 18/20]
[retrieval_preprocessing] for episode 64370 [episode count 19/20], we have num_retrieval=np.int64(1865) num_query=np.int64(116)
2025-03-13 15:25:00,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:00,734 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:00
2025-03-13 15:25:00,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1024.00it/s]
2025-03-13 15:25:00,762 [INFO]: There are 1865 embeddings of dim 49152
2025-03-13 15:25:00,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 15:25:00,762 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:00
2025-03-13 15:25:00,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:00,762 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:25:00,762 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:00,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:00,762 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:00
2025-03-13 15:25:00,763 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:00,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:25:00,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:00
2025-03-13 15:25:00,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:00,763 [INFO]: 	Creating the index 03/13/2025, 15:25:00
2025-03-13 15:25:00,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:00
2025-03-13 15:25:00,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:00,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:00
2025-03-13 15:25:00,764 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:25:00,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.36it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.18it/s]100%|██████████| 8/8 [00:01<00:00,  6.02it/s]
2025-03-13 15:25:02,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:02
2025-03-13 15:25:30,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3933 secs
2025-03-13 15:25:30,489 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 15:25:30,489 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.01it/s]
2025-03-13 15:25:46,119 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6293 secs
2025-03-13 15:25:46,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3567 secs
2025-03-13 15:25:46,121 [INFO]: {
2025-03-13 15:25:46,121 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:46,121 [INFO]: 	index_param: efSearch=226
2025-03-13 15:25:46,121 [INFO]: 	index_path: knn.index
2025-03-13 15:25:46,121 [INFO]: 	size in bytes: 366927490
2025-03-13 15:25:46,121 [INFO]: 	avg_search_speed_ms: 10.71135548807928
2025-03-13 15:25:46,121 [INFO]: 	99p_search_speed_ms: 14.128812090493737
2025-03-13 15:25:46,121 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:46,121 [INFO]: 	nb vectors: 1865
2025-03-13 15:25:46,121 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:46,121 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-13 15:25:46,121 [INFO]: }
2025-03-13 15:25:46,121 [INFO]: 	>>> Finished "Creating the index" in 45.3583 secs
2025-03-13 15:25:46,121 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3873 secs
2025-03-13 15:25:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 64370 [episode count 19/20]
2025-03-13 15:25:47: [retrieval_preprocessing] finished for 3727693504_press_button_coffeemaker [chosen_id count 1/196]
2025-03-13 15:25:48: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3727693504_press_button_coffee_machine [chosen_id count 2/196]
2025-03-13 15:25:48: [retrieval_preprocessing] we have num_total=2232 embedding_dim=49152
[retrieval_preprocessing] for episode 3102 [episode count 0/20], we have num_retrieval=np.int64(2144) num_query=np.int64(88)
2025-03-13 15:25:48,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:48,794 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:48
2025-03-13 15:25:48,794 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.92it/s]
2025-03-13 15:25:49,391 [INFO]: There are 2144 embeddings of dim 49152
2025-03-13 15:25:49,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5976 secs
2025-03-13 15:25:49,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:49
2025-03-13 15:25:49,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:49,392 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:25:49,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:49,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:25:49,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:49
2025-03-13 15:25:49,393 [INFO]: 442.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:49,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:25:49,393 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:49
2025-03-13 15:25:49,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:49,393 [INFO]: 	Creating the index 03/13/2025, 15:25:49
2025-03-13 15:25:49,393 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:49
2025-03-13 15:25:49,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:25:49,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:49
2025-03-13 15:25:49,396 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:25:49,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.87it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.68it/s]100%|██████████| 9/9 [00:01<00:00,  4.14it/s]100%|██████████| 9/9 [00:01<00:00,  5.06it/s]
2025-03-13 15:25:51,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:51
2025-03-13 15:26:21,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4077 secs
2025-03-13 15:26:21,589 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:26:21,589 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.95it/s]
2025-03-13 15:26:36,685 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0954 secs
2025-03-13 15:26:36,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2912 secs
2025-03-13 15:26:36,687 [INFO]: {
2025-03-13 15:26:36,687 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:36,687 [INFO]: 	index_param: efSearch=265
2025-03-13 15:26:36,687 [INFO]: 	index_path: knn.index
2025-03-13 15:26:36,687 [INFO]: 	size in bytes: 421818970
2025-03-13 15:26:36,687 [INFO]: 	avg_search_speed_ms: 13.620412261637092
2025-03-13 15:26:36,687 [INFO]: 	99p_search_speed_ms: 20.551105798222114
2025-03-13 15:26:36,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:36,687 [INFO]: 	nb vectors: 2144
2025-03-13 15:26:36,687 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:36,687 [INFO]: 	compression ratio: 0.9993091396529653
2025-03-13 15:26:36,687 [INFO]: }
2025-03-13 15:26:36,687 [INFO]: 	>>> Finished "Creating the index" in 47.2943 secs
2025-03-13 15:26:36,687 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8933 secs
2025-03-13 15:26:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 3102 [episode count 0/20]
[retrieval_preprocessing] for episode 79410 [episode count 1/20], we have num_retrieval=np.int64(2144) num_query=np.int64(88)
2025-03-13 15:26:40,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:41,144 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:41
2025-03-13 15:26:41,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 15:26:41,175 [INFO]: There are 2144 embeddings of dim 49152
2025-03-13 15:26:41,175 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 15:26:41,175 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:41,175 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:26:41,175 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:41,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:41,175 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,176 [INFO]: 442.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:41,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:41,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:41
2025-03-13 15:26:41,176 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:41,176 [INFO]: 	Creating the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:41
2025-03-13 15:26:41,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:26:41,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,177 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:41,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.27it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.18it/s]100%|██████████| 9/9 [00:01<00:00,  4.57it/s]
2025-03-13 15:26:43,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:43
2025-03-13 15:27:14,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4525 secs
2025-03-13 15:27:14,605 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 15:27:14,605 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.50it/s]
2025-03-13 15:27:37,458 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8529 secs
2025-03-13 15:27:37,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2831 secs
2025-03-13 15:27:37,461 [INFO]: {
2025-03-13 15:27:37,461 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:37,461 [INFO]: 	index_param: efSearch=290
2025-03-13 15:27:37,461 [INFO]: 	index_path: knn.index
2025-03-13 15:27:37,461 [INFO]: 	size in bytes: 421818970
2025-03-13 15:27:37,461 [INFO]: 	avg_search_speed_ms: 11.41174480811764
2025-03-13 15:27:37,461 [INFO]: 	99p_search_speed_ms: 16.932556331157684
2025-03-13 15:27:37,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:37,461 [INFO]: 	nb vectors: 2144
2025-03-13 15:27:37,461 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:37,461 [INFO]: 	compression ratio: 0.9993091396529653
2025-03-13 15:27:37,461 [INFO]: }
2025-03-13 15:27:37,461 [INFO]: 	>>> Finished "Creating the index" in 56.2849 secs
2025-03-13 15:27:37,461 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3162 secs
2025-03-13 15:27:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 79410 [episode count 1/20]
[retrieval_preprocessing] for episode 60487 [episode count 2/20], we have num_retrieval=np.int64(2122) num_query=np.int64(110)
2025-03-13 15:27:38,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:38,938 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:38
2025-03-13 15:27:38,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.72it/s]
2025-03-13 15:27:38,964 [INFO]: There are 2122 embeddings of dim 49152
2025-03-13 15:27:38,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 15:27:38,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:38
2025-03-13 15:27:38,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:38,964 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:27:38,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:38,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:38,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:38
2025-03-13 15:27:38,965 [INFO]: 437.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:38,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:27:38,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:38
2025-03-13 15:27:38,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:38,965 [INFO]: 	Creating the index 03/13/2025, 15:27:38
2025-03-13 15:27:38,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:38
2025-03-13 15:27:38,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:27:38,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:38
2025-03-13 15:27:38,966 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:27:38,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.17it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.26it/s]100%|██████████| 9/9 [00:01<00:00,  5.55it/s]
2025-03-13 15:27:40,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:40
2025-03-13 15:28:24,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0538 secs
2025-03-13 15:28:24,644 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:28:24,645 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.80it/s]
2025-03-13 15:28:48,120 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4758 secs
2025-03-13 15:28:48,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1566 secs
2025-03-13 15:28:48,123 [INFO]: {
2025-03-13 15:28:48,123 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:48,123 [INFO]: 	index_param: efSearch=184
2025-03-13 15:28:48,123 [INFO]: 	index_path: knn.index
2025-03-13 15:28:48,123 [INFO]: 	size in bytes: 417490570
2025-03-13 15:28:48,123 [INFO]: 	avg_search_speed_ms: 9.080395793379855
2025-03-13 15:28:48,123 [INFO]: 	99p_search_speed_ms: 12.078676838427782
2025-03-13 15:28:48,123 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:48,123 [INFO]: 	nb vectors: 2122
2025-03-13 15:28:48,123 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:48,123 [INFO]: 	compression ratio: 0.9993092203256232
2025-03-13 15:28:48,123 [INFO]: }
2025-03-13 15:28:48,123 [INFO]: 	>>> Finished "Creating the index" in 69.1581 secs
2025-03-13 15:28:48,123 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1852 secs
2025-03-13 15:28:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 60487 [episode count 2/20]
[retrieval_preprocessing] for episode 38481 [episode count 3/20], we have num_retrieval=np.int64(2127) num_query=np.int64(105)
2025-03-13 15:28:49,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:49,655 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:49
2025-03-13 15:28:49,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.32it/s]
2025-03-13 15:28:49,686 [INFO]: There are 2127 embeddings of dim 49152
2025-03-13 15:28:49,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 15:28:49,687 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:49
2025-03-13 15:28:49,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:49,688 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:28:49,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:49,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:28:49,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:49
2025-03-13 15:28:49,688 [INFO]: 439.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:49,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:28:49,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:49
2025-03-13 15:28:49,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:49,689 [INFO]: 	Creating the index 03/13/2025, 15:28:49
2025-03-13 15:28:49,690 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:49
2025-03-13 15:28:49,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:28:49,693 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:49
2025-03-13 15:28:49,694 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:49,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.17it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.46it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]100%|██████████| 9/9 [00:02<00:00,  3.89it/s]
2025-03-13 15:28:52,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:52
2025-03-13 15:29:30,317 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3042 secs
2025-03-13 15:29:30,318 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:29:30,318 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.50it/s]
2025-03-13 15:29:54,649 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3313 secs
2025-03-13 15:29:54,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9576 secs
2025-03-13 15:29:54,651 [INFO]: {
2025-03-13 15:29:54,651 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:54,651 [INFO]: 	index_param: efSearch=186
2025-03-13 15:29:54,651 [INFO]: 	index_path: knn.index
2025-03-13 15:29:54,651 [INFO]: 	size in bytes: 418474270
2025-03-13 15:29:54,651 [INFO]: 	avg_search_speed_ms: 8.793851057404984
2025-03-13 15:29:54,651 [INFO]: 	99p_search_speed_ms: 12.259404631331563
2025-03-13 15:29:54,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:54,651 [INFO]: 	nb vectors: 2127
2025-03-13 15:29:54,652 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:54,652 [INFO]: 	compression ratio: 0.9993092669711808
2025-03-13 15:29:54,652 [INFO]: }
2025-03-13 15:29:54,652 [INFO]: 	>>> Finished "Creating the index" in 64.9620 secs
2025-03-13 15:29:54,652 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9965 secs
2025-03-13 15:29:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 38481 [episode count 3/20]
[retrieval_preprocessing] for episode 35422 [episode count 4/20], we have num_retrieval=np.int64(2115) num_query=np.int64(117)
2025-03-13 15:29:56,120 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:56,545 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:56
2025-03-13 15:29:56,545 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 15:29:56,570 [INFO]: There are 2115 embeddings of dim 49152
2025-03-13 15:29:56,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 15:29:56,571 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,571 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:56,571 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:29:56,571 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:56,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:29:56,571 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,571 [INFO]: 436.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:56,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:29:56,571 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:56
2025-03-13 15:29:56,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:56,571 [INFO]: 	Creating the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,571 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:56
2025-03-13 15:29:56,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:29:56,573 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,573 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:29:56,573 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.24it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.11it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-13 15:29:58,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:58
2025-03-13 15:30:36,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9612 secs
2025-03-13 15:30:36,677 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:30:36,677 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.54it/s]
2025-03-13 15:30:58,234 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5567 secs
2025-03-13 15:30:58,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6641 secs
2025-03-13 15:30:58,237 [INFO]: {
2025-03-13 15:30:58,237 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:58,237 [INFO]: 	index_param: efSearch=231
2025-03-13 15:30:58,237 [INFO]: 	index_path: knn.index
2025-03-13 15:30:58,237 [INFO]: 	size in bytes: 416113390
2025-03-13 15:30:58,237 [INFO]: 	avg_search_speed_ms: 9.978223668258941
2025-03-13 15:30:58,237 [INFO]: 	99p_search_speed_ms: 15.667592599056661
2025-03-13 15:30:58,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:58,237 [INFO]: 	nb vectors: 2115
2025-03-13 15:30:58,237 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:58,237 [INFO]: 	compression ratio: 0.999309154651332
2025-03-13 15:30:58,237 [INFO]: }
2025-03-13 15:30:58,237 [INFO]: 	>>> Finished "Creating the index" in 61.6661 secs
2025-03-13 15:30:58,237 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6921 secs
2025-03-13 15:30:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 35422 [episode count 4/20]
[retrieval_preprocessing] for episode 22139 [episode count 5/20], we have num_retrieval=np.int64(2143) num_query=np.int64(89)
2025-03-13 15:30:59,760 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:00,145 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:00
2025-03-13 15:31:00,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1344.76it/s]
2025-03-13 15:31:00,177 [INFO]: There are 2143 embeddings of dim 49152
2025-03-13 15:31:00,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 15:31:00,178 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:00
2025-03-13 15:31:00,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:00,178 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:31:00,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:00,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:31:00,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:00
2025-03-13 15:31:00,179 [INFO]: 442.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:00,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:31:00,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:00
2025-03-13 15:31:00,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:00,180 [INFO]: 	Creating the index 03/13/2025, 15:31:00
2025-03-13 15:31:00,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:00
2025-03-13 15:31:00,183 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:31:00,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:00
2025-03-13 15:31:00,184 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:31:00,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.15it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.77it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-13 15:31:02,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:02
2025-03-13 15:31:29,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7040 secs
2025-03-13 15:31:29,751 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 15:31:29,751 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-13 15:32:00,167 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4159 secs
2025-03-13 15:32:00,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9859 secs
2025-03-13 15:32:00,170 [INFO]: {
2025-03-13 15:32:00,170 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:00,170 [INFO]: 	index_param: efSearch=274
2025-03-13 15:32:00,170 [INFO]: 	index_path: knn.index
2025-03-13 15:32:00,170 [INFO]: 	size in bytes: 421622230
2025-03-13 15:32:00,170 [INFO]: 	avg_search_speed_ms: 13.550253305457996
2025-03-13 15:32:00,170 [INFO]: 	99p_search_speed_ms: 17.47014812193811
2025-03-13 15:32:00,170 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:00,170 [INFO]: 	nb vectors: 2143
2025-03-13 15:32:00,170 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:00,170 [INFO]: 	compression ratio: 0.9993091303558638
2025-03-13 15:32:00,170 [INFO]: }
2025-03-13 15:32:00,170 [INFO]: 	>>> Finished "Creating the index" in 59.9902 secs
2025-03-13 15:32:00,170 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0258 secs
2025-03-13 15:32:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 22139 [episode count 5/20]
[retrieval_preprocessing] for episode 35533 [episode count 6/20], we have num_retrieval=np.int64(2124) num_query=np.int64(108)
2025-03-13 15:32:02,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:02,691 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:02
2025-03-13 15:32:02,691 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.68it/s]
2025-03-13 15:32:02,733 [INFO]: There are 2124 embeddings of dim 49152
2025-03-13 15:32:02,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 15:32:02,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:02
2025-03-13 15:32:02,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:02,734 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:32:02,734 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:02,734 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:32:02,734 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:02
2025-03-13 15:32:02,735 [INFO]: 438.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:02,735 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:32:02,735 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:02
2025-03-13 15:32:02,735 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:02,736 [INFO]: 	Creating the index 03/13/2025, 15:32:02
2025-03-13 15:32:02,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:02
2025-03-13 15:32:02,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:32:02,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:02
2025-03-13 15:32:02,739 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:32:02,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.09it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.78it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.10it/s]100%|██████████| 9/9 [00:02<00:00,  2.34it/s]100%|██████████| 9/9 [00:02<00:00,  3.37it/s]
2025-03-13 15:32:05,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:05
2025-03-13 15:32:40,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5488 secs
2025-03-13 15:32:40,967 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:32:40,967 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 15:32:58,469 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5023 secs
2025-03-13 15:32:58,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7326 secs
2025-03-13 15:32:58,472 [INFO]: {
2025-03-13 15:32:58,472 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:58,472 [INFO]: 	index_param: efSearch=222
2025-03-13 15:32:58,472 [INFO]: 	index_path: knn.index
2025-03-13 15:32:58,472 [INFO]: 	size in bytes: 417884050
2025-03-13 15:32:58,472 [INFO]: 	avg_search_speed_ms: 11.06501595978419
2025-03-13 15:32:58,472 [INFO]: 	99p_search_speed_ms: 20.18015296896921
2025-03-13 15:32:58,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:58,472 [INFO]: 	nb vectors: 2124
2025-03-13 15:32:58,472 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:58,472 [INFO]: 	compression ratio: 0.9993092390101991
2025-03-13 15:32:58,472 [INFO]: }
2025-03-13 15:32:58,472 [INFO]: 	>>> Finished "Creating the index" in 55.7364 secs
2025-03-13 15:32:58,472 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7813 secs
2025-03-13 15:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 35533 [episode count 6/20]
[retrieval_preprocessing] for episode 44337 [episode count 7/20], we have num_retrieval=np.int64(2114) num_query=np.int64(118)
2025-03-13 15:33:00,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:01,436 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:01
2025-03-13 15:33:01,436 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.14it/s]
2025-03-13 15:33:01,463 [INFO]: There are 2114 embeddings of dim 49152
2025-03-13 15:33:01,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:33:01,463 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:01,464 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:33:01,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:01,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:01,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,464 [INFO]: 436.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:01,464 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:33:01,464 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:01
2025-03-13 15:33:01,464 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:01,464 [INFO]: 	Creating the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,464 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:01
2025-03-13 15:33:01,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:33:01,465 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,465 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:33:01,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.10it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.82it/s] 44%|████▍     | 4/9 [00:00<00:00, 10.45it/s] 67%|██████▋   | 6/9 [00:00<00:00, 11.06it/s] 89%|████████▉ | 8/9 [00:00<00:00, 13.19it/s]100%|██████████| 9/9 [00:02<00:00,  3.27it/s]
2025-03-13 15:33:04,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:04
2025-03-13 15:33:29,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7496 secs
2025-03-13 15:33:29,968 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 15:33:29,968 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 15:33:57,186 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2180 secs
2025-03-13 15:33:57,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0498 secs
2025-03-13 15:33:57,515 [INFO]: {
2025-03-13 15:33:57,515 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:57,515 [INFO]: 	index_param: efSearch=315
2025-03-13 15:33:57,516 [INFO]: 	index_path: knn.index
2025-03-13 15:33:57,516 [INFO]: 	size in bytes: 415916650
2025-03-13 15:33:57,516 [INFO]: 	avg_search_speed_ms: 10.796802483004223
2025-03-13 15:33:57,516 [INFO]: 	99p_search_speed_ms: 14.586858509574085
2025-03-13 15:33:57,516 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:57,516 [INFO]: 	nb vectors: 2114
2025-03-13 15:33:57,516 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:57,516 [INFO]: 	compression ratio: 0.9993091452337867
2025-03-13 15:33:57,516 [INFO]: }
2025-03-13 15:33:57,516 [INFO]: 	>>> Finished "Creating the index" in 56.0521 secs
2025-03-13 15:33:57,516 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0799 secs
2025-03-13 15:33:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 44337 [episode count 7/20]
[retrieval_preprocessing] for episode 89908 [episode count 8/20], we have num_retrieval=np.int64(2117) num_query=np.int64(115)
2025-03-13 15:33:59,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:00,177 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:00
2025-03-13 15:34:00,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1863.31it/s]
2025-03-13 15:34:00,206 [INFO]: There are 2117 embeddings of dim 49152
2025-03-13 15:34:00,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:34:00,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:00
2025-03-13 15:34:00,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:00,207 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:34:00,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:00,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:34:00,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:00
2025-03-13 15:34:00,208 [INFO]: 436.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:00,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:34:00,208 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:00
2025-03-13 15:34:00,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:00,208 [INFO]: 	Creating the index 03/13/2025, 15:34:00
2025-03-13 15:34:00,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:00
2025-03-13 15:34:00,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:34:00,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:00
2025-03-13 15:34:00,212 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:34:00,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.42it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.83it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.89it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.94it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.17it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.20it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.16it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.12it/s]100%|██████████| 9/9 [00:02<00:00,  1.91it/s]100%|██████████| 9/9 [00:02<00:00,  3.74it/s]
2025-03-13 15:34:02,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:02
2025-03-13 15:34:39,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3188 secs
2025-03-13 15:34:39,942 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 15:34:39,942 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 15:34:56,630 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6879 secs
2025-03-13 15:34:56,633 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4208 secs
2025-03-13 15:34:56,633 [INFO]: {
2025-03-13 15:34:56,633 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:56,633 [INFO]: 	index_param: efSearch=248
2025-03-13 15:34:56,633 [INFO]: 	index_path: knn.index
2025-03-13 15:34:56,633 [INFO]: 	size in bytes: 416506870
2025-03-13 15:34:56,633 [INFO]: 	avg_search_speed_ms: 10.184326614091995
2025-03-13 15:34:56,633 [INFO]: 	99p_search_speed_ms: 15.273243493866163
2025-03-13 15:34:56,633 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:56,633 [INFO]: 	nb vectors: 2117
2025-03-13 15:34:56,633 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:56,633 [INFO]: 	compression ratio: 0.9993091734597319
2025-03-13 15:34:56,633 [INFO]: }
2025-03-13 15:34:56,633 [INFO]: 	>>> Finished "Creating the index" in 56.4247 secs
2025-03-13 15:34:56,633 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4557 secs
2025-03-13 15:34:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 89908 [episode count 8/20]
[retrieval_preprocessing] for episode 74559 [episode count 9/20], we have num_retrieval=np.int64(2122) num_query=np.int64(110)
2025-03-13 15:34:58,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:59,320 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:59
2025-03-13 15:34:59,320 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 15:34:59,345 [INFO]: There are 2122 embeddings of dim 49152
2025-03-13 15:34:59,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 15:34:59,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:59
2025-03-13 15:34:59,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:59,345 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:34:59,345 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:59,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:59,345 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:59
2025-03-13 15:34:59,345 [INFO]: 437.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:59,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:59,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:59
2025-03-13 15:34:59,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:59,345 [INFO]: 	Creating the index 03/13/2025, 15:34:59
2025-03-13 15:34:59,346 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:59
2025-03-13 15:34:59,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:34:59,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:59
2025-03-13 15:34:59,347 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:34:59,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.89it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.51it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.24it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.64it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.71it/s]100%|██████████| 9/9 [00:02<00:00,  2.34it/s]100%|██████████| 9/9 [00:02<00:00,  3.96it/s]
2025-03-13 15:35:01,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:01
2025-03-13 15:35:32,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7917 secs
2025-03-13 15:35:32,415 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 15:35:32,415 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s]
2025-03-13 15:35:56,798 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3823 secs
2025-03-13 15:35:56,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4527 secs
2025-03-13 15:35:56,800 [INFO]: {
2025-03-13 15:35:56,800 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:56,800 [INFO]: 	index_param: efSearch=306
2025-03-13 15:35:56,800 [INFO]: 	index_path: knn.index
2025-03-13 15:35:56,800 [INFO]: 	size in bytes: 417490570
2025-03-13 15:35:56,800 [INFO]: 	avg_search_speed_ms: 10.20405739427031
2025-03-13 15:35:56,800 [INFO]: 	99p_search_speed_ms: 16.59651836613194
2025-03-13 15:35:56,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:56,800 [INFO]: 	nb vectors: 2122
2025-03-13 15:35:56,800 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:56,800 [INFO]: 	compression ratio: 0.9993092203256232
2025-03-13 15:35:56,800 [INFO]: }
2025-03-13 15:35:56,800 [INFO]: 	>>> Finished "Creating the index" in 57.4545 secs
2025-03-13 15:35:56,800 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4798 secs
2025-03-13 15:35:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 74559 [episode count 9/20]
[retrieval_preprocessing] for episode 74527 [episode count 10/20], we have num_retrieval=np.int64(2120) num_query=np.int64(112)
2025-03-13 15:35:58,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:58,972 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:58
2025-03-13 15:35:58,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1623.81it/s]
2025-03-13 15:35:59,012 [INFO]: There are 2120 embeddings of dim 49152
2025-03-13 15:35:59,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 15:35:59,013 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:59
2025-03-13 15:35:59,013 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:59,013 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:35:59,013 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:59,013 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:35:59,013 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:59
2025-03-13 15:35:59,014 [INFO]: 437.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:59,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:35:59,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:59
2025-03-13 15:35:59,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:59,014 [INFO]: 	Creating the index 03/13/2025, 15:35:59
2025-03-13 15:35:59,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:59
2025-03-13 15:35:59,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:35:59,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:59
2025-03-13 15:35:59,017 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:35:59,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.76it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.34it/s]100%|██████████| 9/9 [00:01<00:00,  4.99it/s]
2025-03-13 15:36:00,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:00
2025-03-13 15:36:40,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3926 secs
2025-03-13 15:36:40,220 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:36:40,221 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.41it/s] 50%|█████     | 2/4 [00:00<00:00,  4.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 15:37:02,534 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3128 secs
2025-03-13 15:37:02,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5198 secs
2025-03-13 15:37:02,537 [INFO]: {
2025-03-13 15:37:02,537 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:02,537 [INFO]: 	index_param: efSearch=201
2025-03-13 15:37:02,537 [INFO]: 	index_path: knn.index
2025-03-13 15:37:02,537 [INFO]: 	size in bytes: 417097090
2025-03-13 15:37:02,537 [INFO]: 	avg_search_speed_ms: 12.581280327208763
2025-03-13 15:37:02,537 [INFO]: 	99p_search_speed_ms: 17.542220042087138
2025-03-13 15:37:02,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:02,537 [INFO]: 	nb vectors: 2120
2025-03-13 15:37:02,537 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:02,537 [INFO]: 	compression ratio: 0.999309201605794
2025-03-13 15:37:02,537 [INFO]: }
2025-03-13 15:37:02,537 [INFO]: 	>>> Finished "Creating the index" in 63.5228 secs
2025-03-13 15:37:02,537 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5650 secs
2025-03-13 15:37:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 74527 [episode count 10/20]
[retrieval_preprocessing] for episode 90487 [episode count 11/20], we have num_retrieval=np.int64(2136) num_query=np.int64(96)
2025-03-13 15:37:05,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:06,360 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:06
2025-03-13 15:37:06,360 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.50it/s]
2025-03-13 15:37:06,394 [INFO]: There are 2136 embeddings of dim 49152
2025-03-13 15:37:06,395 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 15:37:06,395 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:06
2025-03-13 15:37:06,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:06,395 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:37:06,395 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:06,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:37:06,395 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:06
2025-03-13 15:37:06,395 [INFO]: 440.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:06,396 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:37:06,396 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:06
2025-03-13 15:37:06,396 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:06,396 [INFO]: 	Creating the index 03/13/2025, 15:37:06
2025-03-13 15:37:06,396 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:06
2025-03-13 15:37:06,397 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:37:06,397 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:06
2025-03-13 15:37:06,397 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:37:06,397 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.36it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.03it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]100%|██████████| 9/9 [00:02<00:00,  3.63it/s]
2025-03-13 15:37:08,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:08
2025-03-13 15:37:57,831 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9515 secs
2025-03-13 15:37:57,832 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 15:37:57,832 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 15:38:13,710 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8785 secs
2025-03-13 15:38:13,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3154 secs
2025-03-13 15:38:13,713 [INFO]: {
2025-03-13 15:38:13,713 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:13,713 [INFO]: 	index_param: efSearch=210
2025-03-13 15:38:13,713 [INFO]: 	index_path: knn.index
2025-03-13 15:38:13,713 [INFO]: 	size in bytes: 420244990
2025-03-13 15:38:13,713 [INFO]: 	avg_search_speed_ms: 10.996121353633539
2025-03-13 15:38:13,713 [INFO]: 	99p_search_speed_ms: 15.094402886461465
2025-03-13 15:38:13,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:13,713 [INFO]: 	nb vectors: 2136
2025-03-13 15:38:13,713 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:13,713 [INFO]: 	compression ratio: 0.9993092077076279
2025-03-13 15:38:13,713 [INFO]: }
2025-03-13 15:38:13,713 [INFO]: 	>>> Finished "Creating the index" in 67.3174 secs
2025-03-13 15:38:13,713 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3529 secs
2025-03-13 15:38:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 90487 [episode count 11/20]
[retrieval_preprocessing] for episode 5079 [episode count 12/20], we have num_retrieval=np.int64(2140) num_query=np.int64(92)
2025-03-13 15:38:15,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:16,599 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:16
2025-03-13 15:38:16,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 15:38:16,624 [INFO]: There are 2140 embeddings of dim 49152
2025-03-13 15:38:16,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:38:16,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:16
2025-03-13 15:38:16,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:16,624 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:38:16,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:16,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:16,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:16
2025-03-13 15:38:16,624 [INFO]: 441.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:16,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:16,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:16
2025-03-13 15:38:16,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:16,624 [INFO]: 	Creating the index 03/13/2025, 15:38:16
2025-03-13 15:38:16,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:16
2025-03-13 15:38:16,627 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:38:16,628 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:16
2025-03-13 15:38:16,628 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:38:16,628 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.99it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.79it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.36it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.74it/s]100%|██████████| 9/9 [00:02<00:00,  2.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.69it/s]
2025-03-13 15:38:19,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:19
2025-03-13 15:38:58,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3000 secs
2025-03-13 15:38:58,375 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 15:38:58,375 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.93it/s] 50%|█████     | 2/4 [00:01<00:02,  1.06s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.84s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.09s/it]
2025-03-13 15:39:33,595 [INFO]: 	>>> Finished "Compute fast metrics" in 35.2196 secs
2025-03-13 15:39:33,599 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9711 secs
2025-03-13 15:39:33,599 [INFO]: {
2025-03-13 15:39:33,599 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:33,599 [INFO]: 	index_param: efSearch=223
2025-03-13 15:39:33,599 [INFO]: 	index_path: knn.index
2025-03-13 15:39:33,599 [INFO]: 	size in bytes: 421032010
2025-03-13 15:39:33,599 [INFO]: 	avg_search_speed_ms: 8.823418571134106
2025-03-13 15:39:33,599 [INFO]: 	99p_search_speed_ms: 15.498237328138229
2025-03-13 15:39:33,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:33,599 [INFO]: 	nb vectors: 2140
2025-03-13 15:39:33,599 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:33,599 [INFO]: 	compression ratio: 0.999309102412427
2025-03-13 15:39:33,599 [INFO]: }
2025-03-13 15:39:33,599 [INFO]: 	>>> Finished "Creating the index" in 76.9749 secs
2025-03-13 15:39:33,599 [INFO]: >>> Finished "Launching the whole pipeline" in 77.0008 secs
2025-03-13 15:39:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 5079 [episode count 12/20]
[retrieval_preprocessing] for episode 24106 [episode count 13/20], we have num_retrieval=np.int64(2138) num_query=np.int64(94)
2025-03-13 15:39:35,363 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:35,800 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:35
2025-03-13 15:39:35,800 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.81it/s]
2025-03-13 15:39:35,840 [INFO]: There are 2138 embeddings of dim 49152
2025-03-13 15:39:35,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0401 secs
2025-03-13 15:39:35,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:35
2025-03-13 15:39:35,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:35,841 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:39:35,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:35,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:39:35,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:35
2025-03-13 15:39:35,842 [INFO]: 441.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:35,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:39:35,843 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:35
2025-03-13 15:39:35,843 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:39:35,843 [INFO]: 	Creating the index 03/13/2025, 15:39:35
2025-03-13 15:39:35,843 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:35
2025-03-13 15:39:35,847 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 15:39:35,847 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:35
2025-03-13 15:39:35,848 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:39:35,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.90it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.93it/s] 33%|███▎      | 3/9 [00:00<00:01,  3.77it/s] 44%|████▍     | 4/9 [00:01<00:01,  4.41it/s] 67%|██████▋   | 6/9 [00:01<00:00,  6.94it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.37it/s]
2025-03-13 15:39:38,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:38
2025-03-13 15:40:08,064 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5408 secs
2025-03-13 15:40:08,064 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 15:40:08,064 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 15:40:29,579 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5145 secs
2025-03-13 15:40:29,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7338 secs
2025-03-13 15:40:29,581 [INFO]: {
2025-03-13 15:40:29,581 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:29,581 [INFO]: 	index_param: efSearch=274
2025-03-13 15:40:29,582 [INFO]: 	index_path: knn.index
2025-03-13 15:40:29,582 [INFO]: 	size in bytes: 420638530
2025-03-13 15:40:29,582 [INFO]: 	avg_search_speed_ms: 9.296986807594733
2025-03-13 15:40:29,582 [INFO]: 	99p_search_speed_ms: 15.480375499464571
2025-03-13 15:40:29,582 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:29,582 [INFO]: 	nb vectors: 2138
2025-03-13 15:40:29,582 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:29,582 [INFO]: 	compression ratio: 0.9993090837399037
2025-03-13 15:40:29,582 [INFO]: }
2025-03-13 15:40:29,582 [INFO]: 	>>> Finished "Creating the index" in 53.7383 secs
2025-03-13 15:40:29,582 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7814 secs
2025-03-13 15:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 24106 [episode count 13/20]
[retrieval_preprocessing] for episode 70231 [episode count 14/20], we have num_retrieval=np.int64(2129) num_query=np.int64(103)
2025-03-13 15:40:31,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:32,046 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:32
2025-03-13 15:40:32,046 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.00it/s]
2025-03-13 15:40:32,075 [INFO]: There are 2129 embeddings of dim 49152
2025-03-13 15:40:32,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:40:32,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:32
2025-03-13 15:40:32,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:32,075 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:40:32,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:32,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:32,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:32
2025-03-13 15:40:32,076 [INFO]: 439.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:32,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:40:32,076 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:32
2025-03-13 15:40:32,076 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:32,076 [INFO]: 	Creating the index 03/13/2025, 15:40:32
2025-03-13 15:40:32,076 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:32
2025-03-13 15:40:32,077 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:40:32,077 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:32
2025-03-13 15:40:32,077 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:40:32,077 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.21it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.97it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.80it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.29it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.38it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.70it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.82it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.88it/s]100%|██████████| 9/9 [00:02<00:00,  2.09it/s]100%|██████████| 9/9 [00:02<00:00,  4.01it/s]
2025-03-13 15:40:34,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:34
2025-03-13 15:41:01,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7167 secs
2025-03-13 15:41:01,046 [INFO]: The best hyperparameters are: efSearch=312
2025-03-13 15:41:01,047 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.89it/s]
2025-03-13 15:41:21,966 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9192 secs
2025-03-13 15:41:21,968 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8910 secs
2025-03-13 15:41:21,968 [INFO]: {
2025-03-13 15:41:21,968 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:21,969 [INFO]: 	index_param: efSearch=312
2025-03-13 15:41:21,969 [INFO]: 	index_path: knn.index
2025-03-13 15:41:21,969 [INFO]: 	size in bytes: 418867750
2025-03-13 15:41:21,969 [INFO]: 	avg_search_speed_ms: 14.370199731462796
2025-03-13 15:41:21,969 [INFO]: 	99p_search_speed_ms: 26.243017101660296
2025-03-13 15:41:21,969 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:21,969 [INFO]: 	nb vectors: 2129
2025-03-13 15:41:21,969 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:21,969 [INFO]: 	compression ratio: 0.9993092855680582
2025-03-13 15:41:21,969 [INFO]: }
2025-03-13 15:41:21,969 [INFO]: 	>>> Finished "Creating the index" in 49.8928 secs
2025-03-13 15:41:21,969 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9227 secs
2025-03-13 15:41:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 70231 [episode count 14/20]
[retrieval_preprocessing] for episode 59524 [episode count 15/20], we have num_retrieval=np.int64(1945) num_query=np.int64(287)
2025-03-13 15:41:24,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:24,860 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:24
2025-03-13 15:41:24,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.74it/s]
2025-03-13 15:41:24,890 [INFO]: There are 1945 embeddings of dim 49152
2025-03-13 15:41:24,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:41:24,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:24
2025-03-13 15:41:24,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:24,890 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:41:24,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:24,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:41:24,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:24
2025-03-13 15:41:24,890 [INFO]: 401.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:24,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:41:24,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:24
2025-03-13 15:41:24,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:24,891 [INFO]: 	Creating the index 03/13/2025, 15:41:24
2025-03-13 15:41:24,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:24
2025-03-13 15:41:24,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:41:24,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:24
2025-03-13 15:41:24,892 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:41:24,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.29it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.48it/s] 50%|█████     | 4/8 [00:00<00:00,  8.89it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.50it/s]100%|██████████| 8/8 [00:02<00:00,  2.59it/s]100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
2025-03-13 15:41:27,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:27
2025-03-13 15:42:01,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0285 secs
2025-03-13 15:42:01,166 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 15:42:01,166 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 15:42:16,210 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0438 secs
2025-03-13 15:42:16,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3208 secs
2025-03-13 15:42:16,213 [INFO]: {
2025-03-13 15:42:16,213 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:16,213 [INFO]: 	index_param: efSearch=269
2025-03-13 15:42:16,213 [INFO]: 	index_path: knn.index
2025-03-13 15:42:16,213 [INFO]: 	size in bytes: 382667170
2025-03-13 15:42:16,213 [INFO]: 	avg_search_speed_ms: 9.511493139108953
2025-03-13 15:42:16,213 [INFO]: 	99p_search_speed_ms: 12.493491522036493
2025-03-13 15:42:16,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:16,213 [INFO]: 	nb vectors: 1945
2025-03-13 15:42:16,213 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:16,213 [INFO]: 	compression ratio: 0.9993085113624981
2025-03-13 15:42:16,213 [INFO]: }
2025-03-13 15:42:16,213 [INFO]: 	>>> Finished "Creating the index" in 51.3224 secs
2025-03-13 15:42:16,213 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3527 secs
2025-03-13 15:42:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 59524 [episode count 15/20]
[retrieval_preprocessing] for episode 34997 [episode count 16/20], we have num_retrieval=np.int64(2141) num_query=np.int64(91)
2025-03-13 15:42:19,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:20,400 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:20
2025-03-13 15:42:20,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.22it/s]
2025-03-13 15:42:20,424 [INFO]: There are 2141 embeddings of dim 49152
2025-03-13 15:42:20,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 15:42:20,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:20
2025-03-13 15:42:20,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:20,424 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:42:20,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:20,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:20,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:20
2025-03-13 15:42:20,424 [INFO]: 441.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:20,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:42:20,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:20
2025-03-13 15:42:20,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:20,425 [INFO]: 	Creating the index 03/13/2025, 15:42:20
2025-03-13 15:42:20,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:20
2025-03-13 15:42:20,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:42:20,425 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:20
2025-03-13 15:42:20,426 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:42:20,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.97it/s] 22%|██▏       | 2/9 [00:00<00:01,  4.25it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.36it/s] 44%|████▍     | 4/9 [00:00<00:00,  5.97it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.45it/s] 67%|██████▋   | 6/9 [00:01<00:00,  6.43it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.09it/s] 89%|████████▉ | 8/9 [00:01<00:00,  6.60it/s]100%|██████████| 9/9 [00:03<00:00,  1.57it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
2025-03-13 15:42:23,478 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:23
2025-03-13 15:42:52,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2318 secs
2025-03-13 15:42:52,710 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 15:42:52,710 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 15:43:18,612 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9014 secs
2025-03-13 15:43:18,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1881 secs
2025-03-13 15:43:18,614 [INFO]: {
2025-03-13 15:43:18,614 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:18,614 [INFO]: 	index_param: efSearch=296
2025-03-13 15:43:18,614 [INFO]: 	index_path: knn.index
2025-03-13 15:43:18,614 [INFO]: 	size in bytes: 421228750
2025-03-13 15:43:18,614 [INFO]: 	avg_search_speed_ms: 10.45911219268141
2025-03-13 15:43:18,614 [INFO]: 	99p_search_speed_ms: 14.179599715862425
2025-03-13 15:43:18,614 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:18,614 [INFO]: 	nb vectors: 2141
2025-03-13 15:43:18,614 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:18,614 [INFO]: 	compression ratio: 0.9993091117356069
2025-03-13 15:43:18,614 [INFO]: }
2025-03-13 15:43:18,614 [INFO]: 	>>> Finished "Creating the index" in 58.1894 secs
2025-03-13 15:43:18,614 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2139 secs
2025-03-13 15:43:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 34997 [episode count 16/20]
[retrieval_preprocessing] for episode 14064 [episode count 17/20], we have num_retrieval=np.int64(2107) num_query=np.int64(125)
2025-03-13 15:43:20,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:20,884 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:20
2025-03-13 15:43:20,884 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.58it/s]
2025-03-13 15:43:21,327 [INFO]: There are 2107 embeddings of dim 49152
2025-03-13 15:43:21,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4440 secs
2025-03-13 15:43:21,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:21
2025-03-13 15:43:21,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:21,328 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:43:21,328 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:21,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:43:21,328 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:21
2025-03-13 15:43:21,329 [INFO]: 434.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:21,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:43:21,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:21
2025-03-13 15:43:21,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:21,329 [INFO]: 	Creating the index 03/13/2025, 15:43:21
2025-03-13 15:43:21,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:21
2025-03-13 15:43:21,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:43:21,331 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:21
2025-03-13 15:43:21,332 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:43:21,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.67it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.86it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.43it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.83it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.01it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.13it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.19it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.26it/s]100%|██████████| 9/9 [00:03<00:00,  1.08it/s]100%|██████████| 9/9 [00:03<00:00,  2.35it/s]
2025-03-13 15:43:25,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:25
2025-03-13 15:43:59,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6672 secs
2025-03-13 15:43:59,842 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 15:43:59,842 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 15:44:25,707 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8655 secs
2025-03-13 15:44:25,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3777 secs
2025-03-13 15:44:25,709 [INFO]: {
2025-03-13 15:44:25,709 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:25,709 [INFO]: 	index_param: efSearch=259
2025-03-13 15:44:25,709 [INFO]: 	index_path: knn.index
2025-03-13 15:44:25,709 [INFO]: 	size in bytes: 414539470
2025-03-13 15:44:25,709 [INFO]: 	avg_search_speed_ms: 8.692718251486836
2025-03-13 15:44:25,709 [INFO]: 	99p_search_speed_ms: 11.751899824012071
2025-03-13 15:44:25,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:25,709 [INFO]: 	nb vectors: 2107
2025-03-13 15:44:25,709 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:25,709 [INFO]: 	compression ratio: 0.9993090790606742
2025-03-13 15:44:25,709 [INFO]: }
2025-03-13 15:44:25,709 [INFO]: 	>>> Finished "Creating the index" in 64.3804 secs
2025-03-13 15:44:25,709 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8258 secs
2025-03-13 15:44:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 14064 [episode count 17/20]
[retrieval_preprocessing] for episode 89965 [episode count 18/20], we have num_retrieval=np.int64(2151) num_query=np.int64(81)
2025-03-13 15:44:27,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:28,595 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:28
2025-03-13 15:44:28,595 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2062.10it/s]
2025-03-13 15:44:28,620 [INFO]: There are 2151 embeddings of dim 49152
2025-03-13 15:44:28,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:44:28,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:28
2025-03-13 15:44:28,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:28,620 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:44:28,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:28,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:28,620 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:28
2025-03-13 15:44:28,621 [INFO]: 443.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:28,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:44:28,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:28
2025-03-13 15:44:28,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:28,621 [INFO]: 	Creating the index 03/13/2025, 15:44:28
2025-03-13 15:44:28,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:28
2025-03-13 15:44:28,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:44:28,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:28
2025-03-13 15:44:28,622 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:44:28,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.81it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.39it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.41it/s] 67%|██████▋   | 6/9 [00:00<00:00, 11.18it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.87it/s]100%|██████████| 9/9 [00:02<00:00,  4.20it/s]
2025-03-13 15:44:30,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:30
2025-03-13 15:44:56,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4113 secs
2025-03-13 15:44:56,179 [INFO]: The best hyperparameters are: efSearch=332
2025-03-13 15:44:56,179 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 15:45:18,899 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7204 secs
2025-03-13 15:45:18,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2797 secs
2025-03-13 15:45:18,902 [INFO]: {
2025-03-13 15:45:18,902 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:18,902 [INFO]: 	index_param: efSearch=332
2025-03-13 15:45:18,902 [INFO]: 	index_path: knn.index
2025-03-13 15:45:18,902 [INFO]: 	size in bytes: 423196150
2025-03-13 15:45:18,902 [INFO]: 	avg_search_speed_ms: 13.51085222733437
2025-03-13 15:45:18,902 [INFO]: 	99p_search_speed_ms: 25.098229665309198
2025-03-13 15:45:18,902 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:18,902 [INFO]: 	nb vectors: 2151
2025-03-13 15:45:18,902 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:18,902 [INFO]: 	compression ratio: 0.9993092044906363
2025-03-13 15:45:18,902 [INFO]: }
2025-03-13 15:45:18,902 [INFO]: 	>>> Finished "Creating the index" in 50.2812 secs
2025-03-13 15:45:18,902 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3069 secs
2025-03-13 15:45:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 89965 [episode count 18/20]
[retrieval_preprocessing] for episode 79526 [episode count 19/20], we have num_retrieval=np.int64(2129) num_query=np.int64(103)
2025-03-13 15:45:20,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:20,877 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:20
2025-03-13 15:45:20,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.57it/s]
2025-03-13 15:45:20,905 [INFO]: There are 2129 embeddings of dim 49152
2025-03-13 15:45:20,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:45:20,905 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:20
2025-03-13 15:45:20,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:20,906 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:45:20,906 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:20,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:45:20,906 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:20
2025-03-13 15:45:20,906 [INFO]: 439.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:20,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:45:20,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:20
2025-03-13 15:45:20,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:20,906 [INFO]: 	Creating the index 03/13/2025, 15:45:20
2025-03-13 15:45:20,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:20
2025-03-13 15:45:20,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:45:20,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:20
2025-03-13 15:45:20,909 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:45:20,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.07it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.86it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.82it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.39it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.77it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.10it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.41it/s]100%|██████████| 9/9 [00:02<00:00,  2.32it/s]100%|██████████| 9/9 [00:02<00:00,  3.64it/s]
2025-03-13 15:45:23,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:23
2025-03-13 15:45:57,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1200 secs
2025-03-13 15:45:57,504 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 15:45:57,504 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 15:46:13,269 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7648 secs
2025-03-13 15:46:13,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3621 secs
2025-03-13 15:46:13,271 [INFO]: {
2025-03-13 15:46:13,271 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:13,271 [INFO]: 	index_param: efSearch=257
2025-03-13 15:46:13,271 [INFO]: 	index_path: knn.index
2025-03-13 15:46:13,271 [INFO]: 	size in bytes: 418867750
2025-03-13 15:46:13,271 [INFO]: 	avg_search_speed_ms: 11.029493870252647
2025-03-13 15:46:13,271 [INFO]: 	99p_search_speed_ms: 16.169910584576428
2025-03-13 15:46:13,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:13,271 [INFO]: 	nb vectors: 2129
2025-03-13 15:46:13,271 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:13,271 [INFO]: 	compression ratio: 0.9993092855680582
2025-03-13 15:46:13,271 [INFO]: }
2025-03-13 15:46:13,271 [INFO]: 	>>> Finished "Creating the index" in 52.3651 secs
2025-03-13 15:46:13,271 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3940 secs
2025-03-13 15:46:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 79526 [episode count 19/20]
2025-03-13 15:46:14: [retrieval_preprocessing] finished for 3727693504_press_button_coffee_machine [chosen_id count 2/196]
2025-03-13 15:46:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3774560981_put_towel_in_black_box [chosen_id count 3/196]
2025-03-13 15:46:21: [retrieval_preprocessing] we have num_total=8829 embedding_dim=49152
[retrieval_preprocessing] for episode 17921 [episode count 0/20], we have num_retrieval=np.int64(8515) num_query=np.int64(314)
2025-03-13 15:46:25,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:26,943 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:26
2025-03-13 15:46:26,943 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-13 15:46:26,968 [INFO]: There are 8515 embeddings of dim 49152
2025-03-13 15:46:26,969 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:46:26,969 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:26
2025-03-13 15:46:26,969 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:26,969 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 15:46:26,969 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:26,969 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:26,969 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:26
2025-03-13 15:46:26,969 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:26,969 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:46:26,969 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:26
2025-03-13 15:46:26,969 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:26,969 [INFO]: 	Creating the index 03/13/2025, 15:46:26
2025-03-13 15:46:26,969 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:26
2025-03-13 15:46:26,970 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:46:26,970 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:26
2025-03-13 15:46:26,971 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 15:46:26,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.03it/s]  9%|▊         | 3/35 [00:00<00:03,  8.25it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.30it/s] 20%|██        | 7/35 [00:00<00:02,  9.96it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.28it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.61it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.98it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.08it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.98it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.16it/s] 60%|██████    | 21/35 [00:06<00:10,  1.38it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.88it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.49it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.87it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.35it/s] 80%|████████  | 28/35 [00:06<00:01,  3.92it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.54it/s] 86%|████████▌ | 30/35 [00:07<00:00,  5.26it/s] 89%|████████▊ | 31/35 [00:07<00:00,  6.00it/s] 94%|█████████▍| 33/35 [00:07<00:00,  7.38it/s]100%|██████████| 35/35 [00:11<00:00,  1.12it/s]100%|██████████| 35/35 [00:11<00:00,  3.03it/s]
2025-03-13 15:46:38,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:38
2025-03-13 15:48:12,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 94.1881 secs
2025-03-13 15:48:12,725 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:48:12,725 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.77it/s]
2025-03-13 15:49:10,777 [INFO]: 	>>> Finished "Compute fast metrics" in 58.0516 secs
2025-03-13 15:49:10,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.8097 secs
2025-03-13 15:49:10,780 [INFO]: {
2025-03-13 15:49:10,780 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:10,780 [INFO]: 	index_param: efSearch=158
2025-03-13 15:49:10,780 [INFO]: 	index_path: knn.index
2025-03-13 15:49:10,780 [INFO]: 	size in bytes: 1675275850
2025-03-13 15:49:10,780 [INFO]: 	avg_search_speed_ms: 10.335556278341981
2025-03-13 15:49:10,781 [INFO]: 	99p_search_speed_ms: 20.030475235544145
2025-03-13 15:49:10,781 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:10,781 [INFO]: 	nb vectors: 8515
2025-03-13 15:49:10,781 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:10,781 [INFO]: 	compression ratio: 0.9993083348034892
2025-03-13 15:49:10,781 [INFO]: }
2025-03-13 15:49:10,781 [INFO]: 	>>> Finished "Creating the index" in 163.8113 secs
2025-03-13 15:49:10,781 [INFO]: >>> Finished "Launching the whole pipeline" in 163.8376 secs
2025-03-13 15:49:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 17921 [episode count 0/20]
[retrieval_preprocessing] for episode 53773 [episode count 1/20], we have num_retrieval=np.int64(8532) num_query=np.int64(297)
2025-03-13 15:49:18,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:19,864 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:19
2025-03-13 15:49:19,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.18it/s]
2025-03-13 15:49:19,892 [INFO]: There are 8532 embeddings of dim 49152
2025-03-13 15:49:19,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 15:49:19,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:19
2025-03-13 15:49:19,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:19,893 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 15:49:19,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:19,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:19,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:19
2025-03-13 15:49:19,893 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:19,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:49:19,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:19
2025-03-13 15:49:19,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:19,893 [INFO]: 	Creating the index 03/13/2025, 15:49:19
2025-03-13 15:49:19,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:19
2025-03-13 15:49:19,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:49:19,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:19
2025-03-13 15:49:19,894 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 15:49:19,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  4.21it/s]  9%|▊         | 3/35 [00:00<00:04,  7.50it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.09it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.51it/s] 20%|██        | 7/35 [00:00<00:02, 10.31it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.49it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.89it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.64it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.75it/s] 49%|████▊     | 17/35 [00:01<00:01,  9.90it/s] 54%|█████▍    | 19/35 [00:02<00:01,  8.71it/s] 57%|█████▋    | 20/35 [00:02<00:01,  8.17it/s] 60%|██████    | 21/35 [00:07<00:16,  1.20s/it] 63%|██████▎   | 22/35 [00:07<00:12,  1.05it/s] 66%|██████▌   | 23/35 [00:07<00:09,  1.33it/s] 69%|██████▊   | 24/35 [00:07<00:06,  1.71it/s] 71%|███████▏  | 25/35 [00:07<00:04,  2.16it/s] 74%|███████▍  | 26/35 [00:08<00:03,  2.74it/s] 77%|███████▋  | 27/35 [00:08<00:02,  3.39it/s] 80%|████████  | 28/35 [00:08<00:01,  4.09it/s] 83%|████████▎ | 29/35 [00:08<00:01,  4.72it/s] 86%|████████▌ | 30/35 [00:08<00:00,  5.29it/s] 89%|████████▊ | 31/35 [00:08<00:00,  5.84it/s] 91%|█████████▏| 32/35 [00:08<00:00,  6.27it/s] 94%|█████████▍| 33/35 [00:08<00:00,  6.63it/s] 97%|█████████▋| 34/35 [00:09<00:00,  7.00it/s]100%|██████████| 35/35 [00:13<00:00,  1.32s/it]100%|██████████| 35/35 [00:13<00:00,  2.65it/s]
2025-03-13 15:49:33,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:33
2025-03-13 15:50:40,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.9353 secs
2025-03-13 15:50:40,042 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 15:50:40,042 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 15:51:24,549 [INFO]: 	>>> Finished "Compute fast metrics" in 44.5072 secs
2025-03-13 15:51:24,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.6580 secs
2025-03-13 15:51:24,553 [INFO]: {
2025-03-13 15:51:24,553 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:24,553 [INFO]: 	index_param: efSearch=166
2025-03-13 15:51:24,553 [INFO]: 	index_path: knn.index
2025-03-13 15:51:24,553 [INFO]: 	size in bytes: 1678620430
2025-03-13 15:51:24,553 [INFO]: 	avg_search_speed_ms: 10.946216606596154
2025-03-13 15:51:24,553 [INFO]: 	99p_search_speed_ms: 30.29260143870488
2025-03-13 15:51:24,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:24,553 [INFO]: 	nb vectors: 8532
2025-03-13 15:51:24,553 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:24,553 [INFO]: 	compression ratio: 0.9993083761050138
2025-03-13 15:51:24,553 [INFO]: }
2025-03-13 15:51:24,553 [INFO]: 	>>> Finished "Creating the index" in 124.6598 secs
2025-03-13 15:51:24,553 [INFO]: >>> Finished "Launching the whole pipeline" in 124.6890 secs
2025-03-13 15:51:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 53773 [episode count 1/20]
[retrieval_preprocessing] for episode 79381 [episode count 2/20], we have num_retrieval=np.int64(8424) num_query=np.int64(405)
2025-03-13 15:51:29,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:30,950 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:30
2025-03-13 15:51:30,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-13 15:51:30,975 [INFO]: There are 8424 embeddings of dim 49152
2025-03-13 15:51:30,975 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 15:51:30,975 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:30
2025-03-13 15:51:30,975 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:30,975 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:51:30,975 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:30,975 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:30,975 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:30
2025-03-13 15:51:30,976 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:30,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:51:30,976 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:30
2025-03-13 15:51:30,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:30,976 [INFO]: 	Creating the index 03/13/2025, 15:51:30
2025-03-13 15:51:30,976 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:30
2025-03-13 15:51:30,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:51:30,977 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:30
2025-03-13 15:51:30,977 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:51:30,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.08it/s]  9%|▊         | 3/35 [00:00<00:03, 10.61it/s] 14%|█▍        | 5/35 [00:00<00:02, 12.77it/s] 20%|██        | 7/35 [00:00<00:01, 14.01it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.91it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.18it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.95it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.78it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.58it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.38it/s] 60%|██████    | 21/35 [00:05<00:10,  1.37it/s] 63%|██████▎   | 22/35 [00:06<00:08,  1.62it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.28it/s] 74%|███████▍  | 26/35 [00:10<00:09,  1.04s/it] 77%|███████▋  | 27/35 [00:12<00:08,  1.08s/it] 80%|████████  | 28/35 [00:12<00:06,  1.09it/s] 83%|████████▎ | 29/35 [00:12<00:04,  1.23it/s] 86%|████████▌ | 30/35 [00:13<00:03,  1.27it/s] 89%|████████▊ | 31/35 [00:13<00:02,  1.49it/s] 91%|█████████▏| 32/35 [00:14<00:01,  1.61it/s] 94%|█████████▍| 33/35 [00:14<00:01,  1.88it/s] 97%|█████████▋| 34/35 [00:14<00:00,  2.30it/s]100%|██████████| 35/35 [00:18<00:00,  1.46s/it]100%|██████████| 35/35 [00:18<00:00,  1.86it/s]
2025-03-13 15:51:50,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:50
2025-03-13 15:53:17,412 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.2389 secs
2025-03-13 15:53:17,412 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:53:17,412 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 15:53:54,035 [INFO]: 	>>> Finished "Compute fast metrics" in 36.6227 secs
2025-03-13 15:53:54,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.0631 secs
2025-03-13 15:53:54,040 [INFO]: {
2025-03-13 15:53:54,040 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:54,040 [INFO]: 	index_param: efSearch=212
2025-03-13 15:53:54,040 [INFO]: 	index_path: knn.index
2025-03-13 15:53:54,040 [INFO]: 	size in bytes: 1657372090
2025-03-13 15:53:54,040 [INFO]: 	avg_search_speed_ms: 14.13662712212052
2025-03-13 15:53:54,040 [INFO]: 	99p_search_speed_ms: 28.006614085752513
2025-03-13 15:53:54,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:54,040 [INFO]: 	nb vectors: 8424
2025-03-13 15:53:54,040 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:54,040 [INFO]: 	compression ratio: 0.9993083641223861
2025-03-13 15:53:54,040 [INFO]: }
2025-03-13 15:53:54,040 [INFO]: 	>>> Finished "Creating the index" in 143.0646 secs
2025-03-13 15:53:54,040 [INFO]: >>> Finished "Launching the whole pipeline" in 143.0900 secs
2025-03-13 15:53:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 79381 [episode count 2/20]
[retrieval_preprocessing] for episode 63515 [episode count 3/20], we have num_retrieval=np.int64(8516) num_query=np.int64(313)
2025-03-13 15:54:01,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:02,677 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:02
2025-03-13 15:54:02,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 913.19it/s]
2025-03-13 15:54:02,704 [INFO]: There are 8516 embeddings of dim 49152
2025-03-13 15:54:02,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:54:02,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:02
2025-03-13 15:54:02,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:02,705 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 15:54:02,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:02,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:02,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:02
2025-03-13 15:54:02,705 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:02,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:02,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:02
2025-03-13 15:54:02,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:02,705 [INFO]: 	Creating the index 03/13/2025, 15:54:02
2025-03-13 15:54:02,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:02
2025-03-13 15:54:02,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:54:02,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:02
2025-03-13 15:54:02,706 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 15:54:02,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  4.25it/s]  9%|▊         | 3/35 [00:00<00:04,  7.41it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.88it/s] 20%|██        | 7/35 [00:00<00:02,  9.65it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.02it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.26it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.30it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.04it/s] 49%|████▊     | 17/35 [00:01<00:01,  9.89it/s] 51%|█████▏    | 18/35 [00:01<00:01,  9.74it/s] 54%|█████▍    | 19/35 [00:01<00:01,  9.71it/s] 57%|█████▋    | 20/35 [00:02<00:01,  9.53it/s] 60%|██████    | 21/35 [00:05<00:14,  1.02s/it] 63%|██████▎   | 22/35 [00:06<00:10,  1.28it/s] 69%|██████▊   | 24/35 [00:06<00:05,  2.05it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.50it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.67it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.86it/s] 89%|████████▊ | 31/35 [00:06<00:00,  6.19it/s] 94%|█████████▍| 33/35 [00:06<00:00,  7.21it/s]100%|██████████| 35/35 [00:11<00:00,  1.27it/s]100%|██████████| 35/35 [00:11<00:00,  3.09it/s]
2025-03-13 15:54:14,054 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:14
2025-03-13 15:55:28,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.4281 secs
2025-03-13 15:55:28,483 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:55:28,483 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 15:56:07,605 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1221 secs
2025-03-13 15:56:07,609 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.9022 secs
2025-03-13 15:56:07,609 [INFO]: {
2025-03-13 15:56:07,609 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:07,609 [INFO]: 	index_param: efSearch=229
2025-03-13 15:56:07,609 [INFO]: 	index_path: knn.index
2025-03-13 15:56:07,609 [INFO]: 	size in bytes: 1675472590
2025-03-13 15:56:07,609 [INFO]: 	avg_search_speed_ms: 16.316590666220954
2025-03-13 15:56:07,609 [INFO]: 	99p_search_speed_ms: 30.97678633406758
2025-03-13 15:56:07,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:07,609 [INFO]: 	nb vectors: 8516
2025-03-13 15:56:07,609 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:07,609 [INFO]: 	compression ratio: 0.9993083372375552
2025-03-13 15:56:07,609 [INFO]: }
2025-03-13 15:56:07,609 [INFO]: 	>>> Finished "Creating the index" in 124.9038 secs
2025-03-13 15:56:07,609 [INFO]: >>> Finished "Launching the whole pipeline" in 124.9321 secs
2025-03-13 15:56:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 63515 [episode count 3/20]
[retrieval_preprocessing] for episode 55842 [episode count 4/20], we have num_retrieval=np.int64(8358) num_query=np.int64(471)
2025-03-13 15:56:18,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:20,038 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:20
2025-03-13 15:56:20,038 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.18it/s]
2025-03-13 15:56:20,065 [INFO]: There are 8358 embeddings of dim 49152
2025-03-13 15:56:20,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:56:20,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:20
2025-03-13 15:56:20,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:20,065 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:56:20,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:20,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:20,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:20
2025-03-13 15:56:20,066 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:20,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:56:20,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:20
2025-03-13 15:56:20,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:20,066 [INFO]: 	Creating the index 03/13/2025, 15:56:20
2025-03-13 15:56:20,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:20
2025-03-13 15:56:20,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:56:20,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:20
2025-03-13 15:56:20,067 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:56:20,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:08,  3.74it/s]  6%|▌         | 2/34 [00:00<00:05,  5.74it/s] 12%|█▏        | 4/34 [00:00<00:03,  8.17it/s] 18%|█▊        | 6/34 [00:00<00:02,  9.36it/s] 24%|██▎       | 8/34 [00:00<00:02, 10.97it/s] 29%|██▉       | 10/34 [00:01<00:02, 10.52it/s] 35%|███▌      | 12/34 [00:01<00:02, 10.36it/s] 41%|████      | 14/34 [00:01<00:02,  9.87it/s] 47%|████▋     | 16/34 [00:01<00:01,  9.26it/s] 50%|█████     | 17/34 [00:01<00:01,  9.06it/s] 53%|█████▎    | 18/34 [00:01<00:01,  8.85it/s] 56%|█████▌    | 19/34 [00:02<00:01,  8.59it/s] 59%|█████▉    | 20/34 [00:02<00:01,  8.39it/s] 62%|██████▏   | 21/34 [00:06<00:16,  1.27s/it] 65%|██████▍   | 22/34 [00:06<00:11,  1.04it/s] 68%|██████▊   | 23/34 [00:07<00:07,  1.38it/s] 71%|███████   | 24/34 [00:07<00:05,  1.80it/s] 74%|███████▎  | 25/34 [00:07<00:03,  2.33it/s] 76%|███████▋  | 26/34 [00:07<00:02,  2.95it/s] 79%|███████▉  | 27/34 [00:07<00:01,  3.64it/s] 82%|████████▏ | 28/34 [00:07<00:01,  4.37it/s] 85%|████████▌ | 29/34 [00:07<00:00,  5.22it/s] 91%|█████████ | 31/34 [00:07<00:00,  6.94it/s] 97%|█████████▋| 33/34 [00:08<00:00,  8.29it/s]100%|██████████| 34/34 [00:12<00:00,  2.79it/s]
2025-03-13 15:56:32,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:32
2025-03-13 15:57:51,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.9012 secs
2025-03-13 15:57:51,151 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:57:51,151 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.67s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.29s/it]
2025-03-13 15:58:31,276 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1249 secs
2025-03-13 15:58:31,589 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.5212 secs
2025-03-13 15:58:31,589 [INFO]: {
2025-03-13 15:58:31,589 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:31,589 [INFO]: 	index_param: efSearch=182
2025-03-13 15:58:31,589 [INFO]: 	index_path: knn.index
2025-03-13 15:58:31,589 [INFO]: 	size in bytes: 1644386950
2025-03-13 15:58:31,589 [INFO]: 	avg_search_speed_ms: 10.159901823617549
2025-03-13 15:58:31,589 [INFO]: 	99p_search_speed_ms: 18.8931070221588
2025-03-13 15:58:31,589 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:31,589 [INFO]: 	nb vectors: 8358
2025-03-13 15:58:31,589 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:31,589 [INFO]: 	compression ratio: 0.9993083829812685
2025-03-13 15:58:31,590 [INFO]: }
2025-03-13 15:58:31,590 [INFO]: 	>>> Finished "Creating the index" in 131.5237 secs
2025-03-13 15:58:31,590 [INFO]: >>> Finished "Launching the whole pipeline" in 131.5519 secs
2025-03-13 15:58:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 55842 [episode count 4/20]
[retrieval_preprocessing] for episode 64044 [episode count 5/20], we have num_retrieval=np.int64(8371) num_query=np.int64(458)
2025-03-13 15:58:39,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:41,278 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:41
2025-03-13 15:58:41,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-13 15:58:41,306 [INFO]: There are 8371 embeddings of dim 49152
2025-03-13 15:58:41,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:58:41,306 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,306 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:41,306 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:58:41,306 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:41,306 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:41,306 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,306 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:41,306 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:58:41,307 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:41
2025-03-13 15:58:41,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:41,307 [INFO]: 	Creating the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,307 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:41
2025-03-13 15:58:41,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:58:41,308 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,308 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:58:41,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  5.63it/s]  9%|▉         | 3/34 [00:00<00:03,  9.98it/s] 15%|█▍        | 5/34 [00:00<00:02, 11.55it/s] 21%|██        | 7/34 [00:00<00:02, 12.41it/s] 26%|██▋       | 9/34 [00:00<00:01, 12.57it/s] 32%|███▏      | 11/34 [00:00<00:01, 12.31it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.62it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.15it/s] 50%|█████     | 17/34 [00:01<00:01, 10.36it/s] 56%|█████▌    | 19/34 [00:01<00:01,  9.92it/s] 62%|██████▏   | 21/34 [00:06<00:11,  1.16it/s] 74%|███████▎  | 25/34 [00:07<00:04,  2.11it/s] 85%|████████▌ | 29/34 [00:07<00:01,  3.40it/s] 97%|█████████▋| 33/34 [00:07<00:00,  5.08it/s]100%|██████████| 34/34 [00:11<00:00,  3.03it/s]
2025-03-13 15:58:53,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:53
2025-03-13 16:00:22,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.8975 secs
2025-03-13 16:00:22,031 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 16:00:22,031 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 16:01:18,639 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6072 secs
2025-03-13 16:01:19,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 158.0918 secs
2025-03-13 16:01:19,401 [INFO]: {
2025-03-13 16:01:19,401 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:19,401 [INFO]: 	index_param: efSearch=101
2025-03-13 16:01:19,401 [INFO]: 	index_path: knn.index
2025-03-13 16:01:19,401 [INFO]: 	size in bytes: 1646944570
2025-03-13 16:01:19,401 [INFO]: 	avg_search_speed_ms: 8.690369497502399
2025-03-13 16:01:19,401 [INFO]: 	99p_search_speed_ms: 16.42837096005678
2025-03-13 16:01:19,401 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:19,401 [INFO]: 	nb vectors: 8371
2025-03-13 16:01:19,401 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:19,401 [INFO]: 	compression ratio: 0.9993084150974189
2025-03-13 16:01:19,401 [INFO]: }
2025-03-13 16:01:19,402 [INFO]: 	>>> Finished "Creating the index" in 158.0949 secs
2025-03-13 16:01:19,402 [INFO]: >>> Finished "Launching the whole pipeline" in 158.1236 secs
2025-03-13 16:01:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 64044 [episode count 5/20]
[retrieval_preprocessing] for episode 91692 [episode count 6/20], we have num_retrieval=np.int64(8495) num_query=np.int64(334)
2025-03-13 16:01:22,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:24,163 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:24
2025-03-13 16:01:24,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.07it/s]
2025-03-13 16:01:24,194 [INFO]: There are 8495 embeddings of dim 49152
2025-03-13 16:01:24,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 16:01:24,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:24
2025-03-13 16:01:24,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:24,195 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:01:24,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:24,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:24,195 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:24
2025-03-13 16:01:24,195 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:24,195 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:01:24,195 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:24
2025-03-13 16:01:24,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:24,195 [INFO]: 	Creating the index 03/13/2025, 16:01:24
2025-03-13 16:01:24,195 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:24
2025-03-13 16:01:24,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:01:24,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:24
2025-03-13 16:01:24,197 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:01:24,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.51it/s] 17%|█▋        | 6/35 [00:00<00:00, 30.67it/s] 31%|███▏      | 11/35 [00:00<00:00, 37.69it/s] 46%|████▌     | 16/35 [00:00<00:00, 41.22it/s] 60%|██████    | 21/35 [00:05<00:05,  2.68it/s] 74%|███████▍  | 26/35 [00:05<00:02,  4.04it/s] 91%|█████████▏| 32/35 [00:05<00:00,  6.21it/s]100%|██████████| 35/35 [00:08<00:00,  3.91it/s]
2025-03-13 16:01:33,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:33
2025-03-13 16:03:00,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.7546 secs
2025-03-13 16:03:00,202 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:03:00,202 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 16:04:17,936 [INFO]: 	>>> Finished "Compute fast metrics" in 77.7341 secs
2025-03-13 16:04:17,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 173.7445 secs
2025-03-13 16:04:17,941 [INFO]: {
2025-03-13 16:04:17,941 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:17,941 [INFO]: 	index_param: efSearch=169
2025-03-13 16:04:17,941 [INFO]: 	index_path: knn.index
2025-03-13 16:04:17,941 [INFO]: 	size in bytes: 1671340990
2025-03-13 16:04:17,941 [INFO]: 	avg_search_speed_ms: 11.796463909943341
2025-03-13 16:04:17,941 [INFO]: 	99p_search_speed_ms: 17.27962647564709
2025-03-13 16:04:17,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:17,942 [INFO]: 	nb vectors: 8495
2025-03-13 16:04:17,942 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:17,942 [INFO]: 	compression ratio: 0.9993083218763156
2025-03-13 16:04:17,942 [INFO]: }
2025-03-13 16:04:17,942 [INFO]: 	>>> Finished "Creating the index" in 173.7465 secs
2025-03-13 16:04:17,942 [INFO]: >>> Finished "Launching the whole pipeline" in 173.7788 secs
2025-03-13 16:04:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 91692 [episode count 6/20]
[retrieval_preprocessing] for episode 75312 [episode count 7/20], we have num_retrieval=np.int64(8483) num_query=np.int64(346)
2025-03-13 16:04:22,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:24,726 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:24
2025-03-13 16:04:24,726 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.10it/s]
2025-03-13 16:04:24,763 [INFO]: There are 8483 embeddings of dim 49152
2025-03-13 16:04:24,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 16:04:24,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:24
2025-03-13 16:04:24,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:24,764 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:04:24,764 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:24,764 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:04:24,764 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:24
2025-03-13 16:04:24,765 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:24,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:04:24,765 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:24
2025-03-13 16:04:24,766 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:04:24,766 [INFO]: 	Creating the index 03/13/2025, 16:04:24
2025-03-13 16:04:24,766 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:24
2025-03-13 16:04:24,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:04:24,770 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:24
2025-03-13 16:04:24,770 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:04:24,770 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.65it/s] 17%|█▋        | 6/35 [00:00<00:01, 24.96it/s] 31%|███▏      | 11/35 [00:00<00:00, 32.67it/s] 46%|████▌     | 16/35 [00:00<00:00, 38.23it/s] 60%|██████    | 21/35 [00:06<00:07,  1.92it/s] 71%|███████▏  | 25/35 [00:07<00:03,  2.71it/s] 83%|████████▎ | 29/35 [00:07<00:01,  3.76it/s] 94%|█████████▍| 33/35 [00:07<00:00,  5.16it/s]100%|██████████| 35/35 [00:11<00:00,  3.08it/s]
2025-03-13 16:04:36,130 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:36
2025-03-13 16:06:04,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.0792 secs
2025-03-13 16:06:04,210 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 16:06:04,210 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-13 16:07:08,153 [INFO]: 	>>> Finished "Compute fast metrics" in 63.9430 secs
2025-03-13 16:07:08,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.3860 secs
2025-03-13 16:07:08,156 [INFO]: {
2025-03-13 16:07:08,156 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:08,156 [INFO]: 	index_param: efSearch=186
2025-03-13 16:07:08,156 [INFO]: 	index_path: knn.index
2025-03-13 16:07:08,156 [INFO]: 	size in bytes: 1668980110
2025-03-13 16:07:08,156 [INFO]: 	avg_search_speed_ms: 13.372554749755915
2025-03-13 16:07:08,156 [INFO]: 	99p_search_speed_ms: 21.56654101330785
2025-03-13 16:07:08,156 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:08,156 [INFO]: 	nb vectors: 8483
2025-03-13 16:07:08,156 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:08,156 [INFO]: 	compression ratio: 0.9993082925356133
2025-03-13 16:07:08,156 [INFO]: }
2025-03-13 16:07:08,156 [INFO]: 	>>> Finished "Creating the index" in 163.3903 secs
2025-03-13 16:07:08,156 [INFO]: >>> Finished "Launching the whole pipeline" in 163.4300 secs
2025-03-13 16:07:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 75312 [episode count 7/20]
[retrieval_preprocessing] for episode 41522 [episode count 8/20], we have num_retrieval=np.int64(8536) num_query=np.int64(293)
2025-03-13 16:07:12,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:13,859 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:13
2025-03-13 16:07:13,859 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 16:07:13,886 [INFO]: There are 8536 embeddings of dim 49152
2025-03-13 16:07:13,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 16:07:13,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:13
2025-03-13 16:07:13,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:13,886 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:07:13,886 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:13,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:13,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:13
2025-03-13 16:07:13,886 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:13,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:13,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:13
2025-03-13 16:07:13,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:13,887 [INFO]: 	Creating the index 03/13/2025, 16:07:13
2025-03-13 16:07:13,887 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:13
2025-03-13 16:07:13,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:07:13,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:13
2025-03-13 16:07:13,888 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:07:13,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.73it/s] 17%|█▋        | 6/35 [00:00<00:00, 31.56it/s] 31%|███▏      | 11/35 [00:00<00:00, 38.96it/s] 46%|████▌     | 16/35 [00:00<00:00, 42.25it/s] 60%|██████    | 21/35 [00:04<00:04,  2.80it/s] 74%|███████▍  | 26/35 [00:04<00:02,  4.20it/s] 89%|████████▊ | 31/35 [00:05<00:00,  6.05it/s]100%|██████████| 35/35 [00:09<00:00,  2.38it/s]100%|██████████| 35/35 [00:09<00:00,  3.73it/s]
2025-03-13 16:07:23,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:23
2025-03-13 16:08:40,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1110 secs
2025-03-13 16:08:40,437 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:08:40,437 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 16:10:07,933 [INFO]: 	>>> Finished "Compute fast metrics" in 87.4959 secs
2025-03-13 16:10:08,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 174.9185 secs
2025-03-13 16:10:08,807 [INFO]: {
2025-03-13 16:10:08,807 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:08,807 [INFO]: 	index_param: efSearch=192
2025-03-13 16:10:08,807 [INFO]: 	index_path: knn.index
2025-03-13 16:10:08,807 [INFO]: 	size in bytes: 1679407390
2025-03-13 16:10:08,808 [INFO]: 	avg_search_speed_ms: 12.645083906979085
2025-03-13 16:10:08,808 [INFO]: 	99p_search_speed_ms: 19.22400477342308
2025-03-13 16:10:08,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:08,808 [INFO]: 	nb vectors: 8536
2025-03-13 16:10:08,808 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:08,808 [INFO]: 	compression ratio: 0.9993083857991122
2025-03-13 16:10:08,808 [INFO]: }
2025-03-13 16:10:08,808 [INFO]: 	>>> Finished "Creating the index" in 174.9214 secs
2025-03-13 16:10:08,808 [INFO]: >>> Finished "Launching the whole pipeline" in 174.9495 secs
2025-03-13 16:10:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 41522 [episode count 8/20]
[retrieval_preprocessing] for episode 58419 [episode count 9/20], we have num_retrieval=np.int64(8240) num_query=np.int64(589)
2025-03-13 16:10:14,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:18,031 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:18
2025-03-13 16:10:18,031 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.21it/s]
2025-03-13 16:10:18,072 [INFO]: There are 8240 embeddings of dim 49152
2025-03-13 16:10:18,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0411 secs
2025-03-13 16:10:18,072 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:18
2025-03-13 16:10:18,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:18,073 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:10:18,073 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:18,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:10:18,073 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:18
2025-03-13 16:10:18,074 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:18,074 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:10:18,074 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:18
2025-03-13 16:10:18,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:18,075 [INFO]: 	Creating the index 03/13/2025, 16:10:18
2025-03-13 16:10:18,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:18
2025-03-13 16:10:18,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:10:18,079 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:18
2025-03-13 16:10:18,079 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:10:18,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  6.74it/s] 12%|█▏        | 4/34 [00:00<00:01, 16.43it/s] 21%|██        | 7/34 [00:00<00:01, 20.94it/s] 29%|██▉       | 10/34 [00:00<00:01, 23.21it/s] 38%|███▊      | 13/34 [00:00<00:00, 23.96it/s] 47%|████▋     | 16/34 [00:00<00:00, 25.42it/s] 59%|█████▉    | 20/34 [00:00<00:00, 28.44it/s] 68%|██████▊   | 23/34 [00:06<00:06,  1.67it/s] 82%|████████▏ | 28/34 [00:06<00:02,  2.79it/s] 97%|█████████▋| 33/34 [00:06<00:00,  4.29it/s]100%|██████████| 34/34 [00:10<00:00,  3.22it/s]
2025-03-13 16:10:29,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:29
2025-03-13 16:11:42,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.8418 secs
2025-03-13 16:11:42,864 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 16:11:42,864 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.44it/s]
2025-03-13 16:12:32,816 [INFO]: 	>>> Finished "Compute fast metrics" in 49.9520 secs
2025-03-13 16:12:32,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.7408 secs
2025-03-13 16:12:32,820 [INFO]: {
2025-03-13 16:12:32,820 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:32,820 [INFO]: 	index_param: efSearch=162
2025-03-13 16:12:32,820 [INFO]: 	index_path: knn.index
2025-03-13 16:12:32,820 [INFO]: 	size in bytes: 1621171390
2025-03-13 16:12:32,820 [INFO]: 	avg_search_speed_ms: 11.92497194154106
2025-03-13 16:12:32,820 [INFO]: 	99p_search_speed_ms: 25.258608632721007
2025-03-13 16:12:32,820 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:32,820 [INFO]: 	nb vectors: 8240
2025-03-13 16:12:32,820 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:32,820 [INFO]: 	compression ratio: 0.9993082347696748
2025-03-13 16:12:32,820 [INFO]: }
2025-03-13 16:12:32,820 [INFO]: 	>>> Finished "Creating the index" in 134.7452 secs
2025-03-13 16:12:32,820 [INFO]: >>> Finished "Launching the whole pipeline" in 134.7893 secs
2025-03-13 16:12:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 58419 [episode count 9/20]
[retrieval_preprocessing] for episode 64049 [episode count 10/20], we have num_retrieval=np.int64(8197) num_query=np.int64(632)
2025-03-13 16:12:38,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:39,638 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:39
2025-03-13 16:12:39,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.95it/s]
2025-03-13 16:12:39,666 [INFO]: There are 8197 embeddings of dim 49152
2025-03-13 16:12:39,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 16:12:39,667 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:39
2025-03-13 16:12:39,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:39,667 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:12:39,667 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:39,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:12:39,667 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:39
2025-03-13 16:12:39,667 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:39,667 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:39,667 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:39
2025-03-13 16:12:39,667 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:39,668 [INFO]: 	Creating the index 03/13/2025, 16:12:39
2025-03-13 16:12:39,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:39
2025-03-13 16:12:39,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:12:39,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:39
2025-03-13 16:12:39,669 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:12:39,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.91it/s] 18%|█▊        | 6/34 [00:00<00:00, 29.43it/s] 32%|███▏      | 11/34 [00:00<00:00, 36.98it/s] 47%|████▋     | 16/34 [00:00<00:00, 41.54it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.91it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.37it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.31it/s]100%|██████████| 34/34 [00:08<00:00,  3.88it/s]
2025-03-13 16:12:48,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:48
2025-03-13 16:14:18,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.0634 secs
2025-03-13 16:14:18,491 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:14:18,491 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.26it/s]
2025-03-13 16:15:10,053 [INFO]: 	>>> Finished "Compute fast metrics" in 51.5622 secs
2025-03-13 16:15:10,056 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.3873 secs
2025-03-13 16:15:10,056 [INFO]: {
2025-03-13 16:15:10,056 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:10,057 [INFO]: 	index_param: efSearch=169
2025-03-13 16:15:10,057 [INFO]: 	index_path: knn.index
2025-03-13 16:15:10,057 [INFO]: 	size in bytes: 1612711570
2025-03-13 16:15:10,057 [INFO]: 	avg_search_speed_ms: 12.548298285187338
2025-03-13 16:15:10,057 [INFO]: 	99p_search_speed_ms: 22.838098471984267
2025-03-13 16:15:10,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:10,057 [INFO]: 	nb vectors: 8197
2025-03-13 16:15:10,057 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:10,057 [INFO]: 	compression ratio: 0.9993081255069064
2025-03-13 16:15:10,057 [INFO]: }
2025-03-13 16:15:10,057 [INFO]: 	>>> Finished "Creating the index" in 150.3891 secs
2025-03-13 16:15:10,057 [INFO]: >>> Finished "Launching the whole pipeline" in 150.4182 secs
2025-03-13 16:15:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 64049 [episode count 10/20]
[retrieval_preprocessing] for episode 76854 [episode count 11/20], we have num_retrieval=np.int64(8473) num_query=np.int64(356)
2025-03-13 16:15:16,729 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:18,022 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:18
2025-03-13 16:15:18,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-13 16:15:18,050 [INFO]: There are 8473 embeddings of dim 49152
2025-03-13 16:15:18,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:15:18,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:18,050 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:15:18,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:18,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:18,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,050 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:18,050 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:15:18,050 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:18
2025-03-13 16:15:18,050 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:18,050 [INFO]: 	Creating the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,050 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:18
2025-03-13 16:15:18,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:15:18,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,052 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:15:18,052 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  5.75it/s] 17%|█▋        | 6/35 [00:00<00:01, 23.53it/s] 31%|███▏      | 11/35 [00:00<00:00, 31.16it/s] 46%|████▌     | 16/35 [00:00<00:00, 35.28it/s] 60%|██████    | 21/35 [00:05<00:05,  2.61it/s] 69%|██████▊   | 24/35 [00:08<00:06,  1.78it/s] 74%|███████▍  | 26/35 [00:09<00:04,  1.87it/s] 80%|████████  | 28/35 [00:11<00:04,  1.59it/s] 94%|█████████▍| 33/35 [00:11<00:00,  2.74it/s]100%|██████████| 35/35 [00:15<00:00,  1.40it/s]100%|██████████| 35/35 [00:15<00:00,  2.23it/s]
2025-03-13 16:15:33,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:33
2025-03-13 16:16:49,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.9117 secs
2025-03-13 16:16:49,679 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:16:49,679 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s]
2025-03-13 16:17:40,553 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8744 secs
2025-03-13 16:17:41,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.5236 secs
2025-03-13 16:17:41,576 [INFO]: {
2025-03-13 16:17:41,576 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:41,576 [INFO]: 	index_param: efSearch=238
2025-03-13 16:17:41,576 [INFO]: 	index_path: knn.index
2025-03-13 16:17:41,576 [INFO]: 	size in bytes: 1667012650
2025-03-13 16:17:41,576 [INFO]: 	avg_search_speed_ms: 18.341869429681765
2025-03-13 16:17:41,576 [INFO]: 	99p_search_speed_ms: 27.551739104092103
2025-03-13 16:17:41,576 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:41,576 [INFO]: 	nb vectors: 8473
2025-03-13 16:17:41,576 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:41,576 [INFO]: 	compression ratio: 0.9993083039891749
2025-03-13 16:17:41,576 [INFO]: }
2025-03-13 16:17:41,576 [INFO]: 	>>> Finished "Creating the index" in 143.5256 secs
2025-03-13 16:17:41,576 [INFO]: >>> Finished "Launching the whole pipeline" in 143.5542 secs
2025-03-13 16:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 76854 [episode count 11/20]
[retrieval_preprocessing] for episode 54851 [episode count 12/20], we have num_retrieval=np.int64(8209) num_query=np.int64(620)
2025-03-13 16:17:47,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:48,400 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:48
2025-03-13 16:17:48,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1419.87it/s]
2025-03-13 16:17:48,429 [INFO]: There are 8209 embeddings of dim 49152
2025-03-13 16:17:48,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:17:48,430 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:48,430 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:17:48,431 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:48,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:17:48,431 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,431 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:48,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:17:48,432 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:48
2025-03-13 16:17:48,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:48,432 [INFO]: 	Creating the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:48
2025-03-13 16:17:48,436 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 16:17:48,436 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,436 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:17:48,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:09,  3.63it/s] 18%|█▊        | 6/34 [00:00<00:01, 18.19it/s] 32%|███▏      | 11/34 [00:00<00:00, 26.35it/s] 44%|████▍     | 15/34 [00:00<00:00, 30.21it/s] 56%|█████▌    | 19/34 [00:00<00:00, 32.81it/s] 68%|██████▊   | 23/34 [00:07<00:06,  1.78it/s] 79%|███████▉  | 27/34 [00:07<00:02,  2.57it/s] 91%|█████████ | 31/34 [00:07<00:00,  3.65it/s]100%|██████████| 34/34 [00:11<00:00,  2.96it/s]
2025-03-13 16:17:59,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:59
2025-03-13 16:19:25,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.7742 secs
2025-03-13 16:19:25,688 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 16:19:25,688 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.14it/s]
2025-03-13 16:20:18,146 [INFO]: 	>>> Finished "Compute fast metrics" in 52.4579 secs
2025-03-13 16:20:18,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.7118 secs
2025-03-13 16:20:18,148 [INFO]: {
2025-03-13 16:20:18,148 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:18,148 [INFO]: 	index_param: efSearch=126
2025-03-13 16:20:18,148 [INFO]: 	index_path: knn.index
2025-03-13 16:20:18,148 [INFO]: 	size in bytes: 1615072450
2025-03-13 16:20:18,148 [INFO]: 	avg_search_speed_ms: 8.393377054515542
2025-03-13 16:20:18,148 [INFO]: 	99p_search_speed_ms: 12.61658070143312
2025-03-13 16:20:18,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:18,148 [INFO]: 	nb vectors: 8209
2025-03-13 16:20:18,148 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:18,148 [INFO]: 	compression ratio: 0.9993081561139874
2025-03-13 16:20:18,148 [INFO]: }
2025-03-13 16:20:18,148 [INFO]: 	>>> Finished "Creating the index" in 149.7162 secs
2025-03-13 16:20:18,149 [INFO]: >>> Finished "Launching the whole pipeline" in 149.7484 secs
2025-03-13 16:20:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 54851 [episode count 12/20]
[retrieval_preprocessing] for episode 12360 [episode count 13/20], we have num_retrieval=np.int64(8291) num_query=np.int64(538)
2025-03-13 16:20:23,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:24,589 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:24
2025-03-13 16:20:24,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1659.14it/s]
2025-03-13 16:20:24,620 [INFO]: There are 8291 embeddings of dim 49152
2025-03-13 16:20:24,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 16:20:24,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:24
2025-03-13 16:20:24,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:24,621 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:20:24,621 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:24,621 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:20:24,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:24
2025-03-13 16:20:24,621 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:24,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:20:24,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:24
2025-03-13 16:20:24,622 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:24,622 [INFO]: 	Creating the index 03/13/2025, 16:20:24
2025-03-13 16:20:24,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:24
2025-03-13 16:20:24,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:20:24,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:24
2025-03-13 16:20:24,626 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:20:24,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.41it/s] 18%|█▊        | 6/34 [00:00<00:01, 26.44it/s] 29%|██▉       | 10/34 [00:00<00:00, 30.81it/s] 41%|████      | 14/34 [00:00<00:00, 30.46it/s] 53%|█████▎    | 18/34 [00:00<00:00, 33.00it/s] 65%|██████▍   | 22/34 [00:07<00:07,  1.61it/s] 79%|███████▉  | 27/34 [00:07<00:02,  2.54it/s] 91%|█████████ | 31/34 [00:07<00:00,  3.56it/s]100%|██████████| 34/34 [00:11<00:00,  2.95it/s]
2025-03-13 16:20:36,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:36
2025-03-13 16:21:41,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.9005 secs
2025-03-13 16:21:41,050 [INFO]: The best hyperparameters are: efSearch=86
2025-03-13 16:21:41,050 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 16:22:18,927 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8761 secs
2025-03-13 16:22:18,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.3028 secs
2025-03-13 16:22:18,929 [INFO]: {
2025-03-13 16:22:18,929 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:18,929 [INFO]: 	index_param: efSearch=86
2025-03-13 16:22:18,929 [INFO]: 	index_path: knn.index
2025-03-13 16:22:18,929 [INFO]: 	size in bytes: 1631205250
2025-03-13 16:22:18,929 [INFO]: 	avg_search_speed_ms: 6.153690257754463
2025-03-13 16:22:18,929 [INFO]: 	99p_search_speed_ms: 10.440061585977674
2025-03-13 16:22:18,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:18,929 [INFO]: 	nb vectors: 8291
2025-03-13 16:22:18,929 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:18,929 [INFO]: 	compression ratio: 0.9993082893768274
2025-03-13 16:22:18,929 [INFO]: }
2025-03-13 16:22:18,929 [INFO]: 	>>> Finished "Creating the index" in 114.3066 secs
2025-03-13 16:22:18,929 [INFO]: >>> Finished "Launching the whole pipeline" in 114.3404 secs
2025-03-13 16:22:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 12360 [episode count 13/20]
[retrieval_preprocessing] for episode 14923 [episode count 14/20], we have num_retrieval=np.int64(8408) num_query=np.int64(421)
2025-03-13 16:22:23,151 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:25,223 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:25
2025-03-13 16:22:25,223 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 921.02it/s]
2025-03-13 16:22:25,248 [INFO]: There are 8408 embeddings of dim 49152
2025-03-13 16:22:25,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:22:25,248 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:25
2025-03-13 16:22:25,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:25,248 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:22:25,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:25,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:22:25,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:25
2025-03-13 16:22:25,248 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:25,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:22:25,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:25
2025-03-13 16:22:25,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:22:25,249 [INFO]: 	Creating the index 03/13/2025, 16:22:25
2025-03-13 16:22:25,249 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:25
2025-03-13 16:22:25,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:22:25,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:25
2025-03-13 16:22:25,250 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:22:25,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.34it/s] 17%|█▋        | 6/35 [00:00<00:01, 28.15it/s] 31%|███▏      | 11/35 [00:00<00:00, 35.26it/s] 46%|████▌     | 16/35 [00:00<00:00, 39.31it/s] 60%|██████    | 21/35 [00:04<00:04,  3.00it/s] 74%|███████▍  | 26/35 [00:04<00:02,  4.50it/s] 89%|████████▊ | 31/35 [00:04<00:00,  6.48it/s]100%|██████████| 35/35 [00:08<00:00,  2.95it/s]100%|██████████| 35/35 [00:08<00:00,  4.35it/s]
2025-03-13 16:22:33,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:33
2025-03-13 16:23:42,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.2840 secs
2025-03-13 16:23:42,586 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 16:23:42,587 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.32it/s]
2025-03-13 16:24:30,673 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0863 secs
2025-03-13 16:24:30,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.4260 secs
2025-03-13 16:24:30,676 [INFO]: {
2025-03-13 16:24:30,677 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:30,677 [INFO]: 	index_param: efSearch=136
2025-03-13 16:24:30,677 [INFO]: 	index_path: knn.index
2025-03-13 16:24:30,677 [INFO]: 	size in bytes: 1654224190
2025-03-13 16:24:30,677 [INFO]: 	avg_search_speed_ms: 10.96669691354404
2025-03-13 16:24:30,677 [INFO]: 	99p_search_speed_ms: 18.69801221648231
2025-03-13 16:24:30,677 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:30,677 [INFO]: 	nb vectors: 8408
2025-03-13 16:24:30,677 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:30,677 [INFO]: 	compression ratio: 0.9993083609785685
2025-03-13 16:24:30,677 [INFO]: }
2025-03-13 16:24:30,677 [INFO]: 	>>> Finished "Creating the index" in 125.4279 secs
2025-03-13 16:24:30,677 [INFO]: >>> Finished "Launching the whole pipeline" in 125.4541 secs
2025-03-13 16:24:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 14923 [episode count 14/20]
[retrieval_preprocessing] for episode 65613 [episode count 15/20], we have num_retrieval=np.int64(8477) num_query=np.int64(352)
2025-03-13 16:24:35,591 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:37,698 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:37
2025-03-13 16:24:37,698 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.09it/s]
2025-03-13 16:24:37,731 [INFO]: There are 8477 embeddings of dim 49152
2025-03-13 16:24:37,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 16:24:37,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:37
2025-03-13 16:24:37,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:37,732 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:24:37,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:37,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:37,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:37
2025-03-13 16:24:37,732 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:37,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:24:37,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:37
2025-03-13 16:24:37,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:37,732 [INFO]: 	Creating the index 03/13/2025, 16:24:37
2025-03-13 16:24:37,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:37
2025-03-13 16:24:37,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:24:37,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:37
2025-03-13 16:24:37,733 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:24:37,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  4.19it/s]  9%|▊         | 3/35 [00:00<00:03,  8.66it/s] 17%|█▋        | 6/35 [00:00<00:01, 15.21it/s] 29%|██▊       | 10/35 [00:00<00:01, 20.79it/s] 40%|████      | 14/35 [00:00<00:00, 24.63it/s] 51%|█████▏    | 18/35 [00:00<00:00, 27.63it/s] 60%|██████    | 21/35 [00:05<00:06,  2.19it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.58it/s] 89%|████████▊ | 31/35 [00:05<00:00,  5.44it/s]100%|██████████| 35/35 [00:10<00:00,  1.96it/s]100%|██████████| 35/35 [00:10<00:00,  3.28it/s]
2025-03-13 16:24:48,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:48
2025-03-13 16:26:00,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.1915 secs
2025-03-13 16:26:00,596 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 16:26:00,596 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.19it/s]
2025-03-13 16:26:56,605 [INFO]: 	>>> Finished "Compute fast metrics" in 56.0080 secs
2025-03-13 16:26:56,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.8740 secs
2025-03-13 16:26:56,608 [INFO]: {
2025-03-13 16:26:56,608 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:56,608 [INFO]: 	index_param: efSearch=228
2025-03-13 16:26:56,608 [INFO]: 	index_path: knn.index
2025-03-13 16:26:56,608 [INFO]: 	size in bytes: 1667799610
2025-03-13 16:26:56,608 [INFO]: 	avg_search_speed_ms: 12.842111142450257
2025-03-13 16:26:56,608 [INFO]: 	99p_search_speed_ms: 18.721750723198067
2025-03-13 16:26:56,608 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:56,608 [INFO]: 	nb vectors: 8477
2025-03-13 16:26:56,608 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:56,608 [INFO]: 	compression ratio: 0.9993083137847718
2025-03-13 16:26:56,608 [INFO]: }
2025-03-13 16:26:56,608 [INFO]: 	>>> Finished "Creating the index" in 138.8759 secs
2025-03-13 16:26:56,608 [INFO]: >>> Finished "Launching the whole pipeline" in 138.9098 secs
2025-03-13 16:26:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 65613 [episode count 15/20]
[retrieval_preprocessing] for episode 89741 [episode count 16/20], we have num_retrieval=np.int64(8142) num_query=np.int64(687)
2025-03-13 16:27:02,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:04,388 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:04
2025-03-13 16:27:04,388 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1052.26it/s]
2025-03-13 16:27:04,417 [INFO]: There are 8142 embeddings of dim 49152
2025-03-13 16:27:04,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 16:27:04,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:04
2025-03-13 16:27:04,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:04,417 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:27:04,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:04,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:27:04,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:04
2025-03-13 16:27:04,417 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:04,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:27:04,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:04
2025-03-13 16:27:04,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:04,418 [INFO]: 	Creating the index 03/13/2025, 16:27:04
2025-03-13 16:27:04,418 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:04
2025-03-13 16:27:04,419 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:27:04,419 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:04
2025-03-13 16:27:04,419 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:27:04,419 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  6.93it/s] 12%|█▏        | 4/34 [00:00<00:01, 18.28it/s] 26%|██▋       | 9/34 [00:00<00:00, 30.15it/s] 41%|████      | 14/34 [00:00<00:00, 36.09it/s] 56%|█████▌    | 19/34 [00:00<00:00, 39.34it/s] 71%|███████   | 24/34 [00:05<00:03,  2.80it/s] 85%|████████▌ | 29/34 [00:05<00:01,  4.13it/s] 97%|█████████▋| 33/34 [00:05<00:00,  5.53it/s]100%|██████████| 34/34 [00:11<00:00,  3.01it/s]
2025-03-13 16:27:15,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:15
2025-03-13 16:28:32,318 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.5911 secs
2025-03-13 16:28:32,318 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:28:32,318 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 16:29:21,306 [INFO]: 	>>> Finished "Compute fast metrics" in 48.9881 secs
2025-03-13 16:29:21,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.8896 secs
2025-03-13 16:29:21,309 [INFO]: {
2025-03-13 16:29:21,309 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:21,309 [INFO]: 	index_param: efSearch=227
2025-03-13 16:29:21,309 [INFO]: 	index_path: knn.index
2025-03-13 16:29:21,309 [INFO]: 	size in bytes: 1601890390
2025-03-13 16:29:21,309 [INFO]: 	avg_search_speed_ms: 13.179289170618173
2025-03-13 16:29:21,309 [INFO]: 	99p_search_speed_ms: 20.328440205194052
2025-03-13 16:29:21,309 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:21,309 [INFO]: 	nb vectors: 8142
2025-03-13 16:29:21,309 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:21,309 [INFO]: 	compression ratio: 0.9993082835087113
2025-03-13 16:29:21,309 [INFO]: }
2025-03-13 16:29:21,309 [INFO]: 	>>> Finished "Creating the index" in 136.8914 secs
2025-03-13 16:29:21,309 [INFO]: >>> Finished "Launching the whole pipeline" in 136.9213 secs
2025-03-13 16:29:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 89741 [episode count 16/20]
[retrieval_preprocessing] for episode 43145 [episode count 17/20], we have num_retrieval=np.int64(8396) num_query=np.int64(433)
2025-03-13 16:29:31,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:32,831 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:32
2025-03-13 16:29:32,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.78it/s]
2025-03-13 16:29:32,861 [INFO]: There are 8396 embeddings of dim 49152
2025-03-13 16:29:32,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 16:29:32,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:32
2025-03-13 16:29:32,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:32,861 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:29:32,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:32,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:32,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:32
2025-03-13 16:29:32,861 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:32,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:29:32,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:32
2025-03-13 16:29:32,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:32,862 [INFO]: 	Creating the index 03/13/2025, 16:29:32
2025-03-13 16:29:32,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:32
2025-03-13 16:29:32,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:29:32,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:32
2025-03-13 16:29:32,863 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:29:32,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.29it/s] 17%|█▋        | 6/35 [00:00<00:01, 22.56it/s] 31%|███▏      | 11/35 [00:00<00:00, 30.49it/s] 46%|████▌     | 16/35 [00:00<00:00, 34.78it/s] 60%|██████    | 21/35 [00:05<00:05,  2.69it/s] 71%|███████▏  | 25/35 [00:05<00:02,  3.77it/s] 86%|████████▌ | 30/35 [00:05<00:00,  5.59it/s]100%|██████████| 35/35 [00:09<00:00,  2.72it/s]100%|██████████| 35/35 [00:09<00:00,  3.88it/s]
2025-03-13 16:29:41,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:41
2025-03-13 16:31:09,620 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.7262 secs
2025-03-13 16:31:09,621 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:31:09,621 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 16:31:51,213 [INFO]: 	>>> Finished "Compute fast metrics" in 41.5917 secs
2025-03-13 16:31:51,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.3524 secs
2025-03-13 16:31:51,216 [INFO]: {
2025-03-13 16:31:51,216 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:51,216 [INFO]: 	index_param: efSearch=168
2025-03-13 16:31:51,216 [INFO]: 	index_path: knn.index
2025-03-13 16:31:51,216 [INFO]: 	size in bytes: 1651863250
2025-03-13 16:31:51,216 [INFO]: 	avg_search_speed_ms: 10.201527280923056
2025-03-13 16:31:51,216 [INFO]: 	99p_search_speed_ms: 14.928236922714865
2025-03-13 16:31:51,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:51,216 [INFO]: 	nb vectors: 8396
2025-03-13 16:31:51,216 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:51,216 [INFO]: 	compression ratio: 0.9993083676872162
2025-03-13 16:31:51,216 [INFO]: }
2025-03-13 16:31:51,216 [INFO]: 	>>> Finished "Creating the index" in 138.3542 secs
2025-03-13 16:31:51,216 [INFO]: >>> Finished "Launching the whole pipeline" in 138.3849 secs
2025-03-13 16:31:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 43145 [episode count 17/20]
[retrieval_preprocessing] for episode 85665 [episode count 18/20], we have num_retrieval=np.int64(8313) num_query=np.int64(516)
2025-03-13 16:31:55,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:57,032 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:57
2025-03-13 16:31:57,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-13 16:31:57,060 [INFO]: There are 8313 embeddings of dim 49152
2025-03-13 16:31:57,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 16:31:57,060 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:57
2025-03-13 16:31:57,060 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:57,060 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:31:57,060 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:57,060 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:57,060 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:57
2025-03-13 16:31:57,060 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:57,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:31:57,060 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:57
2025-03-13 16:31:57,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:57,060 [INFO]: 	Creating the index 03/13/2025, 16:31:57
2025-03-13 16:31:57,061 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:57
2025-03-13 16:31:57,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:31:57,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:57
2025-03-13 16:31:57,062 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:31:57,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.59it/s] 18%|█▊        | 6/34 [00:00<00:01, 25.36it/s] 32%|███▏      | 11/34 [00:00<00:00, 33.69it/s] 47%|████▋     | 16/34 [00:00<00:00, 38.01it/s] 62%|██████▏   | 21/34 [00:04<00:04,  3.04it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.54it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.51it/s]100%|██████████| 34/34 [00:08<00:00,  4.13it/s]
2025-03-13 16:32:05,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:05
2025-03-13 16:33:23,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.4394 secs
2025-03-13 16:33:23,729 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:33:23,729 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.40it/s]
2025-03-13 16:34:02,410 [INFO]: 	>>> Finished "Compute fast metrics" in 38.6813 secs
2025-03-13 16:34:02,413 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.3517 secs
2025-03-13 16:34:02,413 [INFO]: {
2025-03-13 16:34:02,413 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:02,414 [INFO]: 	index_param: efSearch=193
2025-03-13 16:34:02,414 [INFO]: 	index_path: knn.index
2025-03-13 16:34:02,414 [INFO]: 	size in bytes: 1635533590
2025-03-13 16:34:02,414 [INFO]: 	avg_search_speed_ms: 14.694535873335255
2025-03-13 16:34:02,414 [INFO]: 	99p_search_speed_ms: 22.092746058478955
2025-03-13 16:34:02,414 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:02,414 [INFO]: 	nb vectors: 8313
2025-03-13 16:34:02,414 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:02,414 [INFO]: 	compression ratio: 0.9993083076942492
2025-03-13 16:34:02,414 [INFO]: }
2025-03-13 16:34:02,414 [INFO]: 	>>> Finished "Creating the index" in 125.3532 secs
2025-03-13 16:34:02,414 [INFO]: >>> Finished "Launching the whole pipeline" in 125.3817 secs
2025-03-13 16:34:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 85665 [episode count 18/20]
[retrieval_preprocessing] for episode 9890 [episode count 19/20], we have num_retrieval=np.int64(8375) num_query=np.int64(454)
2025-03-13 16:34:09,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:10,684 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:10
2025-03-13 16:34:10,685 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.53it/s]
2025-03-13 16:34:10,718 [INFO]: There are 8375 embeddings of dim 49152
2025-03-13 16:34:10,719 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 16:34:10,719 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:10,719 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:34:10,720 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:10,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:34:10,720 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,720 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:10,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:34:10,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:10
2025-03-13 16:34:10,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:10,720 [INFO]: 	Creating the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:10
2025-03-13 16:34:10,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:34:10,722 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,722 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:34:10,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.28it/s] 15%|█▍        | 5/34 [00:00<00:01, 21.27it/s] 26%|██▋       | 9/34 [00:00<00:00, 27.84it/s] 38%|███▊      | 13/34 [00:00<00:00, 30.97it/s] 50%|█████     | 17/34 [00:00<00:00, 32.00it/s] 62%|██████▏   | 21/34 [00:05<00:05,  2.24it/s] 76%|███████▋  | 26/34 [00:05<00:02,  3.55it/s] 91%|█████████ | 31/34 [00:05<00:00,  5.29it/s]100%|██████████| 34/34 [00:09<00:00,  3.74it/s]
2025-03-13 16:34:19,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:19
2025-03-13 16:35:41,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.3635 secs
2025-03-13 16:35:41,182 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 16:35:41,182 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 16:36:36,842 [INFO]: 	>>> Finished "Compute fast metrics" in 55.6593 secs
2025-03-13 16:36:36,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.1227 secs
2025-03-13 16:36:36,845 [INFO]: {
2025-03-13 16:36:36,845 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:36,845 [INFO]: 	index_param: efSearch=209
2025-03-13 16:36:36,845 [INFO]: 	index_path: knn.index
2025-03-13 16:36:36,845 [INFO]: 	size in bytes: 1647731590
2025-03-13 16:36:36,845 [INFO]: 	avg_search_speed_ms: 12.229660313865647
2025-03-13 16:36:36,845 [INFO]: 	99p_search_speed_ms: 18.14650918589905
2025-03-13 16:36:36,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:36,845 [INFO]: 	nb vectors: 8375
2025-03-13 16:36:36,845 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:36,845 [INFO]: 	compression ratio: 0.999308388570738
2025-03-13 16:36:36,845 [INFO]: }
2025-03-13 16:36:36,845 [INFO]: 	>>> Finished "Creating the index" in 146.1246 secs
2025-03-13 16:36:36,845 [INFO]: >>> Finished "Launching the whole pipeline" in 146.1602 secs
2025-03-13 16:36:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 9890 [episode count 19/20]
2025-03-13 16:36:41: [retrieval_preprocessing] finished for 3774560981_put_towel_in_black_box [chosen_id count 3/196]
2025-03-13 16:36:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3774560981_put_towel_in_box [chosen_id count 4/196]
2025-03-13 16:36:44: [retrieval_preprocessing] we have num_total=8876 embedding_dim=49152
[retrieval_preprocessing] for episode 37378 [episode count 0/20], we have num_retrieval=np.int64(8228) num_query=np.int64(648)
2025-03-13 16:36:45,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:47,632 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:47
2025-03-13 16:36:47,632 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 950.66it/s]
2025-03-13 16:36:47,667 [INFO]: There are 8228 embeddings of dim 49152
2025-03-13 16:36:47,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 16:36:47,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:47,668 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:36:47,668 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:47,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:36:47,669 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,669 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:47,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:36:47,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:47
2025-03-13 16:36:47,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:47,670 [INFO]: 	Creating the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:47
2025-03-13 16:36:47,674 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:36:47,674 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,675 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:36:47,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.03it/s] 12%|█▏        | 4/34 [00:00<00:01, 16.93it/s] 24%|██▎       | 8/34 [00:00<00:01, 25.35it/s] 35%|███▌      | 12/34 [00:00<00:00, 30.36it/s] 47%|████▋     | 16/34 [00:00<00:00, 33.28it/s] 59%|█████▉    | 20/34 [00:00<00:00, 35.15it/s] 71%|███████   | 24/34 [00:06<00:05,  1.81it/s] 79%|███████▉  | 27/34 [00:07<00:02,  2.41it/s] 91%|█████████ | 31/34 [00:07<00:00,  3.52it/s]100%|██████████| 34/34 [00:10<00:00,  1.89it/s]100%|██████████| 34/34 [00:10<00:00,  3.15it/s]
2025-03-13 16:36:58,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:58
2025-03-13 16:38:37,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.3999 secs
2025-03-13 16:38:37,863 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 16:38:37,863 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.63it/s]
2025-03-13 16:39:01,611 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7482 secs
2025-03-13 16:39:01,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.9401 secs
2025-03-13 16:39:01,615 [INFO]: {
2025-03-13 16:39:01,615 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:01,615 [INFO]: 	index_param: efSearch=89
2025-03-13 16:39:01,615 [INFO]: 	index_path: knn.index
2025-03-13 16:39:01,615 [INFO]: 	size in bytes: 1618810510
2025-03-13 16:39:01,615 [INFO]: 	avg_search_speed_ms: 8.961789042932585
2025-03-13 16:39:01,615 [INFO]: 	99p_search_speed_ms: 17.469310446176667
2025-03-13 16:39:01,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:01,615 [INFO]: 	nb vectors: 8228
2025-03-13 16:39:01,615 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:01,615 [INFO]: 	compression ratio: 0.9993082043926191
2025-03-13 16:39:01,615 [INFO]: }
2025-03-13 16:39:01,615 [INFO]: 	>>> Finished "Creating the index" in 133.9448 secs
2025-03-13 16:39:01,615 [INFO]: >>> Finished "Launching the whole pipeline" in 133.9832 secs
2025-03-13 16:39:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 37378 [episode count 0/20]
[retrieval_preprocessing] for episode 46627 [episode count 1/20], we have num_retrieval=np.int64(8423) num_query=np.int64(453)
2025-03-13 16:39:07,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:08,829 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:08
2025-03-13 16:39:08,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 944.66it/s]
2025-03-13 16:39:08,858 [INFO]: There are 8423 embeddings of dim 49152
2025-03-13 16:39:08,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:39:08,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:08
2025-03-13 16:39:08,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:08,859 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:39:08,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:08,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:39:08,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:08
2025-03-13 16:39:08,859 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:08,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:39:08,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:08
2025-03-13 16:39:08,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:08,860 [INFO]: 	Creating the index 03/13/2025, 16:39:08
2025-03-13 16:39:08,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:08
2025-03-13 16:39:08,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:39:08,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:08
2025-03-13 16:39:08,864 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:39:08,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  8.50it/s] 17%|█▋        | 6/35 [00:00<00:01, 28.23it/s] 31%|███▏      | 11/35 [00:00<00:00, 34.57it/s] 46%|████▌     | 16/35 [00:00<00:00, 37.89it/s] 60%|██████    | 21/35 [00:05<00:05,  2.64it/s] 71%|███████▏  | 25/35 [00:05<00:02,  3.69it/s] 83%|████████▎ | 29/35 [00:05<00:01,  5.09it/s] 97%|█████████▋| 34/35 [00:05<00:00,  7.35it/s]100%|██████████| 35/35 [00:09<00:00,  3.86it/s]
2025-03-13 16:39:18,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:18
2025-03-13 16:40:31,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.5567 secs
2025-03-13 16:40:31,056 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 16:40:31,056 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.28it/s] 50%|█████     | 2/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.90it/s]
2025-03-13 16:41:27,649 [INFO]: 	>>> Finished "Compute fast metrics" in 56.5924 secs
2025-03-13 16:41:27,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.7879 secs
2025-03-13 16:41:27,652 [INFO]: {
2025-03-13 16:41:27,652 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:27,652 [INFO]: 	index_param: efSearch=196
2025-03-13 16:41:27,652 [INFO]: 	index_path: knn.index
2025-03-13 16:41:27,652 [INFO]: 	size in bytes: 1657175350
2025-03-13 16:41:27,652 [INFO]: 	avg_search_speed_ms: 19.89629178513471
2025-03-13 16:41:27,652 [INFO]: 	99p_search_speed_ms: 34.15319456253201
2025-03-13 16:41:27,652 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:27,652 [INFO]: 	nb vectors: 8423
2025-03-13 16:41:27,652 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:27,652 [INFO]: 	compression ratio: 0.9993083616649258
2025-03-13 16:41:27,652 [INFO]: }
2025-03-13 16:41:27,652 [INFO]: 	>>> Finished "Creating the index" in 138.7920 secs
2025-03-13 16:41:27,652 [INFO]: >>> Finished "Launching the whole pipeline" in 138.8231 secs
2025-03-13 16:41:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 46627 [episode count 1/20]
[retrieval_preprocessing] for episode 3121 [episode count 2/20], we have num_retrieval=np.int64(8418) num_query=np.int64(458)
2025-03-13 16:41:34,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:36,437 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:36
2025-03-13 16:41:36,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1076.01it/s]
2025-03-13 16:41:36,476 [INFO]: There are 8418 embeddings of dim 49152
2025-03-13 16:41:36,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 16:41:36,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:36
2025-03-13 16:41:36,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:36,476 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:41:36,476 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:36,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:41:36,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:36
2025-03-13 16:41:36,476 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:36,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:41:36,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:36
2025-03-13 16:41:36,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:36,477 [INFO]: 	Creating the index 03/13/2025, 16:41:36
2025-03-13 16:41:36,477 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:36
2025-03-13 16:41:36,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:41:36,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:36
2025-03-13 16:41:36,478 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:41:36,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  6.96it/s] 17%|█▋        | 6/35 [00:00<00:01, 26.08it/s] 31%|███▏      | 11/35 [00:00<00:00, 33.71it/s] 46%|████▌     | 16/35 [00:00<00:00, 37.39it/s] 60%|██████    | 21/35 [00:05<00:05,  2.57it/s] 69%|██████▊   | 24/35 [00:05<00:03,  3.18it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.94it/s] 83%|████████▎ | 29/35 [00:05<00:01,  4.55it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.28it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.09it/s]100%|██████████| 35/35 [00:10<00:00,  1.59it/s]100%|██████████| 35/35 [00:10<00:00,  3.40it/s]
2025-03-13 16:41:46,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:46
2025-03-13 16:43:10,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.2948 secs
2025-03-13 16:43:10,071 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 16:43:10,071 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 16:43:59,862 [INFO]: 	>>> Finished "Compute fast metrics" in 49.7903 secs
2025-03-13 16:43:59,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.3872 secs
2025-03-13 16:43:59,866 [INFO]: {
2025-03-13 16:43:59,866 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:59,866 [INFO]: 	index_param: efSearch=271
2025-03-13 16:43:59,866 [INFO]: 	index_path: knn.index
2025-03-13 16:43:59,866 [INFO]: 	size in bytes: 1656191650
2025-03-13 16:43:59,866 [INFO]: 	avg_search_speed_ms: 19.35606618723481
2025-03-13 16:43:59,866 [INFO]: 	99p_search_speed_ms: 33.1480492651462
2025-03-13 16:43:59,866 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:59,866 [INFO]: 	nb vectors: 8418
2025-03-13 16:43:59,866 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:59,866 [INFO]: 	compression ratio: 0.9993083493688668
2025-03-13 16:43:59,866 [INFO]: }
2025-03-13 16:43:59,866 [INFO]: 	>>> Finished "Creating the index" in 143.3892 secs
2025-03-13 16:43:59,866 [INFO]: >>> Finished "Launching the whole pipeline" in 143.4285 secs
2025-03-13 16:44:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 3121 [episode count 2/20]
[retrieval_preprocessing] for episode 24117 [episode count 3/20], we have num_retrieval=np.int64(8580) num_query=np.int64(296)
2025-03-13 16:44:11,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:13,359 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:13
2025-03-13 16:44:13,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1081.56it/s]
2025-03-13 16:44:13,386 [INFO]: There are 8580 embeddings of dim 49152
2025-03-13 16:44:13,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 16:44:13,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:13,387 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:44:13,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:13,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:44:13,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,387 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:13,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:44:13,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:13
2025-03-13 16:44:13,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:13,387 [INFO]: 	Creating the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,387 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:13
2025-03-13 16:44:13,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:44:13,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,389 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:44:13,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.71it/s]  9%|▊         | 3/35 [00:00<00:03,  8.24it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.56it/s] 17%|█▋        | 6/35 [00:00<00:03,  9.58it/s] 23%|██▎       | 8/35 [00:00<00:02, 10.63it/s] 29%|██▊       | 10/35 [00:00<00:02, 11.24it/s] 34%|███▍      | 12/35 [00:01<00:01, 11.75it/s] 40%|████      | 14/35 [00:01<00:01, 12.17it/s] 46%|████▌     | 16/35 [00:01<00:01, 12.24it/s] 51%|█████▏    | 18/35 [00:01<00:01, 12.38it/s] 57%|█████▋    | 20/35 [00:01<00:01, 12.42it/s] 63%|██████▎   | 22/35 [00:06<00:09,  1.33it/s] 69%|██████▊   | 24/35 [00:06<00:06,  1.82it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.44it/s] 80%|████████  | 28/35 [00:06<00:02,  3.21it/s] 86%|████████▌ | 30/35 [00:07<00:01,  4.09it/s] 91%|█████████▏| 32/35 [00:07<00:00,  5.03it/s] 97%|█████████▋| 34/35 [00:07<00:00,  6.02it/s]100%|██████████| 35/35 [00:11<00:00,  3.07it/s]
2025-03-13 16:44:24,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:24
2025-03-13 16:45:48,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.7802 secs
2025-03-13 16:45:48,583 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 16:45:48,583 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 16:46:30,602 [INFO]: 	>>> Finished "Compute fast metrics" in 42.0194 secs
2025-03-13 16:46:30,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.2171 secs
2025-03-13 16:46:30,606 [INFO]: {
2025-03-13 16:46:30,606 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:30,606 [INFO]: 	index_param: efSearch=230
2025-03-13 16:46:30,606 [INFO]: 	index_path: knn.index
2025-03-13 16:46:30,606 [INFO]: 	size in bytes: 1688064130
2025-03-13 16:46:30,606 [INFO]: 	avg_search_speed_ms: 16.24408119445812
2025-03-13 16:46:30,606 [INFO]: 	99p_search_speed_ms: 26.222477911505855
2025-03-13 16:46:30,606 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:30,606 [INFO]: 	nb vectors: 8580
2025-03-13 16:46:30,606 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:30,606 [INFO]: 	compression ratio: 0.9993083852803626
2025-03-13 16:46:30,606 [INFO]: }
2025-03-13 16:46:30,606 [INFO]: 	>>> Finished "Creating the index" in 137.2188 secs
2025-03-13 16:46:30,606 [INFO]: >>> Finished "Launching the whole pipeline" in 137.2467 secs
2025-03-13 16:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 24117 [episode count 3/20]
[retrieval_preprocessing] for episode 11833 [episode count 4/20], we have num_retrieval=np.int64(8527) num_query=np.int64(349)
2025-03-13 16:46:38,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:40,901 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:40
2025-03-13 16:46:40,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.78it/s]
2025-03-13 16:46:40,929 [INFO]: There are 8527 embeddings of dim 49152
2025-03-13 16:46:40,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:46:40,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:40
2025-03-13 16:46:40,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:40,930 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:46:40,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:40,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:40,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:40
2025-03-13 16:46:40,930 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:40,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:46:40,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:40
2025-03-13 16:46:40,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:40,930 [INFO]: 	Creating the index 03/13/2025, 16:46:40
2025-03-13 16:46:40,930 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:40
2025-03-13 16:46:40,931 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:46:40,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:40
2025-03-13 16:46:40,932 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:46:40,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.61it/s]  9%|▊         | 3/35 [00:00<00:03,  8.81it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.16it/s] 20%|██        | 7/35 [00:00<00:02, 10.83it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.14it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.29it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.43it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.42it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.52it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.55it/s] 60%|██████    | 21/35 [00:05<00:09,  1.45it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.98it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.67it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.55it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.63it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.63it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.68it/s]100%|██████████| 35/35 [00:10<00:00,  1.54it/s]100%|██████████| 35/35 [00:10<00:00,  3.36it/s]
2025-03-13 16:46:51,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:51
2025-03-13 16:48:08,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.4877 secs
2025-03-13 16:48:08,825 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:48:08,825 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 16:48:47,236 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4108 secs
2025-03-13 16:48:47,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.3084 secs
2025-03-13 16:48:47,240 [INFO]: {
2025-03-13 16:48:47,240 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:47,240 [INFO]: 	index_param: efSearch=179
2025-03-13 16:48:47,240 [INFO]: 	index_path: knn.index
2025-03-13 16:48:47,240 [INFO]: 	size in bytes: 1677636730
2025-03-13 16:48:47,240 [INFO]: 	avg_search_speed_ms: 13.405416027865005
2025-03-13 16:48:47,241 [INFO]: 	99p_search_speed_ms: 21.388067223597314
2025-03-13 16:48:47,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:47,241 [INFO]: 	nb vectors: 8527
2025-03-13 16:48:47,241 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:47,241 [INFO]: 	compression ratio: 0.9993083639746013
2025-03-13 16:48:47,241 [INFO]: }
2025-03-13 16:48:47,241 [INFO]: 	>>> Finished "Creating the index" in 126.3103 secs
2025-03-13 16:48:47,241 [INFO]: >>> Finished "Launching the whole pipeline" in 126.3398 secs
2025-03-13 16:48:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 11833 [episode count 4/20]
[retrieval_preprocessing] for episode 86591 [episode count 5/20], we have num_retrieval=np.int64(8527) num_query=np.int64(349)
2025-03-13 16:48:54,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:55,580 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:55
2025-03-13 16:48:55,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.29it/s]
2025-03-13 16:48:55,606 [INFO]: There are 8527 embeddings of dim 49152
2025-03-13 16:48:55,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:48:55,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:55
2025-03-13 16:48:55,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:55,606 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:48:55,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:55,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:55,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:55
2025-03-13 16:48:55,606 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:55,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:55,607 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:55
2025-03-13 16:48:55,607 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:55,607 [INFO]: 	Creating the index 03/13/2025, 16:48:55
2025-03-13 16:48:55,607 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:55
2025-03-13 16:48:55,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:48:55,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:55
2025-03-13 16:48:55,608 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:48:55,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.82it/s]  9%|▊         | 3/35 [00:00<00:03,  8.25it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.45it/s] 20%|██        | 7/35 [00:00<00:02, 10.10it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.36it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.57it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.73it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.75it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.88it/s] 54%|█████▍    | 19/35 [00:01<00:01, 10.97it/s] 60%|██████    | 21/35 [00:06<00:10,  1.36it/s] 63%|██████▎   | 22/35 [00:06<00:08,  1.61it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.28it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.07it/s] 80%|████████  | 28/35 [00:06<00:01,  3.98it/s] 86%|████████▌ | 30/35 [00:07<00:01,  4.89it/s] 91%|█████████▏| 32/35 [00:07<00:00,  5.79it/s] 97%|█████████▋| 34/35 [00:07<00:00,  6.64it/s]100%|██████████| 35/35 [00:12<00:00,  2.89it/s]
2025-03-13 16:49:07,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:07
2025-03-13 16:50:25,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.4927 secs
2025-03-13 16:50:25,200 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 16:50:25,200 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 16:51:14,397 [INFO]: 	>>> Finished "Compute fast metrics" in 49.1972 secs
2025-03-13 16:51:14,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.2893 secs
2025-03-13 16:51:14,898 [INFO]: {
2025-03-13 16:51:14,898 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:14,898 [INFO]: 	index_param: efSearch=208
2025-03-13 16:51:14,898 [INFO]: 	index_path: knn.index
2025-03-13 16:51:14,898 [INFO]: 	size in bytes: 1677636730
2025-03-13 16:51:14,898 [INFO]: 	avg_search_speed_ms: 15.126765264288357
2025-03-13 16:51:14,898 [INFO]: 	99p_search_speed_ms: 24.15161579847335
2025-03-13 16:51:14,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:14,898 [INFO]: 	nb vectors: 8527
2025-03-13 16:51:14,898 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:14,898 [INFO]: 	compression ratio: 0.9993083639746013
2025-03-13 16:51:14,898 [INFO]: }
2025-03-13 16:51:14,898 [INFO]: 	>>> Finished "Creating the index" in 139.2917 secs
2025-03-13 16:51:14,898 [INFO]: >>> Finished "Launching the whole pipeline" in 139.3187 secs
2025-03-13 16:51:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 86591 [episode count 5/20]
[retrieval_preprocessing] for episode 18040 [episode count 6/20], we have num_retrieval=np.int64(8517) num_query=np.int64(359)
2025-03-13 16:51:20,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:21,979 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:21
2025-03-13 16:51:21,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1740.38it/s]
2025-03-13 16:51:22,002 [INFO]: There are 8517 embeddings of dim 49152
2025-03-13 16:51:22,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 16:51:22,002 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:22
2025-03-13 16:51:22,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:22,002 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:51:22,002 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:22,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:22,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:22
2025-03-13 16:51:22,002 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:22,002 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:51:22,002 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:22
2025-03-13 16:51:22,002 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:22,002 [INFO]: 	Creating the index 03/13/2025, 16:51:22
2025-03-13 16:51:22,002 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:22
2025-03-13 16:51:22,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 16:51:22,003 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:22
2025-03-13 16:51:22,003 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:51:22,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  3.79it/s]  6%|▌         | 2/35 [00:00<00:06,  5.12it/s]  9%|▊         | 3/35 [00:00<00:05,  6.15it/s] 11%|█▏        | 4/35 [00:00<00:04,  6.71it/s] 14%|█▍        | 5/35 [00:00<00:04,  7.04it/s] 17%|█▋        | 6/35 [00:00<00:03,  7.28it/s] 20%|██        | 7/35 [00:01<00:03,  7.53it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.10it/s] 31%|███▏      | 11/35 [00:01<00:01, 13.10it/s] 40%|████      | 14/35 [00:01<00:01, 16.71it/s] 51%|█████▏    | 18/35 [00:01<00:00, 21.71it/s] 60%|██████    | 21/35 [00:06<00:08,  1.62it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.56it/s] 83%|████████▎ | 29/35 [00:07<00:01,  3.82it/s] 94%|█████████▍| 33/35 [00:07<00:00,  5.46it/s]100%|██████████| 35/35 [00:11<00:00,  3.07it/s]
2025-03-13 16:51:33,410 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:33
2025-03-13 16:53:06,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 93.4604 secs
2025-03-13 16:53:06,871 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 16:53:06,871 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 16:54:03,084 [INFO]: 	>>> Finished "Compute fast metrics" in 56.2130 secs
2025-03-13 16:54:03,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.0853 secs
2025-03-13 16:54:03,089 [INFO]: {
2025-03-13 16:54:03,089 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:03,089 [INFO]: 	index_param: efSearch=163
2025-03-13 16:54:03,089 [INFO]: 	index_path: knn.index
2025-03-13 16:54:03,089 [INFO]: 	size in bytes: 1675669330
2025-03-13 16:54:03,089 [INFO]: 	avg_search_speed_ms: 13.090125267436497
2025-03-13 16:54:03,089 [INFO]: 	99p_search_speed_ms: 22.47554773464799
2025-03-13 16:54:03,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:03,089 [INFO]: 	nb vectors: 8517
2025-03-13 16:54:03,089 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:03,089 [INFO]: 	compression ratio: 0.9993083396710495
2025-03-13 16:54:03,089 [INFO]: }
2025-03-13 16:54:03,089 [INFO]: 	>>> Finished "Creating the index" in 161.0867 secs
2025-03-13 16:54:03,089 [INFO]: >>> Finished "Launching the whole pipeline" in 161.1099 secs
2025-03-13 16:54:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 18040 [episode count 6/20]
[retrieval_preprocessing] for episode 90745 [episode count 7/20], we have num_retrieval=np.int64(8250) num_query=np.int64(626)
2025-03-13 16:54:10,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:12,430 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:12
2025-03-13 16:54:12,431 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1045.44it/s]
2025-03-13 16:54:12,459 [INFO]: There are 8250 embeddings of dim 49152
2025-03-13 16:54:12,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:54:12,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:12
2025-03-13 16:54:12,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:12,460 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:54:12,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:12,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:12,460 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:12
2025-03-13 16:54:12,460 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:12,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:54:12,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:12
2025-03-13 16:54:12,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:12,460 [INFO]: 	Creating the index 03/13/2025, 16:54:12
2025-03-13 16:54:12,460 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:12
2025-03-13 16:54:12,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:54:12,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:12
2025-03-13 16:54:12,461 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:54:12,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.43it/s]  6%|▌         | 2/34 [00:00<00:05,  6.24it/s]  9%|▉         | 3/34 [00:00<00:04,  7.22it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.81it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.29it/s] 21%|██        | 7/34 [00:00<00:02,  9.23it/s] 26%|██▋       | 9/34 [00:01<00:02,  9.70it/s] 32%|███▏      | 11/34 [00:01<00:02, 10.19it/s] 38%|███▊      | 13/34 [00:01<00:02, 10.38it/s] 44%|████▍     | 15/34 [00:01<00:01, 10.45it/s] 50%|█████     | 17/34 [00:01<00:01, 10.72it/s] 56%|█████▌    | 19/34 [00:01<00:01, 10.72it/s] 62%|██████▏   | 21/34 [00:07<00:11,  1.15it/s] 65%|██████▍   | 22/34 [00:07<00:08,  1.36it/s] 68%|██████▊   | 23/34 [00:07<00:06,  1.65it/s] 71%|███████   | 24/34 [00:07<00:04,  2.04it/s] 74%|███████▎  | 25/34 [00:07<00:03,  2.53it/s] 79%|███████▉  | 27/34 [00:07<00:01,  3.74it/s] 85%|████████▌ | 29/34 [00:07<00:01,  4.98it/s] 91%|█████████ | 31/34 [00:08<00:00,  6.19it/s] 97%|█████████▋| 33/34 [00:08<00:00,  7.23it/s]100%|██████████| 34/34 [00:12<00:00,  2.69it/s]
2025-03-13 16:54:25,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:25
2025-03-13 16:55:38,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.4082 secs
2025-03-13 16:55:38,523 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 16:55:38,523 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 50%|█████     | 2/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 16:56:39,131 [INFO]: 	>>> Finished "Compute fast metrics" in 60.6073 secs
2025-03-13 16:56:39,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.6738 secs
2025-03-13 16:56:39,135 [INFO]: {
2025-03-13 16:56:39,135 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:39,135 [INFO]: 	index_param: efSearch=221
2025-03-13 16:56:39,135 [INFO]: 	index_path: knn.index
2025-03-13 16:56:39,135 [INFO]: 	size in bytes: 1623138790
2025-03-13 16:56:39,135 [INFO]: 	avg_search_speed_ms: 12.45450389955383
2025-03-13 16:56:39,135 [INFO]: 	99p_search_speed_ms: 23.399989129975445
2025-03-13 16:56:39,135 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:39,135 [INFO]: 	nb vectors: 8250
2025-03-13 16:56:39,135 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:39,135 [INFO]: 	compression ratio: 0.9993082600163846
2025-03-13 16:56:39,135 [INFO]: }
2025-03-13 16:56:39,136 [INFO]: 	>>> Finished "Creating the index" in 146.6754 secs
2025-03-13 16:56:39,136 [INFO]: >>> Finished "Launching the whole pipeline" in 146.7050 secs
2025-03-13 16:56:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 90745 [episode count 7/20]
[retrieval_preprocessing] for episode 35945 [episode count 8/20], we have num_retrieval=np.int64(8342) num_query=np.int64(534)
2025-03-13 16:56:47,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:49,010 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:49
2025-03-13 16:56:49,010 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.43it/s]
2025-03-13 16:56:49,036 [INFO]: There are 8342 embeddings of dim 49152
2025-03-13 16:56:49,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:56:49,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:49
2025-03-13 16:56:49,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:49,036 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 16:56:49,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:49,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:56:49,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:49
2025-03-13 16:56:49,036 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:49,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:56:49,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:49
2025-03-13 16:56:49,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:49,036 [INFO]: 	Creating the index 03/13/2025, 16:56:49
2025-03-13 16:56:49,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:49
2025-03-13 16:56:49,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:56:49,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:49
2025-03-13 16:56:49,037 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:56:49,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.86it/s]  9%|▉         | 3/34 [00:00<00:03,  8.80it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.31it/s] 21%|██        | 7/34 [00:00<00:02, 11.07it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.55it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.71it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.91it/s] 44%|████▍     | 15/34 [00:01<00:01, 12.01it/s] 50%|█████     | 17/34 [00:01<00:01, 12.16it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.20it/s] 62%|██████▏   | 21/34 [00:05<00:07,  1.65it/s] 65%|██████▍   | 22/34 [00:05<00:06,  1.93it/s] 68%|██████▊   | 23/34 [00:05<00:04,  2.30it/s] 71%|███████   | 24/34 [00:05<00:03,  2.79it/s] 74%|███████▎  | 25/34 [00:05<00:02,  3.34it/s] 76%|███████▋  | 26/34 [00:05<00:02,  3.96it/s] 79%|███████▉  | 27/34 [00:05<00:01,  4.62it/s] 82%|████████▏ | 28/34 [00:06<00:01,  5.27it/s] 85%|████████▌ | 29/34 [00:06<00:00,  5.94it/s] 88%|████████▊ | 30/34 [00:06<00:00,  6.42it/s] 91%|█████████ | 31/34 [00:06<00:00,  6.82it/s] 94%|█████████▍| 32/34 [00:06<00:00,  7.15it/s] 97%|█████████▋| 33/34 [00:06<00:00,  7.49it/s]100%|██████████| 34/34 [00:10<00:00,  1.16s/it]100%|██████████| 34/34 [00:10<00:00,  3.31it/s]
2025-03-13 16:56:59,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:59
2025-03-13 16:58:19,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.7074 secs
2025-03-13 16:58:19,013 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 16:58:19,014 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 16:58:50,360 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3460 secs
2025-03-13 16:58:50,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.3249 secs
2025-03-13 16:58:50,362 [INFO]: {
2025-03-13 16:58:50,363 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:50,363 [INFO]: 	index_param: efSearch=186
2025-03-13 16:58:50,363 [INFO]: 	index_path: knn.index
2025-03-13 16:58:50,363 [INFO]: 	size in bytes: 1641239110
2025-03-13 16:58:50,363 [INFO]: 	avg_search_speed_ms: 12.473623507233462
2025-03-13 16:58:50,363 [INFO]: 	99p_search_speed_ms: 21.072391711641103
2025-03-13 16:58:50,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:50,363 [INFO]: 	nb vectors: 8342
2025-03-13 16:58:50,363 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:50,363 [INFO]: 	compression ratio: 0.9993083433162886
2025-03-13 16:58:50,363 [INFO]: }
2025-03-13 16:58:50,363 [INFO]: 	>>> Finished "Creating the index" in 121.3263 secs
2025-03-13 16:58:50,363 [INFO]: >>> Finished "Launching the whole pipeline" in 121.3523 secs
2025-03-13 16:58:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 35945 [episode count 8/20]
[retrieval_preprocessing] for episode 52310 [episode count 9/20], we have num_retrieval=np.int64(8506) num_query=np.int64(370)
2025-03-13 16:58:57,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:58,685 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:58
2025-03-13 16:58:58,685 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.20it/s]
2025-03-13 16:58:58,714 [INFO]: There are 8506 embeddings of dim 49152
2025-03-13 16:58:58,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:58:58,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:58
2025-03-13 16:58:58,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:58,715 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 16:58:58,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:58,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:58:58,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:58
2025-03-13 16:58:58,715 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:58,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:58:58,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:58
2025-03-13 16:58:58,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:58,716 [INFO]: 	Creating the index 03/13/2025, 16:58:58
2025-03-13 16:58:58,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:58
2025-03-13 16:58:58,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:58:58,719 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:58
2025-03-13 16:58:58,720 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:58:58,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:15,  2.20it/s]  9%|▊         | 3/35 [00:00<00:05,  5.60it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.79it/s] 20%|██        | 7/35 [00:00<00:03,  9.27it/s] 26%|██▌       | 9/35 [00:01<00:02, 10.14it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.79it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.29it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.54it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.70it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.95it/s] 60%|██████    | 21/35 [00:05<00:08,  1.69it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.28it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.03it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.91it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.91it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.95it/s] 94%|█████████▍| 33/35 [00:06<00:00,  7.01it/s]100%|██████████| 35/35 [00:10<00:00,  1.35it/s]100%|██████████| 35/35 [00:10<00:00,  3.28it/s]
2025-03-13 16:59:09,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:09
2025-03-13 17:00:18,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1387 secs
2025-03-13 17:00:18,923 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:00:18,923 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s]
2025-03-13 17:01:01,447 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5241 secs
2025-03-13 17:01:01,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.7307 secs
2025-03-13 17:01:01,450 [INFO]: {
2025-03-13 17:01:01,450 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:01,450 [INFO]: 	index_param: efSearch=202
2025-03-13 17:01:01,450 [INFO]: 	index_path: knn.index
2025-03-13 17:01:01,450 [INFO]: 	size in bytes: 1673505190
2025-03-13 17:01:01,450 [INFO]: 	avg_search_speed_ms: 13.18606093884182
2025-03-13 17:01:01,450 [INFO]: 	99p_search_speed_ms: 22.72446692455559
2025-03-13 17:01:01,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:01,450 [INFO]: 	nb vectors: 8506
2025-03-13 17:01:01,450 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:01,450 [INFO]: 	compression ratio: 0.9993083128711421
2025-03-13 17:01:01,451 [INFO]: }
2025-03-13 17:01:01,451 [INFO]: 	>>> Finished "Creating the index" in 122.7345 secs
2025-03-13 17:01:01,451 [INFO]: >>> Finished "Launching the whole pipeline" in 122.7653 secs
2025-03-13 17:01:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 52310 [episode count 9/20]
[retrieval_preprocessing] for episode 69476 [episode count 10/20], we have num_retrieval=np.int64(8395) num_query=np.int64(481)
2025-03-13 17:01:09,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:10,270 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:10
2025-03-13 17:01:10,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-13 17:01:10,298 [INFO]: There are 8395 embeddings of dim 49152
2025-03-13 17:01:10,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:01:10,299 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:10,299 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 17:01:10,299 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:10,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:01:10,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,300 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:10,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:01:10,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:10
2025-03-13 17:01:10,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:10,301 [INFO]: 	Creating the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:10
2025-03-13 17:01:10,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:01:10,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,304 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:01:10,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.35it/s]  9%|▊         | 3/35 [00:00<00:03,  8.76it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.87it/s] 20%|██        | 7/35 [00:00<00:02, 10.29it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.16it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.46it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.32it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.39it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.55it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.49it/s] 60%|██████    | 21/35 [00:06<00:09,  1.41it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.91it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.56it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.35it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.27it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.35it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.84it/s]100%|██████████| 35/35 [00:11<00:00,  1.41it/s]100%|██████████| 35/35 [00:11<00:00,  3.18it/s]
2025-03-13 17:01:21,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:21
2025-03-13 17:02:32,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.4348 secs
2025-03-13 17:02:32,755 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:02:32,755 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 17:03:04,598 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8421 secs
2025-03-13 17:03:04,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.2972 secs
2025-03-13 17:03:04,602 [INFO]: {
2025-03-13 17:03:04,602 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:04,602 [INFO]: 	index_param: efSearch=170
2025-03-13 17:03:04,602 [INFO]: 	index_path: knn.index
2025-03-13 17:03:04,602 [INFO]: 	size in bytes: 1651666510
2025-03-13 17:03:04,602 [INFO]: 	avg_search_speed_ms: 11.523429191701355
2025-03-13 17:03:04,602 [INFO]: 	99p_search_speed_ms: 16.97608299087733
2025-03-13 17:03:04,602 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:04,602 [INFO]: 	nb vectors: 8395
2025-03-13 17:03:04,602 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:04,602 [INFO]: 	compression ratio: 0.9993083652219842
2025-03-13 17:03:04,602 [INFO]: }
2025-03-13 17:03:04,602 [INFO]: 	>>> Finished "Creating the index" in 114.3008 secs
2025-03-13 17:03:04,602 [INFO]: >>> Finished "Launching the whole pipeline" in 114.3313 secs
2025-03-13 17:03:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 69476 [episode count 10/20]
[retrieval_preprocessing] for episode 60309 [episode count 11/20], we have num_retrieval=np.int64(8466) num_query=np.int64(410)
2025-03-13 17:03:13,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:14,300 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:14
2025-03-13 17:03:14,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.73it/s]
2025-03-13 17:03:14,328 [INFO]: There are 8466 embeddings of dim 49152
2025-03-13 17:03:14,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:03:14,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,329 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:14,329 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 17:03:14,329 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:14,329 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:03:14,329 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,329 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:14,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:03:14,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:14
2025-03-13 17:03:14,330 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:14,330 [INFO]: 	Creating the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,330 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:14
2025-03-13 17:03:14,333 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:03:14,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,334 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:03:14,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.18it/s]  9%|▊         | 3/35 [00:00<00:03,  8.94it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.59it/s] 20%|██        | 7/35 [00:00<00:02, 11.67it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.09it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.31it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.56it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.47it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.05it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.19it/s] 60%|██████    | 21/35 [00:05<00:09,  1.50it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.77it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.49it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.37it/s] 80%|████████  | 28/35 [00:06<00:01,  4.35it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.41it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.46it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.47it/s]100%|██████████| 35/35 [00:10<00:00,  3.46it/s]
2025-03-13 17:03:24,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:24
2025-03-13 17:04:36,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.4867 secs
2025-03-13 17:04:36,951 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:04:36,951 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 17:05:34,590 [INFO]: 	>>> Finished "Compute fast metrics" in 57.6382 secs
2025-03-13 17:05:35,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.8043 secs
2025-03-13 17:05:35,138 [INFO]: {
2025-03-13 17:05:35,138 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:35,139 [INFO]: 	index_param: efSearch=170
2025-03-13 17:05:35,139 [INFO]: 	index_path: knn.index
2025-03-13 17:05:35,139 [INFO]: 	size in bytes: 1665635290
2025-03-13 17:05:35,139 [INFO]: 	avg_search_speed_ms: 9.87069102221142
2025-03-13 17:05:35,139 [INFO]: 	99p_search_speed_ms: 16.25602873042226
2025-03-13 17:05:35,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:35,139 [INFO]: 	nb vectors: 8466
2025-03-13 17:05:35,139 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:35,139 [INFO]: 	compression ratio: 0.9993083948167308
2025-03-13 17:05:35,139 [INFO]: }
2025-03-13 17:05:35,139 [INFO]: 	>>> Finished "Creating the index" in 140.8093 secs
2025-03-13 17:05:35,139 [INFO]: >>> Finished "Launching the whole pipeline" in 140.8387 secs
2025-03-13 17:05:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 60309 [episode count 11/20]
[retrieval_preprocessing] for episode 41890 [episode count 12/20], we have num_retrieval=np.int64(8129) num_query=np.int64(747)
2025-03-13 17:05:46,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:48,309 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:48
2025-03-13 17:05:48,309 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 17:05:48,335 [INFO]: There are 8129 embeddings of dim 49152
2025-03-13 17:05:48,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:05:48,336 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:48,336 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 17:05:48,336 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:48,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:48,336 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,336 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:48,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:48,336 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:48
2025-03-13 17:05:48,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:48,336 [INFO]: 	Creating the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,336 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:48
2025-03-13 17:05:48,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:05:48,338 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,338 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:05:48,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  5.33it/s]  9%|▉         | 3/33 [00:00<00:03,  8.82it/s] 15%|█▌        | 5/33 [00:00<00:02,  9.85it/s] 21%|██        | 7/33 [00:00<00:02, 10.54it/s] 27%|██▋       | 9/33 [00:00<00:02, 10.99it/s] 33%|███▎      | 11/33 [00:01<00:01, 11.30it/s] 39%|███▉      | 13/33 [00:01<00:01, 11.54it/s] 45%|████▌     | 15/33 [00:01<00:01, 11.77it/s] 52%|█████▏    | 17/33 [00:01<00:01, 12.04it/s] 58%|█████▊    | 19/33 [00:01<00:01, 12.17it/s] 64%|██████▎   | 21/33 [00:06<00:08,  1.36it/s] 70%|██████▉   | 23/33 [00:06<00:05,  1.86it/s] 73%|███████▎  | 24/33 [00:06<00:04,  2.18it/s] 79%|███████▉  | 26/33 [00:06<00:02,  2.99it/s] 85%|████████▍ | 28/33 [00:06<00:01,  3.95it/s] 91%|█████████ | 30/33 [00:06<00:00,  4.94it/s] 97%|█████████▋| 32/33 [00:07<00:00,  5.96it/s]100%|██████████| 33/33 [00:10<00:00,  3.07it/s]
2025-03-13 17:05:59,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:59
2025-03-13 17:07:14,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.6526 secs
2025-03-13 17:07:14,750 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:07:14,750 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 17:08:17,081 [INFO]: 	>>> Finished "Compute fast metrics" in 62.3301 secs
2025-03-13 17:08:17,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.7459 secs
2025-03-13 17:08:17,084 [INFO]: {
2025-03-13 17:08:17,084 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:17,084 [INFO]: 	index_param: efSearch=194
2025-03-13 17:08:17,084 [INFO]: 	index_path: knn.index
2025-03-13 17:08:17,084 [INFO]: 	size in bytes: 1599332770
2025-03-13 17:08:17,084 [INFO]: 	avg_search_speed_ms: 12.531620561481363
2025-03-13 17:08:17,084 [INFO]: 	99p_search_speed_ms: 21.79523576283827
2025-03-13 17:08:17,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:17,084 [INFO]: 	nb vectors: 8129
2025-03-13 17:08:17,084 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:17,084 [INFO]: 	compression ratio: 0.9993082502773953
2025-03-13 17:08:17,084 [INFO]: }
2025-03-13 17:08:17,084 [INFO]: 	>>> Finished "Creating the index" in 148.7478 secs
2025-03-13 17:08:17,084 [INFO]: >>> Finished "Launching the whole pipeline" in 148.7750 secs
2025-03-13 17:08:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 41890 [episode count 12/20]
[retrieval_preprocessing] for episode 19423 [episode count 13/20], we have num_retrieval=np.int64(8333) num_query=np.int64(543)
2025-03-13 17:08:28,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:30,249 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:30
2025-03-13 17:08:30,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.50it/s]
2025-03-13 17:08:30,278 [INFO]: There are 8333 embeddings of dim 49152
2025-03-13 17:08:30,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:08:30,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:30,279 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 17:08:30,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:30,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:08:30,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,280 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:30,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:08:30,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:30
2025-03-13 17:08:30,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:30,281 [INFO]: 	Creating the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:30
2025-03-13 17:08:30,284 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:08:30,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,285 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:08:30,285 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.76it/s]  9%|▉         | 3/34 [00:00<00:04,  7.59it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.99it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.38it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.73it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.39it/s] 29%|██▉       | 10/34 [00:01<00:02,  9.66it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.75it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.68it/s] 41%|████      | 14/34 [00:01<00:02,  9.56it/s] 44%|████▍     | 15/34 [00:01<00:01,  9.60it/s] 47%|████▋     | 16/34 [00:01<00:01,  9.58it/s] 53%|█████▎    | 18/34 [00:01<00:01,  9.45it/s] 56%|█████▌    | 19/34 [00:02<00:01,  8.99it/s] 59%|█████▉    | 20/34 [00:02<00:01,  8.70it/s] 62%|██████▏   | 21/34 [00:08<00:23,  1.78s/it] 68%|██████▊   | 23/34 [00:08<00:11,  1.05s/it] 74%|███████▎  | 25/34 [00:09<00:06,  1.46it/s] 79%|███████▉  | 27/34 [00:09<00:03,  2.13it/s] 85%|████████▌ | 29/34 [00:09<00:01,  2.96it/s] 91%|█████████ | 31/34 [00:09<00:00,  3.99it/s] 97%|█████████▋| 33/34 [00:09<00:00,  5.20it/s]100%|██████████| 34/34 [00:13<00:00,  2.47it/s]
2025-03-13 17:08:44,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:44
2025-03-13 17:10:02,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.7448 secs
2025-03-13 17:10:02,806 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 17:10:02,806 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 17:10:59,242 [INFO]: 	>>> Finished "Compute fast metrics" in 56.4360 secs
2025-03-13 17:10:59,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.9604 secs
2025-03-13 17:10:59,245 [INFO]: {
2025-03-13 17:10:59,245 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:59,245 [INFO]: 	index_param: efSearch=149
2025-03-13 17:10:59,245 [INFO]: 	index_path: knn.index
2025-03-13 17:10:59,245 [INFO]: 	size in bytes: 1639468450
2025-03-13 17:10:59,245 [INFO]: 	avg_search_speed_ms: 10.270196404470632
2025-03-13 17:10:59,245 [INFO]: 	99p_search_speed_ms: 18.78113616025075
2025-03-13 17:10:59,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:59,245 [INFO]: 	nb vectors: 8333
2025-03-13 17:10:59,245 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:59,245 [INFO]: 	compression ratio: 0.9993083209378015
2025-03-13 17:10:59,245 [INFO]: }
2025-03-13 17:10:59,246 [INFO]: 	>>> Finished "Creating the index" in 148.9648 secs
2025-03-13 17:10:59,246 [INFO]: >>> Finished "Launching the whole pipeline" in 148.9967 secs
2025-03-13 17:11:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 19423 [episode count 13/20]
[retrieval_preprocessing] for episode 42968 [episode count 14/20], we have num_retrieval=np.int64(8531) num_query=np.int64(345)
2025-03-13 17:11:07,273 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:08,411 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:08
2025-03-13 17:11:08,411 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.18it/s]
2025-03-13 17:11:08,438 [INFO]: There are 8531 embeddings of dim 49152
2025-03-13 17:11:08,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:11:08,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:08,438 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 17:11:08,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:08,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:08,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,438 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:08,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:08,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:08
2025-03-13 17:11:08,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:08,438 [INFO]: 	Creating the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,439 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:08
2025-03-13 17:11:08,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:11:08,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,440 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:11:08,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.22it/s]  9%|▊         | 3/35 [00:00<00:03,  9.31it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.21it/s] 20%|██        | 7/35 [00:00<00:02, 11.48it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.17it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.62it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.97it/s] 43%|████▎     | 15/35 [00:01<00:01, 13.15it/s] 49%|████▊     | 17/35 [00:01<00:01, 13.17it/s] 54%|█████▍    | 19/35 [00:01<00:01, 13.26it/s] 60%|██████    | 21/35 [00:05<00:09,  1.43it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.70it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.38it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.23it/s] 80%|████████  | 28/35 [00:06<00:01,  4.23it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.34it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.58it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.75it/s]100%|██████████| 35/35 [00:10<00:00,  3.35it/s]
2025-03-13 17:11:18,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:18
2025-03-13 17:12:29,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.8564 secs
2025-03-13 17:12:29,762 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:12:29,762 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 17:13:08,777 [INFO]: 	>>> Finished "Compute fast metrics" in 39.0142 secs
2025-03-13 17:13:08,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.3398 secs
2025-03-13 17:13:08,780 [INFO]: {
2025-03-13 17:13:08,780 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:08,780 [INFO]: 	index_param: efSearch=138
2025-03-13 17:13:08,780 [INFO]: 	index_path: knn.index
2025-03-13 17:13:08,780 [INFO]: 	size in bytes: 1678423690
2025-03-13 17:13:08,780 [INFO]: 	avg_search_speed_ms: 10.981068843934771
2025-03-13 17:13:08,780 [INFO]: 	99p_search_speed_ms: 18.63738514948636
2025-03-13 17:13:08,780 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:08,780 [INFO]: 	nb vectors: 8531
2025-03-13 17:13:08,780 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:08,780 [INFO]: 	compression ratio: 0.9993083736800689
2025-03-13 17:13:08,780 [INFO]: }
2025-03-13 17:13:08,780 [INFO]: 	>>> Finished "Creating the index" in 120.3417 secs
2025-03-13 17:13:08,780 [INFO]: >>> Finished "Launching the whole pipeline" in 120.3689 secs
2025-03-13 17:13:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 42968 [episode count 14/20]
[retrieval_preprocessing] for episode 14090 [episode count 15/20], we have num_retrieval=np.int64(8459) num_query=np.int64(417)
2025-03-13 17:13:14,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:15,793 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:15
2025-03-13 17:13:15,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.31it/s]
2025-03-13 17:13:15,820 [INFO]: There are 8459 embeddings of dim 49152
2025-03-13 17:13:15,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:13:15,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:15
2025-03-13 17:13:15,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:15,820 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 17:13:15,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:15,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:15,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:15
2025-03-13 17:13:15,820 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:15,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:13:15,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:15
2025-03-13 17:13:15,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:15,820 [INFO]: 	Creating the index 03/13/2025, 17:13:15
2025-03-13 17:13:15,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:15
2025-03-13 17:13:15,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:13:15,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:15
2025-03-13 17:13:15,822 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:13:15,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.15it/s]  9%|▊         | 3/35 [00:00<00:03,  9.70it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.23it/s] 20%|██        | 7/35 [00:00<00:02, 10.50it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.80it/s] 34%|███▍      | 12/35 [00:01<00:01, 13.85it/s] 43%|████▎     | 15/35 [00:01<00:01, 16.20it/s] 49%|████▊     | 17/35 [00:01<00:01, 16.67it/s] 54%|█████▍    | 19/35 [00:01<00:00, 17.11it/s] 60%|██████    | 21/35 [00:05<00:08,  1.72it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.33it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.04it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.89it/s] 83%|████████▎ | 29/35 [00:05<00:01,  4.86it/s] 89%|████████▊ | 31/35 [00:05<00:00,  5.89it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.93it/s]100%|██████████| 35/35 [00:09<00:00,  1.77it/s]100%|██████████| 35/35 [00:09<00:00,  3.79it/s]
2025-03-13 17:13:25,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:25
2025-03-13 17:14:46,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.2075 secs
2025-03-13 17:14:46,268 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:14:46,268 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-13 17:15:39,025 [INFO]: 	>>> Finished "Compute fast metrics" in 52.7569 secs
2025-03-13 17:15:39,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.8529 secs
2025-03-13 17:15:39,675 [INFO]: {
2025-03-13 17:15:39,675 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:39,675 [INFO]: 	index_param: efSearch=190
2025-03-13 17:15:39,675 [INFO]: 	index_path: knn.index
2025-03-13 17:15:39,675 [INFO]: 	size in bytes: 1664258110
2025-03-13 17:15:39,675 [INFO]: 	avg_search_speed_ms: 11.956788069571912
2025-03-13 17:15:39,675 [INFO]: 	99p_search_speed_ms: 19.777947282418605
2025-03-13 17:15:39,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:39,675 [INFO]: 	nb vectors: 8459
2025-03-13 17:15:39,675 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:39,675 [INFO]: 	compression ratio: 0.9993083777131181
2025-03-13 17:15:39,676 [INFO]: }
2025-03-13 17:15:39,676 [INFO]: 	>>> Finished "Creating the index" in 143.8551 secs
2025-03-13 17:15:39,676 [INFO]: >>> Finished "Launching the whole pipeline" in 143.8824 secs
2025-03-13 17:15:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 14090 [episode count 15/20]
[retrieval_preprocessing] for episode 27413 [episode count 16/20], we have num_retrieval=np.int64(8514) num_query=np.int64(362)
2025-03-13 17:15:52,880 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:54,519 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:54
2025-03-13 17:15:54,520 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-13 17:15:54,545 [INFO]: There are 8514 embeddings of dim 49152
2025-03-13 17:15:54,545 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:15:54,545 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:54
2025-03-13 17:15:54,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:54,546 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 17:15:54,546 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:54,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:54,546 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:54
2025-03-13 17:15:54,546 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:54,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:15:54,546 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:54
2025-03-13 17:15:54,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:54,546 [INFO]: 	Creating the index 03/13/2025, 17:15:54
2025-03-13 17:15:54,546 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:54
2025-03-13 17:15:54,547 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:15:54,547 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:54
2025-03-13 17:15:54,547 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:15:54,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.59it/s]  6%|▌         | 2/35 [00:00<00:05,  6.17it/s]  9%|▊         | 3/35 [00:00<00:04,  6.85it/s] 11%|█▏        | 4/35 [00:00<00:04,  7.47it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.80it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.35it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.44it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.80it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.93it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.08it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.43it/s] 54%|█████▍    | 19/35 [00:01<00:01, 10.95it/s] 60%|██████    | 21/35 [00:06<00:10,  1.35it/s] 63%|██████▎   | 22/35 [00:06<00:08,  1.59it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.87it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.26it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.65it/s] 74%|███████▍  | 26/35 [00:07<00:02,  3.09it/s] 77%|███████▋  | 27/35 [00:07<00:02,  3.78it/s] 80%|████████  | 28/35 [00:07<00:01,  4.54it/s] 83%|████████▎ | 29/35 [00:07<00:01,  5.27it/s] 86%|████████▌ | 30/35 [00:07<00:00,  5.96it/s] 89%|████████▊ | 31/35 [00:07<00:00,  6.60it/s] 91%|█████████▏| 32/35 [00:07<00:00,  7.20it/s] 94%|█████████▍| 33/35 [00:07<00:00,  7.63it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.95it/s]100%|██████████| 35/35 [00:12<00:00,  1.36s/it]100%|██████████| 35/35 [00:12<00:00,  2.86it/s]
2025-03-13 17:16:07,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:07
2025-03-13 17:17:20,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.7719 secs
2025-03-13 17:17:20,786 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:17:20,787 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 17:18:04,556 [INFO]: 	>>> Finished "Compute fast metrics" in 43.7681 secs
2025-03-13 17:18:04,559 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.0114 secs
2025-03-13 17:18:04,559 [INFO]: {
2025-03-13 17:18:04,559 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:04,559 [INFO]: 	index_param: efSearch=183
2025-03-13 17:18:04,559 [INFO]: 	index_path: knn.index
2025-03-13 17:18:04,559 [INFO]: 	size in bytes: 1675079110
2025-03-13 17:18:04,559 [INFO]: 	avg_search_speed_ms: 13.782056563882767
2025-03-13 17:18:04,559 [INFO]: 	99p_search_speed_ms: 30.6124992785044
2025-03-13 17:18:04,559 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:04,559 [INFO]: 	nb vectors: 8514
2025-03-13 17:18:04,559 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:04,559 [INFO]: 	compression ratio: 0.9993083323688515
2025-03-13 17:18:04,559 [INFO]: }
2025-03-13 17:18:04,559 [INFO]: 	>>> Finished "Creating the index" in 130.0131 secs
2025-03-13 17:18:04,559 [INFO]: >>> Finished "Launching the whole pipeline" in 130.0394 secs
2025-03-13 17:18:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 27413 [episode count 16/20]
[retrieval_preprocessing] for episode 27506 [episode count 17/20], we have num_retrieval=np.int64(8396) num_query=np.int64(480)
2025-03-13 17:18:10,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:11,940 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:11
2025-03-13 17:18:11,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 17:18:12,460 [INFO]: There are 8396 embeddings of dim 49152
2025-03-13 17:18:12,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5200 secs
2025-03-13 17:18:12,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:12
2025-03-13 17:18:12,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:12,460 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 17:18:12,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:12,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:18:12,460 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:12
2025-03-13 17:18:12,461 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:12,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:18:12,461 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:12
2025-03-13 17:18:12,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:12,461 [INFO]: 	Creating the index 03/13/2025, 17:18:12
2025-03-13 17:18:12,461 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:12
2025-03-13 17:18:12,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:18:12,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:12
2025-03-13 17:18:12,464 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:18:12,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.76it/s]  9%|▊         | 3/35 [00:00<00:03,  8.55it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.07it/s] 20%|██        | 7/35 [00:00<00:02, 10.61it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.01it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.95it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.84it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.76it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.75it/s] 54%|█████▍    | 19/35 [00:01<00:01, 10.79it/s] 60%|██████    | 21/35 [00:06<00:10,  1.40it/s] 63%|██████▎   | 22/35 [00:06<00:07,  1.65it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.20it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.15it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.57it/s]100%|██████████| 35/35 [00:10<00:00,  3.44it/s]
2025-03-13 17:18:22,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:22
2025-03-13 17:19:42,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.7607 secs
2025-03-13 17:19:42,393 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:19:42,393 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 17:20:25,375 [INFO]: 	>>> Finished "Compute fast metrics" in 42.9817 secs
2025-03-13 17:20:25,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.9140 secs
2025-03-13 17:20:25,378 [INFO]: {
2025-03-13 17:20:25,378 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:25,378 [INFO]: 	index_param: efSearch=212
2025-03-13 17:20:25,378 [INFO]: 	index_path: knn.index
2025-03-13 17:20:25,378 [INFO]: 	size in bytes: 1651863250
2025-03-13 17:20:25,378 [INFO]: 	avg_search_speed_ms: 13.080838099852496
2025-03-13 17:20:25,378 [INFO]: 	99p_search_speed_ms: 23.818956213071974
2025-03-13 17:20:25,378 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:25,378 [INFO]: 	nb vectors: 8396
2025-03-13 17:20:25,378 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:25,378 [INFO]: 	compression ratio: 0.9993083676872162
2025-03-13 17:20:25,378 [INFO]: }
2025-03-13 17:20:25,378 [INFO]: 	>>> Finished "Creating the index" in 132.9167 secs
2025-03-13 17:20:25,378 [INFO]: >>> Finished "Launching the whole pipeline" in 133.4380 secs
2025-03-13 17:20:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 27506 [episode count 17/20]
[retrieval_preprocessing] for episode 79171 [episode count 18/20], we have num_retrieval=np.int64(8602) num_query=np.int64(274)
2025-03-13 17:20:34,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:35,657 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:35
2025-03-13 17:20:35,657 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.52it/s]
2025-03-13 17:20:35,685 [INFO]: There are 8602 embeddings of dim 49152
2025-03-13 17:20:35,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:20:35,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:35
2025-03-13 17:20:35,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:35,686 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 17:20:35,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:35,686 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:20:35,687 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:35
2025-03-13 17:20:35,687 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:35,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:20:35,687 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:35
2025-03-13 17:20:35,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:35,688 [INFO]: 	Creating the index 03/13/2025, 17:20:35
2025-03-13 17:20:35,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:35
2025-03-13 17:20:35,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:20:35,692 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:35
2025-03-13 17:20:35,692 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:20:35,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.17it/s]  9%|▊         | 3/35 [00:00<00:03,  8.46it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.53it/s] 20%|██        | 7/35 [00:00<00:02, 10.11it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.50it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.70it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.02it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.20it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.38it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.39it/s] 60%|██████    | 21/35 [00:05<00:09,  1.46it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.72it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.41it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.25it/s] 80%|████████  | 28/35 [00:06<00:01,  4.20it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.24it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.30it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.29it/s]100%|██████████| 35/35 [00:10<00:00,  3.32it/s]
2025-03-13 17:20:46,260 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:46
2025-03-13 17:21:54,231 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.9702 secs
2025-03-13 17:21:54,231 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:21:54,232 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 17:22:34,352 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1199 secs
2025-03-13 17:22:34,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.6632 secs
2025-03-13 17:22:34,355 [INFO]: {
2025-03-13 17:22:34,355 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:34,355 [INFO]: 	index_param: efSearch=213
2025-03-13 17:22:34,355 [INFO]: 	index_path: knn.index
2025-03-13 17:22:34,355 [INFO]: 	size in bytes: 1692392470
2025-03-13 17:22:34,355 [INFO]: 	avg_search_speed_ms: 12.820754254775816
2025-03-13 17:22:34,355 [INFO]: 	99p_search_speed_ms: 19.741401122882962
2025-03-13 17:22:34,355 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:34,355 [INFO]: 	nb vectors: 8602
2025-03-13 17:22:34,355 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:34,355 [INFO]: 	compression ratio: 0.9993084027371028
2025-03-13 17:22:34,355 [INFO]: }
2025-03-13 17:22:34,355 [INFO]: 	>>> Finished "Creating the index" in 118.6675 secs
2025-03-13 17:22:34,355 [INFO]: >>> Finished "Launching the whole pipeline" in 118.6986 secs
2025-03-13 17:22:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 79171 [episode count 18/20]
[retrieval_preprocessing] for episode 10125 [episode count 19/20], we have num_retrieval=np.int64(8501) num_query=np.int64(375)
2025-03-13 17:22:40,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:42,202 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:42
2025-03-13 17:22:42,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1287.39it/s]
2025-03-13 17:22:42,228 [INFO]: There are 8501 embeddings of dim 49152
2025-03-13 17:22:42,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:22:42,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:42,228 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 17:22:42,228 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:42,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:42,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,228 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:42,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:22:42,228 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:42
2025-03-13 17:22:42,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:42,228 [INFO]: 	Creating the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:42
2025-03-13 17:22:42,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:22:42,230 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,230 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:22:42,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.50it/s]  6%|▌         | 2/35 [00:00<00:05,  6.25it/s]  9%|▊         | 3/35 [00:00<00:04,  7.49it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.69it/s] 17%|█▋        | 6/35 [00:00<00:03,  9.02it/s] 20%|██        | 7/35 [00:00<00:03,  9.07it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.30it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.42it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.50it/s] 34%|███▍      | 12/35 [00:01<00:02,  9.61it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.45it/s] 40%|████      | 14/35 [00:01<00:02,  9.02it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.74it/s] 46%|████▌     | 16/35 [00:01<00:02,  8.56it/s] 51%|█████▏    | 18/35 [00:02<00:01,  9.23it/s] 57%|█████▋    | 20/35 [00:02<00:01,  9.67it/s] 60%|██████    | 21/35 [00:06<00:13,  1.02it/s] 63%|██████▎   | 22/35 [00:06<00:09,  1.30it/s] 69%|██████▊   | 24/35 [00:06<00:05,  2.04it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.93it/s] 80%|████████  | 28/35 [00:06<00:01,  3.94it/s] 86%|████████▌ | 30/35 [00:07<00:00,  5.06it/s] 91%|█████████▏| 32/35 [00:07<00:00,  6.09it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.03it/s]100%|██████████| 35/35 [00:11<00:00,  2.92it/s]
2025-03-13 17:22:54,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:54
2025-03-13 17:24:06,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.3722 secs
2025-03-13 17:24:06,596 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 17:24:06,596 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 17:24:52,736 [INFO]: 	>>> Finished "Compute fast metrics" in 46.1399 secs
2025-03-13 17:24:52,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.5091 secs
2025-03-13 17:24:52,739 [INFO]: {
2025-03-13 17:24:52,739 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:52,739 [INFO]: 	index_param: efSearch=186
2025-03-13 17:24:52,739 [INFO]: 	index_path: knn.index
2025-03-13 17:24:52,739 [INFO]: 	size in bytes: 1672521490
2025-03-13 17:24:52,739 [INFO]: 	avg_search_speed_ms: 11.364672378509898
2025-03-13 17:24:52,739 [INFO]: 	99p_search_speed_ms: 17.386725465767093
2025-03-13 17:24:52,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:52,739 [INFO]: 	nb vectors: 8501
2025-03-13 17:24:52,739 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:52,739 [INFO]: 	compression ratio: 0.9993083006664387
2025-03-13 17:24:52,739 [INFO]: }
2025-03-13 17:24:52,739 [INFO]: 	>>> Finished "Creating the index" in 130.5107 secs
2025-03-13 17:24:52,739 [INFO]: >>> Finished "Launching the whole pipeline" in 130.5369 secs
2025-03-13 17:24:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 10125 [episode count 19/20]
2025-03-13 17:24:59: [retrieval_preprocessing] finished for 3774560981_put_towel_in_box [chosen_id count 4/196]
2025-03-13 17:25:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3774560981_put_cloth_in_box [chosen_id count 5/196]
2025-03-13 17:25:03: [retrieval_preprocessing] we have num_total=8278 embedding_dim=49152
[retrieval_preprocessing] for episode 35354 [episode count 0/20], we have num_retrieval=np.int64(7774) num_query=np.int64(504)
2025-03-13 17:25:06,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:07,748 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:07
2025-03-13 17:25:07,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.95it/s]
2025-03-13 17:25:07,870 [INFO]: There are 7774 embeddings of dim 49152
2025-03-13 17:25:07,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1221 secs
2025-03-13 17:25:07,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:07
2025-03-13 17:25:07,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:07,871 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:25:07,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:07,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:25:07,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:07
2025-03-13 17:25:07,871 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:07,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:25:07,872 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:07
2025-03-13 17:25:07,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:07,872 [INFO]: 	Creating the index 03/13/2025, 17:25:07
2025-03-13 17:25:07,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:07
2025-03-13 17:25:07,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:25:07,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:07
2025-03-13 17:25:07,876 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:25:07,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:05,  5.58it/s]  9%|▉         | 3/32 [00:00<00:03,  8.76it/s] 12%|█▎        | 4/32 [00:00<00:03,  8.80it/s] 16%|█▌        | 5/32 [00:00<00:02,  9.03it/s] 22%|██▏       | 7/32 [00:00<00:02,  9.89it/s] 28%|██▊       | 9/32 [00:00<00:01, 11.51it/s] 34%|███▍      | 11/32 [00:01<00:01, 12.86it/s] 41%|████      | 13/32 [00:01<00:01, 12.82it/s] 47%|████▋     | 15/32 [00:01<00:01, 12.76it/s] 53%|█████▎    | 17/32 [00:01<00:01, 12.76it/s] 59%|█████▉    | 19/32 [00:01<00:01, 12.42it/s] 66%|██████▌   | 21/32 [00:06<00:08,  1.35it/s] 72%|███████▏  | 23/32 [00:06<00:04,  1.87it/s] 78%|███████▊  | 25/32 [00:06<00:02,  2.58it/s] 84%|████████▍ | 27/32 [00:06<00:01,  3.48it/s] 91%|█████████ | 29/32 [00:06<00:00,  4.44it/s] 97%|█████████▋| 31/32 [00:06<00:00,  5.67it/s]100%|██████████| 32/32 [00:09<00:00,  3.20it/s]
2025-03-13 17:25:17,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:17
2025-03-13 17:26:17,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0957 secs
2025-03-13 17:26:17,964 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:26:17,964 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 17:26:50,496 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5319 secs
2025-03-13 17:26:50,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.6229 secs
2025-03-13 17:26:50,499 [INFO]: {
2025-03-13 17:26:50,499 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:50,499 [INFO]: 	index_param: efSearch=153
2025-03-13 17:26:50,499 [INFO]: 	index_path: knn.index
2025-03-13 17:26:50,499 [INFO]: 	size in bytes: 1529488930
2025-03-13 17:26:50,499 [INFO]: 	avg_search_speed_ms: 10.473594892799309
2025-03-13 17:26:50,499 [INFO]: 	99p_search_speed_ms: 17.74404137395323
2025-03-13 17:26:50,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:50,499 [INFO]: 	nb vectors: 7774
2025-03-13 17:26:50,499 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:50,499 [INFO]: 	compression ratio: 0.9993080446813041
2025-03-13 17:26:50,499 [INFO]: }
2025-03-13 17:26:50,499 [INFO]: 	>>> Finished "Creating the index" in 102.6267 secs
2025-03-13 17:26:50,499 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7511 secs
2025-03-13 17:26:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 35354 [episode count 0/20]
[retrieval_preprocessing] for episode 75831 [episode count 1/20], we have num_retrieval=np.int64(7779) num_query=np.int64(499)
2025-03-13 17:26:57,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:58,359 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:58
2025-03-13 17:26:58,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-13 17:26:58,386 [INFO]: There are 7779 embeddings of dim 49152
2025-03-13 17:26:58,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:26:58,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:58
2025-03-13 17:26:58,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:58,387 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:26:58,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:58,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:26:58,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:58
2025-03-13 17:26:58,387 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:58,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:26:58,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:58
2025-03-13 17:26:58,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:58,388 [INFO]: 	Creating the index 03/13/2025, 17:26:58
2025-03-13 17:26:58,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:58
2025-03-13 17:26:58,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:26:58,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:58
2025-03-13 17:26:58,391 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:26:58,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:05,  6.10it/s]  9%|▉         | 3/32 [00:00<00:03,  9.16it/s] 16%|█▌        | 5/32 [00:00<00:02, 10.10it/s] 22%|██▏       | 7/32 [00:00<00:02, 11.44it/s] 28%|██▊       | 9/32 [00:00<00:01, 12.64it/s] 34%|███▍      | 11/32 [00:00<00:01, 13.56it/s] 41%|████      | 13/32 [00:01<00:01, 13.59it/s] 47%|████▋     | 15/32 [00:01<00:01, 12.67it/s] 53%|█████▎    | 17/32 [00:01<00:01, 12.87it/s] 62%|██████▎   | 20/32 [00:01<00:00, 14.69it/s] 69%|██████▉   | 22/32 [00:05<00:05,  1.68it/s] 75%|███████▌  | 24/32 [00:05<00:03,  2.24it/s] 81%|████████▏ | 26/32 [00:05<00:02,  2.96it/s] 88%|████████▊ | 28/32 [00:05<00:01,  3.82it/s] 94%|█████████▍| 30/32 [00:06<00:00,  4.89it/s]100%|██████████| 32/32 [00:08<00:00,  1.87it/s]100%|██████████| 32/32 [00:08<00:00,  3.67it/s]
2025-03-13 17:27:07,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:07
2025-03-13 17:28:18,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.8248 secs
2025-03-13 17:28:18,937 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:28:18,937 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.50it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 17:29:26,136 [INFO]: 	>>> Finished "Compute fast metrics" in 67.1989 secs
2025-03-13 17:29:26,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.7486 secs
2025-03-13 17:29:26,140 [INFO]: {
2025-03-13 17:29:26,140 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:26,140 [INFO]: 	index_param: efSearch=198
2025-03-13 17:29:26,140 [INFO]: 	index_path: knn.index
2025-03-13 17:29:26,140 [INFO]: 	size in bytes: 1530472630
2025-03-13 17:29:26,140 [INFO]: 	avg_search_speed_ms: 14.350976407129739
2025-03-13 17:29:26,140 [INFO]: 	99p_search_speed_ms: 22.313283458352064
2025-03-13 17:29:26,140 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:26,140 [INFO]: 	nb vectors: 7779
2025-03-13 17:29:26,140 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:26,140 [INFO]: 	compression ratio: 0.9993080581911484
2025-03-13 17:29:26,140 [INFO]: }
2025-03-13 17:29:26,140 [INFO]: 	>>> Finished "Creating the index" in 147.7522 secs
2025-03-13 17:29:26,140 [INFO]: >>> Finished "Launching the whole pipeline" in 147.7806 secs
2025-03-13 17:29:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 75831 [episode count 1/20]
[retrieval_preprocessing] for episode 8294 [episode count 2/20], we have num_retrieval=np.int64(7898) num_query=np.int64(380)
2025-03-13 17:29:35,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:36,950 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:36
2025-03-13 17:29:36,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-13 17:29:36,977 [INFO]: There are 7898 embeddings of dim 49152
2025-03-13 17:29:36,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:29:36,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:36
2025-03-13 17:29:36,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:36,977 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:29:36,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:36,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:36,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:36
2025-03-13 17:29:36,978 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:36,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:36,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:36
2025-03-13 17:29:36,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:36,978 [INFO]: 	Creating the index 03/13/2025, 17:29:36
2025-03-13 17:29:36,978 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:36
2025-03-13 17:29:36,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:29:36,979 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:36
2025-03-13 17:29:36,979 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:29:36,979 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:08,  3.72it/s]  9%|▉         | 3/33 [00:00<00:04,  7.20it/s] 15%|█▌        | 5/33 [00:00<00:03,  8.66it/s] 21%|██        | 7/33 [00:00<00:02,  9.50it/s] 27%|██▋       | 9/33 [00:01<00:02, 10.02it/s] 33%|███▎      | 11/33 [00:01<00:02, 10.26it/s] 39%|███▉      | 13/33 [00:01<00:01, 10.57it/s] 45%|████▌     | 15/33 [00:01<00:01, 10.72it/s] 52%|█████▏    | 17/33 [00:01<00:01, 10.93it/s] 58%|█████▊    | 19/33 [00:01<00:01, 10.95it/s] 64%|██████▎   | 21/33 [00:07<00:10,  1.14it/s] 67%|██████▋   | 22/33 [00:07<00:08,  1.36it/s] 73%|███████▎  | 24/33 [00:07<00:04,  1.93it/s] 79%|███████▉  | 26/33 [00:07<00:02,  2.65it/s] 85%|████████▍ | 28/33 [00:07<00:01,  3.49it/s] 91%|█████████ | 30/33 [00:08<00:00,  4.43it/s] 97%|█████████▋| 32/33 [00:08<00:00,  5.41it/s]100%|██████████| 33/33 [00:12<00:00,  2.73it/s]
2025-03-13 17:29:49,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:49
2025-03-13 17:31:01,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.9937 secs
2025-03-13 17:31:01,642 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:31:01,642 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 17:31:34,638 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9961 secs
2025-03-13 17:31:34,951 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.9720 secs
2025-03-13 17:31:34,952 [INFO]: {
2025-03-13 17:31:34,952 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:34,952 [INFO]: 	index_param: efSearch=174
2025-03-13 17:31:34,952 [INFO]: 	index_path: knn.index
2025-03-13 17:31:34,952 [INFO]: 	size in bytes: 1553885110
2025-03-13 17:31:34,952 [INFO]: 	avg_search_speed_ms: 11.934150470451836
2025-03-13 17:31:34,952 [INFO]: 	99p_search_speed_ms: 18.22189495433122
2025-03-13 17:31:34,952 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:34,952 [INFO]: 	nb vectors: 7898
2025-03-13 17:31:34,952 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:34,952 [INFO]: 	compression ratio: 0.9993081045740891
2025-03-13 17:31:34,952 [INFO]: }
2025-03-13 17:31:34,952 [INFO]: 	>>> Finished "Creating the index" in 117.9746 secs
2025-03-13 17:31:34,952 [INFO]: >>> Finished "Launching the whole pipeline" in 118.0022 secs
2025-03-13 17:31:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 8294 [episode count 2/20]
[retrieval_preprocessing] for episode 32873 [episode count 3/20], we have num_retrieval=np.int64(7909) num_query=np.int64(369)
2025-03-13 17:31:41,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:43,168 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:43
2025-03-13 17:31:43,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1053.58it/s]
2025-03-13 17:31:43,197 [INFO]: There are 7909 embeddings of dim 49152
2025-03-13 17:31:43,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:31:43,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:43
2025-03-13 17:31:43,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:43,197 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:31:43,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:43,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:43,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:43
2025-03-13 17:31:43,198 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:43,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:31:43,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:43
2025-03-13 17:31:43,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:43,198 [INFO]: 	Creating the index 03/13/2025, 17:31:43
2025-03-13 17:31:43,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:43
2025-03-13 17:31:43,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:31:43,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:43
2025-03-13 17:31:43,200 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:31:43,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  4.59it/s]  6%|▌         | 2/33 [00:00<00:05,  6.13it/s]  9%|▉         | 3/33 [00:00<00:04,  6.77it/s] 12%|█▏        | 4/33 [00:00<00:04,  7.19it/s] 15%|█▌        | 5/33 [00:00<00:03,  7.37it/s] 18%|█▊        | 6/33 [00:00<00:03,  7.68it/s] 21%|██        | 7/33 [00:00<00:03,  7.56it/s] 24%|██▍       | 8/33 [00:01<00:03,  7.56it/s] 27%|██▋       | 9/33 [00:01<00:03,  7.85it/s] 30%|███       | 10/33 [00:01<00:02,  8.23it/s] 33%|███▎      | 11/33 [00:01<00:02,  8.54it/s] 36%|███▋      | 12/33 [00:01<00:02,  8.87it/s] 39%|███▉      | 13/33 [00:01<00:02,  8.99it/s] 42%|████▏     | 14/33 [00:01<00:02,  9.14it/s] 45%|████▌     | 15/33 [00:01<00:01,  9.26it/s] 48%|████▊     | 16/33 [00:01<00:01,  9.43it/s] 55%|█████▍    | 18/33 [00:02<00:01,  9.64it/s] 58%|█████▊    | 19/33 [00:02<00:01,  9.32it/s] 64%|██████▎   | 21/33 [00:07<00:12,  1.07s/it] 67%|██████▋   | 22/33 [00:07<00:09,  1.16it/s] 70%|██████▉   | 23/33 [00:07<00:06,  1.46it/s] 73%|███████▎  | 24/33 [00:07<00:04,  1.84it/s] 76%|███████▌  | 25/33 [00:07<00:03,  2.30it/s] 79%|███████▉  | 26/33 [00:07<00:02,  2.85it/s] 82%|████████▏ | 27/33 [00:07<00:01,  3.48it/s] 85%|████████▍ | 28/33 [00:08<00:01,  4.18it/s] 88%|████████▊ | 29/33 [00:08<00:00,  4.83it/s] 91%|█████████ | 30/33 [00:08<00:00,  5.41it/s] 94%|█████████▍| 31/33 [00:08<00:00,  5.97it/s] 97%|█████████▋| 32/33 [00:08<00:00,  6.44it/s]100%|██████████| 33/33 [00:12<00:00,  1.26s/it]100%|██████████| 33/33 [00:12<00:00,  2.64it/s]
2025-03-13 17:31:55,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:55
2025-03-13 17:33:02,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.1950 secs
2025-03-13 17:33:02,886 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:33:02,886 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 17:33:36,205 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3182 secs
2025-03-13 17:33:36,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.0075 secs
2025-03-13 17:33:36,207 [INFO]: {
2025-03-13 17:33:36,207 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:36,207 [INFO]: 	index_param: efSearch=183
2025-03-13 17:33:36,207 [INFO]: 	index_path: knn.index
2025-03-13 17:33:36,207 [INFO]: 	size in bytes: 1556049250
2025-03-13 17:33:36,207 [INFO]: 	avg_search_speed_ms: 12.20817444448033
2025-03-13 17:33:36,207 [INFO]: 	99p_search_speed_ms: 21.59613902680575
2025-03-13 17:33:36,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:36,207 [INFO]: 	nb vectors: 7909
2025-03-13 17:33:36,207 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:36,207 [INFO]: 	compression ratio: 0.9993081337239165
2025-03-13 17:33:36,207 [INFO]: }
2025-03-13 17:33:36,207 [INFO]: 	>>> Finished "Creating the index" in 113.0094 secs
2025-03-13 17:33:36,207 [INFO]: >>> Finished "Launching the whole pipeline" in 113.0392 secs
2025-03-13 17:33:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 32873 [episode count 3/20]
[retrieval_preprocessing] for episode 51825 [episode count 4/20], we have num_retrieval=np.int64(7798) num_query=np.int64(480)
2025-03-13 17:33:42,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:44,038 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:44
2025-03-13 17:33:44,039 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.98it/s]
2025-03-13 17:33:44,065 [INFO]: There are 7798 embeddings of dim 49152
2025-03-13 17:33:44,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:33:44,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:44,065 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:33:44,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:44,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:44,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,066 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:44,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:33:44,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:44
2025-03-13 17:33:44,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:44,066 [INFO]: 	Creating the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:44
2025-03-13 17:33:44,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:33:44,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,067 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:33:44,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  4.79it/s]  9%|▉         | 3/32 [00:00<00:03,  8.04it/s] 16%|█▌        | 5/32 [00:00<00:03,  8.97it/s] 19%|█▉        | 6/32 [00:00<00:02,  8.72it/s] 22%|██▏       | 7/32 [00:00<00:02,  8.60it/s] 25%|██▌       | 8/32 [00:00<00:02,  8.45it/s] 28%|██▊       | 9/32 [00:01<00:02,  8.36it/s] 31%|███▏      | 10/32 [00:01<00:02,  8.32it/s] 34%|███▍      | 11/32 [00:01<00:02,  8.59it/s] 41%|████      | 13/32 [00:01<00:02,  9.43it/s] 47%|████▋     | 15/32 [00:01<00:01,  9.80it/s] 53%|█████▎    | 17/32 [00:01<00:01, 10.04it/s] 59%|█████▉    | 19/32 [00:02<00:01, 10.20it/s] 66%|██████▌   | 21/32 [00:06<00:08,  1.25it/s] 72%|███████▏  | 23/32 [00:06<00:05,  1.74it/s] 78%|███████▊  | 25/32 [00:06<00:02,  2.35it/s] 84%|████████▍ | 27/32 [00:07<00:01,  3.09it/s] 91%|█████████ | 29/32 [00:07<00:00,  3.96it/s] 97%|█████████▋| 31/32 [00:07<00:00,  4.92it/s]100%|██████████| 32/32 [00:10<00:00,  3.02it/s]
2025-03-13 17:33:54,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:54
2025-03-13 17:35:10,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2116 secs
2025-03-13 17:35:10,893 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:35:10,893 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 17:35:58,928 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0348 secs
2025-03-13 17:35:59,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.9939 secs
2025-03-13 17:35:59,061 [INFO]: {
2025-03-13 17:35:59,062 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:59,062 [INFO]: 	index_param: efSearch=162
2025-03-13 17:35:59,062 [INFO]: 	index_path: knn.index
2025-03-13 17:35:59,062 [INFO]: 	size in bytes: 1534210810
2025-03-13 17:35:59,062 [INFO]: 	avg_search_speed_ms: 10.580566624751087
2025-03-13 17:35:59,062 [INFO]: 	99p_search_speed_ms: 17.734414022415855
2025-03-13 17:35:59,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:59,062 [INFO]: 	nb vectors: 7798
2025-03-13 17:35:59,062 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:59,062 [INFO]: 	compression ratio: 0.9993080312085665
2025-03-13 17:35:59,062 [INFO]: }
2025-03-13 17:35:59,062 [INFO]: 	>>> Finished "Creating the index" in 134.9963 secs
2025-03-13 17:35:59,062 [INFO]: >>> Finished "Launching the whole pipeline" in 135.0237 secs
2025-03-13 17:36:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 51825 [episode count 4/20]
[retrieval_preprocessing] for episode 76375 [episode count 5/20], we have num_retrieval=np.int64(7869) num_query=np.int64(409)
2025-03-13 17:36:07,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:08,263 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:08
2025-03-13 17:36:08,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-13 17:36:08,290 [INFO]: There are 7869 embeddings of dim 49152
2025-03-13 17:36:08,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:36:08,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:08
2025-03-13 17:36:08,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:08,290 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:36:08,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:08,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:08,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:08
2025-03-13 17:36:08,290 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:08,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:08,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:08
2025-03-13 17:36:08,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:08,291 [INFO]: 	Creating the index 03/13/2025, 17:36:08
2025-03-13 17:36:08,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:08
2025-03-13 17:36:08,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:36:08,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:08
2025-03-13 17:36:08,292 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:36:08,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  4.74it/s]  9%|▉         | 3/32 [00:00<00:03,  7.86it/s] 16%|█▌        | 5/32 [00:00<00:03,  8.94it/s] 22%|██▏       | 7/32 [00:00<00:02,  9.68it/s] 28%|██▊       | 9/32 [00:00<00:02, 10.92it/s] 34%|███▍      | 11/32 [00:01<00:01, 11.22it/s] 41%|████      | 13/32 [00:01<00:01, 11.12it/s] 47%|████▋     | 15/32 [00:01<00:01, 10.73it/s] 53%|█████▎    | 17/32 [00:01<00:01, 10.86it/s] 59%|█████▉    | 19/32 [00:01<00:01, 10.88it/s] 66%|██████▌   | 21/32 [00:06<00:09,  1.17it/s] 72%|███████▏  | 23/32 [00:07<00:05,  1.61it/s] 78%|███████▊  | 25/32 [00:07<00:03,  2.18it/s] 84%|████████▍ | 27/32 [00:07<00:01,  2.88it/s] 91%|█████████ | 29/32 [00:07<00:00,  3.69it/s] 97%|█████████▋| 31/32 [00:07<00:00,  4.60it/s]100%|██████████| 32/32 [00:11<00:00,  2.84it/s]
2025-03-13 17:36:19,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:19
2025-03-13 17:37:25,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.3597 secs
2025-03-13 17:37:25,919 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 17:37:25,919 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-13 17:38:05,506 [INFO]: 	>>> Finished "Compute fast metrics" in 39.5868 secs
2025-03-13 17:38:05,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.2167 secs
2025-03-13 17:38:05,509 [INFO]: {
2025-03-13 17:38:05,509 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:05,509 [INFO]: 	index_param: efSearch=192
2025-03-13 17:38:05,509 [INFO]: 	index_path: knn.index
2025-03-13 17:38:05,509 [INFO]: 	size in bytes: 1548179530
2025-03-13 17:38:05,509 [INFO]: 	avg_search_speed_ms: 11.518710586328213
2025-03-13 17:38:05,509 [INFO]: 	99p_search_speed_ms: 19.033437499310843
2025-03-13 17:38:05,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:05,509 [INFO]: 	nb vectors: 7869
2025-03-13 17:38:05,509 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:05,509 [INFO]: 	compression ratio: 0.9993081047906633
2025-03-13 17:38:05,509 [INFO]: }
2025-03-13 17:38:05,509 [INFO]: 	>>> Finished "Creating the index" in 117.2185 secs
2025-03-13 17:38:05,509 [INFO]: >>> Finished "Launching the whole pipeline" in 117.2461 secs
2025-03-13 17:38:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 76375 [episode count 5/20]
[retrieval_preprocessing] for episode 24154 [episode count 6/20], we have num_retrieval=np.int64(7784) num_query=np.int64(494)
2025-03-13 17:38:11,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:13,176 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:13
2025-03-13 17:38:13,176 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.50it/s]
2025-03-13 17:38:13,197 [INFO]: There are 7784 embeddings of dim 49152
2025-03-13 17:38:13,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 17:38:13,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:13,198 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:38:13,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:13,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:13,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,198 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:13,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:38:13,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:13
2025-03-13 17:38:13,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:13,198 [INFO]: 	Creating the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:13
2025-03-13 17:38:13,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:38:13,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,199 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:38:13,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:05,  5.21it/s]  9%|▉         | 3/32 [00:00<00:03,  9.05it/s] 16%|█▌        | 5/32 [00:00<00:02, 10.57it/s] 22%|██▏       | 7/32 [00:00<00:02, 11.60it/s] 28%|██▊       | 9/32 [00:00<00:01, 11.63it/s] 38%|███▊      | 12/32 [00:00<00:01, 14.58it/s] 44%|████▍     | 14/32 [00:01<00:01, 15.27it/s] 53%|█████▎    | 17/32 [00:01<00:00, 17.28it/s] 62%|██████▎   | 20/32 [00:01<00:00, 16.98it/s] 69%|██████▉   | 22/32 [00:06<00:06,  1.58it/s] 75%|███████▌  | 24/32 [00:06<00:03,  2.04it/s] 81%|████████▏ | 26/32 [00:06<00:02,  2.62it/s] 88%|████████▊ | 28/32 [00:06<00:01,  3.36it/s] 94%|█████████▍| 30/32 [00:06<00:00,  4.37it/s]100%|██████████| 32/32 [00:09<00:00,  1.73it/s]100%|██████████| 32/32 [00:09<00:00,  3.34it/s]
2025-03-13 17:38:22,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:22
2025-03-13 17:39:32,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.5190 secs
2025-03-13 17:39:32,309 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:39:32,309 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.06it/s]
2025-03-13 17:40:36,067 [INFO]: 	>>> Finished "Compute fast metrics" in 63.7569 secs
2025-03-13 17:40:36,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.8697 secs
2025-03-13 17:40:36,069 [INFO]: {
2025-03-13 17:40:36,069 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:36,069 [INFO]: 	index_param: efSearch=176
2025-03-13 17:40:36,069 [INFO]: 	index_path: knn.index
2025-03-13 17:40:36,069 [INFO]: 	size in bytes: 1531456450
2025-03-13 17:40:36,069 [INFO]: 	avg_search_speed_ms: 13.219519775444482
2025-03-13 17:40:36,069 [INFO]: 	99p_search_speed_ms: 23.94769113510841
2025-03-13 17:40:36,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:36,069 [INFO]: 	nb vectors: 7784
2025-03-13 17:40:36,069 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:36,069 [INFO]: 	compression ratio: 0.999307993381072
2025-03-13 17:40:36,069 [INFO]: }
2025-03-13 17:40:36,069 [INFO]: 	>>> Finished "Creating the index" in 142.8713 secs
2025-03-13 17:40:36,069 [INFO]: >>> Finished "Launching the whole pipeline" in 142.8936 secs
2025-03-13 17:40:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 24154 [episode count 6/20]
[retrieval_preprocessing] for episode 37010 [episode count 7/20], we have num_retrieval=np.int64(7883) num_query=np.int64(395)
2025-03-13 17:40:44,553 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:46,103 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:46
2025-03-13 17:40:46,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 683.00it/s]
2025-03-13 17:40:46,134 [INFO]: There are 7883 embeddings of dim 49152
2025-03-13 17:40:46,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 17:40:46,135 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,135 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:46,136 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:40:46,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:46,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:40:46,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,136 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:46,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:40:46,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:46
2025-03-13 17:40:46,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:46,137 [INFO]: 	Creating the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:46
2025-03-13 17:40:46,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:40:46,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,141 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:40:46,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.34it/s]  6%|▌         | 2/33 [00:00<00:05,  5.62it/s]  9%|▉         | 3/33 [00:00<00:05,  5.91it/s] 12%|█▏        | 4/33 [00:00<00:04,  6.26it/s] 15%|█▌        | 5/33 [00:00<00:04,  6.44it/s] 18%|█▊        | 6/33 [00:00<00:04,  6.60it/s] 21%|██        | 7/33 [00:01<00:03,  6.76it/s] 24%|██▍       | 8/33 [00:01<00:03,  6.81it/s] 27%|██▋       | 9/33 [00:01<00:03,  6.86it/s] 30%|███       | 10/33 [00:01<00:03,  6.96it/s] 33%|███▎      | 11/33 [00:01<00:03,  7.09it/s] 36%|███▋      | 12/33 [00:01<00:02,  7.26it/s] 39%|███▉      | 13/33 [00:01<00:02,  7.29it/s] 42%|████▏     | 14/33 [00:02<00:02,  7.79it/s] 45%|████▌     | 15/33 [00:02<00:02,  8.12it/s] 48%|████▊     | 16/33 [00:02<00:02,  8.36it/s] 52%|█████▏    | 17/33 [00:02<00:01,  8.54it/s] 55%|█████▍    | 18/33 [00:02<00:01,  8.65it/s] 58%|█████▊    | 19/33 [00:02<00:01,  8.63it/s] 61%|██████    | 20/33 [00:02<00:01,  8.74it/s] 64%|██████▎   | 21/33 [00:07<00:16,  1.40s/it] 70%|██████▉   | 23/33 [00:07<00:07,  1.27it/s] 76%|███████▌  | 25/33 [00:07<00:04,  1.95it/s] 82%|████████▏ | 27/33 [00:07<00:02,  2.79it/s] 88%|████████▊ | 29/33 [00:07<00:01,  3.72it/s] 94%|█████████▍| 31/33 [00:08<00:00,  4.75it/s]100%|██████████| 33/33 [00:11<00:00,  1.38it/s]100%|██████████| 33/33 [00:11<00:00,  2.83it/s]
2025-03-13 17:40:57,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:57
2025-03-13 17:42:05,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.2384 secs
2025-03-13 17:42:05,030 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 17:42:05,030 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 17:42:56,291 [INFO]: 	>>> Finished "Compute fast metrics" in 51.2616 secs
2025-03-13 17:42:56,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.1532 secs
2025-03-13 17:42:56,294 [INFO]: {
2025-03-13 17:42:56,294 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:56,294 [INFO]: 	index_param: efSearch=148
2025-03-13 17:42:56,294 [INFO]: 	index_path: knn.index
2025-03-13 17:42:56,294 [INFO]: 	size in bytes: 1550933950
2025-03-13 17:42:56,294 [INFO]: 	avg_search_speed_ms: 9.589739134472689
2025-03-13 17:42:56,294 [INFO]: 	99p_search_speed_ms: 16.004076353274275
2025-03-13 17:42:56,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:56,294 [INFO]: 	nb vectors: 7883
2025-03-13 17:42:56,294 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:56,294 [INFO]: 	compression ratio: 0.9993081033528217
2025-03-13 17:42:56,294 [INFO]: }
2025-03-13 17:42:56,294 [INFO]: 	>>> Finished "Creating the index" in 130.1571 secs
2025-03-13 17:42:56,294 [INFO]: >>> Finished "Launching the whole pipeline" in 130.1915 secs
2025-03-13 17:42:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 37010 [episode count 7/20]
[retrieval_preprocessing] for episode 77459 [episode count 8/20], we have num_retrieval=np.int64(7852) num_query=np.int64(426)
2025-03-13 17:43:01,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:03,175 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:03
2025-03-13 17:43:03,175 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.74it/s]
2025-03-13 17:43:03,201 [INFO]: There are 7852 embeddings of dim 49152
2025-03-13 17:43:03,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:43:03,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:03,202 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:43:03,202 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:03,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:43:03,202 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,202 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:03,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:03,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:03
2025-03-13 17:43:03,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:03,202 [INFO]: 	Creating the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,202 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:03
2025-03-13 17:43:03,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:43:03,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,203 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:43:03,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  4.95it/s]  9%|▉         | 3/32 [00:00<00:03,  8.07it/s] 16%|█▌        | 5/32 [00:00<00:02, 11.01it/s] 25%|██▌       | 8/32 [00:00<00:01, 12.84it/s] 31%|███▏      | 10/32 [00:00<00:01, 11.63it/s] 38%|███▊      | 12/32 [00:01<00:01, 11.06it/s] 44%|████▍     | 14/32 [00:01<00:01, 10.59it/s] 50%|█████     | 16/32 [00:01<00:01, 10.40it/s] 56%|█████▋    | 18/32 [00:01<00:01, 10.42it/s] 62%|██████▎   | 20/32 [00:01<00:01, 10.30it/s] 69%|██████▉   | 22/32 [00:08<00:10,  1.01s/it] 81%|████████▏ | 26/32 [00:08<00:03,  1.81it/s] 94%|█████████▍| 30/32 [00:08<00:00,  2.92it/s]100%|██████████| 32/32 [00:11<00:00,  2.78it/s]
2025-03-13 17:43:14,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:14
2025-03-13 17:44:28,216 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.4886 secs
2025-03-13 17:44:28,216 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 17:44:28,217 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 17:45:02,907 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6906 secs
2025-03-13 17:45:02,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.7067 secs
2025-03-13 17:45:02,910 [INFO]: {
2025-03-13 17:45:02,911 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:02,911 [INFO]: 	index_param: efSearch=163
2025-03-13 17:45:02,911 [INFO]: 	index_path: knn.index
2025-03-13 17:45:02,911 [INFO]: 	size in bytes: 1544834890
2025-03-13 17:45:02,911 [INFO]: 	avg_search_speed_ms: 14.088953908165577
2025-03-13 17:45:02,911 [INFO]: 	99p_search_speed_ms: 20.119132527615875
2025-03-13 17:45:02,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:02,911 [INFO]: 	nb vectors: 7852
2025-03-13 17:45:02,911 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:02,911 [INFO]: 	compression ratio: 0.9993080982266008
2025-03-13 17:45:02,911 [INFO]: }
2025-03-13 17:45:02,911 [INFO]: 	>>> Finished "Creating the index" in 119.7087 secs
2025-03-13 17:45:02,911 [INFO]: >>> Finished "Launching the whole pipeline" in 119.7356 secs
2025-03-13 17:45:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 77459 [episode count 8/20]
[retrieval_preprocessing] for episode 9003 [episode count 9/20], we have num_retrieval=np.int64(8038) num_query=np.int64(240)
2025-03-13 17:45:10,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:12,131 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:12
2025-03-13 17:45:12,131 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1054.11it/s]
2025-03-13 17:45:12,474 [INFO]: There are 8038 embeddings of dim 49152
2025-03-13 17:45:12,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3434 secs
2025-03-13 17:45:12,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:12
2025-03-13 17:45:12,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:12,475 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 17:45:12,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:12,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:45:12,475 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:12
2025-03-13 17:45:12,476 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:12,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:45:12,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:12
2025-03-13 17:45:12,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:12,476 [INFO]: 	Creating the index 03/13/2025, 17:45:12
2025-03-13 17:45:12,477 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:12
2025-03-13 17:45:12,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:45:12,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:12
2025-03-13 17:45:12,479 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:45:12,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.37it/s]  6%|▌         | 2/33 [00:00<00:05,  5.93it/s]  9%|▉         | 3/33 [00:00<00:04,  6.67it/s] 12%|█▏        | 4/33 [00:00<00:04,  7.08it/s] 15%|█▌        | 5/33 [00:00<00:03,  7.41it/s] 18%|█▊        | 6/33 [00:00<00:03,  7.69it/s] 21%|██        | 7/33 [00:00<00:03,  7.83it/s] 24%|██▍       | 8/33 [00:01<00:03,  7.86it/s] 27%|██▋       | 9/33 [00:01<00:03,  7.95it/s] 30%|███       | 10/33 [00:01<00:02,  8.02it/s] 33%|███▎      | 11/33 [00:01<00:02,  7.96it/s] 36%|███▋      | 12/33 [00:01<00:02,  8.12it/s] 42%|████▏     | 14/33 [00:01<00:02,  9.07it/s] 45%|████▌     | 15/33 [00:01<00:01,  9.18it/s] 48%|████▊     | 16/33 [00:01<00:01,  9.26it/s] 52%|█████▏    | 17/33 [00:02<00:01,  9.14it/s] 55%|█████▍    | 18/33 [00:02<00:01,  8.79it/s] 58%|█████▊    | 19/33 [00:02<00:01,  8.66it/s] 61%|██████    | 20/33 [00:02<00:01,  9.00it/s] 64%|██████▎   | 21/33 [00:07<00:17,  1.44s/it] 73%|███████▎  | 24/33 [00:07<00:05,  1.51it/s] 82%|████████▏ | 27/33 [00:07<00:02,  2.60it/s] 91%|█████████ | 30/33 [00:07<00:00,  4.01it/s]100%|██████████| 33/33 [00:10<00:00,  1.84it/s]100%|██████████| 33/33 [00:10<00:00,  3.09it/s]
2025-03-13 17:45:23,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:23
2025-03-13 17:46:42,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.4652 secs
2025-03-13 17:46:42,620 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:46:42,620 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.42it/s]
2025-03-13 17:47:20,852 [INFO]: 	>>> Finished "Compute fast metrics" in 38.2323 secs
2025-03-13 17:47:20,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.3755 secs
2025-03-13 17:47:20,855 [INFO]: {
2025-03-13 17:47:20,855 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:20,855 [INFO]: 	index_param: efSearch=185
2025-03-13 17:47:20,855 [INFO]: 	index_path: knn.index
2025-03-13 17:47:20,855 [INFO]: 	size in bytes: 1581429010
2025-03-13 17:47:20,855 [INFO]: 	avg_search_speed_ms: 12.03376509638102
2025-03-13 17:47:20,855 [INFO]: 	99p_search_speed_ms: 18.619234021753076
2025-03-13 17:47:20,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:20,855 [INFO]: 	nb vectors: 8038
2025-03-13 17:47:20,855 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:20,855 [INFO]: 	compression ratio: 0.9993082800472972
2025-03-13 17:47:20,855 [INFO]: }
2025-03-13 17:47:20,855 [INFO]: 	>>> Finished "Creating the index" in 128.3785 secs
2025-03-13 17:47:20,855 [INFO]: >>> Finished "Launching the whole pipeline" in 128.7240 secs
2025-03-13 17:47:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 9003 [episode count 9/20]
[retrieval_preprocessing] for episode 86329 [episode count 10/20], we have num_retrieval=np.int64(7935) num_query=np.int64(343)
2025-03-13 17:47:24,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:26,188 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:26
2025-03-13 17:47:26,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1063.73it/s]
2025-03-13 17:47:26,219 [INFO]: There are 7935 embeddings of dim 49152
2025-03-13 17:47:26,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:47:26,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:26
2025-03-13 17:47:26,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:26,219 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 17:47:26,219 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:26,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:26,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:26
2025-03-13 17:47:26,220 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:26,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:47:26,220 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:26
2025-03-13 17:47:26,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:26,220 [INFO]: 	Creating the index 03/13/2025, 17:47:26
2025-03-13 17:47:26,220 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:26
2025-03-13 17:47:26,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:47:26,221 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:26
2025-03-13 17:47:26,221 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:47:26,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:05,  5.41it/s]  9%|▉         | 3/33 [00:00<00:03,  9.24it/s] 15%|█▌        | 5/33 [00:00<00:02, 11.05it/s] 21%|██        | 7/33 [00:00<00:02, 11.79it/s] 27%|██▋       | 9/33 [00:00<00:01, 12.01it/s] 33%|███▎      | 11/33 [00:00<00:01, 12.27it/s] 39%|███▉      | 13/33 [00:01<00:01, 12.51it/s] 45%|████▌     | 15/33 [00:01<00:01, 12.69it/s] 52%|█████▏    | 17/33 [00:01<00:01, 12.90it/s] 58%|█████▊    | 19/33 [00:01<00:01, 12.99it/s] 64%|██████▎   | 21/33 [00:06<00:10,  1.15it/s] 67%|██████▋   | 22/33 [00:07<00:08,  1.36it/s] 73%|███████▎  | 24/33 [00:07<00:04,  1.97it/s] 79%|███████▉  | 26/33 [00:07<00:02,  2.72it/s] 85%|████████▍ | 28/33 [00:07<00:01,  3.56it/s] 91%|█████████ | 30/33 [00:07<00:00,  4.50it/s] 97%|█████████▋| 32/33 [00:07<00:00,  5.49it/s]100%|██████████| 33/33 [00:11<00:00,  2.84it/s]
2025-03-13 17:47:37,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:37
2025-03-13 17:48:38,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.4326 secs
2025-03-13 17:48:38,278 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:48:38,278 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 17:49:11,418 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1397 secs
2025-03-13 17:49:11,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.1997 secs
2025-03-13 17:49:11,421 [INFO]: {
2025-03-13 17:49:11,421 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:11,421 [INFO]: 	index_param: efSearch=184
2025-03-13 17:49:11,421 [INFO]: 	index_path: knn.index
2025-03-13 17:49:11,421 [INFO]: 	size in bytes: 1561164490
2025-03-13 17:49:11,421 [INFO]: 	avg_search_speed_ms: 14.311453858483716
2025-03-13 17:49:11,421 [INFO]: 	99p_search_speed_ms: 25.29892629478125
2025-03-13 17:49:11,421 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:11,421 [INFO]: 	nb vectors: 7935
2025-03-13 17:49:11,421 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:11,421 [INFO]: 	compression ratio: 0.9993082023022443
2025-03-13 17:49:11,421 [INFO]: }
2025-03-13 17:49:11,421 [INFO]: 	>>> Finished "Creating the index" in 105.2016 secs
2025-03-13 17:49:11,421 [INFO]: >>> Finished "Launching the whole pipeline" in 105.2335 secs
2025-03-13 17:49:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 86329 [episode count 10/20]
[retrieval_preprocessing] for episode 81225 [episode count 11/20], we have num_retrieval=np.int64(7917) num_query=np.int64(361)
2025-03-13 17:49:18,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:19,661 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:19
2025-03-13 17:49:19,661 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.31it/s]
2025-03-13 17:49:19,686 [INFO]: There are 7917 embeddings of dim 49152
2025-03-13 17:49:19,686 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:49:19,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:19
2025-03-13 17:49:19,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:19,687 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:49:19,687 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:19,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:19,687 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:19
2025-03-13 17:49:19,687 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:19,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:49:19,687 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:19
2025-03-13 17:49:19,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:19,687 [INFO]: 	Creating the index 03/13/2025, 17:49:19
2025-03-13 17:49:19,687 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:19
2025-03-13 17:49:19,688 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:49:19,688 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:19
2025-03-13 17:49:19,688 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:49:19,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  5.05it/s]  9%|▉         | 3/33 [00:00<00:03,  8.60it/s] 15%|█▌        | 5/33 [00:00<00:02,  9.74it/s] 21%|██        | 7/33 [00:00<00:02, 10.23it/s] 27%|██▋       | 9/33 [00:00<00:02, 10.08it/s] 33%|███▎      | 11/33 [00:01<00:02,  9.82it/s] 36%|███▋      | 12/33 [00:01<00:02,  9.83it/s] 39%|███▉      | 13/33 [00:01<00:02,  9.68it/s] 42%|████▏     | 14/33 [00:01<00:02,  9.42it/s] 45%|████▌     | 15/33 [00:01<00:01,  9.27it/s] 48%|████▊     | 16/33 [00:01<00:01,  9.13it/s] 52%|█████▏    | 17/33 [00:01<00:01,  9.32it/s] 55%|█████▍    | 18/33 [00:01<00:01,  9.30it/s] 58%|█████▊    | 19/33 [00:02<00:01,  9.17it/s] 61%|██████    | 20/33 [00:02<00:01,  9.21it/s] 64%|██████▎   | 21/33 [00:06<00:16,  1.41s/it] 67%|██████▋   | 22/33 [00:06<00:11,  1.03s/it] 70%|██████▉   | 23/33 [00:06<00:07,  1.33it/s] 73%|███████▎  | 24/33 [00:06<00:05,  1.79it/s] 76%|███████▌  | 25/33 [00:07<00:03,  2.36it/s] 79%|███████▉  | 26/33 [00:07<00:02,  3.06it/s] 82%|████████▏ | 27/33 [00:07<00:01,  3.84it/s] 85%|████████▍ | 28/33 [00:07<00:01,  4.65it/s] 88%|████████▊ | 29/33 [00:07<00:00,  5.47it/s] 91%|█████████ | 30/33 [00:07<00:00,  6.23it/s] 94%|█████████▍| 31/33 [00:07<00:00,  6.89it/s] 97%|█████████▋| 32/33 [00:07<00:00,  7.46it/s]100%|██████████| 33/33 [00:10<00:00,  1.02s/it]100%|██████████| 33/33 [00:10<00:00,  3.02it/s]
2025-03-13 17:49:30,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:30
2025-03-13 17:50:37,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.3100 secs
2025-03-13 17:50:37,943 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 17:50:37,943 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s]
2025-03-13 17:51:05,737 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7944 secs
2025-03-13 17:51:05,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.0508 secs
2025-03-13 17:51:05,739 [INFO]: {
2025-03-13 17:51:05,739 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:05,740 [INFO]: 	index_param: efSearch=180
2025-03-13 17:51:05,740 [INFO]: 	index_path: knn.index
2025-03-13 17:51:05,740 [INFO]: 	size in bytes: 1557623170
2025-03-13 17:51:05,740 [INFO]: 	avg_search_speed_ms: 10.37257088032354
2025-03-13 17:51:05,740 [INFO]: 	99p_search_speed_ms: 17.497282952535897
2025-03-13 17:51:05,740 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:05,740 [INFO]: 	nb vectors: 7917
2025-03-13 17:51:05,740 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:05,740 [INFO]: 	compression ratio: 0.9993081548729145
2025-03-13 17:51:05,740 [INFO]: }
2025-03-13 17:51:05,740 [INFO]: 	>>> Finished "Creating the index" in 106.0525 secs
2025-03-13 17:51:05,740 [INFO]: >>> Finished "Launching the whole pipeline" in 106.0787 secs
2025-03-13 17:51:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 81225 [episode count 11/20]
[retrieval_preprocessing] for episode 37712 [episode count 12/20], we have num_retrieval=np.int64(7956) num_query=np.int64(322)
2025-03-13 17:51:11,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:12,620 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:12
2025-03-13 17:51:12,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 983.65it/s]
2025-03-13 17:51:12,645 [INFO]: There are 7956 embeddings of dim 49152
2025-03-13 17:51:12,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:51:12,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:12
2025-03-13 17:51:12,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:12,646 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 17:51:12,646 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:12,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:12,646 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:12
2025-03-13 17:51:12,646 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:12,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:51:12,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:12
2025-03-13 17:51:12,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:12,646 [INFO]: 	Creating the index 03/13/2025, 17:51:12
2025-03-13 17:51:12,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:12
2025-03-13 17:51:12,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:51:12,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:12
2025-03-13 17:51:12,647 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:51:12,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  4.60it/s]  6%|▌         | 2/33 [00:00<00:04,  6.73it/s] 12%|█▏        | 4/33 [00:00<00:03,  8.71it/s] 18%|█▊        | 6/33 [00:00<00:02,  9.33it/s] 24%|██▍       | 8/33 [00:00<00:02,  9.75it/s] 27%|██▋       | 9/33 [00:00<00:02,  9.75it/s] 30%|███       | 10/33 [00:01<00:02,  9.65it/s] 33%|███▎      | 11/33 [00:01<00:02,  9.38it/s] 39%|███▉      | 13/33 [00:01<00:02,  9.53it/s] 42%|████▏     | 14/33 [00:01<00:02,  9.27it/s] 45%|████▌     | 15/33 [00:01<00:01,  9.36it/s] 48%|████▊     | 16/33 [00:01<00:01,  9.00it/s] 52%|█████▏    | 17/33 [00:01<00:01,  8.74it/s] 55%|█████▍    | 18/33 [00:02<00:01,  8.89it/s] 58%|█████▊    | 19/33 [00:02<00:01,  8.89it/s] 64%|██████▎   | 21/33 [00:06<00:12,  1.07s/it] 67%|██████▋   | 22/33 [00:06<00:09,  1.20it/s] 73%|███████▎  | 24/33 [00:06<00:04,  1.89it/s] 79%|███████▉  | 26/33 [00:07<00:02,  2.73it/s] 85%|████████▍ | 28/33 [00:07<00:01,  3.73it/s] 91%|█████████ | 30/33 [00:07<00:00,  4.83it/s] 97%|█████████▋| 32/33 [00:07<00:00,  6.00it/s]100%|██████████| 33/33 [00:10<00:00,  3.11it/s]
2025-03-13 17:51:23,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:23
2025-03-13 17:52:28,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.8006 secs
2025-03-13 17:52:28,071 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 17:52:28,071 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 17:53:00,848 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7766 secs
2025-03-13 17:53:00,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.2908 secs
2025-03-13 17:53:00,939 [INFO]: {
2025-03-13 17:53:00,939 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:00,939 [INFO]: 	index_param: efSearch=115
2025-03-13 17:53:00,939 [INFO]: 	index_path: knn.index
2025-03-13 17:53:00,939 [INFO]: 	size in bytes: 1565296150
2025-03-13 17:53:00,939 [INFO]: 	avg_search_speed_ms: 8.444356287843737
2025-03-13 17:53:00,939 [INFO]: 	99p_search_speed_ms: 13.205558108165862
2025-03-13 17:53:00,939 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:00,939 [INFO]: 	nb vectors: 7956
2025-03-13 17:53:00,939 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:00,939 [INFO]: 	compression ratio: 0.9993081807554436
2025-03-13 17:53:00,939 [INFO]: }
2025-03-13 17:53:00,939 [INFO]: 	>>> Finished "Creating the index" in 108.2932 secs
2025-03-13 17:53:00,939 [INFO]: >>> Finished "Launching the whole pipeline" in 108.3193 secs
2025-03-13 17:53:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 37712 [episode count 12/20]
[retrieval_preprocessing] for episode 58294 [episode count 13/20], we have num_retrieval=np.int64(7849) num_query=np.int64(429)
2025-03-13 17:53:05,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:07,477 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:07
2025-03-13 17:53:07,478 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.91it/s]
2025-03-13 17:53:07,504 [INFO]: There are 7849 embeddings of dim 49152
2025-03-13 17:53:07,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:53:07,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:07,505 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:53:07,505 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:07,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:53:07,505 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,505 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:07,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:53:07,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:07
2025-03-13 17:53:07,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:07,506 [INFO]: 	Creating the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:07
2025-03-13 17:53:07,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:53:07,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,509 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:53:07,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  5.10it/s]  9%|▉         | 3/32 [00:00<00:03,  8.58it/s] 16%|█▌        | 5/32 [00:00<00:02,  9.83it/s] 22%|██▏       | 7/32 [00:00<00:02, 10.65it/s] 28%|██▊       | 9/32 [00:00<00:02, 11.07it/s] 34%|███▍      | 11/32 [00:01<00:01, 11.19it/s] 41%|████      | 13/32 [00:01<00:01, 11.37it/s] 47%|████▋     | 15/32 [00:01<00:01, 11.08it/s] 53%|█████▎    | 17/32 [00:01<00:01, 10.79it/s] 59%|█████▉    | 19/32 [00:01<00:01, 10.57it/s] 66%|██████▌   | 21/32 [00:06<00:08,  1.28it/s] 69%|██████▉   | 22/32 [00:06<00:06,  1.51it/s] 75%|███████▌  | 24/32 [00:06<00:03,  2.13it/s] 81%|████████▏ | 26/32 [00:06<00:02,  2.89it/s] 88%|████████▊ | 28/32 [00:07<00:01,  3.79it/s] 94%|█████████▍| 30/32 [00:07<00:00,  4.79it/s]100%|██████████| 32/32 [00:10<00:00,  1.67it/s]100%|██████████| 32/32 [00:10<00:00,  3.12it/s]
2025-03-13 17:53:17,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:17
2025-03-13 17:54:21,297 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.5166 secs
2025-03-13 17:54:21,297 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:54:21,297 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 17:55:16,359 [INFO]: 	>>> Finished "Compute fast metrics" in 55.0612 secs
2025-03-13 17:55:16,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.8522 secs
2025-03-13 17:55:16,362 [INFO]: {
2025-03-13 17:55:16,362 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:16,362 [INFO]: 	index_param: efSearch=200
2025-03-13 17:55:16,362 [INFO]: 	index_path: knn.index
2025-03-13 17:55:16,362 [INFO]: 	size in bytes: 1544244670
2025-03-13 17:55:16,362 [INFO]: 	avg_search_speed_ms: 12.931058774714284
2025-03-13 17:55:16,362 [INFO]: 	99p_search_speed_ms: 21.25370685709639
2025-03-13 17:55:16,362 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:16,362 [INFO]: 	nb vectors: 7849
2025-03-13 17:55:16,362 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:16,362 [INFO]: 	compression ratio: 0.9993080902134505
2025-03-13 17:55:16,362 [INFO]: }
2025-03-13 17:55:16,362 [INFO]: 	>>> Finished "Creating the index" in 128.8557 secs
2025-03-13 17:55:16,362 [INFO]: >>> Finished "Launching the whole pipeline" in 128.8841 secs
2025-03-13 17:55:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 58294 [episode count 13/20]
[retrieval_preprocessing] for episode 1015 [episode count 14/20], we have num_retrieval=np.int64(7806) num_query=np.int64(472)
2025-03-13 17:55:23,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:25,283 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:25
2025-03-13 17:55:25,284 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.15it/s]
2025-03-13 17:55:25,317 [INFO]: There are 7806 embeddings of dim 49152
2025-03-13 17:55:25,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 17:55:25,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:25
2025-03-13 17:55:25,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:25,318 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 17:55:25,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:25,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:55:25,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:25
2025-03-13 17:55:25,318 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:25,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:55:25,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:25
2025-03-13 17:55:25,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:25,318 [INFO]: 	Creating the index 03/13/2025, 17:55:25
2025-03-13 17:55:25,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:25
2025-03-13 17:55:25,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:55:25,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:25
2025-03-13 17:55:25,321 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:55:25,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.00it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.17it/s] 34%|███▍      | 11/32 [00:00<00:00, 35.43it/s] 50%|█████     | 16/32 [00:00<00:00, 38.72it/s] 66%|██████▌   | 21/32 [00:05<00:04,  2.54it/s] 81%|████████▏ | 26/32 [00:05<00:01,  3.81it/s] 97%|█████████▋| 31/32 [00:05<00:00,  5.52it/s]100%|██████████| 32/32 [00:09<00:00,  3.44it/s]
2025-03-13 17:55:34,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:34
2025-03-13 17:56:47,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.5389 secs
2025-03-13 17:56:47,163 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:56:47,163 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-13 17:57:40,464 [INFO]: 	>>> Finished "Compute fast metrics" in 53.3003 secs
2025-03-13 17:57:40,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.1464 secs
2025-03-13 17:57:40,467 [INFO]: {
2025-03-13 17:57:40,467 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:40,467 [INFO]: 	index_param: efSearch=202
2025-03-13 17:57:40,467 [INFO]: 	index_path: knn.index
2025-03-13 17:57:40,467 [INFO]: 	size in bytes: 1535784730
2025-03-13 17:57:40,467 [INFO]: 	avg_search_speed_ms: 14.979362696225191
2025-03-13 17:57:40,467 [INFO]: 	99p_search_speed_ms: 21.52284955605866
2025-03-13 17:57:40,467 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:40,467 [INFO]: 	nb vectors: 7806
2025-03-13 17:57:40,467 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:40,467 [INFO]: 	compression ratio: 0.9993080527633583
2025-03-13 17:57:40,467 [INFO]: }
2025-03-13 17:57:40,468 [INFO]: 	>>> Finished "Creating the index" in 135.1493 secs
2025-03-13 17:57:40,468 [INFO]: >>> Finished "Launching the whole pipeline" in 135.1840 secs
2025-03-13 17:57:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 1015 [episode count 14/20]
[retrieval_preprocessing] for episode 28414 [episode count 15/20], we have num_retrieval=np.int64(7679) num_query=np.int64(599)
2025-03-13 17:57:46,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:48,593 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:48
2025-03-13 17:57:48,593 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.12it/s]
2025-03-13 17:57:48,631 [INFO]: There are 7679 embeddings of dim 49152
2025-03-13 17:57:48,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 17:57:48,632 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:48
2025-03-13 17:57:48,632 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:48,632 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 17:57:48,632 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:48,632 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:57:48,632 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:48
2025-03-13 17:57:48,632 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:48,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:48,632 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:48
2025-03-13 17:57:48,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:48,632 [INFO]: 	Creating the index 03/13/2025, 17:57:48
2025-03-13 17:57:48,632 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:48
2025-03-13 17:57:48,634 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:57:48,634 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:48
2025-03-13 17:57:48,634 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 17:57:48,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.58it/s] 16%|█▌        | 5/32 [00:00<00:01, 22.13it/s] 28%|██▊       | 9/32 [00:00<00:00, 29.03it/s] 41%|████      | 13/32 [00:00<00:00, 29.73it/s] 53%|█████▎    | 17/32 [00:00<00:00, 32.73it/s] 66%|██████▌   | 21/32 [00:05<00:05,  2.02it/s] 78%|███████▊  | 25/32 [00:06<00:02,  2.96it/s] 91%|█████████ | 29/32 [00:06<00:00,  4.21it/s]100%|██████████| 32/32 [00:09<00:00,  2.03it/s]100%|██████████| 32/32 [00:09<00:00,  3.25it/s]
2025-03-13 17:57:58,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:58
2025-03-13 17:59:12,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.5188 secs
2025-03-13 17:59:12,015 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:59:12,015 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.47it/s]
2025-03-13 17:59:51,734 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7193 secs
2025-03-13 17:59:51,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.1024 secs
2025-03-13 17:59:51,737 [INFO]: {
2025-03-13 17:59:51,737 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:51,737 [INFO]: 	index_param: efSearch=155
2025-03-13 17:59:51,737 [INFO]: 	index_path: knn.index
2025-03-13 17:59:51,737 [INFO]: 	size in bytes: 1510798210
2025-03-13 17:59:51,737 [INFO]: 	avg_search_speed_ms: 9.87139873703995
2025-03-13 17:59:51,737 [INFO]: 	99p_search_speed_ms: 16.312856199219823
2025-03-13 17:59:51,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:51,737 [INFO]: 	nb vectors: 7679
2025-03-13 17:59:51,737 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:51,737 [INFO]: 	compression ratio: 0.9993080624579241
2025-03-13 17:59:51,737 [INFO]: }
2025-03-13 17:59:51,737 [INFO]: 	>>> Finished "Creating the index" in 123.1045 secs
2025-03-13 17:59:51,737 [INFO]: >>> Finished "Launching the whole pipeline" in 123.1437 secs
2025-03-13 17:59:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 28414 [episode count 15/20]
[retrieval_preprocessing] for episode 21380 [episode count 16/20], we have num_retrieval=np.int64(7996) num_query=np.int64(282)
2025-03-13 17:59:56,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:57,922 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:57
2025-03-13 17:59:57,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.18it/s]
2025-03-13 17:59:57,947 [INFO]: There are 7996 embeddings of dim 49152
2025-03-13 17:59:57,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 17:59:57,947 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:57,947 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 17:59:57,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:57,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:57,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,947 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:57,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:59:57,947 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:57
2025-03-13 17:59:57,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:57,947 [INFO]: 	Creating the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:57
2025-03-13 17:59:57,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:59:57,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,949 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 17:59:57,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.05it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.35it/s] 33%|███▎      | 11/33 [00:00<00:00, 35.14it/s] 48%|████▊     | 16/33 [00:00<00:00, 38.11it/s] 64%|██████▎   | 21/33 [00:05<00:05,  2.33it/s] 76%|███████▌  | 25/33 [00:05<00:02,  3.26it/s] 88%|████████▊ | 29/33 [00:06<00:00,  4.51it/s]100%|██████████| 33/33 [00:09<00:00,  2.61it/s]100%|██████████| 33/33 [00:09<00:00,  3.65it/s]
2025-03-13 18:00:07,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:07
2025-03-13 18:01:17,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.8280 secs
2025-03-13 18:01:17,834 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:01:17,834 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 18:02:04,636 [INFO]: 	>>> Finished "Compute fast metrics" in 46.8017 secs
2025-03-13 18:02:04,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.6896 secs
2025-03-13 18:02:04,638 [INFO]: {
2025-03-13 18:02:04,638 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:04,638 [INFO]: 	index_param: efSearch=221
2025-03-13 18:02:04,638 [INFO]: 	index_path: knn.index
2025-03-13 18:02:04,638 [INFO]: 	size in bytes: 1573165930
2025-03-13 18:02:04,638 [INFO]: 	avg_search_speed_ms: 13.196646204859627
2025-03-13 18:02:04,638 [INFO]: 	99p_search_speed_ms: 17.783490903675553
2025-03-13 18:02:04,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:04,638 [INFO]: 	nb vectors: 7996
2025-03-13 18:02:04,638 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:04,638 [INFO]: 	compression ratio: 0.999308170880614
2025-03-13 18:02:04,638 [INFO]: }
2025-03-13 18:02:04,638 [INFO]: 	>>> Finished "Creating the index" in 126.6911 secs
2025-03-13 18:02:04,638 [INFO]: >>> Finished "Launching the whole pipeline" in 126.7165 secs
2025-03-13 18:02:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 21380 [episode count 16/20]
[retrieval_preprocessing] for episode 95113 [episode count 17/20], we have num_retrieval=np.int64(7860) num_query=np.int64(418)
2025-03-13 18:02:11,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:12,379 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:12
2025-03-13 18:02:12,379 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.27it/s]
2025-03-13 18:02:12,411 [INFO]: There are 7860 embeddings of dim 49152
2025-03-13 18:02:12,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 18:02:12,412 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:12
2025-03-13 18:02:12,412 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:12,412 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 18:02:12,412 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:12,412 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:12,412 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:12
2025-03-13 18:02:12,412 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:12,412 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:12,412 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:12
2025-03-13 18:02:12,412 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:12,412 [INFO]: 	Creating the index 03/13/2025, 18:02:12
2025-03-13 18:02:12,412 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:12
2025-03-13 18:02:12,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:02:12,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:12
2025-03-13 18:02:12,413 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 18:02:12,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.53it/s] 19%|█▉        | 6/32 [00:00<00:00, 29.80it/s] 38%|███▊      | 12/32 [00:00<00:00, 39.72it/s] 53%|█████▎    | 17/32 [00:00<00:00, 43.41it/s] 69%|██████▉   | 22/32 [00:04<00:03,  3.23it/s] 88%|████████▊ | 28/32 [00:04<00:00,  5.10it/s]100%|██████████| 32/32 [00:07<00:00,  2.96it/s]100%|██████████| 32/32 [00:07<00:00,  4.33it/s]
2025-03-13 18:02:19,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:19
2025-03-13 18:03:37,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.6831 secs
2025-03-13 18:03:37,491 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 18:03:37,491 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.04it/s]
2025-03-13 18:04:19,557 [INFO]: 	>>> Finished "Compute fast metrics" in 42.0660 secs
2025-03-13 18:04:19,559 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.1456 secs
2025-03-13 18:04:19,559 [INFO]: {
2025-03-13 18:04:19,559 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:19,559 [INFO]: 	index_param: efSearch=171
2025-03-13 18:04:19,559 [INFO]: 	index_path: knn.index
2025-03-13 18:04:19,559 [INFO]: 	size in bytes: 1546408870
2025-03-13 18:04:19,559 [INFO]: 	avg_search_speed_ms: 11.99474067335649
2025-03-13 18:04:19,559 [INFO]: 	99p_search_speed_ms: 21.178881539963164
2025-03-13 18:04:19,559 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:19,559 [INFO]: 	nb vectors: 7860
2025-03-13 18:04:19,559 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:19,559 [INFO]: 	compression ratio: 0.9993080807923715
2025-03-13 18:04:19,559 [INFO]: }
2025-03-13 18:04:19,559 [INFO]: 	>>> Finished "Creating the index" in 127.1471 secs
2025-03-13 18:04:19,559 [INFO]: >>> Finished "Launching the whole pipeline" in 127.1803 secs
2025-03-13 18:04:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 95113 [episode count 17/20]
[retrieval_preprocessing] for episode 30559 [episode count 18/20], we have num_retrieval=np.int64(7881) num_query=np.int64(397)
2025-03-13 18:04:24,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:25,587 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:25
2025-03-13 18:04:25,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 900.45it/s]
2025-03-13 18:04:25,615 [INFO]: There are 7881 embeddings of dim 49152
2025-03-13 18:04:25,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:04:25,615 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:25
2025-03-13 18:04:25,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:25,615 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 18:04:25,615 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:25,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:25,615 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:25
2025-03-13 18:04:25,616 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:25,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:25,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:25
2025-03-13 18:04:25,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:25,616 [INFO]: 	Creating the index 03/13/2025, 18:04:25
2025-03-13 18:04:25,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:25
2025-03-13 18:04:25,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:04:25,617 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:25
2025-03-13 18:04:25,617 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 18:04:25,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:05,  5.89it/s] 15%|█▌        | 5/33 [00:00<00:01, 21.26it/s] 30%|███       | 10/33 [00:00<00:00, 30.62it/s] 45%|████▌     | 15/33 [00:00<00:00, 36.50it/s] 61%|██████    | 20/33 [00:00<00:00, 40.32it/s] 76%|███████▌  | 25/33 [00:05<00:02,  2.75it/s] 85%|████████▍ | 28/33 [00:05<00:01,  3.36it/s] 94%|█████████▍| 31/33 [00:05<00:00,  4.10it/s]100%|██████████| 33/33 [00:09<00:00,  1.70it/s]100%|██████████| 33/33 [00:09<00:00,  3.31it/s]
2025-03-13 18:04:35,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:35
2025-03-13 18:05:54,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.5396 secs
2025-03-13 18:05:54,119 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 18:05:54,119 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.82it/s]
2025-03-13 18:06:50,766 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6471 secs
2025-03-13 18:06:50,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.1509 secs
2025-03-13 18:06:50,768 [INFO]: {
2025-03-13 18:06:50,768 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:50,768 [INFO]: 	index_param: efSearch=158
2025-03-13 18:06:50,768 [INFO]: 	index_path: knn.index
2025-03-13 18:06:50,768 [INFO]: 	size in bytes: 1550540470
2025-03-13 18:06:50,769 [INFO]: 	avg_search_speed_ms: 12.03313860011194
2025-03-13 18:06:50,769 [INFO]: 	99p_search_speed_ms: 22.60577520355583
2025-03-13 18:06:50,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:50,769 [INFO]: 	nb vectors: 7881
2025-03-13 18:06:50,769 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:50,769 [INFO]: 	compression ratio: 0.9993080980337133
2025-03-13 18:06:50,769 [INFO]: }
2025-03-13 18:06:50,769 [INFO]: 	>>> Finished "Creating the index" in 145.1525 secs
2025-03-13 18:06:50,769 [INFO]: >>> Finished "Launching the whole pipeline" in 145.1811 secs
2025-03-13 18:06:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 30559 [episode count 18/20]
[retrieval_preprocessing] for episode 15227 [episode count 19/20], we have num_retrieval=np.int64(7819) num_query=np.int64(459)
2025-03-13 18:06:54,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:56,775 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:56
2025-03-13 18:06:56,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1925.76it/s]
2025-03-13 18:06:56,809 [INFO]: There are 7819 embeddings of dim 49152
2025-03-13 18:06:56,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 18:06:56,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:56
2025-03-13 18:06:56,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:56,810 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 18:06:56,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:56,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:06:56,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:56
2025-03-13 18:06:56,811 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:56,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:06:56,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:56
2025-03-13 18:06:56,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:56,812 [INFO]: 	Creating the index 03/13/2025, 18:06:56
2025-03-13 18:06:56,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:56
2025-03-13 18:06:56,815 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:06:56,815 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:56
2025-03-13 18:06:56,816 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 18:06:56,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.11it/s] 19%|█▉        | 6/32 [00:00<00:00, 29.49it/s] 28%|██▊       | 9/32 [00:00<00:00, 29.00it/s] 41%|████      | 13/32 [00:00<00:00, 32.28it/s] 53%|█████▎    | 17/32 [00:00<00:00, 33.91it/s] 66%|██████▌   | 21/32 [00:06<00:05,  1.93it/s] 75%|███████▌  | 24/32 [00:06<00:03,  2.50it/s] 81%|████████▏ | 26/32 [00:06<00:02,  2.96it/s] 88%|████████▊ | 28/32 [00:06<00:01,  3.55it/s] 94%|█████████▍| 30/32 [00:06<00:00,  4.24it/s]100%|██████████| 32/32 [00:11<00:00,  1.36it/s]100%|██████████| 32/32 [00:11<00:00,  2.84it/s]
2025-03-13 18:07:08,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:08
2025-03-13 18:08:25,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1630 secs
2025-03-13 18:08:25,264 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 18:08:25,264 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 18:09:13,856 [INFO]: 	>>> Finished "Compute fast metrics" in 48.5925 secs
2025-03-13 18:09:13,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.0434 secs
2025-03-13 18:09:13,859 [INFO]: {
2025-03-13 18:09:13,859 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:13,859 [INFO]: 	index_param: efSearch=202
2025-03-13 18:09:13,859 [INFO]: 	index_path: knn.index
2025-03-13 18:09:13,859 [INFO]: 	size in bytes: 1538342350
2025-03-13 18:09:13,859 [INFO]: 	avg_search_speed_ms: 12.849343097164978
2025-03-13 18:09:13,859 [INFO]: 	99p_search_speed_ms: 21.47153434809298
2025-03-13 18:09:13,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:13,859 [INFO]: 	nb vectors: 7819
2025-03-13 18:09:13,859 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:13,859 [INFO]: 	compression ratio: 0.999308087695824
2025-03-13 18:09:13,859 [INFO]: }
2025-03-13 18:09:13,859 [INFO]: 	>>> Finished "Creating the index" in 137.0474 secs
2025-03-13 18:09:13,860 [INFO]: >>> Finished "Launching the whole pipeline" in 137.0845 secs
2025-03-13 18:09:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 15227 [episode count 19/20]
2025-03-13 18:09:18: [retrieval_preprocessing] finished for 3774560981_put_cloth_in_box [chosen_id count 5/196]
2025-03-13 18:09:25: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3774560981_put_white_towel_black_basket [chosen_id count 6/196]
2025-03-13 18:09:25: [retrieval_preprocessing] we have num_total=8846 embedding_dim=49152
[retrieval_preprocessing] for episode 35904 [episode count 0/20], we have num_retrieval=np.int64(8369) num_query=np.int64(477)
2025-03-13 18:09:27,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:29,101 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:29
2025-03-13 18:09:29,102 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.98it/s]
2025-03-13 18:09:29,129 [INFO]: There are 8369 embeddings of dim 49152
2025-03-13 18:09:29,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:09:29,129 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:29,129 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:09:29,129 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:29,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:09:29,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,130 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:29,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:29,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:29
2025-03-13 18:09:29,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:29,130 [INFO]: 	Creating the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:29
2025-03-13 18:09:29,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:09:29,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,133 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:09:29,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.33it/s]  9%|▉         | 3/34 [00:00<00:03,  8.43it/s] 15%|█▍        | 5/34 [00:00<00:02,  9.78it/s] 21%|██        | 7/34 [00:00<00:02, 10.92it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.72it/s] 32%|███▏      | 11/34 [00:01<00:01, 12.21it/s] 38%|███▊      | 13/34 [00:01<00:01, 12.86it/s] 44%|████▍     | 15/34 [00:01<00:01, 13.00it/s] 50%|█████     | 17/34 [00:01<00:01, 13.14it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.97it/s] 62%|██████▏   | 21/34 [00:06<00:09,  1.33it/s] 68%|██████▊   | 23/34 [00:06<00:06,  1.81it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.43it/s] 79%|███████▉  | 27/34 [00:06<00:02,  3.17it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.06it/s] 91%|█████████ | 31/34 [00:07<00:00,  5.11it/s] 97%|█████████▋| 33/34 [00:07<00:00,  6.21it/s]100%|██████████| 34/34 [00:10<00:00,  3.16it/s]
2025-03-13 18:09:39,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:39
2025-03-13 18:10:50,145 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.2366 secs
2025-03-13 18:10:50,145 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 18:10:50,146 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:11:44,929 [INFO]: 	>>> Finished "Compute fast metrics" in 54.7833 secs
2025-03-13 18:11:45,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.0561 secs
2025-03-13 18:11:45,189 [INFO]: {
2025-03-13 18:11:45,189 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:45,189 [INFO]: 	index_param: efSearch=139
2025-03-13 18:11:45,190 [INFO]: 	index_path: knn.index
2025-03-13 18:11:45,190 [INFO]: 	size in bytes: 1646551090
2025-03-13 18:11:45,190 [INFO]: 	avg_search_speed_ms: 9.237359815800867
2025-03-13 18:11:45,190 [INFO]: 	99p_search_speed_ms: 15.10954414494337
2025-03-13 18:11:45,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:45,190 [INFO]: 	nb vectors: 8369
2025-03-13 18:11:45,190 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:45,190 [INFO]: 	compression ratio: 0.9993084101629668
2025-03-13 18:11:45,190 [INFO]: }
2025-03-13 18:11:45,190 [INFO]: 	>>> Finished "Creating the index" in 136.0605 secs
2025-03-13 18:11:45,190 [INFO]: >>> Finished "Launching the whole pipeline" in 136.0889 secs
2025-03-13 18:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 35904 [episode count 0/20]
[retrieval_preprocessing] for episode 13897 [episode count 1/20], we have num_retrieval=np.int64(8552) num_query=np.int64(294)
2025-03-13 18:11:51,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:52,873 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:52
2025-03-13 18:11:52,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.29it/s]
2025-03-13 18:11:52,902 [INFO]: There are 8552 embeddings of dim 49152
2025-03-13 18:11:52,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:11:52,902 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:52,902 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:11:52,902 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:52,902 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:52,902 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,902 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:52,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:52,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:52
2025-03-13 18:11:52,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:52,902 [INFO]: 	Creating the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,903 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:52
2025-03-13 18:11:52,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:11:52,904 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,904 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:11:52,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.25it/s]  9%|▊         | 3/35 [00:00<00:03,  9.01it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.29it/s] 20%|██        | 7/35 [00:00<00:02, 11.04it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.25it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.30it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.23it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.22it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.17it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.41it/s] 60%|██████    | 21/35 [00:06<00:12,  1.15it/s] 66%|██████▌   | 23/35 [00:07<00:07,  1.58it/s] 71%|███████▏  | 25/35 [00:07<00:04,  2.14it/s] 77%|███████▋  | 27/35 [00:07<00:02,  2.84it/s] 83%|████████▎ | 29/35 [00:07<00:01,  3.67it/s] 89%|████████▊ | 31/35 [00:07<00:00,  4.61it/s] 94%|█████████▍| 33/35 [00:08<00:00,  5.53it/s]100%|██████████| 35/35 [00:12<00:00,  1.31it/s]100%|██████████| 35/35 [00:12<00:00,  2.84it/s]
2025-03-13 18:12:05,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:05
2025-03-13 18:13:15,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.0026 secs
2025-03-13 18:13:15,252 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:13:15,253 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 18:14:11,503 [INFO]: 	>>> Finished "Compute fast metrics" in 56.2509 secs
2025-03-13 18:14:11,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.6023 secs
2025-03-13 18:14:11,506 [INFO]: {
2025-03-13 18:14:11,506 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:11,506 [INFO]: 	index_param: efSearch=222
2025-03-13 18:14:11,506 [INFO]: 	index_path: knn.index
2025-03-13 18:14:11,506 [INFO]: 	size in bytes: 1682555290
2025-03-13 18:14:11,506 [INFO]: 	avg_search_speed_ms: 13.33253621092687
2025-03-13 18:14:11,507 [INFO]: 	99p_search_speed_ms: 18.322971339803185
2025-03-13 18:14:11,507 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:11,507 [INFO]: 	nb vectors: 8552
2025-03-13 18:14:11,507 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:11,507 [INFO]: 	compression ratio: 0.9993083888494386
2025-03-13 18:14:11,507 [INFO]: }
2025-03-13 18:14:11,507 [INFO]: 	>>> Finished "Creating the index" in 138.6041 secs
2025-03-13 18:14:11,507 [INFO]: >>> Finished "Launching the whole pipeline" in 138.6331 secs
2025-03-13 18:14:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 13897 [episode count 1/20]
[retrieval_preprocessing] for episode 44629 [episode count 2/20], we have num_retrieval=np.int64(8466) num_query=np.int64(380)
2025-03-13 18:14:20,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:22,645 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:22
2025-03-13 18:14:22,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.52it/s]
2025-03-13 18:14:22,671 [INFO]: There are 8466 embeddings of dim 49152
2025-03-13 18:14:22,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:14:22,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:22
2025-03-13 18:14:22,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:22,671 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:14:22,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:22,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:22,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:22
2025-03-13 18:14:22,671 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:22,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:22,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:22
2025-03-13 18:14:22,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:22,672 [INFO]: 	Creating the index 03/13/2025, 18:14:22
2025-03-13 18:14:22,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:22
2025-03-13 18:14:22,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:14:22,673 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:22
2025-03-13 18:14:22,673 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:14:22,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  4.93it/s]  6%|▌         | 2/35 [00:00<00:04,  6.85it/s]  9%|▊         | 3/35 [00:00<00:04,  7.99it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.47it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.88it/s] 20%|██        | 7/35 [00:00<00:02,  9.48it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.72it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.31it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.95it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.79it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.60it/s] 40%|████      | 14/35 [00:01<00:02,  8.46it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.36it/s] 49%|████▊     | 17/35 [00:01<00:01,  9.25it/s] 54%|█████▍    | 19/35 [00:02<00:01,  9.92it/s] 60%|██████    | 21/35 [00:06<00:12,  1.11it/s] 63%|██████▎   | 22/35 [00:06<00:09,  1.34it/s] 66%|██████▌   | 23/35 [00:07<00:07,  1.67it/s] 69%|██████▊   | 24/35 [00:07<00:05,  2.09it/s] 71%|███████▏  | 25/35 [00:07<00:03,  2.61it/s] 74%|███████▍  | 26/35 [00:07<00:02,  3.25it/s] 77%|███████▋  | 27/35 [00:07<00:02,  3.97it/s] 80%|████████  | 28/35 [00:07<00:01,  4.73it/s] 83%|████████▎ | 29/35 [00:07<00:01,  5.51it/s] 86%|████████▌ | 30/35 [00:07<00:00,  6.34it/s] 91%|█████████▏| 32/35 [00:07<00:00,  7.63it/s] 94%|█████████▍| 33/35 [00:08<00:00,  8.01it/s] 97%|█████████▋| 34/35 [00:08<00:00,  8.35it/s]100%|██████████| 35/35 [00:12<00:00,  1.20s/it]100%|██████████| 35/35 [00:12<00:00,  2.85it/s]
2025-03-13 18:14:34,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:34
2025-03-13 18:15:36,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.9823 secs
2025-03-13 18:15:36,947 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 18:15:36,947 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 18:16:07,989 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0416 secs
2025-03-13 18:16:07,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.3194 secs
2025-03-13 18:16:07,993 [INFO]: {
2025-03-13 18:16:07,993 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:07,993 [INFO]: 	index_param: efSearch=235
2025-03-13 18:16:07,993 [INFO]: 	index_path: knn.index
2025-03-13 18:16:07,993 [INFO]: 	size in bytes: 1665635290
2025-03-13 18:16:07,993 [INFO]: 	avg_search_speed_ms: 14.521236751425919
2025-03-13 18:16:07,993 [INFO]: 	99p_search_speed_ms: 20.327075123786926
2025-03-13 18:16:07,993 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:07,993 [INFO]: 	nb vectors: 8466
2025-03-13 18:16:07,993 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:07,993 [INFO]: 	compression ratio: 0.9993083948167308
2025-03-13 18:16:07,993 [INFO]: }
2025-03-13 18:16:07,993 [INFO]: 	>>> Finished "Creating the index" in 105.3210 secs
2025-03-13 18:16:07,993 [INFO]: >>> Finished "Launching the whole pipeline" in 105.3481 secs
2025-03-13 18:16:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 44629 [episode count 2/20]
[retrieval_preprocessing] for episode 71266 [episode count 3/20], we have num_retrieval=np.int64(8502) num_query=np.int64(344)
2025-03-13 18:16:16,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:17,880 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:17
2025-03-13 18:16:17,880 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1075.74it/s]
2025-03-13 18:16:17,906 [INFO]: There are 8502 embeddings of dim 49152
2025-03-13 18:16:17,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:16:17,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:17
2025-03-13 18:16:17,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:17,906 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:16:17,906 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:17,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:17,906 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:17
2025-03-13 18:16:17,906 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:17,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:17,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:17
2025-03-13 18:16:17,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:17,907 [INFO]: 	Creating the index 03/13/2025, 18:16:17
2025-03-13 18:16:17,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:17
2025-03-13 18:16:17,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:16:17,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:17
2025-03-13 18:16:17,908 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:16:17,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.77it/s]  9%|▊         | 3/35 [00:00<00:03,  8.14it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.61it/s] 20%|██        | 7/35 [00:00<00:02, 10.28it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.85it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.07it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.06it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.26it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.52it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.28it/s] 60%|██████    | 21/35 [00:06<00:10,  1.37it/s] 63%|██████▎   | 22/35 [00:06<00:08,  1.62it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.27it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.06it/s] 80%|████████  | 28/35 [00:06<00:01,  3.94it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.44it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.59it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.81it/s]100%|██████████| 35/35 [00:11<00:00,  1.33it/s]100%|██████████| 35/35 [00:11<00:00,  3.09it/s]
2025-03-13 18:16:29,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:29
2025-03-13 18:17:31,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2626 secs
2025-03-13 18:17:31,502 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 18:17:31,502 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 18:17:58,402 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8997 secs
2025-03-13 18:17:58,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.4974 secs
2025-03-13 18:17:58,405 [INFO]: {
2025-03-13 18:17:58,405 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:58,405 [INFO]: 	index_param: efSearch=218
2025-03-13 18:17:58,405 [INFO]: 	index_path: knn.index
2025-03-13 18:17:58,405 [INFO]: 	size in bytes: 1672718230
2025-03-13 18:17:58,405 [INFO]: 	avg_search_speed_ms: 14.744047360118913
2025-03-13 18:17:58,405 [INFO]: 	99p_search_speed_ms: 21.763352607376877
2025-03-13 18:17:58,406 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:58,406 [INFO]: 	nb vectors: 8502
2025-03-13 18:17:58,406 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:58,406 [INFO]: 	compression ratio: 0.9993083031085277
2025-03-13 18:17:58,406 [INFO]: }
2025-03-13 18:17:58,406 [INFO]: 	>>> Finished "Creating the index" in 100.4990 secs
2025-03-13 18:17:58,406 [INFO]: >>> Finished "Launching the whole pipeline" in 100.5252 secs
2025-03-13 18:18:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 71266 [episode count 3/20]
[retrieval_preprocessing] for episode 89595 [episode count 4/20], we have num_retrieval=np.int64(8486) num_query=np.int64(360)
2025-03-13 18:18:05,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:06,873 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:06
2025-03-13 18:18:06,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.98it/s]
2025-03-13 18:18:06,899 [INFO]: There are 8486 embeddings of dim 49152
2025-03-13 18:18:06,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:18:06,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:06
2025-03-13 18:18:06,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:06,899 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:18:06,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:06,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:06,899 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:06
2025-03-13 18:18:06,899 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:06,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:18:06,899 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:06
2025-03-13 18:18:06,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:06,899 [INFO]: 	Creating the index 03/13/2025, 18:18:06
2025-03-13 18:18:06,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:06
2025-03-13 18:18:06,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:18:06,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:06
2025-03-13 18:18:06,901 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:18:06,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.35it/s]  9%|▊         | 3/35 [00:00<00:04,  7.97it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.40it/s] 20%|██        | 7/35 [00:00<00:02, 10.08it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.66it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.90it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.11it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.14it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.31it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.36it/s] 60%|██████    | 21/35 [00:06<00:10,  1.35it/s] 63%|██████▎   | 22/35 [00:06<00:08,  1.60it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.26it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.08it/s] 80%|████████  | 28/35 [00:06<00:01,  4.02it/s] 86%|████████▌ | 30/35 [00:07<00:00,  5.04it/s] 91%|█████████▏| 32/35 [00:07<00:00,  6.09it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.10it/s]100%|██████████| 35/35 [00:11<00:00,  3.15it/s]
2025-03-13 18:18:18,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:18
2025-03-13 18:19:22,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.8149 secs
2025-03-13 18:19:22,832 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:19:22,832 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 18:20:12,447 [INFO]: 	>>> Finished "Compute fast metrics" in 49.6143 secs
2025-03-13 18:20:12,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.5491 secs
2025-03-13 18:20:12,450 [INFO]: {
2025-03-13 18:20:12,450 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:12,450 [INFO]: 	index_param: efSearch=213
2025-03-13 18:20:12,450 [INFO]: 	index_path: knn.index
2025-03-13 18:20:12,450 [INFO]: 	size in bytes: 1669570330
2025-03-13 18:20:12,450 [INFO]: 	avg_search_speed_ms: 13.006839185156247
2025-03-13 18:20:12,450 [INFO]: 	99p_search_speed_ms: 25.140484888106535
2025-03-13 18:20:12,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:12,450 [INFO]: 	nb vectors: 8486
2025-03-13 18:20:12,450 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:12,450 [INFO]: 	compression ratio: 0.9993082998785682
2025-03-13 18:20:12,450 [INFO]: }
2025-03-13 18:20:12,450 [INFO]: 	>>> Finished "Creating the index" in 125.5508 secs
2025-03-13 18:20:12,450 [INFO]: >>> Finished "Launching the whole pipeline" in 125.5771 secs
2025-03-13 18:20:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 89595 [episode count 4/20]
[retrieval_preprocessing] for episode 16718 [episode count 5/20], we have num_retrieval=np.int64(8419) num_query=np.int64(427)
2025-03-13 18:20:20,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:21,642 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:21
2025-03-13 18:20:21,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.57it/s]
2025-03-13 18:20:21,671 [INFO]: There are 8419 embeddings of dim 49152
2025-03-13 18:20:21,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:20:21,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:21
2025-03-13 18:20:21,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:21,672 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:20:21,672 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:21,673 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0011 secs
2025-03-13 18:20:21,673 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:21
2025-03-13 18:20:21,673 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:21,673 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:20:21,673 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:21
2025-03-13 18:20:21,673 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:21,673 [INFO]: 	Creating the index 03/13/2025, 18:20:21
2025-03-13 18:20:21,674 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:21
2025-03-13 18:20:21,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:20:21,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:21
2025-03-13 18:20:21,677 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:20:21,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.14it/s]  9%|▊         | 3/35 [00:00<00:03,  8.12it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.67it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.94it/s] 17%|█▋        | 6/35 [00:00<00:03,  9.15it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.42it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.41it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.34it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.26it/s] 34%|███▍      | 12/35 [00:01<00:02,  9.29it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.19it/s] 40%|████      | 14/35 [00:01<00:02,  9.12it/s] 43%|████▎     | 15/35 [00:01<00:02,  9.11it/s] 46%|████▌     | 16/35 [00:01<00:02,  9.12it/s] 49%|████▊     | 17/35 [00:01<00:01,  9.23it/s] 51%|█████▏    | 18/35 [00:01<00:01,  9.23it/s] 54%|█████▍    | 19/35 [00:02<00:01,  9.21it/s] 57%|█████▋    | 20/35 [00:02<00:01,  9.28it/s] 60%|██████    | 21/35 [00:06<00:20,  1.44s/it] 63%|██████▎   | 22/35 [00:06<00:13,  1.04s/it] 69%|██████▊   | 24/35 [00:07<00:06,  1.65it/s] 74%|███████▍  | 26/35 [00:07<00:03,  2.52it/s] 80%|████████  | 28/35 [00:07<00:01,  3.51it/s] 86%|████████▌ | 30/35 [00:07<00:01,  4.57it/s] 91%|█████████▏| 32/35 [00:07<00:00,  5.74it/s] 97%|█████████▋| 34/35 [00:07<00:00,  6.87it/s]100%|██████████| 35/35 [00:12<00:00,  2.85it/s]
2025-03-13 18:20:33,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:33
2025-03-13 18:21:38,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.5176 secs
2025-03-13 18:21:38,465 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 18:21:38,465 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s]
2025-03-13 18:22:33,420 [INFO]: 	>>> Finished "Compute fast metrics" in 54.9550 secs
2025-03-13 18:22:33,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.7464 secs
2025-03-13 18:22:33,424 [INFO]: {
2025-03-13 18:22:33,424 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:33,424 [INFO]: 	index_param: efSearch=235
2025-03-13 18:22:33,424 [INFO]: 	index_path: knn.index
2025-03-13 18:22:33,424 [INFO]: 	size in bytes: 1656388390
2025-03-13 18:22:33,424 [INFO]: 	avg_search_speed_ms: 13.853427856629121
2025-03-13 18:22:33,424 [INFO]: 	99p_search_speed_ms: 23.484244770370417
2025-03-13 18:22:33,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:33,424 [INFO]: 	nb vectors: 8419
2025-03-13 18:22:33,424 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:33,424 [INFO]: 	compression ratio: 0.999308351829247
2025-03-13 18:22:33,424 [INFO]: }
2025-03-13 18:22:33,424 [INFO]: 	>>> Finished "Creating the index" in 131.7502 secs
2025-03-13 18:22:33,424 [INFO]: >>> Finished "Launching the whole pipeline" in 131.7818 secs
2025-03-13 18:22:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 16718 [episode count 5/20]
[retrieval_preprocessing] for episode 40293 [episode count 6/20], we have num_retrieval=np.int64(8327) num_query=np.int64(519)
2025-03-13 18:22:42,403 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:43,634 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:43
2025-03-13 18:22:43,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1054.91it/s]
2025-03-13 18:22:43,660 [INFO]: There are 8327 embeddings of dim 49152
2025-03-13 18:22:43,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:22:43,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:43
2025-03-13 18:22:43,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:43,660 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:22:43,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:43,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:43,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:43
2025-03-13 18:22:43,661 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:43,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:43,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:43
2025-03-13 18:22:43,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:43,661 [INFO]: 	Creating the index 03/13/2025, 18:22:43
2025-03-13 18:22:43,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:43
2025-03-13 18:22:43,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:22:43,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:43
2025-03-13 18:22:43,662 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:22:43,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.33it/s]  6%|▌         | 2/34 [00:00<00:05,  6.02it/s]  9%|▉         | 3/34 [00:00<00:04,  6.88it/s] 12%|█▏        | 4/34 [00:00<00:04,  7.35it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.65it/s] 18%|█▊        | 6/34 [00:00<00:03,  7.80it/s] 21%|██        | 7/34 [00:00<00:03,  7.95it/s] 24%|██▎       | 8/34 [00:01<00:03,  8.03it/s] 26%|██▋       | 9/34 [00:01<00:03,  8.10it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.13it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.15it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.24it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.18it/s] 41%|████      | 14/34 [00:01<00:02,  8.14it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.12it/s] 47%|████▋     | 16/34 [00:02<00:02,  8.33it/s] 53%|█████▎    | 18/34 [00:02<00:01,  9.47it/s] 59%|█████▉    | 20/34 [00:02<00:01, 10.03it/s] 62%|██████▏   | 21/34 [00:06<00:11,  1.09it/s] 65%|██████▍   | 22/34 [00:06<00:08,  1.37it/s] 68%|██████▊   | 23/34 [00:06<00:06,  1.76it/s] 71%|███████   | 24/34 [00:06<00:04,  2.24it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.81it/s] 76%|███████▋  | 26/34 [00:06<00:02,  3.50it/s] 79%|███████▉  | 27/34 [00:06<00:01,  4.27it/s] 82%|████████▏ | 28/34 [00:06<00:01,  5.09it/s] 85%|████████▌ | 29/34 [00:07<00:00,  5.92it/s] 91%|█████████ | 31/34 [00:07<00:00,  7.27it/s] 94%|█████████▍| 32/34 [00:07<00:00,  7.74it/s] 97%|█████████▋| 33/34 [00:07<00:00,  8.17it/s]100%|██████████| 34/34 [00:11<00:00,  1.05s/it]100%|██████████| 34/34 [00:11<00:00,  3.07it/s]
2025-03-13 18:22:54,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:54
2025-03-13 18:24:00,214 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.4785 secs
2025-03-13 18:24:00,214 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 18:24:00,214 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 18:24:36,966 [INFO]: 	>>> Finished "Compute fast metrics" in 36.7519 secs
2025-03-13 18:24:36,969 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.3072 secs
2025-03-13 18:24:36,970 [INFO]: {
2025-03-13 18:24:36,970 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:36,970 [INFO]: 	index_param: efSearch=241
2025-03-13 18:24:36,970 [INFO]: 	index_path: knn.index
2025-03-13 18:24:36,970 [INFO]: 	size in bytes: 1638288010
2025-03-13 18:24:36,970 [INFO]: 	avg_search_speed_ms: 17.59371670251074
2025-03-13 18:24:36,970 [INFO]: 	99p_search_speed_ms: 30.04608775489041
2025-03-13 18:24:36,970 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:36,970 [INFO]: 	nb vectors: 8327
2025-03-13 18:24:36,970 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:36,970 [INFO]: 	compression ratio: 0.9993083059919361
2025-03-13 18:24:36,970 [INFO]: }
2025-03-13 18:24:36,970 [INFO]: 	>>> Finished "Creating the index" in 113.3088 secs
2025-03-13 18:24:36,970 [INFO]: >>> Finished "Launching the whole pipeline" in 113.3354 secs
2025-03-13 18:24:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 40293 [episode count 6/20]
[retrieval_preprocessing] for episode 70003 [episode count 7/20], we have num_retrieval=np.int64(8335) num_query=np.int64(511)
2025-03-13 18:24:46,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:47,961 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:47
2025-03-13 18:24:47,961 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.37it/s]
2025-03-13 18:24:47,987 [INFO]: There are 8335 embeddings of dim 49152
2025-03-13 18:24:47,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:24:47,987 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:47
2025-03-13 18:24:47,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:47,987 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:24:47,987 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:47,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:47,987 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:47
2025-03-13 18:24:47,988 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:47,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:24:47,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:47
2025-03-13 18:24:47,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:47,988 [INFO]: 	Creating the index 03/13/2025, 18:24:47
2025-03-13 18:24:47,988 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:47
2025-03-13 18:24:47,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:24:47,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:47
2025-03-13 18:24:47,989 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:24:47,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.33it/s]  6%|▌         | 2/34 [00:00<00:05,  6.04it/s]  9%|▉         | 3/34 [00:00<00:04,  6.98it/s] 12%|█▏        | 4/34 [00:00<00:04,  7.50it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.82it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.03it/s] 21%|██        | 7/34 [00:00<00:03,  8.18it/s] 24%|██▎       | 8/34 [00:01<00:03,  8.24it/s] 26%|██▋       | 9/34 [00:01<00:03,  8.27it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.29it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.89it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.80it/s] 41%|████      | 14/34 [00:01<00:02,  8.71it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.61it/s] 50%|█████     | 17/34 [00:02<00:01,  9.80it/s] 56%|█████▌    | 19/34 [00:02<00:01, 10.44it/s] 62%|██████▏   | 21/34 [00:06<00:11,  1.18it/s] 68%|██████▊   | 23/34 [00:06<00:06,  1.69it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.34it/s] 79%|███████▉  | 27/34 [00:07<00:02,  3.12it/s] 85%|████████▌ | 29/34 [00:07<00:01,  4.04it/s] 91%|█████████ | 31/34 [00:07<00:00,  5.09it/s] 97%|█████████▋| 33/34 [00:07<00:00,  6.19it/s]100%|██████████| 34/34 [00:11<00:00,  2.93it/s]
2025-03-13 18:24:59,603 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:59
2025-03-13 18:26:03,876 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.2721 secs
2025-03-13 18:26:03,876 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 18:26:03,876 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 18:26:49,272 [INFO]: 	>>> Finished "Compute fast metrics" in 45.3956 secs
2025-03-13 18:26:49,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.2852 secs
2025-03-13 18:26:49,275 [INFO]: {
2025-03-13 18:26:49,275 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:49,275 [INFO]: 	index_param: efSearch=232
2025-03-13 18:26:49,275 [INFO]: 	index_path: knn.index
2025-03-13 18:26:49,275 [INFO]: 	size in bytes: 1639861930
2025-03-13 18:26:49,275 [INFO]: 	avg_search_speed_ms: 17.210296230958118
2025-03-13 18:26:49,275 [INFO]: 	99p_search_speed_ms: 36.79813705384731
2025-03-13 18:26:49,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:49,275 [INFO]: 	nb vectors: 8335
2025-03-13 18:26:49,275 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:49,275 [INFO]: 	compression ratio: 0.9993083259149751
2025-03-13 18:26:49,275 [INFO]: }
2025-03-13 18:26:49,275 [INFO]: 	>>> Finished "Creating the index" in 121.2870 secs
2025-03-13 18:26:49,275 [INFO]: >>> Finished "Launching the whole pipeline" in 121.3142 secs
2025-03-13 18:26:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 70003 [episode count 7/20]
[retrieval_preprocessing] for episode 85406 [episode count 8/20], we have num_retrieval=np.int64(8380) num_query=np.int64(466)
2025-03-13 18:27:02,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:03,945 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:03
2025-03-13 18:27:03,945 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1291.35it/s]
2025-03-13 18:27:03,973 [INFO]: There are 8380 embeddings of dim 49152
2025-03-13 18:27:03,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:27:03,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:03
2025-03-13 18:27:03,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:03,973 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:27:03,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:03,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:03,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:03
2025-03-13 18:27:03,973 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:03,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:27:03,973 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:03
2025-03-13 18:27:03,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:03,974 [INFO]: 	Creating the index 03/13/2025, 18:27:03
2025-03-13 18:27:03,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:03
2025-03-13 18:27:03,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:27:03,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:03
2025-03-13 18:27:03,975 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:27:03,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.48it/s]  6%|▌         | 2/34 [00:00<00:05,  6.10it/s]  9%|▉         | 3/34 [00:00<00:04,  6.88it/s] 12%|█▏        | 4/34 [00:00<00:04,  7.35it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.64it/s] 18%|█▊        | 6/34 [00:00<00:03,  7.81it/s] 21%|██        | 7/34 [00:00<00:03,  8.03it/s] 24%|██▎       | 8/34 [00:01<00:03,  8.02it/s] 26%|██▋       | 9/34 [00:01<00:03,  8.04it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.08it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.09it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.18it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.14it/s] 41%|████      | 14/34 [00:01<00:02,  8.07it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.05it/s] 47%|████▋     | 16/34 [00:02<00:02,  8.47it/s] 53%|█████▎    | 18/34 [00:02<00:01,  9.41it/s] 59%|█████▉    | 20/34 [00:02<00:01,  9.69it/s] 62%|██████▏   | 21/34 [00:07<00:15,  1.16s/it] 65%|██████▍   | 22/34 [00:07<00:10,  1.10it/s] 71%|███████   | 24/34 [00:07<00:05,  1.75it/s] 76%|███████▋  | 26/34 [00:07<00:03,  2.55it/s] 82%|████████▏ | 28/34 [00:07<00:01,  3.50it/s] 88%|████████▊ | 30/34 [00:08<00:00,  4.57it/s] 94%|█████████▍| 32/34 [00:08<00:00,  5.70it/s]100%|██████████| 34/34 [00:12<00:00,  1.34it/s]100%|██████████| 34/34 [00:12<00:00,  2.78it/s]
2025-03-13 18:27:16,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:16
2025-03-13 18:28:25,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.6389 secs
2025-03-13 18:28:25,867 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:28:25,867 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-13 18:29:25,294 [INFO]: 	>>> Finished "Compute fast metrics" in 59.4267 secs
2025-03-13 18:29:25,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.3223 secs
2025-03-13 18:29:25,297 [INFO]: {
2025-03-13 18:29:25,297 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:25,297 [INFO]: 	index_param: efSearch=213
2025-03-13 18:29:25,297 [INFO]: 	index_path: knn.index
2025-03-13 18:29:25,297 [INFO]: 	size in bytes: 1648715290
2025-03-13 18:29:25,297 [INFO]: 	avg_search_speed_ms: 13.35359345101944
2025-03-13 18:29:25,297 [INFO]: 	99p_search_speed_ms: 20.853612944483753
2025-03-13 18:29:25,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:25,297 [INFO]: 	nb vectors: 8380
2025-03-13 18:29:25,297 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:25,297 [INFO]: 	compression ratio: 0.9993084009065022
2025-03-13 18:29:25,297 [INFO]: }
2025-03-13 18:29:25,297 [INFO]: 	>>> Finished "Creating the index" in 141.3238 secs
2025-03-13 18:29:25,297 [INFO]: >>> Finished "Launching the whole pipeline" in 141.3527 secs
2025-03-13 18:29:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 85406 [episode count 8/20]
[retrieval_preprocessing] for episode 25986 [episode count 9/20], we have num_retrieval=np.int64(8495) num_query=np.int64(351)
2025-03-13 18:29:33,664 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:34,952 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:34
2025-03-13 18:29:34,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.61it/s]
2025-03-13 18:29:34,978 [INFO]: There are 8495 embeddings of dim 49152
2025-03-13 18:29:34,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:29:34,979 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:34,979 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:29:34,979 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:34,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:29:34,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,979 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:34,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:29:34,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:34
2025-03-13 18:29:34,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:34,979 [INFO]: 	Creating the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:34
2025-03-13 18:29:34,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:29:34,980 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,981 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:29:34,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  4.03it/s]  6%|▌         | 2/35 [00:00<00:06,  5.42it/s]  9%|▊         | 3/35 [00:00<00:05,  6.34it/s] 11%|█▏        | 4/35 [00:00<00:04,  6.94it/s] 14%|█▍        | 5/35 [00:00<00:04,  7.20it/s] 17%|█▋        | 6/35 [00:00<00:03,  7.33it/s] 20%|██        | 7/35 [00:01<00:03,  7.48it/s] 23%|██▎       | 8/35 [00:01<00:03,  7.73it/s] 26%|██▌       | 9/35 [00:01<00:03,  7.76it/s] 29%|██▊       | 10/35 [00:01<00:03,  7.73it/s] 31%|███▏      | 11/35 [00:01<00:03,  7.69it/s] 34%|███▍      | 12/35 [00:01<00:02,  7.75it/s] 37%|███▋      | 13/35 [00:01<00:02,  7.62it/s] 40%|████      | 14/35 [00:01<00:02,  7.43it/s] 43%|████▎     | 15/35 [00:02<00:02,  7.32it/s] 46%|████▌     | 16/35 [00:02<00:02,  7.31it/s] 49%|████▊     | 17/35 [00:02<00:02,  7.40it/s] 51%|█████▏    | 18/35 [00:02<00:02,  7.43it/s] 54%|█████▍    | 19/35 [00:02<00:02,  7.47it/s] 57%|█████▋    | 20/35 [00:02<00:01,  7.57it/s] 60%|██████    | 21/35 [00:07<00:20,  1.44s/it] 63%|██████▎   | 22/35 [00:07<00:13,  1.05s/it] 66%|██████▌   | 23/35 [00:07<00:09,  1.29it/s] 69%|██████▊   | 24/35 [00:07<00:06,  1.71it/s] 71%|███████▏  | 25/35 [00:07<00:04,  2.24it/s] 74%|███████▍  | 26/35 [00:07<00:03,  2.86it/s] 77%|███████▋  | 27/35 [00:08<00:02,  3.49it/s] 80%|████████  | 28/35 [00:08<00:01,  4.21it/s] 83%|████████▎ | 29/35 [00:08<00:01,  4.79it/s] 86%|████████▌ | 30/35 [00:08<00:00,  5.28it/s] 89%|████████▊ | 31/35 [00:08<00:00,  5.69it/s] 91%|█████████▏| 32/35 [00:08<00:00,  5.99it/s] 94%|█████████▍| 33/35 [00:08<00:00,  6.47it/s] 97%|█████████▋| 34/35 [00:08<00:00,  7.07it/s]100%|██████████| 35/35 [00:12<00:00,  1.21s/it]100%|██████████| 35/35 [00:12<00:00,  2.76it/s]
2025-03-13 18:29:47,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:47
2025-03-13 18:30:58,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.5200 secs
2025-03-13 18:30:58,184 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 18:30:58,184 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 18:31:41,119 [INFO]: 	>>> Finished "Compute fast metrics" in 42.9351 secs
2025-03-13 18:31:41,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.1410 secs
2025-03-13 18:31:41,122 [INFO]: {
2025-03-13 18:31:41,122 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:41,122 [INFO]: 	index_param: efSearch=244
2025-03-13 18:31:41,122 [INFO]: 	index_path: knn.index
2025-03-13 18:31:41,122 [INFO]: 	size in bytes: 1671340990
2025-03-13 18:31:41,122 [INFO]: 	avg_search_speed_ms: 15.896192688527496
2025-03-13 18:31:41,122 [INFO]: 	99p_search_speed_ms: 28.28390125185253
2025-03-13 18:31:41,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:41,122 [INFO]: 	nb vectors: 8495
2025-03-13 18:31:41,122 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:41,122 [INFO]: 	compression ratio: 0.9993083218763156
2025-03-13 18:31:41,122 [INFO]: }
2025-03-13 18:31:41,122 [INFO]: 	>>> Finished "Creating the index" in 126.1426 secs
2025-03-13 18:31:41,122 [INFO]: >>> Finished "Launching the whole pipeline" in 126.1698 secs
2025-03-13 18:31:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 25986 [episode count 9/20]
[retrieval_preprocessing] for episode 41601 [episode count 10/20], we have num_retrieval=np.int64(8443) num_query=np.int64(403)
2025-03-13 18:31:50,608 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:52,202 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:52
2025-03-13 18:31:52,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.48it/s]
2025-03-13 18:31:52,234 [INFO]: There are 8443 embeddings of dim 49152
2025-03-13 18:31:52,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 18:31:52,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:52
2025-03-13 18:31:52,235 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:52,235 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:31:52,235 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:52,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:31:52,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:52
2025-03-13 18:31:52,236 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:52,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:31:52,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:52
2025-03-13 18:31:52,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:52,237 [INFO]: 	Creating the index 03/13/2025, 18:31:52
2025-03-13 18:31:52,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:52
2025-03-13 18:31:52,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:31:52,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:52
2025-03-13 18:31:52,240 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:31:52,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  5.89it/s]  9%|▊         | 3/35 [00:00<00:02, 10.84it/s] 14%|█▍        | 5/35 [00:00<00:02, 12.98it/s] 20%|██        | 7/35 [00:00<00:01, 14.48it/s] 26%|██▌       | 9/35 [00:00<00:01, 15.38it/s] 31%|███▏      | 11/35 [00:00<00:01, 15.93it/s] 37%|███▋      | 13/35 [00:00<00:01, 16.66it/s] 43%|████▎     | 15/35 [00:00<00:01, 16.95it/s] 49%|████▊     | 17/35 [00:01<00:01, 16.67it/s] 54%|█████▍    | 19/35 [00:01<00:01, 14.97it/s] 60%|██████    | 21/35 [00:05<00:10,  1.38it/s] 66%|██████▌   | 23/35 [00:05<00:06,  1.86it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.48it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.21it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.05it/s] 89%|████████▊ | 31/35 [00:06<00:00,  4.95it/s] 94%|█████████▍| 33/35 [00:06<00:00,  5.85it/s]100%|██████████| 35/35 [00:10<00:00,  1.41it/s]100%|██████████| 35/35 [00:10<00:00,  3.23it/s]
2025-03-13 18:32:03,082 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:03
2025-03-13 18:33:08,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.0924 secs
2025-03-13 18:33:08,175 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:33:08,176 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 18:34:00,338 [INFO]: 	>>> Finished "Compute fast metrics" in 52.1624 secs
2025-03-13 18:34:00,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.1005 secs
2025-03-13 18:34:00,341 [INFO]: {
2025-03-13 18:34:00,341 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:00,341 [INFO]: 	index_param: efSearch=209
2025-03-13 18:34:00,341 [INFO]: 	index_path: knn.index
2025-03-13 18:34:00,341 [INFO]: 	size in bytes: 1661110270
2025-03-13 18:34:00,341 [INFO]: 	avg_search_speed_ms: 14.04060311073393
2025-03-13 18:34:00,341 [INFO]: 	99p_search_speed_ms: 27.59985756129026
2025-03-13 18:34:00,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:00,341 [INFO]: 	nb vectors: 8443
2025-03-13 18:34:00,341 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:00,341 [INFO]: 	compression ratio: 0.9993083385126503
2025-03-13 18:34:00,341 [INFO]: }
2025-03-13 18:34:00,341 [INFO]: 	>>> Finished "Creating the index" in 128.1043 secs
2025-03-13 18:34:00,341 [INFO]: >>> Finished "Launching the whole pipeline" in 128.1390 secs
2025-03-13 18:34:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 41601 [episode count 10/20]
[retrieval_preprocessing] for episode 94188 [episode count 11/20], we have num_retrieval=np.int64(8333) num_query=np.int64(513)
2025-03-13 18:34:07,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:09,073 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:09
2025-03-13 18:34:09,073 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-13 18:34:09,101 [INFO]: There are 8333 embeddings of dim 49152
2025-03-13 18:34:09,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 18:34:09,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:09
2025-03-13 18:34:09,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:09,103 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:34:09,103 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:09,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:34:09,103 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:09
2025-03-13 18:34:09,103 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:09,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:34:09,104 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:09
2025-03-13 18:34:09,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:09,104 [INFO]: 	Creating the index 03/13/2025, 18:34:09
2025-03-13 18:34:09,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:09
2025-03-13 18:34:09,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:34:09,107 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:09
2025-03-13 18:34:09,107 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:34:09,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.25it/s]  9%|▉         | 3/34 [00:00<00:03,  8.93it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.17it/s] 21%|██        | 7/34 [00:00<00:02, 11.08it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.47it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.62it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.91it/s] 44%|████▍     | 15/34 [00:01<00:01, 12.08it/s] 50%|█████     | 17/34 [00:01<00:01, 12.17it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.15it/s] 62%|██████▏   | 21/34 [00:06<00:10,  1.25it/s] 65%|██████▍   | 22/34 [00:06<00:08,  1.48it/s] 71%|███████   | 24/34 [00:06<00:04,  2.10it/s] 76%|███████▋  | 26/34 [00:06<00:02,  2.85it/s] 82%|████████▏ | 28/34 [00:07<00:01,  3.71it/s] 88%|████████▊ | 30/34 [00:07<00:00,  4.61it/s] 94%|█████████▍| 32/34 [00:07<00:00,  5.54it/s]100%|██████████| 34/34 [00:12<00:00,  1.23it/s]100%|██████████| 34/34 [00:12<00:00,  2.82it/s]
2025-03-13 18:34:21,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:21
2025-03-13 18:35:30,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.9566 secs
2025-03-13 18:35:30,112 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:35:30,112 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 18:36:21,958 [INFO]: 	>>> Finished "Compute fast metrics" in 51.8451 secs
2025-03-13 18:36:21,962 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.8550 secs
2025-03-13 18:36:21,963 [INFO]: {
2025-03-13 18:36:21,963 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:21,963 [INFO]: 	index_param: efSearch=226
2025-03-13 18:36:21,963 [INFO]: 	index_path: knn.index
2025-03-13 18:36:21,963 [INFO]: 	size in bytes: 1639468450
2025-03-13 18:36:21,963 [INFO]: 	avg_search_speed_ms: 15.326836763968146
2025-03-13 18:36:21,963 [INFO]: 	99p_search_speed_ms: 28.325142450630675
2025-03-13 18:36:21,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:21,963 [INFO]: 	nb vectors: 8333
2025-03-13 18:36:21,963 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:21,963 [INFO]: 	compression ratio: 0.9993083209378015
2025-03-13 18:36:21,963 [INFO]: }
2025-03-13 18:36:21,963 [INFO]: 	>>> Finished "Creating the index" in 132.8590 secs
2025-03-13 18:36:21,963 [INFO]: >>> Finished "Launching the whole pipeline" in 132.8901 secs
2025-03-13 18:36:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 94188 [episode count 11/20]
[retrieval_preprocessing] for episode 26299 [episode count 12/20], we have num_retrieval=np.int64(8409) num_query=np.int64(437)
2025-03-13 18:36:29,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:31,600 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:31
2025-03-13 18:36:31,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.80it/s]
2025-03-13 18:36:31,627 [INFO]: There are 8409 embeddings of dim 49152
2025-03-13 18:36:31,627 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:36:31,627 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:31
2025-03-13 18:36:31,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:31,627 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:36:31,627 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:31,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:31,627 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:31
2025-03-13 18:36:31,628 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:31,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:36:31,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:31
2025-03-13 18:36:31,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:31,628 [INFO]: 	Creating the index 03/13/2025, 18:36:31
2025-03-13 18:36:31,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:31
2025-03-13 18:36:31,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:36:31,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:31
2025-03-13 18:36:31,629 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:36:31,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  4.94it/s]  9%|▊         | 3/35 [00:00<00:03,  8.57it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.79it/s] 20%|██        | 7/35 [00:00<00:02, 10.48it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.02it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.33it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.82it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.95it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.09it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.13it/s] 60%|██████    | 21/35 [00:05<00:09,  1.46it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.72it/s] 66%|██████▌   | 23/35 [00:06<00:05,  2.06it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.50it/s] 71%|███████▏  | 25/35 [00:06<00:03,  3.04it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.67it/s] 77%|███████▋  | 27/35 [00:06<00:01,  4.33it/s] 80%|████████  | 28/35 [00:06<00:01,  4.93it/s] 83%|████████▎ | 29/35 [00:06<00:01,  5.61it/s] 89%|████████▊ | 31/35 [00:06<00:00,  7.63it/s] 94%|█████████▍| 33/35 [00:07<00:00,  8.15it/s] 97%|█████████▋| 34/35 [00:07<00:00,  8.33it/s]100%|██████████| 35/35 [00:10<00:00,  1.05it/s]100%|██████████| 35/35 [00:10<00:00,  3.24it/s]
2025-03-13 18:36:42,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:42
2025-03-13 18:37:55,869 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.4233 secs
2025-03-13 18:37:55,869 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:37:55,869 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s]
2025-03-13 18:38:59,776 [INFO]: 	>>> Finished "Compute fast metrics" in 63.9066 secs
2025-03-13 18:38:59,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.1499 secs
2025-03-13 18:38:59,779 [INFO]: {
2025-03-13 18:38:59,779 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:59,779 [INFO]: 	index_param: efSearch=221
2025-03-13 18:38:59,779 [INFO]: 	index_path: knn.index
2025-03-13 18:38:59,779 [INFO]: 	size in bytes: 1654420930
2025-03-13 18:38:59,779 [INFO]: 	avg_search_speed_ms: 13.58597733538456
2025-03-13 18:38:59,779 [INFO]: 	99p_search_speed_ms: 23.75815506093203
2025-03-13 18:38:59,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:59,779 [INFO]: 	nb vectors: 8409
2025-03-13 18:38:59,779 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:59,779 [INFO]: 	compression ratio: 0.9993083634404939
2025-03-13 18:38:59,779 [INFO]: }
2025-03-13 18:38:59,779 [INFO]: 	>>> Finished "Creating the index" in 148.1515 secs
2025-03-13 18:38:59,779 [INFO]: >>> Finished "Launching the whole pipeline" in 148.1788 secs
2025-03-13 18:39:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 26299 [episode count 12/20]
[retrieval_preprocessing] for episode 74722 [episode count 13/20], we have num_retrieval=np.int64(8374) num_query=np.int64(472)
2025-03-13 18:39:09,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:10,972 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:10
2025-03-13 18:39:10,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-13 18:39:10,998 [INFO]: There are 8374 embeddings of dim 49152
2025-03-13 18:39:10,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:39:10,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:10
2025-03-13 18:39:10,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:10,999 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:39:10,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:10,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:39:10,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:10
2025-03-13 18:39:10,999 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:10,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:39:10,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:10
2025-03-13 18:39:10,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:10,999 [INFO]: 	Creating the index 03/13/2025, 18:39:10
2025-03-13 18:39:10,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:10
2025-03-13 18:39:11,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:39:11,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:11
2025-03-13 18:39:11,001 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:39:11,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.30it/s]  9%|▉         | 3/34 [00:00<00:03,  8.70it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.27it/s] 21%|██        | 7/34 [00:00<00:02, 11.55it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.42it/s] 32%|███▏      | 11/34 [00:01<00:02, 11.48it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.60it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.35it/s] 50%|█████     | 17/34 [00:01<00:01, 11.51it/s] 56%|█████▌    | 19/34 [00:01<00:01, 11.56it/s] 62%|██████▏   | 21/34 [00:05<00:09,  1.41it/s] 65%|██████▍   | 22/34 [00:06<00:07,  1.66it/s] 68%|██████▊   | 23/34 [00:06<00:05,  1.98it/s] 71%|███████   | 24/34 [00:06<00:04,  2.39it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.89it/s] 76%|███████▋  | 26/34 [00:06<00:02,  3.51it/s] 79%|███████▉  | 27/34 [00:06<00:01,  4.23it/s] 82%|████████▏ | 28/34 [00:06<00:01,  4.97it/s] 85%|████████▌ | 29/34 [00:06<00:00,  5.71it/s] 88%|████████▊ | 30/34 [00:06<00:00,  6.40it/s] 91%|█████████ | 31/34 [00:07<00:00,  7.03it/s] 94%|█████████▍| 32/34 [00:07<00:00,  7.50it/s] 97%|█████████▋| 33/34 [00:07<00:00,  7.96it/s]100%|██████████| 34/34 [00:11<00:00,  1.29s/it]100%|██████████| 34/34 [00:11<00:00,  3.00it/s]
2025-03-13 18:39:22,357 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:22
2025-03-13 18:40:35,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.0172 secs
2025-03-13 18:40:35,375 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:40:35,375 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:41:21,889 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5135 secs
2025-03-13 18:41:21,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.8907 secs
2025-03-13 18:41:21,892 [INFO]: {
2025-03-13 18:41:21,892 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:21,892 [INFO]: 	index_param: efSearch=208
2025-03-13 18:41:21,892 [INFO]: 	index_path: knn.index
2025-03-13 18:41:21,892 [INFO]: 	size in bytes: 1647534850
2025-03-13 18:41:21,892 [INFO]: 	avg_search_speed_ms: 12.04735038701041
2025-03-13 18:41:21,892 [INFO]: 	99p_search_speed_ms: 19.31709954980763
2025-03-13 18:41:21,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:21,892 [INFO]: 	nb vectors: 8374
2025-03-13 18:41:21,892 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:21,892 [INFO]: 	compression ratio: 0.9993083861018175
2025-03-13 18:41:21,892 [INFO]: }
2025-03-13 18:41:21,892 [INFO]: 	>>> Finished "Creating the index" in 130.8926 secs
2025-03-13 18:41:21,892 [INFO]: >>> Finished "Launching the whole pipeline" in 130.9193 secs
2025-03-13 18:41:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 74722 [episode count 13/20]
[retrieval_preprocessing] for episode 17347 [episode count 14/20], we have num_retrieval=np.int64(8552) num_query=np.int64(294)
2025-03-13 18:41:28,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:30,244 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:30
2025-03-13 18:41:30,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.71it/s]
2025-03-13 18:41:30,271 [INFO]: There are 8552 embeddings of dim 49152
2025-03-13 18:41:30,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:41:30,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:30
2025-03-13 18:41:30,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:30,272 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:41:30,272 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:30,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:41:30,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:30
2025-03-13 18:41:30,272 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:30,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:41:30,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:30
2025-03-13 18:41:30,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:30,273 [INFO]: 	Creating the index 03/13/2025, 18:41:30
2025-03-13 18:41:30,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:30
2025-03-13 18:41:30,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 18:41:30,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:30
2025-03-13 18:41:30,276 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:41:30,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:09,  3.63it/s]  6%|▌         | 2/35 [00:00<00:06,  5.44it/s]  9%|▊         | 3/35 [00:00<00:04,  6.51it/s] 11%|█▏        | 4/35 [00:00<00:04,  7.46it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.80it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.03it/s] 20%|██        | 7/35 [00:00<00:03,  8.50it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.70it/s] 26%|██▌       | 9/35 [00:01<00:03,  8.65it/s] 29%|██▊       | 10/35 [00:01<00:02,  8.61it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.51it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.57it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.51it/s] 40%|████      | 14/35 [00:01<00:02,  8.45it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.41it/s] 46%|████▌     | 16/35 [00:02<00:02,  8.36it/s] 51%|█████▏    | 18/35 [00:02<00:01,  9.55it/s] 57%|█████▋    | 20/35 [00:02<00:01, 10.40it/s] 63%|██████▎   | 22/35 [00:06<00:11,  1.15it/s] 71%|███████▏  | 25/35 [00:06<00:05,  1.98it/s] 80%|████████  | 28/35 [00:07<00:02,  3.01it/s] 86%|████████▌ | 30/35 [00:07<00:01,  3.78it/s] 91%|█████████▏| 32/35 [00:07<00:00,  4.62it/s] 97%|█████████▋| 34/35 [00:07<00:00,  5.45it/s]100%|██████████| 35/35 [00:11<00:00,  2.98it/s]
2025-03-13 18:41:42,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:42
2025-03-13 18:42:49,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.2404 secs
2025-03-13 18:42:49,280 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 18:42:49,280 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 18:43:26,308 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0280 secs
2025-03-13 18:43:26,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.5723 secs
2025-03-13 18:43:26,848 [INFO]: {
2025-03-13 18:43:26,848 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:26,848 [INFO]: 	index_param: efSearch=232
2025-03-13 18:43:26,849 [INFO]: 	index_path: knn.index
2025-03-13 18:43:26,849 [INFO]: 	size in bytes: 1682555290
2025-03-13 18:43:26,849 [INFO]: 	avg_search_speed_ms: 14.30891423109114
2025-03-13 18:43:26,849 [INFO]: 	99p_search_speed_ms: 23.34021244198083
2025-03-13 18:43:26,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:26,849 [INFO]: 	nb vectors: 8552
2025-03-13 18:43:26,849 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:26,849 [INFO]: 	compression ratio: 0.9993083888494386
2025-03-13 18:43:26,849 [INFO]: }
2025-03-13 18:43:26,849 [INFO]: 	>>> Finished "Creating the index" in 116.5759 secs
2025-03-13 18:43:26,849 [INFO]: >>> Finished "Launching the whole pipeline" in 116.6046 secs
2025-03-13 18:43:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 17347 [episode count 14/20]
[retrieval_preprocessing] for episode 27299 [episode count 15/20], we have num_retrieval=np.int64(8198) num_query=np.int64(648)
2025-03-13 18:43:34,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:36,290 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:36
2025-03-13 18:43:36,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.87it/s]
2025-03-13 18:43:36,315 [INFO]: There are 8198 embeddings of dim 49152
2025-03-13 18:43:36,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:43:36,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:36
2025-03-13 18:43:36,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:36,315 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 18:43:36,315 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:36,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:36,315 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:36
2025-03-13 18:43:36,315 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:36,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:36,315 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:36
2025-03-13 18:43:36,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:36,315 [INFO]: 	Creating the index 03/13/2025, 18:43:36
2025-03-13 18:43:36,316 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:36
2025-03-13 18:43:36,316 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:43:36,316 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:36
2025-03-13 18:43:36,317 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:43:36,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.49it/s]  6%|▌         | 2/34 [00:00<00:04,  6.56it/s]  9%|▉         | 3/34 [00:00<00:04,  7.52it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.96it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.40it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.53it/s] 21%|██        | 7/34 [00:00<00:03,  8.72it/s] 24%|██▎       | 8/34 [00:00<00:02,  8.87it/s] 26%|██▋       | 9/34 [00:01<00:02,  8.82it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.74it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.68it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.40it/s] 41%|████      | 14/34 [00:01<00:02,  9.20it/s] 44%|████▍     | 15/34 [00:01<00:02,  9.09it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.81it/s] 53%|█████▎    | 18/34 [00:02<00:01,  9.79it/s] 59%|█████▉    | 20/34 [00:02<00:01, 10.60it/s] 65%|██████▍   | 22/34 [00:06<00:10,  1.14it/s] 71%|███████   | 24/34 [00:06<00:06,  1.65it/s] 76%|███████▋  | 26/34 [00:07<00:03,  2.32it/s] 82%|████████▏ | 28/34 [00:07<00:01,  3.18it/s] 88%|████████▊ | 30/34 [00:07<00:00,  4.25it/s] 94%|█████████▍| 32/34 [00:07<00:00,  5.49it/s]100%|██████████| 34/34 [00:11<00:00,  1.33it/s]100%|██████████| 34/34 [00:11<00:00,  2.94it/s]
2025-03-13 18:43:47,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:47
2025-03-13 18:44:53,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9634 secs
2025-03-13 18:44:53,856 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:44:53,857 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 18:45:36,621 [INFO]: 	>>> Finished "Compute fast metrics" in 42.7639 secs
2025-03-13 18:45:36,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.3068 secs
2025-03-13 18:45:36,624 [INFO]: {
2025-03-13 18:45:36,624 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:36,624 [INFO]: 	index_param: efSearch=224
2025-03-13 18:45:36,624 [INFO]: 	index_path: knn.index
2025-03-13 18:45:36,624 [INFO]: 	size in bytes: 1612908310
2025-03-13 18:45:36,624 [INFO]: 	avg_search_speed_ms: 13.70856340189962
2025-03-13 18:45:36,624 [INFO]: 	99p_search_speed_ms: 19.279062540736053
2025-03-13 18:45:36,624 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:36,624 [INFO]: 	nb vectors: 8198
2025-03-13 18:45:36,624 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:36,624 [INFO]: 	compression ratio: 0.9993081280609187
2025-03-13 18:45:36,624 [INFO]: }
2025-03-13 18:45:36,624 [INFO]: 	>>> Finished "Creating the index" in 120.3082 secs
2025-03-13 18:45:36,624 [INFO]: >>> Finished "Launching the whole pipeline" in 120.3339 secs
2025-03-13 18:45:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27299 [episode count 15/20]
[retrieval_preprocessing] for episode 19681 [episode count 16/20], we have num_retrieval=np.int64(8171) num_query=np.int64(675)
2025-03-13 18:45:45,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:47,057 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:47
2025-03-13 18:45:47,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 18:45:47,083 [INFO]: There are 8171 embeddings of dim 49152
2025-03-13 18:45:47,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:45:47,083 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:47
2025-03-13 18:45:47,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:47,083 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 18:45:47,083 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:47,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:47,083 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:47
2025-03-13 18:45:47,084 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:47,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:45:47,084 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:47
2025-03-13 18:45:47,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:47,084 [INFO]: 	Creating the index 03/13/2025, 18:45:47
2025-03-13 18:45:47,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:47
2025-03-13 18:45:47,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:45:47,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:47
2025-03-13 18:45:47,085 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:45:47,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.17it/s]  9%|▉         | 3/34 [00:00<00:03,  8.99it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.35it/s] 21%|██        | 7/34 [00:00<00:02, 11.09it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.48it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.68it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.92it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.97it/s] 50%|█████     | 17/34 [00:01<00:01, 12.07it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.09it/s] 62%|██████▏   | 21/34 [00:05<00:08,  1.55it/s] 65%|██████▍   | 22/34 [00:05<00:06,  1.83it/s] 71%|███████   | 24/34 [00:05<00:03,  2.55it/s] 76%|███████▋  | 26/34 [00:05<00:02,  3.38it/s] 82%|████████▏ | 28/34 [00:06<00:01,  4.31it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.82it/s] 91%|█████████ | 31/34 [00:06<00:00,  5.91it/s] 97%|█████████▋| 33/34 [00:06<00:00,  6.93it/s]100%|██████████| 34/34 [00:10<00:00,  3.32it/s]
2025-03-13 18:45:57,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:57
2025-03-13 18:46:58,460 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1375 secs
2025-03-13 18:46:58,461 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 18:46:58,461 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 18:47:35,469 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0077 secs
2025-03-13 18:47:35,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.3862 secs
2025-03-13 18:47:35,471 [INFO]: {
2025-03-13 18:47:35,471 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:35,471 [INFO]: 	index_param: efSearch=246
2025-03-13 18:47:35,471 [INFO]: 	index_path: knn.index
2025-03-13 18:47:35,471 [INFO]: 	size in bytes: 1607596210
2025-03-13 18:47:35,471 [INFO]: 	avg_search_speed_ms: 15.604812659863702
2025-03-13 18:47:35,471 [INFO]: 	99p_search_speed_ms: 22.88079177960754
2025-03-13 18:47:35,471 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:35,471 [INFO]: 	nb vectors: 8171
2025-03-13 18:47:35,471 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:35,471 [INFO]: 	compression ratio: 0.9993081334771249
2025-03-13 18:47:35,471 [INFO]: }
2025-03-13 18:47:35,471 [INFO]: 	>>> Finished "Creating the index" in 108.3877 secs
2025-03-13 18:47:35,471 [INFO]: >>> Finished "Launching the whole pipeline" in 108.4141 secs
2025-03-13 18:47:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 19681 [episode count 16/20]
[retrieval_preprocessing] for episode 79092 [episode count 17/20], we have num_retrieval=np.int64(8427) num_query=np.int64(419)
2025-03-13 18:47:49,057 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:50,420 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:50
2025-03-13 18:47:50,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.47it/s]
2025-03-13 18:47:50,450 [INFO]: There are 8427 embeddings of dim 49152
2025-03-13 18:47:50,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:47:50,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:50,451 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:47:50,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:50,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:47:50,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,452 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:50,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:47:50,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:50
2025-03-13 18:47:50,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:50,452 [INFO]: 	Creating the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:50
2025-03-13 18:47:50,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:47:50,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,456 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:47:50,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.20it/s]  9%|▊         | 3/35 [00:00<00:03,  8.90it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.15it/s] 20%|██        | 7/35 [00:00<00:02, 10.97it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.24it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.74it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.10it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.28it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.60it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.66it/s] 60%|██████    | 21/35 [00:06<00:10,  1.37it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.88it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.55it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.36it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.33it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.33it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.41it/s]100%|██████████| 35/35 [00:11<00:00,  1.35it/s]100%|██████████| 35/35 [00:11<00:00,  3.11it/s]
2025-03-13 18:48:01,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:01
2025-03-13 18:49:10,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.7346 secs
2025-03-13 18:49:10,445 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:49:10,445 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 18:49:57,793 [INFO]: 	>>> Finished "Compute fast metrics" in 47.3478 secs
2025-03-13 18:49:57,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.3396 secs
2025-03-13 18:49:57,796 [INFO]: {
2025-03-13 18:49:57,796 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:57,796 [INFO]: 	index_param: efSearch=231
2025-03-13 18:49:57,796 [INFO]: 	index_path: knn.index
2025-03-13 18:49:57,796 [INFO]: 	size in bytes: 1657962310
2025-03-13 18:49:57,796 [INFO]: 	avg_search_speed_ms: 14.610056780333066
2025-03-13 18:49:57,796 [INFO]: 	99p_search_speed_ms: 24.852270670235118
2025-03-13 18:49:57,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:57,796 [INFO]: 	nb vectors: 8427
2025-03-13 18:49:57,796 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:57,796 [INFO]: 	compression ratio: 0.9993083714912675
2025-03-13 18:49:57,796 [INFO]: }
2025-03-13 18:49:57,796 [INFO]: 	>>> Finished "Creating the index" in 127.3437 secs
2025-03-13 18:49:57,796 [INFO]: >>> Finished "Launching the whole pipeline" in 127.3763 secs
2025-03-13 18:50:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 79092 [episode count 17/20]
[retrieval_preprocessing] for episode 10079 [episode count 18/20], we have num_retrieval=np.int64(8492) num_query=np.int64(354)
2025-03-13 18:50:07,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:09,631 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:09
2025-03-13 18:50:09,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.97it/s]
2025-03-13 18:50:09,658 [INFO]: There are 8492 embeddings of dim 49152
2025-03-13 18:50:09,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:50:09,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:09
2025-03-13 18:50:09,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:09,659 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 18:50:09,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:09,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:09,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:09
2025-03-13 18:50:09,659 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:09,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:50:09,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:09
2025-03-13 18:50:09,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:09,659 [INFO]: 	Creating the index 03/13/2025, 18:50:09
2025-03-13 18:50:09,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:09
2025-03-13 18:50:09,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:50:09,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:09
2025-03-13 18:50:09,660 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:50:09,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.64it/s]  6%|▌         | 2/35 [00:00<00:04,  6.67it/s]  9%|▊         | 3/35 [00:00<00:04,  7.83it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.29it/s] 20%|██        | 7/35 [00:00<00:02, 10.23it/s] 26%|██▌       | 9/35 [00:00<00:02, 10.75it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.79it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.16it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.29it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.47it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.42it/s] 60%|██████    | 21/35 [00:05<00:09,  1.44it/s] 63%|██████▎   | 22/35 [00:06<00:07,  1.70it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.39it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.22it/s] 80%|████████  | 28/35 [00:06<00:01,  4.17it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.19it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.22it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.24it/s]100%|██████████| 35/35 [00:10<00:00,  3.33it/s]
2025-03-13 18:50:20,185 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:20
2025-03-13 18:51:24,544 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3586 secs
2025-03-13 18:51:24,544 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 18:51:24,544 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s] 50%|█████     | 2/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-13 18:51:58,296 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7516 secs
2025-03-13 18:51:58,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.6379 secs
2025-03-13 18:51:58,298 [INFO]: {
2025-03-13 18:51:58,298 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:58,298 [INFO]: 	index_param: efSearch=230
2025-03-13 18:51:58,298 [INFO]: 	index_path: knn.index
2025-03-13 18:51:58,298 [INFO]: 	size in bytes: 1670750770
2025-03-13 18:51:58,299 [INFO]: 	avg_search_speed_ms: 13.918097352774836
2025-03-13 18:51:58,299 [INFO]: 	99p_search_speed_ms: 22.111524920910604
2025-03-13 18:51:58,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:58,299 [INFO]: 	nb vectors: 8492
2025-03-13 18:51:58,299 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:58,299 [INFO]: 	compression ratio: 0.9993083145489139
2025-03-13 18:51:58,299 [INFO]: }
2025-03-13 18:51:58,299 [INFO]: 	>>> Finished "Creating the index" in 108.6395 secs
2025-03-13 18:51:58,299 [INFO]: >>> Finished "Launching the whole pipeline" in 108.6672 secs
2025-03-13 18:52:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 10079 [episode count 18/20]
[retrieval_preprocessing] for episode 44481 [episode count 19/20], we have num_retrieval=np.int64(8344) num_query=np.int64(502)
2025-03-13 18:52:05,424 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:06,600 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:06
2025-03-13 18:52:06,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.38it/s]
2025-03-13 18:52:06,627 [INFO]: There are 8344 embeddings of dim 49152
2025-03-13 18:52:06,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:52:06,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:06
2025-03-13 18:52:06,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:06,628 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 18:52:06,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:06,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:06,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:06
2025-03-13 18:52:06,628 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:06,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:52:06,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:06
2025-03-13 18:52:06,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:06,628 [INFO]: 	Creating the index 03/13/2025, 18:52:06
2025-03-13 18:52:06,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:06
2025-03-13 18:52:06,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:52:06,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:06
2025-03-13 18:52:06,630 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:52:06,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.89it/s]  6%|▌         | 2/34 [00:00<00:04,  6.50it/s]  9%|▉         | 3/34 [00:00<00:04,  7.27it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.65it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.92it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.07it/s] 21%|██        | 7/34 [00:00<00:03,  8.26it/s] 24%|██▎       | 8/34 [00:01<00:03,  8.36it/s] 26%|██▋       | 9/34 [00:01<00:02,  8.45it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.53it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.63it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.78it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.79it/s] 41%|████      | 14/34 [00:01<00:02,  8.80it/s] 47%|████▋     | 16/34 [00:01<00:01, 10.08it/s] 53%|█████▎    | 18/34 [00:02<00:01, 10.94it/s] 59%|█████▉    | 20/34 [00:02<00:01, 11.42it/s] 65%|██████▍   | 22/34 [00:06<00:09,  1.25it/s] 71%|███████   | 24/34 [00:06<00:05,  1.78it/s] 76%|███████▋  | 26/34 [00:06<00:03,  2.46it/s] 82%|████████▏ | 28/34 [00:06<00:01,  3.30it/s] 88%|████████▊ | 30/34 [00:07<00:00,  4.31it/s] 94%|█████████▍| 32/34 [00:07<00:00,  5.45it/s]100%|██████████| 34/34 [00:10<00:00,  1.48it/s]100%|██████████| 34/34 [00:10<00:00,  3.12it/s]
2025-03-13 18:52:17,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:17
2025-03-13 18:53:23,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.3917 secs
2025-03-13 18:53:23,913 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 18:53:23,913 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 18:53:50,762 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8489 secs
2025-03-13 18:53:50,764 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1344 secs
2025-03-13 18:53:50,764 [INFO]: {
2025-03-13 18:53:50,764 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:50,764 [INFO]: 	index_param: efSearch=214
2025-03-13 18:53:50,764 [INFO]: 	index_path: knn.index
2025-03-13 18:53:50,764 [INFO]: 	size in bytes: 1641632590
2025-03-13 18:53:50,764 [INFO]: 	avg_search_speed_ms: 13.371083713609746
2025-03-13 18:53:50,764 [INFO]: 	99p_search_speed_ms: 20.09323983220383
2025-03-13 18:53:50,764 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:50,764 [INFO]: 	nb vectors: 8344
2025-03-13 18:53:50,764 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:50,764 [INFO]: 	compression ratio: 0.99930834828273
2025-03-13 18:53:50,765 [INFO]: }
2025-03-13 18:53:50,765 [INFO]: 	>>> Finished "Creating the index" in 104.1362 secs
2025-03-13 18:53:50,765 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1641 secs
2025-03-13 18:53:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 44481 [episode count 19/20]
2025-03-13 18:53:56: [retrieval_preprocessing] finished for 3774560981_put_white_towel_black_basket [chosen_id count 6/196]
2025-03-13 18:53:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3816161570_open_bottom_drawer [chosen_id count 7/196]
2025-03-13 18:53:59: [retrieval_preprocessing] we have num_total=3683 embedding_dim=49152
[retrieval_preprocessing] for episode 81409 [episode count 0/20], we have num_retrieval=np.int64(3419) num_query=np.int64(264)
2025-03-13 18:54:01,218 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:01,864 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:01
2025-03-13 18:54:01,865 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.69it/s]
2025-03-13 18:54:01,893 [INFO]: There are 3419 embeddings of dim 49152
2025-03-13 18:54:01,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:54:01,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:01
2025-03-13 18:54:01,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:01,894 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:54:01,894 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:01,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:01,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:01
2025-03-13 18:54:01,894 [INFO]: 705.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:01,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:54:01,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:01
2025-03-13 18:54:01,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:01,894 [INFO]: 	Creating the index 03/13/2025, 18:54:01
2025-03-13 18:54:01,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:01
2025-03-13 18:54:01,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:54:01,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:01
2025-03-13 18:54:01,896 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:54:01,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.34it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.77it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.84it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.24it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.72it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.48it/s] 50%|█████     | 7/14 [00:00<00:00,  8.86it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.72it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.61it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.47it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.81it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.06it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.93it/s]100%|██████████| 14/14 [00:04<00:00,  1.21it/s]100%|██████████| 14/14 [00:04<00:00,  3.49it/s]
2025-03-13 18:54:05,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:05
2025-03-13 18:54:45,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6329 secs
2025-03-13 18:54:45,551 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 18:54:45,551 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 18:55:06,225 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6738 secs
2025-03-13 18:55:06,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3320 secs
2025-03-13 18:55:06,228 [INFO]: {
2025-03-13 18:55:06,228 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:06,228 [INFO]: 	index_param: efSearch=304
2025-03-13 18:55:06,228 [INFO]: 	index_path: knn.index
2025-03-13 18:55:06,228 [INFO]: 	size in bytes: 672667330
2025-03-13 18:55:06,228 [INFO]: 	avg_search_speed_ms: 10.658188601399758
2025-03-13 18:55:06,228 [INFO]: 	99p_search_speed_ms: 15.236687615979463
2025-03-13 18:55:06,228 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:06,228 [INFO]: 	nb vectors: 3419
2025-03-13 18:55:06,228 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:06,228 [INFO]: 	compression ratio: 0.9993093495413253
2025-03-13 18:55:06,228 [INFO]: }
2025-03-13 18:55:06,228 [INFO]: 	>>> Finished "Creating the index" in 64.3339 secs
2025-03-13 18:55:06,228 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3636 secs
2025-03-13 18:55:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 81409 [episode count 0/20]
[retrieval_preprocessing] for episode 4116 [episode count 1/20], we have num_retrieval=np.int64(3512) num_query=np.int64(171)
2025-03-13 18:55:10,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:10,512 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:10
2025-03-13 18:55:10,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-13 18:55:10,536 [INFO]: There are 3512 embeddings of dim 49152
2025-03-13 18:55:10,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:55:10,537 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:10
2025-03-13 18:55:10,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:10,537 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:55:10,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:10,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:10,537 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:10
2025-03-13 18:55:10,537 [INFO]: 724.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:10,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:55:10,537 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:10
2025-03-13 18:55:10,537 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:10,537 [INFO]: 	Creating the index 03/13/2025, 18:55:10
2025-03-13 18:55:10,537 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:10
2025-03-13 18:55:10,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:55:10,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:10
2025-03-13 18:55:10,538 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:55:10,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.47it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.16it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.43it/s] 50%|█████     | 7/14 [00:00<00:00, 11.96it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.29it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.62it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.71it/s]100%|██████████| 14/14 [00:03<00:00,  4.38it/s]
2025-03-13 18:55:13,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:13
2025-03-13 18:55:49,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8180 secs
2025-03-13 18:55:49,563 [INFO]: The best hyperparameters are: efSearch=391
2025-03-13 18:55:49,563 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s]
2025-03-13 18:56:10,556 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9929 secs
2025-03-13 18:56:10,558 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0197 secs
2025-03-13 18:56:10,558 [INFO]: {
2025-03-13 18:56:10,558 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:10,558 [INFO]: 	index_param: efSearch=391
2025-03-13 18:56:10,558 [INFO]: 	index_path: knn.index
2025-03-13 18:56:10,558 [INFO]: 	size in bytes: 690964390
2025-03-13 18:56:10,558 [INFO]: 	avg_search_speed_ms: 10.977599734561078
2025-03-13 18:56:10,558 [INFO]: 	99p_search_speed_ms: 15.445583616383374
2025-03-13 18:56:10,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:10,558 [INFO]: 	nb vectors: 3512
2025-03-13 18:56:10,558 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:10,558 [INFO]: 	compression ratio: 0.9993095244749154
2025-03-13 18:56:10,558 [INFO]: }
2025-03-13 18:56:10,558 [INFO]: 	>>> Finished "Creating the index" in 60.0211 secs
2025-03-13 18:56:10,558 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0463 secs
2025-03-13 18:56:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 4116 [episode count 1/20]
[retrieval_preprocessing] for episode 24605 [episode count 2/20], we have num_retrieval=np.int64(3511) num_query=np.int64(172)
2025-03-13 18:56:14,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:14,992 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:14
2025-03-13 18:56:14,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.82it/s]
2025-03-13 18:56:15,017 [INFO]: There are 3511 embeddings of dim 49152
2025-03-13 18:56:15,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:56:15,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:15
2025-03-13 18:56:15,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:15,017 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:56:15,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:15,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:15,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:15
2025-03-13 18:56:15,017 [INFO]: 724.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:15,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:56:15,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:15
2025-03-13 18:56:15,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:15,018 [INFO]: 	Creating the index 03/13/2025, 18:56:15
2025-03-13 18:56:15,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:15
2025-03-13 18:56:15,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:56:15,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:15
2025-03-13 18:56:15,019 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:56:15,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.43it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.87it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.01it/s] 50%|█████     | 7/14 [00:00<00:00, 11.44it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.70it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.90it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.90it/s]100%|██████████| 14/14 [00:03<00:00,  4.05it/s]
2025-03-13 18:56:18,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:18
2025-03-13 18:56:49,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5917 secs
2025-03-13 18:56:49,074 [INFO]: The best hyperparameters are: efSearch=394
2025-03-13 18:56:49,074 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
2025-03-13 18:57:08,083 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0093 secs
2025-03-13 18:57:08,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0669 secs
2025-03-13 18:57:08,086 [INFO]: {
2025-03-13 18:57:08,086 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:08,086 [INFO]: 	index_param: efSearch=394
2025-03-13 18:57:08,086 [INFO]: 	index_path: knn.index
2025-03-13 18:57:08,086 [INFO]: 	size in bytes: 690767650
2025-03-13 18:57:08,086 [INFO]: 	avg_search_speed_ms: 11.030134529310722
2025-03-13 18:57:08,086 [INFO]: 	99p_search_speed_ms: 16.12117259763181
2025-03-13 18:57:08,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:08,086 [INFO]: 	nb vectors: 3511
2025-03-13 18:57:08,086 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:08,086 [INFO]: 	compression ratio: 0.9993095189098679
2025-03-13 18:57:08,086 [INFO]: }
2025-03-13 18:57:08,086 [INFO]: 	>>> Finished "Creating the index" in 53.0682 secs
2025-03-13 18:57:08,086 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0939 secs
2025-03-13 18:57:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 24605 [episode count 2/20]
[retrieval_preprocessing] for episode 24623 [episode count 3/20], we have num_retrieval=np.int64(3493) num_query=np.int64(190)
2025-03-13 18:57:11,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:12,439 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:12
2025-03-13 18:57:12,439 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1897.02it/s]
2025-03-13 18:57:12,462 [INFO]: There are 3493 embeddings of dim 49152
2025-03-13 18:57:12,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:57:12,463 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:12
2025-03-13 18:57:12,463 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:12,463 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:57:12,463 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:12,463 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:57:12,463 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:12
2025-03-13 18:57:12,463 [INFO]: 720.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:12,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:57:12,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:12
2025-03-13 18:57:12,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:12,463 [INFO]: 	Creating the index 03/13/2025, 18:57:12
2025-03-13 18:57:12,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:12
2025-03-13 18:57:12,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:57:12,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:12
2025-03-13 18:57:12,464 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:57:12,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.11it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.34it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.75it/s] 50%|█████     | 7/14 [00:00<00:00, 12.80it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.25it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.47it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.65it/s]100%|██████████| 14/14 [00:03<00:00,  4.04it/s]
2025-03-13 18:57:15,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:15
2025-03-13 18:57:47,172 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2308 secs
2025-03-13 18:57:47,172 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 18:57:47,172 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 18:58:08,449 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2770 secs
2025-03-13 18:58:08,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9877 secs
2025-03-13 18:58:08,452 [INFO]: {
2025-03-13 18:58:08,452 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:08,452 [INFO]: 	index_param: efSearch=308
2025-03-13 18:58:08,452 [INFO]: 	index_path: knn.index
2025-03-13 18:58:08,452 [INFO]: 	size in bytes: 687226270
2025-03-13 18:58:08,452 [INFO]: 	avg_search_speed_ms: 9.73055981745552
2025-03-13 18:58:08,452 [INFO]: 	99p_search_speed_ms: 14.582166317850358
2025-03-13 18:58:08,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:08,452 [INFO]: 	nb vectors: 3493
2025-03-13 18:58:08,452 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:08,452 [INFO]: 	compression ratio: 0.9993095054413447
2025-03-13 18:58:08,452 [INFO]: }
2025-03-13 18:58:08,452 [INFO]: 	>>> Finished "Creating the index" in 55.9892 secs
2025-03-13 18:58:08,452 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0135 secs
2025-03-13 18:58:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 24623 [episode count 3/20]
[retrieval_preprocessing] for episode 30264 [episode count 4/20], we have num_retrieval=np.int64(3530) num_query=np.int64(153)
2025-03-13 18:58:12,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:12,582 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:12
2025-03-13 18:58:12,582 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2129.09it/s]
2025-03-13 18:58:12,607 [INFO]: There are 3530 embeddings of dim 49152
2025-03-13 18:58:12,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:58:12,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:12
2025-03-13 18:58:12,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:12,608 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:58:12,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:12,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:58:12,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:12
2025-03-13 18:58:12,609 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:12,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:58:12,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:12
2025-03-13 18:58:12,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:12,610 [INFO]: 	Creating the index 03/13/2025, 18:58:12
2025-03-13 18:58:12,610 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:12
2025-03-13 18:58:12,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:58:12,613 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:12
2025-03-13 18:58:12,613 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:58:12,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.80it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.96it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.43it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.66it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.80it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.02it/s] 50%|█████     | 7/14 [00:00<00:00,  8.04it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.05it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.00it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.94it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.03it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.06it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.03it/s]100%|██████████| 14/14 [00:04<00:00,  1.21it/s]100%|██████████| 14/14 [00:04<00:00,  3.41it/s]
2025-03-13 18:58:16,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:16
2025-03-13 18:58:46,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2136 secs
2025-03-13 18:58:46,949 [INFO]: The best hyperparameters are: efSearch=486
2025-03-13 18:58:46,949 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 18:59:09,247 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2975 secs
2025-03-13 18:59:09,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6375 secs
2025-03-13 18:59:09,250 [INFO]: {
2025-03-13 18:59:09,251 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:09,251 [INFO]: 	index_param: efSearch=486
2025-03-13 18:59:09,251 [INFO]: 	index_path: knn.index
2025-03-13 18:59:09,251 [INFO]: 	size in bytes: 694505770
2025-03-13 18:59:09,251 [INFO]: 	avg_search_speed_ms: 13.856185717221834
2025-03-13 18:59:09,251 [INFO]: 	99p_search_speed_ms: 20.751268083695322
2025-03-13 18:59:09,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:09,251 [INFO]: 	nb vectors: 3530
2025-03-13 18:59:09,251 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:09,251 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-13 18:59:09,251 [INFO]: }
2025-03-13 18:59:09,251 [INFO]: 	>>> Finished "Creating the index" in 56.6410 secs
2025-03-13 18:59:09,251 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6683 secs
2025-03-13 18:59:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 30264 [episode count 4/20]
[retrieval_preprocessing] for episode 5689 [episode count 5/20], we have num_retrieval=np.int64(3445) num_query=np.int64(238)
2025-03-13 18:59:13,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:13,869 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:13
2025-03-13 18:59:13,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2275.80it/s]
2025-03-13 18:59:13,893 [INFO]: There are 3445 embeddings of dim 49152
2025-03-13 18:59:13,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 18:59:13,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:13
2025-03-13 18:59:13,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:13,893 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:59:13,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:13,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:13,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:13
2025-03-13 18:59:13,893 [INFO]: 711.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:13,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:59:13,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:13
2025-03-13 18:59:13,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:13,893 [INFO]: 	Creating the index 03/13/2025, 18:59:13
2025-03-13 18:59:13,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:13
2025-03-13 18:59:13,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:59:13,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:13
2025-03-13 18:59:13,894 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:59:13,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.48it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.95it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.01it/s] 50%|█████     | 7/14 [00:00<00:00, 11.61it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.84it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.06it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.11it/s]100%|██████████| 14/14 [00:03<00:00,  4.40it/s]
2025-03-13 18:59:17,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:17
2025-03-13 18:59:46,160 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0817 secs
2025-03-13 18:59:46,160 [INFO]: The best hyperparameters are: efSearch=486
2025-03-13 18:59:46,160 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 19:00:21,670 [INFO]: 	>>> Finished "Compute fast metrics" in 35.5095 secs
2025-03-13 19:00:22,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3877 secs
2025-03-13 19:00:22,282 [INFO]: {
2025-03-13 19:00:22,283 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:22,283 [INFO]: 	index_param: efSearch=486
2025-03-13 19:00:22,283 [INFO]: 	index_path: knn.index
2025-03-13 19:00:22,283 [INFO]: 	size in bytes: 677782690
2025-03-13 19:00:22,283 [INFO]: 	avg_search_speed_ms: 13.752848824276045
2025-03-13 19:00:22,283 [INFO]: 	99p_search_speed_ms: 18.79950923845172
2025-03-13 19:00:22,283 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:22,283 [INFO]: 	nb vectors: 3445
2025-03-13 19:00:22,283 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:22,283 [INFO]: 	compression ratio: 0.9993093213991641
2025-03-13 19:00:22,283 [INFO]: }
2025-03-13 19:00:22,283 [INFO]: 	>>> Finished "Creating the index" in 68.3899 secs
2025-03-13 19:00:22,283 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4137 secs
2025-03-13 19:00:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 5689 [episode count 5/20]
[retrieval_preprocessing] for episode 9341 [episode count 6/20], we have num_retrieval=np.int64(3532) num_query=np.int64(151)
2025-03-13 19:00:27,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:27,757 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:27
2025-03-13 19:00:27,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.90it/s]
2025-03-13 19:00:27,781 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 19:00:27,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 19:00:27,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:27
2025-03-13 19:00:27,781 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:27,781 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:00:27,781 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:27,781 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:27,781 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:27
2025-03-13 19:00:27,781 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:27,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:27,781 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:27
2025-03-13 19:00:27,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:27,781 [INFO]: 	Creating the index 03/13/2025, 19:00:27
2025-03-13 19:00:27,781 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:27
2025-03-13 19:00:27,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:00:27,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:27
2025-03-13 19:00:27,783 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:00:27,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.87it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.51it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.85it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.95it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.10it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.16it/s] 50%|█████     | 7/14 [00:00<00:00,  8.08it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.14it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.21it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.36it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.37it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.30it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.25it/s]100%|██████████| 14/14 [00:03<00:00,  1.27it/s]100%|██████████| 14/14 [00:03<00:00,  3.55it/s]
2025-03-13 19:00:31,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:31
2025-03-13 19:01:05,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5669 secs
2025-03-13 19:01:05,301 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 19:01:05,301 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 19:01:27,739 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4372 secs
2025-03-13 19:01:27,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9586 secs
2025-03-13 19:01:27,741 [INFO]: {
2025-03-13 19:01:27,741 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:27,741 [INFO]: 	index_param: efSearch=171
2025-03-13 19:01:27,741 [INFO]: 	index_path: knn.index
2025-03-13 19:01:27,741 [INFO]: 	size in bytes: 694899250
2025-03-13 19:01:27,741 [INFO]: 	avg_search_speed_ms: 6.8878424376346805
2025-03-13 19:01:27,742 [INFO]: 	99p_search_speed_ms: 12.51751289702952
2025-03-13 19:01:27,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:27,742 [INFO]: 	nb vectors: 3532
2025-03-13 19:01:27,742 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:27,742 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 19:01:27,742 [INFO]: }
2025-03-13 19:01:27,742 [INFO]: 	>>> Finished "Creating the index" in 59.9601 secs
2025-03-13 19:01:27,742 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9849 secs
2025-03-13 19:01:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:01:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 9341 [episode count 6/20]
[retrieval_preprocessing] for episode 84599 [episode count 7/20], we have num_retrieval=np.int64(3503) num_query=np.int64(180)
2025-03-13 19:01:31,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:31,932 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:31
2025-03-13 19:01:31,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.04it/s]
2025-03-13 19:01:31,957 [INFO]: There are 3503 embeddings of dim 49152
2025-03-13 19:01:31,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 19:01:31,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:31,958 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:01:31,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:31,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:31,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,958 [INFO]: 722.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:31,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:01:31,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:31
2025-03-13 19:01:31,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:31,958 [INFO]: 	Creating the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:31
2025-03-13 19:01:31,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:01:31,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,960 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:01:31,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.75it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.54it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.70it/s] 50%|█████     | 7/14 [00:00<00:00, 12.24it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.86it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.90it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.93it/s]100%|██████████| 14/14 [00:03<00:00,  3.95it/s]
2025-03-13 19:01:35,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:35
2025-03-13 19:02:05,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9684 secs
2025-03-13 19:02:05,481 [INFO]: The best hyperparameters are: efSearch=401
2025-03-13 19:02:05,481 [INFO]: 	Compute fast metrics 03/13/2025, 19:02:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.32it/s] 50%|█████     | 2/4 [00:00<00:00,  4.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.32it/s]
2025-03-13 19:02:36,188 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7067 secs
2025-03-13 19:02:36,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3809 secs
2025-03-13 19:02:36,341 [INFO]: {
2025-03-13 19:02:36,341 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:36,341 [INFO]: 	index_param: efSearch=401
2025-03-13 19:02:36,341 [INFO]: 	index_path: knn.index
2025-03-13 19:02:36,341 [INFO]: 	size in bytes: 689193730
2025-03-13 19:02:36,341 [INFO]: 	avg_search_speed_ms: 12.471612957724256
2025-03-13 19:02:36,341 [INFO]: 	99p_search_speed_ms: 16.3788785925135
2025-03-13 19:02:36,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:36,342 [INFO]: 	nb vectors: 3503
2025-03-13 19:02:36,342 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:36,342 [INFO]: 	compression ratio: 0.999309474275107
2025-03-13 19:02:36,342 [INFO]: }
2025-03-13 19:02:36,342 [INFO]: 	>>> Finished "Creating the index" in 64.3834 secs
2025-03-13 19:02:36,342 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4093 secs
2025-03-13 19:02:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 84599 [episode count 7/20]
[retrieval_preprocessing] for episode 14513 [episode count 8/20], we have num_retrieval=np.int64(3464) num_query=np.int64(219)
2025-03-13 19:02:41,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:41,990 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:41
2025-03-13 19:02:41,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1040.00it/s]
2025-03-13 19:02:42,016 [INFO]: There are 3464 embeddings of dim 49152
2025-03-13 19:02:42,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:02:42,016 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:42
2025-03-13 19:02:42,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:42,016 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:02:42,016 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:42,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:02:42,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:42
2025-03-13 19:02:42,016 [INFO]: 714.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:42,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:02:42,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:42
2025-03-13 19:02:42,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:42,017 [INFO]: 	Creating the index 03/13/2025, 19:02:42
2025-03-13 19:02:42,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:42
2025-03-13 19:02:42,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:02:42,018 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:42
2025-03-13 19:02:42,018 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:02:42,018 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.18it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.17it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.08it/s] 50%|█████     | 7/14 [00:00<00:00, 10.12it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.15it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.15it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.00it/s]100%|██████████| 14/14 [00:03<00:00,  1.86it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-13 19:02:45,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:45
2025-03-13 19:03:16,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2846 secs
2025-03-13 19:03:16,999 [INFO]: The best hyperparameters are: efSearch=322
2025-03-13 19:03:16,999 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 19:03:45,934 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9348 secs
2025-03-13 19:03:45,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9185 secs
2025-03-13 19:03:45,936 [INFO]: {
2025-03-13 19:03:45,936 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:45,936 [INFO]: 	index_param: efSearch=322
2025-03-13 19:03:45,936 [INFO]: 	index_path: knn.index
2025-03-13 19:03:45,936 [INFO]: 	size in bytes: 681520750
2025-03-13 19:03:45,936 [INFO]: 	avg_search_speed_ms: 9.015153011019914
2025-03-13 19:03:45,936 [INFO]: 	99p_search_speed_ms: 12.141657136380674
2025-03-13 19:03:45,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:45,936 [INFO]: 	nb vectors: 3464
2025-03-13 19:03:45,936 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:45,936 [INFO]: 	compression ratio: 0.9993094296835423
2025-03-13 19:03:45,936 [INFO]: }
2025-03-13 19:03:45,936 [INFO]: 	>>> Finished "Creating the index" in 63.9199 secs
2025-03-13 19:03:45,936 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9459 secs
2025-03-13 19:03:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 14513 [episode count 8/20]
[retrieval_preprocessing] for episode 58034 [episode count 9/20], we have num_retrieval=np.int64(3530) num_query=np.int64(153)
2025-03-13 19:03:49,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:50,676 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:50
2025-03-13 19:03:50,676 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1919.59it/s]
2025-03-13 19:03:50,699 [INFO]: There are 3530 embeddings of dim 49152
2025-03-13 19:03:50,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 19:03:50,700 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:50
2025-03-13 19:03:50,700 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:50,700 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:03:50,700 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:03:50,700 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:03:50,700 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:50
2025-03-13 19:03:50,700 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:50,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:03:50,700 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:50
2025-03-13 19:03:50,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:50,700 [INFO]: 	Creating the index 03/13/2025, 19:03:50
2025-03-13 19:03:50,700 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:03:50
2025-03-13 19:03:50,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:03:50,701 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:50
2025-03-13 19:03:50,701 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:03:50,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  4.02it/s] 14%|█▍        | 2/14 [00:00<00:02,  5.32it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.71it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.50it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.16it/s] 50%|█████     | 7/14 [00:00<00:00,  9.19it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.35it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.16it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.20it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.11it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.06it/s]100%|██████████| 14/14 [00:03<00:00,  1.41it/s]100%|██████████| 14/14 [00:03<00:00,  3.67it/s]
2025-03-13 19:03:54,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:54
2025-03-13 19:04:25,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9526 secs
2025-03-13 19:04:25,477 [INFO]: The best hyperparameters are: efSearch=340
2025-03-13 19:04:25,477 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-13 19:04:48,752 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2754 secs
2025-03-13 19:04:48,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0536 secs
2025-03-13 19:04:48,755 [INFO]: {
2025-03-13 19:04:48,755 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:48,755 [INFO]: 	index_param: efSearch=340
2025-03-13 19:04:48,755 [INFO]: 	index_path: knn.index
2025-03-13 19:04:48,755 [INFO]: 	size in bytes: 694505770
2025-03-13 19:04:48,755 [INFO]: 	avg_search_speed_ms: 8.953484944830796
2025-03-13 19:04:48,755 [INFO]: 	99p_search_speed_ms: 11.801231680437914
2025-03-13 19:04:48,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:48,755 [INFO]: 	nb vectors: 3530
2025-03-13 19:04:48,755 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:48,755 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-13 19:04:48,755 [INFO]: }
2025-03-13 19:04:48,755 [INFO]: 	>>> Finished "Creating the index" in 58.0549 secs
2025-03-13 19:04:48,755 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0792 secs
2025-03-13 19:04:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 58034 [episode count 9/20]
[retrieval_preprocessing] for episode 10934 [episode count 10/20], we have num_retrieval=np.int64(3505) num_query=np.int64(178)
2025-03-13 19:04:51,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:52,456 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:52
2025-03-13 19:04:52,456 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.77it/s]
2025-03-13 19:04:52,480 [INFO]: There are 3505 embeddings of dim 49152
2025-03-13 19:04:52,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 19:04:52,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:52
2025-03-13 19:04:52,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:52,480 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:04:52,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:52,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:04:52,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:52
2025-03-13 19:04:52,480 [INFO]: 723.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:52,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:04:52,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:52
2025-03-13 19:04:52,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:52,480 [INFO]: 	Creating the index 03/13/2025, 19:04:52
2025-03-13 19:04:52,480 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:52
2025-03-13 19:04:52,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:04:52,481 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:52
2025-03-13 19:04:52,481 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:04:52,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.61it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.07it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.04it/s] 50%|█████     | 7/14 [00:00<00:00, 10.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.64it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.78it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.82it/s]100%|██████████| 14/14 [00:03<00:00,  3.82it/s]
2025-03-13 19:04:56,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:56
2025-03-13 19:05:28,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5294 secs
2025-03-13 19:05:28,683 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 19:05:28,683 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 19:05:53,724 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0404 secs
2025-03-13 19:05:53,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3895 secs
2025-03-13 19:05:53,871 [INFO]: {
2025-03-13 19:05:53,871 [INFO]: 	index_key: HNSW15
2025-03-13 19:05:53,871 [INFO]: 	index_param: efSearch=284
2025-03-13 19:05:53,872 [INFO]: 	index_path: knn.index
2025-03-13 19:05:53,872 [INFO]: 	size in bytes: 689587210
2025-03-13 19:05:53,872 [INFO]: 	avg_search_speed_ms: 9.957767712032103
2025-03-13 19:05:53,872 [INFO]: 	99p_search_speed_ms: 14.314461417961866
2025-03-13 19:05:53,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:05:53,872 [INFO]: 	nb vectors: 3505
2025-03-13 19:05:53,872 [INFO]: 	vectors dimension: 49152
2025-03-13 19:05:53,872 [INFO]: 	compression ratio: 0.9993094854528987
2025-03-13 19:05:53,872 [INFO]: }
2025-03-13 19:05:53,872 [INFO]: 	>>> Finished "Creating the index" in 61.3917 secs
2025-03-13 19:05:53,872 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4163 secs
2025-03-13 19:05:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 10934 [episode count 10/20]
[retrieval_preprocessing] for episode 94902 [episode count 11/20], we have num_retrieval=np.int64(3487) num_query=np.int64(196)
2025-03-13 19:05:56,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:56,715 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:56
2025-03-13 19:05:56,715 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.09it/s]
2025-03-13 19:05:56,738 [INFO]: There are 3487 embeddings of dim 49152
2025-03-13 19:05:56,738 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 19:05:56,738 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:56
2025-03-13 19:05:56,738 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:56,738 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:05:56,738 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:05:56,738 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:05:56,738 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:56
2025-03-13 19:05:56,738 [INFO]: 719.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:56,738 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:05:56,738 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:56
2025-03-13 19:05:56,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:05:56,738 [INFO]: 	Creating the index 03/13/2025, 19:05:56
2025-03-13 19:05:56,739 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:05:56
2025-03-13 19:05:56,740 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:05:56,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:56
2025-03-13 19:05:56,740 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:05:56,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.55it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.24it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.09it/s] 50%|█████     | 7/14 [00:00<00:00, 12.51it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.68it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.58it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.84it/s]100%|██████████| 14/14 [00:03<00:00,  4.59it/s]
2025-03-13 19:05:59,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:59
2025-03-13 19:06:26,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0990 secs
2025-03-13 19:06:26,896 [INFO]: The best hyperparameters are: efSearch=398
2025-03-13 19:06:26,896 [INFO]: 	Compute fast metrics 03/13/2025, 19:06:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 19:06:45,411 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5150 secs
2025-03-13 19:06:45,414 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6737 secs
2025-03-13 19:06:45,414 [INFO]: {
2025-03-13 19:06:45,414 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:45,414 [INFO]: 	index_param: efSearch=398
2025-03-13 19:06:45,414 [INFO]: 	index_path: knn.index
2025-03-13 19:06:45,414 [INFO]: 	size in bytes: 686045830
2025-03-13 19:06:45,414 [INFO]: 	avg_search_speed_ms: 11.725869281151947
2025-03-13 19:06:45,414 [INFO]: 	99p_search_speed_ms: 17.126259496435523
2025-03-13 19:06:45,414 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:45,414 [INFO]: 	nb vectors: 3487
2025-03-13 19:06:45,414 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:45,414 [INFO]: 	compression ratio: 0.9993094717884955
2025-03-13 19:06:45,414 [INFO]: }
2025-03-13 19:06:45,414 [INFO]: 	>>> Finished "Creating the index" in 48.6753 secs
2025-03-13 19:06:45,414 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6990 secs
2025-03-13 19:06:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 94902 [episode count 11/20]
[retrieval_preprocessing] for episode 20669 [episode count 12/20], we have num_retrieval=np.int64(3440) num_query=np.int64(243)
2025-03-13 19:06:49,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:49,861 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:49
2025-03-13 19:06:49,861 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1910.84it/s]
2025-03-13 19:06:49,884 [INFO]: There are 3440 embeddings of dim 49152
2025-03-13 19:06:49,884 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 19:06:49,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:49
2025-03-13 19:06:49,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:49,885 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:06:49,885 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:49,885 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:49,885 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:49
2025-03-13 19:06:49,885 [INFO]: 709.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:49,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:06:49,885 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:49
2025-03-13 19:06:49,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:49,885 [INFO]: 	Creating the index 03/13/2025, 19:06:49
2025-03-13 19:06:49,885 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:49
2025-03-13 19:06:49,886 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:06:49,886 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:49
2025-03-13 19:06:49,886 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:06:49,886 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.67it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.03it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.70it/s] 50%|█████     | 7/14 [00:00<00:00, 12.17it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.43it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.49it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.56it/s]100%|██████████| 14/14 [00:03<00:00,  4.53it/s]
2025-03-13 19:06:52,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:52
2025-03-13 19:07:21,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8794 secs
2025-03-13 19:07:21,861 [INFO]: The best hyperparameters are: efSearch=371
2025-03-13 19:07:21,861 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.50it/s] 50%|█████     | 2/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-13 19:07:46,689 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8279 secs
2025-03-13 19:07:46,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8051 secs
2025-03-13 19:07:46,691 [INFO]: {
2025-03-13 19:07:46,691 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:46,691 [INFO]: 	index_param: efSearch=371
2025-03-13 19:07:46,691 [INFO]: 	index_path: knn.index
2025-03-13 19:07:46,691 [INFO]: 	size in bytes: 676798930
2025-03-13 19:07:46,691 [INFO]: 	avg_search_speed_ms: 10.277199939865799
2025-03-13 19:07:46,691 [INFO]: 	99p_search_speed_ms: 14.207741366699334
2025-03-13 19:07:46,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:46,691 [INFO]: 	nb vectors: 3440
2025-03-13 19:07:46,691 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:46,691 [INFO]: 	compression ratio: 0.9993093812958599
2025-03-13 19:07:46,691 [INFO]: }
2025-03-13 19:07:46,691 [INFO]: 	>>> Finished "Creating the index" in 56.8064 secs
2025-03-13 19:07:46,691 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8302 secs
2025-03-13 19:07:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 20669 [episode count 12/20]
[retrieval_preprocessing] for episode 23741 [episode count 13/20], we have num_retrieval=np.int64(3515) num_query=np.int64(168)
2025-03-13 19:07:50,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:51,182 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:51
2025-03-13 19:07:51,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2353.71it/s]
2025-03-13 19:07:51,207 [INFO]: There are 3515 embeddings of dim 49152
2025-03-13 19:07:51,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:07:51,207 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:51,207 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:07:51,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:51,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:07:51,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,207 [INFO]: 725.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:51,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:07:51,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:51
2025-03-13 19:07:51,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:51,207 [INFO]: 	Creating the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:51
2025-03-13 19:07:51,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:07:51,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,208 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:07:51,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.16it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.02it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.07it/s] 50%|█████     | 7/14 [00:00<00:00, 13.24it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.77it/s] 79%|███████▊  | 11/14 [00:00<00:00, 14.03it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.93it/s]100%|██████████| 14/14 [00:03<00:00,  4.28it/s]
2025-03-13 19:07:54,486 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:54
2025-03-13 19:08:26,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2716 secs
2025-03-13 19:08:26,759 [INFO]: The best hyperparameters are: efSearch=379
2025-03-13 19:08:26,759 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s]
2025-03-13 19:08:44,040 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2809 secs
2025-03-13 19:08:44,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8349 secs
2025-03-13 19:08:44,043 [INFO]: {
2025-03-13 19:08:44,043 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:44,043 [INFO]: 	index_param: efSearch=379
2025-03-13 19:08:44,043 [INFO]: 	index_path: knn.index
2025-03-13 19:08:44,044 [INFO]: 	size in bytes: 691554610
2025-03-13 19:08:44,044 [INFO]: 	avg_search_speed_ms: 12.412978254753181
2025-03-13 19:08:44,044 [INFO]: 	99p_search_speed_ms: 18.39737319387496
2025-03-13 19:08:44,044 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:44,044 [INFO]: 	nb vectors: 3515
2025-03-13 19:08:44,044 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:44,044 [INFO]: 	compression ratio: 0.9993095411510596
2025-03-13 19:08:44,044 [INFO]: }
2025-03-13 19:08:44,044 [INFO]: 	>>> Finished "Creating the index" in 52.8363 secs
2025-03-13 19:08:44,044 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8612 secs
2025-03-13 19:08:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 23741 [episode count 13/20]
[retrieval_preprocessing] for episode 33478 [episode count 14/20], we have num_retrieval=np.int64(3507) num_query=np.int64(176)
2025-03-13 19:08:47,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:48,012 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:48
2025-03-13 19:08:48,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.00it/s]
2025-03-13 19:08:48,038 [INFO]: There are 3507 embeddings of dim 49152
2025-03-13 19:08:48,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:08:48,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:48
2025-03-13 19:08:48,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:48,038 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:08:48,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:48,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:48,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:48
2025-03-13 19:08:48,038 [INFO]: 723.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:48,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:08:48,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:48
2025-03-13 19:08:48,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:48,038 [INFO]: 	Creating the index 03/13/2025, 19:08:48
2025-03-13 19:08:48,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:48
2025-03-13 19:08:48,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:08:48,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:48
2025-03-13 19:08:48,040 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:08:48,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.89it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.75it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.75it/s] 50%|█████     | 7/14 [00:00<00:00, 11.19it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.41it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.55it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.50it/s]100%|██████████| 14/14 [00:03<00:00,  3.96it/s]
2025-03-13 19:08:51,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:51
2025-03-13 19:09:20,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4842 secs
2025-03-13 19:09:20,070 [INFO]: The best hyperparameters are: efSearch=436
2025-03-13 19:09:20,070 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 19:09:42,361 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2901 secs
2025-03-13 19:09:42,906 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8668 secs
2025-03-13 19:09:42,907 [INFO]: {
2025-03-13 19:09:42,907 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:42,907 [INFO]: 	index_param: efSearch=436
2025-03-13 19:09:42,907 [INFO]: 	index_path: knn.index
2025-03-13 19:09:42,907 [INFO]: 	size in bytes: 689980690
2025-03-13 19:09:42,907 [INFO]: 	avg_search_speed_ms: 11.103743939483735
2025-03-13 19:09:42,907 [INFO]: 	99p_search_speed_ms: 17.14107394218445
2025-03-13 19:09:42,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:42,907 [INFO]: 	nb vectors: 3507
2025-03-13 19:09:42,907 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:42,907 [INFO]: 	compression ratio: 0.9993094966179416
2025-03-13 19:09:42,907 [INFO]: }
2025-03-13 19:09:42,907 [INFO]: 	>>> Finished "Creating the index" in 54.8691 secs
2025-03-13 19:09:42,908 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8950 secs
2025-03-13 19:09:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 33478 [episode count 14/20]
[retrieval_preprocessing] for episode 20692 [episode count 15/20], we have num_retrieval=np.int64(3561) num_query=np.int64(122)
2025-03-13 19:09:46,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:47,065 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:47
2025-03-13 19:09:47,065 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.40it/s]
2025-03-13 19:09:47,092 [INFO]: There are 3561 embeddings of dim 49152
2025-03-13 19:09:47,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 19:09:47,092 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:47
2025-03-13 19:09:47,092 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:47,092 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:09:47,092 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:47,092 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:47,092 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:47
2025-03-13 19:09:47,093 [INFO]: 734.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:47,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:09:47,093 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:47
2025-03-13 19:09:47,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:47,093 [INFO]: 	Creating the index 03/13/2025, 19:09:47
2025-03-13 19:09:47,093 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:47
2025-03-13 19:09:47,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:09:47,094 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:47
2025-03-13 19:09:47,094 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:09:47,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.28it/s] 20%|██        | 3/15 [00:00<00:01,  8.35it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.83it/s] 40%|████      | 6/15 [00:00<00:00,  9.73it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.68it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.43it/s] 60%|██████    | 9/15 [00:01<00:00,  9.11it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.80it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.60it/s] 80%|████████  | 12/15 [00:01<00:00,  8.50it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.31it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.19it/s]100%|██████████| 15/15 [00:04<00:00,  1.21it/s]100%|██████████| 15/15 [00:04<00:00,  3.64it/s]
2025-03-13 19:09:51,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:51
2025-03-13 19:10:21,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7966 secs
2025-03-13 19:10:21,018 [INFO]: The best hyperparameters are: efSearch=428
2025-03-13 19:10:21,018 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 19:10:41,067 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0491 secs
2025-03-13 19:10:41,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9754 secs
2025-03-13 19:10:41,070 [INFO]: {
2025-03-13 19:10:41,070 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:41,070 [INFO]: 	index_param: efSearch=428
2025-03-13 19:10:41,070 [INFO]: 	index_path: knn.index
2025-03-13 19:10:41,070 [INFO]: 	size in bytes: 700604830
2025-03-13 19:10:41,070 [INFO]: 	avg_search_speed_ms: 11.259663604390765
2025-03-13 19:10:41,070 [INFO]: 	99p_search_speed_ms: 15.778100434690712
2025-03-13 19:10:41,070 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:41,070 [INFO]: 	nb vectors: 3561
2025-03-13 19:10:41,070 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:41,070 [INFO]: 	compression ratio: 0.9993095365899776
2025-03-13 19:10:41,070 [INFO]: }
2025-03-13 19:10:41,070 [INFO]: 	>>> Finished "Creating the index" in 53.9769 secs
2025-03-13 19:10:41,070 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0047 secs
2025-03-13 19:10:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 20692 [episode count 15/20]
[retrieval_preprocessing] for episode 52444 [episode count 16/20], we have num_retrieval=np.int64(3531) num_query=np.int64(152)
2025-03-13 19:10:44,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:44,605 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:44
2025-03-13 19:10:44,605 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2347.12it/s]
2025-03-13 19:10:44,628 [INFO]: There are 3531 embeddings of dim 49152
2025-03-13 19:10:44,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 19:10:44,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:44,628 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:10:44,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:44,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:44,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,628 [INFO]: 728.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:44,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:10:44,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:44
2025-03-13 19:10:44,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:44,629 [INFO]: 	Creating the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:44
2025-03-13 19:10:44,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:10:44,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,630 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:10:44,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.05it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.33it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.81it/s] 50%|█████     | 7/14 [00:00<00:00, 12.13it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.11it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.77it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.34it/s]100%|██████████| 14/14 [00:04<00:00,  3.34it/s]
2025-03-13 19:10:48,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:48
2025-03-13 19:11:23,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5119 secs
2025-03-13 19:11:23,349 [INFO]: The best hyperparameters are: efSearch=357
2025-03-13 19:11:23,349 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 19:11:46,889 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5401 secs
2025-03-13 19:11:46,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2620 secs
2025-03-13 19:11:46,892 [INFO]: {
2025-03-13 19:11:46,892 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:46,892 [INFO]: 	index_param: efSearch=357
2025-03-13 19:11:46,892 [INFO]: 	index_path: knn.index
2025-03-13 19:11:46,892 [INFO]: 	size in bytes: 694702510
2025-03-13 19:11:46,892 [INFO]: 	avg_search_speed_ms: 10.363974779303827
2025-03-13 19:11:46,892 [INFO]: 	99p_search_speed_ms: 14.795867158100009
2025-03-13 19:11:46,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:46,892 [INFO]: 	nb vectors: 3531
2025-03-13 19:11:46,892 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:46,892 [INFO]: 	compression ratio: 0.999309543303651
2025-03-13 19:11:46,892 [INFO]: }
2025-03-13 19:11:46,892 [INFO]: 	>>> Finished "Creating the index" in 62.2635 secs
2025-03-13 19:11:46,892 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2869 secs
2025-03-13 19:11:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 52444 [episode count 16/20]
[retrieval_preprocessing] for episode 17872 [episode count 17/20], we have num_retrieval=np.int64(3500) num_query=np.int64(183)
2025-03-13 19:11:50,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:51,424 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:51
2025-03-13 19:11:51,424 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-13 19:11:51,448 [INFO]: There are 3500 embeddings of dim 49152
2025-03-13 19:11:51,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 19:11:51,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:51,448 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:11:51,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:51,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:11:51,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,448 [INFO]: 722.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:51,448 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:11:51,448 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:51
2025-03-13 19:11:51,448 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:51,448 [INFO]: 	Creating the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,448 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:51
2025-03-13 19:11:51,449 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:11:51,449 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,449 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:11:51,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.07it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.63it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.37it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.83it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.08it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.10it/s] 50%|█████     | 7/14 [00:00<00:00,  8.04it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.89it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.90it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.99it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.94it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.92it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.89it/s]100%|██████████| 14/14 [00:04<00:00,  1.16it/s]100%|██████████| 14/14 [00:04<00:00,  3.30it/s]
2025-03-13 19:11:55,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:55
2025-03-13 19:12:24,757 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0587 secs
2025-03-13 19:12:24,758 [INFO]: The best hyperparameters are: efSearch=390
2025-03-13 19:12:24,758 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 19:12:43,463 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7048 secs
2025-03-13 19:12:43,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0158 secs
2025-03-13 19:12:43,465 [INFO]: {
2025-03-13 19:12:43,465 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:43,465 [INFO]: 	index_param: efSearch=390
2025-03-13 19:12:43,465 [INFO]: 	index_path: knn.index
2025-03-13 19:12:43,465 [INFO]: 	size in bytes: 688603450
2025-03-13 19:12:43,465 [INFO]: 	avg_search_speed_ms: 10.675336686763098
2025-03-13 19:12:43,465 [INFO]: 	99p_search_speed_ms: 17.286183945834633
2025-03-13 19:12:43,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:43,466 [INFO]: 	nb vectors: 3500
2025-03-13 19:12:43,466 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:43,466 [INFO]: 	compression ratio: 0.9993095445571758
2025-03-13 19:12:43,466 [INFO]: }
2025-03-13 19:12:43,466 [INFO]: 	>>> Finished "Creating the index" in 52.0176 secs
2025-03-13 19:12:43,466 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0419 secs
2025-03-13 19:12:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 17872 [episode count 17/20]
[retrieval_preprocessing] for episode 26579 [episode count 18/20], we have num_retrieval=np.int64(3494) num_query=np.int64(189)
2025-03-13 19:12:47,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:48,301 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:48
2025-03-13 19:12:48,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.18it/s]
2025-03-13 19:12:48,328 [INFO]: There are 3494 embeddings of dim 49152
2025-03-13 19:12:48,329 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:12:48,329 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:48
2025-03-13 19:12:48,329 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:48,329 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:12:48,329 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:48,329 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:12:48,329 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:48
2025-03-13 19:12:48,329 [INFO]: 721.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:48,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:12:48,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:48
2025-03-13 19:12:48,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:48,329 [INFO]: 	Creating the index 03/13/2025, 19:12:48
2025-03-13 19:12:48,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:48
2025-03-13 19:12:48,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:12:48,330 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:48
2025-03-13 19:12:48,331 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:12:48,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.99it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.83it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.55it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.64it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.74it/s] 50%|█████     | 7/14 [00:00<00:00,  8.80it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.94it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.89it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.86it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.86it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.82it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.96it/s]100%|██████████| 14/14 [00:03<00:00,  1.27it/s]100%|██████████| 14/14 [00:03<00:00,  3.61it/s]
2025-03-13 19:12:52,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:52
2025-03-13 19:13:23,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7589 secs
2025-03-13 19:13:23,979 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 19:13:23,979 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s]
2025-03-13 19:13:46,747 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7678 secs
2025-03-13 19:13:46,749 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4187 secs
2025-03-13 19:13:46,749 [INFO]: {
2025-03-13 19:13:46,749 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:46,750 [INFO]: 	index_param: efSearch=303
2025-03-13 19:13:46,750 [INFO]: 	index_path: knn.index
2025-03-13 19:13:46,750 [INFO]: 	size in bytes: 687423010
2025-03-13 19:13:46,750 [INFO]: 	avg_search_speed_ms: 9.449680111791748
2025-03-13 19:13:46,750 [INFO]: 	99p_search_speed_ms: 13.057701361831281
2025-03-13 19:13:46,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:46,750 [INFO]: 	nb vectors: 3494
2025-03-13 19:13:46,750 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:46,750 [INFO]: 	compression ratio: 0.9993095110389162
2025-03-13 19:13:46,750 [INFO]: }
2025-03-13 19:13:46,750 [INFO]: 	>>> Finished "Creating the index" in 58.4204 secs
2025-03-13 19:13:46,750 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4485 secs
2025-03-13 19:13:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 26579 [episode count 18/20]
[retrieval_preprocessing] for episode 26580 [episode count 19/20], we have num_retrieval=np.int64(3498) num_query=np.int64(185)
2025-03-13 19:13:50,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:50,573 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:50
2025-03-13 19:13:50,573 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.84it/s]
2025-03-13 19:13:50,597 [INFO]: There are 3498 embeddings of dim 49152
2025-03-13 19:13:50,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:13:50,597 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:50
2025-03-13 19:13:50,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:50,597 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:13:50,597 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:50,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:50,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:50
2025-03-13 19:13:50,597 [INFO]: 721.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:50,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:13:50,597 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:50
2025-03-13 19:13:50,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:50,597 [INFO]: 	Creating the index 03/13/2025, 19:13:50
2025-03-13 19:13:50,597 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:50
2025-03-13 19:13:50,598 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:13:50,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:50
2025-03-13 19:13:50,599 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:13:50,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.38it/s] 21%|██▏       | 3/14 [00:00<00:01, 11.00it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.04it/s] 50%|█████     | 7/14 [00:00<00:00, 12.46it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.34it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.37it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.82it/s]100%|██████████| 14/14 [00:03<00:00,  4.59it/s]
2025-03-13 19:13:53,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:53
2025-03-13 19:14:28,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4323 secs
2025-03-13 19:14:28,088 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 19:14:28,088 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 19:14:45,505 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4166 secs
2025-03-13 19:14:45,507 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9089 secs
2025-03-13 19:14:45,508 [INFO]: {
2025-03-13 19:14:45,508 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:45,508 [INFO]: 	index_param: efSearch=323
2025-03-13 19:14:45,508 [INFO]: 	index_path: knn.index
2025-03-13 19:14:45,508 [INFO]: 	size in bytes: 688209970
2025-03-13 19:14:45,508 [INFO]: 	avg_search_speed_ms: 9.79160446031466
2025-03-13 19:14:45,508 [INFO]: 	99p_search_speed_ms: 13.49839209578931
2025-03-13 19:14:45,508 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:45,508 [INFO]: 	nb vectors: 3498
2025-03-13 19:14:45,508 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:45,508 [INFO]: 	compression ratio: 0.9993095333971985
2025-03-13 19:14:45,508 [INFO]: }
2025-03-13 19:14:45,508 [INFO]: 	>>> Finished "Creating the index" in 54.9103 secs
2025-03-13 19:14:45,508 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9349 secs
2025-03-13 19:14:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 26580 [episode count 19/20]
2025-03-13 19:14:47: [retrieval_preprocessing] finished for 3816161570_open_bottom_drawer [chosen_id count 7/196]
2025-03-13 19:14:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3816161570_close_drawer [chosen_id count 8/196]
2025-03-13 19:14:49: [retrieval_preprocessing] we have num_total=2659 embedding_dim=49152
[retrieval_preprocessing] for episode 15381 [episode count 0/20], we have num_retrieval=np.int64(2466) num_query=np.int64(193)
2025-03-13 19:14:50,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:50,331 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:50
2025-03-13 19:14:50,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2149.82it/s]
2025-03-13 19:14:50,354 [INFO]: There are 2466 embeddings of dim 49152
2025-03-13 19:14:50,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 19:14:50,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:50
2025-03-13 19:14:50,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:50,355 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:14:50,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:50,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:14:50,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:50
2025-03-13 19:14:50,355 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:50,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:14:50,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:50
2025-03-13 19:14:50,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:50,355 [INFO]: 	Creating the index 03/13/2025, 19:14:50
2025-03-13 19:14:50,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:50
2025-03-13 19:14:50,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:14:50,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:50
2025-03-13 19:14:50,357 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:14:50,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.71it/s] 30%|███       | 3/10 [00:00<00:00, 10.41it/s] 50%|█████     | 5/10 [00:00<00:00, 11.41it/s] 70%|███████   | 7/10 [00:00<00:00, 12.02it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.26it/s]100%|██████████| 10/10 [00:02<00:00,  4.49it/s]
2025-03-13 19:14:52,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:52
2025-03-13 19:15:21,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7128 secs
2025-03-13 19:15:21,306 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 19:15:21,307 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-13 19:15:40,091 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7847 secs
2025-03-13 19:15:40,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7374 secs
2025-03-13 19:15:40,094 [INFO]: {
2025-03-13 19:15:40,094 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:40,094 [INFO]: 	index_param: efSearch=317
2025-03-13 19:15:40,094 [INFO]: 	index_path: knn.index
2025-03-13 19:15:40,094 [INFO]: 	size in bytes: 485170090
2025-03-13 19:15:40,094 [INFO]: 	avg_search_speed_ms: 10.843517786798971
2025-03-13 19:15:40,094 [INFO]: 	99p_search_speed_ms: 15.205995978321878
2025-03-13 19:15:40,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:40,094 [INFO]: 	nb vectors: 2466
2025-03-13 19:15:40,094 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:40,094 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-13 19:15:40,094 [INFO]: }
2025-03-13 19:15:40,094 [INFO]: 	>>> Finished "Creating the index" in 49.7390 secs
2025-03-13 19:15:40,094 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7629 secs
2025-03-13 19:15:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 15381 [episode count 0/20]
[retrieval_preprocessing] for episode 20512 [episode count 1/20], we have num_retrieval=np.int64(2539) num_query=np.int64(120)
2025-03-13 19:15:43,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:44,088 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:44
2025-03-13 19:15:44,088 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2075.36it/s]
2025-03-13 19:15:44,112 [INFO]: There are 2539 embeddings of dim 49152
2025-03-13 19:15:44,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 19:15:44,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:44
2025-03-13 19:15:44,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:44,113 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:15:44,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:44,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:44,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:44
2025-03-13 19:15:44,113 [INFO]: 524.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:44,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:15:44,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:44
2025-03-13 19:15:44,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:44,113 [INFO]: 	Creating the index 03/13/2025, 19:15:44
2025-03-13 19:15:44,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:44
2025-03-13 19:15:44,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:15:44,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:44
2025-03-13 19:15:44,114 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:15:44,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.57it/s] 30%|███       | 3/10 [00:00<00:00,  8.73it/s] 50%|█████     | 5/10 [00:00<00:00,  9.80it/s] 70%|███████   | 7/10 [00:00<00:00, 10.53it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.07it/s]
2025-03-13 19:15:46,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:46
2025-03-13 19:16:14,918 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3397 secs
2025-03-13 19:16:14,920 [INFO]: The best hyperparameters are: efSearch=409
2025-03-13 19:16:14,920 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 19:16:34,909 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9888 secs
2025-03-13 19:16:34,911 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7968 secs
2025-03-13 19:16:34,911 [INFO]: {
2025-03-13 19:16:34,911 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:34,911 [INFO]: 	index_param: efSearch=409
2025-03-13 19:16:34,911 [INFO]: 	index_path: knn.index
2025-03-13 19:16:34,911 [INFO]: 	size in bytes: 499532530
2025-03-13 19:16:34,911 [INFO]: 	avg_search_speed_ms: 11.454490914872558
2025-03-13 19:16:34,911 [INFO]: 	99p_search_speed_ms: 15.194875672459602
2025-03-13 19:16:34,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:34,911 [INFO]: 	nb vectors: 2539
2025-03-13 19:16:34,911 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:34,911 [INFO]: 	compression ratio: 0.9993097186283344
2025-03-13 19:16:34,911 [INFO]: }
2025-03-13 19:16:34,911 [INFO]: 	>>> Finished "Creating the index" in 50.7981 secs
2025-03-13 19:16:34,911 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8229 secs
2025-03-13 19:16:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 20512 [episode count 1/20]
[retrieval_preprocessing] for episode 48680 [episode count 2/20], we have num_retrieval=np.int64(2559) num_query=np.int64(100)
2025-03-13 19:16:37,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:37,858 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:37
2025-03-13 19:16:37,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.96it/s]
2025-03-13 19:16:37,882 [INFO]: There are 2559 embeddings of dim 49152
2025-03-13 19:16:37,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:16:37,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:37
2025-03-13 19:16:37,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:37,883 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:16:37,883 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:37,884 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 19:16:37,884 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:37
2025-03-13 19:16:37,884 [INFO]: 528.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:37,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 19:16:37,885 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:37
2025-03-13 19:16:37,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:37,885 [INFO]: 	Creating the index 03/13/2025, 19:16:37
2025-03-13 19:16:37,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:37
2025-03-13 19:16:37,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 19:16:37,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:37
2025-03-13 19:16:37,890 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:16:37,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.78it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.31it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.53it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.48it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.36it/s]100%|██████████| 11/11 [00:02<00:00,  2.81it/s]100%|██████████| 11/11 [00:02<00:00,  4.39it/s]
2025-03-13 19:16:40,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:40
2025-03-13 19:17:10,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1649 secs
2025-03-13 19:17:10,568 [INFO]: The best hyperparameters are: efSearch=380
2025-03-13 19:17:10,568 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s]
2025-03-13 19:17:28,554 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9859 secs
2025-03-13 19:17:28,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6663 secs
2025-03-13 19:17:28,556 [INFO]: {
2025-03-13 19:17:28,556 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:28,556 [INFO]: 	index_param: efSearch=380
2025-03-13 19:17:28,556 [INFO]: 	index_path: knn.index
2025-03-13 19:17:28,556 [INFO]: 	size in bytes: 503467450
2025-03-13 19:17:28,556 [INFO]: 	avg_search_speed_ms: 11.310065098601461
2025-03-13 19:17:28,556 [INFO]: 	99p_search_speed_ms: 14.365522004663944
2025-03-13 19:17:28,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:28,556 [INFO]: 	nb vectors: 2559
2025-03-13 19:17:28,556 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:28,556 [INFO]: 	compression ratio: 0.9993096316355705
2025-03-13 19:17:28,556 [INFO]: }
2025-03-13 19:17:28,556 [INFO]: 	>>> Finished "Creating the index" in 50.6709 secs
2025-03-13 19:17:28,557 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6986 secs
2025-03-13 19:17:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 48680 [episode count 2/20]
[retrieval_preprocessing] for episode 64577 [episode count 3/20], we have num_retrieval=np.int64(2545) num_query=np.int64(114)
2025-03-13 19:17:30,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:31,097 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:31
2025-03-13 19:17:31,097 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1934.64it/s]
2025-03-13 19:17:31,121 [INFO]: There are 2545 embeddings of dim 49152
2025-03-13 19:17:31,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 19:17:31,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:31
2025-03-13 19:17:31,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:31,121 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:17:31,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:31,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:31,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:31
2025-03-13 19:17:31,121 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:31,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:17:31,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:31
2025-03-13 19:17:31,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:31,121 [INFO]: 	Creating the index 03/13/2025, 19:17:31
2025-03-13 19:17:31,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:31
2025-03-13 19:17:31,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:17:31,122 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:31
2025-03-13 19:17:31,122 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:17:31,122 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.31it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.43it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.78it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.98it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.03it/s]100%|██████████| 11/11 [00:02<00:00,  2.61it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]
2025-03-13 19:17:33,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:33
2025-03-13 19:18:03,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1496 secs
2025-03-13 19:18:03,007 [INFO]: The best hyperparameters are: efSearch=369
2025-03-13 19:18:03,007 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 19:18:20,458 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4512 secs
2025-03-13 19:18:20,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3380 secs
2025-03-13 19:18:20,460 [INFO]: {
2025-03-13 19:18:20,460 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:20,460 [INFO]: 	index_param: efSearch=369
2025-03-13 19:18:20,460 [INFO]: 	index_path: knn.index
2025-03-13 19:18:20,460 [INFO]: 	size in bytes: 500713090
2025-03-13 19:18:20,460 [INFO]: 	avg_search_speed_ms: 10.402301939119052
2025-03-13 19:18:20,460 [INFO]: 	99p_search_speed_ms: 13.838005019351836
2025-03-13 19:18:20,460 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:20,460 [INFO]: 	nb vectors: 2545
2025-03-13 19:18:20,460 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:20,460 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-13 19:18:20,460 [INFO]: }
2025-03-13 19:18:20,460 [INFO]: 	>>> Finished "Creating the index" in 49.3393 secs
2025-03-13 19:18:20,460 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3637 secs
2025-03-13 19:18:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 64577 [episode count 3/20]
[retrieval_preprocessing] for episode 17487 [episode count 4/20], we have num_retrieval=np.int64(2496) num_query=np.int64(163)
2025-03-13 19:18:22,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:23,270 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:23
2025-03-13 19:18:23,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2089.84it/s]
2025-03-13 19:18:23,296 [INFO]: There are 2496 embeddings of dim 49152
2025-03-13 19:18:23,296 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 19:18:23,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:23
2025-03-13 19:18:23,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:23,297 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:18:23,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:23,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:18:23,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:23
2025-03-13 19:18:23,297 [INFO]: 515.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:23,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:18:23,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:23
2025-03-13 19:18:23,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:23,298 [INFO]: 	Creating the index 03/13/2025, 19:18:23
2025-03-13 19:18:23,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:23
2025-03-13 19:18:23,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:18:23,301 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:23
2025-03-13 19:18:23,302 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:18:23,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.99it/s] 20%|██        | 2/10 [00:00<00:01,  7.42it/s] 30%|███       | 3/10 [00:00<00:00,  8.07it/s] 40%|████      | 4/10 [00:00<00:00,  8.29it/s] 50%|█████     | 5/10 [00:00<00:00,  8.42it/s] 60%|██████    | 6/10 [00:00<00:00,  8.60it/s] 70%|███████   | 7/10 [00:00<00:00,  8.93it/s] 80%|████████  | 8/10 [00:00<00:00,  9.15it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.06it/s]100%|██████████| 10/10 [00:02<00:00,  1.56it/s]100%|██████████| 10/10 [00:02<00:00,  3.47it/s]
2025-03-13 19:18:26,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:26
2025-03-13 19:18:50,745 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5452 secs
2025-03-13 19:18:50,745 [INFO]: The best hyperparameters are: efSearch=397
2025-03-13 19:18:50,745 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 19:19:08,547 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8015 secs
2025-03-13 19:19:08,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2471 secs
2025-03-13 19:19:08,549 [INFO]: {
2025-03-13 19:19:08,549 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:08,549 [INFO]: 	index_param: efSearch=397
2025-03-13 19:19:08,549 [INFO]: 	index_path: knn.index
2025-03-13 19:19:08,549 [INFO]: 	size in bytes: 491072350
2025-03-13 19:19:08,549 [INFO]: 	avg_search_speed_ms: 11.601915187580541
2025-03-13 19:19:08,549 [INFO]: 	99p_search_speed_ms: 16.18673973251134
2025-03-13 19:19:08,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:08,549 [INFO]: 	nb vectors: 2496
2025-03-13 19:19:08,549 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:08,549 [INFO]: 	compression ratio: 0.999310117949015
2025-03-13 19:19:08,549 [INFO]: }
2025-03-13 19:19:08,549 [INFO]: 	>>> Finished "Creating the index" in 45.2509 secs
2025-03-13 19:19:08,549 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2787 secs
2025-03-13 19:19:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 17487 [episode count 4/20]
[retrieval_preprocessing] for episode 83555 [episode count 5/20], we have num_retrieval=np.int64(2545) num_query=np.int64(114)
2025-03-13 19:19:12,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:12,707 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:12
2025-03-13 19:19:12,708 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2409.13it/s]
2025-03-13 19:19:12,731 [INFO]: There are 2545 embeddings of dim 49152
2025-03-13 19:19:12,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 19:19:12,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:12
2025-03-13 19:19:12,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:12,731 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:19:12,731 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:12,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:19:12,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:12
2025-03-13 19:19:12,731 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:12,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:19:12,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:12
2025-03-13 19:19:12,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:12,731 [INFO]: 	Creating the index 03/13/2025, 19:19:12
2025-03-13 19:19:12,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:12
2025-03-13 19:19:12,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:19:12,732 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:12
2025-03-13 19:19:12,732 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:19:12,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.28it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.17it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.60it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.98it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.15it/s]100%|██████████| 11/11 [00:02<00:00,  2.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]
2025-03-13 19:19:15,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:15
2025-03-13 19:19:44,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7694 secs
2025-03-13 19:19:44,154 [INFO]: The best hyperparameters are: efSearch=394
2025-03-13 19:19:44,154 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s]
2025-03-13 19:20:03,140 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9854 secs
2025-03-13 19:20:03,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4090 secs
2025-03-13 19:20:03,142 [INFO]: {
2025-03-13 19:20:03,142 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:03,142 [INFO]: 	index_param: efSearch=394
2025-03-13 19:20:03,142 [INFO]: 	index_path: knn.index
2025-03-13 19:20:03,142 [INFO]: 	size in bytes: 500713090
2025-03-13 19:20:03,142 [INFO]: 	avg_search_speed_ms: 11.373609778035826
2025-03-13 19:20:03,142 [INFO]: 	99p_search_speed_ms: 17.04794084653259
2025-03-13 19:20:03,142 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:03,142 [INFO]: 	nb vectors: 2545
2025-03-13 19:20:03,142 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:03,142 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-13 19:20:03,142 [INFO]: }
2025-03-13 19:20:03,142 [INFO]: 	>>> Finished "Creating the index" in 50.4104 secs
2025-03-13 19:20:03,142 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4342 secs
2025-03-13 19:20:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 83555 [episode count 5/20]
[retrieval_preprocessing] for episode 81016 [episode count 6/20], we have num_retrieval=np.int64(2542) num_query=np.int64(117)
2025-03-13 19:20:06,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:06,854 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:06
2025-03-13 19:20:06,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1811.01it/s]
2025-03-13 19:20:06,878 [INFO]: There are 2542 embeddings of dim 49152
2025-03-13 19:20:06,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:20:06,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:06
2025-03-13 19:20:06,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:06,878 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:20:06,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:06,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:20:06,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:06
2025-03-13 19:20:06,878 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:06,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:20:06,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:06
2025-03-13 19:20:06,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:06,879 [INFO]: 	Creating the index 03/13/2025, 19:20:06
2025-03-13 19:20:06,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:06
2025-03-13 19:20:06,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:20:06,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:06
2025-03-13 19:20:06,880 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:20:06,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.79it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.50it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.02it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.41it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.59it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.71it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.78it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.97it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.96it/s]100%|██████████| 11/11 [00:02<00:00,  1.80it/s]100%|██████████| 11/11 [00:02<00:00,  3.99it/s]
2025-03-13 19:20:09,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:09
2025-03-13 19:20:40,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1365 secs
2025-03-13 19:20:40,781 [INFO]: The best hyperparameters are: efSearch=358
2025-03-13 19:20:40,782 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 19:20:59,468 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6865 secs
2025-03-13 19:20:59,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6715 secs
2025-03-13 19:20:59,552 [INFO]: {
2025-03-13 19:20:59,552 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:59,552 [INFO]: 	index_param: efSearch=358
2025-03-13 19:20:59,552 [INFO]: 	index_path: knn.index
2025-03-13 19:20:59,552 [INFO]: 	size in bytes: 500122750
2025-03-13 19:20:59,552 [INFO]: 	avg_search_speed_ms: 10.510934915925775
2025-03-13 19:20:59,552 [INFO]: 	99p_search_speed_ms: 14.550159259233626
2025-03-13 19:20:59,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:59,552 [INFO]: 	nb vectors: 2542
2025-03-13 19:20:59,552 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:59,552 [INFO]: 	compression ratio: 0.999309741458472
2025-03-13 19:20:59,552 [INFO]: }
2025-03-13 19:20:59,552 [INFO]: 	>>> Finished "Creating the index" in 52.6738 secs
2025-03-13 19:20:59,553 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6984 secs
2025-03-13 19:21:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 81016 [episode count 6/20]
[retrieval_preprocessing] for episode 59518 [episode count 7/20], we have num_retrieval=np.int64(2571) num_query=np.int64(88)
2025-03-13 19:21:02,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:02,487 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:02
2025-03-13 19:21:02,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1028.77it/s]
2025-03-13 19:21:02,511 [INFO]: There are 2571 embeddings of dim 49152
2025-03-13 19:21:02,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:21:02,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:02
2025-03-13 19:21:02,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:02,512 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:21:02,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:02,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:02,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:02
2025-03-13 19:21:02,512 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:02,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:02,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:02
2025-03-13 19:21:02,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:02,512 [INFO]: 	Creating the index 03/13/2025, 19:21:02
2025-03-13 19:21:02,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:02
2025-03-13 19:21:02,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:21:02,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:02
2025-03-13 19:21:02,513 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:21:02,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.91it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.81it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.01it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.59it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.17it/s]100%|██████████| 11/11 [00:02<00:00,  3.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.67it/s]
2025-03-13 19:21:04,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:04
2025-03-13 19:21:31,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6395 secs
2025-03-13 19:21:31,514 [INFO]: The best hyperparameters are: efSearch=414
2025-03-13 19:21:31,514 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 19:21:52,999 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4847 secs
2025-03-13 19:21:53,000 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4869 secs
2025-03-13 19:21:53,000 [INFO]: {
2025-03-13 19:21:53,000 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:53,000 [INFO]: 	index_param: efSearch=414
2025-03-13 19:21:53,000 [INFO]: 	index_path: knn.index
2025-03-13 19:21:53,000 [INFO]: 	size in bytes: 505828330
2025-03-13 19:21:53,000 [INFO]: 	avg_search_speed_ms: 11.648683472914888
2025-03-13 19:21:53,000 [INFO]: 	99p_search_speed_ms: 16.373289525508877
2025-03-13 19:21:53,000 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:53,000 [INFO]: 	nb vectors: 2571
2025-03-13 19:21:53,000 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:53,000 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-13 19:21:53,000 [INFO]: }
2025-03-13 19:21:53,000 [INFO]: 	>>> Finished "Creating the index" in 50.4883 secs
2025-03-13 19:21:53,000 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5129 secs
2025-03-13 19:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 59518 [episode count 7/20]
[retrieval_preprocessing] for episode 27788 [episode count 8/20], we have num_retrieval=np.int64(2520) num_query=np.int64(139)
2025-03-13 19:21:55,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:56,406 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:56
2025-03-13 19:21:56,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2385.84it/s]
2025-03-13 19:21:56,428 [INFO]: There are 2520 embeddings of dim 49152
2025-03-13 19:21:56,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 19:21:56,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:56
2025-03-13 19:21:56,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:56,429 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:21:56,429 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:56,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:56,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:56
2025-03-13 19:21:56,429 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:56,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:56,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:56
2025-03-13 19:21:56,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:56,429 [INFO]: 	Creating the index 03/13/2025, 19:21:56
2025-03-13 19:21:56,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:56
2025-03-13 19:21:56,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:21:56,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:56
2025-03-13 19:21:56,430 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:21:56,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.46it/s] 30%|███       | 3/10 [00:00<00:00, 10.60it/s] 50%|█████     | 5/10 [00:00<00:00, 11.98it/s] 70%|███████   | 7/10 [00:00<00:00, 12.05it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.24it/s]100%|██████████| 10/10 [00:02<00:00,  4.28it/s]
2025-03-13 19:21:58,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:58
2025-03-13 19:22:26,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6114 secs
2025-03-13 19:22:26,388 [INFO]: The best hyperparameters are: efSearch=411
2025-03-13 19:22:26,388 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 19:22:44,204 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8165 secs
2025-03-13 19:22:44,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7759 secs
2025-03-13 19:22:44,206 [INFO]: {
2025-03-13 19:22:44,206 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:44,206 [INFO]: 	index_param: efSearch=411
2025-03-13 19:22:44,206 [INFO]: 	index_path: knn.index
2025-03-13 19:22:44,206 [INFO]: 	size in bytes: 495794350
2025-03-13 19:22:44,206 [INFO]: 	avg_search_speed_ms: 11.503741657361388
2025-03-13 19:22:44,206 [INFO]: 	99p_search_speed_ms: 15.919619631022215
2025-03-13 19:22:44,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:44,206 [INFO]: 	nb vectors: 2520
2025-03-13 19:22:44,206 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:44,206 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-13 19:22:44,206 [INFO]: }
2025-03-13 19:22:44,207 [INFO]: 	>>> Finished "Creating the index" in 47.7771 secs
2025-03-13 19:22:44,207 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8009 secs
2025-03-13 19:22:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 27788 [episode count 8/20]
[retrieval_preprocessing] for episode 69793 [episode count 9/20], we have num_retrieval=np.int64(2525) num_query=np.int64(134)
2025-03-13 19:22:47,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:47,390 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:47
2025-03-13 19:22:47,390 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-13 19:22:47,414 [INFO]: There are 2525 embeddings of dim 49152
2025-03-13 19:22:47,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 19:22:47,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:47
2025-03-13 19:22:47,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:47,414 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:22:47,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:47,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:22:47,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:47
2025-03-13 19:22:47,414 [INFO]: 521.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:47,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:22:47,414 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:47
2025-03-13 19:22:47,414 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:47,414 [INFO]: 	Creating the index 03/13/2025, 19:22:47
2025-03-13 19:22:47,414 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:47
2025-03-13 19:22:47,415 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:22:47,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:47
2025-03-13 19:22:47,416 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:22:47,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.95it/s] 30%|███       | 3/10 [00:00<00:00, 11.64it/s] 50%|█████     | 5/10 [00:00<00:00, 13.47it/s] 70%|███████   | 7/10 [00:00<00:00, 14.71it/s] 90%|█████████ | 9/10 [00:00<00:00, 15.24it/s]100%|██████████| 10/10 [00:02<00:00,  4.51it/s]
2025-03-13 19:22:49,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:49
2025-03-13 19:23:19,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8367 secs
2025-03-13 19:23:19,477 [INFO]: The best hyperparameters are: efSearch=386
2025-03-13 19:23:19,477 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s]
2025-03-13 19:23:35,677 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2000 secs
2025-03-13 19:23:35,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2634 secs
2025-03-13 19:23:35,679 [INFO]: {
2025-03-13 19:23:35,679 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:35,679 [INFO]: 	index_param: efSearch=386
2025-03-13 19:23:35,679 [INFO]: 	index_path: knn.index
2025-03-13 19:23:35,679 [INFO]: 	size in bytes: 496778050
2025-03-13 19:23:35,679 [INFO]: 	avg_search_speed_ms: 11.212843927845041
2025-03-13 19:23:35,679 [INFO]: 	99p_search_speed_ms: 15.309620888438078
2025-03-13 19:23:35,679 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:35,679 [INFO]: 	nb vectors: 2525
2025-03-13 19:23:35,679 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:35,679 [INFO]: 	compression ratio: 0.9993098527602015
2025-03-13 19:23:35,679 [INFO]: }
2025-03-13 19:23:35,679 [INFO]: 	>>> Finished "Creating the index" in 48.2649 secs
2025-03-13 19:23:35,679 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2892 secs
2025-03-13 19:23:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 69793 [episode count 9/20]
[retrieval_preprocessing] for episode 21164 [episode count 10/20], we have num_retrieval=np.int64(2497) num_query=np.int64(162)
2025-03-13 19:23:38,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:38,739 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:38
2025-03-13 19:23:38,739 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1931.08it/s]
2025-03-13 19:23:38,762 [INFO]: There are 2497 embeddings of dim 49152
2025-03-13 19:23:38,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 19:23:38,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:38
2025-03-13 19:23:38,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:38,763 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:23:38,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:38,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:23:38,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:38
2025-03-13 19:23:38,763 [INFO]: 515.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:38,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:23:38,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:38
2025-03-13 19:23:38,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:38,763 [INFO]: 	Creating the index 03/13/2025, 19:23:38
2025-03-13 19:23:38,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:38
2025-03-13 19:23:38,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:23:38,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:38
2025-03-13 19:23:38,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:23:38,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.89it/s] 30%|███       | 3/10 [00:00<00:00,  9.56it/s] 50%|█████     | 5/10 [00:00<00:00, 10.46it/s] 70%|███████   | 7/10 [00:00<00:00,  8.14it/s] 80%|████████  | 8/10 [00:00<00:00,  7.67it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.33it/s]100%|██████████| 10/10 [00:02<00:00,  1.94it/s]100%|██████████| 10/10 [00:02<00:00,  3.67it/s]
2025-03-13 19:23:41,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:41
2025-03-13 19:24:10,645 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1479 secs
2025-03-13 19:24:10,645 [INFO]: The best hyperparameters are: efSearch=370
2025-03-13 19:24:10,645 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 19:24:27,022 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3770 secs
2025-03-13 19:24:27,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2605 secs
2025-03-13 19:24:27,025 [INFO]: {
2025-03-13 19:24:27,025 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:27,025 [INFO]: 	index_param: efSearch=370
2025-03-13 19:24:27,025 [INFO]: 	index_path: knn.index
2025-03-13 19:24:27,025 [INFO]: 	size in bytes: 491269090
2025-03-13 19:24:27,025 [INFO]: 	avg_search_speed_ms: 10.73531705642303
2025-03-13 19:24:27,025 [INFO]: 	99p_search_speed_ms: 14.48780110105872
2025-03-13 19:24:27,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:27,025 [INFO]: 	nb vectors: 2497
2025-03-13 19:24:27,025 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:27,025 [INFO]: 	compression ratio: 0.9993101255362922
2025-03-13 19:24:27,025 [INFO]: }
2025-03-13 19:24:27,025 [INFO]: 	>>> Finished "Creating the index" in 48.2618 secs
2025-03-13 19:24:27,025 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2858 secs
2025-03-13 19:24:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 21164 [episode count 10/20]
[retrieval_preprocessing] for episode 6832 [episode count 11/20], we have num_retrieval=np.int64(2504) num_query=np.int64(155)
2025-03-13 19:24:30,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:30,510 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:30
2025-03-13 19:24:30,510 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.06it/s]
2025-03-13 19:24:30,538 [INFO]: There are 2504 embeddings of dim 49152
2025-03-13 19:24:30,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 19:24:30,538 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:30
2025-03-13 19:24:30,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:30,539 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:24:30,539 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:30,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 19:24:30,539 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:30
2025-03-13 19:24:30,539 [INFO]: 516.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:30,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:24:30,540 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:30
2025-03-13 19:24:30,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:30,540 [INFO]: 	Creating the index 03/13/2025, 19:24:30
2025-03-13 19:24:30,540 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:30
2025-03-13 19:24:30,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:24:30,543 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:30
2025-03-13 19:24:30,543 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:24:30,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.21it/s] 20%|██        | 2/10 [00:00<00:01,  6.68it/s] 30%|███       | 3/10 [00:00<00:00,  7.34it/s] 40%|████      | 4/10 [00:00<00:00,  7.67it/s] 50%|█████     | 5/10 [00:00<00:00,  7.97it/s] 60%|██████    | 6/10 [00:00<00:00,  8.04it/s] 70%|███████   | 7/10 [00:00<00:00,  8.11it/s] 80%|████████  | 8/10 [00:01<00:00,  8.15it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.16it/s]100%|██████████| 10/10 [00:02<00:00,  1.54it/s]100%|██████████| 10/10 [00:02<00:00,  3.34it/s]
2025-03-13 19:24:33,544 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:33
2025-03-13 19:25:00,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6035 secs
2025-03-13 19:25:00,148 [INFO]: The best hyperparameters are: efSearch=463
2025-03-13 19:25:00,148 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 19:25:20,061 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9130 secs
2025-03-13 19:25:20,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5196 secs
2025-03-13 19:25:20,063 [INFO]: {
2025-03-13 19:25:20,063 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:20,063 [INFO]: 	index_param: efSearch=463
2025-03-13 19:25:20,063 [INFO]: 	index_path: knn.index
2025-03-13 19:25:20,063 [INFO]: 	size in bytes: 492646330
2025-03-13 19:25:20,063 [INFO]: 	avg_search_speed_ms: 12.56851356736286
2025-03-13 19:25:20,063 [INFO]: 	99p_search_speed_ms: 16.779868071898818
2025-03-13 19:25:20,063 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:20,063 [INFO]: 	nb vectors: 2504
2025-03-13 19:25:20,063 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:20,063 [INFO]: 	compression ratio: 0.9993100567703407
2025-03-13 19:25:20,063 [INFO]: }
2025-03-13 19:25:20,063 [INFO]: 	>>> Finished "Creating the index" in 49.5231 secs
2025-03-13 19:25:20,063 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5536 secs
2025-03-13 19:25:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 6832 [episode count 11/20]
[retrieval_preprocessing] for episode 44732 [episode count 12/20], we have num_retrieval=np.int64(2521) num_query=np.int64(138)
2025-03-13 19:25:23,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:23,894 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:23
2025-03-13 19:25:23,894 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1616.30it/s]
2025-03-13 19:25:23,918 [INFO]: There are 2521 embeddings of dim 49152
2025-03-13 19:25:23,919 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:25:23,919 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:23
2025-03-13 19:25:23,919 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:23,919 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:25:23,919 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:23,919 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:25:23,919 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:23
2025-03-13 19:25:23,919 [INFO]: 520.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:23,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:23,919 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:23
2025-03-13 19:25:23,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:23,919 [INFO]: 	Creating the index 03/13/2025, 19:25:23
2025-03-13 19:25:23,919 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:23
2025-03-13 19:25:23,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:25:23,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:23
2025-03-13 19:25:23,920 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:25:23,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.38it/s] 20%|██        | 2/10 [00:00<00:01,  6.65it/s] 30%|███       | 3/10 [00:00<00:00,  7.23it/s] 40%|████      | 4/10 [00:00<00:00,  7.56it/s] 50%|█████     | 5/10 [00:00<00:00,  7.73it/s] 60%|██████    | 6/10 [00:00<00:00,  7.77it/s] 70%|███████   | 7/10 [00:00<00:00,  7.71it/s] 80%|████████  | 8/10 [00:01<00:00,  7.89it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.94it/s]100%|██████████| 10/10 [00:02<00:00,  1.57it/s]100%|██████████| 10/10 [00:02<00:00,  3.36it/s]
2025-03-13 19:25:26,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:26
2025-03-13 19:25:55,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4090 secs
2025-03-13 19:25:55,313 [INFO]: The best hyperparameters are: efSearch=401
2025-03-13 19:25:55,313 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 19:26:12,903 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5900 secs
2025-03-13 19:26:13,096 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1754 secs
2025-03-13 19:26:13,096 [INFO]: {
2025-03-13 19:26:13,096 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:13,096 [INFO]: 	index_param: efSearch=401
2025-03-13 19:26:13,096 [INFO]: 	index_path: knn.index
2025-03-13 19:26:13,096 [INFO]: 	size in bytes: 495991090
2025-03-13 19:26:13,096 [INFO]: 	avg_search_speed_ms: 10.603100225607907
2025-03-13 19:26:13,096 [INFO]: 	99p_search_speed_ms: 13.85568958707154
2025-03-13 19:26:13,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:13,097 [INFO]: 	nb vectors: 2521
2025-03-13 19:26:13,097 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:13,097 [INFO]: 	compression ratio: 0.9993098222792671
2025-03-13 19:26:13,097 [INFO]: }
2025-03-13 19:26:13,097 [INFO]: 	>>> Finished "Creating the index" in 49.1775 secs
2025-03-13 19:26:13,097 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2027 secs
2025-03-13 19:26:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 44732 [episode count 12/20]
[retrieval_preprocessing] for episode 24268 [episode count 13/20], we have num_retrieval=np.int64(2500) num_query=np.int64(159)
2025-03-13 19:26:18,616 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:18,932 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:18
2025-03-13 19:26:18,932 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2321.14it/s]
2025-03-13 19:26:18,956 [INFO]: There are 2500 embeddings of dim 49152
2025-03-13 19:26:18,956 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 19:26:18,956 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:18
2025-03-13 19:26:18,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:18,956 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:26:18,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:18,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:26:18,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:18
2025-03-13 19:26:18,956 [INFO]: 515.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:18,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:26:18,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:18
2025-03-13 19:26:18,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:18,956 [INFO]: 	Creating the index 03/13/2025, 19:26:18
2025-03-13 19:26:18,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:18
2025-03-13 19:26:18,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:26:18,957 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:18
2025-03-13 19:26:18,957 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:26:18,957 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.36it/s] 30%|███       | 3/10 [00:00<00:00, 10.86it/s] 50%|█████     | 5/10 [00:00<00:00, 11.96it/s] 70%|███████   | 7/10 [00:00<00:00, 12.43it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.75it/s]100%|██████████| 10/10 [00:02<00:00,  4.25it/s]
2025-03-13 19:26:21,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:21
2025-03-13 19:26:48,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5695 secs
2025-03-13 19:26:48,889 [INFO]: The best hyperparameters are: efSearch=395
2025-03-13 19:26:48,889 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-13 19:27:06,895 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0059 secs
2025-03-13 19:27:06,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9394 secs
2025-03-13 19:27:06,897 [INFO]: {
2025-03-13 19:27:06,897 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:06,897 [INFO]: 	index_param: efSearch=395
2025-03-13 19:27:06,897 [INFO]: 	index_path: knn.index
2025-03-13 19:27:06,897 [INFO]: 	size in bytes: 491859370
2025-03-13 19:27:06,897 [INFO]: 	avg_search_speed_ms: 11.302896470915378
2025-03-13 19:27:06,897 [INFO]: 	99p_search_speed_ms: 14.778070682659743
2025-03-13 19:27:06,897 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:06,897 [INFO]: 	nb vectors: 2500
2025-03-13 19:27:06,897 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:06,897 [INFO]: 	compression ratio: 0.9993100263597703
2025-03-13 19:27:06,897 [INFO]: }
2025-03-13 19:27:06,897 [INFO]: 	>>> Finished "Creating the index" in 47.9407 secs
2025-03-13 19:27:06,897 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9648 secs
2025-03-13 19:27:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 24268 [episode count 13/20]
[retrieval_preprocessing] for episode 60913 [episode count 14/20], we have num_retrieval=np.int64(2500) num_query=np.int64(159)
2025-03-13 19:27:09,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:10,295 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:10
2025-03-13 19:27:10,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1735.33it/s]
2025-03-13 19:27:10,318 [INFO]: There are 2500 embeddings of dim 49152
2025-03-13 19:27:10,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 19:27:10,318 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:10
2025-03-13 19:27:10,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:10,318 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:27:10,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:10,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:10,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:10
2025-03-13 19:27:10,318 [INFO]: 515.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:10,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:10,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:10
2025-03-13 19:27:10,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:10,318 [INFO]: 	Creating the index 03/13/2025, 19:27:10
2025-03-13 19:27:10,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:10
2025-03-13 19:27:10,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:27:10,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:10
2025-03-13 19:27:10,319 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:27:10,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.25it/s] 30%|███       | 3/10 [00:00<00:00, 10.01it/s] 50%|█████     | 5/10 [00:00<00:00, 11.35it/s] 70%|███████   | 7/10 [00:00<00:00, 11.85it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.18it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-13 19:27:12,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:12
2025-03-13 19:27:35,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9763 secs
2025-03-13 19:27:35,712 [INFO]: The best hyperparameters are: efSearch=386
2025-03-13 19:27:35,712 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 19:27:52,693 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9807 secs
2025-03-13 19:27:52,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3751 secs
2025-03-13 19:27:52,695 [INFO]: {
2025-03-13 19:27:52,695 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:52,695 [INFO]: 	index_param: efSearch=386
2025-03-13 19:27:52,695 [INFO]: 	index_path: knn.index
2025-03-13 19:27:52,695 [INFO]: 	size in bytes: 491859370
2025-03-13 19:27:52,695 [INFO]: 	avg_search_speed_ms: 10.6665366063657
2025-03-13 19:27:52,695 [INFO]: 	99p_search_speed_ms: 17.318002160172895
2025-03-13 19:27:52,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:52,695 [INFO]: 	nb vectors: 2500
2025-03-13 19:27:52,695 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:52,695 [INFO]: 	compression ratio: 0.9993100263597703
2025-03-13 19:27:52,695 [INFO]: }
2025-03-13 19:27:52,695 [INFO]: 	>>> Finished "Creating the index" in 42.3765 secs
2025-03-13 19:27:52,695 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4000 secs
2025-03-13 19:27:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 60913 [episode count 14/20]
[retrieval_preprocessing] for episode 60917 [episode count 15/20], we have num_retrieval=np.int64(2578) num_query=np.int64(81)
2025-03-13 19:27:55,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:55,905 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:55
2025-03-13 19:27:55,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.09it/s]
2025-03-13 19:27:55,930 [INFO]: There are 2578 embeddings of dim 49152
2025-03-13 19:27:55,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 19:27:55,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:55,930 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:27:55,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:55,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:55,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,930 [INFO]: 532.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:55,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:55,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:55
2025-03-13 19:27:55,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:55,931 [INFO]: 	Creating the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:55
2025-03-13 19:27:55,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:27:55,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,932 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:27:55,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.36it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.86it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.40it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.69it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.99it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.73it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.56it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.38it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.21it/s]100%|██████████| 11/11 [00:03<00:00,  1.37it/s]100%|██████████| 11/11 [00:03<00:00,  3.25it/s]
2025-03-13 19:27:59,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:59
2025-03-13 19:28:27,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2006 secs
2025-03-13 19:28:27,754 [INFO]: The best hyperparameters are: efSearch=416
2025-03-13 19:28:27,754 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 19:28:45,151 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3969 secs
2025-03-13 19:28:45,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2212 secs
2025-03-13 19:28:45,153 [INFO]: {
2025-03-13 19:28:45,153 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:45,153 [INFO]: 	index_param: efSearch=416
2025-03-13 19:28:45,153 [INFO]: 	index_path: knn.index
2025-03-13 19:28:45,153 [INFO]: 	size in bytes: 507205690
2025-03-13 19:28:45,153 [INFO]: 	avg_search_speed_ms: 11.793070886270934
2025-03-13 19:28:45,153 [INFO]: 	99p_search_speed_ms: 19.51523867202921
2025-03-13 19:28:45,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:45,153 [INFO]: 	nb vectors: 2578
2025-03-13 19:28:45,153 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:45,153 [INFO]: 	compression ratio: 0.9993094202078057
2025-03-13 19:28:45,153 [INFO]: }
2025-03-13 19:28:45,153 [INFO]: 	>>> Finished "Creating the index" in 49.2229 secs
2025-03-13 19:28:45,153 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2488 secs
2025-03-13 19:28:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 60917 [episode count 15/20]
[retrieval_preprocessing] for episode 8188 [episode count 16/20], we have num_retrieval=np.int64(2558) num_query=np.int64(101)
2025-03-13 19:28:47,222 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:47,597 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:47
2025-03-13 19:28:47,598 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 19:28:47,626 [INFO]: There are 2558 embeddings of dim 49152
2025-03-13 19:28:47,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 19:28:47,626 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:47
2025-03-13 19:28:47,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:47,627 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:28:47,627 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:47,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:28:47,627 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:47
2025-03-13 19:28:47,628 [INFO]: 527.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:47,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:28:47,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:47
2025-03-13 19:28:47,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:47,628 [INFO]: 	Creating the index 03/13/2025, 19:28:47
2025-03-13 19:28:47,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:47
2025-03-13 19:28:47,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:28:47,632 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:47
2025-03-13 19:28:47,632 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:28:47,632 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.44it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.39it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.06it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.65it/s]100%|██████████| 11/11 [00:02<00:00,  3.04it/s]100%|██████████| 11/11 [00:02<00:00,  4.65it/s]
2025-03-13 19:28:50,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:50
2025-03-13 19:29:17,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0308 secs
2025-03-13 19:29:17,035 [INFO]: The best hyperparameters are: efSearch=404
2025-03-13 19:29:17,035 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.75it/s]
2025-03-13 19:29:32,588 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5532 secs
2025-03-13 19:29:32,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9579 secs
2025-03-13 19:29:32,590 [INFO]: {
2025-03-13 19:29:32,590 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:32,590 [INFO]: 	index_param: efSearch=404
2025-03-13 19:29:32,590 [INFO]: 	index_path: knn.index
2025-03-13 19:29:32,590 [INFO]: 	size in bytes: 503270710
2025-03-13 19:29:32,590 [INFO]: 	avg_search_speed_ms: 11.361690925497731
2025-03-13 19:29:32,590 [INFO]: 	99p_search_speed_ms: 16.82398004224525
2025-03-13 19:29:32,590 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:32,590 [INFO]: 	nb vectors: 2558
2025-03-13 19:29:32,590 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:32,590 [INFO]: 	compression ratio: 0.999309624039118
2025-03-13 19:29:32,590 [INFO]: }
2025-03-13 19:29:32,590 [INFO]: 	>>> Finished "Creating the index" in 44.9619 secs
2025-03-13 19:29:32,590 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9927 secs
2025-03-13 19:29:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 8188 [episode count 16/20]
[retrieval_preprocessing] for episode 87769 [episode count 17/20], we have num_retrieval=np.int64(2508) num_query=np.int64(151)
2025-03-13 19:29:34,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:35,294 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:35
2025-03-13 19:29:35,294 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1722.51it/s]
2025-03-13 19:29:35,319 [INFO]: There are 2508 embeddings of dim 49152
2025-03-13 19:29:35,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 19:29:35,320 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:35
2025-03-13 19:29:35,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:35,320 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:29:35,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:35,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:35,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:35
2025-03-13 19:29:35,320 [INFO]: 517.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:35,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:29:35,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:35
2025-03-13 19:29:35,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:35,320 [INFO]: 	Creating the index 03/13/2025, 19:29:35
2025-03-13 19:29:35,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:35
2025-03-13 19:29:35,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:29:35,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:35
2025-03-13 19:29:35,321 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:29:35,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.23it/s] 20%|██        | 2/10 [00:00<00:01,  6.79it/s] 30%|███       | 3/10 [00:00<00:00,  7.51it/s] 40%|████      | 4/10 [00:00<00:00,  7.91it/s] 50%|█████     | 5/10 [00:00<00:00,  8.28it/s] 60%|██████    | 6/10 [00:00<00:00,  8.39it/s] 70%|███████   | 7/10 [00:00<00:00,  8.49it/s] 80%|████████  | 8/10 [00:00<00:00,  8.51it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.55it/s]100%|██████████| 10/10 [00:02<00:00,  1.72it/s]100%|██████████| 10/10 [00:02<00:00,  3.65it/s]
2025-03-13 19:29:38,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:38
2025-03-13 19:30:02,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9857 secs
2025-03-13 19:30:02,055 [INFO]: The best hyperparameters are: efSearch=437
2025-03-13 19:30:02,055 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-13 19:30:22,954 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8989 secs
2025-03-13 19:30:22,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6338 secs
2025-03-13 19:30:22,955 [INFO]: {
2025-03-13 19:30:22,955 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:22,955 [INFO]: 	index_param: efSearch=437
2025-03-13 19:30:22,955 [INFO]: 	index_path: knn.index
2025-03-13 19:30:22,955 [INFO]: 	size in bytes: 493433350
2025-03-13 19:30:22,955 [INFO]: 	avg_search_speed_ms: 10.48658946670584
2025-03-13 19:30:22,955 [INFO]: 	99p_search_speed_ms: 13.733517001383007
2025-03-13 19:30:22,955 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:22,955 [INFO]: 	nb vectors: 2508
2025-03-13 19:30:22,955 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:22,955 [INFO]: 	compression ratio: 0.9993099655708314
2025-03-13 19:30:22,955 [INFO]: }
2025-03-13 19:30:22,955 [INFO]: 	>>> Finished "Creating the index" in 47.6353 secs
2025-03-13 19:30:22,956 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6616 secs
2025-03-13 19:30:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 87769 [episode count 17/20]
[retrieval_preprocessing] for episode 90342 [episode count 18/20], we have num_retrieval=np.int64(2520) num_query=np.int64(139)
2025-03-13 19:30:25,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:26,257 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:26
2025-03-13 19:30:26,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1908.24it/s]
2025-03-13 19:30:26,279 [INFO]: There are 2520 embeddings of dim 49152
2025-03-13 19:30:26,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 19:30:26,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:26
2025-03-13 19:30:26,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:26,279 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:30:26,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:26,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:26,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:26
2025-03-13 19:30:26,280 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:26,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:30:26,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:26
2025-03-13 19:30:26,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:26,280 [INFO]: 	Creating the index 03/13/2025, 19:30:26
2025-03-13 19:30:26,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:26
2025-03-13 19:30:26,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:30:26,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:26
2025-03-13 19:30:26,281 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:30:26,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.59it/s] 30%|███       | 3/10 [00:00<00:00,  8.81it/s] 40%|████      | 4/10 [00:00<00:00,  8.92it/s] 50%|█████     | 5/10 [00:00<00:00,  8.99it/s] 60%|██████    | 6/10 [00:00<00:00,  9.05it/s] 70%|███████   | 7/10 [00:00<00:00,  9.03it/s] 80%|████████  | 8/10 [00:00<00:00,  9.08it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.08it/s]100%|██████████| 10/10 [00:02<00:00,  1.82it/s]100%|██████████| 10/10 [00:02<00:00,  3.90it/s]
2025-03-13 19:30:28,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:28
2025-03-13 19:30:56,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7911 secs
2025-03-13 19:30:56,648 [INFO]: The best hyperparameters are: efSearch=393
2025-03-13 19:30:56,648 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-13 19:31:12,308 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6598 secs
2025-03-13 19:31:12,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0292 secs
2025-03-13 19:31:12,310 [INFO]: {
2025-03-13 19:31:12,310 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:12,310 [INFO]: 	index_param: efSearch=393
2025-03-13 19:31:12,310 [INFO]: 	index_path: knn.index
2025-03-13 19:31:12,310 [INFO]: 	size in bytes: 495794350
2025-03-13 19:31:12,310 [INFO]: 	avg_search_speed_ms: 11.963890884105009
2025-03-13 19:31:12,310 [INFO]: 	99p_search_speed_ms: 15.60611142776906
2025-03-13 19:31:12,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:12,310 [INFO]: 	nb vectors: 2520
2025-03-13 19:31:12,310 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:12,310 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-13 19:31:12,310 [INFO]: }
2025-03-13 19:31:12,310 [INFO]: 	>>> Finished "Creating the index" in 46.0305 secs
2025-03-13 19:31:12,310 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0534 secs
2025-03-13 19:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 90342 [episode count 18/20]
[retrieval_preprocessing] for episode 14070 [episode count 19/20], we have num_retrieval=np.int64(2527) num_query=np.int64(132)
2025-03-13 19:31:14,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:15,693 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:15
2025-03-13 19:31:15,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 19:31:15,715 [INFO]: There are 2527 embeddings of dim 49152
2025-03-13 19:31:15,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 19:31:15,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:15
2025-03-13 19:31:15,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:15,716 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:31:15,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:15,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:31:15,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:15
2025-03-13 19:31:15,716 [INFO]: 521.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:15,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:31:15,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:15
2025-03-13 19:31:15,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:15,716 [INFO]: 	Creating the index 03/13/2025, 19:31:15
2025-03-13 19:31:15,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:15
2025-03-13 19:31:15,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:31:15,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:15
2025-03-13 19:31:15,717 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:31:15,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.10it/s] 30%|███       | 3/10 [00:00<00:00, 10.13it/s] 50%|█████     | 5/10 [00:00<00:00, 11.32it/s] 70%|███████   | 7/10 [00:00<00:00, 11.94it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.30it/s]100%|██████████| 10/10 [00:02<00:00,  4.42it/s]
2025-03-13 19:31:17,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:17
2025-03-13 19:31:43,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2466 secs
2025-03-13 19:31:43,235 [INFO]: The best hyperparameters are: efSearch=441
2025-03-13 19:31:43,235 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s]
2025-03-13 19:31:58,875 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6393 secs
2025-03-13 19:31:58,877 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1599 secs
2025-03-13 19:31:58,877 [INFO]: {
2025-03-13 19:31:58,877 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:58,877 [INFO]: 	index_param: efSearch=441
2025-03-13 19:31:58,877 [INFO]: 	index_path: knn.index
2025-03-13 19:31:58,877 [INFO]: 	size in bytes: 497171530
2025-03-13 19:31:58,877 [INFO]: 	avg_search_speed_ms: 10.689477425050708
2025-03-13 19:31:58,877 [INFO]: 	99p_search_speed_ms: 14.114023128058761
2025-03-13 19:31:58,877 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:58,877 [INFO]: 	nb vectors: 2527
2025-03-13 19:31:58,877 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:58,877 [INFO]: 	compression ratio: 0.999309867964483
2025-03-13 19:31:58,877 [INFO]: }
2025-03-13 19:31:58,877 [INFO]: 	>>> Finished "Creating the index" in 43.1612 secs
2025-03-13 19:31:58,877 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1844 secs
2025-03-13 19:32:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 14070 [episode count 19/20]
2025-03-13 19:32:00: [retrieval_preprocessing] finished for 3816161570_close_drawer [chosen_id count 8/196]
2025-03-13 19:32:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3816161570_pull_box_out [chosen_id count 9/196]
2025-03-13 19:32:03: [retrieval_preprocessing] we have num_total=3734 embedding_dim=49152
[retrieval_preprocessing] for episode 50188 [episode count 0/20], we have num_retrieval=np.int64(3543) num_query=np.int64(191)
2025-03-13 19:32:04,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:04,892 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:04
2025-03-13 19:32:04,892 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-13 19:32:05,378 [INFO]: There are 3543 embeddings of dim 49152
2025-03-13 19:32:05,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4861 secs
2025-03-13 19:32:05,378 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:05
2025-03-13 19:32:05,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:05,379 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:32:05,379 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:05,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:32:05,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:05
2025-03-13 19:32:05,379 [INFO]: 731.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:05,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:32:05,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:05
2025-03-13 19:32:05,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:05,379 [INFO]: 	Creating the index 03/13/2025, 19:32:05
2025-03-13 19:32:05,380 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:05
2025-03-13 19:32:05,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:32:05,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:05
2025-03-13 19:32:05,382 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:32:05,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  4.19it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.04it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.41it/s] 50%|█████     | 7/14 [00:00<00:00, 11.44it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.88it/s] 79%|███████▊  | 11/14 [00:01<00:00, 12.24it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.42it/s]100%|██████████| 14/14 [00:03<00:00,  4.31it/s]
2025-03-13 19:32:08,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:08
2025-03-13 19:32:40,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1369 secs
2025-03-13 19:32:40,782 [INFO]: The best hyperparameters are: efSearch=374
2025-03-13 19:32:40,782 [INFO]: 	Compute fast metrics 03/13/2025, 19:32:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 19:33:01,279 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4972 secs
2025-03-13 19:33:01,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8991 secs
2025-03-13 19:33:01,281 [INFO]: {
2025-03-13 19:33:01,281 [INFO]: 	index_key: HNSW15
2025-03-13 19:33:01,281 [INFO]: 	index_param: efSearch=374
2025-03-13 19:33:01,281 [INFO]: 	index_path: knn.index
2025-03-13 19:33:01,281 [INFO]: 	size in bytes: 697063390
2025-03-13 19:33:01,281 [INFO]: 	avg_search_speed_ms: 10.65974351145756
2025-03-13 19:33:01,281 [INFO]: 	99p_search_speed_ms: 14.630612581968307
2025-03-13 19:33:01,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:33:01,281 [INFO]: 	nb vectors: 3543
2025-03-13 19:33:01,281 [INFO]: 	vectors dimension: 49152
2025-03-13 19:33:01,281 [INFO]: 	compression ratio: 0.9993096094173013
2025-03-13 19:33:01,281 [INFO]: }
2025-03-13 19:33:01,281 [INFO]: 	>>> Finished "Creating the index" in 55.9019 secs
2025-03-13 19:33:01,281 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3893 secs
2025-03-13 19:33:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:33:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 50188 [episode count 0/20]
[retrieval_preprocessing] for episode 61965 [episode count 1/20], we have num_retrieval=np.int64(3530) num_query=np.int64(204)
2025-03-13 19:33:04,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:33:05,710 [INFO]: Launching the whole pipeline 03/13/2025, 19:33:05
2025-03-13 19:33:05,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:33:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1775.74it/s]
2025-03-13 19:33:05,733 [INFO]: There are 3530 embeddings of dim 49152
2025-03-13 19:33:05,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 19:33:05,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:33:05,733 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:33:05,733 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:33:05,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:33:05,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,733 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:33:05,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:33:05,733 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:33:05
2025-03-13 19:33:05,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:33:05,734 [INFO]: 	Creating the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:33:05
2025-03-13 19:33:05,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:33:05,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,735 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:33:05,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.46it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.77it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.16it/s] 50%|█████     | 7/14 [00:00<00:00, 12.78it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.82it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.61it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.16it/s]100%|██████████| 14/14 [00:03<00:00,  3.92it/s]
2025-03-13 19:33:09,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:33:09
2025-03-13 19:33:44,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1457 secs
2025-03-13 19:33:44,462 [INFO]: The best hyperparameters are: efSearch=361
2025-03-13 19:33:44,462 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.43it/s]
2025-03-13 19:34:02,290 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8275 secs
2025-03-13 19:34:02,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5580 secs
2025-03-13 19:34:02,293 [INFO]: {
2025-03-13 19:34:02,293 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:02,293 [INFO]: 	index_param: efSearch=361
2025-03-13 19:34:02,293 [INFO]: 	index_path: knn.index
2025-03-13 19:34:02,293 [INFO]: 	size in bytes: 694505770
2025-03-13 19:34:02,293 [INFO]: 	avg_search_speed_ms: 12.48579665747577
2025-03-13 19:34:02,293 [INFO]: 	99p_search_speed_ms: 18.413941143080592
2025-03-13 19:34:02,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:02,293 [INFO]: 	nb vectors: 3530
2025-03-13 19:34:02,293 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:02,293 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-13 19:34:02,293 [INFO]: }
2025-03-13 19:34:02,293 [INFO]: 	>>> Finished "Creating the index" in 56.5595 secs
2025-03-13 19:34:02,293 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5834 secs
2025-03-13 19:34:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 61965 [episode count 1/20]
[retrieval_preprocessing] for episode 55325 [episode count 2/20], we have num_retrieval=np.int64(3503) num_query=np.int64(231)
2025-03-13 19:34:07,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:07,958 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:07
2025-03-13 19:34:07,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.01it/s]
2025-03-13 19:34:07,989 [INFO]: There are 3503 embeddings of dim 49152
2025-03-13 19:34:07,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 19:34:07,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:07
2025-03-13 19:34:07,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:07,991 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:34:07,991 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:07,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:34:07,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:07
2025-03-13 19:34:07,991 [INFO]: 722.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:07,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:34:07,992 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:07
2025-03-13 19:34:07,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:07,992 [INFO]: 	Creating the index 03/13/2025, 19:34:07
2025-03-13 19:34:07,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:07
2025-03-13 19:34:07,996 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 19:34:07,996 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:07
2025-03-13 19:34:07,996 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:34:07,997 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.72it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.46it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.54it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.12it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.22it/s] 50%|█████     | 7/14 [00:00<00:00,  8.93it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.22it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.20it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.66it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.92it/s]100%|██████████| 14/14 [00:04<00:00,  1.41it/s]100%|██████████| 14/14 [00:04<00:00,  3.26it/s]
2025-03-13 19:34:12,306 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:12
2025-03-13 19:34:44,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9056 secs
2025-03-13 19:34:44,213 [INFO]: The best hyperparameters are: efSearch=337
2025-03-13 19:34:44,213 [INFO]: 	Compute fast metrics 03/13/2025, 19:34:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 19:35:01,476 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2633 secs
2025-03-13 19:35:01,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4820 secs
2025-03-13 19:35:01,479 [INFO]: {
2025-03-13 19:35:01,479 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:01,479 [INFO]: 	index_param: efSearch=337
2025-03-13 19:35:01,479 [INFO]: 	index_path: knn.index
2025-03-13 19:35:01,479 [INFO]: 	size in bytes: 689193730
2025-03-13 19:35:01,479 [INFO]: 	avg_search_speed_ms: 10.568626723390064
2025-03-13 19:35:01,479 [INFO]: 	99p_search_speed_ms: 15.325894660782065
2025-03-13 19:35:01,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:01,479 [INFO]: 	nb vectors: 3503
2025-03-13 19:35:01,479 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:01,479 [INFO]: 	compression ratio: 0.999309474275107
2025-03-13 19:35:01,479 [INFO]: }
2025-03-13 19:35:01,479 [INFO]: 	>>> Finished "Creating the index" in 53.4863 secs
2025-03-13 19:35:01,479 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5202 secs
2025-03-13 19:35:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 55325 [episode count 2/20]
[retrieval_preprocessing] for episode 77066 [episode count 3/20], we have num_retrieval=np.int64(3507) num_query=np.int64(227)
2025-03-13 19:35:04,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:35:04,689 [INFO]: Launching the whole pipeline 03/13/2025, 19:35:04
2025-03-13 19:35:04,689 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:35:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1950.84it/s]
2025-03-13 19:35:04,716 [INFO]: There are 3507 embeddings of dim 49152
2025-03-13 19:35:04,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 19:35:04,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:35:04
2025-03-13 19:35:04,717 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:35:04,717 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:35:04,717 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:35:04,717 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:35:04,718 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:35:04
2025-03-13 19:35:04,718 [INFO]: 723.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:35:04,718 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:35:04,718 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:35:04
2025-03-13 19:35:04,718 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:35:04,719 [INFO]: 	Creating the index 03/13/2025, 19:35:04
2025-03-13 19:35:04,719 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:35:04
2025-03-13 19:35:04,722 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:35:04,722 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:35:04
2025-03-13 19:35:04,722 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:35:04,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.44it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.14it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.94it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.34it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.69it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.83it/s] 50%|█████     | 7/14 [00:00<00:00,  8.87it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.90it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.94it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.04it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.10it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.08it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.06it/s]100%|██████████| 14/14 [00:03<00:00,  1.40it/s]100%|██████████| 14/14 [00:03<00:00,  3.88it/s]
2025-03-13 19:35:08,342 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:35:08
2025-03-13 19:35:42,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6144 secs
2025-03-13 19:35:42,957 [INFO]: The best hyperparameters are: efSearch=318
2025-03-13 19:35:42,957 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s]
2025-03-13 19:35:57,195 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2383 secs
2025-03-13 19:35:57,198 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4756 secs
2025-03-13 19:35:57,198 [INFO]: {
2025-03-13 19:35:57,198 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:57,198 [INFO]: 	index_param: efSearch=318
2025-03-13 19:35:57,198 [INFO]: 	index_path: knn.index
2025-03-13 19:35:57,198 [INFO]: 	size in bytes: 689980690
2025-03-13 19:35:57,198 [INFO]: 	avg_search_speed_ms: 9.378013946727533
2025-03-13 19:35:57,198 [INFO]: 	99p_search_speed_ms: 12.404679169412697
2025-03-13 19:35:57,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:57,198 [INFO]: 	nb vectors: 3507
2025-03-13 19:35:57,198 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:57,198 [INFO]: 	compression ratio: 0.9993094966179416
2025-03-13 19:35:57,198 [INFO]: }
2025-03-13 19:35:57,198 [INFO]: 	>>> Finished "Creating the index" in 52.4793 secs
2025-03-13 19:35:57,198 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5091 secs
2025-03-13 19:35:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 77066 [episode count 3/20]
[retrieval_preprocessing] for episode 3318 [episode count 4/20], we have num_retrieval=np.int64(3576) num_query=np.int64(158)
2025-03-13 19:36:00,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:00,744 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:00
2025-03-13 19:36:00,744 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 796.94it/s]
2025-03-13 19:36:00,782 [INFO]: There are 3576 embeddings of dim 49152
2025-03-13 19:36:00,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 19:36:00,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:00
2025-03-13 19:36:00,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:00,783 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:36:00,783 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:00,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:36:00,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:00
2025-03-13 19:36:00,784 [INFO]: 738.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:00,784 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:36:00,784 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:00
2025-03-13 19:36:00,784 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:00,784 [INFO]: 	Creating the index 03/13/2025, 19:36:00
2025-03-13 19:36:00,784 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:00
2025-03-13 19:36:00,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:36:00,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:00
2025-03-13 19:36:00,786 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:36:00,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.42it/s] 20%|██        | 3/15 [00:00<00:01, 10.88it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.65it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.06it/s] 60%|██████    | 9/15 [00:00<00:00, 12.72it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.76it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.76it/s]100%|██████████| 15/15 [00:03<00:00,  2.29it/s]100%|██████████| 15/15 [00:03<00:00,  4.37it/s]
2025-03-13 19:36:04,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:04
2025-03-13 19:36:34,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6497 secs
2025-03-13 19:36:34,872 [INFO]: The best hyperparameters are: efSearch=358
2025-03-13 19:36:34,873 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 19:36:55,819 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9468 secs
2025-03-13 19:36:55,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0353 secs
2025-03-13 19:36:55,822 [INFO]: {
2025-03-13 19:36:55,822 [INFO]: 	index_key: HNSW15
2025-03-13 19:36:55,822 [INFO]: 	index_param: efSearch=358
2025-03-13 19:36:55,822 [INFO]: 	index_path: knn.index
2025-03-13 19:36:55,822 [INFO]: 	size in bytes: 703555930
2025-03-13 19:36:55,822 [INFO]: 	avg_search_speed_ms: 9.990146205705646
2025-03-13 19:36:55,822 [INFO]: 	99p_search_speed_ms: 13.198415050283074
2025-03-13 19:36:55,822 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:55,822 [INFO]: 	nb vectors: 3576
2025-03-13 19:36:55,822 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:55,822 [INFO]: 	compression ratio: 0.9993096184975656
2025-03-13 19:36:55,822 [INFO]: }
2025-03-13 19:36:55,822 [INFO]: 	>>> Finished "Creating the index" in 55.0379 secs
2025-03-13 19:36:55,822 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0774 secs
2025-03-13 19:36:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 3318 [episode count 4/20]
[retrieval_preprocessing] for episode 29034 [episode count 5/20], we have num_retrieval=np.int64(3520) num_query=np.int64(214)
2025-03-13 19:36:58,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:59,379 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:59
2025-03-13 19:36:59,379 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1990.65it/s]
2025-03-13 19:36:59,402 [INFO]: There are 3520 embeddings of dim 49152
2025-03-13 19:36:59,402 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 19:36:59,402 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:59
2025-03-13 19:36:59,402 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:59,402 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:36:59,402 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:59,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:36:59,402 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:59
2025-03-13 19:36:59,403 [INFO]: 726.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:59,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:36:59,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:59
2025-03-13 19:36:59,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:59,403 [INFO]: 	Creating the index 03/13/2025, 19:36:59
2025-03-13 19:36:59,403 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:59
2025-03-13 19:36:59,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:36:59,404 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:59
2025-03-13 19:36:59,404 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:36:59,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.69it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.49it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.65it/s] 50%|█████     | 7/14 [00:00<00:00, 12.29it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.54it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.74it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.83it/s]100%|██████████| 14/14 [00:03<00:00,  4.30it/s]
2025-03-13 19:37:02,665 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:37:02
2025-03-13 19:37:32,977 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3109 secs
2025-03-13 19:37:32,977 [INFO]: The best hyperparameters are: efSearch=375
2025-03-13 19:37:32,977 [INFO]: 	Compute fast metrics 03/13/2025, 19:37:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 19:37:52,732 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7550 secs
2025-03-13 19:37:52,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3304 secs
2025-03-13 19:37:52,734 [INFO]: {
2025-03-13 19:37:52,734 [INFO]: 	index_key: HNSW15
2025-03-13 19:37:52,734 [INFO]: 	index_param: efSearch=375
2025-03-13 19:37:52,734 [INFO]: 	index_path: knn.index
2025-03-13 19:37:52,734 [INFO]: 	size in bytes: 692538310
2025-03-13 19:37:52,735 [INFO]: 	avg_search_speed_ms: 10.655132970595147
2025-03-13 19:37:52,735 [INFO]: 	99p_search_speed_ms: 17.215479505248368
2025-03-13 19:37:52,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:37:52,735 [INFO]: 	nb vectors: 3520
2025-03-13 19:37:52,735 [INFO]: 	vectors dimension: 49152
2025-03-13 19:37:52,735 [INFO]: 	compression ratio: 0.9993095688814674
2025-03-13 19:37:52,735 [INFO]: }
2025-03-13 19:37:52,735 [INFO]: 	>>> Finished "Creating the index" in 53.3318 secs
2025-03-13 19:37:52,735 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3557 secs
2025-03-13 19:37:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:37:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 29034 [episode count 5/20]
[retrieval_preprocessing] for episode 59364 [episode count 6/20], we have num_retrieval=np.int64(3532) num_query=np.int64(202)
2025-03-13 19:37:56,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:37:57,027 [INFO]: Launching the whole pipeline 03/13/2025, 19:37:57
2025-03-13 19:37:57,027 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:37:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.53it/s]
2025-03-13 19:37:57,053 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 19:37:57,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 19:37:57,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:37:57
2025-03-13 19:37:57,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:37:57,053 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:37:57,053 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:37:57,053 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:37:57,053 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:37:57
2025-03-13 19:37:57,053 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:37:57,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:37:57,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:37:57
2025-03-13 19:37:57,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:37:57,053 [INFO]: 	Creating the index 03/13/2025, 19:37:57
2025-03-13 19:37:57,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:37:57
2025-03-13 19:37:57,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:37:57,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:37:57
2025-03-13 19:37:57,055 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:37:57,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.57it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.92it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.53it/s] 50%|█████     | 7/14 [00:00<00:00, 10.68it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.06it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.87it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.67it/s]100%|██████████| 14/14 [00:03<00:00,  2.03it/s]100%|██████████| 14/14 [00:03<00:00,  4.06it/s]
2025-03-13 19:38:00,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:00
2025-03-13 19:38:30,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6104 secs
2025-03-13 19:38:30,126 [INFO]: The best hyperparameters are: efSearch=392
2025-03-13 19:38:30,126 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.39it/s] 50%|█████     | 2/4 [00:00<00:00,  3.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.05it/s]
2025-03-13 19:38:49,433 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3074 secs
2025-03-13 19:38:49,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3812 secs
2025-03-13 19:38:49,436 [INFO]: {
2025-03-13 19:38:49,436 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:49,436 [INFO]: 	index_param: efSearch=392
2025-03-13 19:38:49,436 [INFO]: 	index_path: knn.index
2025-03-13 19:38:49,436 [INFO]: 	size in bytes: 694899250
2025-03-13 19:38:49,436 [INFO]: 	avg_search_speed_ms: 10.796356128305439
2025-03-13 19:38:49,436 [INFO]: 	99p_search_speed_ms: 13.407494698185474
2025-03-13 19:38:49,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:49,436 [INFO]: 	nb vectors: 3532
2025-03-13 19:38:49,436 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:49,436 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 19:38:49,436 [INFO]: }
2025-03-13 19:38:49,436 [INFO]: 	>>> Finished "Creating the index" in 52.3829 secs
2025-03-13 19:38:49,436 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4093 secs
2025-03-13 19:38:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 59364 [episode count 6/20]
[retrieval_preprocessing] for episode 36273 [episode count 7/20], we have num_retrieval=np.int64(3527) num_query=np.int64(207)
2025-03-13 19:38:53,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:53,760 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:53
2025-03-13 19:38:53,760 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.03it/s]
2025-03-13 19:38:53,784 [INFO]: There are 3527 embeddings of dim 49152
2025-03-13 19:38:53,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:38:53,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:53
2025-03-13 19:38:53,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:53,785 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:38:53,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:38:53,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:38:53,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:53
2025-03-13 19:38:53,785 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:53,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:38:53,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:53
2025-03-13 19:38:53,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:53,785 [INFO]: 	Creating the index 03/13/2025, 19:38:53
2025-03-13 19:38:53,785 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:53
2025-03-13 19:38:53,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:38:53,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:53
2025-03-13 19:38:53,786 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:38:53,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.93it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.61it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.61it/s] 50%|█████     | 7/14 [00:00<00:00, 12.11it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.13it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.81it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.31it/s]100%|██████████| 14/14 [00:03<00:00,  4.13it/s]
2025-03-13 19:38:57,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:57
2025-03-13 19:39:27,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3207 secs
2025-03-13 19:39:27,502 [INFO]: The best hyperparameters are: efSearch=374
2025-03-13 19:39:27,502 [INFO]: 	Compute fast metrics 03/13/2025, 19:39:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-13 19:39:45,103 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6009 secs
2025-03-13 19:39:45,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3191 secs
2025-03-13 19:39:45,105 [INFO]: {
2025-03-13 19:39:45,105 [INFO]: 	index_key: HNSW15
2025-03-13 19:39:45,105 [INFO]: 	index_param: efSearch=374
2025-03-13 19:39:45,106 [INFO]: 	index_path: knn.index
2025-03-13 19:39:45,106 [INFO]: 	size in bytes: 693915550
2025-03-13 19:39:45,106 [INFO]: 	avg_search_speed_ms: 9.449180326070671
2025-03-13 19:39:45,106 [INFO]: 	99p_search_speed_ms: 11.991625721566379
2025-03-13 19:39:45,106 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:39:45,106 [INFO]: 	nb vectors: 3527
2025-03-13 19:39:45,106 [INFO]: 	vectors dimension: 49152
2025-03-13 19:39:45,106 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-13 19:39:45,106 [INFO]: }
2025-03-13 19:39:45,106 [INFO]: 	>>> Finished "Creating the index" in 51.3206 secs
2025-03-13 19:39:45,106 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3456 secs
2025-03-13 19:39:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:39:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 36273 [episode count 7/20]
[retrieval_preprocessing] for episode 7240 [episode count 8/20], we have num_retrieval=np.int64(3543) num_query=np.int64(191)
2025-03-13 19:39:48,785 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:39:49,228 [INFO]: Launching the whole pipeline 03/13/2025, 19:39:49
2025-03-13 19:39:49,228 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:39:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2452.81it/s]
2025-03-13 19:39:49,249 [INFO]: There are 3543 embeddings of dim 49152
2025-03-13 19:39:49,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 19:39:49,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:39:49
2025-03-13 19:39:49,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:39:49,250 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:39:49,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:39:49,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:39:49,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:39:49
2025-03-13 19:39:49,250 [INFO]: 731.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:39:49,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:39:49,250 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:39:49
2025-03-13 19:39:49,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:39:49,250 [INFO]: 	Creating the index 03/13/2025, 19:39:49
2025-03-13 19:39:49,250 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:39:49
2025-03-13 19:39:49,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:39:49,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:39:49
2025-03-13 19:39:49,251 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:39:49,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.95it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.53it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.79it/s] 50%|█████     | 7/14 [00:00<00:00, 12.27it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.37it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.00it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.32it/s]100%|██████████| 14/14 [00:03<00:00,  4.57it/s]
2025-03-13 19:39:52,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:39:52
2025-03-13 19:40:20,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5953 secs
2025-03-13 19:40:20,917 [INFO]: The best hyperparameters are: efSearch=406
2025-03-13 19:40:20,917 [INFO]: 	Compute fast metrics 03/13/2025, 19:40:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.13it/s]
2025-03-13 19:40:39,725 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8080 secs
2025-03-13 19:40:39,727 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4760 secs
2025-03-13 19:40:39,727 [INFO]: {
2025-03-13 19:40:39,728 [INFO]: 	index_key: HNSW15
2025-03-13 19:40:39,728 [INFO]: 	index_param: efSearch=406
2025-03-13 19:40:39,728 [INFO]: 	index_path: knn.index
2025-03-13 19:40:39,728 [INFO]: 	size in bytes: 697063390
2025-03-13 19:40:39,728 [INFO]: 	avg_search_speed_ms: 10.46188089535786
2025-03-13 19:40:39,728 [INFO]: 	99p_search_speed_ms: 14.168615592643624
2025-03-13 19:40:39,728 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:40:39,728 [INFO]: 	nb vectors: 3543
2025-03-13 19:40:39,728 [INFO]: 	vectors dimension: 49152
2025-03-13 19:40:39,728 [INFO]: 	compression ratio: 0.9993096094173013
2025-03-13 19:40:39,728 [INFO]: }
2025-03-13 19:40:39,728 [INFO]: 	>>> Finished "Creating the index" in 50.4776 secs
2025-03-13 19:40:39,728 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4998 secs
2025-03-13 19:40:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:40:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 7240 [episode count 8/20]
[retrieval_preprocessing] for episode 8351 [episode count 9/20], we have num_retrieval=np.int64(3580) num_query=np.int64(154)
2025-03-13 19:40:43,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:40:43,937 [INFO]: Launching the whole pipeline 03/13/2025, 19:40:43
2025-03-13 19:40:43,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:40:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-13 19:40:44,192 [INFO]: There are 3580 embeddings of dim 49152
2025-03-13 19:40:44,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2550 secs
2025-03-13 19:40:44,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:40:44
2025-03-13 19:40:44,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:40:44,192 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:40:44,192 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:40:44,192 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:40:44,192 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:40:44
2025-03-13 19:40:44,192 [INFO]: 738.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:40:44,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:40:44,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:40:44
2025-03-13 19:40:44,193 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:40:44,193 [INFO]: 	Creating the index 03/13/2025, 19:40:44
2025-03-13 19:40:44,193 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:40:44
2025-03-13 19:40:44,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:40:44,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:40:44
2025-03-13 19:40:44,194 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:40:44,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.19it/s] 20%|██        | 3/15 [00:00<00:00, 12.08it/s] 33%|███▎      | 5/15 [00:00<00:00, 13.86it/s] 47%|████▋     | 7/15 [00:00<00:00, 14.93it/s] 60%|██████    | 9/15 [00:00<00:00, 15.98it/s] 73%|███████▎  | 11/15 [00:00<00:00, 16.71it/s] 87%|████████▋ | 13/15 [00:00<00:00, 17.08it/s]100%|██████████| 15/15 [00:02<00:00,  2.73it/s]100%|██████████| 15/15 [00:02<00:00,  5.23it/s]
2025-03-13 19:40:47,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:40:47
2025-03-13 19:41:14,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7406 secs
2025-03-13 19:41:14,805 [INFO]: The best hyperparameters are: efSearch=353
2025-03-13 19:41:14,805 [INFO]: 	Compute fast metrics 03/13/2025, 19:41:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s]
2025-03-13 19:41:30,207 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4017 secs
2025-03-13 19:41:30,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0156 secs
2025-03-13 19:41:30,209 [INFO]: {
2025-03-13 19:41:30,209 [INFO]: 	index_key: HNSW15
2025-03-13 19:41:30,209 [INFO]: 	index_param: efSearch=353
2025-03-13 19:41:30,209 [INFO]: 	index_path: knn.index
2025-03-13 19:41:30,209 [INFO]: 	size in bytes: 704342890
2025-03-13 19:41:30,209 [INFO]: 	avg_search_speed_ms: 9.604320260646908
2025-03-13 19:41:30,209 [INFO]: 	99p_search_speed_ms: 12.396570434793823
2025-03-13 19:41:30,209 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:41:30,209 [INFO]: 	nb vectors: 3580
2025-03-13 19:41:30,209 [INFO]: 	vectors dimension: 49152
2025-03-13 19:41:30,209 [INFO]: 	compression ratio: 0.9993096402236701
2025-03-13 19:41:30,209 [INFO]: }
2025-03-13 19:41:30,209 [INFO]: 	>>> Finished "Creating the index" in 46.0169 secs
2025-03-13 19:41:30,209 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2725 secs
2025-03-13 19:41:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:41:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 8351 [episode count 9/20]
[retrieval_preprocessing] for episode 66309 [episode count 10/20], we have num_retrieval=np.int64(3601) num_query=np.int64(133)
2025-03-13 19:41:33,399 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:41:33,855 [INFO]: Launching the whole pipeline 03/13/2025, 19:41:33
2025-03-13 19:41:33,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:41:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2150.93it/s]
2025-03-13 19:41:33,877 [INFO]: There are 3601 embeddings of dim 49152
2025-03-13 19:41:33,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 19:41:33,877 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:41:33
2025-03-13 19:41:33,877 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:41:33,877 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:41:33,877 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:41:33,877 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:41:33,877 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:41:33
2025-03-13 19:41:33,878 [INFO]: 743.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:41:33,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:41:33,878 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:41:33
2025-03-13 19:41:33,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:41:33,878 [INFO]: 	Creating the index 03/13/2025, 19:41:33
2025-03-13 19:41:33,878 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:41:33
2025-03-13 19:41:33,879 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:41:33,879 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:41:33
2025-03-13 19:41:33,879 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:41:33,879 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.51it/s] 20%|██        | 3/15 [00:00<00:01, 10.31it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.68it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.33it/s] 60%|██████    | 9/15 [00:00<00:00, 12.65it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.89it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.94it/s]100%|██████████| 15/15 [00:03<00:00,  2.35it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 19:41:37,262 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:41:37
2025-03-13 19:42:07,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7906 secs
2025-03-13 19:42:07,053 [INFO]: The best hyperparameters are: efSearch=376
2025-03-13 19:42:07,053 [INFO]: 	Compute fast metrics 03/13/2025, 19:42:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 19:42:23,269 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2157 secs
2025-03-13 19:42:23,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3925 secs
2025-03-13 19:42:23,271 [INFO]: {
2025-03-13 19:42:23,271 [INFO]: 	index_key: HNSW15
2025-03-13 19:42:23,271 [INFO]: 	index_param: efSearch=376
2025-03-13 19:42:23,271 [INFO]: 	index_path: knn.index
2025-03-13 19:42:23,271 [INFO]: 	size in bytes: 708474490
2025-03-13 19:42:23,271 [INFO]: 	avg_search_speed_ms: 10.609556152954429
2025-03-13 19:42:23,271 [INFO]: 	99p_search_speed_ms: 15.704957996495068
2025-03-13 19:42:23,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:42:23,271 [INFO]: 	nb vectors: 3601
2025-03-13 19:42:23,271 [INFO]: 	vectors dimension: 49152
2025-03-13 19:42:23,271 [INFO]: 	compression ratio: 0.9993096688633065
2025-03-13 19:42:23,271 [INFO]: }
2025-03-13 19:42:23,271 [INFO]: 	>>> Finished "Creating the index" in 49.3938 secs
2025-03-13 19:42:23,272 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4167 secs
2025-03-13 19:42:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:42:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 66309 [episode count 10/20]
[retrieval_preprocessing] for episode 78375 [episode count 11/20], we have num_retrieval=np.int64(3562) num_query=np.int64(172)
2025-03-13 19:42:25,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:42:26,311 [INFO]: Launching the whole pipeline 03/13/2025, 19:42:26
2025-03-13 19:42:26,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1583.35it/s]
2025-03-13 19:42:26,334 [INFO]: There are 3562 embeddings of dim 49152
2025-03-13 19:42:26,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 19:42:26,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:42:26
2025-03-13 19:42:26,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:42:26,335 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:42:26,335 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:42:26,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:42:26,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:42:26
2025-03-13 19:42:26,335 [INFO]: 735.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:42:26,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:42:26,335 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:42:26
2025-03-13 19:42:26,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:42:26,335 [INFO]: 	Creating the index 03/13/2025, 19:42:26
2025-03-13 19:42:26,335 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:42:26
2025-03-13 19:42:26,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:42:26,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:42:26
2025-03-13 19:42:26,336 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:42:26,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.27it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.07it/s] 20%|██        | 3/15 [00:00<00:01,  7.85it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.28it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.51it/s] 40%|████      | 6/15 [00:00<00:01,  8.79it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.93it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.04it/s] 60%|██████    | 9/15 [00:01<00:00,  9.11it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.15it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.23it/s] 80%|████████  | 12/15 [00:01<00:00,  9.19it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.23it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.28it/s]100%|██████████| 15/15 [00:03<00:00,  1.50it/s]100%|██████████| 15/15 [00:03<00:00,  4.21it/s]
2025-03-13 19:42:29,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:42:29
2025-03-13 19:42:56,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0070 secs
2025-03-13 19:42:56,912 [INFO]: The best hyperparameters are: efSearch=419
2025-03-13 19:42:56,912 [INFO]: 	Compute fast metrics 03/13/2025, 19:42:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s]
2025-03-13 19:43:11,751 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8394 secs
2025-03-13 19:43:11,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4169 secs
2025-03-13 19:43:11,753 [INFO]: {
2025-03-13 19:43:11,753 [INFO]: 	index_key: HNSW15
2025-03-13 19:43:11,753 [INFO]: 	index_param: efSearch=419
2025-03-13 19:43:11,753 [INFO]: 	index_path: knn.index
2025-03-13 19:43:11,753 [INFO]: 	size in bytes: 700801570
2025-03-13 19:43:11,753 [INFO]: 	avg_search_speed_ms: 9.666525317886888
2025-03-13 19:43:11,753 [INFO]: 	99p_search_speed_ms: 12.811805079691107
2025-03-13 19:43:11,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:43:11,753 [INFO]: 	nb vectors: 3562
2025-03-13 19:43:11,753 [INFO]: 	vectors dimension: 49152
2025-03-13 19:43:11,753 [INFO]: 	compression ratio: 0.9993095420719449
2025-03-13 19:43:11,753 [INFO]: }
2025-03-13 19:43:11,754 [INFO]: 	>>> Finished "Creating the index" in 45.4184 secs
2025-03-13 19:43:11,754 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4425 secs
2025-03-13 19:43:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:43:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 78375 [episode count 11/20]
[retrieval_preprocessing] for episode 95414 [episode count 12/20], we have num_retrieval=np.int64(3533) num_query=np.int64(201)
2025-03-13 19:43:15,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:43:15,517 [INFO]: Launching the whole pipeline 03/13/2025, 19:43:15
2025-03-13 19:43:15,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:43:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2428.66it/s]
2025-03-13 19:43:15,541 [INFO]: There are 3533 embeddings of dim 49152
2025-03-13 19:43:15,541 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 19:43:15,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:43:15
2025-03-13 19:43:15,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:43:15,541 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:43:15,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:43:15,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:43:15,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:43:15
2025-03-13 19:43:15,542 [INFO]: 729.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:43:15,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:43:15,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:43:15
2025-03-13 19:43:15,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:43:15,542 [INFO]: 	Creating the index 03/13/2025, 19:43:15
2025-03-13 19:43:15,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:43:15
2025-03-13 19:43:15,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:43:15,543 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:43:15
2025-03-13 19:43:15,543 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:43:15,543 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.70it/s] 36%|███▌      | 5/14 [00:00<00:00, 20.72it/s] 57%|█████▋    | 8/14 [00:00<00:00, 17.69it/s] 79%|███████▊  | 11/14 [00:00<00:00, 20.50it/s]100%|██████████| 14/14 [00:02<00:00,  3.33it/s]100%|██████████| 14/14 [00:02<00:00,  5.01it/s]
2025-03-13 19:43:18,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:43:18
2025-03-13 19:43:44,916 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5694 secs
2025-03-13 19:43:44,917 [INFO]: The best hyperparameters are: efSearch=439
2025-03-13 19:43:44,917 [INFO]: 	Compute fast metrics 03/13/2025, 19:43:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-13 19:44:01,757 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8402 secs
2025-03-13 19:44:01,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2154 secs
2025-03-13 19:44:01,759 [INFO]: {
2025-03-13 19:44:01,759 [INFO]: 	index_key: HNSW15
2025-03-13 19:44:01,759 [INFO]: 	index_param: efSearch=439
2025-03-13 19:44:01,759 [INFO]: 	index_path: knn.index
2025-03-13 19:44:01,759 [INFO]: 	size in bytes: 695095990
2025-03-13 19:44:01,759 [INFO]: 	avg_search_speed_ms: 10.398513075978865
2025-03-13 19:44:01,759 [INFO]: 	99p_search_speed_ms: 14.329146954696624
2025-03-13 19:44:01,759 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:44:01,759 [INFO]: 	nb vectors: 3533
2025-03-13 19:44:01,759 [INFO]: 	vectors dimension: 49152
2025-03-13 19:44:01,759 [INFO]: 	compression ratio: 0.9993095543537807
2025-03-13 19:44:01,759 [INFO]: }
2025-03-13 19:44:01,759 [INFO]: 	>>> Finished "Creating the index" in 46.2170 secs
2025-03-13 19:44:01,759 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2416 secs
2025-03-13 19:44:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:44:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 95414 [episode count 12/20]
[retrieval_preprocessing] for episode 35220 [episode count 13/20], we have num_retrieval=np.int64(3605) num_query=np.int64(129)
2025-03-13 19:44:05,404 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:44:05,846 [INFO]: Launching the whole pipeline 03/13/2025, 19:44:05
2025-03-13 19:44:05,846 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:44:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2305.83it/s]
2025-03-13 19:44:05,868 [INFO]: There are 3605 embeddings of dim 49152
2025-03-13 19:44:05,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 19:44:05,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:44:05,868 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:44:05,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:44:05,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:44:05,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,869 [INFO]: 744.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:44:05,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:44:05,869 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:44:05
2025-03-13 19:44:05,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:44:05,869 [INFO]: 	Creating the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,869 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:44:05
2025-03-13 19:44:05,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:44:05,870 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,870 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:44:05,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.44it/s] 20%|██        | 3/15 [00:00<00:01, 11.25it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.41it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.78it/s] 60%|██████    | 9/15 [00:00<00:00, 12.72it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.63it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.46it/s]100%|██████████| 15/15 [00:03<00:00,  2.50it/s]100%|██████████| 15/15 [00:03<00:00,  4.67it/s]
2025-03-13 19:44:09,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:44:09
2025-03-13 19:44:37,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5341 secs
2025-03-13 19:44:37,618 [INFO]: The best hyperparameters are: efSearch=438
2025-03-13 19:44:37,618 [INFO]: 	Compute fast metrics 03/13/2025, 19:44:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 19:44:55,439 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8208 secs
2025-03-13 19:44:55,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5714 secs
2025-03-13 19:44:55,441 [INFO]: {
2025-03-13 19:44:55,442 [INFO]: 	index_key: HNSW15
2025-03-13 19:44:55,442 [INFO]: 	index_param: efSearch=438
2025-03-13 19:44:55,442 [INFO]: 	index_path: knn.index
2025-03-13 19:44:55,442 [INFO]: 	size in bytes: 709261510
2025-03-13 19:44:55,442 [INFO]: 	avg_search_speed_ms: 10.258563502858847
2025-03-13 19:44:55,442 [INFO]: 	99p_search_speed_ms: 13.38579080067575
2025-03-13 19:44:55,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:44:55,442 [INFO]: 	nb vectors: 3605
2025-03-13 19:44:55,442 [INFO]: 	vectors dimension: 49152
2025-03-13 19:44:55,442 [INFO]: 	compression ratio: 0.9993096058462273
2025-03-13 19:44:55,442 [INFO]: }
2025-03-13 19:44:55,442 [INFO]: 	>>> Finished "Creating the index" in 49.5730 secs
2025-03-13 19:44:55,442 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5954 secs
2025-03-13 19:44:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:44:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 35220 [episode count 13/20]
[retrieval_preprocessing] for episode 80650 [episode count 14/20], we have num_retrieval=np.int64(3542) num_query=np.int64(192)
2025-03-13 19:44:58,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:44:58,749 [INFO]: Launching the whole pipeline 03/13/2025, 19:44:58
2025-03-13 19:44:58,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:44:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1280.70it/s]
2025-03-13 19:44:58,772 [INFO]: There are 3542 embeddings of dim 49152
2025-03-13 19:44:58,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 19:44:58,773 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:44:58
2025-03-13 19:44:58,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:44:58,773 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:44:58,773 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:44:58,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:44:58,773 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:44:58
2025-03-13 19:44:58,773 [INFO]: 731.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:44:58,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:44:58,773 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:44:58
2025-03-13 19:44:58,773 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:44:58,773 [INFO]: 	Creating the index 03/13/2025, 19:44:58
2025-03-13 19:44:58,773 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:44:58
2025-03-13 19:44:58,774 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:44:58,774 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:44:58
2025-03-13 19:44:58,774 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:44:58,774 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.82it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.71it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.50it/s] 50%|█████     | 7/14 [00:00<00:00, 12.63it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.87it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.70it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.29it/s]100%|██████████| 14/14 [00:03<00:00,  4.35it/s]
2025-03-13 19:45:01,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:45:01
2025-03-13 19:45:29,643 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6446 secs
2025-03-13 19:45:29,644 [INFO]: The best hyperparameters are: efSearch=411
2025-03-13 19:45:29,644 [INFO]: 	Compute fast metrics 03/13/2025, 19:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 19:45:47,799 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1555 secs
2025-03-13 19:45:47,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0271 secs
2025-03-13 19:45:47,801 [INFO]: {
2025-03-13 19:45:47,801 [INFO]: 	index_key: HNSW15
2025-03-13 19:45:47,801 [INFO]: 	index_param: efSearch=411
2025-03-13 19:45:47,801 [INFO]: 	index_path: knn.index
2025-03-13 19:45:47,801 [INFO]: 	size in bytes: 696866650
2025-03-13 19:45:47,801 [INFO]: 	avg_search_speed_ms: 9.723558707888609
2025-03-13 19:45:47,801 [INFO]: 	99p_search_speed_ms: 12.772316168993711
2025-03-13 19:45:47,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:45:47,801 [INFO]: 	nb vectors: 3542
2025-03-13 19:45:47,801 [INFO]: 	vectors dimension: 49152
2025-03-13 19:45:47,801 [INFO]: 	compression ratio: 0.9993096039249403
2025-03-13 19:45:47,801 [INFO]: }
2025-03-13 19:45:47,802 [INFO]: 	>>> Finished "Creating the index" in 49.0284 secs
2025-03-13 19:45:47,802 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0528 secs
2025-03-13 19:45:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:45:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 80650 [episode count 14/20]
[retrieval_preprocessing] for episode 61238 [episode count 15/20], we have num_retrieval=np.int64(3523) num_query=np.int64(211)
2025-03-13 19:45:51,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:45:51,497 [INFO]: Launching the whole pipeline 03/13/2025, 19:45:51
2025-03-13 19:45:51,497 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1599.05it/s]
2025-03-13 19:45:51,521 [INFO]: There are 3523 embeddings of dim 49152
2025-03-13 19:45:51,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 19:45:51,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:45:51
2025-03-13 19:45:51,521 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:45:51,521 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:45:51,521 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:45:51,521 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:45:51,521 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:45:51
2025-03-13 19:45:51,521 [INFO]: 727.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:45:51,521 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:45:51,521 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:45:51
2025-03-13 19:45:51,521 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:45:51,521 [INFO]: 	Creating the index 03/13/2025, 19:45:51
2025-03-13 19:45:51,521 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:45:51
2025-03-13 19:45:51,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:45:51,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:45:51
2025-03-13 19:45:51,522 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:45:51,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.63it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.52it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.40it/s] 50%|█████     | 7/14 [00:00<00:00, 12.70it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.89it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.04it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.78it/s]100%|██████████| 14/14 [00:03<00:00,  4.62it/s]
2025-03-13 19:45:54,558 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:45:54
2025-03-13 19:46:22,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3130 secs
2025-03-13 19:46:22,871 [INFO]: The best hyperparameters are: efSearch=383
2025-03-13 19:46:22,871 [INFO]: 	Compute fast metrics 03/13/2025, 19:46:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.43it/s] 50%|█████     | 2/4 [00:00<00:00,  8.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-13 19:46:42,332 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4612 secs
2025-03-13 19:46:42,334 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8120 secs
2025-03-13 19:46:42,335 [INFO]: {
2025-03-13 19:46:42,335 [INFO]: 	index_key: HNSW15
2025-03-13 19:46:42,335 [INFO]: 	index_param: efSearch=383
2025-03-13 19:46:42,335 [INFO]: 	index_path: knn.index
2025-03-13 19:46:42,335 [INFO]: 	size in bytes: 693128530
2025-03-13 19:46:42,335 [INFO]: 	avg_search_speed_ms: 10.116981997609486
2025-03-13 19:46:42,335 [INFO]: 	99p_search_speed_ms: 13.431436773389578
2025-03-13 19:46:42,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:46:42,335 [INFO]: 	nb vectors: 3523
2025-03-13 19:46:42,335 [INFO]: 	vectors dimension: 49152
2025-03-13 19:46:42,335 [INFO]: 	compression ratio: 0.9993095854819307
2025-03-13 19:46:42,335 [INFO]: }
2025-03-13 19:46:42,335 [INFO]: 	>>> Finished "Creating the index" in 50.8134 secs
2025-03-13 19:46:42,335 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8372 secs
2025-03-13 19:46:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:46:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 61238 [episode count 15/20]
[retrieval_preprocessing] for episode 90107 [episode count 16/20], we have num_retrieval=np.int64(3562) num_query=np.int64(172)
2025-03-13 19:46:45,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:46:46,476 [INFO]: Launching the whole pipeline 03/13/2025, 19:46:46
2025-03-13 19:46:46,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:46:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2056.03it/s]
2025-03-13 19:46:46,496 [INFO]: There are 3562 embeddings of dim 49152
2025-03-13 19:46:46,496 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0207 secs
2025-03-13 19:46:46,496 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:46:46
2025-03-13 19:46:46,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:46:46,497 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:46:46,497 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:46:46,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:46:46,497 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:46:46
2025-03-13 19:46:46,497 [INFO]: 735.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:46:46,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:46:46,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:46:46
2025-03-13 19:46:46,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:46:46,497 [INFO]: 	Creating the index 03/13/2025, 19:46:46
2025-03-13 19:46:46,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:46:46
2025-03-13 19:46:46,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:46:46,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:46:46
2025-03-13 19:46:46,498 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:46:46,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.74it/s] 20%|██        | 3/15 [00:00<00:01, 10.26it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.71it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.32it/s] 60%|██████    | 9/15 [00:00<00:00, 11.01it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.11it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.51it/s]100%|██████████| 15/15 [00:03<00:00,  2.13it/s]100%|██████████| 15/15 [00:03<00:00,  4.00it/s]
2025-03-13 19:46:50,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:46:50
2025-03-13 19:47:19,416 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1673 secs
2025-03-13 19:47:19,416 [INFO]: The best hyperparameters are: efSearch=386
2025-03-13 19:47:19,416 [INFO]: 	Compute fast metrics 03/13/2025, 19:47:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.98it/s]
2025-03-13 19:47:34,314 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8977 secs
2025-03-13 19:47:34,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8180 secs
2025-03-13 19:47:34,316 [INFO]: {
2025-03-13 19:47:34,316 [INFO]: 	index_key: HNSW15
2025-03-13 19:47:34,316 [INFO]: 	index_param: efSearch=386
2025-03-13 19:47:34,316 [INFO]: 	index_path: knn.index
2025-03-13 19:47:34,316 [INFO]: 	size in bytes: 700801570
2025-03-13 19:47:34,316 [INFO]: 	avg_search_speed_ms: 10.037151903031747
2025-03-13 19:47:34,316 [INFO]: 	99p_search_speed_ms: 12.618170054629445
2025-03-13 19:47:34,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:47:34,316 [INFO]: 	nb vectors: 3562
2025-03-13 19:47:34,316 [INFO]: 	vectors dimension: 49152
2025-03-13 19:47:34,316 [INFO]: 	compression ratio: 0.9993095420719449
2025-03-13 19:47:34,316 [INFO]: }
2025-03-13 19:47:34,316 [INFO]: 	>>> Finished "Creating the index" in 47.8193 secs
2025-03-13 19:47:34,316 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8405 secs
2025-03-13 19:47:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:47:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 90107 [episode count 16/20]
[retrieval_preprocessing] for episode 44232 [episode count 17/20], we have num_retrieval=np.int64(3567) num_query=np.int64(167)
2025-03-13 19:47:37,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:47:38,220 [INFO]: Launching the whole pipeline 03/13/2025, 19:47:38
2025-03-13 19:47:38,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:47:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1820.44it/s]
2025-03-13 19:47:38,247 [INFO]: There are 3567 embeddings of dim 49152
2025-03-13 19:47:38,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:47:38,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:47:38
2025-03-13 19:47:38,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:47:38,247 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:47:38,247 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:47:38,247 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:47:38,247 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:47:38
2025-03-13 19:47:38,247 [INFO]: 736.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:47:38,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:47:38,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:47:38
2025-03-13 19:47:38,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:47:38,248 [INFO]: 	Creating the index 03/13/2025, 19:47:38
2025-03-13 19:47:38,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:47:38
2025-03-13 19:47:38,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 19:47:38,249 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:47:38
2025-03-13 19:47:38,249 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:47:38,249 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.65it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.46it/s] 20%|██        | 3/15 [00:00<00:01,  8.18it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.69it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.91it/s] 40%|████      | 6/15 [00:00<00:00,  9.12it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.07it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.01it/s] 60%|██████    | 9/15 [00:01<00:00,  9.02it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.06it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.10it/s] 80%|████████  | 12/15 [00:01<00:00,  9.29it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.29it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.26it/s]100%|██████████| 15/15 [00:03<00:00,  1.46it/s]100%|██████████| 15/15 [00:03<00:00,  4.16it/s]
2025-03-13 19:47:41,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:47:41
2025-03-13 19:48:10,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9148 secs
2025-03-13 19:48:10,776 [INFO]: The best hyperparameters are: efSearch=397
2025-03-13 19:48:10,776 [INFO]: 	Compute fast metrics 03/13/2025, 19:48:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-13 19:48:28,072 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2958 secs
2025-03-13 19:48:28,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8248 secs
2025-03-13 19:48:28,074 [INFO]: {
2025-03-13 19:48:28,074 [INFO]: 	index_key: HNSW15
2025-03-13 19:48:28,074 [INFO]: 	index_param: efSearch=397
2025-03-13 19:48:28,074 [INFO]: 	index_path: knn.index
2025-03-13 19:48:28,074 [INFO]: 	size in bytes: 701785270
2025-03-13 19:48:28,074 [INFO]: 	avg_search_speed_ms: 10.466475041181816
2025-03-13 19:48:28,074 [INFO]: 	99p_search_speed_ms: 13.834993063937874
2025-03-13 19:48:28,074 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:48:28,074 [INFO]: 	nb vectors: 3567
2025-03-13 19:48:28,074 [INFO]: 	vectors dimension: 49152
2025-03-13 19:48:28,074 [INFO]: 	compression ratio: 0.9993095694356765
2025-03-13 19:48:28,074 [INFO]: }
2025-03-13 19:48:28,074 [INFO]: 	>>> Finished "Creating the index" in 49.8267 secs
2025-03-13 19:48:28,074 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8541 secs
2025-03-13 19:48:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:48:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 44232 [episode count 17/20]
[retrieval_preprocessing] for episode 46898 [episode count 18/20], we have num_retrieval=np.int64(3527) num_query=np.int64(207)
2025-03-13 19:48:31,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:48:31,682 [INFO]: Launching the whole pipeline 03/13/2025, 19:48:31
2025-03-13 19:48:31,682 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:48:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2535.85it/s]
2025-03-13 19:48:31,704 [INFO]: There are 3527 embeddings of dim 49152
2025-03-13 19:48:31,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 19:48:31,704 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:48:31
2025-03-13 19:48:31,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:48:31,704 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:48:31,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:48:31,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:48:31,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:48:31
2025-03-13 19:48:31,705 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:48:31,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:48:31,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:48:31
2025-03-13 19:48:31,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:48:31,705 [INFO]: 	Creating the index 03/13/2025, 19:48:31
2025-03-13 19:48:31,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:48:31
2025-03-13 19:48:31,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:48:31,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:48:31
2025-03-13 19:48:31,706 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:48:31,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.53it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.61it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.90it/s] 50%|█████     | 7/14 [00:00<00:00, 13.98it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.15it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.62it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.71it/s]100%|██████████| 14/14 [00:03<00:00,  4.13it/s]
2025-03-13 19:48:35,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:48:35
2025-03-13 19:49:04,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1200 secs
2025-03-13 19:49:04,224 [INFO]: The best hyperparameters are: efSearch=351
2025-03-13 19:49:04,224 [INFO]: 	Compute fast metrics 03/13/2025, 19:49:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 19:49:19,342 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1179 secs
2025-03-13 19:49:19,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6384 secs
2025-03-13 19:49:19,345 [INFO]: {
2025-03-13 19:49:19,345 [INFO]: 	index_key: HNSW15
2025-03-13 19:49:19,345 [INFO]: 	index_param: efSearch=351
2025-03-13 19:49:19,345 [INFO]: 	index_path: knn.index
2025-03-13 19:49:19,345 [INFO]: 	size in bytes: 693915550
2025-03-13 19:49:19,345 [INFO]: 	avg_search_speed_ms: 10.017971258810189
2025-03-13 19:49:19,345 [INFO]: 	99p_search_speed_ms: 14.216067672241476
2025-03-13 19:49:19,345 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:49:19,345 [INFO]: 	nb vectors: 3527
2025-03-13 19:49:19,345 [INFO]: 	vectors dimension: 49152
2025-03-13 19:49:19,345 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-13 19:49:19,345 [INFO]: }
2025-03-13 19:49:19,345 [INFO]: 	>>> Finished "Creating the index" in 47.6401 secs
2025-03-13 19:49:19,345 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6632 secs
2025-03-13 19:49:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:49:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 46898 [episode count 18/20]
[retrieval_preprocessing] for episode 33755 [episode count 19/20], we have num_retrieval=np.int64(3563) num_query=np.int64(171)
2025-03-13 19:49:22,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:49:23,055 [INFO]: Launching the whole pipeline 03/13/2025, 19:49:23
2025-03-13 19:49:23,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:49:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2452.81it/s]
2025-03-13 19:49:23,078 [INFO]: There are 3563 embeddings of dim 49152
2025-03-13 19:49:23,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 19:49:23,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:49:23
2025-03-13 19:49:23,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:49:23,078 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:49:23,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:49:23,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:49:23,078 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:49:23
2025-03-13 19:49:23,078 [INFO]: 735.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:49:23,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:49:23,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:49:23
2025-03-13 19:49:23,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:49:23,079 [INFO]: 	Creating the index 03/13/2025, 19:49:23
2025-03-13 19:49:23,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:49:23
2025-03-13 19:49:23,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:49:23,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:49:23
2025-03-13 19:49:23,080 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:49:23,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.33it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.07it/s] 27%|██▋       | 4/15 [00:00<00:01,  9.79it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.73it/s] 40%|████      | 6/15 [00:00<00:00,  9.69it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.53it/s] 60%|██████    | 9/15 [00:00<00:00,  9.70it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.56it/s] 80%|████████  | 12/15 [00:01<00:00,  9.62it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.53it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.44it/s]100%|██████████| 15/15 [00:03<00:00,  1.55it/s]100%|██████████| 15/15 [00:03<00:00,  4.07it/s]
2025-03-13 19:49:26,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:49:26
2025-03-13 19:49:56,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5345 secs
2025-03-13 19:49:56,300 [INFO]: The best hyperparameters are: efSearch=389
2025-03-13 19:49:56,300 [INFO]: 	Compute fast metrics 03/13/2025, 19:49:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 19:50:13,379 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0787 secs
2025-03-13 19:50:13,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3014 secs
2025-03-13 19:50:13,381 [INFO]: {
2025-03-13 19:50:13,381 [INFO]: 	index_key: HNSW15
2025-03-13 19:50:13,381 [INFO]: 	index_param: efSearch=389
2025-03-13 19:50:13,381 [INFO]: 	index_path: knn.index
2025-03-13 19:50:13,381 [INFO]: 	size in bytes: 700998310
2025-03-13 19:50:13,381 [INFO]: 	avg_search_speed_ms: 10.725485605396338
2025-03-13 19:50:13,381 [INFO]: 	99p_search_speed_ms: 14.982133507728575
2025-03-13 19:50:13,381 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:50:13,381 [INFO]: 	nb vectors: 3563
2025-03-13 19:50:13,381 [INFO]: 	vectors dimension: 49152
2025-03-13 19:50:13,381 [INFO]: 	compression ratio: 0.999309547550835
2025-03-13 19:50:13,381 [INFO]: }
2025-03-13 19:50:13,381 [INFO]: 	>>> Finished "Creating the index" in 50.3028 secs
2025-03-13 19:50:13,382 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3268 secs
2025-03-13 19:50:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:50:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 33755 [episode count 19/20]
2025-03-13 19:50:16: [retrieval_preprocessing] finished for 3816161570_pull_box_out [chosen_id count 9/196]
2025-03-13 19:50:16: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
