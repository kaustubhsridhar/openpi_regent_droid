nohup: ignoring input
2025-03-13 10:50:25: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:51:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4251465834_coffee_machine_press_button [chosen_id count 0/260]
2025-03-13 10:51:01: [retrieval_preprocessing] we have num_total=2314 embedding_dim=49152
[retrieval_preprocessing] for episode 11776 [episode count 0/20], we have num_retrieval=np.int64(2207) num_query=np.int64(107)
2025-03-13 10:51:04,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:04,512 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:04
2025-03-13 10:51:04,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 557.75it/s]
2025-03-13 10:51:04,554 [INFO]: There are 2207 embeddings of dim 49152
2025-03-13 10:51:04,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0415 secs
2025-03-13 10:51:04,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:04
2025-03-13 10:51:04,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:04,554 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:51:04,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:04,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:51:04,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:04
2025-03-13 10:51:04,555 [INFO]: 455.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:04,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0009 secs
2025-03-13 10:51:04,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:04
2025-03-13 10:51:04,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:04,555 [INFO]: 	Creating the index 03/13/2025, 10:51:04
2025-03-13 10:51:04,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:04
2025-03-13 10:51:04,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 10:51:04,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:04
2025-03-13 10:51:04,557 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:51:04,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.86it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.70it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.01it/s] 56%|█████▌    | 5/9 [00:00<00:00,  4.63it/s] 67%|██████▋   | 6/9 [00:01<00:00,  3.23it/s] 78%|███████▊  | 7/9 [00:02<00:01,  1.82it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.13it/s]100%|██████████| 9/9 [00:04<00:00,  1.36it/s]100%|██████████| 9/9 [00:04<00:00,  2.18it/s]
2025-03-13 10:51:08,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:08
2025-03-13 10:51:38,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6352 secs
2025-03-13 10:51:38,331 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 10:51:38,331 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.50it/s]
2025-03-13 10:51:50,402 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0708 secs
2025-03-13 10:51:50,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8472 secs
2025-03-13 10:51:50,405 [INFO]: {
2025-03-13 10:51:50,405 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:50,405 [INFO]: 	index_param: efSearch=237
2025-03-13 10:51:50,405 [INFO]: 	index_path: knn.index
2025-03-13 10:51:50,405 [INFO]: 	size in bytes: 434213890
2025-03-13 10:51:50,405 [INFO]: 	avg_search_speed_ms: 10.296316135695816
2025-03-13 10:51:50,405 [INFO]: 	99p_search_speed_ms: 16.063793422654268
2025-03-13 10:51:50,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:50,405 [INFO]: 	nb vectors: 2207
2025-03-13 10:51:50,405 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:50,405 [INFO]: 	compression ratio: 0.9993090179588682
2025-03-13 10:51:50,405 [INFO]: }
2025-03-13 10:51:50,405 [INFO]: 	>>> Finished "Creating the index" in 45.8494 secs
2025-03-13 10:51:50,405 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8925 secs
2025-03-13 10:51:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 11776 [episode count 0/20]
[retrieval_preprocessing] for episode 75777 [episode count 1/20], we have num_retrieval=np.int64(2092) num_query=np.int64(222)
2025-03-13 10:51:52,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:52,610 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:52
2025-03-13 10:51:52,610 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1408.90it/s]
2025-03-13 10:51:52,648 [INFO]: There are 2092 embeddings of dim 49152
2025-03-13 10:51:52,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 10:51:52,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:52,649 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:51:52,649 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:52,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:51:52,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,649 [INFO]: 431.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:52,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 10:51:52,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:52
2025-03-13 10:51:52,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:52,650 [INFO]: 	Creating the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,650 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:52
2025-03-13 10:51:52,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 10:51:52,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,655 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:51:52,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.23it/s] 33%|███▎      | 3/9 [00:00<00:00, 14.54it/s] 67%|██████▋   | 6/9 [00:00<00:00, 14.85it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.36it/s]100%|██████████| 9/9 [00:02<00:00,  3.16it/s]
2025-03-13 10:51:55,511 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:55
2025-03-13 10:52:23,512 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0000 secs
2025-03-13 10:52:23,512 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 10:52:23,512 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-13 10:52:35,646 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1336 secs
2025-03-13 10:52:35,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9931 secs
2025-03-13 10:52:35,648 [INFO]: {
2025-03-13 10:52:35,648 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:35,648 [INFO]: 	index_param: efSearch=222
2025-03-13 10:52:35,648 [INFO]: 	index_path: knn.index
2025-03-13 10:52:35,648 [INFO]: 	size in bytes: 411588310
2025-03-13 10:52:35,648 [INFO]: 	avg_search_speed_ms: 9.612386580108879
2025-03-13 10:52:35,648 [INFO]: 	99p_search_speed_ms: 14.726009296718956
2025-03-13 10:52:35,648 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:35,648 [INFO]: 	nb vectors: 2092
2025-03-13 10:52:35,648 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:35,648 [INFO]: 	compression ratio: 0.9993090814459721
2025-03-13 10:52:35,648 [INFO]: }
2025-03-13 10:52:35,648 [INFO]: 	>>> Finished "Creating the index" in 42.9977 secs
2025-03-13 10:52:35,648 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0377 secs
2025-03-13 10:52:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 75777 [episode count 1/20]
[retrieval_preprocessing] for episode 91658 [episode count 2/20], we have num_retrieval=np.int64(2198) num_query=np.int64(116)
2025-03-13 10:52:38,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:38,565 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:38
2025-03-13 10:52:38,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 945.94it/s]
2025-03-13 10:52:38,592 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 10:52:38,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 10:52:38,592 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:38
2025-03-13 10:52:38,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:38,592 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:52:38,592 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:38,593 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:38,593 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:38
2025-03-13 10:52:38,593 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:38,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:52:38,593 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:38
2025-03-13 10:52:38,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:38,593 [INFO]: 	Creating the index 03/13/2025, 10:52:38
2025-03-13 10:52:38,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:38
2025-03-13 10:52:38,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:52:38,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:38
2025-03-13 10:52:38,594 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:52:38,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.28it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.64it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.24it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.70it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.88it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.97it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.95it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.11it/s]100%|██████████| 9/9 [00:02<00:00,  1.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.17it/s]
2025-03-13 10:52:41,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:41
2025-03-13 10:53:10,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0213 secs
2025-03-13 10:53:10,460 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 10:53:10,460 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s]
2025-03-13 10:53:22,853 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3926 secs
2025-03-13 10:53:22,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2602 secs
2025-03-13 10:53:22,854 [INFO]: {
2025-03-13 10:53:22,854 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:22,854 [INFO]: 	index_param: efSearch=309
2025-03-13 10:53:22,854 [INFO]: 	index_path: knn.index
2025-03-13 10:53:22,855 [INFO]: 	size in bytes: 432443230
2025-03-13 10:53:22,855 [INFO]: 	avg_search_speed_ms: 10.10216344947541
2025-03-13 10:53:22,855 [INFO]: 	99p_search_speed_ms: 14.526628130115569
2025-03-13 10:53:22,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:22,855 [INFO]: 	nb vectors: 2198
2025-03-13 10:53:22,855 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:22,855 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 10:53:22,855 [INFO]: }
2025-03-13 10:53:22,855 [INFO]: 	>>> Finished "Creating the index" in 44.2617 secs
2025-03-13 10:53:22,855 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2900 secs
2025-03-13 10:53:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 91658 [episode count 2/20]
[retrieval_preprocessing] for episode 9747 [episode count 3/20], we have num_retrieval=np.int64(2224) num_query=np.int64(90)
2025-03-13 10:53:24,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:25,078 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:25
2025-03-13 10:53:25,078 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.63it/s]
2025-03-13 10:53:25,100 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 10:53:25,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 10:53:25,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:25
2025-03-13 10:53:25,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:25,101 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:53:25,101 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:25,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:25,101 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:25
2025-03-13 10:53:25,101 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:25,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:25,101 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:25
2025-03-13 10:53:25,101 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:25,101 [INFO]: 	Creating the index 03/13/2025, 10:53:25
2025-03-13 10:53:25,101 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:25
2025-03-13 10:53:25,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:53:25,102 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:25
2025-03-13 10:53:25,102 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:25,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.31it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.69it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.41it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.89it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.29it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.62it/s]100%|██████████| 9/9 [00:02<00:00,  2.41it/s]100%|██████████| 9/9 [00:02<00:00,  3.84it/s]
2025-03-13 10:53:27,452 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:27
2025-03-13 10:53:53,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8726 secs
2025-03-13 10:53:53,325 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 10:53:53,325 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 10:54:05,802 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4766 secs
2025-03-13 10:54:05,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.7015 secs
2025-03-13 10:54:05,804 [INFO]: {
2025-03-13 10:54:05,804 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:05,804 [INFO]: 	index_param: efSearch=245
2025-03-13 10:54:05,804 [INFO]: 	index_path: knn.index
2025-03-13 10:54:05,804 [INFO]: 	size in bytes: 437558470
2025-03-13 10:54:05,804 [INFO]: 	avg_search_speed_ms: 8.222442367887675
2025-03-13 10:54:05,804 [INFO]: 	99p_search_speed_ms: 11.499180865939701
2025-03-13 10:54:05,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:05,804 [INFO]: 	nb vectors: 2224
2025-03-13 10:54:05,804 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:05,804 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 10:54:05,804 [INFO]: }
2025-03-13 10:54:05,804 [INFO]: 	>>> Finished "Creating the index" in 40.7029 secs
2025-03-13 10:54:05,804 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7263 secs
2025-03-13 10:54:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 9747 [episode count 3/20]
[retrieval_preprocessing] for episode 12825 [episode count 4/20], we have num_retrieval=np.int64(2198) num_query=np.int64(116)
2025-03-13 10:54:07,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:07,674 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:07
2025-03-13 10:54:07,674 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.69it/s]
2025-03-13 10:54:07,699 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 10:54:07,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 10:54:07,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:07
2025-03-13 10:54:07,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:07,699 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:54:07,699 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:07,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:07,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:07
2025-03-13 10:54:07,699 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:07,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:07,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:07
2025-03-13 10:54:07,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:07,699 [INFO]: 	Creating the index 03/13/2025, 10:54:07
2025-03-13 10:54:07,699 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:07
2025-03-13 10:54:07,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:54:07,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:07
2025-03-13 10:54:07,701 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:07,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.57it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.70it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.79it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.25it/s]100%|██████████| 9/9 [00:02<00:00,  2.90it/s]100%|██████████| 9/9 [00:02<00:00,  4.02it/s]
2025-03-13 10:54:09,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:09
2025-03-13 10:54:39,272 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3314 secs
2025-03-13 10:54:39,272 [INFO]: The best hyperparameters are: efSearch=345
2025-03-13 10:54:39,272 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s]
2025-03-13 10:54:51,593 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3203 secs
2025-03-13 10:54:51,595 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8942 secs
2025-03-13 10:54:51,595 [INFO]: {
2025-03-13 10:54:51,595 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:51,595 [INFO]: 	index_param: efSearch=345
2025-03-13 10:54:51,595 [INFO]: 	index_path: knn.index
2025-03-13 10:54:51,595 [INFO]: 	size in bytes: 432443230
2025-03-13 10:54:51,595 [INFO]: 	avg_search_speed_ms: 9.782285051358365
2025-03-13 10:54:51,595 [INFO]: 	99p_search_speed_ms: 13.555498358327888
2025-03-13 10:54:51,595 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:51,595 [INFO]: 	nb vectors: 2198
2025-03-13 10:54:51,595 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:51,595 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 10:54:51,595 [INFO]: }
2025-03-13 10:54:51,595 [INFO]: 	>>> Finished "Creating the index" in 43.8957 secs
2025-03-13 10:54:51,595 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9206 secs
2025-03-13 10:54:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 12825 [episode count 4/20]
[retrieval_preprocessing] for episode 55833 [episode count 5/20], we have num_retrieval=np.int64(2221) num_query=np.int64(93)
2025-03-13 10:54:53,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:54,162 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:54
2025-03-13 10:54:54,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.64it/s]
2025-03-13 10:54:54,186 [INFO]: There are 2221 embeddings of dim 49152
2025-03-13 10:54:54,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 10:54:54,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:54
2025-03-13 10:54:54,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:54,187 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:54:54,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:54,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:54:54,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:54
2025-03-13 10:54:54,188 [INFO]: 458.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:54,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:54:54,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:54
2025-03-13 10:54:54,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:54,189 [INFO]: 	Creating the index 03/13/2025, 10:54:54
2025-03-13 10:54:54,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:54
2025-03-13 10:54:54,191 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 10:54:54,191 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:54
2025-03-13 10:54:54,192 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:54,192 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.93it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.47it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.73it/s]100%|██████████| 9/9 [00:02<00:00,  3.10it/s]100%|██████████| 9/9 [00:02<00:00,  4.32it/s]
2025-03-13 10:54:56,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:56
2025-03-13 10:55:24,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0595 secs
2025-03-13 10:55:24,343 [INFO]: The best hyperparameters are: efSearch=334
2025-03-13 10:55:24,343 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 10:55:36,793 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4493 secs
2025-03-13 10:55:36,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6029 secs
2025-03-13 10:55:36,795 [INFO]: {
2025-03-13 10:55:36,795 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:36,795 [INFO]: 	index_param: efSearch=334
2025-03-13 10:55:36,795 [INFO]: 	index_path: knn.index
2025-03-13 10:55:36,795 [INFO]: 	size in bytes: 436968250
2025-03-13 10:55:36,795 [INFO]: 	avg_search_speed_ms: 9.271829458518063
2025-03-13 10:55:36,795 [INFO]: 	99p_search_speed_ms: 12.077638772316277
2025-03-13 10:55:36,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:36,795 [INFO]: 	nb vectors: 2221
2025-03-13 10:55:36,795 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:36,795 [INFO]: 	compression ratio: 0.9993091443142608
2025-03-13 10:55:36,795 [INFO]: }
2025-03-13 10:55:36,795 [INFO]: 	>>> Finished "Creating the index" in 42.6058 secs
2025-03-13 10:55:36,795 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6325 secs
2025-03-13 10:55:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 55833 [episode count 5/20]
[retrieval_preprocessing] for episode 67122 [episode count 6/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 10:55:38,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:38,870 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:38
2025-03-13 10:55:38,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.16it/s]
2025-03-13 10:55:38,894 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 10:55:38,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 10:55:38,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:38
2025-03-13 10:55:38,895 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:38,895 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:55:38,895 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:38,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:38,895 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:38
2025-03-13 10:55:38,895 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:38,895 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:55:38,895 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:38
2025-03-13 10:55:38,895 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:38,895 [INFO]: 	Creating the index 03/13/2025, 10:55:38
2025-03-13 10:55:38,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:38
2025-03-13 10:55:38,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:55:38,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:38
2025-03-13 10:55:38,896 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:55:38,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.15it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.62it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.26it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.59it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.81it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.07it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.15it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.18it/s]100%|██████████| 9/9 [00:02<00:00,  1.65it/s]100%|██████████| 9/9 [00:02<00:00,  3.33it/s]
2025-03-13 10:55:41,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:41
2025-03-13 10:56:09,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8749 secs
2025-03-13 10:56:09,484 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 10:56:09,484 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s]
2025-03-13 10:56:22,161 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6770 secs
2025-03-13 10:56:22,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2661 secs
2025-03-13 10:56:22,162 [INFO]: {
2025-03-13 10:56:22,162 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:22,162 [INFO]: 	index_param: efSearch=321
2025-03-13 10:56:22,162 [INFO]: 	index_path: knn.index
2025-03-13 10:56:22,162 [INFO]: 	size in bytes: 434410630
2025-03-13 10:56:22,163 [INFO]: 	avg_search_speed_ms: 10.255102473191727
2025-03-13 10:56:22,163 [INFO]: 	99p_search_speed_ms: 13.44280906021595
2025-03-13 10:56:22,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:22,163 [INFO]: 	nb vectors: 2208
2025-03-13 10:56:22,163 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:22,163 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 10:56:22,163 [INFO]: }
2025-03-13 10:56:22,163 [INFO]: 	>>> Finished "Creating the index" in 43.2674 secs
2025-03-13 10:56:22,163 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2927 secs
2025-03-13 10:56:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 67122 [episode count 6/20]
[retrieval_preprocessing] for episode 28725 [episode count 7/20], we have num_retrieval=np.int64(2217) num_query=np.int64(97)
2025-03-13 10:56:23,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:24,143 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:24
2025-03-13 10:56:24,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.57it/s]
2025-03-13 10:56:24,166 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 10:56:24,166 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 10:56:24,167 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:24
2025-03-13 10:56:24,167 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:24,167 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:56:24,167 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:24,167 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:56:24,167 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:24
2025-03-13 10:56:24,167 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:24,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:56:24,168 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:24
2025-03-13 10:56:24,168 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:24,168 [INFO]: 	Creating the index 03/13/2025, 10:56:24
2025-03-13 10:56:24,168 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:24
2025-03-13 10:56:24,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 10:56:24,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:24
2025-03-13 10:56:24,172 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:56:24,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.87it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.43it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.13it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.53it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.76it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.88it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.96it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.99it/s]100%|██████████| 9/9 [00:02<00:00,  1.78it/s]100%|██████████| 9/9 [00:02<00:00,  3.62it/s]
2025-03-13 10:56:26,668 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:26
2025-03-13 10:56:50,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0873 secs
2025-03-13 10:56:50,756 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 10:56:50,756 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
2025-03-13 10:57:03,110 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3540 secs
2025-03-13 10:57:03,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.9398 secs
2025-03-13 10:57:03,112 [INFO]: {
2025-03-13 10:57:03,112 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:03,112 [INFO]: 	index_param: efSearch=282
2025-03-13 10:57:03,112 [INFO]: 	index_path: knn.index
2025-03-13 10:57:03,112 [INFO]: 	size in bytes: 436181290
2025-03-13 10:57:03,112 [INFO]: 	avg_search_speed_ms: 8.787658033231256
2025-03-13 10:57:03,112 [INFO]: 	99p_search_speed_ms: 11.045084267389026
2025-03-13 10:57:03,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:03,112 [INFO]: 	nb vectors: 2217
2025-03-13 10:57:03,112 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:03,112 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 10:57:03,112 [INFO]: }
2025-03-13 10:57:03,112 [INFO]: 	>>> Finished "Creating the index" in 38.9436 secs
2025-03-13 10:57:03,112 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9689 secs
2025-03-13 10:57:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 28725 [episode count 7/20]
[retrieval_preprocessing] for episode 12863 [episode count 8/20], we have num_retrieval=np.int64(2220) num_query=np.int64(94)
2025-03-13 10:57:04,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:05,325 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:05
2025-03-13 10:57:05,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2239.35it/s]
2025-03-13 10:57:05,347 [INFO]: There are 2220 embeddings of dim 49152
2025-03-13 10:57:05,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 10:57:05,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:05,348 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:57:05,348 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:05,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:05,348 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,348 [INFO]: 458.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:05,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:05,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:05
2025-03-13 10:57:05,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:05,348 [INFO]: 	Creating the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:05
2025-03-13 10:57:05,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:57:05,349 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,349 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:05,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.71it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.11it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.59it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.66it/s]100%|██████████| 9/9 [00:02<00:00,  2.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.73it/s]
2025-03-13 10:57:07,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:07
2025-03-13 10:57:34,742 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9720 secs
2025-03-13 10:57:34,742 [INFO]: The best hyperparameters are: efSearch=338
2025-03-13 10:57:34,742 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s]
2025-03-13 10:57:48,451 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7081 secs
2025-03-13 10:57:48,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1036 secs
2025-03-13 10:57:48,453 [INFO]: {
2025-03-13 10:57:48,453 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:48,453 [INFO]: 	index_param: efSearch=338
2025-03-13 10:57:48,453 [INFO]: 	index_path: knn.index
2025-03-13 10:57:48,453 [INFO]: 	size in bytes: 436771510
2025-03-13 10:57:48,453 [INFO]: 	avg_search_speed_ms: 10.940235109409429
2025-03-13 10:57:48,453 [INFO]: 	99p_search_speed_ms: 16.258159205317497
2025-03-13 10:57:48,453 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:48,453 [INFO]: 	nb vectors: 2220
2025-03-13 10:57:48,453 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:48,453 [INFO]: 	compression ratio: 0.9993091353417259
2025-03-13 10:57:48,453 [INFO]: }
2025-03-13 10:57:48,453 [INFO]: 	>>> Finished "Creating the index" in 43.1049 secs
2025-03-13 10:57:48,453 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1284 secs
2025-03-13 10:57:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 12863 [episode count 8/20]
[retrieval_preprocessing] for episode 59457 [episode count 9/20], we have num_retrieval=np.int64(2217) num_query=np.int64(97)
2025-03-13 10:57:50,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:50,837 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:50
2025-03-13 10:57:50,837 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-13 10:57:50,860 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 10:57:50,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 10:57:50,860 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:50
2025-03-13 10:57:50,860 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:50,860 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:57:50,860 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:50,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:50,860 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:50
2025-03-13 10:57:50,861 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:50,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:50,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:50
2025-03-13 10:57:50,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:50,861 [INFO]: 	Creating the index 03/13/2025, 10:57:50
2025-03-13 10:57:50,861 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:50
2025-03-13 10:57:50,862 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:57:50,862 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:50
2025-03-13 10:57:50,862 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:50,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.64it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.44it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.97it/s] 67%|██████▋   | 6/9 [00:00<00:00, 11.03it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.76it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 10:57:53,040 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:53
2025-03-13 10:58:24,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7417 secs
2025-03-13 10:58:24,783 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 10:58:24,783 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 10:58:38,481 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6984 secs
2025-03-13 10:58:38,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6216 secs
2025-03-13 10:58:38,483 [INFO]: {
2025-03-13 10:58:38,484 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:38,484 [INFO]: 	index_param: efSearch=284
2025-03-13 10:58:38,484 [INFO]: 	index_path: knn.index
2025-03-13 10:58:38,484 [INFO]: 	size in bytes: 436181290
2025-03-13 10:58:38,484 [INFO]: 	avg_search_speed_ms: 10.164012681461902
2025-03-13 10:58:38,484 [INFO]: 	99p_search_speed_ms: 17.416413344908506
2025-03-13 10:58:38,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:38,484 [INFO]: 	nb vectors: 2217
2025-03-13 10:58:38,484 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:38,484 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 10:58:38,484 [INFO]: }
2025-03-13 10:58:38,484 [INFO]: 	>>> Finished "Creating the index" in 47.6230 secs
2025-03-13 10:58:38,484 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6468 secs
2025-03-13 10:58:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 59457 [episode count 9/20]
[retrieval_preprocessing] for episode 21070 [episode count 10/20], we have num_retrieval=np.int64(2190) num_query=np.int64(124)
2025-03-13 10:58:40,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:40,406 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:40
2025-03-13 10:58:40,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1108.72it/s]
2025-03-13 10:58:40,433 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 10:58:40,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 10:58:40,433 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,434 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:40,434 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:58:40,434 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:40,434 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:58:40,434 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,434 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:40,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:58:40,435 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:40
2025-03-13 10:58:40,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:40,435 [INFO]: 	Creating the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,435 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:40
2025-03-13 10:58:40,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 10:58:40,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,439 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:58:40,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.76it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.05it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.55it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.28it/s]100%|██████████| 9/9 [00:01<00:00,  3.35it/s]100%|██████████| 9/9 [00:01<00:00,  4.67it/s]
2025-03-13 10:58:42,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:42
2025-03-13 10:59:11,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2761 secs
2025-03-13 10:59:11,649 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 10:59:11,649 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 10:59:24,049 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4005 secs
2025-03-13 10:59:24,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6120 secs
2025-03-13 10:59:24,051 [INFO]: {
2025-03-13 10:59:24,051 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:24,051 [INFO]: 	index_param: efSearch=303
2025-03-13 10:59:24,051 [INFO]: 	index_path: knn.index
2025-03-13 10:59:24,051 [INFO]: 	size in bytes: 430869310
2025-03-13 10:59:24,051 [INFO]: 	avg_search_speed_ms: 10.50512437824113
2025-03-13 10:59:24,051 [INFO]: 	99p_search_speed_ms: 23.157995343208317
2025-03-13 10:59:24,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:24,051 [INFO]: 	nb vectors: 2190
2025-03-13 10:59:24,051 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:24,051 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 10:59:24,051 [INFO]: }
2025-03-13 10:59:24,051 [INFO]: 	>>> Finished "Creating the index" in 43.6161 secs
2025-03-13 10:59:24,051 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6457 secs
2025-03-13 10:59:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 21070 [episode count 10/20]
[retrieval_preprocessing] for episode 32351 [episode count 11/20], we have num_retrieval=np.int64(2156) num_query=np.int64(158)
2025-03-13 10:59:25,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:26,269 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:26
2025-03-13 10:59:26,269 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1661.11it/s]
2025-03-13 10:59:26,291 [INFO]: There are 2156 embeddings of dim 49152
2025-03-13 10:59:26,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 10:59:26,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:26
2025-03-13 10:59:26,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:26,291 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:59:26,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:26,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:26,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:26
2025-03-13 10:59:26,291 [INFO]: 444.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:26,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:26,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:26
2025-03-13 10:59:26,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:26,291 [INFO]: 	Creating the index 03/13/2025, 10:59:26
2025-03-13 10:59:26,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:26
2025-03-13 10:59:26,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:59:26,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:26
2025-03-13 10:59:26,293 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:59:26,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.85it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.32it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.65it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.07it/s]
2025-03-13 10:59:28,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:28
2025-03-13 10:59:50,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2738 secs
2025-03-13 10:59:50,780 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 10:59:50,780 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s]
2025-03-13 11:00:03,579 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7987 secs
2025-03-13 11:00:03,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2879 secs
2025-03-13 11:00:03,580 [INFO]: {
2025-03-13 11:00:03,580 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:03,580 [INFO]: 	index_param: efSearch=291
2025-03-13 11:00:03,581 [INFO]: 	index_path: knn.index
2025-03-13 11:00:03,581 [INFO]: 	size in bytes: 424179910
2025-03-13 11:00:03,581 [INFO]: 	avg_search_speed_ms: 9.753058386921156
2025-03-13 11:00:03,581 [INFO]: 	99p_search_speed_ms: 13.49642924964428
2025-03-13 11:00:03,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:03,581 [INFO]: 	nb vectors: 2156
2025-03-13 11:00:03,581 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:03,581 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 11:00:03,581 [INFO]: }
2025-03-13 11:00:03,581 [INFO]: 	>>> Finished "Creating the index" in 37.2892 secs
2025-03-13 11:00:03,581 [INFO]: >>> Finished "Launching the whole pipeline" in 37.3116 secs
2025-03-13 11:00:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 32351 [episode count 11/20]
[retrieval_preprocessing] for episode 82536 [episode count 12/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 11:00:05,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:06,043 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:06
2025-03-13 11:00:06,043 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.26it/s]
2025-03-13 11:00:06,065 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 11:00:06,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:00:06,066 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:06
2025-03-13 11:00:06,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:06,066 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:00:06,066 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:06,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:06,066 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:06
2025-03-13 11:00:06,066 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:06,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:00:06,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:06
2025-03-13 11:00:06,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:06,066 [INFO]: 	Creating the index 03/13/2025, 11:00:06
2025-03-13 11:00:06,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:06
2025-03-13 11:00:06,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:00:06,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:06
2025-03-13 11:00:06,067 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:06,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.11it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.66it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.34it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.80it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.56it/s]100%|██████████| 9/9 [00:02<00:00,  2.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.69it/s]
2025-03-13 11:00:08,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:08
2025-03-13 11:00:39,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0390 secs
2025-03-13 11:00:39,554 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:00:39,554 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 11:00:52,079 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5253 secs
2025-03-13 11:00:52,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0135 secs
2025-03-13 11:00:52,081 [INFO]: {
2025-03-13 11:00:52,081 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:52,081 [INFO]: 	index_param: efSearch=280
2025-03-13 11:00:52,081 [INFO]: 	index_path: knn.index
2025-03-13 11:00:52,081 [INFO]: 	size in bytes: 434410630
2025-03-13 11:00:52,081 [INFO]: 	avg_search_speed_ms: 9.460529605236852
2025-03-13 11:00:52,081 [INFO]: 	99p_search_speed_ms: 13.657641559839252
2025-03-13 11:00:52,081 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:52,081 [INFO]: 	nb vectors: 2208
2025-03-13 11:00:52,081 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:52,081 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 11:00:52,081 [INFO]: }
2025-03-13 11:00:52,081 [INFO]: 	>>> Finished "Creating the index" in 46.0150 secs
2025-03-13 11:00:52,081 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0383 secs
2025-03-13 11:00:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 82536 [episode count 12/20]
[retrieval_preprocessing] for episode 10373 [episode count 13/20], we have num_retrieval=np.int64(2222) num_query=np.int64(92)
2025-03-13 11:00:53,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:54,241 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:54
2025-03-13 11:00:54,241 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.92it/s]
2025-03-13 11:00:54,264 [INFO]: There are 2222 embeddings of dim 49152
2025-03-13 11:00:54,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 11:00:54,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:54
2025-03-13 11:00:54,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:54,264 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:00:54,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:54,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:54,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:54
2025-03-13 11:00:54,264 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:54,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:00:54,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:54
2025-03-13 11:00:54,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:54,264 [INFO]: 	Creating the index 03/13/2025, 11:00:54
2025-03-13 11:00:54,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:54
2025-03-13 11:00:54,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:00:54,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:54
2025-03-13 11:00:54,265 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:54,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.63it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.36it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.70it/s]100%|██████████| 9/9 [00:02<00:00,  3.12it/s]100%|██████████| 9/9 [00:02<00:00,  4.32it/s]
2025-03-13 11:00:56,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:56
2025-03-13 11:01:23,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2190 secs
2025-03-13 11:01:23,574 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 11:01:23,574 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-13 11:01:37,082 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5077 secs
2025-03-13 11:01:37,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8183 secs
2025-03-13 11:01:37,084 [INFO]: {
2025-03-13 11:01:37,084 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:37,084 [INFO]: 	index_param: efSearch=297
2025-03-13 11:01:37,084 [INFO]: 	index_path: knn.index
2025-03-13 11:01:37,084 [INFO]: 	size in bytes: 437164990
2025-03-13 11:01:37,084 [INFO]: 	avg_search_speed_ms: 10.767621075157056
2025-03-13 11:01:37,084 [INFO]: 	99p_search_speed_ms: 17.345175324007876
2025-03-13 11:01:37,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:37,084 [INFO]: 	nb vectors: 2222
2025-03-13 11:01:37,084 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:37,084 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-13 11:01:37,084 [INFO]: }
2025-03-13 11:01:37,084 [INFO]: 	>>> Finished "Creating the index" in 42.8198 secs
2025-03-13 11:01:37,084 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8426 secs
2025-03-13 11:01:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 10373 [episode count 13/20]
[retrieval_preprocessing] for episode 649 [episode count 14/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 11:01:38,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:39,161 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:39
2025-03-13 11:01:39,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1898.73it/s]
2025-03-13 11:01:39,195 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 11:01:39,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:01:39,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:39
2025-03-13 11:01:39,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:39,196 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:01:39,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:39,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:01:39,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:39
2025-03-13 11:01:39,196 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:39,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:01:39,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:39
2025-03-13 11:01:39,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:39,197 [INFO]: 	Creating the index 03/13/2025, 11:01:39
2025-03-13 11:01:39,197 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:39
2025-03-13 11:01:39,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:01:39,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:39
2025-03-13 11:01:39,200 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:01:39,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.73it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.31it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.10it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.58it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.26it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.36it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.42it/s]100%|██████████| 9/9 [00:02<00:00,  1.87it/s]100%|██████████| 9/9 [00:02<00:00,  3.63it/s]
2025-03-13 11:01:41,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:41
2025-03-13 11:02:10,270 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5849 secs
2025-03-13 11:02:10,270 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 11:02:10,270 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 11:02:24,654 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3839 secs
2025-03-13 11:02:24,656 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4560 secs
2025-03-13 11:02:24,656 [INFO]: {
2025-03-13 11:02:24,656 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:24,656 [INFO]: 	index_param: efSearch=309
2025-03-13 11:02:24,656 [INFO]: 	index_path: knn.index
2025-03-13 11:02:24,656 [INFO]: 	size in bytes: 434410630
2025-03-13 11:02:24,656 [INFO]: 	avg_search_speed_ms: 10.73763508946864
2025-03-13 11:02:24,656 [INFO]: 	99p_search_speed_ms: 16.0033128457144
2025-03-13 11:02:24,656 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:24,656 [INFO]: 	nb vectors: 2208
2025-03-13 11:02:24,656 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:24,656 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 11:02:24,656 [INFO]: }
2025-03-13 11:02:24,656 [INFO]: 	>>> Finished "Creating the index" in 45.4589 secs
2025-03-13 11:02:24,656 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4949 secs
2025-03-13 11:02:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 649 [episode count 14/20]
[retrieval_preprocessing] for episode 61577 [episode count 15/20], we have num_retrieval=np.int64(2199) num_query=np.int64(115)
2025-03-13 11:02:26,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:27,044 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:27
2025-03-13 11:02:27,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-13 11:02:27,068 [INFO]: There are 2199 embeddings of dim 49152
2025-03-13 11:02:27,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:02:27,068 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:27
2025-03-13 11:02:27,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:27,068 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:02:27,068 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:27,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:02:27,068 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:27
2025-03-13 11:02:27,069 [INFO]: 453.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:27,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:27,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:27
2025-03-13 11:02:27,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:27,069 [INFO]: 	Creating the index 03/13/2025, 11:02:27
2025-03-13 11:02:27,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:27
2025-03-13 11:02:27,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:02:27,070 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:27
2025-03-13 11:02:27,070 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:02:27,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.73it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.82it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.86it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.12it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.32it/s]100%|██████████| 9/9 [00:02<00:00,  1.97it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]
2025-03-13 11:02:29,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:29
2025-03-13 11:02:58,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6554 secs
2025-03-13 11:02:58,251 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 11:02:58,251 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s]
2025-03-13 11:03:10,600 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3485 secs
2025-03-13 11:03:10,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5321 secs
2025-03-13 11:03:10,602 [INFO]: {
2025-03-13 11:03:10,602 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:10,602 [INFO]: 	index_param: efSearch=296
2025-03-13 11:03:10,602 [INFO]: 	index_path: knn.index
2025-03-13 11:03:10,602 [INFO]: 	size in bytes: 432639970
2025-03-13 11:03:10,602 [INFO]: 	avg_search_speed_ms: 10.269914420744216
2025-03-13 11:03:10,602 [INFO]: 	99p_search_speed_ms: 16.72582557424903
2025-03-13 11:03:10,602 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:10,602 [INFO]: 	nb vectors: 2199
2025-03-13 11:03:10,602 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:10,602 [INFO]: 	compression ratio: 0.999308945033442
2025-03-13 11:03:10,602 [INFO]: }
2025-03-13 11:03:10,602 [INFO]: 	>>> Finished "Creating the index" in 43.5336 secs
2025-03-13 11:03:10,602 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5580 secs
2025-03-13 11:03:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 61577 [episode count 15/20]
[retrieval_preprocessing] for episode 28309 [episode count 16/20], we have num_retrieval=np.int64(2202) num_query=np.int64(112)
2025-03-13 11:03:12,363 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:12,739 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:12
2025-03-13 11:03:12,739 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-13 11:03:12,763 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 11:03:12,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 11:03:12,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:12,763 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:03:12,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:12,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:12,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,763 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:12,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:12,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:12
2025-03-13 11:03:12,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:12,763 [INFO]: 	Creating the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:12
2025-03-13 11:03:12,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:03:12,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,764 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:12,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.21it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.65it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.71it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.18it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.55it/s]100%|██████████| 9/9 [00:02<00:00,  2.21it/s]100%|██████████| 9/9 [00:02<00:00,  3.67it/s]
2025-03-13 11:03:15,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:15
2025-03-13 11:03:43,021 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8003 secs
2025-03-13 11:03:43,021 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 11:03:43,022 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s]
2025-03-13 11:03:56,245 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2231 secs
2025-03-13 11:03:56,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4823 secs
2025-03-13 11:03:56,247 [INFO]: {
2025-03-13 11:03:56,247 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:56,247 [INFO]: 	index_param: efSearch=314
2025-03-13 11:03:56,247 [INFO]: 	index_path: knn.index
2025-03-13 11:03:56,247 [INFO]: 	size in bytes: 433230190
2025-03-13 11:03:56,247 [INFO]: 	avg_search_speed_ms: 11.411216880695017
2025-03-13 11:03:56,247 [INFO]: 	99p_search_speed_ms: 21.52902995236218
2025-03-13 11:03:56,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:56,247 [INFO]: 	nb vectors: 2202
2025-03-13 11:03:56,247 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:56,247 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 11:03:56,247 [INFO]: }
2025-03-13 11:03:56,247 [INFO]: 	>>> Finished "Creating the index" in 43.4837 secs
2025-03-13 11:03:56,247 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5077 secs
2025-03-13 11:03:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 28309 [episode count 16/20]
[retrieval_preprocessing] for episode 75928 [episode count 17/20], we have num_retrieval=np.int64(2161) num_query=np.int64(153)
2025-03-13 11:03:58,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:58,353 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:58
2025-03-13 11:03:58,353 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1380.61it/s]
2025-03-13 11:03:58,379 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 11:03:58,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 11:03:58,379 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:58
2025-03-13 11:03:58,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:58,379 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:03:58,379 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:58,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:58,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:58
2025-03-13 11:03:58,379 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:58,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:03:58,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:58
2025-03-13 11:03:58,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:58,380 [INFO]: 	Creating the index 03/13/2025, 11:03:58
2025-03-13 11:03:58,380 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:58
2025-03-13 11:03:58,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:03:58,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:58
2025-03-13 11:03:58,381 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:58,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.38it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.82it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.48it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.04it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.48it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.81it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.62it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.63it/s]100%|██████████| 9/9 [00:02<00:00,  1.95it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 11:04:00,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:00
2025-03-13 11:04:29,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1492 secs
2025-03-13 11:04:29,902 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 11:04:29,902 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 11:04:43,328 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4255 secs
2025-03-13 11:04:43,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9495 secs
2025-03-13 11:04:43,330 [INFO]: {
2025-03-13 11:04:43,330 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:43,330 [INFO]: 	index_param: efSearch=305
2025-03-13 11:04:43,330 [INFO]: 	index_path: knn.index
2025-03-13 11:04:43,330 [INFO]: 	size in bytes: 425163610
2025-03-13 11:04:43,330 [INFO]: 	avg_search_speed_ms: 10.227237472289733
2025-03-13 11:04:43,330 [INFO]: 	99p_search_speed_ms: 15.003548990935087
2025-03-13 11:04:43,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:43,330 [INFO]: 	nb vectors: 2161
2025-03-13 11:04:43,330 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:43,330 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 11:04:43,330 [INFO]: }
2025-03-13 11:04:43,331 [INFO]: 	>>> Finished "Creating the index" in 44.9509 secs
2025-03-13 11:04:43,331 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9774 secs
2025-03-13 11:04:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 75928 [episode count 17/20]
[retrieval_preprocessing] for episode 66735 [episode count 18/20], we have num_retrieval=np.int64(2204) num_query=np.int64(110)
2025-03-13 11:04:45,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:45,567 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:45
2025-03-13 11:04:45,567 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 11:04:45,606 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 11:04:45,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0388 secs
2025-03-13 11:04:45,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:45
2025-03-13 11:04:45,607 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:45,607 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:04:45,607 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:45,607 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:04:45,607 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:45
2025-03-13 11:04:45,608 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:45,608 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:04:45,608 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:45
2025-03-13 11:04:45,608 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:45,608 [INFO]: 	Creating the index 03/13/2025, 11:04:45
2025-03-13 11:04:45,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:45
2025-03-13 11:04:45,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:04:45,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:45
2025-03-13 11:04:45,613 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:04:45,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.35it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.25it/s]
2025-03-13 11:04:47,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:47
2025-03-13 11:05:21,740 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4053 secs
2025-03-13 11:05:21,740 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 11:05:21,740 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 11:05:33,552 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8122 secs
2025-03-13 11:05:33,554 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9418 secs
2025-03-13 11:05:33,555 [INFO]: {
2025-03-13 11:05:33,555 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:33,555 [INFO]: 	index_param: efSearch=220
2025-03-13 11:05:33,555 [INFO]: 	index_path: knn.index
2025-03-13 11:05:33,555 [INFO]: 	size in bytes: 433623670
2025-03-13 11:05:33,555 [INFO]: 	avg_search_speed_ms: 9.120701675098678
2025-03-13 11:05:33,555 [INFO]: 	99p_search_speed_ms: 13.736844761297101
2025-03-13 11:05:33,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:33,555 [INFO]: 	nb vectors: 2204
2025-03-13 11:05:33,555 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:33,555 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 11:05:33,555 [INFO]: }
2025-03-13 11:05:33,555 [INFO]: 	>>> Finished "Creating the index" in 47.9465 secs
2025-03-13 11:05:33,555 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9878 secs
2025-03-13 11:05:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 66735 [episode count 18/20]
[retrieval_preprocessing] for episode 65210 [episode count 19/20], we have num_retrieval=np.int64(2214) num_query=np.int64(100)
2025-03-13 11:05:34,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:34,971 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:34
2025-03-13 11:05:34,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.05it/s]
2025-03-13 11:05:35,027 [INFO]: There are 2214 embeddings of dim 49152
2025-03-13 11:05:35,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0566 secs
2025-03-13 11:05:35,028 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:35
2025-03-13 11:05:35,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:35,028 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:05:35,028 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:35,028 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:05:35,028 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:35
2025-03-13 11:05:35,028 [INFO]: 456.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:35,028 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:05:35,028 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:35
2025-03-13 11:05:35,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:35,029 [INFO]: 	Creating the index 03/13/2025, 11:05:35
2025-03-13 11:05:35,029 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:35
2025-03-13 11:05:35,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:05:35,031 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:35
2025-03-13 11:05:35,031 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:05:35,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.07it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.54it/s]100%|██████████| 9/9 [00:02<00:00,  4.44it/s]
2025-03-13 11:05:37,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:37
2025-03-13 11:06:03,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6324 secs
2025-03-13 11:06:03,695 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 11:06:03,695 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.20it/s]
2025-03-13 11:06:16,852 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1576 secs
2025-03-13 11:06:16,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8234 secs
2025-03-13 11:06:16,854 [INFO]: {
2025-03-13 11:06:16,854 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:16,854 [INFO]: 	index_param: efSearch=301
2025-03-13 11:06:16,854 [INFO]: 	index_path: knn.index
2025-03-13 11:06:16,854 [INFO]: 	size in bytes: 435591070
2025-03-13 11:06:16,854 [INFO]: 	avg_search_speed_ms: 10.834285326693127
2025-03-13 11:06:16,854 [INFO]: 	99p_search_speed_ms: 14.037109250202773
2025-03-13 11:06:16,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:16,854 [INFO]: 	nb vectors: 2214
2025-03-13 11:06:16,854 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:16,854 [INFO]: 	compression ratio: 0.9993090813363094
2025-03-13 11:06:16,854 [INFO]: }
2025-03-13 11:06:16,854 [INFO]: 	>>> Finished "Creating the index" in 41.8257 secs
2025-03-13 11:06:16,854 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8833 secs
2025-03-13 11:06:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 65210 [episode count 19/20]
2025-03-13 11:06:17: [retrieval_preprocessing] finished for 4251465834_coffee_machine_press_button [chosen_id count 0/260]
2025-03-13 11:06:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4329524892_put_cup_in_bowl [chosen_id count 1/260]
2025-03-13 11:06:19: [retrieval_preprocessing] we have num_total=2289 embedding_dim=49152
[retrieval_preprocessing] for episode 8707 [episode count 0/20], we have num_retrieval=np.int64(2134) num_query=np.int64(155)
2025-03-13 11:06:20,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:20,683 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:20
2025-03-13 11:06:20,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.78it/s]
2025-03-13 11:06:20,710 [INFO]: There are 2134 embeddings of dim 49152
2025-03-13 11:06:20,710 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:06:20,710 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:20
2025-03-13 11:06:20,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:20,710 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:06:20,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:20,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:20,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:20
2025-03-13 11:06:20,710 [INFO]: 440.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:20,711 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:06:20,711 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:20
2025-03-13 11:06:20,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:20,711 [INFO]: 	Creating the index 03/13/2025, 11:06:20
2025-03-13 11:06:20,711 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:20
2025-03-13 11:06:20,712 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:06:20,712 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:20
2025-03-13 11:06:20,712 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:06:20,712 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.38it/s] 78%|███████▊  | 7/9 [00:00<00:00, 30.85it/s]100%|██████████| 9/9 [00:01<00:00,  5.16it/s]
2025-03-13 11:06:22,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:22
2025-03-13 11:06:51,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6287 secs
2025-03-13 11:06:51,089 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:06:51,089 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s]
2025-03-13 11:07:02,807 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7179 secs
2025-03-13 11:07:02,809 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0968 secs
2025-03-13 11:07:02,809 [INFO]: {
2025-03-13 11:07:02,809 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:02,809 [INFO]: 	index_param: efSearch=205
2025-03-13 11:07:02,809 [INFO]: 	index_path: knn.index
2025-03-13 11:07:02,809 [INFO]: 	size in bytes: 419851510
2025-03-13 11:07:02,809 [INFO]: 	avg_search_speed_ms: 10.103130249325375
2025-03-13 11:07:02,809 [INFO]: 	99p_search_speed_ms: 15.362032053526493
2025-03-13 11:07:02,809 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:02,809 [INFO]: 	nb vectors: 2134
2025-03-13 11:07:02,809 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:02,809 [INFO]: 	compression ratio: 0.999309189098784
2025-03-13 11:07:02,809 [INFO]: }
2025-03-13 11:07:02,809 [INFO]: 	>>> Finished "Creating the index" in 42.0987 secs
2025-03-13 11:07:02,809 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1265 secs
2025-03-13 11:07:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 8707 [episode count 0/20]
[retrieval_preprocessing] for episode 90627 [episode count 1/20], we have num_retrieval=np.int64(2183) num_query=np.int64(106)
2025-03-13 11:07:04,189 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:04,582 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:04
2025-03-13 11:07:04,582 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 942.54it/s]
2025-03-13 11:07:04,621 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 11:07:04,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-13 11:07:04,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:04
2025-03-13 11:07:04,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:04,622 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:04,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:04,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:04,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:04
2025-03-13 11:07:04,622 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:04,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:07:04,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:04
2025-03-13 11:07:04,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:04,623 [INFO]: 	Creating the index 03/13/2025, 11:07:04
2025-03-13 11:07:04,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:04
2025-03-13 11:07:04,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:07:04,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:04
2025-03-13 11:07:04,624 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:04,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.77it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.03it/s]100%|██████████| 9/9 [00:01<00:00,  3.83it/s]100%|██████████| 9/9 [00:01<00:00,  4.51it/s]
2025-03-13 11:07:06,624 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:06
2025-03-13 11:07:34,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1103 secs
2025-03-13 11:07:34,735 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 11:07:34,735 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 11:07:48,538 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8026 secs
2025-03-13 11:07:48,540 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9159 secs
2025-03-13 11:07:48,540 [INFO]: {
2025-03-13 11:07:48,540 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:48,540 [INFO]: 	index_param: efSearch=224
2025-03-13 11:07:48,540 [INFO]: 	index_path: knn.index
2025-03-13 11:07:48,540 [INFO]: 	size in bytes: 429492010
2025-03-13 11:07:48,540 [INFO]: 	avg_search_speed_ms: 11.158734321205495
2025-03-13 11:07:48,540 [INFO]: 	99p_search_speed_ms: 15.532722603529688
2025-03-13 11:07:48,540 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:48,540 [INFO]: 	nb vectors: 2183
2025-03-13 11:07:48,540 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:48,540 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 11:07:48,540 [INFO]: }
2025-03-13 11:07:48,540 [INFO]: 	>>> Finished "Creating the index" in 43.9179 secs
2025-03-13 11:07:48,541 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9583 secs
2025-03-13 11:07:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 90627 [episode count 1/20]
[retrieval_preprocessing] for episode 72197 [episode count 2/20], we have num_retrieval=np.int64(2184) num_query=np.int64(105)
2025-03-13 11:07:49,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:50,164 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:50
2025-03-13 11:07:50,164 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.81it/s]
2025-03-13 11:07:50,195 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 11:07:50,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 11:07:50,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:50
2025-03-13 11:07:50,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:50,196 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:50,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:50,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:50,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:50
2025-03-13 11:07:50,196 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:50,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:07:50,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:50
2025-03-13 11:07:50,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:50,196 [INFO]: 	Creating the index 03/13/2025, 11:07:50
2025-03-13 11:07:50,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:50
2025-03-13 11:07:50,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:07:50,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:50
2025-03-13 11:07:50,198 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:50,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.84it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.68it/s]100%|██████████| 9/9 [00:01<00:00,  4.65it/s]
2025-03-13 11:07:52,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:52
2025-03-13 11:08:21,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0035 secs
2025-03-13 11:08:21,140 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 11:08:21,140 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 11:08:33,471 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3309 secs
2025-03-13 11:08:33,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2748 secs
2025-03-13 11:08:33,473 [INFO]: {
2025-03-13 11:08:33,473 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:33,473 [INFO]: 	index_param: efSearch=302
2025-03-13 11:08:33,473 [INFO]: 	index_path: knn.index
2025-03-13 11:08:33,473 [INFO]: 	size in bytes: 429688750
2025-03-13 11:08:33,473 [INFO]: 	avg_search_speed_ms: 12.493405165848381
2025-03-13 11:08:33,473 [INFO]: 	99p_search_speed_ms: 27.740831021219492
2025-03-13 11:08:33,473 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:33,473 [INFO]: 	nb vectors: 2184
2025-03-13 11:08:33,473 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:33,473 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 11:08:33,473 [INFO]: }
2025-03-13 11:08:33,474 [INFO]: 	>>> Finished "Creating the index" in 43.2772 secs
2025-03-13 11:08:33,474 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3096 secs
2025-03-13 11:08:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 72197 [episode count 2/20]
[retrieval_preprocessing] for episode 48152 [episode count 3/20], we have num_retrieval=np.int64(2177) num_query=np.int64(112)
2025-03-13 11:08:34,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:35,157 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:35
2025-03-13 11:08:35,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.55it/s]
2025-03-13 11:08:35,188 [INFO]: There are 2177 embeddings of dim 49152
2025-03-13 11:08:35,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:08:35,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:35,188 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:08:35,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:35,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:35,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,188 [INFO]: 449.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:35,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:35,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:35
2025-03-13 11:08:35,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:35,188 [INFO]: 	Creating the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:35
2025-03-13 11:08:35,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:08:35,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,190 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:08:35,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.23it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.31it/s]100%|██████████| 9/9 [00:01<00:00,  4.89it/s]
2025-03-13 11:08:37,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:37
2025-03-13 11:09:10,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6753 secs
2025-03-13 11:09:10,710 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 11:09:10,710 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.92it/s]
2025-03-13 11:09:23,676 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9662 secs
2025-03-13 11:09:23,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4892 secs
2025-03-13 11:09:23,679 [INFO]: {
2025-03-13 11:09:23,679 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:23,679 [INFO]: 	index_param: efSearch=210
2025-03-13 11:09:23,679 [INFO]: 	index_path: knn.index
2025-03-13 11:09:23,679 [INFO]: 	size in bytes: 428311570
2025-03-13 11:09:23,679 [INFO]: 	avg_search_speed_ms: 11.52936369636684
2025-03-13 11:09:23,679 [INFO]: 	99p_search_speed_ms: 19.990434062201533
2025-03-13 11:09:23,679 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:23,679 [INFO]: 	nb vectors: 2177
2025-03-13 11:09:23,679 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:23,679 [INFO]: 	compression ratio: 0.9993090217011882
2025-03-13 11:09:23,679 [INFO]: }
2025-03-13 11:09:23,679 [INFO]: 	>>> Finished "Creating the index" in 48.4908 secs
2025-03-13 11:09:23,679 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5221 secs
2025-03-13 11:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 48152 [episode count 3/20]
[retrieval_preprocessing] for episode 55324 [episode count 4/20], we have num_retrieval=np.int64(2190) num_query=np.int64(99)
2025-03-13 11:09:25,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:25,606 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:25
2025-03-13 11:09:25,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-13 11:09:25,635 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 11:09:25,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:09:25,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:25
2025-03-13 11:09:25,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:25,635 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:09:25,635 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:25,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:09:25,635 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:25
2025-03-13 11:09:25,635 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:25,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:09:25,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:25
2025-03-13 11:09:25,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:25,636 [INFO]: 	Creating the index 03/13/2025, 11:09:25
2025-03-13 11:09:25,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:25
2025-03-13 11:09:25,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:09:25,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:25
2025-03-13 11:09:25,637 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:09:25,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.28it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.68it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.02it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.76it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.86it/s]
2025-03-13 11:09:27,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:27
2025-03-13 11:10:00,348 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3779 secs
2025-03-13 11:10:00,349 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 11:10:00,349 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-13 11:10:15,774 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4249 secs
2025-03-13 11:10:15,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1383 secs
2025-03-13 11:10:15,776 [INFO]: {
2025-03-13 11:10:15,776 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:15,776 [INFO]: 	index_param: efSearch=284
2025-03-13 11:10:15,776 [INFO]: 	index_path: knn.index
2025-03-13 11:10:15,776 [INFO]: 	size in bytes: 430869310
2025-03-13 11:10:15,776 [INFO]: 	avg_search_speed_ms: 10.437709416046241
2025-03-13 11:10:15,776 [INFO]: 	99p_search_speed_ms: 14.948273408226662
2025-03-13 11:10:15,776 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:15,776 [INFO]: 	nb vectors: 2190
2025-03-13 11:10:15,776 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:15,776 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 11:10:15,776 [INFO]: }
2025-03-13 11:10:15,776 [INFO]: 	>>> Finished "Creating the index" in 50.1403 secs
2025-03-13 11:10:15,776 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1695 secs
2025-03-13 11:10:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 55324 [episode count 4/20]
[retrieval_preprocessing] for episode 87069 [episode count 5/20], we have num_retrieval=np.int64(2204) num_query=np.int64(85)
2025-03-13 11:10:18,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:19,088 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:19
2025-03-13 11:10:19,089 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.95it/s]
2025-03-13 11:10:19,114 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 11:10:19,114 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:10:19,114 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:19
2025-03-13 11:10:19,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:19,114 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:10:19,114 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:19,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:19,114 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:19
2025-03-13 11:10:19,114 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:19,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:10:19,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:19
2025-03-13 11:10:19,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:19,115 [INFO]: 	Creating the index 03/13/2025, 11:10:19
2025-03-13 11:10:19,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:19
2025-03-13 11:10:19,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:10:19,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:19
2025-03-13 11:10:19,116 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:19,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.68it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.70it/s] 67%|██████▋   | 6/9 [00:02<00:01,  1.74it/s] 78%|███████▊  | 7/9 [00:03<00:01,  1.79it/s] 89%|████████▉ | 8/9 [00:05<00:00,  1.09it/s]100%|██████████| 9/9 [00:07<00:00,  1.26s/it]100%|██████████| 9/9 [00:07<00:00,  1.19it/s]
2025-03-13 11:10:26,688 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:26
2025-03-13 11:10:55,962 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2738 secs
2025-03-13 11:10:55,962 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 11:10:55,962 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-13 11:11:08,444 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4819 secs
2025-03-13 11:11:08,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3302 secs
2025-03-13 11:11:08,446 [INFO]: {
2025-03-13 11:11:08,446 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:08,446 [INFO]: 	index_param: efSearch=300
2025-03-13 11:11:08,446 [INFO]: 	index_path: knn.index
2025-03-13 11:11:08,446 [INFO]: 	size in bytes: 433623670
2025-03-13 11:11:08,446 [INFO]: 	avg_search_speed_ms: 10.118478919032524
2025-03-13 11:11:08,446 [INFO]: 	99p_search_speed_ms: 13.68902774527669
2025-03-13 11:11:08,446 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:08,446 [INFO]: 	nb vectors: 2204
2025-03-13 11:11:08,446 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:08,446 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 11:11:08,446 [INFO]: }
2025-03-13 11:11:08,446 [INFO]: 	>>> Finished "Creating the index" in 49.3318 secs
2025-03-13 11:11:08,447 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3580 secs
2025-03-13 11:11:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 87069 [episode count 5/20]
[retrieval_preprocessing] for episode 27178 [episode count 6/20], we have num_retrieval=np.int64(2198) num_query=np.int64(91)
2025-03-13 11:11:10,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:11,037 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:11
2025-03-13 11:11:11,037 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.97it/s]
2025-03-13 11:11:11,064 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 11:11:11,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:11:11,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:11
2025-03-13 11:11:11,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:11,064 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:11:11,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:11,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:11,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:11
2025-03-13 11:11:11,064 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:11,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:11:11,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:11
2025-03-13 11:11:11,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:11,065 [INFO]: 	Creating the index 03/13/2025, 11:11:11
2025-03-13 11:11:11,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:11
2025-03-13 11:11:11,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:11:11,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:11
2025-03-13 11:11:11,066 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:11:11,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.03it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.30it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.94it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.98it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.11it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.04it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.00it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.97it/s]100%|██████████| 9/9 [00:02<00:00,  1.48it/s]100%|██████████| 9/9 [00:02<00:00,  3.10it/s]
2025-03-13 11:11:13,976 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:13
2025-03-13 11:11:42,287 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3103 secs
2025-03-13 11:11:42,287 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 11:11:42,287 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 11:11:55,025 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7383 secs
2025-03-13 11:11:55,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9610 secs
2025-03-13 11:11:55,027 [INFO]: {
2025-03-13 11:11:55,027 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:55,027 [INFO]: 	index_param: efSearch=323
2025-03-13 11:11:55,027 [INFO]: 	index_path: knn.index
2025-03-13 11:11:55,027 [INFO]: 	size in bytes: 432443230
2025-03-13 11:11:55,027 [INFO]: 	avg_search_speed_ms: 12.25204382938625
2025-03-13 11:11:55,027 [INFO]: 	99p_search_speed_ms: 20.585281716194007
2025-03-13 11:11:55,027 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:55,027 [INFO]: 	nb vectors: 2198
2025-03-13 11:11:55,027 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:55,027 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 11:11:55,027 [INFO]: }
2025-03-13 11:11:55,027 [INFO]: 	>>> Finished "Creating the index" in 43.9627 secs
2025-03-13 11:11:55,027 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9906 secs
2025-03-13 11:11:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 27178 [episode count 6/20]
[retrieval_preprocessing] for episode 28214 [episode count 7/20], we have num_retrieval=np.int64(2173) num_query=np.int64(116)
2025-03-13 11:11:56,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:56,983 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:56
2025-03-13 11:11:56,983 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.56it/s]
2025-03-13 11:11:57,007 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 11:11:57,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 11:11:57,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:57
2025-03-13 11:11:57,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:57,007 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:11:57,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:57,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:57,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:57
2025-03-13 11:11:57,007 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:57,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:57,007 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:57
2025-03-13 11:11:57,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:57,007 [INFO]: 	Creating the index 03/13/2025, 11:11:57
2025-03-13 11:11:57,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:57
2025-03-13 11:11:57,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:11:57,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:57
2025-03-13 11:11:57,008 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:11:57,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.04it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.55it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.69it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.37it/s]100%|██████████| 9/9 [00:02<00:00,  2.86it/s]100%|██████████| 9/9 [00:02<00:00,  4.04it/s]
2025-03-13 11:11:59,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:59
2025-03-13 11:12:30,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7843 secs
2025-03-13 11:12:30,023 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:12:30,023 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s]
2025-03-13 11:12:42,290 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2672 secs
2025-03-13 11:12:42,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2836 secs
2025-03-13 11:12:42,292 [INFO]: {
2025-03-13 11:12:42,292 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:42,292 [INFO]: 	index_param: efSearch=299
2025-03-13 11:12:42,292 [INFO]: 	index_path: knn.index
2025-03-13 11:12:42,292 [INFO]: 	size in bytes: 427524550
2025-03-13 11:12:42,292 [INFO]: 	avg_search_speed_ms: 10.124817433783988
2025-03-13 11:12:42,292 [INFO]: 	99p_search_speed_ms: 20.698647077661008
2025-03-13 11:12:42,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:42,292 [INFO]: 	nb vectors: 2173
2025-03-13 11:12:42,292 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:42,292 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 11:12:42,292 [INFO]: }
2025-03-13 11:12:42,292 [INFO]: 	>>> Finished "Creating the index" in 45.2849 secs
2025-03-13 11:12:42,292 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3088 secs
2025-03-13 11:12:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 28214 [episode count 7/20]
[retrieval_preprocessing] for episode 63547 [episode count 8/20], we have num_retrieval=np.int64(2204) num_query=np.int64(85)
2025-03-13 11:12:44,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:44,833 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:44
2025-03-13 11:12:44,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.20it/s]
2025-03-13 11:12:44,856 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 11:12:44,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:12:44,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:44
2025-03-13 11:12:44,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:44,856 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:12:44,856 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:44,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:44,857 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:44
2025-03-13 11:12:44,857 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:44,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:44,857 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:44
2025-03-13 11:12:44,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:44,857 [INFO]: 	Creating the index 03/13/2025, 11:12:44
2025-03-13 11:12:44,857 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:44
2025-03-13 11:12:44,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:12:44,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:44
2025-03-13 11:12:44,858 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:44,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.85it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.30it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.62it/s]100%|██████████| 9/9 [00:02<00:00,  2.52it/s]100%|██████████| 9/9 [00:02<00:00,  3.66it/s]
2025-03-13 11:12:47,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:47
2025-03-13 11:13:14,691 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3654 secs
2025-03-13 11:13:14,691 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 11:13:14,691 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 50%|█████     | 2/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 11:13:28,212 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5215 secs
2025-03-13 11:13:28,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3563 secs
2025-03-13 11:13:28,214 [INFO]: {
2025-03-13 11:13:28,214 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:28,214 [INFO]: 	index_param: efSearch=304
2025-03-13 11:13:28,214 [INFO]: 	index_path: knn.index
2025-03-13 11:13:28,214 [INFO]: 	size in bytes: 433623670
2025-03-13 11:13:28,214 [INFO]: 	avg_search_speed_ms: 10.937822690993727
2025-03-13 11:13:28,214 [INFO]: 	99p_search_speed_ms: 14.95381334098056
2025-03-13 11:13:28,214 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:28,214 [INFO]: 	nb vectors: 2204
2025-03-13 11:13:28,214 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:28,214 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 11:13:28,214 [INFO]: }
2025-03-13 11:13:28,214 [INFO]: 	>>> Finished "Creating the index" in 43.3576 secs
2025-03-13 11:13:28,214 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3815 secs
2025-03-13 11:13:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 63547 [episode count 8/20]
[retrieval_preprocessing] for episode 70721 [episode count 9/20], we have num_retrieval=np.int64(2151) num_query=np.int64(138)
2025-03-13 11:13:29,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:30,271 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:30
2025-03-13 11:13:30,271 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2186.81it/s]
2025-03-13 11:13:30,294 [INFO]: There are 2151 embeddings of dim 49152
2025-03-13 11:13:30,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:13:30,295 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:30
2025-03-13 11:13:30,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:30,295 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:13:30,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:30,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:13:30,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:30
2025-03-13 11:13:30,295 [INFO]: 443.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:30,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:30,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:30
2025-03-13 11:13:30,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:30,295 [INFO]: 	Creating the index 03/13/2025, 11:13:30
2025-03-13 11:13:30,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:30
2025-03-13 11:13:30,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:13:30,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:30
2025-03-13 11:13:30,296 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:13:30,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.13it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.15it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.63it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.35it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]100%|██████████| 9/9 [00:02<00:00,  4.49it/s]
2025-03-13 11:13:32,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:32
2025-03-13 11:13:58,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6722 secs
2025-03-13 11:13:58,975 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 11:13:58,975 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s]
2025-03-13 11:14:11,530 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5552 secs
2025-03-13 11:14:11,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2359 secs
2025-03-13 11:14:11,532 [INFO]: {
2025-03-13 11:14:11,532 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:11,532 [INFO]: 	index_param: efSearch=303
2025-03-13 11:14:11,532 [INFO]: 	index_path: knn.index
2025-03-13 11:14:11,532 [INFO]: 	size in bytes: 423196150
2025-03-13 11:14:11,532 [INFO]: 	avg_search_speed_ms: 10.461096496712884
2025-03-13 11:14:11,532 [INFO]: 	99p_search_speed_ms: 14.39834156772122
2025-03-13 11:14:11,532 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:11,532 [INFO]: 	nb vectors: 2151
2025-03-13 11:14:11,532 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:11,533 [INFO]: 	compression ratio: 0.9993092044906363
2025-03-13 11:14:11,533 [INFO]: }
2025-03-13 11:14:11,533 [INFO]: 	>>> Finished "Creating the index" in 41.2372 secs
2025-03-13 11:14:11,533 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2611 secs
2025-03-13 11:14:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 70721 [episode count 9/20]
[retrieval_preprocessing] for episode 11332 [episode count 10/20], we have num_retrieval=np.int64(2178) num_query=np.int64(111)
2025-03-13 11:14:13,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:14,112 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:14
2025-03-13 11:14:14,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2017.46it/s]
2025-03-13 11:14:14,138 [INFO]: There are 2178 embeddings of dim 49152
2025-03-13 11:14:14,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:14:14,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:14
2025-03-13 11:14:14,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:14,139 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:14:14,139 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:14,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:14:14,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:14
2025-03-13 11:14:14,140 [INFO]: 449.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:14,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:14:14,140 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:14
2025-03-13 11:14:14,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:14,140 [INFO]: 	Creating the index 03/13/2025, 11:14:14
2025-03-13 11:14:14,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:14
2025-03-13 11:14:14,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:14:14,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:14
2025-03-13 11:14:14,144 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:14:14,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.72it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.15it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.77it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.12it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.44it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.51it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.56it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.59it/s]100%|██████████| 9/9 [00:02<00:00,  1.84it/s]100%|██████████| 9/9 [00:02<00:00,  3.65it/s]
2025-03-13 11:14:16,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:16
2025-03-13 11:14:44,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2308 secs
2025-03-13 11:14:44,842 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 11:14:44,842 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-13 11:14:57,661 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8180 secs
2025-03-13 11:14:57,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5190 secs
2025-03-13 11:14:57,663 [INFO]: {
2025-03-13 11:14:57,663 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:57,663 [INFO]: 	index_param: efSearch=297
2025-03-13 11:14:57,663 [INFO]: 	index_path: knn.index
2025-03-13 11:14:57,663 [INFO]: 	size in bytes: 428508310
2025-03-13 11:14:57,663 [INFO]: 	avg_search_speed_ms: 9.473269193249783
2025-03-13 11:14:57,663 [INFO]: 	99p_search_speed_ms: 13.897085306234658
2025-03-13 11:14:57,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:57,663 [INFO]: 	nb vectors: 2178
2025-03-13 11:14:57,663 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:57,663 [INFO]: 	compression ratio: 0.9993090309030414
2025-03-13 11:14:57,663 [INFO]: }
2025-03-13 11:14:57,663 [INFO]: 	>>> Finished "Creating the index" in 43.5228 secs
2025-03-13 11:14:57,663 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5504 secs
2025-03-13 11:14:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 11332 [episode count 10/20]
[retrieval_preprocessing] for episode 16461 [episode count 11/20], we have num_retrieval=np.int64(2187) num_query=np.int64(102)
2025-03-13 11:14:59,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:59,931 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:59
2025-03-13 11:14:59,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.76it/s]
2025-03-13 11:14:59,957 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 11:14:59,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 11:14:59,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:59
2025-03-13 11:14:59,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:59,958 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:14:59,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:59,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:59,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:59
2025-03-13 11:14:59,958 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:59,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:59,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:59
2025-03-13 11:14:59,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:59,958 [INFO]: 	Creating the index 03/13/2025, 11:14:59
2025-03-13 11:14:59,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:59
2025-03-13 11:14:59,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:14:59,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:59
2025-03-13 11:14:59,959 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:14:59,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.08it/s] 22%|██▏       | 2/9 [00:00<00:01,  4.75it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.91it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.66it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.18it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.64it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.77it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.89it/s]100%|██████████| 9/9 [00:02<00:00,  1.76it/s]100%|██████████| 9/9 [00:02<00:00,  3.32it/s]
2025-03-13 11:15:02,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:02
2025-03-13 11:15:30,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1829 secs
2025-03-13 11:15:30,860 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 11:15:30,860 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 11:15:43,991 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1307 secs
2025-03-13 11:15:43,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0330 secs
2025-03-13 11:15:43,992 [INFO]: {
2025-03-13 11:15:43,992 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:43,992 [INFO]: 	index_param: efSearch=314
2025-03-13 11:15:43,992 [INFO]: 	index_path: knn.index
2025-03-13 11:15:43,993 [INFO]: 	size in bytes: 430279030
2025-03-13 11:15:43,993 [INFO]: 	avg_search_speed_ms: 11.066163500381501
2025-03-13 11:15:43,993 [INFO]: 	99p_search_speed_ms: 15.390182135161016
2025-03-13 11:15:43,993 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:43,993 [INFO]: 	nb vectors: 2187
2025-03-13 11:15:43,993 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:43,993 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 11:15:43,993 [INFO]: }
2025-03-13 11:15:43,993 [INFO]: 	>>> Finished "Creating the index" in 44.0347 secs
2025-03-13 11:15:43,993 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0617 secs
2025-03-13 11:15:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 16461 [episode count 11/20]
[retrieval_preprocessing] for episode 91735 [episode count 12/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 11:15:45,729 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:46,073 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:46
2025-03-13 11:15:46,073 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-13 11:15:46,096 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:15:46,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:15:46,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:46
2025-03-13 11:15:46,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:46,096 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:15:46,096 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:46,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:46,097 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:46
2025-03-13 11:15:46,097 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:46,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:15:46,097 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:46
2025-03-13 11:15:46,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:46,097 [INFO]: 	Creating the index 03/13/2025, 11:15:46
2025-03-13 11:15:46,097 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:46
2025-03-13 11:15:46,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:15:46,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:46
2025-03-13 11:15:46,098 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:15:46,098 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.43it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.55it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.37it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.08it/s]100%|██████████| 9/9 [00:02<00:00,  4.28it/s]
2025-03-13 11:15:48,205 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:48
2025-03-13 11:16:17,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9452 secs
2025-03-13 11:16:17,151 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 11:16:17,151 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s]
2025-03-13 11:16:30,575 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4245 secs
2025-03-13 11:16:30,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4791 secs
2025-03-13 11:16:30,577 [INFO]: {
2025-03-13 11:16:30,577 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:30,577 [INFO]: 	index_param: efSearch=306
2025-03-13 11:16:30,577 [INFO]: 	index_path: knn.index
2025-03-13 11:16:30,577 [INFO]: 	size in bytes: 429295270
2025-03-13 11:16:30,577 [INFO]: 	avg_search_speed_ms: 10.314204846748833
2025-03-13 11:16:30,577 [INFO]: 	99p_search_speed_ms: 13.948146631009875
2025-03-13 11:16:30,577 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:30,577 [INFO]: 	nb vectors: 2182
2025-03-13 11:16:30,577 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:30,577 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:16:30,577 [INFO]: }
2025-03-13 11:16:30,578 [INFO]: 	>>> Finished "Creating the index" in 44.4806 secs
2025-03-13 11:16:30,578 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5047 secs
2025-03-13 11:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 91735 [episode count 12/20]
[retrieval_preprocessing] for episode 30316 [episode count 13/20], we have num_retrieval=np.int64(2143) num_query=np.int64(146)
2025-03-13 11:16:32,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:32,884 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:32
2025-03-13 11:16:32,884 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.56it/s]
2025-03-13 11:16:32,906 [INFO]: There are 2143 embeddings of dim 49152
2025-03-13 11:16:32,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 11:16:32,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:32
2025-03-13 11:16:32,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:32,906 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:16:32,906 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:32,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:32,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:32
2025-03-13 11:16:32,907 [INFO]: 442.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:32,907 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:32,907 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:32
2025-03-13 11:16:32,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:32,907 [INFO]: 	Creating the index 03/13/2025, 11:16:32
2025-03-13 11:16:32,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:32
2025-03-13 11:16:32,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:16:32,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:32
2025-03-13 11:16:32,908 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:16:32,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.19it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.61it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.99it/s]100%|██████████| 9/9 [00:02<00:00,  2.99it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 11:16:35,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:35
2025-03-13 11:17:00,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0592 secs
2025-03-13 11:17:00,124 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 11:17:00,124 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-13 11:17:12,485 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3612 secs
2025-03-13 11:17:12,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5788 secs
2025-03-13 11:17:12,487 [INFO]: {
2025-03-13 11:17:12,487 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:12,487 [INFO]: 	index_param: efSearch=248
2025-03-13 11:17:12,487 [INFO]: 	index_path: knn.index
2025-03-13 11:17:12,487 [INFO]: 	size in bytes: 421622230
2025-03-13 11:17:12,487 [INFO]: 	avg_search_speed_ms: 9.744398778333505
2025-03-13 11:17:12,487 [INFO]: 	99p_search_speed_ms: 18.564831931144
2025-03-13 11:17:12,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:12,487 [INFO]: 	nb vectors: 2143
2025-03-13 11:17:12,487 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:12,487 [INFO]: 	compression ratio: 0.9993091303558638
2025-03-13 11:17:12,487 [INFO]: }
2025-03-13 11:17:12,487 [INFO]: 	>>> Finished "Creating the index" in 39.5805 secs
2025-03-13 11:17:12,487 [INFO]: >>> Finished "Launching the whole pipeline" in 39.6034 secs
2025-03-13 11:17:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 30316 [episode count 13/20]
[retrieval_preprocessing] for episode 18545 [episode count 14/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 11:17:14,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:15,004 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:15
2025-03-13 11:17:15,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.64it/s]
2025-03-13 11:17:15,032 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:17:15,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:17:15,033 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:15
2025-03-13 11:17:15,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:15,034 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:17:15,034 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:15,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:17:15,034 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:15
2025-03-13 11:17:15,034 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:15,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:17:15,035 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:15
2025-03-13 11:17:15,035 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:15,035 [INFO]: 	Creating the index 03/13/2025, 11:17:15
2025-03-13 11:17:15,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:15
2025-03-13 11:17:15,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:17:15,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:15
2025-03-13 11:17:15,039 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:17:15,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.36it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.29it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.34it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.34it/s]100%|██████████| 9/9 [00:02<00:00,  2.24it/s]100%|██████████| 9/9 [00:02<00:00,  3.28it/s]
2025-03-13 11:17:17,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:17
2025-03-13 11:17:47,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0280 secs
2025-03-13 11:17:47,816 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 11:17:47,816 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 11:18:00,702 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8854 secs
2025-03-13 11:18:00,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6648 secs
2025-03-13 11:18:00,704 [INFO]: {
2025-03-13 11:18:00,704 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:00,704 [INFO]: 	index_param: efSearch=317
2025-03-13 11:18:00,704 [INFO]: 	index_path: knn.index
2025-03-13 11:18:00,704 [INFO]: 	size in bytes: 429295270
2025-03-13 11:18:00,704 [INFO]: 	avg_search_speed_ms: 11.083763505243375
2025-03-13 11:18:00,704 [INFO]: 	99p_search_speed_ms: 15.855613830499353
2025-03-13 11:18:00,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:00,704 [INFO]: 	nb vectors: 2182
2025-03-13 11:18:00,704 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:00,704 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:18:00,704 [INFO]: }
2025-03-13 11:18:00,704 [INFO]: 	>>> Finished "Creating the index" in 45.6683 secs
2025-03-13 11:18:00,704 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6996 secs
2025-03-13 11:18:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 18545 [episode count 14/20]
[retrieval_preprocessing] for episode 58490 [episode count 15/20], we have num_retrieval=np.int64(2202) num_query=np.int64(87)
2025-03-13 11:18:02,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:03,002 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:03
2025-03-13 11:18:03,003 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.98it/s]
2025-03-13 11:18:03,026 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 11:18:03,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 11:18:03,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:03
2025-03-13 11:18:03,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:03,026 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:18:03,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:03,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:03,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:03
2025-03-13 11:18:03,027 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:03,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:18:03,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:03
2025-03-13 11:18:03,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:03,027 [INFO]: 	Creating the index 03/13/2025, 11:18:03
2025-03-13 11:18:03,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:03
2025-03-13 11:18:03,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:18:03,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:03
2025-03-13 11:18:03,028 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:18:03,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.50it/s] 22%|██▏       | 2/9 [00:00<00:00,  8.14it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.39it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.87it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.09it/s]100%|██████████| 9/9 [00:02<00:00,  4.25it/s]
2025-03-13 11:18:05,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:05
2025-03-13 11:18:29,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4494 secs
2025-03-13 11:18:29,598 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:18:29,598 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 11:18:42,274 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6758 secs
2025-03-13 11:18:42,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2472 secs
2025-03-13 11:18:42,276 [INFO]: {
2025-03-13 11:18:42,276 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:42,276 [INFO]: 	index_param: efSearch=279
2025-03-13 11:18:42,276 [INFO]: 	index_path: knn.index
2025-03-13 11:18:42,276 [INFO]: 	size in bytes: 433230190
2025-03-13 11:18:42,276 [INFO]: 	avg_search_speed_ms: 10.162073025447732
2025-03-13 11:18:42,276 [INFO]: 	99p_search_speed_ms: 16.26150568248704
2025-03-13 11:18:42,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:42,276 [INFO]: 	nb vectors: 2202
2025-03-13 11:18:42,276 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:42,276 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 11:18:42,276 [INFO]: }
2025-03-13 11:18:42,276 [INFO]: 	>>> Finished "Creating the index" in 39.2486 secs
2025-03-13 11:18:42,276 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2733 secs
2025-03-13 11:18:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 58490 [episode count 15/20]
[retrieval_preprocessing] for episode 86649 [episode count 16/20], we have num_retrieval=np.int64(2137) num_query=np.int64(152)
2025-03-13 11:18:43,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:44,225 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:44
2025-03-13 11:18:44,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.07it/s]
2025-03-13 11:18:44,247 [INFO]: There are 2137 embeddings of dim 49152
2025-03-13 11:18:44,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 11:18:44,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:44,248 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:18:44,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:44,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:44,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,248 [INFO]: 441.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:44,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:18:44,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:44
2025-03-13 11:18:44,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:44,248 [INFO]: 	Creating the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:44
2025-03-13 11:18:44,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:18:44,249 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,249 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:18:44,249 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.00it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.57it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.19it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.25it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.18it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.39it/s]100%|██████████| 9/9 [00:02<00:00,  1.82it/s]100%|██████████| 9/9 [00:02<00:00,  3.56it/s]
2025-03-13 11:18:46,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:46
2025-03-13 11:19:17,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3158 secs
2025-03-13 11:19:17,099 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 11:19:17,099 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 11:19:31,457 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3581 secs
2025-03-13 11:19:31,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2101 secs
2025-03-13 11:19:31,459 [INFO]: {
2025-03-13 11:19:31,459 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:31,459 [INFO]: 	index_param: efSearch=248
2025-03-13 11:19:31,459 [INFO]: 	index_path: knn.index
2025-03-13 11:19:31,459 [INFO]: 	size in bytes: 420441790
2025-03-13 11:19:31,459 [INFO]: 	avg_search_speed_ms: 9.04016656620903
2025-03-13 11:19:31,459 [INFO]: 	99p_search_speed_ms: 14.814921678043907
2025-03-13 11:19:31,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:31,459 [INFO]: 	nb vectors: 2137
2025-03-13 11:19:31,459 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:31,459 [INFO]: 	compression ratio: 0.9993090743905357
2025-03-13 11:19:31,459 [INFO]: }
2025-03-13 11:19:31,459 [INFO]: 	>>> Finished "Creating the index" in 47.2114 secs
2025-03-13 11:19:31,459 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2337 secs
2025-03-13 11:19:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 86649 [episode count 16/20]
[retrieval_preprocessing] for episode 14972 [episode count 17/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 11:19:33,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:33,911 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:33
2025-03-13 11:19:33,911 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-13 11:19:33,936 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:19:33,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:19:33,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:33
2025-03-13 11:19:33,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:33,937 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:19:33,937 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:33,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:33,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:33
2025-03-13 11:19:33,937 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:33,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:33,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:33
2025-03-13 11:19:33,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:33,937 [INFO]: 	Creating the index 03/13/2025, 11:19:33
2025-03-13 11:19:33,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:33
2025-03-13 11:19:33,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:33,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:33
2025-03-13 11:19:33,938 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:19:33,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.32it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.07it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.41it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.49it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.89it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.40it/s]100%|██████████| 9/9 [00:02<00:00,  1.86it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]
2025-03-13 11:19:36,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:36
2025-03-13 11:20:03,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7853 secs
2025-03-13 11:20:03,239 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:20:03,239 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 11:20:17,855 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6158 secs
2025-03-13 11:20:17,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9185 secs
2025-03-13 11:20:17,857 [INFO]: {
2025-03-13 11:20:17,857 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:17,857 [INFO]: 	index_param: efSearch=280
2025-03-13 11:20:17,857 [INFO]: 	index_path: knn.index
2025-03-13 11:20:17,857 [INFO]: 	size in bytes: 429295270
2025-03-13 11:20:17,857 [INFO]: 	avg_search_speed_ms: 10.327298757966515
2025-03-13 11:20:17,857 [INFO]: 	99p_search_speed_ms: 15.69192478200421
2025-03-13 11:20:17,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:17,857 [INFO]: 	nb vectors: 2182
2025-03-13 11:20:17,857 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:17,857 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:20:17,857 [INFO]: }
2025-03-13 11:20:17,857 [INFO]: 	>>> Finished "Creating the index" in 43.9199 secs
2025-03-13 11:20:17,857 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9457 secs
2025-03-13 11:20:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 14972 [episode count 17/20]
[retrieval_preprocessing] for episode 78463 [episode count 18/20], we have num_retrieval=np.int64(2091) num_query=np.int64(198)
2025-03-13 11:20:20,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:20,626 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:20
2025-03-13 11:20:20,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1474.79it/s]
2025-03-13 11:20:20,649 [INFO]: There are 2091 embeddings of dim 49152
2025-03-13 11:20:20,649 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:20:20,649 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:20,649 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:20:20,649 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:20,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:20,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,650 [INFO]: 431.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:20,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:20:20,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:20
2025-03-13 11:20:20,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:20,650 [INFO]: 	Creating the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,650 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:20
2025-03-13 11:20:20,651 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:20:20,651 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,651 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:20:20,652 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.16it/s] 44%|████▍     | 4/9 [00:00<00:00, 17.09it/s] 67%|██████▋   | 6/9 [00:00<00:00, 13.57it/s] 89%|████████▉ | 8/9 [00:00<00:00, 15.19it/s]100%|██████████| 9/9 [00:01<00:00,  4.67it/s]
2025-03-13 11:20:22,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:22
2025-03-13 11:20:50,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5796 secs
2025-03-13 11:20:50,164 [INFO]: The best hyperparameters are: efSearch=311
2025-03-13 11:20:50,164 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 11:21:02,153 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9887 secs
2025-03-13 11:21:02,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5030 secs
2025-03-13 11:21:02,155 [INFO]: {
2025-03-13 11:21:02,155 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:02,155 [INFO]: 	index_param: efSearch=311
2025-03-13 11:21:02,155 [INFO]: 	index_path: knn.index
2025-03-13 11:21:02,155 [INFO]: 	size in bytes: 411391570
2025-03-13 11:21:02,155 [INFO]: 	avg_search_speed_ms: 11.558630107767407
2025-03-13 11:21:02,155 [INFO]: 	99p_search_speed_ms: 20.556043731048707
2025-03-13 11:21:02,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:02,155 [INFO]: 	nb vectors: 2091
2025-03-13 11:21:02,155 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:02,155 [INFO]: 	compression ratio: 0.99930907188983
2025-03-13 11:21:02,155 [INFO]: }
2025-03-13 11:21:02,155 [INFO]: 	>>> Finished "Creating the index" in 41.5051 secs
2025-03-13 11:21:02,155 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5291 secs
2025-03-13 11:21:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 78463 [episode count 18/20]
[retrieval_preprocessing] for episode 16011 [episode count 19/20], we have num_retrieval=np.int64(2209) num_query=np.int64(80)
2025-03-13 11:21:04,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:05,146 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:05
2025-03-13 11:21:05,146 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.98it/s]
2025-03-13 11:21:05,170 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 11:21:05,171 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:21:05,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:05
2025-03-13 11:21:05,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:05,171 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:21:05,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:05,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:21:05,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:05
2025-03-13 11:21:05,171 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:05,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:05,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:05
2025-03-13 11:21:05,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:05,171 [INFO]: 	Creating the index 03/13/2025, 11:21:05
2025-03-13 11:21:05,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:05
2025-03-13 11:21:05,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:21:05,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:05
2025-03-13 11:21:05,172 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:21:05,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.52it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.06it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.82it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.19it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.53it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.83it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.68it/s]100%|██████████| 9/9 [00:02<00:00,  2.10it/s]100%|██████████| 9/9 [00:02<00:00,  3.67it/s]
2025-03-13 11:21:07,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:07
2025-03-13 11:21:36,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1747 secs
2025-03-13 11:21:36,811 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 11:21:36,811 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-13 11:21:49,257 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4461 secs
2025-03-13 11:21:49,379 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2063 secs
2025-03-13 11:21:49,379 [INFO]: {
2025-03-13 11:21:49,379 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:49,379 [INFO]: 	index_param: efSearch=276
2025-03-13 11:21:49,379 [INFO]: 	index_path: knn.index
2025-03-13 11:21:49,379 [INFO]: 	size in bytes: 434607370
2025-03-13 11:21:49,379 [INFO]: 	avg_search_speed_ms: 9.791346491494902
2025-03-13 11:21:49,379 [INFO]: 	99p_search_speed_ms: 15.186114525422449
2025-03-13 11:21:49,379 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:49,380 [INFO]: 	nb vectors: 2209
2025-03-13 11:21:49,380 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:49,380 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 11:21:49,380 [INFO]: }
2025-03-13 11:21:49,380 [INFO]: 	>>> Finished "Creating the index" in 44.2085 secs
2025-03-13 11:21:49,380 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2337 secs
2025-03-13 11:21:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 16011 [episode count 19/20]
2025-03-13 11:21:50: [retrieval_preprocessing] finished for 4329524892_put_cup_in_bowl [chosen_id count 1/260]
2025-03-13 11:21:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4329524892_put_orange_cup_in_black_bowl [chosen_id count 2/260]
2025-03-13 11:21:52: [retrieval_preprocessing] we have num_total=2145 embedding_dim=49152
[retrieval_preprocessing] for episode 56842 [episode count 0/20], we have num_retrieval=np.int64(2024) num_query=np.int64(121)
2025-03-13 11:21:53,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:53,757 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:53
2025-03-13 11:21:53,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1777.25it/s]
2025-03-13 11:21:53,782 [INFO]: There are 2024 embeddings of dim 49152
2025-03-13 11:21:53,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:21:53,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:53
2025-03-13 11:21:53,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:53,782 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:21:53,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:53,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:53,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:53
2025-03-13 11:21:53,782 [INFO]: 417.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:53,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:21:53,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:53
2025-03-13 11:21:53,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:53,782 [INFO]: 	Creating the index 03/13/2025, 11:21:53
2025-03-13 11:21:53,783 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:53
2025-03-13 11:21:53,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:21:53,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:53
2025-03-13 11:21:53,784 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:21:53,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.79it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.51it/s] 50%|█████     | 4/8 [00:00<00:00,  8.97it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.58it/s]100%|██████████| 8/8 [00:02<00:00,  2.74it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 11:21:55,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:55
2025-03-13 11:22:21,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9229 secs
2025-03-13 11:22:21,845 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:22:21,845 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.37it/s] 50%|█████     | 2/4 [00:00<00:00,  4.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.38it/s]
2025-03-13 11:22:34,200 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3555 secs
2025-03-13 11:22:34,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4185 secs
2025-03-13 11:22:34,203 [INFO]: {
2025-03-13 11:22:34,203 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:34,203 [INFO]: 	index_param: efSearch=264
2025-03-13 11:22:34,203 [INFO]: 	index_path: knn.index
2025-03-13 11:22:34,203 [INFO]: 	size in bytes: 398209870
2025-03-13 11:22:34,203 [INFO]: 	avg_search_speed_ms: 9.928292390227304
2025-03-13 11:22:34,203 [INFO]: 	99p_search_speed_ms: 14.129534093663047
2025-03-13 11:22:34,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:34,203 [INFO]: 	nb vectors: 2024
2025-03-13 11:22:34,203 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:34,203 [INFO]: 	compression ratio: 0.9993087112582116
2025-03-13 11:22:34,203 [INFO]: }
2025-03-13 11:22:34,203 [INFO]: 	>>> Finished "Creating the index" in 40.4203 secs
2025-03-13 11:22:34,203 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4458 secs
2025-03-13 11:22:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 56842 [episode count 0/20]
[retrieval_preprocessing] for episode 52755 [episode count 1/20], we have num_retrieval=np.int64(2032) num_query=np.int64(113)
2025-03-13 11:22:35,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:36,356 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:36
2025-03-13 11:22:36,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1974.72it/s]
2025-03-13 11:22:36,387 [INFO]: There are 2032 embeddings of dim 49152
2025-03-13 11:22:36,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:22:36,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:36
2025-03-13 11:22:36,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:36,387 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:22:36,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:36,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:36,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:36
2025-03-13 11:22:36,387 [INFO]: 419.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:36,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:36,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:36
2025-03-13 11:22:36,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:36,388 [INFO]: 	Creating the index 03/13/2025, 11:22:36
2025-03-13 11:22:36,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:36
2025-03-13 11:22:36,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:22:36,389 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:36
2025-03-13 11:22:36,389 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:22:36,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.33it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.94it/s]100%|██████████| 8/8 [00:01<00:00,  4.51it/s]
2025-03-13 11:22:38,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:38
2025-03-13 11:23:09,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8077 secs
2025-03-13 11:23:09,974 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:23:09,974 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 11:23:23,914 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9401 secs
2025-03-13 11:23:23,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5274 secs
2025-03-13 11:23:23,916 [INFO]: {
2025-03-13 11:23:23,916 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:23,917 [INFO]: 	index_param: efSearch=198
2025-03-13 11:23:23,917 [INFO]: 	index_path: knn.index
2025-03-13 11:23:23,917 [INFO]: 	size in bytes: 399783790
2025-03-13 11:23:23,917 [INFO]: 	avg_search_speed_ms: 11.32439400885773
2025-03-13 11:23:23,917 [INFO]: 	99p_search_speed_ms: 15.258043711073695
2025-03-13 11:23:23,917 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:23,917 [INFO]: 	nb vectors: 2032
2025-03-13 11:23:23,917 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:23,917 [INFO]: 	compression ratio: 0.999308791384463
2025-03-13 11:23:23,917 [INFO]: }
2025-03-13 11:23:23,917 [INFO]: 	>>> Finished "Creating the index" in 47.5291 secs
2025-03-13 11:23:23,917 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5602 secs
2025-03-13 11:23:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 52755 [episode count 1/20]
[retrieval_preprocessing] for episode 64531 [episode count 2/20], we have num_retrieval=np.int64(2066) num_query=np.int64(79)
2025-03-13 11:23:25,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:26,311 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:26
2025-03-13 11:23:26,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.07it/s]
2025-03-13 11:23:26,339 [INFO]: There are 2066 embeddings of dim 49152
2025-03-13 11:23:26,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:23:26,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:26
2025-03-13 11:23:26,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:26,340 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:23:26,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:26,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:23:26,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:26
2025-03-13 11:23:26,340 [INFO]: 426.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:26,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:23:26,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:26
2025-03-13 11:23:26,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:26,341 [INFO]: 	Creating the index 03/13/2025, 11:23:26
2025-03-13 11:23:26,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:26
2025-03-13 11:23:26,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:23:26,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:26
2025-03-13 11:23:26,344 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:23:26,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.37it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.78it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.33it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.55it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.92it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.65it/s]100%|██████████| 9/9 [00:02<00:00,  2.07it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]
2025-03-13 11:23:29,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:29
2025-03-13 11:23:55,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6590 secs
2025-03-13 11:23:55,946 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 11:23:55,946 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 11:24:09,098 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1515 secs
2025-03-13 11:24:09,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7561 secs
2025-03-13 11:24:09,101 [INFO]: {
2025-03-13 11:24:09,101 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:09,101 [INFO]: 	index_param: efSearch=203
2025-03-13 11:24:09,101 [INFO]: 	index_path: knn.index
2025-03-13 11:24:09,101 [INFO]: 	size in bytes: 406473010
2025-03-13 11:24:09,101 [INFO]: 	avg_search_speed_ms: 10.44639341665535
2025-03-13 11:24:09,101 [INFO]: 	99p_search_speed_ms: 20.62607533298431
2025-03-13 11:24:09,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:09,101 [INFO]: 	nb vectors: 2066
2025-03-13 11:24:09,101 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:09,101 [INFO]: 	compression ratio: 0.9993089774890589
2025-03-13 11:24:09,101 [INFO]: }
2025-03-13 11:24:09,101 [INFO]: 	>>> Finished "Creating the index" in 42.7600 secs
2025-03-13 11:24:09,101 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7894 secs
2025-03-13 11:24:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 64531 [episode count 2/20]
[retrieval_preprocessing] for episode 15922 [episode count 3/20], we have num_retrieval=np.int64(2017) num_query=np.int64(128)
2025-03-13 11:24:09,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:10,225 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:10
2025-03-13 11:24:10,225 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-13 11:24:10,257 [INFO]: There are 2017 embeddings of dim 49152
2025-03-13 11:24:10,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 11:24:10,258 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:10
2025-03-13 11:24:10,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:10,258 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:24:10,258 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:10,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:10,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:10
2025-03-13 11:24:10,258 [INFO]: 416.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:10,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:24:10,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:10
2025-03-13 11:24:10,258 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:10,258 [INFO]: 	Creating the index 03/13/2025, 11:24:10
2025-03-13 11:24:10,258 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:10
2025-03-13 11:24:10,260 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:24:10,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:10
2025-03-13 11:24:10,260 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:24:10,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.17it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.19it/s]100%|██████████| 8/8 [00:01<00:00,  4.30it/s]
2025-03-13 11:24:12,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:12
2025-03-13 11:24:46,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7512 secs
2025-03-13 11:24:46,878 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 11:24:46,878 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 11:24:58,973 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0956 secs
2025-03-13 11:24:58,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7148 secs
2025-03-13 11:24:58,975 [INFO]: {
2025-03-13 11:24:58,975 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:58,975 [INFO]: 	index_param: efSearch=185
2025-03-13 11:24:58,975 [INFO]: 	index_path: knn.index
2025-03-13 11:24:58,975 [INFO]: 	size in bytes: 396832570
2025-03-13 11:24:58,975 [INFO]: 	avg_search_speed_ms: 8.710405677970732
2025-03-13 11:24:58,975 [INFO]: 	99p_search_speed_ms: 13.652898950967936
2025-03-13 11:24:58,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:58,976 [INFO]: 	nb vectors: 2017
2025-03-13 11:24:58,976 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:58,976 [INFO]: 	compression ratio: 0.9993089428118261
2025-03-13 11:24:58,976 [INFO]: }
2025-03-13 11:24:58,976 [INFO]: 	>>> Finished "Creating the index" in 48.7171 secs
2025-03-13 11:24:58,976 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7506 secs
2025-03-13 11:24:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 15922 [episode count 3/20]
[retrieval_preprocessing] for episode 28219 [episode count 4/20], we have num_retrieval=np.int64(2013) num_query=np.int64(132)
2025-03-13 11:25:00,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:00,500 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:00
2025-03-13 11:25:00,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.84it/s]
2025-03-13 11:25:00,533 [INFO]: There are 2013 embeddings of dim 49152
2025-03-13 11:25:00,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 11:25:00,533 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:00
2025-03-13 11:25:00,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:00,533 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:25:00,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:00,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:00,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:00
2025-03-13 11:25:00,533 [INFO]: 415.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:00,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:00,533 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:00
2025-03-13 11:25:00,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:00,534 [INFO]: 	Creating the index 03/13/2025, 11:25:00
2025-03-13 11:25:00,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:00
2025-03-13 11:25:00,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:25:00,535 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:00
2025-03-13 11:25:00,535 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:25:00,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.71it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.34it/s]100%|██████████| 8/8 [00:01<00:00,  4.90it/s]
2025-03-13 11:25:02,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:02
2025-03-13 11:25:27,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2481 secs
2025-03-13 11:25:27,419 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 11:25:27,419 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-13 11:25:39,266 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8471 secs
2025-03-13 11:25:39,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7330 secs
2025-03-13 11:25:39,268 [INFO]: {
2025-03-13 11:25:39,268 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:39,268 [INFO]: 	index_param: efSearch=224
2025-03-13 11:25:39,268 [INFO]: 	index_path: knn.index
2025-03-13 11:25:39,268 [INFO]: 	size in bytes: 396045610
2025-03-13 11:25:39,268 [INFO]: 	avg_search_speed_ms: 9.310455555772648
2025-03-13 11:25:39,268 [INFO]: 	99p_search_speed_ms: 18.90227137133479
2025-03-13 11:25:39,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:39,268 [INFO]: 	nb vectors: 2013
2025-03-13 11:25:39,268 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:39,268 [INFO]: 	compression ratio: 0.9993089028306613
2025-03-13 11:25:39,268 [INFO]: }
2025-03-13 11:25:39,268 [INFO]: 	>>> Finished "Creating the index" in 38.7344 secs
2025-03-13 11:25:39,268 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7677 secs
2025-03-13 11:25:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 28219 [episode count 4/20]
[retrieval_preprocessing] for episode 93247 [episode count 5/20], we have num_retrieval=np.int64(2009) num_query=np.int64(136)
2025-03-13 11:25:40,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:41,174 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:41
2025-03-13 11:25:41,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 11:25:41,205 [INFO]: There are 2009 embeddings of dim 49152
2025-03-13 11:25:41,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 11:25:41,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:41
2025-03-13 11:25:41,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:41,206 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:25:41,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:41,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:41,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:41
2025-03-13 11:25:41,206 [INFO]: 414.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:41,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:41,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:41
2025-03-13 11:25:41,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:41,206 [INFO]: 	Creating the index 03/13/2025, 11:25:41
2025-03-13 11:25:41,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:41
2025-03-13 11:25:41,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:25:41,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:41
2025-03-13 11:25:41,208 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:25:41,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.57it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.88it/s]100%|██████████| 8/8 [00:01<00:00,  4.82it/s]
2025-03-13 11:25:42,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:42
2025-03-13 11:26:12,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9890 secs
2025-03-13 11:26:12,861 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 11:26:12,861 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 11:26:24,361 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4996 secs
2025-03-13 11:26:24,363 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1546 secs
2025-03-13 11:26:24,363 [INFO]: {
2025-03-13 11:26:24,363 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:24,363 [INFO]: 	index_param: efSearch=195
2025-03-13 11:26:24,363 [INFO]: 	index_path: knn.index
2025-03-13 11:26:24,363 [INFO]: 	size in bytes: 395258650
2025-03-13 11:26:24,363 [INFO]: 	avg_search_speed_ms: 8.674099490309825
2025-03-13 11:26:24,363 [INFO]: 	99p_search_speed_ms: 12.952480120584369
2025-03-13 11:26:24,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:24,363 [INFO]: 	nb vectors: 2009
2025-03-13 11:26:24,363 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:24,363 [INFO]: 	compression ratio: 0.9993088626902915
2025-03-13 11:26:24,363 [INFO]: }
2025-03-13 11:26:24,363 [INFO]: 	>>> Finished "Creating the index" in 43.1564 secs
2025-03-13 11:26:24,363 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1892 secs
2025-03-13 11:26:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 93247 [episode count 5/20]
[retrieval_preprocessing] for episode 72783 [episode count 6/20], we have num_retrieval=np.int64(2035) num_query=np.int64(110)
2025-03-13 11:26:25,400 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:25,669 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:25
2025-03-13 11:26:25,669 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 11:26:25,703 [INFO]: There are 2035 embeddings of dim 49152
2025-03-13 11:26:25,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 11:26:25,703 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:25
2025-03-13 11:26:25,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:25,704 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:26:25,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:25,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:26:25,704 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:25
2025-03-13 11:26:25,704 [INFO]: 420.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:25,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:26:25,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:25
2025-03-13 11:26:25,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:25,705 [INFO]: 	Creating the index 03/13/2025, 11:26:25
2025-03-13 11:26:25,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:25
2025-03-13 11:26:25,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:26:25,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:25
2025-03-13 11:26:25,709 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:26:25,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.83it/s]100%|██████████| 9/9 [00:01<00:00,  4.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.42it/s]
2025-03-13 11:26:27,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:27
2025-03-13 11:26:49,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3637 secs
2025-03-13 11:26:49,738 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 11:26:49,738 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 11:27:01,171 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4327 secs
2025-03-13 11:27:01,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.4640 secs
2025-03-13 11:27:01,173 [INFO]: {
2025-03-13 11:27:01,173 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:01,173 [INFO]: 	index_param: efSearch=281
2025-03-13 11:27:01,173 [INFO]: 	index_path: knn.index
2025-03-13 11:27:01,173 [INFO]: 	size in bytes: 400374010
2025-03-13 11:27:01,173 [INFO]: 	avg_search_speed_ms: 11.0746542126423
2025-03-13 11:27:01,173 [INFO]: 	99p_search_speed_ms: 18.96930551622063
2025-03-13 11:27:01,173 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:01,173 [INFO]: 	nb vectors: 2035
2025-03-13 11:27:01,173 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:01,173 [INFO]: 	compression ratio: 0.9993088212693926
2025-03-13 11:27:01,173 [INFO]: }
2025-03-13 11:27:01,173 [INFO]: 	>>> Finished "Creating the index" in 35.4677 secs
2025-03-13 11:27:01,173 [INFO]: >>> Finished "Launching the whole pipeline" in 35.5041 secs
2025-03-13 11:27:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 72783 [episode count 6/20]
[retrieval_preprocessing] for episode 92254 [episode count 7/20], we have num_retrieval=np.int64(2055) num_query=np.int64(90)
2025-03-13 11:27:02,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:02,664 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:02
2025-03-13 11:27:02,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.76it/s]
2025-03-13 11:27:02,692 [INFO]: There are 2055 embeddings of dim 49152
2025-03-13 11:27:02,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:27:02,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:02
2025-03-13 11:27:02,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:02,693 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:27:02,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:02,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:27:02,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:02
2025-03-13 11:27:02,694 [INFO]: 424.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:02,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:27:02,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:02
2025-03-13 11:27:02,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:02,694 [INFO]: 	Creating the index 03/13/2025, 11:27:02
2025-03-13 11:27:02,695 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:02
2025-03-13 11:27:02,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:27:02,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:02
2025-03-13 11:27:02,698 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:27:02,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.65it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.47it/s]100%|██████████| 9/9 [00:01<00:00,  5.00it/s]
2025-03-13 11:27:04,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:04
2025-03-13 11:27:28,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3239 secs
2025-03-13 11:27:28,828 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:27:28,828 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.46it/s]
2025-03-13 11:27:40,588 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7602 secs
2025-03-13 11:27:40,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8920 secs
2025-03-13 11:27:40,590 [INFO]: {
2025-03-13 11:27:40,590 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:40,590 [INFO]: 	index_param: efSearch=194
2025-03-13 11:27:40,590 [INFO]: 	index_path: knn.index
2025-03-13 11:27:40,590 [INFO]: 	size in bytes: 404308870
2025-03-13 11:27:40,590 [INFO]: 	avg_search_speed_ms: 9.87971140524527
2025-03-13 11:27:40,590 [INFO]: 	99p_search_speed_ms: 20.03915799083188
2025-03-13 11:27:40,590 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:40,590 [INFO]: 	nb vectors: 2055
2025-03-13 11:27:40,590 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:40,590 [INFO]: 	compression ratio: 0.9993088699735923
2025-03-13 11:27:40,590 [INFO]: }
2025-03-13 11:27:40,590 [INFO]: 	>>> Finished "Creating the index" in 37.8958 secs
2025-03-13 11:27:40,590 [INFO]: >>> Finished "Launching the whole pipeline" in 37.9259 secs
2025-03-13 11:27:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 92254 [episode count 7/20]
[retrieval_preprocessing] for episode 51295 [episode count 8/20], we have num_retrieval=np.int64(2034) num_query=np.int64(111)
2025-03-13 11:27:41,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:41,647 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:41
2025-03-13 11:27:41,647 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.57it/s]
2025-03-13 11:27:41,676 [INFO]: There are 2034 embeddings of dim 49152
2025-03-13 11:27:41,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:27:41,677 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:41
2025-03-13 11:27:41,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:41,677 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:27:41,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:41,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:41,677 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:41
2025-03-13 11:27:41,677 [INFO]: 419.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:41,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:41,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:41
2025-03-13 11:27:41,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:41,677 [INFO]: 	Creating the index 03/13/2025, 11:27:41
2025-03-13 11:27:41,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:41
2025-03-13 11:27:41,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:27:41,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:41
2025-03-13 11:27:41,678 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:27:41,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.50it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.77it/s]100%|██████████| 9/9 [00:01<00:00,  4.07it/s]100%|██████████| 9/9 [00:01<00:00,  4.77it/s]
2025-03-13 11:27:43,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:43
2025-03-13 11:28:07,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1058 secs
2025-03-13 11:28:07,675 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:28:07,675 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.97it/s]
2025-03-13 11:28:23,038 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3628 secs
2025-03-13 11:28:23,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3612 secs
2025-03-13 11:28:23,039 [INFO]: {
2025-03-13 11:28:23,040 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:23,040 [INFO]: 	index_param: efSearch=280
2025-03-13 11:28:23,040 [INFO]: 	index_path: knn.index
2025-03-13 11:28:23,040 [INFO]: 	size in bytes: 400177270
2025-03-13 11:28:23,040 [INFO]: 	avg_search_speed_ms: 10.821818074995644
2025-03-13 11:28:23,040 [INFO]: 	99p_search_speed_ms: 14.09166528144851
2025-03-13 11:28:23,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:23,040 [INFO]: 	nb vectors: 2034
2025-03-13 11:28:23,040 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:23,040 [INFO]: 	compression ratio: 0.9993088113175443
2025-03-13 11:28:23,040 [INFO]: }
2025-03-13 11:28:23,040 [INFO]: 	>>> Finished "Creating the index" in 41.3625 secs
2025-03-13 11:28:23,040 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3922 secs
2025-03-13 11:28:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 51295 [episode count 8/20]
[retrieval_preprocessing] for episode 95329 [episode count 9/20], we have num_retrieval=np.int64(2054) num_query=np.int64(91)
2025-03-13 11:28:24,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:24,661 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:24
2025-03-13 11:28:24,661 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-13 11:28:24,691 [INFO]: There are 2054 embeddings of dim 49152
2025-03-13 11:28:24,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:28:24,691 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:24,691 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:28:24,691 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:24,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:24,692 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,692 [INFO]: 423.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:24,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:28:24,692 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:24
2025-03-13 11:28:24,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:24,692 [INFO]: 	Creating the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,692 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:24
2025-03-13 11:28:24,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:28:24,693 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,693 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:28:24,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.93it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.26it/s]
2025-03-13 11:28:26,406 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:26
2025-03-13 11:28:50,318 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9110 secs
2025-03-13 11:28:50,318 [INFO]: The best hyperparameters are: efSearch=312
2025-03-13 11:28:50,318 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 11:29:03,425 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1065 secs
2025-03-13 11:29:03,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7336 secs
2025-03-13 11:29:03,427 [INFO]: {
2025-03-13 11:29:03,427 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:03,427 [INFO]: 	index_param: efSearch=312
2025-03-13 11:29:03,427 [INFO]: 	index_path: knn.index
2025-03-13 11:29:03,427 [INFO]: 	size in bytes: 404112130
2025-03-13 11:29:03,427 [INFO]: 	avg_search_speed_ms: 12.329746220885568
2025-03-13 11:29:03,427 [INFO]: 	99p_search_speed_ms: 17.511601117439568
2025-03-13 11:29:03,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:03,427 [INFO]: 	nb vectors: 2054
2025-03-13 11:29:03,427 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:03,427 [INFO]: 	compression ratio: 0.999308860142357
2025-03-13 11:29:03,427 [INFO]: }
2025-03-13 11:29:03,427 [INFO]: 	>>> Finished "Creating the index" in 38.7349 secs
2025-03-13 11:29:03,427 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7657 secs
2025-03-13 11:29:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 95329 [episode count 9/20]
[retrieval_preprocessing] for episode 50787 [episode count 10/20], we have num_retrieval=np.int64(2057) num_query=np.int64(88)
2025-03-13 11:29:04,729 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:05,011 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:05
2025-03-13 11:29:05,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 11:29:05,037 [INFO]: There are 2057 embeddings of dim 49152
2025-03-13 11:29:05,037 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 11:29:05,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:05
2025-03-13 11:29:05,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:05,038 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:29:05,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:05,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:05,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:05
2025-03-13 11:29:05,038 [INFO]: 424.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:05,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:05,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:05
2025-03-13 11:29:05,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:05,038 [INFO]: 	Creating the index 03/13/2025, 11:29:05
2025-03-13 11:29:05,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:05
2025-03-13 11:29:05,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:29:05,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:05
2025-03-13 11:29:05,039 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:05,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.68it/s] 78%|███████▊  | 7/9 [00:00<00:00, 37.33it/s]100%|██████████| 9/9 [00:01<00:00,  6.05it/s]
2025-03-13 11:29:06,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:06
2025-03-13 11:29:29,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8489 secs
2025-03-13 11:29:29,378 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:29:29,378 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-13 11:29:42,371 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9920 secs
2025-03-13 11:29:42,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.3328 secs
2025-03-13 11:29:42,372 [INFO]: {
2025-03-13 11:29:42,372 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:42,372 [INFO]: 	index_param: efSearch=295
2025-03-13 11:29:42,372 [INFO]: 	index_path: knn.index
2025-03-13 11:29:42,372 [INFO]: 	size in bytes: 404702350
2025-03-13 11:29:42,372 [INFO]: 	avg_search_speed_ms: 11.165092912571188
2025-03-13 11:29:42,372 [INFO]: 	99p_search_speed_ms: 14.58052824018522
2025-03-13 11:29:42,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:42,372 [INFO]: 	nb vectors: 2057
2025-03-13 11:29:42,372 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:42,372 [INFO]: 	compression ratio: 0.9993088896073867
2025-03-13 11:29:42,372 [INFO]: }
2025-03-13 11:29:42,372 [INFO]: 	>>> Finished "Creating the index" in 37.3343 secs
2025-03-13 11:29:42,372 [INFO]: >>> Finished "Launching the whole pipeline" in 37.3614 secs
2025-03-13 11:29:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 50787 [episode count 10/20]
[retrieval_preprocessing] for episode 62565 [episode count 11/20], we have num_retrieval=np.int64(1998) num_query=np.int64(147)
2025-03-13 11:29:43,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:43,916 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:43
2025-03-13 11:29:43,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1523.54it/s]
2025-03-13 11:29:43,949 [INFO]: There are 1998 embeddings of dim 49152
2025-03-13 11:29:43,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:29:43,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:43
2025-03-13 11:29:43,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:43,950 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:29:43,950 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:43,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:29:43,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:43
2025-03-13 11:29:43,950 [INFO]: 412.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:43,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:29:43,951 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:43
2025-03-13 11:29:43,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:43,951 [INFO]: 	Creating the index 03/13/2025, 11:29:43
2025-03-13 11:29:43,951 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:43
2025-03-13 11:29:43,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:29:43,954 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:43
2025-03-13 11:29:43,954 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:43,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.89it/s]100%|██████████| 8/8 [00:01<00:00,  4.38it/s]100%|██████████| 8/8 [00:01<00:00,  4.82it/s]
2025-03-13 11:29:45,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:45
2025-03-13 11:30:09,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9260 secs
2025-03-13 11:30:09,546 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 11:30:09,546 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-13 11:30:21,201 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6548 secs
2025-03-13 11:30:21,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2485 secs
2025-03-13 11:30:21,203 [INFO]: {
2025-03-13 11:30:21,203 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:21,203 [INFO]: 	index_param: efSearch=278
2025-03-13 11:30:21,203 [INFO]: 	index_path: knn.index
2025-03-13 11:30:21,203 [INFO]: 	size in bytes: 393094450
2025-03-13 11:30:21,203 [INFO]: 	avg_search_speed_ms: 11.883311307405048
2025-03-13 11:30:21,203 [INFO]: 	99p_search_speed_ms: 19.58253105171026
2025-03-13 11:30:21,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:21,203 [INFO]: 	nb vectors: 1998
2025-03-13 11:30:21,203 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:21,203 [INFO]: 	compression ratio: 0.9993089040051316
2025-03-13 11:30:21,203 [INFO]: }
2025-03-13 11:30:21,203 [INFO]: 	>>> Finished "Creating the index" in 37.2522 secs
2025-03-13 11:30:21,203 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2867 secs
2025-03-13 11:30:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 62565 [episode count 11/20]
[retrieval_preprocessing] for episode 68709 [episode count 12/20], we have num_retrieval=np.int64(2053) num_query=np.int64(92)
2025-03-13 11:30:22,890 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:23,226 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:23
2025-03-13 11:30:23,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.61it/s]
2025-03-13 11:30:23,254 [INFO]: There are 2053 embeddings of dim 49152
2025-03-13 11:30:23,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 11:30:23,254 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:23
2025-03-13 11:30:23,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:23,254 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:30:23,254 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:23,254 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:23,254 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:23
2025-03-13 11:30:23,254 [INFO]: 423.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:23,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:23,254 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:23
2025-03-13 11:30:23,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:23,254 [INFO]: 	Creating the index 03/13/2025, 11:30:23
2025-03-13 11:30:23,254 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:23
2025-03-13 11:30:23,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:23,255 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:23
2025-03-13 11:30:23,255 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:30:23,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.58it/s]100%|██████████| 9/9 [00:01<00:00,  4.62it/s]
2025-03-13 11:30:25,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:25
2025-03-13 11:30:50,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1373 secs
2025-03-13 11:30:50,347 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 11:30:50,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 11:31:02,085 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7375 secs
2025-03-13 11:31:02,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8308 secs
2025-03-13 11:31:02,086 [INFO]: {
2025-03-13 11:31:02,086 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:02,086 [INFO]: 	index_param: efSearch=229
2025-03-13 11:31:02,086 [INFO]: 	index_path: knn.index
2025-03-13 11:31:02,086 [INFO]: 	size in bytes: 403915390
2025-03-13 11:31:02,087 [INFO]: 	avg_search_speed_ms: 10.005770693533123
2025-03-13 11:31:02,087 [INFO]: 	99p_search_speed_ms: 15.255679150577635
2025-03-13 11:31:02,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:02,087 [INFO]: 	nb vectors: 2053
2025-03-13 11:31:02,087 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:02,087 [INFO]: 	compression ratio: 0.9993088503015446
2025-03-13 11:31:02,087 [INFO]: }
2025-03-13 11:31:02,087 [INFO]: 	>>> Finished "Creating the index" in 38.8324 secs
2025-03-13 11:31:02,087 [INFO]: >>> Finished "Launching the whole pipeline" in 38.8602 secs
2025-03-13 11:31:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 68709 [episode count 12/20]
[retrieval_preprocessing] for episode 31339 [episode count 13/20], we have num_retrieval=np.int64(2045) num_query=np.int64(100)
2025-03-13 11:31:03,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:03,644 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:03
2025-03-13 11:31:03,644 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.25it/s]
2025-03-13 11:31:03,677 [INFO]: There are 2045 embeddings of dim 49152
2025-03-13 11:31:03,677 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 11:31:03,677 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:03
2025-03-13 11:31:03,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:03,677 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:31:03,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:03,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:03,677 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:03
2025-03-13 11:31:03,677 [INFO]: 422.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:03,678 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:03,678 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:03
2025-03-13 11:31:03,678 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:03,678 [INFO]: 	Creating the index 03/13/2025, 11:31:03
2025-03-13 11:31:03,678 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:03
2025-03-13 11:31:03,679 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:31:03,679 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:03
2025-03-13 11:31:03,679 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:03,679 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.49it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.44it/s]100%|██████████| 9/9 [00:01<00:00,  4.76it/s]100%|██████████| 9/9 [00:01<00:00,  5.78it/s]
2025-03-13 11:31:05,241 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:05
2025-03-13 11:31:29,145 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9037 secs
2025-03-13 11:31:29,145 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 11:31:29,145 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 11:31:41,715 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5697 secs
2025-03-13 11:31:41,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0372 secs
2025-03-13 11:31:41,716 [INFO]: {
2025-03-13 11:31:41,716 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:41,716 [INFO]: 	index_param: efSearch=250
2025-03-13 11:31:41,716 [INFO]: 	index_path: knn.index
2025-03-13 11:31:41,716 [INFO]: 	size in bytes: 402341470
2025-03-13 11:31:41,716 [INFO]: 	avg_search_speed_ms: 11.62789961956658
2025-03-13 11:31:41,716 [INFO]: 	99p_search_speed_ms: 17.087667621672143
2025-03-13 11:31:41,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:41,716 [INFO]: 	nb vectors: 2045
2025-03-13 11:31:41,716 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:41,716 [INFO]: 	compression ratio: 0.9993087712285785
2025-03-13 11:31:41,716 [INFO]: }
2025-03-13 11:31:41,716 [INFO]: 	>>> Finished "Creating the index" in 38.0388 secs
2025-03-13 11:31:41,716 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0725 secs
2025-03-13 11:31:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 31339 [episode count 13/20]
[retrieval_preprocessing] for episode 38013 [episode count 14/20], we have num_retrieval=np.int64(2028) num_query=np.int64(117)
2025-03-13 11:31:42,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:43,216 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:43
2025-03-13 11:31:43,216 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.54it/s]
2025-03-13 11:31:43,245 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 11:31:43,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 11:31:43,246 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:43
2025-03-13 11:31:43,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:43,246 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:31:43,246 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:43,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:31:43,246 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:43
2025-03-13 11:31:43,246 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:43,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:31:43,247 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:43
2025-03-13 11:31:43,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:43,247 [INFO]: 	Creating the index 03/13/2025, 11:31:43
2025-03-13 11:31:43,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:43
2025-03-13 11:31:43,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:31:43,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:43
2025-03-13 11:31:43,251 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:43,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.88it/s]100%|██████████| 8/8 [00:01<00:00,  5.10it/s]100%|██████████| 8/8 [00:01<00:00,  5.60it/s]
2025-03-13 11:31:44,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:44
2025-03-13 11:32:09,941 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2556 secs
2025-03-13 11:32:09,942 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:32:09,942 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.75it/s]
2025-03-13 11:32:27,384 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4425 secs
2025-03-13 11:32:27,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1353 secs
2025-03-13 11:32:27,386 [INFO]: {
2025-03-13 11:32:27,386 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:27,386 [INFO]: 	index_param: efSearch=238
2025-03-13 11:32:27,386 [INFO]: 	index_path: knn.index
2025-03-13 11:32:27,386 [INFO]: 	size in bytes: 398996830
2025-03-13 11:32:27,386 [INFO]: 	avg_search_speed_ms: 9.999730969080701
2025-03-13 11:32:27,386 [INFO]: 	99p_search_speed_ms: 13.740694220177827
2025-03-13 11:32:27,386 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:27,386 [INFO]: 	nb vectors: 2028
2025-03-13 11:32:27,386 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:27,386 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 11:32:27,386 [INFO]: }
2025-03-13 11:32:27,386 [INFO]: 	>>> Finished "Creating the index" in 44.1389 secs
2025-03-13 11:32:27,386 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1705 secs
2025-03-13 11:32:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 38013 [episode count 14/20]
[retrieval_preprocessing] for episode 14976 [episode count 15/20], we have num_retrieval=np.int64(2049) num_query=np.int64(96)
2025-03-13 11:32:28,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:28,962 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:28
2025-03-13 11:32:28,962 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1003.66it/s]
2025-03-13 11:32:28,993 [INFO]: There are 2049 embeddings of dim 49152
2025-03-13 11:32:28,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:32:28,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:28,993 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:32:28,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:28,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:28,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,993 [INFO]: 422.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:28,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:28,993 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:28
2025-03-13 11:32:28,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:28,993 [INFO]: 	Creating the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:28
2025-03-13 11:32:28,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:32:28,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,995 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:32:28,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.10it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.26it/s]100%|██████████| 9/9 [00:01<00:00,  4.86it/s]
2025-03-13 11:32:30,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:30
2025-03-13 11:32:57,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7475 secs
2025-03-13 11:32:57,600 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 11:32:57,600 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.52it/s]
2025-03-13 11:33:12,288 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6884 secs
2025-03-13 11:33:12,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2955 secs
2025-03-13 11:33:12,290 [INFO]: {
2025-03-13 11:33:12,290 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:12,290 [INFO]: 	index_param: efSearch=237
2025-03-13 11:33:12,290 [INFO]: 	index_path: knn.index
2025-03-13 11:33:12,290 [INFO]: 	size in bytes: 403128430
2025-03-13 11:33:12,290 [INFO]: 	avg_search_speed_ms: 10.92744150092123
2025-03-13 11:33:12,290 [INFO]: 	99p_search_speed_ms: 17.890578219667077
2025-03-13 11:33:12,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:12,290 [INFO]: 	nb vectors: 2049
2025-03-13 11:33:12,290 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:12,290 [INFO]: 	compression ratio: 0.999308810842242
2025-03-13 11:33:12,290 [INFO]: }
2025-03-13 11:33:12,290 [INFO]: 	>>> Finished "Creating the index" in 43.2969 secs
2025-03-13 11:33:12,290 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3282 secs
2025-03-13 11:33:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 14976 [episode count 15/20]
[retrieval_preprocessing] for episode 74372 [episode count 16/20], we have num_retrieval=np.int64(2063) num_query=np.int64(82)
2025-03-13 11:33:13,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:13,705 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:13
2025-03-13 11:33:13,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.10it/s]
2025-03-13 11:33:13,734 [INFO]: There are 2063 embeddings of dim 49152
2025-03-13 11:33:13,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:33:13,735 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,735 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:13,735 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:33:13,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:13,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:33:13,735 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,736 [INFO]: 425.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:13,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:33:13,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:13
2025-03-13 11:33:13,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:13,736 [INFO]: 	Creating the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:13
2025-03-13 11:33:13,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:33:13,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,740 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:13,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.27it/s]100%|██████████| 9/9 [00:01<00:00,  4.49it/s]100%|██████████| 9/9 [00:01<00:00,  4.90it/s]
2025-03-13 11:33:15,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:15
2025-03-13 11:33:41,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6288 secs
2025-03-13 11:33:41,212 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 11:33:41,212 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 11:33:53,620 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4071 secs
2025-03-13 11:33:53,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8814 secs
2025-03-13 11:33:53,621 [INFO]: {
2025-03-13 11:33:53,621 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:53,621 [INFO]: 	index_param: efSearch=296
2025-03-13 11:33:53,621 [INFO]: 	index_path: knn.index
2025-03-13 11:33:53,621 [INFO]: 	size in bytes: 405882790
2025-03-13 11:33:53,621 [INFO]: 	avg_search_speed_ms: 10.80256327508987
2025-03-13 11:33:53,621 [INFO]: 	99p_search_speed_ms: 14.480461541097611
2025-03-13 11:33:53,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:53,621 [INFO]: 	nb vectors: 2063
2025-03-13 11:33:53,621 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:53,621 [INFO]: 	compression ratio: 0.9993089482803644
2025-03-13 11:33:53,621 [INFO]: }
2025-03-13 11:33:53,621 [INFO]: 	>>> Finished "Creating the index" in 39.8849 secs
2025-03-13 11:33:53,621 [INFO]: >>> Finished "Launching the whole pipeline" in 39.9168 secs
2025-03-13 11:33:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 74372 [episode count 16/20]
[retrieval_preprocessing] for episode 39573 [episode count 17/20], we have num_retrieval=np.int64(2056) num_query=np.int64(89)
2025-03-13 11:33:54,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:54,868 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:54
2025-03-13 11:33:54,868 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-13 11:33:54,897 [INFO]: There are 2056 embeddings of dim 49152
2025-03-13 11:33:54,897 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 11:33:54,897 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:54,897 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:33:54,897 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:54,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:54,897 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,897 [INFO]: 424.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:54,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:33:54,897 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:54
2025-03-13 11:33:54,897 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:54,897 [INFO]: 	Creating the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,897 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:54
2025-03-13 11:33:54,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:33:54,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,899 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:54,899 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.88it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.62it/s]100%|██████████| 9/9 [00:01<00:00,  5.18it/s]
2025-03-13 11:33:56,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:56
2025-03-13 11:34:20,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2126 secs
2025-03-13 11:34:20,853 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 11:34:20,853 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 11:34:32,616 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7633 secs
2025-03-13 11:34:32,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.7193 secs
2025-03-13 11:34:32,618 [INFO]: {
2025-03-13 11:34:32,618 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:32,618 [INFO]: 	index_param: efSearch=259
2025-03-13 11:34:32,618 [INFO]: 	index_path: knn.index
2025-03-13 11:34:32,618 [INFO]: 	size in bytes: 404505610
2025-03-13 11:34:32,618 [INFO]: 	avg_search_speed_ms: 10.13082873171503
2025-03-13 11:34:32,618 [INFO]: 	99p_search_speed_ms: 14.076704410836099
2025-03-13 11:34:32,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:32,618 [INFO]: 	nb vectors: 2056
2025-03-13 11:34:32,618 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:32,618 [INFO]: 	compression ratio: 0.9993088797952642
2025-03-13 11:34:32,618 [INFO]: }
2025-03-13 11:34:32,618 [INFO]: 	>>> Finished "Creating the index" in 37.7206 secs
2025-03-13 11:34:32,618 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7498 secs
2025-03-13 11:34:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 39573 [episode count 17/20]
[retrieval_preprocessing] for episode 94362 [episode count 18/20], we have num_retrieval=np.int64(2043) num_query=np.int64(102)
2025-03-13 11:34:33,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:34,052 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:34
2025-03-13 11:34:34,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1279.53it/s]
2025-03-13 11:34:34,090 [INFO]: There are 2043 embeddings of dim 49152
2025-03-13 11:34:34,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 11:34:34,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:34,090 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:34:34,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:34,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:34:34,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,091 [INFO]: 421.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:34,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:34:34,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:34
2025-03-13 11:34:34,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:34,091 [INFO]: 	Creating the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,091 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:34
2025-03-13 11:34:34,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:34:34,093 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,093 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:34,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.04it/s]100%|██████████| 9/9 [00:01<00:00,  5.41it/s]
2025-03-13 11:34:35,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:35
2025-03-13 11:34:59,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0293 secs
2025-03-13 11:34:59,791 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:34:59,791 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.09it/s]
2025-03-13 11:35:15,547 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7559 secs
2025-03-13 11:35:15,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.4560 secs
2025-03-13 11:35:15,549 [INFO]: {
2025-03-13 11:35:15,549 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:15,549 [INFO]: 	index_param: efSearch=264
2025-03-13 11:35:15,549 [INFO]: 	index_path: knn.index
2025-03-13 11:35:15,549 [INFO]: 	size in bytes: 401947990
2025-03-13 11:35:15,549 [INFO]: 	avg_search_speed_ms: 11.426922066669379
2025-03-13 11:35:15,549 [INFO]: 	99p_search_speed_ms: 16.546820481307805
2025-03-13 11:35:15,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:15,549 [INFO]: 	nb vectors: 2043
2025-03-13 11:35:15,549 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:15,549 [INFO]: 	compression ratio: 0.9993087513635781
2025-03-13 11:35:15,549 [INFO]: }
2025-03-13 11:35:15,549 [INFO]: 	>>> Finished "Creating the index" in 41.4580 secs
2025-03-13 11:35:15,549 [INFO]: >>> Finished "Launching the whole pipeline" in 41.4967 secs
2025-03-13 11:35:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 94362 [episode count 18/20]
[retrieval_preprocessing] for episode 62630 [episode count 19/20], we have num_retrieval=np.int64(2024) num_query=np.int64(121)
2025-03-13 11:35:17,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:17,993 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:17
2025-03-13 11:35:17,993 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2029.17it/s]
2025-03-13 11:35:18,024 [INFO]: There are 2024 embeddings of dim 49152
2025-03-13 11:35:18,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 11:35:18,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:18
2025-03-13 11:35:18,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:18,025 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:35:18,025 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:18,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:35:18,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:18
2025-03-13 11:35:18,026 [INFO]: 417.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:18,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:35:18,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:18
2025-03-13 11:35:18,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:18,026 [INFO]: 	Creating the index 03/13/2025, 11:35:18
2025-03-13 11:35:18,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:18
2025-03-13 11:35:18,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:35:18,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:18
2025-03-13 11:35:18,030 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:35:18,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.81it/s]100%|██████████| 8/8 [00:01<00:00,  4.80it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]
2025-03-13 11:35:19,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:19
2025-03-13 11:35:43,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0572 secs
2025-03-13 11:35:43,665 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:35:43,665 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.94it/s]
2025-03-13 11:35:55,995 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3292 secs
2025-03-13 11:35:55,996 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.9659 secs
2025-03-13 11:35:55,996 [INFO]: {
2025-03-13 11:35:55,996 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:55,996 [INFO]: 	index_param: efSearch=294
2025-03-13 11:35:55,996 [INFO]: 	index_path: knn.index
2025-03-13 11:35:55,996 [INFO]: 	size in bytes: 398209870
2025-03-13 11:35:55,996 [INFO]: 	avg_search_speed_ms: 11.026142081379266
2025-03-13 11:35:55,997 [INFO]: 	99p_search_speed_ms: 15.230305297300218
2025-03-13 11:35:55,997 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:55,997 [INFO]: 	nb vectors: 2024
2025-03-13 11:35:55,997 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:55,997 [INFO]: 	compression ratio: 0.9993087112582116
2025-03-13 11:35:55,997 [INFO]: }
2025-03-13 11:35:55,997 [INFO]: 	>>> Finished "Creating the index" in 37.9700 secs
2025-03-13 11:35:55,997 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0037 secs
2025-03-13 11:35:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 62630 [episode count 19/20]
2025-03-13 11:35:57: [retrieval_preprocessing] finished for 4329524892_put_orange_cup_in_black_bowl [chosen_id count 2/260]
2025-03-13 11:35:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_put_lid_on_pot [chosen_id count 3/260]
2025-03-13 11:35:58: [retrieval_preprocessing] we have num_total=4197 embedding_dim=49152
[retrieval_preprocessing] for episode 20992 [episode count 0/20], we have num_retrieval=np.int64(4003) num_query=np.int64(194)
2025-03-13 11:35:59,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:00,199 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:00
2025-03-13 11:36:00,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.67it/s]
2025-03-13 11:36:00,225 [INFO]: There are 4003 embeddings of dim 49152
2025-03-13 11:36:00,226 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:36:00,226 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:00
2025-03-13 11:36:00,226 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:00,226 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:36:00,226 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:00,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:36:00,226 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:00
2025-03-13 11:36:00,227 [INFO]: 826.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:00,227 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:36:00,227 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:00
2025-03-13 11:36:00,227 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:00,228 [INFO]: 	Creating the index 03/13/2025, 11:36:00
2025-03-13 11:36:00,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:00
2025-03-13 11:36:00,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:36:00,231 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:00
2025-03-13 11:36:00,231 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:36:00,231 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.14it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.02it/s] 38%|███▊      | 6/16 [00:00<00:00, 14.75it/s] 69%|██████▉   | 11/16 [00:00<00:00, 23.76it/s]100%|██████████| 16/16 [00:03<00:00,  3.82it/s]100%|██████████| 16/16 [00:03<00:00,  4.97it/s]
2025-03-13 11:36:03,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:03
2025-03-13 11:36:45,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3287 secs
2025-03-13 11:36:45,791 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:36:45,791 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.14it/s]
2025-03-13 11:37:00,022 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2311 secs
2025-03-13 11:37:00,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7944 secs
2025-03-13 11:37:00,025 [INFO]: {
2025-03-13 11:37:00,025 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:00,025 [INFO]: 	index_param: efSearch=256
2025-03-13 11:37:00,025 [INFO]: 	index_path: knn.index
2025-03-13 11:37:00,025 [INFO]: 	size in bytes: 787566370
2025-03-13 11:37:00,025 [INFO]: 	avg_search_speed_ms: 9.10378082079443
2025-03-13 11:37:00,025 [INFO]: 	99p_search_speed_ms: 12.042958394158632
2025-03-13 11:37:00,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:00,025 [INFO]: 	nb vectors: 4003
2025-03-13 11:37:00,026 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:00,026 [INFO]: 	compression ratio: 0.9993085712890458
2025-03-13 11:37:00,026 [INFO]: }
2025-03-13 11:37:00,026 [INFO]: 	>>> Finished "Creating the index" in 59.7978 secs
2025-03-13 11:37:00,026 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8260 secs
2025-03-13 11:37:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 20992 [episode count 0/20]
[retrieval_preprocessing] for episode 38412 [episode count 1/20], we have num_retrieval=np.int64(3879) num_query=np.int64(318)
2025-03-13 11:37:02,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:02,883 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:02
2025-03-13 11:37:02,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2323.71it/s]
2025-03-13 11:37:02,908 [INFO]: There are 3879 embeddings of dim 49152
2025-03-13 11:37:02,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:37:02,909 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:02
2025-03-13 11:37:02,909 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:02,909 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 11:37:02,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:02,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:02,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:02
2025-03-13 11:37:02,909 [INFO]: 800.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:02,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:02,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:02
2025-03-13 11:37:02,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:02,909 [INFO]: 	Creating the index 03/13/2025, 11:37:02
2025-03-13 11:37:02,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:02
2025-03-13 11:37:02,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:02,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:02
2025-03-13 11:37:02,910 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:37:02,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.05it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.45it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.20it/s]100%|██████████| 16/16 [00:03<00:00,  4.63it/s]
2025-03-13 11:37:06,369 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:06
2025-03-13 11:37:47,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9315 secs
2025-03-13 11:37:47,302 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 11:37:47,302 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.94it/s]
2025-03-13 11:38:01,018 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7162 secs
2025-03-13 11:38:01,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1106 secs
2025-03-13 11:38:01,021 [INFO]: {
2025-03-13 11:38:01,021 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:01,021 [INFO]: 	index_param: efSearch=265
2025-03-13 11:38:01,021 [INFO]: 	index_path: knn.index
2025-03-13 11:38:01,021 [INFO]: 	size in bytes: 763169830
2025-03-13 11:38:01,021 [INFO]: 	avg_search_speed_ms: 10.21630339827712
2025-03-13 11:38:01,021 [INFO]: 	99p_search_speed_ms: 18.295765002258133
2025-03-13 11:38:01,021 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:01,021 [INFO]: 	nb vectors: 3879
2025-03-13 11:38:01,021 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:01,021 [INFO]: 	compression ratio: 0.9993089375663605
2025-03-13 11:38:01,021 [INFO]: }
2025-03-13 11:38:01,021 [INFO]: 	>>> Finished "Creating the index" in 58.1121 secs
2025-03-13 11:38:01,021 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1376 secs
2025-03-13 11:38:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 38412 [episode count 1/20]
[retrieval_preprocessing] for episode 1046 [episode count 2/20], we have num_retrieval=np.int64(3958) num_query=np.int64(239)
2025-03-13 11:38:04,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:05,288 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:05
2025-03-13 11:38:05,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.78it/s]
2025-03-13 11:38:05,318 [INFO]: There are 3958 embeddings of dim 49152
2025-03-13 11:38:05,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 11:38:05,318 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:05
2025-03-13 11:38:05,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:05,319 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:38:05,319 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:05,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:38:05,319 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:05
2025-03-13 11:38:05,319 [INFO]: 816.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:05,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:38:05,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:05
2025-03-13 11:38:05,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:05,320 [INFO]: 	Creating the index 03/13/2025, 11:38:05
2025-03-13 11:38:05,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:05
2025-03-13 11:38:05,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:38:05,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:05
2025-03-13 11:38:05,324 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:38:05,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.15it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.64it/s] 75%|███████▌  | 12/16 [00:00<00:00, 39.56it/s]100%|██████████| 16/16 [00:02<00:00,  3.93it/s]100%|██████████| 16/16 [00:02<00:00,  5.57it/s]
2025-03-13 11:38:08,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:08
2025-03-13 11:38:48,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7090 secs
2025-03-13 11:38:48,909 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 11:38:48,909 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-13 11:39:02,878 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9685 secs
2025-03-13 11:39:02,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5565 secs
2025-03-13 11:39:02,880 [INFO]: {
2025-03-13 11:39:02,880 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:02,880 [INFO]: 	index_param: efSearch=290
2025-03-13 11:39:02,880 [INFO]: 	index_path: knn.index
2025-03-13 11:39:02,880 [INFO]: 	size in bytes: 778712950
2025-03-13 11:39:02,880 [INFO]: 	avg_search_speed_ms: 9.598942616089264
2025-03-13 11:39:02,880 [INFO]: 	99p_search_speed_ms: 12.580173967871803
2025-03-13 11:39:02,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:02,880 [INFO]: 	nb vectors: 3958
2025-03-13 11:39:02,880 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:02,880 [INFO]: 	compression ratio: 0.999308492301303
2025-03-13 11:39:02,880 [INFO]: }
2025-03-13 11:39:02,880 [INFO]: 	>>> Finished "Creating the index" in 57.5602 secs
2025-03-13 11:39:02,880 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5921 secs
2025-03-13 11:39:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 1046 [episode count 2/20]
[retrieval_preprocessing] for episode 20005 [episode count 3/20], we have num_retrieval=np.int64(4031) num_query=np.int64(166)
2025-03-13 11:39:05,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:06,202 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:06
2025-03-13 11:39:06,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.01it/s]
2025-03-13 11:39:06,227 [INFO]: There are 4031 embeddings of dim 49152
2025-03-13 11:39:06,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:39:06,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:06
2025-03-13 11:39:06,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:06,228 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:39:06,228 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:06,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:39:06,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:06
2025-03-13 11:39:06,229 [INFO]: 831.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:06,229 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:39:06,229 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:06
2025-03-13 11:39:06,229 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:06,230 [INFO]: 	Creating the index 03/13/2025, 11:39:06
2025-03-13 11:39:06,230 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:06
2025-03-13 11:39:06,233 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:39:06,233 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:06
2025-03-13 11:39:06,233 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:39:06,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.16it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.93it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.21it/s]100%|██████████| 16/16 [00:03<00:00,  4.98it/s]
2025-03-13 11:39:09,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:09
2025-03-13 11:39:55,269 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8158 secs
2025-03-13 11:39:55,270 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 11:39:55,270 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-13 11:40:12,484 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2142 secs
2025-03-13 11:40:12,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2531 secs
2025-03-13 11:40:12,486 [INFO]: {
2025-03-13 11:40:12,486 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:12,486 [INFO]: 	index_param: efSearch=222
2025-03-13 11:40:12,486 [INFO]: 	index_path: knn.index
2025-03-13 11:40:12,486 [INFO]: 	size in bytes: 793075210
2025-03-13 11:40:12,486 [INFO]: 	avg_search_speed_ms: 8.041235165546238
2025-03-13 11:40:12,486 [INFO]: 	99p_search_speed_ms: 12.40992949111387
2025-03-13 11:40:12,486 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:12,486 [INFO]: 	nb vectors: 4031
2025-03-13 11:40:12,487 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:12,487 [INFO]: 	compression ratio: 0.9993085624249937
2025-03-13 11:40:12,487 [INFO]: }
2025-03-13 11:40:12,487 [INFO]: 	>>> Finished "Creating the index" in 66.2568 secs
2025-03-13 11:40:12,487 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2846 secs
2025-03-13 11:40:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 20005 [episode count 3/20]
[retrieval_preprocessing] for episode 37953 [episode count 4/20], we have num_retrieval=np.int64(4013) num_query=np.int64(184)
2025-03-13 11:40:14,016 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:14,546 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:14
2025-03-13 11:40:14,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2177.73it/s]
2025-03-13 11:40:14,570 [INFO]: There are 4013 embeddings of dim 49152
2025-03-13 11:40:14,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:40:14,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:14
2025-03-13 11:40:14,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:14,570 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:40:14,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:14,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:14,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:14
2025-03-13 11:40:14,570 [INFO]: 828.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:14,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:14,570 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:14
2025-03-13 11:40:14,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:14,571 [INFO]: 	Creating the index 03/13/2025, 11:40:14
2025-03-13 11:40:14,571 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:14
2025-03-13 11:40:14,572 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:40:14,572 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:14
2025-03-13 11:40:14,572 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:40:14,572 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.42it/s] 50%|█████     | 8/16 [00:00<00:00, 38.25it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.08it/s]100%|██████████| 16/16 [00:02<00:00,  5.74it/s]
2025-03-13 11:40:17,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:17
2025-03-13 11:40:54,914 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5474 secs
2025-03-13 11:40:54,914 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 11:40:54,914 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-13 11:41:09,253 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3390 secs
2025-03-13 11:41:09,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6847 secs
2025-03-13 11:41:09,257 [INFO]: {
2025-03-13 11:41:09,257 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:09,257 [INFO]: 	index_param: efSearch=273
2025-03-13 11:41:09,257 [INFO]: 	index_path: knn.index
2025-03-13 11:41:09,257 [INFO]: 	size in bytes: 789533890
2025-03-13 11:41:09,257 [INFO]: 	avg_search_speed_ms: 11.661541637083156
2025-03-13 11:41:09,257 [INFO]: 	99p_search_speed_ms: 24.44411117583497
2025-03-13 11:41:09,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:09,257 [INFO]: 	nb vectors: 4013
2025-03-13 11:41:09,257 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:09,257 [INFO]: 	compression ratio: 0.9993084704698363
2025-03-13 11:41:09,257 [INFO]: }
2025-03-13 11:41:09,257 [INFO]: 	>>> Finished "Creating the index" in 54.6863 secs
2025-03-13 11:41:09,257 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7112 secs
2025-03-13 11:41:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 37953 [episode count 4/20]
[retrieval_preprocessing] for episode 60492 [episode count 5/20], we have num_retrieval=np.int64(3956) num_query=np.int64(241)
2025-03-13 11:41:11,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:11,887 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:11
2025-03-13 11:41:11,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1562.71it/s]
2025-03-13 11:41:11,913 [INFO]: There are 3956 embeddings of dim 49152
2025-03-13 11:41:11,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:41:11,913 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:11
2025-03-13 11:41:11,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:11,913 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:41:11,913 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:11,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:11,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:11
2025-03-13 11:41:11,914 [INFO]: 816.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:11,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:11,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:11
2025-03-13 11:41:11,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:11,914 [INFO]: 	Creating the index 03/13/2025, 11:41:11
2025-03-13 11:41:11,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:11
2025-03-13 11:41:11,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:41:11,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:11
2025-03-13 11:41:11,915 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:41:11,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.45it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.84it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.34it/s]100%|██████████| 16/16 [00:03<00:00,  5.26it/s]
2025-03-13 11:41:14,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:14
2025-03-13 11:41:49,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7921 secs
2025-03-13 11:41:49,750 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 11:41:49,750 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-13 11:42:07,569 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8184 secs
2025-03-13 11:42:07,571 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6564 secs
2025-03-13 11:42:07,571 [INFO]: {
2025-03-13 11:42:07,571 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:07,571 [INFO]: 	index_param: efSearch=290
2025-03-13 11:42:07,571 [INFO]: 	index_path: knn.index
2025-03-13 11:42:07,571 [INFO]: 	size in bytes: 778319470
2025-03-13 11:42:07,571 [INFO]: 	avg_search_speed_ms: 10.381768850478133
2025-03-13 11:42:07,571 [INFO]: 	99p_search_speed_ms: 15.434353784658015
2025-03-13 11:42:07,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:07,571 [INFO]: 	nb vectors: 3956
2025-03-13 11:42:07,571 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:07,571 [INFO]: 	compression ratio: 0.9993084819013971
2025-03-13 11:42:07,571 [INFO]: }
2025-03-13 11:42:07,571 [INFO]: 	>>> Finished "Creating the index" in 55.6577 secs
2025-03-13 11:42:07,572 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6846 secs
2025-03-13 11:42:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 60492 [episode count 5/20]
[retrieval_preprocessing] for episode 54354 [episode count 6/20], we have num_retrieval=np.int64(3974) num_query=np.int64(223)
2025-03-13 11:42:10,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:10,612 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:10
2025-03-13 11:42:10,613 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.32it/s]
2025-03-13 11:42:10,642 [INFO]: There are 3974 embeddings of dim 49152
2025-03-13 11:42:10,642 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 11:42:10,643 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:10
2025-03-13 11:42:10,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:10,643 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:42:10,643 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:10,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:42:10,644 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:10
2025-03-13 11:42:10,644 [INFO]: 820.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:10,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:42:10,644 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:10
2025-03-13 11:42:10,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:10,645 [INFO]: 	Creating the index 03/13/2025, 11:42:10
2025-03-13 11:42:10,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:10
2025-03-13 11:42:10,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:42:10,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:10
2025-03-13 11:42:10,649 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:42:10,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 26.56it/s] 56%|█████▋    | 9/16 [00:00<00:00, 42.91it/s] 94%|█████████▍| 15/16 [00:00<00:00, 49.00it/s]100%|██████████| 16/16 [00:02<00:00,  5.37it/s]
2025-03-13 11:42:13,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:13
2025-03-13 11:42:52,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0545 secs
2025-03-13 11:42:52,687 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 11:42:52,688 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 11:43:09,450 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7626 secs
2025-03-13 11:43:09,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8049 secs
2025-03-13 11:43:09,454 [INFO]: {
2025-03-13 11:43:09,454 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:09,454 [INFO]: 	index_param: efSearch=321
2025-03-13 11:43:09,454 [INFO]: 	index_path: knn.index
2025-03-13 11:43:09,454 [INFO]: 	size in bytes: 781860790
2025-03-13 11:43:09,454 [INFO]: 	avg_search_speed_ms: 11.57836899990259
2025-03-13 11:43:09,454 [INFO]: 	99p_search_speed_ms: 17.260982003062963
2025-03-13 11:43:09,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:09,454 [INFO]: 	nb vectors: 3974
2025-03-13 11:43:09,454 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:09,454 [INFO]: 	compression ratio: 0.9993085751237123
2025-03-13 11:43:09,454 [INFO]: }
2025-03-13 11:43:09,454 [INFO]: 	>>> Finished "Creating the index" in 58.8091 secs
2025-03-13 11:43:09,454 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8412 secs
2025-03-13 11:43:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 54354 [episode count 6/20]
[retrieval_preprocessing] for episode 85081 [episode count 7/20], we have num_retrieval=np.int64(4000) num_query=np.int64(197)
2025-03-13 11:43:12,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:12,706 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:12
2025-03-13 11:43:12,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]
2025-03-13 11:43:12,731 [INFO]: There are 4000 embeddings of dim 49152
2025-03-13 11:43:12,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:43:12,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:12
2025-03-13 11:43:12,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:12,731 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:43:12,731 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:12,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:43:12,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:12
2025-03-13 11:43:12,732 [INFO]: 825.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:12,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:43:12,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:12
2025-03-13 11:43:12,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:12,732 [INFO]: 	Creating the index 03/13/2025, 11:43:12
2025-03-13 11:43:12,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:12
2025-03-13 11:43:12,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:12,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:12
2025-03-13 11:43:12,733 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:43:12,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.51it/s] 38%|███▊      | 6/16 [00:00<00:00, 32.46it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.38it/s]100%|██████████| 16/16 [00:03<00:00,  4.84it/s]
2025-03-13 11:43:16,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:16
2025-03-13 11:43:56,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9462 secs
2025-03-13 11:43:56,994 [INFO]: The best hyperparameters are: efSearch=310
2025-03-13 11:43:56,994 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-13 11:44:12,135 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1417 secs
2025-03-13 11:44:12,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4054 secs
2025-03-13 11:44:12,138 [INFO]: {
2025-03-13 11:44:12,138 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:12,138 [INFO]: 	index_param: efSearch=310
2025-03-13 11:44:12,139 [INFO]: 	index_path: knn.index
2025-03-13 11:44:12,139 [INFO]: 	size in bytes: 786976150
2025-03-13 11:44:12,139 [INFO]: 	avg_search_speed_ms: 12.831120789110756
2025-03-13 11:44:12,139 [INFO]: 	99p_search_speed_ms: 21.164337624795735
2025-03-13 11:44:12,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:12,139 [INFO]: 	nb vectors: 4000
2025-03-13 11:44:12,139 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:12,139 [INFO]: 	compression ratio: 0.9993085559200238
2025-03-13 11:44:12,139 [INFO]: }
2025-03-13 11:44:12,139 [INFO]: 	>>> Finished "Creating the index" in 59.4068 secs
2025-03-13 11:44:12,139 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4326 secs
2025-03-13 11:44:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 85081 [episode count 7/20]
[retrieval_preprocessing] for episode 92762 [episode count 8/20], we have num_retrieval=np.int64(3982) num_query=np.int64(215)
2025-03-13 11:44:14,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:14,597 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:14
2025-03-13 11:44:14,597 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.96it/s]
2025-03-13 11:44:14,622 [INFO]: There are 3982 embeddings of dim 49152
2025-03-13 11:44:14,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:44:14,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:14
2025-03-13 11:44:14,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:14,623 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:44:14,623 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:14,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:14,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:14
2025-03-13 11:44:14,623 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:14,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:14,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:14
2025-03-13 11:44:14,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:14,623 [INFO]: 	Creating the index 03/13/2025, 11:44:14
2025-03-13 11:44:14,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:14
2025-03-13 11:44:14,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:44:14,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:14
2025-03-13 11:44:14,624 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:44:14,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.54it/s] 50%|█████     | 8/16 [00:00<00:00, 39.44it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.93it/s]100%|██████████| 16/16 [00:02<00:00,  5.36it/s]
2025-03-13 11:44:17,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:17
2025-03-13 11:45:01,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7563 secs
2025-03-13 11:45:01,369 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 11:45:01,369 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 11:45:16,319 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9497 secs
2025-03-13 11:45:16,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6969 secs
2025-03-13 11:45:16,321 [INFO]: {
2025-03-13 11:45:16,321 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:16,321 [INFO]: 	index_param: efSearch=275
2025-03-13 11:45:16,321 [INFO]: 	index_path: knn.index
2025-03-13 11:45:16,321 [INFO]: 	size in bytes: 783434770
2025-03-13 11:45:16,321 [INFO]: 	avg_search_speed_ms: 9.589480297338158
2025-03-13 11:45:16,321 [INFO]: 	99p_search_speed_ms: 13.595925867557526
2025-03-13 11:45:16,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:16,321 [INFO]: 	nb vectors: 3982
2025-03-13 11:45:16,321 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:16,321 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-13 11:45:16,321 [INFO]: }
2025-03-13 11:45:16,321 [INFO]: 	>>> Finished "Creating the index" in 61.6984 secs
2025-03-13 11:45:16,321 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7240 secs
2025-03-13 11:45:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 92762 [episode count 8/20]
[retrieval_preprocessing] for episode 58998 [episode count 9/20], we have num_retrieval=np.int64(3982) num_query=np.int64(215)
2025-03-13 11:45:18,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:19,282 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:19
2025-03-13 11:45:19,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1885.93it/s]
2025-03-13 11:45:19,638 [INFO]: There are 3982 embeddings of dim 49152
2025-03-13 11:45:19,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3567 secs
2025-03-13 11:45:19,639 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,639 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:19,639 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:45:19,639 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:19,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:45:19,639 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,640 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:19,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:45:19,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:19
2025-03-13 11:45:19,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:19,640 [INFO]: 	Creating the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:19
2025-03-13 11:45:19,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:45:19,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,643 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:45:19,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.61it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.86it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.26it/s]100%|██████████| 16/16 [00:04<00:00,  2.81it/s]100%|██████████| 16/16 [00:04<00:00,  3.83it/s]
2025-03-13 11:45:23,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:23
2025-03-13 11:46:09,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4141 secs
2025-03-13 11:46:09,240 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 11:46:09,240 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 11:46:26,115 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8750 secs
2025-03-13 11:46:26,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4744 secs
2025-03-13 11:46:26,118 [INFO]: {
2025-03-13 11:46:26,118 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:26,118 [INFO]: 	index_param: efSearch=276
2025-03-13 11:46:26,118 [INFO]: 	index_path: knn.index
2025-03-13 11:46:26,118 [INFO]: 	size in bytes: 783434770
2025-03-13 11:46:26,118 [INFO]: 	avg_search_speed_ms: 10.940472884776165
2025-03-13 11:46:26,118 [INFO]: 	99p_search_speed_ms: 16.76449280232192
2025-03-13 11:46:26,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:26,118 [INFO]: 	nb vectors: 3982
2025-03-13 11:46:26,118 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:26,118 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-13 11:46:26,118 [INFO]: }
2025-03-13 11:46:26,118 [INFO]: 	>>> Finished "Creating the index" in 66.4779 secs
2025-03-13 11:46:26,118 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8365 secs
2025-03-13 11:46:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 58998 [episode count 9/20]
[retrieval_preprocessing] for episode 15511 [episode count 10/20], we have num_retrieval=np.int64(3961) num_query=np.int64(236)
2025-03-13 11:46:28,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:29,108 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:29
2025-03-13 11:46:29,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2168.72it/s]
2025-03-13 11:46:29,133 [INFO]: There are 3961 embeddings of dim 49152
2025-03-13 11:46:29,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 11:46:29,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:29
2025-03-13 11:46:29,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:29,133 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:46:29,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:29,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:46:29,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:29
2025-03-13 11:46:29,133 [INFO]: 817.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:29,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:46:29,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:29
2025-03-13 11:46:29,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:29,133 [INFO]: 	Creating the index 03/13/2025, 11:46:29
2025-03-13 11:46:29,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:29
2025-03-13 11:46:29,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:46:29,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:29
2025-03-13 11:46:29,134 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:46:29,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.97it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.87it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.41it/s]100%|██████████| 16/16 [00:02<00:00,  4.05it/s]100%|██████████| 16/16 [00:02<00:00,  5.52it/s]
2025-03-13 11:46:32,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:32
2025-03-13 11:47:11,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0997 secs
2025-03-13 11:47:11,133 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 11:47:11,133 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-13 11:47:27,289 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1558 secs
2025-03-13 11:47:27,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1576 secs
2025-03-13 11:47:27,292 [INFO]: {
2025-03-13 11:47:27,292 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:27,292 [INFO]: 	index_param: efSearch=307
2025-03-13 11:47:27,292 [INFO]: 	index_path: knn.index
2025-03-13 11:47:27,292 [INFO]: 	size in bytes: 779303170
2025-03-13 11:47:27,292 [INFO]: 	avg_search_speed_ms: 12.070134113036069
2025-03-13 11:47:27,292 [INFO]: 	99p_search_speed_ms: 22.611844781786207
2025-03-13 11:47:27,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:27,292 [INFO]: 	nb vectors: 3961
2025-03-13 11:47:27,292 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:27,292 [INFO]: 	compression ratio: 0.9993085078814705
2025-03-13 11:47:27,292 [INFO]: }
2025-03-13 11:47:27,292 [INFO]: 	>>> Finished "Creating the index" in 58.1589 secs
2025-03-13 11:47:27,292 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1840 secs
2025-03-13 11:47:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 15511 [episode count 10/20]
[retrieval_preprocessing] for episode 84120 [episode count 11/20], we have num_retrieval=np.int64(4000) num_query=np.int64(197)
2025-03-13 11:47:30,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:30,582 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:30
2025-03-13 11:47:30,582 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1304.20it/s]
2025-03-13 11:47:30,609 [INFO]: There are 4000 embeddings of dim 49152
2025-03-13 11:47:30,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:47:30,609 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:30
2025-03-13 11:47:30,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:30,609 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:47:30,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:30,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:30,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:30
2025-03-13 11:47:30,609 [INFO]: 825.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:30,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:30,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:30
2025-03-13 11:47:30,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:30,609 [INFO]: 	Creating the index 03/13/2025, 11:47:30
2025-03-13 11:47:30,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:30
2025-03-13 11:47:30,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:47:30,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:30
2025-03-13 11:47:30,610 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:47:30,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.66it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.23it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.85it/s]100%|██████████| 16/16 [00:02<00:00,  4.15it/s]100%|██████████| 16/16 [00:02<00:00,  5.54it/s]
2025-03-13 11:47:33,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:33
2025-03-13 11:48:15,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2520 secs
2025-03-13 11:48:15,752 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 11:48:15,752 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-13 11:48:30,695 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9421 secs
2025-03-13 11:48:30,697 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0867 secs
2025-03-13 11:48:30,697 [INFO]: {
2025-03-13 11:48:30,697 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:30,697 [INFO]: 	index_param: efSearch=257
2025-03-13 11:48:30,697 [INFO]: 	index_path: knn.index
2025-03-13 11:48:30,697 [INFO]: 	size in bytes: 786976150
2025-03-13 11:48:30,697 [INFO]: 	avg_search_speed_ms: 8.978511101467605
2025-03-13 11:48:30,697 [INFO]: 	99p_search_speed_ms: 11.552738924510775
2025-03-13 11:48:30,697 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:30,697 [INFO]: 	nb vectors: 4000
2025-03-13 11:48:30,697 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:30,697 [INFO]: 	compression ratio: 0.9993085559200238
2025-03-13 11:48:30,697 [INFO]: }
2025-03-13 11:48:30,697 [INFO]: 	>>> Finished "Creating the index" in 60.0880 secs
2025-03-13 11:48:30,697 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1148 secs
2025-03-13 11:48:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 84120 [episode count 11/20]
[retrieval_preprocessing] for episode 47793 [episode count 12/20], we have num_retrieval=np.int64(3991) num_query=np.int64(206)
2025-03-13 11:48:32,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:33,380 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:33
2025-03-13 11:48:33,381 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-13 11:48:33,408 [INFO]: There are 3991 embeddings of dim 49152
2025-03-13 11:48:33,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 11:48:33,409 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:33
2025-03-13 11:48:33,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:33,409 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:48:33,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:33,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 11:48:33,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:33
2025-03-13 11:48:33,410 [INFO]: 823.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:33,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:48:33,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:33
2025-03-13 11:48:33,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:33,411 [INFO]: 	Creating the index 03/13/2025, 11:48:33
2025-03-13 11:48:33,411 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:33
2025-03-13 11:48:33,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:48:33,414 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:33
2025-03-13 11:48:33,414 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:48:33,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.86it/s] 50%|█████     | 8/16 [00:00<00:00, 40.79it/s] 88%|████████▊ | 14/16 [00:00<00:00, 47.18it/s]100%|██████████| 16/16 [00:02<00:00,  6.02it/s]
2025-03-13 11:48:36,080 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:36
2025-03-13 11:49:14,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7929 secs
2025-03-13 11:49:14,873 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 11:49:14,874 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.11it/s]
2025-03-13 11:49:30,389 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5156 secs
2025-03-13 11:49:30,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9787 secs
2025-03-13 11:49:30,393 [INFO]: {
2025-03-13 11:49:30,393 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:30,393 [INFO]: 	index_param: efSearch=293
2025-03-13 11:49:30,393 [INFO]: 	index_path: knn.index
2025-03-13 11:49:30,393 [INFO]: 	size in bytes: 785205430
2025-03-13 11:49:30,393 [INFO]: 	avg_search_speed_ms: 12.667989587599907
2025-03-13 11:49:30,393 [INFO]: 	99p_search_speed_ms: 21.3452294562012
2025-03-13 11:49:30,393 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:30,393 [INFO]: 	nb vectors: 3991
2025-03-13 11:49:30,393 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:30,393 [INFO]: 	compression ratio: 0.9993085860346126
2025-03-13 11:49:30,393 [INFO]: }
2025-03-13 11:49:30,393 [INFO]: 	>>> Finished "Creating the index" in 56.9821 secs
2025-03-13 11:49:30,393 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0124 secs
2025-03-13 11:49:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 47793 [episode count 12/20]
[retrieval_preprocessing] for episode 42292 [episode count 13/20], we have num_retrieval=np.int64(4005) num_query=np.int64(192)
2025-03-13 11:49:33,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:34,639 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:34
2025-03-13 11:49:34,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.38it/s]
2025-03-13 11:49:34,676 [INFO]: There are 4005 embeddings of dim 49152
2025-03-13 11:49:34,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 11:49:34,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:34
2025-03-13 11:49:34,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:34,676 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:49:34,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:34,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:34,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:34
2025-03-13 11:49:34,676 [INFO]: 826.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:34,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:49:34,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:34
2025-03-13 11:49:34,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:34,676 [INFO]: 	Creating the index 03/13/2025, 11:49:34
2025-03-13 11:49:34,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:34
2025-03-13 11:49:34,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:49:34,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:34
2025-03-13 11:49:34,678 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:49:34,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.56it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.92it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.05it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.15it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.29it/s] 50%|█████     | 8/16 [00:00<00:00,  9.59it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.87it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.12it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.72it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.41it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.78it/s]100%|██████████| 16/16 [00:04<00:00,  1.16it/s]100%|██████████| 16/16 [00:04<00:00,  3.44it/s]
2025-03-13 11:49:39,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:39
2025-03-13 11:50:15,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5128 secs
2025-03-13 11:50:15,855 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 11:50:15,855 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 11:50:46,133 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2780 secs
2025-03-13 11:50:46,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4588 secs
2025-03-13 11:50:46,137 [INFO]: {
2025-03-13 11:50:46,137 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:46,137 [INFO]: 	index_param: efSearch=290
2025-03-13 11:50:46,137 [INFO]: 	index_path: knn.index
2025-03-13 11:50:46,137 [INFO]: 	size in bytes: 787959850
2025-03-13 11:50:46,137 [INFO]: 	avg_search_speed_ms: 9.541188163872993
2025-03-13 11:50:46,137 [INFO]: 	99p_search_speed_ms: 15.742380390875041
2025-03-13 11:50:46,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:46,137 [INFO]: 	nb vectors: 4005
2025-03-13 11:50:46,137 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:46,137 [INFO]: 	compression ratio: 0.9993085815222692
2025-03-13 11:50:46,137 [INFO]: }
2025-03-13 11:50:46,137 [INFO]: 	>>> Finished "Creating the index" in 71.4605 secs
2025-03-13 11:50:46,137 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4979 secs
2025-03-13 11:50:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 42292 [episode count 13/20]
[retrieval_preprocessing] for episode 31078 [episode count 14/20], we have num_retrieval=np.int64(4006) num_query=np.int64(191)
2025-03-13 11:50:48,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:49,322 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:49
2025-03-13 11:50:49,322 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.99it/s]
2025-03-13 11:50:49,354 [INFO]: There are 4006 embeddings of dim 49152
2025-03-13 11:50:49,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:50:49,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:49
2025-03-13 11:50:49,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:49,356 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:50:49,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:49,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:50:49,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:49
2025-03-13 11:50:49,356 [INFO]: 826.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:49,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:50:49,357 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:49
2025-03-13 11:50:49,357 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:49,357 [INFO]: 	Creating the index 03/13/2025, 11:50:49
2025-03-13 11:50:49,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:49
2025-03-13 11:50:49,361 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:50:49,361 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:49
2025-03-13 11:50:49,361 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:50:49,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.81it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.83it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.40it/s]100%|██████████| 16/16 [00:03<00:00,  4.30it/s]
2025-03-13 11:50:53,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:53
2025-03-13 11:51:49,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6521 secs
2025-03-13 11:51:49,746 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:51:49,746 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 11:52:07,264 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5176 secs
2025-03-13 11:52:07,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9056 secs
2025-03-13 11:52:07,267 [INFO]: {
2025-03-13 11:52:07,267 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:07,267 [INFO]: 	index_param: efSearch=204
2025-03-13 11:52:07,267 [INFO]: 	index_path: knn.index
2025-03-13 11:52:07,267 [INFO]: 	size in bytes: 788156590
2025-03-13 11:52:07,267 [INFO]: 	avg_search_speed_ms: 8.674050446039152
2025-03-13 11:52:07,267 [INFO]: 	99p_search_speed_ms: 13.320198645815255
2025-03-13 11:52:07,267 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:07,267 [INFO]: 	nb vectors: 4006
2025-03-13 11:52:07,267 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:07,267 [INFO]: 	compression ratio: 0.9993085866350493
2025-03-13 11:52:07,267 [INFO]: }
2025-03-13 11:52:07,267 [INFO]: 	>>> Finished "Creating the index" in 77.9100 secs
2025-03-13 11:52:07,267 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9452 secs
2025-03-13 11:52:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 31078 [episode count 14/20]
[retrieval_preprocessing] for episode 88437 [episode count 15/20], we have num_retrieval=np.int64(3983) num_query=np.int64(214)
2025-03-13 11:52:09,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:09,829 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:09
2025-03-13 11:52:09,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.26it/s]
2025-03-13 11:52:09,861 [INFO]: There are 3983 embeddings of dim 49152
2025-03-13 11:52:09,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:52:09,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:09
2025-03-13 11:52:09,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:09,862 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:52:09,862 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:09,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:09,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:09
2025-03-13 11:52:09,862 [INFO]: 822.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:09,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:52:09,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:09
2025-03-13 11:52:09,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:09,862 [INFO]: 	Creating the index 03/13/2025, 11:52:09
2025-03-13 11:52:09,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:09
2025-03-13 11:52:09,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:52:09,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:09
2025-03-13 11:52:09,864 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:52:09,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.67it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.04it/s] 81%|████████▏ | 13/16 [00:00<00:00, 45.77it/s]100%|██████████| 16/16 [00:02<00:00,  6.08it/s]
2025-03-13 11:52:12,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:12
2025-03-13 11:52:55,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6566 secs
2025-03-13 11:52:55,156 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 11:52:55,156 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-13 11:53:10,953 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7972 secs
2025-03-13 11:53:10,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0924 secs
2025-03-13 11:53:10,956 [INFO]: {
2025-03-13 11:53:10,956 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:10,956 [INFO]: 	index_param: efSearch=284
2025-03-13 11:53:10,956 [INFO]: 	index_path: knn.index
2025-03-13 11:53:10,956 [INFO]: 	size in bytes: 783631510
2025-03-13 11:53:10,956 [INFO]: 	avg_search_speed_ms: 10.520089126596488
2025-03-13 11:53:10,956 [INFO]: 	99p_search_speed_ms: 14.043953502550721
2025-03-13 11:53:10,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:10,956 [INFO]: 	nb vectors: 3983
2025-03-13 11:53:10,956 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:10,956 [INFO]: 	compression ratio: 0.9993085449052451
2025-03-13 11:53:10,956 [INFO]: }
2025-03-13 11:53:10,956 [INFO]: 	>>> Finished "Creating the index" in 61.0943 secs
2025-03-13 11:53:10,956 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1271 secs
2025-03-13 11:53:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 88437 [episode count 15/20]
[retrieval_preprocessing] for episode 6012 [episode count 16/20], we have num_retrieval=np.int64(4011) num_query=np.int64(186)
2025-03-13 11:53:13,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:14,474 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:14
2025-03-13 11:53:14,474 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-13 11:53:14,501 [INFO]: There are 4011 embeddings of dim 49152
2025-03-13 11:53:14,502 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:53:14,502 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:14
2025-03-13 11:53:14,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:14,502 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:53:14,502 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:14,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:14,502 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:14
2025-03-13 11:53:14,502 [INFO]: 827.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:14,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:53:14,502 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:14
2025-03-13 11:53:14,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:14,502 [INFO]: 	Creating the index 03/13/2025, 11:53:14
2025-03-13 11:53:14,502 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:14
2025-03-13 11:53:14,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:53:14,504 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:14
2025-03-13 11:53:14,504 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:53:14,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.19it/s] 31%|███▏      | 5/16 [00:00<00:00, 25.98it/s] 56%|█████▋    | 9/16 [00:00<00:00, 31.39it/s] 88%|████████▊ | 14/16 [00:00<00:00, 37.36it/s]100%|██████████| 16/16 [00:03<00:00,  5.01it/s]
2025-03-13 11:53:17,702 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:17
2025-03-13 11:53:59,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5127 secs
2025-03-13 11:53:59,215 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 11:53:59,215 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.15it/s]
2025-03-13 11:54:21,073 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8581 secs
2025-03-13 11:54:21,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5729 secs
2025-03-13 11:54:21,077 [INFO]: {
2025-03-13 11:54:21,077 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:21,077 [INFO]: 	index_param: efSearch=302
2025-03-13 11:54:21,077 [INFO]: 	index_path: knn.index
2025-03-13 11:54:21,077 [INFO]: 	size in bytes: 789140410
2025-03-13 11:54:21,077 [INFO]: 	avg_search_speed_ms: 11.786823303277469
2025-03-13 11:54:21,077 [INFO]: 	99p_search_speed_ms: 20.520169390365474
2025-03-13 11:54:21,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:21,077 [INFO]: 	nb vectors: 4011
2025-03-13 11:54:21,077 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:21,077 [INFO]: 	compression ratio: 0.9993084602016515
2025-03-13 11:54:21,077 [INFO]: }
2025-03-13 11:54:21,077 [INFO]: 	>>> Finished "Creating the index" in 66.5748 secs
2025-03-13 11:54:21,077 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6032 secs
2025-03-13 11:54:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 6012 [episode count 16/20]
[retrieval_preprocessing] for episode 17803 [episode count 17/20], we have num_retrieval=np.int64(3990) num_query=np.int64(207)
2025-03-13 11:54:24,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:25,713 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:25
2025-03-13 11:54:25,713 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1052.79it/s]
2025-03-13 11:54:25,745 [INFO]: There are 3990 embeddings of dim 49152
2025-03-13 11:54:25,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 11:54:25,746 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:25
2025-03-13 11:54:25,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:25,746 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:54:25,746 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:25,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:25,746 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:25
2025-03-13 11:54:25,746 [INFO]: 823.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:25,746 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:54:25,746 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:25
2025-03-13 11:54:25,746 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:25,746 [INFO]: 	Creating the index 03/13/2025, 11:54:25
2025-03-13 11:54:25,746 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:25
2025-03-13 11:54:25,747 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:54:25,747 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:25
2025-03-13 11:54:25,748 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:54:25,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.22it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.78it/s] 75%|███████▌  | 12/16 [00:00<00:00, 39.63it/s]100%|██████████| 16/16 [00:02<00:00,  5.67it/s]
2025-03-13 11:54:28,573 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:28
2025-03-13 11:55:07,464 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8903 secs
2025-03-13 11:55:07,464 [INFO]: The best hyperparameters are: efSearch=318
2025-03-13 11:55:07,464 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.42it/s]
2025-03-13 11:55:24,509 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0449 secs
2025-03-13 11:55:24,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0528 secs
2025-03-13 11:55:24,801 [INFO]: {
2025-03-13 11:55:24,801 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:24,801 [INFO]: 	index_param: efSearch=318
2025-03-13 11:55:24,801 [INFO]: 	index_path: knn.index
2025-03-13 11:55:24,801 [INFO]: 	size in bytes: 785008690
2025-03-13 11:55:24,801 [INFO]: 	avg_search_speed_ms: 11.504386181935617
2025-03-13 11:55:24,801 [INFO]: 	99p_search_speed_ms: 19.17581014335154
2025-03-13 11:55:24,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:24,801 [INFO]: 	nb vectors: 3990
2025-03-13 11:55:24,801 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:24,801 [INFO]: 	compression ratio: 0.9993085809024611
2025-03-13 11:55:24,801 [INFO]: }
2025-03-13 11:55:24,801 [INFO]: 	>>> Finished "Creating the index" in 59.0553 secs
2025-03-13 11:55:24,801 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0879 secs
2025-03-13 11:55:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 17803 [episode count 17/20]
[retrieval_preprocessing] for episode 56192 [episode count 18/20], we have num_retrieval=np.int64(4014) num_query=np.int64(183)
2025-03-13 11:55:27,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:27,597 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:27
2025-03-13 11:55:27,597 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1621.93it/s]
2025-03-13 11:55:27,621 [INFO]: There are 4014 embeddings of dim 49152
2025-03-13 11:55:27,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:55:27,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:27
2025-03-13 11:55:27,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:27,623 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:55:27,623 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:27,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:55:27,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:27
2025-03-13 11:55:27,623 [INFO]: 828.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:27,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:55:27,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:27
2025-03-13 11:55:27,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:27,624 [INFO]: 	Creating the index 03/13/2025, 11:55:27
2025-03-13 11:55:27,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:27
2025-03-13 11:55:27,627 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:55:27,627 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:27
2025-03-13 11:55:27,627 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:55:27,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 28.21it/s] 56%|█████▋    | 9/16 [00:00<00:00, 45.96it/s] 94%|█████████▍| 15/16 [00:00<00:00, 51.97it/s]100%|██████████| 16/16 [00:02<00:00,  6.22it/s]
2025-03-13 11:55:30,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:30
2025-03-13 11:56:07,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5206 secs
2025-03-13 11:56:07,725 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 11:56:07,725 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-13 11:56:21,023 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2978 secs
2025-03-13 11:56:21,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3983 secs
2025-03-13 11:56:21,026 [INFO]: {
2025-03-13 11:56:21,026 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:21,026 [INFO]: 	index_param: efSearch=175
2025-03-13 11:56:21,026 [INFO]: 	index_path: knn.index
2025-03-13 11:56:21,026 [INFO]: 	size in bytes: 789730630
2025-03-13 11:56:21,026 [INFO]: 	avg_search_speed_ms: 6.458893012061705
2025-03-13 11:56:21,026 [INFO]: 	99p_search_speed_ms: 9.07229977659881
2025-03-13 11:56:21,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:21,026 [INFO]: 	nb vectors: 4014
2025-03-13 11:56:21,026 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:21,026 [INFO]: 	compression ratio: 0.9993084756000916
2025-03-13 11:56:21,026 [INFO]: }
2025-03-13 11:56:21,026 [INFO]: 	>>> Finished "Creating the index" in 53.4017 secs
2025-03-13 11:56:21,026 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4290 secs
2025-03-13 11:56:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 56192 [episode count 18/20]
[retrieval_preprocessing] for episode 87977 [episode count 19/20], we have num_retrieval=np.int64(4004) num_query=np.int64(193)
2025-03-13 11:56:22,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:22,910 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:22
2025-03-13 11:56:22,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.83it/s]
2025-03-13 11:56:22,939 [INFO]: There are 4004 embeddings of dim 49152
2025-03-13 11:56:22,939 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 11:56:22,939 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:22
2025-03-13 11:56:22,940 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:22,940 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:56:22,940 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:22,940 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:56:22,940 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:22
2025-03-13 11:56:22,940 [INFO]: 826.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:22,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:56:22,941 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:22
2025-03-13 11:56:22,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:22,941 [INFO]: 	Creating the index 03/13/2025, 11:56:22
2025-03-13 11:56:22,942 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:22
2025-03-13 11:56:22,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:56:22,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:22
2025-03-13 11:56:22,945 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:56:22,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 26.15it/s] 56%|█████▋    | 9/16 [00:00<00:00, 43.32it/s] 94%|█████████▍| 15/16 [00:00<00:00, 49.36it/s]100%|██████████| 16/16 [00:02<00:00,  5.37it/s]
2025-03-13 11:56:25,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:25
2025-03-13 11:57:01,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6057 secs
2025-03-13 11:57:01,539 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 11:57:01,539 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.15it/s]
2025-03-13 11:57:20,431 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8927 secs
2025-03-13 11:57:20,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4887 secs
2025-03-13 11:57:20,434 [INFO]: {
2025-03-13 11:57:20,434 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:20,434 [INFO]: 	index_param: efSearch=300
2025-03-13 11:57:20,434 [INFO]: 	index_path: knn.index
2025-03-13 11:57:20,434 [INFO]: 	size in bytes: 787763110
2025-03-13 11:57:20,434 [INFO]: 	avg_search_speed_ms: 10.241351465712718
2025-03-13 11:57:20,434 [INFO]: 	99p_search_speed_ms: 14.35956556349993
2025-03-13 11:57:20,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:20,434 [INFO]: 	nb vectors: 4004
2025-03-13 11:57:20,434 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:20,434 [INFO]: 	compression ratio: 0.9993085764069354
2025-03-13 11:57:20,434 [INFO]: }
2025-03-13 11:57:20,434 [INFO]: 	>>> Finished "Creating the index" in 57.4927 secs
2025-03-13 11:57:20,434 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5244 secs
2025-03-13 11:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 87977 [episode count 19/20]
2025-03-13 11:57:22: [retrieval_preprocessing] finished for 4345518188_put_lid_on_pot [chosen_id count 3/260]
2025-03-13 11:57:23: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_remove_lid_from_pot [chosen_id count 4/260]
2025-03-13 11:57:23: [retrieval_preprocessing] we have num_total=3188 embedding_dim=49152
[retrieval_preprocessing] for episode 26652 [episode count 0/20], we have num_retrieval=np.int64(3009) num_query=np.int64(179)
2025-03-13 11:57:23,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:24,410 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:24
2025-03-13 11:57:24,410 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1549.43it/s]
2025-03-13 11:57:24,446 [INFO]: There are 3009 embeddings of dim 49152
2025-03-13 11:57:24,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 11:57:24,446 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:24
2025-03-13 11:57:24,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:24,447 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:57:24,447 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:24,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:57:24,447 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:24
2025-03-13 11:57:24,447 [INFO]: 621.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:24,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:57:24,448 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:24
2025-03-13 11:57:24,448 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:24,448 [INFO]: 	Creating the index 03/13/2025, 11:57:24
2025-03-13 11:57:24,448 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:24
2025-03-13 11:57:24,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:57:24,450 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:24
2025-03-13 11:57:24,450 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:57:24,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.32it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.13it/s]100%|██████████| 12/12 [00:02<00:00,  5.29it/s]
2025-03-13 11:57:26,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:26
2025-03-13 11:58:07,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9374 secs
2025-03-13 11:58:07,659 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 11:58:07,659 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.38it/s]
2025-03-13 11:58:25,621 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9620 secs
2025-03-13 11:58:25,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1730 secs
2025-03-13 11:58:25,623 [INFO]: {
2025-03-13 11:58:25,624 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:25,624 [INFO]: 	index_param: efSearch=207
2025-03-13 11:58:25,624 [INFO]: 	index_path: knn.index
2025-03-13 11:58:25,624 [INFO]: 	size in bytes: 592002070
2025-03-13 11:58:25,624 [INFO]: 	avg_search_speed_ms: 8.006320662499727
2025-03-13 11:58:25,624 [INFO]: 	99p_search_speed_ms: 10.459597948938608
2025-03-13 11:58:25,624 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:25,624 [INFO]: 	nb vectors: 3009
2025-03-13 11:58:25,624 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:25,624 [INFO]: 	compression ratio: 0.9993098030890332
2025-03-13 11:58:25,624 [INFO]: }
2025-03-13 11:58:25,624 [INFO]: 	>>> Finished "Creating the index" in 61.1757 secs
2025-03-13 11:58:25,624 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2133 secs
2025-03-13 11:58:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 26652 [episode count 0/20]
[retrieval_preprocessing] for episode 9760 [episode count 1/20], we have num_retrieval=np.int64(2996) num_query=np.int64(192)
2025-03-13 11:58:27,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:27,756 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:27
2025-03-13 11:58:27,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.46it/s]
2025-03-13 11:58:27,786 [INFO]: There are 2996 embeddings of dim 49152
2025-03-13 11:58:27,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 11:58:27,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:27
2025-03-13 11:58:27,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:27,786 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 11:58:27,786 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:27,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:27,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:27
2025-03-13 11:58:27,786 [INFO]: 618.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:27,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:58:27,786 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:27
2025-03-13 11:58:27,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:27,786 [INFO]: 	Creating the index 03/13/2025, 11:58:27
2025-03-13 11:58:27,786 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:27
2025-03-13 11:58:27,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:58:27,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:27
2025-03-13 11:58:27,788 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:58:27,788 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.07it/s] 50%|█████     | 6/12 [00:00<00:00, 28.71it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.57it/s]100%|██████████| 12/12 [00:02<00:00,  5.21it/s]
2025-03-13 11:58:30,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:30
2025-03-13 11:59:08,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4054 secs
2025-03-13 11:59:08,499 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 11:59:08,499 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 11:59:24,437 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9381 secs
2025-03-13 11:59:24,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6515 secs
2025-03-13 11:59:24,439 [INFO]: {
2025-03-13 11:59:24,439 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:24,439 [INFO]: 	index_param: efSearch=234
2025-03-13 11:59:24,439 [INFO]: 	index_path: knn.index
2025-03-13 11:59:24,439 [INFO]: 	size in bytes: 589444450
2025-03-13 11:59:24,439 [INFO]: 	avg_search_speed_ms: 8.497433290645139
2025-03-13 11:59:24,439 [INFO]: 	99p_search_speed_ms: 14.620799990370871
2025-03-13 11:59:24,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:24,439 [INFO]: 	nb vectors: 2996
2025-03-13 11:59:24,439 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:24,439 [INFO]: 	compression ratio: 0.9993097195164022
2025-03-13 11:59:24,439 [INFO]: }
2025-03-13 11:59:24,439 [INFO]: 	>>> Finished "Creating the index" in 56.6530 secs
2025-03-13 11:59:24,439 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6833 secs
2025-03-13 11:59:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 9760 [episode count 1/20]
[retrieval_preprocessing] for episode 87110 [episode count 2/20], we have num_retrieval=np.int64(3038) num_query=np.int64(150)
2025-03-13 11:59:26,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:26,940 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:26
2025-03-13 11:59:26,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.30it/s]
2025-03-13 11:59:26,974 [INFO]: There are 3038 embeddings of dim 49152
2025-03-13 11:59:26,974 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 11:59:26,975 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:26
2025-03-13 11:59:26,975 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:26,975 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:59:26,975 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:26,975 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:59:26,975 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:26
2025-03-13 11:59:26,976 [INFO]: 627.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:26,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:59:26,976 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:26
2025-03-13 11:59:26,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:26,976 [INFO]: 	Creating the index 03/13/2025, 11:59:26
2025-03-13 11:59:26,976 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:26
2025-03-13 11:59:26,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:59:26,980 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:26
2025-03-13 11:59:26,980 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:59:26,980 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.61it/s] 75%|███████▌  | 9/12 [00:00<00:00, 40.65it/s]100%|██████████| 12/12 [00:02<00:00,  5.40it/s]
2025-03-13 11:59:29,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:29
2025-03-13 11:59:59,824 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6164 secs
2025-03-13 11:59:59,824 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 11:59:59,824 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.14it/s]
2025-03-13 12:00:18,346 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5221 secs
2025-03-13 12:00:18,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3684 secs
2025-03-13 12:00:18,348 [INFO]: {
2025-03-13 12:00:18,348 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:18,349 [INFO]: 	index_param: efSearch=296
2025-03-13 12:00:18,349 [INFO]: 	index_path: knn.index
2025-03-13 12:00:18,349 [INFO]: 	size in bytes: 597707590
2025-03-13 12:00:18,349 [INFO]: 	avg_search_speed_ms: 9.64488157541774
2025-03-13 12:00:18,349 [INFO]: 	99p_search_speed_ms: 13.546907473355542
2025-03-13 12:00:18,349 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:18,349 [INFO]: 	nb vectors: 3038
2025-03-13 12:00:18,349 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:18,349 [INFO]: 	compression ratio: 0.9993098866286774
2025-03-13 12:00:18,349 [INFO]: }
2025-03-13 12:00:18,349 [INFO]: 	>>> Finished "Creating the index" in 51.3725 secs
2025-03-13 12:00:18,349 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4086 secs
2025-03-13 12:00:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 87110 [episode count 2/20]
[retrieval_preprocessing] for episode 93271 [episode count 3/20], we have num_retrieval=np.int64(3018) num_query=np.int64(170)
2025-03-13 12:00:19,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:20,341 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:20
2025-03-13 12:00:20,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.61it/s]
2025-03-13 12:00:20,376 [INFO]: There are 3018 embeddings of dim 49152
2025-03-13 12:00:20,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 12:00:20,377 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:20
2025-03-13 12:00:20,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:20,377 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:00:20,378 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:20,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:00:20,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:20
2025-03-13 12:00:20,378 [INFO]: 622.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:20,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:00:20,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:20
2025-03-13 12:00:20,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:20,379 [INFO]: 	Creating the index 03/13/2025, 12:00:20
2025-03-13 12:00:20,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:20
2025-03-13 12:00:20,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:00:20,383 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:20
2025-03-13 12:00:20,383 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:00:20,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.11it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.02it/s]100%|██████████| 12/12 [00:02<00:00,  4.21it/s]100%|██████████| 12/12 [00:02<00:00,  5.12it/s]
2025-03-13 12:00:22,733 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:22
2025-03-13 12:00:56,299 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5660 secs
2025-03-13 12:00:56,299 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 12:00:56,299 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.14it/s]
2025-03-13 12:01:15,454 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1543 secs
2025-03-13 12:01:15,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0732 secs
2025-03-13 12:01:15,456 [INFO]: {
2025-03-13 12:01:15,456 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:15,456 [INFO]: 	index_param: efSearch=260
2025-03-13 12:01:15,456 [INFO]: 	index_path: knn.index
2025-03-13 12:01:15,456 [INFO]: 	size in bytes: 593772730
2025-03-13 12:01:15,456 [INFO]: 	avg_search_speed_ms: 9.048091937952181
2025-03-13 12:01:15,456 [INFO]: 	99p_search_speed_ms: 11.753027569502596
2025-03-13 12:01:15,456 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:15,456 [INFO]: 	nb vectors: 3018
2025-03-13 12:01:15,456 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:15,456 [INFO]: 	compression ratio: 0.9993098605252552
2025-03-13 12:01:15,456 [INFO]: }
2025-03-13 12:01:15,456 [INFO]: 	>>> Finished "Creating the index" in 55.0771 secs
2025-03-13 12:01:15,456 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1153 secs
2025-03-13 12:01:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 93271 [episode count 3/20]
[retrieval_preprocessing] for episode 41051 [episode count 4/20], we have num_retrieval=np.int64(3026) num_query=np.int64(162)
2025-03-13 12:01:17,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:17,903 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:17
2025-03-13 12:01:17,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.57it/s]
2025-03-13 12:01:17,936 [INFO]: There are 3026 embeddings of dim 49152
2025-03-13 12:01:17,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 12:01:17,936 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:17
2025-03-13 12:01:17,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:17,936 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:01:17,936 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:17,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:17,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:17
2025-03-13 12:01:17,937 [INFO]: 624.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:17,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:01:17,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:17
2025-03-13 12:01:17,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:17,937 [INFO]: 	Creating the index 03/13/2025, 12:01:17
2025-03-13 12:01:17,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:17
2025-03-13 12:01:17,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:01:17,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:17
2025-03-13 12:01:17,938 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:01:17,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.51it/s] 50%|█████     | 6/12 [00:00<00:00, 32.50it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.63it/s]100%|██████████| 12/12 [00:02<00:00,  4.16it/s]
2025-03-13 12:01:20,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:20
2025-03-13 12:01:48,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8200 secs
2025-03-13 12:01:48,648 [INFO]: The best hyperparameters are: efSearch=398
2025-03-13 12:01:48,648 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 12:02:13,133 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4852 secs
2025-03-13 12:02:13,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1982 secs
2025-03-13 12:02:13,136 [INFO]: {
2025-03-13 12:02:13,136 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:13,136 [INFO]: 	index_param: efSearch=398
2025-03-13 12:02:13,136 [INFO]: 	index_path: knn.index
2025-03-13 12:02:13,136 [INFO]: 	size in bytes: 595346650
2025-03-13 12:02:13,136 [INFO]: 	avg_search_speed_ms: 12.738097165817864
2025-03-13 12:02:13,136 [INFO]: 	99p_search_speed_ms: 19.155748316552486
2025-03-13 12:02:13,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:13,136 [INFO]: 	nb vectors: 3026
2025-03-13 12:02:13,136 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:13,136 [INFO]: 	compression ratio: 0.9993099112928577
2025-03-13 12:02:13,137 [INFO]: }
2025-03-13 12:02:13,137 [INFO]: 	>>> Finished "Creating the index" in 55.1997 secs
2025-03-13 12:02:13,137 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2335 secs
2025-03-13 12:02:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 41051 [episode count 4/20]
[retrieval_preprocessing] for episode 91227 [episode count 5/20], we have num_retrieval=np.int64(3041) num_query=np.int64(147)
2025-03-13 12:02:16,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:16,834 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:16
2025-03-13 12:02:16,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 942.96it/s]
2025-03-13 12:02:16,869 [INFO]: There are 3041 embeddings of dim 49152
2025-03-13 12:02:16,869 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 12:02:16,869 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:16,870 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:02:16,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:16,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:02:16,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,871 [INFO]: 627.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:16,871 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:02:16,872 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:16
2025-03-13 12:02:16,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:16,872 [INFO]: 	Creating the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:16
2025-03-13 12:02:16,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:02:16,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,876 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:02:16,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.72it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.14it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.78it/s]100%|██████████| 12/12 [00:02<00:00,  3.16it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]
2025-03-13 12:02:19,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:19
2025-03-13 12:02:58,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8921 secs
2025-03-13 12:02:58,503 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 12:02:58,503 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.42it/s]
2025-03-13 12:03:14,103 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6002 secs
2025-03-13 12:03:14,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2294 secs
2025-03-13 12:03:14,106 [INFO]: {
2025-03-13 12:03:14,106 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:14,106 [INFO]: 	index_param: efSearch=259
2025-03-13 12:03:14,106 [INFO]: 	index_path: knn.index
2025-03-13 12:03:14,106 [INFO]: 	size in bytes: 598297810
2025-03-13 12:03:14,106 [INFO]: 	avg_search_speed_ms: 10.498439541559545
2025-03-13 12:03:14,106 [INFO]: 	99p_search_speed_ms: 15.29156762175262
2025-03-13 12:03:14,106 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:14,106 [INFO]: 	nb vectors: 3041
2025-03-13 12:03:14,106 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:14,106 [INFO]: 	compression ratio: 0.9993099055468714
2025-03-13 12:03:14,106 [INFO]: }
2025-03-13 12:03:14,106 [INFO]: 	>>> Finished "Creating the index" in 57.2337 secs
2025-03-13 12:03:14,106 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2720 secs
2025-03-13 12:03:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 91227 [episode count 5/20]
[retrieval_preprocessing] for episode 49252 [episode count 6/20], we have num_retrieval=np.int64(3023) num_query=np.int64(165)
2025-03-13 12:03:15,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:16,388 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:16
2025-03-13 12:03:16,388 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.73it/s]
2025-03-13 12:03:16,682 [INFO]: There are 3023 embeddings of dim 49152
2025-03-13 12:03:16,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2941 secs
2025-03-13 12:03:16,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:16
2025-03-13 12:03:16,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:16,683 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:03:16,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:16,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:03:16,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:16
2025-03-13 12:03:16,683 [INFO]: 623.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:16,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:03:16,684 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:16
2025-03-13 12:03:16,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:16,684 [INFO]: 	Creating the index 03/13/2025, 12:03:16
2025-03-13 12:03:16,684 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:16
2025-03-13 12:03:16,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 12:03:16,686 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:16
2025-03-13 12:03:16,687 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:03:16,687 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.09it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.90it/s]100%|██████████| 12/12 [00:02<00:00,  3.92it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]
2025-03-13 12:03:19,205 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:19
2025-03-13 12:03:49,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8057 secs
2025-03-13 12:03:49,012 [INFO]: The best hyperparameters are: efSearch=331
2025-03-13 12:03:49,012 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.80it/s]
2025-03-13 12:04:07,351 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3389 secs
2025-03-13 12:04:07,373 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6867 secs
2025-03-13 12:04:07,373 [INFO]: {
2025-03-13 12:04:07,373 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:07,373 [INFO]: 	index_param: efSearch=331
2025-03-13 12:04:07,373 [INFO]: 	index_path: knn.index
2025-03-13 12:04:07,373 [INFO]: 	size in bytes: 594756430
2025-03-13 12:04:07,373 [INFO]: 	avg_search_speed_ms: 13.646700697103553
2025-03-13 12:04:07,373 [INFO]: 	99p_search_speed_ms: 18.878417676314708
2025-03-13 12:04:07,374 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:07,374 [INFO]: 	nb vectors: 3023
2025-03-13 12:04:07,374 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:07,374 [INFO]: 	compression ratio: 0.9993098922864945
2025-03-13 12:04:07,374 [INFO]: }
2025-03-13 12:04:07,374 [INFO]: 	>>> Finished "Creating the index" in 50.6895 secs
2025-03-13 12:04:07,374 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9856 secs
2025-03-13 12:04:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 49252 [episode count 6/20]
[retrieval_preprocessing] for episode 58509 [episode count 7/20], we have num_retrieval=np.int64(3019) num_query=np.int64(169)
2025-03-13 12:04:09,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:10,094 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:10
2025-03-13 12:04:10,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.40it/s]
2025-03-13 12:04:10,125 [INFO]: There are 3019 embeddings of dim 49152
2025-03-13 12:04:10,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 12:04:10,125 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:10,126 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:04:10,126 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:10,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:04:10,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,126 [INFO]: 623.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:10,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:04:10,127 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:10
2025-03-13 12:04:10,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:10,127 [INFO]: 	Creating the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,127 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:10
2025-03-13 12:04:10,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:04:10,131 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,131 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:04:10,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.88it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.25it/s]100%|██████████| 12/12 [00:02<00:00,  3.52it/s]100%|██████████| 12/12 [00:02<00:00,  4.32it/s]
2025-03-13 12:04:12,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:12
2025-03-13 12:04:46,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9137 secs
2025-03-13 12:04:46,828 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 12:04:46,829 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 12:05:04,238 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4087 secs
2025-03-13 12:05:04,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1088 secs
2025-03-13 12:05:04,240 [INFO]: {
2025-03-13 12:05:04,240 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:04,240 [INFO]: 	index_param: efSearch=288
2025-03-13 12:05:04,240 [INFO]: 	index_path: knn.index
2025-03-13 12:05:04,240 [INFO]: 	size in bytes: 593969470
2025-03-13 12:05:04,240 [INFO]: 	avg_search_speed_ms: 13.594286374585783
2025-03-13 12:05:04,240 [INFO]: 	99p_search_speed_ms: 22.584216657560315
2025-03-13 12:05:04,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:04,240 [INFO]: 	nb vectors: 3019
2025-03-13 12:05:04,240 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:04,240 [INFO]: 	compression ratio: 0.9993098668859193
2025-03-13 12:05:04,240 [INFO]: }
2025-03-13 12:05:04,240 [INFO]: 	>>> Finished "Creating the index" in 54.1125 secs
2025-03-13 12:05:04,240 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1461 secs
2025-03-13 12:05:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 58509 [episode count 7/20]
[retrieval_preprocessing] for episode 44689 [episode count 8/20], we have num_retrieval=np.int64(3063) num_query=np.int64(125)
2025-03-13 12:05:10,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:10,984 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:10
2025-03-13 12:05:10,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2067.18it/s]
2025-03-13 12:05:11,015 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 12:05:11,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 12:05:11,016 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:11
2025-03-13 12:05:11,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:11,016 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:05:11,016 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:11,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:11,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:11
2025-03-13 12:05:11,016 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:11,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:05:11,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:11
2025-03-13 12:05:11,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:11,016 [INFO]: 	Creating the index 03/13/2025, 12:05:11
2025-03-13 12:05:11,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:11
2025-03-13 12:05:11,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:05:11,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:11
2025-03-13 12:05:11,017 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:05:11,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:05,  2.32it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.15it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.70it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.62it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.45it/s] 85%|████████▍ | 11/13 [00:04<00:01,  1.48it/s]100%|██████████| 13/13 [00:06<00:00,  1.19it/s]100%|██████████| 13/13 [00:06<00:00,  1.99it/s]
2025-03-13 12:05:17,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:17
2025-03-13 12:05:48,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6218 secs
2025-03-13 12:05:48,186 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:05:48,186 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 12:06:06,107 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9215 secs
2025-03-13 12:06:06,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0940 secs
2025-03-13 12:06:06,112 [INFO]: {
2025-03-13 12:06:06,112 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:06,112 [INFO]: 	index_param: efSearch=266
2025-03-13 12:06:06,112 [INFO]: 	index_path: knn.index
2025-03-13 12:06:06,112 [INFO]: 	size in bytes: 602626270
2025-03-13 12:06:06,112 [INFO]: 	avg_search_speed_ms: 11.591397820478726
2025-03-13 12:06:06,112 [INFO]: 	99p_search_speed_ms: 17.207438750192523
2025-03-13 12:06:06,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:06,112 [INFO]: 	nb vectors: 3063
2025-03-13 12:06:06,112 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:06,112 [INFO]: 	compression ratio: 0.9993097446614798
2025-03-13 12:06:06,112 [INFO]: }
2025-03-13 12:06:06,112 [INFO]: 	>>> Finished "Creating the index" in 55.0956 secs
2025-03-13 12:06:06,112 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1273 secs
2025-03-13 12:06:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 44689 [episode count 8/20]
[retrieval_preprocessing] for episode 82630 [episode count 9/20], we have num_retrieval=np.int64(3024) num_query=np.int64(164)
2025-03-13 12:06:07,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:08,074 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:08
2025-03-13 12:06:08,074 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2261.08it/s]
2025-03-13 12:06:08,102 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 12:06:08,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:06:08,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:08
2025-03-13 12:06:08,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:08,103 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:06:08,103 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:08,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:06:08,103 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:08
2025-03-13 12:06:08,103 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:08,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:06:08,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:08
2025-03-13 12:06:08,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:08,103 [INFO]: 	Creating the index 03/13/2025, 12:06:08
2025-03-13 12:06:08,103 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:08
2025-03-13 12:06:08,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:06:08,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:08
2025-03-13 12:06:08,104 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:06:08,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.95it/s] 50%|█████     | 6/12 [00:00<00:00, 28.64it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.05it/s]100%|██████████| 12/12 [00:02<00:00,  4.80it/s]
2025-03-13 12:06:10,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:10
2025-03-13 12:06:42,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1796 secs
2025-03-13 12:06:42,791 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 12:06:42,791 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 12:06:58,345 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5540 secs
2025-03-13 12:06:58,347 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2433 secs
2025-03-13 12:06:58,348 [INFO]: {
2025-03-13 12:06:58,348 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:58,348 [INFO]: 	index_param: efSearch=129
2025-03-13 12:06:58,348 [INFO]: 	index_path: knn.index
2025-03-13 12:06:58,348 [INFO]: 	size in bytes: 594953170
2025-03-13 12:06:58,348 [INFO]: 	avg_search_speed_ms: 7.461764754678832
2025-03-13 12:06:58,348 [INFO]: 	99p_search_speed_ms: 17.33036143938067
2025-03-13 12:06:58,348 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:58,348 [INFO]: 	nb vectors: 3024
2025-03-13 12:06:58,348 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:58,348 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 12:06:58,348 [INFO]: }
2025-03-13 12:06:58,348 [INFO]: 	>>> Finished "Creating the index" in 50.2447 secs
2025-03-13 12:06:58,348 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2736 secs
2025-03-13 12:06:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 82630 [episode count 9/20]
[retrieval_preprocessing] for episode 9988 [episode count 10/20], we have num_retrieval=np.int64(3044) num_query=np.int64(144)
2025-03-13 12:06:59,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:59,982 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:59
2025-03-13 12:06:59,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.62it/s]
2025-03-13 12:07:00,020 [INFO]: There are 3044 embeddings of dim 49152
2025-03-13 12:07:00,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 12:07:00,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:00,021 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:07:00,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:00,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:07:00,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,021 [INFO]: 628.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:00,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:07:00,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:00
2025-03-13 12:07:00,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:00,022 [INFO]: 	Creating the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:00
2025-03-13 12:07:00,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:07:00,023 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,024 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:07:00,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.03it/s] 33%|███▎      | 4/12 [00:00<00:00, 17.02it/s] 58%|█████▊    | 7/12 [00:00<00:00, 21.82it/s] 92%|█████████▏| 11/12 [00:00<00:00, 28.20it/s]100%|██████████| 12/12 [00:03<00:00,  3.51it/s]
2025-03-13 12:07:03,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:03
2025-03-13 12:07:35,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4963 secs
2025-03-13 12:07:35,943 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 12:07:35,943 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 12:07:51,549 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6056 secs
2025-03-13 12:07:51,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5279 secs
2025-03-13 12:07:51,552 [INFO]: {
2025-03-13 12:07:51,552 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:51,552 [INFO]: 	index_param: efSearch=149
2025-03-13 12:07:51,552 [INFO]: 	index_path: knn.index
2025-03-13 12:07:51,552 [INFO]: 	size in bytes: 598888030
2025-03-13 12:07:51,552 [INFO]: 	avg_search_speed_ms: 7.897745174213091
2025-03-13 12:07:51,552 [INFO]: 	99p_search_speed_ms: 10.372533777263016
2025-03-13 12:07:51,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:51,552 [INFO]: 	nb vectors: 3044
2025-03-13 12:07:51,552 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:51,552 [INFO]: 	compression ratio: 0.9993099244277766
2025-03-13 12:07:51,552 [INFO]: }
2025-03-13 12:07:51,552 [INFO]: 	>>> Finished "Creating the index" in 51.5304 secs
2025-03-13 12:07:51,552 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5703 secs
2025-03-13 12:07:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 9988 [episode count 10/20]
[retrieval_preprocessing] for episode 62185 [episode count 11/20], we have num_retrieval=np.int64(3052) num_query=np.int64(136)
2025-03-13 12:07:52,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:53,275 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:53
2025-03-13 12:07:53,275 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.57it/s]
2025-03-13 12:07:53,316 [INFO]: There are 3052 embeddings of dim 49152
2025-03-13 12:07:53,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 12:07:53,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:53
2025-03-13 12:07:53,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:53,317 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:07:53,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:53,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:07:53,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:53
2025-03-13 12:07:53,318 [INFO]: 629.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:53,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:07:53,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:53
2025-03-13 12:07:53,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:53,319 [INFO]: 	Creating the index 03/13/2025, 12:07:53
2025-03-13 12:07:53,319 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:53
2025-03-13 12:07:53,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:07:53,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:53
2025-03-13 12:07:53,323 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:07:53,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.36it/s] 54%|█████▍    | 7/13 [00:00<00:00, 31.72it/s] 92%|█████████▏| 12/13 [00:00<00:00, 38.53it/s]100%|██████████| 13/13 [00:02<00:00,  5.61it/s]
2025-03-13 12:07:55,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:55
2025-03-13 12:08:27,857 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2102 secs
2025-03-13 12:08:27,858 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 12:08:27,858 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.76it/s]
2025-03-13 12:08:45,072 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2141 secs
2025-03-13 12:08:45,582 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2590 secs
2025-03-13 12:08:45,582 [INFO]: {
2025-03-13 12:08:45,582 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:45,582 [INFO]: 	index_param: efSearch=232
2025-03-13 12:08:45,582 [INFO]: 	index_path: knn.index
2025-03-13 12:08:45,582 [INFO]: 	size in bytes: 600461950
2025-03-13 12:08:45,582 [INFO]: 	avg_search_speed_ms: 9.27742193854744
2025-03-13 12:08:45,582 [INFO]: 	99p_search_speed_ms: 13.294034935534002
2025-03-13 12:08:45,583 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:45,583 [INFO]: 	nb vectors: 3052
2025-03-13 12:08:45,583 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:45,583 [INFO]: 	compression ratio: 0.9993099745953927
2025-03-13 12:08:45,583 [INFO]: }
2025-03-13 12:08:45,583 [INFO]: 	>>> Finished "Creating the index" in 52.2639 secs
2025-03-13 12:08:45,583 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3082 secs
2025-03-13 12:08:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 62185 [episode count 11/20]
[retrieval_preprocessing] for episode 37186 [episode count 12/20], we have num_retrieval=np.int64(3026) num_query=np.int64(162)
2025-03-13 12:08:46,868 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:47,244 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:47
2025-03-13 12:08:47,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.74it/s]
2025-03-13 12:08:47,273 [INFO]: There are 3026 embeddings of dim 49152
2025-03-13 12:08:47,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 12:08:47,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:47
2025-03-13 12:08:47,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:47,274 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:08:47,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:47,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:47,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:47
2025-03-13 12:08:47,274 [INFO]: 624.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:47,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:08:47,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:47
2025-03-13 12:08:47,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:47,274 [INFO]: 	Creating the index 03/13/2025, 12:08:47
2025-03-13 12:08:47,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:47
2025-03-13 12:08:47,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:08:47,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:47
2025-03-13 12:08:47,275 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:08:47,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.06it/s] 50%|█████     | 6/12 [00:00<00:00, 31.44it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.96it/s]100%|██████████| 12/12 [00:02<00:00,  5.69it/s]
2025-03-13 12:08:49,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:49
2025-03-13 12:09:21,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8458 secs
2025-03-13 12:09:21,234 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 12:09:21,234 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.44it/s]
2025-03-13 12:09:38,842 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6081 secs
2025-03-13 12:09:38,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5684 secs
2025-03-13 12:09:38,844 [INFO]: {
2025-03-13 12:09:38,844 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:38,844 [INFO]: 	index_param: efSearch=260
2025-03-13 12:09:38,844 [INFO]: 	index_path: knn.index
2025-03-13 12:09:38,844 [INFO]: 	size in bytes: 595346650
2025-03-13 12:09:38,844 [INFO]: 	avg_search_speed_ms: 9.338129653763218
2025-03-13 12:09:38,844 [INFO]: 	99p_search_speed_ms: 14.921371382661158
2025-03-13 12:09:38,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:38,844 [INFO]: 	nb vectors: 3026
2025-03-13 12:09:38,844 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:38,844 [INFO]: 	compression ratio: 0.9993099112928577
2025-03-13 12:09:38,844 [INFO]: }
2025-03-13 12:09:38,844 [INFO]: 	>>> Finished "Creating the index" in 51.5700 secs
2025-03-13 12:09:38,844 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6003 secs
2025-03-13 12:09:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 37186 [episode count 12/20]
[retrieval_preprocessing] for episode 13644 [episode count 13/20], we have num_retrieval=np.int64(3028) num_query=np.int64(160)
2025-03-13 12:09:40,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:40,857 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:40
2025-03-13 12:09:40,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1350.39it/s]
2025-03-13 12:09:41,292 [INFO]: There are 3028 embeddings of dim 49152
2025-03-13 12:09:41,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4344 secs
2025-03-13 12:09:41,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:41
2025-03-13 12:09:41,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:41,293 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:09:41,293 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:41,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:09:41,293 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:41
2025-03-13 12:09:41,293 [INFO]: 624.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:41,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:09:41,294 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:41
2025-03-13 12:09:41,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:41,294 [INFO]: 	Creating the index 03/13/2025, 12:09:41
2025-03-13 12:09:41,294 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:41
2025-03-13 12:09:41,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:09:41,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:41
2025-03-13 12:09:41,297 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:09:41,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.99it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.13it/s]100%|██████████| 12/12 [00:02<00:00,  4.37it/s]100%|██████████| 12/12 [00:02<00:00,  5.31it/s]
2025-03-13 12:09:43,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:43
2025-03-13 12:10:14,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8121 secs
2025-03-13 12:10:14,375 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 12:10:14,375 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 12:10:33,540 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1654 secs
2025-03-13 12:10:33,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2459 secs
2025-03-13 12:10:33,543 [INFO]: {
2025-03-13 12:10:33,543 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:33,543 [INFO]: 	index_param: efSearch=216
2025-03-13 12:10:33,543 [INFO]: 	index_path: knn.index
2025-03-13 12:10:33,543 [INFO]: 	size in bytes: 595740130
2025-03-13 12:10:33,543 [INFO]: 	avg_search_speed_ms: 10.009815942289102
2025-03-13 12:10:33,543 [INFO]: 	99p_search_speed_ms: 13.543715439736843
2025-03-13 12:10:33,543 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:33,543 [INFO]: 	nb vectors: 3028
2025-03-13 12:10:33,543 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:33,543 [INFO]: 	compression ratio: 0.999309923942844
2025-03-13 12:10:33,543 [INFO]: }
2025-03-13 12:10:33,543 [INFO]: 	>>> Finished "Creating the index" in 52.2496 secs
2025-03-13 12:10:33,543 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6859 secs
2025-03-13 12:10:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 13644 [episode count 13/20]
[retrieval_preprocessing] for episode 47961 [episode count 14/20], we have num_retrieval=np.int64(3028) num_query=np.int64(160)
2025-03-13 12:10:35,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:35,789 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:35
2025-03-13 12:10:35,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.02it/s]
2025-03-13 12:10:35,821 [INFO]: There are 3028 embeddings of dim 49152
2025-03-13 12:10:35,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 12:10:35,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:35
2025-03-13 12:10:35,822 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:35,822 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:10:35,822 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:35,822 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:35,822 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:35
2025-03-13 12:10:35,822 [INFO]: 624.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:35,822 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:10:35,822 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:35
2025-03-13 12:10:35,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:35,822 [INFO]: 	Creating the index 03/13/2025, 12:10:35
2025-03-13 12:10:35,822 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:35
2025-03-13 12:10:35,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:10:35,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:35
2025-03-13 12:10:35,823 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:10:35,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.72it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.91it/s] 83%|████████▎ | 10/12 [00:00<00:00, 34.52it/s]100%|██████████| 12/12 [00:02<00:00,  4.83it/s]
2025-03-13 12:10:38,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:38
2025-03-13 12:11:14,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8787 secs
2025-03-13 12:11:14,193 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 12:11:14,193 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 12:11:27,731 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5376 secs
2025-03-13 12:11:27,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9090 secs
2025-03-13 12:11:27,732 [INFO]: {
2025-03-13 12:11:27,732 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:27,732 [INFO]: 	index_param: efSearch=281
2025-03-13 12:11:27,733 [INFO]: 	index_path: knn.index
2025-03-13 12:11:27,733 [INFO]: 	size in bytes: 595740130
2025-03-13 12:11:27,733 [INFO]: 	avg_search_speed_ms: 10.083140332895827
2025-03-13 12:11:27,733 [INFO]: 	99p_search_speed_ms: 13.435630353633316
2025-03-13 12:11:27,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:27,733 [INFO]: 	nb vectors: 3028
2025-03-13 12:11:27,733 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:27,733 [INFO]: 	compression ratio: 0.999309923942844
2025-03-13 12:11:27,733 [INFO]: }
2025-03-13 12:11:27,733 [INFO]: 	>>> Finished "Creating the index" in 51.9106 secs
2025-03-13 12:11:27,733 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9437 secs
2025-03-13 12:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 47961 [episode count 14/20]
[retrieval_preprocessing] for episode 22948 [episode count 15/20], we have num_retrieval=np.int64(3024) num_query=np.int64(164)
2025-03-13 12:11:29,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:30,584 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:30
2025-03-13 12:11:30,584 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.74it/s]
2025-03-13 12:11:30,615 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 12:11:30,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 12:11:30,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:30
2025-03-13 12:11:30,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:30,616 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:11:30,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:30,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:30,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:30
2025-03-13 12:11:30,616 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:30,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:11:30,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:30
2025-03-13 12:11:30,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:30,616 [INFO]: 	Creating the index 03/13/2025, 12:11:30
2025-03-13 12:11:30,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:30
2025-03-13 12:11:30,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:11:30,617 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:30
2025-03-13 12:11:30,617 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:11:30,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.19it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.17it/s]100%|██████████| 12/12 [00:02<00:00,  5.22it/s]
2025-03-13 12:11:32,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:32
2025-03-13 12:12:02,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7537 secs
2025-03-13 12:12:02,672 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 12:12:02,672 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.33it/s]
2025-03-13 12:12:20,576 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9035 secs
2025-03-13 12:12:20,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9605 secs
2025-03-13 12:12:20,578 [INFO]: {
2025-03-13 12:12:20,578 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:20,578 [INFO]: 	index_param: efSearch=206
2025-03-13 12:12:20,578 [INFO]: 	index_path: knn.index
2025-03-13 12:12:20,578 [INFO]: 	size in bytes: 594953170
2025-03-13 12:12:20,578 [INFO]: 	avg_search_speed_ms: 9.287836948909495
2025-03-13 12:12:20,578 [INFO]: 	99p_search_speed_ms: 13.533639553934336
2025-03-13 12:12:20,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:20,578 [INFO]: 	nb vectors: 3024
2025-03-13 12:12:20,578 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:20,578 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 12:12:20,578 [INFO]: }
2025-03-13 12:12:20,578 [INFO]: 	>>> Finished "Creating the index" in 49.9620 secs
2025-03-13 12:12:20,578 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9945 secs
2025-03-13 12:12:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 22948 [episode count 15/20]
[retrieval_preprocessing] for episode 67022 [episode count 16/20], we have num_retrieval=np.int64(3020) num_query=np.int64(168)
2025-03-13 12:12:22,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:23,221 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:23
2025-03-13 12:12:23,221 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1606.40it/s]
2025-03-13 12:12:23,267 [INFO]: There are 3020 embeddings of dim 49152
2025-03-13 12:12:23,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0464 secs
2025-03-13 12:12:23,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:23
2025-03-13 12:12:23,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:23,268 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:12:23,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:23,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:12:23,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:23
2025-03-13 12:12:23,268 [INFO]: 623.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:23,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:12:23,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:23
2025-03-13 12:12:23,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:23,269 [INFO]: 	Creating the index 03/13/2025, 12:12:23
2025-03-13 12:12:23,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:23
2025-03-13 12:12:23,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:12:23,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:23
2025-03-13 12:12:23,273 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:12:23,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.47it/s] 33%|███▎      | 4/12 [00:00<00:00, 13.95it/s] 75%|███████▌  | 9/12 [00:00<00:00, 24.79it/s]100%|██████████| 12/12 [00:02<00:00,  3.43it/s]100%|██████████| 12/12 [00:02<00:00,  4.50it/s]
2025-03-13 12:12:25,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:25
2025-03-13 12:13:01,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2825 secs
2025-03-13 12:13:01,235 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 12:13:01,235 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.46it/s]
2025-03-13 12:13:18,520 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2848 secs
2025-03-13 12:13:18,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2489 secs
2025-03-13 12:13:18,522 [INFO]: {
2025-03-13 12:13:18,522 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:18,522 [INFO]: 	index_param: efSearch=224
2025-03-13 12:13:18,522 [INFO]: 	index_path: knn.index
2025-03-13 12:13:18,523 [INFO]: 	size in bytes: 594166210
2025-03-13 12:13:18,523 [INFO]: 	avg_search_speed_ms: 9.13693827989439
2025-03-13 12:13:18,523 [INFO]: 	99p_search_speed_ms: 12.438806081190704
2025-03-13 12:13:18,523 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:18,523 [INFO]: 	nb vectors: 3020
2025-03-13 12:13:18,523 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:18,523 [INFO]: 	compression ratio: 0.999309873242371
2025-03-13 12:13:18,523 [INFO]: }
2025-03-13 12:13:18,523 [INFO]: 	>>> Finished "Creating the index" in 55.2539 secs
2025-03-13 12:13:18,523 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3018 secs
2025-03-13 12:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 67022 [episode count 16/20]
[retrieval_preprocessing] for episode 73186 [episode count 17/20], we have num_retrieval=np.int64(3036) num_query=np.int64(152)
2025-03-13 12:13:19,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:20,318 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:20
2025-03-13 12:13:20,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.40it/s]
2025-03-13 12:13:20,349 [INFO]: There are 3036 embeddings of dim 49152
2025-03-13 12:13:20,349 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 12:13:20,349 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:20
2025-03-13 12:13:20,349 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:20,349 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:13:20,349 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:20,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:20,349 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:20
2025-03-13 12:13:20,350 [INFO]: 626.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:20,350 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:20,350 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:20
2025-03-13 12:13:20,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:20,350 [INFO]: 	Creating the index 03/13/2025, 12:13:20
2025-03-13 12:13:20,350 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:20
2025-03-13 12:13:20,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:13:20,351 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:20
2025-03-13 12:13:20,351 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:13:20,351 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.90it/s] 50%|█████     | 6/12 [00:00<00:00, 28.45it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.90it/s]100%|██████████| 12/12 [00:02<00:00,  5.24it/s]
2025-03-13 12:13:22,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:22
2025-03-13 12:13:54,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6051 secs
2025-03-13 12:13:54,251 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 12:13:54,251 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.86it/s]
2025-03-13 12:14:11,998 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7463 secs
2025-03-13 12:14:12,000 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6495 secs
2025-03-13 12:14:12,001 [INFO]: {
2025-03-13 12:14:12,001 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:12,001 [INFO]: 	index_param: efSearch=273
2025-03-13 12:14:12,001 [INFO]: 	index_path: knn.index
2025-03-13 12:14:12,001 [INFO]: 	size in bytes: 597314110
2025-03-13 12:14:12,001 [INFO]: 	avg_search_speed_ms: 12.270643146411498
2025-03-13 12:14:12,001 [INFO]: 	99p_search_speed_ms: 16.980305118486285
2025-03-13 12:14:12,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:12,001 [INFO]: 	nb vectors: 3036
2025-03-13 12:14:12,001 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:12,001 [INFO]: 	compression ratio: 0.9993098739957775
2025-03-13 12:14:12,001 [INFO]: }
2025-03-13 12:14:12,001 [INFO]: 	>>> Finished "Creating the index" in 51.6510 secs
2025-03-13 12:14:12,001 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6823 secs
2025-03-13 12:14:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 73186 [episode count 17/20]
[retrieval_preprocessing] for episode 37352 [episode count 18/20], we have num_retrieval=np.int64(3035) num_query=np.int64(153)
2025-03-13 12:14:14,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:14,544 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:14
2025-03-13 12:14:14,544 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 886.37it/s]
2025-03-13 12:14:14,579 [INFO]: There are 3035 embeddings of dim 49152
2025-03-13 12:14:14,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 12:14:14,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:14
2025-03-13 12:14:14,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:14,579 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:14:14,579 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:14,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:14:14,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:14
2025-03-13 12:14:14,580 [INFO]: 626.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:14,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:14:14,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:14
2025-03-13 12:14:14,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:14,580 [INFO]: 	Creating the index 03/13/2025, 12:14:14
2025-03-13 12:14:14,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:14
2025-03-13 12:14:14,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:14:14,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:14
2025-03-13 12:14:14,581 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:14:14,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.56it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.58it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.59it/s]100%|██████████| 12/12 [00:02<00:00,  3.29it/s]100%|██████████| 12/12 [00:02<00:00,  4.56it/s]
2025-03-13 12:14:17,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:17
2025-03-13 12:14:48,138 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9209 secs
2025-03-13 12:14:48,138 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 12:14:48,138 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.67it/s]
2025-03-13 12:15:09,521 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3830 secs
2025-03-13 12:15:09,524 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9428 secs
2025-03-13 12:15:09,524 [INFO]: {
2025-03-13 12:15:09,524 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:09,524 [INFO]: 	index_param: efSearch=223
2025-03-13 12:15:09,524 [INFO]: 	index_path: knn.index
2025-03-13 12:15:09,524 [INFO]: 	size in bytes: 597117370
2025-03-13 12:15:09,524 [INFO]: 	avg_search_speed_ms: 9.10904576118954
2025-03-13 12:15:09,524 [INFO]: 	99p_search_speed_ms: 12.940123034641147
2025-03-13 12:15:09,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:09,524 [INFO]: 	nb vectors: 3035
2025-03-13 12:15:09,524 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:09,524 [INFO]: 	compression ratio: 0.999309867673084
2025-03-13 12:15:09,524 [INFO]: }
2025-03-13 12:15:09,524 [INFO]: 	>>> Finished "Creating the index" in 54.9444 secs
2025-03-13 12:15:09,524 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9802 secs
2025-03-13 12:15:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 37352 [episode count 18/20]
[retrieval_preprocessing] for episode 40940 [episode count 19/20], we have num_retrieval=np.int64(3022) num_query=np.int64(166)
2025-03-13 12:15:11,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:11,490 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:11
2025-03-13 12:15:11,490 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.65it/s]
2025-03-13 12:15:11,521 [INFO]: There are 3022 embeddings of dim 49152
2025-03-13 12:15:11,522 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 12:15:11,522 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:11
2025-03-13 12:15:11,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:11,522 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 12:15:11,522 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:11,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:11,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:11
2025-03-13 12:15:11,522 [INFO]: 623.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:11,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:15:11,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:11
2025-03-13 12:15:11,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:11,522 [INFO]: 	Creating the index 03/13/2025, 12:15:11
2025-03-13 12:15:11,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:11
2025-03-13 12:15:11,524 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:15:11,524 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:11
2025-03-13 12:15:11,524 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:15:11,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.03it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.04it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.22it/s]
2025-03-13 12:15:14,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:14
2025-03-13 12:15:46,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7775 secs
2025-03-13 12:15:46,151 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 12:15:46,151 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 12:16:02,348 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1968 secs
2025-03-13 12:16:02,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8264 secs
2025-03-13 12:16:02,350 [INFO]: {
2025-03-13 12:16:02,350 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:02,350 [INFO]: 	index_param: efSearch=281
2025-03-13 12:16:02,350 [INFO]: 	index_path: knn.index
2025-03-13 12:16:02,350 [INFO]: 	size in bytes: 594559690
2025-03-13 12:16:02,350 [INFO]: 	avg_search_speed_ms: 11.836982015575442
2025-03-13 12:16:02,350 [INFO]: 	99p_search_speed_ms: 18.7789881415665
2025-03-13 12:16:02,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:02,350 [INFO]: 	nb vectors: 3022
2025-03-13 12:16:02,350 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:02,350 [INFO]: 	compression ratio: 0.9993098859426545
2025-03-13 12:16:02,350 [INFO]: }
2025-03-13 12:16:02,350 [INFO]: 	>>> Finished "Creating the index" in 50.8281 secs
2025-03-13 12:16:02,350 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8607 secs
2025-03-13 12:16:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 40940 [episode count 19/20]
2025-03-13 12:16:04: [retrieval_preprocessing] finished for 4345518188_remove_lid_from_pot [chosen_id count 4/260]
2025-03-13 12:16:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_hang_cloth_on_stand [chosen_id count 5/260]
2025-03-13 12:16:05: [retrieval_preprocessing] we have num_total=4585 embedding_dim=49152
[retrieval_preprocessing] for episode 65034 [episode count 0/20], we have num_retrieval=np.int64(4362) num_query=np.int64(223)
2025-03-13 12:16:06,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:06,912 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:06
2025-03-13 12:16:06,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.66it/s]
2025-03-13 12:16:06,940 [INFO]: There are 4362 embeddings of dim 49152
2025-03-13 12:16:06,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:16:06,940 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:06
2025-03-13 12:16:06,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:06,941 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:16:06,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:06,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:16:06,941 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:06
2025-03-13 12:16:06,941 [INFO]: 900.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:06,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:16:06,941 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:06
2025-03-13 12:16:06,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:06,941 [INFO]: 	Creating the index 03/13/2025, 12:16:06
2025-03-13 12:16:06,941 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:06
2025-03-13 12:16:06,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:16:06,942 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:06
2025-03-13 12:16:06,942 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:16:06,942 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.07it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.46it/s] 61%|██████    | 11/18 [00:00<00:00, 36.71it/s] 89%|████████▉ | 16/18 [00:00<00:00, 40.35it/s]100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
2025-03-13 12:16:11,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:11
2025-03-13 12:16:49,727 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5389 secs
2025-03-13 12:16:49,728 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:16:49,728 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 12:17:12,401 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6727 secs
2025-03-13 12:17:12,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4608 secs
2025-03-13 12:17:12,403 [INFO]: {
2025-03-13 12:17:12,403 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:12,403 [INFO]: 	index_param: efSearch=194
2025-03-13 12:17:12,403 [INFO]: 	index_path: knn.index
2025-03-13 12:17:12,403 [INFO]: 	size in bytes: 858197470
2025-03-13 12:17:12,403 [INFO]: 	avg_search_speed_ms: 12.757717203515183
2025-03-13 12:17:12,403 [INFO]: 	99p_search_speed_ms: 24.244887090753764
2025-03-13 12:17:12,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:12,403 [INFO]: 	nb vectors: 4362
2025-03-13 12:17:12,403 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:12,403 [INFO]: 	compression ratio: 0.9993085810425426
2025-03-13 12:17:12,403 [INFO]: }
2025-03-13 12:17:12,403 [INFO]: 	>>> Finished "Creating the index" in 65.4625 secs
2025-03-13 12:17:12,404 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4916 secs
2025-03-13 12:17:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 65034 [episode count 0/20]
[retrieval_preprocessing] for episode 71712 [episode count 1/20], we have num_retrieval=np.int64(4078) num_query=np.int64(507)
2025-03-13 12:17:14,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:15,443 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:15
2025-03-13 12:17:15,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.34it/s]
2025-03-13 12:17:15,469 [INFO]: There are 4078 embeddings of dim 49152
2025-03-13 12:17:15,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:17:15,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:15
2025-03-13 12:17:15,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:15,469 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 12:17:15,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:15,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:15,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:15
2025-03-13 12:17:15,470 [INFO]: 841.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:15,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:15,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:15
2025-03-13 12:17:15,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:15,470 [INFO]: 	Creating the index 03/13/2025, 12:17:15
2025-03-13 12:17:15,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:15
2025-03-13 12:17:15,471 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:17:15,471 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:15
2025-03-13 12:17:15,471 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:17:15,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.13it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.08it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.13it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.61it/s]100%|██████████| 17/17 [00:04<00:00,  3.87it/s]
2025-03-13 12:17:19,873 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:19
2025-03-13 12:18:02,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8699 secs
2025-03-13 12:18:02,744 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:18:02,744 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 12:18:17,635 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8912 secs
2025-03-13 12:18:17,637 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1663 secs
2025-03-13 12:18:17,637 [INFO]: {
2025-03-13 12:18:17,637 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:17,637 [INFO]: 	index_param: efSearch=241
2025-03-13 12:18:17,637 [INFO]: 	index_path: knn.index
2025-03-13 12:18:17,637 [INFO]: 	size in bytes: 802322110
2025-03-13 12:18:17,637 [INFO]: 	avg_search_speed_ms: 11.166064129221402
2025-03-13 12:18:17,637 [INFO]: 	99p_search_speed_ms: 15.853206836618472
2025-03-13 12:18:17,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:17,638 [INFO]: 	nb vectors: 4078
2025-03-13 12:18:17,638 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:17,638 [INFO]: 	compression ratio: 0.9993086492406398
2025-03-13 12:18:17,638 [INFO]: }
2025-03-13 12:18:17,638 [INFO]: 	>>> Finished "Creating the index" in 62.1678 secs
2025-03-13 12:18:17,638 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1949 secs
2025-03-13 12:18:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 71712 [episode count 1/20]
[retrieval_preprocessing] for episode 41017 [episode count 2/20], we have num_retrieval=np.int64(4350) num_query=np.int64(235)
2025-03-13 12:18:24,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:24,973 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:24
2025-03-13 12:18:24,974 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 880.23it/s]
2025-03-13 12:18:25,002 [INFO]: There are 4350 embeddings of dim 49152
2025-03-13 12:18:25,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 12:18:25,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:25
2025-03-13 12:18:25,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:25,004 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:18:25,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:25,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:18:25,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:25
2025-03-13 12:18:25,004 [INFO]: 897.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:25,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:18:25,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:25
2025-03-13 12:18:25,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:25,005 [INFO]: 	Creating the index 03/13/2025, 12:18:25
2025-03-13 12:18:25,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:25
2025-03-13 12:18:25,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:18:25,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:25
2025-03-13 12:18:25,009 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:18:25,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.75it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.30it/s] 67%|██████▋   | 12/18 [00:00<00:00, 40.75it/s] 94%|█████████▍| 17/18 [00:00<00:00, 43.46it/s]100%|██████████| 18/18 [00:03<00:00,  4.67it/s]
2025-03-13 12:18:28,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:28
2025-03-13 12:19:12,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0058 secs
2025-03-13 12:19:12,876 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 12:19:12,876 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-13 12:19:31,383 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5070 secs
2025-03-13 12:19:31,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3759 secs
2025-03-13 12:19:31,385 [INFO]: {
2025-03-13 12:19:31,385 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:31,385 [INFO]: 	index_param: efSearch=236
2025-03-13 12:19:31,385 [INFO]: 	index_path: knn.index
2025-03-13 12:19:31,385 [INFO]: 	size in bytes: 855836590
2025-03-13 12:19:31,385 [INFO]: 	avg_search_speed_ms: 12.390435307749456
2025-03-13 12:19:31,385 [INFO]: 	99p_search_speed_ms: 19.97909127268935
2025-03-13 12:19:31,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:31,385 [INFO]: 	nb vectors: 4350
2025-03-13 12:19:31,385 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:31,385 [INFO]: 	compression ratio: 0.9993085245397139
2025-03-13 12:19:31,386 [INFO]: }
2025-03-13 12:19:31,386 [INFO]: 	>>> Finished "Creating the index" in 66.3802 secs
2025-03-13 12:19:31,386 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4120 secs
2025-03-13 12:19:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 41017 [episode count 2/20]
[retrieval_preprocessing] for episode 75817 [episode count 3/20], we have num_retrieval=np.int64(4419) num_query=np.int64(166)
2025-03-13 12:19:33,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:34,468 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:34
2025-03-13 12:19:34,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2232.20it/s]
2025-03-13 12:19:34,492 [INFO]: There are 4419 embeddings of dim 49152
2025-03-13 12:19:34,492 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 12:19:34,492 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:34
2025-03-13 12:19:34,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:34,492 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:19:34,492 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:34,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:34,492 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:34
2025-03-13 12:19:34,492 [INFO]: 912.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:34,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:34,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:34
2025-03-13 12:19:34,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:34,492 [INFO]: 	Creating the index 03/13/2025, 12:19:34
2025-03-13 12:19:34,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:34
2025-03-13 12:19:34,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:19:34,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:34
2025-03-13 12:19:34,494 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:19:34,494 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.84it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.53it/s] 72%|███████▏  | 13/18 [00:00<00:00, 44.82it/s]100%|██████████| 18/18 [00:03<00:00,  3.75it/s]100%|██████████| 18/18 [00:03<00:00,  5.15it/s]
2025-03-13 12:19:37,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:37
2025-03-13 12:20:21,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3327 secs
2025-03-13 12:20:21,326 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 12:20:21,326 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 12:20:40,940 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6143 secs
2025-03-13 12:20:40,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4492 secs
2025-03-13 12:20:40,943 [INFO]: {
2025-03-13 12:20:40,943 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:40,943 [INFO]: 	index_param: efSearch=243
2025-03-13 12:20:40,943 [INFO]: 	index_path: knn.index
2025-03-13 12:20:40,943 [INFO]: 	size in bytes: 869411890
2025-03-13 12:20:40,943 [INFO]: 	avg_search_speed_ms: 12.350809712963247
2025-03-13 12:20:40,943 [INFO]: 	99p_search_speed_ms: 22.24638721672818
2025-03-13 12:20:40,943 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:40,943 [INFO]: 	nb vectors: 4419
2025-03-13 12:20:40,943 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:40,943 [INFO]: 	compression ratio: 0.9993085693824593
2025-03-13 12:20:40,943 [INFO]: }
2025-03-13 12:20:40,943 [INFO]: 	>>> Finished "Creating the index" in 66.4507 secs
2025-03-13 12:20:40,943 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4747 secs
2025-03-13 12:20:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 75817 [episode count 3/20]
[retrieval_preprocessing] for episode 63557 [episode count 4/20], we have num_retrieval=np.int64(4342) num_query=np.int64(243)
2025-03-13 12:20:43,701 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:44,506 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:44
2025-03-13 12:20:44,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2020.38it/s]
2025-03-13 12:20:44,531 [INFO]: There are 4342 embeddings of dim 49152
2025-03-13 12:20:44,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:20:44,531 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:44
2025-03-13 12:20:44,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:44,531 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:20:44,531 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:44,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:44,531 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:44
2025-03-13 12:20:44,531 [INFO]: 896.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:44,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:20:44,531 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:44
2025-03-13 12:20:44,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:44,531 [INFO]: 	Creating the index 03/13/2025, 12:20:44
2025-03-13 12:20:44,532 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:44
2025-03-13 12:20:44,533 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:20:44,533 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:44
2025-03-13 12:20:44,533 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:20:44,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.88it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.00it/s] 61%|██████    | 11/18 [00:00<00:00, 36.89it/s] 89%|████████▉ | 16/18 [00:00<00:00, 40.85it/s]100%|██████████| 18/18 [00:04<00:00,  4.13it/s]
2025-03-13 12:20:48,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:48
2025-03-13 12:21:30,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5106 secs
2025-03-13 12:21:30,409 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 12:21:30,409 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 12:21:52,953 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5442 secs
2025-03-13 12:21:52,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4237 secs
2025-03-13 12:21:52,957 [INFO]: {
2025-03-13 12:21:52,957 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:52,957 [INFO]: 	index_param: efSearch=183
2025-03-13 12:21:52,957 [INFO]: 	index_path: knn.index
2025-03-13 12:21:52,957 [INFO]: 	size in bytes: 854262550
2025-03-13 12:21:52,957 [INFO]: 	avg_search_speed_ms: 10.938361584141655
2025-03-13 12:21:52,957 [INFO]: 	99p_search_speed_ms: 17.375547948759053
2025-03-13 12:21:52,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:52,957 [INFO]: 	nb vectors: 4342
2025-03-13 12:21:52,957 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:52,957 [INFO]: 	compression ratio: 0.9993086270725552
2025-03-13 12:21:52,957 [INFO]: }
2025-03-13 12:21:52,957 [INFO]: 	>>> Finished "Creating the index" in 68.4253 secs
2025-03-13 12:21:52,957 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4509 secs
2025-03-13 12:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 63557 [episode count 4/20]
[retrieval_preprocessing] for episode 78926 [episode count 5/20], we have num_retrieval=np.int64(4210) num_query=np.int64(375)
2025-03-13 12:21:55,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:55,941 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:55
2025-03-13 12:21:55,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.44it/s]
2025-03-13 12:21:55,968 [INFO]: There are 4210 embeddings of dim 49152
2025-03-13 12:21:55,969 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:21:55,969 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:55
2025-03-13 12:21:55,969 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:55,970 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:21:55,970 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:55,970 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:21:55,970 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:55
2025-03-13 12:21:55,970 [INFO]: 868.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:55,971 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:21:55,971 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:55
2025-03-13 12:21:55,971 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:55,971 [INFO]: 	Creating the index 03/13/2025, 12:21:55
2025-03-13 12:21:55,971 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:55
2025-03-13 12:21:55,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:21:55,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:55
2025-03-13 12:21:55,975 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:21:55,976 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.97it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.05it/s] 82%|████████▏ | 14/17 [00:00<00:00, 44.60it/s]100%|██████████| 17/17 [00:03<00:00,  4.39it/s]
2025-03-13 12:21:59,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:59
2025-03-13 12:22:45,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3272 secs
2025-03-13 12:22:45,181 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 12:22:45,181 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.45it/s]
2025-03-13 12:23:06,381 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2001 secs
2025-03-13 12:23:06,384 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.4088 secs
2025-03-13 12:23:06,384 [INFO]: {
2025-03-13 12:23:06,384 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:06,384 [INFO]: 	index_param: efSearch=261
2025-03-13 12:23:06,384 [INFO]: 	index_path: knn.index
2025-03-13 12:23:06,384 [INFO]: 	size in bytes: 828292210
2025-03-13 12:23:06,384 [INFO]: 	avg_search_speed_ms: 13.416284460876506
2025-03-13 12:23:06,384 [INFO]: 	99p_search_speed_ms: 20.47131127910688
2025-03-13 12:23:06,384 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:06,384 [INFO]: 	nb vectors: 4210
2025-03-13 12:23:06,384 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:06,384 [INFO]: 	compression ratio: 0.9993087825853149
2025-03-13 12:23:06,384 [INFO]: }
2025-03-13 12:23:06,384 [INFO]: 	>>> Finished "Creating the index" in 70.4130 secs
2025-03-13 12:23:06,384 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4434 secs
2025-03-13 12:23:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 78926 [episode count 5/20]
[retrieval_preprocessing] for episode 76371 [episode count 6/20], we have num_retrieval=np.int64(4383) num_query=np.int64(202)
2025-03-13 12:23:12,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:13,552 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:13
2025-03-13 12:23:13,552 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.19it/s]
2025-03-13 12:23:13,580 [INFO]: There are 4383 embeddings of dim 49152
2025-03-13 12:23:13,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:23:13,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:13
2025-03-13 12:23:13,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:13,580 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:23:13,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:13,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:23:13,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:13
2025-03-13 12:23:13,581 [INFO]: 904.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:13,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:23:13,581 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:13
2025-03-13 12:23:13,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:13,581 [INFO]: 	Creating the index 03/13/2025, 12:23:13
2025-03-13 12:23:13,581 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:13
2025-03-13 12:23:13,582 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:23:13,582 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:13
2025-03-13 12:23:13,582 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:23:13,583 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:04,  3.93it/s] 22%|██▏       | 4/18 [00:00<00:01, 11.68it/s] 39%|███▉      | 7/18 [00:00<00:00, 16.24it/s] 61%|██████    | 11/18 [00:00<00:00, 22.58it/s] 83%|████████▎ | 15/18 [00:00<00:00, 26.88it/s]100%|██████████| 18/18 [00:04<00:00,  2.36it/s]100%|██████████| 18/18 [00:04<00:00,  3.93it/s]
2025-03-13 12:23:18,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:18
2025-03-13 12:24:03,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9006 secs
2025-03-13 12:24:03,070 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 12:24:03,070 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 12:24:21,078 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0072 secs
2025-03-13 12:24:21,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4976 secs
2025-03-13 12:24:21,080 [INFO]: {
2025-03-13 12:24:21,080 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:21,080 [INFO]: 	index_param: efSearch=211
2025-03-13 12:24:21,080 [INFO]: 	index_path: knn.index
2025-03-13 12:24:21,080 [INFO]: 	size in bytes: 862329070
2025-03-13 12:24:21,080 [INFO]: 	avg_search_speed_ms: 11.732605820115555
2025-03-13 12:24:21,080 [INFO]: 	99p_search_speed_ms: 16.05147098191083
2025-03-13 12:24:21,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:21,080 [INFO]: 	nb vectors: 4383
2025-03-13 12:24:21,080 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:21,080 [INFO]: 	compression ratio: 0.999308609647127
2025-03-13 12:24:21,080 [INFO]: }
2025-03-13 12:24:21,080 [INFO]: 	>>> Finished "Creating the index" in 67.4996 secs
2025-03-13 12:24:21,080 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5288 secs
2025-03-13 12:24:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 76371 [episode count 6/20]
[retrieval_preprocessing] for episode 19046 [episode count 7/20], we have num_retrieval=np.int64(4394) num_query=np.int64(191)
2025-03-13 12:24:23,056 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:23,647 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:23
2025-03-13 12:24:23,647 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2032.12it/s]
2025-03-13 12:24:23,679 [INFO]: There are 4394 embeddings of dim 49152
2025-03-13 12:24:23,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 12:24:23,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:23
2025-03-13 12:24:23,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:23,679 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:24:23,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:23,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:23,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:23
2025-03-13 12:24:23,680 [INFO]: 906.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:23,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:23,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:23
2025-03-13 12:24:23,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:23,680 [INFO]: 	Creating the index 03/13/2025, 12:24:23
2025-03-13 12:24:23,680 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:23
2025-03-13 12:24:23,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:24:23,681 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:23
2025-03-13 12:24:23,681 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:24:23,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.32it/s] 33%|███▎      | 6/18 [00:00<00:00, 28.90it/s] 61%|██████    | 11/18 [00:00<00:00, 37.41it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.72it/s]100%|██████████| 18/18 [00:04<00:00,  4.38it/s]
2025-03-13 12:24:27,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:27
2025-03-13 12:25:19,323 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.5299 secs
2025-03-13 12:25:19,324 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 12:25:19,324 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 12:25:36,616 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2924 secs
2025-03-13 12:25:36,619 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9376 secs
2025-03-13 12:25:36,619 [INFO]: {
2025-03-13 12:25:36,619 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:36,619 [INFO]: 	index_param: efSearch=193
2025-03-13 12:25:36,619 [INFO]: 	index_path: knn.index
2025-03-13 12:25:36,619 [INFO]: 	size in bytes: 864493210
2025-03-13 12:25:36,619 [INFO]: 	avg_search_speed_ms: 10.524185189585152
2025-03-13 12:25:36,619 [INFO]: 	99p_search_speed_ms: 14.255040315911172
2025-03-13 12:25:36,619 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:36,619 [INFO]: 	nb vectors: 4394
2025-03-13 12:25:36,619 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:36,619 [INFO]: 	compression ratio: 0.9993086608511361
2025-03-13 12:25:36,619 [INFO]: }
2025-03-13 12:25:36,619 [INFO]: 	>>> Finished "Creating the index" in 72.9394 secs
2025-03-13 12:25:36,619 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9724 secs
2025-03-13 12:25:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 19046 [episode count 7/20]
[retrieval_preprocessing] for episode 61564 [episode count 8/20], we have num_retrieval=np.int64(4422) num_query=np.int64(163)
2025-03-13 12:25:38,714 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:39,503 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:39
2025-03-13 12:25:39,504 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2073.31it/s]
2025-03-13 12:25:39,528 [INFO]: There are 4422 embeddings of dim 49152
2025-03-13 12:25:39,529 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 12:25:39,529 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:39
2025-03-13 12:25:39,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:39,529 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:25:39,529 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:39,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:39,529 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:39
2025-03-13 12:25:39,529 [INFO]: 912.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:39,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:25:39,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:39
2025-03-13 12:25:39,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:39,529 [INFO]: 	Creating the index 03/13/2025, 12:25:39
2025-03-13 12:25:39,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:39
2025-03-13 12:25:39,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:25:39,530 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:39
2025-03-13 12:25:39,530 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:25:39,530 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.49it/s] 28%|██▊       | 5/18 [00:00<00:00, 21.59it/s] 50%|█████     | 9/18 [00:00<00:00, 27.97it/s] 72%|███████▏  | 13/18 [00:00<00:00, 31.26it/s] 94%|█████████▍| 17/18 [00:00<00:00, 33.17it/s]100%|██████████| 18/18 [00:05<00:00,  3.17it/s]
2025-03-13 12:25:45,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:45
2025-03-13 12:26:37,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3968 secs
2025-03-13 12:26:37,608 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 12:26:37,609 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 12:26:56,075 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4665 secs
2025-03-13 12:26:56,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5471 secs
2025-03-13 12:26:56,078 [INFO]: {
2025-03-13 12:26:56,078 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:56,078 [INFO]: 	index_param: efSearch=213
2025-03-13 12:26:56,078 [INFO]: 	index_path: knn.index
2025-03-13 12:26:56,078 [INFO]: 	size in bytes: 870002110
2025-03-13 12:26:56,078 [INFO]: 	avg_search_speed_ms: 11.459252552234942
2025-03-13 12:26:56,078 [INFO]: 	99p_search_speed_ms: 22.437890395522114
2025-03-13 12:26:56,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:56,078 [INFO]: 	nb vectors: 4422
2025-03-13 12:26:56,078 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:56,078 [INFO]: 	compression ratio: 0.9993085832860796
2025-03-13 12:26:56,078 [INFO]: }
2025-03-13 12:26:56,078 [INFO]: 	>>> Finished "Creating the index" in 76.5486 secs
2025-03-13 12:26:56,078 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5743 secs
2025-03-13 12:26:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 61564 [episode count 8/20]
[retrieval_preprocessing] for episode 42110 [episode count 9/20], we have num_retrieval=np.int64(4415) num_query=np.int64(170)
2025-03-13 12:26:57,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:58,303 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:58
2025-03-13 12:26:58,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.55it/s]
2025-03-13 12:26:58,328 [INFO]: There are 4415 embeddings of dim 49152
2025-03-13 12:26:58,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 12:26:58,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:58
2025-03-13 12:26:58,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:58,328 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:26:58,328 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:58,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:58,329 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:58
2025-03-13 12:26:58,329 [INFO]: 911.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:58,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:26:58,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:58
2025-03-13 12:26:58,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:58,329 [INFO]: 	Creating the index 03/13/2025, 12:26:58
2025-03-13 12:26:58,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:58
2025-03-13 12:26:58,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:26:58,330 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:58
2025-03-13 12:26:58,330 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:26:58,330 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.18it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.10it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.49it/s]100%|██████████| 18/18 [00:04<00:00,  3.19it/s]100%|██████████| 18/18 [00:04<00:00,  4.40it/s]
2025-03-13 12:27:02,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:02
2025-03-13 12:27:51,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8260 secs
2025-03-13 12:27:51,254 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 12:27:51,254 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.16it/s]
2025-03-13 12:28:11,680 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4258 secs
2025-03-13 12:28:11,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3532 secs
2025-03-13 12:28:11,683 [INFO]: {
2025-03-13 12:28:11,683 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:11,683 [INFO]: 	index_param: efSearch=197
2025-03-13 12:28:11,683 [INFO]: 	index_path: knn.index
2025-03-13 12:28:11,683 [INFO]: 	size in bytes: 868624930
2025-03-13 12:28:11,683 [INFO]: 	avg_search_speed_ms: 11.149142048848065
2025-03-13 12:28:11,683 [INFO]: 	99p_search_speed_ms: 15.52685387432575
2025-03-13 12:28:11,683 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:11,683 [INFO]: 	nb vectors: 4415
2025-03-13 12:28:11,683 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:11,684 [INFO]: 	compression ratio: 0.999308550814907
2025-03-13 12:28:11,684 [INFO]: }
2025-03-13 12:28:11,684 [INFO]: 	>>> Finished "Creating the index" in 73.3546 secs
2025-03-13 12:28:11,684 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3804 secs
2025-03-13 12:28:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 42110 [episode count 9/20]
[retrieval_preprocessing] for episode 46210 [episode count 10/20], we have num_retrieval=np.int64(4348) num_query=np.int64(237)
2025-03-13 12:28:13,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:15,709 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:15
2025-03-13 12:28:15,709 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.72it/s]
2025-03-13 12:28:15,735 [INFO]: There are 4348 embeddings of dim 49152
2025-03-13 12:28:15,735 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:28:15,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:15,736 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:28:15,736 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:15,736 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:15,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,736 [INFO]: 897.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:15,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:28:15,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:15
2025-03-13 12:28:15,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:15,736 [INFO]: 	Creating the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:15
2025-03-13 12:28:15,737 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:28:15,737 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,737 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:28:15,737 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.46it/s] 33%|███▎      | 6/18 [00:00<00:00, 28.02it/s] 61%|██████    | 11/18 [00:00<00:00, 35.54it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.40it/s]100%|██████████| 18/18 [00:04<00:00,  4.06it/s]
2025-03-13 12:28:20,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:20
2025-03-13 12:29:00,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3497 secs
2025-03-13 12:29:00,525 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:29:00,525 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-13 12:29:29,100 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5751 secs
2025-03-13 12:29:29,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3652 secs
2025-03-13 12:29:29,103 [INFO]: {
2025-03-13 12:29:29,103 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:29,103 [INFO]: 	index_param: efSearch=218
2025-03-13 12:29:29,103 [INFO]: 	index_path: knn.index
2025-03-13 12:29:29,103 [INFO]: 	size in bytes: 855443050
2025-03-13 12:29:29,103 [INFO]: 	avg_search_speed_ms: 11.363534822753122
2025-03-13 12:29:29,103 [INFO]: 	99p_search_speed_ms: 15.400027614086868
2025-03-13 12:29:29,103 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:29,103 [INFO]: 	nb vectors: 4348
2025-03-13 12:29:29,103 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:29,103 [INFO]: 	compression ratio: 0.9993085851828476
2025-03-13 12:29:29,103 [INFO]: }
2025-03-13 12:29:29,103 [INFO]: 	>>> Finished "Creating the index" in 73.3667 secs
2025-03-13 12:29:29,103 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3939 secs
2025-03-13 12:29:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 46210 [episode count 10/20]
[retrieval_preprocessing] for episode 45190 [episode count 11/20], we have num_retrieval=np.int64(4371) num_query=np.int64(214)
2025-03-13 12:29:31,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:32,224 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:32
2025-03-13 12:29:32,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2169.84it/s]
2025-03-13 12:29:32,250 [INFO]: There are 4371 embeddings of dim 49152
2025-03-13 12:29:32,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:29:32,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:32
2025-03-13 12:29:32,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:32,251 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:29:32,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:32,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:29:32,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:32
2025-03-13 12:29:32,252 [INFO]: 902.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:32,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:29:32,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:32
2025-03-13 12:29:32,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:32,253 [INFO]: 	Creating the index 03/13/2025, 12:29:32
2025-03-13 12:29:32,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:32
2025-03-13 12:29:32,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 12:29:32,255 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:32
2025-03-13 12:29:32,255 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:29:32,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.22it/s] 28%|██▊       | 5/18 [00:00<00:00, 26.12it/s] 61%|██████    | 11/18 [00:00<00:00, 38.29it/s] 89%|████████▉ | 16/18 [00:00<00:00, 42.26it/s]100%|██████████| 18/18 [00:04<00:00,  3.85it/s]
2025-03-13 12:29:36,937 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:36
2025-03-13 12:30:23,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6151 secs
2025-03-13 12:30:23,553 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:30:23,553 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 12:30:42,549 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9962 secs
2025-03-13 12:30:42,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2968 secs
2025-03-13 12:30:42,552 [INFO]: {
2025-03-13 12:30:42,552 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:42,552 [INFO]: 	index_param: efSearch=231
2025-03-13 12:30:42,552 [INFO]: 	index_path: knn.index
2025-03-13 12:30:42,552 [INFO]: 	size in bytes: 859968130
2025-03-13 12:30:42,552 [INFO]: 	avg_search_speed_ms: 13.230500308853431
2025-03-13 12:30:42,552 [INFO]: 	99p_search_speed_ms: 20.10134612210096
2025-03-13 12:30:42,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:42,552 [INFO]: 	nb vectors: 4371
2025-03-13 12:30:42,552 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:42,552 [INFO]: 	compression ratio: 0.999308623216072
2025-03-13 12:30:42,552 [INFO]: }
2025-03-13 12:30:42,553 [INFO]: 	>>> Finished "Creating the index" in 70.2997 secs
2025-03-13 12:30:42,553 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3283 secs
2025-03-13 12:30:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 45190 [episode count 11/20]
[retrieval_preprocessing] for episode 12936 [episode count 12/20], we have num_retrieval=np.int64(4367) num_query=np.int64(218)
2025-03-13 12:30:45,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:46,090 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:46
2025-03-13 12:30:46,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.36it/s]
2025-03-13 12:30:46,119 [INFO]: There are 4367 embeddings of dim 49152
2025-03-13 12:30:46,119 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:30:46,119 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:46
2025-03-13 12:30:46,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:46,119 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:30:46,119 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:46,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:46,119 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:46
2025-03-13 12:30:46,119 [INFO]: 901.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:46,119 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:30:46,119 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:46
2025-03-13 12:30:46,120 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:46,120 [INFO]: 	Creating the index 03/13/2025, 12:30:46
2025-03-13 12:30:46,120 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:46
2025-03-13 12:30:46,121 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:30:46,121 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:46
2025-03-13 12:30:46,121 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:30:46,121 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.47it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.77it/s] 72%|███████▏  | 13/18 [00:00<00:00, 42.46it/s]100%|██████████| 18/18 [00:03<00:00,  3.49it/s]100%|██████████| 18/18 [00:03<00:00,  4.81it/s]
2025-03-13 12:30:49,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:49
2025-03-13 12:31:37,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9688 secs
2025-03-13 12:31:37,839 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:31:37,839 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 12:31:54,075 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2359 secs
2025-03-13 12:31:54,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9563 secs
2025-03-13 12:31:54,078 [INFO]: {
2025-03-13 12:31:54,078 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:54,078 [INFO]: 	index_param: efSearch=222
2025-03-13 12:31:54,078 [INFO]: 	index_path: knn.index
2025-03-13 12:31:54,078 [INFO]: 	size in bytes: 859181170
2025-03-13 12:31:54,078 [INFO]: 	avg_search_speed_ms: 10.757962448061795
2025-03-13 12:31:54,078 [INFO]: 	99p_search_speed_ms: 13.930157460272321
2025-03-13 12:31:54,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:54,078 [INFO]: 	nb vectors: 4367
2025-03-13 12:31:54,078 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:54,078 [INFO]: 	compression ratio: 0.9993086044937414
2025-03-13 12:31:54,078 [INFO]: }
2025-03-13 12:31:54,078 [INFO]: 	>>> Finished "Creating the index" in 67.9582 secs
2025-03-13 12:31:54,078 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9874 secs
2025-03-13 12:31:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 12936 [episode count 12/20]
[retrieval_preprocessing] for episode 43147 [episode count 13/20], we have num_retrieval=np.int64(4407) num_query=np.int64(178)
2025-03-13 12:31:56,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:56,575 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:56
2025-03-13 12:31:56,575 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1995.39it/s]
2025-03-13 12:31:56,598 [INFO]: There are 4407 embeddings of dim 49152
2025-03-13 12:31:56,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 12:31:56,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:56
2025-03-13 12:31:56,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:56,599 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:31:56,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:56,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:31:56,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:56
2025-03-13 12:31:56,599 [INFO]: 909.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:56,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:31:56,599 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:56
2025-03-13 12:31:56,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:56,599 [INFO]: 	Creating the index 03/13/2025, 12:31:56
2025-03-13 12:31:56,599 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:56
2025-03-13 12:31:56,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:31:56,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:56
2025-03-13 12:31:56,600 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:31:56,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.66it/s] 39%|███▉      | 7/18 [00:00<00:00, 36.13it/s] 72%|███████▏  | 13/18 [00:00<00:00, 46.05it/s]100%|██████████| 18/18 [00:03<00:00,  3.34it/s]100%|██████████| 18/18 [00:03<00:00,  4.61it/s]
2025-03-13 12:32:00,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:00
2025-03-13 12:32:48,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5305 secs
2025-03-13 12:32:48,038 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 12:32:48,038 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 12:33:10,305 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2669 secs
2025-03-13 12:33:10,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7085 secs
2025-03-13 12:33:10,309 [INFO]: {
2025-03-13 12:33:10,309 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:10,309 [INFO]: 	index_param: efSearch=240
2025-03-13 12:33:10,309 [INFO]: 	index_path: knn.index
2025-03-13 12:33:10,309 [INFO]: 	size in bytes: 867050890
2025-03-13 12:33:10,309 [INFO]: 	avg_search_speed_ms: 12.835689168782075
2025-03-13 12:33:10,309 [INFO]: 	99p_search_speed_ms: 23.457072265446186
2025-03-13 12:33:10,309 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:10,309 [INFO]: 	nb vectors: 4407
2025-03-13 12:33:10,309 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:10,309 [INFO]: 	compression ratio: 0.9993086518831669
2025-03-13 12:33:10,309 [INFO]: }
2025-03-13 12:33:10,309 [INFO]: 	>>> Finished "Creating the index" in 73.7100 secs
2025-03-13 12:33:10,309 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7337 secs
2025-03-13 12:33:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 43147 [episode count 13/20]
[retrieval_preprocessing] for episode 73395 [episode count 14/20], we have num_retrieval=np.int64(4376) num_query=np.int64(209)
2025-03-13 12:33:13,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:14,404 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:14
2025-03-13 12:33:14,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]
2025-03-13 12:33:14,435 [INFO]: There are 4376 embeddings of dim 49152
2025-03-13 12:33:14,436 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 12:33:14,436 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:14
2025-03-13 12:33:14,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:14,436 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:33:14,436 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:14,437 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:33:14,437 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:14
2025-03-13 12:33:14,437 [INFO]: 903.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:14,437 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:33:14,437 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:14
2025-03-13 12:33:14,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:14,438 [INFO]: 	Creating the index 03/13/2025, 12:33:14
2025-03-13 12:33:14,438 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:14
2025-03-13 12:33:14,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:33:14,441 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:14
2025-03-13 12:33:14,442 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:33:14,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.42it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.85it/s] 67%|██████▋   | 12/18 [00:00<00:00, 40.10it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.18it/s]100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
2025-03-13 12:33:18,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:18
2025-03-13 12:33:59,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7436 secs
2025-03-13 12:33:59,561 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 12:33:59,561 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.42it/s]
2025-03-13 12:34:15,836 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2750 secs
2025-03-13 12:34:15,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3978 secs
2025-03-13 12:34:15,840 [INFO]: {
2025-03-13 12:34:15,840 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:15,840 [INFO]: 	index_param: efSearch=212
2025-03-13 12:34:15,840 [INFO]: 	index_path: knn.index
2025-03-13 12:34:15,840 [INFO]: 	size in bytes: 860951890
2025-03-13 12:34:15,840 [INFO]: 	avg_search_speed_ms: 12.011121067420847
2025-03-13 12:34:15,840 [INFO]: 	99p_search_speed_ms: 17.918267678469416
2025-03-13 12:34:15,840 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:15,840 [INFO]: 	nb vectors: 4376
2025-03-13 12:34:15,840 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:15,840 [INFO]: 	compression ratio: 0.9993085769287294
2025-03-13 12:34:15,840 [INFO]: }
2025-03-13 12:34:15,840 [INFO]: 	>>> Finished "Creating the index" in 61.4020 secs
2025-03-13 12:34:15,840 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4363 secs
2025-03-13 12:34:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 73395 [episode count 14/20]
[retrieval_preprocessing] for episode 46261 [episode count 15/20], we have num_retrieval=np.int64(4391) num_query=np.int64(194)
2025-03-13 12:34:18,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:18,829 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:18
2025-03-13 12:34:18,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.78it/s]
2025-03-13 12:34:18,854 [INFO]: There are 4391 embeddings of dim 49152
2025-03-13 12:34:18,854 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 12:34:18,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:18
2025-03-13 12:34:18,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:18,855 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:34:18,855 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:18,855 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:18,855 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:18
2025-03-13 12:34:18,855 [INFO]: 906.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:18,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:34:18,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:18
2025-03-13 12:34:18,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:18,855 [INFO]: 	Creating the index 03/13/2025, 12:34:18
2025-03-13 12:34:18,855 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:18
2025-03-13 12:34:18,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:34:18,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:18
2025-03-13 12:34:18,856 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:34:18,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.28it/s] 33%|███▎      | 6/18 [00:00<00:00, 31.88it/s] 61%|██████    | 11/18 [00:00<00:00, 39.90it/s] 89%|████████▉ | 16/18 [00:00<00:00, 43.69it/s]100%|██████████| 18/18 [00:03<00:00,  4.67it/s]
2025-03-13 12:34:22,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:22
2025-03-13 12:35:10,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7167 secs
2025-03-13 12:35:10,437 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 12:35:10,437 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.00it/s]
2025-03-13 12:35:31,756 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3189 secs
2025-03-13 12:35:31,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9022 secs
2025-03-13 12:35:31,759 [INFO]: {
2025-03-13 12:35:31,759 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:31,759 [INFO]: 	index_param: efSearch=225
2025-03-13 12:35:31,759 [INFO]: 	index_path: knn.index
2025-03-13 12:35:31,759 [INFO]: 	size in bytes: 863902990
2025-03-13 12:35:31,759 [INFO]: 	avg_search_speed_ms: 11.444810350868826
2025-03-13 12:35:31,759 [INFO]: 	99p_search_speed_ms: 17.320699386764318
2025-03-13 12:35:31,759 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:31,759 [INFO]: 	nb vectors: 4391
2025-03-13 12:35:31,759 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:31,759 [INFO]: 	compression ratio: 0.9993086469118483
2025-03-13 12:35:31,759 [INFO]: }
2025-03-13 12:35:31,759 [INFO]: 	>>> Finished "Creating the index" in 72.9039 secs
2025-03-13 12:35:31,759 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9303 secs
2025-03-13 12:35:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 46261 [episode count 15/20]
[retrieval_preprocessing] for episode 84672 [episode count 16/20], we have num_retrieval=np.int64(4378) num_query=np.int64(207)
2025-03-13 12:35:33,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:34,570 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:34
2025-03-13 12:35:34,570 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-13 12:35:34,593 [INFO]: There are 4378 embeddings of dim 49152
2025-03-13 12:35:34,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 12:35:34,594 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:34
2025-03-13 12:35:34,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:34,594 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:35:34,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:34,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:35:34,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:34
2025-03-13 12:35:34,594 [INFO]: 903.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:34,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:35:34,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:34
2025-03-13 12:35:34,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:34,594 [INFO]: 	Creating the index 03/13/2025, 12:35:34
2025-03-13 12:35:34,594 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:34
2025-03-13 12:35:34,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:35:34,595 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:34
2025-03-13 12:35:34,595 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:35:34,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.25it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.39it/s] 72%|███████▏  | 13/18 [00:00<00:00, 43.07it/s]100%|██████████| 18/18 [00:04<00:00,  3.23it/s]100%|██████████| 18/18 [00:04<00:00,  4.46it/s]
2025-03-13 12:35:38,638 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:38
2025-03-13 12:36:25,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5344 secs
2025-03-13 12:36:25,173 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 12:36:25,173 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.31it/s]
2025-03-13 12:36:45,476 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3029 secs
2025-03-13 12:36:45,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8833 secs
2025-03-13 12:36:45,479 [INFO]: {
2025-03-13 12:36:45,479 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:45,479 [INFO]: 	index_param: efSearch=216
2025-03-13 12:36:45,479 [INFO]: 	index_path: knn.index
2025-03-13 12:36:45,479 [INFO]: 	size in bytes: 861345370
2025-03-13 12:36:45,479 [INFO]: 	avg_search_speed_ms: 11.571860421890381
2025-03-13 12:36:45,479 [INFO]: 	99p_search_speed_ms: 14.57854270003736
2025-03-13 12:36:45,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:45,479 [INFO]: 	nb vectors: 4378
2025-03-13 12:36:45,479 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:45,479 [INFO]: 	compression ratio: 0.9993085862875191
2025-03-13 12:36:45,479 [INFO]: }
2025-03-13 12:36:45,479 [INFO]: 	>>> Finished "Creating the index" in 70.8849 secs
2025-03-13 12:36:45,479 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9093 secs
2025-03-13 12:36:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 84672 [episode count 16/20]
[retrieval_preprocessing] for episode 39689 [episode count 17/20], we have num_retrieval=np.int64(4370) num_query=np.int64(215)
2025-03-13 12:36:47,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:48,524 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:48
2025-03-13 12:36:48,524 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 956.73it/s]
2025-03-13 12:36:48,554 [INFO]: There are 4370 embeddings of dim 49152
2025-03-13 12:36:48,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 12:36:48,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:48,555 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:36:48,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:48,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:36:48,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,556 [INFO]: 901.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:48,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:36:48,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:48
2025-03-13 12:36:48,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:48,556 [INFO]: 	Creating the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,557 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:48
2025-03-13 12:36:48,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:36:48,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,560 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:36:48,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.73it/s] 39%|███▉      | 7/18 [00:00<00:00, 31.24it/s] 67%|██████▋   | 12/18 [00:00<00:00, 35.63it/s] 94%|█████████▍| 17/18 [00:00<00:00, 37.61it/s]100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
2025-03-13 12:36:53,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:53
2025-03-13 12:37:35,510 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3546 secs
2025-03-13 12:37:35,510 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 12:37:35,510 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.14it/s]
2025-03-13 12:37:50,736 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2258 secs
2025-03-13 12:37:50,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1787 secs
2025-03-13 12:37:50,739 [INFO]: {
2025-03-13 12:37:50,739 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:50,739 [INFO]: 	index_param: efSearch=198
2025-03-13 12:37:50,739 [INFO]: 	index_path: knn.index
2025-03-13 12:37:50,739 [INFO]: 	size in bytes: 859771390
2025-03-13 12:37:50,739 [INFO]: 	avg_search_speed_ms: 10.003480303334072
2025-03-13 12:37:50,739 [INFO]: 	99p_search_speed_ms: 13.209434300661087
2025-03-13 12:37:50,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:50,739 [INFO]: 	nb vectors: 4370
2025-03-13 12:37:50,739 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:50,739 [INFO]: 	compression ratio: 0.9993086185387025
2025-03-13 12:37:50,739 [INFO]: }
2025-03-13 12:37:50,739 [INFO]: 	>>> Finished "Creating the index" in 62.1826 secs
2025-03-13 12:37:50,739 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2147 secs
2025-03-13 12:37:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 39689 [episode count 17/20]
[retrieval_preprocessing] for episode 91409 [episode count 18/20], we have num_retrieval=np.int64(4319) num_query=np.int64(266)
2025-03-13 12:37:52,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:53,406 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:53
2025-03-13 12:37:53,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1648.70it/s]
2025-03-13 12:37:53,437 [INFO]: There are 4319 embeddings of dim 49152
2025-03-13 12:37:53,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 12:37:53,437 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:53
2025-03-13 12:37:53,437 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:53,437 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:37:53,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:53,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:53,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:53
2025-03-13 12:37:53,438 [INFO]: 891.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:53,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:37:53,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:53
2025-03-13 12:37:53,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:53,438 [INFO]: 	Creating the index 03/13/2025, 12:37:53
2025-03-13 12:37:53,438 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:53
2025-03-13 12:37:53,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:37:53,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:53
2025-03-13 12:37:53,439 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:37:53,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.24it/s] 28%|██▊       | 5/18 [00:00<00:00, 24.33it/s] 50%|█████     | 9/18 [00:00<00:00, 30.24it/s] 72%|███████▏  | 13/18 [00:00<00:00, 31.61it/s] 94%|█████████▍| 17/18 [00:00<00:00, 34.17it/s]100%|██████████| 18/18 [00:04<00:00,  3.88it/s]
2025-03-13 12:37:58,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:58
2025-03-13 12:38:49,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1208 secs
2025-03-13 12:38:49,199 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 12:38:49,199 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 12:39:07,990 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7909 secs
2025-03-13 12:39:07,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5532 secs
2025-03-13 12:39:07,992 [INFO]: {
2025-03-13 12:39:07,992 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:07,992 [INFO]: 	index_param: efSearch=205
2025-03-13 12:39:07,992 [INFO]: 	index_path: knn.index
2025-03-13 12:39:07,992 [INFO]: 	size in bytes: 849737410
2025-03-13 12:39:07,992 [INFO]: 	avg_search_speed_ms: 12.060689118065039
2025-03-13 12:39:07,992 [INFO]: 	99p_search_speed_ms: 18.372376272454872
2025-03-13 12:39:07,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:07,992 [INFO]: 	nb vectors: 4319
2025-03-13 12:39:07,992 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:07,992 [INFO]: 	compression ratio: 0.999308659365721
2025-03-13 12:39:07,992 [INFO]: }
2025-03-13 12:39:07,992 [INFO]: 	>>> Finished "Creating the index" in 74.5547 secs
2025-03-13 12:39:07,992 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5866 secs
2025-03-13 12:39:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 91409 [episode count 18/20]
[retrieval_preprocessing] for episode 21857 [episode count 19/20], we have num_retrieval=np.int64(4413) num_query=np.int64(172)
2025-03-13 12:39:10,209 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:10,784 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:10
2025-03-13 12:39:10,784 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2231.01it/s]
2025-03-13 12:39:10,807 [INFO]: There are 4413 embeddings of dim 49152
2025-03-13 12:39:10,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 12:39:10,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:10
2025-03-13 12:39:10,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:10,808 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 12:39:10,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:10,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:10,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:10
2025-03-13 12:39:10,808 [INFO]: 910.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:10,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:10,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:10
2025-03-13 12:39:10,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:10,808 [INFO]: 	Creating the index 03/13/2025, 12:39:10
2025-03-13 12:39:10,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:10
2025-03-13 12:39:10,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:39:10,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:10
2025-03-13 12:39:10,809 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:39:10,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.46it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.30it/s] 72%|███████▏  | 13/18 [00:00<00:00, 44.17it/s]100%|██████████| 18/18 [00:04<00:00,  3.14it/s]100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
2025-03-13 12:39:14,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:14
2025-03-13 12:39:57,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5310 secs
2025-03-13 12:39:57,483 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:39:57,483 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.82it/s]
2025-03-13 12:40:29,326 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8431 secs
2025-03-13 12:40:29,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5207 secs
2025-03-13 12:40:29,330 [INFO]: {
2025-03-13 12:40:29,330 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:29,330 [INFO]: 	index_param: efSearch=250
2025-03-13 12:40:29,330 [INFO]: 	index_path: knn.index
2025-03-13 12:40:29,330 [INFO]: 	size in bytes: 868231450
2025-03-13 12:40:29,330 [INFO]: 	avg_search_speed_ms: 12.549276894876918
2025-03-13 12:40:29,330 [INFO]: 	99p_search_speed_ms: 18.46594426780939
2025-03-13 12:40:29,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:29,330 [INFO]: 	nb vectors: 4413
2025-03-13 12:40:29,330 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:29,330 [INFO]: 	compression ratio: 0.9993085415185087
2025-03-13 12:40:29,330 [INFO]: }
2025-03-13 12:40:29,330 [INFO]: 	>>> Finished "Creating the index" in 78.5222 secs
2025-03-13 12:40:29,330 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5457 secs
2025-03-13 12:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 21857 [episode count 19/20]
2025-03-13 12:40:31: [retrieval_preprocessing] finished for 4345518188_hang_cloth_on_stand [chosen_id count 5/260]
2025-03-13 12:40:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4385851547_Place Plate in Dishwasher [chosen_id count 6/260]
2025-03-13 12:40:34: [retrieval_preprocessing] we have num_total=11251 embedding_dim=49152
[retrieval_preprocessing] for episode 26133 [episode count 0/20], we have num_retrieval=np.int64(10915) num_query=np.int64(336)
2025-03-13 12:40:36,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:37,931 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:37
2025-03-13 12:40:37,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2169.84it/s]
2025-03-13 12:40:37,962 [INFO]: There are 10915 embeddings of dim 49152
2025-03-13 12:40:37,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 12:40:37,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:37,963 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 12:40:37,964 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:40:37,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:40:37,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,964 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:37,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:40:37,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:37
2025-03-13 12:40:37,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:40:37,965 [INFO]: 	Creating the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,966 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:40:37
2025-03-13 12:40:37,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0036 secs
2025-03-13 12:40:37,970 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,970 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 12:40:37,970 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  7.08it/s] 13%|█▎        | 6/45 [00:00<00:01, 27.12it/s] 24%|██▍       | 11/45 [00:00<00:00, 34.61it/s] 36%|███▌      | 16/45 [00:00<00:00, 37.94it/s] 47%|████▋     | 21/45 [00:05<00:10,  2.33it/s] 58%|█████▊    | 26/45 [00:05<00:05,  3.53it/s] 71%|███████   | 32/45 [00:06<00:02,  5.45it/s] 82%|████████▏ | 37/45 [00:06<00:01,  7.53it/s] 93%|█████████▎| 42/45 [00:14<00:01,  1.59it/s]100%|██████████| 45/45 [00:17<00:00,  1.47it/s]100%|██████████| 45/45 [00:17<00:00,  2.58it/s]
2025-03-13 12:40:55,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:55
2025-03-13 12:42:45,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 109.6430 secs
2025-03-13 12:42:45,084 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 12:42:45,084 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.96it/s]
2025-03-13 12:43:08,095 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0109 secs
2025-03-13 12:43:08,096 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.1259 secs
2025-03-13 12:43:08,096 [INFO]: {
2025-03-13 12:43:08,096 [INFO]: 	index_key: HNSW32
2025-03-13 12:43:08,096 [INFO]: 	index_param: efSearch=111
2025-03-13 12:43:08,096 [INFO]: 	index_path: knn.index
2025-03-13 12:43:08,096 [INFO]: 	size in bytes: 2148943622
2025-03-13 12:43:08,096 [INFO]: 	avg_search_speed_ms: 10.794997164786682
2025-03-13 12:43:08,096 [INFO]: 	99p_search_speed_ms: 18.365470175631348
2025-03-13 12:43:08,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:08,096 [INFO]: 	nb vectors: 10915
2025-03-13 12:43:08,096 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:08,096 [INFO]: 	compression ratio: 0.9986191810852448
2025-03-13 12:43:08,096 [INFO]: }
2025-03-13 12:43:08,096 [INFO]: 	>>> Finished "Creating the index" in 150.1307 secs
2025-03-13 12:43:08,096 [INFO]: >>> Finished "Launching the whole pipeline" in 150.1654 secs
2025-03-13 12:43:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 26133 [episode count 0/20]
[retrieval_preprocessing] for episode 25641 [episode count 1/20], we have num_retrieval=np.int64(10436) num_query=np.int64(815)
2025-03-13 12:43:11,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:13,182 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:13
2025-03-13 12:43:13,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 12:43:13,218 [INFO]: There are 10436 embeddings of dim 49152
2025-03-13 12:43:13,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 12:43:13,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:13
2025-03-13 12:43:13,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:13,218 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 12:43:13,218 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:43:13,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:43:13,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:13
2025-03-13 12:43:13,219 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:13,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:43:13,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:13
2025-03-13 12:43:13,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:13,219 [INFO]: 	Creating the index 03/13/2025, 12:43:13
2025-03-13 12:43:13,219 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:43:13
2025-03-13 12:43:13,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:43:13,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:13
2025-03-13 12:43:13,220 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:43:13,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:05,  7.74it/s] 11%|█▏        | 5/44 [00:00<00:01, 22.85it/s] 23%|██▎       | 10/44 [00:00<00:01, 32.29it/s] 34%|███▍      | 15/44 [00:00<00:00, 37.36it/s] 45%|████▌     | 20/44 [00:00<00:00, 40.11it/s] 50%|█████     | 22/44 [00:11<00:00, 40.11it/s] 52%|█████▏    | 23/44 [00:12<00:20,  1.01it/s] 55%|█████▍    | 24/44 [00:13<00:21,  1.08s/it] 61%|██████▏   | 27/44 [00:13<00:12,  1.33it/s] 68%|██████▊   | 30/44 [00:14<00:07,  1.89it/s] 75%|███████▌  | 33/44 [00:14<00:04,  2.63it/s] 82%|████████▏ | 36/44 [00:14<00:02,  3.61it/s] 89%|████████▊ | 39/44 [00:14<00:01,  4.86it/s] 95%|█████████▌| 42/44 [00:22<00:01,  1.06it/s]100%|██████████| 44/44 [00:23<00:00,  1.14it/s]100%|██████████| 44/44 [00:23<00:00,  1.85it/s]
2025-03-13 12:43:36,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:36
2025-03-13 12:45:00,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.7026 secs
2025-03-13 12:45:00,650 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 12:45:00,650 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.63it/s]
2025-03-13 12:45:31,452 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8013 secs
2025-03-13 12:45:31,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.2316 secs
2025-03-13 12:45:31,452 [INFO]: {
2025-03-13 12:45:31,452 [INFO]: 	index_key: HNSW32
2025-03-13 12:45:31,452 [INFO]: 	index_param: efSearch=103
2025-03-13 12:45:31,452 [INFO]: 	index_path: knn.index
2025-03-13 12:45:31,452 [INFO]: 	size in bytes: 2054637970
2025-03-13 12:45:31,452 [INFO]: 	avg_search_speed_ms: 9.039684191645673
2025-03-13 12:45:31,452 [INFO]: 	99p_search_speed_ms: 15.84907825570554
2025-03-13 12:45:31,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:31,452 [INFO]: 	nb vectors: 10436
2025-03-13 12:45:31,452 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:31,452 [INFO]: 	compression ratio: 0.9986192788990461
2025-03-13 12:45:31,452 [INFO]: }
2025-03-13 12:45:31,452 [INFO]: 	>>> Finished "Creating the index" in 138.2331 secs
2025-03-13 12:45:31,452 [INFO]: >>> Finished "Launching the whole pipeline" in 138.2703 secs
2025-03-13 12:45:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 25641 [episode count 1/20]
[retrieval_preprocessing] for episode 1580 [episode count 2/20], we have num_retrieval=np.int64(10818) num_query=np.int64(433)
2025-03-13 12:45:37,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:39,546 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:39
2025-03-13 12:45:39,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2424.45it/s]
2025-03-13 12:45:39,583 [INFO]: There are 10818 embeddings of dim 49152
2025-03-13 12:45:39,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 12:45:39,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:39
2025-03-13 12:45:39,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:39,583 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 12:45:39,583 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:45:39,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:39,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:39
2025-03-13 12:45:39,584 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:39,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:45:39,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:39
2025-03-13 12:45:39,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:39,584 [INFO]: 	Creating the index 03/13/2025, 12:45:39
2025-03-13 12:45:39,584 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:45:39
2025-03-13 12:45:39,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:45:39,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:39
2025-03-13 12:45:39,585 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 12:45:39,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  6.87it/s] 11%|█         | 5/45 [00:00<00:01, 22.31it/s] 20%|██        | 9/45 [00:00<00:01, 29.13it/s] 29%|██▉       | 13/45 [00:00<00:00, 32.67it/s] 38%|███▊      | 17/45 [00:00<00:00, 34.81it/s] 47%|████▋     | 21/45 [00:06<00:12,  1.88it/s] 53%|█████▎    | 24/45 [00:07<00:10,  2.08it/s] 64%|██████▍   | 29/45 [00:07<00:04,  3.34it/s] 76%|███████▌  | 34/45 [00:07<00:02,  5.00it/s] 87%|████████▋ | 39/45 [00:07<00:00,  7.17it/s] 96%|█████████▌| 43/45 [00:14<00:01,  1.74it/s]100%|██████████| 45/45 [00:16<00:00,  2.76it/s]
2025-03-13 12:45:55,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:55
2025-03-13 12:47:23,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.0732 secs
2025-03-13 12:47:23,985 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 12:47:23,985 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.13s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.49it/s]
2025-03-13 12:47:51,716 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7306 secs
2025-03-13 12:47:51,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.1315 secs
2025-03-13 12:47:51,717 [INFO]: {
2025-03-13 12:47:51,717 [INFO]: 	index_key: HNSW32
2025-03-13 12:47:51,717 [INFO]: 	index_param: efSearch=89
2025-03-13 12:47:51,717 [INFO]: 	index_path: knn.index
2025-03-13 12:47:51,718 [INFO]: 	size in bytes: 2129845882
2025-03-13 12:47:51,718 [INFO]: 	avg_search_speed_ms: 8.611220075098299
2025-03-13 12:47:51,718 [INFO]: 	99p_search_speed_ms: 13.555139955133209
2025-03-13 12:47:51,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:51,718 [INFO]: 	nb vectors: 10818
2025-03-13 12:47:51,718 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:51,718 [INFO]: 	compression ratio: 0.9986193658307151
2025-03-13 12:47:51,718 [INFO]: }
2025-03-13 12:47:51,718 [INFO]: 	>>> Finished "Creating the index" in 132.1336 secs
2025-03-13 12:47:51,718 [INFO]: >>> Finished "Launching the whole pipeline" in 132.1718 secs
2025-03-13 12:47:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 1580 [episode count 2/20]
[retrieval_preprocessing] for episode 22090 [episode count 3/20], we have num_retrieval=np.int64(10844) num_query=np.int64(407)
2025-03-13 12:48:02,218 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:03,779 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:03
2025-03-13 12:48:03,779 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.01it/s]
2025-03-13 12:48:03,818 [INFO]: There are 10844 embeddings of dim 49152
2025-03-13 12:48:03,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 12:48:03,819 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:03
2025-03-13 12:48:03,819 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:03,819 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 12:48:03,819 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:48:03,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 12:48:03,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:03
2025-03-13 12:48:03,820 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:03,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:48:03,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:03
2025-03-13 12:48:03,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:48:03,821 [INFO]: 	Creating the index 03/13/2025, 12:48:03
2025-03-13 12:48:03,821 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:48:03
2025-03-13 12:48:03,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0035 secs
2025-03-13 12:48:03,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:03
2025-03-13 12:48:03,826 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 12:48:03,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:05,  7.69it/s] 11%|█         | 5/45 [00:00<00:01, 23.72it/s] 18%|█▊        | 8/45 [00:00<00:01, 26.22it/s] 27%|██▋       | 12/45 [00:00<00:01, 29.40it/s] 38%|███▊      | 17/45 [00:00<00:00, 34.50it/s] 47%|████▋     | 21/45 [00:05<00:11,  2.13it/s] 53%|█████▎    | 24/45 [00:18<00:31,  1.50s/it] 64%|██████▍   | 29/45 [00:18<00:14,  1.08it/s] 78%|███████▊  | 35/45 [00:18<00:05,  1.79it/s] 91%|█████████ | 41/45 [00:19<00:01,  2.76it/s]100%|██████████| 45/45 [00:27<00:00,  1.65it/s]
2025-03-13 12:48:31,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:31
2025-03-13 12:49:57,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.0072 secs
2025-03-13 12:49:57,061 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 12:49:57,061 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.60it/s]
2025-03-13 12:50:34,046 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9849 secs
2025-03-13 12:50:34,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.3491 secs
2025-03-13 12:50:34,176 [INFO]: {
2025-03-13 12:50:34,176 [INFO]: 	index_key: HNSW32
2025-03-13 12:50:34,176 [INFO]: 	index_param: efSearch=105
2025-03-13 12:50:34,176 [INFO]: 	index_path: knn.index
2025-03-13 12:50:34,176 [INFO]: 	size in bytes: 2134965042
2025-03-13 12:50:34,176 [INFO]: 	avg_search_speed_ms: 9.30235407520328
2025-03-13 12:50:34,176 [INFO]: 	99p_search_speed_ms: 14.655801118351519
2025-03-13 12:50:34,176 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:34,176 [INFO]: 	nb vectors: 10844
2025-03-13 12:50:34,176 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:34,176 [INFO]: 	compression ratio: 0.9986192326609533
2025-03-13 12:50:34,176 [INFO]: }
2025-03-13 12:50:34,176 [INFO]: 	>>> Finished "Creating the index" in 150.3551 secs
2025-03-13 12:50:34,177 [INFO]: >>> Finished "Launching the whole pipeline" in 150.3975 secs
2025-03-13 12:50:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 22090 [episode count 3/20]
[retrieval_preprocessing] for episode 21592 [episode count 4/20], we have num_retrieval=np.int64(10718) num_query=np.int64(533)
2025-03-13 12:50:37,592 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:39,070 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:39
2025-03-13 12:50:39,071 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2163.13it/s]
2025-03-13 12:50:39,105 [INFO]: There are 10718 embeddings of dim 49152
2025-03-13 12:50:39,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 12:50:39,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:39
2025-03-13 12:50:39,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:39,105 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 12:50:39,105 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:50:39,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:50:39,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:39
2025-03-13 12:50:39,105 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:39,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:50:39,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:39
2025-03-13 12:50:39,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:39,106 [INFO]: 	Creating the index 03/13/2025, 12:50:39
2025-03-13 12:50:39,106 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:50:39
2025-03-13 12:50:39,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 12:50:39,107 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:39
2025-03-13 12:50:39,107 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 12:50:39,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:07,  5.60it/s] 11%|█         | 5/45 [00:00<00:01, 20.58it/s] 22%|██▏       | 10/45 [00:00<00:01, 30.46it/s] 33%|███▎      | 15/45 [00:00<00:00, 35.62it/s] 44%|████▍     | 20/45 [00:00<00:00, 38.64it/s] 56%|█████▌    | 25/45 [00:06<00:08,  2.38it/s] 69%|██████▉   | 31/45 [00:06<00:03,  3.74it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.57it/s] 93%|█████████▎| 42/45 [00:12<00:01,  2.04it/s]100%|██████████| 45/45 [00:14<00:00,  1.94it/s]100%|██████████| 45/45 [00:14<00:00,  3.12it/s]
2025-03-13 12:50:53,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:53
2025-03-13 12:52:32,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.2455 secs
2025-03-13 12:52:32,784 [INFO]: The best hyperparameters are: efSearch=77
2025-03-13 12:52:32,784 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:06<00:20,  6.72s/it] 50%|█████     | 2/4 [00:10<00:10,  5.25s/it] 75%|███████▌  | 3/4 [00:12<00:03,  3.60s/it] 75%|███████▌  | 3/4 [00:15<00:05,  5.10s/it]
2025-03-13 12:53:22,422 [INFO]: 	>>> Finished "Compute fast metrics" in 49.6374 secs
2025-03-13 12:53:22,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.3169 secs
2025-03-13 12:53:22,424 [INFO]: {
2025-03-13 12:53:22,424 [INFO]: 	index_key: HNSW32
2025-03-13 12:53:22,424 [INFO]: 	index_param: efSearch=77
2025-03-13 12:53:22,424 [INFO]: 	index_path: knn.index
2025-03-13 12:53:22,424 [INFO]: 	size in bytes: 2110157770
2025-03-13 12:53:22,424 [INFO]: 	avg_search_speed_ms: 7.09439858774397
2025-03-13 12:53:22,424 [INFO]: 	99p_search_speed_ms: 13.64012558246035
2025-03-13 12:53:22,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:22,424 [INFO]: 	nb vectors: 10718
2025-03-13 12:53:22,424 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:22,424 [INFO]: 	compression ratio: 0.9986194273994973
2025-03-13 12:53:22,424 [INFO]: }
2025-03-13 12:53:22,424 [INFO]: 	>>> Finished "Creating the index" in 163.3182 secs
2025-03-13 12:53:22,424 [INFO]: >>> Finished "Launching the whole pipeline" in 163.3533 secs
2025-03-13 12:53:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 21592 [episode count 4/20]
[retrieval_preprocessing] for episode 61029 [episode count 5/20], we have num_retrieval=np.int64(10156) num_query=np.int64(1095)
2025-03-13 12:53:28,186 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:29,701 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:29
2025-03-13 12:53:29,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 867.85it/s]
2025-03-13 12:53:29,738 [INFO]: There are 10156 embeddings of dim 49152
2025-03-13 12:53:29,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 12:53:29,739 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:29,739 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:53:29,739 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:53:29,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:53:29,739 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,739 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:29,739 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:53:29,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:29
2025-03-13 12:53:29,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:29,740 [INFO]: 	Creating the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,740 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:53:29
2025-03-13 12:53:29,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 12:53:29,741 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,742 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:53:29,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:10,  3.96it/s]  5%|▍         | 2/41 [00:00<00:06,  5.81it/s]  7%|▋         | 3/41 [00:00<00:05,  6.91it/s] 10%|▉         | 4/41 [00:00<00:04,  7.45it/s] 12%|█▏        | 5/41 [00:00<00:04,  7.84it/s] 15%|█▍        | 6/41 [00:00<00:04,  8.23it/s] 17%|█▋        | 7/41 [00:00<00:04,  8.37it/s] 20%|█▉        | 8/41 [00:01<00:03,  8.50it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.61it/s] 24%|██▍       | 10/41 [00:01<00:03,  8.72it/s] 27%|██▋       | 11/41 [00:01<00:03,  8.85it/s] 29%|██▉       | 12/41 [00:01<00:03,  7.85it/s] 32%|███▏      | 13/41 [00:01<00:03,  7.75it/s] 34%|███▍      | 14/41 [00:01<00:03,  8.03it/s] 37%|███▋      | 15/41 [00:01<00:03,  7.39it/s] 39%|███▉      | 16/41 [00:02<00:03,  6.84it/s] 41%|████▏     | 17/41 [00:02<00:03,  7.28it/s] 51%|█████     | 21/41 [00:06<00:15,  1.28it/s] 63%|██████▎   | 26/41 [00:06<00:05,  2.63it/s] 68%|██████▊   | 28/41 [00:07<00:03,  3.29it/s] 76%|███████▌  | 31/41 [00:07<00:02,  4.52it/s] 80%|████████  | 33/41 [00:07<00:01,  5.41it/s] 88%|████████▊ | 36/41 [00:07<00:00,  7.37it/s] 93%|█████████▎| 38/41 [00:07<00:00,  8.40it/s]100%|██████████| 41/41 [00:16<00:00,  1.13s/it]100%|██████████| 41/41 [00:16<00:00,  2.43it/s]
2025-03-13 12:53:46,596 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:53:46
2025-03-13 12:55:10,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.5701 secs
2025-03-13 12:55:10,167 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 12:55:10,167 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-13 12:55:43,710 [INFO]: 	>>> Finished "Compute fast metrics" in 33.5430 secs
2025-03-13 12:55:43,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.9720 secs
2025-03-13 12:55:43,714 [INFO]: {
2025-03-13 12:55:43,714 [INFO]: 	index_key: HNSW32
2025-03-13 12:55:43,714 [INFO]: 	index_param: efSearch=105
2025-03-13 12:55:43,714 [INFO]: 	index_path: knn.index
2025-03-13 12:55:43,714 [INFO]: 	size in bytes: 1999511154
2025-03-13 12:55:43,714 [INFO]: 	avg_search_speed_ms: 9.19872378821638
2025-03-13 12:55:43,714 [INFO]: 	99p_search_speed_ms: 18.522694753482956
2025-03-13 12:55:43,714 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:43,714 [INFO]: 	nb vectors: 10156
2025-03-13 12:55:43,714 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:43,714 [INFO]: 	compression ratio: 0.9986195095763892
2025-03-13 12:55:43,714 [INFO]: }
2025-03-13 12:55:43,714 [INFO]: 	>>> Finished "Creating the index" in 133.9741 secs
2025-03-13 12:55:43,714 [INFO]: >>> Finished "Launching the whole pipeline" in 134.0132 secs
2025-03-13 12:55:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 61029 [episode count 5/20]
[retrieval_preprocessing] for episode 93849 [episode count 6/20], we have num_retrieval=np.int64(10844) num_query=np.int64(407)
2025-03-13 12:55:51,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:53,086 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:53
2025-03-13 12:55:53,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1814.15it/s]
2025-03-13 12:55:53,123 [INFO]: There are 10844 embeddings of dim 49152
2025-03-13 12:55:53,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 12:55:53,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:53
2025-03-13 12:55:53,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:53,123 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 12:55:53,123 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:55:53,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:55:53,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:53
2025-03-13 12:55:53,123 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:53,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:55:53,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:53
2025-03-13 12:55:53,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:53,124 [INFO]: 	Creating the index 03/13/2025, 12:55:53
2025-03-13 12:55:53,124 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:55:53
2025-03-13 12:55:53,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 12:55:53,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:53
2025-03-13 12:55:53,125 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 12:55:53,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  7.24it/s] 13%|█▎        | 6/45 [00:00<00:01, 28.41it/s] 27%|██▋       | 12/45 [00:00<00:00, 40.14it/s] 40%|████      | 18/45 [00:00<00:00, 45.96it/s] 51%|█████     | 23/45 [00:05<00:07,  2.85it/s] 64%|██████▍   | 29/45 [00:05<00:03,  4.44it/s] 78%|███████▊  | 35/45 [00:05<00:01,  6.56it/s] 91%|█████████ | 41/45 [00:05<00:00,  9.27it/s]100%|██████████| 45/45 [00:12<00:00,  3.52it/s]
2025-03-13 12:56:05,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:05
2025-03-13 12:57:32,883 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.9765 secs
2025-03-13 12:57:32,884 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 12:57:32,884 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.41it/s]
2025-03-13 12:58:17,028 [INFO]: 	>>> Finished "Compute fast metrics" in 44.1438 secs
2025-03-13 12:58:17,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.9038 secs
2025-03-13 12:58:17,028 [INFO]: {
2025-03-13 12:58:17,029 [INFO]: 	index_key: HNSW32
2025-03-13 12:58:17,029 [INFO]: 	index_param: efSearch=107
2025-03-13 12:58:17,029 [INFO]: 	index_path: knn.index
2025-03-13 12:58:17,029 [INFO]: 	size in bytes: 2134965042
2025-03-13 12:58:17,029 [INFO]: 	avg_search_speed_ms: 8.758555110764156
2025-03-13 12:58:17,029 [INFO]: 	99p_search_speed_ms: 14.628867364954178
2025-03-13 12:58:17,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:17,029 [INFO]: 	nb vectors: 10844
2025-03-13 12:58:17,029 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:17,029 [INFO]: 	compression ratio: 0.9986192326609533
2025-03-13 12:58:17,029 [INFO]: }
2025-03-13 12:58:17,029 [INFO]: 	>>> Finished "Creating the index" in 143.9051 secs
2025-03-13 12:58:17,029 [INFO]: >>> Finished "Launching the whole pipeline" in 143.9428 secs
2025-03-13 12:58:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 93849 [episode count 6/20]
[retrieval_preprocessing] for episode 5292 [episode count 7/20], we have num_retrieval=np.int64(10202) num_query=np.int64(1049)
2025-03-13 12:58:20,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:21,437 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:21
2025-03-13 12:58:21,438 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.99it/s]
2025-03-13 12:58:21,470 [INFO]: There are 10202 embeddings of dim 49152
2025-03-13 12:58:21,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 12:58:21,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:21,470 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:58:21,470 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:58:21,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:21,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,470 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:21,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:21,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:21
2025-03-13 12:58:21,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:21,471 [INFO]: 	Creating the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,471 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:58:21
2025-03-13 12:58:21,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:58:21,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,472 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:58:21,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  8.16it/s] 14%|█▍        | 6/43 [00:00<00:01, 30.62it/s] 28%|██▊       | 12/43 [00:00<00:00, 41.71it/s] 42%|████▏     | 18/43 [00:00<00:00, 46.70it/s] 53%|█████▎    | 23/43 [00:05<00:08,  2.47it/s] 67%|██████▋   | 29/43 [00:06<00:03,  3.86it/s] 79%|███████▉  | 34/43 [00:06<00:01,  5.39it/s] 93%|█████████▎| 40/43 [00:06<00:00,  7.84it/s]100%|██████████| 43/43 [00:14<00:00,  2.99it/s]
2025-03-13 12:58:35,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:35
2025-03-13 12:59:53,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.8399 secs
2025-03-13 12:59:53,690 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 12:59:53,690 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 13:00:23,092 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4020 secs
2025-03-13 13:00:23,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.6204 secs
2025-03-13 13:00:23,092 [INFO]: {
2025-03-13 13:00:23,092 [INFO]: 	index_key: HNSW32
2025-03-13 13:00:23,092 [INFO]: 	index_param: efSearch=109
2025-03-13 13:00:23,092 [INFO]: 	index_path: knn.index
2025-03-13 13:00:23,092 [INFO]: 	size in bytes: 2008567706
2025-03-13 13:00:23,092 [INFO]: 	avg_search_speed_ms: 8.911778033526744
2025-03-13 13:00:23,092 [INFO]: 	99p_search_speed_ms: 14.36910135671495
2025-03-13 13:00:23,092 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:23,092 [INFO]: 	nb vectors: 10202
2025-03-13 13:00:23,092 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:23,092 [INFO]: 	compression ratio: 0.9986194689919007
2025-03-13 13:00:23,092 [INFO]: }
2025-03-13 13:00:23,092 [INFO]: 	>>> Finished "Creating the index" in 121.6219 secs
2025-03-13 13:00:23,093 [INFO]: >>> Finished "Launching the whole pipeline" in 121.6550 secs
2025-03-13 13:00:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 5292 [episode count 7/20]
[retrieval_preprocessing] for episode 71935 [episode count 8/20], we have num_retrieval=np.int64(10762) num_query=np.int64(489)
2025-03-13 13:00:29,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:31,248 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:31
2025-03-13 13:00:31,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]
2025-03-13 13:00:31,279 [INFO]: There are 10762 embeddings of dim 49152
2025-03-13 13:00:31,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 13:00:31,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:31
2025-03-13 13:00:31,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:31,280 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 13:00:31,280 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:00:31,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:31,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:31
2025-03-13 13:00:31,280 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:31,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:00:31,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:31
2025-03-13 13:00:31,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:31,280 [INFO]: 	Creating the index 03/13/2025, 13:00:31
2025-03-13 13:00:31,280 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:00:31
2025-03-13 13:00:31,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:00:31,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:31
2025-03-13 13:00:31,281 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:00:31,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:05,  7.47it/s]  4%|▍         | 2/45 [00:00<00:05,  8.38it/s]  9%|▉         | 4/45 [00:00<00:04,  9.55it/s] 11%|█         | 5/45 [00:00<00:04,  9.42it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.21it/s] 16%|█▌        | 7/45 [00:00<00:04,  9.10it/s] 18%|█▊        | 8/45 [00:00<00:04,  9.04it/s] 20%|██        | 9/45 [00:00<00:03,  9.01it/s] 22%|██▏       | 10/45 [00:01<00:03,  8.99it/s] 24%|██▍       | 11/45 [00:01<00:03,  9.06it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.03it/s] 29%|██▉       | 13/45 [00:01<00:03,  9.00it/s] 31%|███       | 14/45 [00:01<00:03,  8.98it/s] 42%|████▏     | 19/45 [00:01<00:01, 19.98it/s] 49%|████▉     | 22/45 [00:07<00:17,  1.29it/s] 62%|██████▏   | 28/45 [00:07<00:06,  2.59it/s] 76%|███████▌  | 34/45 [00:07<00:02,  4.33it/s] 89%|████████▉ | 40/45 [00:08<00:00,  6.61it/s] 98%|█████████▊| 44/45 [00:14<00:00,  1.76it/s]100%|██████████| 45/45 [00:16<00:00,  2.70it/s]
2025-03-13 13:00:47,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:47
2025-03-13 13:02:20,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.9187 secs
2025-03-13 13:02:20,844 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 13:02:20,844 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.02it/s]
2025-03-13 13:02:45,942 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0976 secs
2025-03-13 13:02:45,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.6616 secs
2025-03-13 13:02:45,943 [INFO]: {
2025-03-13 13:02:45,943 [INFO]: 	index_key: HNSW32
2025-03-13 13:02:45,943 [INFO]: 	index_param: efSearch=106
2025-03-13 13:02:45,943 [INFO]: 	index_path: knn.index
2025-03-13 13:02:45,943 [INFO]: 	size in bytes: 2118820442
2025-03-13 13:02:45,943 [INFO]: 	avg_search_speed_ms: 9.470591583522037
2025-03-13 13:02:45,943 [INFO]: 	99p_search_speed_ms: 16.970016178674996
2025-03-13 13:02:45,943 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:45,943 [INFO]: 	nb vectors: 10762
2025-03-13 13:02:45,943 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:45,943 [INFO]: 	compression ratio: 0.9986194460172194
2025-03-13 13:02:45,943 [INFO]: }
2025-03-13 13:02:45,943 [INFO]: 	>>> Finished "Creating the index" in 134.6630 secs
2025-03-13 13:02:45,943 [INFO]: >>> Finished "Launching the whole pipeline" in 134.6953 secs
2025-03-13 13:02:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 71935 [episode count 8/20]
[retrieval_preprocessing] for episode 48902 [episode count 9/20], we have num_retrieval=np.int64(10866) num_query=np.int64(385)
2025-03-13 13:02:50,004 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:51,615 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:51
2025-03-13 13:02:51,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1308.68it/s]
2025-03-13 13:02:51,648 [INFO]: There are 10866 embeddings of dim 49152
2025-03-13 13:02:51,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 13:02:51,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:51
2025-03-13 13:02:51,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:51,648 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 13:02:51,648 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:02:51,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:51,648 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:51
2025-03-13 13:02:51,648 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:51,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:02:51,649 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:51
2025-03-13 13:02:51,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:51,649 [INFO]: 	Creating the index 03/13/2025, 13:02:51
2025-03-13 13:02:51,649 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:02:51
2025-03-13 13:02:51,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:02:51,650 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:51
2025-03-13 13:02:51,650 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:02:51,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  7.05it/s] 13%|█▎        | 6/45 [00:00<00:01, 27.64it/s] 29%|██▉       | 13/45 [00:00<00:00, 42.33it/s] 44%|████▍     | 20/45 [00:00<00:00, 49.79it/s] 58%|█████▊    | 26/45 [00:05<00:06,  2.89it/s] 71%|███████   | 32/45 [00:06<00:03,  4.28it/s] 84%|████████▍ | 38/45 [00:06<00:01,  6.13it/s] 96%|█████████▌| 43/45 [00:15<00:01,  1.51it/s]100%|██████████| 45/45 [00:19<00:00,  2.36it/s]
2025-03-13 13:03:10,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:10
2025-03-13 13:05:02,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 111.9769 secs
2025-03-13 13:05:02,676 [INFO]: The best hyperparameters are: efSearch=74
2025-03-13 13:05:02,676 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 13:05:32,453 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7765 secs
2025-03-13 13:05:32,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.8048 secs
2025-03-13 13:05:32,455 [INFO]: {
2025-03-13 13:05:32,455 [INFO]: 	index_key: HNSW32
2025-03-13 13:05:32,455 [INFO]: 	index_param: efSearch=74
2025-03-13 13:05:32,455 [INFO]: 	index_path: knn.index
2025-03-13 13:05:32,455 [INFO]: 	size in bytes: 2139296442
2025-03-13 13:05:32,455 [INFO]: 	avg_search_speed_ms: 8.755300355090021
2025-03-13 13:05:32,455 [INFO]: 	99p_search_speed_ms: 20.105629016179584
2025-03-13 13:05:32,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:05:32,455 [INFO]: 	nb vectors: 10866
2025-03-13 13:05:32,455 [INFO]: 	vectors dimension: 49152
2025-03-13 13:05:32,455 [INFO]: 	compression ratio: 0.9986192123999241
2025-03-13 13:05:32,455 [INFO]: }
2025-03-13 13:05:32,455 [INFO]: 	>>> Finished "Creating the index" in 160.8064 secs
2025-03-13 13:05:32,455 [INFO]: >>> Finished "Launching the whole pipeline" in 160.8401 secs
2025-03-13 13:05:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 48902 [episode count 9/20]
[retrieval_preprocessing] for episode 88842 [episode count 10/20], we have num_retrieval=np.int64(10671) num_query=np.int64(580)
2025-03-13 13:05:45,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:05:47,096 [INFO]: Launching the whole pipeline 03/13/2025, 13:05:47
2025-03-13 13:05:47,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:05:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.73it/s]
2025-03-13 13:05:47,126 [INFO]: There are 10671 embeddings of dim 49152
2025-03-13 13:05:47,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 13:05:47,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:05:47
2025-03-13 13:05:47,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:05:47,127 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 13:05:47,127 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:05:47,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:05:47,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:05:47
2025-03-13 13:05:47,127 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:05:47,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:05:47,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:05:47
2025-03-13 13:05:47,128 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:05:47,128 [INFO]: 	Creating the index 03/13/2025, 13:05:47
2025-03-13 13:05:47,128 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:05:47
2025-03-13 13:05:47,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-13 13:05:47,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:05:47
2025-03-13 13:05:47,132 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:05:47,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:13,  3.23it/s]  7%|▋         | 3/44 [00:00<00:04,  8.39it/s] 11%|█▏        | 5/44 [00:00<00:03,  9.76it/s] 16%|█▌        | 7/44 [00:01<00:06,  5.74it/s] 18%|█▊        | 8/44 [00:01<00:09,  3.76it/s] 20%|██        | 9/44 [00:03<00:23,  1.48it/s] 25%|██▌       | 11/44 [00:03<00:13,  2.39it/s] 32%|███▏      | 14/44 [00:03<00:07,  4.20it/s] 36%|███▋      | 16/44 [00:06<00:15,  1.83it/s] 41%|████      | 18/44 [00:08<00:17,  1.45it/s] 43%|████▎     | 19/44 [00:09<00:17,  1.40it/s] 45%|████▌     | 20/44 [00:09<00:14,  1.62it/s] 48%|████▊     | 21/44 [00:14<00:38,  1.66s/it] 55%|█████▍    | 24/44 [00:15<00:21,  1.05s/it] 57%|█████▋    | 25/44 [00:18<00:26,  1.38s/it] 59%|█████▉    | 26/44 [00:18<00:20,  1.12s/it] 61%|██████▏   | 27/44 [00:18<00:15,  1.13it/s] 64%|██████▎   | 28/44 [00:19<00:11,  1.45it/s] 66%|██████▌   | 29/44 [00:19<00:08,  1.82it/s] 68%|██████▊   | 30/44 [00:19<00:05,  2.35it/s] 70%|███████   | 31/44 [00:19<00:04,  2.98it/s] 75%|███████▌  | 33/44 [00:19<00:02,  4.17it/s] 80%|███████▉  | 35/44 [00:21<00:04,  1.83it/s] 84%|████████▍ | 37/44 [00:21<00:02,  2.49it/s] 89%|████████▊ | 39/44 [00:22<00:01,  3.30it/s] 91%|█████████ | 40/44 [00:22<00:01,  3.29it/s] 93%|█████████▎| 41/44 [00:22<00:00,  3.29it/s] 95%|█████████▌| 42/44 [00:30<00:03,  1.98s/it] 98%|█████████▊| 43/44 [00:30<00:01,  1.51s/it]100%|██████████| 44/44 [00:32<00:00,  1.63s/it]100%|██████████| 44/44 [00:32<00:00,  1.36it/s]
2025-03-13 13:06:19,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:19
2025-03-13 13:07:42,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.9701 secs
2025-03-13 13:07:42,402 [INFO]: The best hyperparameters are: efSearch=94
2025-03-13 13:07:42,402 [INFO]: 	Compute fast metrics 03/13/2025, 13:07:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 13:08:02,761 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3581 secs
2025-03-13 13:08:02,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.6295 secs
2025-03-13 13:08:02,762 [INFO]: {
2025-03-13 13:08:02,762 [INFO]: 	index_key: HNSW32
2025-03-13 13:08:02,762 [INFO]: 	index_param: efSearch=94
2025-03-13 13:08:02,762 [INFO]: 	index_path: knn.index
2025-03-13 13:08:02,762 [INFO]: 	size in bytes: 2100904598
2025-03-13 13:08:02,762 [INFO]: 	avg_search_speed_ms: 8.017601973713997
2025-03-13 13:08:02,762 [INFO]: 	99p_search_speed_ms: 13.563618259504434
2025-03-13 13:08:02,762 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:02,762 [INFO]: 	nb vectors: 10671
2025-03-13 13:08:02,762 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:02,762 [INFO]: 	compression ratio: 0.9986193423524508
2025-03-13 13:08:02,762 [INFO]: }
2025-03-13 13:08:02,762 [INFO]: 	>>> Finished "Creating the index" in 135.6333 secs
2025-03-13 13:08:02,762 [INFO]: >>> Finished "Launching the whole pipeline" in 135.6661 secs
2025-03-13 13:08:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 88842 [episode count 10/20]
[retrieval_preprocessing] for episode 2801 [episode count 11/20], we have num_retrieval=np.int64(10929) num_query=np.int64(322)
2025-03-13 13:08:10,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:11,810 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:11
2025-03-13 13:08:11,810 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.33it/s]
2025-03-13 13:08:11,837 [INFO]: There are 10929 embeddings of dim 49152
2025-03-13 13:08:11,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 13:08:11,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:11
2025-03-13 13:08:11,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:11,837 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 13:08:11,837 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:08:11,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:08:11,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:11
2025-03-13 13:08:11,837 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:11,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:08:11,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:11
2025-03-13 13:08:11,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:11,838 [INFO]: 	Creating the index 03/13/2025, 13:08:11
2025-03-13 13:08:11,838 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:08:11
2025-03-13 13:08:11,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 13:08:11,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:11
2025-03-13 13:08:11,839 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:08:11,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.72it/s]  7%|▋         | 3/45 [00:00<00:05,  8.31it/s] 11%|█         | 5/45 [00:00<00:04,  9.73it/s] 16%|█▌        | 7/45 [00:00<00:03, 10.49it/s] 20%|██        | 9/45 [00:00<00:03, 11.01it/s] 24%|██▍       | 11/45 [00:01<00:03, 11.31it/s] 29%|██▉       | 13/45 [00:01<00:02, 11.70it/s] 33%|███▎      | 15/45 [00:01<00:02, 11.88it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.96it/s] 42%|████▏     | 19/45 [00:01<00:02, 12.17it/s] 47%|████▋     | 21/45 [00:06<00:20,  1.16it/s] 51%|█████     | 23/45 [00:07<00:13,  1.60it/s] 56%|█████▌    | 25/45 [00:07<00:09,  2.18it/s] 60%|██████    | 27/45 [00:07<00:06,  2.90it/s] 64%|██████▍   | 29/45 [00:07<00:04,  3.79it/s] 69%|██████▉   | 31/45 [00:07<00:02,  4.83it/s] 73%|███████▎  | 33/45 [00:07<00:02,  5.96it/s] 78%|███████▊  | 35/45 [00:08<00:01,  7.11it/s] 82%|████████▏ | 37/45 [00:08<00:00,  8.22it/s] 87%|████████▋ | 39/45 [00:08<00:00,  9.10it/s] 91%|█████████ | 41/45 [00:08<00:00,  9.87it/s] 96%|█████████▌| 43/45 [00:15<00:02,  1.06s/it]100%|██████████| 45/45 [00:17<00:00,  1.13s/it]100%|██████████| 45/45 [00:17<00:00,  2.55it/s]
2025-03-13 13:08:29,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:29
2025-03-13 13:10:05,742 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.2126 secs
2025-03-13 13:10:05,742 [INFO]: The best hyperparameters are: efSearch=84
2025-03-13 13:10:05,742 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 13:10:44,213 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4711 secs
2025-03-13 13:10:44,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.3756 secs
2025-03-13 13:10:44,215 [INFO]: {
2025-03-13 13:10:44,215 [INFO]: 	index_key: HNSW32
2025-03-13 13:10:44,215 [INFO]: 	index_param: efSearch=84
2025-03-13 13:10:44,215 [INFO]: 	index_path: knn.index
2025-03-13 13:10:44,215 [INFO]: 	size in bytes: 2151700014
2025-03-13 13:10:44,215 [INFO]: 	avg_search_speed_ms: 9.909092375502818
2025-03-13 13:10:44,215 [INFO]: 	99p_search_speed_ms: 17.17169377021489
2025-03-13 13:10:44,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:44,215 [INFO]: 	nb vectors: 10929
2025-03-13 13:10:44,215 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:44,215 [INFO]: 	compression ratio: 0.9986191467301817
2025-03-13 13:10:44,215 [INFO]: }
2025-03-13 13:10:44,215 [INFO]: 	>>> Finished "Creating the index" in 152.3776 secs
2025-03-13 13:10:44,215 [INFO]: >>> Finished "Launching the whole pipeline" in 152.4049 secs
2025-03-13 13:10:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 2801 [episode count 11/20]
[retrieval_preprocessing] for episode 69406 [episode count 12/20], we have num_retrieval=np.int64(10756) num_query=np.int64(495)
2025-03-13 13:10:50,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:52,385 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:52
2025-03-13 13:10:52,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.97it/s]
2025-03-13 13:10:52,410 [INFO]: There are 10756 embeddings of dim 49152
2025-03-13 13:10:52,411 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 13:10:52,411 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:52
2025-03-13 13:10:52,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:52,411 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 13:10:52,411 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:10:52,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:10:52,411 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:52
2025-03-13 13:10:52,411 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:52,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:52,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:52
2025-03-13 13:10:52,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:52,411 [INFO]: 	Creating the index 03/13/2025, 13:10:52
2025-03-13 13:10:52,411 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:10:52
2025-03-13 13:10:52,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:10:52,412 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:52
2025-03-13 13:10:52,412 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:10:52,412 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.60it/s]  7%|▋         | 3/45 [00:00<00:04,  8.65it/s] 11%|█         | 5/45 [00:00<00:04,  9.93it/s] 16%|█▌        | 7/45 [00:00<00:03, 11.92it/s] 20%|██        | 9/45 [00:00<00:02, 12.07it/s] 24%|██▍       | 11/45 [00:00<00:02, 12.26it/s] 29%|██▉       | 13/45 [00:01<00:02, 12.26it/s] 33%|███▎      | 15/45 [00:01<00:02, 12.42it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.36it/s] 42%|████▏     | 19/45 [00:01<00:02, 12.37it/s] 47%|████▋     | 21/45 [00:07<00:23,  1.04it/s] 51%|█████     | 23/45 [00:07<00:15,  1.43it/s] 53%|█████▎    | 24/45 [00:07<00:12,  1.69it/s] 56%|█████▌    | 25/45 [00:07<00:09,  2.03it/s] 58%|█████▊    | 26/45 [00:08<00:07,  2.47it/s] 62%|██████▏   | 28/45 [00:08<00:04,  3.56it/s] 67%|██████▋   | 30/45 [00:08<00:03,  4.76it/s] 71%|███████   | 32/45 [00:08<00:02,  5.75it/s] 76%|███████▌  | 34/45 [00:08<00:01,  6.76it/s] 80%|████████  | 36/45 [00:08<00:01,  7.45it/s] 84%|████████▍ | 38/45 [00:09<00:00,  8.05it/s] 89%|████████▉ | 40/45 [00:09<00:00,  8.48it/s] 93%|█████████▎| 42/45 [00:16<00:03,  1.15s/it] 96%|█████████▌| 43/45 [00:16<00:01,  1.04it/s] 98%|█████████▊| 44/45 [00:16<00:00,  1.27it/s]100%|██████████| 45/45 [00:18<00:00,  1.12s/it]100%|██████████| 45/45 [00:18<00:00,  2.38it/s]
2025-03-13 13:11:11,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:11:11
2025-03-13 13:12:28,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1230 secs
2025-03-13 13:12:28,424 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 13:12:28,424 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 13:12:57,983 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5593 secs
2025-03-13 13:12:57,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.5718 secs
2025-03-13 13:12:57,984 [INFO]: {
2025-03-13 13:12:57,984 [INFO]: 	index_key: HNSW32
2025-03-13 13:12:57,984 [INFO]: 	index_param: efSearch=118
2025-03-13 13:12:57,984 [INFO]: 	index_path: knn.index
2025-03-13 13:12:57,984 [INFO]: 	size in bytes: 2117639058
2025-03-13 13:12:57,984 [INFO]: 	avg_search_speed_ms: 8.424118168851347
2025-03-13 13:12:57,984 [INFO]: 	99p_search_speed_ms: 14.702772852033378
2025-03-13 13:12:57,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:57,984 [INFO]: 	nb vectors: 10756
2025-03-13 13:12:57,984 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:57,984 [INFO]: 	compression ratio: 0.9986194956175577
2025-03-13 13:12:57,984 [INFO]: }
2025-03-13 13:12:57,984 [INFO]: 	>>> Finished "Creating the index" in 125.5732 secs
2025-03-13 13:12:57,984 [INFO]: >>> Finished "Launching the whole pipeline" in 125.5989 secs
2025-03-13 13:12:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 69406 [episode count 12/20]
[retrieval_preprocessing] for episode 75097 [episode count 13/20], we have num_retrieval=np.int64(10677) num_query=np.int64(574)
2025-03-13 13:13:04,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:06,406 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:06
2025-03-13 13:13:06,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.73it/s]
2025-03-13 13:13:06,432 [INFO]: There are 10677 embeddings of dim 49152
2025-03-13 13:13:06,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 13:13:06,433 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:06
2025-03-13 13:13:06,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:06,433 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 13:13:06,433 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:13:06,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:06,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:06
2025-03-13 13:13:06,433 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:06,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:13:06,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:06
2025-03-13 13:13:06,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:06,433 [INFO]: 	Creating the index 03/13/2025, 13:13:06
2025-03-13 13:13:06,433 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:13:06
2025-03-13 13:13:06,435 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 13:13:06,435 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:06
2025-03-13 13:13:06,435 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:13:06,435 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:09,  4.35it/s]  7%|▋         | 3/44 [00:00<00:05,  7.99it/s] 11%|█▏        | 5/44 [00:00<00:04,  9.40it/s] 16%|█▌        | 7/44 [00:00<00:03, 10.13it/s] 20%|██        | 9/44 [00:00<00:03, 10.51it/s] 25%|██▌       | 11/44 [00:01<00:03, 10.29it/s] 30%|██▉       | 13/44 [00:01<00:02, 10.54it/s] 34%|███▍      | 15/44 [00:01<00:02, 10.65it/s] 39%|███▊      | 17/44 [00:01<00:02, 10.81it/s] 43%|████▎     | 19/44 [00:01<00:02, 10.88it/s] 48%|████▊     | 21/44 [00:06<00:17,  1.30it/s] 50%|█████     | 22/44 [00:06<00:14,  1.54it/s] 55%|█████▍    | 24/44 [00:06<00:09,  2.19it/s] 59%|█████▉    | 26/44 [00:06<00:06,  2.98it/s] 64%|██████▎   | 28/44 [00:07<00:04,  3.90it/s] 68%|██████▊   | 30/44 [00:07<00:02,  4.94it/s] 73%|███████▎  | 32/44 [00:07<00:02,  5.99it/s] 77%|███████▋  | 34/44 [00:07<00:01,  6.98it/s] 82%|████████▏ | 36/44 [00:07<00:01,  7.77it/s] 86%|████████▋ | 38/44 [00:07<00:00,  8.52it/s] 91%|█████████ | 40/44 [00:08<00:00,  9.26it/s] 95%|█████████▌| 42/44 [00:14<00:02,  1.08s/it] 98%|█████████▊| 43/44 [00:14<00:00,  1.11it/s]100%|██████████| 44/44 [00:16<00:00,  1.13s/it]100%|██████████| 44/44 [00:16<00:00,  2.60it/s]
2025-03-13 13:13:23,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:23
2025-03-13 13:14:35,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.8413 secs
2025-03-13 13:14:35,281 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 13:14:35,281 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 13:15:16,860 [INFO]: 	>>> Finished "Compute fast metrics" in 41.5786 secs
2025-03-13 13:15:16,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.4260 secs
2025-03-13 13:15:16,861 [INFO]: {
2025-03-13 13:15:16,861 [INFO]: 	index_key: HNSW32
2025-03-13 13:15:16,861 [INFO]: 	index_param: efSearch=138
2025-03-13 13:15:16,861 [INFO]: 	index_path: knn.index
2025-03-13 13:15:16,861 [INFO]: 	size in bytes: 2102085854
2025-03-13 13:15:16,861 [INFO]: 	avg_search_speed_ms: 11.787712981253073
2025-03-13 13:15:16,861 [INFO]: 	99p_search_speed_ms: 20.113632204011083
2025-03-13 13:15:16,861 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:16,861 [INFO]: 	nb vectors: 10677
2025-03-13 13:15:16,861 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:16,861 [INFO]: 	compression ratio: 0.9986193532512112
2025-03-13 13:15:16,861 [INFO]: }
2025-03-13 13:15:16,861 [INFO]: 	>>> Finished "Creating the index" in 130.4280 secs
2025-03-13 13:15:16,861 [INFO]: >>> Finished "Launching the whole pipeline" in 130.4553 secs
2025-03-13 13:15:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 75097 [episode count 13/20]
[retrieval_preprocessing] for episode 54974 [episode count 14/20], we have num_retrieval=np.int64(10914) num_query=np.int64(337)
2025-03-13 13:15:24,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:26,412 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:26
2025-03-13 13:15:26,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-13 13:15:26,437 [INFO]: There are 10914 embeddings of dim 49152
2025-03-13 13:15:26,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 13:15:26,437 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:26
2025-03-13 13:15:26,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:26,438 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 13:15:26,438 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:15:26,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:26,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:26
2025-03-13 13:15:26,438 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:26,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:15:26,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:26
2025-03-13 13:15:26,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:26,438 [INFO]: 	Creating the index 03/13/2025, 13:15:26
2025-03-13 13:15:26,438 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:15:26
2025-03-13 13:15:26,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:15:26,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:26
2025-03-13 13:15:26,439 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:15:26,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:11,  4.00it/s]  4%|▍         | 2/45 [00:00<00:07,  5.63it/s]  7%|▋         | 3/45 [00:00<00:06,  6.60it/s]  9%|▉         | 4/45 [00:00<00:05,  7.10it/s] 11%|█         | 5/45 [00:00<00:05,  7.44it/s] 13%|█▎        | 6/45 [00:00<00:05,  7.66it/s] 16%|█▌        | 7/45 [00:00<00:04,  7.82it/s] 18%|█▊        | 8/45 [00:01<00:04,  8.06it/s] 20%|██        | 9/45 [00:01<00:04,  8.14it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.22it/s] 24%|██▍       | 11/45 [00:01<00:04,  8.16it/s] 27%|██▋       | 12/45 [00:01<00:04,  8.20it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.92it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.97it/s] 38%|███▊      | 17/45 [00:02<00:02,  9.66it/s] 42%|████▏     | 19/45 [00:02<00:02, 10.19it/s] 47%|████▋     | 21/45 [00:06<00:20,  1.16it/s] 51%|█████     | 23/45 [00:07<00:13,  1.67it/s] 56%|█████▌    | 25/45 [00:07<00:08,  2.30it/s] 60%|██████    | 27/45 [00:07<00:05,  3.10it/s] 64%|██████▍   | 29/45 [00:07<00:03,  4.03it/s] 69%|██████▉   | 31/45 [00:07<00:02,  5.02it/s] 73%|███████▎  | 33/45 [00:07<00:01,  6.06it/s] 78%|███████▊  | 35/45 [00:08<00:01,  7.03it/s] 82%|████████▏ | 37/45 [00:08<00:01,  7.99it/s] 87%|████████▋ | 39/45 [00:08<00:00,  8.75it/s] 91%|█████████ | 41/45 [00:08<00:00,  9.50it/s] 96%|█████████▌| 43/45 [00:14<00:01,  1.01it/s]100%|██████████| 45/45 [00:16<00:00,  1.03s/it]100%|██████████| 45/45 [00:16<00:00,  2.66it/s]
2025-03-13 13:15:43,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:43
2025-03-13 13:16:58,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.6997 secs
2025-03-13 13:16:58,085 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 13:16:58,085 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 13:17:26,855 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7702 secs
2025-03-13 13:17:26,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.4168 secs
2025-03-13 13:17:26,856 [INFO]: {
2025-03-13 13:17:26,856 [INFO]: 	index_key: HNSW32
2025-03-13 13:17:26,856 [INFO]: 	index_param: efSearch=133
2025-03-13 13:17:26,856 [INFO]: 	index_path: knn.index
2025-03-13 13:17:26,856 [INFO]: 	size in bytes: 2148746746
2025-03-13 13:17:26,856 [INFO]: 	avg_search_speed_ms: 9.16951851011019
2025-03-13 13:17:26,856 [INFO]: 	99p_search_speed_ms: 15.928642940707476
2025-03-13 13:17:26,856 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:17:26,856 [INFO]: 	nb vectors: 10914
2025-03-13 13:17:26,856 [INFO]: 	vectors dimension: 49152
2025-03-13 13:17:26,856 [INFO]: 	compression ratio: 0.9986191792934541
2025-03-13 13:17:26,856 [INFO]: }
2025-03-13 13:17:26,856 [INFO]: 	>>> Finished "Creating the index" in 120.4183 secs
2025-03-13 13:17:26,856 [INFO]: >>> Finished "Launching the whole pipeline" in 120.4442 secs
2025-03-13 13:17:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:17:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 54974 [episode count 14/20]
[retrieval_preprocessing] for episode 14189 [episode count 15/20], we have num_retrieval=np.int64(10580) num_query=np.int64(671)
2025-03-13 13:17:32,887 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:34,926 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:34
2025-03-13 13:17:34,926 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.81it/s]
2025-03-13 13:17:34,949 [INFO]: There are 10580 embeddings of dim 49152
2025-03-13 13:17:34,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 13:17:34,950 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:34
2025-03-13 13:17:34,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:34,950 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 13:17:34,950 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:17:34,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:17:34,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:34
2025-03-13 13:17:34,950 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:34,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:17:34,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:34
2025-03-13 13:17:34,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:34,950 [INFO]: 	Creating the index 03/13/2025, 13:17:34
2025-03-13 13:17:34,950 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:17:34
2025-03-13 13:17:34,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 13:17:34,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:34
2025-03-13 13:17:34,951 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:17:34,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:09,  4.59it/s]  7%|▋         | 3/44 [00:00<00:04,  8.56it/s] 11%|█▏        | 5/44 [00:00<00:03, 10.05it/s] 16%|█▌        | 7/44 [00:00<00:03, 10.73it/s] 20%|██        | 9/44 [00:00<00:03, 11.30it/s] 25%|██▌       | 11/44 [00:01<00:02, 11.65it/s] 30%|██▉       | 13/44 [00:01<00:02, 11.87it/s] 34%|███▍      | 15/44 [00:01<00:02, 12.06it/s] 39%|███▊      | 17/44 [00:01<00:02, 11.95it/s] 43%|████▎     | 19/44 [00:01<00:02, 12.02it/s] 48%|████▊     | 21/44 [00:06<00:17,  1.28it/s] 52%|█████▏    | 23/44 [00:06<00:11,  1.78it/s] 61%|██████▏   | 27/44 [00:06<00:05,  3.19it/s] 70%|███████   | 31/44 [00:06<00:02,  5.01it/s] 80%|███████▉  | 35/44 [00:06<00:01,  7.29it/s] 89%|████████▊ | 39/44 [00:06<00:00,  9.99it/s] 95%|█████████▌| 42/44 [00:14<00:01,  1.31it/s]100%|██████████| 44/44 [00:16<00:00,  2.67it/s]
2025-03-13 13:17:51,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:51
2025-03-13 13:19:07,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.0040 secs
2025-03-13 13:19:07,458 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 13:19:07,458 [INFO]: 	Compute fast metrics 03/13/2025, 13:19:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s]
2025-03-13 13:19:30,200 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7422 secs
2025-03-13 13:19:30,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.9162 secs
2025-03-13 13:19:30,868 [INFO]: {
2025-03-13 13:19:30,868 [INFO]: 	index_key: HNSW32
2025-03-13 13:19:30,868 [INFO]: 	index_param: efSearch=117
2025-03-13 13:19:30,868 [INFO]: 	index_path: knn.index
2025-03-13 13:19:30,868 [INFO]: 	size in bytes: 2082988626
2025-03-13 13:19:30,868 [INFO]: 	avg_search_speed_ms: 12.004776078523422
2025-03-13 13:19:30,868 [INFO]: 	99p_search_speed_ms: 27.519922684878107
2025-03-13 13:19:30,868 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:30,868 [INFO]: 	nb vectors: 10580
2025-03-13 13:19:30,868 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:30,868 [INFO]: 	compression ratio: 0.9986192982697545
2025-03-13 13:19:30,868 [INFO]: }
2025-03-13 13:19:30,868 [INFO]: 	>>> Finished "Creating the index" in 115.9182 secs
2025-03-13 13:19:30,868 [INFO]: >>> Finished "Launching the whole pipeline" in 115.9424 secs
2025-03-13 13:19:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 14189 [episode count 15/20]
[retrieval_preprocessing] for episode 31087 [episode count 16/20], we have num_retrieval=np.int64(10983) num_query=np.int64(268)
2025-03-13 13:19:39,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:41,252 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:41
2025-03-13 13:19:41,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.52it/s]
2025-03-13 13:19:41,278 [INFO]: There are 10983 embeddings of dim 49152
2025-03-13 13:19:41,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 13:19:41,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:41
2025-03-13 13:19:41,278 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:41,278 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 13:19:41,278 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:19:41,278 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:41,278 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:41
2025-03-13 13:19:41,279 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:41,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:19:41,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:41
2025-03-13 13:19:41,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:41,279 [INFO]: 	Creating the index 03/13/2025, 13:19:41
2025-03-13 13:19:41,279 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:19:41
2025-03-13 13:19:41,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:19:41,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:41
2025-03-13 13:19:41,280 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:19:41,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.27it/s]  4%|▍         | 2/46 [00:00<00:07,  6.10it/s]  7%|▋         | 3/46 [00:00<00:06,  6.97it/s]  9%|▊         | 4/46 [00:00<00:05,  7.48it/s] 11%|█         | 5/46 [00:00<00:05,  7.88it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.06it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.30it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.32it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.37it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.38it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.36it/s] 26%|██▌       | 12/46 [00:01<00:04,  8.43it/s] 30%|███       | 14/46 [00:01<00:03,  9.58it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.97it/s] 39%|███▉      | 18/46 [00:02<00:02, 10.45it/s] 43%|████▎     | 20/46 [00:02<00:02, 10.61it/s] 48%|████▊     | 22/46 [00:07<00:20,  1.15it/s] 50%|█████     | 23/46 [00:07<00:16,  1.38it/s] 52%|█████▏    | 24/46 [00:07<00:13,  1.69it/s] 57%|█████▋    | 26/46 [00:07<00:08,  2.46it/s] 59%|█████▊    | 27/46 [00:07<00:06,  2.93it/s] 63%|██████▎   | 29/46 [00:07<00:04,  4.01it/s] 67%|██████▋   | 31/46 [00:08<00:02,  5.11it/s] 72%|███████▏  | 33/46 [00:08<00:02,  6.13it/s] 76%|███████▌  | 35/46 [00:08<00:01,  7.01it/s] 78%|███████▊  | 36/46 [00:08<00:01,  7.42it/s] 80%|████████  | 37/46 [00:08<00:01,  7.81it/s] 83%|████████▎ | 38/46 [00:08<00:01,  7.99it/s] 85%|████████▍ | 39/46 [00:08<00:00,  8.26it/s] 87%|████████▋ | 40/46 [00:09<00:00,  8.29it/s] 89%|████████▉ | 41/46 [00:09<00:00,  8.32it/s] 91%|█████████▏| 42/46 [00:15<00:07,  1.80s/it] 96%|█████████▌| 44/46 [00:15<00:02,  1.04s/it]100%|██████████| 46/46 [00:17<00:00,  1.11s/it]100%|██████████| 46/46 [00:17<00:00,  2.57it/s]
2025-03-13 13:19:59,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:59
2025-03-13 13:21:22,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.7589 secs
2025-03-13 13:21:22,920 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 13:21:22,920 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-13 13:21:54,488 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5671 secs
2025-03-13 13:21:54,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2088 secs
2025-03-13 13:21:54,489 [INFO]: {
2025-03-13 13:21:54,489 [INFO]: 	index_key: HNSW32
2025-03-13 13:21:54,489 [INFO]: 	index_param: efSearch=113
2025-03-13 13:21:54,489 [INFO]: 	index_path: knn.index
2025-03-13 13:21:54,489 [INFO]: 	size in bytes: 2162331446
2025-03-13 13:21:54,489 [INFO]: 	avg_search_speed_ms: 8.833337810904853
2025-03-13 13:21:54,489 [INFO]: 	99p_search_speed_ms: 16.0642484202981
2025-03-13 13:21:54,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:54,489 [INFO]: 	nb vectors: 10983
2025-03-13 13:21:54,489 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:54,489 [INFO]: 	compression ratio: 0.9986191839343024
2025-03-13 13:21:54,489 [INFO]: }
2025-03-13 13:21:54,489 [INFO]: 	>>> Finished "Creating the index" in 133.2104 secs
2025-03-13 13:21:54,489 [INFO]: >>> Finished "Launching the whole pipeline" in 133.2371 secs
2025-03-13 13:21:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 31087 [episode count 16/20]
[retrieval_preprocessing] for episode 25977 [episode count 17/20], we have num_retrieval=np.int64(10684) num_query=np.int64(567)
2025-03-13 13:22:00,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:01,806 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:01
2025-03-13 13:22:01,806 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.42it/s]
2025-03-13 13:22:01,832 [INFO]: There are 10684 embeddings of dim 49152
2025-03-13 13:22:01,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 13:22:01,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:01
2025-03-13 13:22:01,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:01,832 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 13:22:01,832 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:22:01,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:22:01,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:01
2025-03-13 13:22:01,833 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:01,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:22:01,833 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:01
2025-03-13 13:22:01,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:01,833 [INFO]: 	Creating the index 03/13/2025, 13:22:01
2025-03-13 13:22:01,833 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:22:01
2025-03-13 13:22:01,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 13:22:01,834 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:01
2025-03-13 13:22:01,834 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:22:01,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.45it/s]  4%|▍         | 2/45 [00:00<00:06,  6.48it/s]  7%|▋         | 3/45 [00:00<00:05,  7.19it/s]  9%|▉         | 4/45 [00:00<00:05,  7.86it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.35it/s] 18%|█▊        | 8/45 [00:00<00:03, 10.36it/s] 22%|██▏       | 10/45 [00:01<00:03, 11.20it/s] 27%|██▋       | 12/45 [00:01<00:02, 11.71it/s] 31%|███       | 14/45 [00:01<00:02, 12.34it/s] 36%|███▌      | 16/45 [00:01<00:02, 10.94it/s] 40%|████      | 18/45 [00:01<00:02, 10.23it/s] 44%|████▍     | 20/45 [00:02<00:02,  9.82it/s] 49%|████▉     | 22/45 [00:06<00:19,  1.20it/s] 60%|██████    | 27/45 [00:07<00:07,  2.45it/s] 69%|██████▉   | 31/45 [00:07<00:03,  3.77it/s] 80%|████████  | 36/45 [00:07<00:01,  5.95it/s] 91%|█████████ | 41/45 [00:07<00:00,  8.66it/s]100%|██████████| 45/45 [00:16<00:00,  1.31it/s]100%|██████████| 45/45 [00:16<00:00,  2.70it/s]
2025-03-13 13:22:18,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:22:18
2025-03-13 13:23:54,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.7383 secs
2025-03-13 13:23:54,256 [INFO]: The best hyperparameters are: efSearch=78
2025-03-13 13:23:54,256 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 13:24:30,131 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8749 secs
2025-03-13 13:24:30,132 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.2987 secs
2025-03-13 13:24:30,133 [INFO]: {
2025-03-13 13:24:30,133 [INFO]: 	index_key: HNSW32
2025-03-13 13:24:30,133 [INFO]: 	index_param: efSearch=78
2025-03-13 13:24:30,133 [INFO]: 	index_path: knn.index
2025-03-13 13:24:30,133 [INFO]: 	size in bytes: 2103463986
2025-03-13 13:24:30,133 [INFO]: 	avg_search_speed_ms: 9.157201293779147
2025-03-13 13:24:30,133 [INFO]: 	99p_search_speed_ms: 16.571275813039385
2025-03-13 13:24:30,133 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:30,133 [INFO]: 	nb vectors: 10684
2025-03-13 13:24:30,133 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:30,133 [INFO]: 	compression ratio: 0.9986193659509605
2025-03-13 13:24:30,133 [INFO]: }
2025-03-13 13:24:30,133 [INFO]: 	>>> Finished "Creating the index" in 148.3001 secs
2025-03-13 13:24:30,133 [INFO]: >>> Finished "Launching the whole pipeline" in 148.3265 secs
2025-03-13 13:24:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 25977 [episode count 17/20]
[retrieval_preprocessing] for episode 12671 [episode count 18/20], we have num_retrieval=np.int64(10622) num_query=np.int64(629)
2025-03-13 13:24:36,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:38,965 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:38
2025-03-13 13:24:38,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1073.54it/s]
2025-03-13 13:24:39,008 [INFO]: There are 10622 embeddings of dim 49152
2025-03-13 13:24:39,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0430 secs
2025-03-13 13:24:39,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:39
2025-03-13 13:24:39,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:39,009 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 13:24:39,009 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:24:39,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:24:39,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:39
2025-03-13 13:24:39,009 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:39,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:24:39,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:39
2025-03-13 13:24:39,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:39,009 [INFO]: 	Creating the index 03/13/2025, 13:24:39
2025-03-13 13:24:39,009 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:24:39
2025-03-13 13:24:39,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 13:24:39,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:39
2025-03-13 13:24:39,011 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:24:39,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:06,  7.05it/s]  9%|▉         | 4/44 [00:00<00:02, 18.28it/s] 20%|██        | 9/44 [00:00<00:01, 29.34it/s] 32%|███▏      | 14/44 [00:00<00:00, 35.01it/s] 43%|████▎     | 19/44 [00:00<00:00, 38.66it/s] 52%|█████▏    | 23/44 [00:05<00:09,  2.28it/s] 64%|██████▎   | 28/44 [00:05<00:04,  3.48it/s] 75%|███████▌  | 33/44 [00:06<00:02,  5.10it/s] 89%|████████▊ | 39/44 [00:06<00:00,  7.64it/s]100%|██████████| 44/44 [00:15<00:00,  1.48it/s]100%|██████████| 44/44 [00:15<00:00,  2.79it/s]
2025-03-13 13:24:54,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:54
2025-03-13 13:26:22,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.9714 secs
2025-03-13 13:26:22,744 [INFO]: The best hyperparameters are: efSearch=94
2025-03-13 13:26:22,745 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 13:26:55,668 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9234 secs
2025-03-13 13:26:55,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.6581 secs
2025-03-13 13:26:55,669 [INFO]: {
2025-03-13 13:26:55,669 [INFO]: 	index_key: HNSW32
2025-03-13 13:26:55,669 [INFO]: 	index_param: efSearch=94
2025-03-13 13:26:55,669 [INFO]: 	index_path: knn.index
2025-03-13 13:26:55,669 [INFO]: 	size in bytes: 2091257418
2025-03-13 13:26:55,669 [INFO]: 	avg_search_speed_ms: 9.747942338641334
2025-03-13 13:26:55,669 [INFO]: 	99p_search_speed_ms: 17.47181249083951
2025-03-13 13:26:55,670 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:55,670 [INFO]: 	nb vectors: 10622
2025-03-13 13:26:55,670 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:55,670 [INFO]: 	compression ratio: 0.9986193751304125
2025-03-13 13:26:55,670 [INFO]: }
2025-03-13 13:26:55,670 [INFO]: 	>>> Finished "Creating the index" in 136.6603 secs
2025-03-13 13:26:55,670 [INFO]: >>> Finished "Launching the whole pipeline" in 136.7043 secs
2025-03-13 13:26:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 12671 [episode count 18/20]
[retrieval_preprocessing] for episode 21377 [episode count 19/20], we have num_retrieval=np.int64(10392) num_query=np.int64(859)
2025-03-13 13:27:03,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:05,075 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:05
2025-03-13 13:27:05,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.39it/s]
2025-03-13 13:27:05,104 [INFO]: There are 10392 embeddings of dim 49152
2025-03-13 13:27:05,104 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 13:27:05,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:05
2025-03-13 13:27:05,104 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:05,104 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 13:27:05,104 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:27:05,104 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:27:05,104 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:05
2025-03-13 13:27:05,105 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:05,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:27:05,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:05
2025-03-13 13:27:05,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:05,105 [INFO]: 	Creating the index 03/13/2025, 13:27:05
2025-03-13 13:27:05,105 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:27:05
2025-03-13 13:27:05,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 13:27:05,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:05
2025-03-13 13:27:05,106 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:27:05,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.53it/s]  7%|▋         | 3/43 [00:00<00:04,  8.57it/s] 12%|█▏        | 5/43 [00:00<00:03,  9.98it/s] 16%|█▋        | 7/43 [00:00<00:03, 10.67it/s] 21%|██        | 9/43 [00:00<00:03, 11.14it/s] 26%|██▌       | 11/43 [00:01<00:02, 11.36it/s] 30%|███       | 13/43 [00:01<00:02, 11.63it/s] 35%|███▍      | 15/43 [00:01<00:02, 11.71it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.37it/s] 44%|████▍     | 19/43 [00:01<00:02, 11.37it/s] 49%|████▉     | 21/43 [00:08<00:23,  1.05s/it] 53%|█████▎    | 23/43 [00:08<00:15,  1.33it/s] 58%|█████▊    | 25/43 [00:08<00:09,  1.84it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.48it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.26it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.16it/s] 77%|███████▋  | 33/43 [00:09<00:01,  5.14it/s] 81%|████████▏ | 35/43 [00:09<00:01,  6.13it/s] 86%|████████▌ | 37/43 [00:09<00:00,  6.99it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.01it/s] 95%|█████████▌| 41/43 [00:09<00:00,  9.06it/s]100%|██████████| 43/43 [00:18<00:00,  1.42s/it]100%|██████████| 43/43 [00:18<00:00,  2.29it/s]
2025-03-13 13:27:23,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:23
2025-03-13 13:28:40,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.6639 secs
2025-03-13 13:28:40,583 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 13:28:40,583 [INFO]: 	Compute fast metrics 03/13/2025, 13:28:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 13:29:08,349 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7666 secs
2025-03-13 13:29:08,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.2433 secs
2025-03-13 13:29:08,350 [INFO]: {
2025-03-13 13:29:08,350 [INFO]: 	index_key: HNSW32
2025-03-13 13:29:08,350 [INFO]: 	index_param: efSearch=111
2025-03-13 13:29:08,350 [INFO]: 	index_path: knn.index
2025-03-13 13:29:08,350 [INFO]: 	size in bytes: 2045974914
2025-03-13 13:29:08,350 [INFO]: 	avg_search_speed_ms: 8.398989546656184
2025-03-13 13:29:08,350 [INFO]: 	99p_search_speed_ms: 13.40539513621479
2025-03-13 13:29:08,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:29:08,350 [INFO]: 	nb vectors: 10392
2025-03-13 13:29:08,350 [INFO]: 	vectors dimension: 49152
2025-03-13 13:29:08,350 [INFO]: 	compression ratio: 0.9986194464161451
2025-03-13 13:29:08,350 [INFO]: }
2025-03-13 13:29:08,350 [INFO]: 	>>> Finished "Creating the index" in 123.2449 secs
2025-03-13 13:29:08,350 [INFO]: >>> Finished "Launching the whole pipeline" in 123.2745 secs
2025-03-13 13:29:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:29:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 21377 [episode count 19/20]
2025-03-13 13:29:13: [retrieval_preprocessing] finished for 4385851547_Place Plate in Dishwasher [chosen_id count 6/260]
2025-03-13 13:29:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 440287856_put_black_objects_in_drawer_and_close [chosen_id count 7/260]
2025-03-13 13:29:19: [retrieval_preprocessing] we have num_total=11537 embedding_dim=49152
[retrieval_preprocessing] for episode 25090 [episode count 0/20], we have num_retrieval=np.int64(10952) num_query=np.int64(585)
2025-03-13 13:29:23,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:29:24,830 [INFO]: Launching the whole pipeline 03/13/2025, 13:29:24
2025-03-13 13:29:24,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:29:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2718.28it/s]
2025-03-13 13:29:24,860 [INFO]: There are 10952 embeddings of dim 49152
2025-03-13 13:29:24,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 13:29:24,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:29:24
2025-03-13 13:29:24,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:29:24,861 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 13:29:24,861 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:29:24,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:29:24,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:29:24
2025-03-13 13:29:24,861 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:29:24,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:29:24,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:29:24
2025-03-13 13:29:24,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:29:24,861 [INFO]: 	Creating the index 03/13/2025, 13:29:24
2025-03-13 13:29:24,861 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:29:24
2025-03-13 13:29:24,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 13:29:24,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:29:24
2025-03-13 13:29:24,863 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 13:29:24,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  6.38it/s]  9%|▊         | 4/46 [00:00<00:02, 15.58it/s] 13%|█▎        | 6/46 [00:00<00:02, 16.16it/s] 17%|█▋        | 8/46 [00:00<00:02, 14.58it/s] 22%|██▏       | 10/46 [00:00<00:02, 14.67it/s] 26%|██▌       | 12/46 [00:00<00:02, 15.67it/s] 30%|███       | 14/46 [00:00<00:01, 16.61it/s] 35%|███▍      | 16/46 [00:01<00:01, 16.72it/s] 39%|███▉      | 18/46 [00:01<00:01, 16.58it/s] 43%|████▎     | 20/46 [00:01<00:01, 16.40it/s] 48%|████▊     | 22/46 [00:07<00:24,  1.01s/it] 52%|█████▏    | 24/46 [00:07<00:16,  1.37it/s] 57%|█████▋    | 26/46 [00:07<00:10,  1.88it/s] 61%|██████    | 28/46 [00:08<00:07,  2.53it/s] 65%|██████▌   | 30/46 [00:08<00:04,  3.33it/s] 70%|██████▉   | 32/46 [00:08<00:03,  4.28it/s] 74%|███████▍  | 34/46 [00:08<00:02,  5.28it/s] 78%|███████▊  | 36/46 [00:08<00:01,  6.35it/s] 83%|████████▎ | 38/46 [00:08<00:01,  7.48it/s] 87%|████████▋ | 40/46 [00:09<00:00,  8.47it/s]