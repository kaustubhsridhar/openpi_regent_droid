nohup: ignoring input
2025-03-13 10:50:42: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:50:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4570623316_orange_object_in_bowl [chosen_id count 0/260]
2025-03-13 10:50:44: [retrieval_preprocessing] we have num_total=2013 embedding_dim=49152
[retrieval_preprocessing] for episode 36869 [episode count 0/20], we have num_retrieval=np.int64(1923) num_query=np.int64(90)
2025-03-13 10:50:44,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:45,324 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:45
2025-03-13 10:50:45,324 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 747.38it/s]
2025-03-13 10:50:45,359 [INFO]: There are 1923 embeddings of dim 49152
2025-03-13 10:50:45,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 10:50:45,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:45,359 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:50:45,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:45,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:50:45,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,360 [INFO]: 396.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:45,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 10:50:45,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:45
2025-03-13 10:50:45,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:45,360 [INFO]: 	Creating the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:45
2025-03-13 10:50:45,362 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:50:45,362 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,362 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:50:45,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.57it/s] 50%|█████     | 4/8 [00:00<00:00, 17.93it/s]100%|██████████| 8/8 [00:01<00:00,  4.61it/s]100%|██████████| 8/8 [00:01<00:00,  5.23it/s]
2025-03-13 10:50:46,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:46
2025-03-13 10:51:10,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.2071 secs
2025-03-13 10:51:10,103 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 10:51:10,103 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s]
2025-03-13 10:51:21,649 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5459 secs
2025-03-13 10:51:21,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.2895 secs
2025-03-13 10:51:21,651 [INFO]: {
2025-03-13 10:51:21,651 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:21,651 [INFO]: 	index_param: efSearch=164
2025-03-13 10:51:21,651 [INFO]: 	index_path: knn.index
2025-03-13 10:51:21,651 [INFO]: 	size in bytes: 378338770
2025-03-13 10:51:21,651 [INFO]: 	avg_search_speed_ms: 8.860383508190763
2025-03-13 10:51:21,651 [INFO]: 	99p_search_speed_ms: 12.69000097177923
2025-03-13 10:51:21,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:21,652 [INFO]: 	nb vectors: 1923
2025-03-13 10:51:21,652 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:21,652 [INFO]: 	compression ratio: 0.9993085931954582
2025-03-13 10:51:21,652 [INFO]: }
2025-03-13 10:51:21,652 [INFO]: 	>>> Finished "Creating the index" in 36.2913 secs
2025-03-13 10:51:21,652 [INFO]: >>> Finished "Launching the whole pipeline" in 36.3278 secs
2025-03-13 10:51:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 36869 [episode count 0/20]
[retrieval_preprocessing] for episode 86545 [episode count 1/20], we have num_retrieval=np.int64(1883) num_query=np.int64(130)
2025-03-13 10:51:22,689 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:23,059 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:23
2025-03-13 10:51:23,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 964.21it/s]
2025-03-13 10:51:23,093 [INFO]: There are 1883 embeddings of dim 49152
2025-03-13 10:51:23,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 10:51:23,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:23,093 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 10:51:23,093 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:23,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:51:23,093 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,094 [INFO]: 388.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:23,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:51:23,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:23
2025-03-13 10:51:23,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:23,094 [INFO]: 	Creating the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,094 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:23
2025-03-13 10:51:23,095 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:51:23,095 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,095 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 10:51:23,095 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.97it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.69it/s]100%|██████████| 8/8 [00:01<00:00,  4.25it/s]
2025-03-13 10:51:24,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:24
2025-03-13 10:51:57,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8854 secs
2025-03-13 10:51:57,867 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 10:51:57,867 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.19it/s]
2025-03-13 10:52:09,548 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6814 secs
2025-03-13 10:52:09,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4557 secs
2025-03-13 10:52:09,551 [INFO]: {
2025-03-13 10:52:09,551 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:09,551 [INFO]: 	index_param: efSearch=138
2025-03-13 10:52:09,551 [INFO]: 	index_path: knn.index
2025-03-13 10:52:09,551 [INFO]: 	size in bytes: 370468990
2025-03-13 10:52:09,551 [INFO]: 	avg_search_speed_ms: 9.109438530793701
2025-03-13 10:52:09,551 [INFO]: 	99p_search_speed_ms: 13.46110031707212
2025-03-13 10:52:09,551 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:09,551 [INFO]: 	nb vectors: 1883
2025-03-13 10:52:09,551 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:09,551 [INFO]: 	compression ratio: 0.9993086438894656
2025-03-13 10:52:09,551 [INFO]: }
2025-03-13 10:52:09,551 [INFO]: 	>>> Finished "Creating the index" in 46.4573 secs
2025-03-13 10:52:09,551 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4918 secs
2025-03-13 10:52:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 86545 [episode count 1/20]
[retrieval_preprocessing] for episode 78363 [episode count 2/20], we have num_retrieval=np.int64(1890) num_query=np.int64(123)
2025-03-13 10:52:10,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:10,805 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:10
2025-03-13 10:52:10,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 10:52:10,836 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 10:52:10,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 10:52:10,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:10
2025-03-13 10:52:10,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:10,837 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 10:52:10,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:10,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:10,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:10
2025-03-13 10:52:10,837 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:10,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:52:10,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:10
2025-03-13 10:52:10,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:10,837 [INFO]: 	Creating the index 03/13/2025, 10:52:10
2025-03-13 10:52:10,837 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:10
2025-03-13 10:52:10,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:52:10,838 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:10
2025-03-13 10:52:10,838 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 10:52:10,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.25it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.21it/s]100%|██████████| 8/8 [00:01<00:00,  4.80it/s]
2025-03-13 10:52:12,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:12
2025-03-13 10:52:39,933 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4251 secs
2025-03-13 10:52:39,933 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 10:52:39,933 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-13 10:52:51,203 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2697 secs
2025-03-13 10:52:51,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3662 secs
2025-03-13 10:52:51,205 [INFO]: {
2025-03-13 10:52:51,205 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:51,205 [INFO]: 	index_param: efSearch=170
2025-03-13 10:52:51,205 [INFO]: 	index_path: knn.index
2025-03-13 10:52:51,205 [INFO]: 	size in bytes: 371846230
2025-03-13 10:52:51,205 [INFO]: 	avg_search_speed_ms: 8.890518336660332
2025-03-13 10:52:51,205 [INFO]: 	99p_search_speed_ms: 13.730169041082263
2025-03-13 10:52:51,205 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:51,205 [INFO]: 	nb vectors: 1890
2025-03-13 10:52:51,205 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:51,205 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 10:52:51,205 [INFO]: }
2025-03-13 10:52:51,205 [INFO]: 	>>> Finished "Creating the index" in 40.3676 secs
2025-03-13 10:52:51,205 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4002 secs
2025-03-13 10:52:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 78363 [episode count 2/20]
[retrieval_preprocessing] for episode 78877 [episode count 3/20], we have num_retrieval=np.int64(1902) num_query=np.int64(111)
2025-03-13 10:52:52,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:52,571 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:52
2025-03-13 10:52:52,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1625.70it/s]
2025-03-13 10:52:52,601 [INFO]: There are 1902 embeddings of dim 49152
2025-03-13 10:52:52,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 10:52:52,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:52
2025-03-13 10:52:52,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:52,602 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 10:52:52,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:52,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:52,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:52
2025-03-13 10:52:52,602 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:52,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:52:52,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:52
2025-03-13 10:52:52,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:52,602 [INFO]: 	Creating the index 03/13/2025, 10:52:52
2025-03-13 10:52:52,602 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:52
2025-03-13 10:52:52,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:52:52,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:52
2025-03-13 10:52:52,603 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 10:52:52,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.66it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.53it/s]100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
2025-03-13 10:52:54,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:54
2025-03-13 10:53:21,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2263 secs
2025-03-13 10:53:21,549 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 10:53:21,549 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 10:53:32,828 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2782 secs
2025-03-13 10:53:32,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.2259 secs
2025-03-13 10:53:32,829 [INFO]: {
2025-03-13 10:53:32,829 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:32,829 [INFO]: 	index_param: efSearch=149
2025-03-13 10:53:32,829 [INFO]: 	index_path: knn.index
2025-03-13 10:53:32,829 [INFO]: 	size in bytes: 374207170
2025-03-13 10:53:32,829 [INFO]: 	avg_search_speed_ms: 8.670841714535134
2025-03-13 10:53:32,829 [INFO]: 	99p_search_speed_ms: 11.173506116028875
2025-03-13 10:53:32,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:32,829 [INFO]: 	nb vectors: 1902
2025-03-13 10:53:32,829 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:32,829 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-13 10:53:32,830 [INFO]: }
2025-03-13 10:53:32,830 [INFO]: 	>>> Finished "Creating the index" in 40.2275 secs
2025-03-13 10:53:32,830 [INFO]: >>> Finished "Launching the whole pipeline" in 40.2580 secs
2025-03-13 10:53:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 78877 [episode count 3/20]
[retrieval_preprocessing] for episode 73250 [episode count 4/20], we have num_retrieval=np.int64(1932) num_query=np.int64(81)
2025-03-13 10:53:34,094 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:34,478 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:34
2025-03-13 10:53:34,478 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1596.61it/s]
2025-03-13 10:53:34,513 [INFO]: There are 1932 embeddings of dim 49152
2025-03-13 10:53:34,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 10:53:34,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:34
2025-03-13 10:53:34,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:34,514 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:53:34,514 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:34,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:34,514 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:34
2025-03-13 10:53:34,514 [INFO]: 398.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:34,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:34,514 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:34
2025-03-13 10:53:34,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:34,514 [INFO]: 	Creating the index 03/13/2025, 10:53:34
2025-03-13 10:53:34,514 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:34
2025-03-13 10:53:34,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 10:53:34,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:34
2025-03-13 10:53:34,516 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:34,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.03it/s] 62%|██████▎   | 5/8 [00:00<00:00, 26.47it/s]100%|██████████| 8/8 [00:01<00:00,  3.44it/s]100%|██████████| 8/8 [00:01<00:00,  4.17it/s]
2025-03-13 10:53:36,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:36
2025-03-13 10:54:02,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3087 secs
2025-03-13 10:54:02,748 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 10:54:02,748 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-13 10:54:14,592 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8433 secs
2025-03-13 10:54:14,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.0774 secs
2025-03-13 10:54:14,593 [INFO]: {
2025-03-13 10:54:14,593 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:14,593 [INFO]: 	index_param: efSearch=140
2025-03-13 10:54:14,594 [INFO]: 	index_path: knn.index
2025-03-13 10:54:14,594 [INFO]: 	size in bytes: 380109490
2025-03-13 10:54:14,594 [INFO]: 	avg_search_speed_ms: 8.757332319290999
2025-03-13 10:54:14,594 [INFO]: 	99p_search_speed_ms: 11.886797859333454
2025-03-13 10:54:14,594 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:14,594 [INFO]: 	nb vectors: 1932
2025-03-13 10:54:14,594 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:14,594 [INFO]: 	compression ratio: 0.999308530813056
2025-03-13 10:54:14,594 [INFO]: }
2025-03-13 10:54:14,594 [INFO]: 	>>> Finished "Creating the index" in 40.0792 secs
2025-03-13 10:54:14,594 [INFO]: >>> Finished "Launching the whole pipeline" in 40.1159 secs
2025-03-13 10:54:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 73250 [episode count 4/20]
[retrieval_preprocessing] for episode 8232 [episode count 5/20], we have num_retrieval=np.int64(1913) num_query=np.int64(100)
2025-03-13 10:54:15,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:15,692 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:15
2025-03-13 10:54:15,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2158.67it/s]
2025-03-13 10:54:15,722 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 10:54:15,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 10:54:15,722 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:15
2025-03-13 10:54:15,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:15,722 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:54:15,722 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:15,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:15,722 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:15
2025-03-13 10:54:15,722 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:15,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:15,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:15
2025-03-13 10:54:15,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:15,722 [INFO]: 	Creating the index 03/13/2025, 10:54:15
2025-03-13 10:54:15,722 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:15
2025-03-13 10:54:15,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:54:15,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:15
2025-03-13 10:54:15,723 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:15,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.08it/s]100%|██████████| 8/8 [00:01<00:00,  4.44it/s]100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
2025-03-13 10:54:17,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:17
2025-03-13 10:54:44,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3361 secs
2025-03-13 10:54:44,764 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 10:54:44,764 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-13 10:54:56,025 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2602 secs
2025-03-13 10:54:56,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3024 secs
2025-03-13 10:54:56,026 [INFO]: {
2025-03-13 10:54:56,026 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:56,026 [INFO]: 	index_param: efSearch=185
2025-03-13 10:54:56,026 [INFO]: 	index_path: knn.index
2025-03-13 10:54:56,026 [INFO]: 	size in bytes: 376371370
2025-03-13 10:54:56,026 [INFO]: 	avg_search_speed_ms: 9.736609627277804
2025-03-13 10:54:56,026 [INFO]: 	99p_search_speed_ms: 12.185719921253622
2025-03-13 10:54:56,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:56,026 [INFO]: 	nb vectors: 1913
2025-03-13 10:54:56,026 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:56,026 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 10:54:56,026 [INFO]: }
2025-03-13 10:54:56,026 [INFO]: 	>>> Finished "Creating the index" in 40.3039 secs
2025-03-13 10:54:56,026 [INFO]: >>> Finished "Launching the whole pipeline" in 40.3336 secs
2025-03-13 10:54:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 8232 [episode count 5/20]
[retrieval_preprocessing] for episode 58413 [episode count 6/20], we have num_retrieval=np.int64(1935) num_query=np.int64(78)
2025-03-13 10:54:57,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:57,370 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:57
2025-03-13 10:54:57,370 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.90it/s]
2025-03-13 10:54:57,403 [INFO]: There are 1935 embeddings of dim 49152
2025-03-13 10:54:57,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 10:54:57,404 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:57
2025-03-13 10:54:57,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:57,404 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:54:57,404 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:57,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:57,404 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:57
2025-03-13 10:54:57,404 [INFO]: 399.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:57,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:57,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:57
2025-03-13 10:54:57,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:57,404 [INFO]: 	Creating the index 03/13/2025, 10:54:57
2025-03-13 10:54:57,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:57
2025-03-13 10:54:57,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:54:57,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:57
2025-03-13 10:54:57,405 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:57,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.83it/s]100%|██████████| 8/8 [00:01<00:00,  4.28it/s]100%|██████████| 8/8 [00:01<00:00,  4.54it/s]
2025-03-13 10:54:59,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:59
2025-03-13 10:55:23,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1827 secs
2025-03-13 10:55:23,355 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 10:55:23,355 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 10:55:35,075 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7193 secs
2025-03-13 10:55:35,076 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6712 secs
2025-03-13 10:55:35,076 [INFO]: {
2025-03-13 10:55:35,076 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:35,076 [INFO]: 	index_param: efSearch=126
2025-03-13 10:55:35,076 [INFO]: 	index_path: knn.index
2025-03-13 10:55:35,076 [INFO]: 	size in bytes: 380699770
2025-03-13 10:55:35,077 [INFO]: 	avg_search_speed_ms: 8.604397279131843
2025-03-13 10:55:35,077 [INFO]: 	99p_search_speed_ms: 14.960343188140651
2025-03-13 10:55:35,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:35,077 [INFO]: 	nb vectors: 1935
2025-03-13 10:55:35,077 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:35,077 [INFO]: 	compression ratio: 0.9993084051508621
2025-03-13 10:55:35,077 [INFO]: }
2025-03-13 10:55:35,077 [INFO]: 	>>> Finished "Creating the index" in 37.6725 secs
2025-03-13 10:55:35,077 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7065 secs
2025-03-13 10:55:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 58413 [episode count 6/20]
[retrieval_preprocessing] for episode 17468 [episode count 7/20], we have num_retrieval=np.int64(1911) num_query=np.int64(102)
2025-03-13 10:55:35,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:36,115 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:36
2025-03-13 10:55:36,115 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1101.16it/s]
2025-03-13 10:55:36,149 [INFO]: There are 1911 embeddings of dim 49152
2025-03-13 10:55:36,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 10:55:36,149 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:36
2025-03-13 10:55:36,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:36,149 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 10:55:36,149 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:36,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:36,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:36
2025-03-13 10:55:36,150 [INFO]: 394.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:36,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:36,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:36
2025-03-13 10:55:36,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:36,150 [INFO]: 	Creating the index 03/13/2025, 10:55:36
2025-03-13 10:55:36,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:36
2025-03-13 10:55:36,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:55:36,151 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:36
2025-03-13 10:55:36,151 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:55:36,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.72it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.42it/s]100%|██████████| 8/8 [00:01<00:00,  4.49it/s]
2025-03-13 10:55:37,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:37
2025-03-13 10:56:03,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8808 secs
2025-03-13 10:56:03,816 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 10:56:03,816 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 10:56:15,063 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2460 secs
2025-03-13 10:56:15,064 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.9130 secs
2025-03-13 10:56:15,064 [INFO]: {
2025-03-13 10:56:15,064 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:15,064 [INFO]: 	index_param: efSearch=189
2025-03-13 10:56:15,064 [INFO]: 	index_path: knn.index
2025-03-13 10:56:15,064 [INFO]: 	size in bytes: 375977890
2025-03-13 10:56:15,064 [INFO]: 	avg_search_speed_ms: 9.677889477191366
2025-03-13 10:56:15,064 [INFO]: 	99p_search_speed_ms: 12.544593359343704
2025-03-13 10:56:15,064 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:15,064 [INFO]: 	nb vectors: 1911
2025-03-13 10:56:15,064 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:15,064 [INFO]: 	compression ratio: 0.9993084646546636
2025-03-13 10:56:15,064 [INFO]: }
2025-03-13 10:56:15,064 [INFO]: 	>>> Finished "Creating the index" in 38.9145 secs
2025-03-13 10:56:15,064 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9496 secs
2025-03-13 10:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17468 [episode count 7/20]
[retrieval_preprocessing] for episode 74312 [episode count 8/20], we have num_retrieval=np.int64(1938) num_query=np.int64(75)
2025-03-13 10:56:16,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:16,450 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:16
2025-03-13 10:56:16,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.89it/s]
2025-03-13 10:56:16,483 [INFO]: There are 1938 embeddings of dim 49152
2025-03-13 10:56:16,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 10:56:16,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:16
2025-03-13 10:56:16,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:16,483 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:56:16,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:16,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:16,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:16
2025-03-13 10:56:16,483 [INFO]: 400.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:16,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:56:16,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:16
2025-03-13 10:56:16,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:16,484 [INFO]: 	Creating the index 03/13/2025, 10:56:16
2025-03-13 10:56:16,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:16
2025-03-13 10:56:16,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:56:16,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:16
2025-03-13 10:56:16,485 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:56:16,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.50it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.63it/s]100%|██████████| 8/8 [00:01<00:00,  4.92it/s]
2025-03-13 10:56:18,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:18
2025-03-13 10:56:42,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0481 secs
2025-03-13 10:56:42,162 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 10:56:42,163 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 10:56:53,410 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2474 secs
2025-03-13 10:56:53,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.9266 secs
2025-03-13 10:56:53,411 [INFO]: {
2025-03-13 10:56:53,412 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:53,412 [INFO]: 	index_param: efSearch=184
2025-03-13 10:56:53,412 [INFO]: 	index_path: knn.index
2025-03-13 10:56:53,412 [INFO]: 	size in bytes: 381289990
2025-03-13 10:56:53,412 [INFO]: 	avg_search_speed_ms: 9.348637354560196
2025-03-13 10:56:53,412 [INFO]: 	99p_search_speed_ms: 12.834532887209205
2025-03-13 10:56:53,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:53,412 [INFO]: 	nb vectors: 1938
2025-03-13 10:56:53,412 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:53,412 [INFO]: 	compression ratio: 0.9993084371294405
2025-03-13 10:56:53,412 [INFO]: }
2025-03-13 10:56:53,412 [INFO]: 	>>> Finished "Creating the index" in 36.9280 secs
2025-03-13 10:56:53,412 [INFO]: >>> Finished "Launching the whole pipeline" in 36.9616 secs
2025-03-13 10:56:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 74312 [episode count 8/20]
[retrieval_preprocessing] for episode 84583 [episode count 9/20], we have num_retrieval=np.int64(1932) num_query=np.int64(81)
2025-03-13 10:56:54,219 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:54,475 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:54
2025-03-13 10:56:54,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1901.32it/s]
2025-03-13 10:56:54,505 [INFO]: There are 1932 embeddings of dim 49152
2025-03-13 10:56:54,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 10:56:54,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:54
2025-03-13 10:56:54,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:54,505 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:56:54,505 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:54,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:54,505 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:54
2025-03-13 10:56:54,505 [INFO]: 398.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:54,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:56:54,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:54
2025-03-13 10:56:54,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:54,505 [INFO]: 	Creating the index 03/13/2025, 10:56:54
2025-03-13 10:56:54,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:54
2025-03-13 10:56:54,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:56:54,506 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:54
2025-03-13 10:56:54,506 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:56:54,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.71it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.87it/s]100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
2025-03-13 10:56:56,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:56
2025-03-13 10:57:26,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0119 secs
2025-03-13 10:57:26,060 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 10:57:26,061 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.18it/s]
2025-03-13 10:57:37,402 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3410 secs
2025-03-13 10:57:37,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8967 secs
2025-03-13 10:57:37,403 [INFO]: {
2025-03-13 10:57:37,403 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:37,403 [INFO]: 	index_param: efSearch=184
2025-03-13 10:57:37,403 [INFO]: 	index_path: knn.index
2025-03-13 10:57:37,403 [INFO]: 	size in bytes: 380109490
2025-03-13 10:57:37,403 [INFO]: 	avg_search_speed_ms: 10.119583589205828
2025-03-13 10:57:37,403 [INFO]: 	99p_search_speed_ms: 15.69310135440901
2025-03-13 10:57:37,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:37,403 [INFO]: 	nb vectors: 1932
2025-03-13 10:57:37,403 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:37,403 [INFO]: 	compression ratio: 0.999308530813056
2025-03-13 10:57:37,403 [INFO]: }
2025-03-13 10:57:37,403 [INFO]: 	>>> Finished "Creating the index" in 42.8981 secs
2025-03-13 10:57:37,403 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9281 secs
2025-03-13 10:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 84583 [episode count 9/20]
[retrieval_preprocessing] for episode 25192 [episode count 10/20], we have num_retrieval=np.int64(1924) num_query=np.int64(89)
2025-03-13 10:57:38,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:38,586 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:38
2025-03-13 10:57:38,586 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1922.23it/s]
2025-03-13 10:57:38,614 [INFO]: There are 1924 embeddings of dim 49152
2025-03-13 10:57:38,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 10:57:38,615 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:38
2025-03-13 10:57:38,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:38,615 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:57:38,615 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:38,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:38,615 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:38
2025-03-13 10:57:38,615 [INFO]: 397.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:38,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:38,615 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:38
2025-03-13 10:57:38,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:38,615 [INFO]: 	Creating the index 03/13/2025, 10:57:38
2025-03-13 10:57:38,615 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:38
2025-03-13 10:57:38,616 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:57:38,616 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:38
2025-03-13 10:57:38,616 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:38,616 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.57it/s]100%|██████████| 8/8 [00:01<00:00,  4.47it/s]100%|██████████| 8/8 [00:01<00:00,  4.74it/s]
2025-03-13 10:57:40,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:40
2025-03-13 10:58:11,270 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9610 secs
2025-03-13 10:58:11,270 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 10:58:11,270 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 10:58:23,676 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4054 secs
2025-03-13 10:58:23,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0617 secs
2025-03-13 10:58:23,678 [INFO]: {
2025-03-13 10:58:23,678 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:23,678 [INFO]: 	index_param: efSearch=166
2025-03-13 10:58:23,678 [INFO]: 	index_path: knn.index
2025-03-13 10:58:23,678 [INFO]: 	size in bytes: 378535510
2025-03-13 10:58:23,678 [INFO]: 	avg_search_speed_ms: 11.21713413863188
2025-03-13 10:58:23,678 [INFO]: 	99p_search_speed_ms: 18.01104796584696
2025-03-13 10:58:23,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:23,678 [INFO]: 	nb vectors: 1924
2025-03-13 10:58:23,678 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:23,678 [INFO]: 	compression ratio: 0.9993086038348159
2025-03-13 10:58:23,678 [INFO]: }
2025-03-13 10:58:23,678 [INFO]: 	>>> Finished "Creating the index" in 45.0632 secs
2025-03-13 10:58:23,678 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0920 secs
2025-03-13 10:58:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 25192 [episode count 10/20]
[retrieval_preprocessing] for episode 35467 [episode count 11/20], we have num_retrieval=np.int64(1919) num_query=np.int64(94)
2025-03-13 10:58:25,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:25,281 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:25
2025-03-13 10:58:25,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1100.29it/s]
2025-03-13 10:58:25,310 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 10:58:25,310 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 10:58:25,310 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:25
2025-03-13 10:58:25,310 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:25,310 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:58:25,310 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:25,310 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:25,310 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:25
2025-03-13 10:58:25,311 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:25,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:25,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:25
2025-03-13 10:58:25,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:25,311 [INFO]: 	Creating the index 03/13/2025, 10:58:25
2025-03-13 10:58:25,311 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:25
2025-03-13 10:58:25,312 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:58:25,312 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:25
2025-03-13 10:58:25,312 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:58:25,312 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.06it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.72it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.89it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.74it/s]100%|██████████| 8/8 [00:02<00:00,  3.72it/s]
2025-03-13 10:58:27,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:27
2025-03-13 10:58:54,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9928 secs
2025-03-13 10:58:54,462 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 10:58:54,462 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.59it/s]
2025-03-13 10:59:05,730 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2677 secs
2025-03-13 10:59:05,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4199 secs
2025-03-13 10:59:05,732 [INFO]: {
2025-03-13 10:59:05,732 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:05,732 [INFO]: 	index_param: efSearch=154
2025-03-13 10:59:05,732 [INFO]: 	index_path: knn.index
2025-03-13 10:59:05,732 [INFO]: 	size in bytes: 377551810
2025-03-13 10:59:05,732 [INFO]: 	avg_search_speed_ms: 9.185992817362793
2025-03-13 10:59:05,732 [INFO]: 	99p_search_speed_ms: 15.914146974682795
2025-03-13 10:59:05,732 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:05,732 [INFO]: 	nb vectors: 1919
2025-03-13 10:59:05,732 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:05,732 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 10:59:05,732 [INFO]: }
2025-03-13 10:59:05,732 [INFO]: 	>>> Finished "Creating the index" in 40.4216 secs
2025-03-13 10:59:05,732 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4509 secs
2025-03-13 10:59:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 35467 [episode count 11/20]
[retrieval_preprocessing] for episode 39077 [episode count 12/20], we have num_retrieval=np.int64(1889) num_query=np.int64(124)
2025-03-13 10:59:06,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:07,013 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:07
2025-03-13 10:59:07,014 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-13 10:59:07,053 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 10:59:07,054 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 10:59:07,054 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:07
2025-03-13 10:59:07,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:07,055 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 10:59:07,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:07,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 10:59:07,055 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:07
2025-03-13 10:59:07,055 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:07,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:59:07,056 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:07
2025-03-13 10:59:07,056 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:07,056 [INFO]: 	Creating the index 03/13/2025, 10:59:07
2025-03-13 10:59:07,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:07
2025-03-13 10:59:07,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:59:07,060 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:07
2025-03-13 10:59:07,061 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 10:59:07,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.81it/s]100%|██████████| 8/8 [00:01<00:00,  4.08it/s]100%|██████████| 8/8 [00:01<00:00,  4.50it/s]
2025-03-13 10:59:08,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:08
2025-03-13 10:59:33,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5136 secs
2025-03-13 10:59:33,360 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 10:59:33,360 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.44it/s]
2025-03-13 10:59:45,731 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3702 secs
2025-03-13 10:59:45,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.6716 secs
2025-03-13 10:59:45,732 [INFO]: {
2025-03-13 10:59:45,732 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:45,732 [INFO]: 	index_param: efSearch=177
2025-03-13 10:59:45,732 [INFO]: 	index_path: knn.index
2025-03-13 10:59:45,732 [INFO]: 	size in bytes: 371649490
2025-03-13 10:59:45,732 [INFO]: 	avg_search_speed_ms: 9.955121188966642
2025-03-13 10:59:45,732 [INFO]: 	99p_search_speed_ms: 13.989944765344264
2025-03-13 10:59:45,732 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:45,732 [INFO]: 	nb vectors: 1889
2025-03-13 10:59:45,732 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:45,732 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 10:59:45,732 [INFO]: }
2025-03-13 10:59:45,732 [INFO]: 	>>> Finished "Creating the index" in 38.6757 secs
2025-03-13 10:59:45,732 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7188 secs
2025-03-13 10:59:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 39077 [episode count 12/20]
[retrieval_preprocessing] for episode 7861 [episode count 13/20], we have num_retrieval=np.int64(1914) num_query=np.int64(99)
2025-03-13 10:59:46,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:47,164 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:47
2025-03-13 10:59:47,164 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.84it/s]
2025-03-13 10:59:47,214 [INFO]: There are 1914 embeddings of dim 49152
2025-03-13 10:59:47,216 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0515 secs
2025-03-13 10:59:47,216 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:47
2025-03-13 10:59:47,217 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:47,217 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:59:47,217 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:47,217 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 10:59:47,217 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:47
2025-03-13 10:59:47,218 [INFO]: 395.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:47,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 10:59:47,218 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:47
2025-03-13 10:59:47,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:47,219 [INFO]: 	Creating the index 03/13/2025, 10:59:47
2025-03-13 10:59:47,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:47
2025-03-13 10:59:47,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:59:47,223 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:47
2025-03-13 10:59:47,223 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:59:47,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.11it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.51it/s]100%|██████████| 8/8 [00:02<00:00,  3.89it/s]
2025-03-13 10:59:49,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:49
2025-03-13 11:00:16,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8061 secs
2025-03-13 11:00:16,090 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 11:00:16,090 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 11:00:27,934 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8442 secs
2025-03-13 11:00:27,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.7132 secs
2025-03-13 11:00:27,936 [INFO]: {
2025-03-13 11:00:27,936 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:27,936 [INFO]: 	index_param: efSearch=170
2025-03-13 11:00:27,936 [INFO]: 	index_path: knn.index
2025-03-13 11:00:27,936 [INFO]: 	size in bytes: 376568110
2025-03-13 11:00:27,936 [INFO]: 	avg_search_speed_ms: 9.099002484125412
2025-03-13 11:00:27,936 [INFO]: 	99p_search_speed_ms: 13.788090040907262
2025-03-13 11:00:27,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:27,936 [INFO]: 	nb vectors: 1914
2025-03-13 11:00:27,936 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:27,936 [INFO]: 	compression ratio: 0.9993084969409651
2025-03-13 11:00:27,936 [INFO]: }
2025-03-13 11:00:27,936 [INFO]: 	>>> Finished "Creating the index" in 40.7173 secs
2025-03-13 11:00:27,936 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7724 secs
2025-03-13 11:00:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 7861 [episode count 13/20]
[retrieval_preprocessing] for episode 16055 [episode count 14/20], we have num_retrieval=np.int64(1919) num_query=np.int64(94)
2025-03-13 11:00:29,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:29,341 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:29
2025-03-13 11:00:29,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.34it/s]
2025-03-13 11:00:29,375 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 11:00:29,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:00:29,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:29
2025-03-13 11:00:29,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:29,375 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:00:29,375 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:29,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:29,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:29
2025-03-13 11:00:29,376 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:29,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:00:29,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:29
2025-03-13 11:00:29,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:29,376 [INFO]: 	Creating the index 03/13/2025, 11:00:29
2025-03-13 11:00:29,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:29
2025-03-13 11:00:29,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:00:29,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:29
2025-03-13 11:00:29,377 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:29,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.00it/s]100%|██████████| 8/8 [00:01<00:00,  4.57it/s]100%|██████████| 8/8 [00:01<00:00,  4.83it/s]
2025-03-13 11:00:31,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:31
2025-03-13 11:00:55,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7735 secs
2025-03-13 11:00:55,809 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 11:00:55,809 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 11:01:07,179 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3695 secs
2025-03-13 11:01:07,180 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8030 secs
2025-03-13 11:01:07,180 [INFO]: {
2025-03-13 11:01:07,180 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:07,181 [INFO]: 	index_param: efSearch=137
2025-03-13 11:01:07,181 [INFO]: 	index_path: knn.index
2025-03-13 11:01:07,181 [INFO]: 	size in bytes: 377551810
2025-03-13 11:01:07,181 [INFO]: 	avg_search_speed_ms: 8.488929692927767
2025-03-13 11:01:07,181 [INFO]: 	99p_search_speed_ms: 12.16049199923873
2025-03-13 11:01:07,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:07,181 [INFO]: 	nb vectors: 1919
2025-03-13 11:01:07,181 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:07,181 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 11:01:07,181 [INFO]: }
2025-03-13 11:01:07,181 [INFO]: 	>>> Finished "Creating the index" in 37.8048 secs
2025-03-13 11:01:07,181 [INFO]: >>> Finished "Launching the whole pipeline" in 37.8394 secs
2025-03-13 11:01:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 16055 [episode count 14/20]
[retrieval_preprocessing] for episode 93833 [episode count 15/20], we have num_retrieval=np.int64(1881) num_query=np.int64(132)
2025-03-13 11:01:08,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:08,404 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:08
2025-03-13 11:01:08,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.28it/s]
2025-03-13 11:01:08,439 [INFO]: There are 1881 embeddings of dim 49152
2025-03-13 11:01:08,440 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 11:01:08,440 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:08
2025-03-13 11:01:08,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:08,440 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:01:08,440 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:08,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:08,440 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:08
2025-03-13 11:01:08,440 [INFO]: 388.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:08,440 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:01:08,440 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:08
2025-03-13 11:01:08,440 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:08,440 [INFO]: 	Creating the index 03/13/2025, 11:01:08
2025-03-13 11:01:08,441 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:08
2025-03-13 11:01:08,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:01:08,442 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:08
2025-03-13 11:01:08,442 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:01:08,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.88it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.04it/s]100%|██████████| 8/8 [00:01<00:00,  4.75it/s]
2025-03-13 11:01:10,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:10
2025-03-13 11:01:37,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4944 secs
2025-03-13 11:01:37,626 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 11:01:37,626 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-13 11:01:49,409 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7825 secs
2025-03-13 11:01:49,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9685 secs
2025-03-13 11:01:49,410 [INFO]: {
2025-03-13 11:01:49,410 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:49,410 [INFO]: 	index_param: efSearch=182
2025-03-13 11:01:49,410 [INFO]: 	index_path: knn.index
2025-03-13 11:01:49,410 [INFO]: 	size in bytes: 370075510
2025-03-13 11:01:49,410 [INFO]: 	avg_search_speed_ms: 9.409511846473558
2025-03-13 11:01:49,410 [INFO]: 	99p_search_speed_ms: 12.962139584124085
2025-03-13 11:01:49,410 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:49,410 [INFO]: 	nb vectors: 1881
2025-03-13 11:01:49,410 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:49,410 [INFO]: 	compression ratio: 0.9993086221782144
2025-03-13 11:01:49,410 [INFO]: }
2025-03-13 11:01:49,410 [INFO]: 	>>> Finished "Creating the index" in 40.9699 secs
2025-03-13 11:01:49,410 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0063 secs
2025-03-13 11:01:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 93833 [episode count 15/20]
[retrieval_preprocessing] for episode 27850 [episode count 16/20], we have num_retrieval=np.int64(1913) num_query=np.int64(100)
2025-03-13 11:01:50,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:51,303 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:51
2025-03-13 11:01:51,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-13 11:01:51,338 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 11:01:51,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 11:01:51,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:51
2025-03-13 11:01:51,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:51,339 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:01:51,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:51,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:51,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:51
2025-03-13 11:01:51,339 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:51,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:01:51,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:51
2025-03-13 11:01:51,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:51,339 [INFO]: 	Creating the index 03/13/2025, 11:01:51
2025-03-13 11:01:51,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:51
2025-03-13 11:01:51,340 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:01:51,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:51
2025-03-13 11:01:51,341 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:01:51,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.76it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.96it/s]100%|██████████| 8/8 [00:01<00:00,  5.25it/s]
2025-03-13 11:01:52,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:52
2025-03-13 11:02:19,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5177 secs
2025-03-13 11:02:19,386 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 11:02:19,386 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 11:02:30,837 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4509 secs
2025-03-13 11:02:30,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.4979 secs
2025-03-13 11:02:30,839 [INFO]: {
2025-03-13 11:02:30,839 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:30,839 [INFO]: 	index_param: efSearch=179
2025-03-13 11:02:30,839 [INFO]: 	index_path: knn.index
2025-03-13 11:02:30,839 [INFO]: 	size in bytes: 376371370
2025-03-13 11:02:30,839 [INFO]: 	avg_search_speed_ms: 10.26711304618516
2025-03-13 11:02:30,839 [INFO]: 	99p_search_speed_ms: 15.771314688026905
2025-03-13 11:02:30,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:30,839 [INFO]: 	nb vectors: 1913
2025-03-13 11:02:30,839 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:30,839 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 11:02:30,839 [INFO]: }
2025-03-13 11:02:30,839 [INFO]: 	>>> Finished "Creating the index" in 39.4995 secs
2025-03-13 11:02:30,839 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5360 secs
2025-03-13 11:02:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 27850 [episode count 16/20]
[retrieval_preprocessing] for episode 68304 [episode count 17/20], we have num_retrieval=np.int64(1898) num_query=np.int64(115)
2025-03-13 11:02:31,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:32,099 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:32
2025-03-13 11:02:32,099 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2226.28it/s]
2025-03-13 11:02:32,129 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 11:02:32,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:02:32,129 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:32,130 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:02:32,130 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:32,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:02:32,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,130 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:32,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:32,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:32
2025-03-13 11:02:32,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:32,130 [INFO]: 	Creating the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:32
2025-03-13 11:02:32,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:02:32,131 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,131 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:02:32,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.52it/s] 62%|██████▎   | 5/8 [00:00<00:00, 25.98it/s]100%|██████████| 8/8 [00:01<00:00,  4.07it/s]100%|██████████| 8/8 [00:01<00:00,  4.90it/s]
2025-03-13 11:02:33,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:33
2025-03-13 11:02:59,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8430 secs
2025-03-13 11:02:59,609 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 11:02:59,609 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 11:03:11,458 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8484 secs
2025-03-13 11:03:11,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3281 secs
2025-03-13 11:03:11,459 [INFO]: {
2025-03-13 11:03:11,459 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:11,459 [INFO]: 	index_param: efSearch=187
2025-03-13 11:03:11,459 [INFO]: 	index_path: knn.index
2025-03-13 11:03:11,459 [INFO]: 	size in bytes: 373420150
2025-03-13 11:03:11,459 [INFO]: 	avg_search_speed_ms: 11.125456649774854
2025-03-13 11:03:11,459 [INFO]: 	99p_search_speed_ms: 15.78542206902057
2025-03-13 11:03:11,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:11,459 [INFO]: 	nb vectors: 1898
2025-03-13 11:03:11,459 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:11,459 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 11:03:11,459 [INFO]: }
2025-03-13 11:03:11,460 [INFO]: 	>>> Finished "Creating the index" in 39.3295 secs
2025-03-13 11:03:11,460 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3604 secs
2025-03-13 11:03:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 68304 [episode count 17/20]
[retrieval_preprocessing] for episode 93919 [episode count 18/20], we have num_retrieval=np.int64(1922) num_query=np.int64(91)
2025-03-13 11:03:12,519 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:12,877 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:12
2025-03-13 11:03:12,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-13 11:03:12,911 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 11:03:12,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 11:03:12,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,912 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:12,912 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:03:12,912 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:12,912 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:03:12,912 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,912 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:12,912 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:03:12,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:12
2025-03-13 11:03:12,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:12,913 [INFO]: 	Creating the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,913 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:12
2025-03-13 11:03:12,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:03:12,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:12
2025-03-13 11:03:12,916 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:12,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.86it/s]100%|██████████| 8/8 [00:01<00:00,  4.11it/s]100%|██████████| 8/8 [00:01<00:00,  4.54it/s]
2025-03-13 11:03:14,684 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:14
2025-03-13 11:03:38,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3667 secs
2025-03-13 11:03:38,052 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:03:38,052 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 11:03:50,139 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0868 secs
2025-03-13 11:03:50,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2244 secs
2025-03-13 11:03:50,140 [INFO]: {
2025-03-13 11:03:50,140 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:50,140 [INFO]: 	index_param: efSearch=184
2025-03-13 11:03:50,140 [INFO]: 	index_path: knn.index
2025-03-13 11:03:50,140 [INFO]: 	size in bytes: 378142030
2025-03-13 11:03:50,140 [INFO]: 	avg_search_speed_ms: 10.278753105470603
2025-03-13 11:03:50,141 [INFO]: 	99p_search_speed_ms: 14.185199867933987
2025-03-13 11:03:50,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:50,141 [INFO]: 	nb vectors: 1922
2025-03-13 11:03:50,141 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:50,141 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 11:03:50,141 [INFO]: }
2025-03-13 11:03:50,141 [INFO]: 	>>> Finished "Creating the index" in 37.2278 secs
2025-03-13 11:03:50,141 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2637 secs
2025-03-13 11:03:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 93919 [episode count 18/20]
[retrieval_preprocessing] for episode 63204 [episode count 19/20], we have num_retrieval=np.int64(1909) num_query=np.int64(104)
2025-03-13 11:03:50,988 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:51,246 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:51
2025-03-13 11:03:51,246 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1325.63it/s]
2025-03-13 11:03:51,280 [INFO]: There are 1909 embeddings of dim 49152
2025-03-13 11:03:51,281 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 11:03:51,281 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:51
2025-03-13 11:03:51,281 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:51,281 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:03:51,281 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:51,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:03:51,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:51
2025-03-13 11:03:51,282 [INFO]: 394.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:51,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:03:51,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:51
2025-03-13 11:03:51,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:51,283 [INFO]: 	Creating the index 03/13/2025, 11:03:51
2025-03-13 11:03:51,283 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:51
2025-03-13 11:03:51,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:03:51,286 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:51
2025-03-13 11:03:51,286 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:03:51,287 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.97it/s] 88%|████████▊ | 7/8 [00:00<00:00, 37.31it/s]100%|██████████| 8/8 [00:01<00:00,  4.08it/s]
2025-03-13 11:03:53,251 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:53
2025-03-13 11:04:19,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6092 secs
2025-03-13 11:04:19,861 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 11:04:19,861 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-13 11:04:31,079 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2176 secs
2025-03-13 11:04:31,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7939 secs
2025-03-13 11:04:31,080 [INFO]: {
2025-03-13 11:04:31,080 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:31,080 [INFO]: 	index_param: efSearch=183
2025-03-13 11:04:31,080 [INFO]: 	index_path: knn.index
2025-03-13 11:04:31,080 [INFO]: 	size in bytes: 375584410
2025-03-13 11:04:31,080 [INFO]: 	avg_search_speed_ms: 9.283031081454224
2025-03-13 11:04:31,080 [INFO]: 	99p_search_speed_ms: 11.73858849797398
2025-03-13 11:04:31,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:31,080 [INFO]: 	nb vectors: 1909
2025-03-13 11:04:31,080 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:31,080 [INFO]: 	compression ratio: 0.9993084430740882
2025-03-13 11:04:31,080 [INFO]: }
2025-03-13 11:04:31,080 [INFO]: 	>>> Finished "Creating the index" in 39.7977 secs
2025-03-13 11:04:31,080 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8345 secs
2025-03-13 11:04:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 63204 [episode count 19/20]
2025-03-13 11:04:31: [retrieval_preprocessing] finished for 4570623316_orange_object_in_bowl [chosen_id count 0/260]
2025-03-13 11:04:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4570623316_wrench_in_black_bowl [chosen_id count 1/260]
2025-03-13 11:04:33: [retrieval_preprocessing] we have num_total=2068 embedding_dim=49152
[retrieval_preprocessing] for episode 17433 [episode count 0/20], we have num_retrieval=np.int64(1972) num_query=np.int64(96)
2025-03-13 11:04:33,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:33,618 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:33
2025-03-13 11:04:33,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.46it/s]
2025-03-13 11:04:33,648 [INFO]: There are 1972 embeddings of dim 49152
2025-03-13 11:04:33,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 11:04:33,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:33
2025-03-13 11:04:33,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:33,649 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:04:33,649 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:33,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:33,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:33
2025-03-13 11:04:33,649 [INFO]: 407.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:33,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:04:33,649 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:33
2025-03-13 11:04:33,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:33,649 [INFO]: 	Creating the index 03/13/2025, 11:04:33
2025-03-13 11:04:33,649 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:33
2025-03-13 11:04:33,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:04:33,650 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:33
2025-03-13 11:04:33,650 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:04:33,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.53it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.61it/s]100%|██████████| 8/8 [00:01<00:00,  5.18it/s]
2025-03-13 11:04:35,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:35
2025-03-13 11:04:59,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3040 secs
2025-03-13 11:04:59,503 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 11:04:59,504 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.81it/s]
2025-03-13 11:05:10,823 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3191 secs
2025-03-13 11:05:10,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1740 secs
2025-03-13 11:05:10,824 [INFO]: {
2025-03-13 11:05:10,824 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:10,824 [INFO]: 	index_param: efSearch=227
2025-03-13 11:05:10,824 [INFO]: 	index_path: knn.index
2025-03-13 11:05:10,824 [INFO]: 	size in bytes: 387979150
2025-03-13 11:05:10,824 [INFO]: 	avg_search_speed_ms: 10.136945087041823
2025-03-13 11:05:10,824 [INFO]: 	99p_search_speed_ms: 13.268570471554993
2025-03-13 11:05:10,824 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:10,824 [INFO]: 	nb vectors: 1972
2025-03-13 11:05:10,824 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:10,824 [INFO]: 	compression ratio: 0.999308792753425
2025-03-13 11:05:10,824 [INFO]: }
2025-03-13 11:05:10,824 [INFO]: 	>>> Finished "Creating the index" in 37.1754 secs
2025-03-13 11:05:10,824 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2065 secs
2025-03-13 11:05:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 17433 [episode count 0/20]
[retrieval_preprocessing] for episode 74267 [episode count 1/20], we have num_retrieval=np.int64(1966) num_query=np.int64(102)
2025-03-13 11:05:12,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:12,338 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:12
2025-03-13 11:05:12,338 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2013.59it/s]
2025-03-13 11:05:12,372 [INFO]: There are 1966 embeddings of dim 49152
2025-03-13 11:05:12,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 11:05:12,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:12
2025-03-13 11:05:12,373 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:12,373 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:05:12,373 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:12,373 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:12,373 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:12
2025-03-13 11:05:12,373 [INFO]: 405.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:12,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:05:12,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:12
2025-03-13 11:05:12,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:12,373 [INFO]: 	Creating the index 03/13/2025, 11:05:12
2025-03-13 11:05:12,373 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:12
2025-03-13 11:05:12,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:05:12,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:12
2025-03-13 11:05:12,374 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:05:12,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.18it/s] 62%|██████▎   | 5/8 [00:00<00:00, 26.44it/s]100%|██████████| 8/8 [00:02<00:00,  3.09it/s]100%|██████████| 8/8 [00:02<00:00,  3.77it/s]
2025-03-13 11:05:14,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:14
2025-03-13 11:05:41,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1255 secs
2025-03-13 11:05:41,627 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 11:05:41,627 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-13 11:05:53,422 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7944 secs
2025-03-13 11:05:53,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0487 secs
2025-03-13 11:05:53,423 [INFO]: {
2025-03-13 11:05:53,423 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:53,423 [INFO]: 	index_param: efSearch=203
2025-03-13 11:05:53,423 [INFO]: 	index_path: knn.index
2025-03-13 11:05:53,423 [INFO]: 	size in bytes: 386798710
2025-03-13 11:05:53,423 [INFO]: 	avg_search_speed_ms: 9.473426343351038
2025-03-13 11:05:53,423 [INFO]: 	99p_search_speed_ms: 12.79264648910612
2025-03-13 11:05:53,423 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:53,423 [INFO]: 	nb vectors: 1966
2025-03-13 11:05:53,423 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:53,423 [INFO]: 	compression ratio: 0.999308730890028
2025-03-13 11:05:53,423 [INFO]: }
2025-03-13 11:05:53,423 [INFO]: 	>>> Finished "Creating the index" in 41.0502 secs
2025-03-13 11:05:53,423 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0856 secs
2025-03-13 11:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 74267 [episode count 1/20]
[retrieval_preprocessing] for episode 20563 [episode count 2/20], we have num_retrieval=np.int64(1986) num_query=np.int64(82)
2025-03-13 11:05:54,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:54,676 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:54
2025-03-13 11:05:54,676 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-13 11:05:54,703 [INFO]: There are 1986 embeddings of dim 49152
2025-03-13 11:05:54,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:05:54,703 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:54
2025-03-13 11:05:54,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:54,703 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:05:54,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:54,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:54,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:54
2025-03-13 11:05:54,703 [INFO]: 409.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:54,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:05:54,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:54
2025-03-13 11:05:54,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:54,703 [INFO]: 	Creating the index 03/13/2025, 11:05:54
2025-03-13 11:05:54,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:54
2025-03-13 11:05:54,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:05:54,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:54
2025-03-13 11:05:54,705 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:05:54,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.08it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.67it/s]100%|██████████| 8/8 [00:01<00:00,  5.30it/s]
2025-03-13 11:05:56,218 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:56
2025-03-13 11:06:20,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5034 secs
2025-03-13 11:06:20,722 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 11:06:20,722 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 11:06:32,935 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2127 secs
2025-03-13 11:06:32,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2318 secs
2025-03-13 11:06:32,937 [INFO]: {
2025-03-13 11:06:32,937 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:32,937 [INFO]: 	index_param: efSearch=210
2025-03-13 11:06:32,937 [INFO]: 	index_path: knn.index
2025-03-13 11:06:32,937 [INFO]: 	size in bytes: 390733510
2025-03-13 11:06:32,937 [INFO]: 	avg_search_speed_ms: 9.669662449406225
2025-03-13 11:06:32,937 [INFO]: 	99p_search_speed_ms: 15.162488361820579
2025-03-13 11:06:32,937 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:32,937 [INFO]: 	nb vectors: 1986
2025-03-13 11:06:32,937 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:32,937 [INFO]: 	compression ratio: 0.9993089356477257
2025-03-13 11:06:32,937 [INFO]: }
2025-03-13 11:06:32,937 [INFO]: 	>>> Finished "Creating the index" in 38.2332 secs
2025-03-13 11:06:32,937 [INFO]: >>> Finished "Launching the whole pipeline" in 38.2604 secs
2025-03-13 11:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 20563 [episode count 2/20]
[retrieval_preprocessing] for episode 41557 [episode count 3/20], we have num_retrieval=np.int64(1982) num_query=np.int64(86)
2025-03-13 11:06:33,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:34,147 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:34
2025-03-13 11:06:34,147 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 11:06:34,182 [INFO]: There are 1982 embeddings of dim 49152
2025-03-13 11:06:34,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 11:06:34,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:34,182 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:06:34,182 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:34,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:34,182 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,182 [INFO]: 409.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:34,182 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:34,182 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:34
2025-03-13 11:06:34,182 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:34,182 [INFO]: 	Creating the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:34
2025-03-13 11:06:34,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:06:34,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,184 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:06:34,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.51it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.33it/s]100%|██████████| 8/8 [00:01<00:00,  5.05it/s]
2025-03-13 11:06:35,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:35
2025-03-13 11:07:03,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0342 secs
2025-03-13 11:07:03,805 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 11:07:03,805 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 11:07:15,196 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3901 secs
2025-03-13 11:07:15,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0137 secs
2025-03-13 11:07:15,198 [INFO]: {
2025-03-13 11:07:15,198 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:15,198 [INFO]: 	index_param: efSearch=232
2025-03-13 11:07:15,198 [INFO]: 	index_path: knn.index
2025-03-13 11:07:15,198 [INFO]: 	size in bytes: 389946550
2025-03-13 11:07:15,198 [INFO]: 	avg_search_speed_ms: 10.582355087347052
2025-03-13 11:07:15,198 [INFO]: 	99p_search_speed_ms: 15.52135222591458
2025-03-13 11:07:15,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:15,198 [INFO]: 	nb vectors: 1982
2025-03-13 11:07:15,198 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:15,198 [INFO]: 	compression ratio: 0.9993088950267671
2025-03-13 11:07:15,198 [INFO]: }
2025-03-13 11:07:15,198 [INFO]: 	>>> Finished "Creating the index" in 41.0159 secs
2025-03-13 11:07:15,198 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0511 secs
2025-03-13 11:07:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 41557 [episode count 3/20]
[retrieval_preprocessing] for episode 19064 [episode count 4/20], we have num_retrieval=np.int64(1987) num_query=np.int64(81)
2025-03-13 11:07:16,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:16,475 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:16
2025-03-13 11:07:16,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 11:07:16,503 [INFO]: There are 1987 embeddings of dim 49152
2025-03-13 11:07:16,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:07:16,503 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:16
2025-03-13 11:07:16,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:16,503 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:07:16,503 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:16,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:16,503 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:16
2025-03-13 11:07:16,504 [INFO]: 410.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:16,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:07:16,504 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:16
2025-03-13 11:07:16,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:16,504 [INFO]: 	Creating the index 03/13/2025, 11:07:16
2025-03-13 11:07:16,504 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:16
2025-03-13 11:07:16,505 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:07:16,505 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:16
2025-03-13 11:07:16,505 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:16,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.36it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.72it/s]100%|██████████| 8/8 [00:01<00:00,  4.30it/s]
2025-03-13 11:07:18,368 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:18
2025-03-13 11:07:43,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1977 secs
2025-03-13 11:07:43,566 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 11:07:43,566 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 11:07:55,850 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2843 secs
2025-03-13 11:07:55,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3469 secs
2025-03-13 11:07:55,852 [INFO]: {
2025-03-13 11:07:55,852 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:55,852 [INFO]: 	index_param: efSearch=225
2025-03-13 11:07:55,852 [INFO]: 	index_path: knn.index
2025-03-13 11:07:55,852 [INFO]: 	size in bytes: 390930250
2025-03-13 11:07:55,852 [INFO]: 	avg_search_speed_ms: 10.833745158881854
2025-03-13 11:07:55,852 [INFO]: 	99p_search_speed_ms: 15.987680265679955
2025-03-13 11:07:55,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:55,852 [INFO]: 	nb vectors: 1987
2025-03-13 11:07:55,852 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:55,852 [INFO]: 	compression ratio: 0.9993089457774117
2025-03-13 11:07:55,852 [INFO]: }
2025-03-13 11:07:55,852 [INFO]: 	>>> Finished "Creating the index" in 39.3483 secs
2025-03-13 11:07:55,852 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3774 secs
2025-03-13 11:07:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 19064 [episode count 4/20]
[retrieval_preprocessing] for episode 87684 [episode count 5/20], we have num_retrieval=np.int64(1961) num_query=np.int64(107)
2025-03-13 11:07:56,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:57,158 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:57
2025-03-13 11:07:57,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.99it/s]
2025-03-13 11:07:57,193 [INFO]: There are 1961 embeddings of dim 49152
2025-03-13 11:07:57,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 11:07:57,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:57
2025-03-13 11:07:57,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:57,194 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:07:57,194 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:57,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:57,194 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:57
2025-03-13 11:07:57,194 [INFO]: 404.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:57,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:07:57,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:57
2025-03-13 11:07:57,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:57,194 [INFO]: 	Creating the index 03/13/2025, 11:07:57
2025-03-13 11:07:57,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:57
2025-03-13 11:07:57,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:07:57,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:57
2025-03-13 11:07:57,195 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:57,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.22it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.87it/s]100%|██████████| 8/8 [00:01<00:00,  4.26it/s]
2025-03-13 11:07:59,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:59
2025-03-13 11:08:28,903 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8237 secs
2025-03-13 11:08:28,903 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:08:28,903 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 11:08:40,228 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3244 secs
2025-03-13 11:08:40,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0341 secs
2025-03-13 11:08:40,229 [INFO]: {
2025-03-13 11:08:40,229 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:40,229 [INFO]: 	index_param: efSearch=184
2025-03-13 11:08:40,229 [INFO]: 	index_path: knn.index
2025-03-13 11:08:40,229 [INFO]: 	size in bytes: 385815010
2025-03-13 11:08:40,230 [INFO]: 	avg_search_speed_ms: 9.79214003077005
2025-03-13 11:08:40,230 [INFO]: 	99p_search_speed_ms: 15.645481646060936
2025-03-13 11:08:40,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:40,230 [INFO]: 	nb vectors: 1961
2025-03-13 11:08:40,230 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:40,230 [INFO]: 	compression ratio: 0.9993086790480236
2025-03-13 11:08:40,230 [INFO]: }
2025-03-13 11:08:40,230 [INFO]: 	>>> Finished "Creating the index" in 43.0362 secs
2025-03-13 11:08:40,230 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0715 secs
2025-03-13 11:08:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 87684 [episode count 5/20]
[retrieval_preprocessing] for episode 8342 [episode count 6/20], we have num_retrieval=np.int64(1984) num_query=np.int64(84)
2025-03-13 11:08:41,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:41,361 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:41
2025-03-13 11:08:41,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1148.81it/s]
2025-03-13 11:08:41,390 [INFO]: There are 1984 embeddings of dim 49152
2025-03-13 11:08:41,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 11:08:41,390 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:41
2025-03-13 11:08:41,390 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:41,391 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:08:41,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:41,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:41,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:41
2025-03-13 11:08:41,391 [INFO]: 409.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:41,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:41,391 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:41
2025-03-13 11:08:41,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:41,391 [INFO]: 	Creating the index 03/13/2025, 11:08:41
2025-03-13 11:08:41,391 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:41
2025-03-13 11:08:41,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:08:41,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:41
2025-03-13 11:08:41,392 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:08:41,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.96it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.84it/s]100%|██████████| 8/8 [00:01<00:00,  5.30it/s]
2025-03-13 11:08:42,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:42
2025-03-13 11:09:10,737 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8318 secs
2025-03-13 11:09:10,737 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 11:09:10,737 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 11:09:23,522 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7842 secs
2025-03-13 11:09:23,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1313 secs
2025-03-13 11:09:23,524 [INFO]: {
2025-03-13 11:09:23,524 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:23,524 [INFO]: 	index_param: efSearch=213
2025-03-13 11:09:23,524 [INFO]: 	index_path: knn.index
2025-03-13 11:09:23,524 [INFO]: 	size in bytes: 390340030
2025-03-13 11:09:23,524 [INFO]: 	avg_search_speed_ms: 11.751236291996232
2025-03-13 11:09:23,524 [INFO]: 	99p_search_speed_ms: 19.16998450178653
2025-03-13 11:09:23,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:23,524 [INFO]: 	nb vectors: 1984
2025-03-13 11:09:23,524 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:23,524 [INFO]: 	compression ratio: 0.9993089153577203
2025-03-13 11:09:23,524 [INFO]: }
2025-03-13 11:09:23,524 [INFO]: 	>>> Finished "Creating the index" in 42.1329 secs
2025-03-13 11:09:23,524 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1631 secs
2025-03-13 11:09:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 8342 [episode count 6/20]
[retrieval_preprocessing] for episode 75437 [episode count 7/20], we have num_retrieval=np.int64(1827) num_query=np.int64(241)
2025-03-13 11:09:24,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:24,826 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:24
2025-03-13 11:09:24,826 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1092.84it/s]
2025-03-13 11:09:24,865 [INFO]: There are 1827 embeddings of dim 49152
2025-03-13 11:09:24,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-13 11:09:24,865 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:24
2025-03-13 11:09:24,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:24,865 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:09:24,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:24,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:09:24,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:24
2025-03-13 11:09:24,866 [INFO]: 377.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:24,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:09:24,866 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:24
2025-03-13 11:09:24,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:24,866 [INFO]: 	Creating the index 03/13/2025, 11:09:24
2025-03-13 11:09:24,866 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:24
2025-03-13 11:09:24,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:09:24,867 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:24
2025-03-13 11:09:24,867 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:09:24,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.80it/s]100%|██████████| 8/8 [00:01<00:00,  5.73it/s]100%|██████████| 8/8 [00:01<00:00,  6.04it/s]
2025-03-13 11:09:26,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:26
2025-03-13 11:09:49,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8539 secs
2025-03-13 11:09:49,050 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 11:09:49,050 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 11:10:00,332 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2821 secs
2025-03-13 11:10:00,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.4663 secs
2025-03-13 11:10:00,333 [INFO]: {
2025-03-13 11:10:00,333 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:00,334 [INFO]: 	index_param: efSearch=114
2025-03-13 11:10:00,334 [INFO]: 	index_path: knn.index
2025-03-13 11:10:00,334 [INFO]: 	size in bytes: 359451190
2025-03-13 11:10:00,334 [INFO]: 	avg_search_speed_ms: 7.008072268315699
2025-03-13 11:10:00,334 [INFO]: 	99p_search_speed_ms: 10.104912584647536
2025-03-13 11:10:00,334 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:00,334 [INFO]: 	nb vectors: 1827
2025-03-13 11:10:00,334 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:00,334 [INFO]: 	compression ratio: 0.9993090188406387
2025-03-13 11:10:00,334 [INFO]: }
2025-03-13 11:10:00,334 [INFO]: 	>>> Finished "Creating the index" in 35.4679 secs
2025-03-13 11:10:00,334 [INFO]: >>> Finished "Launching the whole pipeline" in 35.5078 secs
2025-03-13 11:10:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 75437 [episode count 7/20]
[retrieval_preprocessing] for episode 14511 [episode count 8/20], we have num_retrieval=np.int64(1915) num_query=np.int64(153)
2025-03-13 11:10:01,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:02,210 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:02
2025-03-13 11:10:02,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-13 11:10:02,240 [INFO]: There are 1915 embeddings of dim 49152
2025-03-13 11:10:02,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 11:10:02,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:02
2025-03-13 11:10:02,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:02,240 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:10:02,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:02,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:02,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:02
2025-03-13 11:10:02,241 [INFO]: 395.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:02,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:10:02,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:02
2025-03-13 11:10:02,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:02,241 [INFO]: 	Creating the index 03/13/2025, 11:10:02
2025-03-13 11:10:02,241 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:02
2025-03-13 11:10:02,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:02,242 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:02
2025-03-13 11:10:02,242 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:02,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.27it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.89it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]
2025-03-13 11:10:03,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:03
2025-03-13 11:10:31,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8961 secs
2025-03-13 11:10:31,715 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 11:10:31,715 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.78it/s]
2025-03-13 11:10:43,051 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3363 secs
2025-03-13 11:10:43,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8107 secs
2025-03-13 11:10:43,053 [INFO]: {
2025-03-13 11:10:43,053 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:43,053 [INFO]: 	index_param: efSearch=228
2025-03-13 11:10:43,053 [INFO]: 	index_path: knn.index
2025-03-13 11:10:43,053 [INFO]: 	size in bytes: 376764850
2025-03-13 11:10:43,053 [INFO]: 	avg_search_speed_ms: 10.836032239663721
2025-03-13 11:10:43,053 [INFO]: 	99p_search_speed_ms: 15.689743123948572
2025-03-13 11:10:43,053 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:43,053 [INFO]: 	nb vectors: 1915
2025-03-13 11:10:43,053 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:43,053 [INFO]: 	compression ratio: 0.9993085076805864
2025-03-13 11:10:43,053 [INFO]: }
2025-03-13 11:10:43,053 [INFO]: 	>>> Finished "Creating the index" in 40.8120 secs
2025-03-13 11:10:43,053 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8427 secs
2025-03-13 11:10:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 14511 [episode count 8/20]
[retrieval_preprocessing] for episode 48305 [episode count 9/20], we have num_retrieval=np.int64(1960) num_query=np.int64(108)
2025-03-13 11:10:44,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:45,044 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:45
2025-03-13 11:10:45,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2126.93it/s]
2025-03-13 11:10:45,074 [INFO]: There are 1960 embeddings of dim 49152
2025-03-13 11:10:45,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:10:45,074 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:45
2025-03-13 11:10:45,074 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:45,074 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:10:45,074 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:45,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:45,075 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:45
2025-03-13 11:10:45,075 [INFO]: 404.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:45,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:10:45,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:45
2025-03-13 11:10:45,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:45,075 [INFO]: 	Creating the index 03/13/2025, 11:10:45
2025-03-13 11:10:45,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:45
2025-03-13 11:10:45,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:45,076 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:45
2025-03-13 11:10:45,076 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:45,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.63it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.75it/s]100%|██████████| 8/8 [00:01<00:00,  4.64it/s]
2025-03-13 11:10:46,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:46
2025-03-13 11:11:14,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9636 secs
2025-03-13 11:11:14,766 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 11:11:14,767 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 11:11:27,571 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8040 secs
2025-03-13 11:11:27,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4963 secs
2025-03-13 11:11:27,572 [INFO]: {
2025-03-13 11:11:27,572 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:27,573 [INFO]: 	index_param: efSearch=217
2025-03-13 11:11:27,573 [INFO]: 	index_path: knn.index
2025-03-13 11:11:27,573 [INFO]: 	size in bytes: 385618270
2025-03-13 11:11:27,573 [INFO]: 	avg_search_speed_ms: 11.4434042629025
2025-03-13 11:11:27,573 [INFO]: 	99p_search_speed_ms: 17.660232624039054
2025-03-13 11:11:27,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:27,573 [INFO]: 	nb vectors: 1960
2025-03-13 11:11:27,573 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:27,573 [INFO]: 	compression ratio: 0.9993086686478833
2025-03-13 11:11:27,573 [INFO]: }
2025-03-13 11:11:27,573 [INFO]: 	>>> Finished "Creating the index" in 42.4977 secs
2025-03-13 11:11:27,573 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5291 secs
2025-03-13 11:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 48305 [episode count 9/20]
[retrieval_preprocessing] for episode 20659 [episode count 10/20], we have num_retrieval=np.int64(1970) num_query=np.int64(98)
2025-03-13 11:11:28,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:28,951 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:28
2025-03-13 11:11:28,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.21it/s]
2025-03-13 11:11:28,981 [INFO]: There are 1970 embeddings of dim 49152
2025-03-13 11:11:28,982 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:11:28,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:28
2025-03-13 11:11:28,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:28,982 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:11:28,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:28,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:28,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:28
2025-03-13 11:11:28,982 [INFO]: 406.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:28,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:28,982 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:28
2025-03-13 11:11:28,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:28,982 [INFO]: 	Creating the index 03/13/2025, 11:11:28
2025-03-13 11:11:28,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:28
2025-03-13 11:11:28,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:11:28,983 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:28
2025-03-13 11:11:28,984 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:11:28,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.16it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.07it/s]100%|██████████| 8/8 [00:01<00:00,  5.04it/s]
2025-03-13 11:11:30,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:30
2025-03-13 11:11:55,620 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0445 secs
2025-03-13 11:11:55,621 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:11:55,621 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.30it/s]
2025-03-13 11:12:09,828 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2069 secs
2025-03-13 11:12:09,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8469 secs
2025-03-13 11:12:09,831 [INFO]: {
2025-03-13 11:12:09,831 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:09,831 [INFO]: 	index_param: efSearch=204
2025-03-13 11:12:09,831 [INFO]: 	index_path: knn.index
2025-03-13 11:12:09,831 [INFO]: 	size in bytes: 387585670
2025-03-13 11:12:09,831 [INFO]: 	avg_search_speed_ms: 11.038032345212667
2025-03-13 11:12:09,831 [INFO]: 	99p_search_speed_ms: 25.41374766733498
2025-03-13 11:12:09,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:09,831 [INFO]: 	nb vectors: 1970
2025-03-13 11:12:09,831 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:09,831 [INFO]: 	compression ratio: 0.9993087721741621
2025-03-13 11:12:09,831 [INFO]: }
2025-03-13 11:12:09,831 [INFO]: 	>>> Finished "Creating the index" in 40.8491 secs
2025-03-13 11:12:09,831 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8799 secs
2025-03-13 11:12:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 20659 [episode count 10/20]
[retrieval_preprocessing] for episode 24766 [episode count 11/20], we have num_retrieval=np.int64(1980) num_query=np.int64(88)
2025-03-13 11:12:10,979 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:11,353 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:11
2025-03-13 11:12:11,353 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.65it/s]
2025-03-13 11:12:11,387 [INFO]: There are 1980 embeddings of dim 49152
2025-03-13 11:12:11,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 11:12:11,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:11,388 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:12:11,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:11,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:11,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,388 [INFO]: 408.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:11,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:11,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:11
2025-03-13 11:12:11,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:11,388 [INFO]: 	Creating the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:11
2025-03-13 11:12:11,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:12:11,389 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,389 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:11,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.12it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.28it/s]100%|██████████| 8/8 [00:02<00:00,  3.89it/s]
2025-03-13 11:12:13,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:13
2025-03-13 11:12:41,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6108 secs
2025-03-13 11:12:41,063 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:12:41,063 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.81it/s]
2025-03-13 11:12:53,443 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3797 secs
2025-03-13 11:12:53,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0547 secs
2025-03-13 11:12:53,444 [INFO]: {
2025-03-13 11:12:53,444 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:53,444 [INFO]: 	index_param: efSearch=215
2025-03-13 11:12:53,444 [INFO]: 	index_path: knn.index
2025-03-13 11:12:53,444 [INFO]: 	size in bytes: 389553070
2025-03-13 11:12:53,444 [INFO]: 	avg_search_speed_ms: 10.10792954246316
2025-03-13 11:12:53,444 [INFO]: 	99p_search_speed_ms: 14.357909604441375
2025-03-13 11:12:53,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:53,444 [INFO]: 	nb vectors: 1980
2025-03-13 11:12:53,444 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:53,444 [INFO]: 	compression ratio: 0.9993088746547422
2025-03-13 11:12:53,444 [INFO]: }
2025-03-13 11:12:53,444 [INFO]: 	>>> Finished "Creating the index" in 42.0564 secs
2025-03-13 11:12:53,444 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0911 secs
2025-03-13 11:12:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 24766 [episode count 11/20]
[retrieval_preprocessing] for episode 41708 [episode count 12/20], we have num_retrieval=np.int64(1973) num_query=np.int64(95)
2025-03-13 11:12:54,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:54,595 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:54
2025-03-13 11:12:54,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 11:12:54,623 [INFO]: There are 1973 embeddings of dim 49152
2025-03-13 11:12:54,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:12:54,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:54
2025-03-13 11:12:54,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:54,624 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:12:54,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:54,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:12:54,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:54
2025-03-13 11:12:54,625 [INFO]: 407.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:54,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:12:54,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:54
2025-03-13 11:12:54,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:54,626 [INFO]: 	Creating the index 03/13/2025, 11:12:54
2025-03-13 11:12:54,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:54
2025-03-13 11:12:54,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:12:54,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:54
2025-03-13 11:12:54,629 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:54,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.30it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.98it/s]100%|██████████| 8/8 [00:01<00:00,  4.55it/s]
2025-03-13 11:12:56,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:56
2025-03-13 11:13:23,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8345 secs
2025-03-13 11:13:23,229 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:13:23,229 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.86it/s]
2025-03-13 11:13:34,593 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3644 secs
2025-03-13 11:13:34,595 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.9658 secs
2025-03-13 11:13:34,595 [INFO]: {
2025-03-13 11:13:34,595 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:34,595 [INFO]: 	index_param: efSearch=193
2025-03-13 11:13:34,595 [INFO]: 	index_path: knn.index
2025-03-13 11:13:34,595 [INFO]: 	size in bytes: 388175890
2025-03-13 11:13:34,595 [INFO]: 	avg_search_speed_ms: 8.837181040622268
2025-03-13 11:13:34,595 [INFO]: 	99p_search_speed_ms: 12.8788674552925
2025-03-13 11:13:34,595 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:34,595 [INFO]: 	nb vectors: 1973
2025-03-13 11:13:34,595 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:34,595 [INFO]: 	compression ratio: 0.9993088030274111
2025-03-13 11:13:34,595 [INFO]: }
2025-03-13 11:13:34,595 [INFO]: 	>>> Finished "Creating the index" in 39.9695 secs
2025-03-13 11:13:34,595 [INFO]: >>> Finished "Launching the whole pipeline" in 39.9997 secs
2025-03-13 11:13:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 41708 [episode count 12/20]
[retrieval_preprocessing] for episode 65438 [episode count 13/20], we have num_retrieval=np.int64(1980) num_query=np.int64(88)
2025-03-13 11:13:35,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:35,748 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:35
2025-03-13 11:13:35,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 11:13:35,776 [INFO]: There are 1980 embeddings of dim 49152
2025-03-13 11:13:35,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:13:35,776 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:35
2025-03-13 11:13:35,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:35,776 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:13:35,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:35,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:35,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:35
2025-03-13 11:13:35,776 [INFO]: 408.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:35,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:35,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:35
2025-03-13 11:13:35,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:35,776 [INFO]: 	Creating the index 03/13/2025, 11:13:35
2025-03-13 11:13:35,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:35
2025-03-13 11:13:35,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:13:35,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:35
2025-03-13 11:13:35,778 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:13:35,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.79it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.01it/s]100%|██████████| 8/8 [00:01<00:00,  4.02it/s]100%|██████████| 8/8 [00:01<00:00,  4.82it/s]
2025-03-13 11:13:37,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:37
2025-03-13 11:14:03,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7310 secs
2025-03-13 11:14:03,173 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 11:14:03,173 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 11:14:14,916 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7433 secs
2025-03-13 11:14:14,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.1404 secs
2025-03-13 11:14:14,918 [INFO]: {
2025-03-13 11:14:14,918 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:14,918 [INFO]: 	index_param: efSearch=235
2025-03-13 11:14:14,918 [INFO]: 	index_path: knn.index
2025-03-13 11:14:14,918 [INFO]: 	size in bytes: 389553070
2025-03-13 11:14:14,918 [INFO]: 	avg_search_speed_ms: 10.88975512491533
2025-03-13 11:14:14,918 [INFO]: 	99p_search_speed_ms: 15.611872198060142
2025-03-13 11:14:14,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:14,918 [INFO]: 	nb vectors: 1980
2025-03-13 11:14:14,918 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:14,918 [INFO]: 	compression ratio: 0.9993088746547422
2025-03-13 11:14:14,918 [INFO]: }
2025-03-13 11:14:14,918 [INFO]: 	>>> Finished "Creating the index" in 39.1418 secs
2025-03-13 11:14:14,918 [INFO]: >>> Finished "Launching the whole pipeline" in 39.1701 secs
2025-03-13 11:14:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 65438 [episode count 13/20]
[retrieval_preprocessing] for episode 5377 [episode count 14/20], we have num_retrieval=np.int64(1949) num_query=np.int64(119)
2025-03-13 11:14:15,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:16,218 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:16
2025-03-13 11:14:16,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.79it/s]
2025-03-13 11:14:16,250 [INFO]: There are 1949 embeddings of dim 49152
2025-03-13 11:14:16,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 11:14:16,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:16
2025-03-13 11:14:16,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:16,251 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:14:16,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:16,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:16,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:16
2025-03-13 11:14:16,251 [INFO]: 402.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:16,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:16,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:16
2025-03-13 11:14:16,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:16,251 [INFO]: 	Creating the index 03/13/2025, 11:14:16
2025-03-13 11:14:16,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:16
2025-03-13 11:14:16,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:14:16,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:16
2025-03-13 11:14:16,252 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:14:16,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.38it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.68it/s]100%|██████████| 8/8 [00:01<00:00,  4.82it/s]
2025-03-13 11:14:17,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:17
2025-03-13 11:14:45,025 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1105 secs
2025-03-13 11:14:45,025 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:14:45,025 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 11:14:57,066 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0404 secs
2025-03-13 11:14:57,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8152 secs
2025-03-13 11:14:57,068 [INFO]: {
2025-03-13 11:14:57,068 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:57,068 [INFO]: 	index_param: efSearch=239
2025-03-13 11:14:57,068 [INFO]: 	index_path: knn.index
2025-03-13 11:14:57,068 [INFO]: 	size in bytes: 383454130
2025-03-13 11:14:57,068 [INFO]: 	avg_search_speed_ms: 10.298844328558745
2025-03-13 11:14:57,068 [INFO]: 	99p_search_speed_ms: 14.014735701493919
2025-03-13 11:14:57,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:57,068 [INFO]: 	nb vectors: 1949
2025-03-13 11:14:57,068 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:57,068 [INFO]: 	compression ratio: 0.9993085535419842
2025-03-13 11:14:57,068 [INFO]: }
2025-03-13 11:14:57,068 [INFO]: 	>>> Finished "Creating the index" in 40.8168 secs
2025-03-13 11:14:57,068 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8496 secs
2025-03-13 11:14:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 5377 [episode count 14/20]
[retrieval_preprocessing] for episode 72124 [episode count 15/20], we have num_retrieval=np.int64(1984) num_query=np.int64(84)
2025-03-13 11:14:58,588 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:58,862 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:58
2025-03-13 11:14:58,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.04it/s]
2025-03-13 11:14:58,891 [INFO]: There are 1984 embeddings of dim 49152
2025-03-13 11:14:58,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:14:58,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:58
2025-03-13 11:14:58,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:58,892 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:14:58,892 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:58,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:58,892 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:58
2025-03-13 11:14:58,892 [INFO]: 409.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:58,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:58,892 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:58
2025-03-13 11:14:58,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:58,892 [INFO]: 	Creating the index 03/13/2025, 11:14:58
2025-03-13 11:14:58,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:58
2025-03-13 11:14:58,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:14:58,893 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:58
2025-03-13 11:14:58,893 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:14:58,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.53it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.24it/s]100%|██████████| 8/8 [00:01<00:00,  4.97it/s]
2025-03-13 11:15:00,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:00
2025-03-13 11:15:25,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1613 secs
2025-03-13 11:15:25,668 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 11:15:25,668 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 11:15:37,021 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3529 secs
2025-03-13 11:15:37,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.1287 secs
2025-03-13 11:15:37,022 [INFO]: {
2025-03-13 11:15:37,022 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:37,022 [INFO]: 	index_param: efSearch=241
2025-03-13 11:15:37,022 [INFO]: 	index_path: knn.index
2025-03-13 11:15:37,022 [INFO]: 	size in bytes: 390340030
2025-03-13 11:15:37,022 [INFO]: 	avg_search_speed_ms: 10.339177251612567
2025-03-13 11:15:37,022 [INFO]: 	99p_search_speed_ms: 15.047217006795112
2025-03-13 11:15:37,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:37,022 [INFO]: 	nb vectors: 1984
2025-03-13 11:15:37,022 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:37,022 [INFO]: 	compression ratio: 0.9993089153577203
2025-03-13 11:15:37,022 [INFO]: }
2025-03-13 11:15:37,022 [INFO]: 	>>> Finished "Creating the index" in 38.1300 secs
2025-03-13 11:15:37,022 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1598 secs
2025-03-13 11:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 72124 [episode count 15/20]
[retrieval_preprocessing] for episode 31167 [episode count 16/20], we have num_retrieval=np.int64(1986) num_query=np.int64(82)
2025-03-13 11:15:38,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:38,337 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:38
2025-03-13 11:15:38,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1878.33it/s]
2025-03-13 11:15:38,368 [INFO]: There are 1986 embeddings of dim 49152
2025-03-13 11:15:38,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:15:38,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:38
2025-03-13 11:15:38,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:38,368 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:15:38,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:38,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:38,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:38
2025-03-13 11:15:38,368 [INFO]: 409.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:38,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:38,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:38
2025-03-13 11:15:38,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:38,368 [INFO]: 	Creating the index 03/13/2025, 11:15:38
2025-03-13 11:15:38,368 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:38
2025-03-13 11:15:38,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:15:38,369 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:38
2025-03-13 11:15:38,369 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:15:38,369 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.90it/s]100%|██████████| 8/8 [00:01<00:00,  5.20it/s]100%|██████████| 8/8 [00:01<00:00,  5.49it/s]
2025-03-13 11:15:39,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:39
2025-03-13 11:16:08,141 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3097 secs
2025-03-13 11:16:08,141 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 11:16:08,141 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 11:16:19,636 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4944 secs
2025-03-13 11:16:19,637 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2678 secs
2025-03-13 11:16:19,637 [INFO]: {
2025-03-13 11:16:19,637 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:19,637 [INFO]: 	index_param: efSearch=236
2025-03-13 11:16:19,637 [INFO]: 	index_path: knn.index
2025-03-13 11:16:19,637 [INFO]: 	size in bytes: 390733510
2025-03-13 11:16:19,637 [INFO]: 	avg_search_speed_ms: 10.504587084848477
2025-03-13 11:16:19,637 [INFO]: 	99p_search_speed_ms: 14.586415048688652
2025-03-13 11:16:19,637 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:19,637 [INFO]: 	nb vectors: 1986
2025-03-13 11:16:19,637 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:19,638 [INFO]: 	compression ratio: 0.9993089356477257
2025-03-13 11:16:19,638 [INFO]: }
2025-03-13 11:16:19,638 [INFO]: 	>>> Finished "Creating the index" in 41.2692 secs
2025-03-13 11:16:19,638 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3001 secs
2025-03-13 11:16:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 31167 [episode count 16/20]
[retrieval_preprocessing] for episode 18389 [episode count 17/20], we have num_retrieval=np.int64(1967) num_query=np.int64(101)
2025-03-13 11:16:20,864 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:21,176 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:21
2025-03-13 11:16:21,176 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.02it/s]
2025-03-13 11:16:21,204 [INFO]: There are 1967 embeddings of dim 49152
2025-03-13 11:16:21,204 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:16:21,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:21
2025-03-13 11:16:21,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:21,204 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:16:21,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:21,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:21,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:21
2025-03-13 11:16:21,205 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:21,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:21,205 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:21
2025-03-13 11:16:21,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:21,205 [INFO]: 	Creating the index 03/13/2025, 11:16:21
2025-03-13 11:16:21,205 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:21
2025-03-13 11:16:21,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:16:21,206 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:21
2025-03-13 11:16:21,206 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:16:21,206 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.09it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.84it/s]100%|██████████| 8/8 [00:01<00:00,  5.15it/s]
2025-03-13 11:16:22,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:22
2025-03-13 11:16:46,491 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7274 secs
2025-03-13 11:16:46,491 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 11:16:46,491 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-13 11:16:57,750 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2587 secs
2025-03-13 11:16:57,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.5449 secs
2025-03-13 11:16:57,751 [INFO]: {
2025-03-13 11:16:57,751 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:57,751 [INFO]: 	index_param: efSearch=217
2025-03-13 11:16:57,751 [INFO]: 	index_path: knn.index
2025-03-13 11:16:57,751 [INFO]: 	size in bytes: 386995450
2025-03-13 11:16:57,751 [INFO]: 	avg_search_speed_ms: 9.126091686954355
2025-03-13 11:16:57,751 [INFO]: 	99p_search_speed_ms: 15.07532162358984
2025-03-13 11:16:57,751 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:57,751 [INFO]: 	nb vectors: 1967
2025-03-13 11:16:57,751 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:57,751 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-13 11:16:57,751 [INFO]: }
2025-03-13 11:16:57,751 [INFO]: 	>>> Finished "Creating the index" in 36.5463 secs
2025-03-13 11:16:57,751 [INFO]: >>> Finished "Launching the whole pipeline" in 36.5755 secs
2025-03-13 11:16:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18389 [episode count 17/20]
[retrieval_preprocessing] for episode 80870 [episode count 18/20], we have num_retrieval=np.int64(1974) num_query=np.int64(94)
2025-03-13 11:16:58,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:59,106 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:59
2025-03-13 11:16:59,106 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1888.48it/s]
2025-03-13 11:16:59,136 [INFO]: There are 1974 embeddings of dim 49152
2025-03-13 11:16:59,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:16:59,137 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:59
2025-03-13 11:16:59,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:59,137 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:16:59,137 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:59,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:59,137 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:59
2025-03-13 11:16:59,137 [INFO]: 407.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:59,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:59,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:59
2025-03-13 11:16:59,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:59,137 [INFO]: 	Creating the index 03/13/2025, 11:16:59
2025-03-13 11:16:59,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:59
2025-03-13 11:16:59,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:16:59,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:59
2025-03-13 11:16:59,138 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:16:59,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.06it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.45it/s]100%|██████████| 8/8 [00:01<00:00,  4.78it/s]
2025-03-13 11:17:00,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:00
2025-03-13 11:17:25,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5751 secs
2025-03-13 11:17:25,391 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:17:25,391 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 11:17:36,681 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2894 secs
2025-03-13 11:17:36,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.5439 secs
2025-03-13 11:17:36,682 [INFO]: {
2025-03-13 11:17:36,682 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:36,682 [INFO]: 	index_param: efSearch=219
2025-03-13 11:17:36,682 [INFO]: 	index_path: knn.index
2025-03-13 11:17:36,682 [INFO]: 	size in bytes: 388372630
2025-03-13 11:17:36,682 [INFO]: 	avg_search_speed_ms: 9.52811347453722
2025-03-13 11:17:36,682 [INFO]: 	99p_search_speed_ms: 12.533866872545332
2025-03-13 11:17:36,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:36,682 [INFO]: 	nb vectors: 1974
2025-03-13 11:17:36,682 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:36,682 [INFO]: 	compression ratio: 0.9993088132909881
2025-03-13 11:17:36,682 [INFO]: }
2025-03-13 11:17:36,682 [INFO]: 	>>> Finished "Creating the index" in 37.5452 secs
2025-03-13 11:17:36,682 [INFO]: >>> Finished "Launching the whole pipeline" in 37.5764 secs
2025-03-13 11:17:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 80870 [episode count 18/20]
[retrieval_preprocessing] for episode 73610 [episode count 19/20], we have num_retrieval=np.int64(1989) num_query=np.int64(79)
2025-03-13 11:17:37,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:38,162 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:38
2025-03-13 11:17:38,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-13 11:17:38,190 [INFO]: There are 1989 embeddings of dim 49152
2025-03-13 11:17:38,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:17:38,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:38
2025-03-13 11:17:38,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:38,190 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:17:38,190 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:38,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:38,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:38
2025-03-13 11:17:38,191 [INFO]: 410.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:38,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:17:38,191 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:38
2025-03-13 11:17:38,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:38,191 [INFO]: 	Creating the index 03/13/2025, 11:17:38
2025-03-13 11:17:38,191 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:38
2025-03-13 11:17:38,192 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:17:38,192 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:38
2025-03-13 11:17:38,192 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:17:38,192 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.13it/s] 50%|█████     | 4/8 [00:00<00:00, 20.30it/s]100%|██████████| 8/8 [00:01<00:00,  4.05it/s]100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
2025-03-13 11:17:39,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:39
2025-03-13 11:18:05,638 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7260 secs
2025-03-13 11:18:05,638 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:18:05,638 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-13 11:18:16,938 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2993 secs
2025-03-13 11:18:16,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7473 secs
2025-03-13 11:18:16,939 [INFO]: {
2025-03-13 11:18:16,939 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:16,939 [INFO]: 	index_param: efSearch=233
2025-03-13 11:18:16,939 [INFO]: 	index_path: knn.index
2025-03-13 11:18:16,939 [INFO]: 	size in bytes: 391323790
2025-03-13 11:18:16,939 [INFO]: 	avg_search_speed_ms: 10.107723124221796
2025-03-13 11:18:16,939 [INFO]: 	99p_search_speed_ms: 15.090798330493275
2025-03-13 11:18:16,939 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:16,939 [INFO]: 	nb vectors: 1989
2025-03-13 11:18:16,939 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:16,939 [INFO]: 	compression ratio: 0.9993088127864651
2025-03-13 11:18:16,939 [INFO]: }
2025-03-13 11:18:16,939 [INFO]: 	>>> Finished "Creating the index" in 38.7485 secs
2025-03-13 11:18:16,939 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7772 secs
2025-03-13 11:18:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 73610 [episode count 19/20]
2025-03-13 11:18:17: [retrieval_preprocessing] finished for 4570623316_wrench_in_black_bowl [chosen_id count 1/260]
2025-03-13 11:18:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4706041793_place_cloth_on_table [chosen_id count 2/260]
2025-03-13 11:18:19: [retrieval_preprocessing] we have num_total=2274 embedding_dim=49152
[retrieval_preprocessing] for episode 20480 [episode count 0/20], we have num_retrieval=np.int64(2157) num_query=np.int64(117)
2025-03-13 11:18:19,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:19,501 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:19
2025-03-13 11:18:19,501 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1601.49it/s]
2025-03-13 11:18:19,536 [INFO]: There are 2157 embeddings of dim 49152
2025-03-13 11:18:19,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 11:18:19,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:19
2025-03-13 11:18:19,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:19,537 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:18:19,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:19,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:18:19,537 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:19
2025-03-13 11:18:19,537 [INFO]: 445.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:19,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:18:19,537 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:19
2025-03-13 11:18:19,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:19,538 [INFO]: 	Creating the index 03/13/2025, 11:18:19
2025-03-13 11:18:19,538 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:19
2025-03-13 11:18:19,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:18:19,541 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:19
2025-03-13 11:18:19,541 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:18:19,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.11it/s]100%|██████████| 9/9 [00:01<00:00,  4.67it/s]100%|██████████| 9/9 [00:01<00:00,  5.08it/s]
2025-03-13 11:18:21,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:21
2025-03-13 11:18:56,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5179 secs
2025-03-13 11:18:56,837 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 11:18:56,837 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 11:19:08,278 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4405 secs
2025-03-13 11:19:08,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7379 secs
2025-03-13 11:19:08,279 [INFO]: {
2025-03-13 11:19:08,279 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:08,279 [INFO]: 	index_param: efSearch=218
2025-03-13 11:19:08,279 [INFO]: 	index_path: knn.index
2025-03-13 11:19:08,279 [INFO]: 	size in bytes: 424376650
2025-03-13 11:19:08,279 [INFO]: 	avg_search_speed_ms: 11.062595082819874
2025-03-13 11:19:08,279 [INFO]: 	99p_search_speed_ms: 14.434972475282848
2025-03-13 11:19:08,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:08,279 [INFO]: 	nb vectors: 2157
2025-03-13 11:19:08,279 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:08,279 [INFO]: 	compression ratio: 0.9993091184446646
2025-03-13 11:19:08,279 [INFO]: }
2025-03-13 11:19:08,279 [INFO]: 	>>> Finished "Creating the index" in 48.7417 secs
2025-03-13 11:19:08,279 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7780 secs
2025-03-13 11:19:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 20480 [episode count 0/20]
[retrieval_preprocessing] for episode 51732 [episode count 1/20], we have num_retrieval=np.int64(2173) num_query=np.int64(101)
2025-03-13 11:19:09,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:09,760 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:09
2025-03-13 11:19:09,760 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.18it/s]
2025-03-13 11:19:09,788 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 11:19:09,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:19:09,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:09
2025-03-13 11:19:09,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:09,789 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:19:09,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:09,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:09,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:09
2025-03-13 11:19:09,789 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:09,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:09,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:09
2025-03-13 11:19:09,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:09,789 [INFO]: 	Creating the index 03/13/2025, 11:19:09
2025-03-13 11:19:09,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:09
2025-03-13 11:19:09,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:09,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:09
2025-03-13 11:19:09,790 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:19:09,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.66it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.69it/s]100%|██████████| 9/9 [00:01<00:00,  4.13it/s]100%|██████████| 9/9 [00:01<00:00,  5.05it/s]
2025-03-13 11:19:11,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:11
2025-03-13 11:19:36,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7873 secs
2025-03-13 11:19:36,364 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 11:19:36,364 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 11:19:48,088 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7239 secs
2025-03-13 11:19:48,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2989 secs
2025-03-13 11:19:48,089 [INFO]: {
2025-03-13 11:19:48,089 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:48,089 [INFO]: 	index_param: efSearch=160
2025-03-13 11:19:48,089 [INFO]: 	index_path: knn.index
2025-03-13 11:19:48,089 [INFO]: 	size in bytes: 427524550
2025-03-13 11:19:48,089 [INFO]: 	avg_search_speed_ms: 8.581196365462288
2025-03-13 11:19:48,089 [INFO]: 	99p_search_speed_ms: 13.72811060398817
2025-03-13 11:19:48,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:48,089 [INFO]: 	nb vectors: 2173
2025-03-13 11:19:48,089 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:48,089 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 11:19:48,089 [INFO]: }
2025-03-13 11:19:48,089 [INFO]: 	>>> Finished "Creating the index" in 38.3003 secs
2025-03-13 11:19:48,089 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3292 secs
2025-03-13 11:19:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 51732 [episode count 1/20]
[retrieval_preprocessing] for episode 13356 [episode count 2/20], we have num_retrieval=np.int64(2160) num_query=np.int64(114)
2025-03-13 11:19:48,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:49,221 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:49
2025-03-13 11:19:49,221 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]
2025-03-13 11:19:49,252 [INFO]: There are 2160 embeddings of dim 49152
2025-03-13 11:19:49,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:19:49,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:49
2025-03-13 11:19:49,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:49,252 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:19:49,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:49,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:49,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:49
2025-03-13 11:19:49,252 [INFO]: 445.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:49,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:49,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:49
2025-03-13 11:19:49,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:49,252 [INFO]: 	Creating the index 03/13/2025, 11:19:49
2025-03-13 11:19:49,252 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:49
2025-03-13 11:19:49,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:19:49,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:49
2025-03-13 11:19:49,253 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:19:49,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.35it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.34it/s]100%|██████████| 9/9 [00:01<00:00,  4.92it/s]
2025-03-13 11:19:51,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:51
2025-03-13 11:20:20,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2495 secs
2025-03-13 11:20:20,334 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 11:20:20,334 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-13 11:20:31,928 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5935 secs
2025-03-13 11:20:31,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6759 secs
2025-03-13 11:20:31,929 [INFO]: {
2025-03-13 11:20:31,929 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:31,929 [INFO]: 	index_param: efSearch=192
2025-03-13 11:20:31,929 [INFO]: 	index_path: knn.index
2025-03-13 11:20:31,929 [INFO]: 	size in bytes: 424966870
2025-03-13 11:20:31,929 [INFO]: 	avg_search_speed_ms: 10.199226638602205
2025-03-13 11:20:31,929 [INFO]: 	99p_search_speed_ms: 13.346372731029996
2025-03-13 11:20:31,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:31,929 [INFO]: 	nb vectors: 2160
2025-03-13 11:20:31,929 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:31,929 [INFO]: 	compression ratio: 0.9993091461459102
2025-03-13 11:20:31,929 [INFO]: }
2025-03-13 11:20:31,929 [INFO]: 	>>> Finished "Creating the index" in 42.6771 secs
2025-03-13 11:20:31,929 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7084 secs
2025-03-13 11:20:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 13356 [episode count 2/20]
[retrieval_preprocessing] for episode 24137 [episode count 3/20], we have num_retrieval=np.int64(2175) num_query=np.int64(99)
2025-03-13 11:20:32,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:33,271 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:33
2025-03-13 11:20:33,271 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1708.47it/s]
2025-03-13 11:20:33,297 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 11:20:33,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:20:33,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:33
2025-03-13 11:20:33,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:33,298 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:20:33,298 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:33,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:33,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:33
2025-03-13 11:20:33,298 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:33,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:33,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:33
2025-03-13 11:20:33,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:33,298 [INFO]: 	Creating the index 03/13/2025, 11:20:33
2025-03-13 11:20:33,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:33
2025-03-13 11:20:33,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:20:33,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:33
2025-03-13 11:20:33,299 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:20:33,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.77it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.96it/s]100%|██████████| 9/9 [00:01<00:00,  5.22it/s]
2025-03-13 11:20:35,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:35
2025-03-13 11:21:05,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8384 secs
2025-03-13 11:21:05,866 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:21:05,866 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.99it/s]
2025-03-13 11:21:17,554 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6875 secs
2025-03-13 11:21:17,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2562 secs
2025-03-13 11:21:17,556 [INFO]: {
2025-03-13 11:21:17,556 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:17,556 [INFO]: 	index_param: efSearch=194
2025-03-13 11:21:17,556 [INFO]: 	index_path: knn.index
2025-03-13 11:21:17,556 [INFO]: 	size in bytes: 427918090
2025-03-13 11:21:17,556 [INFO]: 	avg_search_speed_ms: 10.010772571154126
2025-03-13 11:21:17,556 [INFO]: 	99p_search_speed_ms: 15.202807229943572
2025-03-13 11:21:17,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:17,556 [INFO]: 	nb vectors: 2175
2025-03-13 11:21:17,556 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:17,556 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 11:21:17,556 [INFO]: }
2025-03-13 11:21:17,556 [INFO]: 	>>> Finished "Creating the index" in 44.2582 secs
2025-03-13 11:21:17,556 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2853 secs
2025-03-13 11:21:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 24137 [episode count 3/20]
[retrieval_preprocessing] for episode 17499 [episode count 4/20], we have num_retrieval=np.int64(2190) num_query=np.int64(84)
2025-03-13 11:21:18,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:18,834 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:18
2025-03-13 11:21:18,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1810.23it/s]
2025-03-13 11:21:18,866 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 11:21:18,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:21:18,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:18,867 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:21:18,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:18,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:18,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,867 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:18,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:18,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:18
2025-03-13 11:21:18,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:18,867 [INFO]: 	Creating the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,867 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:18
2025-03-13 11:21:18,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:21:18,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,868 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:21:18,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.04it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.85it/s]100%|██████████| 9/9 [00:01<00:00,  5.27it/s]
2025-03-13 11:21:20,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:20
2025-03-13 11:21:46,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9444 secs
2025-03-13 11:21:46,524 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 11:21:46,524 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.63it/s]
2025-03-13 11:21:58,160 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6353 secs
2025-03-13 11:21:58,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2932 secs
2025-03-13 11:21:58,161 [INFO]: {
2025-03-13 11:21:58,161 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:58,161 [INFO]: 	index_param: efSearch=172
2025-03-13 11:21:58,161 [INFO]: 	index_path: knn.index
2025-03-13 11:21:58,161 [INFO]: 	size in bytes: 430869310
2025-03-13 11:21:58,161 [INFO]: 	avg_search_speed_ms: 8.748836408973014
2025-03-13 11:21:58,161 [INFO]: 	99p_search_speed_ms: 12.505765911191697
2025-03-13 11:21:58,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:58,161 [INFO]: 	nb vectors: 2190
2025-03-13 11:21:58,161 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:58,161 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 11:21:58,161 [INFO]: }
2025-03-13 11:21:58,161 [INFO]: 	>>> Finished "Creating the index" in 39.2945 secs
2025-03-13 11:21:58,161 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3272 secs
2025-03-13 11:21:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 17499 [episode count 4/20]
[retrieval_preprocessing] for episode 63613 [episode count 5/20], we have num_retrieval=np.int64(2154) num_query=np.int64(120)
2025-03-13 11:21:58,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:59,265 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:59
2025-03-13 11:21:59,265 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1668.38it/s]
2025-03-13 11:21:59,291 [INFO]: There are 2154 embeddings of dim 49152
2025-03-13 11:21:59,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:21:59,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:59
2025-03-13 11:21:59,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:59,292 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:21:59,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:59,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:59,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:59
2025-03-13 11:21:59,292 [INFO]: 444.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:59,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:59,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:59
2025-03-13 11:21:59,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:59,292 [INFO]: 	Creating the index 03/13/2025, 11:21:59
2025-03-13 11:21:59,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:59
2025-03-13 11:21:59,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:21:59,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:59
2025-03-13 11:21:59,293 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:21:59,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.37it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.83it/s]100%|██████████| 9/9 [00:01<00:00,  5.19it/s]
2025-03-13 11:22:01,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:01
2025-03-13 11:22:29,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1914 secs
2025-03-13 11:22:29,223 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 11:22:29,223 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 11:22:41,307 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0839 secs
2025-03-13 11:22:41,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0163 secs
2025-03-13 11:22:41,310 [INFO]: {
2025-03-13 11:22:41,310 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:41,310 [INFO]: 	index_param: efSearch=195
2025-03-13 11:22:41,310 [INFO]: 	index_path: knn.index
2025-03-13 11:22:41,310 [INFO]: 	size in bytes: 423786370
2025-03-13 11:22:41,310 [INFO]: 	avg_search_speed_ms: 10.54741691391255
2025-03-13 11:22:41,310 [INFO]: 	99p_search_speed_ms: 17.523770402185615
2025-03-13 11:22:41,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:41,310 [INFO]: 	nb vectors: 2154
2025-03-13 11:22:41,310 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:41,310 [INFO]: 	compression ratio: 0.9993092321492076
2025-03-13 11:22:41,310 [INFO]: }
2025-03-13 11:22:41,310 [INFO]: 	>>> Finished "Creating the index" in 42.0179 secs
2025-03-13 11:22:41,310 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0447 secs
2025-03-13 11:22:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 63613 [episode count 5/20]
[retrieval_preprocessing] for episode 7809 [episode count 6/20], we have num_retrieval=np.int64(2173) num_query=np.int64(101)
2025-03-13 11:22:42,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:43,344 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:43
2025-03-13 11:22:43,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2082.57it/s]
2025-03-13 11:22:43,378 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 11:22:43,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 11:22:43,378 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:43
2025-03-13 11:22:43,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:43,378 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:22:43,378 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:43,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:43,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:43
2025-03-13 11:22:43,378 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:43,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:43,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:43
2025-03-13 11:22:43,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:43,379 [INFO]: 	Creating the index 03/13/2025, 11:22:43
2025-03-13 11:22:43,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:43
2025-03-13 11:22:43,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:22:43,380 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:43
2025-03-13 11:22:43,380 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:22:43,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.96it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.83it/s]100%|██████████| 9/9 [00:01<00:00,  4.62it/s]
2025-03-13 11:22:45,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:45
2025-03-13 11:23:09,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6582 secs
2025-03-13 11:23:09,989 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 11:23:09,989 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-13 11:23:23,024 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0346 secs
2025-03-13 11:23:23,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.6455 secs
2025-03-13 11:23:23,026 [INFO]: {
2025-03-13 11:23:23,026 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:23,026 [INFO]: 	index_param: efSearch=178
2025-03-13 11:23:23,026 [INFO]: 	index_path: knn.index
2025-03-13 11:23:23,026 [INFO]: 	size in bytes: 427524550
2025-03-13 11:23:23,026 [INFO]: 	avg_search_speed_ms: 9.045089965317379
2025-03-13 11:23:23,026 [INFO]: 	99p_search_speed_ms: 13.07134844828398
2025-03-13 11:23:23,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:23,026 [INFO]: 	nb vectors: 2173
2025-03-13 11:23:23,026 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:23,026 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 11:23:23,026 [INFO]: }
2025-03-13 11:23:23,026 [INFO]: 	>>> Finished "Creating the index" in 39.6472 secs
2025-03-13 11:23:23,026 [INFO]: >>> Finished "Launching the whole pipeline" in 39.6813 secs
2025-03-13 11:23:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 7809 [episode count 6/20]
[retrieval_preprocessing] for episode 29836 [episode count 7/20], we have num_retrieval=np.int64(2159) num_query=np.int64(115)
2025-03-13 11:23:24,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:24,408 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:24
2025-03-13 11:23:24,408 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.54it/s]
2025-03-13 11:23:24,439 [INFO]: There are 2159 embeddings of dim 49152
2025-03-13 11:23:24,439 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:23:24,439 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:24,440 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:23:24,440 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:24,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:23:24,440 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,440 [INFO]: 445.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:24,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:23:24,441 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:24
2025-03-13 11:23:24,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:24,441 [INFO]: 	Creating the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,441 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:24
2025-03-13 11:23:24,444 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:23:24,444 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,445 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:23:24,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.18it/s]100%|██████████| 9/9 [00:01<00:00,  4.30it/s]100%|██████████| 9/9 [00:01<00:00,  4.69it/s]
2025-03-13 11:23:26,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:26
2025-03-13 11:23:51,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7233 secs
2025-03-13 11:23:51,095 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 11:23:51,095 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 11:24:03,152 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0573 secs
2025-03-13 11:24:03,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7094 secs
2025-03-13 11:24:03,154 [INFO]: {
2025-03-13 11:24:03,154 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:03,154 [INFO]: 	index_param: efSearch=213
2025-03-13 11:24:03,154 [INFO]: 	index_path: knn.index
2025-03-13 11:24:03,154 [INFO]: 	size in bytes: 424770130
2025-03-13 11:24:03,154 [INFO]: 	avg_search_speed_ms: 10.717797610661192
2025-03-13 11:24:03,154 [INFO]: 	99p_search_speed_ms: 15.465157246217132
2025-03-13 11:24:03,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:03,154 [INFO]: 	nb vectors: 2159
2025-03-13 11:24:03,154 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:03,154 [INFO]: 	compression ratio: 0.9993091369207152
2025-03-13 11:24:03,154 [INFO]: }
2025-03-13 11:24:03,154 [INFO]: 	>>> Finished "Creating the index" in 38.7130 secs
2025-03-13 11:24:03,154 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7458 secs
2025-03-13 11:24:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 29836 [episode count 7/20]
[retrieval_preprocessing] for episode 37029 [episode count 8/20], we have num_retrieval=np.int64(2152) num_query=np.int64(122)
2025-03-13 11:24:04,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:04,633 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:04
2025-03-13 11:24:04,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1024.50it/s]
2025-03-13 11:24:04,672 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 11:24:04,672 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0391 secs
2025-03-13 11:24:04,672 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:04
2025-03-13 11:24:04,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:04,672 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:24:04,672 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:04,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:24:04,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:04
2025-03-13 11:24:04,673 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:04,673 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:24:04,673 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:04
2025-03-13 11:24:04,673 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:04,673 [INFO]: 	Creating the index 03/13/2025, 11:24:04
2025-03-13 11:24:04,673 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:04
2025-03-13 11:24:04,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 11:24:04,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:04
2025-03-13 11:24:04,675 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:24:04,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.12it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.26it/s]100%|██████████| 9/9 [00:01<00:00,  4.54it/s]
2025-03-13 11:24:06,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:06
2025-03-13 11:24:34,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3281 secs
2025-03-13 11:24:34,991 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:24:34,991 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 11:24:46,843 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8521 secs
2025-03-13 11:24:46,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1695 secs
2025-03-13 11:24:46,845 [INFO]: {
2025-03-13 11:24:46,845 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:46,845 [INFO]: 	index_param: efSearch=194
2025-03-13 11:24:46,845 [INFO]: 	index_path: knn.index
2025-03-13 11:24:46,845 [INFO]: 	size in bytes: 423392890
2025-03-13 11:24:46,845 [INFO]: 	avg_search_speed_ms: 12.540811673390275
2025-03-13 11:24:46,845 [INFO]: 	99p_search_speed_ms: 18.513778778724372
2025-03-13 11:24:46,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:46,845 [INFO]: 	nb vectors: 2152
2025-03-13 11:24:46,845 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:46,845 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 11:24:46,845 [INFO]: }
2025-03-13 11:24:46,845 [INFO]: 	>>> Finished "Creating the index" in 42.1720 secs
2025-03-13 11:24:46,845 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2121 secs
2025-03-13 11:24:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 37029 [episode count 8/20]
[retrieval_preprocessing] for episode 60589 [episode count 9/20], we have num_retrieval=np.int64(2148) num_query=np.int64(126)
2025-03-13 11:24:48,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:48,468 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:48
2025-03-13 11:24:48,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-13 11:24:48,494 [INFO]: There are 2148 embeddings of dim 49152
2025-03-13 11:24:48,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 11:24:48,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:48
2025-03-13 11:24:48,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:48,494 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:24:48,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:48,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:48,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:48
2025-03-13 11:24:48,495 [INFO]: 443.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:48,495 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:48,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:48
2025-03-13 11:24:48,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:48,495 [INFO]: 	Creating the index 03/13/2025, 11:24:48
2025-03-13 11:24:48,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:48
2025-03-13 11:24:48,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:24:48,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:48
2025-03-13 11:24:48,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:24:48,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.17it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.06it/s]100%|██████████| 9/9 [00:01<00:00,  5.28it/s]
2025-03-13 11:24:50,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:50
2025-03-13 11:25:14,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9340 secs
2025-03-13 11:25:14,139 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 11:25:14,139 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.39it/s]
2025-03-13 11:25:26,041 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9020 secs
2025-03-13 11:25:26,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.5471 secs
2025-03-13 11:25:26,043 [INFO]: {
2025-03-13 11:25:26,043 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:26,043 [INFO]: 	index_param: efSearch=161
2025-03-13 11:25:26,043 [INFO]: 	index_path: knn.index
2025-03-13 11:25:26,043 [INFO]: 	size in bytes: 422605930
2025-03-13 11:25:26,043 [INFO]: 	avg_search_speed_ms: 9.01657727868628
2025-03-13 11:25:26,043 [INFO]: 	99p_search_speed_ms: 16.507784035057146
2025-03-13 11:25:26,043 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:26,043 [INFO]: 	nb vectors: 2148
2025-03-13 11:25:26,043 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:26,043 [INFO]: 	compression ratio: 0.999309176754808
2025-03-13 11:25:26,043 [INFO]: }
2025-03-13 11:25:26,043 [INFO]: 	>>> Finished "Creating the index" in 37.5488 secs
2025-03-13 11:25:26,043 [INFO]: >>> Finished "Launching the whole pipeline" in 37.5757 secs
2025-03-13 11:25:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 60589 [episode count 9/20]
[retrieval_preprocessing] for episode 26308 [episode count 10/20], we have num_retrieval=np.int64(2137) num_query=np.int64(137)
2025-03-13 11:25:27,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:27,749 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:27
2025-03-13 11:25:27,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 11:25:27,787 [INFO]: There are 2137 embeddings of dim 49152
2025-03-13 11:25:27,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 11:25:27,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,787 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:27,787 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:25:27,787 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:27,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:25:27,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,788 [INFO]: 441.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:27,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:27,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:27
2025-03-13 11:25:27,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:27,788 [INFO]: 	Creating the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:27
2025-03-13 11:25:27,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:25:27,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,790 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:25:27,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.10it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.39it/s]100%|██████████| 9/9 [00:01<00:00,  4.65it/s]
2025-03-13 11:25:29,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:29
2025-03-13 11:26:01,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0092 secs
2025-03-13 11:26:01,738 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:26:01,738 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 11:26:14,608 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8697 secs
2025-03-13 11:26:14,609 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8190 secs
2025-03-13 11:26:14,610 [INFO]: {
2025-03-13 11:26:14,610 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:14,610 [INFO]: 	index_param: efSearch=184
2025-03-13 11:26:14,610 [INFO]: 	index_path: knn.index
2025-03-13 11:26:14,610 [INFO]: 	size in bytes: 420441790
2025-03-13 11:26:14,610 [INFO]: 	avg_search_speed_ms: 11.001809427414265
2025-03-13 11:26:14,610 [INFO]: 	99p_search_speed_ms: 16.277942117303606
2025-03-13 11:26:14,610 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:14,610 [INFO]: 	nb vectors: 2137
2025-03-13 11:26:14,610 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:14,610 [INFO]: 	compression ratio: 0.9993090743905357
2025-03-13 11:26:14,610 [INFO]: }
2025-03-13 11:26:14,610 [INFO]: 	>>> Finished "Creating the index" in 46.8216 secs
2025-03-13 11:26:14,610 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8606 secs
2025-03-13 11:26:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 26308 [episode count 10/20]
[retrieval_preprocessing] for episode 20681 [episode count 11/20], we have num_retrieval=np.int64(2172) num_query=np.int64(102)
2025-03-13 11:26:16,003 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:16,303 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:16
2025-03-13 11:26:16,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]
2025-03-13 11:26:16,330 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 11:26:16,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:26:16,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:16
2025-03-13 11:26:16,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:16,330 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:26:16,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:16,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:16,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:16
2025-03-13 11:26:16,330 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:16,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:26:16,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:16
2025-03-13 11:26:16,330 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:16,330 [INFO]: 	Creating the index 03/13/2025, 11:26:16
2025-03-13 11:26:16,330 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:16
2025-03-13 11:26:16,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:26:16,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:16
2025-03-13 11:26:16,332 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:26:16,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.42it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.11it/s]100%|██████████| 9/9 [00:01<00:00,  5.25it/s]
2025-03-13 11:26:18,050 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:18
2025-03-13 11:26:42,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0325 secs
2025-03-13 11:26:42,083 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 11:26:42,083 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-13 11:26:55,659 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5753 secs
2025-03-13 11:26:55,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3289 secs
2025-03-13 11:26:55,661 [INFO]: {
2025-03-13 11:26:55,661 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:55,661 [INFO]: 	index_param: efSearch=176
2025-03-13 11:26:55,661 [INFO]: 	index_path: knn.index
2025-03-13 11:26:55,661 [INFO]: 	size in bytes: 427327810
2025-03-13 11:26:55,661 [INFO]: 	avg_search_speed_ms: 9.15525494409459
2025-03-13 11:26:55,661 [INFO]: 	99p_search_speed_ms: 12.54084303509444
2025-03-13 11:26:55,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:55,661 [INFO]: 	nb vectors: 2172
2025-03-13 11:26:55,661 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:55,661 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 11:26:55,661 [INFO]: }
2025-03-13 11:26:55,661 [INFO]: 	>>> Finished "Creating the index" in 39.3305 secs
2025-03-13 11:26:55,661 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3576 secs
2025-03-13 11:26:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 20681 [episode count 11/20]
[retrieval_preprocessing] for episode 8947 [episode count 12/20], we have num_retrieval=np.int64(2164) num_query=np.int64(110)
2025-03-13 11:26:56,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:57,145 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:57
2025-03-13 11:26:57,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1621.30it/s]
2025-03-13 11:26:57,180 [INFO]: There are 2164 embeddings of dim 49152
2025-03-13 11:26:57,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 11:26:57,180 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:57
2025-03-13 11:26:57,181 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:57,181 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:26:57,181 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:57,181 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:26:57,181 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:57
2025-03-13 11:26:57,181 [INFO]: 446.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:57,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:26:57,182 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:57
2025-03-13 11:26:57,182 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:57,182 [INFO]: 	Creating the index 03/13/2025, 11:26:57
2025-03-13 11:26:57,182 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:57
2025-03-13 11:26:57,185 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:26:57,185 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:57
2025-03-13 11:26:57,185 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:26:57,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.67it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.34it/s]100%|██████████| 9/9 [00:01<00:00,  5.29it/s]
2025-03-13 11:26:58,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:58
2025-03-13 11:27:29,994 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1032 secs
2025-03-13 11:27:29,994 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 11:27:29,994 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.61it/s]
2025-03-13 11:27:41,812 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8176 secs
2025-03-13 11:27:41,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6283 secs
2025-03-13 11:27:41,813 [INFO]: {
2025-03-13 11:27:41,814 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:41,814 [INFO]: 	index_param: efSearch=177
2025-03-13 11:27:41,814 [INFO]: 	index_path: knn.index
2025-03-13 11:27:41,814 [INFO]: 	size in bytes: 425753830
2025-03-13 11:27:41,814 [INFO]: 	avg_search_speed_ms: 10.632849296932994
2025-03-13 11:27:41,814 [INFO]: 	99p_search_speed_ms: 15.456352289766073
2025-03-13 11:27:41,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:41,814 [INFO]: 	nb vectors: 2164
2025-03-13 11:27:41,814 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:41,814 [INFO]: 	compression ratio: 0.999309182961431
2025-03-13 11:27:41,814 [INFO]: }
2025-03-13 11:27:41,814 [INFO]: 	>>> Finished "Creating the index" in 44.6317 secs
2025-03-13 11:27:41,814 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6685 secs
2025-03-13 11:27:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 8947 [episode count 12/20]
[retrieval_preprocessing] for episode 66878 [episode count 13/20], we have num_retrieval=np.int64(2185) num_query=np.int64(89)
2025-03-13 11:27:42,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:43,248 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:43
2025-03-13 11:27:43,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.96it/s]
2025-03-13 11:27:43,278 [INFO]: There are 2185 embeddings of dim 49152
2025-03-13 11:27:43,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:27:43,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:43
2025-03-13 11:27:43,278 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:43,278 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:27:43,278 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:43,278 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:43,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:43
2025-03-13 11:27:43,279 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:43,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:43,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:43
2025-03-13 11:27:43,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:43,279 [INFO]: 	Creating the index 03/13/2025, 11:27:43
2025-03-13 11:27:43,279 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:43
2025-03-13 11:27:43,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:27:43,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:43
2025-03-13 11:27:43,280 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:27:43,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.52it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.17it/s]
2025-03-13 11:27:45,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:45
2025-03-13 11:28:12,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6247 secs
2025-03-13 11:28:12,650 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 11:28:12,650 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.75it/s]
2025-03-13 11:28:26,624 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9744 secs
2025-03-13 11:28:26,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3460 secs
2025-03-13 11:28:26,626 [INFO]: {
2025-03-13 11:28:26,626 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:26,626 [INFO]: 	index_param: efSearch=222
2025-03-13 11:28:26,626 [INFO]: 	index_path: knn.index
2025-03-13 11:28:26,626 [INFO]: 	size in bytes: 429885490
2025-03-13 11:28:26,626 [INFO]: 	avg_search_speed_ms: 11.187328240819593
2025-03-13 11:28:26,626 [INFO]: 	99p_search_speed_ms: 18.28825591364874
2025-03-13 11:28:26,626 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:26,626 [INFO]: 	nb vectors: 2185
2025-03-13 11:28:26,626 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:26,626 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-13 11:28:26,626 [INFO]: }
2025-03-13 11:28:26,626 [INFO]: 	>>> Finished "Creating the index" in 43.3474 secs
2025-03-13 11:28:26,626 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3782 secs
2025-03-13 11:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 66878 [episode count 13/20]
[retrieval_preprocessing] for episode 59218 [episode count 14/20], we have num_retrieval=np.int64(2174) num_query=np.int64(100)
2025-03-13 11:28:27,642 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:27,983 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:27
2025-03-13 11:28:27,983 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2032.12it/s]
2025-03-13 11:28:28,015 [INFO]: There are 2174 embeddings of dim 49152
2025-03-13 11:28:28,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 11:28:28,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:28
2025-03-13 11:28:28,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:28,016 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:28:28,016 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:28,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:28,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:28
2025-03-13 11:28:28,016 [INFO]: 448.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:28,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:28:28,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:28
2025-03-13 11:28:28,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:28,016 [INFO]: 	Creating the index 03/13/2025, 11:28:28
2025-03-13 11:28:28,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:28
2025-03-13 11:28:28,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:28:28,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:28
2025-03-13 11:28:28,017 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:28:28,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.76it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.27it/s]100%|██████████| 9/9 [00:01<00:00,  5.15it/s]
2025-03-13 11:28:29,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:29
2025-03-13 11:28:56,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3256 secs
2025-03-13 11:28:56,093 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 11:28:56,093 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.28it/s]
2025-03-13 11:29:07,795 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7009 secs
2025-03-13 11:29:07,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7792 secs
2025-03-13 11:29:07,796 [INFO]: {
2025-03-13 11:29:07,796 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:07,796 [INFO]: 	index_param: efSearch=176
2025-03-13 11:29:07,796 [INFO]: 	index_path: knn.index
2025-03-13 11:29:07,796 [INFO]: 	size in bytes: 427721350
2025-03-13 11:29:07,796 [INFO]: 	avg_search_speed_ms: 11.289454742206543
2025-03-13 11:29:07,796 [INFO]: 	99p_search_speed_ms: 21.04129841318354
2025-03-13 11:29:07,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:07,797 [INFO]: 	nb vectors: 2174
2025-03-13 11:29:07,797 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:07,797 [INFO]: 	compression ratio: 0.9993089940448379
2025-03-13 11:29:07,797 [INFO]: }
2025-03-13 11:29:07,797 [INFO]: 	>>> Finished "Creating the index" in 39.7807 secs
2025-03-13 11:29:07,797 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8133 secs
2025-03-13 11:29:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 59218 [episode count 14/20]
[retrieval_preprocessing] for episode 83798 [episode count 15/20], we have num_retrieval=np.int64(2124) num_query=np.int64(150)
2025-03-13 11:29:08,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:08,928 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:08
2025-03-13 11:29:08,928 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.44it/s]
2025-03-13 11:29:08,957 [INFO]: There are 2124 embeddings of dim 49152
2025-03-13 11:29:08,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 11:29:08,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:08
2025-03-13 11:29:08,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:08,958 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:29:08,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:08,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:08,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:08
2025-03-13 11:29:08,958 [INFO]: 438.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:08,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:08,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:08
2025-03-13 11:29:08,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:08,958 [INFO]: 	Creating the index 03/13/2025, 11:29:08
2025-03-13 11:29:08,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:08
2025-03-13 11:29:08,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:29:08,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:08
2025-03-13 11:29:08,959 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:08,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.29it/s]100%|██████████| 9/9 [00:01<00:00,  5.24it/s]100%|██████████| 9/9 [00:01<00:00,  5.69it/s]
2025-03-13 11:29:10,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:10
2025-03-13 11:29:42,189 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6455 secs
2025-03-13 11:29:42,189 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 11:29:42,189 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.31it/s]
2025-03-13 11:29:55,601 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4115 secs
2025-03-13 11:29:55,603 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6436 secs
2025-03-13 11:29:55,603 [INFO]: {
2025-03-13 11:29:55,603 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:55,603 [INFO]: 	index_param: efSearch=201
2025-03-13 11:29:55,603 [INFO]: 	index_path: knn.index
2025-03-13 11:29:55,603 [INFO]: 	size in bytes: 417884050
2025-03-13 11:29:55,603 [INFO]: 	avg_search_speed_ms: 11.902679802317705
2025-03-13 11:29:55,603 [INFO]: 	99p_search_speed_ms: 19.47941465303303
2025-03-13 11:29:55,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:55,603 [INFO]: 	nb vectors: 2124
2025-03-13 11:29:55,603 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:55,603 [INFO]: 	compression ratio: 0.9993092390101991
2025-03-13 11:29:55,603 [INFO]: }
2025-03-13 11:29:55,603 [INFO]: 	>>> Finished "Creating the index" in 46.6451 secs
2025-03-13 11:29:55,603 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6751 secs
2025-03-13 11:29:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 83798 [episode count 15/20]
[retrieval_preprocessing] for episode 90458 [episode count 16/20], we have num_retrieval=np.int64(2175) num_query=np.int64(99)
2025-03-13 11:29:57,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:57,558 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:57
2025-03-13 11:29:57,559 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.98it/s]
2025-03-13 11:29:57,596 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 11:29:57,596 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 11:29:57,596 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:57
2025-03-13 11:29:57,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:57,596 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:29:57,596 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:57,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:57,596 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:57
2025-03-13 11:29:57,596 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:57,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:29:57,596 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:57
2025-03-13 11:29:57,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:57,596 [INFO]: 	Creating the index 03/13/2025, 11:29:57
2025-03-13 11:29:57,596 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:57
2025-03-13 11:29:57,598 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:29:57,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:57
2025-03-13 11:29:57,598 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:57,598 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.00it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.77it/s]100%|██████████| 9/9 [00:01<00:00,  5.15it/s]
2025-03-13 11:29:59,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:59
2025-03-13 11:30:35,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5117 secs
2025-03-13 11:30:35,861 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 11:30:35,861 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-13 11:30:48,050 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1887 secs
2025-03-13 11:30:48,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4539 secs
2025-03-13 11:30:48,052 [INFO]: {
2025-03-13 11:30:48,052 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:48,052 [INFO]: 	index_param: efSearch=147
2025-03-13 11:30:48,052 [INFO]: 	index_path: knn.index
2025-03-13 11:30:48,052 [INFO]: 	size in bytes: 427918090
2025-03-13 11:30:48,052 [INFO]: 	avg_search_speed_ms: 8.284584752206058
2025-03-13 11:30:48,052 [INFO]: 	99p_search_speed_ms: 11.255422276444735
2025-03-13 11:30:48,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:48,052 [INFO]: 	nb vectors: 2175
2025-03-13 11:30:48,052 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:48,052 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 11:30:48,052 [INFO]: }
2025-03-13 11:30:48,052 [INFO]: 	>>> Finished "Creating the index" in 50.4556 secs
2025-03-13 11:30:48,052 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4936 secs
2025-03-13 11:30:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 90458 [episode count 16/20]
[retrieval_preprocessing] for episode 58214 [episode count 17/20], we have num_retrieval=np.int64(2135) num_query=np.int64(139)
2025-03-13 11:30:49,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:49,372 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:49
2025-03-13 11:30:49,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-13 11:30:49,401 [INFO]: There are 2135 embeddings of dim 49152
2025-03-13 11:30:49,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:30:49,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:49
2025-03-13 11:30:49,402 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:49,402 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:30:49,402 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:49,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:49,402 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:49
2025-03-13 11:30:49,402 [INFO]: 440.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:49,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:49,402 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:49
2025-03-13 11:30:49,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:49,402 [INFO]: 	Creating the index 03/13/2025, 11:30:49
2025-03-13 11:30:49,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:49
2025-03-13 11:30:49,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:49,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:49
2025-03-13 11:30:49,403 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:30:49,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.40it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.80it/s]100%|██████████| 9/9 [00:01<00:00,  5.24it/s]
2025-03-13 11:30:51,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:51
2025-03-13 11:31:22,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2556 secs
2025-03-13 11:31:22,380 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:31:22,380 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.32it/s]
2025-03-13 11:31:36,114 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7342 secs
2025-03-13 11:31:36,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7122 secs
2025-03-13 11:31:36,115 [INFO]: {
2025-03-13 11:31:36,115 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:36,115 [INFO]: 	index_param: efSearch=198
2025-03-13 11:31:36,115 [INFO]: 	index_path: knn.index
2025-03-13 11:31:36,115 [INFO]: 	size in bytes: 420048250
2025-03-13 11:31:36,115 [INFO]: 	avg_search_speed_ms: 9.528641314689247
2025-03-13 11:31:36,116 [INFO]: 	99p_search_speed_ms: 12.737860372290015
2025-03-13 11:31:36,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:36,116 [INFO]: 	nb vectors: 2135
2025-03-13 11:31:36,116 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:36,116 [INFO]: 	compression ratio: 0.9993091984075639
2025-03-13 11:31:36,116 [INFO]: }
2025-03-13 11:31:36,116 [INFO]: 	>>> Finished "Creating the index" in 46.7137 secs
2025-03-13 11:31:36,116 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7433 secs
2025-03-13 11:31:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 58214 [episode count 17/20]
[retrieval_preprocessing] for episode 1409 [episode count 18/20], we have num_retrieval=np.int64(2183) num_query=np.int64(91)
2025-03-13 11:31:37,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:37,569 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:37
2025-03-13 11:31:37,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-13 11:31:37,599 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 11:31:37,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:31:37,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:37
2025-03-13 11:31:37,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:37,600 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:31:37,600 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:37,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:37,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:37
2025-03-13 11:31:37,600 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:37,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:37,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:37
2025-03-13 11:31:37,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:37,600 [INFO]: 	Creating the index 03/13/2025, 11:31:37
2025-03-13 11:31:37,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:37
2025-03-13 11:31:37,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:37,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:37
2025-03-13 11:31:37,601 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:37,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.44it/s] 67%|██████▋   | 6/9 [00:00<00:00, 32.34it/s]100%|██████████| 9/9 [00:01<00:00,  5.13it/s]
2025-03-13 11:31:39,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:39
2025-03-13 11:32:10,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4756 secs
2025-03-13 11:32:10,835 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 11:32:10,835 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.18it/s]
2025-03-13 11:32:27,661 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8256 secs
2025-03-13 11:32:27,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0616 secs
2025-03-13 11:32:27,663 [INFO]: {
2025-03-13 11:32:27,663 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:27,663 [INFO]: 	index_param: efSearch=190
2025-03-13 11:32:27,663 [INFO]: 	index_path: knn.index
2025-03-13 11:32:27,663 [INFO]: 	size in bytes: 429492010
2025-03-13 11:32:27,663 [INFO]: 	avg_search_speed_ms: 9.855512711976475
2025-03-13 11:32:27,663 [INFO]: 	99p_search_speed_ms: 12.979379910975695
2025-03-13 11:32:27,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:27,663 [INFO]: 	nb vectors: 2183
2025-03-13 11:32:27,663 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:27,663 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 11:32:27,663 [INFO]: }
2025-03-13 11:32:27,663 [INFO]: 	>>> Finished "Creating the index" in 50.0630 secs
2025-03-13 11:32:27,663 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0942 secs
2025-03-13 11:32:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 1409 [episode count 18/20]
[retrieval_preprocessing] for episode 32174 [episode count 19/20], we have num_retrieval=np.int64(2116) num_query=np.int64(158)
2025-03-13 11:32:28,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:28,822 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:28
2025-03-13 11:32:28,822 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.30it/s]
2025-03-13 11:32:28,853 [INFO]: There are 2116 embeddings of dim 49152
2025-03-13 11:32:28,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:32:28,853 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,853 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:28,853 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:32:28,853 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:28,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:32:28,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,853 [INFO]: 436.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:28,853 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:32:28,853 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:28
2025-03-13 11:32:28,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:28,854 [INFO]: 	Creating the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:28
2025-03-13 11:32:28,855 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:32:28,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:28
2025-03-13 11:32:28,856 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:32:28,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.26it/s]100%|██████████| 9/9 [00:01<00:00,  4.48it/s]100%|██████████| 9/9 [00:01<00:00,  4.89it/s]
2025-03-13 11:32:30,700 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:30
2025-03-13 11:32:57,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1189 secs
2025-03-13 11:32:57,819 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:32:57,819 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 11:33:12,504 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6849 secs
2025-03-13 11:33:12,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6504 secs
2025-03-13 11:33:12,506 [INFO]: {
2025-03-13 11:33:12,506 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:12,506 [INFO]: 	index_param: efSearch=194
2025-03-13 11:33:12,506 [INFO]: 	index_path: knn.index
2025-03-13 11:33:12,506 [INFO]: 	size in bytes: 416310130
2025-03-13 11:33:12,506 [INFO]: 	avg_search_speed_ms: 10.58009783959105
2025-03-13 11:33:12,506 [INFO]: 	99p_search_speed_ms: 15.141126699745653
2025-03-13 11:33:12,506 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:12,506 [INFO]: 	nb vectors: 2116
2025-03-13 11:33:12,506 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:12,506 [INFO]: 	compression ratio: 0.9993091640599762
2025-03-13 11:33:12,506 [INFO]: }
2025-03-13 11:33:12,506 [INFO]: 	>>> Finished "Creating the index" in 43.6529 secs
2025-03-13 11:33:12,506 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6842 secs
2025-03-13 11:33:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 32174 [episode count 19/20]
2025-03-13 11:33:14: [retrieval_preprocessing] finished for 4706041793_place_cloth_on_table [chosen_id count 2/260]
2025-03-13 11:33:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4706041793_hang_cloth_on_stand [chosen_id count 3/260]
2025-03-13 11:33:16: [retrieval_preprocessing] we have num_total=5322 embedding_dim=49152
[retrieval_preprocessing] for episode 39950 [episode count 0/20], we have num_retrieval=np.int64(5167) num_query=np.int64(155)
2025-03-13 11:33:16,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:18,015 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:18
2025-03-13 11:33:18,015 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.17it/s]
2025-03-13 11:33:18,047 [INFO]: There are 5167 embeddings of dim 49152
2025-03-13 11:33:18,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:33:18,047 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:18
2025-03-13 11:33:18,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:18,047 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:33:18,047 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:18,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:18,047 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:18
2025-03-13 11:33:18,047 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:18,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:33:18,048 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:18
2025-03-13 11:33:18,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:18,048 [INFO]: 	Creating the index 03/13/2025, 11:33:18
2025-03-13 11:33:18,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:18
2025-03-13 11:33:18,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:33:18,049 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:18
2025-03-13 11:33:18,049 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:33:18,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.14it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.68it/s] 50%|█████     | 11/22 [00:00<00:00, 38.22it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.54it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.80it/s]100%|██████████| 22/22 [00:05<00:00,  3.72it/s]
2025-03-13 11:33:23,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:23
2025-03-13 11:34:14,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7443 secs
2025-03-13 11:34:14,705 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 11:34:14,705 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 11:34:31,653 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9473 secs
2025-03-13 11:34:31,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.6042 secs
2025-03-13 11:34:31,653 [INFO]: {
2025-03-13 11:34:31,653 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:31,653 [INFO]: 	index_param: efSearch=145
2025-03-13 11:34:31,653 [INFO]: 	index_path: knn.index
2025-03-13 11:34:31,653 [INFO]: 	size in bytes: 1016576530
2025-03-13 11:34:31,653 [INFO]: 	avg_search_speed_ms: 8.819449263028604
2025-03-13 11:34:31,653 [INFO]: 	99p_search_speed_ms: 12.704176185652614
2025-03-13 11:34:31,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:31,653 [INFO]: 	nb vectors: 5167
2025-03-13 11:34:31,653 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:31,653 [INFO]: 	compression ratio: 0.9993084691813611
2025-03-13 11:34:31,653 [INFO]: }
2025-03-13 11:34:31,653 [INFO]: 	>>> Finished "Creating the index" in 73.6058 secs
2025-03-13 11:34:31,653 [INFO]: >>> Finished "Launching the whole pipeline" in 73.6387 secs
2025-03-13 11:34:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 39950 [episode count 0/20]
[retrieval_preprocessing] for episode 75280 [episode count 1/20], we have num_retrieval=np.int64(5159) num_query=np.int64(163)
2025-03-13 11:34:34,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:35,492 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:35
2025-03-13 11:34:35,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.26it/s]
2025-03-13 11:34:35,517 [INFO]: There are 5159 embeddings of dim 49152
2025-03-13 11:34:35,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:34:35,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:35
2025-03-13 11:34:35,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:35,518 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:34:35,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:35,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:35,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:35
2025-03-13 11:34:35,518 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:35,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:34:35,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:35
2025-03-13 11:34:35,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:35,518 [INFO]: 	Creating the index 03/13/2025, 11:34:35
2025-03-13 11:34:35,518 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:35
2025-03-13 11:34:35,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 11:34:35,520 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:35
2025-03-13 11:34:35,520 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:34:35,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.08it/s] 14%|█▎        | 3/22 [00:00<00:01, 10.05it/s] 32%|███▏      | 7/22 [00:00<00:00, 19.88it/s] 50%|█████     | 11/22 [00:00<00:00, 25.89it/s] 68%|██████▊   | 15/22 [00:00<00:00, 29.08it/s] 86%|████████▋ | 19/22 [00:00<00:00, 31.19it/s]100%|██████████| 22/22 [00:07<00:00,  2.96it/s]
2025-03-13 11:34:42,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:42
2025-03-13 11:35:41,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1198 secs
2025-03-13 11:35:41,085 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 11:35:41,085 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.31it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
2025-03-13 11:35:56,868 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7830 secs
2025-03-13 11:35:56,869 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.3487 secs
2025-03-13 11:35:56,869 [INFO]: {
2025-03-13 11:35:56,869 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:56,869 [INFO]: 	index_param: efSearch=137
2025-03-13 11:35:56,869 [INFO]: 	index_path: knn.index
2025-03-13 11:35:56,869 [INFO]: 	size in bytes: 1015002550
2025-03-13 11:35:56,869 [INFO]: 	avg_search_speed_ms: 10.404193562333493
2025-03-13 11:35:56,869 [INFO]: 	99p_search_speed_ms: 16.750599727965888
2025-03-13 11:35:56,869 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:56,869 [INFO]: 	nb vectors: 5159
2025-03-13 11:35:56,869 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:56,869 [INFO]: 	compression ratio: 0.999308496318556
2025-03-13 11:35:56,869 [INFO]: }
2025-03-13 11:35:56,869 [INFO]: 	>>> Finished "Creating the index" in 81.3507 secs
2025-03-13 11:35:56,869 [INFO]: >>> Finished "Launching the whole pipeline" in 81.3768 secs
2025-03-13 11:35:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 75280 [episode count 1/20]
[retrieval_preprocessing] for episode 50720 [episode count 2/20], we have num_retrieval=np.int64(5149) num_query=np.int64(173)
2025-03-13 11:36:00,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:01,570 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:01
2025-03-13 11:36:01,570 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 802.89it/s]
2025-03-13 11:36:01,601 [INFO]: There are 5149 embeddings of dim 49152
2025-03-13 11:36:01,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 11:36:01,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:01
2025-03-13 11:36:01,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:01,602 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:36:01,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:01,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:36:01,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:01
2025-03-13 11:36:01,603 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:01,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:36:01,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:01
2025-03-13 11:36:01,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:01,604 [INFO]: 	Creating the index 03/13/2025, 11:36:01
2025-03-13 11:36:01,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:01
2025-03-13 11:36:01,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:36:01,607 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:01
2025-03-13 11:36:01,607 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:36:01,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:01<00:37,  1.81s/it]  9%|▉         | 2/22 [00:02<00:19,  1.03it/s] 14%|█▎        | 3/22 [00:02<00:11,  1.66it/s] 18%|█▊        | 4/22 [00:02<00:08,  2.14it/s] 27%|██▋       | 6/22 [00:02<00:04,  3.89it/s] 32%|███▏      | 7/22 [00:02<00:03,  4.05it/s] 41%|████      | 9/22 [00:03<00:02,  5.79it/s] 45%|████▌     | 10/22 [00:03<00:02,  5.14it/s] 50%|█████     | 11/22 [00:03<00:02,  5.26it/s] 55%|█████▍    | 12/22 [00:03<00:01,  5.00it/s] 59%|█████▉    | 13/22 [00:03<00:01,  5.09it/s] 64%|██████▎   | 14/22 [00:04<00:01,  5.52it/s] 68%|██████▊   | 15/22 [00:05<00:02,  2.43it/s] 77%|███████▋  | 17/22 [00:05<00:01,  3.94it/s] 86%|████████▋ | 19/22 [00:05<00:00,  5.73it/s] 95%|█████████▌| 21/22 [00:10<00:01,  1.05s/it]100%|██████████| 22/22 [00:11<00:00,  1.02s/it]100%|██████████| 22/22 [00:11<00:00,  1.92it/s]
2025-03-13 11:36:13,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:13
2025-03-13 11:37:09,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5762 secs
2025-03-13 11:37:09,674 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 11:37:09,674 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 11:37:31,344 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6703 secs
2025-03-13 11:37:31,345 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.7374 secs
2025-03-13 11:37:31,345 [INFO]: {
2025-03-13 11:37:31,345 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:31,345 [INFO]: 	index_param: efSearch=124
2025-03-13 11:37:31,345 [INFO]: 	index_path: knn.index
2025-03-13 11:37:31,345 [INFO]: 	size in bytes: 1013035150
2025-03-13 11:37:31,345 [INFO]: 	avg_search_speed_ms: 8.991473317757691
2025-03-13 11:37:31,345 [INFO]: 	99p_search_speed_ms: 13.220610679127288
2025-03-13 11:37:31,345 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:31,345 [INFO]: 	nb vectors: 5149
2025-03-13 11:37:31,345 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:31,345 [INFO]: 	compression ratio: 0.999308456374885
2025-03-13 11:37:31,345 [INFO]: }
2025-03-13 11:37:31,345 [INFO]: 	>>> Finished "Creating the index" in 89.7412 secs
2025-03-13 11:37:31,345 [INFO]: >>> Finished "Launching the whole pipeline" in 89.7752 secs
2025-03-13 11:37:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 50720 [episode count 2/20]
[retrieval_preprocessing] for episode 35384 [episode count 3/20], we have num_retrieval=np.int64(4911) num_query=np.int64(411)
2025-03-13 11:37:35,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:36,385 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:36
2025-03-13 11:37:36,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2264.74it/s]
2025-03-13 11:37:36,403 [INFO]: There are 4911 embeddings of dim 49152
2025-03-13 11:37:36,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0182 secs
2025-03-13 11:37:36,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:36,403 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:37:36,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:36,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:36,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,403 [INFO]: 1013.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:36,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:36,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:36
2025-03-13 11:37:36,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:36,403 [INFO]: 	Creating the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,403 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:36
2025-03-13 11:37:36,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:36,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,405 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:37:36,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.51it/s] 15%|█▌        | 3/20 [00:00<00:01, 11.61it/s] 25%|██▌       | 5/20 [00:00<00:01, 12.37it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.09it/s] 45%|████▌     | 9/20 [00:00<00:00, 13.14it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.76it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.32it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.61it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.36it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.24it/s]100%|██████████| 20/20 [00:06<00:00,  3.09it/s]
2025-03-13 11:37:42,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:42
2025-03-13 11:38:44,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6309 secs
2025-03-13 11:38:44,506 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 11:38:44,506 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 11:38:59,780 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2737 secs
2025-03-13 11:38:59,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3786 secs
2025-03-13 11:38:59,783 [INFO]: {
2025-03-13 11:38:59,783 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:59,783 [INFO]: 	index_param: efSearch=123
2025-03-13 11:38:59,783 [INFO]: 	index_path: knn.index
2025-03-13 11:38:59,783 [INFO]: 	size in bytes: 966209770
2025-03-13 11:38:59,783 [INFO]: 	avg_search_speed_ms: 9.194456186592374
2025-03-13 11:38:59,783 [INFO]: 	99p_search_speed_ms: 20.904435089323638
2025-03-13 11:38:59,783 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:59,783 [INFO]: 	nb vectors: 4911
2025-03-13 11:38:59,783 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:59,784 [INFO]: 	compression ratio: 0.9993087608708408
2025-03-13 11:38:59,784 [INFO]: }
2025-03-13 11:38:59,784 [INFO]: 	>>> Finished "Creating the index" in 83.3801 secs
2025-03-13 11:38:59,784 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3989 secs
2025-03-13 11:39:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 35384 [episode count 3/20]
[retrieval_preprocessing] for episode 46667 [episode count 4/20], we have num_retrieval=np.int64(4947) num_query=np.int64(375)
2025-03-13 11:39:04,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:04,910 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:04
2025-03-13 11:39:04,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.68it/s]
2025-03-13 11:39:04,935 [INFO]: There are 4947 embeddings of dim 49152
2025-03-13 11:39:04,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:39:04,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:04
2025-03-13 11:39:04,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:04,935 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:39:04,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:04,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:39:04,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:04
2025-03-13 11:39:04,935 [INFO]: 1020.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:04,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:39:04,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:04
2025-03-13 11:39:04,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:04,936 [INFO]: 	Creating the index 03/13/2025, 11:39:04
2025-03-13 11:39:04,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:04
2025-03-13 11:39:04,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:39:04,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:04
2025-03-13 11:39:04,937 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:39:04,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.72it/s] 25%|██▌       | 5/20 [00:00<00:00, 19.27it/s] 50%|█████     | 10/20 [00:00<00:00, 28.61it/s] 75%|███████▌  | 15/20 [00:00<00:00, 34.02it/s]100%|██████████| 20/20 [00:05<00:00,  2.56it/s]100%|██████████| 20/20 [00:05<00:00,  3.83it/s]
2025-03-13 11:39:10,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:10
2025-03-13 11:40:07,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0325 secs
2025-03-13 11:40:07,200 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 11:40:07,201 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 11:40:24,108 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9064 secs
2025-03-13 11:40:24,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.1740 secs
2025-03-13 11:40:24,111 [INFO]: {
2025-03-13 11:40:24,111 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:24,111 [INFO]: 	index_param: efSearch=138
2025-03-13 11:40:24,111 [INFO]: 	index_path: knn.index
2025-03-13 11:40:24,111 [INFO]: 	size in bytes: 973292710
2025-03-13 11:40:24,111 [INFO]: 	avg_search_speed_ms: 10.497924498579147
2025-03-13 11:40:24,111 [INFO]: 	99p_search_speed_ms: 17.14582497486845
2025-03-13 11:40:24,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:24,111 [INFO]: 	nb vectors: 4947
2025-03-13 11:40:24,111 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:24,111 [INFO]: 	compression ratio: 0.9993086005956009
2025-03-13 11:40:24,111 [INFO]: }
2025-03-13 11:40:24,111 [INFO]: 	>>> Finished "Creating the index" in 79.1756 secs
2025-03-13 11:40:24,111 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2012 secs
2025-03-13 11:40:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 46667 [episode count 4/20]
[retrieval_preprocessing] for episode 65640 [episode count 5/20], we have num_retrieval=np.int64(5043) num_query=np.int64(279)
2025-03-13 11:40:27,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:28,066 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:28
2025-03-13 11:40:28,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.73it/s]
2025-03-13 11:40:28,104 [INFO]: There are 5043 embeddings of dim 49152
2025-03-13 11:40:28,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0388 secs
2025-03-13 11:40:28,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:28
2025-03-13 11:40:28,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:28,106 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:40:28,106 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:28,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:40:28,106 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:28
2025-03-13 11:40:28,106 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:28,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:40:28,107 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:28
2025-03-13 11:40:28,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:28,107 [INFO]: 	Creating the index 03/13/2025, 11:40:28
2025-03-13 11:40:28,107 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:28
2025-03-13 11:40:28,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:40:28,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:28
2025-03-13 11:40:28,111 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:40:28,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.73it/s] 30%|███       | 6/20 [00:00<00:00, 30.93it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.65it/s] 80%|████████  | 16/20 [00:00<00:00, 40.65it/s]100%|██████████| 20/20 [00:04<00:00,  4.16it/s]
2025-03-13 11:40:32,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:32
2025-03-13 11:41:30,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1666 secs
2025-03-13 11:41:30,099 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 11:41:30,099 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-13 11:41:48,092 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9931 secs
2025-03-13 11:41:48,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.9841 secs
2025-03-13 11:41:48,095 [INFO]: {
2025-03-13 11:41:48,095 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:48,095 [INFO]: 	index_param: efSearch=124
2025-03-13 11:41:48,095 [INFO]: 	index_path: knn.index
2025-03-13 11:41:48,095 [INFO]: 	size in bytes: 992180290
2025-03-13 11:41:48,095 [INFO]: 	avg_search_speed_ms: 8.89753390623926
2025-03-13 11:41:48,095 [INFO]: 	99p_search_speed_ms: 14.305524223018436
2025-03-13 11:41:48,095 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:48,095 [INFO]: 	nb vectors: 5043
2025-03-13 11:41:48,095 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:48,095 [INFO]: 	compression ratio: 0.9993084462502274
2025-03-13 11:41:48,095 [INFO]: }
2025-03-13 11:41:48,095 [INFO]: 	>>> Finished "Creating the index" in 79.9880 secs
2025-03-13 11:41:48,095 [INFO]: >>> Finished "Launching the whole pipeline" in 80.0294 secs
2025-03-13 11:41:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 65640 [episode count 5/20]
[retrieval_preprocessing] for episode 66664 [episode count 6/20], we have num_retrieval=np.int64(5144) num_query=np.int64(178)
2025-03-13 11:41:50,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:51,770 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:51
2025-03-13 11:41:51,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.93it/s]
2025-03-13 11:41:51,806 [INFO]: There are 5144 embeddings of dim 49152
2025-03-13 11:41:51,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 11:41:51,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:51
2025-03-13 11:41:51,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:51,807 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:41:51,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:51,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:51,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:51
2025-03-13 11:41:51,807 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:51,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:41:51,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:51
2025-03-13 11:41:51,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:51,807 [INFO]: 	Creating the index 03/13/2025, 11:41:51
2025-03-13 11:41:51,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:51
2025-03-13 11:41:51,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 11:41:51,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:51
2025-03-13 11:41:51,809 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:41:51,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.24it/s] 32%|███▏      | 7/22 [00:00<00:00, 31.42it/s] 59%|█████▉    | 13/22 [00:00<00:00, 39.75it/s] 82%|████████▏ | 18/22 [00:00<00:00, 43.20it/s]100%|██████████| 22/22 [00:05<00:00,  4.36it/s]
2025-03-13 11:41:56,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:56
2025-03-13 11:42:47,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.5469 secs
2025-03-13 11:42:47,406 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 11:42:47,406 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 11:43:07,429 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0231 secs
2025-03-13 11:43:07,430 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6207 secs
2025-03-13 11:43:07,430 [INFO]: {
2025-03-13 11:43:07,430 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:07,430 [INFO]: 	index_param: efSearch=149
2025-03-13 11:43:07,430 [INFO]: 	index_path: knn.index
2025-03-13 11:43:07,430 [INFO]: 	size in bytes: 1012051390
2025-03-13 11:43:07,430 [INFO]: 	avg_search_speed_ms: 11.619154533693669
2025-03-13 11:43:07,430 [INFO]: 	99p_search_speed_ms: 16.284729074686766
2025-03-13 11:43:07,430 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:07,430 [INFO]: 	nb vectors: 5144
2025-03-13 11:43:07,430 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:07,430 [INFO]: 	compression ratio: 0.9993084955893395
2025-03-13 11:43:07,430 [INFO]: }
2025-03-13 11:43:07,430 [INFO]: 	>>> Finished "Creating the index" in 75.6227 secs
2025-03-13 11:43:07,430 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6595 secs
2025-03-13 11:43:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 66664 [episode count 6/20]
[retrieval_preprocessing] for episode 19072 [episode count 7/20], we have num_retrieval=np.int64(5173) num_query=np.int64(149)
2025-03-13 11:43:10,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:10,980 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:10
2025-03-13 11:43:10,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.56it/s]
2025-03-13 11:43:11,008 [INFO]: There are 5173 embeddings of dim 49152
2025-03-13 11:43:11,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:43:11,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:11
2025-03-13 11:43:11,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:11,009 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:43:11,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:11,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:11,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:11
2025-03-13 11:43:11,009 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:11,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:43:11,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:11
2025-03-13 11:43:11,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:11,009 [INFO]: 	Creating the index 03/13/2025, 11:43:11
2025-03-13 11:43:11,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:11
2025-03-13 11:43:11,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:11,010 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:11
2025-03-13 11:43:11,010 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:43:11,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.37it/s] 14%|█▎        | 3/22 [00:00<00:01, 11.34it/s] 23%|██▎       | 5/22 [00:00<00:01, 12.27it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.84it/s] 41%|████      | 9/22 [00:00<00:01, 12.14it/s] 50%|█████     | 11/22 [00:00<00:00, 12.23it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.92it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.59it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.83it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.41it/s] 95%|█████████▌| 21/22 [00:07<00:00,  1.11it/s]100%|██████████| 22/22 [00:08<00:00,  1.08it/s]100%|██████████| 22/22 [00:08<00:00,  2.71it/s]
2025-03-13 11:43:19,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:19
2025-03-13 11:44:09,115 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9798 secs
2025-03-13 11:44:09,115 [INFO]: The best hyperparameters are: efSearch=116
2025-03-13 11:44:09,116 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 11:44:32,621 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5056 secs
2025-03-13 11:44:32,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6120 secs
2025-03-13 11:44:32,622 [INFO]: {
2025-03-13 11:44:32,622 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:32,622 [INFO]: 	index_param: efSearch=116
2025-03-13 11:44:32,622 [INFO]: 	index_path: knn.index
2025-03-13 11:44:32,622 [INFO]: 	size in bytes: 1017757030
2025-03-13 11:44:32,622 [INFO]: 	avg_search_speed_ms: 11.19714230481506
2025-03-13 11:44:32,622 [INFO]: 	99p_search_speed_ms: 16.058854619041085
2025-03-13 11:44:32,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:32,622 [INFO]: 	nb vectors: 5173
2025-03-13 11:44:32,622 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:32,622 [INFO]: 	compression ratio: 0.9993084341554487
2025-03-13 11:44:32,622 [INFO]: }
2025-03-13 11:44:32,622 [INFO]: 	>>> Finished "Creating the index" in 81.6135 secs
2025-03-13 11:44:32,622 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6419 secs
2025-03-13 11:44:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 19072 [episode count 7/20]
[retrieval_preprocessing] for episode 26815 [episode count 8/20], we have num_retrieval=np.int64(5190) num_query=np.int64(132)
2025-03-13 11:44:35,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:36,462 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:36
2025-03-13 11:44:36,462 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-13 11:44:36,494 [INFO]: There are 5190 embeddings of dim 49152
2025-03-13 11:44:36,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 11:44:36,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:36
2025-03-13 11:44:36,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:36,496 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 11:44:36,496 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:36,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:44:36,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:36
2025-03-13 11:44:36,497 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:36,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:44:36,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:36
2025-03-13 11:44:36,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:36,497 [INFO]: 	Creating the index 03/13/2025, 11:44:36
2025-03-13 11:44:36,498 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:36
2025-03-13 11:44:36,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:44:36,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:36
2025-03-13 11:44:36,501 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:44:36,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.74it/s]  9%|▉         | 2/22 [00:00<00:03,  6.24it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.00it/s] 27%|██▋       | 6/22 [00:00<00:01, 13.81it/s] 45%|████▌     | 10/22 [00:00<00:00, 21.02it/s] 64%|██████▎   | 14/22 [00:00<00:00, 25.60it/s] 82%|████████▏ | 18/22 [00:00<00:00, 29.13it/s]100%|██████████| 22/22 [00:06<00:00,  1.94it/s]100%|██████████| 22/22 [00:06<00:00,  3.41it/s]
2025-03-13 11:44:42,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:42
2025-03-13 11:45:49,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.5750 secs
2025-03-13 11:45:49,532 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 11:45:49,532 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.59s/it] 50%|█████     | 2/4 [00:04<00:03,  1.92s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.46s/it]
2025-03-13 11:46:12,921 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3884 secs
2025-03-13 11:46:12,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.4205 secs
2025-03-13 11:46:12,922 [INFO]: {
2025-03-13 11:46:12,922 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:12,922 [INFO]: 	index_param: efSearch=130
2025-03-13 11:46:12,922 [INFO]: 	index_path: knn.index
2025-03-13 11:46:12,922 [INFO]: 	size in bytes: 1021101790
2025-03-13 11:46:12,922 [INFO]: 	avg_search_speed_ms: 10.220953743273165
2025-03-13 11:46:12,922 [INFO]: 	99p_search_speed_ms: 14.277021763846278
2025-03-13 11:46:12,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:12,922 [INFO]: 	nb vectors: 5190
2025-03-13 11:46:12,922 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:12,922 [INFO]: 	compression ratio: 0.9993083255685998
2025-03-13 11:46:12,922 [INFO]: }
2025-03-13 11:46:12,922 [INFO]: 	>>> Finished "Creating the index" in 96.4247 secs
2025-03-13 11:46:12,922 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4602 secs
2025-03-13 11:46:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 26815 [episode count 8/20]
[retrieval_preprocessing] for episode 52940 [episode count 9/20], we have num_retrieval=np.int64(4982) num_query=np.int64(340)
2025-03-13 11:46:15,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:16,433 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:16
2025-03-13 11:46:16,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.02it/s]
2025-03-13 11:46:16,466 [INFO]: There are 4982 embeddings of dim 49152
2025-03-13 11:46:16,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 11:46:16,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:16
2025-03-13 11:46:16,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:16,467 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:46:16,467 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:16,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:46:16,467 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:16
2025-03-13 11:46:16,467 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:16,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:46:16,467 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:16
2025-03-13 11:46:16,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:16,467 [INFO]: 	Creating the index 03/13/2025, 11:46:16
2025-03-13 11:46:16,468 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:16
2025-03-13 11:46:16,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:46:16,469 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:16
2025-03-13 11:46:16,469 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:46:16,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.12it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.53it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.12it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.64it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.93it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.51it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.84it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.94it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.14it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.07it/s]100%|██████████| 20/20 [00:06<00:00,  2.93it/s]
2025-03-13 11:46:23,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:23
2025-03-13 11:47:18,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3031 secs
2025-03-13 11:47:18,603 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 11:47:18,603 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 11:47:35,927 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3241 secs
2025-03-13 11:47:36,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8165 secs
2025-03-13 11:47:36,286 [INFO]: {
2025-03-13 11:47:36,286 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:36,286 [INFO]: 	index_param: efSearch=128
2025-03-13 11:47:36,286 [INFO]: 	index_path: knn.index
2025-03-13 11:47:36,287 [INFO]: 	size in bytes: 980178670
2025-03-13 11:47:36,287 [INFO]: 	avg_search_speed_ms: 8.349966840567992
2025-03-13 11:47:36,287 [INFO]: 	99p_search_speed_ms: 12.364358054473994
2025-03-13 11:47:36,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:36,287 [INFO]: 	nb vectors: 4982
2025-03-13 11:47:36,287 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:36,287 [INFO]: 	compression ratio: 0.9993086831812
2025-03-13 11:47:36,287 [INFO]: }
2025-03-13 11:47:36,287 [INFO]: 	>>> Finished "Creating the index" in 79.8195 secs
2025-03-13 11:47:36,287 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8541 secs
2025-03-13 11:47:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 52940 [episode count 9/20]
[retrieval_preprocessing] for episode 46297 [episode count 10/20], we have num_retrieval=np.int64(5183) num_query=np.int64(139)
2025-03-13 11:47:40,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:42,108 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:42
2025-03-13 11:47:42,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1822.82it/s]
2025-03-13 11:47:42,132 [INFO]: There are 5183 embeddings of dim 49152
2025-03-13 11:47:42,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:47:42,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:42
2025-03-13 11:47:42,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:42,133 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:47:42,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:42,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:42,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:42
2025-03-13 11:47:42,133 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:42,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:42,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:42
2025-03-13 11:47:42,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:42,133 [INFO]: 	Creating the index 03/13/2025, 11:47:42
2025-03-13 11:47:42,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:42
2025-03-13 11:47:42,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:47:42,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:42
2025-03-13 11:47:42,134 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:47:42,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.38it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.88it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.02it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.64it/s] 41%|████      | 9/22 [00:00<00:01, 10.96it/s] 50%|█████     | 11/22 [00:01<00:00, 11.09it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.25it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.32it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.44it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.45it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.54it/s]100%|██████████| 22/22 [00:06<00:00,  1.34it/s]100%|██████████| 22/22 [00:06<00:00,  3.24it/s]
2025-03-13 11:47:48,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:48
2025-03-13 11:48:43,318 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.4006 secs
2025-03-13 11:48:43,318 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 11:48:43,318 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 11:49:09,778 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4591 secs
2025-03-13 11:49:09,778 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.6441 secs
2025-03-13 11:49:09,778 [INFO]: {
2025-03-13 11:49:09,778 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:09,778 [INFO]: 	index_param: efSearch=163
2025-03-13 11:49:09,778 [INFO]: 	index_path: knn.index
2025-03-13 11:49:09,778 [INFO]: 	size in bytes: 1019724490
2025-03-13 11:49:09,778 [INFO]: 	avg_search_speed_ms: 10.461158573600194
2025-03-13 11:49:09,778 [INFO]: 	99p_search_speed_ms: 14.19225595891476
2025-03-13 11:49:09,778 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:09,778 [INFO]: 	nb vectors: 5183
2025-03-13 11:49:09,778 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:09,778 [INFO]: 	compression ratio: 0.9993084151582944
2025-03-13 11:49:09,778 [INFO]: }
2025-03-13 11:49:09,778 [INFO]: 	>>> Finished "Creating the index" in 87.6454 secs
2025-03-13 11:49:09,778 [INFO]: >>> Finished "Launching the whole pipeline" in 87.6703 secs
2025-03-13 11:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 46297 [episode count 10/20]
[retrieval_preprocessing] for episode 29409 [episode count 11/20], we have num_retrieval=np.int64(5097) num_query=np.int64(225)
2025-03-13 11:49:12,702 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:13,474 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:13
2025-03-13 11:49:13,474 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.82it/s]
2025-03-13 11:49:13,501 [INFO]: There are 5097 embeddings of dim 49152
2025-03-13 11:49:13,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:49:13,501 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:13
2025-03-13 11:49:13,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:13,501 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:49:13,501 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:13,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:13,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:13
2025-03-13 11:49:13,501 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:13,501 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:49:13,501 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:13
2025-03-13 11:49:13,501 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:13,502 [INFO]: 	Creating the index 03/13/2025, 11:49:13
2025-03-13 11:49:13,502 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:13
2025-03-13 11:49:13,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:49:13,503 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:13
2025-03-13 11:49:13,503 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:49:13,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.31it/s] 14%|█▎        | 3/22 [00:00<00:01, 11.05it/s] 23%|██▎       | 5/22 [00:00<00:01, 13.26it/s] 32%|███▏      | 7/22 [00:00<00:01, 14.61it/s] 41%|████      | 9/22 [00:00<00:00, 15.69it/s] 55%|█████▍    | 12/22 [00:00<00:00, 17.42it/s] 64%|██████▎   | 14/22 [00:00<00:00, 17.18it/s] 73%|███████▎  | 16/22 [00:01<00:00, 15.49it/s] 82%|████████▏ | 18/22 [00:01<00:00, 14.32it/s] 91%|█████████ | 20/22 [00:01<00:00, 13.36it/s]100%|██████████| 22/22 [00:06<00:00,  1.22it/s]100%|██████████| 22/22 [00:06<00:00,  3.36it/s]
2025-03-13 11:49:20,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:20
2025-03-13 11:50:08,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3845 secs
2025-03-13 11:50:08,438 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 11:50:08,438 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 11:50:37,075 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6365 secs
2025-03-13 11:50:37,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5722 secs
2025-03-13 11:50:37,075 [INFO]: {
2025-03-13 11:50:37,075 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:37,075 [INFO]: 	index_param: efSearch=153
2025-03-13 11:50:37,075 [INFO]: 	index_path: knn.index
2025-03-13 11:50:37,075 [INFO]: 	size in bytes: 1002804370
2025-03-13 11:50:37,075 [INFO]: 	avg_search_speed_ms: 8.864160580890822
2025-03-13 11:50:37,075 [INFO]: 	99p_search_speed_ms: 13.311494262889033
2025-03-13 11:50:37,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:37,075 [INFO]: 	nb vectors: 5097
2025-03-13 11:50:37,075 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:37,075 [INFO]: 	compression ratio: 0.9993085450953908
2025-03-13 11:50:37,075 [INFO]: }
2025-03-13 11:50:37,075 [INFO]: 	>>> Finished "Creating the index" in 83.5738 secs
2025-03-13 11:50:37,075 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6010 secs
2025-03-13 11:50:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 29409 [episode count 11/20]
[retrieval_preprocessing] for episode 77574 [episode count 12/20], we have num_retrieval=np.int64(5158) num_query=np.int64(164)
2025-03-13 11:50:40,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:41,331 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:41
2025-03-13 11:50:41,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 11:50:41,356 [INFO]: There are 5158 embeddings of dim 49152
2025-03-13 11:50:41,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 11:50:41,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:41
2025-03-13 11:50:41,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:41,356 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:50:41,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:41,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:50:41,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:41
2025-03-13 11:50:41,356 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:41,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:50:41,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:41
2025-03-13 11:50:41,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:41,356 [INFO]: 	Creating the index 03/13/2025, 11:50:41
2025-03-13 11:50:41,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:41
2025-03-13 11:50:41,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:50:41,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:41
2025-03-13 11:50:41,358 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:50:41,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.98it/s]  9%|▉         | 2/22 [00:00<00:03,  6.52it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.25it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.65it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.86it/s] 27%|██▋       | 6/22 [00:00<00:02,  8.00it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.15it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.19it/s] 41%|████      | 9/22 [00:01<00:01,  8.25it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.23it/s] 50%|█████     | 11/22 [00:01<00:01,  8.23it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.21it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.03it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.61it/s] 82%|████████▏ | 18/22 [00:02<00:00, 10.02it/s] 91%|█████████ | 20/22 [00:02<00:00, 10.24it/s]100%|██████████| 22/22 [00:07<00:00,  1.04it/s]100%|██████████| 22/22 [00:07<00:00,  2.84it/s]
2025-03-13 11:50:49,103 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:49
2025-03-13 11:51:44,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7532 secs
2025-03-13 11:51:44,856 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 11:51:44,856 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 11:52:04,461 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6044 secs
2025-03-13 11:52:04,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1037 secs
2025-03-13 11:52:04,461 [INFO]: {
2025-03-13 11:52:04,461 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:04,461 [INFO]: 	index_param: efSearch=159
2025-03-13 11:52:04,461 [INFO]: 	index_path: knn.index
2025-03-13 11:52:04,461 [INFO]: 	size in bytes: 1014805810
2025-03-13 11:52:04,461 [INFO]: 	avg_search_speed_ms: 10.455671541741562
2025-03-13 11:52:04,461 [INFO]: 	99p_search_speed_ms: 14.197157800663273
2025-03-13 11:52:04,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:04,461 [INFO]: 	nb vectors: 5158
2025-03-13 11:52:04,461 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:04,461 [INFO]: 	compression ratio: 0.9993084923311584
2025-03-13 11:52:04,461 [INFO]: }
2025-03-13 11:52:04,461 [INFO]: 	>>> Finished "Creating the index" in 83.1051 secs
2025-03-13 11:52:04,461 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1305 secs
2025-03-13 11:52:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 77574 [episode count 12/20]
[retrieval_preprocessing] for episode 53561 [episode count 13/20], we have num_retrieval=np.int64(4768) num_query=np.int64(554)
2025-03-13 11:52:07,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:08,470 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:08
2025-03-13 11:52:08,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 942.96it/s]
2025-03-13 11:52:08,497 [INFO]: There are 4768 embeddings of dim 49152
2025-03-13 11:52:08,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:52:08,498 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:08,498 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 11:52:08,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:08,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:52:08,499 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,499 [INFO]: 984.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:08,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:52:08,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:08
2025-03-13 11:52:08,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:08,500 [INFO]: 	Creating the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:08
2025-03-13 11:52:08,502 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:52:08,502 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,503 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:52:08,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:05,  3.38it/s] 11%|█         | 2/19 [00:00<00:03,  4.40it/s] 16%|█▌        | 3/19 [00:00<00:02,  5.45it/s] 21%|██        | 4/19 [00:00<00:02,  6.31it/s] 26%|██▋       | 5/19 [00:00<00:02,  6.91it/s] 32%|███▏      | 6/19 [00:00<00:01,  7.23it/s] 37%|███▋      | 7/19 [00:01<00:01,  7.38it/s] 42%|████▏     | 8/19 [00:01<00:01,  7.55it/s] 47%|████▋     | 9/19 [00:01<00:01,  7.74it/s] 53%|█████▎    | 10/19 [00:01<00:01,  7.73it/s] 58%|█████▊    | 11/19 [00:01<00:01,  7.89it/s] 63%|██████▎   | 12/19 [00:01<00:00,  8.01it/s] 68%|██████▊   | 13/19 [00:01<00:00,  8.09it/s] 74%|███████▎  | 14/19 [00:01<00:00,  8.15it/s] 79%|███████▉  | 15/19 [00:02<00:00,  8.29it/s] 84%|████████▍ | 16/19 [00:02<00:00,  8.44it/s] 89%|████████▉ | 17/19 [00:02<00:00,  8.77it/s]100%|██████████| 19/19 [00:05<00:00,  1.10it/s]100%|██████████| 19/19 [00:05<00:00,  3.18it/s]
2025-03-13 11:52:14,487 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:14
2025-03-13 11:53:05,138 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6503 secs
2025-03-13 11:53:05,138 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 11:53:05,138 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 11:53:24,706 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5675 secs
2025-03-13 11:53:24,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2065 secs
2025-03-13 11:53:24,709 [INFO]: {
2025-03-13 11:53:24,709 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:24,709 [INFO]: 	index_param: efSearch=168
2025-03-13 11:53:24,709 [INFO]: 	index_path: knn.index
2025-03-13 11:53:24,709 [INFO]: 	size in bytes: 938075530
2025-03-13 11:53:24,709 [INFO]: 	avg_search_speed_ms: 10.655974013645586
2025-03-13 11:53:24,709 [INFO]: 	99p_search_speed_ms: 15.46565422322601
2025-03-13 11:53:24,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:24,709 [INFO]: 	nb vectors: 4768
2025-03-13 11:53:24,709 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:24,709 [INFO]: 	compression ratio: 0.9993085993832501
2025-03-13 11:53:24,709 [INFO]: }
2025-03-13 11:53:24,709 [INFO]: 	>>> Finished "Creating the index" in 76.2094 secs
2025-03-13 11:53:24,709 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2394 secs
2025-03-13 11:53:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 53561 [episode count 13/20]
[retrieval_preprocessing] for episode 6973 [episode count 14/20], we have num_retrieval=np.int64(5159) num_query=np.int64(163)
2025-03-13 11:53:30,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:31,999 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:31
2025-03-13 11:53:32,000 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-13 11:53:32,024 [INFO]: There are 5159 embeddings of dim 49152
2025-03-13 11:53:32,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:53:32,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:32,024 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:53:32,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:32,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:32,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,024 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:32,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:53:32,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:32
2025-03-13 11:53:32,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:32,024 [INFO]: 	Creating the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:32
2025-03-13 11:53:32,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:53:32,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,026 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:53:32,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.98it/s]  9%|▉         | 2/22 [00:00<00:03,  6.63it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.46it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.84it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.09it/s] 27%|██▋       | 6/22 [00:00<00:02,  7.87it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.18it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.26it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.39it/s] 55%|█████▍    | 12/22 [00:01<00:00, 10.18it/s] 64%|██████▎   | 14/22 [00:01<00:00, 10.30it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.91it/s] 82%|████████▏ | 18/22 [00:01<00:00, 10.00it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.99it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.97it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.08s/it]100%|██████████| 22/22 [00:07<00:00,  1.06s/it]100%|██████████| 22/22 [00:07<00:00,  2.94it/s]
2025-03-13 11:53:39,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:39
2025-03-13 11:54:46,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.7698 secs
2025-03-13 11:54:46,291 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 11:54:46,291 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 11:55:05,977 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6862 secs
2025-03-13 11:55:05,978 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.9522 secs
2025-03-13 11:55:05,978 [INFO]: {
2025-03-13 11:55:05,978 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:05,978 [INFO]: 	index_param: efSearch=105
2025-03-13 11:55:05,978 [INFO]: 	index_path: knn.index
2025-03-13 11:55:05,978 [INFO]: 	size in bytes: 1015002550
2025-03-13 11:55:05,978 [INFO]: 	avg_search_speed_ms: 9.19854766736364
2025-03-13 11:55:05,978 [INFO]: 	99p_search_speed_ms: 12.925585238263013
2025-03-13 11:55:05,978 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:05,978 [INFO]: 	nb vectors: 5159
2025-03-13 11:55:05,978 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:05,978 [INFO]: 	compression ratio: 0.999308496318556
2025-03-13 11:55:05,978 [INFO]: }
2025-03-13 11:55:05,978 [INFO]: 	>>> Finished "Creating the index" in 93.9537 secs
2025-03-13 11:55:05,978 [INFO]: >>> Finished "Launching the whole pipeline" in 93.9786 secs
2025-03-13 11:55:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 6973 [episode count 14/20]
[retrieval_preprocessing] for episode 94033 [episode count 15/20], we have num_retrieval=np.int64(4998) num_query=np.int64(324)
2025-03-13 11:55:08,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:09,491 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:09
2025-03-13 11:55:09,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.19it/s]
2025-03-13 11:55:09,517 [INFO]: There are 4998 embeddings of dim 49152
2025-03-13 11:55:09,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:55:09,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:09
2025-03-13 11:55:09,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:09,517 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:55:09,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:09,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:55:09,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:09
2025-03-13 11:55:09,517 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:09,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:55:09,517 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:09
2025-03-13 11:55:09,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:09,517 [INFO]: 	Creating the index 03/13/2025, 11:55:09
2025-03-13 11:55:09,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:09
2025-03-13 11:55:09,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:55:09,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:09
2025-03-13 11:55:09,519 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:55:09,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.74it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.09it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.20it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.78it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.07it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.23it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.40it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.47it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.55it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.53it/s]100%|██████████| 20/20 [00:06<00:00,  3.14it/s]
2025-03-13 11:55:15,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:15
2025-03-13 11:56:10,594 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6973 secs
2025-03-13 11:56:10,595 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 11:56:10,595 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s]
2025-03-13 11:56:29,042 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4470 secs
2025-03-13 11:56:29,045 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5268 secs
2025-03-13 11:56:29,046 [INFO]: {
2025-03-13 11:56:29,046 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:29,046 [INFO]: 	index_param: efSearch=137
2025-03-13 11:56:29,046 [INFO]: 	index_path: knn.index
2025-03-13 11:56:29,046 [INFO]: 	size in bytes: 983326750
2025-03-13 11:56:29,046 [INFO]: 	avg_search_speed_ms: 9.380759989343039
2025-03-13 11:56:29,046 [INFO]: 	99p_search_speed_ms: 14.805848523974404
2025-03-13 11:56:29,046 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:29,046 [INFO]: 	nb vectors: 4998
2025-03-13 11:56:29,046 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:29,046 [INFO]: 	compression ratio: 0.9993085045230388
2025-03-13 11:56:29,046 [INFO]: }
2025-03-13 11:56:29,046 [INFO]: 	>>> Finished "Creating the index" in 79.5285 secs
2025-03-13 11:56:29,046 [INFO]: >>> Finished "Launching the whole pipeline" in 79.5543 secs
2025-03-13 11:56:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 94033 [episode count 15/20]
[retrieval_preprocessing] for episode 46928 [episode count 16/20], we have num_retrieval=np.int64(4568) num_query=np.int64(754)
2025-03-13 11:56:33,374 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:34,191 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:34
2025-03-13 11:56:34,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.16it/s]
2025-03-13 11:56:34,233 [INFO]: There are 4568 embeddings of dim 49152
2025-03-13 11:56:34,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0412 secs
2025-03-13 11:56:34,233 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:34
2025-03-13 11:56:34,234 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:34,234 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 11:56:34,234 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:34,234 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:56:34,234 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:34
2025-03-13 11:56:34,234 [INFO]: 942.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:34,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:56:34,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:34
2025-03-13 11:56:34,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:34,235 [INFO]: 	Creating the index 03/13/2025, 11:56:34
2025-03-13 11:56:34,236 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:34
2025-03-13 11:56:34,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:56:34,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:34
2025-03-13 11:56:34,237 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:56:34,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:04,  3.62it/s] 11%|█         | 2/18 [00:00<00:03,  5.31it/s] 22%|██▏       | 4/18 [00:00<00:01,  9.21it/s] 44%|████▍     | 8/18 [00:00<00:00, 17.84it/s] 67%|██████▋   | 12/18 [00:00<00:00, 23.80it/s] 94%|█████████▍| 17/18 [00:00<00:00, 29.40it/s]100%|██████████| 18/18 [00:05<00:00,  3.58it/s]
2025-03-13 11:56:39,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:39
2025-03-13 11:57:41,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.8040 secs
2025-03-13 11:57:41,084 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 11:57:41,085 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 11:57:56,277 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1926 secs
2025-03-13 11:57:56,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0428 secs
2025-03-13 11:57:56,280 [INFO]: {
2025-03-13 11:57:56,280 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:56,280 [INFO]: 	index_param: efSearch=124
2025-03-13 11:57:56,280 [INFO]: 	index_path: knn.index
2025-03-13 11:57:56,280 [INFO]: 	size in bytes: 898726630
2025-03-13 11:57:56,280 [INFO]: 	avg_search_speed_ms: 8.498208094451549
2025-03-13 11:57:56,281 [INFO]: 	99p_search_speed_ms: 12.726000351831317
2025-03-13 11:57:56,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:56,281 [INFO]: 	nb vectors: 4568
2025-03-13 11:57:56,281 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:56,281 [INFO]: 	compression ratio: 0.999308704138432
2025-03-13 11:57:56,281 [INFO]: }
2025-03-13 11:57:56,281 [INFO]: 	>>> Finished "Creating the index" in 82.0451 secs
2025-03-13 11:57:56,281 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0890 secs
2025-03-13 11:57:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 46928 [episode count 16/20]
[retrieval_preprocessing] for episode 87029 [episode count 17/20], we have num_retrieval=np.int64(5180) num_query=np.int64(142)
2025-03-13 11:58:01,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:02,412 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:02
2025-03-13 11:58:02,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 977.24it/s]
2025-03-13 11:58:02,446 [INFO]: There are 5180 embeddings of dim 49152
2025-03-13 11:58:02,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 11:58:02,447 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:02,447 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:58:02,447 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:02,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:02,447 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,447 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:02,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:58:02,447 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:02
2025-03-13 11:58:02,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:02,447 [INFO]: 	Creating the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,447 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:02
2025-03-13 11:58:02,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:58:02,448 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,448 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:58:02,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.61it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.08it/s] 50%|█████     | 11/22 [00:00<00:00, 34.46it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.73it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.66it/s]100%|██████████| 22/22 [00:06<00:00,  3.59it/s]
2025-03-13 11:58:08,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:08
2025-03-13 11:59:08,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5115 secs
2025-03-13 11:59:08,088 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 11:59:08,088 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 11:59:27,940 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8522 secs
2025-03-13 11:59:27,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.4922 secs
2025-03-13 11:59:27,941 [INFO]: {
2025-03-13 11:59:27,941 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:27,941 [INFO]: 	index_param: efSearch=132
2025-03-13 11:59:27,941 [INFO]: 	index_path: knn.index
2025-03-13 11:59:27,941 [INFO]: 	size in bytes: 1019134210
2025-03-13 11:59:27,941 [INFO]: 	avg_search_speed_ms: 9.052802542671223
2025-03-13 11:59:27,941 [INFO]: 	99p_search_speed_ms: 12.777302246540787
2025-03-13 11:59:27,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:27,941 [INFO]: 	nb vectors: 5180
2025-03-13 11:59:27,941 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:27,941 [INFO]: 	compression ratio: 0.9993084620326895
2025-03-13 11:59:27,941 [INFO]: }
2025-03-13 11:59:27,941 [INFO]: 	>>> Finished "Creating the index" in 85.4938 secs
2025-03-13 11:59:27,941 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5285 secs
2025-03-13 11:59:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 87029 [episode count 17/20]
[retrieval_preprocessing] for episode 10231 [episode count 18/20], we have num_retrieval=np.int64(5184) num_query=np.int64(138)
2025-03-13 11:59:29,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:30,342 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:30
2025-03-13 11:59:30,342 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2197.12it/s]
2025-03-13 11:59:30,372 [INFO]: There are 5184 embeddings of dim 49152
2025-03-13 11:59:30,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 11:59:30,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:30
2025-03-13 11:59:30,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:30,372 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:59:30,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:30,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:30,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:30
2025-03-13 11:59:30,373 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:30,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:59:30,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:30
2025-03-13 11:59:30,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:30,373 [INFO]: 	Creating the index 03/13/2025, 11:59:30
2025-03-13 11:59:30,373 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:30
2025-03-13 11:59:30,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:59:30,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:30
2025-03-13 11:59:30,374 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:59:30,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.90it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.59it/s] 50%|█████     | 11/22 [00:00<00:00, 37.88it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.52it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.76it/s]100%|██████████| 22/22 [00:05<00:00,  3.77it/s]
2025-03-13 11:59:36,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:36
2025-03-13 12:00:29,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.3966 secs
2025-03-13 12:00:29,616 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 12:00:29,616 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 12:00:47,963 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3465 secs
2025-03-13 12:00:47,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5891 secs
2025-03-13 12:00:47,963 [INFO]: {
2025-03-13 12:00:47,963 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:47,963 [INFO]: 	index_param: efSearch=135
2025-03-13 12:00:47,963 [INFO]: 	index_path: knn.index
2025-03-13 12:00:47,963 [INFO]: 	size in bytes: 1019921290
2025-03-13 12:00:47,963 [INFO]: 	avg_search_speed_ms: 11.316617007095502
2025-03-13 12:00:47,963 [INFO]: 	99p_search_speed_ms: 21.81460543302818
2025-03-13 12:00:47,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:47,963 [INFO]: 	nb vectors: 5184
2025-03-13 12:00:47,963 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:47,963 [INFO]: 	compression ratio: 0.9993083603539642
2025-03-13 12:00:47,963 [INFO]: }
2025-03-13 12:00:47,963 [INFO]: 	>>> Finished "Creating the index" in 77.5905 secs
2025-03-13 12:00:47,963 [INFO]: >>> Finished "Launching the whole pipeline" in 77.6216 secs
2025-03-13 12:00:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 10231 [episode count 18/20]
[retrieval_preprocessing] for episode 35313 [episode count 19/20], we have num_retrieval=np.int64(4958) num_query=np.int64(364)
2025-03-13 12:00:49,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:50,901 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:50
2025-03-13 12:00:50,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-13 12:00:50,933 [INFO]: There are 4958 embeddings of dim 49152
2025-03-13 12:00:50,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 12:00:50,934 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:50
2025-03-13 12:00:50,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:50,934 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 12:00:50,934 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:50,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:00:50,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:50
2025-03-13 12:00:50,935 [INFO]: 1023.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:50,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:00:50,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:50
2025-03-13 12:00:50,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:50,936 [INFO]: 	Creating the index 03/13/2025, 12:00:50
2025-03-13 12:00:50,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:50
2025-03-13 12:00:50,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:00:50,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:50
2025-03-13 12:00:50,940 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:00:50,940 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.36it/s] 35%|███▌      | 7/20 [00:00<00:00, 36.71it/s] 60%|██████    | 12/20 [00:00<00:00, 42.39it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.76it/s]100%|██████████| 20/20 [00:04<00:00,  4.27it/s]
2025-03-13 12:00:55,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:55
2025-03-13 12:01:43,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4489 secs
2025-03-13 12:01:43,082 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 12:01:43,082 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.92it/s]
2025-03-13 12:02:09,816 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7341 secs
2025-03-13 12:02:09,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.8792 secs
2025-03-13 12:02:09,819 [INFO]: {
2025-03-13 12:02:09,819 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:09,819 [INFO]: 	index_param: efSearch=153
2025-03-13 12:02:09,819 [INFO]: 	index_path: knn.index
2025-03-13 12:02:09,819 [INFO]: 	size in bytes: 975456850
2025-03-13 12:02:09,819 [INFO]: 	avg_search_speed_ms: 9.60408395767305
2025-03-13 12:02:09,820 [INFO]: 	99p_search_speed_ms: 13.5853923857212
2025-03-13 12:02:09,820 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:09,820 [INFO]: 	nb vectors: 4958
2025-03-13 12:02:09,820 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:09,820 [INFO]: 	compression ratio: 0.999308645994951
2025-03-13 12:02:09,820 [INFO]: }
2025-03-13 12:02:09,820 [INFO]: 	>>> Finished "Creating the index" in 78.8837 secs
2025-03-13 12:02:09,820 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9183 secs
2025-03-13 12:02:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 35313 [episode count 19/20]
2025-03-13 12:02:12: [retrieval_preprocessing] finished for 4706041793_hang_cloth_on_stand [chosen_id count 3/260]
2025-03-13 12:02:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4743066113_swap_box_and_table_contents [chosen_id count 4/260]
2025-03-13 12:02:18: [retrieval_preprocessing] we have num_total=18568 embedding_dim=49152
[retrieval_preprocessing] for episode 1032 [episode count 0/20], we have num_retrieval=np.int64(17722) num_query=np.int64(846)
2025-03-13 12:02:20,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:24,346 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:24
2025-03-13 12:02:24,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1707.78it/s]
2025-03-13 12:02:24,396 [INFO]: There are 17722 embeddings of dim 49152
2025-03-13 12:02:24,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0503 secs
2025-03-13 12:02:24,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:24
2025-03-13 12:02:24,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:24,397 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:02:24,397 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:02:24,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:02:24,398 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:24
2025-03-13 12:02:24,398 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:24,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:02:24,399 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:24
2025-03-13 12:02:24,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:02:24,399 [INFO]: 	Creating the index 03/13/2025, 12:02:24
2025-03-13 12:02:24,399 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:02:24
2025-03-13 12:02:24,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 12:02:24,402 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:24
2025-03-13 12:02:24,403 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:02:24,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:09,  7.82it/s]  7%|▋         | 5/73 [00:00<00:02, 24.49it/s] 14%|█▎        | 10/73 [00:00<00:01, 33.75it/s] 21%|██        | 15/73 [00:00<00:01, 38.34it/s] 27%|██▋       | 20/73 [00:00<00:01, 40.79it/s] 34%|███▍      | 25/73 [00:09<00:30,  1.59it/s] 41%|████      | 30/73 [00:09<00:18,  2.37it/s] 48%|████▊     | 35/73 [00:09<00:11,  3.44it/s] 55%|█████▍    | 40/73 [00:09<00:06,  4.89it/s] 62%|██████▏   | 45/73 [00:18<00:19,  1.44it/s] 67%|██████▋   | 49/73 [00:18<00:12,  1.92it/s] 74%|███████▍  | 54/73 [00:18<00:06,  2.76it/s] 81%|████████  | 59/73 [00:18<00:03,  3.91it/s] 86%|████████▋ | 63/73 [00:27<00:07,  1.25it/s] 92%|█████████▏| 67/73 [00:27<00:03,  1.71it/s] 99%|█████████▊| 72/73 [00:28<00:00,  2.50it/s]100%|██████████| 73/73 [00:33<00:00,  2.19it/s]
2025-03-13 12:02:57,684 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:57
2025-03-13 12:05:23,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 146.2326 secs
2025-03-13 12:05:23,917 [INFO]: The best hyperparameters are: efSearch=60
2025-03-13 12:05:23,917 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 12:06:10,669 [INFO]: 	>>> Finished "Compute fast metrics" in 46.7515 secs
2025-03-13 12:06:10,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 226.2684 secs
2025-03-13 12:06:10,672 [INFO]: {
2025-03-13 12:06:10,672 [INFO]: 	index_key: HNSW32
2025-03-13 12:06:10,672 [INFO]: 	index_param: efSearch=60
2025-03-13 12:06:10,672 [INFO]: 	index_path: knn.index
2025-03-13 12:06:10,672 [INFO]: 	size in bytes: 3489110170
2025-03-13 12:06:10,672 [INFO]: 	avg_search_speed_ms: 10.658923227753021
2025-03-13 12:06:10,672 [INFO]: 	99p_search_speed_ms: 20.41523998370394
2025-03-13 12:06:10,672 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:10,672 [INFO]: 	nb vectors: 17722
2025-03-13 12:06:10,672 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:10,672 [INFO]: 	compression ratio: 0.998617643535171
2025-03-13 12:06:10,672 [INFO]: }
2025-03-13 12:06:10,672 [INFO]: 	>>> Finished "Creating the index" in 226.2728 secs
2025-03-13 12:06:10,672 [INFO]: >>> Finished "Launching the whole pipeline" in 226.3259 secs
2025-03-13 12:06:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 1032 [episode count 0/20]
[retrieval_preprocessing] for episode 41993 [episode count 1/20], we have num_retrieval=np.int64(17576) num_query=np.int64(992)
2025-03-13 12:06:18,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:21,294 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:21
2025-03-13 12:06:21,294 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.17it/s]
2025-03-13 12:06:21,340 [INFO]: There are 17576 embeddings of dim 49152
2025-03-13 12:06:21,340 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0460 secs
2025-03-13 12:06:21,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:21
2025-03-13 12:06:21,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:21,341 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:06:21,341 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:06:21,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:06:21,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:21
2025-03-13 12:06:21,341 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:21,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:06:21,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:21
2025-03-13 12:06:21,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:06:21,342 [INFO]: 	Creating the index 03/13/2025, 12:06:21
2025-03-13 12:06:21,342 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:06:21
2025-03-13 12:06:21,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0019 secs
2025-03-13 12:06:21,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:21
2025-03-13 12:06:21,344 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:06:21,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:10,  6.83it/s]  5%|▌         | 4/73 [00:00<00:03, 17.70it/s] 12%|█▏        | 9/73 [00:00<00:02, 28.73it/s] 19%|█▉        | 14/73 [00:00<00:01, 34.68it/s] 26%|██▌       | 19/73 [00:00<00:01, 38.24it/s] 32%|███▏      | 23/73 [00:07<00:29,  1.67it/s] 40%|███▉      | 29/73 [00:07<00:15,  2.76it/s] 48%|████▊     | 35/73 [00:08<00:08,  4.23it/s] 56%|█████▌    | 41/73 [00:08<00:05,  6.20it/s] 63%|██████▎   | 46/73 [00:16<00:16,  1.66it/s] 71%|███████   | 52/73 [00:16<00:08,  2.44it/s] 79%|███████▉  | 58/73 [00:16<00:04,  3.52it/s] 86%|████████▋ | 63/73 [00:25<00:07,  1.41it/s] 93%|█████████▎| 68/73 [00:26<00:02,  1.94it/s]100%|██████████| 73/73 [00:31<00:00,  1.45it/s]100%|██████████| 73/73 [00:31<00:00,  2.30it/s]
2025-03-13 12:06:53,026 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:53
2025-03-13 12:09:20,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 147.0084 secs
2025-03-13 12:09:20,035 [INFO]: The best hyperparameters are: efSearch=45
2025-03-13 12:09:20,035 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 12:09:57,718 [INFO]: 	>>> Finished "Compute fast metrics" in 37.6821 secs
2025-03-13 12:09:57,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 216.3749 secs
2025-03-13 12:09:57,719 [INFO]: {
2025-03-13 12:09:57,719 [INFO]: 	index_key: HNSW32
2025-03-13 12:09:57,719 [INFO]: 	index_param: efSearch=45
2025-03-13 12:09:57,719 [INFO]: 	index_path: knn.index
2025-03-13 12:09:57,719 [INFO]: 	size in bytes: 3460365506
2025-03-13 12:09:57,719 [INFO]: 	avg_search_speed_ms: 8.426199543580928
2025-03-13 12:09:57,719 [INFO]: 	99p_search_speed_ms: 14.86362637020648
2025-03-13 12:09:57,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:57,719 [INFO]: 	nb vectors: 17576
2025-03-13 12:09:57,719 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:57,719 [INFO]: 	compression ratio: 0.9986176899545132
2025-03-13 12:09:57,719 [INFO]: }
2025-03-13 12:09:57,719 [INFO]: 	>>> Finished "Creating the index" in 216.3777 secs
2025-03-13 12:09:57,719 [INFO]: >>> Finished "Launching the whole pipeline" in 216.4250 secs
2025-03-13 12:10:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 41993 [episode count 1/20]
[retrieval_preprocessing] for episode 9740 [episode count 2/20], we have num_retrieval=np.int64(17866) num_query=np.int64(702)
2025-03-13 12:10:05,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:08,624 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:08
2025-03-13 12:10:08,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.90it/s]
2025-03-13 12:10:08,672 [INFO]: There are 17866 embeddings of dim 49152
2025-03-13 12:10:08,673 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0478 secs
2025-03-13 12:10:08,673 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:08
2025-03-13 12:10:08,673 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:08,673 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 12:10:08,673 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:10:08,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:10:08,674 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:08
2025-03-13 12:10:08,674 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:08,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:10:08,675 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:08
2025-03-13 12:10:08,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:10:08,675 [INFO]: 	Creating the index 03/13/2025, 12:10:08
2025-03-13 12:10:08,676 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:10:08
2025-03-13 12:10:08,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 12:10:08,679 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:08
2025-03-13 12:10:08,679 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 12:10:08,679 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:12,  5.88it/s]  5%|▌         | 4/74 [00:00<00:04, 16.80it/s] 11%|█         | 8/74 [00:00<00:02, 25.33it/s] 16%|█▌        | 12/74 [00:00<00:02, 29.25it/s] 23%|██▎       | 17/74 [00:00<00:01, 33.55it/s] 28%|██▊       | 21/74 [00:08<00:36,  1.45it/s] 34%|███▍      | 25/74 [00:08<00:23,  2.11it/s] 39%|███▉      | 29/74 [00:08<00:14,  3.02it/s] 45%|████▍     | 33/74 [00:08<00:09,  4.25it/s] 50%|█████     | 37/74 [00:08<00:06,  5.86it/s] 55%|█████▌    | 41/74 [00:09<00:04,  7.85it/s] 61%|██████    | 45/74 [00:18<00:22,  1.29it/s] 69%|██████▉   | 51/74 [00:18<00:10,  2.09it/s] 74%|███████▍  | 55/74 [00:18<00:06,  2.82it/s] 82%|████████▏ | 61/74 [00:18<00:02,  4.34it/s] 88%|████████▊ | 65/74 [00:27<00:07,  1.28it/s] 92%|█████████▏| 68/74 [00:28<00:03,  1.59it/s] 96%|█████████▌| 71/74 [00:28<00:01,  2.00it/s] 99%|█████████▊| 73/74 [00:28<00:00,  2.36it/s]100%|██████████| 74/74 [00:34<00:00,  2.14it/s]
2025-03-13 12:10:43,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:43
2025-03-13 12:13:13,354 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 150.0970 secs
2025-03-13 12:13:13,354 [INFO]: The best hyperparameters are: efSearch=41
2025-03-13 12:13:13,354 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 12:13:49,601 [INFO]: 	>>> Finished "Compute fast metrics" in 36.2468 secs
2025-03-13 12:13:49,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 220.9246 secs
2025-03-13 12:13:49,604 [INFO]: {
2025-03-13 12:13:49,604 [INFO]: 	index_key: HNSW32
2025-03-13 12:13:49,604 [INFO]: 	index_param: efSearch=41
2025-03-13 12:13:49,604 [INFO]: 	index_path: knn.index
2025-03-13 12:13:49,604 [INFO]: 	size in bytes: 3517460570
2025-03-13 12:13:49,604 [INFO]: 	avg_search_speed_ms: 9.089085417799652
2025-03-13 12:13:49,604 [INFO]: 	99p_search_speed_ms: 17.178653846494853
2025-03-13 12:13:49,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:49,604 [INFO]: 	nb vectors: 17866
2025-03-13 12:13:49,604 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:49,604 [INFO]: 	compression ratio: 0.9986177408663888
2025-03-13 12:13:49,604 [INFO]: }
2025-03-13 12:13:49,604 [INFO]: 	>>> Finished "Creating the index" in 220.9284 secs
2025-03-13 12:13:49,604 [INFO]: >>> Finished "Launching the whole pipeline" in 220.9793 secs
2025-03-13 12:13:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 9740 [episode count 2/20]
[retrieval_preprocessing] for episode 93199 [episode count 3/20], we have num_retrieval=np.int64(17359) num_query=np.int64(1209)
2025-03-13 12:13:56,133 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:58,785 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:58
2025-03-13 12:13:58,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.68it/s]
2025-03-13 12:13:58,817 [INFO]: There are 17359 embeddings of dim 49152
2025-03-13 12:13:58,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 12:13:58,817 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:58
2025-03-13 12:13:58,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:58,817 [INFO]: 		-> Add: 9.5 seconds
2025-03-13 12:13:58,817 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:13:58,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:58,818 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:58
2025-03-13 12:13:58,818 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:58,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:13:58,818 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:58
2025-03-13 12:13:58,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:58,818 [INFO]: 	Creating the index 03/13/2025, 12:13:58
2025-03-13 12:13:58,818 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:13:58
2025-03-13 12:13:58,819 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:13:58,819 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:58
2025-03-13 12:13:58,819 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:13:58,819 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:09,  7.79it/s]  7%|▋         | 5/72 [00:00<00:02, 23.22it/s] 14%|█▍        | 10/72 [00:00<00:01, 32.16it/s] 21%|██        | 15/72 [00:00<00:01, 37.13it/s] 28%|██▊       | 20/72 [00:00<00:01, 39.78it/s] 35%|███▍      | 25/72 [00:07<00:25,  1.81it/s] 42%|████▏     | 30/72 [00:08<00:15,  2.70it/s] 49%|████▊     | 35/72 [00:08<00:09,  3.90it/s] 56%|█████▌    | 40/72 [00:08<00:05,  5.51it/s] 62%|██████▎   | 45/72 [00:17<00:18,  1.44it/s] 67%|██████▋   | 48/72 [00:17<00:13,  1.77it/s] 71%|███████   | 51/72 [00:17<00:09,  2.21it/s] 75%|███████▌  | 54/72 [00:18<00:06,  2.78it/s] 78%|███████▊  | 56/72 [00:18<00:04,  3.26it/s] 81%|████████  | 58/72 [00:18<00:03,  3.90it/s] 83%|████████▎ | 60/72 [00:18<00:02,  4.67it/s] 86%|████████▌ | 62/72 [00:18<00:01,  5.60it/s] 89%|████████▉ | 64/72 [00:29<00:12,  1.52s/it] 97%|█████████▋| 70/72 [00:29<00:01,  1.38it/s]100%|██████████| 72/72 [00:34<00:00,  2.11it/s]
2025-03-13 12:14:32,972 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:32
2025-03-13 12:17:13,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 160.5468 secs
2025-03-13 12:17:13,520 [INFO]: The best hyperparameters are: efSearch=46
2025-03-13 12:17:13,520 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 12:17:48,617 [INFO]: 	>>> Finished "Compute fast metrics" in 35.0972 secs
2025-03-13 12:17:48,619 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 229.8002 secs
2025-03-13 12:17:48,620 [INFO]: {
2025-03-13 12:17:48,620 [INFO]: 	index_key: HNSW32
2025-03-13 12:17:48,620 [INFO]: 	index_param: efSearch=46
2025-03-13 12:17:48,620 [INFO]: 	index_path: knn.index
2025-03-13 12:17:48,620 [INFO]: 	size in bytes: 3417642902
2025-03-13 12:17:48,620 [INFO]: 	avg_search_speed_ms: 10.449746005916374
2025-03-13 12:17:48,620 [INFO]: 	99p_search_speed_ms: 21.94274995476007
2025-03-13 12:17:48,620 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:48,620 [INFO]: 	nb vectors: 17359
2025-03-13 12:17:48,620 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:48,620 [INFO]: 	compression ratio: 0.9986175764597187
2025-03-13 12:17:48,620 [INFO]: }
2025-03-13 12:17:48,620 [INFO]: 	>>> Finished "Creating the index" in 229.8018 secs
2025-03-13 12:17:48,620 [INFO]: >>> Finished "Launching the whole pipeline" in 229.8346 secs
2025-03-13 12:17:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 93199 [episode count 3/20]
[retrieval_preprocessing] for episode 15896 [episode count 4/20], we have num_retrieval=np.int64(17159) num_query=np.int64(1409)
2025-03-13 12:18:02,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:05,304 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:05
2025-03-13 12:18:05,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.48it/s]
2025-03-13 12:18:05,332 [INFO]: There are 17159 embeddings of dim 49152
2025-03-13 12:18:05,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:18:05,332 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:05
2025-03-13 12:18:05,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:05,333 [INFO]: 		-> Add: 9.4 seconds
2025-03-13 12:18:05,333 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:18:05,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:05,333 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:05
2025-03-13 12:18:05,333 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:05,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:18:05,333 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:05
2025-03-13 12:18:05,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:05,333 [INFO]: 	Creating the index 03/13/2025, 12:18:05
2025-03-13 12:18:05,333 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:18:05
2025-03-13 12:18:05,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:18:05,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:05
2025-03-13 12:18:05,334 [INFO]: The memory available for adding the vectors is 46.9GB(total available - used by the index)
2025-03-13 12:18:05,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/71 [00:00<?, ?it/s]  1%|▏         | 1/71 [00:00<00:18,  3.81it/s]  3%|▎         | 2/71 [00:00<00:11,  5.81it/s]  4%|▍         | 3/71 [00:00<00:09,  7.12it/s]  6%|▌         | 4/71 [00:00<00:08,  7.88it/s]  7%|▋         | 5/71 [00:00<00:07,  8.45it/s] 10%|▉         | 7/71 [00:00<00:06,  9.40it/s] 13%|█▎        | 9/71 [00:01<00:06, 10.03it/s] 15%|█▌        | 11/71 [00:01<00:05, 10.26it/s] 18%|█▊        | 13/71 [00:01<00:05, 10.38it/s] 21%|██        | 15/71 [00:01<00:05, 10.56it/s] 24%|██▍       | 17/71 [00:01<00:05, 10.65it/s] 27%|██▋       | 19/71 [00:01<00:04, 10.87it/s] 30%|██▉       | 21/71 [00:09<01:05,  1.31s/it] 31%|███       | 22/71 [00:10<00:53,  1.09s/it] 34%|███▍      | 24/71 [00:10<00:35,  1.32it/s] 35%|███▌      | 25/71 [00:10<00:28,  1.59it/s] 37%|███▋      | 26/71 [00:10<00:23,  1.94it/s] 38%|███▊      | 27/71 [00:10<00:18,  2.39it/s] 39%|███▉      | 28/71 [00:10<00:14,  2.93it/s] 41%|████      | 29/71 [00:10<00:11,  3.57it/s] 42%|████▏     | 30/71 [00:10<00:09,  4.27it/s] 44%|████▎     | 31/71 [00:11<00:07,  5.01it/s] 45%|████▌     | 32/71 [00:11<00:06,  5.72it/s] 46%|████▋     | 33/71 [00:11<00:05,  6.36it/s] 48%|████▊     | 34/71 [00:11<00:05,  6.98it/s] 49%|████▉     | 35/71 [00:11<00:04,  7.56it/s] 51%|█████     | 36/71 [00:11<00:04,  7.87it/s] 54%|█████▎    | 38/71 [00:11<00:03,  8.95it/s] 55%|█████▍    | 39/71 [00:11<00:03,  8.54it/s] 56%|█████▋    | 40/71 [00:12<00:03,  8.66it/s] 58%|█████▊    | 41/71 [00:12<00:03,  8.51it/s] 59%|█████▉    | 42/71 [00:20<01:11,  2.45s/it] 61%|██████    | 43/71 [00:20<00:50,  1.79s/it] 63%|██████▎   | 45/71 [00:21<00:26,  1.03s/it] 66%|██████▌   | 47/71 [00:21<00:15,  1.51it/s] 68%|██████▊   | 48/71 [00:21<00:12,  1.84it/s] 69%|██████▉   | 49/71 [00:21<00:09,  2.27it/s] 70%|███████   | 50/71 [00:21<00:07,  2.81it/s] 72%|███████▏  | 51/71 [00:21<00:05,  3.47it/s] 73%|███████▎  | 52/71 [00:21<00:04,  4.21it/s] 75%|███████▍  | 53/71 [00:21<00:03,  4.90it/s] 76%|███████▌  | 54/71 [00:21<00:03,  5.59it/s] 77%|███████▋  | 55/71 [00:22<00:02,  6.18it/s] 79%|███████▉  | 56/71 [00:22<00:02,  6.72it/s] 80%|████████  | 57/71 [00:22<00:01,  7.05it/s] 82%|████████▏ | 58/71 [00:22<00:01,  7.27it/s] 83%|████████▎ | 59/71 [00:22<00:01,  7.43it/s] 85%|████████▍ | 60/71 [00:22<00:01,  7.57it/s] 86%|████████▌ | 61/71 [00:22<00:01,  7.73it/s] 87%|████████▋ | 62/71 [00:22<00:01,  7.82it/s] 89%|████████▊ | 63/71 [00:33<00:25,  3.25s/it] 90%|█████████ | 64/71 [00:33<00:16,  2.31s/it] 93%|█████████▎| 66/71 [00:33<00:06,  1.29s/it] 94%|█████████▍| 67/71 [00:33<00:03,  1.00it/s] 96%|█████████▌| 68/71 [00:34<00:02,  1.31it/s] 97%|█████████▋| 69/71 [00:34<00:01,  1.71it/s] 99%|█████████▊| 70/71 [00:34<00:00,  2.21it/s]100%|██████████| 71/71 [00:39<00:00,  1.73s/it]100%|██████████| 71/71 [00:39<00:00,  1.81it/s]
2025-03-13 12:18:44,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:44
2025-03-13 12:20:51,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 126.5867 secs
2025-03-13 12:20:51,122 [INFO]: The best hyperparameters are: efSearch=55
2025-03-13 12:20:51,122 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 12:21:18,339 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2164 secs
2025-03-13 12:21:18,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 193.0062 secs
2025-03-13 12:21:18,341 [INFO]: {
2025-03-13 12:21:18,341 [INFO]: 	index_key: HNSW32
2025-03-13 12:21:18,341 [INFO]: 	index_param: efSearch=55
2025-03-13 12:21:18,341 [INFO]: 	index_path: knn.index
2025-03-13 12:21:18,341 [INFO]: 	size in bytes: 3378267446
2025-03-13 12:21:18,341 [INFO]: 	avg_search_speed_ms: 10.163747562129595
2025-03-13 12:21:18,341 [INFO]: 	99p_search_speed_ms: 21.07552943751215
2025-03-13 12:21:18,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:18,341 [INFO]: 	nb vectors: 17159
2025-03-13 12:21:18,341 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:18,341 [INFO]: 	compression ratio: 0.9986174054971491
2025-03-13 12:21:18,341 [INFO]: }
2025-03-13 12:21:18,341 [INFO]: 	>>> Finished "Creating the index" in 193.0078 secs
2025-03-13 12:21:18,341 [INFO]: >>> Finished "Launching the whole pipeline" in 193.0368 secs
2025-03-13 12:21:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 15896 [episode count 4/20]
[retrieval_preprocessing] for episode 64545 [episode count 5/20], we have num_retrieval=np.int64(17719) num_query=np.int64(849)
2025-03-13 12:21:33,656 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:36,102 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:36
2025-03-13 12:21:36,102 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.03it/s]
2025-03-13 12:21:36,130 [INFO]: There are 17719 embeddings of dim 49152
2025-03-13 12:21:36,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:21:36,130 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:36
2025-03-13 12:21:36,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:36,130 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:21:36,130 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:21:36,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:21:36,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:36
2025-03-13 12:21:36,130 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:36,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:21:36,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:36
2025-03-13 12:21:36,131 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:36,131 [INFO]: 	Creating the index 03/13/2025, 12:21:36
2025-03-13 12:21:36,131 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:21:36
2025-03-13 12:21:36,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 12:21:36,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:36
2025-03-13 12:21:36,132 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:21:36,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:14,  4.81it/s]  4%|▍         | 3/73 [00:00<00:07,  9.22it/s]  7%|▋         | 5/73 [00:00<00:06, 11.14it/s] 10%|▉         | 7/73 [00:00<00:05, 11.65it/s] 12%|█▏        | 9/73 [00:00<00:05, 12.04it/s] 15%|█▌        | 11/73 [00:00<00:05, 12.24it/s] 18%|█▊        | 13/73 [00:01<00:04, 12.42it/s] 21%|██        | 15/73 [00:01<00:04, 12.59it/s] 23%|██▎       | 17/73 [00:01<00:04, 12.55it/s] 26%|██▌       | 19/73 [00:01<00:04, 12.62it/s] 29%|██▉       | 21/73 [00:08<01:01,  1.19s/it] 30%|███       | 22/73 [00:09<00:50,  1.00it/s] 33%|███▎      | 24/73 [00:09<00:33,  1.45it/s] 36%|███▌      | 26/73 [00:09<00:23,  2.03it/s] 38%|███▊      | 28/73 [00:09<00:16,  2.75it/s] 41%|████      | 30/73 [00:09<00:11,  3.61it/s] 44%|████▍     | 32/73 [00:09<00:08,  4.63it/s] 47%|████▋     | 34/73 [00:10<00:06,  5.68it/s] 49%|████▉     | 36/73 [00:10<00:05,  6.75it/s] 52%|█████▏    | 38/73 [00:10<00:04,  7.79it/s] 55%|█████▍    | 40/73 [00:10<00:03,  8.81it/s] 58%|█████▊    | 42/73 [00:19<00:46,  1.49s/it] 62%|██████▏   | 45/73 [00:20<00:25,  1.09it/s] 66%|██████▌   | 48/73 [00:20<00:15,  1.66it/s] 70%|██████▉   | 51/73 [00:20<00:09,  2.44it/s] 74%|███████▍  | 54/73 [00:20<00:05,  3.48it/s] 78%|███████▊  | 57/73 [00:20<00:03,  4.83it/s] 82%|████████▏ | 60/73 [00:20<00:02,  6.49it/s] 86%|████████▋ | 63/73 [00:31<00:12,  1.22s/it] 88%|████████▊ | 64/73 [00:31<00:09,  1.08s/it] 92%|█████████▏| 67/73 [00:31<00:04,  1.34it/s] 95%|█████████▍| 69/73 [00:32<00:02,  1.70it/s] 97%|█████████▋| 71/73 [00:32<00:00,  2.16it/s]100%|██████████| 73/73 [00:38<00:00,  1.14s/it]100%|██████████| 73/73 [00:38<00:00,  1.91it/s]
2025-03-13 12:22:14,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:14
2025-03-13 12:24:50,803 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 156.3549 secs
2025-03-13 12:24:50,803 [INFO]: The best hyperparameters are: efSearch=50
2025-03-13 12:24:50,803 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 12:25:22,669 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8651 secs
2025-03-13 12:25:22,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 226.6841 secs
2025-03-13 12:25:22,817 [INFO]: {
2025-03-13 12:25:22,817 [INFO]: 	index_key: HNSW32
2025-03-13 12:25:22,817 [INFO]: 	index_param: efSearch=50
2025-03-13 12:25:22,817 [INFO]: 	index_path: knn.index
2025-03-13 12:25:22,817 [INFO]: 	size in bytes: 3488519542
2025-03-13 12:25:22,817 [INFO]: 	avg_search_speed_ms: 12.145029168148769
2025-03-13 12:25:22,817 [INFO]: 	99p_search_speed_ms: 22.22996421158313
2025-03-13 12:25:22,817 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:22,817 [INFO]: 	nb vectors: 17719
2025-03-13 12:25:22,817 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:22,817 [INFO]: 	compression ratio: 0.9986176399639042
2025-03-13 12:25:22,817 [INFO]: }
2025-03-13 12:25:22,817 [INFO]: 	>>> Finished "Creating the index" in 226.6868 secs
2025-03-13 12:25:22,818 [INFO]: >>> Finished "Launching the whole pipeline" in 226.7158 secs
2025-03-13 12:25:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 64545 [episode count 5/20]
[retrieval_preprocessing] for episode 45633 [episode count 6/20], we have num_retrieval=np.int64(17563) num_query=np.int64(1005)
2025-03-13 12:25:34,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:37,291 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:37
2025-03-13 12:25:37,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.07it/s]
2025-03-13 12:25:37,317 [INFO]: There are 17563 embeddings of dim 49152
2025-03-13 12:25:37,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:25:37,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:37
2025-03-13 12:25:37,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:37,318 [INFO]: 		-> Add: 9.6 seconds
2025-03-13 12:25:37,318 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:25:37,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:37,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:37
2025-03-13 12:25:37,318 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:37,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:25:37,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:37
2025-03-13 12:25:37,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:37,318 [INFO]: 	Creating the index 03/13/2025, 12:25:37
2025-03-13 12:25:37,318 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:25:37
2025-03-13 12:25:37,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:25:37,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:37
2025-03-13 12:25:37,319 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:25:37,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:13,  5.53it/s]  7%|▋         | 5/73 [00:00<00:03, 19.97it/s] 12%|█▏        | 9/73 [00:00<00:02, 27.02it/s] 18%|█▊        | 13/73 [00:00<00:01, 31.13it/s] 23%|██▎       | 17/73 [00:00<00:01, 33.62it/s] 29%|██▉       | 21/73 [00:09<00:41,  1.24it/s] 33%|███▎      | 24/73 [00:09<00:29,  1.64it/s] 36%|███▌      | 26/73 [00:09<00:23,  1.99it/s] 38%|███▊      | 28/73 [00:10<00:18,  2.46it/s] 41%|████      | 30/73 [00:10<00:14,  3.06it/s] 44%|████▍     | 32/73 [00:10<00:10,  3.80it/s] 47%|████▋     | 34/73 [00:10<00:08,  4.73it/s] 49%|████▉     | 36/73 [00:10<00:06,  5.72it/s] 52%|█████▏    | 38/73 [00:10<00:05,  6.74it/s] 55%|█████▍    | 40/73 [00:11<00:04,  7.72it/s] 58%|█████▊    | 42/73 [00:21<00:48,  1.56s/it] 62%|██████▏   | 45/73 [00:21<00:27,  1.03it/s] 66%|██████▌   | 48/73 [00:21<00:16,  1.56it/s] 70%|██████▉   | 51/73 [00:21<00:09,  2.29it/s] 74%|███████▍  | 54/73 [00:21<00:05,  3.25it/s] 78%|███████▊  | 57/73 [00:21<00:03,  4.52it/s] 82%|████████▏ | 60/73 [00:21<00:02,  6.12it/s] 86%|████████▋ | 63/73 [00:31<00:11,  1.15s/it] 88%|████████▊ | 64/73 [00:31<00:09,  1.02s/it] 92%|█████████▏| 67/73 [00:32<00:04,  1.45it/s] 95%|█████████▍| 69/73 [00:32<00:02,  1.84it/s] 97%|█████████▋| 71/73 [00:32<00:00,  2.34it/s]100%|██████████| 73/73 [00:38<00:00,  1.14s/it]100%|██████████| 73/73 [00:38<00:00,  1.88it/s]
2025-03-13 12:26:16,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:16
2025-03-13 12:28:48,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 152.7893 secs
2025-03-13 12:28:48,855 [INFO]: The best hyperparameters are: efSearch=48
2025-03-13 12:28:48,856 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 12:29:32,637 [INFO]: 	>>> Finished "Compute fast metrics" in 43.7815 secs
2025-03-13 12:29:32,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 235.3199 secs
2025-03-13 12:29:32,639 [INFO]: {
2025-03-13 12:29:32,639 [INFO]: 	index_key: HNSW32
2025-03-13 12:29:32,639 [INFO]: 	index_param: efSearch=48
2025-03-13 12:29:32,639 [INFO]: 	index_path: knn.index
2025-03-13 12:29:32,639 [INFO]: 	size in bytes: 3457806118
2025-03-13 12:29:32,639 [INFO]: 	avg_search_speed_ms: 10.949429824870785
2025-03-13 12:29:32,639 [INFO]: 	99p_search_speed_ms: 19.81152401305735
2025-03-13 12:29:32,639 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:32,640 [INFO]: 	nb vectors: 17563
2025-03-13 12:29:32,640 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:32,640 [INFO]: 	compression ratio: 0.9986176743759234
2025-03-13 12:29:32,640 [INFO]: }
2025-03-13 12:29:32,640 [INFO]: 	>>> Finished "Creating the index" in 235.3216 secs
2025-03-13 12:29:32,640 [INFO]: >>> Finished "Launching the whole pipeline" in 235.3487 secs
2025-03-13 12:29:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 45633 [episode count 6/20]
[retrieval_preprocessing] for episode 59969 [episode count 7/20], we have num_retrieval=np.int64(18067) num_query=np.int64(501)
2025-03-13 12:29:45,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:49,142 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:49
2025-03-13 12:29:49,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.57it/s]
2025-03-13 12:29:49,174 [INFO]: There are 18067 embeddings of dim 49152
2025-03-13 12:29:49,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 12:29:49,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:49
2025-03-13 12:29:49,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:49,175 [INFO]: 		-> Add: 9.9 seconds
2025-03-13 12:29:49,175 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:29:49,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:29:49,175 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:49
2025-03-13 12:29:49,175 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:49,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 12:29:49,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:49
2025-03-13 12:29:49,176 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:29:49,176 [INFO]: 	Creating the index 03/13/2025, 12:29:49
2025-03-13 12:29:49,177 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:29:49
2025-03-13 12:29:49,179 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0023 secs
2025-03-13 12:29:49,180 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:49
2025-03-13 12:29:49,180 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 12:29:49,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/75 [00:00<?, ?it/s]  1%|▏         | 1/75 [00:00<00:11,  6.55it/s]  7%|▋         | 5/75 [00:00<00:03, 21.31it/s] 12%|█▏        | 9/75 [00:00<00:02, 27.33it/s] 17%|█▋        | 13/75 [00:00<00:02, 29.66it/s] 23%|██▎       | 17/75 [00:00<00:01, 31.33it/s] 28%|██▊       | 21/75 [00:08<00:38,  1.40it/s] 33%|███▎      | 25/75 [00:08<00:24,  2.07it/s] 37%|███▋      | 28/75 [00:08<00:17,  2.70it/s] 41%|████▏     | 31/75 [00:09<00:13,  3.34it/s] 44%|████▍     | 33/75 [00:09<00:10,  3.84it/s] 47%|████▋     | 35/75 [00:09<00:09,  4.40it/s] 49%|████▉     | 37/75 [00:09<00:07,  4.99it/s] 52%|█████▏    | 39/75 [00:09<00:06,  5.59it/s] 55%|█████▍    | 41/75 [00:10<00:05,  6.08it/s] 57%|█████▋    | 43/75 [00:20<00:48,  1.53s/it] 60%|██████    | 45/75 [00:20<00:33,  1.12s/it] 63%|██████▎   | 47/75 [00:20<00:22,  1.22it/s] 65%|██████▌   | 49/75 [00:20<00:15,  1.65it/s] 68%|██████▊   | 51/75 [00:21<00:10,  2.19it/s] 71%|███████   | 53/75 [00:21<00:07,  2.90it/s] 73%|███████▎  | 55/75 [00:21<00:05,  3.76it/s] 76%|███████▌  | 57/75 [00:21<00:03,  4.76it/s] 79%|███████▊  | 59/75 [00:21<00:02,  5.78it/s] 81%|████████▏ | 61/75 [00:21<00:02,  6.73it/s] 84%|████████▍ | 63/75 [00:32<00:20,  1.69s/it] 85%|████████▌ | 64/75 [00:32<00:15,  1.41s/it] 88%|████████▊ | 66/75 [00:32<00:08,  1.03it/s] 91%|█████████ | 68/75 [00:32<00:04,  1.45it/s] 93%|█████████▎| 70/75 [00:33<00:02,  1.99it/s] 96%|█████████▌| 72/75 [00:33<00:01,  2.66it/s] 99%|█████████▊| 74/75 [00:33<00:00,  3.45it/s]100%|██████████| 75/75 [00:40<00:00,  1.87it/s]
2025-03-13 12:30:29,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:29
2025-03-13 12:32:42,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 132.9798 secs
2025-03-13 12:32:42,168 [INFO]: The best hyperparameters are: efSearch=58
2025-03-13 12:32:42,168 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
2025-03-13 12:33:28,685 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5176 secs
2025-03-13 12:33:29,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 220.1514 secs
2025-03-13 12:33:29,331 [INFO]: {
2025-03-13 12:33:29,332 [INFO]: 	index_key: HNSW32
2025-03-13 12:33:29,332 [INFO]: 	index_param: efSearch=58
2025-03-13 12:33:29,332 [INFO]: 	index_path: knn.index
2025-03-13 12:33:29,332 [INFO]: 	size in bytes: 3557033286
2025-03-13 12:33:29,332 [INFO]: 	avg_search_speed_ms: 10.470582494092861
2025-03-13 12:33:29,332 [INFO]: 	99p_search_speed_ms: 21.991024492308505
2025-03-13 12:33:29,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:29,332 [INFO]: 	nb vectors: 18067
2025-03-13 12:33:29,332 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:29,332 [INFO]: 	compression ratio: 0.9986177947731468
2025-03-13 12:33:29,332 [INFO]: }
2025-03-13 12:33:29,332 [INFO]: 	>>> Finished "Creating the index" in 220.1555 secs
2025-03-13 12:33:29,332 [INFO]: >>> Finished "Launching the whole pipeline" in 220.1899 secs
2025-03-13 12:33:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 59969 [episode count 7/20]
[retrieval_preprocessing] for episode 44613 [episode count 8/20], we have num_retrieval=np.int64(17592) num_query=np.int64(976)
2025-03-13 12:33:38,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:41,808 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:41
2025-03-13 12:33:41,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2318.58it/s]
2025-03-13 12:33:41,830 [INFO]: There are 17592 embeddings of dim 49152
2025-03-13 12:33:41,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 12:33:41,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:41
2025-03-13 12:33:41,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:41,831 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:33:41,831 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:33:41,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:41,831 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:41
2025-03-13 12:33:41,831 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:41,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:33:41,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:41
2025-03-13 12:33:41,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:41,831 [INFO]: 	Creating the index 03/13/2025, 12:33:41
2025-03-13 12:33:41,831 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:33:41
2025-03-13 12:33:41,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 12:33:41,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:41
2025-03-13 12:33:41,832 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:33:41,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:18,  3.90it/s]  3%|▎         | 2/73 [00:00<00:12,  5.72it/s]  4%|▍         | 3/73 [00:00<00:10,  6.84it/s]  5%|▌         | 4/73 [00:00<00:09,  7.45it/s]  7%|▋         | 5/73 [00:00<00:08,  7.81it/s]  8%|▊         | 6/73 [00:00<00:08,  8.07it/s] 10%|▉         | 7/73 [00:00<00:08,  8.19it/s] 11%|█         | 8/73 [00:01<00:07,  8.38it/s] 12%|█▏        | 9/73 [00:01<00:07,  8.49it/s] 14%|█▎        | 10/73 [00:01<00:07,  8.63it/s] 16%|█▋        | 12/73 [00:01<00:05, 10.98it/s] 19%|█▉        | 14/73 [00:01<00:05, 10.05it/s] 22%|██▏       | 16/73 [00:01<00:05,  9.66it/s] 25%|██▍       | 18/73 [00:02<00:05, 10.26it/s] 27%|██▋       | 20/73 [00:02<00:04, 10.60it/s] 30%|███       | 22/73 [00:08<00:55,  1.09s/it] 34%|███▍      | 25/73 [00:08<00:32,  1.49it/s] 37%|███▋      | 27/73 [00:08<00:23,  1.97it/s] 40%|███▉      | 29/73 [00:09<00:17,  2.58it/s] 42%|████▏     | 31/73 [00:09<00:12,  3.31it/s] 45%|████▌     | 33/73 [00:09<00:09,  4.20it/s] 48%|████▊     | 35/73 [00:09<00:07,  5.39it/s] 51%|█████     | 37/73 [00:09<00:05,  6.35it/s] 53%|█████▎    | 39/73 [00:10<00:04,  7.24it/s] 56%|█████▌    | 41/73 [00:10<00:03,  8.17it/s] 59%|█████▉    | 43/73 [00:18<00:40,  1.35s/it] 62%|██████▏   | 45/73 [00:18<00:27,  1.03it/s] 64%|██████▍   | 47/73 [00:19<00:18,  1.41it/s] 67%|██████▋   | 49/73 [00:19<00:12,  1.92it/s] 70%|██████▉   | 51/73 [00:19<00:08,  2.57it/s] 73%|███████▎  | 53/73 [00:19<00:05,  3.42it/s] 75%|███████▌  | 55/73 [00:19<00:04,  4.43it/s] 78%|███████▊  | 57/73 [00:19<00:02,  5.59it/s] 81%|████████  | 59/73 [00:19<00:02,  6.77it/s] 84%|████████▎ | 61/73 [00:20<00:01,  7.86it/s] 86%|████████▋ | 63/73 [00:29<00:14,  1.43s/it] 88%|████████▊ | 64/73 [00:29<00:10,  1.20s/it] 89%|████████▉ | 65/73 [00:29<00:07,  1.01it/s] 90%|█████████ | 66/73 [00:29<00:05,  1.26it/s] 92%|█████████▏| 67/73 [00:29<00:03,  1.58it/s] 93%|█████████▎| 68/73 [00:29<00:02,  1.98it/s] 95%|█████████▍| 69/73 [00:29<00:01,  2.47it/s] 96%|█████████▌| 70/73 [00:29<00:00,  3.04it/s] 97%|█████████▋| 71/73 [00:30<00:00,  3.70it/s] 99%|█████████▊| 72/73 [00:30<00:00,  4.37it/s]100%|██████████| 73/73 [00:34<00:00,  1.54s/it]100%|██████████| 73/73 [00:34<00:00,  2.09it/s]
2025-03-13 12:34:16,746 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:16
2025-03-13 12:36:40,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 143.5080 secs
2025-03-13 12:36:40,255 [INFO]: The best hyperparameters are: efSearch=64
2025-03-13 12:36:40,255 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 12:37:24,949 [INFO]: 	>>> Finished "Compute fast metrics" in 44.6935 secs
2025-03-13 12:37:25,127 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 223.2950 secs
2025-03-13 12:37:25,128 [INFO]: {
2025-03-13 12:37:25,128 [INFO]: 	index_key: HNSW32
2025-03-13 12:37:25,128 [INFO]: 	index_param: efSearch=64
2025-03-13 12:37:25,128 [INFO]: 	index_path: knn.index
2025-03-13 12:37:25,128 [INFO]: 	size in bytes: 3463515650
2025-03-13 12:37:25,128 [INFO]: 	avg_search_speed_ms: 11.21288478022625
2025-03-13 12:37:25,128 [INFO]: 	99p_search_speed_ms: 19.343325351364918
2025-03-13 12:37:25,128 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:25,128 [INFO]: 	nb vectors: 17592
2025-03-13 12:37:25,128 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:25,128 [INFO]: 	compression ratio: 0.9986176721909716
2025-03-13 12:37:25,128 [INFO]: }
2025-03-13 12:37:25,128 [INFO]: 	>>> Finished "Creating the index" in 223.2971 secs
2025-03-13 12:37:25,128 [INFO]: >>> Finished "Launching the whole pipeline" in 223.3203 secs
2025-03-13 12:37:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 44613 [episode count 8/20]
[retrieval_preprocessing] for episode 87623 [episode count 9/20], we have num_retrieval=np.int64(17805) num_query=np.int64(763)
2025-03-13 12:37:39,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:41,748 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:41
2025-03-13 12:37:41,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1196.32it/s]
2025-03-13 12:37:41,777 [INFO]: There are 17805 embeddings of dim 49152
2025-03-13 12:37:41,777 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 12:37:41,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:41
2025-03-13 12:37:41,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:41,778 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 12:37:41,778 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:37:41,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:37:41,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:41
2025-03-13 12:37:41,779 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:41,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:37:41,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:41
2025-03-13 12:37:41,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:37:41,780 [INFO]: 	Creating the index 03/13/2025, 12:37:41
2025-03-13 12:37:41,780 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:37:41
2025-03-13 12:37:41,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 12:37:41,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:41
2025-03-13 12:37:41,783 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 12:37:41,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:16,  4.54it/s]  4%|▍         | 3/74 [00:00<00:08,  7.95it/s]  7%|▋         | 5/74 [00:00<00:07,  9.41it/s]  9%|▉         | 7/74 [00:00<00:06, 10.62it/s] 12%|█▏        | 9/74 [00:00<00:05, 11.48it/s] 15%|█▍        | 11/74 [00:01<00:05, 11.93it/s] 18%|█▊        | 13/74 [00:01<00:04, 12.31it/s] 20%|██        | 15/74 [00:01<00:04, 12.50it/s] 23%|██▎       | 17/74 [00:01<00:04, 12.90it/s] 26%|██▌       | 19/74 [00:01<00:04, 13.62it/s] 28%|██▊       | 21/74 [00:08<01:02,  1.17s/it] 34%|███▍      | 25/74 [00:09<00:31,  1.57it/s] 39%|███▉      | 29/74 [00:09<00:17,  2.55it/s] 43%|████▎     | 32/74 [00:09<00:12,  3.28it/s] 47%|████▋     | 35/74 [00:09<00:09,  3.95it/s] 50%|█████     | 37/74 [00:10<00:08,  4.43it/s] 53%|█████▎    | 39/74 [00:10<00:07,  4.94it/s] 55%|█████▌    | 41/74 [00:10<00:06,  5.46it/s] 58%|█████▊    | 43/74 [00:20<00:45,  1.46s/it] 62%|██████▏   | 46/74 [00:20<00:26,  1.06it/s] 66%|██████▌   | 49/74 [00:20<00:15,  1.58it/s] 70%|███████   | 52/74 [00:20<00:09,  2.29it/s] 74%|███████▍  | 55/74 [00:20<00:05,  3.24it/s] 78%|███████▊  | 58/74 [00:21<00:03,  4.49it/s] 82%|████████▏ | 61/74 [00:21<00:02,  6.09it/s] 86%|████████▋ | 64/74 [00:31<00:11,  1.17s/it] 91%|█████████ | 67/74 [00:31<00:05,  1.22it/s] 95%|█████████▍| 70/74 [00:31<00:02,  1.71it/s] 99%|█████████▊| 73/74 [00:31<00:00,  2.39it/s]100%|██████████| 74/74 [00:37<00:00,  1.97it/s]
2025-03-13 12:38:19,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:19
2025-03-13 12:40:44,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 145.0794 secs
2025-03-13 12:40:44,522 [INFO]: The best hyperparameters are: efSearch=50
2025-03-13 12:40:44,522 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-13 12:41:33,452 [INFO]: 	>>> Finished "Compute fast metrics" in 48.9303 secs
2025-03-13 12:41:33,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 231.6714 secs
2025-03-13 12:41:33,455 [INFO]: {
2025-03-13 12:41:33,455 [INFO]: 	index_key: HNSW32
2025-03-13 12:41:33,455 [INFO]: 	index_param: efSearch=50
2025-03-13 12:41:33,455 [INFO]: 	index_path: knn.index
2025-03-13 12:41:33,455 [INFO]: 	size in bytes: 3505451006
2025-03-13 12:41:33,455 [INFO]: 	avg_search_speed_ms: 10.052553652528317
2025-03-13 12:41:33,455 [INFO]: 	99p_search_speed_ms: 15.678291865624484
2025-03-13 12:41:33,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:33,455 [INFO]: 	nb vectors: 17805
2025-03-13 12:41:33,455 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:33,455 [INFO]: 	compression ratio: 0.998617705398904
2025-03-13 12:41:33,455 [INFO]: }
2025-03-13 12:41:33,455 [INFO]: 	>>> Finished "Creating the index" in 231.6750 secs
2025-03-13 12:41:33,455 [INFO]: >>> Finished "Launching the whole pipeline" in 231.7064 secs
2025-03-13 12:41:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 87623 [episode count 9/20]
[retrieval_preprocessing] for episode 70737 [episode count 10/20], we have num_retrieval=np.int64(17737) num_query=np.int64(831)
2025-03-13 12:41:46,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:49,348 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:49
2025-03-13 12:41:49,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-13 12:41:49,396 [INFO]: There are 17737 embeddings of dim 49152
2025-03-13 12:41:49,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0488 secs
2025-03-13 12:41:49,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:49
2025-03-13 12:41:49,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:49,397 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:41:49,397 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:41:49,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:41:49,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:49
2025-03-13 12:41:49,398 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:49,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:41:49,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:49
2025-03-13 12:41:49,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:41:49,398 [INFO]: 	Creating the index 03/13/2025, 12:41:49
2025-03-13 12:41:49,398 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:41:49
2025-03-13 12:41:49,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0022 secs
2025-03-13 12:41:49,401 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:49
2025-03-13 12:41:49,401 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 12:41:49,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:10,  7.02it/s]  5%|▌         | 4/73 [00:02<00:40,  1.71it/s]  7%|▋         | 5/73 [00:02<00:30,  2.20it/s]  8%|▊         | 6/73 [00:02<00:27,  2.40it/s] 12%|█▏        | 9/73 [00:08<01:23,  1.30s/it] 14%|█▎        | 10/73 [00:09<01:09,  1.11s/it] 16%|█▋        | 12/73 [00:09<00:46,  1.30it/s] 18%|█▊        | 13/73 [00:09<00:41,  1.45it/s] 21%|██        | 15/73 [00:10<00:26,  2.19it/s] 22%|██▏       | 16/73 [00:10<00:25,  2.22it/s] 23%|██▎       | 17/73 [00:10<00:23,  2.39it/s] 25%|██▍       | 18/73 [00:10<00:20,  2.75it/s] 26%|██▌       | 19/73 [00:11<00:16,  3.19it/s] 27%|██▋       | 20/73 [00:11<00:14,  3.62it/s] 29%|██▉       | 21/73 [00:19<02:16,  2.62s/it] 30%|███       | 22/73 [00:21<01:53,  2.22s/it] 32%|███▏      | 23/73 [00:24<02:09,  2.59s/it] 33%|███▎      | 24/73 [00:27<02:14,  2.74s/it] 34%|███▍      | 25/73 [00:30<02:04,  2.59s/it] 36%|███▌      | 26/73 [00:30<01:37,  2.08s/it] 37%|███▋      | 27/73 [00:34<01:57,  2.56s/it] 38%|███▊      | 28/73 [00:37<02:04,  2.77s/it] 40%|███▉      | 29/73 [00:40<01:54,  2.61s/it] 41%|████      | 30/73 [00:41<01:35,  2.21s/it] 42%|████▏     | 31/73 [00:42<01:23,  2.00s/it] 49%|████▉     | 36/73 [00:42<00:24,  1.54it/s] 56%|█████▌    | 41/73 [00:43<00:10,  2.94it/s] 60%|██████    | 44/73 [00:53<00:35,  1.23s/it] 63%|██████▎   | 46/73 [00:53<00:26,  1.03it/s] 67%|██████▋   | 49/73 [00:53<00:16,  1.49it/s] 70%|██████▉   | 51/73 [00:53<00:11,  1.88it/s] 73%|███████▎  | 53/73 [00:53<00:08,  2.40it/s] 75%|███████▌  | 55/73 [00:53<00:05,  3.01it/s] 79%|███████▉  | 58/73 [00:53<00:03,  4.30it/s] 82%|████████▏ | 60/73 [00:54<00:02,  4.93it/s] 86%|████████▋ | 63/73 [01:04<00:12,  1.30s/it] 93%|█████████▎| 68/73 [01:04<00:03,  1.40it/s] 97%|█████████▋| 71/73 [01:04<00:01,  1.90it/s]100%|██████████| 73/73 [01:10<00:00,  1.05s/it]100%|██████████| 73/73 [01:10<00:00,  1.04it/s]
2025-03-13 12:42:59,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:59
2025-03-13 12:45:46,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 167.2091 secs
2025-03-13 12:45:46,900 [INFO]: The best hyperparameters are: efSearch=34
2025-03-13 12:45:46,900 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.35it/s]
2025-03-13 12:46:14,164 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2633 secs
2025-03-13 12:46:14,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 264.7651 secs
2025-03-13 12:46:14,166 [INFO]: {
2025-03-13 12:46:14,166 [INFO]: 	index_key: HNSW32
2025-03-13 12:46:14,166 [INFO]: 	index_param: efSearch=34
2025-03-13 12:46:14,166 [INFO]: 	index_path: knn.index
2025-03-13 12:46:14,166 [INFO]: 	size in bytes: 3492063438
2025-03-13 12:46:14,166 [INFO]: 	avg_search_speed_ms: 7.604310745479602
2025-03-13 12:46:14,166 [INFO]: 	99p_search_speed_ms: 14.120579673908642
2025-03-13 12:46:14,166 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:14,166 [INFO]: 	nb vectors: 17737
2025-03-13 12:46:14,166 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:14,166 [INFO]: 	compression ratio: 0.9986176247695074
2025-03-13 12:46:14,166 [INFO]: }
2025-03-13 12:46:14,166 [INFO]: 	>>> Finished "Creating the index" in 264.7682 secs
2025-03-13 12:46:14,167 [INFO]: >>> Finished "Launching the whole pipeline" in 264.8187 secs
2025-03-13 12:46:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 70737 [episode count 10/20]
[retrieval_preprocessing] for episode 5714 [episode count 11/20], we have num_retrieval=np.int64(17697) num_query=np.int64(871)
2025-03-13 12:46:19,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:21,957 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:21
2025-03-13 12:46:21,957 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.50it/s]
2025-03-13 12:46:21,991 [INFO]: There are 17697 embeddings of dim 49152
2025-03-13 12:46:21,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 12:46:21,991 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:21
2025-03-13 12:46:21,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:21,992 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:46:21,992 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:46:21,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:46:21,992 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:21
2025-03-13 12:46:21,992 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:21,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:46:21,992 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:21
2025-03-13 12:46:21,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:21,992 [INFO]: 	Creating the index 03/13/2025, 12:46:21
2025-03-13 12:46:21,992 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:46:21
2025-03-13 12:46:21,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:46:21,993 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:21
2025-03-13 12:46:21,993 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:46:21,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:08,  8.01it/s]  7%|▋         | 5/73 [00:00<00:02, 24.28it/s] 14%|█▎        | 10/73 [00:00<00:01, 34.70it/s] 21%|██        | 15/73 [00:00<00:01, 38.36it/s] 29%|██▉       | 21/73 [00:08<00:31,  1.66it/s] 33%|███▎      | 24/73 [00:08<00:23,  2.09it/s] 37%|███▋      | 27/73 [00:08<00:17,  2.66it/s] 40%|███▉      | 29/73 [00:09<00:13,  3.15it/s] 42%|████▏     | 31/73 [00:09<00:11,  3.76it/s] 45%|████▌     | 33/73 [00:09<00:08,  4.51it/s] 48%|████▊     | 35/73 [00:09<00:07,  5.38it/s] 51%|█████     | 37/73 [00:09<00:05,  6.32it/s] 53%|█████▎    | 39/73 [00:09<00:04,  7.28it/s] 56%|█████▌    | 41/73 [00:10<00:03,  8.24it/s] 59%|█████▉    | 43/73 [00:19<00:45,  1.50s/it] 62%|██████▏   | 45/73 [00:20<00:30,  1.09s/it] 64%|██████▍   | 47/73 [00:20<00:20,  1.27it/s] 67%|██████▋   | 49/73 [00:20<00:13,  1.73it/s] 70%|██████▉   | 51/73 [00:20<00:09,  2.33it/s] 73%|███████▎  | 53/73 [00:20<00:06,  3.10it/s] 75%|███████▌  | 55/73 [00:20<00:04,  4.01it/s] 78%|███████▊  | 57/73 [00:20<00:03,  5.14it/s] 81%|████████  | 59/73 [00:21<00:02,  6.37it/s] 84%|████████▎ | 61/73 [00:21<00:01,  7.55it/s] 86%|████████▋ | 63/73 [00:33<00:18,  1.89s/it] 88%|████████▊ | 64/73 [00:33<00:14,  1.58s/it] 90%|█████████ | 66/73 [00:33<00:07,  1.08s/it] 93%|█████████▎| 68/73 [00:33<00:03,  1.32it/s] 96%|█████████▌| 70/73 [00:33<00:01,  1.84it/s] 99%|█████████▊| 72/73 [00:33<00:00,  2.51it/s]100%|██████████| 73/73 [00:39<00:00,  1.85it/s]
2025-03-13 12:47:01,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:01
2025-03-13 12:49:23,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 141.7157 secs
2025-03-13 12:49:23,132 [INFO]: The best hyperparameters are: efSearch=50
2025-03-13 12:49:23,132 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.99s/it] 50%|█████     | 2/4 [00:06<00:06,  3.21s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.17s/it]
2025-03-13 12:50:03,825 [INFO]: 	>>> Finished "Compute fast metrics" in 40.6929 secs
2025-03-13 12:50:03,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 221.8342 secs
2025-03-13 12:50:03,828 [INFO]: {
2025-03-13 12:50:03,828 [INFO]: 	index_key: HNSW32
2025-03-13 12:50:03,828 [INFO]: 	index_param: efSearch=50
2025-03-13 12:50:03,828 [INFO]: 	index_path: knn.index
2025-03-13 12:50:03,828 [INFO]: 	size in bytes: 3484188270
2025-03-13 12:50:03,828 [INFO]: 	avg_search_speed_ms: 8.318826317176619
2025-03-13 12:50:03,828 [INFO]: 	99p_search_speed_ms: 14.321986266877504
2025-03-13 12:50:03,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:03,828 [INFO]: 	nb vectors: 17697
2025-03-13 12:50:03,828 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:03,828 [INFO]: 	compression ratio: 0.9986176137376181
2025-03-13 12:50:03,828 [INFO]: }
2025-03-13 12:50:03,828 [INFO]: 	>>> Finished "Creating the index" in 221.8358 secs
2025-03-13 12:50:03,828 [INFO]: >>> Finished "Launching the whole pipeline" in 221.8703 secs
2025-03-13 12:50:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 5714 [episode count 11/20]
[retrieval_preprocessing] for episode 67164 [episode count 12/20], we have num_retrieval=np.int64(17630) num_query=np.int64(938)
2025-03-13 12:50:14,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:16,337 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:16
2025-03-13 12:50:16,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-13 12:50:16,367 [INFO]: There are 17630 embeddings of dim 49152
2025-03-13 12:50:16,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 12:50:16,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:16
2025-03-13 12:50:16,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:16,368 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 12:50:16,368 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:50:16,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:50:16,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:16
2025-03-13 12:50:16,368 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:16,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:50:16,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:16
2025-03-13 12:50:16,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:50:16,369 [INFO]: 	Creating the index 03/13/2025, 12:50:16
2025-03-13 12:50:16,370 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:50:16
2025-03-13 12:50:16,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 12:50:16,373 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:16
2025-03-13 12:50:16,373 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:50:16,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:18,  3.89it/s]  3%|▎         | 2/73 [00:00<00:12,  5.47it/s]  4%|▍         | 3/73 [00:00<00:10,  6.69it/s]  5%|▌         | 4/73 [00:00<00:09,  7.43it/s]  7%|▋         | 5/73 [00:00<00:08,  7.91it/s]  8%|▊         | 6/73 [00:00<00:08,  8.30it/s] 10%|▉         | 7/73 [00:00<00:07,  8.54it/s] 11%|█         | 8/73 [00:01<00:07,  8.84it/s] 12%|█▏        | 9/73 [00:01<00:07,  8.93it/s] 14%|█▎        | 10/73 [00:01<00:06,  9.00it/s] 15%|█▌        | 11/73 [00:01<00:06,  9.02it/s] 16%|█▋        | 12/73 [00:01<00:06,  9.07it/s] 18%|█▊        | 13/73 [00:01<00:06,  9.11it/s] 21%|██        | 15/73 [00:01<00:05, 10.14it/s] 23%|██▎       | 17/73 [00:01<00:05, 11.09it/s] 26%|██▌       | 19/73 [00:02<00:04, 11.78it/s] 29%|██▉       | 21/73 [00:08<00:58,  1.13s/it] 32%|███▏      | 23/73 [00:08<00:39,  1.27it/s] 34%|███▍      | 25/73 [00:08<00:26,  1.79it/s] 37%|███▋      | 27/73 [00:08<00:18,  2.45it/s] 40%|███▉      | 29/73 [00:08<00:13,  3.26it/s] 44%|████▍     | 32/73 [00:09<00:08,  4.92it/s] 47%|████▋     | 34/73 [00:09<00:06,  5.90it/s] 49%|████▉     | 36/73 [00:09<00:05,  6.90it/s] 52%|█████▏    | 38/73 [00:09<00:04,  7.93it/s] 55%|█████▍    | 40/73 [00:09<00:03,  8.85it/s] 58%|█████▊    | 42/73 [00:17<00:36,  1.17s/it] 60%|██████    | 44/73 [00:17<00:24,  1.17it/s] 63%|██████▎   | 46/73 [00:17<00:16,  1.61it/s] 66%|██████▌   | 48/73 [00:17<00:11,  2.17it/s] 68%|██████▊   | 50/73 [00:17<00:07,  2.88it/s] 71%|███████   | 52/73 [00:18<00:05,  3.72it/s] 74%|███████▍  | 54/73 [00:18<00:04,  4.70it/s] 77%|███████▋  | 56/73 [00:18<00:02,  5.86it/s] 79%|███████▉  | 58/73 [00:18<00:02,  7.08it/s] 82%|████████▏ | 60/73 [00:18<00:01,  8.12it/s] 85%|████████▍ | 62/73 [00:18<00:01,  9.14it/s] 88%|████████▊ | 64/73 [00:27<00:12,  1.42s/it] 89%|████████▉ | 65/73 [00:27<00:09,  1.19s/it] 90%|█████████ | 66/73 [00:27<00:06,  1.03it/s] 92%|█████████▏| 67/73 [00:28<00:04,  1.28it/s] 93%|█████████▎| 68/73 [00:28<00:03,  1.62it/s] 95%|█████████▍| 69/73 [00:28<00:01,  2.04it/s] 96%|█████████▌| 70/73 [00:28<00:01,  2.56it/s] 97%|█████████▋| 71/73 [00:28<00:00,  3.17it/s] 99%|█████████▊| 72/73 [00:28<00:00,  3.90it/s]100%|██████████| 73/73 [00:34<00:00,  1.74s/it]100%|██████████| 73/73 [00:34<00:00,  2.14it/s]
2025-03-13 12:50:50,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:50
2025-03-13 12:53:22,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 151.5921 secs
2025-03-13 12:53:22,042 [INFO]: The best hyperparameters are: efSearch=58
2025-03-13 12:53:22,042 [INFO]: 	Compute fast metrics 03/13/2025, 12:53:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:13,  4.55s/it] 50%|█████     | 2/4 [00:07<00:07,  3.82s/it] 75%|███████▌  | 3/4 [00:09<00:02,  2.84s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.22s/it]
2025-03-13 12:54:07,302 [INFO]: 	>>> Finished "Compute fast metrics" in 45.2595 secs
2025-03-13 12:54:07,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 230.9312 secs
2025-03-13 12:54:07,304 [INFO]: {
2025-03-13 12:54:07,304 [INFO]: 	index_key: HNSW32
2025-03-13 12:54:07,304 [INFO]: 	index_param: efSearch=58
2025-03-13 12:54:07,304 [INFO]: 	index_path: knn.index
2025-03-13 12:54:07,304 [INFO]: 	size in bytes: 3470997066
2025-03-13 12:54:07,304 [INFO]: 	avg_search_speed_ms: 11.157567084280474
2025-03-13 12:54:07,304 [INFO]: 	99p_search_speed_ms: 19.91885566385463
2025-03-13 12:54:07,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:54:07,305 [INFO]: 	nb vectors: 17630
2025-03-13 12:54:07,305 [INFO]: 	vectors dimension: 49152
2025-03-13 12:54:07,305 [INFO]: 	compression ratio: 0.9986176807675815
2025-03-13 12:54:07,305 [INFO]: }
2025-03-13 12:54:07,305 [INFO]: 	>>> Finished "Creating the index" in 230.9351 secs
2025-03-13 12:54:07,305 [INFO]: >>> Finished "Launching the whole pipeline" in 230.9673 secs
2025-03-13 12:54:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:54:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 67164 [episode count 12/20]
[retrieval_preprocessing] for episode 70236 [episode count 13/20], we have num_retrieval=np.int64(17350) num_query=np.int64(1218)
2025-03-13 12:54:19,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:54:22,210 [INFO]: Launching the whole pipeline 03/13/2025, 12:54:22
2025-03-13 12:54:22,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:54:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.81it/s]
2025-03-13 12:54:22,237 [INFO]: There are 17350 embeddings of dim 49152
2025-03-13 12:54:22,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 12:54:22,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:54:22
2025-03-13 12:54:22,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:54:22,238 [INFO]: 		-> Add: 9.5 seconds
2025-03-13 12:54:22,238 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:54:22,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:54:22,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:54:22
2025-03-13 12:54:22,238 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:54:22,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:54:22,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:54:22
2025-03-13 12:54:22,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:54:22,238 [INFO]: 	Creating the index 03/13/2025, 12:54:22
2025-03-13 12:54:22,238 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:54:22
2025-03-13 12:54:22,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:54:22,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:54:22
2025-03-13 12:54:22,240 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:54:22,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:18,  3.76it/s]  4%|▍         | 3/72 [00:00<00:09,  7.26it/s]  7%|▋         | 5/72 [00:00<00:07,  9.27it/s] 10%|▉         | 7/72 [00:00<00:06, 10.40it/s] 12%|█▎        | 9/72 [00:00<00:05, 11.12it/s] 15%|█▌        | 11/72 [00:01<00:05, 11.43it/s] 18%|█▊        | 13/72 [00:01<00:05, 11.72it/s] 21%|██        | 15/72 [00:01<00:04, 11.90it/s] 24%|██▎       | 17/72 [00:01<00:04, 12.02it/s] 26%|██▋       | 19/72 [00:01<00:04, 12.05it/s] 29%|██▉       | 21/72 [00:08<00:52,  1.04s/it] 32%|███▏      | 23/72 [00:08<00:36,  1.34it/s] 35%|███▍      | 25/72 [00:08<00:25,  1.83it/s] 38%|███▊      | 27/72 [00:08<00:18,  2.47it/s] 40%|████      | 29/72 [00:08<00:13,  3.27it/s] 43%|████▎     | 31/72 [00:08<00:09,  4.18it/s] 46%|████▌     | 33/72 [00:09<00:07,  5.24it/s] 49%|████▊     | 35/72 [00:09<00:05,  6.38it/s] 51%|█████▏    | 37/72 [00:09<00:04,  7.51it/s] 54%|█████▍    | 39/72 [00:09<00:03,  8.43it/s] 57%|█████▋    | 41/72 [00:09<00:03,  9.40it/s] 60%|█████▉    | 43/72 [00:22<00:55,  1.92s/it] 61%|██████    | 44/72 [00:24<00:56,  2.02s/it] 62%|██████▎   | 45/72 [00:27<01:00,  2.23s/it] 64%|██████▍   | 46/72 [00:29<00:55,  2.13s/it] 65%|██████▌   | 47/72 [00:31<00:53,  2.12s/it] 67%|██████▋   | 48/72 [00:33<00:51,  2.14s/it] 68%|██████▊   | 49/72 [00:35<00:45,  2.00s/it] 69%|██████▉   | 50/72 [00:35<00:33,  1.51s/it] 72%|███████▏  | 52/72 [00:35<00:17,  1.15it/s] 76%|███████▋  | 55/72 [00:35<00:08,  2.08it/s] 79%|███████▉  | 57/72 [00:35<00:05,  2.90it/s] 82%|████████▏ | 59/72 [00:36<00:03,  3.87it/s] 85%|████████▍ | 61/72 [00:36<00:02,  4.96it/s] 88%|████████▊ | 63/72 [00:45<00:13,  1.55s/it] 89%|████████▉ | 64/72 [00:47<00:13,  1.73s/it] 94%|█████████▍| 68/72 [00:48<00:03,  1.15it/s] 99%|█████████▊| 71/72 [00:48<00:00,  1.73it/s]100%|██████████| 72/72 [00:52<00:00,  1.37it/s]
2025-03-13 12:55:14,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:14
2025-03-13 12:57:32,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 137.2627 secs
2025-03-13 12:57:32,096 [INFO]: The best hyperparameters are: efSearch=58
2025-03-13 12:57:32,096 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 12:58:31,831 [INFO]: 	>>> Finished "Compute fast metrics" in 59.7345 secs
2025-03-13 12:58:31,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 249.5940 secs
2025-03-13 12:58:31,835 [INFO]: {
2025-03-13 12:58:31,835 [INFO]: 	index_key: HNSW32
2025-03-13 12:58:31,835 [INFO]: 	index_param: efSearch=58
2025-03-13 12:58:31,835 [INFO]: 	index_path: knn.index
2025-03-13 12:58:31,835 [INFO]: 	size in bytes: 3415871018
2025-03-13 12:58:31,835 [INFO]: 	avg_search_speed_ms: 12.074702857197032
2025-03-13 12:58:31,835 [INFO]: 	99p_search_speed_ms: 21.96074682287872
2025-03-13 12:58:31,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:31,835 [INFO]: 	nb vectors: 17350
2025-03-13 12:58:31,835 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:31,835 [INFO]: 	compression ratio: 0.9986175654832644
2025-03-13 12:58:31,835 [INFO]: }
2025-03-13 12:58:31,835 [INFO]: 	>>> Finished "Creating the index" in 249.5965 secs
2025-03-13 12:58:31,835 [INFO]: >>> Finished "Launching the whole pipeline" in 249.6246 secs
2025-03-13 12:58:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 70236 [episode count 13/20]
[retrieval_preprocessing] for episode 46700 [episode count 14/20], we have num_retrieval=np.int64(17494) num_query=np.int64(1074)
2025-03-13 12:58:47,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:49,362 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:49
2025-03-13 12:58:49,362 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.98it/s]
2025-03-13 12:58:49,388 [INFO]: There are 17494 embeddings of dim 49152
2025-03-13 12:58:49,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:58:49,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:49
2025-03-13 12:58:49,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:49,389 [INFO]: 		-> Add: 9.6 seconds
2025-03-13 12:58:49,389 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:58:49,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:49,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:49
2025-03-13 12:58:49,389 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:49,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:49,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:49
2025-03-13 12:58:49,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:49,389 [INFO]: 	Creating the index 03/13/2025, 12:58:49
2025-03-13 12:58:49,389 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:58:49
2025-03-13 12:58:49,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 12:58:49,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:49
2025-03-13 12:58:49,390 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 12:58:49,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:16,  4.26it/s]  4%|▍         | 3/72 [00:00<00:08,  8.37it/s]  7%|▋         | 5/72 [00:00<00:06, 10.07it/s] 10%|▉         | 7/72 [00:00<00:05, 10.94it/s] 12%|█▎        | 9/72 [00:00<00:05, 11.23it/s] 15%|█▌        | 11/72 [00:01<00:05, 11.64it/s] 18%|█▊        | 13/72 [00:01<00:04, 11.90it/s] 21%|██        | 15/72 [00:01<00:04, 12.16it/s] 24%|██▎       | 17/72 [00:01<00:04, 12.22it/s] 26%|██▋       | 19/72 [00:01<00:04, 12.65it/s] 29%|██▉       | 21/72 [00:08<00:59,  1.17s/it] 36%|███▌      | 26/72 [00:09<00:26,  1.75it/s] 43%|████▎     | 31/72 [00:09<00:13,  2.98it/s] 50%|█████     | 36/72 [00:09<00:07,  4.61it/s] 57%|█████▋    | 41/72 [00:09<00:04,  6.74it/s] 62%|██████▎   | 45/72 [00:20<00:23,  1.13it/s] 65%|██████▌   | 47/72 [00:20<00:18,  1.34it/s] 71%|███████   | 51/72 [00:20<00:10,  1.94it/s] 75%|███████▌  | 54/72 [00:20<00:07,  2.55it/s] 79%|███████▉  | 57/72 [00:20<00:04,  3.37it/s] 83%|████████▎ | 60/72 [00:20<00:02,  4.44it/s] 88%|████████▊ | 63/72 [00:33<00:12,  1.39s/it] 89%|████████▉ | 64/72 [00:34<00:09,  1.24s/it] 93%|█████████▎| 67/72 [00:34<00:04,  1.16it/s] 96%|█████████▌| 69/72 [00:34<00:02,  1.48it/s] 99%|█████████▊| 71/72 [00:34<00:00,  1.89it/s]100%|██████████| 72/72 [00:40<00:00,  1.78it/s]
2025-03-13 12:59:29,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:29
2025-03-13 13:02:03,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 154.0045 secs
2025-03-13 13:02:03,862 [INFO]: The best hyperparameters are: efSearch=52
2025-03-13 13:02:03,862 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s]
2025-03-13 13:02:37,066 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2039 secs
2025-03-13 13:02:37,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 227.6779 secs
2025-03-13 13:02:37,068 [INFO]: {
2025-03-13 13:02:37,068 [INFO]: 	index_key: HNSW32
2025-03-13 13:02:37,068 [INFO]: 	index_param: efSearch=52
2025-03-13 13:02:37,068 [INFO]: 	index_path: knn.index
2025-03-13 13:02:37,068 [INFO]: 	size in bytes: 3444221546
2025-03-13 13:02:37,068 [INFO]: 	avg_search_speed_ms: 10.186913340967035
2025-03-13 13:02:37,068 [INFO]: 	99p_search_speed_ms: 17.46004029177128
2025-03-13 13:02:37,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:37,068 [INFO]: 	nb vectors: 17494
2025-03-13 13:02:37,068 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:37,068 [INFO]: 	compression ratio: 0.9986176284143133
2025-03-13 13:02:37,068 [INFO]: }
2025-03-13 13:02:37,068 [INFO]: 	>>> Finished "Creating the index" in 227.6792 secs
2025-03-13 13:02:37,068 [INFO]: >>> Finished "Launching the whole pipeline" in 227.7062 secs
2025-03-13 13:02:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 46700 [episode count 14/20]
[retrieval_preprocessing] for episode 25737 [episode count 15/20], we have num_retrieval=np.int64(17851) num_query=np.int64(717)
2025-03-13 13:02:49,067 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:52,076 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:52
2025-03-13 13:02:52,076 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.98it/s]
2025-03-13 13:02:52,100 [INFO]: There are 17851 embeddings of dim 49152
2025-03-13 13:02:52,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 13:02:52,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:52
2025-03-13 13:02:52,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:52,100 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 13:02:52,100 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:02:52,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:52,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:52
2025-03-13 13:02:52,101 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:52,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:02:52,101 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:52
2025-03-13 13:02:52,101 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:52,101 [INFO]: 	Creating the index 03/13/2025, 13:02:52
2025-03-13 13:02:52,101 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:02:52
2025-03-13 13:02:52,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 13:02:52,102 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:52
2025-03-13 13:02:52,102 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 13:02:52,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:18,  3.92it/s]  5%|▌         | 4/74 [00:00<00:05, 12.11it/s] 11%|█         | 8/74 [00:00<00:03, 20.26it/s] 16%|█▌        | 12/74 [00:00<00:02, 24.45it/s] 20%|██        | 15/74 [00:00<00:02, 21.74it/s] 24%|██▍       | 18/74 [00:01<00:03, 16.97it/s] 27%|██▋       | 20/74 [00:01<00:03, 15.41it/s] 30%|██▉       | 22/74 [00:09<00:58,  1.12s/it] 34%|███▍      | 25/74 [00:09<00:36,  1.34it/s] 38%|███▊      | 28/74 [00:10<00:23,  1.96it/s] 43%|████▎     | 32/74 [00:10<00:13,  3.08it/s] 49%|████▊     | 36/74 [00:10<00:08,  4.58it/s] 54%|█████▍    | 40/74 [00:10<00:05,  6.49it/s] 58%|█████▊    | 43/74 [00:21<00:33,  1.07s/it] 64%|██████▎   | 47/74 [00:21<00:19,  1.39it/s] 69%|██████▉   | 51/74 [00:21<00:11,  2.02it/s] 74%|███████▍  | 55/74 [00:21<00:06,  2.85it/s] 80%|███████▉  | 59/74 [00:21<00:03,  3.94it/s] 84%|████████▍ | 62/74 [00:21<00:02,  5.00it/s] 88%|████████▊ | 65/74 [00:33<00:10,  1.16s/it] 91%|█████████ | 67/74 [00:33<00:06,  1.06it/s] 95%|█████████▍| 70/74 [00:33<00:02,  1.46it/s] 97%|█████████▋| 72/74 [00:34<00:01,  1.78it/s]100%|██████████| 74/74 [00:40<00:00,  1.17s/it]100%|██████████| 74/74 [00:40<00:00,  1.84it/s]
2025-03-13 13:03:32,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:32
2025-03-13 13:05:56,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 143.6773 secs
2025-03-13 13:05:56,008 [INFO]: The best hyperparameters are: efSearch=59
2025-03-13 13:05:56,008 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 13:06:42,264 [INFO]: 	>>> Finished "Compute fast metrics" in 46.2553 secs
2025-03-13 13:06:42,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 230.3687 secs
2025-03-13 13:06:42,471 [INFO]: {
2025-03-13 13:06:42,471 [INFO]: 	index_key: HNSW32
2025-03-13 13:06:42,471 [INFO]: 	index_param: efSearch=59
2025-03-13 13:06:42,472 [INFO]: 	index_path: knn.index
2025-03-13 13:06:42,472 [INFO]: 	size in bytes: 3514507430
2025-03-13 13:06:42,472 [INFO]: 	avg_search_speed_ms: 11.631794753592722
2025-03-13 13:06:42,472 [INFO]: 	99p_search_speed_ms: 20.83933681715279
2025-03-13 13:06:42,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:42,472 [INFO]: 	nb vectors: 17851
2025-03-13 13:06:42,472 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:42,472 [INFO]: 	compression ratio: 0.9986177232238772
2025-03-13 13:06:42,472 [INFO]: }
2025-03-13 13:06:42,472 [INFO]: 	>>> Finished "Creating the index" in 230.3711 secs
2025-03-13 13:06:42,472 [INFO]: >>> Finished "Launching the whole pipeline" in 230.3964 secs
2025-03-13 13:06:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 25737 [episode count 15/20]
[retrieval_preprocessing] for episode 29323 [episode count 16/20], we have num_retrieval=np.int64(17873) num_query=np.int64(695)
2025-03-13 13:06:51,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:54,663 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:54
2025-03-13 13:06:54,663 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 932.90it/s]
2025-03-13 13:06:54,713 [INFO]: There are 17873 embeddings of dim 49152
2025-03-13 13:06:54,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0493 secs
2025-03-13 13:06:54,713 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:54
2025-03-13 13:06:54,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:54,713 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 13:06:54,713 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:06:54,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:06:54,713 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:54
2025-03-13 13:06:54,714 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:54,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:06:54,714 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:54
2025-03-13 13:06:54,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:54,714 [INFO]: 	Creating the index 03/13/2025, 13:06:54
2025-03-13 13:06:54,714 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:06:54
2025-03-13 13:06:54,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0017 secs
2025-03-13 13:06:54,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:54
2025-03-13 13:06:54,716 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 13:06:54,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:12,  6.06it/s]  8%|▊         | 6/74 [00:00<00:02, 26.36it/s] 16%|█▌        | 12/74 [00:00<00:01, 37.75it/s] 24%|██▍       | 18/74 [00:00<00:01, 43.77it/s] 31%|███       | 23/74 [00:07<00:26,  1.92it/s] 38%|███▊      | 28/74 [00:07<00:16,  2.84it/s] 46%|████▌     | 34/74 [00:07<00:09,  4.35it/s] 54%|█████▍    | 40/74 [00:07<00:05,  6.37it/s] 61%|██████    | 45/74 [00:16<00:17,  1.64it/s] 69%|██████▉   | 51/74 [00:16<00:09,  2.42it/s] 77%|███████▋  | 57/74 [00:16<00:04,  3.50it/s] 85%|████████▌ | 63/74 [00:26<00:07,  1.43it/s] 92%|█████████▏| 68/74 [00:26<00:03,  1.94it/s]100%|██████████| 74/74 [00:32<00:00,  1.43it/s]100%|██████████| 74/74 [00:32<00:00,  2.24it/s]
2025-03-13 13:07:27,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:27
2025-03-13 13:09:52,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 144.8660 secs
2025-03-13 13:09:52,589 [INFO]: The best hyperparameters are: efSearch=56
2025-03-13 13:09:52,589 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.24it/s]
2025-03-13 13:10:45,120 [INFO]: 	>>> Finished "Compute fast metrics" in 52.5311 secs
2025-03-13 13:10:45,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 230.4068 secs
2025-03-13 13:10:45,123 [INFO]: {
2025-03-13 13:10:45,123 [INFO]: 	index_key: HNSW32
2025-03-13 13:10:45,123 [INFO]: 	index_param: efSearch=56
2025-03-13 13:10:45,123 [INFO]: 	index_path: knn.index
2025-03-13 13:10:45,123 [INFO]: 	size in bytes: 3518838702
2025-03-13 13:10:45,123 [INFO]: 	avg_search_speed_ms: 14.721679984701469
2025-03-13 13:10:45,123 [INFO]: 	99p_search_speed_ms: 25.39410434896127
2025-03-13 13:10:45,123 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:45,123 [INFO]: 	nb vectors: 17873
2025-03-13 13:10:45,123 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:45,123 [INFO]: 	compression ratio: 0.9986177490894267
2025-03-13 13:10:45,123 [INFO]: }
2025-03-13 13:10:45,123 [INFO]: 	>>> Finished "Creating the index" in 230.4095 secs
2025-03-13 13:10:45,123 [INFO]: >>> Finished "Launching the whole pipeline" in 230.4600 secs
2025-03-13 13:10:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 29323 [episode count 16/20]
[retrieval_preprocessing] for episode 16047 [episode count 17/20], we have num_retrieval=np.int64(17549) num_query=np.int64(1019)
2025-03-13 13:10:53,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:55,912 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:55
2025-03-13 13:10:55,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 731.35it/s]
2025-03-13 13:10:55,955 [INFO]: There are 17549 embeddings of dim 49152
2025-03-13 13:10:55,956 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0439 secs
2025-03-13 13:10:55,956 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:55
2025-03-13 13:10:55,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:55,956 [INFO]: 		-> Add: 9.6 seconds
2025-03-13 13:10:55,957 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:10:55,957 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:10:55,957 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:55
2025-03-13 13:10:55,957 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:55,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:10:55,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:55
2025-03-13 13:10:55,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:10:55,958 [INFO]: 	Creating the index 03/13/2025, 13:10:55
2025-03-13 13:10:55,958 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:10:55
2025-03-13 13:10:55,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0033 secs
2025-03-13 13:10:55,962 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:55
2025-03-13 13:10:55,962 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 13:10:55,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:09,  7.21it/s]  7%|▋         | 5/73 [00:00<00:03, 21.17it/s] 12%|█▏        | 9/73 [00:00<00:02, 27.86it/s] 18%|█▊        | 13/73 [00:00<00:01, 30.89it/s] 23%|██▎       | 17/73 [00:00<00:01, 33.03it/s] 29%|██▉       | 21/73 [00:07<00:34,  1.53it/s] 36%|███▌      | 26/73 [00:07<00:19,  2.44it/s] 42%|████▏     | 31/73 [00:07<00:11,  3.69it/s] 49%|████▉     | 36/73 [00:08<00:06,  5.36it/s] 56%|█████▌    | 41/73 [00:08<00:04,  7.55it/s] 63%|██████▎   | 46/73 [00:17<00:17,  1.52it/s] 70%|██████▉   | 51/73 [00:17<00:10,  2.18it/s] 77%|███████▋  | 56/73 [00:17<00:05,  3.09it/s] 84%|████████▎ | 61/73 [00:17<00:02,  4.32it/s] 90%|█████████ | 66/73 [00:27<00:05,  1.30it/s] 95%|█████████▍| 69/73 [00:27<00:02,  1.62it/s]100%|██████████| 73/73 [00:32<00:00,  1.25it/s]100%|██████████| 73/73 [00:32<00:00,  2.24it/s]
2025-03-13 13:11:28,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:11:28
2025-03-13 13:13:59,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 151.4348 secs
2025-03-13 13:13:59,979 [INFO]: The best hyperparameters are: efSearch=47
2025-03-13 13:13:59,979 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 13:14:51,127 [INFO]: 	>>> Finished "Compute fast metrics" in 51.1477 secs
2025-03-13 13:14:51,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 235.1663 secs
2025-03-13 13:14:51,129 [INFO]: {
2025-03-13 13:14:51,129 [INFO]: 	index_key: HNSW32
2025-03-13 13:14:51,129 [INFO]: 	index_param: efSearch=47
2025-03-13 13:14:51,129 [INFO]: 	index_path: knn.index
2025-03-13 13:14:51,129 [INFO]: 	size in bytes: 3455049726
2025-03-13 13:14:51,129 [INFO]: 	avg_search_speed_ms: 9.826421484484728
2025-03-13 13:14:51,129 [INFO]: 	99p_search_speed_ms: 22.041272227652374
2025-03-13 13:14:51,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:51,129 [INFO]: 	nb vectors: 17549
2025-03-13 13:14:51,129 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:51,129 [INFO]: 	compression ratio: 0.9986176945691808
2025-03-13 13:14:51,129 [INFO]: }
2025-03-13 13:14:51,129 [INFO]: 	>>> Finished "Creating the index" in 235.1706 secs
2025-03-13 13:14:51,129 [INFO]: >>> Finished "Launching the whole pipeline" in 235.2171 secs
2025-03-13 13:14:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 16047 [episode count 17/20]
[retrieval_preprocessing] for episode 46783 [episode count 18/20], we have num_retrieval=np.int64(17604) num_query=np.int64(964)
2025-03-13 13:14:57,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:00,876 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:00
2025-03-13 13:15:00,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-13 13:15:00,914 [INFO]: There are 17604 embeddings of dim 49152
2025-03-13 13:15:00,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 13:15:00,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:00
2025-03-13 13:15:00,916 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:00,916 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 13:15:00,916 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:15:00,916 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:15:00,916 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:00
2025-03-13 13:15:00,917 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:00,917 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:15:00,917 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:00
2025-03-13 13:15:00,917 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:15:00,918 [INFO]: 	Creating the index 03/13/2025, 13:15:00
2025-03-13 13:15:00,918 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:15:00
2025-03-13 13:15:00,921 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 13:15:00,921 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:00
2025-03-13 13:15:00,922 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 13:15:00,922 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:08,  8.21it/s]  8%|▊         | 6/73 [00:00<00:02, 28.73it/s] 15%|█▌        | 11/73 [00:00<00:01, 37.19it/s] 22%|██▏       | 16/73 [00:00<00:01, 41.68it/s] 29%|██▉       | 21/73 [00:08<00:33,  1.55it/s] 33%|███▎      | 24/73 [00:08<00:24,  1.98it/s] 37%|███▋      | 27/73 [00:09<00:18,  2.54it/s] 40%|███▉      | 29/73 [00:09<00:14,  3.02it/s] 42%|████▏     | 31/73 [00:09<00:11,  3.65it/s] 45%|████▌     | 33/73 [00:09<00:08,  4.45it/s] 48%|████▊     | 35/73 [00:09<00:07,  5.36it/s] 51%|█████     | 37/73 [00:09<00:05,  6.35it/s] 53%|█████▎    | 39/73 [00:09<00:04,  7.39it/s] 56%|█████▌    | 41/73 [00:10<00:03,  8.42it/s] 59%|█████▉    | 43/73 [00:20<00:48,  1.63s/it] 62%|██████▏   | 45/73 [00:20<00:32,  1.17s/it] 64%|██████▍   | 47/73 [00:21<00:22,  1.18it/s] 67%|██████▋   | 49/73 [00:21<00:14,  1.61it/s] 70%|██████▉   | 51/73 [00:21<00:10,  2.19it/s] 73%|███████▎  | 53/73 [00:21<00:06,  2.92it/s] 75%|███████▌  | 55/73 [00:21<00:04,  3.81it/s] 78%|███████▊  | 57/73 [00:21<00:03,  4.88it/s] 81%|████████  | 59/73 [00:21<00:02,  6.14it/s] 86%|████████▋ | 63/73 [00:31<00:11,  1.16s/it] 93%|█████████▎| 68/73 [00:31<00:03,  1.54it/s]100%|██████████| 73/73 [00:36<00:00,  1.26it/s]100%|██████████| 73/73 [00:36<00:00,  2.00it/s]
2025-03-13 13:15:37,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:37
2025-03-13 13:17:55,940 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 138.5013 secs
2025-03-13 13:17:55,941 [INFO]: The best hyperparameters are: efSearch=54
2025-03-13 13:17:55,941 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 13:18:56,273 [INFO]: 	>>> Finished "Compute fast metrics" in 60.3317 secs
2025-03-13 13:18:56,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 235.3538 secs
2025-03-13 13:18:56,275 [INFO]: {
2025-03-13 13:18:56,275 [INFO]: 	index_key: HNSW32
2025-03-13 13:18:56,276 [INFO]: 	index_param: efSearch=54
2025-03-13 13:18:56,276 [INFO]: 	index_path: knn.index
2025-03-13 13:18:56,276 [INFO]: 	size in bytes: 3465878162
2025-03-13 13:18:56,276 [INFO]: 	avg_search_speed_ms: 11.095940892248024
2025-03-13 13:18:56,276 [INFO]: 	99p_search_speed_ms: 23.146017722319815
2025-03-13 13:18:56,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:56,276 [INFO]: 	nb vectors: 17604
2025-03-13 13:18:56,276 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:56,276 [INFO]: 	compression ratio: 0.9986176865498251
2025-03-13 13:18:56,276 [INFO]: }
2025-03-13 13:18:56,276 [INFO]: 	>>> Finished "Creating the index" in 235.3581 secs
2025-03-13 13:18:56,276 [INFO]: >>> Finished "Launching the whole pipeline" in 235.3995 secs
2025-03-13 13:19:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 46783 [episode count 18/20]
[retrieval_preprocessing] for episode 52929 [episode count 19/20], we have num_retrieval=np.int64(17579) num_query=np.int64(989)
2025-03-13 13:19:11,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:14,778 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:14
2025-03-13 13:19:14,778 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.48it/s]
2025-03-13 13:19:14,810 [INFO]: There are 17579 embeddings of dim 49152
2025-03-13 13:19:14,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 13:19:14,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:14
2025-03-13 13:19:14,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:14,810 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 13:19:14,810 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:19:14,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:14,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:14
2025-03-13 13:19:14,810 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:14,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:19:14,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:14
2025-03-13 13:19:14,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:14,811 [INFO]: 	Creating the index 03/13/2025, 13:19:14
2025-03-13 13:19:14,811 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:19:14
2025-03-13 13:19:14,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 13:19:14,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:14
2025-03-13 13:19:14,812 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 13:19:14,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:16,  4.24it/s]  4%|▍         | 3/73 [00:00<00:09,  7.73it/s]  7%|▋         | 5/73 [00:00<00:07,  9.18it/s] 10%|▉         | 7/73 [00:00<00:06,  9.86it/s] 12%|█▏        | 9/73 [00:00<00:06, 10.22it/s] 15%|█▌        | 11/73 [00:01<00:05, 10.37it/s] 18%|█▊        | 13/73 [00:01<00:05, 10.97it/s] 21%|██        | 15/73 [00:01<00:05, 11.54it/s] 23%|██▎       | 17/73 [00:01<00:04, 11.98it/s] 26%|██▌       | 19/73 [00:01<00:04, 12.66it/s] 29%|██▉       | 21/73 [00:11<01:23,  1.60s/it] 34%|███▍      | 25/73 [00:11<00:41,  1.16it/s] 41%|████      | 30/73 [00:12<00:20,  2.08it/s] 48%|████▊     | 35/73 [00:12<00:11,  3.32it/s] 55%|█████▍    | 40/73 [00:12<00:06,  4.96it/s] 60%|██████    | 44/73 [00:20<00:21,  1.33it/s] 64%|██████▍   | 47/73 [00:20<00:15,  1.73it/s] 68%|██████▊   | 50/73 [00:20<00:10,  2.27it/s] 75%|███████▌  | 55/73 [00:20<00:05,  3.52it/s] 81%|████████  | 59/73 [00:21<00:02,  4.85it/s] 86%|████████▋ | 63/73 [00:30<00:08,  1.18it/s] 90%|█████████ | 66/73 [00:30<00:04,  1.52it/s] 95%|█████████▍| 69/73 [00:30<00:02,  1.97it/s] 97%|█████████▋| 71/73 [00:30<00:00,  2.37it/s]100%|██████████| 73/73 [00:37<00:00,  1.02s/it]100%|██████████| 73/73 [00:37<00:00,  1.96it/s]
2025-03-13 13:19:52,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:52
2025-03-13 13:22:08,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 136.8121 secs
2025-03-13 13:22:08,907 [INFO]: The best hyperparameters are: efSearch=52
2025-03-13 13:22:08,907 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.59it/s]
2025-03-13 13:22:46,637 [INFO]: 	>>> Finished "Compute fast metrics" in 37.7303 secs
2025-03-13 13:22:46,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 211.8274 secs
2025-03-13 13:22:46,640 [INFO]: {
2025-03-13 13:22:46,640 [INFO]: 	index_key: HNSW32
2025-03-13 13:22:46,640 [INFO]: 	index_param: efSearch=52
2025-03-13 13:22:46,640 [INFO]: 	index_path: knn.index
2025-03-13 13:22:46,640 [INFO]: 	size in bytes: 3460956262
2025-03-13 13:22:46,640 [INFO]: 	avg_search_speed_ms: 9.044917975468174
2025-03-13 13:22:46,640 [INFO]: 	99p_search_speed_ms: 14.213138143531983
2025-03-13 13:22:46,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:46,640 [INFO]: 	nb vectors: 17579
2025-03-13 13:22:46,640 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:46,640 [INFO]: 	compression ratio: 0.9986176566134253
2025-03-13 13:22:46,640 [INFO]: }
2025-03-13 13:22:46,640 [INFO]: 	>>> Finished "Creating the index" in 211.8292 secs
2025-03-13 13:22:46,640 [INFO]: >>> Finished "Launching the whole pipeline" in 211.8614 secs
2025-03-13 13:22:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 52929 [episode count 19/20]
2025-03-13 13:22:51: [retrieval_preprocessing] finished for 4743066113_swap_box_and_table_contents [chosen_id count 4/260]
2025-03-13 13:22:55: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4743066113_push_table_items_left_with_towel [chosen_id count 5/260]
2025-03-13 13:22:55: [retrieval_preprocessing] we have num_total=10446 embedding_dim=49152
[retrieval_preprocessing] for episode 79416 [episode count 0/20], we have num_retrieval=np.int64(10045) num_query=np.int64(401)
2025-03-13 13:22:56,220 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:59,233 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:59
2025-03-13 13:22:59,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.38it/s]
2025-03-13 13:22:59,266 [INFO]: There are 10045 embeddings of dim 49152
2025-03-13 13:22:59,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 13:22:59,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:59
2025-03-13 13:22:59,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:59,267 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 13:22:59,267 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:22:59,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:22:59,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:59
2025-03-13 13:22:59,268 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:59,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 13:22:59,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:59
2025-03-13 13:22:59,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:22:59,269 [INFO]: 	Creating the index 03/13/2025, 13:22:59
2025-03-13 13:22:59,269 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:22:59
2025-03-13 13:22:59,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0034 secs
2025-03-13 13:22:59,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:59
2025-03-13 13:22:59,273 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:22:59,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.88it/s]  7%|▋         | 3/41 [00:00<00:04,  8.45it/s] 12%|█▏        | 5/41 [00:00<00:03, 10.10it/s] 22%|██▏       | 9/41 [00:00<00:01, 17.86it/s] 32%|███▏      | 13/41 [00:00<00:01, 21.98it/s] 39%|███▉      | 16/41 [00:00<00:01, 22.66it/s] 46%|████▋     | 19/41 [00:01<00:00, 23.06it/s] 54%|█████▎    | 22/41 [00:08<00:15,  1.20it/s] 63%|██████▎   | 26/41 [00:08<00:07,  1.88it/s] 73%|███████▎  | 30/41 [00:08<00:03,  2.80it/s] 80%|████████  | 33/41 [00:09<00:02,  3.66it/s] 88%|████████▊ | 36/41 [00:09<00:01,  4.74it/s] 95%|█████████▌| 39/41 [00:09<00:00,  5.98it/s]100%|██████████| 41/41 [00:17<00:00,  2.31it/s]
2025-03-13 13:23:17,063 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:17
2025-03-13 13:24:59,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.4969 secs
2025-03-13 13:24:59,561 [INFO]: The best hyperparameters are: efSearch=66
2025-03-13 13:24:59,561 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.78it/s]
2025-03-13 13:25:22,920 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3592 secs
2025-03-13 13:25:22,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.6497 secs
2025-03-13 13:25:22,923 [INFO]: {
2025-03-13 13:25:22,923 [INFO]: 	index_key: HNSW32
2025-03-13 13:25:22,923 [INFO]: 	index_param: efSearch=66
2025-03-13 13:25:22,923 [INFO]: 	index_path: knn.index
2025-03-13 13:25:22,923 [INFO]: 	size in bytes: 1977657406
2025-03-13 13:25:22,923 [INFO]: 	avg_search_speed_ms: 10.769469009870733
2025-03-13 13:25:22,923 [INFO]: 	99p_search_speed_ms: 17.296680221334103
2025-03-13 13:25:22,923 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:22,923 [INFO]: 	nb vectors: 10045
2025-03-13 13:25:22,923 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:22,923 [INFO]: 	compression ratio: 0.9986195556461309
2025-03-13 13:25:22,923 [INFO]: }
2025-03-13 13:25:22,923 [INFO]: 	>>> Finished "Creating the index" in 143.6543 secs
2025-03-13 13:25:22,923 [INFO]: >>> Finished "Launching the whole pipeline" in 143.6905 secs
2025-03-13 13:25:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 79416 [episode count 0/20]
[retrieval_preprocessing] for episode 94245 [episode count 1/20], we have num_retrieval=np.int64(10002) num_query=np.int64(444)
2025-03-13 13:25:26,523 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:28,569 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:28
2025-03-13 13:25:28,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-13 13:25:28,604 [INFO]: There are 10002 embeddings of dim 49152
2025-03-13 13:25:28,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 13:25:28,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:28
2025-03-13 13:25:28,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:28,605 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 13:25:28,605 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:25:28,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:28,605 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:28
2025-03-13 13:25:28,605 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:28,605 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:25:28,605 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:28
2025-03-13 13:25:28,605 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:28,605 [INFO]: 	Creating the index 03/13/2025, 13:25:28
2025-03-13 13:25:28,605 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:25:28
2025-03-13 13:25:28,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:25:28,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:28
2025-03-13 13:25:28,606 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:25:28,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.35it/s] 15%|█▍        | 6/41 [00:00<00:01, 28.37it/s] 27%|██▋       | 11/41 [00:00<00:00, 36.49it/s] 39%|███▉      | 16/41 [00:00<00:00, 40.65it/s] 51%|█████     | 21/41 [00:07<00:11,  1.76it/s] 63%|██████▎   | 26/41 [00:07<00:05,  2.68it/s] 78%|███████▊  | 32/41 [00:07<00:02,  4.20it/s] 93%|█████████▎| 38/41 [00:07<00:00,  6.21it/s]100%|██████████| 41/41 [00:16<00:00,  2.51it/s]
2025-03-13 13:25:44,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:44
2025-03-13 13:27:20,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.3060 secs
2025-03-13 13:27:20,223 [INFO]: The best hyperparameters are: efSearch=55
2025-03-13 13:27:20,223 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
