2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3854327802_move_right [chosen_id count 0/196]
2025-03-13 14:35:05: [retrieval_preprocessing] we have num_total=3360 embedding_dim=49152
[retrieval_preprocessing] for episode 54799 [episode count 0/20], we have num_retrieval=np.int64(3212) num_query=np.int64(148)
2025-03-13 14:35:07,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:08,553 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:08
2025-03-13 14:35:08,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 713.20it/s]
2025-03-13 14:35:08,587 [INFO]: There are 3212 embeddings of dim 49152
2025-03-13 14:35:08,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 14:35:08,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:08
2025-03-13 14:35:08,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:08,587 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:35:08,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:08,588 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:08,588 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:08
2025-03-13 14:35:08,588 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:08,588 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:35:08,588 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:08
2025-03-13 14:35:08,588 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:08,588 [INFO]: 	Creating the index 03/13/2025, 14:35:08
2025-03-13 14:35:08,588 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:08
2025-03-13 14:35:08,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:35:08,590 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:08
2025-03-13 14:35:08,590 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:35:08,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.83it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.96it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.98it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.29it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.45it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.71it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.08it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.61it/s]100%|██████████| 13/13 [00:06<00:00,  1.10s/it]100%|██████████| 13/13 [00:06<00:00,  2.03it/s]
2025-03-13 14:35:15,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:15
2025-03-13 14:36:06,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9788 secs
2025-03-13 14:36:06,981 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 14:36:06,981 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 14:36:27,803 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8221 secs
2025-03-13 14:36:27,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2161 secs
2025-03-13 14:36:27,807 [INFO]: {
2025-03-13 14:36:27,807 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:27,807 [INFO]: 	index_param: efSearch=225
2025-03-13 14:36:27,807 [INFO]: 	index_path: knn.index
2025-03-13 14:36:27,807 [INFO]: 	size in bytes: 631941070
2025-03-13 14:36:27,807 [INFO]: 	avg_search_speed_ms: 10.47534562003706
2025-03-13 14:36:27,807 [INFO]: 	99p_search_speed_ms: 17.780635282397274
2025-03-13 14:36:27,807 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:27,807 [INFO]: 	nb vectors: 3212
2025-03-13 14:36:27,807 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:27,807 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-13 14:36:27,807 [INFO]: }
2025-03-13 14:36:27,807 [INFO]: 	>>> Finished "Creating the index" in 79.2183 secs
2025-03-13 14:36:27,807 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2536 secs
2025-03-13 14:36:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 54799 [episode count 0/20]
[retrieval_preprocessing] for episode 32315 [episode count 1/20], we have num_retrieval=np.int64(3170) num_query=np.int64(190)
2025-03-13 14:36:30,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:31,460 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:31
2025-03-13 14:36:31,460 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 14:36:31,489 [INFO]: There are 3170 embeddings of dim 49152
2025-03-13 14:36:31,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 14:36:31,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:31
2025-03-13 14:36:31,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:31,489 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:36:31,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:31,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:31,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:31
2025-03-13 14:36:31,489 [INFO]: 654.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:31,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:31,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:31
2025-03-13 14:36:31,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:31,490 [INFO]: 	Creating the index 03/13/2025, 14:36:31
2025-03-13 14:36:31,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:31
2025-03-13 14:36:31,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:36:31,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:31
2025-03-13 14:36:31,491 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:36:31,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.50it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.83it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.49it/s] 31%|███       | 4/13 [00:00<00:01,  6.86it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.19it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.36it/s] 54%|█████▍    | 7/13 [00:01<00:00,  7.35it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.20it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.09it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.09it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.01it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.30it/s]100%|██████████| 13/13 [00:04<00:00,  1.26it/s]100%|██████████| 13/13 [00:04<00:00,  3.22it/s]
2025-03-13 14:36:35,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:35
2025-03-13 14:37:14,243 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7137 secs
2025-03-13 14:37:14,243 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 14:37:14,243 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 14:37:30,904 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6611 secs
2025-03-13 14:37:31,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1428 secs
2025-03-13 14:37:31,634 [INFO]: {
2025-03-13 14:37:31,635 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:31,635 [INFO]: 	index_param: efSearch=217
2025-03-13 14:37:31,635 [INFO]: 	index_path: knn.index
2025-03-13 14:37:31,635 [INFO]: 	size in bytes: 623677870
2025-03-13 14:37:31,635 [INFO]: 	avg_search_speed_ms: 10.540348224222141
2025-03-13 14:37:31,635 [INFO]: 	99p_search_speed_ms: 17.838719505816698
2025-03-13 14:37:31,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:31,635 [INFO]: 	nb vectors: 3170
2025-03-13 14:37:31,635 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:31,635 [INFO]: 	compression ratio: 0.9993097237841708
2025-03-13 14:37:31,635 [INFO]: }
2025-03-13 14:37:31,635 [INFO]: 	>>> Finished "Creating the index" in 60.1454 secs
2025-03-13 14:37:31,635 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1749 secs
2025-03-13 14:37:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 32315 [episode count 1/20]
[retrieval_preprocessing] for episode 93249 [episode count 2/20], we have num_retrieval=np.int64(3196) num_query=np.int64(164)
2025-03-13 14:37:35,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:35,628 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:35
2025-03-13 14:37:35,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.74it/s]
2025-03-13 14:37:35,657 [INFO]: There are 3196 embeddings of dim 49152
2025-03-13 14:37:35,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 14:37:35,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:35,658 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:37:35,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:35,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:37:35,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,659 [INFO]: 659.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:35,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:37:35,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:35
2025-03-13 14:37:35,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:35,660 [INFO]: 	Creating the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:35
2025-03-13 14:37:35,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 14:37:35,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,664 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:37:35,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.76it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.79it/s] 31%|███       | 4/13 [00:00<00:01,  7.76it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.71it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.61it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.55it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.57it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.47it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.41it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.30it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.15it/s]100%|██████████| 13/13 [00:04<00:00,  1.01s/it]100%|██████████| 13/13 [00:04<00:00,  2.80it/s]
2025-03-13 14:37:40,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:40
2025-03-13 14:38:23,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9219 secs
2025-03-13 14:38:23,241 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 14:38:23,241 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 14:38:39,969 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7278 secs
2025-03-13 14:38:39,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3077 secs
2025-03-13 14:38:39,972 [INFO]: {
2025-03-13 14:38:39,972 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:39,972 [INFO]: 	index_param: efSearch=203
2025-03-13 14:38:39,972 [INFO]: 	index_path: knn.index
2025-03-13 14:38:39,972 [INFO]: 	size in bytes: 628793170
2025-03-13 14:38:39,972 [INFO]: 	avg_search_speed_ms: 9.192506921809741
2025-03-13 14:38:39,972 [INFO]: 	99p_search_speed_ms: 12.954474997241048
2025-03-13 14:38:39,972 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:39,972 [INFO]: 	nb vectors: 3196
2025-03-13 14:38:39,972 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:39,972 [INFO]: 	compression ratio: 0.9993097857599185
2025-03-13 14:38:39,972 [INFO]: }
2025-03-13 14:38:39,972 [INFO]: 	>>> Finished "Creating the index" in 64.3120 secs
2025-03-13 14:38:39,972 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3442 secs
2025-03-13 14:38:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 93249 [episode count 2/20]
[retrieval_preprocessing] for episode 79426 [episode count 3/20], we have num_retrieval=np.int64(3189) num_query=np.int64(171)
2025-03-13 14:38:42,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:43,223 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:43
2025-03-13 14:38:43,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.76it/s]
2025-03-13 14:38:43,248 [INFO]: There are 3189 embeddings of dim 49152
2025-03-13 14:38:43,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 14:38:43,249 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:43
2025-03-13 14:38:43,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:43,249 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:38:43,249 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:43,249 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:38:43,249 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:43
2025-03-13 14:38:43,250 [INFO]: 658.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:43,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:38:43,250 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:43
2025-03-13 14:38:43,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:43,251 [INFO]: 	Creating the index 03/13/2025, 14:38:43
2025-03-13 14:38:43,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:43
2025-03-13 14:38:43,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:38:43,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:43
2025-03-13 14:38:43,254 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:38:43,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.85it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.89it/s] 31%|███       | 4/13 [00:00<00:01,  8.15it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.29it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.62it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.82it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.60it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.48it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.47it/s]100%|██████████| 13/13 [00:04<00:00,  1.05it/s]100%|██████████| 13/13 [00:04<00:00,  2.92it/s]
2025-03-13 14:38:47,713 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:47
2025-03-13 14:39:25,145 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4313 secs
2025-03-13 14:39:25,145 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 14:39:25,145 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 14:39:47,162 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0169 secs
2025-03-13 14:39:47,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9103 secs
2025-03-13 14:39:47,165 [INFO]: {
2025-03-13 14:39:47,165 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:47,165 [INFO]: 	index_param: efSearch=165
2025-03-13 14:39:47,165 [INFO]: 	index_path: knn.index
2025-03-13 14:39:47,165 [INFO]: 	size in bytes: 627415990
2025-03-13 14:39:47,165 [INFO]: 	avg_search_speed_ms: 8.238687327275853
2025-03-13 14:39:47,165 [INFO]: 	99p_search_speed_ms: 11.562199154868722
2025-03-13 14:39:47,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:47,165 [INFO]: 	nb vectors: 3189
2025-03-13 14:39:47,165 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:47,165 [INFO]: 	compression ratio: 0.999309743444696
2025-03-13 14:39:47,165 [INFO]: }
2025-03-13 14:39:47,165 [INFO]: 	>>> Finished "Creating the index" in 63.9140 secs
2025-03-13 14:39:47,165 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9411 secs
2025-03-13 14:39:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 79426 [episode count 3/20]
[retrieval_preprocessing] for episode 44084 [episode count 4/20], we have num_retrieval=np.int64(3185) num_query=np.int64(175)
2025-03-13 14:39:49,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:50,017 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:50
2025-03-13 14:39:50,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1718.27it/s]
2025-03-13 14:39:50,038 [INFO]: There are 3185 embeddings of dim 49152
2025-03-13 14:39:50,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0213 secs
2025-03-13 14:39:50,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:50
2025-03-13 14:39:50,039 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:50,039 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:39:50,039 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:50,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:50,039 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:50
2025-03-13 14:39:50,039 [INFO]: 657.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:50,039 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:39:50,039 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:50
2025-03-13 14:39:50,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:50,039 [INFO]: 	Creating the index 03/13/2025, 14:39:50
2025-03-13 14:39:50,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:50
2025-03-13 14:39:50,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:39:50,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:50
2025-03-13 14:39:50,040 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:39:50,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.96it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.74it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.68it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.07it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.70it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.08it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.25it/s]100%|██████████| 13/13 [00:03<00:00,  1.96it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-13 14:39:53,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:53
2025-03-13 14:40:39,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0097 secs
2025-03-13 14:40:39,774 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 14:40:39,775 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 14:40:56,864 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0893 secs
2025-03-13 14:40:56,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8266 secs
2025-03-13 14:40:56,867 [INFO]: {
2025-03-13 14:40:56,867 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:56,867 [INFO]: 	index_param: efSearch=194
2025-03-13 14:40:56,867 [INFO]: 	index_path: knn.index
2025-03-13 14:40:56,867 [INFO]: 	size in bytes: 626629030
2025-03-13 14:40:56,867 [INFO]: 	avg_search_speed_ms: 9.155072347728378
2025-03-13 14:40:56,867 [INFO]: 	99p_search_speed_ms: 12.697005046065895
2025-03-13 14:40:56,867 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:56,867 [INFO]: 	nb vectors: 3185
2025-03-13 14:40:56,867 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:56,867 [INFO]: 	compression ratio: 0.9993097191810599
2025-03-13 14:40:56,867 [INFO]: }
2025-03-13 14:40:56,867 [INFO]: 	>>> Finished "Creating the index" in 66.8278 secs
2025-03-13 14:40:56,867 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8503 secs
2025-03-13 14:40:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 44084 [episode count 4/20]
[retrieval_preprocessing] for episode 78917 [episode count 5/20], we have num_retrieval=np.int64(3188) num_query=np.int64(172)
2025-03-13 14:40:59,963 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:00,489 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:00
2025-03-13 14:41:00,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.37it/s]
2025-03-13 14:41:00,512 [INFO]: There are 3188 embeddings of dim 49152
2025-03-13 14:41:00,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 14:41:00,513 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:00
2025-03-13 14:41:00,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:00,513 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:41:00,513 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:00,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:00,513 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:00
2025-03-13 14:41:00,513 [INFO]: 657.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:00,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:00,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:00
2025-03-13 14:41:00,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:00,513 [INFO]: 	Creating the index 03/13/2025, 14:41:00
2025-03-13 14:41:00,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:00
2025-03-13 14:41:00,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:41:00,514 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:00
2025-03-13 14:41:00,514 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:41:00,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.79it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.56it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.22it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.76it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.80it/s]100%|██████████| 13/13 [00:03<00:00,  1.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.45it/s]
2025-03-13 14:41:04,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:04
2025-03-13 14:41:55,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3819 secs
2025-03-13 14:41:55,668 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 14:41:55,668 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 14:42:17,794 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1262 secs
2025-03-13 14:42:17,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.2827 secs
2025-03-13 14:42:17,797 [INFO]: {
2025-03-13 14:42:17,797 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:17,797 [INFO]: 	index_param: efSearch=180
2025-03-13 14:42:17,797 [INFO]: 	index_path: knn.index
2025-03-13 14:42:17,797 [INFO]: 	size in bytes: 627219250
2025-03-13 14:42:17,797 [INFO]: 	avg_search_speed_ms: 8.943641975843589
2025-03-13 14:42:17,797 [INFO]: 	99p_search_speed_ms: 11.564988419413565
2025-03-13 14:42:17,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:17,797 [INFO]: 	nb vectors: 3188
2025-03-13 14:42:17,797 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:17,797 [INFO]: 	compression ratio: 0.9993097373844951
2025-03-13 14:42:17,797 [INFO]: }
2025-03-13 14:42:17,797 [INFO]: 	>>> Finished "Creating the index" in 77.2841 secs
2025-03-13 14:42:17,797 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3081 secs
2025-03-13 14:42:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 78917 [episode count 5/20]
[retrieval_preprocessing] for episode 78428 [episode count 6/20], we have num_retrieval=np.int64(3216) num_query=np.int64(144)
2025-03-13 14:42:20,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:20,754 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:20
2025-03-13 14:42:20,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-13 14:42:20,780 [INFO]: There are 3216 embeddings of dim 49152
2025-03-13 14:42:20,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 14:42:20,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,781 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:20,781 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:42:20,781 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:20,781 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:42:20,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,782 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:20,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:42:20,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:20
2025-03-13 14:42:20,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:20,783 [INFO]: 	Creating the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,783 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:20
2025-03-13 14:42:20,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:42:20,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,786 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:42:20,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.91it/s] 23%|██▎       | 3/13 [00:00<00:00, 13.07it/s] 38%|███▊      | 5/13 [00:00<00:00, 14.60it/s] 54%|█████▍    | 7/13 [00:00<00:00, 15.21it/s] 69%|██████▉   | 9/13 [00:00<00:00, 15.69it/s] 85%|████████▍ | 11/13 [00:00<00:00, 15.81it/s]100%|██████████| 13/13 [00:03<00:00,  2.18it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-13 14:42:24,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:24
2025-03-13 14:42:59,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5805 secs
2025-03-13 14:42:59,611 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 14:42:59,611 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 14:43:20,219 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6086 secs
2025-03-13 14:43:20,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4357 secs
2025-03-13 14:43:20,222 [INFO]: {
2025-03-13 14:43:20,222 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:20,222 [INFO]: 	index_param: efSearch=214
2025-03-13 14:43:20,222 [INFO]: 	index_path: knn.index
2025-03-13 14:43:20,222 [INFO]: 	size in bytes: 632728030
2025-03-13 14:43:20,222 [INFO]: 	avg_search_speed_ms: 10.24521501795923
2025-03-13 14:43:20,222 [INFO]: 	99p_search_speed_ms: 13.439669040963054
2025-03-13 14:43:20,222 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:20,222 [INFO]: 	nb vectors: 3216
2025-03-13 14:43:20,222 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:20,222 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-13 14:43:20,222 [INFO]: }
2025-03-13 14:43:20,222 [INFO]: 	>>> Finished "Creating the index" in 59.4397 secs
2025-03-13 14:43:20,222 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4684 secs
2025-03-13 14:43:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 78428 [episode count 6/20]
[retrieval_preprocessing] for episode 11381 [episode count 7/20], we have num_retrieval=np.int64(3237) num_query=np.int64(123)
2025-03-13 14:43:22,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:23,579 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:23
2025-03-13 14:43:23,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-13 14:43:23,604 [INFO]: There are 3237 embeddings of dim 49152
2025-03-13 14:43:23,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 14:43:23,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:23
2025-03-13 14:43:23,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:23,604 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:43:23,604 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:23,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:23,604 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:23
2025-03-13 14:43:23,604 [INFO]: 668.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:23,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:43:23,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:23
2025-03-13 14:43:23,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:23,604 [INFO]: 	Creating the index 03/13/2025, 14:43:23
2025-03-13 14:43:23,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:23
2025-03-13 14:43:23,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:43:23,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:23
2025-03-13 14:43:23,605 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:43:23,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.85it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.60it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.70it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.23it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.91it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.96it/s]100%|██████████| 13/13 [00:04<00:00,  1.59it/s]100%|██████████| 13/13 [00:04<00:00,  2.93it/s]
2025-03-13 14:43:28,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:28
2025-03-13 14:44:09,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6297 secs
2025-03-13 14:44:09,687 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 14:44:09,687 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 14:44:29,553 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8659 secs
2025-03-13 14:44:29,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3205 secs
2025-03-13 14:44:29,926 [INFO]: {
2025-03-13 14:44:29,926 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:29,926 [INFO]: 	index_param: efSearch=218
2025-03-13 14:44:29,926 [INFO]: 	index_path: knn.index
2025-03-13 14:44:29,926 [INFO]: 	size in bytes: 636860050
2025-03-13 14:44:29,927 [INFO]: 	avg_search_speed_ms: 10.019829025947468
2025-03-13 14:44:29,927 [INFO]: 	99p_search_speed_ms: 14.871117537841194
2025-03-13 14:44:29,927 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:29,927 [INFO]: 	nb vectors: 3237
2025-03-13 14:44:29,929 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:29,929 [INFO]: 	compression ratio: 0.9993091826061314
2025-03-13 14:44:29,929 [INFO]: }
2025-03-13 14:44:29,929 [INFO]: 	>>> Finished "Creating the index" in 66.3249 secs
2025-03-13 14:44:29,929 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3503 secs
2025-03-13 14:44:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 11381 [episode count 7/20]
[retrieval_preprocessing] for episode 95377 [episode count 8/20], we have num_retrieval=np.int64(3181) num_query=np.int64(179)
2025-03-13 14:44:32,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:32,855 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:32
2025-03-13 14:44:32,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.74it/s]
2025-03-13 14:44:32,895 [INFO]: There are 3181 embeddings of dim 49152
2025-03-13 14:44:32,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 14:44:32,895 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:32
2025-03-13 14:44:32,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:32,896 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:44:32,896 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:32,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:44:32,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:32
2025-03-13 14:44:32,897 [INFO]: 656.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:32,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:44:32,897 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:32
2025-03-13 14:44:32,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:32,898 [INFO]: 	Creating the index 03/13/2025, 14:44:32
2025-03-13 14:44:32,898 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:32
2025-03-13 14:44:32,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:44:32,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:32
2025-03-13 14:44:32,901 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:44:32,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.25it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.82it/s] 92%|█████████▏| 12/13 [00:00<00:00, 40.37it/s]100%|██████████| 13/13 [00:02<00:00,  5.20it/s]
2025-03-13 14:44:35,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:35
2025-03-13 14:45:25,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2142 secs
2025-03-13 14:45:25,624 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 14:45:25,624 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s]
2025-03-13 14:45:48,444 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8193 secs
2025-03-13 14:45:48,828 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9264 secs
2025-03-13 14:45:48,828 [INFO]: {
2025-03-13 14:45:48,828 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:48,828 [INFO]: 	index_param: efSearch=129
2025-03-13 14:45:48,828 [INFO]: 	index_path: knn.index
2025-03-13 14:45:48,829 [INFO]: 	size in bytes: 625842070
2025-03-13 14:45:48,829 [INFO]: 	avg_search_speed_ms: 7.903683189074454
2025-03-13 14:45:48,829 [INFO]: 	99p_search_speed_ms: 13.102393830195068
2025-03-13 14:45:48,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:48,829 [INFO]: 	nb vectors: 3181
2025-03-13 14:45:48,829 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:48,829 [INFO]: 	compression ratio: 0.9993096948564036
2025-03-13 14:45:48,829 [INFO]: }
2025-03-13 14:45:48,829 [INFO]: 	>>> Finished "Creating the index" in 75.9311 secs
2025-03-13 14:45:48,829 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9737 secs
2025-03-13 14:45:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 95377 [episode count 8/20]
[retrieval_preprocessing] for episode 55939 [episode count 9/20], we have num_retrieval=np.int64(3149) num_query=np.int64(211)
2025-03-13 14:45:50,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:51,144 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:51
2025-03-13 14:45:51,144 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 993.20it/s]
2025-03-13 14:45:51,182 [INFO]: There are 3149 embeddings of dim 49152
2025-03-13 14:45:51,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 14:45:51,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:51
2025-03-13 14:45:51,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:51,182 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:45:51,182 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:51,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:51,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:51
2025-03-13 14:45:51,183 [INFO]: 649.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:51,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:45:51,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:51
2025-03-13 14:45:51,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:51,183 [INFO]: 	Creating the index 03/13/2025, 14:45:51
2025-03-13 14:45:51,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:51
2025-03-13 14:45:51,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:45:51,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:51
2025-03-13 14:45:51,184 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:45:51,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.86it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.89it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.59it/s]100%|██████████| 13/13 [00:02<00:00,  4.65it/s]
2025-03-13 14:45:53,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:53
2025-03-13 14:46:42,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0471 secs
2025-03-13 14:46:42,032 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 14:46:42,032 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.84it/s]
2025-03-13 14:46:58,508 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4761 secs
2025-03-13 14:46:58,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3256 secs
2025-03-13 14:46:58,510 [INFO]: {
2025-03-13 14:46:58,510 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:58,510 [INFO]: 	index_param: efSearch=149
2025-03-13 14:46:58,510 [INFO]: 	index_path: knn.index
2025-03-13 14:46:58,510 [INFO]: 	size in bytes: 619546270
2025-03-13 14:46:58,510 [INFO]: 	avg_search_speed_ms: 9.04850969617824
2025-03-13 14:46:58,510 [INFO]: 	99p_search_speed_ms: 14.225142439827325
2025-03-13 14:46:58,510 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:58,510 [INFO]: 	nb vectors: 3149
2025-03-13 14:46:58,510 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:58,510 [INFO]: 	compression ratio: 0.9993096915909122
2025-03-13 14:46:58,510 [INFO]: }
2025-03-13 14:46:58,510 [INFO]: 	>>> Finished "Creating the index" in 67.3274 secs
2025-03-13 14:46:58,510 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3666 secs
2025-03-13 14:46:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 55939 [episode count 9/20]
[retrieval_preprocessing] for episode 89237 [episode count 10/20], we have num_retrieval=np.int64(3113) num_query=np.int64(247)
2025-03-13 14:47:00,023 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:00,478 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:00
2025-03-13 14:47:00,478 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.58it/s]
2025-03-13 14:47:00,510 [INFO]: There are 3113 embeddings of dim 49152
2025-03-13 14:47:00,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 14:47:00,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:00
2025-03-13 14:47:00,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:00,510 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:47:00,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:00,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:00,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:00
2025-03-13 14:47:00,510 [INFO]: 642.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:00,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:47:00,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:00
2025-03-13 14:47:00,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:00,511 [INFO]: 	Creating the index 03/13/2025, 14:47:00
2025-03-13 14:47:00,511 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:00
2025-03-13 14:47:00,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:47:00,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:00
2025-03-13 14:47:00,512 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:47:00,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.93it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.35it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.48it/s]100%|██████████| 13/13 [00:02<00:00,  4.47it/s]
2025-03-13 14:47:03,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:03
2025-03-13 14:47:43,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9971 secs
2025-03-13 14:47:43,423 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 14:47:43,423 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.40it/s]
2025-03-13 14:48:04,384 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9602 secs
2025-03-13 14:48:04,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8737 secs
2025-03-13 14:48:04,386 [INFO]: {
2025-03-13 14:48:04,386 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:04,386 [INFO]: 	index_param: efSearch=158
2025-03-13 14:48:04,386 [INFO]: 	index_path: knn.index
2025-03-13 14:48:04,386 [INFO]: 	size in bytes: 612463450
2025-03-13 14:48:04,386 [INFO]: 	avg_search_speed_ms: 7.105904815034592
2025-03-13 14:48:04,386 [INFO]: 	99p_search_speed_ms: 10.333171326201409
2025-03-13 14:48:04,386 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:04,386 [INFO]: 	nb vectors: 3113
2025-03-13 14:48:04,386 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:04,386 [INFO]: 	compression ratio: 0.9993097612600392
2025-03-13 14:48:04,386 [INFO]: }
2025-03-13 14:48:04,386 [INFO]: 	>>> Finished "Creating the index" in 63.8755 secs
2025-03-13 14:48:04,386 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9080 secs
2025-03-13 14:48:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 89237 [episode count 10/20]
[retrieval_preprocessing] for episode 80041 [episode count 11/20], we have num_retrieval=np.int64(3156) num_query=np.int64(204)
2025-03-13 14:48:06,274 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:06,755 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:06
2025-03-13 14:48:06,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-13 14:48:06,786 [INFO]: There are 3156 embeddings of dim 49152
2025-03-13 14:48:06,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 14:48:06,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:06
2025-03-13 14:48:06,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:06,786 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:48:06,786 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:06,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:06,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:06
2025-03-13 14:48:06,787 [INFO]: 651.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:06,787 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:48:06,787 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:06
2025-03-13 14:48:06,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:06,787 [INFO]: 	Creating the index 03/13/2025, 14:48:06
2025-03-13 14:48:06,787 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:06
2025-03-13 14:48:06,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:48:06,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:06
2025-03-13 14:48:06,788 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:48:06,788 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.83it/s] 46%|████▌     | 6/13 [00:00<00:00, 26.95it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.14it/s]100%|██████████| 13/13 [00:02<00:00,  4.65it/s]
2025-03-13 14:48:09,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:09
2025-03-13 14:48:53,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1099 secs
2025-03-13 14:48:53,700 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 14:48:53,701 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.34it/s]
2025-03-13 14:49:17,868 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1679 secs
2025-03-13 14:49:17,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0824 secs
2025-03-13 14:49:17,870 [INFO]: {
2025-03-13 14:49:17,871 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:17,871 [INFO]: 	index_param: efSearch=174
2025-03-13 14:49:17,871 [INFO]: 	index_path: knn.index
2025-03-13 14:49:17,871 [INFO]: 	size in bytes: 620923510
2025-03-13 14:49:17,871 [INFO]: 	avg_search_speed_ms: 7.698303613176511
2025-03-13 14:49:17,871 [INFO]: 	99p_search_speed_ms: 10.676160189323127
2025-03-13 14:49:17,871 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:17,871 [INFO]: 	nb vectors: 3156
2025-03-13 14:49:17,871 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:17,871 [INFO]: 	compression ratio: 0.9993096379938972
2025-03-13 14:49:17,871 [INFO]: }
2025-03-13 14:49:17,871 [INFO]: 	>>> Finished "Creating the index" in 71.0838 secs
2025-03-13 14:49:17,871 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1154 secs
2025-03-13 14:49:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 80041 [episode count 11/20]
[retrieval_preprocessing] for episode 86730 [episode count 12/20], we have num_retrieval=np.int64(3208) num_query=np.int64(152)
2025-03-13 14:49:19,418 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:19,913 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:19
2025-03-13 14:49:19,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2359.00it/s]
2025-03-13 14:49:19,941 [INFO]: There are 3208 embeddings of dim 49152
2025-03-13 14:49:19,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 14:49:19,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:19,942 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:49:19,942 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:19,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:19,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,942 [INFO]: 662.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:19,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:19,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:19
2025-03-13 14:49:19,942 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:19,942 [INFO]: 	Creating the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,942 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:19
2025-03-13 14:49:19,943 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:49:19,943 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,943 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:49:19,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.78it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.14it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.33it/s]100%|██████████| 13/13 [00:03<00:00,  4.23it/s]
2025-03-13 14:49:23,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:23
2025-03-13 14:50:01,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5499 secs
2025-03-13 14:50:01,568 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 14:50:01,568 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-13 14:50:20,079 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5110 secs
2025-03-13 14:50:20,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1387 secs
2025-03-13 14:50:20,082 [INFO]: {
2025-03-13 14:50:20,082 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:20,082 [INFO]: 	index_param: efSearch=195
2025-03-13 14:50:20,082 [INFO]: 	index_path: knn.index
2025-03-13 14:50:20,082 [INFO]: 	size in bytes: 631154110
2025-03-13 14:50:20,082 [INFO]: 	avg_search_speed_ms: 13.051616203030157
2025-03-13 14:50:20,082 [INFO]: 	99p_search_speed_ms: 19.772795774042606
2025-03-13 14:50:20,082 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:20,082 [INFO]: 	nb vectors: 3208
2025-03-13 14:50:20,082 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:20,083 [INFO]: 	compression ratio: 0.9993097628723355
2025-03-13 14:50:20,083 [INFO]: }
2025-03-13 14:50:20,083 [INFO]: 	>>> Finished "Creating the index" in 60.1404 secs
2025-03-13 14:50:20,083 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1696 secs
2025-03-13 14:50:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 86730 [episode count 12/20]
[retrieval_preprocessing] for episode 95460 [episode count 13/20], we have num_retrieval=np.int64(3182) num_query=np.int64(178)
2025-03-13 14:50:21,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:22,494 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:22
2025-03-13 14:50:22,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1887.63it/s]
2025-03-13 14:50:22,525 [INFO]: There are 3182 embeddings of dim 49152
2025-03-13 14:50:22,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:50:22,525 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:22,526 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:50:22,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:22,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:22,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,526 [INFO]: 656.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:22,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:50:22,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:22
2025-03-13 14:50:22,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:22,526 [INFO]: 	Creating the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,526 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:22
2025-03-13 14:50:22,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:50:22,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,527 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:50:22,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.65it/s] 38%|███▊      | 5/13 [00:00<00:00, 25.66it/s] 69%|██████▉   | 9/13 [00:00<00:00, 31.35it/s]100%|██████████| 13/13 [00:03<00:00,  2.97it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-13 14:50:25,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:25
2025-03-13 14:51:12,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0151 secs
2025-03-13 14:51:12,778 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 14:51:12,778 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 14:51:30,576 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7972 secs
2025-03-13 14:51:30,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0521 secs
2025-03-13 14:51:30,580 [INFO]: {
2025-03-13 14:51:30,580 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:30,580 [INFO]: 	index_param: efSearch=202
2025-03-13 14:51:30,580 [INFO]: 	index_path: knn.index
2025-03-13 14:51:30,580 [INFO]: 	size in bytes: 626038810
2025-03-13 14:51:30,580 [INFO]: 	avg_search_speed_ms: 10.491882249075775
2025-03-13 14:51:30,580 [INFO]: 	99p_search_speed_ms: 14.289601249620318
2025-03-13 14:51:30,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:30,580 [INFO]: 	nb vectors: 3182
2025-03-13 14:51:30,580 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:30,580 [INFO]: 	compression ratio: 0.999309700943301
2025-03-13 14:51:30,580 [INFO]: }
2025-03-13 14:51:30,580 [INFO]: 	>>> Finished "Creating the index" in 68.0539 secs
2025-03-13 14:51:30,580 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0857 secs
2025-03-13 14:51:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 95460 [episode count 13/20]
[retrieval_preprocessing] for episode 71398 [episode count 14/20], we have num_retrieval=np.int64(3179) num_query=np.int64(181)
2025-03-13 14:51:34,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:35,700 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:35
2025-03-13 14:51:35,700 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1028.52it/s]
2025-03-13 14:51:35,735 [INFO]: There are 3179 embeddings of dim 49152
2025-03-13 14:51:35,735 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 14:51:35,735 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:35
2025-03-13 14:51:35,735 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:35,735 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:51:35,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:35,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:35,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:35
2025-03-13 14:51:35,736 [INFO]: 656.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:35,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:51:35,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:35
2025-03-13 14:51:35,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:35,736 [INFO]: 	Creating the index 03/13/2025, 14:51:35
2025-03-13 14:51:35,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:35
2025-03-13 14:51:35,737 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:51:35,737 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:35
2025-03-13 14:51:35,737 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:51:35,737 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.96it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.05it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.83it/s]100%|██████████| 13/13 [00:02<00:00,  4.47it/s]
2025-03-13 14:51:38,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:38
2025-03-13 14:52:23,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5561 secs
2025-03-13 14:52:23,210 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 14:52:23,210 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.62it/s]
2025-03-13 14:52:38,943 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7331 secs
2025-03-13 14:52:38,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2080 secs
2025-03-13 14:52:38,945 [INFO]: {
2025-03-13 14:52:38,945 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:38,945 [INFO]: 	index_param: efSearch=210
2025-03-13 14:52:38,945 [INFO]: 	index_path: knn.index
2025-03-13 14:52:38,945 [INFO]: 	size in bytes: 625448590
2025-03-13 14:52:38,945 [INFO]: 	avg_search_speed_ms: 10.861620471037188
2025-03-13 14:52:38,946 [INFO]: 	99p_search_speed_ms: 15.518037090077994
2025-03-13 14:52:38,946 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:38,946 [INFO]: 	nb vectors: 3179
2025-03-13 14:52:38,946 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:38,946 [INFO]: 	compression ratio: 0.9993096826711209
2025-03-13 14:52:38,946 [INFO]: }
2025-03-13 14:52:38,946 [INFO]: 	>>> Finished "Creating the index" in 63.2097 secs
2025-03-13 14:52:38,946 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2456 secs
2025-03-13 14:52:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 71398 [episode count 14/20]
[retrieval_preprocessing] for episode 61175 [episode count 15/20], we have num_retrieval=np.int64(3259) num_query=np.int64(101)
2025-03-13 14:52:40,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:42,115 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:42
2025-03-13 14:52:42,116 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.06it/s]
2025-03-13 14:52:42,146 [INFO]: There are 3259 embeddings of dim 49152
2025-03-13 14:52:42,146 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 14:52:42,146 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,146 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:42,147 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:52:42,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:42,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:52:42,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,147 [INFO]: 672.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:42,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:52:42,147 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:42
2025-03-13 14:52:42,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:42,147 [INFO]: 	Creating the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,147 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:42
2025-03-13 14:52:42,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:52:42,148 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,148 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:52:42,148 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.70it/s] 46%|████▌     | 6/13 [00:00<00:00, 26.37it/s] 77%|███████▋  | 10/13 [00:00<00:00, 31.48it/s]100%|██████████| 13/13 [00:03<00:00,  3.73it/s]
2025-03-13 14:52:45,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:45
2025-03-13 14:53:32,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9004 secs
2025-03-13 14:53:32,536 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 14:53:32,536 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-13 14:53:54,209 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6729 secs
2025-03-13 14:53:54,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0644 secs
2025-03-13 14:53:54,213 [INFO]: {
2025-03-13 14:53:54,213 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:54,213 [INFO]: 	index_param: efSearch=182
2025-03-13 14:53:54,213 [INFO]: 	index_path: knn.index
2025-03-13 14:53:54,213 [INFO]: 	size in bytes: 641188450
2025-03-13 14:53:54,213 [INFO]: 	avg_search_speed_ms: 9.853262635718647
2025-03-13 14:53:54,213 [INFO]: 	99p_search_speed_ms: 13.660214571282268
2025-03-13 14:53:54,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:54,213 [INFO]: 	nb vectors: 3259
2025-03-13 14:53:54,213 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:54,213 [INFO]: 	compression ratio: 0.999309129788598
2025-03-13 14:53:54,213 [INFO]: }
2025-03-13 14:53:54,213 [INFO]: 	>>> Finished "Creating the index" in 72.0660 secs
2025-03-13 14:53:54,213 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0976 secs
2025-03-13 14:53:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 61175 [episode count 15/20]
[retrieval_preprocessing] for episode 34046 [episode count 16/20], we have num_retrieval=np.int64(3201) num_query=np.int64(159)
2025-03-13 14:53:55,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:55,945 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:55
2025-03-13 14:53:55,945 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.12it/s]
2025-03-13 14:53:55,980 [INFO]: There are 3201 embeddings of dim 49152
2025-03-13 14:53:55,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 14:53:55,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:55
2025-03-13 14:53:55,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:55,981 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:53:55,981 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:55,981 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:53:55,981 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:55
2025-03-13 14:53:55,981 [INFO]: 660.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:55,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:53:55,981 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:55
2025-03-13 14:53:55,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:55,981 [INFO]: 	Creating the index 03/13/2025, 14:53:55
2025-03-13 14:53:55,981 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:55
2025-03-13 14:53:55,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:55,983 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:55
2025-03-13 14:53:55,983 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:53:55,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.47it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.15it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.32it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-13 14:53:59,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:59
2025-03-13 14:54:37,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8364 secs
2025-03-13 14:54:37,954 [INFO]: The best hyperparameters are: efSearch=68
2025-03-13 14:54:37,954 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.99it/s]
2025-03-13 14:55:29,355 [INFO]: 	>>> Finished "Compute fast metrics" in 51.4003 secs
2025-03-13 14:55:29,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.3847 secs
2025-03-13 14:55:29,368 [INFO]: {
2025-03-13 14:55:29,368 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:29,368 [INFO]: 	index_param: efSearch=68
2025-03-13 14:55:29,368 [INFO]: 	index_path: knn.index
2025-03-13 14:55:29,368 [INFO]: 	size in bytes: 629776870
2025-03-13 14:55:29,368 [INFO]: 	avg_search_speed_ms: 4.892696412396617
2025-03-13 14:55:29,368 [INFO]: 	99p_search_speed_ms: 7.2087803785689175
2025-03-13 14:55:29,368 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:29,368 [INFO]: 	nb vectors: 3201
2025-03-13 14:55:29,368 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:29,368 [INFO]: 	compression ratio: 0.9993098158717706
2025-03-13 14:55:29,368 [INFO]: }
2025-03-13 14:55:29,368 [INFO]: 	>>> Finished "Creating the index" in 93.3863 secs
2025-03-13 14:55:29,368 [INFO]: >>> Finished "Launching the whole pipeline" in 93.4225 secs
2025-03-13 14:55:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 34046 [episode count 16/20]
[retrieval_preprocessing] for episode 74526 [episode count 17/20], we have num_retrieval=np.int64(3187) num_query=np.int64(173)
2025-03-13 14:55:30,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:31,636 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:31
2025-03-13 14:55:31,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.45it/s]
2025-03-13 14:55:31,684 [INFO]: There are 3187 embeddings of dim 49152
2025-03-13 14:55:31,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0482 secs
2025-03-13 14:55:31,685 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:31
2025-03-13 14:55:31,685 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:31,685 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:55:31,685 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:31,685 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:55:31,685 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:31
2025-03-13 14:55:31,685 [INFO]: 657.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:31,685 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:55:31,685 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:31
2025-03-13 14:55:31,685 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:31,685 [INFO]: 	Creating the index 03/13/2025, 14:55:31
2025-03-13 14:55:31,686 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:31
2025-03-13 14:55:31,687 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:55:31,687 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:31
2025-03-13 14:55:31,687 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:55:31,687 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.06it/s] 38%|███▊      | 5/13 [00:00<00:00, 20.96it/s] 69%|██████▉   | 9/13 [00:00<00:00, 26.78it/s]100%|██████████| 13/13 [00:03<00:00,  2.81it/s]100%|██████████| 13/13 [00:03<00:00,  3.79it/s]
2025-03-13 14:55:35,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:35
2025-03-13 14:56:25,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8925 secs
2025-03-13 14:56:25,018 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:56:25,018 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.73it/s] 50%|█████     | 2/4 [00:00<00:00,  4.31it/s] 75%|███████▌  | 3/4 [00:02<00:01,  1.25s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.09s/it]
2025-03-13 14:56:56,211 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1929 secs
2025-03-13 14:56:56,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.5267 secs
2025-03-13 14:56:56,214 [INFO]: {
2025-03-13 14:56:56,214 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:56,214 [INFO]: 	index_param: efSearch=156
2025-03-13 14:56:56,214 [INFO]: 	index_path: knn.index
2025-03-13 14:56:56,214 [INFO]: 	size in bytes: 627022510
2025-03-13 14:56:56,214 [INFO]: 	avg_search_speed_ms: 8.278948655590995
2025-03-13 14:56:56,214 [INFO]: 	99p_search_speed_ms: 11.923025695141407
2025-03-13 14:56:56,214 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:56,214 [INFO]: 	nb vectors: 3187
2025-03-13 14:56:56,214 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:56,214 [INFO]: 	compression ratio: 0.9993097313204912
2025-03-13 14:56:56,214 [INFO]: }
2025-03-13 14:56:56,214 [INFO]: 	>>> Finished "Creating the index" in 84.5286 secs
2025-03-13 14:56:56,214 [INFO]: >>> Finished "Launching the whole pipeline" in 84.5778 secs
2025-03-13 14:56:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 74526 [episode count 17/20]
[retrieval_preprocessing] for episode 52159 [episode count 18/20], we have num_retrieval=np.int64(3219) num_query=np.int64(141)
2025-03-13 14:56:58,030 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:58,708 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:58
2025-03-13 14:56:58,708 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-13 14:56:58,744 [INFO]: There are 3219 embeddings of dim 49152
2025-03-13 14:56:58,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 14:56:58,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:58
2025-03-13 14:56:58,745 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:58,745 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:56:58,745 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:58,745 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:56:58,745 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:58
2025-03-13 14:56:58,745 [INFO]: 664.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:58,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:56:58,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:58
2025-03-13 14:56:58,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:58,745 [INFO]: 	Creating the index 03/13/2025, 14:56:58
2025-03-13 14:56:58,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:58
2025-03-13 14:56:58,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:56:58,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:58
2025-03-13 14:56:58,746 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:56:58,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.92it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.42it/s] 69%|██████▉   | 9/13 [00:00<00:00, 28.54it/s]100%|██████████| 13/13 [00:03<00:00,  2.85it/s]100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
2025-03-13 14:57:02,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:02
2025-03-13 14:57:50,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0549 secs
2025-03-13 14:57:50,182 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 14:57:50,182 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.31it/s]
2025-03-13 14:58:13,418 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2354 secs
2025-03-13 14:58:13,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6740 secs
2025-03-13 14:58:13,421 [INFO]: {
2025-03-13 14:58:13,421 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:13,421 [INFO]: 	index_param: efSearch=232
2025-03-13 14:58:13,421 [INFO]: 	index_path: knn.index
2025-03-13 14:58:13,421 [INFO]: 	size in bytes: 633318310
2025-03-13 14:58:13,421 [INFO]: 	avg_search_speed_ms: 14.849575774644665
2025-03-13 14:58:13,421 [INFO]: 	99p_search_speed_ms: 24.30247166194021
2025-03-13 14:58:13,421 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:13,421 [INFO]: 	nb vectors: 3219
2025-03-13 14:58:13,421 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:13,421 [INFO]: 	compression ratio: 0.9993097341524833
2025-03-13 14:58:13,421 [INFO]: }
2025-03-13 14:58:13,421 [INFO]: 	>>> Finished "Creating the index" in 74.6758 secs
2025-03-13 14:58:13,421 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7127 secs
2025-03-13 14:58:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 52159 [episode count 18/20]
[retrieval_preprocessing] for episode 79223 [episode count 19/20], we have num_retrieval=np.int64(3213) num_query=np.int64(147)
2025-03-13 14:58:15,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:16,462 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:16
2025-03-13 14:58:16,462 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1738.21it/s]
2025-03-13 14:58:16,496 [INFO]: There are 3213 embeddings of dim 49152
2025-03-13 14:58:16,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 14:58:16,497 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:16,498 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:58:16,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:16,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:58:16,498 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,498 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:16,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:58:16,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:16
2025-03-13 14:58:16,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:16,499 [INFO]: 	Creating the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:16
2025-03-13 14:58:16,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:58:16,503 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,504 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:58:16,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.44it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.15it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.38it/s]100%|██████████| 13/13 [00:03<00:00,  3.42it/s]
2025-03-13 14:58:20,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:20
2025-03-13 14:59:12,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2466 secs
2025-03-13 14:59:12,562 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 14:59:12,562 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.48it/s]
2025-03-13 14:59:39,497 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9357 secs
2025-03-13 14:59:39,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9963 secs
2025-03-13 14:59:39,500 [INFO]: {
2025-03-13 14:59:39,500 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:39,500 [INFO]: 	index_param: efSearch=212
2025-03-13 14:59:39,500 [INFO]: 	index_path: knn.index
2025-03-13 14:59:39,500 [INFO]: 	size in bytes: 632137810
2025-03-13 14:59:39,500 [INFO]: 	avg_search_speed_ms: 11.737072143753982
2025-03-13 14:59:39,500 [INFO]: 	99p_search_speed_ms: 17.621419371571392
2025-03-13 14:59:39,500 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:39,500 [INFO]: 	nb vectors: 3213
2025-03-13 14:59:39,500 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:39,500 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-13 14:59:39,500 [INFO]: }
2025-03-13 14:59:39,500 [INFO]: 	>>> Finished "Creating the index" in 83.0005 secs
2025-03-13 14:59:39,500 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0383 secs
2025-03-13 14:59:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 79223 [episode count 19/20]
2025-03-13 14:59:41: [retrieval_preprocessing] finished for 3854327802_move_right [chosen_id count 0/196]
2025-03-13 14:59:42: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3895077471_press_button_on_coffee_maker [chosen_id count 1/196]
2025-03-13 14:59:42: [retrieval_preprocessing] we have num_total=2396 embedding_dim=49152
[retrieval_preprocessing] for episode 27655 [episode count 0/20], we have num_retrieval=np.int64(2300) num_query=np.int64(96)
2025-03-13 14:59:42,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:43,618 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:43
2025-03-13 14:59:43,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.01it/s]
2025-03-13 14:59:43,647 [INFO]: There are 2300 embeddings of dim 49152
2025-03-13 14:59:43,647 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 14:59:43,647 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,647 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:43,647 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 14:59:43,647 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:43,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:43,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,647 [INFO]: 474.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:43,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:43,647 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:43
2025-03-13 14:59:43,647 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:43,648 [INFO]: 	Creating the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:43
2025-03-13 14:59:43,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:59:43,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,649 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:59:43,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.59it/s] 60%|██████    | 6/10 [00:00<00:00, 28.32it/s]100%|██████████| 10/10 [00:01<00:00,  4.09it/s]100%|██████████| 10/10 [00:01<00:00,  5.00it/s]
2025-03-13 14:59:45,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:45
2025-03-13 15:00:20,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8198 secs
2025-03-13 15:00:20,474 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:00:20,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.84it/s]
2025-03-13 15:00:42,406 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9327 secs
2025-03-13 15:00:42,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7595 secs
2025-03-13 15:00:42,409 [INFO]: {
2025-03-13 15:00:42,409 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:42,409 [INFO]: 	index_param: efSearch=158
2025-03-13 15:00:42,409 [INFO]: 	index_path: knn.index
2025-03-13 15:00:42,409 [INFO]: 	size in bytes: 452510890
2025-03-13 15:00:42,409 [INFO]: 	avg_search_speed_ms: 7.895395270251561
2025-03-13 15:00:42,409 [INFO]: 	99p_search_speed_ms: 16.15402401657774
2025-03-13 15:00:42,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:42,409 [INFO]: 	nb vectors: 2300
2025-03-13 15:00:42,409 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:42,409 [INFO]: 	compression ratio: 0.9993094309840809
2025-03-13 15:00:42,409 [INFO]: }
2025-03-13 15:00:42,409 [INFO]: 	>>> Finished "Creating the index" in 58.7613 secs
2025-03-13 15:00:42,409 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7907 secs
2025-03-13 15:00:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 27655 [episode count 0/20]
[retrieval_preprocessing] for episode 1045 [episode count 1/20], we have num_retrieval=np.int64(2259) num_query=np.int64(137)
2025-03-13 15:00:43,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:43,933 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:43
2025-03-13 15:00:43,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1993.49it/s]
2025-03-13 15:00:43,964 [INFO]: There are 2259 embeddings of dim 49152
2025-03-13 15:00:43,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:00:43,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:43
2025-03-13 15:00:43,965 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:43,965 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:00:43,965 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:43,965 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:00:43,965 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:43
2025-03-13 15:00:43,966 [INFO]: 466.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:43,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:00:43,966 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:43
2025-03-13 15:00:43,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:43,966 [INFO]: 	Creating the index 03/13/2025, 15:00:43
2025-03-13 15:00:43,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:43
2025-03-13 15:00:43,970 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:00:43,970 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:43
2025-03-13 15:00:43,970 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:00:43,970 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.33it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.14it/s]100%|██████████| 9/9 [00:01<00:00,  4.90it/s]
2025-03-13 15:00:46,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:46
2025-03-13 15:01:16,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1280 secs
2025-03-13 15:01:16,200 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 15:01:16,200 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.16it/s]
2025-03-13 15:01:37,389 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1892 secs
2025-03-13 15:01:37,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4209 secs
2025-03-13 15:01:37,391 [INFO]: {
2025-03-13 15:01:37,391 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:37,391 [INFO]: 	index_param: efSearch=278
2025-03-13 15:01:37,391 [INFO]: 	index_path: knn.index
2025-03-13 15:01:37,391 [INFO]: 	size in bytes: 444444370
2025-03-13 15:01:37,391 [INFO]: 	avg_search_speed_ms: 10.660389144626905
2025-03-13 15:01:37,391 [INFO]: 	99p_search_speed_ms: 14.910857731010765
2025-03-13 15:01:37,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:37,391 [INFO]: 	nb vectors: 2259
2025-03-13 15:01:37,391 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:37,391 [INFO]: 	compression ratio: 0.9993094793843378
2025-03-13 15:01:37,391 [INFO]: }
2025-03-13 15:01:37,391 [INFO]: 	>>> Finished "Creating the index" in 53.4245 secs
2025-03-13 15:01:37,391 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4578 secs
2025-03-13 15:01:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 1045 [episode count 1/20]
[retrieval_preprocessing] for episode 52758 [episode count 2/20], we have num_retrieval=np.int64(2294) num_query=np.int64(102)
2025-03-13 15:01:38,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:39,210 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:39
2025-03-13 15:01:39,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 15:01:39,237 [INFO]: There are 2294 embeddings of dim 49152
2025-03-13 15:01:39,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:01:39,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:39
2025-03-13 15:01:39,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:39,238 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:01:39,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:39,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:01:39,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:39
2025-03-13 15:01:39,238 [INFO]: 473.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:39,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:01:39,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:39
2025-03-13 15:01:39,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:39,238 [INFO]: 	Creating the index 03/13/2025, 15:01:39
2025-03-13 15:01:39,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:39
2025-03-13 15:01:39,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:01:39,239 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:39
2025-03-13 15:01:39,239 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:01:39,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.78it/s] 80%|████████  | 8/10 [00:00<00:00, 38.35it/s]100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
2025-03-13 15:01:40,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:40
2025-03-13 15:02:08,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6542 secs
2025-03-13 15:02:08,423 [INFO]: The best hyperparameters are: efSearch=339
2025-03-13 15:02:08,423 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.21it/s]
2025-03-13 15:02:33,902 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4793 secs
2025-03-13 15:02:33,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6648 secs
2025-03-13 15:02:33,904 [INFO]: {
2025-03-13 15:02:33,904 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:33,904 [INFO]: 	index_param: efSearch=339
2025-03-13 15:02:33,904 [INFO]: 	index_path: knn.index
2025-03-13 15:02:33,904 [INFO]: 	size in bytes: 451330450
2025-03-13 15:02:33,904 [INFO]: 	avg_search_speed_ms: 12.961634978232182
2025-03-13 15:02:33,904 [INFO]: 	99p_search_speed_ms: 22.192005834076554
2025-03-13 15:02:33,904 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:33,904 [INFO]: 	nb vectors: 2294
2025-03-13 15:02:33,904 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:33,904 [INFO]: 	compression ratio: 0.9993093796352539
2025-03-13 15:02:33,904 [INFO]: }
2025-03-13 15:02:33,904 [INFO]: 	>>> Finished "Creating the index" in 54.6665 secs
2025-03-13 15:02:33,904 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6948 secs
2025-03-13 15:02:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 52758 [episode count 2/20]
[retrieval_preprocessing] for episode 94758 [episode count 3/20], we have num_retrieval=np.int64(2263) num_query=np.int64(133)
2025-03-13 15:02:35,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:36,778 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:36
2025-03-13 15:02:36,778 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1016.55it/s]
2025-03-13 15:02:36,814 [INFO]: There are 2263 embeddings of dim 49152
2025-03-13 15:02:36,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 15:02:36,815 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:36,816 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:02:36,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:36,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:02:36,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,816 [INFO]: 467.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:36,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:02:36,817 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:36
2025-03-13 15:02:36,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:36,817 [INFO]: 	Creating the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,818 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:36
2025-03-13 15:02:36,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:02:36,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,821 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:02:36,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.89it/s] 44%|████▍     | 4/9 [00:00<00:00, 20.46it/s] 78%|███████▊  | 7/9 [00:00<00:00, 24.42it/s]100%|██████████| 9/9 [00:02<00:00,  3.29it/s]
2025-03-13 15:02:39,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:39
2025-03-13 15:03:12,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0475 secs
2025-03-13 15:03:12,616 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 15:03:12,616 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.94it/s]
2025-03-13 15:03:35,433 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8162 secs
2025-03-13 15:03:35,435 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6139 secs
2025-03-13 15:03:35,435 [INFO]: {
2025-03-13 15:03:35,435 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:35,435 [INFO]: 	index_param: efSearch=164
2025-03-13 15:03:35,435 [INFO]: 	index_path: knn.index
2025-03-13 15:03:35,435 [INFO]: 	size in bytes: 445231390
2025-03-13 15:03:35,435 [INFO]: 	avg_search_speed_ms: 8.766568297892482
2025-03-13 15:03:35,435 [INFO]: 	99p_search_speed_ms: 13.941517286002616
2025-03-13 15:03:35,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:35,436 [INFO]: 	nb vectors: 2263
2025-03-13 15:03:35,436 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:35,436 [INFO]: 	compression ratio: 0.999309379331947
2025-03-13 15:03:35,436 [INFO]: }
2025-03-13 15:03:35,436 [INFO]: 	>>> Finished "Creating the index" in 58.6182 secs
2025-03-13 15:03:35,436 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6577 secs
2025-03-13 15:03:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 94758 [episode count 3/20]
[retrieval_preprocessing] for episode 93224 [episode count 4/20], we have num_retrieval=np.int64(2298) num_query=np.int64(98)
2025-03-13 15:03:36,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:37,104 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:37
2025-03-13 15:03:37,104 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.32it/s]
2025-03-13 15:03:37,132 [INFO]: There are 2298 embeddings of dim 49152
2025-03-13 15:03:37,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:03:37,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:37
2025-03-13 15:03:37,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:37,133 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:03:37,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:37,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:37,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:37
2025-03-13 15:03:37,133 [INFO]: 474.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:37,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:03:37,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:37
2025-03-13 15:03:37,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:37,133 [INFO]: 	Creating the index 03/13/2025, 15:03:37
2025-03-13 15:03:37,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:37
2025-03-13 15:03:37,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:03:37,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:37
2025-03-13 15:03:37,134 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:03:37,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.12it/s] 50%|█████     | 5/10 [00:00<00:00, 23.01it/s] 90%|█████████ | 9/10 [00:00<00:00, 29.65it/s]100%|██████████| 10/10 [00:01<00:00,  5.31it/s]
2025-03-13 15:03:39,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:39
2025-03-13 15:04:17,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0396 secs
2025-03-13 15:04:17,062 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 15:04:17,062 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.34it/s]
2025-03-13 15:04:35,430 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3687 secs
2025-03-13 15:04:35,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2982 secs
2025-03-13 15:04:35,432 [INFO]: {
2025-03-13 15:04:35,432 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:35,432 [INFO]: 	index_param: efSearch=194
2025-03-13 15:04:35,432 [INFO]: 	index_path: knn.index
2025-03-13 15:04:35,432 [INFO]: 	size in bytes: 452117410
2025-03-13 15:04:35,432 [INFO]: 	avg_search_speed_ms: 8.461423528691133
2025-03-13 15:04:35,432 [INFO]: 	99p_search_speed_ms: 11.485944485757502
2025-03-13 15:04:35,432 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:35,432 [INFO]: 	nb vectors: 2298
2025-03-13 15:04:35,433 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:35,433 [INFO]: 	compression ratio: 0.999309413897598
2025-03-13 15:04:35,433 [INFO]: }
2025-03-13 15:04:35,433 [INFO]: 	>>> Finished "Creating the index" in 58.2997 secs
2025-03-13 15:04:35,433 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3284 secs
2025-03-13 15:04:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 93224 [episode count 4/20]
[retrieval_preprocessing] for episode 65577 [episode count 5/20], we have num_retrieval=np.int64(2296) num_query=np.int64(100)
2025-03-13 15:04:36,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:37,641 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:37
2025-03-13 15:04:37,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-13 15:04:37,668 [INFO]: There are 2296 embeddings of dim 49152
2025-03-13 15:04:37,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:04:37,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:37
2025-03-13 15:04:37,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:37,668 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:04:37,668 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:37,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:37,668 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:37
2025-03-13 15:04:37,668 [INFO]: 473.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:37,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:04:37,668 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:37
2025-03-13 15:04:37,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:37,668 [INFO]: 	Creating the index 03/13/2025, 15:04:37
2025-03-13 15:04:37,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:37
2025-03-13 15:04:37,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:04:37,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:37
2025-03-13 15:04:37,669 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:04:37,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.61it/s] 60%|██████    | 6/10 [00:00<00:00, 29.07it/s]100%|██████████| 10/10 [00:01<00:00,  4.26it/s]100%|██████████| 10/10 [00:01<00:00,  5.07it/s]
2025-03-13 15:04:39,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:39
2025-03-13 15:05:11,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3828 secs
2025-03-13 15:05:11,029 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 15:05:11,029 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 15:05:30,047 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0183 secs
2025-03-13 15:05:30,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3801 secs
2025-03-13 15:05:30,050 [INFO]: {
2025-03-13 15:05:30,050 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:30,050 [INFO]: 	index_param: efSearch=171
2025-03-13 15:05:30,050 [INFO]: 	index_path: knn.index
2025-03-13 15:05:30,050 [INFO]: 	size in bytes: 451723930
2025-03-13 15:05:30,050 [INFO]: 	avg_search_speed_ms: 8.68263685273026
2025-03-13 15:05:30,050 [INFO]: 	99p_search_speed_ms: 12.770480432081968
2025-03-13 15:05:30,050 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:30,050 [INFO]: 	nb vectors: 2296
2025-03-13 15:05:30,050 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:30,050 [INFO]: 	compression ratio: 0.9993093967813483
2025-03-13 15:05:30,050 [INFO]: }
2025-03-13 15:05:30,050 [INFO]: 	>>> Finished "Creating the index" in 52.3815 secs
2025-03-13 15:05:30,050 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4083 secs
2025-03-13 15:05:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 65577 [episode count 5/20]
[retrieval_preprocessing] for episode 8276 [episode count 6/20], we have num_retrieval=np.int64(2281) num_query=np.int64(115)
2025-03-13 15:05:31,189 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:31,654 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:31
2025-03-13 15:05:31,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-13 15:05:31,687 [INFO]: There are 2281 embeddings of dim 49152
2025-03-13 15:05:31,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 15:05:31,687 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:31,688 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:05:31,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:31,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:05:31,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,688 [INFO]: 470.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:31,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:05:31,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:31
2025-03-13 15:05:31,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:31,689 [INFO]: 	Creating the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:31
2025-03-13 15:05:31,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:05:31,693 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,693 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:05:31,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.49it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.28it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]100%|██████████| 9/9 [00:02<00:00,  3.86it/s]
2025-03-13 15:05:34,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:34
2025-03-13 15:06:05,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5193 secs
2025-03-13 15:06:05,547 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 15:06:05,547 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 15:06:25,874 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3268 secs
2025-03-13 15:06:25,877 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1837 secs
2025-03-13 15:06:25,877 [INFO]: {
2025-03-13 15:06:25,877 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:25,877 [INFO]: 	index_param: efSearch=237
2025-03-13 15:06:25,877 [INFO]: 	index_path: knn.index
2025-03-13 15:06:25,877 [INFO]: 	size in bytes: 448772710
2025-03-13 15:06:25,877 [INFO]: 	avg_search_speed_ms: 10.385594432757681
2025-03-13 15:06:25,877 [INFO]: 	99p_search_speed_ms: 15.243246899917722
2025-03-13 15:06:25,877 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:25,877 [INFO]: 	nb vectors: 2281
2025-03-13 15:06:25,877 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:25,877 [INFO]: 	compression ratio: 0.9993095346639951
2025-03-13 15:06:25,877 [INFO]: }
2025-03-13 15:06:25,877 [INFO]: 	>>> Finished "Creating the index" in 54.1879 secs
2025-03-13 15:06:25,877 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2227 secs
2025-03-13 15:06:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 8276 [episode count 6/20]
[retrieval_preprocessing] for episode 91224 [episode count 7/20], we have num_retrieval=np.int64(2245) num_query=np.int64(151)
2025-03-13 15:06:27,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:27,757 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:27
2025-03-13 15:06:27,758 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.69it/s]
2025-03-13 15:06:27,784 [INFO]: There are 2245 embeddings of dim 49152
2025-03-13 15:06:27,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:06:27,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:27
2025-03-13 15:06:27,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:27,785 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:06:27,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:27,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:27,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:27
2025-03-13 15:06:27,785 [INFO]: 463.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:27,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:06:27,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:27
2025-03-13 15:06:27,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:27,785 [INFO]: 	Creating the index 03/13/2025, 15:06:27
2025-03-13 15:06:27,785 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:27
2025-03-13 15:06:27,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:06:27,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:27
2025-03-13 15:06:27,787 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:06:27,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.19it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.90it/s]100%|██████████| 9/9 [00:02<00:00,  3.51it/s]100%|██████████| 9/9 [00:02<00:00,  4.32it/s]
2025-03-13 15:06:29,873 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:29
2025-03-13 15:07:03,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6220 secs
2025-03-13 15:07:03,496 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 15:07:03,496 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.24it/s]
2025-03-13 15:07:25,804 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3086 secs
2025-03-13 15:07:25,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0465 secs
2025-03-13 15:07:25,833 [INFO]: {
2025-03-13 15:07:25,834 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:25,834 [INFO]: 	index_param: efSearch=241
2025-03-13 15:07:25,834 [INFO]: 	index_path: knn.index
2025-03-13 15:07:25,834 [INFO]: 	size in bytes: 441690010
2025-03-13 15:07:25,834 [INFO]: 	avg_search_speed_ms: 11.94530426638074
2025-03-13 15:07:25,834 [INFO]: 	99p_search_speed_ms: 23.503053905442354
2025-03-13 15:07:25,834 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:25,834 [INFO]: 	nb vectors: 2245
2025-03-13 15:07:25,834 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:25,834 [INFO]: 	compression ratio: 0.9993093572571405
2025-03-13 15:07:25,834 [INFO]: }
2025-03-13 15:07:25,834 [INFO]: 	>>> Finished "Creating the index" in 58.0483 secs
2025-03-13 15:07:25,834 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0763 secs
2025-03-13 15:07:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 91224 [episode count 7/20]
[retrieval_preprocessing] for episode 53861 [episode count 8/20], we have num_retrieval=np.int64(2262) num_query=np.int64(134)
2025-03-13 15:07:28,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:28,568 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:28
2025-03-13 15:07:28,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.09it/s]
2025-03-13 15:07:28,597 [INFO]: There are 2262 embeddings of dim 49152
2025-03-13 15:07:28,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:07:28,597 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:28,598 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:07:28,598 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:28,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:28,598 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,598 [INFO]: 466.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:28,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:28,598 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:28
2025-03-13 15:07:28,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:28,598 [INFO]: 	Creating the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,598 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:28
2025-03-13 15:07:28,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:07:28,599 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,599 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:07:28,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.58it/s] 56%|█████▌    | 5/9 [00:00<00:00, 24.89it/s]100%|██████████| 9/9 [00:02<00:00,  2.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]
2025-03-13 15:07:31,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:31
2025-03-13 15:08:10,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1156 secs
2025-03-13 15:08:10,553 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:08:10,553 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 15:08:28,916 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3624 secs
2025-03-13 15:08:28,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3186 secs
2025-03-13 15:08:28,918 [INFO]: {
2025-03-13 15:08:28,918 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:28,918 [INFO]: 	index_param: efSearch=229
2025-03-13 15:08:28,918 [INFO]: 	index_path: knn.index
2025-03-13 15:08:28,918 [INFO]: 	size in bytes: 445034650
2025-03-13 15:08:28,918 [INFO]: 	avg_search_speed_ms: 9.28409580213079
2025-03-13 15:08:28,918 [INFO]: 	99p_search_speed_ms: 17.043837439268827
2025-03-13 15:08:28,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:28,918 [INFO]: 	nb vectors: 2262
2025-03-13 15:08:28,918 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:28,918 [INFO]: 	compression ratio: 0.9993093706299049
2025-03-13 15:08:28,918 [INFO]: }
2025-03-13 15:08:28,918 [INFO]: 	>>> Finished "Creating the index" in 60.3205 secs
2025-03-13 15:08:28,918 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3498 secs
2025-03-13 15:08:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 53861 [episode count 8/20]
[retrieval_preprocessing] for episode 73828 [episode count 9/20], we have num_retrieval=np.int64(2298) num_query=np.int64(98)
2025-03-13 15:08:30,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:31,136 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:31
2025-03-13 15:08:31,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 986.90it/s]
2025-03-13 15:08:31,169 [INFO]: There are 2298 embeddings of dim 49152
2025-03-13 15:08:31,169 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 15:08:31,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:31
2025-03-13 15:08:31,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:31,170 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:08:31,170 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:31,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:08:31,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:31
2025-03-13 15:08:31,171 [INFO]: 474.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:31,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:08:31,172 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:31
2025-03-13 15:08:31,172 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:31,172 [INFO]: 	Creating the index 03/13/2025, 15:08:31
2025-03-13 15:08:31,172 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:31
2025-03-13 15:08:31,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:08:31,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:31
2025-03-13 15:08:31,175 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:31,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.01it/s] 60%|██████    | 6/10 [00:00<00:00, 29.09it/s]100%|██████████| 10/10 [00:01<00:00,  4.52it/s]100%|██████████| 10/10 [00:01<00:00,  5.51it/s]
2025-03-13 15:08:32,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:32
2025-03-13 15:09:04,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2251 secs
2025-03-13 15:09:04,223 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 15:09:04,223 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.95it/s]
2025-03-13 15:09:23,537 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3139 secs
2025-03-13 15:09:23,541 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3654 secs
2025-03-13 15:09:23,541 [INFO]: {
2025-03-13 15:09:23,541 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:23,541 [INFO]: 	index_param: efSearch=254
2025-03-13 15:09:23,541 [INFO]: 	index_path: knn.index
2025-03-13 15:09:23,541 [INFO]: 	size in bytes: 452117410
2025-03-13 15:09:23,541 [INFO]: 	avg_search_speed_ms: 16.33913835455917
2025-03-13 15:09:23,541 [INFO]: 	99p_search_speed_ms: 22.398486994206905
2025-03-13 15:09:23,541 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:23,541 [INFO]: 	nb vectors: 2298
2025-03-13 15:09:23,541 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:23,541 [INFO]: 	compression ratio: 0.999309413897598
2025-03-13 15:09:23,541 [INFO]: }
2025-03-13 15:09:23,541 [INFO]: 	>>> Finished "Creating the index" in 52.3688 secs
2025-03-13 15:09:23,541 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4047 secs
2025-03-13 15:09:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 73828 [episode count 9/20]
[retrieval_preprocessing] for episode 4227 [episode count 10/20], we have num_retrieval=np.int64(2233) num_query=np.int64(163)
2025-03-13 15:09:26,950 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:27,483 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:27
2025-03-13 15:09:27,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 964.43it/s]
2025-03-13 15:09:27,537 [INFO]: There are 2233 embeddings of dim 49152
2025-03-13 15:09:27,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0542 secs
2025-03-13 15:09:27,538 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,538 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:27,538 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:09:27,539 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:27,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:09:27,539 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,539 [INFO]: 460.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:27,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:09:27,540 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:27
2025-03-13 15:09:27,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:27,540 [INFO]: 	Creating the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,541 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:27
2025-03-13 15:09:27,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:09:27,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,544 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:09:27,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 14.74it/s] 67%|██████▋   | 6/9 [00:00<00:00, 24.74it/s]100%|██████████| 9/9 [00:03<00:00,  2.34it/s]100%|██████████| 9/9 [00:03<00:00,  2.99it/s]
2025-03-13 15:09:30,558 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:30
2025-03-13 15:10:02,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8756 secs
2025-03-13 15:10:02,434 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:10:02,434 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-13 15:10:21,970 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5354 secs
2025-03-13 15:10:21,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4283 secs
2025-03-13 15:10:21,973 [INFO]: {
2025-03-13 15:10:21,973 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:21,973 [INFO]: 	index_param: efSearch=170
2025-03-13 15:10:21,973 [INFO]: 	index_path: knn.index
2025-03-13 15:10:21,973 [INFO]: 	size in bytes: 439329130
2025-03-13 15:10:21,973 [INFO]: 	avg_search_speed_ms: 9.748569120095633
2025-03-13 15:10:21,973 [INFO]: 	99p_search_speed_ms: 14.774294453673065
2025-03-13 15:10:21,973 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:21,973 [INFO]: 	nb vectors: 2233
2025-03-13 15:10:21,973 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:21,973 [INFO]: 	compression ratio: 0.9993092513578601
2025-03-13 15:10:21,973 [INFO]: }
2025-03-13 15:10:21,973 [INFO]: 	>>> Finished "Creating the index" in 54.4323 secs
2025-03-13 15:10:21,973 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4895 secs
2025-03-13 15:10:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 4227 [episode count 10/20]
[retrieval_preprocessing] for episode 34438 [episode count 11/20], we have num_retrieval=np.int64(2241) num_query=np.int64(155)
2025-03-13 15:10:23,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:23,831 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:23
2025-03-13 15:10:23,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.89it/s]
2025-03-13 15:10:23,858 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 15:10:23,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:10:23,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:23
2025-03-13 15:10:23,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:23,858 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:10:23,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:23,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:23,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:23
2025-03-13 15:10:23,859 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:23,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:23,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:23
2025-03-13 15:10:23,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:23,859 [INFO]: 	Creating the index 03/13/2025, 15:10:23
2025-03-13 15:10:23,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:23
2025-03-13 15:10:23,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:10:23,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:23
2025-03-13 15:10:23,860 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:10:23,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.93it/s] 56%|█████▌    | 5/9 [00:00<00:00, 27.01it/s]100%|██████████| 9/9 [00:01<00:00,  3.83it/s]100%|██████████| 9/9 [00:01<00:00,  4.52it/s]
2025-03-13 15:10:25,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:25
2025-03-13 15:11:03,022 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1687 secs
2025-03-13 15:11:03,023 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:11:03,023 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 15:11:20,170 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1469 secs
2025-03-13 15:11:20,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3121 secs
2025-03-13 15:11:20,173 [INFO]: {
2025-03-13 15:11:20,173 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:20,173 [INFO]: 	index_param: efSearch=196
2025-03-13 15:11:20,173 [INFO]: 	index_path: knn.index
2025-03-13 15:11:20,173 [INFO]: 	size in bytes: 440903050
2025-03-13 15:11:20,173 [INFO]: 	avg_search_speed_ms: 9.368971204027297
2025-03-13 15:11:20,173 [INFO]: 	99p_search_speed_ms: 14.208458564244156
2025-03-13 15:11:20,173 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:20,173 [INFO]: 	nb vectors: 2241
2025-03-13 15:11:20,173 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:20,173 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 15:11:20,173 [INFO]: }
2025-03-13 15:11:20,173 [INFO]: 	>>> Finished "Creating the index" in 56.3142 secs
2025-03-13 15:11:20,173 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3422 secs
2025-03-13 15:11:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 34438 [episode count 11/20]
[retrieval_preprocessing] for episode 81050 [episode count 12/20], we have num_retrieval=np.int64(2291) num_query=np.int64(105)
2025-03-13 15:11:23,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:23,746 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:23
2025-03-13 15:11:23,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 823.54it/s]
2025-03-13 15:11:23,778 [INFO]: There are 2291 embeddings of dim 49152
2025-03-13 15:11:23,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 15:11:23,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:23
2025-03-13 15:11:23,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:23,779 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:11:23,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:23,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:11:23,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:23
2025-03-13 15:11:23,780 [INFO]: 472.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:23,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:11:23,781 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:23
2025-03-13 15:11:23,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:23,781 [INFO]: 	Creating the index 03/13/2025, 15:11:23
2025-03-13 15:11:23,781 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:23
2025-03-13 15:11:23,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:11:23,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:23
2025-03-13 15:11:23,784 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:11:23,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.41it/s] 70%|███████   | 7/10 [00:00<00:00, 31.54it/s]100%|██████████| 10/10 [00:01<00:00,  5.18it/s]
2025-03-13 15:11:25,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:25
2025-03-13 15:12:05,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3285 secs
2025-03-13 15:12:05,050 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:12:05,050 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.11it/s]
2025-03-13 15:12:21,858 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8081 secs
2025-03-13 15:12:21,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0767 secs
2025-03-13 15:12:21,861 [INFO]: {
2025-03-13 15:12:21,861 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:21,861 [INFO]: 	index_param: efSearch=222
2025-03-13 15:12:21,861 [INFO]: 	index_path: knn.index
2025-03-13 15:12:21,861 [INFO]: 	size in bytes: 450740230
2025-03-13 15:12:21,861 [INFO]: 	avg_search_speed_ms: 9.59453265264902
2025-03-13 15:12:21,861 [INFO]: 	99p_search_speed_ms: 13.362714468967168
2025-03-13 15:12:21,861 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:21,861 [INFO]: 	nb vectors: 2291
2025-03-13 15:12:21,861 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:21,861 [INFO]: 	compression ratio: 0.9993093538599828
2025-03-13 15:12:21,861 [INFO]: }
2025-03-13 15:12:21,861 [INFO]: 	>>> Finished "Creating the index" in 58.0800 secs
2025-03-13 15:12:21,861 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1147 secs
2025-03-13 15:12:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 81050 [episode count 12/20]
[retrieval_preprocessing] for episode 7836 [episode count 13/20], we have num_retrieval=np.int64(2270) num_query=np.int64(126)
2025-03-13 15:12:22,908 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:23,322 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:23
2025-03-13 15:12:23,323 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 625.18it/s]
2025-03-13 15:12:23,356 [INFO]: There are 2270 embeddings of dim 49152
2025-03-13 15:12:23,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 15:12:23,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:23
2025-03-13 15:12:23,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:23,357 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:12:23,357 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:23,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:12:23,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:23
2025-03-13 15:12:23,358 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:23,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:12:23,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:23
2025-03-13 15:12:23,359 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:23,359 [INFO]: 	Creating the index 03/13/2025, 15:12:23
2025-03-13 15:12:23,359 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:23
2025-03-13 15:12:23,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0042 secs
2025-03-13 15:12:23,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:23
2025-03-13 15:12:23,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:12:23,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.89it/s] 44%|████▍     | 4/9 [00:00<00:00, 14.88it/s] 67%|██████▋   | 6/9 [00:00<00:00, 16.18it/s]100%|██████████| 9/9 [00:02<00:00,  2.45it/s]100%|██████████| 9/9 [00:02<00:00,  3.28it/s]
2025-03-13 15:12:26,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:26
2025-03-13 15:12:58,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7149 secs
2025-03-13 15:12:58,826 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:12:58,827 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 15:13:15,121 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2942 secs
2025-03-13 15:13:15,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7590 secs
2025-03-13 15:13:15,124 [INFO]: {
2025-03-13 15:13:15,124 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:15,124 [INFO]: 	index_param: efSearch=162
2025-03-13 15:13:15,124 [INFO]: 	index_path: knn.index
2025-03-13 15:13:15,124 [INFO]: 	size in bytes: 446608570
2025-03-13 15:13:15,124 [INFO]: 	avg_search_speed_ms: 7.346879031056159
2025-03-13 15:13:15,124 [INFO]: 	99p_search_speed_ms: 9.776744106784466
2025-03-13 15:13:15,124 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:15,124 [INFO]: 	nb vectors: 2270
2025-03-13 15:13:15,124 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:15,124 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-13 15:13:15,124 [INFO]: }
2025-03-13 15:13:15,124 [INFO]: 	>>> Finished "Creating the index" in 51.7651 secs
2025-03-13 15:13:15,124 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8012 secs
2025-03-13 15:13:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 7836 [episode count 13/20]
[retrieval_preprocessing] for episode 38558 [episode count 14/20], we have num_retrieval=np.int64(2277) num_query=np.int64(119)
2025-03-13 15:13:16,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:16,809 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:16
2025-03-13 15:13:16,809 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.56it/s]
2025-03-13 15:13:16,838 [INFO]: There are 2277 embeddings of dim 49152
2025-03-13 15:13:16,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:13:16,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:16,838 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:13:16,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:16,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:16,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,838 [INFO]: 469.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:16,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:13:16,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:16
2025-03-13 15:13:16,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:16,839 [INFO]: 	Creating the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,839 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:16
2025-03-13 15:13:16,840 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:13:16,840 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,840 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:13:16,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.40it/s] 44%|████▍     | 4/9 [00:00<00:00, 18.57it/s]100%|██████████| 9/9 [00:01<00:00,  4.47it/s]100%|██████████| 9/9 [00:01<00:00,  5.00it/s]
2025-03-13 15:13:18,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:18
2025-03-13 15:13:49,817 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1707 secs
2025-03-13 15:13:49,817 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 15:13:49,817 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 15:14:11,208 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3907 secs
2025-03-13 15:14:11,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3693 secs
2025-03-13 15:14:11,209 [INFO]: {
2025-03-13 15:14:11,209 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:11,209 [INFO]: 	index_param: efSearch=287
2025-03-13 15:14:11,209 [INFO]: 	index_path: knn.index
2025-03-13 15:14:11,210 [INFO]: 	size in bytes: 447985750
2025-03-13 15:14:11,210 [INFO]: 	avg_search_speed_ms: 10.407435041721465
2025-03-13 15:14:11,210 [INFO]: 	99p_search_speed_ms: 15.823645517230034
2025-03-13 15:14:11,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:11,210 [INFO]: 	nb vectors: 2277
2025-03-13 15:14:11,210 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:11,210 [INFO]: 	compression ratio: 0.9993095003579913
2025-03-13 15:14:11,210 [INFO]: }
2025-03-13 15:14:11,210 [INFO]: 	>>> Finished "Creating the index" in 54.3709 secs
2025-03-13 15:14:11,210 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4004 secs
2025-03-13 15:14:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 38558 [episode count 14/20]
[retrieval_preprocessing] for episode 59040 [episode count 15/20], we have num_retrieval=np.int64(2285) num_query=np.int64(111)
2025-03-13 15:14:12,403 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:13,021 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:13
2025-03-13 15:14:13,021 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1856.71it/s]
2025-03-13 15:14:13,047 [INFO]: There are 2285 embeddings of dim 49152
2025-03-13 15:14:13,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:14:13,047 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:13
2025-03-13 15:14:13,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:13,047 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:14:13,047 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:13,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:13,047 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:13
2025-03-13 15:14:13,047 [INFO]: 471.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:13,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:14:13,047 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:13
2025-03-13 15:14:13,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:13,047 [INFO]: 	Creating the index 03/13/2025, 15:14:13
2025-03-13 15:14:13,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:13
2025-03-13 15:14:13,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:14:13,049 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:13
2025-03-13 15:14:13,049 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:14:13,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.91it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.76it/s]100%|██████████| 9/9 [00:01<00:00,  6.15it/s]
2025-03-13 15:14:14,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:14
2025-03-13 15:14:41,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1335 secs
2025-03-13 15:14:41,651 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 15:14:41,651 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.78it/s]
2025-03-13 15:14:56,727 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0763 secs
2025-03-13 15:14:56,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6806 secs
2025-03-13 15:14:56,730 [INFO]: {
2025-03-13 15:14:56,730 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:56,730 [INFO]: 	index_param: efSearch=165
2025-03-13 15:14:56,730 [INFO]: 	index_path: knn.index
2025-03-13 15:14:56,730 [INFO]: 	size in bytes: 449559670
2025-03-13 15:14:56,730 [INFO]: 	avg_search_speed_ms: 8.498662006000758
2025-03-13 15:14:56,730 [INFO]: 	99p_search_speed_ms: 12.349738851189613
2025-03-13 15:14:56,730 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:56,730 [INFO]: 	nb vectors: 2285
2025-03-13 15:14:56,730 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:56,730 [INFO]: 	compression ratio: 0.9993095688498926
2025-03-13 15:14:56,730 [INFO]: }
2025-03-13 15:14:56,730 [INFO]: 	>>> Finished "Creating the index" in 43.6823 secs
2025-03-13 15:14:56,730 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7091 secs
2025-03-13 15:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 59040 [episode count 15/20]
[retrieval_preprocessing] for episode 86688 [episode count 16/20], we have num_retrieval=np.int64(2268) num_query=np.int64(128)
2025-03-13 15:14:58,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:58,929 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:58
2025-03-13 15:14:58,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1648.06it/s]
2025-03-13 15:14:58,960 [INFO]: There are 2268 embeddings of dim 49152
2025-03-13 15:14:58,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 15:14:58,961 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:58
2025-03-13 15:14:58,961 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:58,961 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:14:58,961 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:58,961 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:14:58,961 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:58
2025-03-13 15:14:58,962 [INFO]: 468.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:58,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:14:58,962 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:58
2025-03-13 15:14:58,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:58,962 [INFO]: 	Creating the index 03/13/2025, 15:14:58
2025-03-13 15:14:58,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:58
2025-03-13 15:14:58,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:14:58,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:58
2025-03-13 15:14:58,966 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:14:58,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 13.82it/s] 44%|████▍     | 4/9 [00:00<00:00, 16.69it/s]100%|██████████| 9/9 [00:01<00:00,  3.97it/s]100%|██████████| 9/9 [00:01<00:00,  4.57it/s]
2025-03-13 15:15:00,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:00
2025-03-13 15:15:33,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3864 secs
2025-03-13 15:15:33,328 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 15:15:33,328 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.53it/s]
2025-03-13 15:15:53,442 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1138 secs
2025-03-13 15:15:53,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8839 secs
2025-03-13 15:15:53,850 [INFO]: {
2025-03-13 15:15:53,851 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:53,851 [INFO]: 	index_param: efSearch=243
2025-03-13 15:15:53,851 [INFO]: 	index_path: knn.index
2025-03-13 15:15:53,851 [INFO]: 	size in bytes: 446215090
2025-03-13 15:15:53,851 [INFO]: 	avg_search_speed_ms: 12.004425076685068
2025-03-13 15:15:53,851 [INFO]: 	99p_search_speed_ms: 20.15310761518776
2025-03-13 15:15:53,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:53,851 [INFO]: 	nb vectors: 2268
2025-03-13 15:15:53,851 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:53,851 [INFO]: 	compression ratio: 0.999309422727053
2025-03-13 15:15:53,851 [INFO]: }
2025-03-13 15:15:53,851 [INFO]: 	>>> Finished "Creating the index" in 54.8887 secs
2025-03-13 15:15:53,851 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9217 secs
2025-03-13 15:15:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 86688 [episode count 16/20]
[retrieval_preprocessing] for episode 8889 [episode count 17/20], we have num_retrieval=np.int64(2296) num_query=np.int64(100)
2025-03-13 15:15:56,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:57,227 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:57
2025-03-13 15:15:57,228 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 921.83it/s]
2025-03-13 15:15:57,261 [INFO]: There are 2296 embeddings of dim 49152
2025-03-13 15:15:57,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 15:15:57,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:57,262 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:15:57,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:57,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:57,262 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,262 [INFO]: 473.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:57,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:15:57,262 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:57
2025-03-13 15:15:57,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:57,262 [INFO]: 	Creating the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,262 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:57
2025-03-13 15:15:57,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:15:57,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,264 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:15:57,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.48it/s] 40%|████      | 4/10 [00:00<00:00, 15.57it/s] 70%|███████   | 7/10 [00:00<00:00, 19.97it/s]100%|██████████| 10/10 [00:02<00:00,  2.83it/s]100%|██████████| 10/10 [00:02<00:00,  3.77it/s]
2025-03-13 15:15:59,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:59
2025-03-13 15:16:34,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1895 secs
2025-03-13 15:16:34,113 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 15:16:34,113 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 15:16:57,643 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5300 secs
2025-03-13 15:16:57,645 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3818 secs
2025-03-13 15:16:57,646 [INFO]: {
2025-03-13 15:16:57,646 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:57,646 [INFO]: 	index_param: efSearch=283
2025-03-13 15:16:57,646 [INFO]: 	index_path: knn.index
2025-03-13 15:16:57,646 [INFO]: 	size in bytes: 451723930
2025-03-13 15:16:57,646 [INFO]: 	avg_search_speed_ms: 11.815078976292519
2025-03-13 15:16:57,646 [INFO]: 	99p_search_speed_ms: 21.597568914294243
2025-03-13 15:16:57,646 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:57,646 [INFO]: 	nb vectors: 2296
2025-03-13 15:16:57,646 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:57,646 [INFO]: 	compression ratio: 0.9993093967813483
2025-03-13 15:16:57,646 [INFO]: }
2025-03-13 15:16:57,646 [INFO]: 	>>> Finished "Creating the index" in 60.3835 secs
2025-03-13 15:16:57,646 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4182 secs
2025-03-13 15:16:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 8889 [episode count 17/20]
[retrieval_preprocessing] for episode 58557 [episode count 18/20], we have num_retrieval=np.int64(2273) num_query=np.int64(123)
2025-03-13 15:16:59,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:59,756 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:59
2025-03-13 15:16:59,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.74it/s]
2025-03-13 15:16:59,787 [INFO]: There are 2273 embeddings of dim 49152
2025-03-13 15:16:59,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:16:59,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:59
2025-03-13 15:16:59,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:59,788 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:16:59,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:59,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:16:59,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:59
2025-03-13 15:16:59,788 [INFO]: 469.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:59,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:16:59,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:59
2025-03-13 15:16:59,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:59,789 [INFO]: 	Creating the index 03/13/2025, 15:16:59
2025-03-13 15:16:59,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:59
2025-03-13 15:16:59,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:16:59,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:59
2025-03-13 15:16:59,792 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:16:59,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.84it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.61it/s]100%|██████████| 9/9 [00:01<00:00,  4.93it/s]
2025-03-13 15:17:02,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:02
2025-03-13 15:17:31,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0128 secs
2025-03-13 15:17:31,329 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 15:17:31,330 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.44it/s]
2025-03-13 15:17:45,736 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4063 secs
2025-03-13 15:17:45,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0598 secs
2025-03-13 15:17:45,853 [INFO]: {
2025-03-13 15:17:45,853 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:45,853 [INFO]: 	index_param: efSearch=257
2025-03-13 15:17:45,853 [INFO]: 	index_path: knn.index
2025-03-13 15:17:45,853 [INFO]: 	size in bytes: 447198790
2025-03-13 15:17:45,853 [INFO]: 	avg_search_speed_ms: 21.57570304176449
2025-03-13 15:17:45,853 [INFO]: 	99p_search_speed_ms: 44.86785623477772
2025-03-13 15:17:45,853 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:45,853 [INFO]: 	nb vectors: 2273
2025-03-13 15:17:45,853 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:45,853 [INFO]: 	compression ratio: 0.9993094659312473
2025-03-13 15:17:45,853 [INFO]: }
2025-03-13 15:17:45,853 [INFO]: 	>>> Finished "Creating the index" in 46.0642 secs
2025-03-13 15:17:45,853 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0974 secs
2025-03-13 15:17:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 58557 [episode count 18/20]
[retrieval_preprocessing] for episode 86720 [episode count 19/20], we have num_retrieval=np.int64(2294) num_query=np.int64(102)
2025-03-13 15:17:48,026 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:48,492 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:48
2025-03-13 15:17:48,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 781.94it/s]
2025-03-13 15:17:48,527 [INFO]: There are 2294 embeddings of dim 49152
2025-03-13 15:17:48,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 15:17:48,527 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:48
2025-03-13 15:17:48,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:48,528 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:17:48,528 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:48,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:17:48,528 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:48
2025-03-13 15:17:48,529 [INFO]: 473.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:48,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:48,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:48
2025-03-13 15:17:48,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:48,529 [INFO]: 	Creating the index 03/13/2025, 15:17:48
2025-03-13 15:17:48,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:48
2025-03-13 15:17:48,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 15:17:48,531 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:48
2025-03-13 15:17:48,532 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:17:48,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.70it/s] 40%|████      | 4/10 [00:00<00:00, 20.25it/s] 70%|███████   | 7/10 [00:00<00:00, 24.26it/s]100%|██████████| 10/10 [00:02<00:00,  3.02it/s]100%|██████████| 10/10 [00:02<00:00,  4.08it/s]
2025-03-13 15:17:50,989 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:50
2025-03-13 15:18:30,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3916 secs
2025-03-13 15:18:30,381 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:18:30,381 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.72it/s]
2025-03-13 15:18:51,705 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3237 secs
2025-03-13 15:18:52,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7122 secs
2025-03-13 15:18:52,244 [INFO]: {
2025-03-13 15:18:52,244 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:52,244 [INFO]: 	index_param: efSearch=207
2025-03-13 15:18:52,244 [INFO]: 	index_path: knn.index
2025-03-13 15:18:52,244 [INFO]: 	size in bytes: 451330450
2025-03-13 15:18:52,244 [INFO]: 	avg_search_speed_ms: 9.140926236806052
2025-03-13 15:18:52,244 [INFO]: 	99p_search_speed_ms: 12.443677373230457
2025-03-13 15:18:52,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:52,245 [INFO]: 	nb vectors: 2294
2025-03-13 15:18:52,245 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:52,245 [INFO]: 	compression ratio: 0.9993093796352539
2025-03-13 15:18:52,245 [INFO]: }
2025-03-13 15:18:52,245 [INFO]: 	>>> Finished "Creating the index" in 63.7156 secs
2025-03-13 15:18:52,245 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7530 secs
2025-03-13 15:18:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 86720 [episode count 19/20]
2025-03-13 15:18:53: [retrieval_preprocessing] finished for 3895077471_press_button_on_coffee_maker [chosen_id count 1/196]
2025-03-13 15:18:54: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_blue_cup_in_orange_cup [chosen_id count 2/196]
2025-03-13 15:18:54: [retrieval_preprocessing] we have num_total=2677 embedding_dim=49152
[retrieval_preprocessing] for episode 38936 [episode count 0/20], we have num_retrieval=np.int64(2554) num_query=np.int64(123)
2025-03-13 15:18:54,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:55,251 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:55
2025-03-13 15:18:55,251 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.05it/s]
2025-03-13 15:18:55,278 [INFO]: There are 2554 embeddings of dim 49152
2025-03-13 15:18:55,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:18:55,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:55
2025-03-13 15:18:55,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:55,279 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:18:55,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:55,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:18:55,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:55
2025-03-13 15:18:55,279 [INFO]: 527.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:55,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:18:55,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:55
2025-03-13 15:18:55,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:55,279 [INFO]: 	Creating the index 03/13/2025, 15:18:55
2025-03-13 15:18:55,279 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:55
2025-03-13 15:18:55,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:18:55,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:55
2025-03-13 15:18:55,281 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:18:55,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.91it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.89it/s]100%|██████████| 11/11 [00:02<00:00,  3.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.63it/s]
2025-03-13 15:18:57,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:57
2025-03-13 15:19:33,719 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0596 secs
2025-03-13 15:19:33,719 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 15:19:33,720 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 15:19:57,919 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1991 secs
2025-03-13 15:19:58,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9414 secs
2025-03-13 15:19:58,222 [INFO]: {
2025-03-13 15:19:58,222 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:58,223 [INFO]: 	index_param: efSearch=208
2025-03-13 15:19:58,223 [INFO]: 	index_path: knn.index
2025-03-13 15:19:58,223 [INFO]: 	size in bytes: 502483750
2025-03-13 15:19:58,223 [INFO]: 	avg_search_speed_ms: 12.44418011469748
2025-03-13 15:19:58,223 [INFO]: 	99p_search_speed_ms: 19.711246197111908
2025-03-13 15:19:58,223 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:58,223 [INFO]: 	nb vectors: 2554
2025-03-13 15:19:58,223 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:58,223 [INFO]: 	compression ratio: 0.9993095935938227
2025-03-13 15:19:58,223 [INFO]: }
2025-03-13 15:19:58,223 [INFO]: 	>>> Finished "Creating the index" in 62.9439 secs
2025-03-13 15:19:58,223 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9725 secs
2025-03-13 15:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 38936 [episode count 0/20]
[retrieval_preprocessing] for episode 83484 [episode count 1/20], we have num_retrieval=np.int64(2556) num_query=np.int64(121)
2025-03-13 15:19:59,685 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:00,129 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:00
2025-03-13 15:20:00,129 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-13 15:20:00,155 [INFO]: There are 2556 embeddings of dim 49152
2025-03-13 15:20:00,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:20:00,155 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,155 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:00,155 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:20:00,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:00,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:00,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,155 [INFO]: 527.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:00,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:00,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:00
2025-03-13 15:20:00,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:00,156 [INFO]: 	Creating the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,156 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:00
2025-03-13 15:20:00,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:20:00,157 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,157 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:20:00,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.52it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.56it/s]100%|██████████| 11/11 [00:03<00:00,  3.05it/s]100%|██████████| 11/11 [00:03<00:00,  3.62it/s]
2025-03-13 15:20:03,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:03
2025-03-13 15:20:42,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9693 secs
2025-03-13 15:20:42,169 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 15:20:42,169 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 15:21:05,998 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8287 secs
2025-03-13 15:21:06,000 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8436 secs
2025-03-13 15:21:06,001 [INFO]: {
2025-03-13 15:21:06,001 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:06,001 [INFO]: 	index_param: efSearch=114
2025-03-13 15:21:06,001 [INFO]: 	index_path: knn.index
2025-03-13 15:21:06,001 [INFO]: 	size in bytes: 502877230
2025-03-13 15:21:06,001 [INFO]: 	avg_search_speed_ms: 6.938482645056863
2025-03-13 15:21:06,001 [INFO]: 	99p_search_speed_ms: 11.666585563216358
2025-03-13 15:21:06,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:06,001 [INFO]: 	nb vectors: 2556
2025-03-13 15:21:06,001 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:06,001 [INFO]: 	compression ratio: 0.9993096088283814
2025-03-13 15:21:06,001 [INFO]: }
2025-03-13 15:21:06,001 [INFO]: 	>>> Finished "Creating the index" in 65.8452 secs
2025-03-13 15:21:06,001 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8720 secs
2025-03-13 15:21:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 83484 [episode count 1/20]
[retrieval_preprocessing] for episode 11299 [episode count 2/20], we have num_retrieval=np.int64(2527) num_query=np.int64(150)
2025-03-13 15:21:07,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:07,853 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:07
2025-03-13 15:21:07,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.58it/s]
2025-03-13 15:21:07,887 [INFO]: There are 2527 embeddings of dim 49152
2025-03-13 15:21:07,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 15:21:07,888 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:07
2025-03-13 15:21:07,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:07,888 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:21:07,888 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:07,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:21:07,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:07
2025-03-13 15:21:07,889 [INFO]: 521.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:07,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:21:07,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:07
2025-03-13 15:21:07,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:07,890 [INFO]: 	Creating the index 03/13/2025, 15:21:07
2025-03-13 15:21:07,890 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:07
2025-03-13 15:21:07,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:21:07,893 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:07
2025-03-13 15:21:07,893 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:21:07,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.14it/s] 70%|███████   | 7/10 [00:00<00:00, 33.76it/s]100%|██████████| 10/10 [00:02<00:00,  4.31it/s]
2025-03-13 15:21:10,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:10
2025-03-13 15:21:42,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9586 secs
2025-03-13 15:21:42,180 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 15:21:42,180 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 15:22:02,451 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2713 secs
2025-03-13 15:22:02,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5601 secs
2025-03-13 15:22:02,453 [INFO]: {
2025-03-13 15:22:02,453 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:02,453 [INFO]: 	index_param: efSearch=119
2025-03-13 15:22:02,453 [INFO]: 	index_path: knn.index
2025-03-13 15:22:02,453 [INFO]: 	size in bytes: 497171530
2025-03-13 15:22:02,453 [INFO]: 	avg_search_speed_ms: 6.846257470469109
2025-03-13 15:22:02,453 [INFO]: 	99p_search_speed_ms: 9.58289783447981
2025-03-13 15:22:02,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:02,454 [INFO]: 	nb vectors: 2527
2025-03-13 15:22:02,454 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:02,454 [INFO]: 	compression ratio: 0.999309867964483
2025-03-13 15:22:02,454 [INFO]: }
2025-03-13 15:22:02,454 [INFO]: 	>>> Finished "Creating the index" in 54.5638 secs
2025-03-13 15:22:02,454 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6006 secs
2025-03-13 15:22:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 11299 [episode count 2/20]
[retrieval_preprocessing] for episode 13879 [episode count 3/20], we have num_retrieval=np.int64(2568) num_query=np.int64(109)
2025-03-13 15:22:03,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:03,916 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:03
2025-03-13 15:22:03,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 15:22:03,943 [INFO]: There are 2568 embeddings of dim 49152
2025-03-13 15:22:03,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:22:03,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:03
2025-03-13 15:22:03,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:03,943 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:22:03,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:03,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:03,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:03
2025-03-13 15:22:03,943 [INFO]: 530.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:03,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:22:03,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:03
2025-03-13 15:22:03,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:03,943 [INFO]: 	Creating the index 03/13/2025, 15:22:03
2025-03-13 15:22:03,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:03
2025-03-13 15:22:03,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:22:03,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:03
2025-03-13 15:22:03,945 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:22:03,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.55it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.47it/s]100%|██████████| 11/11 [00:02<00:00,  4.48it/s]100%|██████████| 11/11 [00:02<00:00,  5.26it/s]
2025-03-13 15:22:06,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:06
2025-03-13 15:22:38,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0135 secs
2025-03-13 15:22:38,053 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 15:22:38,053 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 15:23:06,728 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6742 secs
2025-03-13 15:23:07,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2132 secs
2025-03-13 15:23:07,158 [INFO]: {
2025-03-13 15:23:07,159 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:07,159 [INFO]: 	index_param: efSearch=128
2025-03-13 15:23:07,159 [INFO]: 	index_path: knn.index
2025-03-13 15:23:07,159 [INFO]: 	size in bytes: 505238110
2025-03-13 15:23:07,159 [INFO]: 	avg_search_speed_ms: 8.955201284998266
2025-03-13 15:23:07,159 [INFO]: 	99p_search_speed_ms: 12.659372668713331
2025-03-13 15:23:07,159 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:07,159 [INFO]: 	nb vectors: 2568
2025-03-13 15:23:07,159 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:07,159 [INFO]: 	compression ratio: 0.9993096997374169
2025-03-13 15:23:07,159 [INFO]: }
2025-03-13 15:23:07,159 [INFO]: 	>>> Finished "Creating the index" in 63.2157 secs
2025-03-13 15:23:07,159 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2428 secs
2025-03-13 15:23:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 13879 [episode count 3/20]
[retrieval_preprocessing] for episode 93755 [episode count 4/20], we have num_retrieval=np.int64(2562) num_query=np.int64(115)
2025-03-13 15:23:08,451 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:08,917 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:08
2025-03-13 15:23:08,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-13 15:23:08,951 [INFO]: There are 2562 embeddings of dim 49152
2025-03-13 15:23:08,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 15:23:08,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:08
2025-03-13 15:23:08,952 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:08,952 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:23:08,952 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:08,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:23:08,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:08
2025-03-13 15:23:08,953 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:08,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:23:08,953 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:08
2025-03-13 15:23:08,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:08,954 [INFO]: 	Creating the index 03/13/2025, 15:23:08
2025-03-13 15:23:08,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:08
2025-03-13 15:23:08,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:23:08,957 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:08
2025-03-13 15:23:08,958 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:23:08,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.86it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.52it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.58it/s]100%|██████████| 11/11 [00:03<00:00,  3.58it/s]
2025-03-13 15:23:12,037 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:12
2025-03-13 15:23:43,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3431 secs
2025-03-13 15:23:43,380 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 15:23:43,381 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.40it/s]
2025-03-13 15:24:01,225 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8442 secs
2025-03-13 15:24:01,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2695 secs
2025-03-13 15:24:01,227 [INFO]: {
2025-03-13 15:24:01,227 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:01,227 [INFO]: 	index_param: efSearch=139
2025-03-13 15:24:01,227 [INFO]: 	index_path: knn.index
2025-03-13 15:24:01,227 [INFO]: 	size in bytes: 504057670
2025-03-13 15:24:01,227 [INFO]: 	avg_search_speed_ms: 8.61776845373117
2025-03-13 15:24:01,227 [INFO]: 	99p_search_speed_ms: 13.318860805593442
2025-03-13 15:24:01,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:01,227 [INFO]: 	nb vectors: 2562
2025-03-13 15:24:01,227 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:01,227 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-13 15:24:01,227 [INFO]: }
2025-03-13 15:24:01,227 [INFO]: 	>>> Finished "Creating the index" in 52.2736 secs
2025-03-13 15:24:01,227 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3106 secs
2025-03-13 15:24:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 93755 [episode count 4/20]
[retrieval_preprocessing] for episode 43580 [episode count 5/20], we have num_retrieval=np.int64(2540) num_query=np.int64(137)
2025-03-13 15:24:02,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:03,022 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:03
2025-03-13 15:24:03,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 4471.54it/s]
2025-03-13 15:24:03,057 [INFO]: There are 2540 embeddings of dim 49152
2025-03-13 15:24:03,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 15:24:03,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:03
2025-03-13 15:24:03,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:03,058 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:24:03,058 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:03,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:24:03,059 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:03
2025-03-13 15:24:03,059 [INFO]: 524.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:03,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:24:03,059 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:03
2025-03-13 15:24:03,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:03,060 [INFO]: 	Creating the index 03/13/2025, 15:24:03
2025-03-13 15:24:03,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:03
2025-03-13 15:24:03,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:24:03,063 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:03
2025-03-13 15:24:03,063 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:24:03,063 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.74it/s] 70%|███████   | 7/10 [00:00<00:00, 31.74it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-13 15:24:05,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:05
2025-03-13 15:24:39,874 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3535 secs
2025-03-13 15:24:39,875 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 15:24:39,875 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 15:25:00,249 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3739 secs
2025-03-13 15:25:00,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1879 secs
2025-03-13 15:25:00,251 [INFO]: {
2025-03-13 15:25:00,251 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:00,251 [INFO]: 	index_param: efSearch=134
2025-03-13 15:25:00,251 [INFO]: 	index_path: knn.index
2025-03-13 15:25:00,251 [INFO]: 	size in bytes: 499729270
2025-03-13 15:25:00,251 [INFO]: 	avg_search_speed_ms: 7.68675007030574
2025-03-13 15:25:00,251 [INFO]: 	99p_search_speed_ms: 10.949199786409736
2025-03-13 15:25:00,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:00,251 [INFO]: 	nb vectors: 2540
2025-03-13 15:25:00,251 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:00,251 [INFO]: 	compression ratio: 0.9993097262443723
2025-03-13 15:25:00,251 [INFO]: }
2025-03-13 15:25:00,251 [INFO]: 	>>> Finished "Creating the index" in 57.1913 secs
2025-03-13 15:25:00,251 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2292 secs
2025-03-13 15:25:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 43580 [episode count 5/20]
[retrieval_preprocessing] for episode 91708 [episode count 6/20], we have num_retrieval=np.int64(2534) num_query=np.int64(143)
2025-03-13 15:25:01,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:01,683 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:01
2025-03-13 15:25:01,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.66it/s]
2025-03-13 15:25:01,709 [INFO]: There are 2534 embeddings of dim 49152
2025-03-13 15:25:01,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:25:01,709 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:01
2025-03-13 15:25:01,709 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:01,709 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:25:01,709 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:01,709 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:01,709 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:01
2025-03-13 15:25:01,709 [INFO]: 523.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:01,709 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:25:01,709 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:01
2025-03-13 15:25:01,709 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:01,709 [INFO]: 	Creating the index 03/13/2025, 15:25:01
2025-03-13 15:25:01,710 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:01
2025-03-13 15:25:01,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:01,711 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:01
2025-03-13 15:25:01,711 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:25:01,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00, 27.75it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]100%|██████████| 10/10 [00:02<00:00,  4.94it/s]
2025-03-13 15:25:03,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:03
2025-03-13 15:25:37,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6649 secs
2025-03-13 15:25:37,403 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 15:25:37,403 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-13 15:25:58,373 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9694 secs
2025-03-13 15:25:58,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6641 secs
2025-03-13 15:25:58,375 [INFO]: {
2025-03-13 15:25:58,375 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:58,375 [INFO]: 	index_param: efSearch=109
2025-03-13 15:25:58,375 [INFO]: 	index_path: knn.index
2025-03-13 15:25:58,375 [INFO]: 	size in bytes: 498548830
2025-03-13 15:25:58,375 [INFO]: 	avg_search_speed_ms: 6.6478760552931915
2025-03-13 15:25:58,375 [INFO]: 	99p_search_speed_ms: 10.586671321652833
2025-03-13 15:25:58,375 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:58,375 [INFO]: 	nb vectors: 2534
2025-03-13 15:25:58,375 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:58,375 [INFO]: 	compression ratio: 0.9993096804579804
2025-03-13 15:25:58,375 [INFO]: }
2025-03-13 15:25:58,375 [INFO]: 	>>> Finished "Creating the index" in 56.6657 secs
2025-03-13 15:25:58,375 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6925 secs
2025-03-13 15:25:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 91708 [episode count 6/20]
[retrieval_preprocessing] for episode 11334 [episode count 7/20], we have num_retrieval=np.int64(2526) num_query=np.int64(151)
2025-03-13 15:25:59,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:00,068 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:00
2025-03-13 15:26:00,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.25it/s]
2025-03-13 15:26:00,102 [INFO]: There are 2526 embeddings of dim 49152
2025-03-13 15:26:00,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 15:26:00,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:00
2025-03-13 15:26:00,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:00,103 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:26:00,103 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:00,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:26:00,103 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:00
2025-03-13 15:26:00,103 [INFO]: 521.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:00,104 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:26:00,104 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:00
2025-03-13 15:26:00,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:00,104 [INFO]: 	Creating the index 03/13/2025, 15:26:00
2025-03-13 15:26:00,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:00
2025-03-13 15:26:00,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:26:00,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:00
2025-03-13 15:26:00,108 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:26:00,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.76it/s] 70%|███████   | 7/10 [00:00<00:00, 32.07it/s]100%|██████████| 10/10 [00:02<00:00,  4.35it/s]
2025-03-13 15:26:02,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:02
2025-03-13 15:26:37,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9081 secs
2025-03-13 15:26:37,322 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 15:26:37,322 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.58it/s]
2025-03-13 15:26:57,322 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0004 secs
2025-03-13 15:26:57,324 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2165 secs
2025-03-13 15:26:57,324 [INFO]: {
2025-03-13 15:26:57,324 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:57,324 [INFO]: 	index_param: efSearch=138
2025-03-13 15:26:57,324 [INFO]: 	index_path: knn.index
2025-03-13 15:26:57,324 [INFO]: 	size in bytes: 496974790
2025-03-13 15:26:57,325 [INFO]: 	avg_search_speed_ms: 9.17557376039582
2025-03-13 15:26:57,325 [INFO]: 	99p_search_speed_ms: 12.599222215358166
2025-03-13 15:26:57,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:57,325 [INFO]: 	nb vectors: 2526
2025-03-13 15:26:57,325 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:57,325 [INFO]: 	compression ratio: 0.9993098603653517
2025-03-13 15:26:57,325 [INFO]: }
2025-03-13 15:26:57,325 [INFO]: 	>>> Finished "Creating the index" in 57.2203 secs
2025-03-13 15:26:57,325 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2564 secs
2025-03-13 15:26:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 11334 [episode count 7/20]
[retrieval_preprocessing] for episode 43127 [episode count 8/20], we have num_retrieval=np.int64(2550) num_query=np.int64(127)
2025-03-13 15:27:00,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:01,270 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:01
2025-03-13 15:27:01,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.80it/s]
2025-03-13 15:27:01,300 [INFO]: There are 2550 embeddings of dim 49152
2025-03-13 15:27:01,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:27:01,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:01
2025-03-13 15:27:01,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:01,301 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:27:01,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:01,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:01,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:01
2025-03-13 15:27:01,301 [INFO]: 526.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:01,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:01,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:01
2025-03-13 15:27:01,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:01,302 [INFO]: 	Creating the index 03/13/2025, 15:27:01
2025-03-13 15:27:01,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:01
2025-03-13 15:27:01,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:27:01,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:01
2025-03-13 15:27:01,303 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:27:01,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.58it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.13it/s]100%|██████████| 11/11 [00:02<00:00,  3.60it/s]100%|██████████| 11/11 [00:02<00:00,  4.48it/s]
2025-03-13 15:27:03,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:03
2025-03-13 15:27:32,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7132 secs
2025-03-13 15:27:32,479 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 15:27:32,479 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 15:27:57,105 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6257 secs
2025-03-13 15:27:57,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8035 secs
2025-03-13 15:27:57,107 [INFO]: {
2025-03-13 15:27:57,107 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:57,107 [INFO]: 	index_param: efSearch=150
2025-03-13 15:27:57,107 [INFO]: 	index_path: knn.index
2025-03-13 15:27:57,107 [INFO]: 	size in bytes: 501696790
2025-03-13 15:27:57,107 [INFO]: 	avg_search_speed_ms: 8.492920814352411
2025-03-13 15:27:57,107 [INFO]: 	99p_search_speed_ms: 12.105376194231212
2025-03-13 15:27:57,107 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:57,107 [INFO]: 	nb vectors: 2550
2025-03-13 15:27:57,107 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:57,107 [INFO]: 	compression ratio: 0.9993095630530145
2025-03-13 15:27:57,107 [INFO]: }
2025-03-13 15:27:57,107 [INFO]: 	>>> Finished "Creating the index" in 55.8054 secs
2025-03-13 15:27:57,107 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8366 secs
2025-03-13 15:27:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 43127 [episode count 8/20]
[retrieval_preprocessing] for episode 87165 [episode count 9/20], we have num_retrieval=np.int64(2531) num_query=np.int64(146)
2025-03-13 15:27:58,189 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:58,558 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:58
2025-03-13 15:27:58,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2464.34it/s]
2025-03-13 15:27:58,586 [INFO]: There are 2531 embeddings of dim 49152
2025-03-13 15:27:58,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:27:58,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:58
2025-03-13 15:27:58,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:58,586 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:27:58,586 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:58,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:58,586 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:58
2025-03-13 15:27:58,586 [INFO]: 522.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:58,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:58,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:58
2025-03-13 15:27:58,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:58,586 [INFO]: 	Creating the index 03/13/2025, 15:27:58
2025-03-13 15:27:58,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:58
2025-03-13 15:27:58,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:27:58,588 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:58
2025-03-13 15:27:58,588 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:27:58,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00, 29.66it/s]100%|██████████| 10/10 [00:02<00:00,  3.55it/s]100%|██████████| 10/10 [00:02<00:00,  4.26it/s]
2025-03-13 15:28:00,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:00
2025-03-13 15:28:35,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5677 secs
2025-03-13 15:28:35,506 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 15:28:35,506 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.60it/s]
2025-03-13 15:28:55,194 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6883 secs
2025-03-13 15:28:55,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6089 secs
2025-03-13 15:28:55,197 [INFO]: {
2025-03-13 15:28:55,197 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:55,197 [INFO]: 	index_param: efSearch=165
2025-03-13 15:28:55,197 [INFO]: 	index_path: knn.index
2025-03-13 15:28:55,197 [INFO]: 	size in bytes: 497958610
2025-03-13 15:28:55,197 [INFO]: 	avg_search_speed_ms: 9.890415035114502
2025-03-13 15:28:55,197 [INFO]: 	99p_search_speed_ms: 16.999496961943805
2025-03-13 15:28:55,197 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:55,197 [INFO]: 	nb vectors: 2531
2025-03-13 15:28:55,197 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:55,197 [INFO]: 	compression ratio: 0.99930965748338
2025-03-13 15:28:55,197 [INFO]: }
2025-03-13 15:28:55,197 [INFO]: 	>>> Finished "Creating the index" in 56.6105 secs
2025-03-13 15:28:55,197 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6385 secs
2025-03-13 15:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 87165 [episode count 9/20]
[retrieval_preprocessing] for episode 71299 [episode count 10/20], we have num_retrieval=np.int64(2548) num_query=np.int64(129)
2025-03-13 15:28:56,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:57,751 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:57
2025-03-13 15:28:57,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2284.48it/s]
2025-03-13 15:28:57,777 [INFO]: There are 2548 embeddings of dim 49152
2025-03-13 15:28:57,777 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:28:57,777 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:57
2025-03-13 15:28:57,777 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:57,777 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:28:57,777 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:57,777 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:57,777 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:57
2025-03-13 15:28:57,777 [INFO]: 525.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:57,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:28:57,777 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:57
2025-03-13 15:28:57,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:57,777 [INFO]: 	Creating the index 03/13/2025, 15:28:57
2025-03-13 15:28:57,777 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:57
2025-03-13 15:28:57,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:28:57,779 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:57
2025-03-13 15:28:57,779 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:28:57,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.82it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.90it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.71it/s]
2025-03-13 15:29:00,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:00
2025-03-13 15:29:34,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9437 secs
2025-03-13 15:29:34,060 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:29:34,060 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.65it/s]
2025-03-13 15:29:58,056 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9958 secs
2025-03-13 15:29:58,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2813 secs
2025-03-13 15:29:58,060 [INFO]: {
2025-03-13 15:29:58,060 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:58,060 [INFO]: 	index_param: efSearch=180
2025-03-13 15:29:58,060 [INFO]: 	index_path: knn.index
2025-03-13 15:29:58,060 [INFO]: 	size in bytes: 501303310
2025-03-13 15:29:58,060 [INFO]: 	avg_search_speed_ms: 10.439199061786255
2025-03-13 15:29:58,060 [INFO]: 	99p_search_speed_ms: 15.15842417255044
2025-03-13 15:29:58,060 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:58,060 [INFO]: 	nb vectors: 2548
2025-03-13 15:29:58,060 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:58,060 [INFO]: 	compression ratio: 0.9993095477466526
2025-03-13 15:29:58,060 [INFO]: }
2025-03-13 15:29:58,060 [INFO]: 	>>> Finished "Creating the index" in 60.2830 secs
2025-03-13 15:29:58,060 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3095 secs
2025-03-13 15:29:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 71299 [episode count 10/20]
[retrieval_preprocessing] for episode 77967 [episode count 11/20], we have num_retrieval=np.int64(2555) num_query=np.int64(122)
2025-03-13 15:30:00,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:00,967 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:00
2025-03-13 15:30:00,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 910.22it/s]
2025-03-13 15:30:01,002 [INFO]: There are 2555 embeddings of dim 49152
2025-03-13 15:30:01,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 15:30:01,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:01,004 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:30:01,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:01,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:30:01,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,005 [INFO]: 527.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:01,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:30:01,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:01
2025-03-13 15:30:01,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:01,006 [INFO]: 	Creating the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:01
2025-03-13 15:30:01,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:30:01,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,008 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:30:01,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.91it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.15it/s] 91%|█████████ | 10/11 [00:00<00:00, 29.53it/s]100%|██████████| 11/11 [00:03<00:00,  3.66it/s]
2025-03-13 15:30:04,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:04
2025-03-13 15:30:39,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0231 secs
2025-03-13 15:30:39,041 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 15:30:39,041 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-13 15:31:01,941 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9001 secs
2025-03-13 15:31:01,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9360 secs
2025-03-13 15:31:01,945 [INFO]: {
2025-03-13 15:31:01,945 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:01,945 [INFO]: 	index_param: efSearch=138
2025-03-13 15:31:01,945 [INFO]: 	index_path: knn.index
2025-03-13 15:31:01,945 [INFO]: 	size in bytes: 502680490
2025-03-13 15:31:01,945 [INFO]: 	avg_search_speed_ms: 8.579254204704464
2025-03-13 15:31:01,945 [INFO]: 	99p_search_speed_ms: 18.319228303153064
2025-03-13 15:31:01,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:01,945 [INFO]: 	nb vectors: 2555
2025-03-13 15:31:01,945 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:01,945 [INFO]: 	compression ratio: 0.9993096012140833
2025-03-13 15:31:01,945 [INFO]: }
2025-03-13 15:31:01,945 [INFO]: 	>>> Finished "Creating the index" in 60.9393 secs
2025-03-13 15:31:01,945 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9780 secs
2025-03-13 15:31:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 77967 [episode count 11/20]
[retrieval_preprocessing] for episode 31896 [episode count 12/20], we have num_retrieval=np.int64(2539) num_query=np.int64(138)
2025-03-13 15:31:03,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:03,927 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:03
2025-03-13 15:31:03,928 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.43it/s]
2025-03-13 15:31:03,953 [INFO]: There are 2539 embeddings of dim 49152
2025-03-13 15:31:03,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:31:03,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:03
2025-03-13 15:31:03,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:03,954 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:31:03,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:03,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:03,954 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:03
2025-03-13 15:31:03,954 [INFO]: 524.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:03,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:31:03,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:03
2025-03-13 15:31:03,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:03,954 [INFO]: 	Creating the index 03/13/2025, 15:31:03
2025-03-13 15:31:03,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:03
2025-03-13 15:31:03,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:31:03,955 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:03
2025-03-13 15:31:03,955 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:31:03,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.42it/s] 60%|██████    | 6/10 [00:00<00:00, 30.91it/s]100%|██████████| 10/10 [00:02<00:00,  3.64it/s]100%|██████████| 10/10 [00:02<00:00,  4.38it/s]
2025-03-13 15:31:06,241 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:06
2025-03-13 15:31:36,265 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0241 secs
2025-03-13 15:31:36,266 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:31:36,266 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.86it/s]
2025-03-13 15:32:02,576 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3105 secs
2025-03-13 15:32:02,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6228 secs
2025-03-13 15:32:02,578 [INFO]: {
2025-03-13 15:32:02,578 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:02,579 [INFO]: 	index_param: efSearch=201
2025-03-13 15:32:02,579 [INFO]: 	index_path: knn.index
2025-03-13 15:32:02,579 [INFO]: 	size in bytes: 499532530
2025-03-13 15:32:02,579 [INFO]: 	avg_search_speed_ms: 11.361678776235998
2025-03-13 15:32:02,579 [INFO]: 	99p_search_speed_ms: 17.16500430600718
2025-03-13 15:32:02,579 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:02,579 [INFO]: 	nb vectors: 2539
2025-03-13 15:32:02,579 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:02,579 [INFO]: 	compression ratio: 0.9993097186283344
2025-03-13 15:32:02,579 [INFO]: }
2025-03-13 15:32:02,579 [INFO]: 	>>> Finished "Creating the index" in 58.6245 secs
2025-03-13 15:32:02,579 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6511 secs
2025-03-13 15:32:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 31896 [episode count 12/20]
[retrieval_preprocessing] for episode 4776 [episode count 13/20], we have num_retrieval=np.int64(2547) num_query=np.int64(130)
2025-03-13 15:32:03,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:04,512 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:04
2025-03-13 15:32:04,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1602.10it/s]
2025-03-13 15:32:04,545 [INFO]: There are 2547 embeddings of dim 49152
2025-03-13 15:32:04,545 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 15:32:04,546 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:04
2025-03-13 15:32:04,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:04,546 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:32:04,546 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:04,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:32:04,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:04
2025-03-13 15:32:04,547 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:04,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:32:04,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:04
2025-03-13 15:32:04,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:04,548 [INFO]: 	Creating the index 03/13/2025, 15:32:04
2025-03-13 15:32:04,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:04
2025-03-13 15:32:04,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:32:04,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:04
2025-03-13 15:32:04,552 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:32:04,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.10it/s] 36%|███▋      | 4/11 [00:00<00:00, 19.98it/s] 73%|███████▎  | 8/11 [00:00<00:00, 26.52it/s]100%|██████████| 11/11 [00:02<00:00,  3.31it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]
2025-03-13 15:32:07,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:07
2025-03-13 15:32:40,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0217 secs
2025-03-13 15:32:40,431 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 15:32:40,431 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.14it/s]
2025-03-13 15:32:59,010 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5780 secs
2025-03-13 15:32:59,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4604 secs
2025-03-13 15:32:59,012 [INFO]: {
2025-03-13 15:32:59,012 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:59,012 [INFO]: 	index_param: efSearch=126
2025-03-13 15:32:59,012 [INFO]: 	index_path: knn.index
2025-03-13 15:32:59,012 [INFO]: 	size in bytes: 501106570
2025-03-13 15:32:59,012 [INFO]: 	avg_search_speed_ms: 7.473877727705568
2025-03-13 15:32:59,012 [INFO]: 	99p_search_speed_ms: 10.746402731165277
2025-03-13 15:32:59,012 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:59,012 [INFO]: 	nb vectors: 2547
2025-03-13 15:32:59,012 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:59,012 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-13 15:32:59,012 [INFO]: }
2025-03-13 15:32:59,012 [INFO]: 	>>> Finished "Creating the index" in 54.4642 secs
2025-03-13 15:32:59,012 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5006 secs
2025-03-13 15:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 4776 [episode count 13/20]
[retrieval_preprocessing] for episode 23243 [episode count 14/20], we have num_retrieval=np.int64(2538) num_query=np.int64(139)
2025-03-13 15:32:59,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:01,095 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:01
2025-03-13 15:33:01,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.28it/s]
2025-03-13 15:33:01,132 [INFO]: There are 2538 embeddings of dim 49152
2025-03-13 15:33:01,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 15:33:01,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:01,133 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:33:01,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:01,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:01,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,133 [INFO]: 523.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:01,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:33:01,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:01
2025-03-13 15:33:01,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:01,133 [INFO]: 	Creating the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:01
2025-03-13 15:33:01,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:33:01,135 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:01
2025-03-13 15:33:01,135 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:33:01,135 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.35it/s] 50%|█████     | 5/10 [00:00<00:00, 26.86it/s]100%|██████████| 10/10 [00:02<00:00,  3.25it/s]100%|██████████| 10/10 [00:02<00:00,  3.79it/s]
2025-03-13 15:33:03,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:03
2025-03-13 15:33:35,493 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7118 secs
2025-03-13 15:33:35,493 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 15:33:35,493 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 15:34:04,257 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7642 secs
2025-03-13 15:34:04,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1244 secs
2025-03-13 15:34:04,260 [INFO]: {
2025-03-13 15:34:04,260 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:04,260 [INFO]: 	index_param: efSearch=197
2025-03-13 15:34:04,260 [INFO]: 	index_path: knn.index
2025-03-13 15:34:04,260 [INFO]: 	size in bytes: 499335790
2025-03-13 15:34:04,260 [INFO]: 	avg_search_speed_ms: 10.202705603549067
2025-03-13 15:34:04,260 [INFO]: 	99p_search_speed_ms: 16.858410644344993
2025-03-13 15:34:04,260 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:04,260 [INFO]: 	nb vectors: 2538
2025-03-13 15:34:04,260 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:04,260 [INFO]: 	compression ratio: 0.999309711006295
2025-03-13 15:34:04,260 [INFO]: }
2025-03-13 15:34:04,260 [INFO]: 	>>> Finished "Creating the index" in 63.1265 secs
2025-03-13 15:34:04,260 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1648 secs
2025-03-13 15:34:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 23243 [episode count 14/20]
[retrieval_preprocessing] for episode 9935 [episode count 15/20], we have num_retrieval=np.int64(2561) num_query=np.int64(116)
2025-03-13 15:34:05,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:06,359 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:06
2025-03-13 15:34:06,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1017.29it/s]
2025-03-13 15:34:06,386 [INFO]: There are 2561 embeddings of dim 49152
2025-03-13 15:34:06,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:34:06,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:06
2025-03-13 15:34:06,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:06,387 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:34:06,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:06,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:06,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:06
2025-03-13 15:34:06,387 [INFO]: 528.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:06,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:34:06,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:06
2025-03-13 15:34:06,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:06,387 [INFO]: 	Creating the index 03/13/2025, 15:34:06
2025-03-13 15:34:06,387 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:06
2025-03-13 15:34:06,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:34:06,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:06
2025-03-13 15:34:06,388 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:34:06,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.23it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.32it/s] 82%|████████▏ | 9/11 [00:00<00:00, 30.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.07it/s]
2025-03-13 15:34:09,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:09
2025-03-13 15:34:43,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1151 secs
2025-03-13 15:34:43,210 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 15:34:43,210 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 15:35:01,092 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8817 secs
2025-03-13 15:35:01,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7061 secs
2025-03-13 15:35:01,095 [INFO]: {
2025-03-13 15:35:01,095 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:01,095 [INFO]: 	index_param: efSearch=123
2025-03-13 15:35:01,095 [INFO]: 	index_path: knn.index
2025-03-13 15:35:01,095 [INFO]: 	size in bytes: 503860930
2025-03-13 15:35:01,095 [INFO]: 	avg_search_speed_ms: 9.303306410912164
2025-03-13 15:35:01,095 [INFO]: 	99p_search_speed_ms: 16.087681842036545
2025-03-13 15:35:01,095 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:01,095 [INFO]: 	nb vectors: 2561
2025-03-13 15:35:01,095 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:01,095 [INFO]: 	compression ratio: 0.9993096468106785
2025-03-13 15:35:01,095 [INFO]: }
2025-03-13 15:35:01,095 [INFO]: 	>>> Finished "Creating the index" in 54.7077 secs
2025-03-13 15:35:01,095 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7359 secs
2025-03-13 15:35:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 9935 [episode count 15/20]
[retrieval_preprocessing] for episode 20691 [episode count 16/20], we have num_retrieval=np.int64(2513) num_query=np.int64(164)
2025-03-13 15:35:02,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:02,588 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:02
2025-03-13 15:35:02,588 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.48it/s]
2025-03-13 15:35:02,617 [INFO]: There are 2513 embeddings of dim 49152
2025-03-13 15:35:02,617 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:35:02,617 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:02
2025-03-13 15:35:02,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:02,618 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:35:02,618 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:02,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:35:02,618 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:02
2025-03-13 15:35:02,618 [INFO]: 518.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:02,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:35:02,619 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:02
2025-03-13 15:35:02,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:02,619 [INFO]: 	Creating the index 03/13/2025, 15:35:02
2025-03-13 15:35:02,619 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:02
2025-03-13 15:35:02,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:35:02,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:02
2025-03-13 15:35:02,622 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:35:02,623 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.33it/s] 70%|███████   | 7/10 [00:00<00:00, 32.91it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-13 15:35:05,069 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:05
2025-03-13 15:35:35,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9575 secs
2025-03-13 15:35:35,028 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 15:35:35,028 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 15:35:59,573 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5446 secs
2025-03-13 15:35:59,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9526 secs
2025-03-13 15:35:59,575 [INFO]: {
2025-03-13 15:35:59,575 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:59,575 [INFO]: 	index_param: efSearch=164
2025-03-13 15:35:59,575 [INFO]: 	index_path: knn.index
2025-03-13 15:35:59,575 [INFO]: 	size in bytes: 494417110
2025-03-13 15:35:59,575 [INFO]: 	avg_search_speed_ms: 8.782573040824994
2025-03-13 15:35:59,575 [INFO]: 	99p_search_speed_ms: 12.157239494845234
2025-03-13 15:35:59,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:59,575 [INFO]: 	nb vectors: 2513
2025-03-13 15:35:59,575 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:59,575 [INFO]: 	compression ratio: 0.9993098822975605
2025-03-13 15:35:59,575 [INFO]: }
2025-03-13 15:35:59,576 [INFO]: 	>>> Finished "Creating the index" in 56.9570 secs
2025-03-13 15:35:59,576 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9882 secs
2025-03-13 15:36:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 20691 [episode count 16/20]
[retrieval_preprocessing] for episode 23777 [episode count 17/20], we have num_retrieval=np.int64(2492) num_query=np.int64(185)
2025-03-13 15:36:01,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:01,594 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:01
2025-03-13 15:36:01,594 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.90it/s]
2025-03-13 15:36:01,623 [INFO]: There are 2492 embeddings of dim 49152
2025-03-13 15:36:01,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:36:01,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:01
2025-03-13 15:36:01,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:01,624 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:36:01,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:01,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:01,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:01
2025-03-13 15:36:01,624 [INFO]: 514.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:01,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:36:01,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:01
2025-03-13 15:36:01,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:01,624 [INFO]: 	Creating the index 03/13/2025, 15:36:01
2025-03-13 15:36:01,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:01
2025-03-13 15:36:01,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:36:01,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:01
2025-03-13 15:36:01,625 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:36:01,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.37it/s] 60%|██████    | 6/10 [00:00<00:00, 30.83it/s]100%|██████████| 10/10 [00:02<00:00,  3.86it/s]100%|██████████| 10/10 [00:02<00:00,  4.63it/s]
2025-03-13 15:36:03,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:03
2025-03-13 15:36:33,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5160 secs
2025-03-13 15:36:33,306 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:36:33,306 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 15:36:55,145 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8393 secs
2025-03-13 15:36:55,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5226 secs
2025-03-13 15:36:55,148 [INFO]: {
2025-03-13 15:36:55,148 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:55,148 [INFO]: 	index_param: efSearch=191
2025-03-13 15:36:55,148 [INFO]: 	index_path: knn.index
2025-03-13 15:36:55,148 [INFO]: 	size in bytes: 490285390
2025-03-13 15:36:55,148 [INFO]: 	avg_search_speed_ms: 10.534035004675388
2025-03-13 15:36:55,148 [INFO]: 	99p_search_speed_ms: 15.451970361173153
2025-03-13 15:36:55,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:55,148 [INFO]: 	nb vectors: 2492
2025-03-13 15:36:55,148 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:55,148 [INFO]: 	compression ratio: 0.9993100875390147
2025-03-13 15:36:55,148 [INFO]: }
2025-03-13 15:36:55,148 [INFO]: 	>>> Finished "Creating the index" in 53.5241 secs
2025-03-13 15:36:55,148 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5539 secs
2025-03-13 15:36:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 23777 [episode count 17/20]
[retrieval_preprocessing] for episode 60650 [episode count 18/20], we have num_retrieval=np.int64(2575) num_query=np.int64(102)
2025-03-13 15:36:57,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:57,978 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:57
2025-03-13 15:36:57,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.14it/s]
2025-03-13 15:36:58,011 [INFO]: There are 2575 embeddings of dim 49152
2025-03-13 15:36:58,011 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 15:36:58,011 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:58
2025-03-13 15:36:58,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:58,012 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:36:58,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:58,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:36:58,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:58
2025-03-13 15:36:58,013 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:58,013 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:36:58,013 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:58
2025-03-13 15:36:58,013 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:58,014 [INFO]: 	Creating the index 03/13/2025, 15:36:58
2025-03-13 15:36:58,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:58
2025-03-13 15:36:58,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:36:58,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:58
2025-03-13 15:36:58,017 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:36:58,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.19it/s] 36%|███▋      | 4/11 [00:00<00:00, 18.10it/s] 64%|██████▎   | 7/11 [00:00<00:00, 20.39it/s] 91%|█████████ | 10/11 [00:00<00:00, 21.84it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]
2025-03-13 15:37:00,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:00
2025-03-13 15:37:40,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5736 secs
2025-03-13 15:37:40,391 [INFO]: The best hyperparameters are: efSearch=52
2025-03-13 15:37:40,391 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.05it/s]
2025-03-13 15:37:56,589 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1980 secs
2025-03-13 15:37:56,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5747 secs
2025-03-13 15:37:56,592 [INFO]: {
2025-03-13 15:37:56,592 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:56,592 [INFO]: 	index_param: efSearch=52
2025-03-13 15:37:56,592 [INFO]: 	index_path: knn.index
2025-03-13 15:37:56,592 [INFO]: 	size in bytes: 506615410
2025-03-13 15:37:56,592 [INFO]: 	avg_search_speed_ms: 4.48380484955851
2025-03-13 15:37:56,592 [INFO]: 	99p_search_speed_ms: 6.598045171704143
2025-03-13 15:37:56,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:56,592 [INFO]: 	nb vectors: 2575
2025-03-13 15:37:56,592 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:56,592 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-13 15:37:56,592 [INFO]: }
2025-03-13 15:37:56,592 [INFO]: 	>>> Finished "Creating the index" in 58.5784 secs
2025-03-13 15:37:56,592 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6136 secs
2025-03-13 15:37:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 60650 [episode count 18/20]
[retrieval_preprocessing] for episode 22763 [episode count 19/20], we have num_retrieval=np.int64(2547) num_query=np.int64(130)
2025-03-13 15:37:57,451 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:57,838 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:57
2025-03-13 15:37:57,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.57it/s]
2025-03-13 15:37:57,867 [INFO]: There are 2547 embeddings of dim 49152
2025-03-13 15:37:57,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:37:57,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:57
2025-03-13 15:37:57,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:57,867 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:37:57,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:57,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:37:57,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:57
2025-03-13 15:37:57,867 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:57,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:57,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:57
2025-03-13 15:37:57,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:57,868 [INFO]: 	Creating the index 03/13/2025, 15:37:57
2025-03-13 15:37:57,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:57
2025-03-13 15:37:57,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:37:57,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:57
2025-03-13 15:37:57,869 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:37:57,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.14it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.44it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]100%|██████████| 11/11 [00:02<00:00,  4.40it/s]
2025-03-13 15:38:00,370 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:00
2025-03-13 15:38:34,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3677 secs
2025-03-13 15:38:34,739 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:38:34,739 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 15:39:00,739 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0005 secs
2025-03-13 15:39:00,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8727 secs
2025-03-13 15:39:00,741 [INFO]: {
2025-03-13 15:39:00,742 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:00,742 [INFO]: 	index_param: efSearch=159
2025-03-13 15:39:00,742 [INFO]: 	index_path: knn.index
2025-03-13 15:39:00,742 [INFO]: 	size in bytes: 501106570
2025-03-13 15:39:00,742 [INFO]: 	avg_search_speed_ms: 7.935803449927046
2025-03-13 15:39:00,742 [INFO]: 	99p_search_speed_ms: 12.948383833281703
2025-03-13 15:39:00,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:00,742 [INFO]: 	nb vectors: 2547
2025-03-13 15:39:00,742 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:00,742 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-13 15:39:00,742 [INFO]: }
2025-03-13 15:39:00,742 [INFO]: 	>>> Finished "Creating the index" in 62.8741 secs
2025-03-13 15:39:00,742 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9035 secs
2025-03-13 15:39:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 22763 [episode count 19/20]
2025-03-13 15:39:01: [retrieval_preprocessing] finished for 3951366978_put_blue_cup_in_orange_cup [chosen_id count 2/196]
2025-03-13 15:39:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_remove_blue_ring_from_wooden_stand [chosen_id count 3/196]
2025-03-13 15:39:03: [retrieval_preprocessing] we have num_total=2461 embedding_dim=49152
[retrieval_preprocessing] for episode 91147 [episode count 0/20], we have num_retrieval=np.int64(2349) num_query=np.int64(112)
2025-03-13 15:39:03,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:03,660 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:03
2025-03-13 15:39:03,660 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.64it/s]
2025-03-13 15:39:03,689 [INFO]: There are 2349 embeddings of dim 49152
2025-03-13 15:39:03,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:39:03,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:03
2025-03-13 15:39:03,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:03,689 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:39:03,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:03,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:03,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:03
2025-03-13 15:39:03,689 [INFO]: 484.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:03,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:39:03,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:03
2025-03-13 15:39:03,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:03,690 [INFO]: 	Creating the index 03/13/2025, 15:39:03
2025-03-13 15:39:03,690 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:03
2025-03-13 15:39:03,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:39:03,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:03
2025-03-13 15:39:03,691 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:39:03,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:11,  1.33s/it] 60%|██████    | 6/10 [00:01<00:00,  5.29it/s]100%|██████████| 10/10 [00:03<00:00,  3.06it/s]100%|██████████| 10/10 [00:03<00:00,  2.99it/s]
2025-03-13 15:39:07,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:07
2025-03-13 15:39:40,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3236 secs
2025-03-13 15:39:40,358 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 15:39:40,358 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.61it/s]
2025-03-13 15:40:04,554 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1953 secs
2025-03-13 15:40:04,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8659 secs
2025-03-13 15:40:04,557 [INFO]: {
2025-03-13 15:40:04,557 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:04,557 [INFO]: 	index_param: efSearch=153
2025-03-13 15:40:04,557 [INFO]: 	index_path: knn.index
2025-03-13 15:40:04,557 [INFO]: 	size in bytes: 462151270
2025-03-13 15:40:04,557 [INFO]: 	avg_search_speed_ms: 10.452781374008632
2025-03-13 15:40:04,557 [INFO]: 	99p_search_speed_ms: 18.021038165315982
2025-03-13 15:40:04,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:04,557 [INFO]: 	nb vectors: 2349
2025-03-13 15:40:04,557 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:04,557 [INFO]: 	compression ratio: 0.9993095810382605
2025-03-13 15:40:04,557 [INFO]: }
2025-03-13 15:40:04,557 [INFO]: 	>>> Finished "Creating the index" in 60.8677 secs
2025-03-13 15:40:04,557 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8974 secs
2025-03-13 15:40:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 91147 [episode count 0/20]
[retrieval_preprocessing] for episode 64013 [episode count 1/20], we have num_retrieval=np.int64(2363) num_query=np.int64(98)
2025-03-13 15:40:05,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:05,959 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:05
2025-03-13 15:40:05,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1490.51it/s]
2025-03-13 15:40:05,988 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 15:40:05,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:40:05,989 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:05,989 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:40:05,989 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:05,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:40:05,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,990 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:05,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:40:05,990 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:05
2025-03-13 15:40:05,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:05,991 [INFO]: 	Creating the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,991 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:05
2025-03-13 15:40:05,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:40:05,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,994 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:40:05,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.76it/s] 70%|███████   | 7/10 [00:00<00:00, 33.78it/s]100%|██████████| 10/10 [00:02<00:00,  4.01it/s]
2025-03-13 15:40:08,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:08
2025-03-13 15:40:45,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9621 secs
2025-03-13 15:40:45,458 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:40:45,458 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.37it/s]
2025-03-13 15:41:07,354 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8959 secs
2025-03-13 15:41:07,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3617 secs
2025-03-13 15:41:07,356 [INFO]: {
2025-03-13 15:41:07,356 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:07,356 [INFO]: 	index_param: efSearch=182
2025-03-13 15:41:07,356 [INFO]: 	index_path: knn.index
2025-03-13 15:41:07,356 [INFO]: 	size in bytes: 464905690
2025-03-13 15:41:07,356 [INFO]: 	avg_search_speed_ms: 11.804290044912024
2025-03-13 15:41:07,356 [INFO]: 	99p_search_speed_ms: 19.55266594886779
2025-03-13 15:41:07,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:07,356 [INFO]: 	nb vectors: 2363
2025-03-13 15:41:07,356 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:07,356 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 15:41:07,357 [INFO]: }
2025-03-13 15:41:07,357 [INFO]: 	>>> Finished "Creating the index" in 61.3658 secs
2025-03-13 15:41:07,357 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3972 secs
2025-03-13 15:41:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 64013 [episode count 1/20]
[retrieval_preprocessing] for episode 78863 [episode count 2/20], we have num_retrieval=np.int64(2321) num_query=np.int64(140)
2025-03-13 15:41:08,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:09,252 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:09
2025-03-13 15:41:09,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.69it/s]
2025-03-13 15:41:09,289 [INFO]: There are 2321 embeddings of dim 49152
2025-03-13 15:41:09,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 15:41:09,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:09
2025-03-13 15:41:09,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:09,290 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:41:09,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:09,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:41:09,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:09
2025-03-13 15:41:09,291 [INFO]: 479.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:09,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:41:09,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:09
2025-03-13 15:41:09,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:09,291 [INFO]: 	Creating the index 03/13/2025, 15:41:09
2025-03-13 15:41:09,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:09
2025-03-13 15:41:09,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 15:41:09,294 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:09
2025-03-13 15:41:09,294 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:41:09,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.47it/s] 70%|███████   | 7/10 [00:00<00:00, 33.60it/s]100%|██████████| 10/10 [00:02<00:00,  4.91it/s]
2025-03-13 15:41:11,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:11
2025-03-13 15:41:49,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4311 secs
2025-03-13 15:41:49,767 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 15:41:49,767 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 15:42:09,225 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4579 secs
2025-03-13 15:42:09,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9327 secs
2025-03-13 15:42:09,227 [INFO]: {
2025-03-13 15:42:09,227 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:09,227 [INFO]: 	index_param: efSearch=203
2025-03-13 15:42:09,227 [INFO]: 	index_path: knn.index
2025-03-13 15:42:09,227 [INFO]: 	size in bytes: 456642550
2025-03-13 15:42:09,227 [INFO]: 	avg_search_speed_ms: 12.696452692640369
2025-03-13 15:42:09,227 [INFO]: 	99p_search_speed_ms: 20.648048361763358
2025-03-13 15:42:09,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:09,227 [INFO]: 	nb vectors: 2321
2025-03-13 15:42:09,227 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:09,227 [INFO]: 	compression ratio: 0.9993093460081632
2025-03-13 15:42:09,227 [INFO]: }
2025-03-13 15:42:09,227 [INFO]: 	>>> Finished "Creating the index" in 59.9359 secs
2025-03-13 15:42:09,227 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9750 secs
2025-03-13 15:42:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 78863 [episode count 2/20]
[retrieval_preprocessing] for episode 10264 [episode count 3/20], we have num_retrieval=np.int64(2344) num_query=np.int64(117)
2025-03-13 15:42:10,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:11,370 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:11
2025-03-13 15:42:11,370 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-13 15:42:11,401 [INFO]: There are 2344 embeddings of dim 49152
2025-03-13 15:42:11,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:42:11,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:11
2025-03-13 15:42:11,402 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:11,402 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:42:11,402 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:11,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:11,402 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:11
2025-03-13 15:42:11,402 [INFO]: 483.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:11,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:42:11,402 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:11
2025-03-13 15:42:11,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:11,402 [INFO]: 	Creating the index 03/13/2025, 15:42:11
2025-03-13 15:42:11,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:11
2025-03-13 15:42:11,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:42:11,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:11
2025-03-13 15:42:11,404 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:42:11,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.02it/s] 50%|█████     | 5/10 [00:00<00:00, 26.29it/s]100%|██████████| 10/10 [00:02<00:00,  3.10it/s]100%|██████████| 10/10 [00:02<00:00,  3.62it/s]
2025-03-13 15:42:14,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:14
2025-03-13 15:42:53,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8705 secs
2025-03-13 15:42:53,043 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:42:53,043 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 15:43:18,584 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5406 secs
2025-03-13 15:43:18,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1826 secs
2025-03-13 15:43:18,586 [INFO]: {
2025-03-13 15:43:18,586 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:18,586 [INFO]: 	index_param: efSearch=222
2025-03-13 15:43:18,586 [INFO]: 	index_path: knn.index
2025-03-13 15:43:18,586 [INFO]: 	size in bytes: 461167570
2025-03-13 15:43:18,586 [INFO]: 	avg_search_speed_ms: 11.161587525878401
2025-03-13 15:43:18,586 [INFO]: 	99p_search_speed_ms: 17.789976950734847
2025-03-13 15:43:18,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:18,586 [INFO]: 	nb vectors: 2344
2025-03-13 15:43:18,586 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:18,586 [INFO]: 	compression ratio: 0.9993095394804106
2025-03-13 15:43:18,586 [INFO]: }
2025-03-13 15:43:18,586 [INFO]: 	>>> Finished "Creating the index" in 67.1844 secs
2025-03-13 15:43:18,586 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2161 secs
2025-03-13 15:43:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 10264 [episode count 3/20]
[retrieval_preprocessing] for episode 90659 [episode count 4/20], we have num_retrieval=np.int64(2361) num_query=np.int64(100)
2025-03-13 15:43:19,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:20,287 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:20
2025-03-13 15:43:20,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 15:43:20,320 [INFO]: There are 2361 embeddings of dim 49152
2025-03-13 15:43:20,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 15:43:20,321 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:20
2025-03-13 15:43:20,321 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:20,321 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:43:20,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:20,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:43:20,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:20
2025-03-13 15:43:20,322 [INFO]: 487.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:20,323 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:43:20,323 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:20
2025-03-13 15:43:20,323 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:20,323 [INFO]: 	Creating the index 03/13/2025, 15:43:20
2025-03-13 15:43:20,324 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:20
2025-03-13 15:43:20,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:43:20,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:20
2025-03-13 15:43:20,327 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:43:20,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.30it/s] 40%|████      | 4/10 [00:00<00:00, 19.56it/s] 80%|████████  | 8/10 [00:00<00:00, 26.53it/s]100%|██████████| 10/10 [00:02<00:00,  4.70it/s]
2025-03-13 15:43:22,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:22
2025-03-13 15:44:01,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5335 secs
2025-03-13 15:44:01,996 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:44:01,996 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.92it/s]
2025-03-13 15:44:25,064 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0677 secs
2025-03-13 15:44:25,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7393 secs
2025-03-13 15:44:25,066 [INFO]: {
2025-03-13 15:44:25,066 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:25,066 [INFO]: 	index_param: efSearch=179
2025-03-13 15:44:25,066 [INFO]: 	index_path: knn.index
2025-03-13 15:44:25,066 [INFO]: 	size in bytes: 464512210
2025-03-13 15:44:25,066 [INFO]: 	avg_search_speed_ms: 8.718560183281241
2025-03-13 15:44:25,066 [INFO]: 	99p_search_speed_ms: 12.811501815449445
2025-03-13 15:44:25,066 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:25,066 [INFO]: 	nb vectors: 2361
2025-03-13 15:44:25,066 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:25,066 [INFO]: 	compression ratio: 0.9993095509803714
2025-03-13 15:44:25,066 [INFO]: }
2025-03-13 15:44:25,066 [INFO]: 	>>> Finished "Creating the index" in 64.7429 secs
2025-03-13 15:44:25,066 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7789 secs
2025-03-13 15:44:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 90659 [episode count 4/20]
[retrieval_preprocessing] for episode 16933 [episode count 5/20], we have num_retrieval=np.int64(2275) num_query=np.int64(186)
2025-03-13 15:44:26,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:26,912 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:26
2025-03-13 15:44:26,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.46it/s]
2025-03-13 15:44:26,942 [INFO]: There are 2275 embeddings of dim 49152
2025-03-13 15:44:26,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:44:26,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:26
2025-03-13 15:44:26,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:26,943 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:44:26,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:26,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:44:26,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:26
2025-03-13 15:44:26,943 [INFO]: 469.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:26,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:44:26,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:26
2025-03-13 15:44:26,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:26,943 [INFO]: 	Creating the index 03/13/2025, 15:44:26
2025-03-13 15:44:26,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:26
2025-03-13 15:44:26,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:44:26,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:26
2025-03-13 15:44:26,945 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:44:26,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.99it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.00it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 15:44:29,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:29
2025-03-13 15:45:06,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9968 secs
2025-03-13 15:45:06,334 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:45:06,334 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.93it/s]
2025-03-13 15:45:30,413 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0784 secs
2025-03-13 15:45:30,414 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4696 secs
2025-03-13 15:45:30,415 [INFO]: {
2025-03-13 15:45:30,415 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:30,415 [INFO]: 	index_param: efSearch=177
2025-03-13 15:45:30,415 [INFO]: 	index_path: knn.index
2025-03-13 15:45:30,415 [INFO]: 	size in bytes: 447592270
2025-03-13 15:45:30,415 [INFO]: 	avg_search_speed_ms: 9.271686652630388
2025-03-13 15:45:30,415 [INFO]: 	99p_search_speed_ms: 12.114337235689167
2025-03-13 15:45:30,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:30,415 [INFO]: 	nb vectors: 2275
2025-03-13 15:45:30,415 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:30,415 [INFO]: 	compression ratio: 0.9993094831597517
2025-03-13 15:45:30,415 [INFO]: }
2025-03-13 15:45:30,415 [INFO]: 	>>> Finished "Creating the index" in 63.4714 secs
2025-03-13 15:45:30,415 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5027 secs
2025-03-13 15:45:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 16933 [episode count 5/20]
[retrieval_preprocessing] for episode 18998 [episode count 6/20], we have num_retrieval=np.int64(2335) num_query=np.int64(126)
2025-03-13 15:45:32,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:32,636 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:32
2025-03-13 15:45:32,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 15:45:32,669 [INFO]: There are 2335 embeddings of dim 49152
2025-03-13 15:45:32,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 15:45:32,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:32
2025-03-13 15:45:32,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:32,670 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:45:32,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:32,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:32,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:32
2025-03-13 15:45:32,670 [INFO]: 481.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:32,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:45:32,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:32
2025-03-13 15:45:32,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:32,671 [INFO]: 	Creating the index 03/13/2025, 15:45:32
2025-03-13 15:45:32,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:32
2025-03-13 15:45:32,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:45:32,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:32
2025-03-13 15:45:32,672 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:45:32,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.15it/s] 50%|█████     | 5/10 [00:00<00:00, 24.79it/s]100%|██████████| 10/10 [00:02<00:00,  3.76it/s]100%|██████████| 10/10 [00:02<00:00,  4.34it/s]
2025-03-13 15:45:34,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:34
2025-03-13 15:46:12,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4978 secs
2025-03-13 15:46:12,477 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:46:12,477 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.15it/s]
2025-03-13 15:46:33,357 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8797 secs
2025-03-13 15:46:33,359 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6869 secs
2025-03-13 15:46:33,359 [INFO]: {
2025-03-13 15:46:33,359 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:33,359 [INFO]: 	index_param: efSearch=221
2025-03-13 15:46:33,359 [INFO]: 	index_path: knn.index
2025-03-13 15:46:33,359 [INFO]: 	size in bytes: 459396910
2025-03-13 15:46:33,359 [INFO]: 	avg_search_speed_ms: 12.523973031081399
2025-03-13 15:46:33,359 [INFO]: 	99p_search_speed_ms: 19.248378626070917
2025-03-13 15:46:33,359 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:33,360 [INFO]: 	nb vectors: 2335
2025-03-13 15:46:33,360 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:33,360 [INFO]: 	compression ratio: 0.9993094642277851
2025-03-13 15:46:33,360 [INFO]: }
2025-03-13 15:46:33,360 [INFO]: 	>>> Finished "Creating the index" in 60.6889 secs
2025-03-13 15:46:33,360 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7234 secs
2025-03-13 15:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 18998 [episode count 6/20]
[retrieval_preprocessing] for episode 15929 [episode count 7/20], we have num_retrieval=np.int64(2356) num_query=np.int64(105)
2025-03-13 15:46:34,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:34,969 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:34
2025-03-13 15:46:34,970 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.08it/s]
2025-03-13 15:46:34,998 [INFO]: There are 2356 embeddings of dim 49152
2025-03-13 15:46:34,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 15:46:34,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:34
2025-03-13 15:46:34,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:34,999 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:46:34,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:34,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:46:34,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:34
2025-03-13 15:46:35,000 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:35,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:46:35,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:35
2025-03-13 15:46:35,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:35,001 [INFO]: 	Creating the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:35
2025-03-13 15:46:35,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 15:46:35,003 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,003 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:46:35,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.46it/s] 70%|███████   | 7/10 [00:00<00:00, 32.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.62it/s]
2025-03-13 15:46:37,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:37
2025-03-13 15:47:12,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7853 secs
2025-03-13 15:47:12,960 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:47:12,960 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.73it/s]
2025-03-13 15:47:30,986 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0264 secs
2025-03-13 15:47:30,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9850 secs
2025-03-13 15:47:30,988 [INFO]: {
2025-03-13 15:47:30,988 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:30,988 [INFO]: 	index_param: efSearch=170
2025-03-13 15:47:30,988 [INFO]: 	index_path: knn.index
2025-03-13 15:47:30,988 [INFO]: 	size in bytes: 463528450
2025-03-13 15:47:30,989 [INFO]: 	avg_search_speed_ms: 9.307716002998253
2025-03-13 15:47:30,989 [INFO]: 	99p_search_speed_ms: 12.955804942175742
2025-03-13 15:47:30,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:30,989 [INFO]: 	nb vectors: 2356
2025-03-13 15:47:30,989 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:30,989 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-13 15:47:30,989 [INFO]: }
2025-03-13 15:47:30,989 [INFO]: 	>>> Finished "Creating the index" in 55.9878 secs
2025-03-13 15:47:30,989 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0191 secs
2025-03-13 15:47:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 15929 [episode count 7/20]
[retrieval_preprocessing] for episode 68681 [episode count 8/20], we have num_retrieval=np.int64(2356) num_query=np.int64(105)
2025-03-13 15:47:32,090 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:32,447 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:32
2025-03-13 15:47:32,447 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 15:47:32,473 [INFO]: There are 2356 embeddings of dim 49152
2025-03-13 15:47:32,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:47:32,473 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:32
2025-03-13 15:47:32,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:32,473 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:47:32,473 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:32,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:32,473 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:32
2025-03-13 15:47:32,474 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:32,474 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:47:32,474 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:32
2025-03-13 15:47:32,474 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:32,474 [INFO]: 	Creating the index 03/13/2025, 15:47:32
2025-03-13 15:47:32,474 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:32
2025-03-13 15:47:32,475 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:47:32,475 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:32
2025-03-13 15:47:32,475 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:47:32,475 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.35it/s] 60%|██████    | 6/10 [00:00<00:00, 31.57it/s]100%|██████████| 10/10 [00:01<00:00,  4.42it/s]100%|██████████| 10/10 [00:01<00:00,  5.28it/s]
2025-03-13 15:47:34,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:34
2025-03-13 15:48:09,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0688 secs
2025-03-13 15:48:09,443 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:48:09,443 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.80it/s]
2025-03-13 15:48:32,384 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9414 secs
2025-03-13 15:48:32,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9119 secs
2025-03-13 15:48:32,387 [INFO]: {
2025-03-13 15:48:32,387 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:32,387 [INFO]: 	index_param: efSearch=206
2025-03-13 15:48:32,387 [INFO]: 	index_path: knn.index
2025-03-13 15:48:32,387 [INFO]: 	size in bytes: 463528450
2025-03-13 15:48:32,387 [INFO]: 	avg_search_speed_ms: 10.269496981695188
2025-03-13 15:48:32,387 [INFO]: 	99p_search_speed_ms: 13.849965035915375
2025-03-13 15:48:32,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:32,387 [INFO]: 	nb vectors: 2356
2025-03-13 15:48:32,387 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:32,387 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-13 15:48:32,387 [INFO]: }
2025-03-13 15:48:32,387 [INFO]: 	>>> Finished "Creating the index" in 59.9136 secs
2025-03-13 15:48:32,387 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9407 secs
2025-03-13 15:48:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 68681 [episode count 8/20]
[retrieval_preprocessing] for episode 32339 [episode count 9/20], we have num_retrieval=np.int64(2308) num_query=np.int64(153)
2025-03-13 15:48:33,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:33,837 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:33
2025-03-13 15:48:33,837 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-13 15:48:33,862 [INFO]: There are 2308 embeddings of dim 49152
2025-03-13 15:48:33,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:48:33,863 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:33
2025-03-13 15:48:33,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:33,863 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:48:33,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:33,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:48:33,863 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:33
2025-03-13 15:48:33,863 [INFO]: 476.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:33,863 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:48:33,863 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:33
2025-03-13 15:48:33,863 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:33,863 [INFO]: 	Creating the index 03/13/2025, 15:48:33
2025-03-13 15:48:33,863 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:33
2025-03-13 15:48:33,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:48:33,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:33
2025-03-13 15:48:33,864 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:48:33,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.38it/s] 60%|██████    | 6/10 [00:00<00:00, 29.25it/s]100%|██████████| 10/10 [00:02<00:00,  3.51it/s]100%|██████████| 10/10 [00:02<00:00,  4.21it/s]
2025-03-13 15:48:36,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:36
2025-03-13 15:49:10,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4998 secs
2025-03-13 15:49:10,746 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:49:10,746 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.09it/s]
2025-03-13 15:49:35,012 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2652 secs
2025-03-13 15:49:35,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1492 secs
2025-03-13 15:49:35,014 [INFO]: {
2025-03-13 15:49:35,014 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:35,014 [INFO]: 	index_param: efSearch=183
2025-03-13 15:49:35,014 [INFO]: 	index_path: knn.index
2025-03-13 15:49:35,014 [INFO]: 	size in bytes: 454084870
2025-03-13 15:49:35,014 [INFO]: 	avg_search_speed_ms: 9.17659913565656
2025-03-13 15:49:35,014 [INFO]: 	99p_search_speed_ms: 14.543986897915602
2025-03-13 15:49:35,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:35,014 [INFO]: 	nb vectors: 2308
2025-03-13 15:49:35,014 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:35,014 [INFO]: 	compression ratio: 0.9993093669912411
2025-03-13 15:49:35,014 [INFO]: }
2025-03-13 15:49:35,014 [INFO]: 	>>> Finished "Creating the index" in 61.1507 secs
2025-03-13 15:49:35,014 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1771 secs
2025-03-13 15:49:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 32339 [episode count 9/20]
[retrieval_preprocessing] for episode 40684 [episode count 10/20], we have num_retrieval=np.int64(2303) num_query=np.int64(158)
2025-03-13 15:49:36,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:36,454 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:36
2025-03-13 15:49:36,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1807.11it/s]
2025-03-13 15:49:36,480 [INFO]: There are 2303 embeddings of dim 49152
2025-03-13 15:49:36,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:49:36,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:36
2025-03-13 15:49:36,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:36,480 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:49:36,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:36,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:36,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:36
2025-03-13 15:49:36,480 [INFO]: 475.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:36,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:49:36,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:36
2025-03-13 15:49:36,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:36,481 [INFO]: 	Creating the index 03/13/2025, 15:49:36
2025-03-13 15:49:36,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:36
2025-03-13 15:49:36,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:49:36,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:36
2025-03-13 15:49:36,482 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:49:36,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.02it/s] 80%|████████  | 8/10 [00:00<00:00, 40.23it/s]100%|██████████| 10/10 [00:01<00:00,  6.07it/s]
2025-03-13 15:49:38,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:38
2025-03-13 15:50:14,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2782 secs
2025-03-13 15:50:14,413 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:50:14,413 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 15:50:33,670 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2566 secs
2025-03-13 15:50:33,672 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1904 secs
2025-03-13 15:50:33,673 [INFO]: {
2025-03-13 15:50:33,673 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:33,673 [INFO]: 	index_param: efSearch=193
2025-03-13 15:50:33,673 [INFO]: 	index_path: knn.index
2025-03-13 15:50:33,673 [INFO]: 	size in bytes: 453101110
2025-03-13 15:50:33,673 [INFO]: 	avg_search_speed_ms: 12.679106590995525
2025-03-13 15:50:33,673 [INFO]: 	99p_search_speed_ms: 21.63579943589866
2025-03-13 15:50:33,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:33,673 [INFO]: 	nb vectors: 2303
2025-03-13 15:50:33,673 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:33,673 [INFO]: 	compression ratio: 0.9993094565581621
2025-03-13 15:50:33,673 [INFO]: }
2025-03-13 15:50:33,673 [INFO]: 	>>> Finished "Creating the index" in 57.1922 secs
2025-03-13 15:50:33,673 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2186 secs
2025-03-13 15:50:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 40684 [episode count 10/20]
[retrieval_preprocessing] for episode 77064 [episode count 11/20], we have num_retrieval=np.int64(2315) num_query=np.int64(146)
2025-03-13 15:50:35,530 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:35,988 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:35
2025-03-13 15:50:35,988 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.74it/s]
2025-03-13 15:50:36,023 [INFO]: There are 2315 embeddings of dim 49152
2025-03-13 15:50:36,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 15:50:36,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:36
2025-03-13 15:50:36,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:36,024 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:50:36,025 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:36,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:50:36,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:36
2025-03-13 15:50:36,025 [INFO]: 477.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:36,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:50:36,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:36
2025-03-13 15:50:36,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:36,026 [INFO]: 	Creating the index 03/13/2025, 15:50:36
2025-03-13 15:50:36,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:36
2025-03-13 15:50:36,029 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:50:36,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:36
2025-03-13 15:50:36,030 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:50:36,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.16it/s] 70%|███████   | 7/10 [00:00<00:00, 31.88it/s]100%|██████████| 10/10 [00:02<00:00,  4.72it/s]
2025-03-13 15:50:38,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:38
2025-03-13 15:51:18,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2476 secs
2025-03-13 15:51:18,402 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 15:51:18,402 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.26it/s]
2025-03-13 15:51:45,115 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7128 secs
2025-03-13 15:51:45,117 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0866 secs
2025-03-13 15:51:45,117 [INFO]: {
2025-03-13 15:51:45,117 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:45,117 [INFO]: 	index_param: efSearch=132
2025-03-13 15:51:45,117 [INFO]: 	index_path: knn.index
2025-03-13 15:51:45,117 [INFO]: 	size in bytes: 455462050
2025-03-13 15:51:45,117 [INFO]: 	avg_search_speed_ms: 8.036476209193731
2025-03-13 15:51:45,117 [INFO]: 	99p_search_speed_ms: 12.56103549618274
2025-03-13 15:51:45,117 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:45,117 [INFO]: 	nb vectors: 2315
2025-03-13 15:51:45,117 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:45,117 [INFO]: 	compression ratio: 0.9993094265482712
2025-03-13 15:51:45,117 [INFO]: }
2025-03-13 15:51:45,117 [INFO]: 	>>> Finished "Creating the index" in 69.0907 secs
2025-03-13 15:51:45,117 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1289 secs
2025-03-13 15:51:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 77064 [episode count 11/20]
[retrieval_preprocessing] for episode 777 [episode count 12/20], we have num_retrieval=np.int64(2368) num_query=np.int64(93)
2025-03-13 15:51:47,819 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:48,328 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:48
2025-03-13 15:51:48,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2361.66it/s]
2025-03-13 15:51:48,358 [INFO]: There are 2368 embeddings of dim 49152
2025-03-13 15:51:48,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 15:51:48,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:48
2025-03-13 15:51:48,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:48,359 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:51:48,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:48,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:51:48,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:48
2025-03-13 15:51:48,360 [INFO]: 488.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:48,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:51:48,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:48
2025-03-13 15:51:48,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:48,361 [INFO]: 	Creating the index 03/13/2025, 15:51:48
2025-03-13 15:51:48,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:48
2025-03-13 15:51:48,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:51:48,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:48
2025-03-13 15:51:48,365 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:51:48,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.03it/s] 70%|███████   | 7/10 [00:00<00:00, 31.56it/s]100%|██████████| 10/10 [00:01<00:00,  5.03it/s]
2025-03-13 15:51:50,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:50
2025-03-13 15:52:33,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9127 secs
2025-03-13 15:52:33,272 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:52:33,272 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.27it/s]
2025-03-13 15:52:56,363 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0912 secs
2025-03-13 15:52:56,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0002 secs
2025-03-13 15:52:56,365 [INFO]: {
2025-03-13 15:52:56,365 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:56,365 [INFO]: 	index_param: efSearch=156
2025-03-13 15:52:56,365 [INFO]: 	index_path: knn.index
2025-03-13 15:52:56,365 [INFO]: 	size in bytes: 465889390
2025-03-13 15:52:56,365 [INFO]: 	avg_search_speed_ms: 10.271998882978329
2025-03-13 15:52:56,365 [INFO]: 	99p_search_speed_ms: 14.811084123793986
2025-03-13 15:52:56,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:56,365 [INFO]: 	nb vectors: 2368
2025-03-13 15:52:56,365 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:56,365 [INFO]: 	compression ratio: 0.999309608660545
2025-03-13 15:52:56,365 [INFO]: }
2025-03-13 15:52:56,365 [INFO]: 	>>> Finished "Creating the index" in 68.0044 secs
2025-03-13 15:52:56,365 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0370 secs
2025-03-13 15:52:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 777 [episode count 12/20]
[retrieval_preprocessing] for episode 4873 [episode count 13/20], we have num_retrieval=np.int64(2364) num_query=np.int64(97)
2025-03-13 15:52:57,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:58,201 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:58
2025-03-13 15:52:58,201 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1707.08it/s]
2025-03-13 15:52:58,233 [INFO]: There are 2364 embeddings of dim 49152
2025-03-13 15:52:58,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 15:52:58,233 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:58
2025-03-13 15:52:58,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:58,233 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:52:58,233 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:58,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:58,233 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:58
2025-03-13 15:52:58,234 [INFO]: 487.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:58,234 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:52:58,234 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:58
2025-03-13 15:52:58,234 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:58,234 [INFO]: 	Creating the index 03/13/2025, 15:52:58
2025-03-13 15:52:58,234 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:58
2025-03-13 15:52:58,235 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:52:58,235 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:58
2025-03-13 15:52:58,235 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:52:58,235 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.02it/s] 70%|███████   | 7/10 [00:00<00:00, 32.96it/s]100%|██████████| 10/10 [00:02<00:00,  3.36it/s]
2025-03-13 15:53:01,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:01
2025-03-13 15:53:33,916 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7052 secs
2025-03-13 15:53:33,917 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:53:33,917 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 15:53:51,493 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5758 secs
2025-03-13 15:53:51,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2601 secs
2025-03-13 15:53:51,495 [INFO]: {
2025-03-13 15:53:51,495 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:51,495 [INFO]: 	index_param: efSearch=176
2025-03-13 15:53:51,495 [INFO]: 	index_path: knn.index
2025-03-13 15:53:51,495 [INFO]: 	size in bytes: 465102430
2025-03-13 15:53:51,495 [INFO]: 	avg_search_speed_ms: 11.86877843583597
2025-03-13 15:53:51,495 [INFO]: 	99p_search_speed_ms: 17.457965468056514
2025-03-13 15:53:51,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:51,495 [INFO]: 	nb vectors: 2364
2025-03-13 15:53:51,495 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:51,495 [INFO]: 	compression ratio: 0.9993095757422725
2025-03-13 15:53:51,495 [INFO]: }
2025-03-13 15:53:51,495 [INFO]: 	>>> Finished "Creating the index" in 53.2617 secs
2025-03-13 15:53:51,495 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2948 secs
2025-03-13 15:53:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 4873 [episode count 13/20]
[retrieval_preprocessing] for episode 11631 [episode count 14/20], we have num_retrieval=np.int64(2348) num_query=np.int64(113)
2025-03-13 15:53:53,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:53,791 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:53
2025-03-13 15:53:53,791 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-13 15:53:53,819 [INFO]: There are 2348 embeddings of dim 49152
2025-03-13 15:53:53,819 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:53:53,819 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:53
2025-03-13 15:53:53,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:53,820 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:53:53,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:53,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:53,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:53
2025-03-13 15:53:53,820 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:53,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:53:53,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:53
2025-03-13 15:53:53,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:53,820 [INFO]: 	Creating the index 03/13/2025, 15:53:53
2025-03-13 15:53:53,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:53
2025-03-13 15:53:53,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:53:53,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:53
2025-03-13 15:53:53,821 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:53:53,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.88it/s] 60%|██████    | 6/10 [00:00<00:00, 31.60it/s]100%|██████████| 10/10 [00:02<00:00,  4.00it/s]100%|██████████| 10/10 [00:02<00:00,  4.79it/s]
2025-03-13 15:53:55,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:55
2025-03-13 15:54:27,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3894 secs
2025-03-13 15:54:27,302 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 15:54:27,302 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 15:54:50,712 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4103 secs
2025-03-13 15:54:50,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8939 secs
2025-03-13 15:54:50,715 [INFO]: {
2025-03-13 15:54:50,716 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:50,716 [INFO]: 	index_param: efSearch=223
2025-03-13 15:54:50,716 [INFO]: 	index_path: knn.index
2025-03-13 15:54:50,716 [INFO]: 	size in bytes: 461954530
2025-03-13 15:54:50,716 [INFO]: 	avg_search_speed_ms: 12.079622406694714
2025-03-13 15:54:50,716 [INFO]: 	99p_search_speed_ms: 28.23968902230264
2025-03-13 15:54:50,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:50,716 [INFO]: 	nb vectors: 2348
2025-03-13 15:54:50,716 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:50,716 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-13 15:54:50,716 [INFO]: }
2025-03-13 15:54:50,716 [INFO]: 	>>> Finished "Creating the index" in 56.8961 secs
2025-03-13 15:54:50,716 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9250 secs
2025-03-13 15:54:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 11631 [episode count 14/20]
[retrieval_preprocessing] for episode 18421 [episode count 15/20], we have num_retrieval=np.int64(2350) num_query=np.int64(111)
2025-03-13 15:54:51,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:52,255 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:52
2025-03-13 15:54:52,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1691.25it/s]
2025-03-13 15:54:52,282 [INFO]: There are 2350 embeddings of dim 49152
2025-03-13 15:54:52,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:54:52,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:52
2025-03-13 15:54:52,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:52,282 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:54:52,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:52,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:52,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:52
2025-03-13 15:54:52,282 [INFO]: 485.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:52,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:52,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:52
2025-03-13 15:54:52,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:52,282 [INFO]: 	Creating the index 03/13/2025, 15:54:52
2025-03-13 15:54:52,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:52
2025-03-13 15:54:52,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:54:52,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:52
2025-03-13 15:54:52,284 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:54:52,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.07it/s] 50%|█████     | 5/10 [00:00<00:00, 24.34it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.12it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]
2025-03-13 15:54:54,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:54
2025-03-13 15:55:40,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3997 secs
2025-03-13 15:55:40,130 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:55:40,130 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.06it/s]
2025-03-13 15:55:59,075 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9449 secs
2025-03-13 15:55:59,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7939 secs
2025-03-13 15:55:59,078 [INFO]: {
2025-03-13 15:55:59,078 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:59,078 [INFO]: 	index_param: efSearch=182
2025-03-13 15:55:59,078 [INFO]: 	index_path: knn.index
2025-03-13 15:55:59,078 [INFO]: 	size in bytes: 462348010
2025-03-13 15:55:59,078 [INFO]: 	avg_search_speed_ms: 12.518735787538679
2025-03-13 15:55:59,078 [INFO]: 	99p_search_speed_ms: 21.339569725096226
2025-03-13 15:55:59,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:59,078 [INFO]: 	nb vectors: 2350
2025-03-13 15:55:59,078 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:59,078 [INFO]: 	compression ratio: 0.9993095893286098
2025-03-13 15:55:59,078 [INFO]: }
2025-03-13 15:55:59,078 [INFO]: 	>>> Finished "Creating the index" in 66.7955 secs
2025-03-13 15:55:59,078 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8228 secs
2025-03-13 15:55:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 18421 [episode count 15/20]
[retrieval_preprocessing] for episode 85423 [episode count 16/20], we have num_retrieval=np.int64(2342) num_query=np.int64(119)
2025-03-13 15:56:00,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:01,026 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:01
2025-03-13 15:56:01,026 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-13 15:56:01,053 [INFO]: There are 2342 embeddings of dim 49152
2025-03-13 15:56:01,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:56:01,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:01
2025-03-13 15:56:01,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:01,053 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:56:01,053 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:01,053 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:01,053 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:01
2025-03-13 15:56:01,054 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:01,054 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:56:01,054 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:01
2025-03-13 15:56:01,054 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:01,054 [INFO]: 	Creating the index 03/13/2025, 15:56:01
2025-03-13 15:56:01,054 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:01
2025-03-13 15:56:01,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:56:01,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:01
2025-03-13 15:56:01,055 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:56:01,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.43it/s] 40%|████      | 4/10 [00:00<00:00, 15.46it/s] 80%|████████  | 8/10 [00:00<00:00, 22.46it/s]100%|██████████| 10/10 [00:03<00:00,  3.23it/s]
2025-03-13 15:56:04,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:04
2025-03-13 15:56:44,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1481 secs
2025-03-13 15:56:44,306 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 15:56:44,306 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.71it/s]
2025-03-13 15:57:05,408 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1022 secs
2025-03-13 15:57:05,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3553 secs
2025-03-13 15:57:05,410 [INFO]: {
2025-03-13 15:57:05,411 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:05,411 [INFO]: 	index_param: efSearch=178
2025-03-13 15:57:05,411 [INFO]: 	index_path: knn.index
2025-03-13 15:57:05,411 [INFO]: 	size in bytes: 460774090
2025-03-13 15:57:05,411 [INFO]: 	avg_search_speed_ms: 9.371835803447226
2025-03-13 15:57:05,411 [INFO]: 	99p_search_speed_ms: 18.74849130399521
2025-03-13 15:57:05,411 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:05,411 [INFO]: 	nb vectors: 2342
2025-03-13 15:57:05,411 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:05,411 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-13 15:57:05,411 [INFO]: }
2025-03-13 15:57:05,411 [INFO]: 	>>> Finished "Creating the index" in 64.3570 secs
2025-03-13 15:57:05,411 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3850 secs
2025-03-13 15:57:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 85423 [episode count 16/20]
[retrieval_preprocessing] for episode 55741 [episode count 17/20], we have num_retrieval=np.int64(2309) num_query=np.int64(152)
2025-03-13 15:57:06,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:06,980 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:06
2025-03-13 15:57:06,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.95it/s]
2025-03-13 15:57:07,010 [INFO]: There are 2309 embeddings of dim 49152
2025-03-13 15:57:07,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:57:07,011 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:07
2025-03-13 15:57:07,011 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:07,011 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:57:07,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:07,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:57:07,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:07
2025-03-13 15:57:07,012 [INFO]: 476.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:07,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:57:07,013 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:07
2025-03-13 15:57:07,013 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:07,013 [INFO]: 	Creating the index 03/13/2025, 15:57:07
2025-03-13 15:57:07,013 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:07
2025-03-13 15:57:07,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:57:07,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:07
2025-03-13 15:57:07,017 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:57:07,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.04it/s] 70%|███████   | 7/10 [00:00<00:00, 33.03it/s]100%|██████████| 10/10 [00:02<00:00,  4.45it/s]
2025-03-13 15:57:09,267 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:09
2025-03-13 15:57:41,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7111 secs
2025-03-13 15:57:41,979 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 15:57:41,979 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 15:58:04,645 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6665 secs
2025-03-13 15:58:04,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6305 secs
2025-03-13 15:58:04,647 [INFO]: {
2025-03-13 15:58:04,647 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:04,647 [INFO]: 	index_param: efSearch=181
2025-03-13 15:58:04,647 [INFO]: 	index_path: knn.index
2025-03-13 15:58:04,647 [INFO]: 	size in bytes: 454281610
2025-03-13 15:58:04,647 [INFO]: 	avg_search_speed_ms: 10.024337401522141
2025-03-13 15:58:04,647 [INFO]: 	99p_search_speed_ms: 14.938227157108484
2025-03-13 15:58:04,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:04,647 [INFO]: 	nb vectors: 2309
2025-03-13 15:58:04,647 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:04,647 [INFO]: 	compression ratio: 0.9993093755214965
2025-03-13 15:58:04,647 [INFO]: }
2025-03-13 15:58:04,647 [INFO]: 	>>> Finished "Creating the index" in 57.6343 secs
2025-03-13 15:58:04,647 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6672 secs
2025-03-13 15:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 55741 [episode count 17/20]
[retrieval_preprocessing] for episode 7636 [episode count 18/20], we have num_retrieval=np.int64(2339) num_query=np.int64(122)
2025-03-13 15:58:05,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:06,401 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:06
2025-03-13 15:58:06,401 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.91it/s]
2025-03-13 15:58:06,431 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 15:58:06,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 15:58:06,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:06
2025-03-13 15:58:06,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:06,432 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:58:06,432 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:06,432 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:06,432 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:06
2025-03-13 15:58:06,432 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:06,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:58:06,432 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:06
2025-03-13 15:58:06,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:06,432 [INFO]: 	Creating the index 03/13/2025, 15:58:06
2025-03-13 15:58:06,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:06
2025-03-13 15:58:06,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:58:06,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:06
2025-03-13 15:58:06,434 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:58:06,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.43it/s] 60%|██████    | 6/10 [00:00<00:00, 29.67it/s]100%|██████████| 10/10 [00:02<00:00,  3.51it/s]100%|██████████| 10/10 [00:02<00:00,  4.21it/s]
2025-03-13 15:58:08,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:08
2025-03-13 15:58:36,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9080 secs
2025-03-13 15:58:36,720 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 15:58:36,720 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.89it/s]
2025-03-13 15:59:03,261 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5401 secs
2025-03-13 15:59:03,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8289 secs
2025-03-13 15:59:03,263 [INFO]: {
2025-03-13 15:59:03,263 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:03,263 [INFO]: 	index_param: efSearch=220
2025-03-13 15:59:03,263 [INFO]: 	index_path: knn.index
2025-03-13 15:59:03,263 [INFO]: 	size in bytes: 460183870
2025-03-13 15:59:03,263 [INFO]: 	avg_search_speed_ms: 10.774447308935562
2025-03-13 15:59:03,263 [INFO]: 	99p_search_speed_ms: 16.46083927713335
2025-03-13 15:59:03,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:03,263 [INFO]: 	nb vectors: 2339
2025-03-13 15:59:03,263 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:03,263 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 15:59:03,263 [INFO]: }
2025-03-13 15:59:03,263 [INFO]: 	>>> Finished "Creating the index" in 56.8310 secs
2025-03-13 15:59:03,263 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8623 secs
2025-03-13 15:59:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 7636 [episode count 18/20]
[retrieval_preprocessing] for episode 3687 [episode count 19/20], we have num_retrieval=np.int64(2353) num_query=np.int64(108)
2025-03-13 15:59:05,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:05,968 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:05
2025-03-13 15:59:05,968 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.24it/s]
2025-03-13 15:59:05,994 [INFO]: There are 2353 embeddings of dim 49152
2025-03-13 15:59:05,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:59:05,995 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:05
2025-03-13 15:59:05,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:05,995 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:59:05,995 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:05,995 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:59:05,995 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:05
2025-03-13 15:59:05,995 [INFO]: 485.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:05,995 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:59:05,995 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:05
2025-03-13 15:59:05,995 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:05,995 [INFO]: 	Creating the index 03/13/2025, 15:59:05
2025-03-13 15:59:05,995 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:05
2025-03-13 15:59:05,996 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:59:05,996 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:05
2025-03-13 15:59:05,996 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:59:05,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.25it/s] 50%|█████     | 5/10 [00:00<00:00, 25.70it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.64it/s]100%|██████████| 10/10 [00:02<00:00,  4.28it/s]
2025-03-13 15:59:08,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:08
2025-03-13 15:59:52,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3901 secs
2025-03-13 15:59:52,729 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 15:59:52,729 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.51it/s]
2025-03-13 16:00:11,903 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1740 secs
2025-03-13 16:00:12,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4861 secs
2025-03-13 16:00:12,483 [INFO]: {
2025-03-13 16:00:12,483 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:12,483 [INFO]: 	index_param: efSearch=125
2025-03-13 16:00:12,483 [INFO]: 	index_path: knn.index
2025-03-13 16:00:12,483 [INFO]: 	size in bytes: 462938230
2025-03-13 16:00:12,483 [INFO]: 	avg_search_speed_ms: 7.950571643644633
2025-03-13 16:00:12,483 [INFO]: 	99p_search_speed_ms: 11.53983432101086
2025-03-13 16:00:12,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:12,483 [INFO]: 	nb vectors: 2353
2025-03-13 16:00:12,483 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:12,483 [INFO]: 	compression ratio: 0.9993096141573791
2025-03-13 16:00:12,484 [INFO]: }
2025-03-13 16:00:12,484 [INFO]: 	>>> Finished "Creating the index" in 66.4883 secs
2025-03-13 16:00:12,484 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5153 secs
2025-03-13 16:00:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 3687 [episode count 19/20]
2025-03-13 16:00:13: [retrieval_preprocessing] finished for 3951366978_remove_blue_ring_from_wooden_stand [chosen_id count 3/196]
2025-03-13 16:00:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_lid_on_kettle [chosen_id count 4/196]
2025-03-13 16:00:14: [retrieval_preprocessing] we have num_total=6111 embedding_dim=49152
[retrieval_preprocessing] for episode 10760 [episode count 0/20], we have num_retrieval=np.int64(5798) num_query=np.int64(313)
2025-03-13 16:00:15,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:15,912 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:15
2025-03-13 16:00:15,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.00it/s]
2025-03-13 16:00:15,938 [INFO]: There are 5798 embeddings of dim 49152
2025-03-13 16:00:15,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:00:15,938 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:15
2025-03-13 16:00:15,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:15,938 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:00:15,938 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:15,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:00:15,938 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:15
2025-03-13 16:00:15,938 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:15,938 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:00:15,938 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:15
2025-03-13 16:00:15,938 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:15,938 [INFO]: 	Creating the index 03/13/2025, 16:00:15
2025-03-13 16:00:15,938 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:15
2025-03-13 16:00:15,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:00:15,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:15
2025-03-13 16:00:15,939 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:00:15,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  7.86it/s] 21%|██        | 5/24 [00:00<00:00, 22.79it/s] 42%|████▏     | 10/24 [00:00<00:00, 31.25it/s] 58%|█████▊    | 14/24 [00:00<00:00, 33.50it/s] 79%|███████▉  | 19/24 [00:00<00:00, 36.41it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.30it/s]100%|██████████| 24/24 [00:07<00:00,  3.37it/s]
2025-03-13 16:00:23,073 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:23
2025-03-13 16:01:12,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4407 secs
2025-03-13 16:01:12,514 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:01:12,514 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 16:01:54,470 [INFO]: 	>>> Finished "Compute fast metrics" in 41.9559 secs
2025-03-13 16:01:54,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.0439 secs
2025-03-13 16:01:54,984 [INFO]: {
2025-03-13 16:01:54,984 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:54,984 [INFO]: 	index_param: efSearch=145
2025-03-13 16:01:54,984 [INFO]: 	index_path: knn.index
2025-03-13 16:01:54,984 [INFO]: 	size in bytes: 1140722350
2025-03-13 16:01:54,984 [INFO]: 	avg_search_speed_ms: 8.80877759783541
2025-03-13 16:01:54,984 [INFO]: 	99p_search_speed_ms: 13.247278062626725
2025-03-13 16:01:54,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:54,984 [INFO]: 	nb vectors: 5798
2025-03-13 16:01:54,984 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:54,984 [INFO]: 	compression ratio: 0.999308187483133
2025-03-13 16:01:54,984 [INFO]: }
2025-03-13 16:01:54,984 [INFO]: 	>>> Finished "Creating the index" in 99.0458 secs
2025-03-13 16:01:54,984 [INFO]: >>> Finished "Launching the whole pipeline" in 99.0718 secs
2025-03-13 16:01:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 10760 [episode count 0/20]
[retrieval_preprocessing] for episode 33815 [episode count 1/20], we have num_retrieval=np.int64(5778) num_query=np.int64(333)
2025-03-13 16:01:59,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:00,701 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:00
2025-03-13 16:02:00,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.00it/s]
2025-03-13 16:02:00,726 [INFO]: There are 5778 embeddings of dim 49152
2025-03-13 16:02:00,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 16:02:00,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:00,727 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:02:00,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:00,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:02:00,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,727 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:00,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:02:00,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:00
2025-03-13 16:02:00,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:00,727 [INFO]: 	Creating the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,728 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:00
2025-03-13 16:02:00,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:02:00,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,730 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:02:00,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  4.93it/s] 25%|██▌       | 6/24 [00:00<00:00, 22.04it/s] 46%|████▌     | 11/24 [00:00<00:00, 30.87it/s] 67%|██████▋   | 16/24 [00:00<00:00, 35.49it/s] 88%|████████▊ | 21/24 [00:06<00:01,  2.12it/s]100%|██████████| 24/24 [00:08<00:00,  2.00it/s]100%|██████████| 24/24 [00:08<00:00,  2.94it/s]
2025-03-13 16:02:08,909 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:08
2025-03-13 16:03:01,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7469 secs
2025-03-13 16:03:01,657 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 16:03:01,657 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 16:04:12,102 [INFO]: 	>>> Finished "Compute fast metrics" in 70.4454 secs
2025-03-13 16:04:12,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.3739 secs
2025-03-13 16:04:12,104 [INFO]: {
2025-03-13 16:04:12,104 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:12,104 [INFO]: 	index_param: efSearch=291
2025-03-13 16:04:12,104 [INFO]: 	index_path: knn.index
2025-03-13 16:04:12,104 [INFO]: 	size in bytes: 1136787490
2025-03-13 16:04:12,104 [INFO]: 	avg_search_speed_ms: 12.390243684667563
2025-03-13 16:04:12,104 [INFO]: 	99p_search_speed_ms: 17.267855964601036
2025-03-13 16:04:12,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:12,104 [INFO]: 	nb vectors: 5778
2025-03-13 16:04:12,104 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:12,104 [INFO]: 	compression ratio: 0.9993081679672601
2025-03-13 16:04:12,104 [INFO]: }
2025-03-13 16:04:12,104 [INFO]: 	>>> Finished "Creating the index" in 131.3763 secs
2025-03-13 16:04:12,104 [INFO]: >>> Finished "Launching the whole pipeline" in 131.4029 secs
2025-03-13 16:04:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 33815 [episode count 1/20]
[retrieval_preprocessing] for episode 36391 [episode count 2/20], we have num_retrieval=np.int64(5849) num_query=np.int64(262)
2025-03-13 16:04:17,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:18,630 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:18
2025-03-13 16:04:18,630 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1329.41it/s]
2025-03-13 16:04:18,659 [INFO]: There are 5849 embeddings of dim 49152
2025-03-13 16:04:18,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 16:04:18,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:18,660 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:04:18,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:18,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:18,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,660 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:18,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:04:18,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:18
2025-03-13 16:04:18,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:18,660 [INFO]: 	Creating the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:18
2025-03-13 16:04:18,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:04:18,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,662 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:04:18,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.99it/s] 20%|██        | 5/25 [00:00<00:00, 21.30it/s] 40%|████      | 10/25 [00:00<00:00, 29.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 33.13it/s] 72%|███████▏  | 18/25 [00:00<00:00, 32.45it/s] 88%|████████▊ | 22/25 [00:06<00:01,  2.04it/s]100%|██████████| 25/25 [00:08<00:00,  1.88it/s]100%|██████████| 25/25 [00:08<00:00,  3.12it/s]
2025-03-13 16:04:26,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:26
2025-03-13 16:05:30,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4450 secs
2025-03-13 16:05:30,121 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:05:30,121 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 16:06:08,498 [INFO]: 	>>> Finished "Compute fast metrics" in 38.3765 secs
2025-03-13 16:06:08,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.8374 secs
2025-03-13 16:06:08,499 [INFO]: {
2025-03-13 16:06:08,499 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:08,499 [INFO]: 	index_param: efSearch=212
2025-03-13 16:06:08,499 [INFO]: 	index_path: knn.index
2025-03-13 16:06:08,499 [INFO]: 	size in bytes: 1150756210
2025-03-13 16:06:08,499 [INFO]: 	avg_search_speed_ms: 11.009780967521937
2025-03-13 16:06:08,499 [INFO]: 	99p_search_speed_ms: 17.250966457650055
2025-03-13 16:06:08,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:08,499 [INFO]: 	nb vectors: 5849
2025-03-13 16:06:08,499 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:08,499 [INFO]: 	compression ratio: 0.9993082653014751
2025-03-13 16:06:08,499 [INFO]: }
2025-03-13 16:06:08,499 [INFO]: 	>>> Finished "Creating the index" in 109.8391 secs
2025-03-13 16:06:08,499 [INFO]: >>> Finished "Launching the whole pipeline" in 109.8693 secs
2025-03-13 16:06:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 36391 [episode count 2/20]
[retrieval_preprocessing] for episode 29760 [episode count 3/20], we have num_retrieval=np.int64(5791) num_query=np.int64(320)
2025-03-13 16:06:11,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:12,028 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:12
2025-03-13 16:06:12,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-13 16:06:12,064 [INFO]: There are 5791 embeddings of dim 49152
2025-03-13 16:06:12,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 16:06:12,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:12,065 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:06:12,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:12,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:06:12,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,065 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:12,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:06:12,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:12
2025-03-13 16:06:12,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:12,066 [INFO]: 	Creating the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:12
2025-03-13 16:06:12,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 16:06:12,069 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,069 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:06:12,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.79it/s] 29%|██▉       | 7/24 [00:00<00:00, 35.08it/s] 50%|█████     | 12/24 [00:00<00:00, 41.60it/s] 71%|███████   | 17/24 [00:00<00:00, 44.24it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.10it/s]100%|██████████| 24/24 [00:05<00:00,  4.03it/s]
2025-03-13 16:06:18,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:18
2025-03-13 16:07:08,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9348 secs
2025-03-13 16:07:08,966 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:07:08,966 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 16:07:44,893 [INFO]: 	>>> Finished "Compute fast metrics" in 35.9265 secs
2025-03-13 16:07:44,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8250 secs
2025-03-13 16:07:44,894 [INFO]: {
2025-03-13 16:07:44,894 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:44,894 [INFO]: 	index_param: efSearch=236
2025-03-13 16:07:44,894 [INFO]: 	index_path: knn.index
2025-03-13 16:07:44,894 [INFO]: 	size in bytes: 1139345110
2025-03-13 16:07:44,894 [INFO]: 	avg_search_speed_ms: 14.162168732551441
2025-03-13 16:07:44,894 [INFO]: 	99p_search_speed_ms: 25.791881664190452
2025-03-13 16:07:44,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:44,894 [INFO]: 	nb vectors: 5791
2025-03-13 16:07:44,894 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:44,894 [INFO]: 	compression ratio: 0.9993082148744202
2025-03-13 16:07:44,894 [INFO]: }
2025-03-13 16:07:44,895 [INFO]: 	>>> Finished "Creating the index" in 92.8282 secs
2025-03-13 16:07:44,895 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8665 secs
2025-03-13 16:07:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 29760 [episode count 3/20]
[retrieval_preprocessing] for episode 32331 [episode count 4/20], we have num_retrieval=np.int64(5788) num_query=np.int64(323)
2025-03-13 16:07:49,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:50,352 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:50
2025-03-13 16:07:50,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.51it/s]
2025-03-13 16:07:50,381 [INFO]: There are 5788 embeddings of dim 49152
2025-03-13 16:07:50,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:07:50,381 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:50
2025-03-13 16:07:50,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:50,381 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:07:50,381 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:50,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:50,381 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:50
2025-03-13 16:07:50,382 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:50,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:50,382 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:50
2025-03-13 16:07:50,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:50,382 [INFO]: 	Creating the index 03/13/2025, 16:07:50
2025-03-13 16:07:50,382 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:50
2025-03-13 16:07:50,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:07:50,383 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:50
2025-03-13 16:07:50,383 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:07:50,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.79it/s] 17%|█▋        | 4/24 [00:00<00:01, 17.91it/s] 33%|███▎      | 8/24 [00:00<00:00, 25.88it/s] 50%|█████     | 12/24 [00:00<00:00, 29.87it/s] 67%|██████▋   | 16/24 [00:00<00:00, 32.17it/s] 83%|████████▎ | 20/24 [00:00<00:00, 33.58it/s]100%|██████████| 24/24 [00:07<00:00,  1.71it/s]100%|██████████| 24/24 [00:07<00:00,  3.28it/s]
2025-03-13 16:07:57,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:57
2025-03-13 16:08:59,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.1417 secs
2025-03-13 16:08:59,848 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:08:59,848 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-13 16:10:01,707 [INFO]: 	>>> Finished "Compute fast metrics" in 61.8592 secs
2025-03-13 16:10:01,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.3253 secs
2025-03-13 16:10:01,708 [INFO]: {
2025-03-13 16:10:01,708 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:01,708 [INFO]: 	index_param: efSearch=227
2025-03-13 16:10:01,709 [INFO]: 	index_path: knn.index
2025-03-13 16:10:01,709 [INFO]: 	size in bytes: 1138754890
2025-03-13 16:10:01,709 [INFO]: 	avg_search_speed_ms: 10.153456771188429
2025-03-13 16:10:01,709 [INFO]: 	99p_search_speed_ms: 14.857622152194375
2025-03-13 16:10:01,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:01,709 [INFO]: 	nb vectors: 5788
2025-03-13 16:10:01,709 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:01,709 [INFO]: 	compression ratio: 0.9993082040683926
2025-03-13 16:10:01,709 [INFO]: }
2025-03-13 16:10:01,709 [INFO]: 	>>> Finished "Creating the index" in 131.3269 secs
2025-03-13 16:10:01,709 [INFO]: >>> Finished "Launching the whole pipeline" in 131.3570 secs
2025-03-13 16:10:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 32331 [episode count 4/20]
[retrieval_preprocessing] for episode 37992 [episode count 5/20], we have num_retrieval=np.int64(5828) num_query=np.int64(283)
2025-03-13 16:10:06,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:07,454 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:07
2025-03-13 16:10:07,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 888.81it/s]
2025-03-13 16:10:07,482 [INFO]: There are 5828 embeddings of dim 49152
2025-03-13 16:10:07,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 16:10:07,482 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:07
2025-03-13 16:10:07,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:07,483 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:10:07,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:07,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:07,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:07
2025-03-13 16:10:07,483 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:07,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:10:07,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:07
2025-03-13 16:10:07,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:07,483 [INFO]: 	Creating the index 03/13/2025, 16:10:07
2025-03-13 16:10:07,483 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:07
2025-03-13 16:10:07,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:10:07,484 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:07
2025-03-13 16:10:07,484 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:10:07,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.85it/s] 25%|██▌       | 6/24 [00:00<00:00, 23.93it/s] 46%|████▌     | 11/24 [00:00<00:00, 32.41it/s] 67%|██████▋   | 16/24 [00:00<00:00, 37.05it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.63it/s]100%|██████████| 24/24 [00:06<00:00,  2.41it/s]100%|██████████| 24/24 [00:06<00:00,  3.55it/s]
2025-03-13 16:10:14,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:14
2025-03-13 16:11:15,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0069 secs
2025-03-13 16:11:15,261 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:11:15,261 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.73it/s]
2025-03-13 16:11:38,687 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4256 secs
2025-03-13 16:11:38,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2047 secs
2025-03-13 16:11:38,689 [INFO]: {
2025-03-13 16:11:38,689 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:38,689 [INFO]: 	index_param: efSearch=212
2025-03-13 16:11:38,689 [INFO]: 	index_path: knn.index
2025-03-13 16:11:38,689 [INFO]: 	size in bytes: 1146624670
2025-03-13 16:11:38,689 [INFO]: 	avg_search_speed_ms: 12.647250779950344
2025-03-13 16:11:38,689 [INFO]: 	99p_search_speed_ms: 20.21317491307855
2025-03-13 16:11:38,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:38,689 [INFO]: 	nb vectors: 5828
2025-03-13 16:11:38,689 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:38,689 [INFO]: 	compression ratio: 0.9993081903601464
2025-03-13 16:11:38,689 [INFO]: }
2025-03-13 16:11:38,689 [INFO]: 	>>> Finished "Creating the index" in 91.2062 secs
2025-03-13 16:11:38,689 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2355 secs
2025-03-13 16:11:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 37992 [episode count 5/20]
[retrieval_preprocessing] for episode 20134 [episode count 6/20], we have num_retrieval=np.int64(5816) num_query=np.int64(295)
2025-03-13 16:11:42,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:42,966 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:42
2025-03-13 16:11:42,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.58it/s]
2025-03-13 16:11:42,994 [INFO]: There are 5816 embeddings of dim 49152
2025-03-13 16:11:42,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:11:42,995 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:42,995 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:11:42,995 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:42,995 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:11:42,995 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,995 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:42,995 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:11:42,995 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:42
2025-03-13 16:11:42,995 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:42,995 [INFO]: 	Creating the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,995 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:42
2025-03-13 16:11:42,996 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:11:42,996 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,996 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:11:42,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.29it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.99it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.62it/s] 67%|██████▋   | 16/24 [00:00<00:00, 38.92it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.06it/s]100%|██████████| 24/24 [00:05<00:00,  2.75it/s]100%|██████████| 24/24 [00:05<00:00,  4.07it/s]
2025-03-13 16:11:48,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:48
2025-03-13 16:12:45,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.3608 secs
2025-03-13 16:12:45,261 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:12:45,261 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.87s/it] 50%|█████     | 2/4 [00:04<00:04,  2.41s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.44s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.44s/it]
2025-03-13 16:13:58,445 [INFO]: 	>>> Finished "Compute fast metrics" in 73.1837 secs
2025-03-13 16:13:58,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.4499 secs
2025-03-13 16:13:58,446 [INFO]: {
2025-03-13 16:13:58,446 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:58,446 [INFO]: 	index_param: efSearch=227
2025-03-13 16:13:58,446 [INFO]: 	index_path: knn.index
2025-03-13 16:13:58,446 [INFO]: 	size in bytes: 1144263730
2025-03-13 16:13:58,446 [INFO]: 	avg_search_speed_ms: 12.499281277414411
2025-03-13 16:13:58,446 [INFO]: 	99p_search_speed_ms: 30.50085529219359
2025-03-13 16:13:58,446 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:58,446 [INFO]: 	nb vectors: 5816
2025-03-13 16:13:58,446 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:58,446 [INFO]: 	compression ratio: 0.9993081996927404
2025-03-13 16:13:58,446 [INFO]: }
2025-03-13 16:13:58,446 [INFO]: 	>>> Finished "Creating the index" in 135.4513 secs
2025-03-13 16:13:58,446 [INFO]: >>> Finished "Launching the whole pipeline" in 135.4798 secs
2025-03-13 16:14:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 20134 [episode count 6/20]
[retrieval_preprocessing] for episode 10943 [episode count 7/20], we have num_retrieval=np.int64(5758) num_query=np.int64(353)
2025-03-13 16:14:03,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:04,583 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:04
2025-03-13 16:14:04,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 799.52it/s]
2025-03-13 16:14:04,623 [INFO]: There are 5758 embeddings of dim 49152
2025-03-13 16:14:04,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 16:14:04,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:04
2025-03-13 16:14:04,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:04,624 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:14:04,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:04,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:14:04,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:04
2025-03-13 16:14:04,624 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:04,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:04,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:04
2025-03-13 16:14:04,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:04,625 [INFO]: 	Creating the index 03/13/2025, 16:14:04
2025-03-13 16:14:04,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:04
2025-03-13 16:14:04,627 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:14:04,627 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:04
2025-03-13 16:14:04,627 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:14:04,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.61it/s] 21%|██        | 5/24 [00:00<00:00, 22.00it/s] 38%|███▊      | 9/24 [00:00<00:00, 27.39it/s] 54%|█████▍    | 13/24 [00:00<00:00, 31.28it/s] 71%|███████   | 17/24 [00:00<00:00, 32.03it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.40it/s]100%|██████████| 24/24 [00:07<00:00,  1.95it/s]100%|██████████| 24/24 [00:07<00:00,  3.26it/s]
2025-03-13 16:14:12,556 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:12
2025-03-13 16:15:14,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.4234 secs
2025-03-13 16:15:14,981 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 16:15:14,981 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.57s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.67it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.22it/s]
2025-03-13 16:15:47,411 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4303 secs
2025-03-13 16:15:47,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.7852 secs
2025-03-13 16:15:47,412 [INFO]: {
2025-03-13 16:15:47,412 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:47,412 [INFO]: 	index_param: efSearch=171
2025-03-13 16:15:47,412 [INFO]: 	index_path: knn.index
2025-03-13 16:15:47,412 [INFO]: 	size in bytes: 1132852570
2025-03-13 16:15:47,412 [INFO]: 	avg_search_speed_ms: 10.446540177571066
2025-03-13 16:15:47,412 [INFO]: 	99p_search_speed_ms: 18.571764174848788
2025-03-13 16:15:47,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:47,413 [INFO]: 	nb vectors: 5758
2025-03-13 16:15:47,413 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:47,413 [INFO]: 	compression ratio: 0.9993082012428148
2025-03-13 16:15:47,413 [INFO]: }
2025-03-13 16:15:47,413 [INFO]: 	>>> Finished "Creating the index" in 102.7886 secs
2025-03-13 16:15:47,413 [INFO]: >>> Finished "Launching the whole pipeline" in 102.8300 secs
2025-03-13 16:15:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 10943 [episode count 7/20]
[retrieval_preprocessing] for episode 56143 [episode count 8/20], we have num_retrieval=np.int64(5866) num_query=np.int64(245)
2025-03-13 16:15:52,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:53,295 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:53
2025-03-13 16:15:53,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.83it/s]
2025-03-13 16:15:53,324 [INFO]: There are 5866 embeddings of dim 49152
2025-03-13 16:15:53,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 16:15:53,324 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:53
2025-03-13 16:15:53,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:53,324 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:15:53,324 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:53,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:53,324 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:53
2025-03-13 16:15:53,324 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:53,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:15:53,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:53
2025-03-13 16:15:53,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:53,325 [INFO]: 	Creating the index 03/13/2025, 16:15:53
2025-03-13 16:15:53,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:53
2025-03-13 16:15:53,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:15:53,326 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:53
2025-03-13 16:15:53,326 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:15:53,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.63it/s] 24%|██▍       | 6/25 [00:00<00:00, 27.51it/s] 44%|████▍     | 11/25 [00:00<00:00, 33.71it/s] 60%|██████    | 15/25 [00:01<00:01,  9.01it/s] 80%|████████  | 20/25 [00:01<00:00, 13.34it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.26it/s]100%|██████████| 25/25 [00:07<00:00,  1.92it/s]100%|██████████| 25/25 [00:07<00:00,  3.29it/s]
2025-03-13 16:16:00,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:00
2025-03-13 16:16:57,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0080 secs
2025-03-13 16:16:57,933 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 16:16:57,933 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.45it/s]
2025-03-13 16:17:41,479 [INFO]: 	>>> Finished "Compute fast metrics" in 43.5462 secs
2025-03-13 16:17:41,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.2262 secs
2025-03-13 16:17:41,552 [INFO]: {
2025-03-13 16:17:41,552 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:41,552 [INFO]: 	index_param: efSearch=278
2025-03-13 16:17:41,552 [INFO]: 	index_path: knn.index
2025-03-13 16:17:41,553 [INFO]: 	size in bytes: 1154100910
2025-03-13 16:17:41,553 [INFO]: 	avg_search_speed_ms: 18.69679126653507
2025-03-13 16:17:41,553 [INFO]: 	99p_search_speed_ms: 27.067133616656065
2025-03-13 16:17:41,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:41,553 [INFO]: 	nb vectors: 5866
2025-03-13 16:17:41,553 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:41,553 [INFO]: 	compression ratio: 0.9993082216701484
2025-03-13 16:17:41,553 [INFO]: }
2025-03-13 16:17:41,553 [INFO]: 	>>> Finished "Creating the index" in 108.2285 secs
2025-03-13 16:17:41,553 [INFO]: >>> Finished "Launching the whole pipeline" in 108.2577 secs
2025-03-13 16:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 56143 [episode count 8/20]
[retrieval_preprocessing] for episode 21253 [episode count 9/20], we have num_retrieval=np.int64(5799) num_query=np.int64(312)
2025-03-13 16:17:45,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:47,442 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:47
2025-03-13 16:17:47,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1350.82it/s]
2025-03-13 16:17:47,471 [INFO]: There are 5799 embeddings of dim 49152
2025-03-13 16:17:47,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:17:47,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:47
2025-03-13 16:17:47,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:47,472 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:17:47,472 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:47,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:47,472 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:47
2025-03-13 16:17:47,472 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:47,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:47,472 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:47
2025-03-13 16:17:47,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:47,472 [INFO]: 	Creating the index 03/13/2025, 16:17:47
2025-03-13 16:17:47,472 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:47
2025-03-13 16:17:47,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:17:47,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:47
2025-03-13 16:17:47,474 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:17:47,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.64it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.54it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.15it/s] 67%|██████▋   | 16/24 [00:00<00:00, 38.25it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.30it/s]100%|██████████| 24/24 [00:08<00:00,  1.93it/s]100%|██████████| 24/24 [00:08<00:00,  2.93it/s]
2025-03-13 16:17:55,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:55
2025-03-13 16:18:55,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.7664 secs
2025-03-13 16:18:55,427 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 16:18:55,427 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.58it/s]
2025-03-13 16:19:32,389 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9624 secs
2025-03-13 16:19:32,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.9170 secs
2025-03-13 16:19:32,391 [INFO]: {
2025-03-13 16:19:32,391 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:32,391 [INFO]: 	index_param: efSearch=247
2025-03-13 16:19:32,391 [INFO]: 	index_path: knn.index
2025-03-13 16:19:32,391 [INFO]: 	size in bytes: 1140919090
2025-03-13 16:19:32,391 [INFO]: 	avg_search_speed_ms: 15.50571954585323
2025-03-13 16:19:32,391 [INFO]: 	99p_search_speed_ms: 24.53163342550397
2025-03-13 16:19:32,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:32,391 [INFO]: 	nb vectors: 5799
2025-03-13 16:19:32,391 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:32,391 [INFO]: 	compression ratio: 0.9993081910830329
2025-03-13 16:19:32,391 [INFO]: }
2025-03-13 16:19:32,391 [INFO]: 	>>> Finished "Creating the index" in 104.9189 secs
2025-03-13 16:19:32,391 [INFO]: >>> Finished "Launching the whole pipeline" in 104.9490 secs
2025-03-13 16:19:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 21253 [episode count 9/20]
[retrieval_preprocessing] for episode 89861 [episode count 10/20], we have num_retrieval=np.int64(5867) num_query=np.int64(244)
2025-03-13 16:19:37,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:38,886 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:38
2025-03-13 16:19:38,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1862.48it/s]
2025-03-13 16:19:39,376 [INFO]: There are 5867 embeddings of dim 49152
2025-03-13 16:19:39,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4897 secs
2025-03-13 16:19:39,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:39,377 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:19:39,377 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:39,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:39,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,377 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:39,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:39,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:39
2025-03-13 16:19:39,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:39,377 [INFO]: 	Creating the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:39
2025-03-13 16:19:39,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:19:39,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,378 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:19:39,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.71it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 32%|███▏      | 8/25 [00:00<00:00, 24.23it/s] 48%|████▊     | 12/25 [00:00<00:00, 27.87it/s] 64%|██████▍   | 16/25 [00:00<00:00, 29.06it/s] 80%|████████  | 20/25 [00:00<00:00, 29.17it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.14it/s]100%|██████████| 25/25 [00:07<00:00,  3.55it/s]
2025-03-13 16:19:46,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:46
2025-03-13 16:20:41,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.2315 secs
2025-03-13 16:20:41,663 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:20:41,663 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 16:21:23,374 [INFO]: 	>>> Finished "Compute fast metrics" in 41.7107 secs
2025-03-13 16:21:23,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.4864 secs
2025-03-13 16:21:23,865 [INFO]: {
2025-03-13 16:21:23,865 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:23,865 [INFO]: 	index_param: efSearch=220
2025-03-13 16:21:23,865 [INFO]: 	index_path: knn.index
2025-03-13 16:21:23,865 [INFO]: 	size in bytes: 1154297650
2025-03-13 16:21:23,866 [INFO]: 	avg_search_speed_ms: 10.189438375782851
2025-03-13 16:21:23,866 [INFO]: 	99p_search_speed_ms: 13.863907787017519
2025-03-13 16:21:23,866 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:23,866 [INFO]: 	nb vectors: 5867
2025-03-13 16:21:23,866 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:23,866 [INFO]: 	compression ratio: 0.9993082252224978
2025-03-13 16:21:23,866 [INFO]: }
2025-03-13 16:21:23,866 [INFO]: 	>>> Finished "Creating the index" in 104.4889 secs
2025-03-13 16:21:23,866 [INFO]: >>> Finished "Launching the whole pipeline" in 104.9794 secs
2025-03-13 16:21:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 89861 [episode count 10/20]
[retrieval_preprocessing] for episode 39225 [episode count 11/20], we have num_retrieval=np.int64(5822) num_query=np.int64(289)
2025-03-13 16:21:26,999 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:28,211 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:28
2025-03-13 16:21:28,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.57it/s]
2025-03-13 16:21:28,792 [INFO]: There are 5822 embeddings of dim 49152
2025-03-13 16:21:28,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5813 secs
2025-03-13 16:21:28,792 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:28
2025-03-13 16:21:28,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:28,793 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:21:28,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:28,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:21:28,793 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:28
2025-03-13 16:21:28,793 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:28,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:21:28,793 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:28
2025-03-13 16:21:28,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:28,794 [INFO]: 	Creating the index 03/13/2025, 16:21:28
2025-03-13 16:21:28,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:28
2025-03-13 16:21:28,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:21:28,796 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:28
2025-03-13 16:21:28,796 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:21:28,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.84it/s] 25%|██▌       | 6/24 [00:00<00:00, 30.30it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.42it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.87it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.69it/s]100%|██████████| 24/24 [00:07<00:00,  2.17it/s]100%|██████████| 24/24 [00:07<00:00,  3.31it/s]
2025-03-13 16:21:36,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:36
2025-03-13 16:22:34,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5570 secs
2025-03-13 16:22:34,600 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 16:22:34,600 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 16:23:26,401 [INFO]: 	>>> Finished "Compute fast metrics" in 51.8005 secs
2025-03-13 16:23:26,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.6059 secs
2025-03-13 16:23:26,402 [INFO]: {
2025-03-13 16:23:26,402 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:26,402 [INFO]: 	index_param: efSearch=240
2025-03-13 16:23:26,402 [INFO]: 	index_path: knn.index
2025-03-13 16:23:26,402 [INFO]: 	size in bytes: 1145444170
2025-03-13 16:23:26,402 [INFO]: 	avg_search_speed_ms: 10.165886872786862
2025-03-13 16:23:26,402 [INFO]: 	99p_search_speed_ms: 15.717908011283726
2025-03-13 16:23:26,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:26,402 [INFO]: 	nb vectors: 5822
2025-03-13 16:23:26,402 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:26,402 [INFO]: 	compression ratio: 0.9993082211942289
2025-03-13 16:23:26,402 [INFO]: }
2025-03-13 16:23:26,402 [INFO]: 	>>> Finished "Creating the index" in 117.6088 secs
2025-03-13 16:23:26,402 [INFO]: >>> Finished "Launching the whole pipeline" in 118.1916 secs
2025-03-13 16:23:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 39225 [episode count 11/20]
[retrieval_preprocessing] for episode 63790 [episode count 12/20], we have num_retrieval=np.int64(5807) num_query=np.int64(304)
2025-03-13 16:23:31,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:32,497 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:32
2025-03-13 16:23:32,497 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1218.92it/s]
2025-03-13 16:23:32,530 [INFO]: There are 5807 embeddings of dim 49152
2025-03-13 16:23:32,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 16:23:32,531 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:32
2025-03-13 16:23:32,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:32,531 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:23:32,531 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:32,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:23:32,532 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:32
2025-03-13 16:23:32,532 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:32,532 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:23:32,533 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:32
2025-03-13 16:23:32,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:32,533 [INFO]: 	Creating the index 03/13/2025, 16:23:32
2025-03-13 16:23:32,533 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:32
2025-03-13 16:23:32,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:23:32,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:32
2025-03-13 16:23:32,536 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:23:32,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.47it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.80it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.61it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.29it/s] 83%|████████▎ | 20/24 [00:00<00:00, 37.35it/s]100%|██████████| 24/24 [00:07<00:00,  1.77it/s]100%|██████████| 24/24 [00:07<00:00,  3.27it/s]
2025-03-13 16:23:40,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:40
2025-03-13 16:24:39,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3539 secs
2025-03-13 16:24:39,794 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:24:39,794 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 16:25:07,395 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6012 secs
2025-03-13 16:25:07,397 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.8607 secs
2025-03-13 16:25:07,397 [INFO]: {
2025-03-13 16:25:07,397 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:07,397 [INFO]: 	index_param: efSearch=179
2025-03-13 16:25:07,397 [INFO]: 	index_path: knn.index
2025-03-13 16:25:07,397 [INFO]: 	size in bytes: 1142493010
2025-03-13 16:25:07,397 [INFO]: 	avg_search_speed_ms: 10.3654864439596
2025-03-13 16:25:07,397 [INFO]: 	99p_search_speed_ms: 15.312560023739936
2025-03-13 16:25:07,397 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:07,397 [INFO]: 	nb vectors: 5807
2025-03-13 16:25:07,397 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:07,397 [INFO]: 	compression ratio: 0.9993082198375989
2025-03-13 16:25:07,397 [INFO]: }
2025-03-13 16:25:07,397 [INFO]: 	>>> Finished "Creating the index" in 94.8639 secs
2025-03-13 16:25:07,397 [INFO]: >>> Finished "Launching the whole pipeline" in 94.8998 secs
2025-03-13 16:25:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 63790 [episode count 12/20]
[retrieval_preprocessing] for episode 69608 [episode count 13/20], we have num_retrieval=np.int64(5853) num_query=np.int64(258)
2025-03-13 16:25:10,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:11,174 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:11
2025-03-13 16:25:11,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 935.39it/s]
2025-03-13 16:25:11,203 [INFO]: There are 5853 embeddings of dim 49152
2025-03-13 16:25:11,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 16:25:11,203 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:11
2025-03-13 16:25:11,203 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:11,203 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:25:11,203 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:11,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:11,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:11
2025-03-13 16:25:11,204 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:11,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:25:11,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:11
2025-03-13 16:25:11,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:11,204 [INFO]: 	Creating the index 03/13/2025, 16:25:11
2025-03-13 16:25:11,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:11
2025-03-13 16:25:11,205 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:25:11,205 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:11
2025-03-13 16:25:11,205 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:25:11,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.30it/s] 20%|██        | 5/25 [00:00<00:01, 19.62it/s] 36%|███▌      | 9/25 [00:00<00:00, 26.02it/s] 52%|█████▏    | 13/25 [00:00<00:00, 30.08it/s] 68%|██████▊   | 17/25 [00:00<00:00, 32.51it/s] 84%|████████▍ | 21/25 [00:04<00:01,  2.79it/s]100%|██████████| 25/25 [00:05<00:00,  2.75it/s]100%|██████████| 25/25 [00:05<00:00,  4.22it/s]
2025-03-13 16:25:17,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:17
2025-03-13 16:26:12,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9295 secs
2025-03-13 16:26:12,063 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 16:26:12,063 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 16:27:01,664 [INFO]: 	>>> Finished "Compute fast metrics" in 49.6012 secs
2025-03-13 16:27:01,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.4600 secs
2025-03-13 16:27:01,665 [INFO]: {
2025-03-13 16:27:01,665 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:01,665 [INFO]: 	index_param: efSearch=305
2025-03-13 16:27:01,665 [INFO]: 	index_path: knn.index
2025-03-13 16:27:01,665 [INFO]: 	size in bytes: 1151543170
2025-03-13 16:27:01,665 [INFO]: 	avg_search_speed_ms: 14.658073943768292
2025-03-13 16:27:01,665 [INFO]: 	99p_search_speed_ms: 27.291926643811166
2025-03-13 16:27:01,665 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:01,665 [INFO]: 	nb vectors: 5853
2025-03-13 16:27:01,665 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:01,666 [INFO]: 	compression ratio: 0.9993082795150442
2025-03-13 16:27:01,666 [INFO]: }
2025-03-13 16:27:01,666 [INFO]: 	>>> Finished "Creating the index" in 110.4615 secs
2025-03-13 16:27:01,666 [INFO]: >>> Finished "Launching the whole pipeline" in 110.4914 secs
2025-03-13 16:27:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 69608 [episode count 13/20]
[retrieval_preprocessing] for episode 82833 [episode count 14/20], we have num_retrieval=np.int64(5794) num_query=np.int64(317)
2025-03-13 16:27:07,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:08,245 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:08
2025-03-13 16:27:08,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1007.04it/s]
2025-03-13 16:27:08,273 [INFO]: There are 5794 embeddings of dim 49152
2025-03-13 16:27:08,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:27:08,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:08,273 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:27:08,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:08,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:27:08,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,274 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:08,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:27:08,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:08
2025-03-13 16:27:08,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:08,274 [INFO]: 	Creating the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:08
2025-03-13 16:27:08,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:27:08,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,275 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:27:08,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.02it/s] 12%|█▎        | 3/24 [00:00<00:01, 12.67it/s] 29%|██▉       | 7/24 [00:00<00:00, 22.63it/s] 46%|████▌     | 11/24 [00:00<00:00, 27.85it/s] 62%|██████▎   | 15/24 [00:00<00:00, 30.98it/s] 79%|███████▉  | 19/24 [00:00<00:00, 32.94it/s] 96%|█████████▌| 23/24 [00:07<00:00,  1.75it/s]100%|██████████| 24/24 [00:09<00:00,  2.51it/s]
2025-03-13 16:27:17,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:17
2025-03-13 16:28:14,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9933 secs
2025-03-13 16:28:14,820 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 16:28:14,820 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.22it/s]
2025-03-13 16:29:03,480 [INFO]: 	>>> Finished "Compute fast metrics" in 48.6598 secs
2025-03-13 16:29:03,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.6023 secs
2025-03-13 16:29:03,878 [INFO]: {
2025-03-13 16:29:03,878 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:03,878 [INFO]: 	index_param: efSearch=281
2025-03-13 16:29:03,878 [INFO]: 	index_path: knn.index
2025-03-13 16:29:03,878 [INFO]: 	size in bytes: 1139935390
2025-03-13 16:29:03,878 [INFO]: 	avg_search_speed_ms: 13.684757212253256
2025-03-13 16:29:03,878 [INFO]: 	99p_search_speed_ms: 25.725550628267154
2025-03-13 16:29:03,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:03,878 [INFO]: 	nb vectors: 5794
2025-03-13 16:29:03,879 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:03,879 [INFO]: 	compression ratio: 0.9993081730711071
2025-03-13 16:29:03,879 [INFO]: }
2025-03-13 16:29:03,879 [INFO]: 	>>> Finished "Creating the index" in 115.6048 secs
2025-03-13 16:29:03,879 [INFO]: >>> Finished "Launching the whole pipeline" in 115.6335 secs
2025-03-13 16:29:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 82833 [episode count 14/20]
[retrieval_preprocessing] for episode 36763 [episode count 15/20], we have num_retrieval=np.int64(5863) num_query=np.int64(248)
2025-03-13 16:29:09,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:10,072 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:10
2025-03-13 16:29:10,072 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.02it/s]
2025-03-13 16:29:10,100 [INFO]: There are 5863 embeddings of dim 49152
2025-03-13 16:29:10,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 16:29:10,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:10
2025-03-13 16:29:10,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:10,101 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:29:10,101 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:10,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:10,101 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:10
2025-03-13 16:29:10,101 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:10,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:10,101 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:10
2025-03-13 16:29:10,101 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:10,101 [INFO]: 	Creating the index 03/13/2025, 16:29:10
2025-03-13 16:29:10,101 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:10
2025-03-13 16:29:10,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:29:10,102 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:10
2025-03-13 16:29:10,102 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:29:10,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.51it/s] 20%|██        | 5/25 [00:00<00:00, 22.14it/s] 40%|████      | 10/25 [00:00<00:00, 31.72it/s] 60%|██████    | 15/25 [00:00<00:00, 38.08it/s] 84%|████████▍ | 21/25 [00:04<00:01,  3.36it/s]100%|██████████| 25/25 [00:05<00:00,  3.19it/s]100%|██████████| 25/25 [00:05<00:00,  4.37it/s]
2025-03-13 16:29:15,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:15
2025-03-13 16:30:18,850 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.0294 secs
2025-03-13 16:30:18,851 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 16:30:18,851 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 16:30:49,546 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6953 secs
2025-03-13 16:30:49,547 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.4446 secs
2025-03-13 16:30:49,547 [INFO]: {
2025-03-13 16:30:49,547 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:49,547 [INFO]: 	index_param: efSearch=244
2025-03-13 16:30:49,547 [INFO]: 	index_path: knn.index
2025-03-13 16:30:49,547 [INFO]: 	size in bytes: 1153510630
2025-03-13 16:30:49,547 [INFO]: 	avg_search_speed_ms: 12.330565212005071
2025-03-13 16:30:49,547 [INFO]: 	99p_search_speed_ms: 18.160986108705398
2025-03-13 16:30:49,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:49,547 [INFO]: 	nb vectors: 5863
2025-03-13 16:30:49,547 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:49,547 [INFO]: 	compression ratio: 0.9993082629849713
2025-03-13 16:30:49,547 [INFO]: }
2025-03-13 16:30:49,547 [INFO]: 	>>> Finished "Creating the index" in 99.4462 secs
2025-03-13 16:30:49,547 [INFO]: >>> Finished "Launching the whole pipeline" in 99.4755 secs
2025-03-13 16:30:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 36763 [episode count 15/20]
[retrieval_preprocessing] for episode 64414 [episode count 16/20], we have num_retrieval=np.int64(5884) num_query=np.int64(227)
2025-03-13 16:30:53,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:54,874 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:54
2025-03-13 16:30:54,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 16:30:54,900 [INFO]: There are 5884 embeddings of dim 49152
2025-03-13 16:30:54,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:30:54,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:54
2025-03-13 16:30:54,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:54,900 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:30:54,900 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:54,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:30:54,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:54
2025-03-13 16:30:54,901 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:54,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:30:54,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:54
2025-03-13 16:30:54,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:54,901 [INFO]: 	Creating the index 03/13/2025, 16:30:54
2025-03-13 16:30:54,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:54
2025-03-13 16:30:54,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:30:54,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:54
2025-03-13 16:30:54,902 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:30:54,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  9.09it/s] 24%|██▍       | 6/25 [00:00<00:00, 28.24it/s] 40%|████      | 10/25 [00:00<00:00, 33.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 34.69it/s] 72%|███████▏  | 18/25 [00:00<00:00, 35.10it/s] 88%|████████▊ | 22/25 [00:05<00:01,  2.43it/s]100%|██████████| 25/25 [00:06<00:00,  2.27it/s]100%|██████████| 25/25 [00:06<00:00,  3.77it/s]
2025-03-13 16:31:01,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:01
2025-03-13 16:31:55,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5971 secs
2025-03-13 16:31:55,133 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 16:31:55,133 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 16:32:42,187 [INFO]: 	>>> Finished "Compute fast metrics" in 47.0534 secs
2025-03-13 16:32:42,188 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.2857 secs
2025-03-13 16:32:42,188 [INFO]: {
2025-03-13 16:32:42,188 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:42,188 [INFO]: 	index_param: efSearch=244
2025-03-13 16:32:42,188 [INFO]: 	index_path: knn.index
2025-03-13 16:32:42,188 [INFO]: 	size in bytes: 1157642230
2025-03-13 16:32:42,188 [INFO]: 	avg_search_speed_ms: 11.308567791303757
2025-03-13 16:32:42,188 [INFO]: 	99p_search_speed_ms: 17.305056191980835
2025-03-13 16:32:42,188 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:42,188 [INFO]: 	nb vectors: 5884
2025-03-13 16:32:42,188 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:42,188 [INFO]: 	compression ratio: 0.9993082854277008
2025-03-13 16:32:42,188 [INFO]: }
2025-03-13 16:32:42,188 [INFO]: 	>>> Finished "Creating the index" in 107.2875 secs
2025-03-13 16:32:42,188 [INFO]: >>> Finished "Launching the whole pipeline" in 107.3139 secs
2025-03-13 16:32:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 64414 [episode count 16/20]
[retrieval_preprocessing] for episode 68521 [episode count 17/20], we have num_retrieval=np.int64(5633) num_query=np.int64(478)
2025-03-13 16:32:46,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:48,062 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:48
2025-03-13 16:32:48,062 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1087.73it/s]
2025-03-13 16:32:48,092 [INFO]: There are 5633 embeddings of dim 49152
2025-03-13 16:32:48,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:32:48,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:48
2025-03-13 16:32:48,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:48,093 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:32:48,093 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:48,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:32:48,093 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:48
2025-03-13 16:32:48,094 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:48,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:32:48,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:48
2025-03-13 16:32:48,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:48,094 [INFO]: 	Creating the index 03/13/2025, 16:32:48
2025-03-13 16:32:48,094 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:48
2025-03-13 16:32:48,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:32:48,097 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:48
2025-03-13 16:32:48,097 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:32:48,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.79it/s] 25%|██▌       | 6/24 [00:00<00:00, 25.40it/s] 46%|████▌     | 11/24 [00:00<00:00, 32.55it/s] 67%|██████▋   | 16/24 [00:00<00:00, 35.95it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.73it/s]100%|██████████| 24/24 [00:06<00:00,  2.52it/s]100%|██████████| 24/24 [00:06<00:00,  3.70it/s]
2025-03-13 16:32:54,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:54
2025-03-13 16:33:44,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8080 secs
2025-03-13 16:33:44,399 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 16:33:44,400 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.05it/s]
2025-03-13 16:34:10,723 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3238 secs
2025-03-13 16:34:10,725 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6277 secs
2025-03-13 16:34:10,725 [INFO]: {
2025-03-13 16:34:10,725 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:10,725 [INFO]: 	index_param: efSearch=247
2025-03-13 16:34:10,725 [INFO]: 	index_path: knn.index
2025-03-13 16:34:10,725 [INFO]: 	size in bytes: 1108259770
2025-03-13 16:34:10,725 [INFO]: 	avg_search_speed_ms: 14.757585551405661
2025-03-13 16:34:10,725 [INFO]: 	99p_search_speed_ms: 19.98954895418138
2025-03-13 16:34:10,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:10,725 [INFO]: 	nb vectors: 5633
2025-03-13 16:34:10,725 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:10,725 [INFO]: 	compression ratio: 0.9993080088073575
2025-03-13 16:34:10,725 [INFO]: }
2025-03-13 16:34:10,725 [INFO]: 	>>> Finished "Creating the index" in 82.6307 secs
2025-03-13 16:34:10,725 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6627 secs
2025-03-13 16:34:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 68521 [episode count 17/20]
[retrieval_preprocessing] for episode 85940 [episode count 18/20], we have num_retrieval=np.int64(5776) num_query=np.int64(335)
2025-03-13 16:34:18,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:19,897 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:19
2025-03-13 16:34:19,897 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.62it/s]
2025-03-13 16:34:19,926 [INFO]: There are 5776 embeddings of dim 49152
2025-03-13 16:34:19,926 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:34:19,926 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:19
2025-03-13 16:34:19,926 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:19,926 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:34:19,926 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:19,926 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:19,926 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:19
2025-03-13 16:34:19,927 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:19,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:34:19,927 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:19
2025-03-13 16:34:19,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:19,927 [INFO]: 	Creating the index 03/13/2025, 16:34:19
2025-03-13 16:34:19,927 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:19
2025-03-13 16:34:19,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:34:19,928 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:19
2025-03-13 16:34:19,928 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:34:19,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  7.99it/s] 21%|██        | 5/24 [00:00<00:00, 23.98it/s] 38%|███▊      | 9/24 [00:00<00:00, 28.75it/s] 58%|█████▊    | 14/24 [00:00<00:00, 32.95it/s] 79%|███████▉  | 19/24 [00:00<00:00, 36.08it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.80it/s]100%|██████████| 24/24 [00:06<00:00,  3.94it/s]
2025-03-13 16:34:26,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:26
2025-03-13 16:35:20,884 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8628 secs
2025-03-13 16:35:20,885 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 16:35:20,885 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 16:36:10,724 [INFO]: 	>>> Finished "Compute fast metrics" in 49.8395 secs
2025-03-13 16:36:10,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.7974 secs
2025-03-13 16:36:10,726 [INFO]: {
2025-03-13 16:36:10,726 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:10,726 [INFO]: 	index_param: efSearch=261
2025-03-13 16:36:10,726 [INFO]: 	index_path: knn.index
2025-03-13 16:36:10,726 [INFO]: 	size in bytes: 1136393950
2025-03-13 16:36:10,726 [INFO]: 	avg_search_speed_ms: 13.467236810262298
2025-03-13 16:36:10,726 [INFO]: 	99p_search_speed_ms: 22.202435573562994
2025-03-13 16:36:10,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:10,726 [INFO]: 	nb vectors: 5776
2025-03-13 16:36:10,726 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:10,726 [INFO]: 	compression ratio: 0.9993082134940968
2025-03-13 16:36:10,726 [INFO]: }
2025-03-13 16:36:10,726 [INFO]: 	>>> Finished "Creating the index" in 110.7992 secs
2025-03-13 16:36:10,726 [INFO]: >>> Finished "Launching the whole pipeline" in 110.8295 secs
2025-03-13 16:36:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 85940 [episode count 18/20]
[retrieval_preprocessing] for episode 57732 [episode count 19/20], we have num_retrieval=np.int64(5739) num_query=np.int64(372)
2025-03-13 16:36:16,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:17,277 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:17
2025-03-13 16:36:17,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.92it/s]
2025-03-13 16:36:17,306 [INFO]: There are 5739 embeddings of dim 49152
2025-03-13 16:36:17,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:36:17,307 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:17
2025-03-13 16:36:17,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:17,307 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 16:36:17,307 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:17,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:17,307 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:17
2025-03-13 16:36:17,307 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:17,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:17,307 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:17
2025-03-13 16:36:17,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:17,307 [INFO]: 	Creating the index 03/13/2025, 16:36:17
2025-03-13 16:36:17,307 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:17
2025-03-13 16:36:17,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:36:17,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:17
2025-03-13 16:36:17,309 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:36:17,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.08it/s] 21%|██        | 5/24 [00:00<00:00, 26.04it/s] 42%|████▏     | 10/24 [00:00<00:00, 34.74it/s] 62%|██████▎   | 15/24 [00:00<00:00, 38.75it/s] 83%|████████▎ | 20/24 [00:00<00:00, 41.00it/s]100%|██████████| 24/24 [00:06<00:00,  3.85it/s]
2025-03-13 16:36:23,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:23
2025-03-13 16:37:23,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0021 secs
2025-03-13 16:37:23,552 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:37:23,552 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 16:38:15,109 [INFO]: 	>>> Finished "Compute fast metrics" in 51.5570 secs
2025-03-13 16:38:15,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.8019 secs
2025-03-13 16:38:15,111 [INFO]: {
2025-03-13 16:38:15,111 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:15,111 [INFO]: 	index_param: efSearch=236
2025-03-13 16:38:15,111 [INFO]: 	index_path: knn.index
2025-03-13 16:38:15,111 [INFO]: 	size in bytes: 1129114510
2025-03-13 16:38:15,111 [INFO]: 	avg_search_speed_ms: 13.470965033036082
2025-03-13 16:38:15,111 [INFO]: 	99p_search_speed_ms: 27.49023362062873
2025-03-13 16:38:15,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:15,111 [INFO]: 	nb vectors: 5739
2025-03-13 16:38:15,111 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:15,111 [INFO]: 	compression ratio: 0.9993081321751857
2025-03-13 16:38:15,111 [INFO]: }
2025-03-13 16:38:15,111 [INFO]: 	>>> Finished "Creating the index" in 117.8037 secs
2025-03-13 16:38:15,111 [INFO]: >>> Finished "Launching the whole pipeline" in 117.8338 secs
2025-03-13 16:38:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 57732 [episode count 19/20]
2025-03-13 16:38:20: [retrieval_preprocessing] finished for 3951366978_put_lid_on_kettle [chosen_id count 4/196]
2025-03-13 16:38:23: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_lid_on_teapot [chosen_id count 5/196]
2025-03-13 16:38:23: [retrieval_preprocessing] we have num_total=5867 embedding_dim=49152
[retrieval_preprocessing] for episode 21019 [episode count 0/20], we have num_retrieval=np.int64(5581) num_query=np.int64(286)
2025-03-13 16:38:24,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:27,128 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:27
2025-03-13 16:38:27,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.23it/s]
2025-03-13 16:38:27,164 [INFO]: There are 5581 embeddings of dim 49152
2025-03-13 16:38:27,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 16:38:27,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:27
2025-03-13 16:38:27,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:27,166 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:38:27,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:27,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:38:27,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:27
2025-03-13 16:38:27,167 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:27,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:38:27,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:27
2025-03-13 16:38:27,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:27,168 [INFO]: 	Creating the index 03/13/2025, 16:38:27
2025-03-13 16:38:27,168 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:27
2025-03-13 16:38:27,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:38:27,171 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:27
2025-03-13 16:38:27,171 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:38:27,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.51it/s] 17%|█▋        | 4/23 [00:00<00:01, 18.42it/s] 30%|███       | 7/23 [00:00<00:00, 22.55it/s] 43%|████▎     | 10/23 [00:00<00:00, 24.32it/s] 57%|█████▋    | 13/23 [00:00<00:00, 22.63it/s] 70%|██████▉   | 16/23 [00:00<00:00, 22.16it/s] 83%|████████▎ | 19/23 [00:00<00:00, 22.38it/s] 96%|█████████▌| 22/23 [00:10<00:01,  1.06s/it]100%|██████████| 23/23 [00:12<00:00,  1.89it/s]
2025-03-13 16:38:39,375 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:39
2025-03-13 16:39:37,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9739 secs
2025-03-13 16:39:37,350 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 16:39:37,350 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 16:40:09,387 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0366 secs
2025-03-13 16:40:09,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.2171 secs
2025-03-13 16:40:09,388 [INFO]: {
2025-03-13 16:40:09,388 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:09,388 [INFO]: 	index_param: efSearch=245
2025-03-13 16:40:09,388 [INFO]: 	index_path: knn.index
2025-03-13 16:40:09,388 [INFO]: 	size in bytes: 1098029170
2025-03-13 16:40:09,388 [INFO]: 	avg_search_speed_ms: 10.271293102778893
2025-03-13 16:40:09,388 [INFO]: 	99p_search_speed_ms: 15.192192853428413
2025-03-13 16:40:09,388 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:09,388 [INFO]: 	nb vectors: 5581
2025-03-13 16:40:09,388 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:09,388 [INFO]: 	compression ratio: 0.9993079218469214
2025-03-13 16:40:09,388 [INFO]: }
2025-03-13 16:40:09,389 [INFO]: 	>>> Finished "Creating the index" in 102.2209 secs
2025-03-13 16:40:09,389 [INFO]: >>> Finished "Launching the whole pipeline" in 102.2605 secs
2025-03-13 16:40:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 21019 [episode count 0/20]
[retrieval_preprocessing] for episode 84008 [episode count 1/20], we have num_retrieval=np.int64(5570) num_query=np.int64(297)
2025-03-13 16:40:13,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:15,306 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:15
2025-03-13 16:40:15,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.46it/s]
2025-03-13 16:40:15,340 [INFO]: There are 5570 embeddings of dim 49152
2025-03-13 16:40:15,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 16:40:15,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:15,342 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:40:15,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:15,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:40:15,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,342 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:15,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:40:15,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:15
2025-03-13 16:40:15,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:15,343 [INFO]: 	Creating the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:15
2025-03-13 16:40:15,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:40:15,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,347 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:40:15,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.26it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.29it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.05it/s] 30%|███       | 7/23 [00:00<00:01,  9.80it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.89it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.95it/s] 57%|█████▋    | 13/23 [00:01<00:00, 10.59it/s] 65%|██████▌   | 15/23 [00:01<00:00, 10.95it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.53it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.04it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.38it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.63it/s]100%|██████████| 23/23 [00:07<00:00,  1.38it/s]100%|██████████| 23/23 [00:07<00:00,  3.12it/s]
2025-03-13 16:40:22,720 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:22
2025-03-13 16:41:07,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2752 secs
2025-03-13 16:41:07,996 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 16:41:07,996 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 16:41:40,305 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3084 secs
2025-03-13 16:41:40,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9591 secs
2025-03-13 16:41:40,306 [INFO]: {
2025-03-13 16:41:40,306 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:40,306 [INFO]: 	index_param: efSearch=215
2025-03-13 16:41:40,306 [INFO]: 	index_path: knn.index
2025-03-13 16:41:40,306 [INFO]: 	size in bytes: 1095864910
2025-03-13 16:41:40,306 [INFO]: 	avg_search_speed_ms: 11.263754184206796
2025-03-13 16:41:40,306 [INFO]: 	99p_search_speed_ms: 18.096126108430326
2025-03-13 16:41:40,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:40,306 [INFO]: 	nb vectors: 5570
2025-03-13 16:41:40,306 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:40,306 [INFO]: 	compression ratio: 0.9993079895221757
2025-03-13 16:41:40,306 [INFO]: }
2025-03-13 16:41:40,306 [INFO]: 	>>> Finished "Creating the index" in 84.9628 secs
2025-03-13 16:41:40,306 [INFO]: >>> Finished "Launching the whole pipeline" in 84.9999 secs
2025-03-13 16:41:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 84008 [episode count 1/20]
[retrieval_preprocessing] for episode 44080 [episode count 2/20], we have num_retrieval=np.int64(5591) num_query=np.int64(276)
2025-03-13 16:41:44,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:45,902 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:45
2025-03-13 16:41:45,902 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-13 16:41:45,930 [INFO]: There are 5591 embeddings of dim 49152
2025-03-13 16:41:45,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 16:41:45,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:45,931 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:41:45,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:45,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:41:45,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,931 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:45,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:41:45,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:45
2025-03-13 16:41:45,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:45,932 [INFO]: 	Creating the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:45
2025-03-13 16:41:45,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:41:45,933 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,933 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:41:45,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.94it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.06it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.70it/s] 30%|███       | 7/23 [00:00<00:01, 11.19it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.34it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.40it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.38it/s] 65%|██████▌   | 15/23 [00:01<00:00, 10.94it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.57it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.17it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.27it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.50it/s]100%|██████████| 23/23 [00:08<00:00,  1.21it/s]100%|██████████| 23/23 [00:08<00:00,  2.86it/s]
2025-03-13 16:41:53,972 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:53
2025-03-13 16:42:44,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0019 secs
2025-03-13 16:42:44,975 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:42:44,975 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 16:43:45,801 [INFO]: 	>>> Finished "Compute fast metrics" in 60.8261 secs
2025-03-13 16:43:45,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.8692 secs
2025-03-13 16:43:45,802 [INFO]: {
2025-03-13 16:43:45,802 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:45,802 [INFO]: 	index_param: efSearch=197
2025-03-13 16:43:45,802 [INFO]: 	index_path: knn.index
2025-03-13 16:43:45,802 [INFO]: 	size in bytes: 1099996570
2025-03-13 16:43:45,802 [INFO]: 	avg_search_speed_ms: 10.348247572891491
2025-03-13 16:43:45,802 [INFO]: 	99p_search_speed_ms: 16.671604942530397
2025-03-13 16:43:45,802 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:45,802 [INFO]: 	nb vectors: 5591
2025-03-13 16:43:45,802 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:45,802 [INFO]: 	compression ratio: 0.9993079596602742
2025-03-13 16:43:45,802 [INFO]: }
2025-03-13 16:43:45,802 [INFO]: 	>>> Finished "Creating the index" in 119.8708 secs
2025-03-13 16:43:45,802 [INFO]: >>> Finished "Launching the whole pipeline" in 119.9007 secs
2025-03-13 16:43:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 44080 [episode count 2/20]
[retrieval_preprocessing] for episode 43590 [episode count 3/20], we have num_retrieval=np.int64(5602) num_query=np.int64(265)
2025-03-13 16:43:52,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:53,542 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:53
2025-03-13 16:43:53,542 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.04it/s]
2025-03-13 16:43:53,570 [INFO]: There are 5602 embeddings of dim 49152
2025-03-13 16:43:53,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:43:53,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:53
2025-03-13 16:43:53,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:53,570 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:43:53,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:53,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:53,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:53
2025-03-13 16:43:53,570 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:53,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:43:53,570 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:53
2025-03-13 16:43:53,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:53,570 [INFO]: 	Creating the index 03/13/2025, 16:43:53
2025-03-13 16:43:53,570 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:53
2025-03-13 16:43:53,572 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:43:53,572 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:53
2025-03-13 16:43:53,572 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:43:53,572 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.91it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.14it/s] 21%|██        | 5/24 [00:00<00:01, 10.36it/s] 29%|██▉       | 7/24 [00:00<00:01,  9.91it/s] 38%|███▊      | 9/24 [00:00<00:01,  9.30it/s] 42%|████▏     | 10/24 [00:01<00:01,  8.93it/s] 50%|█████     | 12/24 [00:01<00:01,  8.81it/s] 54%|█████▍    | 13/24 [00:01<00:01,  8.33it/s] 58%|█████▊    | 14/24 [00:01<00:01,  7.92it/s] 62%|██████▎   | 15/24 [00:01<00:01,  7.89it/s] 67%|██████▋   | 16/24 [00:01<00:01,  7.71it/s] 71%|███████   | 17/24 [00:02<00:00,  7.51it/s] 75%|███████▌  | 18/24 [00:02<00:00,  7.72it/s] 79%|███████▉  | 19/24 [00:02<00:00,  7.79it/s] 83%|████████▎ | 20/24 [00:02<00:00,  7.97it/s] 88%|████████▊ | 21/24 [00:06<00:04,  1.36s/it] 92%|█████████▏| 22/24 [00:06<00:01,  1.01it/s] 96%|█████████▌| 23/24 [00:06<00:00,  1.37it/s]100%|██████████| 24/24 [00:08<00:00,  1.01s/it]100%|██████████| 24/24 [00:08<00:00,  2.78it/s]
2025-03-13 16:44:02,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:02
2025-03-13 16:44:51,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6944 secs
2025-03-13 16:44:51,894 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 16:44:51,894 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 16:45:31,185 [INFO]: 	>>> Finished "Compute fast metrics" in 39.2915 secs
2025-03-13 16:45:31,186 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.6143 secs
2025-03-13 16:45:31,186 [INFO]: {
2025-03-13 16:45:31,186 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:31,186 [INFO]: 	index_param: efSearch=224
2025-03-13 16:45:31,186 [INFO]: 	index_path: knn.index
2025-03-13 16:45:31,186 [INFO]: 	size in bytes: 1102160710
2025-03-13 16:45:31,186 [INFO]: 	avg_search_speed_ms: 10.400537196682329
2025-03-13 16:45:31,186 [INFO]: 	99p_search_speed_ms: 15.09226456051692
2025-03-13 16:45:31,186 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:31,186 [INFO]: 	nb vectors: 5602
2025-03-13 16:45:31,186 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:31,186 [INFO]: 	compression ratio: 0.9993080010990412
2025-03-13 16:45:31,186 [INFO]: }
2025-03-13 16:45:31,186 [INFO]: 	>>> Finished "Creating the index" in 97.6159 secs
2025-03-13 16:45:31,186 [INFO]: >>> Finished "Launching the whole pipeline" in 97.6440 secs
2025-03-13 16:45:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 43590 [episode count 3/20]
[retrieval_preprocessing] for episode 71747 [episode count 4/20], we have num_retrieval=np.int64(5613) num_query=np.int64(254)
2025-03-13 16:45:35,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:36,090 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:36
2025-03-13 16:45:36,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.23it/s]
2025-03-13 16:45:36,115 [INFO]: There are 5613 embeddings of dim 49152
2025-03-13 16:45:36,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:45:36,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:36
2025-03-13 16:45:36,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:36,115 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:45:36,115 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:36,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:36,115 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:36
2025-03-13 16:45:36,115 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:36,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:36,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:36
2025-03-13 16:45:36,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:36,115 [INFO]: 	Creating the index 03/13/2025, 16:45:36
2025-03-13 16:45:36,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:36
2025-03-13 16:45:36,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:45:36,117 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:36
2025-03-13 16:45:36,117 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:45:36,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.82it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.39it/s] 21%|██        | 5/24 [00:00<00:01, 10.62it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.34it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.71it/s] 46%|████▌     | 11/24 [00:00<00:01, 12.26it/s] 54%|█████▍    | 13/24 [00:01<00:00, 13.02it/s] 62%|██████▎   | 15/24 [00:01<00:00, 13.49it/s] 71%|███████   | 17/24 [00:01<00:00, 14.08it/s] 79%|███████▉  | 19/24 [00:01<00:00, 14.57it/s] 88%|████████▊ | 21/24 [00:05<00:02,  1.46it/s]100%|██████████| 24/24 [00:06<00:00,  1.72it/s]100%|██████████| 24/24 [00:06<00:00,  3.46it/s]
2025-03-13 16:45:43,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:43
2025-03-13 16:46:41,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7669 secs
2025-03-13 16:46:41,816 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 16:46:41,817 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 16:47:16,429 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6126 secs
2025-03-13 16:47:16,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.3139 secs
2025-03-13 16:47:16,431 [INFO]: {
2025-03-13 16:47:16,431 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:16,431 [INFO]: 	index_param: efSearch=205
2025-03-13 16:47:16,431 [INFO]: 	index_path: knn.index
2025-03-13 16:47:16,431 [INFO]: 	size in bytes: 1104324910
2025-03-13 16:47:16,431 [INFO]: 	avg_search_speed_ms: 10.472911193050171
2025-03-13 16:47:16,431 [INFO]: 	99p_search_speed_ms: 14.657770120538775
2025-03-13 16:47:16,431 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:16,431 [INFO]: 	nb vectors: 5613
2025-03-13 16:47:16,431 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:16,431 [INFO]: 	compression ratio: 0.9993079880811526
2025-03-13 16:47:16,431 [INFO]: }
2025-03-13 16:47:16,431 [INFO]: 	>>> Finished "Creating the index" in 100.3155 secs
2025-03-13 16:47:16,431 [INFO]: >>> Finished "Launching the whole pipeline" in 100.3411 secs
2025-03-13 16:47:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 71747 [episode count 4/20]
[retrieval_preprocessing] for episode 26742 [episode count 5/20], we have num_retrieval=np.int64(5584) num_query=np.int64(283)
2025-03-13 16:47:19,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:19,894 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:19
2025-03-13 16:47:19,894 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.73it/s]
2025-03-13 16:47:19,932 [INFO]: There are 5584 embeddings of dim 49152
2025-03-13 16:47:19,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 16:47:19,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:19
2025-03-13 16:47:19,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:19,933 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:47:19,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:19,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:47:19,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:19
2025-03-13 16:47:19,934 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:19,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:47:19,934 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:19
2025-03-13 16:47:19,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:19,934 [INFO]: 	Creating the index 03/13/2025, 16:47:19
2025-03-13 16:47:19,934 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:19
2025-03-13 16:47:19,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:47:19,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:19
2025-03-13 16:47:19,938 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:47:19,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.15it/s] 22%|██▏       | 5/23 [00:00<00:00, 26.41it/s] 43%|████▎     | 10/23 [00:00<00:00, 33.39it/s] 61%|██████    | 14/23 [00:00<00:00, 35.77it/s] 83%|████████▎ | 19/23 [00:00<00:00, 37.40it/s]100%|██████████| 23/23 [00:07<00:00,  1.74it/s]100%|██████████| 23/23 [00:07<00:00,  3.11it/s]
2025-03-13 16:47:27,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:27
2025-03-13 16:48:28,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0268 secs
2025-03-13 16:48:28,368 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 16:48:28,368 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.44it/s]
2025-03-13 16:48:53,859 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4907 secs
2025-03-13 16:48:54,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.1001 secs
2025-03-13 16:48:54,038 [INFO]: {
2025-03-13 16:48:54,039 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:54,039 [INFO]: 	index_param: efSearch=158
2025-03-13 16:48:54,039 [INFO]: 	index_path: knn.index
2025-03-13 16:48:54,039 [INFO]: 	size in bytes: 1098619390
2025-03-13 16:48:54,039 [INFO]: 	avg_search_speed_ms: 10.379358631658327
2025-03-13 16:48:54,039 [INFO]: 	99p_search_speed_ms: 18.09431110974401
2025-03-13 16:48:54,039 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:54,039 [INFO]: 	nb vectors: 5584
2025-03-13 16:48:54,039 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:54,039 [INFO]: 	compression ratio: 0.9993079332051475
2025-03-13 16:48:54,039 [INFO]: }
2025-03-13 16:48:54,039 [INFO]: 	>>> Finished "Creating the index" in 94.1049 secs
2025-03-13 16:48:54,039 [INFO]: >>> Finished "Launching the whole pipeline" in 94.1455 secs
2025-03-13 16:48:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 26742 [episode count 5/20]
[retrieval_preprocessing] for episode 18598 [episode count 6/20], we have num_retrieval=np.int64(5514) num_query=np.int64(353)
2025-03-13 16:48:58,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:59,114 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:59
2025-03-13 16:48:59,114 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1100.00it/s]
2025-03-13 16:48:59,143 [INFO]: There are 5514 embeddings of dim 49152
2025-03-13 16:48:59,143 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:48:59,143 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:59
2025-03-13 16:48:59,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:59,144 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:48:59,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:59,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:59,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:59
2025-03-13 16:48:59,144 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:59,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:59,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:59
2025-03-13 16:48:59,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:59,144 [INFO]: 	Creating the index 03/13/2025, 16:48:59
2025-03-13 16:48:59,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:59
2025-03-13 16:48:59,145 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:48:59,145 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:59
2025-03-13 16:48:59,145 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:48:59,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.21it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.17it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.72it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.44it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.81it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.95it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.01it/s] 61%|██████    | 14/23 [00:01<00:00, 10.30it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.93it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.75it/s] 78%|███████▊  | 18/23 [00:01<00:00,  8.51it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.56it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.71it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.14s/it] 96%|█████████▌| 22/23 [00:06<00:00,  1.16it/s]100%|██████████| 23/23 [00:08<00:00,  1.16s/it]100%|██████████| 23/23 [00:08<00:00,  2.78it/s]
2025-03-13 16:49:07,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:07
2025-03-13 16:49:55,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3077 secs
2025-03-13 16:49:55,743 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 16:49:55,743 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 16:50:57,216 [INFO]: 	>>> Finished "Compute fast metrics" in 61.4721 secs
2025-03-13 16:50:57,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.0711 secs
2025-03-13 16:50:57,217 [INFO]: {
2025-03-13 16:50:57,217 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:57,217 [INFO]: 	index_param: efSearch=266
2025-03-13 16:50:57,217 [INFO]: 	index_path: knn.index
2025-03-13 16:50:57,217 [INFO]: 	size in bytes: 1084847230
2025-03-13 16:50:57,217 [INFO]: 	avg_search_speed_ms: 11.879791374840373
2025-03-13 16:50:57,217 [INFO]: 	99p_search_speed_ms: 19.149012926500294
2025-03-13 16:50:57,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:57,217 [INFO]: 	nb vectors: 5514
2025-03-13 16:50:57,217 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:57,217 [INFO]: 	compression ratio: 0.9993079965738586
2025-03-13 16:50:57,217 [INFO]: }
2025-03-13 16:50:57,217 [INFO]: 	>>> Finished "Creating the index" in 118.0727 secs
2025-03-13 16:50:57,217 [INFO]: >>> Finished "Launching the whole pipeline" in 118.1026 secs
2025-03-13 16:50:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 18598 [episode count 6/20]
[retrieval_preprocessing] for episode 14503 [episode count 7/20], we have num_retrieval=np.int64(5468) num_query=np.int64(399)
2025-03-13 16:51:04,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:05,798 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:05
2025-03-13 16:51:05,798 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1188.52it/s]
2025-03-13 16:51:05,833 [INFO]: There are 5468 embeddings of dim 49152
2025-03-13 16:51:05,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 16:51:05,833 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:05
2025-03-13 16:51:05,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:05,833 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:51:05,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:05,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:05,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:05
2025-03-13 16:51:05,834 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:05,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:05,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:05
2025-03-13 16:51:05,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:05,834 [INFO]: 	Creating the index 03/13/2025, 16:51:05
2025-03-13 16:51:05,834 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:05
2025-03-13 16:51:05,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:51:05,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:05
2025-03-13 16:51:05,836 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:51:05,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:05,  4.21it/s]  9%|▊         | 2/23 [00:00<00:03,  5.48it/s] 13%|█▎        | 3/23 [00:00<00:03,  6.13it/s] 17%|█▋        | 4/23 [00:00<00:02,  6.43it/s] 22%|██▏       | 5/23 [00:00<00:02,  6.54it/s] 26%|██▌       | 6/23 [00:00<00:02,  6.64it/s] 30%|███       | 7/23 [00:01<00:02,  6.74it/s] 35%|███▍      | 8/23 [00:01<00:02,  6.91it/s] 39%|███▉      | 9/23 [00:01<00:01,  7.19it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.46it/s] 48%|████▊     | 11/23 [00:01<00:01,  7.73it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.10it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.37it/s] 65%|██████▌   | 15/23 [00:02<00:00,  9.26it/s] 70%|██████▉   | 16/23 [00:02<00:00,  9.34it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.22it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.33it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.72it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.05s/it] 96%|█████████▌| 22/23 [00:06<00:00,  1.23it/s]100%|██████████| 23/23 [00:08<00:00,  1.04it/s]100%|██████████| 23/23 [00:08<00:00,  2.84it/s]
2025-03-13 16:51:13,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:13
2025-03-13 16:52:04,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1198 secs
2025-03-13 16:52:04,070 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:52:04,070 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 16:52:36,610 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5403 secs
2025-03-13 16:52:36,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1223 secs
2025-03-13 16:52:36,958 [INFO]: {
2025-03-13 16:52:36,958 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:36,958 [INFO]: 	index_param: efSearch=218
2025-03-13 16:52:36,958 [INFO]: 	index_path: knn.index
2025-03-13 16:52:36,958 [INFO]: 	size in bytes: 1075797010
2025-03-13 16:52:36,958 [INFO]: 	avg_search_speed_ms: 11.017709925600496
2025-03-13 16:52:36,959 [INFO]: 	99p_search_speed_ms: 19.724971819669
2025-03-13 16:52:36,959 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:36,959 [INFO]: 	nb vectors: 5468
2025-03-13 16:52:36,959 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:36,959 [INFO]: 	compression ratio: 0.9993079865503623
2025-03-13 16:52:36,959 [INFO]: }
2025-03-13 16:52:36,959 [INFO]: 	>>> Finished "Creating the index" in 91.1250 secs
2025-03-13 16:52:36,959 [INFO]: >>> Finished "Launching the whole pipeline" in 91.1611 secs
2025-03-13 16:52:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 14503 [episode count 7/20]
[retrieval_preprocessing] for episode 72358 [episode count 8/20], we have num_retrieval=np.int64(5585) num_query=np.int64(282)
2025-03-13 16:52:42,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:43,449 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:43
2025-03-13 16:52:43,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1273.32it/s]
2025-03-13 16:52:43,480 [INFO]: There are 5585 embeddings of dim 49152
2025-03-13 16:52:43,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 16:52:43,481 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:43
2025-03-13 16:52:43,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:43,482 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:52:43,482 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:43,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:52:43,482 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:43
2025-03-13 16:52:43,482 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:43,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:52:43,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:43
2025-03-13 16:52:43,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:43,483 [INFO]: 	Creating the index 03/13/2025, 16:52:43
2025-03-13 16:52:43,483 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:43
2025-03-13 16:52:43,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:52:43,487 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:43
2025-03-13 16:52:43,487 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:52:43,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.62it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.94it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.18it/s] 30%|███       | 7/23 [00:00<00:01, 11.95it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.55it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.89it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.13it/s] 65%|██████▌   | 15/23 [00:01<00:00, 13.09it/s] 74%|███████▍  | 17/23 [00:01<00:00, 13.21it/s] 83%|████████▎ | 19/23 [00:01<00:00, 13.27it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.65it/s]100%|██████████| 23/23 [00:06<00:00,  1.63it/s]100%|██████████| 23/23 [00:06<00:00,  3.60it/s]
2025-03-13 16:52:49,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:49
2025-03-13 16:53:33,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7213 secs
2025-03-13 16:53:33,609 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:53:33,609 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 16:54:15,169 [INFO]: 	>>> Finished "Compute fast metrics" in 41.5594 secs
2025-03-13 16:54:15,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6826 secs
2025-03-13 16:54:15,170 [INFO]: {
2025-03-13 16:54:15,170 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:15,170 [INFO]: 	index_param: efSearch=237
2025-03-13 16:54:15,170 [INFO]: 	index_path: knn.index
2025-03-13 16:54:15,170 [INFO]: 	size in bytes: 1098816130
2025-03-13 16:54:15,170 [INFO]: 	avg_search_speed_ms: 12.985552253742762
2025-03-13 16:54:15,170 [INFO]: 	99p_search_speed_ms: 23.94909982103852
2025-03-13 16:54:15,170 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:15,170 [INFO]: 	nb vectors: 5585
2025-03-13 16:54:15,170 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:15,170 [INFO]: 	compression ratio: 0.9993079369885114
2025-03-13 16:54:15,170 [INFO]: }
2025-03-13 16:54:15,170 [INFO]: 	>>> Finished "Creating the index" in 91.6868 secs
2025-03-13 16:54:15,170 [INFO]: >>> Finished "Launching the whole pipeline" in 91.7210 secs
2025-03-13 16:54:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 72358 [episode count 8/20]
[retrieval_preprocessing] for episode 15631 [episode count 9/20], we have num_retrieval=np.int64(5591) num_query=np.int64(276)
2025-03-13 16:54:21,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:22,296 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:22
2025-03-13 16:54:22,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 837.52it/s]
2025-03-13 16:54:22,326 [INFO]: There are 5591 embeddings of dim 49152
2025-03-13 16:54:22,327 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 16:54:22,327 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:22
2025-03-13 16:54:22,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:22,328 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:54:22,328 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:22,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:54:22,328 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:22
2025-03-13 16:54:22,328 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:22,328 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:54:22,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:22
2025-03-13 16:54:22,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:22,329 [INFO]: 	Creating the index 03/13/2025, 16:54:22
2025-03-13 16:54:22,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:22
2025-03-13 16:54:22,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 16:54:22,333 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:22
2025-03-13 16:54:22,333 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:54:22,333 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.30it/s]  9%|▊         | 2/23 [00:00<00:03,  6.87it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.71it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.12it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.38it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.37it/s] 30%|███       | 7/23 [00:00<00:01,  8.47it/s] 35%|███▍      | 8/23 [00:00<00:01,  8.42it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.44it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.45it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.48it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.51it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.41it/s] 61%|██████    | 14/23 [00:01<00:01,  8.32it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.62it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.40it/s] 74%|███████▍  | 17/23 [00:02<00:00,  8.37it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.30it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.32it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.59it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.21s/it] 96%|█████████▌| 22/23 [00:06<00:00,  1.14it/s]100%|██████████| 23/23 [00:07<00:00,  1.01s/it]100%|██████████| 23/23 [00:07<00:00,  3.03it/s]
2025-03-13 16:54:29,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:29
2025-03-13 16:55:16,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7215 secs
2025-03-13 16:55:16,653 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:55:16,653 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 16:55:55,470 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8168 secs
2025-03-13 16:55:55,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.1379 secs
2025-03-13 16:55:55,471 [INFO]: {
2025-03-13 16:55:55,471 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:55,471 [INFO]: 	index_param: efSearch=197
2025-03-13 16:55:55,471 [INFO]: 	index_path: knn.index
2025-03-13 16:55:55,471 [INFO]: 	size in bytes: 1099996570
2025-03-13 16:55:55,471 [INFO]: 	avg_search_speed_ms: 8.326162206478957
2025-03-13 16:55:55,471 [INFO]: 	99p_search_speed_ms: 14.137292979285121
2025-03-13 16:55:55,471 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:55,471 [INFO]: 	nb vectors: 5591
2025-03-13 16:55:55,471 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:55,471 [INFO]: 	compression ratio: 0.9993079596602742
2025-03-13 16:55:55,471 [INFO]: }
2025-03-13 16:55:55,471 [INFO]: 	>>> Finished "Creating the index" in 93.1422 secs
2025-03-13 16:55:55,471 [INFO]: >>> Finished "Launching the whole pipeline" in 93.1747 secs
2025-03-13 16:55:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 15631 [episode count 9/20]
[retrieval_preprocessing] for episode 29463 [episode count 10/20], we have num_retrieval=np.int64(5640) num_query=np.int64(227)
2025-03-13 16:55:59,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:00,641 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:00
2025-03-13 16:56:00,641 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.05it/s]
2025-03-13 16:56:00,670 [INFO]: There are 5640 embeddings of dim 49152
2025-03-13 16:56:00,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:56:00,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:00
2025-03-13 16:56:00,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:00,671 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:56:00,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:00,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:56:00,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:00
2025-03-13 16:56:00,671 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:00,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:56:00,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:00
2025-03-13 16:56:00,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:00,672 [INFO]: 	Creating the index 03/13/2025, 16:56:00
2025-03-13 16:56:00,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:00
2025-03-13 16:56:00,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:56:00,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:00
2025-03-13 16:56:00,676 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:56:00,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.79it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.83it/s] 21%|██        | 5/24 [00:00<00:01, 11.66it/s] 29%|██▉       | 7/24 [00:00<00:01, 12.00it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.32it/s] 46%|████▌     | 11/24 [00:00<00:01, 12.33it/s] 54%|█████▍    | 13/24 [00:01<00:00, 13.24it/s] 62%|██████▎   | 15/24 [00:01<00:00, 14.03it/s] 71%|███████   | 17/24 [00:01<00:00, 14.75it/s] 79%|███████▉  | 19/24 [00:01<00:00, 15.10it/s] 88%|████████▊ | 21/24 [00:04<00:01,  1.83it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.46it/s]100%|██████████| 24/24 [00:06<00:00,  3.89it/s]
2025-03-13 16:56:06,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:06
2025-03-13 16:56:48,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3198 secs
2025-03-13 16:56:48,168 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 16:56:48,168 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 16:57:26,778 [INFO]: 	>>> Finished "Compute fast metrics" in 38.6100 secs
2025-03-13 16:57:26,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.1036 secs
2025-03-13 16:57:26,779 [INFO]: {
2025-03-13 16:57:26,779 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:26,779 [INFO]: 	index_param: efSearch=290
2025-03-13 16:57:26,779 [INFO]: 	index_path: knn.index
2025-03-13 16:57:26,779 [INFO]: 	size in bytes: 1109637010
2025-03-13 16:57:26,779 [INFO]: 	avg_search_speed_ms: 14.262207910787325
2025-03-13 16:57:26,779 [INFO]: 	99p_search_speed_ms: 24.461605721153322
2025-03-13 16:57:26,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:26,779 [INFO]: 	nb vectors: 5640
2025-03-13 16:57:26,779 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:26,779 [INFO]: 	compression ratio: 0.9993079809044941
2025-03-13 16:57:26,779 [INFO]: }
2025-03-13 16:57:26,779 [INFO]: 	>>> Finished "Creating the index" in 86.1074 secs
2025-03-13 16:57:26,779 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1382 secs
2025-03-13 16:57:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 29463 [episode count 10/20]
[retrieval_preprocessing] for episode 17222 [episode count 11/20], we have num_retrieval=np.int64(5579) num_query=np.int64(288)
2025-03-13 16:57:32,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:34,113 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:34
2025-03-13 16:57:34,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.27it/s]
2025-03-13 16:57:34,153 [INFO]: There are 5579 embeddings of dim 49152
2025-03-13 16:57:34,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 16:57:34,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:34
2025-03-13 16:57:34,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:34,154 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:57:34,154 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:34,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:57:34,154 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:34
2025-03-13 16:57:34,154 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:34,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:57:34,154 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:34
2025-03-13 16:57:34,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:34,155 [INFO]: 	Creating the index 03/13/2025, 16:57:34
2025-03-13 16:57:34,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:34
2025-03-13 16:57:34,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:57:34,157 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:34
2025-03-13 16:57:34,157 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:57:34,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.31it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.30it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.36it/s] 30%|███       | 7/23 [00:00<00:01,  9.82it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.90it/s] 48%|████▊     | 11/23 [00:01<00:01, 10.04it/s] 57%|█████▋    | 13/23 [00:01<00:00, 10.35it/s] 65%|██████▌   | 15/23 [00:01<00:00, 10.28it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.39it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.44it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.55it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.82it/s]100%|██████████| 23/23 [00:07<00:00,  1.34it/s]100%|██████████| 23/23 [00:07<00:00,  3.15it/s]
2025-03-13 16:57:41,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:41
2025-03-13 16:58:31,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6127 secs
2025-03-13 16:58:31,095 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 16:58:31,095 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 16:59:01,902 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8069 secs
2025-03-13 16:59:01,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.7456 secs
2025-03-13 16:59:01,903 [INFO]: {
2025-03-13 16:59:01,903 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:01,903 [INFO]: 	index_param: efSearch=194
2025-03-13 16:59:01,903 [INFO]: 	index_path: knn.index
2025-03-13 16:59:01,903 [INFO]: 	size in bytes: 1097635690
2025-03-13 16:59:01,903 [INFO]: 	avg_search_speed_ms: 7.957249958558614
2025-03-13 16:59:01,903 [INFO]: 	99p_search_speed_ms: 12.882464602589618
2025-03-13 16:59:01,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:01,903 [INFO]: 	nb vectors: 5579
2025-03-13 16:59:01,903 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:01,903 [INFO]: 	compression ratio: 0.9993079142679845
2025-03-13 16:59:01,903 [INFO]: }
2025-03-13 16:59:01,903 [INFO]: 	>>> Finished "Creating the index" in 87.7486 secs
2025-03-13 16:59:01,903 [INFO]: >>> Finished "Launching the whole pipeline" in 87.7906 secs
2025-03-13 16:59:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 17222 [episode count 11/20]
[retrieval_preprocessing] for episode 5920 [episode count 12/20], we have num_retrieval=np.int64(5553) num_query=np.int64(314)
2025-03-13 16:59:06,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:07,122 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:07
2025-03-13 16:59:07,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-13 16:59:07,148 [INFO]: There are 5553 embeddings of dim 49152
2025-03-13 16:59:07,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:59:07,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:07
2025-03-13 16:59:07,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:07,149 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:59:07,149 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:07,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:59:07,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:07
2025-03-13 16:59:07,149 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:07,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:59:07,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:07
2025-03-13 16:59:07,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:07,150 [INFO]: 	Creating the index 03/13/2025, 16:59:07
2025-03-13 16:59:07,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:07
2025-03-13 16:59:07,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:59:07,154 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:07
2025-03-13 16:59:07,154 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:59:07,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.93it/s]  9%|▊         | 2/23 [00:00<00:03,  6.30it/s] 13%|█▎        | 3/23 [00:00<00:03,  6.23it/s] 17%|█▋        | 4/23 [00:00<00:03,  5.54it/s] 22%|██▏       | 5/23 [00:00<00:02,  6.20it/s] 26%|██▌       | 6/23 [00:00<00:02,  6.82it/s] 30%|███       | 7/23 [00:01<00:02,  7.27it/s] 35%|███▍      | 8/23 [00:01<00:02,  7.46it/s] 39%|███▉      | 9/23 [00:01<00:01,  7.66it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.65it/s] 48%|████▊     | 11/23 [00:01<00:01,  7.69it/s] 52%|█████▏    | 12/23 [00:01<00:01,  7.72it/s] 57%|█████▋    | 13/23 [00:01<00:01,  7.72it/s] 61%|██████    | 14/23 [00:01<00:01,  7.82it/s] 70%|██████▉   | 16/23 [00:02<00:00,  8.92it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.73it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.15it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.16it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.45it/s]100%|██████████| 23/23 [00:07<00:00,  1.21it/s]100%|██████████| 23/23 [00:07<00:00,  3.00it/s]
2025-03-13 16:59:14,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:14
2025-03-13 16:59:59,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6231 secs
2025-03-13 16:59:59,462 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 16:59:59,462 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 17:00:31,116 [INFO]: 	>>> Finished "Compute fast metrics" in 31.6531 secs
2025-03-13 17:00:31,117 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9629 secs
2025-03-13 17:00:31,117 [INFO]: {
2025-03-13 17:00:31,117 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:31,117 [INFO]: 	index_param: efSearch=152
2025-03-13 17:00:31,117 [INFO]: 	index_path: knn.index
2025-03-13 17:00:31,117 [INFO]: 	size in bytes: 1092520210
2025-03-13 17:00:31,117 [INFO]: 	avg_search_speed_ms: 8.269920527266386
2025-03-13 17:00:31,117 [INFO]: 	99p_search_speed_ms: 11.331133348867304
2025-03-13 17:00:31,117 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:31,117 [INFO]: 	nb vectors: 5553
2025-03-13 17:00:31,117 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:31,117 [INFO]: 	compression ratio: 0.9993080347685285
2025-03-13 17:00:31,117 [INFO]: }
2025-03-13 17:00:31,117 [INFO]: 	>>> Finished "Creating the index" in 83.9666 secs
2025-03-13 17:00:31,117 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9946 secs
2025-03-13 17:00:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 5920 [episode count 12/20]
[retrieval_preprocessing] for episode 16695 [episode count 13/20], we have num_retrieval=np.int64(5570) num_query=np.int64(297)
2025-03-13 17:00:35,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:36,309 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:36
2025-03-13 17:00:36,309 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.20it/s]
2025-03-13 17:00:36,340 [INFO]: There are 5570 embeddings of dim 49152
2025-03-13 17:00:36,340 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:00:36,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:36,341 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 17:00:36,341 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:36,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:00:36,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,341 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:36,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:00:36,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:36
2025-03-13 17:00:36,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:36,342 [INFO]: 	Creating the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:36
2025-03-13 17:00:36,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 17:00:36,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,345 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:00:36,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:06,  3.48it/s]  9%|▊         | 2/23 [00:00<00:04,  5.16it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.69it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.32it/s] 35%|███▍      | 8/23 [00:00<00:01, 10.09it/s] 43%|████▎     | 10/23 [00:01<00:01, 10.39it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.79it/s] 61%|██████    | 14/23 [00:01<00:00, 10.97it/s] 70%|██████▉   | 16/23 [00:01<00:00, 11.09it/s] 78%|███████▊  | 18/23 [00:01<00:00, 11.21it/s] 87%|████████▋ | 20/23 [00:02<00:00, 11.07it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.41it/s]100%|██████████| 23/23 [00:07<00:00,  1.22it/s]100%|██████████| 23/23 [00:07<00:00,  3.05it/s]
2025-03-13 17:00:43,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:43
2025-03-13 17:01:37,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5256 secs
2025-03-13 17:01:37,414 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:01:37,415 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 17:02:21,481 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0666 secs
2025-03-13 17:02:21,482 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.1370 secs
2025-03-13 17:02:21,482 [INFO]: {
2025-03-13 17:02:21,482 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:21,482 [INFO]: 	index_param: efSearch=251
2025-03-13 17:02:21,482 [INFO]: 	index_path: knn.index
2025-03-13 17:02:21,482 [INFO]: 	size in bytes: 1095864910
2025-03-13 17:02:21,482 [INFO]: 	avg_search_speed_ms: 12.817171414200308
2025-03-13 17:02:21,482 [INFO]: 	99p_search_speed_ms: 24.98312490060934
2025-03-13 17:02:21,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:21,482 [INFO]: 	nb vectors: 5570
2025-03-13 17:02:21,482 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:21,482 [INFO]: 	compression ratio: 0.9993079895221757
2025-03-13 17:02:21,482 [INFO]: }
2025-03-13 17:02:21,482 [INFO]: 	>>> Finished "Creating the index" in 105.1403 secs
2025-03-13 17:02:21,482 [INFO]: >>> Finished "Launching the whole pipeline" in 105.1737 secs
2025-03-13 17:02:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 16695 [episode count 13/20]
[retrieval_preprocessing] for episode 18361 [episode count 14/20], we have num_retrieval=np.int64(5534) num_query=np.int64(333)
2025-03-13 17:02:28,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:29,819 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:29
2025-03-13 17:02:29,819 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.25it/s]
2025-03-13 17:02:29,863 [INFO]: There are 5534 embeddings of dim 49152
2025-03-13 17:02:29,863 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0439 secs
2025-03-13 17:02:29,863 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:29
2025-03-13 17:02:29,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:29,863 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 17:02:29,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:29,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:02:29,864 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:29
2025-03-13 17:02:29,864 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:29,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:02:29,864 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:29
2025-03-13 17:02:29,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:29,864 [INFO]: 	Creating the index 03/13/2025, 17:02:29
2025-03-13 17:02:29,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:29
2025-03-13 17:02:29,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:02:29,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:29
2025-03-13 17:02:29,866 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:02:29,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.61it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.76it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.03it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.55it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.70it/s] 30%|███       | 7/23 [00:00<00:02,  7.56it/s] 35%|███▍      | 8/23 [00:01<00:01,  7.86it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.00it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.99it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.20it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.48it/s] 61%|██████    | 14/23 [00:01<00:00,  9.14it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.49it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.58it/s] 83%|████████▎ | 19/23 [00:02<00:00,  9.82it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.85it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.10s/it] 96%|█████████▌| 22/23 [00:06<00:00,  1.17it/s]100%|██████████| 23/23 [00:08<00:00,  1.04s/it]100%|██████████| 23/23 [00:08<00:00,  2.76it/s]
2025-03-13 17:02:38,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:38
2025-03-13 17:03:25,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4146 secs
2025-03-13 17:03:25,634 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:03:25,634 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 17:04:00,843 [INFO]: 	>>> Finished "Compute fast metrics" in 35.2089 secs
2025-03-13 17:04:00,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9780 secs
2025-03-13 17:04:00,844 [INFO]: {
2025-03-13 17:04:00,844 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:00,844 [INFO]: 	index_param: efSearch=157
2025-03-13 17:04:00,844 [INFO]: 	index_path: knn.index
2025-03-13 17:04:00,844 [INFO]: 	size in bytes: 1088782150
2025-03-13 17:04:00,844 [INFO]: 	avg_search_speed_ms: 8.122032972969642
2025-03-13 17:04:00,844 [INFO]: 	99p_search_speed_ms: 12.6451221527532
2025-03-13 17:04:00,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:00,844 [INFO]: 	nb vectors: 5534
2025-03-13 17:04:00,844 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:00,844 [INFO]: 	compression ratio: 0.9993079625708412
2025-03-13 17:04:00,844 [INFO]: }
2025-03-13 17:04:00,844 [INFO]: 	>>> Finished "Creating the index" in 90.9802 secs
2025-03-13 17:04:00,844 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0254 secs
2025-03-13 17:04:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 18361 [episode count 14/20]
[retrieval_preprocessing] for episode 36576 [episode count 15/20], we have num_retrieval=np.int64(5667) num_query=np.int64(200)
2025-03-13 17:04:04,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:05,766 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:05
2025-03-13 17:04:05,766 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1282.27it/s]
2025-03-13 17:04:05,792 [INFO]: There are 5667 embeddings of dim 49152
2025-03-13 17:04:05,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:04:05,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:05,793 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 17:04:05,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:05,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:05,793 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,793 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:05,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:05,793 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:05
2025-03-13 17:04:05,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:05,793 [INFO]: 	Creating the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,793 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:05
2025-03-13 17:04:05,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:04:05,794 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,794 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:04:05,794 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.34it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.53it/s] 21%|██        | 5/24 [00:00<00:01, 10.10it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.85it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.03it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.17it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.16it/s] 62%|██████▎   | 15/24 [00:01<00:01,  8.89it/s] 67%|██████▋   | 16/24 [00:01<00:00,  8.23it/s] 71%|███████   | 17/24 [00:01<00:01,  6.97it/s] 75%|███████▌  | 18/24 [00:02<00:00,  6.07it/s] 79%|███████▉  | 19/24 [00:02<00:00,  6.33it/s] 83%|████████▎ | 20/24 [00:02<00:00,  6.56it/s] 88%|████████▊ | 21/24 [00:06<00:03,  1.24s/it] 92%|█████████▏| 22/24 [00:06<00:01,  1.08it/s]100%|██████████| 24/24 [00:08<00:00,  1.14it/s]100%|██████████| 24/24 [00:08<00:00,  2.87it/s]
2025-03-13 17:04:14,162 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:14
2025-03-13 17:05:02,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6717 secs
2025-03-13 17:05:02,835 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 17:05:02,835 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 17:05:53,665 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8296 secs
2025-03-13 17:05:53,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.8718 secs
2025-03-13 17:05:53,666 [INFO]: {
2025-03-13 17:05:53,666 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:53,666 [INFO]: 	index_param: efSearch=193
2025-03-13 17:05:53,666 [INFO]: 	index_path: knn.index
2025-03-13 17:05:53,666 [INFO]: 	size in bytes: 1114948990
2025-03-13 17:05:53,666 [INFO]: 	avg_search_speed_ms: 9.92783285328765
2025-03-13 17:05:53,666 [INFO]: 	99p_search_speed_ms: 19.591334816068407
2025-03-13 17:05:53,666 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:53,666 [INFO]: 	nb vectors: 5667
2025-03-13 17:05:53,666 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:53,666 [INFO]: 	compression ratio: 0.9993080813499817
2025-03-13 17:05:53,666 [INFO]: }
2025-03-13 17:05:53,667 [INFO]: 	>>> Finished "Creating the index" in 107.8735 secs
2025-03-13 17:05:53,667 [INFO]: >>> Finished "Launching the whole pipeline" in 107.9002 secs
2025-03-13 17:05:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 36576 [episode count 15/20]
[retrieval_preprocessing] for episode 68944 [episode count 16/20], we have num_retrieval=np.int64(5553) num_query=np.int64(314)
2025-03-13 17:05:58,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:58,954 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:58
2025-03-13 17:05:58,954 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.88it/s]
2025-03-13 17:05:58,986 [INFO]: There are 5553 embeddings of dim 49152
2025-03-13 17:05:58,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 17:05:58,987 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:58,987 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 17:05:58,987 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:58,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:58,987 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,987 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:58,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:58,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:58
2025-03-13 17:05:58,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:58,987 [INFO]: 	Creating the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:58
2025-03-13 17:05:58,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:05:58,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,989 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:05:58,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.72it/s] 26%|██▌       | 6/23 [00:00<00:00, 26.43it/s] 39%|███▉      | 9/23 [00:00<00:00, 22.06it/s] 52%|█████▏    | 12/23 [00:00<00:00, 13.77it/s] 61%|██████    | 14/23 [00:00<00:00, 12.58it/s] 70%|██████▉   | 16/23 [00:01<00:00, 11.88it/s] 78%|███████▊  | 18/23 [00:01<00:00, 11.58it/s] 87%|████████▋ | 20/23 [00:01<00:00, 11.22it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.58it/s]100%|██████████| 23/23 [00:06<00:00,  1.32it/s]100%|██████████| 23/23 [00:06<00:00,  3.38it/s]
2025-03-13 17:06:05,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:05
2025-03-13 17:07:10,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.2993 secs
2025-03-13 17:07:10,109 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 17:07:10,110 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 17:07:37,540 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4297 secs
2025-03-13 17:07:38,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.3587 secs
2025-03-13 17:07:38,348 [INFO]: {
2025-03-13 17:07:38,348 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:38,348 [INFO]: 	index_param: efSearch=99
2025-03-13 17:07:38,348 [INFO]: 	index_path: knn.index
2025-03-13 17:07:38,348 [INFO]: 	size in bytes: 1092520210
2025-03-13 17:07:38,348 [INFO]: 	avg_search_speed_ms: 5.1546825564074
2025-03-13 17:07:38,348 [INFO]: 	99p_search_speed_ms: 7.910829479806124
2025-03-13 17:07:38,349 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:38,349 [INFO]: 	nb vectors: 5553
2025-03-13 17:07:38,349 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:38,349 [INFO]: 	compression ratio: 0.9993080347685285
2025-03-13 17:07:38,349 [INFO]: }
2025-03-13 17:07:38,349 [INFO]: 	>>> Finished "Creating the index" in 99.3614 secs
2025-03-13 17:07:38,349 [INFO]: >>> Finished "Launching the whole pipeline" in 99.3946 secs
2025-03-13 17:07:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 68944 [episode count 16/20]
[retrieval_preprocessing] for episode 71531 [episode count 17/20], we have num_retrieval=np.int64(5547) num_query=np.int64(320)
2025-03-13 17:07:40,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:41,149 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:41
2025-03-13 17:07:41,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1309.49it/s]
2025-03-13 17:07:41,183 [INFO]: There are 5547 embeddings of dim 49152
2025-03-13 17:07:41,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 17:07:41,183 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:41
2025-03-13 17:07:41,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:41,183 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 17:07:41,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:41,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:07:41,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:41
2025-03-13 17:07:41,183 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:41,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:07:41,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:41
2025-03-13 17:07:41,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:41,183 [INFO]: 	Creating the index 03/13/2025, 17:07:41
2025-03-13 17:07:41,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:41
2025-03-13 17:07:41,185 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:07:41,185 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:41
2025-03-13 17:07:41,185 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:07:41,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.98it/s] 30%|███       | 7/23 [00:00<00:00, 35.96it/s] 48%|████▊     | 11/23 [00:00<00:00, 36.55it/s] 74%|███████▍  | 17/23 [00:00<00:00, 42.36it/s] 96%|█████████▌| 22/23 [00:03<00:00,  3.85it/s]100%|██████████| 23/23 [00:04<00:00,  4.88it/s]
2025-03-13 17:07:45,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:45
2025-03-13 17:08:38,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1813 secs
2025-03-13 17:08:38,084 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:08:38,084 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-13 17:08:59,104 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0197 secs
2025-03-13 17:08:59,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9201 secs
2025-03-13 17:08:59,105 [INFO]: {
2025-03-13 17:08:59,105 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:59,105 [INFO]: 	index_param: efSearch=173
2025-03-13 17:08:59,105 [INFO]: 	index_path: knn.index
2025-03-13 17:08:59,105 [INFO]: 	size in bytes: 1091339770
2025-03-13 17:08:59,105 [INFO]: 	avg_search_speed_ms: 11.012731248713898
2025-03-13 17:08:59,105 [INFO]: 	99p_search_speed_ms: 15.951342717744396
2025-03-13 17:08:59,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:59,105 [INFO]: 	nb vectors: 5547
2025-03-13 17:08:59,105 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:59,105 [INFO]: 	compression ratio: 0.9993080120226903
2025-03-13 17:08:59,105 [INFO]: }
2025-03-13 17:08:59,105 [INFO]: 	>>> Finished "Creating the index" in 77.9219 secs
2025-03-13 17:08:59,105 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9560 secs
2025-03-13 17:09:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 71531 [episode count 17/20]
[retrieval_preprocessing] for episode 32558 [episode count 18/20], we have num_retrieval=np.int64(5521) num_query=np.int64(346)
2025-03-13 17:09:01,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:02,844 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:02
2025-03-13 17:09:02,844 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1414.13it/s]
2025-03-13 17:09:02,871 [INFO]: There are 5521 embeddings of dim 49152
2025-03-13 17:09:02,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:09:02,872 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:02
2025-03-13 17:09:02,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:02,872 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 17:09:02,872 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:02,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:02,872 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:02
2025-03-13 17:09:02,872 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:02,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:09:02,872 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:02
2025-03-13 17:09:02,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:02,872 [INFO]: 	Creating the index 03/13/2025, 17:09:02
2025-03-13 17:09:02,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:02
2025-03-13 17:09:02,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:09:02,873 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:02
2025-03-13 17:09:02,873 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:09:02,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.72it/s] 22%|██▏       | 5/23 [00:00<00:00, 24.58it/s] 43%|████▎     | 10/23 [00:00<00:00, 34.41it/s] 65%|██████▌   | 15/23 [00:00<00:00, 39.30it/s] 87%|████████▋ | 20/23 [00:00<00:00, 42.59it/s]100%|██████████| 23/23 [00:05<00:00,  4.14it/s]
2025-03-13 17:09:08,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:08
2025-03-13 17:09:53,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9558 secs
2025-03-13 17:09:53,395 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:09:53,395 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.21it/s]
2025-03-13 17:10:42,195 [INFO]: 	>>> Finished "Compute fast metrics" in 48.7993 secs
2025-03-13 17:10:42,195 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.3223 secs
2025-03-13 17:10:42,195 [INFO]: {
2025-03-13 17:10:42,195 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:42,196 [INFO]: 	index_param: efSearch=207
2025-03-13 17:10:42,196 [INFO]: 	index_path: knn.index
2025-03-13 17:10:42,196 [INFO]: 	size in bytes: 1086224410
2025-03-13 17:10:42,196 [INFO]: 	avg_search_speed_ms: 8.232446446432252
2025-03-13 17:10:42,196 [INFO]: 	99p_search_speed_ms: 12.00904751662164
2025-03-13 17:10:42,196 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:42,196 [INFO]: 	nb vectors: 5521
2025-03-13 17:10:42,196 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:42,196 [INFO]: 	compression ratio: 0.9993080232840652
2025-03-13 17:10:42,196 [INFO]: }
2025-03-13 17:10:42,196 [INFO]: 	>>> Finished "Creating the index" in 99.3236 secs
2025-03-13 17:10:42,196 [INFO]: >>> Finished "Launching the whole pipeline" in 99.3520 secs
2025-03-13 17:10:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 32558 [episode count 18/20]
[retrieval_preprocessing] for episode 14717 [episode count 19/20], we have num_retrieval=np.int64(5610) num_query=np.int64(257)
2025-03-13 17:10:44,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:45,500 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:45
2025-03-13 17:10:45,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.28it/s]
2025-03-13 17:10:45,527 [INFO]: There are 5610 embeddings of dim 49152
2025-03-13 17:10:45,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:10:45,527 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:45
2025-03-13 17:10:45,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:45,527 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 17:10:45,527 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:45,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:10:45,528 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:45
2025-03-13 17:10:45,528 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:45,528 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:10:45,528 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:45
2025-03-13 17:10:45,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:45,528 [INFO]: 	Creating the index 03/13/2025, 17:10:45
2025-03-13 17:10:45,528 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:45
2025-03-13 17:10:45,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:10:45,529 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:45
2025-03-13 17:10:45,529 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:10:45,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.07it/s] 29%|██▉       | 7/24 [00:00<00:00, 33.93it/s] 54%|█████▍    | 13/24 [00:00<00:00, 43.26it/s] 79%|███████▉  | 19/24 [00:00<00:00, 47.88it/s]100%|██████████| 24/24 [00:04<00:00,  3.23it/s]100%|██████████| 24/24 [00:04<00:00,  5.08it/s]
2025-03-13 17:10:50,260 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:50
2025-03-13 17:11:37,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7104 secs
2025-03-13 17:11:37,971 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 17:11:37,971 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.62it/s] 50%|█████     | 2/4 [00:00<00:00,  5.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.24it/s]
2025-03-13 17:12:16,796 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8249 secs
2025-03-13 17:12:16,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2688 secs
2025-03-13 17:12:16,798 [INFO]: {
2025-03-13 17:12:16,798 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:16,798 [INFO]: 	index_param: efSearch=114
2025-03-13 17:12:16,798 [INFO]: 	index_path: knn.index
2025-03-13 17:12:16,798 [INFO]: 	size in bytes: 1103734690
2025-03-13 17:12:16,798 [INFO]: 	avg_search_speed_ms: 9.24928672633232
2025-03-13 17:12:16,798 [INFO]: 	99p_search_speed_ms: 18.69120226008818
2025-03-13 17:12:16,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:16,799 [INFO]: 	nb vectors: 5610
2025-03-13 17:12:16,799 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:16,799 [INFO]: 	compression ratio: 0.9993079768109853
2025-03-13 17:12:16,799 [INFO]: }
2025-03-13 17:12:16,799 [INFO]: 	>>> Finished "Creating the index" in 91.2706 secs
2025-03-13 17:12:16,799 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2988 secs
2025-03-13 17:12:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 14717 [episode count 19/20]
2025-03-13 17:12:19: [retrieval_preprocessing] finished for 3951366978_put_lid_on_teapot [chosen_id count 5/196]
2025-03-13 17:12:22: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_silver_object_in_light_blue_cup [chosen_id count 6/196]
2025-03-13 17:12:22: [retrieval_preprocessing] we have num_total=2622 embedding_dim=49152
[retrieval_preprocessing] for episode 29720 [episode count 0/20], we have num_retrieval=np.int64(2473) num_query=np.int64(149)
2025-03-13 17:12:23,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:24,758 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:24
2025-03-13 17:12:24,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.16it/s]
2025-03-13 17:12:24,787 [INFO]: There are 2473 embeddings of dim 49152
2025-03-13 17:12:24,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:12:24,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,787 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:24,787 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:12:24,787 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:24,787 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:24,787 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,788 [INFO]: 510.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:24,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:24,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:24
2025-03-13 17:12:24,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:24,788 [INFO]: 	Creating the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:24
2025-03-13 17:12:24,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:12:24,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,789 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:12:24,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.51it/s] 20%|██        | 2/10 [00:00<00:01,  7.46it/s] 30%|███       | 3/10 [00:00<00:00,  8.34it/s] 40%|████      | 4/10 [00:00<00:00,  8.69it/s] 50%|█████     | 5/10 [00:00<00:00,  8.73it/s] 60%|██████    | 6/10 [00:00<00:00,  8.73it/s] 70%|███████   | 7/10 [00:00<00:00,  9.02it/s] 80%|████████  | 8/10 [00:00<00:00,  9.15it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.20it/s]100%|██████████| 10/10 [00:03<00:00,  1.16it/s]100%|██████████| 10/10 [00:03<00:00,  2.78it/s]
2025-03-13 17:12:28,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:28
2025-03-13 17:13:05,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5289 secs
2025-03-13 17:13:05,926 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 17:13:05,926 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.05it/s]
2025-03-13 17:13:32,026 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0993 secs
2025-03-13 17:13:32,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2390 secs
2025-03-13 17:13:32,028 [INFO]: {
2025-03-13 17:13:32,028 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:32,028 [INFO]: 	index_param: efSearch=139
2025-03-13 17:13:32,028 [INFO]: 	index_path: knn.index
2025-03-13 17:13:32,028 [INFO]: 	size in bytes: 486547270
2025-03-13 17:13:32,028 [INFO]: 	avg_search_speed_ms: 8.549732722340421
2025-03-13 17:13:32,028 [INFO]: 	99p_search_speed_ms: 16.425236184149938
2025-03-13 17:13:32,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:32,028 [INFO]: 	nb vectors: 2473
2025-03-13 17:13:32,028 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:32,028 [INFO]: 	compression ratio: 0.9993100649809421
2025-03-13 17:13:32,028 [INFO]: }
2025-03-13 17:13:32,028 [INFO]: 	>>> Finished "Creating the index" in 67.2405 secs
2025-03-13 17:13:32,028 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2697 secs
2025-03-13 17:13:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 29720 [episode count 0/20]
[retrieval_preprocessing] for episode 36375 [episode count 1/20], we have num_retrieval=np.int64(2496) num_query=np.int64(126)
2025-03-13 17:13:34,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:34,623 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:34
2025-03-13 17:13:34,623 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 17:13:34,654 [INFO]: There are 2496 embeddings of dim 49152
2025-03-13 17:13:34,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:13:34,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:34
2025-03-13 17:13:34,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:34,654 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:13:34,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:34,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:13:34,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:34
2025-03-13 17:13:34,654 [INFO]: 515.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:34,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:13:34,655 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:34
2025-03-13 17:13:34,655 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:34,655 [INFO]: 	Creating the index 03/13/2025, 17:13:34
2025-03-13 17:13:34,655 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:34
2025-03-13 17:13:34,656 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:13:34,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:34
2025-03-13 17:13:34,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:13:34,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.56it/s] 30%|███       | 3/10 [00:00<00:00, 10.17it/s] 50%|█████     | 5/10 [00:00<00:00, 10.65it/s] 70%|███████   | 7/10 [00:00<00:00, 11.16it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.34it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]
2025-03-13 17:13:37,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:37
2025-03-13 17:14:11,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1743 secs
2025-03-13 17:14:11,644 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:14:11,644 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
2025-03-13 17:14:29,692 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0481 secs
2025-03-13 17:14:29,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0386 secs
2025-03-13 17:14:29,695 [INFO]: {
2025-03-13 17:14:29,695 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:29,695 [INFO]: 	index_param: efSearch=234
2025-03-13 17:14:29,695 [INFO]: 	index_path: knn.index
2025-03-13 17:14:29,695 [INFO]: 	size in bytes: 491072350
2025-03-13 17:14:29,695 [INFO]: 	avg_search_speed_ms: 10.939564757381262
2025-03-13 17:14:29,695 [INFO]: 	99p_search_speed_ms: 16.29178292118013
2025-03-13 17:14:29,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:29,695 [INFO]: 	nb vectors: 2496
2025-03-13 17:14:29,695 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:29,695 [INFO]: 	compression ratio: 0.999310117949015
2025-03-13 17:14:29,695 [INFO]: }
2025-03-13 17:14:29,695 [INFO]: 	>>> Finished "Creating the index" in 55.0406 secs
2025-03-13 17:14:29,695 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0721 secs
2025-03-13 17:14:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 36375 [episode count 1/20]
[retrieval_preprocessing] for episode 40003 [episode count 2/20], we have num_retrieval=np.int64(2502) num_query=np.int64(120)
2025-03-13 17:14:33,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:33,684 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:33
2025-03-13 17:14:33,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1644.83it/s]
2025-03-13 17:14:33,713 [INFO]: There are 2502 embeddings of dim 49152
2025-03-13 17:14:33,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:14:33,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:33
2025-03-13 17:14:33,714 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:33,714 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:14:33,714 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:33,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:33,714 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:33
2025-03-13 17:14:33,714 [INFO]: 516.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:33,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:33,714 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:33
2025-03-13 17:14:33,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:33,714 [INFO]: 	Creating the index 03/13/2025, 17:14:33
2025-03-13 17:14:33,714 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:33
2025-03-13 17:14:33,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:14:33,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:33
2025-03-13 17:14:33,716 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:14:33,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.05it/s] 20%|██        | 2/10 [00:00<00:01,  6.59it/s] 30%|███       | 3/10 [00:00<00:00,  7.57it/s] 40%|████      | 4/10 [00:00<00:00,  8.29it/s] 50%|█████     | 5/10 [00:00<00:00,  8.79it/s] 70%|███████   | 7/10 [00:00<00:00,  9.43it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.19it/s]100%|██████████| 10/10 [00:02<00:00,  3.42it/s]
2025-03-13 17:14:36,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:36
2025-03-13 17:15:08,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5925 secs
2025-03-13 17:15:08,241 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 17:15:08,241 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.79it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 17:15:41,445 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2032 secs
2025-03-13 17:15:41,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7312 secs
2025-03-13 17:15:41,447 [INFO]: {
2025-03-13 17:15:41,447 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:41,447 [INFO]: 	index_param: efSearch=280
2025-03-13 17:15:41,447 [INFO]: 	index_path: knn.index
2025-03-13 17:15:41,447 [INFO]: 	size in bytes: 492252850
2025-03-13 17:15:41,447 [INFO]: 	avg_search_speed_ms: 12.360104402568656
2025-03-13 17:15:41,447 [INFO]: 	99p_search_speed_ms: 21.943919621407968
2025-03-13 17:15:41,447 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:41,447 [INFO]: 	nb vectors: 2502
2025-03-13 17:15:41,447 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:41,447 [INFO]: 	compression ratio: 0.9993100415772097
2025-03-13 17:15:41,447 [INFO]: }
2025-03-13 17:15:41,447 [INFO]: 	>>> Finished "Creating the index" in 67.7331 secs
2025-03-13 17:15:41,447 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7634 secs
2025-03-13 17:15:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 40003 [episode count 2/20]
[retrieval_preprocessing] for episode 91714 [episode count 3/20], we have num_retrieval=np.int64(2521) num_query=np.int64(101)
2025-03-13 17:15:44,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:45,165 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:45
2025-03-13 17:15:45,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-13 17:15:45,190 [INFO]: There are 2521 embeddings of dim 49152
2025-03-13 17:15:45,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:15:45,191 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:45,191 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:15:45,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:45,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:45,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,191 [INFO]: 520.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:45,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:15:45,191 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:45
2025-03-13 17:15:45,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:45,191 [INFO]: 	Creating the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,191 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:45
2025-03-13 17:15:45,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:15:45,193 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,193 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:15:45,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.18it/s] 30%|███       | 3/10 [00:00<00:00, 10.80it/s] 50%|█████     | 5/10 [00:00<00:00, 11.64it/s] 70%|███████   | 7/10 [00:00<00:00, 12.79it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.14it/s]100%|██████████| 10/10 [00:02<00:00,  3.64it/s]
2025-03-13 17:15:47,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:47
2025-03-13 17:16:22,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7021 secs
2025-03-13 17:16:22,655 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 17:16:22,655 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 17:16:46,119 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4638 secs
2025-03-13 17:16:46,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9289 secs
2025-03-13 17:16:46,122 [INFO]: {
2025-03-13 17:16:46,122 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:46,122 [INFO]: 	index_param: efSearch=238
2025-03-13 17:16:46,122 [INFO]: 	index_path: knn.index
2025-03-13 17:16:46,122 [INFO]: 	size in bytes: 495991090
2025-03-13 17:16:46,122 [INFO]: 	avg_search_speed_ms: 11.585625005359324
2025-03-13 17:16:46,122 [INFO]: 	99p_search_speed_ms: 17.99130138475448
2025-03-13 17:16:46,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:46,122 [INFO]: 	nb vectors: 2521
2025-03-13 17:16:46,122 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:46,122 [INFO]: 	compression ratio: 0.9993098222792671
2025-03-13 17:16:46,122 [INFO]: }
2025-03-13 17:16:46,122 [INFO]: 	>>> Finished "Creating the index" in 60.9307 secs
2025-03-13 17:16:46,122 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9570 secs
2025-03-13 17:16:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 91714 [episode count 3/20]
[retrieval_preprocessing] for episode 45646 [episode count 4/20], we have num_retrieval=np.int64(2489) num_query=np.int64(133)
2025-03-13 17:16:49,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:50,481 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:50
2025-03-13 17:16:50,482 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-13 17:16:50,507 [INFO]: There are 2489 embeddings of dim 49152
2025-03-13 17:16:50,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:16:50,507 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:50
2025-03-13 17:16:50,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:50,507 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:16:50,507 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:50,507 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:50,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:50
2025-03-13 17:16:50,508 [INFO]: 513.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:50,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:16:50,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:50
2025-03-13 17:16:50,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:50,508 [INFO]: 	Creating the index 03/13/2025, 17:16:50
2025-03-13 17:16:50,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:50
2025-03-13 17:16:50,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:16:50,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:50
2025-03-13 17:16:50,509 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:16:50,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.45it/s] 20%|██        | 2/10 [00:00<00:01,  6.86it/s] 30%|███       | 3/10 [00:00<00:00,  7.44it/s] 40%|████      | 4/10 [00:00<00:00,  7.96it/s] 50%|█████     | 5/10 [00:00<00:00,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00,  8.76it/s] 70%|███████   | 7/10 [00:00<00:00,  9.00it/s] 80%|████████  | 8/10 [00:00<00:00,  9.29it/s]100%|██████████| 10/10 [00:02<00:00,  1.87it/s]100%|██████████| 10/10 [00:02<00:00,  3.37it/s]
2025-03-13 17:16:53,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:53
2025-03-13 17:17:27,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7437 secs
2025-03-13 17:17:27,300 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 17:17:27,300 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 17:17:54,979 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6792 secs
2025-03-13 17:17:54,982 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4723 secs
2025-03-13 17:17:54,982 [INFO]: {
2025-03-13 17:17:54,982 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:54,982 [INFO]: 	index_param: efSearch=231
2025-03-13 17:17:54,982 [INFO]: 	index_path: knn.index
2025-03-13 17:17:54,982 [INFO]: 	size in bytes: 489695170
2025-03-13 17:17:54,982 [INFO]: 	avg_search_speed_ms: 11.37435768542343
2025-03-13 17:17:54,982 [INFO]: 	99p_search_speed_ms: 22.5225611915812
2025-03-13 17:17:54,982 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:54,982 [INFO]: 	nb vectors: 2489
2025-03-13 17:17:54,982 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:54,982 [INFO]: 	compression ratio: 0.9993100646673726
2025-03-13 17:17:54,982 [INFO]: }
2025-03-13 17:17:54,982 [INFO]: 	>>> Finished "Creating the index" in 64.4741 secs
2025-03-13 17:17:54,982 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5004 secs
2025-03-13 17:17:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 45646 [episode count 4/20]
[retrieval_preprocessing] for episode 92758 [episode count 5/20], we have num_retrieval=np.int64(2471) num_query=np.int64(151)
2025-03-13 17:17:57,656 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:58,096 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:58
2025-03-13 17:17:58,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-13 17:17:58,122 [INFO]: There are 2471 embeddings of dim 49152
2025-03-13 17:17:58,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:17:58,122 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:58,122 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:17:58,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:58,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:58,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,122 [INFO]: 510.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:58,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:17:58,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:58
2025-03-13 17:17:58,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:58,123 [INFO]: 	Creating the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:58
2025-03-13 17:17:58,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:17:58,124 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,124 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:17:58,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.73it/s] 20%|██        | 2/10 [00:00<00:01,  6.39it/s] 40%|████      | 4/10 [00:00<00:00,  8.53it/s] 60%|██████    | 6/10 [00:00<00:00,  9.42it/s] 80%|████████  | 8/10 [00:00<00:00,  9.69it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.87it/s]100%|██████████| 10/10 [00:03<00:00,  1.37it/s]100%|██████████| 10/10 [00:03<00:00,  2.67it/s]
2025-03-13 17:18:01,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:01
2025-03-13 17:18:35,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0438 secs
2025-03-13 17:18:35,915 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:18:35,915 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 17:19:00,268 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3532 secs
2025-03-13 17:19:00,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1470 secs
2025-03-13 17:19:00,271 [INFO]: {
2025-03-13 17:19:00,271 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:00,271 [INFO]: 	index_param: efSearch=218
2025-03-13 17:19:00,271 [INFO]: 	index_path: knn.index
2025-03-13 17:19:00,271 [INFO]: 	size in bytes: 486153790
2025-03-13 17:19:00,271 [INFO]: 	avg_search_speed_ms: 9.832438209250702
2025-03-13 17:19:00,271 [INFO]: 	99p_search_speed_ms: 13.351761773228645
2025-03-13 17:19:00,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:00,271 [INFO]: 	nb vectors: 2471
2025-03-13 17:19:00,271 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:00,271 [INFO]: 	compression ratio: 0.9993100496038506
2025-03-13 17:19:00,271 [INFO]: }
2025-03-13 17:19:00,271 [INFO]: 	>>> Finished "Creating the index" in 62.1485 secs
2025-03-13 17:19:00,271 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1748 secs
2025-03-13 17:19:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 92758 [episode count 5/20]
[retrieval_preprocessing] for episode 87284 [episode count 6/20], we have num_retrieval=np.int64(2521) num_query=np.int64(101)
2025-03-13 17:19:02,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:02,699 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:02
2025-03-13 17:19:02,699 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1716.87it/s]
2025-03-13 17:19:02,726 [INFO]: There are 2521 embeddings of dim 49152
2025-03-13 17:19:02,726 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:19:02,726 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,726 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:02,726 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:19:02,726 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:02,726 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:02,726 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,726 [INFO]: 520.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:02,726 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:02,726 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:02
2025-03-13 17:19:02,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:02,727 [INFO]: 	Creating the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:02
2025-03-13 17:19:02,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:19:02,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,728 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:19:02,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.43it/s] 30%|███       | 3/10 [00:00<00:00, 11.49it/s] 50%|█████     | 5/10 [00:00<00:00, 13.57it/s] 70%|███████   | 7/10 [00:00<00:00, 14.53it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.33it/s]100%|██████████| 10/10 [00:02<00:00,  3.64it/s]
2025-03-13 17:19:05,487 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:05
2025-03-13 17:19:39,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4218 secs
2025-03-13 17:19:39,909 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 17:19:39,909 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 17:20:06,180 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2708 secs
2025-03-13 17:20:06,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4548 secs
2025-03-13 17:20:06,183 [INFO]: {
2025-03-13 17:20:06,183 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:06,183 [INFO]: 	index_param: efSearch=268
2025-03-13 17:20:06,183 [INFO]: 	index_path: knn.index
2025-03-13 17:20:06,183 [INFO]: 	size in bytes: 495991090
2025-03-13 17:20:06,183 [INFO]: 	avg_search_speed_ms: 12.000350770708039
2025-03-13 17:20:06,183 [INFO]: 	99p_search_speed_ms: 19.433245458640148
2025-03-13 17:20:06,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:06,183 [INFO]: 	nb vectors: 2521
2025-03-13 17:20:06,183 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:06,183 [INFO]: 	compression ratio: 0.9993098222792671
2025-03-13 17:20:06,183 [INFO]: }
2025-03-13 17:20:06,183 [INFO]: 	>>> Finished "Creating the index" in 63.4563 secs
2025-03-13 17:20:06,183 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4834 secs
2025-03-13 17:20:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 87284 [episode count 6/20]
[retrieval_preprocessing] for episode 28950 [episode count 7/20], we have num_retrieval=np.int64(2502) num_query=np.int64(120)
2025-03-13 17:20:08,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:09,390 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:09
2025-03-13 17:20:09,391 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.87it/s]
2025-03-13 17:20:09,421 [INFO]: There are 2502 embeddings of dim 49152
2025-03-13 17:20:09,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:20:09,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:09
2025-03-13 17:20:09,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:09,422 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:20:09,423 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:09,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:20:09,423 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:09
2025-03-13 17:20:09,423 [INFO]: 516.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:09,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:20:09,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:09
2025-03-13 17:20:09,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:09,424 [INFO]: 	Creating the index 03/13/2025, 17:20:09
2025-03-13 17:20:09,424 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:09
2025-03-13 17:20:09,427 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:20:09,427 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:09
2025-03-13 17:20:09,427 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:20:09,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.74it/s] 20%|██        | 2/10 [00:00<00:01,  5.90it/s] 30%|███       | 3/10 [00:00<00:01,  6.48it/s] 40%|████      | 4/10 [00:00<00:00,  7.01it/s] 50%|█████     | 5/10 [00:00<00:00,  7.41it/s] 60%|██████    | 6/10 [00:00<00:00,  7.60it/s] 70%|███████   | 7/10 [00:00<00:00,  7.74it/s] 80%|████████  | 8/10 [00:01<00:00,  7.84it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.60it/s]100%|██████████| 10/10 [00:03<00:00,  1.34it/s]100%|██████████| 10/10 [00:03<00:00,  2.97it/s]
2025-03-13 17:20:12,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:12
2025-03-13 17:20:42,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5620 secs
2025-03-13 17:20:42,361 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:20:42,361 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  5.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 17:21:00,389 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0279 secs
2025-03-13 17:21:00,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9641 secs
2025-03-13 17:21:00,391 [INFO]: {
2025-03-13 17:21:00,391 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:00,391 [INFO]: 	index_param: efSearch=210
2025-03-13 17:21:00,391 [INFO]: 	index_path: knn.index
2025-03-13 17:21:00,391 [INFO]: 	size in bytes: 492252850
2025-03-13 17:21:00,391 [INFO]: 	avg_search_speed_ms: 10.898617077476805
2025-03-13 17:21:00,391 [INFO]: 	99p_search_speed_ms: 18.30649078125136
2025-03-13 17:21:00,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:00,391 [INFO]: 	nb vectors: 2502
2025-03-13 17:21:00,391 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:00,391 [INFO]: 	compression ratio: 0.9993100415772097
2025-03-13 17:21:00,391 [INFO]: }
2025-03-13 17:21:00,391 [INFO]: 	>>> Finished "Creating the index" in 50.9673 secs
2025-03-13 17:21:00,391 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0009 secs
2025-03-13 17:21:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 28950 [episode count 7/20]
[retrieval_preprocessing] for episode 73588 [episode count 8/20], we have num_retrieval=np.int64(2481) num_query=np.int64(141)
2025-03-13 17:21:02,263 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:02,676 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:02
2025-03-13 17:21:02,676 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.55it/s]
2025-03-13 17:21:02,701 [INFO]: There are 2481 embeddings of dim 49152
2025-03-13 17:21:02,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:21:02,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:02,701 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:21:02,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:02,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:21:02,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,702 [INFO]: 512.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:02,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:21:02,702 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:02
2025-03-13 17:21:02,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:02,702 [INFO]: 	Creating the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,702 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:02
2025-03-13 17:21:02,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:21:02,703 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,703 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:21:02,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.36it/s] 30%|███       | 3/10 [00:00<00:00,  8.60it/s] 50%|█████     | 5/10 [00:00<00:00,  9.42it/s] 60%|██████    | 6/10 [00:00<00:00,  9.29it/s] 70%|███████   | 7/10 [00:00<00:00,  9.41it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.86it/s]100%|██████████| 10/10 [00:03<00:00,  1.65it/s]100%|██████████| 10/10 [00:03<00:00,  3.15it/s]
2025-03-13 17:21:05,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:05
2025-03-13 17:21:34,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1220 secs
2025-03-13 17:21:34,008 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:21:34,008 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 17:21:58,293 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2846 secs
2025-03-13 17:21:58,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5922 secs
2025-03-13 17:21:58,295 [INFO]: {
2025-03-13 17:21:58,295 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:58,295 [INFO]: 	index_param: efSearch=227
2025-03-13 17:21:58,295 [INFO]: 	index_path: knn.index
2025-03-13 17:21:58,295 [INFO]: 	size in bytes: 488121190
2025-03-13 17:21:58,295 [INFO]: 	avg_search_speed_ms: 11.456591703631368
2025-03-13 17:21:58,296 [INFO]: 	99p_search_speed_ms: 20.59208901599048
2025-03-13 17:21:58,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:58,296 [INFO]: 	nb vectors: 2481
2025-03-13 17:21:58,296 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:58,296 [INFO]: 	compression ratio: 0.9993101262413951
2025-03-13 17:21:58,296 [INFO]: }
2025-03-13 17:21:58,296 [INFO]: 	>>> Finished "Creating the index" in 55.5939 secs
2025-03-13 17:21:58,296 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6199 secs
2025-03-13 17:21:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 73588 [episode count 8/20]
[retrieval_preprocessing] for episode 38777 [episode count 9/20], we have num_retrieval=np.int64(2450) num_query=np.int64(172)
2025-03-13 17:22:00,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:00,751 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:00
2025-03-13 17:22:00,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.83it/s]
2025-03-13 17:22:00,779 [INFO]: There are 2450 embeddings of dim 49152
2025-03-13 17:22:00,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:22:00,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:00,779 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:22:00,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:00,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:00,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,779 [INFO]: 505.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:00,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:00,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:00
2025-03-13 17:22:00,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:00,779 [INFO]: 	Creating the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:00
2025-03-13 17:22:00,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:22:00,781 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,781 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:22:00,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.70it/s] 30%|███       | 3/10 [00:00<00:00,  9.93it/s] 50%|█████     | 5/10 [00:00<00:00, 10.83it/s] 70%|███████   | 7/10 [00:00<00:00, 10.93it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.91it/s]100%|██████████| 10/10 [00:02<00:00,  3.99it/s]
2025-03-13 17:22:03,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:03
2025-03-13 17:22:36,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7060 secs
2025-03-13 17:22:37,000 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 17:22:37,000 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 17:22:56,291 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2909 secs
2025-03-13 17:22:56,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5130 secs
2025-03-13 17:22:56,294 [INFO]: {
2025-03-13 17:22:56,294 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:56,294 [INFO]: 	index_param: efSearch=233
2025-03-13 17:22:56,294 [INFO]: 	index_path: knn.index
2025-03-13 17:22:56,294 [INFO]: 	size in bytes: 482022190
2025-03-13 17:22:56,294 [INFO]: 	avg_search_speed_ms: 11.944221498738427
2025-03-13 17:22:56,294 [INFO]: 	99p_search_speed_ms: 18.679853864014145
2025-03-13 17:22:56,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:56,294 [INFO]: 	nb vectors: 2450
2025-03-13 17:22:56,294 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:56,294 [INFO]: 	compression ratio: 0.9993100110183724
2025-03-13 17:22:56,294 [INFO]: }
2025-03-13 17:22:56,294 [INFO]: 	>>> Finished "Creating the index" in 55.5145 secs
2025-03-13 17:22:56,294 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5434 secs
2025-03-13 17:22:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 38777 [episode count 9/20]
[retrieval_preprocessing] for episode 30078 [episode count 10/20], we have num_retrieval=np.int64(2520) num_query=np.int64(102)
2025-03-13 17:22:59,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:59,775 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:59
2025-03-13 17:22:59,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2054.02it/s]
2025-03-13 17:22:59,800 [INFO]: There are 2520 embeddings of dim 49152
2025-03-13 17:22:59,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 17:22:59,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:59,800 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:22:59,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:59,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:59,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,800 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:59,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:59,800 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:59
2025-03-13 17:22:59,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:59,801 [INFO]: 	Creating the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:59
2025-03-13 17:22:59,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:22:59,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,802 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:22:59,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.30it/s] 20%|██        | 2/10 [00:00<00:01,  6.76it/s] 30%|███       | 3/10 [00:00<00:00,  7.41it/s] 40%|████      | 4/10 [00:00<00:00,  7.85it/s] 50%|█████     | 5/10 [00:00<00:00,  7.93it/s] 60%|██████    | 6/10 [00:00<00:00,  7.97it/s] 70%|███████   | 7/10 [00:00<00:00,  7.90it/s] 80%|████████  | 8/10 [00:01<00:00,  7.84it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.82it/s]100%|██████████| 10/10 [00:03<00:00,  1.15it/s]100%|██████████| 10/10 [00:03<00:00,  2.69it/s]
2025-03-13 17:23:03,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:03
2025-03-13 17:23:33,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5258 secs
2025-03-13 17:23:33,046 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:23:33,046 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 17:23:59,806 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7593 secs
2025-03-13 17:23:59,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0066 secs
2025-03-13 17:23:59,808 [INFO]: {
2025-03-13 17:23:59,808 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:59,809 [INFO]: 	index_param: efSearch=200
2025-03-13 17:23:59,809 [INFO]: 	index_path: knn.index
2025-03-13 17:23:59,809 [INFO]: 	size in bytes: 495794350
2025-03-13 17:23:59,809 [INFO]: 	avg_search_speed_ms: 9.871065942064913
2025-03-13 17:23:59,809 [INFO]: 	99p_search_speed_ms: 20.854552183300253
2025-03-13 17:23:59,809 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:59,809 [INFO]: 	nb vectors: 2520
2025-03-13 17:23:59,809 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:59,809 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-13 17:23:59,809 [INFO]: }
2025-03-13 17:23:59,809 [INFO]: 	>>> Finished "Creating the index" in 60.0081 secs
2025-03-13 17:23:59,809 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0338 secs
2025-03-13 17:24:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 30078 [episode count 10/20]
[retrieval_preprocessing] for episode 76672 [episode count 11/20], we have num_retrieval=np.int64(2476) num_query=np.int64(146)
2025-03-13 17:24:01,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:02,148 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:02
2025-03-13 17:24:02,148 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-13 17:24:02,177 [INFO]: There are 2476 embeddings of dim 49152
2025-03-13 17:24:02,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 17:24:02,178 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:02
2025-03-13 17:24:02,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:02,179 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:24:02,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:02,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:24:02,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:02
2025-03-13 17:24:02,180 [INFO]: 511.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:02,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:24:02,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:02
2025-03-13 17:24:02,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:02,181 [INFO]: 	Creating the index 03/13/2025, 17:24:02
2025-03-13 17:24:02,181 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:02
2025-03-13 17:24:02,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:24:02,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:02
2025-03-13 17:24:02,184 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:24:02,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.07it/s] 30%|███       | 3/10 [00:00<00:00,  8.91it/s] 50%|█████     | 5/10 [00:00<00:00,  9.93it/s] 70%|███████   | 7/10 [00:00<00:00, 10.41it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.65it/s]100%|██████████| 10/10 [00:02<00:00,  3.67it/s]
2025-03-13 17:24:05,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:05
2025-03-13 17:24:38,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9925 secs
2025-03-13 17:24:38,441 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 17:24:38,441 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 17:25:07,548 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1073 secs
2025-03-13 17:25:07,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6520 secs
2025-03-13 17:25:07,836 [INFO]: {
2025-03-13 17:25:07,837 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:07,837 [INFO]: 	index_param: efSearch=239
2025-03-13 17:25:07,837 [INFO]: 	index_path: knn.index
2025-03-13 17:25:07,837 [INFO]: 	size in bytes: 487137490
2025-03-13 17:25:07,837 [INFO]: 	avg_search_speed_ms: 9.81407980315782
2025-03-13 17:25:07,837 [INFO]: 	99p_search_speed_ms: 15.042844307608895
2025-03-13 17:25:07,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:07,837 [INFO]: 	nb vectors: 2476
2025-03-13 17:25:07,837 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:07,837 [INFO]: 	compression ratio: 0.9993100880000018
2025-03-13 17:25:07,837 [INFO]: }
2025-03-13 17:25:07,837 [INFO]: 	>>> Finished "Creating the index" in 65.6565 secs
2025-03-13 17:25:07,837 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6893 secs
2025-03-13 17:25:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 76672 [episode count 11/20]
[retrieval_preprocessing] for episode 77223 [episode count 12/20], we have num_retrieval=np.int64(2504) num_query=np.int64(118)
2025-03-13 17:25:10,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:10,805 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:10
2025-03-13 17:25:10,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-13 17:25:10,832 [INFO]: There are 2504 embeddings of dim 49152
2025-03-13 17:25:10,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:25:10,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:10
2025-03-13 17:25:10,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:10,833 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:25:10,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:10,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:25:10,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:10
2025-03-13 17:25:10,834 [INFO]: 516.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:10,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:25:10,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:10
2025-03-13 17:25:10,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:10,835 [INFO]: 	Creating the index 03/13/2025, 17:25:10
2025-03-13 17:25:10,835 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:10
2025-03-13 17:25:10,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:25:10,838 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:10
2025-03-13 17:25:10,838 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:25:10,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.84it/s] 30%|███       | 3/10 [00:00<00:01,  6.92it/s] 40%|████      | 4/10 [00:00<00:00,  6.85it/s] 50%|█████     | 5/10 [00:00<00:00,  6.77it/s] 60%|██████    | 6/10 [00:00<00:00,  7.04it/s] 80%|████████  | 8/10 [00:01<00:00,  8.60it/s]100%|██████████| 10/10 [00:03<00:00,  1.91it/s]100%|██████████| 10/10 [00:03<00:00,  3.02it/s]
2025-03-13 17:25:14,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:14
2025-03-13 17:25:42,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0478 secs
2025-03-13 17:25:42,206 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 17:25:42,206 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.20it/s]
2025-03-13 17:26:04,398 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1918 secs
2025-03-13 17:26:04,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5620 secs
2025-03-13 17:26:04,400 [INFO]: {
2025-03-13 17:26:04,400 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:04,400 [INFO]: 	index_param: efSearch=243
2025-03-13 17:26:04,400 [INFO]: 	index_path: knn.index
2025-03-13 17:26:04,400 [INFO]: 	size in bytes: 492646330
2025-03-13 17:26:04,400 [INFO]: 	avg_search_speed_ms: 10.72254559995421
2025-03-13 17:26:04,400 [INFO]: 	99p_search_speed_ms: 14.925550036132334
2025-03-13 17:26:04,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:04,400 [INFO]: 	nb vectors: 2504
2025-03-13 17:26:04,400 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:04,400 [INFO]: 	compression ratio: 0.9993100567703407
2025-03-13 17:26:04,400 [INFO]: }
2025-03-13 17:26:04,400 [INFO]: 	>>> Finished "Creating the index" in 53.5654 secs
2025-03-13 17:26:04,400 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5955 secs
2025-03-13 17:26:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 77223 [episode count 12/20]
[retrieval_preprocessing] for episode 92587 [episode count 13/20], we have num_retrieval=np.int64(2508) num_query=np.int64(114)
2025-03-13 17:26:06,870 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:07,391 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:07
2025-03-13 17:26:07,391 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-13 17:26:07,414 [INFO]: There are 2508 embeddings of dim 49152
2025-03-13 17:26:07,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 17:26:07,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:07
2025-03-13 17:26:07,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:07,415 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:26:07,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:07,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:26:07,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:07
2025-03-13 17:26:07,415 [INFO]: 517.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:07,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:26:07,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:07
2025-03-13 17:26:07,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:07,415 [INFO]: 	Creating the index 03/13/2025, 17:26:07
2025-03-13 17:26:07,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:07
2025-03-13 17:26:07,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:26:07,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:07
2025-03-13 17:26:07,417 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:26:07,417 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.36it/s] 20%|██        | 2/10 [00:00<00:01,  7.09it/s] 30%|███       | 3/10 [00:00<00:00,  8.12it/s] 50%|█████     | 5/10 [00:00<00:00,  9.30it/s] 70%|███████   | 7/10 [00:00<00:00,  9.75it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.92it/s]100%|██████████| 10/10 [00:03<00:00,  1.85it/s]100%|██████████| 10/10 [00:03<00:00,  3.22it/s]
2025-03-13 17:26:10,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:10
2025-03-13 17:26:42,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7487 secs
2025-03-13 17:26:42,277 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 17:26:42,277 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 17:27:03,902 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6244 secs
2025-03-13 17:27:04,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3414 secs
2025-03-13 17:27:04,758 [INFO]: {
2025-03-13 17:27:04,758 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:04,759 [INFO]: 	index_param: efSearch=267
2025-03-13 17:27:04,759 [INFO]: 	index_path: knn.index
2025-03-13 17:27:04,759 [INFO]: 	size in bytes: 493433350
2025-03-13 17:27:04,759 [INFO]: 	avg_search_speed_ms: 10.91081464527055
2025-03-13 17:27:04,759 [INFO]: 	99p_search_speed_ms: 16.38933436013759
2025-03-13 17:27:04,759 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:04,759 [INFO]: 	nb vectors: 2508
2025-03-13 17:27:04,759 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:04,759 [INFO]: 	compression ratio: 0.9993099655708314
2025-03-13 17:27:04,759 [INFO]: }
2025-03-13 17:27:04,759 [INFO]: 	>>> Finished "Creating the index" in 57.3439 secs
2025-03-13 17:27:04,759 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3682 secs
2025-03-13 17:27:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 92587 [episode count 13/20]
[retrieval_preprocessing] for episode 15503 [episode count 14/20], we have num_retrieval=np.int64(2507) num_query=np.int64(115)
2025-03-13 17:27:13,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:13,920 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:13
2025-03-13 17:27:13,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.69it/s]
2025-03-13 17:27:13,949 [INFO]: There are 2507 embeddings of dim 49152
2025-03-13 17:27:13,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 17:27:13,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:13
2025-03-13 17:27:13,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:13,949 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:27:13,949 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:13,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:13,949 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:13
2025-03-13 17:27:13,949 [INFO]: 517.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:13,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:13,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:13
2025-03-13 17:27:13,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:13,949 [INFO]: 	Creating the index 03/13/2025, 17:27:13
2025-03-13 17:27:13,949 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:13
2025-03-13 17:27:13,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:27:13,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:13
2025-03-13 17:27:13,951 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:27:13,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.23it/s] 20%|██        | 2/10 [00:00<00:01,  6.43it/s] 30%|███       | 3/10 [00:00<00:01,  6.96it/s] 40%|████      | 4/10 [00:00<00:00,  7.26it/s] 50%|█████     | 5/10 [00:00<00:00,  7.49it/s] 60%|██████    | 6/10 [00:00<00:00,  7.80it/s] 70%|███████   | 7/10 [00:00<00:00,  7.92it/s] 80%|████████  | 8/10 [00:01<00:00,  8.00it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.05it/s]100%|██████████| 10/10 [00:03<00:00,  1.32it/s]100%|██████████| 10/10 [00:03<00:00,  2.96it/s]
2025-03-13 17:27:17,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:17
2025-03-13 17:27:51,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1281 secs
2025-03-13 17:27:51,463 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:27:51,463 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 17:28:09,559 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0950 secs
2025-03-13 17:28:09,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6100 secs
2025-03-13 17:28:09,561 [INFO]: {
2025-03-13 17:28:09,561 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:09,561 [INFO]: 	index_param: efSearch=234
2025-03-13 17:28:09,561 [INFO]: 	index_path: knn.index
2025-03-13 17:28:09,561 [INFO]: 	size in bytes: 493236610
2025-03-13 17:28:09,561 [INFO]: 	avg_search_speed_ms: 11.27700757087243
2025-03-13 17:28:09,561 [INFO]: 	99p_search_speed_ms: 18.37917312979698
2025-03-13 17:28:09,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:09,561 [INFO]: 	nb vectors: 2507
2025-03-13 17:28:09,561 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:09,561 [INFO]: 	compression ratio: 0.99930995795304
2025-03-13 17:28:09,561 [INFO]: }
2025-03-13 17:28:09,561 [INFO]: 	>>> Finished "Creating the index" in 55.6118 secs
2025-03-13 17:28:09,561 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6410 secs
2025-03-13 17:28:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 15503 [episode count 14/20]
[retrieval_preprocessing] for episode 5058 [episode count 15/20], we have num_retrieval=np.int64(2441) num_query=np.int64(181)
2025-03-13 17:28:11,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:12,258 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:12
2025-03-13 17:28:12,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.67it/s]
2025-03-13 17:28:12,285 [INFO]: There are 2441 embeddings of dim 49152
2025-03-13 17:28:12,285 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:28:12,285 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:12
2025-03-13 17:28:12,285 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:12,285 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:28:12,285 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:12,285 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:12,285 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:12
2025-03-13 17:28:12,285 [INFO]: 503.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:12,285 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:28:12,285 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:12
2025-03-13 17:28:12,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:12,285 [INFO]: 	Creating the index 03/13/2025, 17:28:12
2025-03-13 17:28:12,285 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:12
2025-03-13 17:28:12,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:28:12,286 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:12
2025-03-13 17:28:12,286 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:28:12,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.90it/s] 30%|███       | 3/10 [00:00<00:00, 11.27it/s] 50%|█████     | 5/10 [00:00<00:00, 10.90it/s] 70%|███████   | 7/10 [00:00<00:00, 10.39it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.17it/s]100%|██████████| 10/10 [00:03<00:00,  3.26it/s]
2025-03-13 17:28:15,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:15
2025-03-13 17:28:44,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0618 secs
2025-03-13 17:28:44,422 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 17:28:44,422 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 17:29:15,628 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2058 secs
2025-03-13 17:29:15,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3441 secs
2025-03-13 17:29:15,631 [INFO]: {
2025-03-13 17:29:15,631 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:15,631 [INFO]: 	index_param: efSearch=282
2025-03-13 17:29:15,631 [INFO]: 	index_path: knn.index
2025-03-13 17:29:15,631 [INFO]: 	size in bytes: 480251530
2025-03-13 17:29:15,631 [INFO]: 	avg_search_speed_ms: 12.173815665215962
2025-03-13 17:29:15,631 [INFO]: 	99p_search_speed_ms: 16.950081593822674
2025-03-13 17:29:15,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:15,631 [INFO]: 	nb vectors: 2441
2025-03-13 17:29:15,631 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:15,631 [INFO]: 	compression ratio: 0.9993099407720784
2025-03-13 17:29:15,631 [INFO]: }
2025-03-13 17:29:15,631 [INFO]: 	>>> Finished "Creating the index" in 63.3456 secs
2025-03-13 17:29:15,631 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3726 secs
2025-03-13 17:29:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 5058 [episode count 15/20]
[retrieval_preprocessing] for episode 24009 [episode count 16/20], we have num_retrieval=np.int64(2506) num_query=np.int64(116)
2025-03-13 17:29:18,908 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:19,339 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:19
2025-03-13 17:29:19,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1942.71it/s]
2025-03-13 17:29:19,366 [INFO]: There are 2506 embeddings of dim 49152
2025-03-13 17:29:19,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:29:19,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:19
2025-03-13 17:29:19,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:19,368 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:29:19,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:19,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:29:19,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:19
2025-03-13 17:29:19,368 [INFO]: 517.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:19,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:29:19,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:19
2025-03-13 17:29:19,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:19,369 [INFO]: 	Creating the index 03/13/2025, 17:29:19
2025-03-13 17:29:19,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:19
2025-03-13 17:29:19,372 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:29:19,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:19
2025-03-13 17:29:19,372 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:29:19,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.49it/s] 20%|██        | 2/10 [00:00<00:01,  7.43it/s] 30%|███       | 3/10 [00:00<00:00,  8.38it/s] 50%|█████     | 5/10 [00:00<00:00,  9.29it/s] 70%|███████   | 7/10 [00:00<00:00, 10.09it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.33it/s]100%|██████████| 10/10 [00:03<00:00,  3.16it/s]
2025-03-13 17:29:22,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:22
2025-03-13 17:29:59,661 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1138 secs
2025-03-13 17:29:59,661 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:29:59,661 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 17:30:21,149 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4876 secs
2025-03-13 17:30:21,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7786 secs
2025-03-13 17:30:21,151 [INFO]: {
2025-03-13 17:30:21,151 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:21,151 [INFO]: 	index_param: efSearch=201
2025-03-13 17:30:21,151 [INFO]: 	index_path: knn.index
2025-03-13 17:30:21,151 [INFO]: 	size in bytes: 493039870
2025-03-13 17:30:21,151 [INFO]: 	avg_search_speed_ms: 10.322639699189148
2025-03-13 17:30:21,151 [INFO]: 	99p_search_speed_ms: 14.771343767642975
2025-03-13 17:30:21,151 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:21,151 [INFO]: 	nb vectors: 2506
2025-03-13 17:30:21,151 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:21,151 [INFO]: 	compression ratio: 0.9993099503291691
2025-03-13 17:30:21,151 [INFO]: }
2025-03-13 17:30:21,151 [INFO]: 	>>> Finished "Creating the index" in 61.7821 secs
2025-03-13 17:30:21,151 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8119 secs
2025-03-13 17:30:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 24009 [episode count 16/20]
[retrieval_preprocessing] for episode 82396 [episode count 17/20], we have num_retrieval=np.int64(2487) num_query=np.int64(135)
2025-03-13 17:30:24,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:24,735 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:24
2025-03-13 17:30:24,735 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1631.39it/s]
2025-03-13 17:30:24,763 [INFO]: There are 2487 embeddings of dim 49152
2025-03-13 17:30:24,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:30:24,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:24,763 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:30:24,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:24,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:24,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,763 [INFO]: 513.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:24,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:30:24,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:24
2025-03-13 17:30:24,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:24,764 [INFO]: 	Creating the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,764 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:24
2025-03-13 17:30:24,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:30:24,765 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,765 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:30:24,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.76it/s] 20%|██        | 2/10 [00:00<00:01,  7.16it/s] 40%|████      | 4/10 [00:00<00:00, 10.61it/s] 60%|██████    | 6/10 [00:00<00:00, 12.51it/s] 80%|████████  | 8/10 [00:00<00:00, 13.52it/s]100%|██████████| 10/10 [00:02<00:00,  2.41it/s]100%|██████████| 10/10 [00:02<00:00,  3.72it/s]
2025-03-13 17:30:27,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:27
2025-03-13 17:30:59,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9160 secs
2025-03-13 17:30:59,378 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:30:59,378 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 17:31:18,715 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3366 secs
2025-03-13 17:31:18,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9522 secs
2025-03-13 17:31:18,717 [INFO]: {
2025-03-13 17:31:18,717 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:18,717 [INFO]: 	index_param: efSearch=196
2025-03-13 17:31:18,717 [INFO]: 	index_path: knn.index
2025-03-13 17:31:18,717 [INFO]: 	size in bytes: 489301630
2025-03-13 17:31:18,717 [INFO]: 	avg_search_speed_ms: 9.346917697454794
2025-03-13 17:31:18,717 [INFO]: 	99p_search_speed_ms: 13.632293138653038
2025-03-13 17:31:18,717 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:18,717 [INFO]: 	nb vectors: 2487
2025-03-13 17:31:18,717 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:18,717 [INFO]: 	compression ratio: 0.9993101719281009
2025-03-13 17:31:18,717 [INFO]: }
2025-03-13 17:31:18,717 [INFO]: 	>>> Finished "Creating the index" in 53.9538 secs
2025-03-13 17:31:18,717 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9827 secs
2025-03-13 17:31:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 82396 [episode count 17/20]
[retrieval_preprocessing] for episode 70624 [episode count 18/20], we have num_retrieval=np.int64(2494) num_query=np.int64(128)
2025-03-13 17:31:22,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:23,256 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:23
2025-03-13 17:31:23,256 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1591.77it/s]
2025-03-13 17:31:23,280 [INFO]: There are 2494 embeddings of dim 49152
2025-03-13 17:31:23,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 17:31:23,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:23
2025-03-13 17:31:23,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:23,280 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:31:23,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:23,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:23,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:23
2025-03-13 17:31:23,280 [INFO]: 514.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:23,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:23,281 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:23
2025-03-13 17:31:23,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:23,281 [INFO]: 	Creating the index 03/13/2025, 17:31:23
2025-03-13 17:31:23,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:23
2025-03-13 17:31:23,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:31:23,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:23
2025-03-13 17:31:23,282 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:31:23,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.89it/s] 20%|██        | 2/10 [00:00<00:01,  7.71it/s] 30%|███       | 3/10 [00:00<00:00,  7.92it/s] 40%|████      | 4/10 [00:00<00:00,  8.03it/s] 50%|█████     | 5/10 [00:00<00:00,  8.11it/s] 60%|██████    | 6/10 [00:00<00:00,  8.35it/s] 80%|████████  | 8/10 [00:00<00:00,  9.01it/s]100%|██████████| 10/10 [00:02<00:00,  2.21it/s]100%|██████████| 10/10 [00:02<00:00,  3.53it/s]
2025-03-13 17:31:26,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:26
2025-03-13 17:31:59,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0326 secs
2025-03-13 17:31:59,157 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 17:31:59,157 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 17:32:23,835 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6786 secs
2025-03-13 17:32:23,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5556 secs
2025-03-13 17:32:23,838 [INFO]: {
2025-03-13 17:32:23,838 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:23,838 [INFO]: 	index_param: efSearch=236
2025-03-13 17:32:23,838 [INFO]: 	index_path: knn.index
2025-03-13 17:32:23,838 [INFO]: 	size in bytes: 490678870
2025-03-13 17:32:23,838 [INFO]: 	avg_search_speed_ms: 10.589367312219357
2025-03-13 17:32:23,838 [INFO]: 	99p_search_speed_ms: 14.056251549627623
2025-03-13 17:32:23,838 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:23,838 [INFO]: 	nb vectors: 2494
2025-03-13 17:32:23,838 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:23,838 [INFO]: 	compression ratio: 0.9993101027562079
2025-03-13 17:32:23,838 [INFO]: }
2025-03-13 17:32:23,838 [INFO]: 	>>> Finished "Creating the index" in 60.5571 secs
2025-03-13 17:32:23,838 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5818 secs
2025-03-13 17:32:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 70624 [episode count 18/20]
[retrieval_preprocessing] for episode 13521 [episode count 19/20], we have num_retrieval=np.int64(2469) num_query=np.int64(153)
2025-03-13 17:32:25,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:27,033 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:27
2025-03-13 17:32:27,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.96it/s]
2025-03-13 17:32:27,058 [INFO]: There are 2469 embeddings of dim 49152
2025-03-13 17:32:27,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 17:32:27,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:27
2025-03-13 17:32:27,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:27,058 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:32:27,058 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:27,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:27,058 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:27
2025-03-13 17:32:27,058 [INFO]: 509.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:27,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:27,058 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:27
2025-03-13 17:32:27,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:27,058 [INFO]: 	Creating the index 03/13/2025, 17:32:27
2025-03-13 17:32:27,058 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:27
2025-03-13 17:32:27,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:32:27,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:27
2025-03-13 17:32:27,059 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:32:27,059 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.59it/s] 30%|███       | 3/10 [00:00<00:00,  8.85it/s] 50%|█████     | 5/10 [00:00<00:00,  9.79it/s] 70%|███████   | 7/10 [00:00<00:00, 10.21it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.47it/s]100%|██████████| 10/10 [00:02<00:00,  3.56it/s]
2025-03-13 17:32:29,878 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:29
2025-03-13 17:33:02,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3303 secs
2025-03-13 17:33:02,210 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:33:02,210 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.79it/s] 50%|█████     | 2/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:33:23,560 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3502 secs
2025-03-13 17:33:23,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5033 secs
2025-03-13 17:33:23,563 [INFO]: {
2025-03-13 17:33:23,563 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:23,563 [INFO]: 	index_param: efSearch=198
2025-03-13 17:33:23,563 [INFO]: 	index_path: knn.index
2025-03-13 17:33:23,563 [INFO]: 	size in bytes: 485760310
2025-03-13 17:33:23,563 [INFO]: 	avg_search_speed_ms: 9.415409890776974
2025-03-13 17:33:23,563 [INFO]: 	99p_search_speed_ms: 16.76769539946692
2025-03-13 17:33:23,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:23,563 [INFO]: 	nb vectors: 2469
2025-03-13 17:33:23,563 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:23,563 [INFO]: 	compression ratio: 0.9993100342018474
2025-03-13 17:33:23,563 [INFO]: }
2025-03-13 17:33:23,563 [INFO]: 	>>> Finished "Creating the index" in 56.5048 secs
2025-03-13 17:33:23,563 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5302 secs
2025-03-13 17:33:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 13521 [episode count 19/20]
2025-03-13 17:33:25: [retrieval_preprocessing] finished for 3951366978_put_silver_object_in_light_blue_cup [chosen_id count 6/196]
2025-03-13 17:33:28: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4045730075_Pour contents of lunchbox onto towel [chosen_id count 7/196]
2025-03-13 17:33:28: [retrieval_preprocessing] we have num_total=4006 embedding_dim=49152
[retrieval_preprocessing] for episode 14350 [episode count 0/20], we have num_retrieval=np.int64(3813) num_query=np.int64(193)
2025-03-13 17:33:29,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:30,498 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:30
2025-03-13 17:33:30,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1843.65it/s]
2025-03-13 17:33:30,522 [INFO]: There are 3813 embeddings of dim 49152
2025-03-13 17:33:30,522 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:33:30,522 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:30
2025-03-13 17:33:30,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:30,523 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:33:30,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:30,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:30,523 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:30
2025-03-13 17:33:30,523 [INFO]: 786.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:30,523 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:30,523 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:30
2025-03-13 17:33:30,523 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:30,523 [INFO]: 	Creating the index 03/13/2025, 17:33:30
2025-03-13 17:33:30,523 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:30
2025-03-13 17:33:30,524 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:33:30,524 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:30
2025-03-13 17:33:30,524 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:33:30,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.68it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.24it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.12it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.85it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.00it/s] 50%|█████     | 8/16 [00:00<00:00,  9.31it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.92it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.50it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.42it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.94it/s]100%|██████████| 16/16 [00:04<00:00,  1.63it/s]100%|██████████| 16/16 [00:04<00:00,  3.39it/s]
2025-03-13 17:33:35,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:35
2025-03-13 17:34:19,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1560 secs
2025-03-13 17:34:19,399 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 17:34:19,399 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 17:34:45,273 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8737 secs
2025-03-13 17:34:45,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7516 secs
2025-03-13 17:34:45,276 [INFO]: {
2025-03-13 17:34:45,276 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:45,276 [INFO]: 	index_param: efSearch=247
2025-03-13 17:34:45,276 [INFO]: 	index_path: knn.index
2025-03-13 17:34:45,276 [INFO]: 	size in bytes: 750184630
2025-03-13 17:34:45,276 [INFO]: 	avg_search_speed_ms: 11.958352120484015
2025-03-13 17:34:45,276 [INFO]: 	99p_search_speed_ms: 15.826674771960825
2025-03-13 17:34:45,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:45,276 [INFO]: 	nb vectors: 3813
2025-03-13 17:34:45,276 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:45,276 [INFO]: 	compression ratio: 0.9993090687555142
2025-03-13 17:34:45,276 [INFO]: }
2025-03-13 17:34:45,276 [INFO]: 	>>> Finished "Creating the index" in 74.7531 secs
2025-03-13 17:34:45,276 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7784 secs
2025-03-13 17:34:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 14350 [episode count 0/20]
[retrieval_preprocessing] for episode 34839 [episode count 1/20], we have num_retrieval=np.int64(3679) num_query=np.int64(327)
2025-03-13 17:34:49,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:50,982 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:50
2025-03-13 17:34:50,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1309.49it/s]
2025-03-13 17:34:51,007 [INFO]: There are 3679 embeddings of dim 49152
2025-03-13 17:34:51,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:34:51,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:51
2025-03-13 17:34:51,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:51,007 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:34:51,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:51,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:51,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:51
2025-03-13 17:34:51,008 [INFO]: 759.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:51,008 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:51,008 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:51
2025-03-13 17:34:51,008 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:51,008 [INFO]: 	Creating the index 03/13/2025, 17:34:51
2025-03-13 17:34:51,008 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:51
2025-03-13 17:34:51,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:34:51,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:51
2025-03-13 17:34:51,009 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:34:51,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  3.59it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.24it/s] 20%|██        | 3/15 [00:00<00:01,  6.53it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.96it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.24it/s] 40%|████      | 6/15 [00:00<00:01,  7.47it/s] 47%|████▋     | 7/15 [00:01<00:01,  7.62it/s] 53%|█████▎    | 8/15 [00:01<00:00,  7.72it/s] 60%|██████    | 9/15 [00:01<00:00,  7.76it/s] 67%|██████▋   | 10/15 [00:01<00:00,  7.81it/s] 73%|███████▎  | 11/15 [00:01<00:00,  7.86it/s] 80%|████████  | 12/15 [00:01<00:00,  7.77it/s] 87%|████████▋ | 13/15 [00:01<00:00,  7.70it/s] 93%|█████████▎| 14/15 [00:01<00:00,  7.69it/s]100%|██████████| 15/15 [00:04<00:00,  1.01it/s]100%|██████████| 15/15 [00:04<00:00,  3.05it/s]
2025-03-13 17:34:55,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:55
2025-03-13 17:35:40,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9325 secs
2025-03-13 17:35:40,862 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:35:40,862 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 17:36:05,083 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2208 secs
2025-03-13 17:36:05,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0769 secs
2025-03-13 17:36:05,086 [INFO]: {
2025-03-13 17:36:05,086 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:05,086 [INFO]: 	index_param: efSearch=220
2025-03-13 17:36:05,086 [INFO]: 	index_path: knn.index
2025-03-13 17:36:05,086 [INFO]: 	size in bytes: 723820750
2025-03-13 17:36:05,086 [INFO]: 	avg_search_speed_ms: 11.937361940194748
2025-03-13 17:36:05,086 [INFO]: 	99p_search_speed_ms: 24.22545072855428
2025-03-13 17:36:05,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:05,086 [INFO]: 	nb vectors: 3679
2025-03-13 17:36:05,086 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:05,086 [INFO]: 	compression ratio: 0.99930933452792
2025-03-13 17:36:05,086 [INFO]: }
2025-03-13 17:36:05,086 [INFO]: 	>>> Finished "Creating the index" in 74.0783 secs
2025-03-13 17:36:05,086 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1045 secs
2025-03-13 17:36:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 34839 [episode count 1/20]
[retrieval_preprocessing] for episode 52766 [episode count 2/20], we have num_retrieval=np.int64(3837) num_query=np.int64(169)
2025-03-13 17:36:08,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:10,488 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:10
2025-03-13 17:36:10,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.41it/s]
2025-03-13 17:36:10,515 [INFO]: There are 3837 embeddings of dim 49152
2025-03-13 17:36:10,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 17:36:10,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:10
2025-03-13 17:36:10,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:10,516 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:36:10,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:10,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:10,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:10
2025-03-13 17:36:10,516 [INFO]: 791.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:10,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:10,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:10
2025-03-13 17:36:10,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:10,516 [INFO]: 	Creating the index 03/13/2025, 17:36:10
2025-03-13 17:36:10,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:10
2025-03-13 17:36:10,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:36:10,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:10
2025-03-13 17:36:10,517 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:36:10,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.26it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.37it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.13it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.43it/s] 50%|█████     | 8/16 [00:00<00:00,  9.29it/s] 62%|██████▎   | 10/16 [00:00<00:00, 11.16it/s] 81%|████████▏ | 13/16 [00:01<00:00, 14.70it/s]100%|██████████| 16/16 [00:04<00:00,  2.03it/s]100%|██████████| 16/16 [00:04<00:00,  3.53it/s]
2025-03-13 17:36:15,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:15
2025-03-13 17:37:03,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4922 secs
2025-03-13 17:37:03,545 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 17:37:03,546 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 17:37:22,847 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3011 secs
2025-03-13 17:37:22,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3327 secs
2025-03-13 17:37:22,850 [INFO]: {
2025-03-13 17:37:22,850 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:22,850 [INFO]: 	index_param: efSearch=224
2025-03-13 17:37:22,850 [INFO]: 	index_path: knn.index
2025-03-13 17:37:22,850 [INFO]: 	size in bytes: 754906630
2025-03-13 17:37:22,850 [INFO]: 	avg_search_speed_ms: 10.874800303313153
2025-03-13 17:37:22,850 [INFO]: 	99p_search_speed_ms: 16.491992725059387
2025-03-13 17:37:22,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:22,850 [INFO]: 	nb vectors: 3837
2025-03-13 17:37:22,850 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:22,850 [INFO]: 	compression ratio: 0.9993088761188916
2025-03-13 17:37:22,850 [INFO]: }
2025-03-13 17:37:22,851 [INFO]: 	>>> Finished "Creating the index" in 72.3343 secs
2025-03-13 17:37:22,851 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3620 secs
2025-03-13 17:37:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 52766 [episode count 2/20]
[retrieval_preprocessing] for episode 43049 [episode count 3/20], we have num_retrieval=np.int64(3826) num_query=np.int64(180)
2025-03-13 17:37:25,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:26,318 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:26
2025-03-13 17:37:26,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2152.03it/s]
2025-03-13 17:37:26,344 [INFO]: There are 3826 embeddings of dim 49152
2025-03-13 17:37:26,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:37:26,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:26
2025-03-13 17:37:26,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:26,345 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:37:26,345 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:26,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:37:26,346 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:26
2025-03-13 17:37:26,346 [INFO]: 789.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:26,346 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:37:26,346 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:26
2025-03-13 17:37:26,346 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:26,347 [INFO]: 	Creating the index 03/13/2025, 17:37:26
2025-03-13 17:37:26,347 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:26
2025-03-13 17:37:26,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:37:26,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:26
2025-03-13 17:37:26,350 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:37:26,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.30it/s] 19%|█▉        | 3/16 [00:00<00:00, 13.55it/s] 38%|███▊      | 6/16 [00:00<00:00, 16.90it/s] 50%|█████     | 8/16 [00:00<00:00, 14.66it/s] 62%|██████▎   | 10/16 [00:00<00:00, 14.81it/s] 75%|███████▌  | 12/16 [00:00<00:00, 13.83it/s] 88%|████████▊ | 14/16 [00:01<00:00, 13.38it/s]100%|██████████| 16/16 [00:04<00:00,  1.81it/s]100%|██████████| 16/16 [00:04<00:00,  3.80it/s]
2025-03-13 17:37:30,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:30
2025-03-13 17:38:09,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7674 secs
2025-03-13 17:38:09,340 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:38:09,340 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 17:38:46,003 [INFO]: 	>>> Finished "Compute fast metrics" in 36.6628 secs
2025-03-13 17:38:46,006 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.6556 secs
2025-03-13 17:38:46,006 [INFO]: {
2025-03-13 17:38:46,006 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:46,006 [INFO]: 	index_param: efSearch=162
2025-03-13 17:38:46,006 [INFO]: 	index_path: knn.index
2025-03-13 17:38:46,006 [INFO]: 	size in bytes: 752742310
2025-03-13 17:38:46,006 [INFO]: 	avg_search_speed_ms: 8.296207674002252
2025-03-13 17:38:46,006 [INFO]: 	99p_search_speed_ms: 13.470996478572488
2025-03-13 17:38:46,006 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:46,006 [INFO]: 	nb vectors: 3826
2025-03-13 17:38:46,006 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:46,006 [INFO]: 	compression ratio: 0.9993090570397192
2025-03-13 17:38:46,006 [INFO]: }
2025-03-13 17:38:46,006 [INFO]: 	>>> Finished "Creating the index" in 79.6592 secs
2025-03-13 17:38:46,006 [INFO]: >>> Finished "Launching the whole pipeline" in 79.6878 secs
2025-03-13 17:38:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 43049 [episode count 3/20]
[retrieval_preprocessing] for episode 36946 [episode count 4/20], we have num_retrieval=np.int64(3808) num_query=np.int64(198)
2025-03-13 17:38:48,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:49,590 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:49
2025-03-13 17:38:49,590 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 17:38:49,616 [INFO]: There are 3808 embeddings of dim 49152
2025-03-13 17:38:49,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:38:49,617 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:49
2025-03-13 17:38:49,617 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:49,617 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:38:49,617 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:49,617 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:49,617 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:49
2025-03-13 17:38:49,617 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:49,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:38:49,617 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:49
2025-03-13 17:38:49,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:49,617 [INFO]: 	Creating the index 03/13/2025, 17:38:49
2025-03-13 17:38:49,617 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:49
2025-03-13 17:38:49,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:38:49,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:49
2025-03-13 17:38:49,618 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:38:49,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.15it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.53it/s] 27%|██▋       | 4/15 [00:00<00:01,  9.90it/s] 40%|████      | 6/15 [00:00<00:00, 11.45it/s] 53%|█████▎    | 8/15 [00:00<00:00, 12.19it/s] 67%|██████▋   | 10/15 [00:00<00:00, 12.62it/s] 80%|████████  | 12/15 [00:01<00:00, 12.68it/s] 93%|█████████▎| 14/15 [00:01<00:00, 12.70it/s]100%|██████████| 15/15 [00:04<00:00,  3.16it/s]
2025-03-13 17:38:54,375 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:54
2025-03-13 17:39:36,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1189 secs
2025-03-13 17:39:36,495 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:39:36,495 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.07it/s] 50%|█████     | 2/4 [00:00<00:00,  4.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.02it/s]
2025-03-13 17:40:12,105 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6101 secs
2025-03-13 17:40:12,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4898 secs
2025-03-13 17:40:12,108 [INFO]: {
2025-03-13 17:40:12,108 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:12,108 [INFO]: 	index_param: efSearch=234
2025-03-13 17:40:12,108 [INFO]: 	index_path: knn.index
2025-03-13 17:40:12,108 [INFO]: 	size in bytes: 749200930
2025-03-13 17:40:12,108 [INFO]: 	avg_search_speed_ms: 11.687090448495523
2025-03-13 17:40:12,108 [INFO]: 	99p_search_speed_ms: 20.87015077704567
2025-03-13 17:40:12,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:12,108 [INFO]: 	nb vectors: 3808
2025-03-13 17:40:12,108 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:12,108 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-13 17:40:12,108 [INFO]: }
2025-03-13 17:40:12,109 [INFO]: 	>>> Finished "Creating the index" in 82.4915 secs
2025-03-13 17:40:12,109 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5186 secs
2025-03-13 17:40:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 36946 [episode count 4/20]
[retrieval_preprocessing] for episode 58494 [episode count 5/20], we have num_retrieval=np.int64(3752) num_query=np.int64(254)
2025-03-13 17:40:15,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:16,301 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:16
2025-03-13 17:40:16,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-13 17:40:16,329 [INFO]: There are 3752 embeddings of dim 49152
2025-03-13 17:40:16,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:40:16,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:16
2025-03-13 17:40:16,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:16,330 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:40:16,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:16,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:16,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:16
2025-03-13 17:40:16,330 [INFO]: 774.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:16,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:16,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:16
2025-03-13 17:40:16,330 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:16,330 [INFO]: 	Creating the index 03/13/2025, 17:40:16
2025-03-13 17:40:16,330 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:16
2025-03-13 17:40:16,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:40:16,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:16
2025-03-13 17:40:16,332 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:40:16,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.70it/s] 20%|██        | 3/15 [00:00<00:00, 13.07it/s] 33%|███▎      | 5/15 [00:00<00:00, 15.09it/s] 47%|████▋     | 7/15 [00:00<00:00, 16.05it/s] 60%|██████    | 9/15 [00:00<00:00, 16.56it/s] 73%|███████▎  | 11/15 [00:00<00:00, 14.91it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.15it/s]100%|██████████| 15/15 [00:04<00:00,  1.81it/s]100%|██████████| 15/15 [00:04<00:00,  3.73it/s]
2025-03-13 17:40:20,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:20
2025-03-13 17:41:04,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5256 secs
2025-03-13 17:41:04,890 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:41:04,890 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:41:24,547 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6563 secs
2025-03-13 17:41:24,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2886 secs
2025-03-13 17:41:24,621 [INFO]: {
2025-03-13 17:41:24,621 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:24,621 [INFO]: 	index_param: efSearch=232
2025-03-13 17:41:24,621 [INFO]: 	index_path: knn.index
2025-03-13 17:41:24,621 [INFO]: 	size in bytes: 738183190
2025-03-13 17:41:24,621 [INFO]: 	avg_search_speed_ms: 11.277580891526908
2025-03-13 17:41:24,621 [INFO]: 	99p_search_speed_ms: 15.922509506344795
2025-03-13 17:41:24,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:24,621 [INFO]: 	nb vectors: 3752
2025-03-13 17:41:24,621 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:24,621 [INFO]: 	compression ratio: 0.9993091498060258
2025-03-13 17:41:24,621 [INFO]: }
2025-03-13 17:41:24,621 [INFO]: 	>>> Finished "Creating the index" in 68.2911 secs
2025-03-13 17:41:24,621 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3199 secs
2025-03-13 17:41:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 58494 [episode count 5/20]
[retrieval_preprocessing] for episode 91912 [episode count 6/20], we have num_retrieval=np.int64(3887) num_query=np.int64(119)
2025-03-13 17:41:30,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:31,879 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:31
2025-03-13 17:41:31,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.50it/s]
2025-03-13 17:41:31,921 [INFO]: There are 3887 embeddings of dim 49152
2025-03-13 17:41:31,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0425 secs
2025-03-13 17:41:31,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:31
2025-03-13 17:41:31,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:31,922 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:41:31,923 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:31,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:41:31,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:31
2025-03-13 17:41:31,923 [INFO]: 802.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:31,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:41:31,924 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:31
2025-03-13 17:41:31,924 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:31,924 [INFO]: 	Creating the index 03/13/2025, 17:41:31
2025-03-13 17:41:31,924 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:31
2025-03-13 17:41:31,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:41:31,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:31
2025-03-13 17:41:31,927 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:41:31,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.62it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.97it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.25it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.92it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.79it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.93it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.81it/s] 50%|█████     | 8/16 [00:01<00:01,  7.93it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.01it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.15it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.32it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.55it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.50it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.52it/s]100%|██████████| 16/16 [00:05<00:00,  1.04s/it]100%|██████████| 16/16 [00:05<00:00,  3.16it/s]
2025-03-13 17:41:36,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:36
2025-03-13 17:42:22,430 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4319 secs
2025-03-13 17:42:22,431 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 17:42:22,431 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.95it/s]
2025-03-13 17:43:00,000 [INFO]: 	>>> Finished "Compute fast metrics" in 37.5691 secs
2025-03-13 17:43:00,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.0758 secs
2025-03-13 17:43:00,003 [INFO]: {
2025-03-13 17:43:00,003 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:00,003 [INFO]: 	index_param: efSearch=242
2025-03-13 17:43:00,003 [INFO]: 	index_path: knn.index
2025-03-13 17:43:00,003 [INFO]: 	size in bytes: 764743870
2025-03-13 17:43:00,003 [INFO]: 	avg_search_speed_ms: 13.263116244211872
2025-03-13 17:43:00,003 [INFO]: 	99p_search_speed_ms: 33.92946436535568
2025-03-13 17:43:00,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:00,003 [INFO]: 	nb vectors: 3887
2025-03-13 17:43:00,003 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:00,003 [INFO]: 	compression ratio: 0.9993088221812095
2025-03-13 17:43:00,003 [INFO]: }
2025-03-13 17:43:00,003 [INFO]: 	>>> Finished "Creating the index" in 88.0795 secs
2025-03-13 17:43:00,003 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1243 secs
2025-03-13 17:43:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 91912 [episode count 6/20]
[retrieval_preprocessing] for episode 71934 [episode count 7/20], we have num_retrieval=np.int64(3860) num_query=np.int64(146)
2025-03-13 17:43:02,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:03,814 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:03
2025-03-13 17:43:03,814 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-13 17:43:03,850 [INFO]: There are 3860 embeddings of dim 49152
2025-03-13 17:43:03,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 17:43:03,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:03,851 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:43:03,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:03,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:43:03,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,852 [INFO]: 796.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:03,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:43:03,853 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:03
2025-03-13 17:43:03,853 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:03,853 [INFO]: 	Creating the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:03
2025-03-13 17:43:03,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:43:03,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,856 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:43:03,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.86it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.73it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.16it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.57it/s] 50%|█████     | 8/16 [00:00<00:00,  9.85it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.07it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.10it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.35it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.97it/s]100%|██████████| 16/16 [00:06<00:00,  1.08s/it]100%|██████████| 16/16 [00:06<00:00,  2.55it/s]
2025-03-13 17:43:10,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:10
2025-03-13 17:43:48,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8519 secs
2025-03-13 17:43:48,992 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 17:43:48,992 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.00it/s] 50%|█████     | 2/4 [00:00<00:00,  2.04it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.78it/s]
2025-03-13 17:44:35,261 [INFO]: 	>>> Finished "Compute fast metrics" in 46.2689 secs
2025-03-13 17:44:35,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.5423 secs
2025-03-13 17:44:35,399 [INFO]: {
2025-03-13 17:44:35,399 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:35,399 [INFO]: 	index_param: efSearch=299
2025-03-13 17:44:35,399 [INFO]: 	index_path: knn.index
2025-03-13 17:44:35,399 [INFO]: 	size in bytes: 759431710
2025-03-13 17:44:35,399 [INFO]: 	avg_search_speed_ms: 11.984010517017213
2025-03-13 17:44:35,399 [INFO]: 	99p_search_speed_ms: 17.498159795068194
2025-03-13 17:44:35,399 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:35,399 [INFO]: 	nb vectors: 3860
2025-03-13 17:44:35,399 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:35,400 [INFO]: 	compression ratio: 0.9993089174535522
2025-03-13 17:44:35,400 [INFO]: }
2025-03-13 17:44:35,400 [INFO]: 	>>> Finished "Creating the index" in 91.5467 secs
2025-03-13 17:44:35,400 [INFO]: >>> Finished "Launching the whole pipeline" in 91.5861 secs
2025-03-13 17:44:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 71934 [episode count 7/20]
[retrieval_preprocessing] for episode 32170 [episode count 8/20], we have num_retrieval=np.int64(3822) num_query=np.int64(184)
2025-03-13 17:44:38,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:39,104 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:39
2025-03-13 17:44:39,104 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 17:44:39,131 [INFO]: There are 3822 embeddings of dim 49152
2025-03-13 17:44:39,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:44:39,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:39
2025-03-13 17:44:39,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:39,132 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:44:39,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:39,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:44:39,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:39
2025-03-13 17:44:39,133 [INFO]: 788.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:39,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:44:39,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:39
2025-03-13 17:44:39,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:39,134 [INFO]: 	Creating the index 03/13/2025, 17:44:39
2025-03-13 17:44:39,134 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:39
2025-03-13 17:44:39,136 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:44:39,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:39
2025-03-13 17:44:39,137 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:44:39,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.90it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.00it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.10it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.55it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.59it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.76it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.59it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.37it/s]100%|██████████| 16/16 [00:04<00:00,  3.56it/s]
2025-03-13 17:44:43,639 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:43
2025-03-13 17:45:29,726 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0861 secs
2025-03-13 17:45:29,726 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:45:29,726 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 17:45:55,383 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6571 secs
2025-03-13 17:45:55,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2500 secs
2025-03-13 17:45:55,387 [INFO]: {
2025-03-13 17:45:55,387 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:55,387 [INFO]: 	index_param: efSearch=195
2025-03-13 17:45:55,387 [INFO]: 	index_path: knn.index
2025-03-13 17:45:55,387 [INFO]: 	size in bytes: 751955290
2025-03-13 17:45:55,387 [INFO]: 	avg_search_speed_ms: 8.634213227271996
2025-03-13 17:45:55,387 [INFO]: 	99p_search_speed_ms: 11.327412254177036
2025-03-13 17:45:55,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:55,387 [INFO]: 	nb vectors: 3822
2025-03-13 17:45:55,387 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:55,387 [INFO]: 	compression ratio: 0.9993091158385228
2025-03-13 17:45:55,387 [INFO]: }
2025-03-13 17:45:55,387 [INFO]: 	>>> Finished "Creating the index" in 76.2534 secs
2025-03-13 17:45:55,387 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2832 secs
2025-03-13 17:45:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 32170 [episode count 8/20]
[retrieval_preprocessing] for episode 77035 [episode count 9/20], we have num_retrieval=np.int64(3816) num_query=np.int64(190)
2025-03-13 17:45:58,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:59,085 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:59
2025-03-13 17:45:59,085 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1778.00it/s]
2025-03-13 17:45:59,110 [INFO]: There are 3816 embeddings of dim 49152
2025-03-13 17:45:59,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:45:59,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:59
2025-03-13 17:45:59,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:59,110 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:45:59,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:59,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:59,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:59
2025-03-13 17:45:59,110 [INFO]: 787.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:59,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:45:59,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:59
2025-03-13 17:45:59,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:59,110 [INFO]: 	Creating the index 03/13/2025, 17:45:59
2025-03-13 17:45:59,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:59
2025-03-13 17:45:59,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:45:59,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:59
2025-03-13 17:45:59,111 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:45:59,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.78it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.89it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.73it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.02it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.29it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.54it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.72it/s]100%|██████████| 16/16 [00:04<00:00,  3.73it/s]
2025-03-13 17:46:03,406 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:03
2025-03-13 17:46:41,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3981 secs
2025-03-13 17:46:41,805 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:46:41,805 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 17:47:06,136 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3306 secs
2025-03-13 17:47:06,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0274 secs
2025-03-13 17:47:06,139 [INFO]: {
2025-03-13 17:47:06,139 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:06,139 [INFO]: 	index_param: efSearch=270
2025-03-13 17:47:06,139 [INFO]: 	index_path: knn.index
2025-03-13 17:47:06,139 [INFO]: 	size in bytes: 750774850
2025-03-13 17:47:06,139 [INFO]: 	avg_search_speed_ms: 11.132194887736897
2025-03-13 17:47:06,139 [INFO]: 	99p_search_speed_ms: 17.474032803438597
2025-03-13 17:47:06,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:06,139 [INFO]: 	nb vectors: 3816
2025-03-13 17:47:06,139 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:06,139 [INFO]: 	compression ratio: 0.9993090844745266
2025-03-13 17:47:06,139 [INFO]: }
2025-03-13 17:47:06,139 [INFO]: 	>>> Finished "Creating the index" in 67.0288 secs
2025-03-13 17:47:06,139 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0543 secs
2025-03-13 17:47:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 77035 [episode count 9/20]
[retrieval_preprocessing] for episode 11583 [episode count 10/20], we have num_retrieval=np.int64(3520) num_query=np.int64(486)
2025-03-13 17:47:09,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:10,249 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:10
2025-03-13 17:47:10,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 17:47:10,276 [INFO]: There are 3520 embeddings of dim 49152
2025-03-13 17:47:10,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:47:10,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:10,276 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:47:10,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:10,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:10,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,276 [INFO]: 726.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:10,277 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:47:10,277 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:10
2025-03-13 17:47:10,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:10,277 [INFO]: 	Creating the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,277 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:10
2025-03-13 17:47:10,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:47:10,278 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,278 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:47:10,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.83it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.14it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.13it/s] 50%|█████     | 7/14 [00:00<00:00, 10.66it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.82it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.95it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.82it/s]100%|██████████| 14/14 [00:04<00:00,  3.47it/s]
2025-03-13 17:47:14,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:14
2025-03-13 17:47:54,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4096 secs
2025-03-13 17:47:54,732 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 17:47:54,732 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 17:48:32,192 [INFO]: 	>>> Finished "Compute fast metrics" in 37.4602 secs
2025-03-13 17:48:32,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.5497 secs
2025-03-13 17:48:32,828 [INFO]: {
2025-03-13 17:48:32,828 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:32,828 [INFO]: 	index_param: efSearch=305
2025-03-13 17:48:32,828 [INFO]: 	index_path: knn.index
2025-03-13 17:48:32,828 [INFO]: 	size in bytes: 692538310
2025-03-13 17:48:32,828 [INFO]: 	avg_search_speed_ms: 12.178899794612784
2025-03-13 17:48:32,828 [INFO]: 	99p_search_speed_ms: 16.385795921087254
2025-03-13 17:48:32,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:32,828 [INFO]: 	nb vectors: 3520
2025-03-13 17:48:32,828 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:32,828 [INFO]: 	compression ratio: 0.9993095688814674
2025-03-13 17:48:32,828 [INFO]: }
2025-03-13 17:48:32,828 [INFO]: 	>>> Finished "Creating the index" in 82.5518 secs
2025-03-13 17:48:32,829 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5791 secs
2025-03-13 17:48:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 11583 [episode count 10/20]
[retrieval_preprocessing] for episode 24551 [episode count 11/20], we have num_retrieval=np.int64(3864) num_query=np.int64(142)
2025-03-13 17:48:40,090 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:40,760 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:40
2025-03-13 17:48:40,760 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.29it/s]
2025-03-13 17:48:40,787 [INFO]: There are 3864 embeddings of dim 49152
2025-03-13 17:48:40,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:48:40,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:40
2025-03-13 17:48:40,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:40,788 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:48:40,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:40,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:40,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:40
2025-03-13 17:48:40,788 [INFO]: 797.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:40,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:40,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:40
2025-03-13 17:48:40,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:40,788 [INFO]: 	Creating the index 03/13/2025, 17:48:40
2025-03-13 17:48:40,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:40
2025-03-13 17:48:40,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:48:40,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:40
2025-03-13 17:48:40,789 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:48:40,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.48it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.05it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.28it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.05it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.49it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.83it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.04it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.22it/s]100%|██████████| 16/16 [00:04<00:00,  3.69it/s]
2025-03-13 17:48:45,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:45
2025-03-13 17:49:26,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5437 secs
2025-03-13 17:49:26,673 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:49:26,673 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 17:49:50,584 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9112 secs
2025-03-13 17:49:50,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7976 secs
2025-03-13 17:49:50,587 [INFO]: {
2025-03-13 17:49:50,587 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:50,587 [INFO]: 	index_param: efSearch=156
2025-03-13 17:49:50,587 [INFO]: 	index_path: knn.index
2025-03-13 17:49:50,587 [INFO]: 	size in bytes: 760218730
2025-03-13 17:49:50,587 [INFO]: 	avg_search_speed_ms: 7.515486855325954
2025-03-13 17:49:50,587 [INFO]: 	99p_search_speed_ms: 11.632060259580616
2025-03-13 17:49:50,587 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:50,587 [INFO]: 	nb vectors: 3864
2025-03-13 17:49:50,587 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:50,587 [INFO]: 	compression ratio: 0.9993088594383882
2025-03-13 17:49:50,587 [INFO]: }
2025-03-13 17:49:50,587 [INFO]: 	>>> Finished "Creating the index" in 69.7994 secs
2025-03-13 17:49:50,587 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8276 secs
2025-03-13 17:49:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 24551 [episode count 11/20]
[retrieval_preprocessing] for episode 3124 [episode count 12/20], we have num_retrieval=np.int64(3818) num_query=np.int64(188)
2025-03-13 17:49:52,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:54,376 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:54
2025-03-13 17:49:54,376 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.41it/s]
2025-03-13 17:49:54,402 [INFO]: There are 3818 embeddings of dim 49152
2025-03-13 17:49:54,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:49:54,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:54
2025-03-13 17:49:54,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:54,403 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:49:54,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:54,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:49:54,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:54
2025-03-13 17:49:54,403 [INFO]: 787.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:54,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:54,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:54
2025-03-13 17:49:54,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:54,404 [INFO]: 	Creating the index 03/13/2025, 17:49:54
2025-03-13 17:49:54,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:54
2025-03-13 17:49:54,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:49:54,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:54
2025-03-13 17:49:54,405 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:49:54,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.54it/s] 31%|███▏      | 5/16 [00:00<00:00, 19.33it/s] 44%|████▍     | 7/16 [00:00<00:00, 17.25it/s] 56%|█████▋    | 9/16 [00:00<00:00, 16.73it/s] 69%|██████▉   | 11/16 [00:00<00:00, 16.66it/s] 81%|████████▏ | 13/16 [00:00<00:00, 15.82it/s] 94%|█████████▍| 15/16 [00:00<00:00, 16.06it/s]100%|██████████| 16/16 [00:03<00:00,  4.66it/s]
2025-03-13 17:49:57,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:57
2025-03-13 17:50:34,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3874 secs
2025-03-13 17:50:34,233 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:50:34,233 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.74it/s] 50%|█████     | 2/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 17:50:55,697 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4642 secs
2025-03-13 17:50:55,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2953 secs
2025-03-13 17:50:55,700 [INFO]: {
2025-03-13 17:50:55,700 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:55,700 [INFO]: 	index_param: efSearch=223
2025-03-13 17:50:55,700 [INFO]: 	index_path: knn.index
2025-03-13 17:50:55,700 [INFO]: 	size in bytes: 751168330
2025-03-13 17:50:55,700 [INFO]: 	avg_search_speed_ms: 10.770300485692974
2025-03-13 17:50:55,700 [INFO]: 	99p_search_speed_ms: 16.3932575751096
2025-03-13 17:50:55,700 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:55,701 [INFO]: 	nb vectors: 3818
2025-03-13 17:50:55,701 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:55,701 [INFO]: 	compression ratio: 0.9993090949401447
2025-03-13 17:50:55,701 [INFO]: }
2025-03-13 17:50:55,701 [INFO]: 	>>> Finished "Creating the index" in 61.2970 secs
2025-03-13 17:50:55,701 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3245 secs
2025-03-13 17:50:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 3124 [episode count 12/20]
[retrieval_preprocessing] for episode 91497 [episode count 13/20], we have num_retrieval=np.int64(3844) num_query=np.int64(162)
2025-03-13 17:50:58,523 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:59,594 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:59
2025-03-13 17:50:59,594 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2133.42it/s]
2025-03-13 17:50:59,618 [INFO]: There are 3844 embeddings of dim 49152
2025-03-13 17:50:59,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 17:50:59,619 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:59
2025-03-13 17:50:59,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:59,619 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:50:59,619 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:59,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:59,619 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:59
2025-03-13 17:50:59,619 [INFO]: 793.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:59,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:50:59,619 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:59
2025-03-13 17:50:59,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:59,619 [INFO]: 	Creating the index 03/13/2025, 17:50:59
2025-03-13 17:50:59,619 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:59
2025-03-13 17:50:59,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:50:59,620 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:59
2025-03-13 17:50:59,620 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:50:59,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  3.87it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.95it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.73it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.01it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.27it/s] 69%|██████▉   | 11/16 [00:01<00:00, 12.31it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.29it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.19it/s]100%|██████████| 16/16 [00:03<00:00,  4.25it/s]
2025-03-13 17:51:03,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:03
2025-03-13 17:51:44,189 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8015 secs
2025-03-13 17:51:44,189 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 17:51:44,189 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 17:52:16,326 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1371 secs
2025-03-13 17:52:16,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7099 secs
2025-03-13 17:52:16,331 [INFO]: {
2025-03-13 17:52:16,331 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:16,331 [INFO]: 	index_param: efSearch=239
2025-03-13 17:52:16,331 [INFO]: 	index_path: knn.index
2025-03-13 17:52:16,331 [INFO]: 	size in bytes: 756283810
2025-03-13 17:52:16,331 [INFO]: 	avg_search_speed_ms: 11.441027323848434
2025-03-13 17:52:16,331 [INFO]: 	99p_search_speed_ms: 17.685019564814866
2025-03-13 17:52:16,331 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:16,331 [INFO]: 	nb vectors: 3844
2025-03-13 17:52:16,331 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:16,331 [INFO]: 	compression ratio: 0.9993089128802056
2025-03-13 17:52:16,331 [INFO]: }
2025-03-13 17:52:16,331 [INFO]: 	>>> Finished "Creating the index" in 76.7113 secs
2025-03-13 17:52:16,331 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7364 secs
2025-03-13 17:52:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91497 [episode count 13/20]
[retrieval_preprocessing] for episode 73123 [episode count 14/20], we have num_retrieval=np.int64(3841) num_query=np.int64(165)
2025-03-13 17:52:20,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:21,609 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:21
2025-03-13 17:52:21,610 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.18it/s]
2025-03-13 17:52:21,637 [INFO]: There are 3841 embeddings of dim 49152
2025-03-13 17:52:21,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:52:21,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:21
2025-03-13 17:52:21,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:21,637 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:52:21,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:21,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:21,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:21
2025-03-13 17:52:21,637 [INFO]: 792.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:21,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:52:21,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:21
2025-03-13 17:52:21,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:21,637 [INFO]: 	Creating the index 03/13/2025, 17:52:21
2025-03-13 17:52:21,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:21
2025-03-13 17:52:21,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:52:21,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:21
2025-03-13 17:52:21,639 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:52:21,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.93it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.76it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.10it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.36it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.12it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.36it/s] 50%|█████     | 8/16 [00:00<00:00,  8.56it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.60it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.71it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.65it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.62it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.69it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.83it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.01it/s]100%|██████████| 16/16 [00:05<00:00,  1.31s/it]100%|██████████| 16/16 [00:05<00:00,  2.72it/s]
2025-03-13 17:52:27,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:27
2025-03-13 17:53:14,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3447 secs
2025-03-13 17:53:14,859 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 17:53:14,859 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 17:53:34,887 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0287 secs
2025-03-13 17:53:34,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2518 secs
2025-03-13 17:53:34,891 [INFO]: {
2025-03-13 17:53:34,891 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:34,891 [INFO]: 	index_param: efSearch=242
2025-03-13 17:53:34,891 [INFO]: 	index_path: knn.index
2025-03-13 17:53:34,891 [INFO]: 	size in bytes: 755693590
2025-03-13 17:53:34,891 [INFO]: 	avg_search_speed_ms: 10.329583818516271
2025-03-13 17:53:34,891 [INFO]: 	99p_search_speed_ms: 13.716121306642897
2025-03-13 17:53:34,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:34,891 [INFO]: 	nb vectors: 3841
2025-03-13 17:53:34,891 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:34,891 [INFO]: 	compression ratio: 0.9993088971417635
2025-03-13 17:53:34,891 [INFO]: }
2025-03-13 17:53:34,891 [INFO]: 	>>> Finished "Creating the index" in 73.2533 secs
2025-03-13 17:53:34,891 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2812 secs
2025-03-13 17:53:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 73123 [episode count 14/20]
[retrieval_preprocessing] for episode 54396 [episode count 15/20], we have num_retrieval=np.int64(3860) num_query=np.int64(146)
2025-03-13 17:53:37,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:38,337 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:38
2025-03-13 17:53:38,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.97it/s]
2025-03-13 17:53:38,364 [INFO]: There are 3860 embeddings of dim 49152
2025-03-13 17:53:38,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:53:38,365 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:38
2025-03-13 17:53:38,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:38,366 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:53:38,366 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:38,366 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:53:38,366 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:38
2025-03-13 17:53:38,367 [INFO]: 796.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:38,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:53:38,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:38
2025-03-13 17:53:38,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:38,368 [INFO]: 	Creating the index 03/13/2025, 17:53:38
2025-03-13 17:53:38,368 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:38
2025-03-13 17:53:38,372 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:53:38,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:38
2025-03-13 17:53:38,372 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:53:38,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.51it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.61it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.48it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.87it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.21it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.51it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.44it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.30it/s]100%|██████████| 16/16 [00:04<00:00,  3.64it/s]
2025-03-13 17:53:42,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:42
2025-03-13 17:54:21,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3188 secs
2025-03-13 17:54:21,090 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 17:54:21,090 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 17:54:54,432 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3426 secs
2025-03-13 17:54:54,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0631 secs
2025-03-13 17:54:54,436 [INFO]: {
2025-03-13 17:54:54,436 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:54,436 [INFO]: 	index_param: efSearch=256
2025-03-13 17:54:54,436 [INFO]: 	index_path: knn.index
2025-03-13 17:54:54,436 [INFO]: 	size in bytes: 759431710
2025-03-13 17:54:54,436 [INFO]: 	avg_search_speed_ms: 9.47539443856379
2025-03-13 17:54:54,436 [INFO]: 	99p_search_speed_ms: 13.820044668391349
2025-03-13 17:54:54,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:54,436 [INFO]: 	nb vectors: 3860
2025-03-13 17:54:54,436 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:54,436 [INFO]: 	compression ratio: 0.9993089174535522
2025-03-13 17:54:54,436 [INFO]: }
2025-03-13 17:54:54,436 [INFO]: 	>>> Finished "Creating the index" in 76.0676 secs
2025-03-13 17:54:54,436 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0990 secs
2025-03-13 17:55:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 54396 [episode count 15/20]
[retrieval_preprocessing] for episode 94343 [episode count 16/20], we have num_retrieval=np.int64(3885) num_query=np.int64(121)
2025-03-13 17:55:03,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:04,302 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:04
2025-03-13 17:55:04,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-13 17:55:04,329 [INFO]: There are 3885 embeddings of dim 49152
2025-03-13 17:55:04,329 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:55:04,329 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:04
2025-03-13 17:55:04,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:04,330 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:55:04,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:04,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:04,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:04
2025-03-13 17:55:04,330 [INFO]: 801.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:04,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:55:04,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:04
2025-03-13 17:55:04,330 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:04,330 [INFO]: 	Creating the index 03/13/2025, 17:55:04
2025-03-13 17:55:04,330 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:04
2025-03-13 17:55:04,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:55:04,331 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:04
2025-03-13 17:55:04,331 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:55:04,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.40it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.80it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.60it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.40it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.34it/s] 50%|█████     | 8/16 [00:00<00:00,  9.19it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.23it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.99it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.76it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.56it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.54it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.45it/s]100%|██████████| 16/16 [00:04<00:00,  1.09it/s]100%|██████████| 16/16 [00:04<00:00,  3.45it/s]
2025-03-13 17:55:08,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:08
2025-03-13 17:55:48,629 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6625 secs
2025-03-13 17:55:48,629 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 17:55:48,629 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 17:56:16,081 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4512 secs
2025-03-13 17:56:16,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7530 secs
2025-03-13 17:56:16,085 [INFO]: {
2025-03-13 17:56:16,085 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:16,085 [INFO]: 	index_param: efSearch=258
2025-03-13 17:56:16,085 [INFO]: 	index_path: knn.index
2025-03-13 17:56:16,085 [INFO]: 	size in bytes: 764350390
2025-03-13 17:56:16,085 [INFO]: 	avg_search_speed_ms: 13.857533606388438
2025-03-13 17:56:16,085 [INFO]: 	99p_search_speed_ms: 25.148394515272216
2025-03-13 17:56:16,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:16,085 [INFO]: 	nb vectors: 3885
2025-03-13 17:56:16,085 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:16,085 [INFO]: 	compression ratio: 0.9993088117610563
2025-03-13 17:56:16,085 [INFO]: }
2025-03-13 17:56:16,085 [INFO]: 	>>> Finished "Creating the index" in 71.7548 secs
2025-03-13 17:56:16,085 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7824 secs
2025-03-13 17:56:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 94343 [episode count 16/20]
[retrieval_preprocessing] for episode 21642 [episode count 17/20], we have num_retrieval=np.int64(3806) num_query=np.int64(200)
2025-03-13 17:56:18,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:19,839 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:19
2025-03-13 17:56:19,839 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 880.60it/s]
2025-03-13 17:56:19,866 [INFO]: There are 3806 embeddings of dim 49152
2025-03-13 17:56:19,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:56:19,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:19
2025-03-13 17:56:19,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:19,867 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:56:19,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:19,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:56:19,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:19
2025-03-13 17:56:19,867 [INFO]: 785.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:19,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:56:19,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:19
2025-03-13 17:56:19,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:19,867 [INFO]: 	Creating the index 03/13/2025, 17:56:19
2025-03-13 17:56:19,867 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:19
2025-03-13 17:56:19,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:56:19,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:19
2025-03-13 17:56:19,868 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:56:19,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.49it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.41it/s] 20%|██        | 3/15 [00:00<00:01,  8.30it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.82it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.15it/s] 53%|█████▎    | 8/15 [00:00<00:00, 14.58it/s] 80%|████████  | 12/15 [00:00<00:00, 20.23it/s]100%|██████████| 15/15 [00:04<00:00,  2.30it/s]100%|██████████| 15/15 [00:04<00:00,  3.59it/s]
2025-03-13 17:56:24,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:24
2025-03-13 17:57:07,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8759 secs
2025-03-13 17:57:07,937 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 17:57:07,937 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 17:57:46,356 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4197 secs
2025-03-13 17:57:46,360 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4914 secs
2025-03-13 17:57:46,360 [INFO]: {
2025-03-13 17:57:46,360 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:46,360 [INFO]: 	index_param: efSearch=279
2025-03-13 17:57:46,360 [INFO]: 	index_path: knn.index
2025-03-13 17:57:46,360 [INFO]: 	size in bytes: 748807390
2025-03-13 17:57:46,360 [INFO]: 	avg_search_speed_ms: 15.154782070947642
2025-03-13 17:57:46,360 [INFO]: 	99p_search_speed_ms: 24.855958025436845
2025-03-13 17:57:46,360 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:46,360 [INFO]: 	nb vectors: 3806
2025-03-13 17:57:46,360 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:46,360 [INFO]: 	compression ratio: 0.9993091120535015
2025-03-13 17:57:46,360 [INFO]: }
2025-03-13 17:57:46,360 [INFO]: 	>>> Finished "Creating the index" in 86.4932 secs
2025-03-13 17:57:46,360 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5212 secs
2025-03-13 17:57:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 21642 [episode count 17/20]
[retrieval_preprocessing] for episode 6104 [episode count 18/20], we have num_retrieval=np.int64(3711) num_query=np.int64(295)
2025-03-13 17:57:49,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:49,937 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:49
2025-03-13 17:57:49,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1323.54it/s]
2025-03-13 17:57:49,968 [INFO]: There are 3711 embeddings of dim 49152
2025-03-13 17:57:49,968 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 17:57:49,968 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,968 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:49,968 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:57:49,968 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:49,968 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:49,968 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,969 [INFO]: 765.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:49,969 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:49,969 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:49
2025-03-13 17:57:49,969 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:49,969 [INFO]: 	Creating the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,970 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:49
2025-03-13 17:57:49,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:57:49,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,971 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:57:49,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.83it/s] 20%|██        | 3/15 [00:00<00:01,  8.65it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.92it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.19it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.41it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.07it/s] 60%|██████    | 9/15 [00:01<00:00,  8.65it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.34it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.23it/s] 80%|████████  | 12/15 [00:01<00:00,  8.36it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.53it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.57it/s]100%|██████████| 15/15 [00:05<00:00,  1.35s/it]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]
2025-03-13 17:57:55,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:55
2025-03-13 17:58:38,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1420 secs
2025-03-13 17:58:38,027 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:58:38,027 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-13 17:59:11,194 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1668 secs
2025-03-13 17:59:11,198 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2264 secs
2025-03-13 17:59:11,198 [INFO]: {
2025-03-13 17:59:11,198 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:11,198 [INFO]: 	index_param: efSearch=235
2025-03-13 17:59:11,198 [INFO]: 	index_path: knn.index
2025-03-13 17:59:11,198 [INFO]: 	size in bytes: 730116430
2025-03-13 17:59:11,198 [INFO]: 	avg_search_speed_ms: 10.575708360696728
2025-03-13 17:59:11,198 [INFO]: 	99p_search_speed_ms: 18.699365167412896
2025-03-13 17:59:11,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:11,198 [INFO]: 	nb vectors: 3711
2025-03-13 17:59:11,198 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:11,198 [INFO]: 	compression ratio: 0.9993095046498269
2025-03-13 17:59:11,198 [INFO]: }
2025-03-13 17:59:11,198 [INFO]: 	>>> Finished "Creating the index" in 81.2283 secs
2025-03-13 17:59:11,198 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2612 secs
2025-03-13 17:59:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 6104 [episode count 18/20]
[retrieval_preprocessing] for episode 33004 [episode count 19/20], we have num_retrieval=np.int64(3865) num_query=np.int64(141)
2025-03-13 17:59:16,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:17,574 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:17
2025-03-13 17:59:17,574 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.27it/s]
2025-03-13 17:59:17,602 [INFO]: There are 3865 embeddings of dim 49152
2025-03-13 17:59:17,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 17:59:17,603 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:17
2025-03-13 17:59:17,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:17,603 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:59:17,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:17,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:59:17,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:17
2025-03-13 17:59:17,603 [INFO]: 797.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:17,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:17,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:17
2025-03-13 17:59:17,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:17,603 [INFO]: 	Creating the index 03/13/2025, 17:59:17
2025-03-13 17:59:17,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:17
2025-03-13 17:59:17,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:59:17,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:17
2025-03-13 17:59:17,605 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:59:17,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.74it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.61it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.55it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.81it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.93it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.92it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.81it/s]100%|██████████| 16/16 [00:04<00:00,  3.72it/s]
2025-03-13 17:59:21,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:21
2025-03-13 18:00:09,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4696 secs
2025-03-13 18:00:09,384 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:00:09,384 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 18:00:33,331 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9463 secs
2025-03-13 18:00:33,334 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.7293 secs
2025-03-13 18:00:33,334 [INFO]: {
2025-03-13 18:00:33,334 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:33,334 [INFO]: 	index_param: efSearch=221
2025-03-13 18:00:33,334 [INFO]: 	index_path: knn.index
2025-03-13 18:00:33,334 [INFO]: 	size in bytes: 760415470
2025-03-13 18:00:33,334 [INFO]: 	avg_search_speed_ms: 10.493810246097548
2025-03-13 18:00:33,334 [INFO]: 	99p_search_speed_ms: 13.418213734403253
2025-03-13 18:00:33,334 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:33,334 [INFO]: 	nb vectors: 3865
2025-03-13 18:00:33,334 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:33,334 [INFO]: 	compression ratio: 0.999308864665786
2025-03-13 18:00:33,334 [INFO]: }
2025-03-13 18:00:33,335 [INFO]: 	>>> Finished "Creating the index" in 75.7312 secs
2025-03-13 18:00:33,335 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7603 secs
2025-03-13 18:00:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 33004 [episode count 19/20]
2025-03-13 18:00:34: [retrieval_preprocessing] finished for 4045730075_Pour contents of lunchbox onto towel [chosen_id count 7/196]
2025-03-13 18:00:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4045730075_Put lid on pot/pan [chosen_id count 8/196]
2025-03-13 18:00:39: [retrieval_preprocessing] we have num_total=5459 embedding_dim=49152
[retrieval_preprocessing] for episode 45609 [episode count 0/20], we have num_retrieval=np.int64(5249) num_query=np.int64(210)
2025-03-13 18:00:41,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:41,991 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:41
2025-03-13 18:00:41,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 18:00:42,014 [INFO]: There are 5249 embeddings of dim 49152
2025-03-13 18:00:42,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:00:42,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:42
2025-03-13 18:00:42,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:42,015 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:00:42,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:42,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:42,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:42
2025-03-13 18:00:42,015 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:42,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:00:42,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:42
2025-03-13 18:00:42,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:42,015 [INFO]: 	Creating the index 03/13/2025, 18:00:42
2025-03-13 18:00:42,015 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:42
2025-03-13 18:00:42,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:42,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:42
2025-03-13 18:00:42,016 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:00:42,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.89it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.17it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.07it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.55it/s] 41%|████      | 9/22 [00:00<00:01, 10.73it/s] 50%|█████     | 11/22 [00:01<00:00, 11.07it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.41it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.54it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.63it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.73it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.63it/s]100%|██████████| 22/22 [00:06<00:00,  1.51it/s]100%|██████████| 22/22 [00:06<00:00,  3.54it/s]
2025-03-13 18:00:48,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:48
2025-03-13 18:01:34,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3012 secs
2025-03-13 18:01:34,538 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 18:01:34,538 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 18:02:12,030 [INFO]: 	>>> Finished "Compute fast metrics" in 37.4919 secs
2025-03-13 18:02:12,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.0140 secs
2025-03-13 18:02:12,030 [INFO]: {
2025-03-13 18:02:12,030 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:12,030 [INFO]: 	index_param: efSearch=277
2025-03-13 18:02:12,030 [INFO]: 	index_path: knn.index
2025-03-13 18:02:12,030 [INFO]: 	size in bytes: 1032709810
2025-03-13 18:02:12,030 [INFO]: 	avg_search_speed_ms: 11.37114436688452
2025-03-13 18:02:12,030 [INFO]: 	99p_search_speed_ms: 15.95177671173588
2025-03-13 18:02:12,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:12,030 [INFO]: 	nb vectors: 5249
2025-03-13 18:02:12,030 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:12,030 [INFO]: 	compression ratio: 0.9993082103093414
2025-03-13 18:02:12,030 [INFO]: }
2025-03-13 18:02:12,030 [INFO]: 	>>> Finished "Creating the index" in 90.0153 secs
2025-03-13 18:02:12,030 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0398 secs
2025-03-13 18:02:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 45609 [episode count 0/20]
[retrieval_preprocessing] for episode 92205 [episode count 1/20], we have num_retrieval=np.int64(5218) num_query=np.int64(241)
2025-03-13 18:02:16,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:17,050 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:17
2025-03-13 18:02:17,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-13 18:02:17,076 [INFO]: There are 5218 embeddings of dim 49152
2025-03-13 18:02:17,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:02:17,076 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:17
2025-03-13 18:02:17,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:17,076 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:02:17,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:17,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:17,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:17
2025-03-13 18:02:17,076 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:17,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:17,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:17
2025-03-13 18:02:17,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:17,077 [INFO]: 	Creating the index 03/13/2025, 18:02:17
2025-03-13 18:02:17,077 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:17
2025-03-13 18:02:17,078 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:02:17,078 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:17
2025-03-13 18:02:17,078 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:02:17,078 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.63it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.61it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.78it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.47it/s] 41%|████      | 9/22 [00:00<00:01, 11.52it/s] 50%|█████     | 11/22 [00:01<00:00, 11.46it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.51it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.61it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.43it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.34it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.66it/s]100%|██████████| 22/22 [00:06<00:00,  1.58it/s]100%|██████████| 22/22 [00:06<00:00,  3.66it/s]
2025-03-13 18:02:23,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:23
2025-03-13 18:03:07,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1138 secs
2025-03-13 18:03:07,207 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 18:03:07,207 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:03:28,356 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1484 secs
2025-03-13 18:03:28,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2784 secs
2025-03-13 18:03:28,356 [INFO]: {
2025-03-13 18:03:28,356 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:28,356 [INFO]: 	index_param: efSearch=162
2025-03-13 18:03:28,356 [INFO]: 	index_path: knn.index
2025-03-13 18:03:28,356 [INFO]: 	size in bytes: 1026610570
2025-03-13 18:03:28,356 [INFO]: 	avg_search_speed_ms: 8.535612150263216
2025-03-13 18:03:28,357 [INFO]: 	99p_search_speed_ms: 13.820123719051479
2025-03-13 18:03:28,357 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:28,357 [INFO]: 	nb vectors: 5218
2025-03-13 18:03:28,357 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:28,357 [INFO]: 	compression ratio: 0.9993083784438339
2025-03-13 18:03:28,357 [INFO]: }
2025-03-13 18:03:28,357 [INFO]: 	>>> Finished "Creating the index" in 71.2800 secs
2025-03-13 18:03:28,357 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3060 secs
2025-03-13 18:03:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 92205 [episode count 1/20]
[retrieval_preprocessing] for episode 1116 [episode count 2/20], we have num_retrieval=np.int64(5214) num_query=np.int64(245)
2025-03-13 18:03:33,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:34,376 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:34
2025-03-13 18:03:34,376 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-13 18:03:34,403 [INFO]: There are 5214 embeddings of dim 49152
2025-03-13 18:03:34,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:03:34,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:34
2025-03-13 18:03:34,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:34,403 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:03:34,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:34,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:34,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:34
2025-03-13 18:03:34,404 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:34,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:03:34,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:34
2025-03-13 18:03:34,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:34,404 [INFO]: 	Creating the index 03/13/2025, 18:03:34
2025-03-13 18:03:34,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:34
2025-03-13 18:03:34,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:03:34,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:34
2025-03-13 18:03:34,405 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:03:34,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.64it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.24it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.26it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.71it/s] 41%|████      | 9/22 [00:00<00:01, 11.08it/s] 50%|█████     | 11/22 [00:01<00:00, 11.31it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.53it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.10it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.22it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.32it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.44it/s]100%|██████████| 22/22 [00:06<00:00,  1.40it/s]100%|██████████| 22/22 [00:06<00:00,  3.29it/s]
2025-03-13 18:03:41,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:41
2025-03-13 18:04:36,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3494 secs
2025-03-13 18:04:36,446 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:04:36,446 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 18:04:57,802 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3565 secs
2025-03-13 18:04:57,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3986 secs
2025-03-13 18:04:57,804 [INFO]: {
2025-03-13 18:04:57,804 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:57,804 [INFO]: 	index_param: efSearch=231
2025-03-13 18:04:57,804 [INFO]: 	index_path: knn.index
2025-03-13 18:04:57,804 [INFO]: 	size in bytes: 1025823610
2025-03-13 18:04:57,804 [INFO]: 	avg_search_speed_ms: 10.50846534487674
2025-03-13 18:04:57,804 [INFO]: 	99p_search_speed_ms: 17.84121482167394
2025-03-13 18:04:57,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:57,804 [INFO]: 	nb vectors: 5214
2025-03-13 18:04:57,804 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:57,804 [INFO]: 	compression ratio: 0.9993083625751215
2025-03-13 18:04:57,804 [INFO]: }
2025-03-13 18:04:57,804 [INFO]: 	>>> Finished "Creating the index" in 83.4001 secs
2025-03-13 18:04:57,804 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4278 secs
2025-03-13 18:04:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 1116 [episode count 2/20]
[retrieval_preprocessing] for episode 23665 [episode count 3/20], we have num_retrieval=np.int64(5185) num_query=np.int64(274)
2025-03-13 18:05:02,073 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:03,186 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:03
2025-03-13 18:05:03,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1949.03it/s]
2025-03-13 18:05:03,210 [INFO]: There are 5185 embeddings of dim 49152
2025-03-13 18:05:03,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:05:03,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:03
2025-03-13 18:05:03,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:03,211 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:05:03,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:03,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:03,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:03
2025-03-13 18:05:03,211 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:03,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:05:03,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:03
2025-03-13 18:05:03,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:03,211 [INFO]: 	Creating the index 03/13/2025, 18:05:03
2025-03-13 18:05:03,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:03
2025-03-13 18:05:03,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:05:03,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:03
2025-03-13 18:05:03,213 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:05:03,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.65it/s]  9%|▉         | 2/22 [00:00<00:03,  6.19it/s] 14%|█▎        | 3/22 [00:00<00:02,  6.84it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.22it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.51it/s] 27%|██▋       | 6/22 [00:00<00:02,  7.78it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.13it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.28it/s] 41%|████      | 9/22 [00:01<00:01,  8.40it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.55it/s] 50%|█████     | 11/22 [00:01<00:01,  8.65it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.71it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.84it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.90it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.98it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.98it/s] 77%|███████▋  | 17/22 [00:02<00:00,  9.00it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.16it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.09it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.05it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.21s/it]100%|██████████| 22/22 [00:07<00:00,  1.13s/it]100%|██████████| 22/22 [00:07<00:00,  3.09it/s]
2025-03-13 18:05:10,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:10
2025-03-13 18:05:58,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3826 secs
2025-03-13 18:05:58,708 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:05:58,708 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 18:06:38,038 [INFO]: 	>>> Finished "Compute fast metrics" in 39.3297 secs
2025-03-13 18:06:38,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.4555 secs
2025-03-13 18:06:38,669 [INFO]: {
2025-03-13 18:06:38,669 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:38,669 [INFO]: 	index_param: efSearch=231
2025-03-13 18:06:38,669 [INFO]: 	index_path: knn.index
2025-03-13 18:06:38,669 [INFO]: 	size in bytes: 1020118030
2025-03-13 18:06:38,669 [INFO]: 	avg_search_speed_ms: 10.360442255647767
2025-03-13 18:06:38,669 [INFO]: 	99p_search_speed_ms: 14.617491560056806
2025-03-13 18:06:38,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:38,669 [INFO]: 	nb vectors: 5185
2025-03-13 18:06:38,669 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:38,669 [INFO]: 	compression ratio: 0.9993083643468198
2025-03-13 18:06:38,669 [INFO]: }
2025-03-13 18:06:38,669 [INFO]: 	>>> Finished "Creating the index" in 95.4578 secs
2025-03-13 18:06:38,669 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4832 secs
2025-03-13 18:06:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 23665 [episode count 3/20]
[retrieval_preprocessing] for episode 15474 [episode count 4/20], we have num_retrieval=np.int64(5131) num_query=np.int64(328)
2025-03-13 18:06:43,592 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:44,386 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:44
2025-03-13 18:06:44,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.02it/s]
2025-03-13 18:06:44,418 [INFO]: There are 5131 embeddings of dim 49152
2025-03-13 18:06:44,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 18:06:44,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:44
2025-03-13 18:06:44,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:44,419 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:06:44,420 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:44,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:06:44,420 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:44
2025-03-13 18:06:44,420 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:44,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:06:44,420 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:44
2025-03-13 18:06:44,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:44,421 [INFO]: 	Creating the index 03/13/2025, 18:06:44
2025-03-13 18:06:44,421 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:44
2025-03-13 18:06:44,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:06:44,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:44
2025-03-13 18:06:44,425 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:06:44,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.72it/s]  9%|▉         | 2/22 [00:00<00:03,  6.13it/s] 14%|█▎        | 3/22 [00:00<00:02,  6.81it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.22it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.46it/s] 27%|██▋       | 6/22 [00:00<00:02,  7.65it/s] 32%|███▏      | 7/22 [00:00<00:01,  7.70it/s] 36%|███▋      | 8/22 [00:01<00:01,  7.85it/s] 41%|████      | 9/22 [00:01<00:01,  8.02it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.32it/s] 50%|█████     | 11/22 [00:01<00:01,  8.45it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.51it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.64it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.56it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.51it/s] 73%|███████▎  | 16/22 [00:02<00:00,  8.48it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.41it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.47it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.61it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.69it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.30s/it]100%|██████████| 22/22 [00:07<00:00,  1.16s/it]100%|██████████| 22/22 [00:07<00:00,  2.99it/s]
2025-03-13 18:06:52,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:52
2025-03-13 18:07:46,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8082 secs
2025-03-13 18:07:46,258 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 18:07:46,258 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 18:08:20,040 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7817 secs
2025-03-13 18:08:20,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.6166 secs
2025-03-13 18:08:20,041 [INFO]: {
2025-03-13 18:08:20,041 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:20,041 [INFO]: 	index_param: efSearch=195
2025-03-13 18:08:20,041 [INFO]: 	index_path: knn.index
2025-03-13 18:08:20,041 [INFO]: 	size in bytes: 1009493770
2025-03-13 18:08:20,041 [INFO]: 	avg_search_speed_ms: 9.430871117104477
2025-03-13 18:08:20,041 [INFO]: 	99p_search_speed_ms: 15.961510532069955
2025-03-13 18:08:20,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:20,041 [INFO]: 	nb vectors: 5131
2025-03-13 18:08:20,041 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:20,041 [INFO]: 	compression ratio: 0.9993084434785566
2025-03-13 18:08:20,041 [INFO]: }
2025-03-13 18:08:20,041 [INFO]: 	>>> Finished "Creating the index" in 95.6205 secs
2025-03-13 18:08:20,041 [INFO]: >>> Finished "Launching the whole pipeline" in 95.6551 secs
2025-03-13 18:08:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 15474 [episode count 4/20]
[retrieval_preprocessing] for episode 26289 [episode count 5/20], we have num_retrieval=np.int64(5067) num_query=np.int64(392)
2025-03-13 18:08:23,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:24,902 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:24
2025-03-13 18:08:24,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.88it/s]
2025-03-13 18:08:24,931 [INFO]: There are 5067 embeddings of dim 49152
2025-03-13 18:08:24,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:08:24,932 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:24
2025-03-13 18:08:24,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:24,933 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:08:24,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:24,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:08:24,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:24
2025-03-13 18:08:24,933 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:24,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:08:24,934 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:24
2025-03-13 18:08:24,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:24,934 [INFO]: 	Creating the index 03/13/2025, 18:08:24
2025-03-13 18:08:24,934 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:24
2025-03-13 18:08:24,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:08:24,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:24
2025-03-13 18:08:24,938 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:08:24,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.79it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.01it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.04it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.65it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.55it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.66it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.91it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.27it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.52it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.73it/s]100%|██████████| 20/20 [00:05<00:00,  3.58it/s]
2025-03-13 18:08:30,538 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:30
2025-03-13 18:09:23,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9338 secs
2025-03-13 18:09:23,473 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 18:09:23,473 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:09:56,671 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1982 secs
2025-03-13 18:09:56,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.7379 secs
2025-03-13 18:09:56,676 [INFO]: {
2025-03-13 18:09:56,676 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:56,676 [INFO]: 	index_param: efSearch=232
2025-03-13 18:09:56,676 [INFO]: 	index_path: knn.index
2025-03-13 18:09:56,676 [INFO]: 	size in bytes: 996902110
2025-03-13 18:09:56,676 [INFO]: 	avg_search_speed_ms: 10.842864039261096
2025-03-13 18:09:56,676 [INFO]: 	99p_search_speed_ms: 16.45374106010422
2025-03-13 18:09:56,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:56,676 [INFO]: 	nb vectors: 5067
2025-03-13 18:09:56,676 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:56,676 [INFO]: 	compression ratio: 0.9993084837587514
2025-03-13 18:09:56,676 [INFO]: }
2025-03-13 18:09:56,676 [INFO]: 	>>> Finished "Creating the index" in 91.7422 secs
2025-03-13 18:09:56,676 [INFO]: >>> Finished "Launching the whole pipeline" in 91.7737 secs
2025-03-13 18:09:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 26289 [episode count 5/20]
[retrieval_preprocessing] for episode 85172 [episode count 6/20], we have num_retrieval=np.int64(5208) num_query=np.int64(251)
2025-03-13 18:10:03,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:05,039 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:05
2025-03-13 18:10:05,039 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 18:10:05,064 [INFO]: There are 5208 embeddings of dim 49152
2025-03-13 18:10:05,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:10:05,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:05
2025-03-13 18:10:05,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:05,065 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:10:05,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:05,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:05,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:05
2025-03-13 18:10:05,065 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:05,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:10:05,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:05
2025-03-13 18:10:05,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:05,065 [INFO]: 	Creating the index 03/13/2025, 18:10:05
2025-03-13 18:10:05,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:05
2025-03-13 18:10:05,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:10:05,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:05
2025-03-13 18:10:05,066 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:10:05,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:06,  3.09it/s]  9%|▉         | 2/22 [00:00<00:03,  5.05it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.32it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.91it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.41it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.76it/s] 41%|████      | 9/22 [00:01<00:01,  9.26it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.39it/s] 50%|█████     | 11/22 [00:01<00:01,  9.49it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.53it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.65it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.63it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.68it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.10it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.22it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.27it/s]100%|██████████| 22/22 [00:07<00:00,  1.25it/s]100%|██████████| 22/22 [00:07<00:00,  3.14it/s]
2025-03-13 18:10:12,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:12
2025-03-13 18:11:01,165 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0797 secs
2025-03-13 18:11:01,165 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 18:11:01,166 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 18:11:42,004 [INFO]: 	>>> Finished "Compute fast metrics" in 40.8379 secs
2025-03-13 18:11:42,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.9377 secs
2025-03-13 18:11:42,004 [INFO]: {
2025-03-13 18:11:42,004 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:42,004 [INFO]: 	index_param: efSearch=269
2025-03-13 18:11:42,004 [INFO]: 	index_path: knn.index
2025-03-13 18:11:42,004 [INFO]: 	size in bytes: 1024643170
2025-03-13 18:11:42,004 [INFO]: 	avg_search_speed_ms: 10.611751115823564
2025-03-13 18:11:42,004 [INFO]: 	99p_search_speed_ms: 17.076261788606647
2025-03-13 18:11:42,004 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:42,004 [INFO]: 	nb vectors: 5208
2025-03-13 18:11:42,004 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:42,004 [INFO]: 	compression ratio: 0.9993083387263489
2025-03-13 18:11:42,004 [INFO]: }
2025-03-13 18:11:42,004 [INFO]: 	>>> Finished "Creating the index" in 96.9392 secs
2025-03-13 18:11:42,004 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9654 secs
2025-03-13 18:11:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 85172 [episode count 6/20]
[retrieval_preprocessing] for episode 4794 [episode count 7/20], we have num_retrieval=np.int64(5264) num_query=np.int64(195)
2025-03-13 18:11:51,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:52,384 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:52
2025-03-13 18:11:52,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.09it/s]
2025-03-13 18:11:52,410 [INFO]: There are 5264 embeddings of dim 49152
2025-03-13 18:11:52,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:11:52,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:52,411 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:11:52,411 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:52,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:11:52,411 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,411 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:52,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:52,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:52
2025-03-13 18:11:52,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:52,411 [INFO]: 	Creating the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,411 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:52
2025-03-13 18:11:52,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:11:52,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:52
2025-03-13 18:11:52,413 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:11:52,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.78it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.97it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.77it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.38it/s] 36%|███▋      | 8/22 [00:00<00:01, 10.31it/s] 45%|████▌     | 10/22 [00:00<00:01, 10.87it/s] 55%|█████▍    | 12/22 [00:01<00:00, 11.33it/s] 64%|██████▎   | 14/22 [00:01<00:00, 11.43it/s] 73%|███████▎  | 16/22 [00:01<00:00, 11.48it/s] 82%|████████▏ | 18/22 [00:01<00:00, 11.39it/s] 91%|█████████ | 20/22 [00:01<00:00, 11.36it/s]100%|██████████| 22/22 [00:07<00:00,  1.03it/s]100%|██████████| 22/22 [00:07<00:00,  2.84it/s]
2025-03-13 18:12:00,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:00
2025-03-13 18:13:08,259 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.0929 secs
2025-03-13 18:13:08,259 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 18:13:08,259 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 18:13:35,234 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9742 secs
2025-03-13 18:13:35,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.8211 secs
2025-03-13 18:13:35,234 [INFO]: {
2025-03-13 18:13:35,234 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:35,234 [INFO]: 	index_param: efSearch=129
2025-03-13 18:13:35,234 [INFO]: 	index_path: knn.index
2025-03-13 18:13:35,234 [INFO]: 	size in bytes: 1035660970
2025-03-13 18:13:35,234 [INFO]: 	avg_search_speed_ms: 7.872076767980759
2025-03-13 18:13:35,234 [INFO]: 	99p_search_speed_ms: 10.891098161228001
2025-03-13 18:13:35,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:35,234 [INFO]: 	nb vectors: 5264
2025-03-13 18:13:35,234 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:35,234 [INFO]: 	compression ratio: 0.9993082118369296
2025-03-13 18:13:35,234 [INFO]: }
2025-03-13 18:13:35,234 [INFO]: 	>>> Finished "Creating the index" in 102.8232 secs
2025-03-13 18:13:35,234 [INFO]: >>> Finished "Launching the whole pipeline" in 102.8500 secs
2025-03-13 18:13:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 4794 [episode count 7/20]
[retrieval_preprocessing] for episode 48373 [episode count 8/20], we have num_retrieval=np.int64(5097) num_query=np.int64(362)
2025-03-13 18:13:38,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:38,991 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:38
2025-03-13 18:13:38,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.56it/s]
2025-03-13 18:13:39,016 [INFO]: There are 5097 embeddings of dim 49152
2025-03-13 18:13:39,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:13:39,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:39
2025-03-13 18:13:39,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:39,017 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:13:39,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:39,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:39,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:39
2025-03-13 18:13:39,017 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:39,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:13:39,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:39
2025-03-13 18:13:39,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:39,017 [INFO]: 	Creating the index 03/13/2025, 18:13:39
2025-03-13 18:13:39,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:39
2025-03-13 18:13:39,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:13:39,018 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:39
2025-03-13 18:13:39,018 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:13:39,018 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.66it/s]  9%|▉         | 2/22 [00:00<00:03,  6.47it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.50it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.91it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.69it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.80it/s] 41%|████      | 9/22 [00:01<00:01,  9.58it/s] 50%|█████     | 11/22 [00:01<00:01,  9.90it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.11it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.12it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.21it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.32it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.67it/s]100%|██████████| 22/22 [00:06<00:00,  1.68it/s]100%|██████████| 22/22 [00:06<00:00,  3.66it/s]
2025-03-13 18:13:45,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:45
2025-03-13 18:14:48,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.0134 secs
2025-03-13 18:14:48,046 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 18:14:48,046 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.34it/s]
2025-03-13 18:15:30,872 [INFO]: 	>>> Finished "Compute fast metrics" in 42.8261 secs
2025-03-13 18:15:30,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.8547 secs
2025-03-13 18:15:30,873 [INFO]: {
2025-03-13 18:15:30,873 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:30,873 [INFO]: 	index_param: efSearch=159
2025-03-13 18:15:30,873 [INFO]: 	index_path: knn.index
2025-03-13 18:15:30,873 [INFO]: 	size in bytes: 1002804370
2025-03-13 18:15:30,873 [INFO]: 	avg_search_speed_ms: 9.106408005651554
2025-03-13 18:15:30,873 [INFO]: 	99p_search_speed_ms: 18.010386493988328
2025-03-13 18:15:30,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:30,873 [INFO]: 	nb vectors: 5097
2025-03-13 18:15:30,873 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:30,873 [INFO]: 	compression ratio: 0.9993085450953908
2025-03-13 18:15:30,873 [INFO]: }
2025-03-13 18:15:30,873 [INFO]: 	>>> Finished "Creating the index" in 111.8561 secs
2025-03-13 18:15:30,873 [INFO]: >>> Finished "Launching the whole pipeline" in 111.8821 secs
2025-03-13 18:15:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 48373 [episode count 8/20]
[retrieval_preprocessing] for episode 37606 [episode count 9/20], we have num_retrieval=np.int64(5191) num_query=np.int64(268)
2025-03-13 18:15:36,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:37,722 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:37
2025-03-13 18:15:37,723 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.72it/s]
2025-03-13 18:15:37,748 [INFO]: There are 5191 embeddings of dim 49152
2025-03-13 18:15:37,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:15:37,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:37
2025-03-13 18:15:37,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:37,749 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:15:37,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:37,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:37,749 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:37
2025-03-13 18:15:37,749 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:37,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:15:37,749 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:37
2025-03-13 18:15:37,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:37,749 [INFO]: 	Creating the index 03/13/2025, 18:15:37
2025-03-13 18:15:37,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:37
2025-03-13 18:15:37,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:15:37,750 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:37
2025-03-13 18:15:37,750 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:15:37,750 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.61it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.64it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.37it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.71it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.77it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.98it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.83it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.62it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.56it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.61it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.53it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.56it/s] 82%|████████▏ | 18/22 [00:01<00:00,  9.58it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.45it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.48it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.38s/it]100%|██████████| 22/22 [00:07<00:00,  1.28s/it]100%|██████████| 22/22 [00:07<00:00,  2.88it/s]
2025-03-13 18:15:45,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:45
2025-03-13 18:16:32,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9815 secs
2025-03-13 18:16:32,376 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 18:16:32,376 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 18:17:21,040 [INFO]: 	>>> Finished "Compute fast metrics" in 48.6638 secs
2025-03-13 18:17:21,449 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.6985 secs
2025-03-13 18:17:21,449 [INFO]: {
2025-03-13 18:17:21,449 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:21,449 [INFO]: 	index_param: efSearch=290
2025-03-13 18:17:21,449 [INFO]: 	index_path: knn.index
2025-03-13 18:17:21,450 [INFO]: 	size in bytes: 1021298530
2025-03-13 18:17:21,450 [INFO]: 	avg_search_speed_ms: 12.548358491043487
2025-03-13 18:17:21,450 [INFO]: 	99p_search_speed_ms: 22.202880736440402
2025-03-13 18:17:21,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:21,450 [INFO]: 	nb vectors: 5191
2025-03-13 18:17:21,450 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:21,450 [INFO]: 	compression ratio: 0.999308329563541
2025-03-13 18:17:21,450 [INFO]: }
2025-03-13 18:17:21,450 [INFO]: 	>>> Finished "Creating the index" in 103.7007 secs
2025-03-13 18:17:21,450 [INFO]: >>> Finished "Launching the whole pipeline" in 103.7275 secs
2025-03-13 18:17:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 37606 [episode count 9/20]
[retrieval_preprocessing] for episode 77083 [episode count 10/20], we have num_retrieval=np.int64(5059) num_query=np.int64(400)
2025-03-13 18:17:27,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:28,400 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:28
2025-03-13 18:17:28,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 18:17:28,428 [INFO]: There are 5059 embeddings of dim 49152
2025-03-13 18:17:28,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:17:28,428 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:28
2025-03-13 18:17:28,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:28,428 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:17:28,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:28,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:28,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:28
2025-03-13 18:17:28,429 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:28,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:28,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:28
2025-03-13 18:17:28,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:28,429 [INFO]: 	Creating the index 03/13/2025, 18:17:28
2025-03-13 18:17:28,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:28
2025-03-13 18:17:28,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:17:28,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:28
2025-03-13 18:17:28,430 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:17:28,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.73it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.94it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.74it/s] 30%|███       | 6/20 [00:00<00:01,  9.77it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.65it/s] 40%|████      | 8/20 [00:00<00:01,  9.51it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.48it/s] 50%|█████     | 10/20 [00:01<00:01,  7.82it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.80it/s] 60%|██████    | 12/20 [00:01<00:01,  7.67it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.56it/s] 70%|███████   | 14/20 [00:01<00:00,  7.60it/s] 75%|███████▌  | 15/20 [00:01<00:00,  7.69it/s] 80%|████████  | 16/20 [00:01<00:00,  7.84it/s] 85%|████████▌ | 17/20 [00:02<00:00,  7.89it/s] 90%|█████████ | 18/20 [00:02<00:00,  7.98it/s] 95%|█████████▌| 19/20 [00:02<00:00,  8.14it/s]100%|██████████| 20/20 [00:06<00:00,  1.25s/it]100%|██████████| 20/20 [00:06<00:00,  3.23it/s]
2025-03-13 18:17:34,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:34
2025-03-13 18:18:24,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7471 secs
2025-03-13 18:18:24,377 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:18:24,377 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 18:19:02,211 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8346 secs
2025-03-13 18:19:02,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.7856 secs
2025-03-13 18:19:02,216 [INFO]: {
2025-03-13 18:19:02,216 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:02,216 [INFO]: 	index_param: efSearch=209
2025-03-13 18:19:02,216 [INFO]: 	index_path: knn.index
2025-03-13 18:19:02,216 [INFO]: 	size in bytes: 995328190
2025-03-13 18:19:02,216 [INFO]: 	avg_search_speed_ms: 8.547416419133098
2025-03-13 18:19:02,216 [INFO]: 	99p_search_speed_ms: 15.9806241840124
2025-03-13 18:19:02,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:02,216 [INFO]: 	nb vectors: 5059
2025-03-13 18:19:02,216 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:02,216 [INFO]: 	compression ratio: 0.999308451215473
2025-03-13 18:19:02,216 [INFO]: }
2025-03-13 18:19:02,216 [INFO]: 	>>> Finished "Creating the index" in 93.7873 secs
2025-03-13 18:19:02,216 [INFO]: >>> Finished "Launching the whole pipeline" in 93.8164 secs
2025-03-13 18:19:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 77083 [episode count 10/20]
[retrieval_preprocessing] for episode 88896 [episode count 11/20], we have num_retrieval=np.int64(5206) num_query=np.int64(253)
2025-03-13 18:19:06,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:07,899 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:07
2025-03-13 18:19:07,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.83it/s]
2025-03-13 18:19:08,522 [INFO]: There are 5206 embeddings of dim 49152
2025-03-13 18:19:08,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6235 secs
2025-03-13 18:19:08,523 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:08,523 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:19:08,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:08,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:19:08,523 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,524 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:08,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:19:08,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:08
2025-03-13 18:19:08,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:08,524 [INFO]: 	Creating the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,524 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:08
2025-03-13 18:19:08,526 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:19:08,526 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,526 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:19:08,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.08it/s]  9%|▉         | 2/22 [00:00<00:02,  7.10it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.80it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.06it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.36it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.72it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.77it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.71it/s] 41%|████      | 9/22 [00:01<00:01,  8.45it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.29it/s] 50%|█████     | 11/22 [00:01<00:01,  8.18it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.08it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.09it/s] 64%|██████▎   | 14/22 [00:01<00:01,  7.97it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.00it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.43it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.64it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.54it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.66it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.56it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.22s/it]100%|██████████| 22/22 [00:07<00:00,  1.09s/it]100%|██████████| 22/22 [00:07<00:00,  3.13it/s]
2025-03-13 18:19:15,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:15
2025-03-13 18:20:01,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6013 secs
2025-03-13 18:20:01,151 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 18:20:01,151 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 18:20:30,397 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2465 secs
2025-03-13 18:20:30,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.8714 secs
2025-03-13 18:20:30,398 [INFO]: {
2025-03-13 18:20:30,398 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:30,398 [INFO]: 	index_param: efSearch=309
2025-03-13 18:20:30,398 [INFO]: 	index_path: knn.index
2025-03-13 18:20:30,398 [INFO]: 	size in bytes: 1024249690
2025-03-13 18:20:30,398 [INFO]: 	avg_search_speed_ms: 14.500277745874895
2025-03-13 18:20:30,398 [INFO]: 	99p_search_speed_ms: 23.79250806523487
2025-03-13 18:20:30,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:30,398 [INFO]: 	nb vectors: 5206
2025-03-13 18:20:30,398 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:30,398 [INFO]: 	compression ratio: 0.9993083307645424
2025-03-13 18:20:30,398 [INFO]: }
2025-03-13 18:20:30,398 [INFO]: 	>>> Finished "Creating the index" in 81.8739 secs
2025-03-13 18:20:30,398 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4990 secs
2025-03-13 18:20:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 88896 [episode count 11/20]
[retrieval_preprocessing] for episode 86905 [episode count 12/20], we have num_retrieval=np.int64(5232) num_query=np.int64(227)
2025-03-13 18:20:37,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:39,414 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:39
2025-03-13 18:20:39,414 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.36it/s]
2025-03-13 18:20:39,441 [INFO]: There are 5232 embeddings of dim 49152
2025-03-13 18:20:39,442 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:20:39,442 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:39
2025-03-13 18:20:39,442 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:39,442 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:20:39,442 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:39,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:39,442 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:39
2025-03-13 18:20:39,442 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:39,442 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:39,442 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:39
2025-03-13 18:20:39,442 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:39,442 [INFO]: 	Creating the index 03/13/2025, 18:20:39
2025-03-13 18:20:39,442 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:39
2025-03-13 18:20:39,443 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:20:39,444 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:39
2025-03-13 18:20:39,444 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:20:39,444 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.68it/s]  9%|▉         | 2/22 [00:00<00:03,  6.35it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.18it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.60it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.93it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.09it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.16it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.21it/s] 41%|████      | 9/22 [00:01<00:01,  8.20it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.19it/s] 50%|█████     | 11/22 [00:01<00:01,  8.34it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.41it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.78it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.80it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.65it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.64it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.48it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.37it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.15it/s]100%|██████████| 22/22 [00:07<00:00,  1.14it/s]100%|██████████| 22/22 [00:07<00:00,  3.04it/s]
2025-03-13 18:20:46,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:46
2025-03-13 18:21:35,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3223 secs
2025-03-13 18:21:35,000 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:21:35,000 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 18:22:13,952 [INFO]: 	>>> Finished "Compute fast metrics" in 38.9513 secs
2025-03-13 18:22:13,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5086 secs
2025-03-13 18:22:13,952 [INFO]: {
2025-03-13 18:22:13,952 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:13,952 [INFO]: 	index_param: efSearch=208
2025-03-13 18:22:13,952 [INFO]: 	index_path: knn.index
2025-03-13 18:22:13,952 [INFO]: 	size in bytes: 1029365110
2025-03-13 18:22:13,952 [INFO]: 	avg_search_speed_ms: 9.191960270768236
2025-03-13 18:22:13,952 [INFO]: 	99p_search_speed_ms: 18.307845427188962
2025-03-13 18:22:13,952 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:13,953 [INFO]: 	nb vectors: 5232
2025-03-13 18:22:13,953 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:13,953 [INFO]: 	compression ratio: 0.9993082590491142
2025-03-13 18:22:13,953 [INFO]: }
2025-03-13 18:22:13,953 [INFO]: 	>>> Finished "Creating the index" in 94.5103 secs
2025-03-13 18:22:13,953 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5389 secs
2025-03-13 18:22:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 86905 [episode count 12/20]
[retrieval_preprocessing] for episode 7555 [episode count 13/20], we have num_retrieval=np.int64(5157) num_query=np.int64(302)
2025-03-13 18:22:17,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:18,300 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:18
2025-03-13 18:22:18,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.92it/s]
2025-03-13 18:22:18,330 [INFO]: There are 5157 embeddings of dim 49152
2025-03-13 18:22:18,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 18:22:18,331 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:18
2025-03-13 18:22:18,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:18,331 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:22:18,331 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:18,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:22:18,332 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:18
2025-03-13 18:22:18,332 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:18,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:22:18,332 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:18
2025-03-13 18:22:18,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:18,332 [INFO]: 	Creating the index 03/13/2025, 18:22:18
2025-03-13 18:22:18,332 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:18
2025-03-13 18:22:18,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:22:18,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:18
2025-03-13 18:22:18,336 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:22:18,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.58it/s]  9%|▉         | 2/22 [00:00<00:02,  8.20it/s] 18%|█▊        | 4/22 [00:00<00:01, 11.90it/s] 27%|██▋       | 6/22 [00:00<00:01, 13.57it/s] 36%|███▋      | 8/22 [00:00<00:00, 14.64it/s] 45%|████▌     | 10/22 [00:00<00:00, 13.51it/s] 55%|█████▍    | 12/22 [00:00<00:00, 14.25it/s] 64%|██████▎   | 14/22 [00:01<00:00, 14.63it/s] 73%|███████▎  | 16/22 [00:01<00:00, 15.17it/s] 82%|████████▏ | 18/22 [00:01<00:00, 14.80it/s] 91%|█████████ | 20/22 [00:01<00:00, 15.07it/s]100%|██████████| 22/22 [00:05<00:00,  1.44it/s]100%|██████████| 22/22 [00:05<00:00,  3.89it/s]
2025-03-13 18:22:23,990 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:23
2025-03-13 18:23:18,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7962 secs
2025-03-13 18:23:18,787 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:23:18,787 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s]
2025-03-13 18:23:45,312 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5250 secs
2025-03-13 18:23:45,313 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.9769 secs
2025-03-13 18:23:45,313 [INFO]: {
2025-03-13 18:23:45,313 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:45,313 [INFO]: 	index_param: efSearch=221
2025-03-13 18:23:45,313 [INFO]: 	index_path: knn.index
2025-03-13 18:23:45,313 [INFO]: 	size in bytes: 1014609070
2025-03-13 18:23:45,313 [INFO]: 	avg_search_speed_ms: 9.445173148772872
2025-03-13 18:23:45,313 [INFO]: 	99p_search_speed_ms: 16.849947446025915
2025-03-13 18:23:45,313 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:45,313 [INFO]: 	nb vectors: 5157
2025-03-13 18:23:45,313 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:45,313 [INFO]: 	compression ratio: 0.9993084883422144
2025-03-13 18:23:45,313 [INFO]: }
2025-03-13 18:23:45,313 [INFO]: 	>>> Finished "Creating the index" in 86.9806 secs
2025-03-13 18:23:45,313 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0124 secs
2025-03-13 18:23:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 7555 [episode count 13/20]
[retrieval_preprocessing] for episode 12204 [episode count 14/20], we have num_retrieval=np.int64(5192) num_query=np.int64(267)
2025-03-13 18:23:49,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:50,436 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:50
2025-03-13 18:23:50,436 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.59it/s]
2025-03-13 18:23:50,462 [INFO]: There are 5192 embeddings of dim 49152
2025-03-13 18:23:50,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:23:50,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:50
2025-03-13 18:23:50,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:50,462 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:23:50,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:50,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:50,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:50
2025-03-13 18:23:50,463 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:50,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:23:50,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:50
2025-03-13 18:23:50,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:50,463 [INFO]: 	Creating the index 03/13/2025, 18:23:50
2025-03-13 18:23:50,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:50
2025-03-13 18:23:50,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:23:50,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:50
2025-03-13 18:23:50,464 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:23:50,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.97it/s] 18%|█▊        | 4/22 [00:00<00:01, 15.36it/s] 27%|██▋       | 6/22 [00:00<00:02,  6.31it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.17it/s] 45%|████▌     | 10/22 [00:01<00:02,  5.94it/s] 50%|█████     | 11/22 [00:01<00:02,  4.35it/s] 55%|█████▍    | 12/22 [00:02<00:02,  4.37it/s] 64%|██████▎   | 14/22 [00:02<00:01,  6.05it/s] 73%|███████▎  | 16/22 [00:02<00:00,  7.68it/s] 82%|████████▏ | 18/22 [00:02<00:00,  6.46it/s] 86%|████████▋ | 19/22 [00:02<00:00,  6.66it/s] 91%|█████████ | 20/22 [00:03<00:00,  6.95it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.04it/s]100%|██████████| 22/22 [00:07<00:00,  1.00it/s]100%|██████████| 22/22 [00:07<00:00,  2.82it/s]
2025-03-13 18:23:58,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:58
2025-03-13 18:24:43,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8624 secs
2025-03-13 18:24:43,140 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:24:43,140 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.47it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 18:25:10,556 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4154 secs
2025-03-13 18:25:10,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.0924 secs
2025-03-13 18:25:10,557 [INFO]: {
2025-03-13 18:25:10,557 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:10,557 [INFO]: 	index_param: efSearch=268
2025-03-13 18:25:10,557 [INFO]: 	index_path: knn.index
2025-03-13 18:25:10,557 [INFO]: 	size in bytes: 1021495270
2025-03-13 18:25:10,557 [INFO]: 	avg_search_speed_ms: 11.46073144394371
2025-03-13 18:25:10,557 [INFO]: 	99p_search_speed_ms: 21.128390394151182
2025-03-13 18:25:10,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:10,557 [INFO]: 	nb vectors: 5192
2025-03-13 18:25:10,557 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:10,557 [INFO]: 	compression ratio: 0.9993083335569435
2025-03-13 18:25:10,557 [INFO]: }
2025-03-13 18:25:10,557 [INFO]: 	>>> Finished "Creating the index" in 80.0939 secs
2025-03-13 18:25:10,557 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1209 secs
2025-03-13 18:25:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 12204 [episode count 14/20]
[retrieval_preprocessing] for episode 58799 [episode count 15/20], we have num_retrieval=np.int64(5199) num_query=np.int64(260)
2025-03-13 18:25:14,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:15,612 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:15
2025-03-13 18:25:15,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.31it/s]
2025-03-13 18:25:15,640 [INFO]: There are 5199 embeddings of dim 49152
2025-03-13 18:25:15,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:25:15,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:15
2025-03-13 18:25:15,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:15,641 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:25:15,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:15,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:25:15,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:15
2025-03-13 18:25:15,642 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:15,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:25:15,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:15
2025-03-13 18:25:15,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:15,642 [INFO]: 	Creating the index 03/13/2025, 18:25:15
2025-03-13 18:25:15,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:15
2025-03-13 18:25:15,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:25:15,644 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:15
2025-03-13 18:25:15,645 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:25:15,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.82it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.51it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.57it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.03it/s] 41%|████      | 9/22 [00:00<00:01, 11.38it/s] 50%|█████     | 11/22 [00:01<00:00, 11.45it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.61it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.76it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.90it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.09it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.68it/s]100%|██████████| 22/22 [00:06<00:00,  1.56it/s]100%|██████████| 22/22 [00:06<00:00,  3.65it/s]
2025-03-13 18:25:21,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:21
2025-03-13 18:26:05,661 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9913 secs
2025-03-13 18:26:05,661 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 18:26:05,661 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 18:26:41,728 [INFO]: 	>>> Finished "Compute fast metrics" in 36.0672 secs
2025-03-13 18:26:41,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.0843 secs
2025-03-13 18:26:41,729 [INFO]: {
2025-03-13 18:26:41,729 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:41,729 [INFO]: 	index_param: efSearch=282
2025-03-13 18:26:41,729 [INFO]: 	index_path: knn.index
2025-03-13 18:26:41,729 [INFO]: 	size in bytes: 1022872450
2025-03-13 18:26:41,729 [INFO]: 	avg_search_speed_ms: 12.165708830489475
2025-03-13 18:26:41,729 [INFO]: 	99p_search_speed_ms: 19.180135983042415
2025-03-13 18:26:41,729 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:41,729 [INFO]: 	nb vectors: 5199
2025-03-13 18:26:41,729 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:41,729 [INFO]: 	compression ratio: 0.999308361467747
2025-03-13 18:26:41,729 [INFO]: }
2025-03-13 18:26:41,729 [INFO]: 	>>> Finished "Creating the index" in 86.0870 secs
2025-03-13 18:26:41,729 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1166 secs
2025-03-13 18:26:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 58799 [episode count 15/20]
[retrieval_preprocessing] for episode 72625 [episode count 16/20], we have num_retrieval=np.int64(5213) num_query=np.int64(246)
2025-03-13 18:26:47,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:48,548 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:48
2025-03-13 18:26:48,548 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.23it/s]
2025-03-13 18:26:48,574 [INFO]: There are 5213 embeddings of dim 49152
2025-03-13 18:26:48,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:26:48,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:48,574 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:26:48,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:48,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:48,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,574 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:48,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:48,575 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:48
2025-03-13 18:26:48,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:48,575 [INFO]: 	Creating the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,575 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:48
2025-03-13 18:26:48,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:26:48,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,576 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:26:48,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.53it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.63it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.59it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.10it/s] 41%|████      | 9/22 [00:00<00:01, 10.45it/s] 50%|█████     | 11/22 [00:01<00:01, 10.50it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.47it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.58it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.27it/s] 77%|███████▋  | 17/22 [00:01<00:00,  8.43it/s] 82%|████████▏ | 18/22 [00:01<00:00,  8.13it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.17it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.10it/s] 95%|█████████▌| 21/22 [00:07<00:01,  1.64s/it]100%|██████████| 22/22 [00:09<00:00,  1.50s/it]100%|██████████| 22/22 [00:09<00:00,  2.43it/s]
2025-03-13 18:26:57,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:57
2025-03-13 18:27:45,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8025 secs
2025-03-13 18:27:45,428 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 18:27:45,428 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s]
2025-03-13 18:28:08,179 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7510 secs
2025-03-13 18:28:08,180 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.6037 secs
2025-03-13 18:28:08,180 [INFO]: {
2025-03-13 18:28:08,180 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:08,180 [INFO]: 	index_param: efSearch=190
2025-03-13 18:28:08,180 [INFO]: 	index_path: knn.index
2025-03-13 18:28:08,180 [INFO]: 	size in bytes: 1025626870
2025-03-13 18:28:08,180 [INFO]: 	avg_search_speed_ms: 9.328991662295632
2025-03-13 18:28:08,180 [INFO]: 	99p_search_speed_ms: 16.929746912792297
2025-03-13 18:28:08,180 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:08,180 [INFO]: 	nb vectors: 5213
2025-03-13 18:28:08,180 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:08,180 [INFO]: 	compression ratio: 0.9993083586041384
2025-03-13 18:28:08,180 [INFO]: }
2025-03-13 18:28:08,180 [INFO]: 	>>> Finished "Creating the index" in 79.6054 secs
2025-03-13 18:28:08,180 [INFO]: >>> Finished "Launching the whole pipeline" in 79.6316 secs
2025-03-13 18:28:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 72625 [episode count 16/20]
[retrieval_preprocessing] for episode 51649 [episode count 17/20], we have num_retrieval=np.int64(5166) num_query=np.int64(293)
2025-03-13 18:28:11,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:12,602 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:12
2025-03-13 18:28:12,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.57it/s]
2025-03-13 18:28:12,628 [INFO]: There are 5166 embeddings of dim 49152
2025-03-13 18:28:12,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:28:12,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:12
2025-03-13 18:28:12,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:12,628 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:28:12,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:12,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:12,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:12
2025-03-13 18:28:12,628 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:12,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:28:12,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:12
2025-03-13 18:28:12,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:12,629 [INFO]: 	Creating the index 03/13/2025, 18:28:12
2025-03-13 18:28:12,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:12
2025-03-13 18:28:12,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:28:12,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:12
2025-03-13 18:28:12,630 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:28:12,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.16it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.89it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.10it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.78it/s] 41%|████      | 9/22 [00:00<00:01, 11.19it/s] 50%|█████     | 11/22 [00:01<00:00, 11.21it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.64it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.09it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.15it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.06it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.47it/s]100%|██████████| 22/22 [00:06<00:00,  1.29it/s]100%|██████████| 22/22 [00:06<00:00,  3.17it/s]
2025-03-13 18:28:19,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:19
2025-03-13 18:29:06,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6279 secs
2025-03-13 18:29:06,208 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 18:29:06,208 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 18:29:45,822 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6138 secs
2025-03-13 18:29:45,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.1941 secs
2025-03-13 18:29:45,824 [INFO]: {
2025-03-13 18:29:45,824 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:45,824 [INFO]: 	index_param: efSearch=283
2025-03-13 18:29:45,824 [INFO]: 	index_path: knn.index
2025-03-13 18:29:45,824 [INFO]: 	size in bytes: 1016379790
2025-03-13 18:29:45,824 [INFO]: 	avg_search_speed_ms: 13.267225832295473
2025-03-13 18:29:45,824 [INFO]: 	99p_search_speed_ms: 22.863432683516308
2025-03-13 18:29:45,824 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:45,824 [INFO]: 	nb vectors: 5166
2025-03-13 18:29:45,824 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:45,824 [INFO]: 	compression ratio: 0.9993084651948855
2025-03-13 18:29:45,824 [INFO]: }
2025-03-13 18:29:45,824 [INFO]: 	>>> Finished "Creating the index" in 93.1957 secs
2025-03-13 18:29:45,824 [INFO]: >>> Finished "Launching the whole pipeline" in 93.2224 secs
2025-03-13 18:29:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 51649 [episode count 17/20]
[retrieval_preprocessing] for episode 50646 [episode count 18/20], we have num_retrieval=np.int64(5282) num_query=np.int64(177)
2025-03-13 18:29:51,742 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:52,710 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:52
2025-03-13 18:29:52,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.98it/s]
2025-03-13 18:29:52,737 [INFO]: There are 5282 embeddings of dim 49152
2025-03-13 18:29:52,737 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:29:52,737 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:52
2025-03-13 18:29:52,737 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:52,737 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:29:52,737 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:52,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:52,737 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:52
2025-03-13 18:29:52,737 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:52,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:29:52,737 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:52
2025-03-13 18:29:52,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:52,738 [INFO]: 	Creating the index 03/13/2025, 18:29:52
2025-03-13 18:29:52,738 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:52
2025-03-13 18:29:52,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:29:52,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:52
2025-03-13 18:29:52,739 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:29:52,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.32it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.59it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.40it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.67it/s] 41%|████      | 9/22 [00:00<00:01, 10.96it/s] 50%|█████     | 11/22 [00:01<00:01, 10.68it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.12it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.71it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.02it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.30it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.53it/s]100%|██████████| 22/22 [00:06<00:00,  1.41it/s]100%|██████████| 22/22 [00:06<00:00,  3.33it/s]
2025-03-13 18:29:59,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:59
2025-03-13 18:30:52,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9419 secs
2025-03-13 18:30:52,290 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:30:52,290 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-13 18:31:22,161 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8710 secs
2025-03-13 18:31:22,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.4225 secs
2025-03-13 18:31:22,161 [INFO]: {
2025-03-13 18:31:22,161 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:22,161 [INFO]: 	index_param: efSearch=261
2025-03-13 18:31:22,161 [INFO]: 	index_path: knn.index
2025-03-13 18:31:22,161 [INFO]: 	size in bytes: 1039202290
2025-03-13 18:31:22,161 [INFO]: 	avg_search_speed_ms: 10.22578846255664
2025-03-13 18:31:22,161 [INFO]: 	99p_search_speed_ms: 16.08945917338133
2025-03-13 18:31:22,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:22,161 [INFO]: 	nb vectors: 5282
2025-03-13 18:31:22,161 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:22,161 [INFO]: 	compression ratio: 0.9993082828945652
2025-03-13 18:31:22,161 [INFO]: }
2025-03-13 18:31:22,161 [INFO]: 	>>> Finished "Creating the index" in 89.4238 secs
2025-03-13 18:31:22,161 [INFO]: >>> Finished "Launching the whole pipeline" in 89.4510 secs
2025-03-13 18:31:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 50646 [episode count 18/20]
[retrieval_preprocessing] for episode 36703 [episode count 19/20], we have num_retrieval=np.int64(5191) num_query=np.int64(268)
2025-03-13 18:31:26,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:27,177 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:27
2025-03-13 18:31:27,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.09it/s]
2025-03-13 18:31:27,203 [INFO]: There are 5191 embeddings of dim 49152
2025-03-13 18:31:27,204 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:31:27,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:27
2025-03-13 18:31:27,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:27,204 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:31:27,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:27,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:27,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:27
2025-03-13 18:31:27,204 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:27,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:31:27,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:27
2025-03-13 18:31:27,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:27,204 [INFO]: 	Creating the index 03/13/2025, 18:31:27
2025-03-13 18:31:27,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:27
2025-03-13 18:31:27,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:31:27,206 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:27
2025-03-13 18:31:27,206 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:31:27,206 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.35it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.57it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.68it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.04it/s] 41%|████      | 9/22 [00:00<00:01, 11.32it/s] 50%|█████     | 11/22 [00:01<00:00, 11.45it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.46it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.53it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.19it/s] 86%|████████▋ | 19/22 [00:01<00:00, 10.23it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.55it/s]100%|██████████| 22/22 [00:06<00:00,  1.40it/s]100%|██████████| 22/22 [00:06<00:00,  3.34it/s]
2025-03-13 18:31:33,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:33
2025-03-13 18:32:21,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5898 secs
2025-03-13 18:32:21,380 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:32:21,380 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 18:32:55,843 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4633 secs
2025-03-13 18:32:55,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.6380 secs
2025-03-13 18:32:55,844 [INFO]: {
2025-03-13 18:32:55,844 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:55,844 [INFO]: 	index_param: efSearch=212
2025-03-13 18:32:55,844 [INFO]: 	index_path: knn.index
2025-03-13 18:32:55,844 [INFO]: 	size in bytes: 1021298530
2025-03-13 18:32:55,844 [INFO]: 	avg_search_speed_ms: 9.649852670867467
2025-03-13 18:32:55,844 [INFO]: 	99p_search_speed_ms: 13.93245373852551
2025-03-13 18:32:55,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:55,844 [INFO]: 	nb vectors: 5191
2025-03-13 18:32:55,844 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:55,844 [INFO]: 	compression ratio: 0.999308329563541
2025-03-13 18:32:55,844 [INFO]: }
2025-03-13 18:32:55,844 [INFO]: 	>>> Finished "Creating the index" in 88.6396 secs
2025-03-13 18:32:55,844 [INFO]: >>> Finished "Launching the whole pipeline" in 88.6672 secs
2025-03-13 18:32:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 36703 [episode count 19/20]
2025-03-13 18:32:58: [retrieval_preprocessing] finished for 4045730075_Put lid on pot/pan [chosen_id count 8/196]
2025-03-13 18:33:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4068510503_purple_object_to_plate [chosen_id count 9/196]
2025-03-13 18:33:00: [retrieval_preprocessing] we have num_total=3033 embedding_dim=49152
[retrieval_preprocessing] for episode 66051 [episode count 0/20], we have num_retrieval=np.int64(2864) num_query=np.int64(169)
2025-03-13 18:33:01,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:02,166 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:02
2025-03-13 18:33:02,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.25it/s]
2025-03-13 18:33:02,202 [INFO]: There are 2864 embeddings of dim 49152
2025-03-13 18:33:02,202 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 18:33:02,202 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:02
2025-03-13 18:33:02,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:02,202 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:33:02,202 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:02,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:33:02,203 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:02
2025-03-13 18:33:02,203 [INFO]: 591.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:02,203 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:33:02,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:02
2025-03-13 18:33:02,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:02,204 [INFO]: 	Creating the index 03/13/2025, 18:33:02
2025-03-13 18:33:02,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:02
2025-03-13 18:33:02,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:33:02,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:02
2025-03-13 18:33:02,208 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:33:02,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.83it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.89it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.56it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.78it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.97it/s] 50%|█████     | 6/12 [00:00<00:00,  7.90it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.97it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.06it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.97it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.69it/s]100%|██████████| 12/12 [00:03<00:00,  1.27it/s]100%|██████████| 12/12 [00:03<00:00,  3.25it/s]
2025-03-13 18:33:05,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:05
2025-03-13 18:33:42,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0681 secs
2025-03-13 18:33:42,974 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 18:33:42,974 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.01it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 18:34:07,438 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4643 secs
2025-03-13 18:34:07,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2328 secs
2025-03-13 18:34:07,441 [INFO]: {
2025-03-13 18:34:07,441 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:07,441 [INFO]: 	index_param: efSearch=264
2025-03-13 18:34:07,441 [INFO]: 	index_path: knn.index
2025-03-13 18:34:07,441 [INFO]: 	size in bytes: 563474290
2025-03-13 18:34:07,441 [INFO]: 	avg_search_speed_ms: 11.803938490766944
2025-03-13 18:34:07,441 [INFO]: 	99p_search_speed_ms: 17.00723697431385
2025-03-13 18:34:07,441 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:07,441 [INFO]: 	nb vectors: 2864
2025-03-13 18:34:07,441 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:07,441 [INFO]: 	compression ratio: 0.999309679240201
2025-03-13 18:34:07,441 [INFO]: }
2025-03-13 18:34:07,441 [INFO]: 	>>> Finished "Creating the index" in 65.2371 secs
2025-03-13 18:34:07,441 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2754 secs
2025-03-13 18:34:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 66051 [episode count 0/20]
[retrieval_preprocessing] for episode 66587 [episode count 1/20], we have num_retrieval=np.int64(2913) num_query=np.int64(120)
2025-03-13 18:34:10,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:11,383 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:11
2025-03-13 18:34:11,383 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1902.18it/s]
2025-03-13 18:34:11,409 [INFO]: There are 2913 embeddings of dim 49152
2025-03-13 18:34:11,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:34:11,409 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:11
2025-03-13 18:34:11,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:11,409 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:34:11,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:11,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:11,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:11
2025-03-13 18:34:11,410 [INFO]: 601.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:11,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:34:11,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:11
2025-03-13 18:34:11,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:11,410 [INFO]: 	Creating the index 03/13/2025, 18:34:11
2025-03-13 18:34:11,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:11
2025-03-13 18:34:11,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:34:11,411 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:11
2025-03-13 18:34:11,411 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:34:11,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.58it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.31it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.79it/s] 50%|█████     | 6/12 [00:00<00:00,  9.60it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.83it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.94it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.89it/s]100%|██████████| 12/12 [00:03<00:00,  1.37it/s]100%|██████████| 12/12 [00:04<00:00,  3.00it/s]
2025-03-13 18:34:15,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:15
2025-03-13 18:34:50,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2359 secs
2025-03-13 18:34:50,652 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:34:50,652 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-13 18:35:12,741 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0894 secs
2025-03-13 18:35:12,982 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5701 secs
2025-03-13 18:35:12,982 [INFO]: {
2025-03-13 18:35:12,982 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:12,982 [INFO]: 	index_param: efSearch=211
2025-03-13 18:35:12,982 [INFO]: 	index_path: knn.index
2025-03-13 18:35:12,982 [INFO]: 	size in bytes: 573114610
2025-03-13 18:35:12,982 [INFO]: 	avg_search_speed_ms: 10.232225730595777
2025-03-13 18:35:12,982 [INFO]: 	99p_search_speed_ms: 16.799655584618453
2025-03-13 18:35:12,982 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:12,982 [INFO]: 	nb vectors: 2913
2025-03-13 18:35:12,982 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:12,982 [INFO]: 	compression ratio: 0.9993099006846118
2025-03-13 18:35:12,983 [INFO]: }
2025-03-13 18:35:12,983 [INFO]: 	>>> Finished "Creating the index" in 61.5727 secs
2025-03-13 18:35:12,983 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5995 secs
2025-03-13 18:35:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 66587 [episode count 1/20]
[retrieval_preprocessing] for episode 58968 [episode count 2/20], we have num_retrieval=np.int64(2875) num_query=np.int64(158)
2025-03-13 18:35:14,851 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:15,268 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:15
2025-03-13 18:35:15,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.81it/s]
2025-03-13 18:35:15,294 [INFO]: There are 2875 embeddings of dim 49152
2025-03-13 18:35:15,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:35:15,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:15
2025-03-13 18:35:15,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:15,295 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:35:15,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:15,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:35:15,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:15
2025-03-13 18:35:15,295 [INFO]: 593.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:15,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:35:15,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:15
2025-03-13 18:35:15,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:15,295 [INFO]: 	Creating the index 03/13/2025, 18:35:15
2025-03-13 18:35:15,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:15
2025-03-13 18:35:15,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:35:15,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:15
2025-03-13 18:35:15,296 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:35:15,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.25it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.71it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.45it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.79it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.97it/s] 50%|█████     | 6/12 [00:00<00:00,  8.08it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.11it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.23it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.26it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.25it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.25it/s]100%|██████████| 12/12 [00:03<00:00,  1.31it/s]100%|██████████| 12/12 [00:03<00:00,  3.30it/s]
2025-03-13 18:35:18,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:18
2025-03-13 18:36:00,022 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0916 secs
2025-03-13 18:36:00,023 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:36:00,023 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-13 18:36:22,965 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9421 secs
2025-03-13 18:36:22,968 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6718 secs
2025-03-13 18:36:22,968 [INFO]: {
2025-03-13 18:36:22,968 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:22,968 [INFO]: 	index_param: efSearch=207
2025-03-13 18:36:22,968 [INFO]: 	index_path: knn.index
2025-03-13 18:36:22,968 [INFO]: 	size in bytes: 565638430
2025-03-13 18:36:22,968 [INFO]: 	avg_search_speed_ms: 10.660632388608684
2025-03-13 18:36:22,968 [INFO]: 	99p_search_speed_ms: 21.11283343518153
2025-03-13 18:36:22,968 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:22,968 [INFO]: 	nb vectors: 2875
2025-03-13 18:36:22,968 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:22,968 [INFO]: 	compression ratio: 0.9993097534055456
2025-03-13 18:36:22,968 [INFO]: }
2025-03-13 18:36:22,968 [INFO]: 	>>> Finished "Creating the index" in 67.6732 secs
2025-03-13 18:36:22,968 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6998 secs
2025-03-13 18:36:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 58968 [episode count 2/20]
[retrieval_preprocessing] for episode 50777 [episode count 3/20], we have num_retrieval=np.int64(2850) num_query=np.int64(183)
2025-03-13 18:36:25,364 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:25,776 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:25
2025-03-13 18:36:25,776 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.43it/s]
2025-03-13 18:36:25,801 [INFO]: There are 2850 embeddings of dim 49152
2025-03-13 18:36:25,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:36:25,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:25
2025-03-13 18:36:25,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:25,801 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:36:25,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:25,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:25,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:25
2025-03-13 18:36:25,801 [INFO]: 588.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:25,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:36:25,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:25
2025-03-13 18:36:25,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:25,801 [INFO]: 	Creating the index 03/13/2025, 18:36:25
2025-03-13 18:36:25,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:25
2025-03-13 18:36:25,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:36:25,803 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:25
2025-03-13 18:36:25,803 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:36:25,803 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.47it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.04it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.91it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.23it/s] 50%|█████     | 6/12 [00:00<00:00,  9.42it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.88it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.21it/s]100%|██████████| 12/12 [00:03<00:00,  2.20it/s]100%|██████████| 12/12 [00:03<00:00,  3.68it/s]
2025-03-13 18:36:29,063 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:29
2025-03-13 18:37:05,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7759 secs
2025-03-13 18:37:05,839 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:37:05,839 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.01it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 18:37:26,632 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7929 secs
2025-03-13 18:37:26,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8321 secs
2025-03-13 18:37:26,635 [INFO]: {
2025-03-13 18:37:26,635 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:26,635 [INFO]: 	index_param: efSearch=209
2025-03-13 18:37:26,635 [INFO]: 	index_path: knn.index
2025-03-13 18:37:26,635 [INFO]: 	size in bytes: 560719870
2025-03-13 18:37:26,635 [INFO]: 	avg_search_speed_ms: 11.245710204572273
2025-03-13 18:37:26,635 [INFO]: 	99p_search_speed_ms: 19.284434039145708
2025-03-13 18:37:26,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:26,635 [INFO]: 	nb vectors: 2850
2025-03-13 18:37:26,635 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:26,635 [INFO]: 	compression ratio: 0.9993096909513837
2025-03-13 18:37:26,635 [INFO]: }
2025-03-13 18:37:26,635 [INFO]: 	>>> Finished "Creating the index" in 60.8338 secs
2025-03-13 18:37:26,635 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8593 secs
2025-03-13 18:37:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 50777 [episode count 3/20]
[retrieval_preprocessing] for episode 22638 [episode count 4/20], we have num_retrieval=np.int64(2887) num_query=np.int64(146)
2025-03-13 18:37:29,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:30,166 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:30
2025-03-13 18:37:30,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.29it/s]
2025-03-13 18:37:30,195 [INFO]: There are 2887 embeddings of dim 49152
2025-03-13 18:37:30,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 18:37:30,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:30,195 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:37:30,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:30,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:30,195 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,196 [INFO]: 595.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:30,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:37:30,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:30
2025-03-13 18:37:30,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:30,196 [INFO]: 	Creating the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:30
2025-03-13 18:37:30,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:37:30,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,198 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:37:30,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.56it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.11it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.53it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.36it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.18it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.62it/s]100%|██████████| 12/12 [00:03<00:00,  3.69it/s]
2025-03-13 18:37:33,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:33
2025-03-13 18:38:09,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5993 secs
2025-03-13 18:38:09,055 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 18:38:09,055 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 18:38:44,856 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8015 secs
2025-03-13 18:38:44,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6609 secs
2025-03-13 18:38:44,859 [INFO]: {
2025-03-13 18:38:44,859 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:44,859 [INFO]: 	index_param: efSearch=302
2025-03-13 18:38:44,859 [INFO]: 	index_path: knn.index
2025-03-13 18:38:44,859 [INFO]: 	size in bytes: 567999370
2025-03-13 18:38:44,859 [INFO]: 	avg_search_speed_ms: 12.018810087913433
2025-03-13 18:38:44,859 [INFO]: 	99p_search_speed_ms: 17.57909952197223
2025-03-13 18:38:44,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:44,859 [INFO]: 	nb vectors: 2887
2025-03-13 18:38:44,859 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:44,859 [INFO]: 	compression ratio: 0.999309728107621
2025-03-13 18:38:44,859 [INFO]: }
2025-03-13 18:38:44,859 [INFO]: 	>>> Finished "Creating the index" in 74.6624 secs
2025-03-13 18:38:44,859 [INFO]: >>> Finished "Launching the whole pipeline" in 74.6930 secs
2025-03-13 18:38:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 22638 [episode count 4/20]
[retrieval_preprocessing] for episode 15472 [episode count 5/20], we have num_retrieval=np.int64(2865) num_query=np.int64(168)
2025-03-13 18:38:47,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:48,842 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:48
2025-03-13 18:38:48,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.42it/s]
2025-03-13 18:38:48,870 [INFO]: There are 2865 embeddings of dim 49152
2025-03-13 18:38:48,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:38:48,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:48
2025-03-13 18:38:48,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:48,871 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:38:48,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:48,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:38:48,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:48
2025-03-13 18:38:48,872 [INFO]: 591.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:48,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:38:48,872 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:48
2025-03-13 18:38:48,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:48,872 [INFO]: 	Creating the index 03/13/2025, 18:38:48
2025-03-13 18:38:48,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:48
2025-03-13 18:38:48,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:38:48,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:48
2025-03-13 18:38:48,876 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:38:48,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.97it/s] 25%|██▌       | 3/12 [00:00<00:00, 12.94it/s] 42%|████▏     | 5/12 [00:00<00:00, 14.91it/s] 58%|█████▊    | 7/12 [00:00<00:00, 15.29it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.78it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.82it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]
2025-03-13 18:38:51,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:51
2025-03-13 18:39:30,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2894 secs
2025-03-13 18:39:30,043 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 18:39:30,044 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 18:39:48,227 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1832 secs
2025-03-13 18:39:48,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7928 secs
2025-03-13 18:39:48,669 [INFO]: {
2025-03-13 18:39:48,669 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:48,669 [INFO]: 	index_param: efSearch=202
2025-03-13 18:39:48,669 [INFO]: 	index_path: knn.index
2025-03-13 18:39:48,669 [INFO]: 	size in bytes: 563671030
2025-03-13 18:39:48,669 [INFO]: 	avg_search_speed_ms: 10.490374429741058
2025-03-13 18:39:48,669 [INFO]: 	99p_search_speed_ms: 16.594129800796512
2025-03-13 18:39:48,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:48,669 [INFO]: 	nb vectors: 2865
2025-03-13 18:39:48,669 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:48,669 [INFO]: 	compression ratio: 0.999309686006038
2025-03-13 18:39:48,669 [INFO]: }
2025-03-13 18:39:48,670 [INFO]: 	>>> Finished "Creating the index" in 59.7972 secs
2025-03-13 18:39:48,670 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8279 secs
2025-03-13 18:39:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 15472 [episode count 5/20]
[retrieval_preprocessing] for episode 80506 [episode count 6/20], we have num_retrieval=np.int64(2878) num_query=np.int64(155)
2025-03-13 18:39:51,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:51,798 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:51
2025-03-13 18:39:51,798 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1748.36it/s]
2025-03-13 18:39:51,822 [INFO]: There are 2878 embeddings of dim 49152
2025-03-13 18:39:51,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:39:51,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:51
2025-03-13 18:39:51,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:51,823 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:39:51,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:51,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:39:51,823 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:51
2025-03-13 18:39:51,823 [INFO]: 593.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:51,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:39:51,823 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:51
2025-03-13 18:39:51,823 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:51,823 [INFO]: 	Creating the index 03/13/2025, 18:39:51
2025-03-13 18:39:51,823 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:51
2025-03-13 18:39:51,824 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:39:51,824 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:51
2025-03-13 18:39:51,824 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:39:51,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.03it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.64it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.63it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.30it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.60it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.76it/s]100%|██████████| 12/12 [00:03<00:00,  3.77it/s]
2025-03-13 18:39:55,006 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:55
2025-03-13 18:40:34,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4714 secs
2025-03-13 18:40:34,478 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 18:40:34,478 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-13 18:40:57,453 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9742 secs
2025-03-13 18:40:57,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6307 secs
2025-03-13 18:40:57,455 [INFO]: {
2025-03-13 18:40:57,455 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:57,455 [INFO]: 	index_param: efSearch=202
2025-03-13 18:40:57,455 [INFO]: 	index_path: knn.index
2025-03-13 18:40:57,455 [INFO]: 	size in bytes: 566228650
2025-03-13 18:40:57,455 [INFO]: 	avg_search_speed_ms: 8.741911383462952
2025-03-13 18:40:57,455 [INFO]: 	99p_search_speed_ms: 12.39633625606074
2025-03-13 18:40:57,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:57,455 [INFO]: 	nb vectors: 2878
2025-03-13 18:40:57,455 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:57,455 [INFO]: 	compression ratio: 0.9993097735340661
2025-03-13 18:40:57,455 [INFO]: }
2025-03-13 18:40:57,455 [INFO]: 	>>> Finished "Creating the index" in 65.6321 secs
2025-03-13 18:40:57,455 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6571 secs
2025-03-13 18:41:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 80506 [episode count 6/20]
[retrieval_preprocessing] for episode 93316 [episode count 7/20], we have num_retrieval=np.int64(2892) num_query=np.int64(141)
2025-03-13 18:41:01,541 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:01,932 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:01
2025-03-13 18:41:01,932 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1844.46it/s]
2025-03-13 18:41:01,955 [INFO]: There are 2892 embeddings of dim 49152
2025-03-13 18:41:01,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:41:01,956 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:01
2025-03-13 18:41:01,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:01,956 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:41:01,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:01,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:01,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:01
2025-03-13 18:41:01,956 [INFO]: 596.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:01,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:41:01,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:01
2025-03-13 18:41:01,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:01,956 [INFO]: 	Creating the index 03/13/2025, 18:41:01
2025-03-13 18:41:01,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:01
2025-03-13 18:41:01,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:41:01,957 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:01
2025-03-13 18:41:01,957 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:41:01,957 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.01it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.47it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.68it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.15it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.38it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.60it/s]100%|██████████| 12/12 [00:03<00:00,  3.74it/s]
2025-03-13 18:41:05,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:05
2025-03-13 18:41:45,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4469 secs
2025-03-13 18:41:45,613 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:41:45,613 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 50%|█████     | 2/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 18:42:11,100 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4872 secs
2025-03-13 18:42:11,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1460 secs
2025-03-13 18:42:11,103 [INFO]: {
2025-03-13 18:42:11,103 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:11,103 [INFO]: 	index_param: efSearch=212
2025-03-13 18:42:11,103 [INFO]: 	index_path: knn.index
2025-03-13 18:42:11,103 [INFO]: 	size in bytes: 568983070
2025-03-13 18:42:11,103 [INFO]: 	avg_search_speed_ms: 10.235504200539056
2025-03-13 18:42:11,103 [INFO]: 	99p_search_speed_ms: 14.53712274320424
2025-03-13 18:42:11,103 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:11,103 [INFO]: 	nb vectors: 2892
2025-03-13 18:42:11,103 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:11,103 [INFO]: 	compression ratio: 0.99930976153649
2025-03-13 18:42:11,103 [INFO]: }
2025-03-13 18:42:11,104 [INFO]: 	>>> Finished "Creating the index" in 69.1475 secs
2025-03-13 18:42:11,104 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1718 secs
2025-03-13 18:42:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 93316 [episode count 7/20]
[retrieval_preprocessing] for episode 10388 [episode count 8/20], we have num_retrieval=np.int64(2892) num_query=np.int64(141)
2025-03-13 18:42:13,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:14,327 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:14
2025-03-13 18:42:14,327 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.96it/s]
2025-03-13 18:42:14,355 [INFO]: There are 2892 embeddings of dim 49152
2025-03-13 18:42:14,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:42:14,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:14,355 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:42:14,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:14,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:14,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,355 [INFO]: 596.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:14,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:42:14,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:14
2025-03-13 18:42:14,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:14,355 [INFO]: 	Creating the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:14
2025-03-13 18:42:14,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:42:14,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,357 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:42:14,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.83it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.23it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.48it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.04it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.42it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.61it/s]100%|██████████| 12/12 [00:03<00:00,  3.74it/s]
2025-03-13 18:42:17,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:17
2025-03-13 18:42:59,731 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1641 secs
2025-03-13 18:42:59,731 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 18:42:59,731 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 18:43:22,888 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1575 secs
2025-03-13 18:43:22,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5339 secs
2025-03-13 18:43:22,891 [INFO]: {
2025-03-13 18:43:22,891 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:22,891 [INFO]: 	index_param: efSearch=218
2025-03-13 18:43:22,891 [INFO]: 	index_path: knn.index
2025-03-13 18:43:22,891 [INFO]: 	size in bytes: 568983070
2025-03-13 18:43:22,891 [INFO]: 	avg_search_speed_ms: 10.04291312763445
2025-03-13 18:43:22,891 [INFO]: 	99p_search_speed_ms: 14.404264604672788
2025-03-13 18:43:22,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:22,891 [INFO]: 	nb vectors: 2892
2025-03-13 18:43:22,891 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:22,891 [INFO]: 	compression ratio: 0.99930976153649
2025-03-13 18:43:22,891 [INFO]: }
2025-03-13 18:43:22,891 [INFO]: 	>>> Finished "Creating the index" in 68.5353 secs
2025-03-13 18:43:22,891 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5632 secs
2025-03-13 18:43:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 10388 [episode count 8/20]
[retrieval_preprocessing] for episode 25237 [episode count 9/20], we have num_retrieval=np.int64(2920) num_query=np.int64(113)
2025-03-13 18:43:25,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:25,495 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:25
2025-03-13 18:43:25,495 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-13 18:43:25,521 [INFO]: There are 2920 embeddings of dim 49152
2025-03-13 18:43:25,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:43:25,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:25
2025-03-13 18:43:25,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:25,522 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:43:25,522 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:25,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:25,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:25
2025-03-13 18:43:25,522 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:25,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:25,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:25
2025-03-13 18:43:25,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:25,522 [INFO]: 	Creating the index 03/13/2025, 18:43:25
2025-03-13 18:43:25,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:25
2025-03-13 18:43:25,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:43:25,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:25
2025-03-13 18:43:25,523 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:43:25,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.55it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.25it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.77it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.43it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.97it/s] 92%|█████████▏| 11/12 [00:00<00:00, 13.44it/s]100%|██████████| 12/12 [00:03<00:00,  3.94it/s]
2025-03-13 18:43:28,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:28
2025-03-13 18:44:04,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0821 secs
2025-03-13 18:44:04,654 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:44:04,654 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 18:44:23,398 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7439 secs
2025-03-13 18:44:23,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2949 secs
2025-03-13 18:44:23,819 [INFO]: {
2025-03-13 18:44:23,819 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:23,819 [INFO]: 	index_param: efSearch=226
2025-03-13 18:44:23,819 [INFO]: 	index_path: knn.index
2025-03-13 18:44:23,819 [INFO]: 	size in bytes: 574491850
2025-03-13 18:44:23,819 [INFO]: 	avg_search_speed_ms: 10.821822149027945
2025-03-13 18:44:23,819 [INFO]: 	99p_search_speed_ms: 14.665872063487768
2025-03-13 18:44:23,819 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:23,819 [INFO]: 	nb vectors: 2920
2025-03-13 18:44:23,819 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:23,819 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-13 18:44:23,820 [INFO]: }
2025-03-13 18:44:23,820 [INFO]: 	>>> Finished "Creating the index" in 58.2976 secs
2025-03-13 18:44:23,820 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3246 secs
2025-03-13 18:44:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 25237 [episode count 9/20]
[retrieval_preprocessing] for episode 28849 [episode count 10/20], we have num_retrieval=np.int64(2889) num_query=np.int64(144)
2025-03-13 18:44:26,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:27,420 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:27
2025-03-13 18:44:27,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-13 18:44:27,447 [INFO]: There are 2889 embeddings of dim 49152
2025-03-13 18:44:27,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:44:27,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:27
2025-03-13 18:44:27,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:27,448 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:44:27,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:27,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:44:27,449 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:27
2025-03-13 18:44:27,449 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:27,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:44:27,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:27
2025-03-13 18:44:27,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:27,449 [INFO]: 	Creating the index 03/13/2025, 18:44:27
2025-03-13 18:44:27,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:27
2025-03-13 18:44:27,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:44:27,453 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:27
2025-03-13 18:44:27,453 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:44:27,453 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.59it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.03it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.68it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.03it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.25it/s] 50%|█████     | 6/12 [00:00<00:00,  8.39it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.60it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.13it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.96it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.83it/s]100%|██████████| 12/12 [00:03<00:00,  1.49it/s]100%|██████████| 12/12 [00:03<00:00,  3.49it/s]
2025-03-13 18:44:30,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:30
2025-03-13 18:45:06,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3934 secs
2025-03-13 18:45:06,293 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 18:45:06,293 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 18:45:30,198 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9051 secs
2025-03-13 18:45:30,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7478 secs
2025-03-13 18:45:30,201 [INFO]: {
2025-03-13 18:45:30,201 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:30,201 [INFO]: 	index_param: efSearch=254
2025-03-13 18:45:30,201 [INFO]: 	index_path: knn.index
2025-03-13 18:45:30,201 [INFO]: 	size in bytes: 568392850
2025-03-13 18:45:30,201 [INFO]: 	avg_search_speed_ms: 11.449164987991413
2025-03-13 18:45:30,201 [INFO]: 	99p_search_speed_ms: 15.300097439903766
2025-03-13 18:45:30,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:30,201 [INFO]: 	nb vectors: 2889
2025-03-13 18:45:30,201 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:30,201 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-13 18:45:30,201 [INFO]: }
2025-03-13 18:45:30,201 [INFO]: 	>>> Finished "Creating the index" in 62.7515 secs
2025-03-13 18:45:30,201 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7811 secs
2025-03-13 18:45:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 28849 [episode count 10/20]
[retrieval_preprocessing] for episode 70870 [episode count 11/20], we have num_retrieval=np.int64(2917) num_query=np.int64(116)
2025-03-13 18:45:32,729 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:33,149 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:33
2025-03-13 18:45:33,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.22it/s]100%|██████████| 1/1 [00:00<00:00,  2.21it/s]
2025-03-13 18:45:33,635 [INFO]: There are 2917 embeddings of dim 49152
2025-03-13 18:45:33,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4862 secs
2025-03-13 18:45:33,636 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:33
2025-03-13 18:45:33,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:33,636 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:45:33,636 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:33,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:45:33,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:33
2025-03-13 18:45:33,637 [INFO]: 602.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:33,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:45:33,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:33
2025-03-13 18:45:33,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:33,637 [INFO]: 	Creating the index 03/13/2025, 18:45:33
2025-03-13 18:45:33,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:33
2025-03-13 18:45:33,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:45:33,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:33
2025-03-13 18:45:33,641 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:45:33,641 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.59it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.87it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.59it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.22it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.84it/s]100%|██████████| 12/12 [00:03<00:00,  3.42it/s]
2025-03-13 18:45:37,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:37
2025-03-13 18:46:17,584 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4238 secs
2025-03-13 18:46:17,584 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:46:17,584 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 18:46:42,610 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0258 secs
2025-03-13 18:46:42,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9713 secs
2025-03-13 18:46:42,612 [INFO]: {
2025-03-13 18:46:42,612 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:42,612 [INFO]: 	index_param: efSearch=216
2025-03-13 18:46:42,612 [INFO]: 	index_path: knn.index
2025-03-13 18:46:42,612 [INFO]: 	size in bytes: 573901630
2025-03-13 18:46:42,612 [INFO]: 	avg_search_speed_ms: 8.898060418353863
2025-03-13 18:46:42,612 [INFO]: 	99p_search_speed_ms: 12.059581889770925
2025-03-13 18:46:42,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:42,612 [INFO]: 	nb vectors: 2917
2025-03-13 18:46:42,612 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:42,613 [INFO]: 	compression ratio: 0.9993098224864774
2025-03-13 18:46:42,613 [INFO]: }
2025-03-13 18:46:42,613 [INFO]: 	>>> Finished "Creating the index" in 68.9750 secs
2025-03-13 18:46:42,613 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4634 secs
2025-03-13 18:46:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 70870 [episode count 11/20]
[retrieval_preprocessing] for episode 90849 [episode count 12/20], we have num_retrieval=np.int64(2863) num_query=np.int64(170)
2025-03-13 18:46:44,219 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:44,579 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:44
2025-03-13 18:46:44,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1763.79it/s]
2025-03-13 18:46:44,603 [INFO]: There are 2863 embeddings of dim 49152
2025-03-13 18:46:44,603 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:46:44,603 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:44
2025-03-13 18:46:44,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:44,603 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:46:44,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:44,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:44,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:44
2025-03-13 18:46:44,603 [INFO]: 590.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:44,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:44,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:44
2025-03-13 18:46:44,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:44,604 [INFO]: 	Creating the index 03/13/2025, 18:46:44
2025-03-13 18:46:44,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:44
2025-03-13 18:46:44,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:46:44,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:44
2025-03-13 18:46:44,605 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:46:44,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.51it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.12it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.85it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.41it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.64it/s] 50%|█████     | 6/12 [00:00<00:00,  8.98it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.28it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.33it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.62it/s]100%|██████████| 12/12 [00:03<00:00,  2.09it/s]100%|██████████| 12/12 [00:03<00:00,  3.77it/s]
2025-03-13 18:46:47,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:47
2025-03-13 18:47:16,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5615 secs
2025-03-13 18:47:16,358 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:47:16,358 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 18:47:40,313 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9558 secs
2025-03-13 18:47:40,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7107 secs
2025-03-13 18:47:40,316 [INFO]: {
2025-03-13 18:47:40,316 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:40,316 [INFO]: 	index_param: efSearch=221
2025-03-13 18:47:40,316 [INFO]: 	index_path: knn.index
2025-03-13 18:47:40,316 [INFO]: 	size in bytes: 563277550
2025-03-13 18:47:40,316 [INFO]: 	avg_search_speed_ms: 10.891130722629024
2025-03-13 18:47:40,316 [INFO]: 	99p_search_speed_ms: 16.381996518466632
2025-03-13 18:47:40,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:40,316 [INFO]: 	nb vectors: 2863
2025-03-13 18:47:40,316 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:40,316 [INFO]: 	compression ratio: 0.9993096724696378
2025-03-13 18:47:40,316 [INFO]: }
2025-03-13 18:47:40,316 [INFO]: 	>>> Finished "Creating the index" in 55.7123 secs
2025-03-13 18:47:40,316 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7368 secs
2025-03-13 18:47:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 90849 [episode count 12/20]
[retrieval_preprocessing] for episode 15085 [episode count 13/20], we have num_retrieval=np.int64(2914) num_query=np.int64(119)
2025-03-13 18:47:42,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:43,045 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:43
2025-03-13 18:47:43,045 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-13 18:47:43,069 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 18:47:43,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:47:43,069 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:43
2025-03-13 18:47:43,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:43,069 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:47:43,069 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:43,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:43,069 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:43
2025-03-13 18:47:43,069 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:43,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:47:43,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:43
2025-03-13 18:47:43,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:43,069 [INFO]: 	Creating the index 03/13/2025, 18:47:43
2025-03-13 18:47:43,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:43
2025-03-13 18:47:43,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:47:43,070 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:43
2025-03-13 18:47:43,070 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:47:43,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.79it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.38it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.51it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.88it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.03it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.20it/s]100%|██████████| 12/12 [00:02<00:00,  4.17it/s]
2025-03-13 18:47:45,950 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:45
2025-03-13 18:48:30,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1561 secs
2025-03-13 18:48:30,107 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 18:48:30,107 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 18:48:56,335 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2277 secs
2025-03-13 18:48:56,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2668 secs
2025-03-13 18:48:56,337 [INFO]: {
2025-03-13 18:48:56,337 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:56,337 [INFO]: 	index_param: efSearch=194
2025-03-13 18:48:56,337 [INFO]: 	index_path: knn.index
2025-03-13 18:48:56,337 [INFO]: 	size in bytes: 573311410
2025-03-13 18:48:56,337 [INFO]: 	avg_search_speed_ms: 9.453146017749841
2025-03-13 18:48:56,337 [INFO]: 	99p_search_speed_ms: 15.874015297740709
2025-03-13 18:48:56,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:56,337 [INFO]: 	nb vectors: 2914
2025-03-13 18:48:56,337 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:56,337 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 18:48:56,337 [INFO]: }
2025-03-13 18:48:56,337 [INFO]: 	>>> Finished "Creating the index" in 73.2681 secs
2025-03-13 18:48:56,337 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2923 secs
2025-03-13 18:48:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 15085 [episode count 13/20]
[retrieval_preprocessing] for episode 82696 [episode count 14/20], we have num_retrieval=np.int64(2840) num_query=np.int64(193)
2025-03-13 18:48:58,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:58,691 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:58
2025-03-13 18:48:58,691 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.21it/s]
2025-03-13 18:48:58,716 [INFO]: There are 2840 embeddings of dim 49152
2025-03-13 18:48:58,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 18:48:58,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:58
2025-03-13 18:48:58,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:58,716 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:48:58,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:58,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:48:58,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:58
2025-03-13 18:48:58,716 [INFO]: 586.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:58,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:48:58,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:58
2025-03-13 18:48:58,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:58,717 [INFO]: 	Creating the index 03/13/2025, 18:48:58
2025-03-13 18:48:58,717 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:58
2025-03-13 18:48:58,718 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:48:58,718 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:58
2025-03-13 18:48:58,718 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:48:58,718 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.88it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.30it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.57it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.22it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.63it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.26it/s]100%|██████████| 12/12 [00:02<00:00,  4.26it/s]
2025-03-13 18:49:01,539 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:01
2025-03-13 18:49:35,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0211 secs
2025-03-13 18:49:35,561 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 18:49:35,561 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s]
2025-03-13 18:50:01,311 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7504 secs
2025-03-13 18:50:01,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5959 secs
2025-03-13 18:50:01,314 [INFO]: {
2025-03-13 18:50:01,314 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:01,314 [INFO]: 	index_param: efSearch=282
2025-03-13 18:50:01,314 [INFO]: 	index_path: knn.index
2025-03-13 18:50:01,314 [INFO]: 	size in bytes: 558752470
2025-03-13 18:50:01,314 [INFO]: 	avg_search_speed_ms: 11.706528341266932
2025-03-13 18:50:01,315 [INFO]: 	99p_search_speed_ms: 17.02639201655984
2025-03-13 18:50:01,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:01,315 [INFO]: 	nb vectors: 2840
2025-03-13 18:50:01,315 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:01,315 [INFO]: 	compression ratio: 0.99930962273867
2025-03-13 18:50:01,315 [INFO]: }
2025-03-13 18:50:01,315 [INFO]: 	>>> Finished "Creating the index" in 62.5980 secs
2025-03-13 18:50:01,315 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6232 secs
2025-03-13 18:50:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 82696 [episode count 14/20]
[retrieval_preprocessing] for episode 25375 [episode count 15/20], we have num_retrieval=np.int64(2871) num_query=np.int64(162)
2025-03-13 18:50:05,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:06,451 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:06
2025-03-13 18:50:06,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-13 18:50:06,478 [INFO]: There are 2871 embeddings of dim 49152
2025-03-13 18:50:06,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:50:06,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:06
2025-03-13 18:50:06,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:06,479 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:50:06,479 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:06,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:06,479 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:06
2025-03-13 18:50:06,479 [INFO]: 592.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:06,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:50:06,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:06
2025-03-13 18:50:06,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:06,479 [INFO]: 	Creating the index 03/13/2025, 18:50:06
2025-03-13 18:50:06,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:06
2025-03-13 18:50:06,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:50:06,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:06
2025-03-13 18:50:06,480 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:50:06,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.75it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.05it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.74it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.52it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.78it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.72it/s]100%|██████████| 12/12 [00:03<00:00,  1.46it/s]100%|██████████| 12/12 [00:03<00:00,  3.31it/s]
2025-03-13 18:50:10,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:10
2025-03-13 18:50:49,660 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5486 secs
2025-03-13 18:50:49,660 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:50:49,660 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:51:10,517 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8563 secs
2025-03-13 18:51:10,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0388 secs
2025-03-13 18:51:10,519 [INFO]: {
2025-03-13 18:51:10,519 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:10,519 [INFO]: 	index_param: efSearch=253
2025-03-13 18:51:10,519 [INFO]: 	index_path: knn.index
2025-03-13 18:51:10,519 [INFO]: 	size in bytes: 564851470
2025-03-13 18:51:10,519 [INFO]: 	avg_search_speed_ms: 10.458931927939402
2025-03-13 18:51:10,519 [INFO]: 	99p_search_speed_ms: 14.751148980576549
2025-03-13 18:51:10,519 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:10,519 [INFO]: 	nb vectors: 2871
2025-03-13 18:51:10,519 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:10,519 [INFO]: 	compression ratio: 0.9993097265020838
2025-03-13 18:51:10,519 [INFO]: }
2025-03-13 18:51:10,519 [INFO]: 	>>> Finished "Creating the index" in 64.0404 secs
2025-03-13 18:51:10,519 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0685 secs
2025-03-13 18:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 25375 [episode count 15/20]
[retrieval_preprocessing] for episode 64847 [episode count 16/20], we have num_retrieval=np.int64(2888) num_query=np.int64(145)
2025-03-13 18:51:13,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:13,701 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:13
2025-03-13 18:51:13,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2272.10it/s]
2025-03-13 18:51:13,724 [INFO]: There are 2888 embeddings of dim 49152
2025-03-13 18:51:13,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 18:51:13,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:13,725 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:51:13,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:13,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:51:13,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,725 [INFO]: 596.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:13,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:51:13,725 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:13
2025-03-13 18:51:13,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:13,725 [INFO]: 	Creating the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,725 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:13
2025-03-13 18:51:13,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:51:13,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,726 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:51:13,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.39it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.82it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.40it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.03it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.49it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.39it/s]100%|██████████| 12/12 [00:02<00:00,  4.02it/s]
2025-03-13 18:51:16,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:16
2025-03-13 18:51:54,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0925 secs
2025-03-13 18:51:54,805 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 18:51:54,805 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-13 18:52:16,849 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0444 secs
2025-03-13 18:52:16,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1264 secs
2025-03-13 18:52:16,852 [INFO]: {
2025-03-13 18:52:16,852 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:16,852 [INFO]: 	index_param: efSearch=238
2025-03-13 18:52:16,853 [INFO]: 	index_path: knn.index
2025-03-13 18:52:16,853 [INFO]: 	size in bytes: 568196110
2025-03-13 18:52:16,853 [INFO]: 	avg_search_speed_ms: 11.7884542296623
2025-03-13 18:52:16,853 [INFO]: 	99p_search_speed_ms: 19.89229100057855
2025-03-13 18:52:16,853 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:16,853 [INFO]: 	nb vectors: 2888
2025-03-13 18:52:16,853 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:16,853 [INFO]: 	compression ratio: 0.9993097348026546
2025-03-13 18:52:16,853 [INFO]: }
2025-03-13 18:52:16,853 [INFO]: 	>>> Finished "Creating the index" in 63.1278 secs
2025-03-13 18:52:16,853 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1513 secs
2025-03-13 18:52:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 64847 [episode count 16/20]
[retrieval_preprocessing] for episode 4435 [episode count 17/20], we have num_retrieval=np.int64(2875) num_query=np.int64(158)
2025-03-13 18:52:19,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:19,731 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:19
2025-03-13 18:52:19,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.44it/s]
2025-03-13 18:52:19,757 [INFO]: There are 2875 embeddings of dim 49152
2025-03-13 18:52:19,757 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:52:19,757 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:19
2025-03-13 18:52:19,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:19,757 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:52:19,757 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:19,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:19,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:19
2025-03-13 18:52:19,758 [INFO]: 593.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:19,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:52:19,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:19
2025-03-13 18:52:19,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:19,758 [INFO]: 	Creating the index 03/13/2025, 18:52:19
2025-03-13 18:52:19,758 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:19
2025-03-13 18:52:19,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:52:19,759 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:19
2025-03-13 18:52:19,759 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:52:19,759 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.38it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.74it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.59it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.02it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.33it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.44it/s]100%|██████████| 12/12 [00:02<00:00,  4.20it/s]
2025-03-13 18:52:22,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:22
2025-03-13 18:52:59,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7368 secs
2025-03-13 18:52:59,356 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 18:52:59,356 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 18:53:16,085 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7284 secs
2025-03-13 18:53:16,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3282 secs
2025-03-13 18:53:16,087 [INFO]: {
2025-03-13 18:53:16,087 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:16,087 [INFO]: 	index_param: efSearch=198
2025-03-13 18:53:16,087 [INFO]: 	index_path: knn.index
2025-03-13 18:53:16,087 [INFO]: 	size in bytes: 565638430
2025-03-13 18:53:16,087 [INFO]: 	avg_search_speed_ms: 9.67255185089818
2025-03-13 18:53:16,087 [INFO]: 	99p_search_speed_ms: 13.480220008641481
2025-03-13 18:53:16,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:16,088 [INFO]: 	nb vectors: 2875
2025-03-13 18:53:16,088 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:16,088 [INFO]: 	compression ratio: 0.9993097534055456
2025-03-13 18:53:16,088 [INFO]: }
2025-03-13 18:53:16,088 [INFO]: 	>>> Finished "Creating the index" in 56.3298 secs
2025-03-13 18:53:16,088 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3563 secs
2025-03-13 18:53:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 4435 [episode count 17/20]
[retrieval_preprocessing] for episode 82773 [episode count 18/20], we have num_retrieval=np.int64(2846) num_query=np.int64(187)
2025-03-13 18:53:18,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:18,702 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:18
2025-03-13 18:53:18,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1737.49it/s]
2025-03-13 18:53:18,726 [INFO]: There are 2846 embeddings of dim 49152
2025-03-13 18:53:18,726 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:53:18,726 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:18
2025-03-13 18:53:18,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:18,727 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:53:18,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:18,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:53:18,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:18
2025-03-13 18:53:18,727 [INFO]: 587.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:18,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:53:18,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:18
2025-03-13 18:53:18,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:18,727 [INFO]: 	Creating the index 03/13/2025, 18:53:18
2025-03-13 18:53:18,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:18
2025-03-13 18:53:18,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:53:18,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:18
2025-03-13 18:53:18,728 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:53:18,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.58it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.00it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.60it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.91it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.06it/s] 50%|█████     | 6/12 [00:00<00:00,  8.20it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.35it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.35it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.35it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.36it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.37it/s]100%|██████████| 12/12 [00:03<00:00,  1.27it/s]100%|██████████| 12/12 [00:03<00:00,  3.26it/s]
2025-03-13 18:53:22,410 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:22
2025-03-13 18:54:01,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9284 secs
2025-03-13 18:54:01,339 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:54:01,339 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:54:23,398 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0591 secs
2025-03-13 18:54:23,401 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6731 secs
2025-03-13 18:54:23,401 [INFO]: {
2025-03-13 18:54:23,401 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:23,401 [INFO]: 	index_param: efSearch=240
2025-03-13 18:54:23,401 [INFO]: 	index_path: knn.index
2025-03-13 18:54:23,401 [INFO]: 	size in bytes: 559932910
2025-03-13 18:54:23,401 [INFO]: 	avg_search_speed_ms: 10.88434029081725
2025-03-13 18:54:23,401 [INFO]: 	99p_search_speed_ms: 18.074713903479275
2025-03-13 18:54:23,401 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:23,401 [INFO]: 	nb vectors: 2846
2025-03-13 18:54:23,401 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:23,401 [INFO]: 	compression ratio: 0.99930966372382
2025-03-13 18:54:23,401 [INFO]: }
2025-03-13 18:54:23,401 [INFO]: 	>>> Finished "Creating the index" in 64.6745 secs
2025-03-13 18:54:23,401 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6991 secs
2025-03-13 18:54:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 82773 [episode count 18/20]
[retrieval_preprocessing] for episode 6494 [episode count 19/20], we have num_retrieval=np.int64(2888) num_query=np.int64(145)
2025-03-13 18:54:26,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:26,852 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:26
2025-03-13 18:54:26,852 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.25it/s]
2025-03-13 18:54:26,879 [INFO]: There are 2888 embeddings of dim 49152
2025-03-13 18:54:26,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:54:26,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:26
2025-03-13 18:54:26,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:26,880 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:54:26,880 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:26,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:26,880 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:26
2025-03-13 18:54:26,880 [INFO]: 596.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:26,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:54:26,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:26
2025-03-13 18:54:26,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:26,880 [INFO]: 	Creating the index 03/13/2025, 18:54:26
2025-03-13 18:54:26,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:26
2025-03-13 18:54:26,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:54:26,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:26
2025-03-13 18:54:26,881 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:54:26,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.49it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.92it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.05it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.98it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.56it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.89it/s]100%|██████████| 12/12 [00:03<00:00,  3.80it/s]
2025-03-13 18:54:30,045 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:30
2025-03-13 18:55:08,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7082 secs
2025-03-13 18:55:08,754 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:55:08,754 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 18:55:27,490 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7361 secs
2025-03-13 18:55:28,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1466 secs
2025-03-13 18:55:28,028 [INFO]: {
2025-03-13 18:55:28,028 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:28,028 [INFO]: 	index_param: efSearch=211
2025-03-13 18:55:28,028 [INFO]: 	index_path: knn.index
2025-03-13 18:55:28,028 [INFO]: 	size in bytes: 568196110
2025-03-13 18:55:28,028 [INFO]: 	avg_search_speed_ms: 11.692283409021316
2025-03-13 18:55:28,028 [INFO]: 	99p_search_speed_ms: 20.403800411149863
2025-03-13 18:55:28,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:28,028 [INFO]: 	nb vectors: 2888
2025-03-13 18:55:28,029 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:28,029 [INFO]: 	compression ratio: 0.9993097348026546
2025-03-13 18:55:28,029 [INFO]: }
2025-03-13 18:55:28,029 [INFO]: 	>>> Finished "Creating the index" in 61.1487 secs
2025-03-13 18:55:28,029 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1765 secs
2025-03-13 18:55:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 6494 [episode count 19/20]
2025-03-13 18:55:29: [retrieval_preprocessing] finished for 4068510503_purple_object_to_plate [chosen_id count 9/196]
2025-03-13 18:55:29: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
