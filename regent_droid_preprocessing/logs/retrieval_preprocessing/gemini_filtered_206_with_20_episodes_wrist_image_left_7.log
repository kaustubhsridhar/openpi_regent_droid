2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4068510503_purple_object_to_bowl [chosen_id count 0/196]
2025-03-13 14:35:03: [retrieval_preprocessing] we have num_total=2942 embedding_dim=49152
[retrieval_preprocessing] for episode 61960 [episode count 0/20], we have num_retrieval=np.int64(2740) num_query=np.int64(202)
2025-03-13 14:35:06,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:07,209 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:07
2025-03-13 14:35:07,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 697.89it/s]
2025-03-13 14:35:07,242 [INFO]: There are 2740 embeddings of dim 49152
2025-03-13 14:35:07,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 14:35:07,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:07,243 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:35:07,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:07,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:07,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,244 [INFO]: 565.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:07,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 14:35:07,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:07
2025-03-13 14:35:07,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:07,244 [INFO]: 	Creating the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:07
2025-03-13 14:35:07,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:35:07,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,246 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:35:07,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.77it/s] 18%|█▊        | 2/11 [00:00<00:01,  4.60it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.03it/s] 45%|████▌     | 5/11 [00:00<00:00,  6.72it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.09it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.12it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.98it/s]100%|██████████| 11/11 [00:05<00:00,  2.20it/s]
2025-03-13 14:35:12,267 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:12
2025-03-13 14:35:48,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9769 secs
2025-03-13 14:35:48,245 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 14:35:48,245 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 14:36:04,145 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8998 secs
2025-03-13 14:36:04,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9016 secs
2025-03-13 14:36:04,148 [INFO]: {
2025-03-13 14:36:04,148 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:04,148 [INFO]: 	index_param: efSearch=152
2025-03-13 14:36:04,148 [INFO]: 	index_path: knn.index
2025-03-13 14:36:04,148 [INFO]: 	size in bytes: 539077930
2025-03-13 14:36:04,148 [INFO]: 	avg_search_speed_ms: 7.269936214285818
2025-03-13 14:36:04,148 [INFO]: 	99p_search_speed_ms: 13.08475577738136
2025-03-13 14:36:04,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:04,148 [INFO]: 	nb vectors: 2740
2025-03-13 14:36:04,148 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:04,148 [INFO]: 	compression ratio: 0.9993099142456082
2025-03-13 14:36:04,148 [INFO]: }
2025-03-13 14:36:04,148 [INFO]: 	>>> Finished "Creating the index" in 56.9038 secs
2025-03-13 14:36:04,148 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9393 secs
2025-03-13 14:36:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 61960 [episode count 0/20]
[retrieval_preprocessing] for episode 10 [episode count 1/20], we have num_retrieval=np.int64(2793) num_query=np.int64(149)
2025-03-13 14:36:06,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:07,737 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:07
2025-03-13 14:36:07,737 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 950.23it/s]
2025-03-13 14:36:07,765 [INFO]: There are 2793 embeddings of dim 49152
2025-03-13 14:36:07,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:36:07,766 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:07
2025-03-13 14:36:07,766 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:07,767 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:36:07,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:07,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:36:07,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:07
2025-03-13 14:36:07,767 [INFO]: 576.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:07,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:36:07,768 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:07
2025-03-13 14:36:07,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:07,768 [INFO]: 	Creating the index 03/13/2025, 14:36:07
2025-03-13 14:36:07,768 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:07
2025-03-13 14:36:07,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:36:07,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:07
2025-03-13 14:36:07,771 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:36:07,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.28it/s] 27%|██▋       | 3/11 [00:00<00:00, 14.54it/s] 55%|█████▍    | 6/11 [00:00<00:00, 17.84it/s] 73%|███████▎  | 8/11 [00:00<00:00, 14.37it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.93it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]
2025-03-13 14:36:10,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:10
2025-03-13 14:36:39,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0197 secs
2025-03-13 14:36:39,429 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 14:36:39,429 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.45it/s] 50%|█████     | 2/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s]
2025-03-13 14:36:55,737 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3079 secs
2025-03-13 14:36:55,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9685 secs
2025-03-13 14:36:55,740 [INFO]: {
2025-03-13 14:36:55,740 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:55,740 [INFO]: 	index_param: efSearch=225
2025-03-13 14:36:55,740 [INFO]: 	index_path: knn.index
2025-03-13 14:36:55,740 [INFO]: 	size in bytes: 549505390
2025-03-13 14:36:55,740 [INFO]: 	avg_search_speed_ms: 10.27311276987738
2025-03-13 14:36:55,740 [INFO]: 	99p_search_speed_ms: 18.09103046543896
2025-03-13 14:36:55,740 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:55,740 [INFO]: 	nb vectors: 2793
2025-03-13 14:36:55,740 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:55,740 [INFO]: 	compression ratio: 0.9993098411646153
2025-03-13 14:36:55,740 [INFO]: }
2025-03-13 14:36:55,740 [INFO]: 	>>> Finished "Creating the index" in 47.9720 secs
2025-03-13 14:36:55,740 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0027 secs
2025-03-13 14:36:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 10 [episode count 1/20]
[retrieval_preprocessing] for episode 34316 [episode count 2/20], we have num_retrieval=np.int64(2761) num_query=np.int64(181)
2025-03-13 14:36:57,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:58,300 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:58
2025-03-13 14:36:58,300 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1101.16it/s]
2025-03-13 14:36:58,325 [INFO]: There are 2761 embeddings of dim 49152
2025-03-13 14:36:58,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 14:36:58,325 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:58
2025-03-13 14:36:58,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:58,325 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:36:58,325 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:58,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:58,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:58
2025-03-13 14:36:58,325 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:58,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:36:58,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:58
2025-03-13 14:36:58,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:58,326 [INFO]: 	Creating the index 03/13/2025, 14:36:58
2025-03-13 14:36:58,326 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:58
2025-03-13 14:36:58,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:36:58,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:58
2025-03-13 14:36:58,327 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:36:58,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.59it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.56it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.05it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.61it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.57it/s]100%|██████████| 11/11 [00:02<00:00,  2.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.09it/s]
2025-03-13 14:37:01,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:01
2025-03-13 14:37:30,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8829 secs
2025-03-13 14:37:30,908 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 14:37:30,908 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 14:37:47,395 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4871 secs
2025-03-13 14:37:47,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0714 secs
2025-03-13 14:37:47,399 [INFO]: {
2025-03-13 14:37:47,399 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:47,399 [INFO]: 	index_param: efSearch=296
2025-03-13 14:37:47,399 [INFO]: 	index_path: knn.index
2025-03-13 14:37:47,399 [INFO]: 	size in bytes: 543209530
2025-03-13 14:37:47,399 [INFO]: 	avg_search_speed_ms: 14.226062467737735
2025-03-13 14:37:47,399 [INFO]: 	99p_search_speed_ms: 22.425864771939814
2025-03-13 14:37:47,399 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:47,399 [INFO]: 	nb vectors: 2761
2025-03-13 14:37:47,399 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:47,399 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-13 14:37:47,399 [INFO]: }
2025-03-13 14:37:47,399 [INFO]: 	>>> Finished "Creating the index" in 49.0731 secs
2025-03-13 14:37:47,399 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0984 secs
2025-03-13 14:37:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 34316 [episode count 2/20]
[retrieval_preprocessing] for episode 3612 [episode count 3/20], we have num_retrieval=np.int64(2800) num_query=np.int64(142)
2025-03-13 14:37:50,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:52,166 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:52
2025-03-13 14:37:52,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-13 14:37:52,191 [INFO]: There are 2800 embeddings of dim 49152
2025-03-13 14:37:52,191 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 14:37:52,191 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:52
2025-03-13 14:37:52,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:52,191 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:37:52,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:52,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:52,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:52
2025-03-13 14:37:52,192 [INFO]: 577.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:52,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:52,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:52
2025-03-13 14:37:52,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:52,192 [INFO]: 	Creating the index 03/13/2025, 14:37:52
2025-03-13 14:37:52,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:52
2025-03-13 14:37:52,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:37:52,193 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:52
2025-03-13 14:37:52,193 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:37:52,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.92it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.48it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.35it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.35it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.92it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.13it/s] 92%|█████████▏| 11/12 [00:01<00:00, 12.29it/s]100%|██████████| 12/12 [00:03<00:00,  3.75it/s]
2025-03-13 14:37:55,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:55
2025-03-13 14:38:25,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8388 secs
2025-03-13 14:38:25,237 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 14:38:25,237 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-13 14:38:41,432 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1950 secs
2025-03-13 14:38:41,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2530 secs
2025-03-13 14:38:41,446 [INFO]: {
2025-03-13 14:38:41,446 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:41,446 [INFO]: 	index_param: efSearch=299
2025-03-13 14:38:41,446 [INFO]: 	index_path: knn.index
2025-03-13 14:38:41,446 [INFO]: 	size in bytes: 550882690
2025-03-13 14:38:41,446 [INFO]: 	avg_search_speed_ms: 11.589992887730066
2025-03-13 14:38:41,446 [INFO]: 	99p_search_speed_ms: 16.143779149279
2025-03-13 14:38:41,446 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:41,446 [INFO]: 	nb vectors: 2800
2025-03-13 14:38:41,446 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:41,446 [INFO]: 	compression ratio: 0.9993096715382362
2025-03-13 14:38:41,446 [INFO]: }
2025-03-13 14:38:41,446 [INFO]: 	>>> Finished "Creating the index" in 49.2544 secs
2025-03-13 14:38:41,446 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2803 secs
2025-03-13 14:38:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 3612 [episode count 3/20]
[retrieval_preprocessing] for episode 44160 [episode count 4/20], we have num_retrieval=np.int64(2787) num_query=np.int64(155)
2025-03-13 14:38:44,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:44,549 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:44
2025-03-13 14:38:44,549 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.73it/s]
2025-03-13 14:38:44,573 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 14:38:44,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 14:38:44,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:44
2025-03-13 14:38:44,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:44,574 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:38:44,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:44,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:44,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:44
2025-03-13 14:38:44,574 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:44,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:38:44,574 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:44
2025-03-13 14:38:44,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:44,574 [INFO]: 	Creating the index 03/13/2025, 14:38:44
2025-03-13 14:38:44,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:44
2025-03-13 14:38:44,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:38:44,575 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:44
2025-03-13 14:38:44,575 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:38:44,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.69it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.15it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.27it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.72it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.20it/s]100%|██████████| 11/11 [00:03<00:00,  1.86it/s]100%|██████████| 11/11 [00:03<00:00,  3.06it/s]
2025-03-13 14:38:48,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:48
2025-03-13 14:39:19,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7753 secs
2025-03-13 14:39:19,957 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 14:39:19,957 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 14:39:36,579 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6214 secs
2025-03-13 14:39:36,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0057 secs
2025-03-13 14:39:36,581 [INFO]: {
2025-03-13 14:39:36,581 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:36,581 [INFO]: 	index_param: efSearch=247
2025-03-13 14:39:36,581 [INFO]: 	index_path: knn.index
2025-03-13 14:39:36,581 [INFO]: 	size in bytes: 548324890
2025-03-13 14:39:36,581 [INFO]: 	avg_search_speed_ms: 10.353015359745633
2025-03-13 14:39:36,581 [INFO]: 	99p_search_speed_ms: 15.263852733187383
2025-03-13 14:39:36,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:36,581 [INFO]: 	nb vectors: 2787
2025-03-13 14:39:36,581 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:36,581 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 14:39:36,581 [INFO]: }
2025-03-13 14:39:36,581 [INFO]: 	>>> Finished "Creating the index" in 52.0072 secs
2025-03-13 14:39:36,581 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0324 secs
2025-03-13 14:39:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 44160 [episode count 4/20]
[retrieval_preprocessing] for episode 16552 [episode count 5/20], we have num_retrieval=np.int64(2812) num_query=np.int64(130)
2025-03-13 14:39:39,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:39,512 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:39
2025-03-13 14:39:39,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2156.45it/s]
2025-03-13 14:39:39,534 [INFO]: There are 2812 embeddings of dim 49152
2025-03-13 14:39:39,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 14:39:39,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:39
2025-03-13 14:39:39,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:39,534 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:39:39,534 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:39,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:39,534 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:39
2025-03-13 14:39:39,534 [INFO]: 580.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:39,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:39:39,535 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:39
2025-03-13 14:39:39,535 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:39,535 [INFO]: 	Creating the index 03/13/2025, 14:39:39
2025-03-13 14:39:39,535 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:39
2025-03-13 14:39:39,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:39:39,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:39
2025-03-13 14:39:39,536 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:39:39,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.08it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.76it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.38it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.67it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.86it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.88it/s]100%|██████████| 12/12 [00:03<00:00,  3.53it/s]
2025-03-13 14:39:42,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:42
2025-03-13 14:40:14,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1656 secs
2025-03-13 14:40:14,108 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 14:40:14,109 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 50%|█████     | 2/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 14:40:32,181 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0726 secs
2025-03-13 14:40:32,184 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6481 secs
2025-03-13 14:40:32,184 [INFO]: {
2025-03-13 14:40:32,184 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:32,184 [INFO]: 	index_param: efSearch=281
2025-03-13 14:40:32,184 [INFO]: 	index_path: knn.index
2025-03-13 14:40:32,184 [INFO]: 	size in bytes: 553243570
2025-03-13 14:40:32,184 [INFO]: 	avg_search_speed_ms: 13.157631231373863
2025-03-13 14:40:32,184 [INFO]: 	99p_search_speed_ms: 22.779458011500534
2025-03-13 14:40:32,184 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:32,184 [INFO]: 	nb vectors: 2812
2025-03-13 14:40:32,184 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:32,184 [INFO]: 	compression ratio: 0.9993097542914054
2025-03-13 14:40:32,184 [INFO]: }
2025-03-13 14:40:32,184 [INFO]: 	>>> Finished "Creating the index" in 52.6496 secs
2025-03-13 14:40:32,184 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6718 secs
2025-03-13 14:40:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 16552 [episode count 5/20]
[retrieval_preprocessing] for episode 51896 [episode count 6/20], we have num_retrieval=np.int64(2814) num_query=np.int64(128)
2025-03-13 14:40:34,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:35,438 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:35
2025-03-13 14:40:35,438 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.14it/s]
2025-03-13 14:40:35,464 [INFO]: There are 2814 embeddings of dim 49152
2025-03-13 14:40:35,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 14:40:35,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:35
2025-03-13 14:40:35,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:35,464 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:40:35,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:35,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:40:35,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:35
2025-03-13 14:40:35,465 [INFO]: 580.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:35,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:40:35,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:35
2025-03-13 14:40:35,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:35,465 [INFO]: 	Creating the index 03/13/2025, 14:40:35
2025-03-13 14:40:35,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:35
2025-03-13 14:40:35,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:40:35,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:35
2025-03-13 14:40:35,466 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:40:35,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.48it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.23it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.65it/s] 50%|█████     | 6/12 [00:00<00:00,  9.28it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.76it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.09it/s]100%|██████████| 12/12 [00:03<00:00,  2.02it/s]100%|██████████| 12/12 [00:03<00:00,  3.39it/s]
2025-03-13 14:40:39,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:39
2025-03-13 14:41:07,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7544 secs
2025-03-13 14:41:07,766 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 14:41:07,766 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-13 14:41:45,056 [INFO]: 	>>> Finished "Compute fast metrics" in 37.2898 secs
2025-03-13 14:41:45,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5929 secs
2025-03-13 14:41:45,059 [INFO]: {
2025-03-13 14:41:45,059 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:45,059 [INFO]: 	index_param: efSearch=307
2025-03-13 14:41:45,059 [INFO]: 	index_path: knn.index
2025-03-13 14:41:45,059 [INFO]: 	size in bytes: 553637050
2025-03-13 14:41:45,059 [INFO]: 	avg_search_speed_ms: 12.272536380365034
2025-03-13 14:41:45,059 [INFO]: 	99p_search_speed_ms: 20.521630714647472
2025-03-13 14:41:45,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:45,059 [INFO]: 	nb vectors: 2814
2025-03-13 14:41:45,059 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:45,059 [INFO]: 	compression ratio: 0.9993097680149838
2025-03-13 14:41:45,059 [INFO]: }
2025-03-13 14:41:45,059 [INFO]: 	>>> Finished "Creating the index" in 69.5943 secs
2025-03-13 14:41:45,059 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6209 secs
2025-03-13 14:41:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 51896 [episode count 6/20]
[retrieval_preprocessing] for episode 38545 [episode count 7/20], we have num_retrieval=np.int64(2818) num_query=np.int64(124)
2025-03-13 14:41:47,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:47,930 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:47
2025-03-13 14:41:47,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.88it/s]
2025-03-13 14:41:47,955 [INFO]: There are 2818 embeddings of dim 49152
2025-03-13 14:41:47,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 14:41:47,955 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:47
2025-03-13 14:41:47,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:47,956 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:41:47,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:47,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:47,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:47
2025-03-13 14:41:47,956 [INFO]: 581.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:47,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:47,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:47
2025-03-13 14:41:47,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:47,956 [INFO]: 	Creating the index 03/13/2025, 14:41:47
2025-03-13 14:41:47,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:47
2025-03-13 14:41:47,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:41:47,957 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:47
2025-03-13 14:41:47,957 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:41:47,957 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.15it/s] 33%|███▎      | 4/12 [00:00<00:00, 18.74it/s] 58%|█████▊    | 7/12 [00:00<00:00, 20.73it/s] 83%|████████▎ | 10/12 [00:00<00:00, 19.81it/s]100%|██████████| 12/12 [00:02<00:00,  2.71it/s]100%|██████████| 12/12 [00:02<00:00,  4.28it/s]
2025-03-13 14:41:50,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:50
2025-03-13 14:42:24,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8925 secs
2025-03-13 14:42:24,658 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 14:42:24,658 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 14:42:42,406 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7475 secs
2025-03-13 14:42:42,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4514 secs
2025-03-13 14:42:42,409 [INFO]: {
2025-03-13 14:42:42,409 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:42,409 [INFO]: 	index_param: efSearch=260
2025-03-13 14:42:42,409 [INFO]: 	index_path: knn.index
2025-03-13 14:42:42,409 [INFO]: 	size in bytes: 554424010
2025-03-13 14:42:42,409 [INFO]: 	avg_search_speed_ms: 11.10306030426683
2025-03-13 14:42:42,409 [INFO]: 	99p_search_speed_ms: 22.87050406448543
2025-03-13 14:42:42,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:42,409 [INFO]: 	nb vectors: 2818
2025-03-13 14:42:42,409 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:42,409 [INFO]: 	compression ratio: 0.9993097954037019
2025-03-13 14:42:42,409 [INFO]: }
2025-03-13 14:42:42,409 [INFO]: 	>>> Finished "Creating the index" in 54.4530 secs
2025-03-13 14:42:42,409 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4786 secs
2025-03-13 14:42:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 38545 [episode count 7/20]
[retrieval_preprocessing] for episode 44296 [episode count 8/20], we have num_retrieval=np.int64(2787) num_query=np.int64(155)
2025-03-13 14:42:45,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:46,104 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:46
2025-03-13 14:42:46,105 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.67it/s]
2025-03-13 14:42:46,130 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 14:42:46,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 14:42:46,130 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:46
2025-03-13 14:42:46,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:46,130 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:42:46,130 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:46,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:46,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:46
2025-03-13 14:42:46,130 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:46,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:42:46,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:46
2025-03-13 14:42:46,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:46,130 [INFO]: 	Creating the index 03/13/2025, 14:42:46
2025-03-13 14:42:46,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:46
2025-03-13 14:42:46,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:42:46,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:46
2025-03-13 14:42:46,132 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:42:46,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.93it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.51it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.16it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.61it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.75it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.75it/s] 64%|██████▎   | 7/11 [00:01<00:00,  6.57it/s] 73%|███████▎  | 8/11 [00:01<00:00,  5.10it/s] 82%|████████▏ | 9/11 [00:01<00:00,  5.64it/s] 91%|█████████ | 10/11 [00:01<00:00,  6.14it/s]100%|██████████| 11/11 [00:04<00:00,  1.13it/s]100%|██████████| 11/11 [00:04<00:00,  2.69it/s]
2025-03-13 14:42:50,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:50
2025-03-13 14:43:19,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5937 secs
2025-03-13 14:43:19,822 [INFO]: The best hyperparameters are: efSearch=310
2025-03-13 14:43:19,822 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 14:43:36,555 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7329 secs
2025-03-13 14:43:36,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4259 secs
2025-03-13 14:43:36,558 [INFO]: {
2025-03-13 14:43:36,558 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:36,558 [INFO]: 	index_param: efSearch=310
2025-03-13 14:43:36,558 [INFO]: 	index_path: knn.index
2025-03-13 14:43:36,558 [INFO]: 	size in bytes: 548324890
2025-03-13 14:43:36,558 [INFO]: 	avg_search_speed_ms: 15.359419072547587
2025-03-13 14:43:36,558 [INFO]: 	99p_search_speed_ms: 29.501311480998993
2025-03-13 14:43:36,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:36,558 [INFO]: 	nb vectors: 2787
2025-03-13 14:43:36,558 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:36,558 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 14:43:36,558 [INFO]: }
2025-03-13 14:43:36,558 [INFO]: 	>>> Finished "Creating the index" in 50.4273 secs
2025-03-13 14:43:36,558 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4532 secs
2025-03-13 14:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 44296 [episode count 8/20]
[retrieval_preprocessing] for episode 1801 [episode count 9/20], we have num_retrieval=np.int64(2803) num_query=np.int64(139)
2025-03-13 14:43:39,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:39,929 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:39
2025-03-13 14:43:39,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 14:43:39,954 [INFO]: There are 2803 embeddings of dim 49152
2025-03-13 14:43:39,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 14:43:39,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,955 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:39,955 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:43:39,955 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:39,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:39,955 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,955 [INFO]: 578.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:39,955 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:39,955 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:39
2025-03-13 14:43:39,955 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:39,955 [INFO]: 	Creating the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,955 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:39
2025-03-13 14:43:39,956 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:43:39,956 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,956 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:43:39,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.95it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.82it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.36it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.84it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.60it/s] 92%|█████████▏| 11/12 [00:00<00:00, 14.18it/s]100%|██████████| 12/12 [00:03<00:00,  3.83it/s]
2025-03-13 14:43:43,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:43
2025-03-13 14:44:13,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1172 secs
2025-03-13 14:44:13,208 [INFO]: The best hyperparameters are: efSearch=316
2025-03-13 14:44:13,208 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 14:44:30,334 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1264 secs
2025-03-13 14:44:30,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3806 secs
2025-03-13 14:44:30,337 [INFO]: {
2025-03-13 14:44:30,337 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:30,337 [INFO]: 	index_param: efSearch=316
2025-03-13 14:44:30,337 [INFO]: 	index_path: knn.index
2025-03-13 14:44:30,337 [INFO]: 	size in bytes: 551472910
2025-03-13 14:44:30,337 [INFO]: 	avg_search_speed_ms: 12.733255277515767
2025-03-13 14:44:30,337 [INFO]: 	99p_search_speed_ms: 25.20412905141711
2025-03-13 14:44:30,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:30,337 [INFO]: 	nb vectors: 2803
2025-03-13 14:44:30,337 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:30,337 [INFO]: 	compression ratio: 0.9993096922929542
2025-03-13 14:44:30,337 [INFO]: }
2025-03-13 14:44:30,337 [INFO]: 	>>> Finished "Creating the index" in 50.3820 secs
2025-03-13 14:44:30,337 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4079 secs
2025-03-13 14:44:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 1801 [episode count 9/20]
[retrieval_preprocessing] for episode 77602 [episode count 10/20], we have num_retrieval=np.int64(2820) num_query=np.int64(122)
2025-03-13 14:44:33,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:34,019 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:34
2025-03-13 14:44:34,019 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 938.32it/s]
2025-03-13 14:44:34,046 [INFO]: There are 2820 embeddings of dim 49152
2025-03-13 14:44:34,046 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 14:44:34,047 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:34
2025-03-13 14:44:34,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:34,047 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:44:34,047 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:34,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:44:34,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:34
2025-03-13 14:44:34,048 [INFO]: 582.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:34,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:34,048 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:34
2025-03-13 14:44:34,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:34,049 [INFO]: 	Creating the index 03/13/2025, 14:44:34
2025-03-13 14:44:34,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:34
2025-03-13 14:44:34,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 14:44:34,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:34
2025-03-13 14:44:34,053 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:44:34,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.99it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.64it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.27it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.31it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.49it/s]100%|██████████| 12/12 [00:03<00:00,  3.84it/s]
2025-03-13 14:44:37,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:37
2025-03-13 14:45:06,333 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1520 secs
2025-03-13 14:45:06,333 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 14:45:06,333 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 14:45:24,485 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1514 secs
2025-03-13 14:45:24,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4351 secs
2025-03-13 14:45:24,488 [INFO]: {
2025-03-13 14:45:24,488 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:24,488 [INFO]: 	index_param: efSearch=301
2025-03-13 14:45:24,488 [INFO]: 	index_path: knn.index
2025-03-13 14:45:24,488 [INFO]: 	size in bytes: 554817490
2025-03-13 14:45:24,488 [INFO]: 	avg_search_speed_ms: 13.636685623939604
2025-03-13 14:45:24,488 [INFO]: 	99p_search_speed_ms: 23.071067947894264
2025-03-13 14:45:24,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:24,488 [INFO]: 	nb vectors: 2820
2025-03-13 14:45:24,488 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:24,488 [INFO]: 	compression ratio: 0.9993098090689246
2025-03-13 14:45:24,488 [INFO]: }
2025-03-13 14:45:24,488 [INFO]: 	>>> Finished "Creating the index" in 50.4394 secs
2025-03-13 14:45:24,488 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4686 secs
2025-03-13 14:45:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 77602 [episode count 10/20]
[retrieval_preprocessing] for episode 3884 [episode count 11/20], we have num_retrieval=np.int64(2800) num_query=np.int64(142)
2025-03-13 14:45:28,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:29,136 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:29
2025-03-13 14:45:29,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.31it/s]
2025-03-13 14:45:29,161 [INFO]: There are 2800 embeddings of dim 49152
2025-03-13 14:45:29,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 14:45:29,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:29,161 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:45:29,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:29,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:29,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,162 [INFO]: 577.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:29,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:45:29,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:29
2025-03-13 14:45:29,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:29,162 [INFO]: 	Creating the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,162 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:29
2025-03-13 14:45:29,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:45:29,163 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,163 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:45:29,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 13.74it/s] 42%|████▏     | 5/12 [00:00<00:00, 18.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 18.31it/s] 83%|████████▎ | 10/12 [00:00<00:00, 21.09it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]
2025-03-13 14:45:31,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:31
2025-03-13 14:46:01,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6642 secs
2025-03-13 14:46:01,560 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 14:46:01,560 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
2025-03-13 14:46:23,064 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5033 secs
2025-03-13 14:46:23,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9035 secs
2025-03-13 14:46:23,067 [INFO]: {
2025-03-13 14:46:23,067 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:23,067 [INFO]: 	index_param: efSearch=309
2025-03-13 14:46:23,067 [INFO]: 	index_path: knn.index
2025-03-13 14:46:23,067 [INFO]: 	size in bytes: 550882690
2025-03-13 14:46:23,067 [INFO]: 	avg_search_speed_ms: 12.435598466580094
2025-03-13 14:46:23,067 [INFO]: 	99p_search_speed_ms: 21.372497926931832
2025-03-13 14:46:23,067 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:23,067 [INFO]: 	nb vectors: 2800
2025-03-13 14:46:23,067 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:23,067 [INFO]: 	compression ratio: 0.9993096715382362
2025-03-13 14:46:23,067 [INFO]: }
2025-03-13 14:46:23,067 [INFO]: 	>>> Finished "Creating the index" in 53.9051 secs
2025-03-13 14:46:23,067 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9304 secs
2025-03-13 14:46:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 3884 [episode count 11/20]
[retrieval_preprocessing] for episode 40756 [episode count 12/20], we have num_retrieval=np.int64(2729) num_query=np.int64(213)
2025-03-13 14:46:26,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:26,550 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:26
2025-03-13 14:46:26,551 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 798.46it/s]
2025-03-13 14:46:26,577 [INFO]: There are 2729 embeddings of dim 49152
2025-03-13 14:46:26,578 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 14:46:26,578 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:26
2025-03-13 14:46:26,578 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:26,578 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:46:26,578 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:26,578 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:46:26,579 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:26
2025-03-13 14:46:26,579 [INFO]: 563.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:26,579 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:46:26,579 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:26
2025-03-13 14:46:26,579 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:26,580 [INFO]: 	Creating the index 03/13/2025, 14:46:26
2025-03-13 14:46:26,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:26
2025-03-13 14:46:26,583 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:46:26,583 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:26
2025-03-13 14:46:26,584 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:46:26,584 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.49it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.16it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.33it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.07it/s]100%|██████████| 11/11 [00:03<00:00,  1.67it/s]100%|██████████| 11/11 [00:03<00:00,  3.31it/s]
2025-03-13 14:46:29,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:29
2025-03-13 14:47:01,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8573 secs
2025-03-13 14:47:01,772 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 14:47:01,772 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 14:47:21,848 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0762 secs
2025-03-13 14:47:21,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2667 secs
2025-03-13 14:47:21,851 [INFO]: {
2025-03-13 14:47:21,851 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:21,851 [INFO]: 	index_param: efSearch=274
2025-03-13 14:47:21,851 [INFO]: 	index_path: knn.index
2025-03-13 14:47:21,851 [INFO]: 	size in bytes: 536913790
2025-03-13 14:47:21,851 [INFO]: 	avg_search_speed_ms: 11.37181784089824
2025-03-13 14:47:21,851 [INFO]: 	99p_search_speed_ms: 18.58858694089577
2025-03-13 14:47:21,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:21,851 [INFO]: 	nb vectors: 2729
2025-03-13 14:47:21,851 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:21,851 [INFO]: 	compression ratio: 0.9993098370596889
2025-03-13 14:47:21,851 [INFO]: }
2025-03-13 14:47:21,851 [INFO]: 	>>> Finished "Creating the index" in 55.2709 secs
2025-03-13 14:47:21,851 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3002 secs
2025-03-13 14:47:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 40756 [episode count 12/20]
[retrieval_preprocessing] for episode 1360 [episode count 13/20], we have num_retrieval=np.int64(2771) num_query=np.int64(171)
2025-03-13 14:47:25,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:25,953 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:25
2025-03-13 14:47:25,953 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.82it/s]
2025-03-13 14:47:25,981 [INFO]: There are 2771 embeddings of dim 49152
2025-03-13 14:47:25,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 14:47:25,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:25
2025-03-13 14:47:25,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:25,982 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:47:25,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:25,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:47:25,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:25
2025-03-13 14:47:25,982 [INFO]: 571.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:25,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:47:25,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:25
2025-03-13 14:47:25,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:25,983 [INFO]: 	Creating the index 03/13/2025, 14:47:25
2025-03-13 14:47:25,983 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:25
2025-03-13 14:47:25,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 14:47:25,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:25
2025-03-13 14:47:25,987 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:47:25,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.51it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.56it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.49it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.98it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.17it/s]100%|██████████| 11/11 [00:02<00:00,  2.49it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]
2025-03-13 14:47:28,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:28
2025-03-13 14:47:59,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1380 secs
2025-03-13 14:47:59,946 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 14:47:59,946 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 14:48:17,475 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5289 secs
2025-03-13 14:48:17,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4909 secs
2025-03-13 14:48:17,478 [INFO]: {
2025-03-13 14:48:17,478 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:17,478 [INFO]: 	index_param: efSearch=238
2025-03-13 14:48:17,478 [INFO]: 	index_path: knn.index
2025-03-13 14:48:17,478 [INFO]: 	size in bytes: 545177050
2025-03-13 14:48:17,478 [INFO]: 	avg_search_speed_ms: 10.556589909647261
2025-03-13 14:48:17,478 [INFO]: 	99p_search_speed_ms: 16.887050904333588
2025-03-13 14:48:17,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:17,478 [INFO]: 	nb vectors: 2771
2025-03-13 14:48:17,478 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:17,478 [INFO]: 	compression ratio: 0.9993097985324217
2025-03-13 14:48:17,478 [INFO]: }
2025-03-13 14:48:17,478 [INFO]: 	>>> Finished "Creating the index" in 51.4946 secs
2025-03-13 14:48:17,478 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5250 secs
2025-03-13 14:48:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 1360 [episode count 13/20]
[retrieval_preprocessing] for episode 14157 [episode count 14/20], we have num_retrieval=np.int64(2836) num_query=np.int64(106)
2025-03-13 14:48:20,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:21,188 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:21
2025-03-13 14:48:21,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.94it/s]
2025-03-13 14:48:21,214 [INFO]: There are 2836 embeddings of dim 49152
2025-03-13 14:48:21,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 14:48:21,214 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:21
2025-03-13 14:48:21,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:21,214 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:48:21,214 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:21,214 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:21,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:21
2025-03-13 14:48:21,216 [INFO]: 585.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:21,216 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:48:21,216 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:21
2025-03-13 14:48:21,216 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:21,216 [INFO]: 	Creating the index 03/13/2025, 14:48:21
2025-03-13 14:48:21,216 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:21
2025-03-13 14:48:21,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:48:21,217 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:21
2025-03-13 14:48:21,217 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:48:21,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.23it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.72it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.21it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.33it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.38it/s] 50%|█████     | 6/12 [00:00<00:00,  7.45it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.48it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.59it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.72it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.80it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.86it/s]100%|██████████| 12/12 [00:03<00:00,  1.28it/s]100%|██████████| 12/12 [00:03<00:00,  3.21it/s]
2025-03-13 14:48:24,962 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:24
2025-03-13 14:48:56,628 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6652 secs
2025-03-13 14:48:56,628 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 14:48:56,628 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 14:49:20,538 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9091 secs
2025-03-13 14:49:20,540 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3237 secs
2025-03-13 14:49:20,541 [INFO]: {
2025-03-13 14:49:20,541 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:20,541 [INFO]: 	index_param: efSearch=274
2025-03-13 14:49:20,541 [INFO]: 	index_path: knn.index
2025-03-13 14:49:20,541 [INFO]: 	size in bytes: 557965510
2025-03-13 14:49:20,541 [INFO]: 	avg_search_speed_ms: 10.847063671237912
2025-03-13 14:49:20,541 [INFO]: 	99p_search_speed_ms: 16.267572187352922
2025-03-13 14:49:20,541 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:20,541 [INFO]: 	nb vectors: 2836
2025-03-13 14:49:20,541 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:20,541 [INFO]: 	compression ratio: 0.9993095953188934
2025-03-13 14:49:20,541 [INFO]: }
2025-03-13 14:49:20,541 [INFO]: 	>>> Finished "Creating the index" in 59.3250 secs
2025-03-13 14:49:20,541 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3532 secs
2025-03-13 14:49:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 14157 [episode count 14/20]
[retrieval_preprocessing] for episode 75129 [episode count 15/20], we have num_retrieval=np.int64(2787) num_query=np.int64(155)
2025-03-13 14:49:22,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:23,173 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:23
2025-03-13 14:49:23,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 14:49:23,198 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 14:49:23,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 14:49:23,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:23
2025-03-13 14:49:23,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:23,198 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:49:23,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:23,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:23,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:23
2025-03-13 14:49:23,199 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:23,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:23,199 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:23
2025-03-13 14:49:23,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:23,199 [INFO]: 	Creating the index 03/13/2025, 14:49:23
2025-03-13 14:49:23,199 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:23
2025-03-13 14:49:23,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:49:23,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:23
2025-03-13 14:49:23,200 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:49:23,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.26it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.84it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.06it/s] 73%|███████▎  | 8/11 [00:00<00:00, 14.33it/s]100%|██████████| 11/11 [00:02<00:00,  3.31it/s]100%|██████████| 11/11 [00:02<00:00,  4.35it/s]
2025-03-13 14:49:25,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:25
2025-03-13 14:50:01,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5123 secs
2025-03-13 14:50:01,250 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 14:50:01,250 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 14:50:19,197 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9467 secs
2025-03-13 14:50:19,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9991 secs
2025-03-13 14:50:19,199 [INFO]: {
2025-03-13 14:50:19,199 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:19,199 [INFO]: 	index_param: efSearch=216
2025-03-13 14:50:19,199 [INFO]: 	index_path: knn.index
2025-03-13 14:50:19,199 [INFO]: 	size in bytes: 548324890
2025-03-13 14:50:19,199 [INFO]: 	avg_search_speed_ms: 10.322827639411923
2025-03-13 14:50:19,200 [INFO]: 	99p_search_speed_ms: 16.317762462422234
2025-03-13 14:50:19,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:19,200 [INFO]: 	nb vectors: 2787
2025-03-13 14:50:19,200 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:19,200 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 14:50:19,200 [INFO]: }
2025-03-13 14:50:19,200 [INFO]: 	>>> Finished "Creating the index" in 56.0007 secs
2025-03-13 14:50:19,200 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0261 secs
2025-03-13 14:50:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 75129 [episode count 15/20]
[retrieval_preprocessing] for episode 11153 [episode count 16/20], we have num_retrieval=np.int64(2836) num_query=np.int64(106)
2025-03-13 14:50:21,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:22,381 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:22
2025-03-13 14:50:22,381 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1286.60it/s]
2025-03-13 14:50:22,407 [INFO]: There are 2836 embeddings of dim 49152
2025-03-13 14:50:22,407 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 14:50:22,407 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,407 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:22,407 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:50:22,407 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:22,407 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:22,407 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,408 [INFO]: 585.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:22,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:50:22,408 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:22
2025-03-13 14:50:22,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:22,408 [INFO]: 	Creating the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,408 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:22
2025-03-13 14:50:22,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:50:22,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,409 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:50:22,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.83it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.00it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.06it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.62it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.85it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.04it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.03it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.91it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.64it/s]100%|██████████| 12/12 [00:04<00:00,  1.06s/it]100%|██████████| 12/12 [00:04<00:00,  2.54it/s]
2025-03-13 14:50:27,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:27
2025-03-13 14:50:57,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7919 secs
2025-03-13 14:50:57,925 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 14:50:57,925 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 14:51:18,582 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6564 secs
2025-03-13 14:51:18,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1753 secs
2025-03-13 14:51:18,584 [INFO]: {
2025-03-13 14:51:18,585 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:18,585 [INFO]: 	index_param: efSearch=294
2025-03-13 14:51:18,585 [INFO]: 	index_path: knn.index
2025-03-13 14:51:18,585 [INFO]: 	size in bytes: 557965510
2025-03-13 14:51:18,585 [INFO]: 	avg_search_speed_ms: 12.68974689324741
2025-03-13 14:51:18,585 [INFO]: 	99p_search_speed_ms: 24.951377739198506
2025-03-13 14:51:18,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:18,585 [INFO]: 	nb vectors: 2836
2025-03-13 14:51:18,585 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:18,585 [INFO]: 	compression ratio: 0.9993095953188934
2025-03-13 14:51:18,585 [INFO]: }
2025-03-13 14:51:18,585 [INFO]: 	>>> Finished "Creating the index" in 56.1770 secs
2025-03-13 14:51:18,585 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2033 secs
2025-03-13 14:51:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 11153 [episode count 16/20]
[retrieval_preprocessing] for episode 60317 [episode count 17/20], we have num_retrieval=np.int64(2802) num_query=np.int64(140)
2025-03-13 14:51:21,003 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:21,765 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:21
2025-03-13 14:51:21,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.79it/s]
2025-03-13 14:51:21,789 [INFO]: There are 2802 embeddings of dim 49152
2025-03-13 14:51:21,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 14:51:21,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:21
2025-03-13 14:51:21,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:21,790 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:51:21,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:21,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:21,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:21
2025-03-13 14:51:21,790 [INFO]: 578.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:21,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:21,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:21
2025-03-13 14:51:21,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:21,790 [INFO]: 	Creating the index 03/13/2025, 14:51:21
2025-03-13 14:51:21,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:21
2025-03-13 14:51:21,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:51:21,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:21
2025-03-13 14:51:21,791 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:51:21,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.62it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.94it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.06it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.61it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.80it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.81it/s]100%|██████████| 12/12 [00:03<00:00,  3.63it/s]
2025-03-13 14:51:25,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:25
2025-03-13 14:51:55,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6911 secs
2025-03-13 14:51:55,788 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 14:51:55,789 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 14:52:17,272 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4837 secs
2025-03-13 14:52:17,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4834 secs
2025-03-13 14:52:17,275 [INFO]: {
2025-03-13 14:52:17,275 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:17,275 [INFO]: 	index_param: efSearch=228
2025-03-13 14:52:17,275 [INFO]: 	index_path: knn.index
2025-03-13 14:52:17,275 [INFO]: 	size in bytes: 551276170
2025-03-13 14:52:17,275 [INFO]: 	avg_search_speed_ms: 9.991641029842071
2025-03-13 14:52:17,275 [INFO]: 	99p_search_speed_ms: 15.384215861558914
2025-03-13 14:52:17,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:17,275 [INFO]: 	nb vectors: 2802
2025-03-13 14:52:17,275 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:17,275 [INFO]: 	compression ratio: 0.9993096853796528
2025-03-13 14:52:17,275 [INFO]: }
2025-03-13 14:52:17,275 [INFO]: 	>>> Finished "Creating the index" in 55.4849 secs
2025-03-13 14:52:17,275 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5102 secs
2025-03-13 14:52:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 60317 [episode count 17/20]
[retrieval_preprocessing] for episode 12716 [episode count 18/20], we have num_retrieval=np.int64(2817) num_query=np.int64(125)
2025-03-13 14:52:20,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:20,847 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:20
2025-03-13 14:52:20,848 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.96it/s]
2025-03-13 14:52:20,882 [INFO]: There are 2817 embeddings of dim 49152
2025-03-13 14:52:20,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 14:52:20,882 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:20
2025-03-13 14:52:20,882 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:20,883 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:52:20,883 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:20,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:52:20,883 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:20
2025-03-13 14:52:20,883 [INFO]: 581.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:20,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:52:20,884 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:20
2025-03-13 14:52:20,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:20,884 [INFO]: 	Creating the index 03/13/2025, 14:52:20
2025-03-13 14:52:20,884 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:20
2025-03-13 14:52:20,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:52:20,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:20
2025-03-13 14:52:20,887 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:52:20,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.01it/s] 17%|█▋        | 2/12 [00:00<00:02,  4.74it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.10it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.78it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.30it/s] 50%|█████     | 6/12 [00:00<00:00,  6.86it/s] 58%|█████▊    | 7/12 [00:01<00:00,  7.49it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.45it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.85it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.40it/s]100%|██████████| 12/12 [00:04<00:00,  1.29it/s]100%|██████████| 12/12 [00:04<00:00,  2.79it/s]
2025-03-13 14:52:25,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:25
2025-03-13 14:53:01,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1990 secs
2025-03-13 14:53:01,469 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 14:53:01,469 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 14:53:26,934 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4653 secs
2025-03-13 14:53:27,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5015 secs
2025-03-13 14:53:27,389 [INFO]: {
2025-03-13 14:53:27,389 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:27,389 [INFO]: 	index_param: efSearch=271
2025-03-13 14:53:27,389 [INFO]: 	index_path: knn.index
2025-03-13 14:53:27,389 [INFO]: 	size in bytes: 554227270
2025-03-13 14:53:27,389 [INFO]: 	avg_search_speed_ms: 11.593497473194004
2025-03-13 14:53:27,389 [INFO]: 	99p_search_speed_ms: 15.880018081516027
2025-03-13 14:53:27,389 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:27,389 [INFO]: 	nb vectors: 2817
2025-03-13 14:53:27,389 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:27,389 [INFO]: 	compression ratio: 0.9993097885638142
2025-03-13 14:53:27,390 [INFO]: }
2025-03-13 14:53:27,390 [INFO]: 	>>> Finished "Creating the index" in 66.5058 secs
2025-03-13 14:53:27,390 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5420 secs
2025-03-13 14:53:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 12716 [episode count 18/20]
[retrieval_preprocessing] for episode 47025 [episode count 19/20], we have num_retrieval=np.int64(2785) num_query=np.int64(157)
2025-03-13 14:53:29,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:30,395 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:30
2025-03-13 14:53:30,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.90it/s]
2025-03-13 14:53:30,416 [INFO]: There are 2785 embeddings of dim 49152
2025-03-13 14:53:30,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-13 14:53:30,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:30
2025-03-13 14:53:30,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:30,416 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:53:30,416 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:30,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:30,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:30
2025-03-13 14:53:30,417 [INFO]: 574.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:30,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:30,417 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:30
2025-03-13 14:53:30,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:30,417 [INFO]: 	Creating the index 03/13/2025, 14:53:30
2025-03-13 14:53:30,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:30
2025-03-13 14:53:30,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:53:30,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:30
2025-03-13 14:53:30,418 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:53:30,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.11it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.59it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.23it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.24it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.69it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.97it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.67it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.27it/s] 82%|████████▏ | 9/11 [00:01<00:00,  6.84it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.28it/s]100%|██████████| 11/11 [00:03<00:00,  1.51it/s]100%|██████████| 11/11 [00:03<00:00,  3.40it/s]
2025-03-13 14:53:33,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:33
2025-03-13 14:54:01,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2785 secs
2025-03-13 14:54:01,937 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 14:54:01,937 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.83it/s]
2025-03-13 14:54:22,449 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5110 secs
2025-03-13 14:54:22,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0334 secs
2025-03-13 14:54:22,451 [INFO]: {
2025-03-13 14:54:22,451 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:22,451 [INFO]: 	index_param: efSearch=288
2025-03-13 14:54:22,452 [INFO]: 	index_path: knn.index
2025-03-13 14:54:22,452 [INFO]: 	size in bytes: 547931410
2025-03-13 14:54:22,452 [INFO]: 	avg_search_speed_ms: 11.440619173326663
2025-03-13 14:54:22,452 [INFO]: 	99p_search_speed_ms: 20.646896683610976
2025-03-13 14:54:22,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:22,452 [INFO]: 	nb vectors: 2785
2025-03-13 14:54:22,452 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:22,452 [INFO]: 	compression ratio: 0.9993098953754084
2025-03-13 14:54:22,452 [INFO]: }
2025-03-13 14:54:22,452 [INFO]: 	>>> Finished "Creating the index" in 52.0350 secs
2025-03-13 14:54:22,452 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0570 secs
2025-03-13 14:54:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 47025 [episode count 19/20]
2025-03-13 14:54:24: [retrieval_preprocessing] finished for 4068510503_purple_object_to_bowl [chosen_id count 0/196]
2025-03-13 14:54:31: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4130977918_fold_towel [chosen_id count 1/196]
2025-03-13 14:54:31: [retrieval_preprocessing] we have num_total=7129 embedding_dim=49152
[retrieval_preprocessing] for episode 23068 [episode count 0/20], we have num_retrieval=np.int64(6585) num_query=np.int64(544)
2025-03-13 14:54:34,383 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:35,677 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:35
2025-03-13 14:54:35,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-13 14:54:35,711 [INFO]: There are 6585 embeddings of dim 49152
2025-03-13 14:54:35,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 14:54:35,712 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:35
2025-03-13 14:54:35,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:35,712 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 14:54:35,712 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:35,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:54:35,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:35
2025-03-13 14:54:35,712 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:35,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:54:35,712 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:35
2025-03-13 14:54:35,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:35,712 [INFO]: 	Creating the index 03/13/2025, 14:54:35
2025-03-13 14:54:35,713 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:35
2025-03-13 14:54:35,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 14:54:35,715 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:35
2025-03-13 14:54:35,715 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 14:54:35,715 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.72it/s]  7%|▋         | 2/27 [00:00<00:04,  5.99it/s] 11%|█         | 3/27 [00:00<00:04,  5.88it/s] 15%|█▍        | 4/27 [00:00<00:03,  5.86it/s] 19%|█▊        | 5/27 [00:00<00:03,  6.21it/s] 22%|██▏       | 6/27 [00:00<00:03,  6.56it/s] 26%|██▌       | 7/27 [00:01<00:02,  6.81it/s] 30%|██▉       | 8/27 [00:01<00:02,  6.74it/s] 33%|███▎      | 9/27 [00:01<00:02,  6.79it/s] 37%|███▋      | 10/27 [00:01<00:02,  7.23it/s] 41%|████      | 11/27 [00:01<00:02,  7.25it/s] 44%|████▍     | 12/27 [00:01<00:02,  7.16it/s] 48%|████▊     | 13/27 [00:01<00:01,  7.07it/s] 52%|█████▏    | 14/27 [00:02<00:01,  7.04it/s] 56%|█████▌    | 15/27 [00:02<00:01,  7.10it/s] 59%|█████▉    | 16/27 [00:02<00:01,  7.27it/s] 63%|██████▎   | 17/27 [00:02<00:01,  7.13it/s] 67%|██████▋   | 18/27 [00:02<00:01,  7.18it/s] 70%|███████   | 19/27 [00:02<00:01,  7.17it/s] 74%|███████▍  | 20/27 [00:02<00:00,  7.20it/s] 78%|███████▊  | 21/27 [00:07<00:09,  1.55s/it] 81%|████████▏ | 22/27 [00:09<00:08,  1.61s/it] 93%|█████████▎| 25/27 [00:09<00:01,  1.38it/s]100%|██████████| 27/27 [00:12<00:00,  1.03it/s]100%|██████████| 27/27 [00:12<00:00,  2.16it/s]
2025-03-13 14:54:48,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:48
2025-03-13 14:56:12,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.7218 secs
2025-03-13 14:56:12,924 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 14:56:12,924 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:13,  4.39s/it] 50%|█████     | 2/4 [00:05<00:05,  2.71s/it] 75%|███████▌  | 3/4 [00:06<00:01,  1.54s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.54s/it]
2025-03-13 14:56:56,935 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0107 secs
2025-03-13 14:56:56,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.2259 secs
2025-03-13 14:56:56,941 [INFO]: {
2025-03-13 14:56:56,941 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:56,941 [INFO]: 	index_param: efSearch=183
2025-03-13 14:56:56,941 [INFO]: 	index_path: knn.index
2025-03-13 14:56:56,941 [INFO]: 	size in bytes: 1295559670
2025-03-13 14:56:56,941 [INFO]: 	avg_search_speed_ms: 12.143711113875044
2025-03-13 14:56:56,941 [INFO]: 	99p_search_speed_ms: 19.028631388209757
2025-03-13 14:56:56,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:56,941 [INFO]: 	nb vectors: 6585
2025-03-13 14:56:56,941 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:56,941 [INFO]: 	compression ratio: 0.9993084147177875
2025-03-13 14:56:56,941 [INFO]: }
2025-03-13 14:56:56,941 [INFO]: 	>>> Finished "Creating the index" in 141.2285 secs
2025-03-13 14:56:56,941 [INFO]: >>> Finished "Launching the whole pipeline" in 141.2643 secs
2025-03-13 14:57:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 23068 [episode count 0/20]
[retrieval_preprocessing] for episode 22558 [episode count 1/20], we have num_retrieval=np.int64(6827) num_query=np.int64(302)
2025-03-13 14:57:22,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:23,516 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:23
2025-03-13 14:57:23,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1087.73it/s]
2025-03-13 14:57:23,544 [INFO]: There are 6827 embeddings of dim 49152
2025-03-13 14:57:23,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:57:23,544 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:23
2025-03-13 14:57:23,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:23,545 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 14:57:23,545 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:23,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:57:23,545 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:23
2025-03-13 14:57:23,545 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:23,545 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:57:23,545 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:23
2025-03-13 14:57:23,545 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:23,545 [INFO]: 	Creating the index 03/13/2025, 14:57:23
2025-03-13 14:57:23,545 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:23
2025-03-13 14:57:23,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:57:23,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:23
2025-03-13 14:57:23,547 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:57:23,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.55it/s]  7%|▋         | 2/28 [00:00<00:03,  6.61it/s] 11%|█         | 3/28 [00:00<00:03,  7.45it/s] 14%|█▍        | 4/28 [00:00<00:03,  7.92it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.21it/s] 25%|██▌       | 7/28 [00:00<00:02, 10.29it/s] 32%|███▏      | 9/28 [00:01<00:02,  9.46it/s] 36%|███▌      | 10/28 [00:01<00:01,  9.05it/s] 39%|███▉      | 11/28 [00:01<00:01,  8.64it/s] 43%|████▎     | 12/28 [00:01<00:01,  8.82it/s] 50%|█████     | 14/28 [00:01<00:01,  9.51it/s] 54%|█████▎    | 15/28 [00:01<00:01,  9.57it/s] 61%|██████    | 17/28 [00:01<00:01, 10.04it/s] 68%|██████▊   | 19/28 [00:03<00:03,  2.91it/s] 71%|███████▏  | 20/28 [00:05<00:05,  1.51it/s] 75%|███████▌  | 21/28 [00:09<00:09,  1.41s/it] 79%|███████▊  | 22/28 [00:09<00:06,  1.11s/it] 86%|████████▌ | 24/28 [00:11<00:04,  1.12s/it] 89%|████████▉ | 25/28 [00:15<00:04,  1.66s/it] 93%|█████████▎| 26/28 [00:17<00:03,  1.83s/it] 96%|█████████▋| 27/28 [00:18<00:01,  1.57s/it]100%|██████████| 28/28 [00:20<00:00,  1.65s/it]100%|██████████| 28/28 [00:20<00:00,  1.38it/s]
2025-03-13 14:57:43,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:43
2025-03-13 14:58:58,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.2124 secs
2025-03-13 14:58:58,026 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 14:58:58,026 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.97it/s]
2025-03-13 14:59:38,072 [INFO]: 	>>> Finished "Compute fast metrics" in 40.0456 secs
2025-03-13 14:59:38,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.5360 secs
2025-03-13 14:59:38,083 [INFO]: {
2025-03-13 14:59:38,083 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:38,083 [INFO]: 	index_param: efSearch=219
2025-03-13 14:59:38,083 [INFO]: 	index_path: knn.index
2025-03-13 14:59:38,083 [INFO]: 	size in bytes: 1343171650
2025-03-13 14:59:38,083 [INFO]: 	avg_search_speed_ms: 13.347961878321955
2025-03-13 14:59:38,083 [INFO]: 	99p_search_speed_ms: 23.698036354035136
2025-03-13 14:59:38,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:38,083 [INFO]: 	nb vectors: 6827
2025-03-13 14:59:38,083 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:38,083 [INFO]: 	compression ratio: 0.9993084770662037
2025-03-13 14:59:38,083 [INFO]: }
2025-03-13 14:59:38,083 [INFO]: 	>>> Finished "Creating the index" in 134.5379 secs
2025-03-13 14:59:38,083 [INFO]: >>> Finished "Launching the whole pipeline" in 134.5672 secs
2025-03-13 14:59:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 22558 [episode count 1/20]
[retrieval_preprocessing] for episode 59956 [episode count 2/20], we have num_retrieval=np.int64(6795) num_query=np.int64(334)
2025-03-13 14:59:42,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:44,560 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:44
2025-03-13 14:59:44,560 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.50it/s]
2025-03-13 14:59:44,605 [INFO]: There are 6795 embeddings of dim 49152
2025-03-13 14:59:44,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0452 secs
2025-03-13 14:59:44,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:44
2025-03-13 14:59:44,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:44,606 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 14:59:44,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:44,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:59:44,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:44
2025-03-13 14:59:44,606 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:44,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:44,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:44
2025-03-13 14:59:44,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:44,606 [INFO]: 	Creating the index 03/13/2025, 14:59:44
2025-03-13 14:59:44,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:44
2025-03-13 14:59:44,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:59:44,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:44
2025-03-13 14:59:44,608 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 14:59:44,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  6.91it/s] 21%|██▏       | 6/28 [00:00<00:00, 25.18it/s] 39%|███▉      | 11/28 [00:00<00:00, 32.39it/s] 57%|█████▋    | 16/28 [00:00<00:00, 36.20it/s] 75%|███████▌  | 21/28 [00:06<00:03,  1.99it/s] 89%|████████▉ | 25/28 [00:06<00:01,  2.79it/s]100%|██████████| 28/28 [00:09<00:00,  1.95it/s]100%|██████████| 28/28 [00:09<00:00,  2.84it/s]
2025-03-13 14:59:55,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:55
2025-03-13 15:01:13,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.5390 secs
2025-03-13 15:01:13,830 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 15:01:13,830 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.69it/s]
2025-03-13 15:02:11,658 [INFO]: 	>>> Finished "Compute fast metrics" in 57.8276 secs
2025-03-13 15:02:11,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.0517 secs
2025-03-13 15:02:11,660 [INFO]: {
2025-03-13 15:02:11,660 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:11,660 [INFO]: 	index_param: efSearch=165
2025-03-13 15:02:11,660 [INFO]: 	index_path: knn.index
2025-03-13 15:02:11,660 [INFO]: 	size in bytes: 1336875910
2025-03-13 15:02:11,660 [INFO]: 	avg_search_speed_ms: 9.728829441854824
2025-03-13 15:02:11,660 [INFO]: 	99p_search_speed_ms: 13.079574129078537
2025-03-13 15:02:11,660 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:11,660 [INFO]: 	nb vectors: 6795
2025-03-13 15:02:11,660 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:11,660 [INFO]: 	compression ratio: 0.9993084249681783
2025-03-13 15:02:11,660 [INFO]: }
2025-03-13 15:02:11,660 [INFO]: 	>>> Finished "Creating the index" in 147.0539 secs
2025-03-13 15:02:11,660 [INFO]: >>> Finished "Launching the whole pipeline" in 147.1000 secs
2025-03-13 15:02:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 59956 [episode count 2/20]
[retrieval_preprocessing] for episode 33348 [episode count 3/20], we have num_retrieval=np.int64(6798) num_query=np.int64(331)
2025-03-13 15:02:14,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:15,994 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:15
2025-03-13 15:02:15,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 933.52it/s]
2025-03-13 15:02:16,034 [INFO]: There are 6798 embeddings of dim 49152
2025-03-13 15:02:16,034 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 15:02:16,034 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:16,035 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:02:16,035 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:16,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:02:16,035 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,035 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:16,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:02:16,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:16
2025-03-13 15:02:16,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:16,036 [INFO]: 	Creating the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:16
2025-03-13 15:02:16,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:02:16,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,040 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:02:16,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.66it/s] 21%|██▏       | 6/28 [00:00<00:00, 32.69it/s] 39%|███▉      | 11/28 [00:00<00:00, 39.86it/s] 57%|█████▋    | 16/28 [00:00<00:00, 43.26it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.18it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.75it/s]100%|██████████| 28/28 [00:06<00:00,  4.33it/s]
2025-03-13 15:02:22,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:22
2025-03-13 15:03:31,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1372 secs
2025-03-13 15:03:31,644 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 15:03:31,644 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.72it/s]
2025-03-13 15:03:58,706 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0616 secs
2025-03-13 15:03:58,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.6684 secs
2025-03-13 15:03:58,708 [INFO]: {
2025-03-13 15:03:58,708 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:58,708 [INFO]: 	index_param: efSearch=129
2025-03-13 15:03:58,708 [INFO]: 	index_path: knn.index
2025-03-13 15:03:58,708 [INFO]: 	size in bytes: 1337466130
2025-03-13 15:03:58,708 [INFO]: 	avg_search_speed_ms: 12.107420671555342
2025-03-13 15:03:58,708 [INFO]: 	99p_search_speed_ms: 17.69348722882569
2025-03-13 15:03:58,708 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:58,708 [INFO]: 	nb vectors: 6798
2025-03-13 15:03:58,708 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:58,708 [INFO]: 	compression ratio: 0.9993084340760091
2025-03-13 15:03:58,709 [INFO]: }
2025-03-13 15:03:58,709 [INFO]: 	>>> Finished "Creating the index" in 102.6724 secs
2025-03-13 15:03:58,709 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7144 secs
2025-03-13 15:03:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 33348 [episode count 3/20]
[retrieval_preprocessing] for episode 88663 [episode count 4/20], we have num_retrieval=np.int64(6702) num_query=np.int64(427)
2025-03-13 15:04:02,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:03,654 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:03
2025-03-13 15:04:03,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1669.04it/s]
2025-03-13 15:04:03,689 [INFO]: There are 6702 embeddings of dim 49152
2025-03-13 15:04:03,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 15:04:03,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:03
2025-03-13 15:04:03,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:03,689 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:04:03,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:03,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:03,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:03
2025-03-13 15:04:03,690 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:03,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:04:03,690 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:03
2025-03-13 15:04:03,690 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:03,690 [INFO]: 	Creating the index 03/13/2025, 15:04:03
2025-03-13 15:04:03,690 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:03
2025-03-13 15:04:03,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:04:03,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:03
2025-03-13 15:04:03,691 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:04:03,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.38it/s] 21%|██▏       | 6/28 [00:00<00:00, 24.80it/s] 39%|███▉      | 11/28 [00:00<00:00, 32.46it/s] 54%|█████▎    | 15/28 [00:00<00:00, 34.51it/s] 68%|██████▊   | 19/28 [00:00<00:00, 35.48it/s] 82%|████████▏ | 23/28 [00:05<00:02,  2.22it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.19it/s]100%|██████████| 28/28 [00:08<00:00,  3.46it/s]
2025-03-13 15:04:11,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:11
2025-03-13 15:05:13,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6029 secs
2025-03-13 15:05:13,382 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:05:13,382 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.64s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.28s/it]
2025-03-13 15:05:44,039 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6568 secs
2025-03-13 15:05:44,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.3494 secs
2025-03-13 15:05:44,041 [INFO]: {
2025-03-13 15:05:44,041 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:44,041 [INFO]: 	index_param: efSearch=187
2025-03-13 15:05:44,041 [INFO]: 	index_path: knn.index
2025-03-13 15:05:44,041 [INFO]: 	size in bytes: 1318578790
2025-03-13 15:05:44,041 [INFO]: 	avg_search_speed_ms: 19.726939236238245
2025-03-13 15:05:44,041 [INFO]: 	99p_search_speed_ms: 43.842774480581284
2025-03-13 15:05:44,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:44,041 [INFO]: 	nb vectors: 6702
2025-03-13 15:05:44,041 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:44,041 [INFO]: 	compression ratio: 0.9993083659414846
2025-03-13 15:05:44,041 [INFO]: }
2025-03-13 15:05:44,041 [INFO]: 	>>> Finished "Creating the index" in 100.3511 secs
2025-03-13 15:05:44,041 [INFO]: >>> Finished "Launching the whole pipeline" in 100.3869 secs
2025-03-13 15:05:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 88663 [episode count 4/20]
[retrieval_preprocessing] for episode 88158 [episode count 5/20], we have num_retrieval=np.int64(6702) num_query=np.int64(427)
2025-03-13 15:05:48,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:49,823 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:49
2025-03-13 15:05:49,824 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-13 15:05:49,861 [INFO]: There are 6702 embeddings of dim 49152
2025-03-13 15:05:49,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 15:05:49,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:49
2025-03-13 15:05:49,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:49,861 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:05:49,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:49,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:05:49,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:49
2025-03-13 15:05:49,861 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:49,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:05:49,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:49
2025-03-13 15:05:49,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:49,861 [INFO]: 	Creating the index 03/13/2025, 15:05:49
2025-03-13 15:05:49,861 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:49
2025-03-13 15:05:49,862 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:05:49,862 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:49
2025-03-13 15:05:49,862 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:05:49,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.32it/s] 21%|██▏       | 6/28 [00:00<00:00, 27.16it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.41it/s] 57%|█████▋    | 16/28 [00:00<00:00, 39.53it/s] 75%|███████▌  | 21/28 [00:04<00:02,  2.74it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.84it/s]100%|██████████| 28/28 [00:06<00:00,  4.04it/s]
2025-03-13 15:05:56,794 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:56
2025-03-13 15:06:54,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9790 secs
2025-03-13 15:06:54,774 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:06:54,775 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 15:07:32,636 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8612 secs
2025-03-13 15:07:32,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.7754 secs
2025-03-13 15:07:32,638 [INFO]: {
2025-03-13 15:07:32,638 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:32,638 [INFO]: 	index_param: efSearch=190
2025-03-13 15:07:32,638 [INFO]: 	index_path: knn.index
2025-03-13 15:07:32,638 [INFO]: 	size in bytes: 1318578790
2025-03-13 15:07:32,638 [INFO]: 	avg_search_speed_ms: 15.865205626244023
2025-03-13 15:07:32,638 [INFO]: 	99p_search_speed_ms: 25.588895170949403
2025-03-13 15:07:32,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:32,638 [INFO]: 	nb vectors: 6702
2025-03-13 15:07:32,638 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:32,638 [INFO]: 	compression ratio: 0.9993083659414846
2025-03-13 15:07:32,638 [INFO]: }
2025-03-13 15:07:32,638 [INFO]: 	>>> Finished "Creating the index" in 102.7767 secs
2025-03-13 15:07:32,638 [INFO]: >>> Finished "Launching the whole pipeline" in 102.8146 secs
2025-03-13 15:07:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 88158 [episode count 5/20]
[retrieval_preprocessing] for episode 69728 [episode count 6/20], we have num_retrieval=np.int64(6684) num_query=np.int64(445)
2025-03-13 15:07:38,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:40,025 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:40
2025-03-13 15:07:40,026 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-13 15:07:40,063 [INFO]: There are 6684 embeddings of dim 49152
2025-03-13 15:07:40,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 15:07:40,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:40
2025-03-13 15:07:40,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:40,063 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:07:40,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:40,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:40,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:40
2025-03-13 15:07:40,063 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:40,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:40,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:40
2025-03-13 15:07:40,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:40,063 [INFO]: 	Creating the index 03/13/2025, 15:07:40
2025-03-13 15:07:40,063 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:40
2025-03-13 15:07:40,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:07:40,065 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:40
2025-03-13 15:07:40,065 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:07:40,065 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.17it/s] 14%|█▍        | 4/28 [00:00<00:01, 15.60it/s] 29%|██▊       | 8/28 [00:00<00:00, 23.42it/s] 43%|████▎     | 12/28 [00:00<00:00, 27.41it/s] 57%|█████▋    | 16/28 [00:00<00:00, 29.37it/s] 71%|███████▏  | 20/28 [00:00<00:00, 29.26it/s] 82%|████████▏ | 23/28 [00:06<00:03,  1.66it/s]100%|██████████| 28/28 [00:10<00:00,  1.55it/s]100%|██████████| 28/28 [00:10<00:00,  2.66it/s]
2025-03-13 15:07:50,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:50
2025-03-13 15:08:49,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.6455 secs
2025-03-13 15:08:49,226 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 15:08:49,226 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 15:09:14,585 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3594 secs
2025-03-13 15:09:14,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5233 secs
2025-03-13 15:09:14,588 [INFO]: {
2025-03-13 15:09:14,588 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:14,588 [INFO]: 	index_param: efSearch=195
2025-03-13 15:09:14,588 [INFO]: 	index_path: knn.index
2025-03-13 15:09:14,588 [INFO]: 	size in bytes: 1315037410
2025-03-13 15:09:14,588 [INFO]: 	avg_search_speed_ms: 14.748768481139274
2025-03-13 15:09:14,588 [INFO]: 	99p_search_speed_ms: 23.041919679380957
2025-03-13 15:09:14,588 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:14,588 [INFO]: 	nb vectors: 6684
2025-03-13 15:09:14,588 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:14,588 [INFO]: 	compression ratio: 0.9993083557980301
2025-03-13 15:09:14,588 [INFO]: }
2025-03-13 15:09:14,588 [INFO]: 	>>> Finished "Creating the index" in 94.5249 secs
2025-03-13 15:09:14,588 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5627 secs
2025-03-13 15:09:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 69728 [episode count 6/20]
[retrieval_preprocessing] for episode 50288 [episode count 7/20], we have num_retrieval=np.int64(6885) num_query=np.int64(244)
2025-03-13 15:09:24,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:25,849 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:25
2025-03-13 15:09:25,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1030.54it/s]
2025-03-13 15:09:25,878 [INFO]: There are 6885 embeddings of dim 49152
2025-03-13 15:09:25,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:09:25,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:25
2025-03-13 15:09:25,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:25,879 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 15:09:25,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:25,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:25,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:25
2025-03-13 15:09:25,879 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:25,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:25,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:25
2025-03-13 15:09:25,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:25,879 [INFO]: 	Creating the index 03/13/2025, 15:09:25
2025-03-13 15:09:25,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:25
2025-03-13 15:09:25,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:09:25,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:25
2025-03-13 15:09:25,881 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:09:25,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.88it/s] 10%|█         | 3/29 [00:00<00:02, 10.62it/s] 21%|██        | 6/29 [00:00<00:01, 16.93it/s] 34%|███▍      | 10/29 [00:00<00:00, 24.09it/s] 48%|████▊     | 14/29 [00:00<00:00, 28.48it/s] 62%|██████▏   | 18/29 [00:00<00:00, 31.71it/s] 76%|███████▌  | 22/29 [00:06<00:03,  2.02it/s] 86%|████████▌ | 25/29 [00:06<00:01,  2.65it/s] 93%|█████████▎| 27/29 [00:06<00:00,  3.18it/s]100%|██████████| 29/29 [00:08<00:00,  2.03it/s]100%|██████████| 29/29 [00:08<00:00,  3.36it/s]
2025-03-13 15:09:34,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:34
2025-03-13 15:10:39,470 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.9419 secs
2025-03-13 15:10:39,470 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 15:10:39,470 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 15:11:05,913 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4428 secs
2025-03-13 15:11:05,915 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.0345 secs
2025-03-13 15:11:05,915 [INFO]: {
2025-03-13 15:11:05,915 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:05,915 [INFO]: 	index_param: efSearch=235
2025-03-13 15:11:05,915 [INFO]: 	index_path: knn.index
2025-03-13 15:11:05,915 [INFO]: 	size in bytes: 1354582810
2025-03-13 15:11:05,915 [INFO]: 	avg_search_speed_ms: 15.38234922175224
2025-03-13 15:11:05,915 [INFO]: 	99p_search_speed_ms: 22.729879789985713
2025-03-13 15:11:05,915 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:05,915 [INFO]: 	nb vectors: 6885
2025-03-13 15:11:05,915 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:05,915 [INFO]: 	compression ratio: 0.9993084734332337
2025-03-13 15:11:05,915 [INFO]: }
2025-03-13 15:11:05,915 [INFO]: 	>>> Finished "Creating the index" in 100.0362 secs
2025-03-13 15:11:05,915 [INFO]: >>> Finished "Launching the whole pipeline" in 100.0663 secs
2025-03-13 15:11:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 50288 [episode count 7/20]
[retrieval_preprocessing] for episode 77430 [episode count 8/20], we have num_retrieval=np.int64(6822) num_query=np.int64(307)
2025-03-13 15:11:09,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:10,863 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:10
2025-03-13 15:11:10,863 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.43it/s]
2025-03-13 15:11:10,911 [INFO]: There are 6822 embeddings of dim 49152
2025-03-13 15:11:10,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0482 secs
2025-03-13 15:11:10,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:10
2025-03-13 15:11:10,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:10,911 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:11:10,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:10,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:11:10,912 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:10
2025-03-13 15:11:10,912 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:10,912 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:11:10,912 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:10
2025-03-13 15:11:10,912 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:10,912 [INFO]: 	Creating the index 03/13/2025, 15:11:10
2025-03-13 15:11:10,912 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:10
2025-03-13 15:11:10,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:11:10,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:10
2025-03-13 15:11:10,915 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:11:10,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.33it/s] 18%|█▊        | 5/28 [00:00<00:01, 22.65it/s] 36%|███▌      | 10/28 [00:00<00:00, 31.37it/s] 54%|█████▎    | 15/28 [00:00<00:00, 35.46it/s] 71%|███████▏  | 20/28 [00:00<00:00, 37.79it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.63it/s]100%|██████████| 28/28 [00:07<00:00,  2.30it/s]100%|██████████| 28/28 [00:07<00:00,  3.75it/s]
2025-03-13 15:11:18,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:18
2025-03-13 15:12:28,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.1043 secs
2025-03-13 15:12:28,498 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:12:28,498 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 15:12:47,766 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2682 secs
2025-03-13 15:12:47,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.8528 secs
2025-03-13 15:12:47,768 [INFO]: {
2025-03-13 15:12:47,768 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:47,768 [INFO]: 	index_param: efSearch=192
2025-03-13 15:12:47,768 [INFO]: 	index_path: knn.index
2025-03-13 15:12:47,768 [INFO]: 	size in bytes: 1342187950
2025-03-13 15:12:47,768 [INFO]: 	avg_search_speed_ms: 13.722609212450857
2025-03-13 15:12:47,768 [INFO]: 	99p_search_speed_ms: 19.36868782155216
2025-03-13 15:12:47,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:47,768 [INFO]: 	nb vectors: 6822
2025-03-13 15:12:47,768 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:47,768 [INFO]: 	compression ratio: 0.999308461978071
2025-03-13 15:12:47,768 [INFO]: }
2025-03-13 15:12:47,768 [INFO]: 	>>> Finished "Creating the index" in 96.8558 secs
2025-03-13 15:12:47,768 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9053 secs
2025-03-13 15:12:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 77430 [episode count 8/20]
[retrieval_preprocessing] for episode 18046 [episode count 9/20], we have num_retrieval=np.int64(6925) num_query=np.int64(204)
2025-03-13 15:12:51,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:52,208 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:52
2025-03-13 15:12:52,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1378.35it/s]
2025-03-13 15:12:52,244 [INFO]: There are 6925 embeddings of dim 49152
2025-03-13 15:12:52,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 15:12:52,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:52
2025-03-13 15:12:52,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:52,244 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 15:12:52,244 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:52,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:52,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:52
2025-03-13 15:12:52,245 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:52,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:12:52,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:52
2025-03-13 15:12:52,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:52,245 [INFO]: 	Creating the index 03/13/2025, 15:12:52
2025-03-13 15:12:52,245 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:52
2025-03-13 15:12:52,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:12:52,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:52
2025-03-13 15:12:52,246 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:12:52,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.67it/s] 21%|██        | 6/29 [00:00<00:00, 23.60it/s] 38%|███▊      | 11/29 [00:00<00:00, 31.43it/s] 55%|█████▌    | 16/29 [00:00<00:00, 35.66it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.35it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.29it/s]100%|██████████| 29/29 [00:08<00:00,  2.49it/s]100%|██████████| 29/29 [00:08<00:00,  3.44it/s]
2025-03-13 15:13:00,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:00
2025-03-13 15:14:00,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3734 secs
2025-03-13 15:14:00,051 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:14:00,051 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.47it/s]
2025-03-13 15:14:48,094 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0432 secs
2025-03-13 15:14:48,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.1806 secs
2025-03-13 15:14:48,428 [INFO]: {
2025-03-13 15:14:48,428 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:48,428 [INFO]: 	index_param: efSearch=187
2025-03-13 15:14:48,428 [INFO]: 	index_path: knn.index
2025-03-13 15:14:48,428 [INFO]: 	size in bytes: 1362452770
2025-03-13 15:14:48,428 [INFO]: 	avg_search_speed_ms: 16.76489247034118
2025-03-13 15:14:48,428 [INFO]: 	99p_search_speed_ms: 31.182170519605194
2025-03-13 15:14:48,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:48,429 [INFO]: 	nb vectors: 6925
2025-03-13 15:14:48,429 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:48,429 [INFO]: 	compression ratio: 0.9993083283173185
2025-03-13 15:14:48,429 [INFO]: }
2025-03-13 15:14:48,429 [INFO]: 	>>> Finished "Creating the index" in 116.1840 secs
2025-03-13 15:14:48,429 [INFO]: >>> Finished "Launching the whole pipeline" in 116.2206 secs
2025-03-13 15:14:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 18046 [episode count 9/20]
[retrieval_preprocessing] for episode 53939 [episode count 10/20], we have num_retrieval=np.int64(6857) num_query=np.int64(272)
2025-03-13 15:14:53,097 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:54,635 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:54
2025-03-13 15:14:54,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.50it/s]
2025-03-13 15:14:54,688 [INFO]: There are 6857 embeddings of dim 49152
2025-03-13 15:14:54,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0536 secs
2025-03-13 15:14:54,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:54
2025-03-13 15:14:54,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:54,689 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 15:14:54,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:54,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:54,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:54
2025-03-13 15:14:54,689 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:54,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:14:54,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:54
2025-03-13 15:14:54,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:54,689 [INFO]: 	Creating the index 03/13/2025, 15:14:54
2025-03-13 15:14:54,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:54
2025-03-13 15:14:54,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:14:54,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:54
2025-03-13 15:14:54,691 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:14:54,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.34it/s] 21%|██▏       | 6/28 [00:00<00:00, 23.08it/s] 39%|███▉      | 11/28 [00:00<00:00, 30.79it/s] 57%|█████▋    | 16/28 [00:00<00:00, 34.96it/s] 75%|███████▌  | 21/28 [00:04<00:02,  2.93it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.38it/s]100%|██████████| 28/28 [00:07<00:00,  3.85it/s]
2025-03-13 15:15:01,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:01
2025-03-13 15:16:13,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.1263 secs
2025-03-13 15:16:13,104 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:16:13,104 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 15:16:39,337 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2332 secs
2025-03-13 15:16:39,899 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.2083 secs
2025-03-13 15:16:39,899 [INFO]: {
2025-03-13 15:16:39,899 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:39,899 [INFO]: 	index_param: efSearch=207
2025-03-13 15:16:39,900 [INFO]: 	index_path: knn.index
2025-03-13 15:16:39,900 [INFO]: 	size in bytes: 1349073970
2025-03-13 15:16:39,900 [INFO]: 	avg_search_speed_ms: 11.925292643413162
2025-03-13 15:16:39,900 [INFO]: 	99p_search_speed_ms: 17.669976837933064
2025-03-13 15:16:39,900 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:39,900 [INFO]: 	nb vectors: 6857
2025-03-13 15:16:39,900 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:39,900 [INFO]: 	compression ratio: 0.9993084782445251
2025-03-13 15:16:39,900 [INFO]: }
2025-03-13 15:16:39,900 [INFO]: 	>>> Finished "Creating the index" in 105.2107 secs
2025-03-13 15:16:39,900 [INFO]: >>> Finished "Launching the whole pipeline" in 105.2651 secs
2025-03-13 15:16:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 53939 [episode count 10/20]
[retrieval_preprocessing] for episode 24764 [episode count 11/20], we have num_retrieval=np.int64(6807) num_query=np.int64(322)
2025-03-13 15:16:43,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:44,163 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:44
2025-03-13 15:16:44,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.86it/s]
2025-03-13 15:16:44,197 [INFO]: There are 6807 embeddings of dim 49152
2025-03-13 15:16:44,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 15:16:44,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:44
2025-03-13 15:16:44,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:44,198 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:16:44,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:44,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:44,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:44
2025-03-13 15:16:44,198 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:44,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:16:44,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:44
2025-03-13 15:16:44,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:44,198 [INFO]: 	Creating the index 03/13/2025, 15:16:44
2025-03-13 15:16:44,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:44
2025-03-13 15:16:44,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:16:44,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:44
2025-03-13 15:16:44,199 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:16:44,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.17it/s] 25%|██▌       | 7/28 [00:00<00:00, 32.08it/s] 43%|████▎     | 12/28 [00:00<00:00, 37.80it/s] 61%|██████    | 17/28 [00:00<00:00, 40.81it/s] 79%|███████▊  | 22/28 [00:04<00:01,  3.05it/s] 96%|█████████▋| 27/28 [00:04<00:00,  4.53it/s]100%|██████████| 28/28 [00:07<00:00,  3.96it/s]
2025-03-13 15:16:51,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:51
2025-03-13 15:18:01,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.4433 secs
2025-03-13 15:18:01,723 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 15:18:01,723 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.56it/s]
2025-03-13 15:18:40,403 [INFO]: 	>>> Finished "Compute fast metrics" in 38.6801 secs
2025-03-13 15:18:40,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.2052 secs
2025-03-13 15:18:40,405 [INFO]: {
2025-03-13 15:18:40,405 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:40,405 [INFO]: 	index_param: efSearch=233
2025-03-13 15:18:40,405 [INFO]: 	index_path: knn.index
2025-03-13 15:18:40,405 [INFO]: 	size in bytes: 1339236850
2025-03-13 15:18:40,405 [INFO]: 	avg_search_speed_ms: 16.43079348070599
2025-03-13 15:18:40,405 [INFO]: 	99p_search_speed_ms: 25.694854902103533
2025-03-13 15:18:40,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:40,405 [INFO]: 	nb vectors: 6807
2025-03-13 15:18:40,405 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:40,405 [INFO]: 	compression ratio: 0.9993084165806817
2025-03-13 15:18:40,405 [INFO]: }
2025-03-13 15:18:40,405 [INFO]: 	>>> Finished "Creating the index" in 116.2066 secs
2025-03-13 15:18:40,405 [INFO]: >>> Finished "Launching the whole pipeline" in 116.2414 secs
2025-03-13 15:18:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 24764 [episode count 11/20]
[retrieval_preprocessing] for episode 43713 [episode count 12/20], we have num_retrieval=np.int64(6785) num_query=np.int64(344)
2025-03-13 15:18:45,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:47,639 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:47
2025-03-13 15:18:47,640 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.05it/s]
2025-03-13 15:18:47,677 [INFO]: There are 6785 embeddings of dim 49152
2025-03-13 15:18:47,678 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 15:18:47,678 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,678 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:47,678 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:18:47,678 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:47,678 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:47,678 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,678 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:47,678 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:18:47,678 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:47
2025-03-13 15:18:47,678 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:47,679 [INFO]: 	Creating the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,679 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:47
2025-03-13 15:18:47,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:18:47,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,680 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:18:47,680 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.71it/s] 18%|█▊        | 5/28 [00:00<00:01, 22.76it/s] 36%|███▌      | 10/28 [00:00<00:00, 31.80it/s] 54%|█████▎    | 15/28 [00:00<00:00, 35.21it/s] 71%|███████▏  | 20/28 [00:00<00:00, 37.60it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.76it/s]100%|██████████| 28/28 [00:07<00:00,  2.39it/s]100%|██████████| 28/28 [00:07<00:00,  3.89it/s]
2025-03-13 15:18:54,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:54
2025-03-13 15:19:58,491 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6108 secs
2025-03-13 15:19:58,492 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 15:19:58,492 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.76it/s]
2025-03-13 15:20:27,345 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8528 secs
2025-03-13 15:20:27,347 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.6671 secs
2025-03-13 15:20:27,347 [INFO]: {
2025-03-13 15:20:27,347 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:27,347 [INFO]: 	index_param: efSearch=129
2025-03-13 15:20:27,347 [INFO]: 	index_path: knn.index
2025-03-13 15:20:27,347 [INFO]: 	size in bytes: 1334908450
2025-03-13 15:20:27,347 [INFO]: 	avg_search_speed_ms: 10.788180700582657
2025-03-13 15:20:27,347 [INFO]: 	99p_search_speed_ms: 19.950049524195496
2025-03-13 15:20:27,347 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:27,347 [INFO]: 	nb vectors: 6785
2025-03-13 15:20:27,347 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:27,347 [INFO]: 	compression ratio: 0.9993084394663919
2025-03-13 15:20:27,347 [INFO]: }
2025-03-13 15:20:27,347 [INFO]: 	>>> Finished "Creating the index" in 99.6689 secs
2025-03-13 15:20:27,348 [INFO]: >>> Finished "Launching the whole pipeline" in 99.7080 secs
2025-03-13 15:20:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 43713 [episode count 12/20]
[retrieval_preprocessing] for episode 69080 [episode count 13/20], we have num_retrieval=np.int64(6858) num_query=np.int64(271)
2025-03-13 15:20:31,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:32,472 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:32
2025-03-13 15:20:32,472 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.23it/s]
2025-03-13 15:20:32,513 [INFO]: There are 6858 embeddings of dim 49152
2025-03-13 15:20:32,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0412 secs
2025-03-13 15:20:32,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:32
2025-03-13 15:20:32,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:32,514 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 15:20:32,514 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:32,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:20:32,514 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:32
2025-03-13 15:20:32,514 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:32,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:32,514 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:32
2025-03-13 15:20:32,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:32,514 [INFO]: 	Creating the index 03/13/2025, 15:20:32
2025-03-13 15:20:32,514 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:32
2025-03-13 15:20:32,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:20:32,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:32
2025-03-13 15:20:32,516 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:20:32,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.06it/s] 14%|█▍        | 4/28 [00:00<00:01, 17.01it/s] 29%|██▊       | 8/28 [00:00<00:00, 23.67it/s] 39%|███▉      | 11/28 [00:00<00:00, 25.69it/s] 50%|█████     | 14/28 [00:00<00:00, 26.40it/s] 64%|██████▍   | 18/28 [00:00<00:00, 28.40it/s] 75%|███████▌  | 21/28 [00:05<00:03,  1.99it/s] 82%|████████▏ | 23/28 [00:05<00:02,  2.43it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.07it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.82it/s]100%|██████████| 28/28 [00:08<00:00,  3.35it/s]
2025-03-13 15:20:40,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:40
2025-03-13 15:21:46,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.5618 secs
2025-03-13 15:21:46,450 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:21:46,450 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-13 15:22:27,038 [INFO]: 	>>> Finished "Compute fast metrics" in 40.5885 secs
2025-03-13 15:22:27,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.5242 secs
2025-03-13 15:22:27,040 [INFO]: {
2025-03-13 15:22:27,040 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:27,040 [INFO]: 	index_param: efSearch=211
2025-03-13 15:22:27,040 [INFO]: 	index_path: knn.index
2025-03-13 15:22:27,040 [INFO]: 	size in bytes: 1349270770
2025-03-13 15:22:27,040 [INFO]: 	avg_search_speed_ms: 13.582651918113697
2025-03-13 15:22:27,040 [INFO]: 	99p_search_speed_ms: 19.21124629443511
2025-03-13 15:22:27,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:27,040 [INFO]: 	nb vectors: 6858
2025-03-13 15:22:27,040 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:27,040 [INFO]: 	compression ratio: 0.9993084368084251
2025-03-13 15:22:27,040 [INFO]: }
2025-03-13 15:22:27,040 [INFO]: 	>>> Finished "Creating the index" in 114.5259 secs
2025-03-13 15:22:27,040 [INFO]: >>> Finished "Launching the whole pipeline" in 114.5678 secs
2025-03-13 15:22:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 69080 [episode count 13/20]
[retrieval_preprocessing] for episode 83101 [episode count 14/20], we have num_retrieval=np.int64(6740) num_query=np.int64(389)
2025-03-13 15:22:30,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:31,643 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:31
2025-03-13 15:22:31,643 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.43it/s]
2025-03-13 15:22:31,685 [INFO]: There are 6740 embeddings of dim 49152
2025-03-13 15:22:31,686 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 15:22:31,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:31
2025-03-13 15:22:31,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:31,687 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:22:31,687 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:31,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 15:22:31,687 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:31
2025-03-13 15:22:31,688 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:31,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:22:31,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:31
2025-03-13 15:22:31,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:31,689 [INFO]: 	Creating the index 03/13/2025, 15:22:31
2025-03-13 15:22:31,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:31
2025-03-13 15:22:31,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0046 secs
2025-03-13 15:22:31,694 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:31
2025-03-13 15:22:31,694 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:22:31,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.65it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.82it/s] 39%|███▉      | 11/28 [00:00<00:00, 37.18it/s] 57%|█████▋    | 16/28 [00:00<00:00, 40.60it/s] 75%|███████▌  | 21/28 [00:05<00:02,  2.47it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.46it/s]100%|██████████| 28/28 [00:08<00:00,  3.46it/s]
2025-03-13 15:22:39,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:39
2025-03-13 15:23:44,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3313 secs
2025-03-13 15:23:44,119 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 15:23:44,119 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.72it/s]
2025-03-13 15:24:09,141 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0219 secs
2025-03-13 15:24:09,143 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.4493 secs
2025-03-13 15:24:09,144 [INFO]: {
2025-03-13 15:24:09,144 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:09,144 [INFO]: 	index_param: efSearch=232
2025-03-13 15:24:09,144 [INFO]: 	index_path: knn.index
2025-03-13 15:24:09,144 [INFO]: 	size in bytes: 1326055030
2025-03-13 15:24:09,144 [INFO]: 	avg_search_speed_ms: 16.72022171625338
2025-03-13 15:24:09,144 [INFO]: 	99p_search_speed_ms: 28.987184797879305
2025-03-13 15:24:09,144 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:09,144 [INFO]: 	nb vectors: 6740
2025-03-13 15:24:09,144 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:09,144 [INFO]: 	compression ratio: 0.999308392201491
2025-03-13 15:24:09,144 [INFO]: }
2025-03-13 15:24:09,144 [INFO]: 	>>> Finished "Creating the index" in 97.4551 secs
2025-03-13 15:24:09,144 [INFO]: >>> Finished "Launching the whole pipeline" in 97.5008 secs
2025-03-13 15:24:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 83101 [episode count 14/20]
[retrieval_preprocessing] for episode 38640 [episode count 15/20], we have num_retrieval=np.int64(6803) num_query=np.int64(326)
2025-03-13 15:24:14,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:15,850 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:15
2025-03-13 15:24:15,850 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1282.27it/s]
2025-03-13 15:24:15,891 [INFO]: There are 6803 embeddings of dim 49152
2025-03-13 15:24:15,891 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 15:24:15,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:15
2025-03-13 15:24:15,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:15,892 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:24:15,892 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:15,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:24:15,892 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:15
2025-03-13 15:24:15,892 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:15,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:24:15,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:15
2025-03-13 15:24:15,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:15,893 [INFO]: 	Creating the index 03/13/2025, 15:24:15
2025-03-13 15:24:15,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:15
2025-03-13 15:24:15,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:24:15,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:15
2025-03-13 15:24:15,897 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:24:15,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 15.81it/s] 21%|██▏       | 6/28 [00:00<00:00, 28.05it/s] 36%|███▌      | 10/28 [00:00<00:00, 31.36it/s] 54%|█████▎    | 15/28 [00:00<00:00, 34.95it/s] 68%|██████▊   | 19/28 [00:00<00:00, 36.55it/s] 82%|████████▏ | 23/28 [00:05<00:02,  2.19it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.16it/s]100%|██████████| 28/28 [00:08<00:00,  3.44it/s]
2025-03-13 15:24:24,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:24
2025-03-13 15:25:23,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3068 secs
2025-03-13 15:25:23,363 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 15:25:23,363 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.49it/s]
2025-03-13 15:25:50,680 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3173 secs
2025-03-13 15:25:50,684 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.7872 secs
2025-03-13 15:25:50,684 [INFO]: {
2025-03-13 15:25:50,684 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:50,684 [INFO]: 	index_param: efSearch=124
2025-03-13 15:25:50,684 [INFO]: 	index_path: knn.index
2025-03-13 15:25:50,684 [INFO]: 	size in bytes: 1338449890
2025-03-13 15:25:50,684 [INFO]: 	avg_search_speed_ms: 10.987690644553648
2025-03-13 15:25:50,684 [INFO]: 	99p_search_speed_ms: 16.88746434403583
2025-03-13 15:25:50,684 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:50,684 [INFO]: 	nb vectors: 6803
2025-03-13 15:25:50,684 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:50,684 [INFO]: 	compression ratio: 0.9993084044409014
2025-03-13 15:25:50,684 [INFO]: }
2025-03-13 15:25:50,684 [INFO]: 	>>> Finished "Creating the index" in 94.7913 secs
2025-03-13 15:25:50,684 [INFO]: >>> Finished "Launching the whole pipeline" in 94.8345 secs
2025-03-13 15:25:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 38640 [episode count 15/20]
[retrieval_preprocessing] for episode 74480 [episode count 16/20], we have num_retrieval=np.int64(6786) num_query=np.int64(343)
2025-03-13 15:25:56,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:57,352 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:57
2025-03-13 15:25:57,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 737.78it/s]
2025-03-13 15:25:57,387 [INFO]: There are 6786 embeddings of dim 49152
2025-03-13 15:25:57,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 15:25:57,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:57
2025-03-13 15:25:57,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:57,388 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:25:57,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:57,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:25:57,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:57
2025-03-13 15:25:57,389 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:57,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:25:57,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:57
2025-03-13 15:25:57,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:57,389 [INFO]: 	Creating the index 03/13/2025, 15:25:57
2025-03-13 15:25:57,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:57
2025-03-13 15:25:57,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:25:57,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:57
2025-03-13 15:25:57,393 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:25:57,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.23it/s]  7%|▋         | 2/28 [00:00<00:03,  6.99it/s] 11%|█         | 3/28 [00:00<00:03,  7.81it/s] 14%|█▍        | 4/28 [00:00<00:02,  8.31it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.61it/s] 25%|██▌       | 7/28 [00:00<00:02, 10.49it/s] 36%|███▌      | 10/28 [00:00<00:01, 14.44it/s] 46%|████▋     | 13/28 [00:01<00:00, 17.02it/s] 54%|█████▎    | 15/28 [00:01<00:00, 17.75it/s] 64%|██████▍   | 18/28 [00:01<00:00, 18.39it/s] 71%|███████▏  | 20/28 [00:01<00:00, 16.15it/s] 79%|███████▊  | 22/28 [00:06<00:04,  1.34it/s] 86%|████████▌ | 24/28 [00:06<00:02,  1.78it/s] 93%|█████████▎| 26/28 [00:06<00:00,  2.37it/s]100%|██████████| 28/28 [00:09<00:00,  1.44it/s]100%|██████████| 28/28 [00:09<00:00,  2.92it/s]
2025-03-13 15:26:06,994 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:06
2025-03-13 15:27:05,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5541 secs
2025-03-13 15:27:05,549 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 15:27:05,549 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.17it/s]
2025-03-13 15:27:52,117 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5685 secs
2025-03-13 15:27:52,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.7269 secs
2025-03-13 15:27:52,120 [INFO]: {
2025-03-13 15:27:52,120 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:52,120 [INFO]: 	index_param: efSearch=236
2025-03-13 15:27:52,120 [INFO]: 	index_path: knn.index
2025-03-13 15:27:52,120 [INFO]: 	size in bytes: 1335105190
2025-03-13 15:27:52,120 [INFO]: 	avg_search_speed_ms: 13.338299340878924
2025-03-13 15:27:52,120 [INFO]: 	99p_search_speed_ms: 25.933123286813494
2025-03-13 15:27:52,120 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:52,120 [INFO]: 	nb vectors: 6786
2025-03-13 15:27:52,120 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:52,120 [INFO]: 	compression ratio: 0.9993084425055677
2025-03-13 15:27:52,120 [INFO]: }
2025-03-13 15:27:52,120 [INFO]: 	>>> Finished "Creating the index" in 114.7304 secs
2025-03-13 15:27:52,120 [INFO]: >>> Finished "Launching the whole pipeline" in 114.7676 secs
2025-03-13 15:27:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 74480 [episode count 16/20]
[retrieval_preprocessing] for episode 9464 [episode count 17/20], we have num_retrieval=np.int64(6358) num_query=np.int64(771)
2025-03-13 15:27:58,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:59,842 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:59
2025-03-13 15:27:59,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.26it/s]
2025-03-13 15:27:59,867 [INFO]: There are 6358 embeddings of dim 49152
2025-03-13 15:27:59,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:27:59,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:59
2025-03-13 15:27:59,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:59,868 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 15:27:59,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:59,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:59,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:59
2025-03-13 15:27:59,868 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:59,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:59,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:59
2025-03-13 15:27:59,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:59,868 [INFO]: 	Creating the index 03/13/2025, 15:27:59
2025-03-13 15:27:59,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:59
2025-03-13 15:27:59,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:27:59,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:59
2025-03-13 15:27:59,869 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 15:27:59,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.45it/s] 11%|█         | 3/27 [00:00<00:02,  9.87it/s] 19%|█▊        | 5/27 [00:00<00:01, 11.03it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.35it/s] 33%|███▎      | 9/27 [00:00<00:01,  9.66it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.60it/s] 44%|████▍     | 12/27 [00:01<00:01, 10.17it/s] 52%|█████▏    | 14/27 [00:01<00:01,  9.61it/s] 59%|█████▉    | 16/27 [00:01<00:01,  9.61it/s] 63%|██████▎   | 17/27 [00:01<00:01,  9.46it/s] 70%|███████   | 19/27 [00:01<00:00,  9.46it/s] 74%|███████▍  | 20/27 [00:02<00:00,  9.39it/s] 78%|███████▊  | 21/27 [00:06<00:05,  1.03it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.60it/s] 93%|█████████▎| 25/27 [00:06<00:00,  2.36it/s]100%|██████████| 27/27 [00:08<00:00,  1.52it/s]100%|██████████| 27/27 [00:08<00:00,  3.15it/s]
2025-03-13 15:28:08,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:08
2025-03-13 15:29:12,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.8780 secs
2025-03-13 15:29:12,326 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 15:29:12,327 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 15:29:51,411 [INFO]: 	>>> Finished "Compute fast metrics" in 39.0845 secs
2025-03-13 15:29:51,413 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.5433 secs
2025-03-13 15:29:51,413 [INFO]: {
2025-03-13 15:29:51,413 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:51,413 [INFO]: 	index_param: efSearch=254
2025-03-13 15:29:51,413 [INFO]: 	index_path: knn.index
2025-03-13 15:29:51,413 [INFO]: 	size in bytes: 1250898730
2025-03-13 15:29:51,413 [INFO]: 	avg_search_speed_ms: 13.482739815659158
2025-03-13 15:29:51,413 [INFO]: 	99p_search_speed_ms: 19.47626287816095
2025-03-13 15:29:51,413 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:51,413 [INFO]: 	nb vectors: 6358
2025-03-13 15:29:51,413 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:51,413 [INFO]: 	compression ratio: 0.999308444417399
2025-03-13 15:29:51,413 [INFO]: }
2025-03-13 15:29:51,413 [INFO]: 	>>> Finished "Creating the index" in 111.5450 secs
2025-03-13 15:29:51,413 [INFO]: >>> Finished "Launching the whole pipeline" in 111.5710 secs
2025-03-13 15:29:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 9464 [episode count 17/20]
[retrieval_preprocessing] for episode 15649 [episode count 18/20], we have num_retrieval=np.int64(6825) num_query=np.int64(304)
2025-03-13 15:30:05,522 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:06,971 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:06
2025-03-13 15:30:06,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.12it/s]
2025-03-13 15:30:06,998 [INFO]: There are 6825 embeddings of dim 49152
2025-03-13 15:30:06,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:30:06,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:06
2025-03-13 15:30:06,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:06,998 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 15:30:06,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:06,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:06,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:06
2025-03-13 15:30:06,999 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:06,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:30:06,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:06
2025-03-13 15:30:06,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:06,999 [INFO]: 	Creating the index 03/13/2025, 15:30:06
2025-03-13 15:30:06,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:06
2025-03-13 15:30:07,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:30:07,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:07
2025-03-13 15:30:07,000 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:30:07,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.25it/s] 11%|█         | 3/28 [00:00<00:02,  8.37it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.51it/s] 25%|██▌       | 7/28 [00:00<00:02, 10.04it/s] 32%|███▏      | 9/28 [00:00<00:01, 10.26it/s] 39%|███▉      | 11/28 [00:01<00:01, 10.48it/s] 46%|████▋     | 13/28 [00:01<00:01, 10.67it/s] 54%|█████▎    | 15/28 [00:01<00:01, 10.83it/s] 61%|██████    | 17/28 [00:01<00:01, 10.92it/s] 68%|██████▊   | 19/28 [00:01<00:00, 10.81it/s] 75%|███████▌  | 21/28 [00:07<00:06,  1.16it/s] 79%|███████▊  | 22/28 [00:07<00:04,  1.35it/s] 82%|████████▏ | 23/28 [00:07<00:03,  1.60it/s] 86%|████████▌ | 24/28 [00:07<00:02,  1.96it/s] 89%|████████▉ | 25/28 [00:07<00:01,  2.41it/s] 93%|█████████▎| 26/28 [00:07<00:00,  2.99it/s] 96%|█████████▋| 27/28 [00:07<00:00,  3.64it/s]100%|██████████| 28/28 [00:11<00:00,  1.08s/it]100%|██████████| 28/28 [00:11<00:00,  2.54it/s]
2025-03-13 15:30:18,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:18
2025-03-13 15:31:11,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.7632 secs
2025-03-13 15:31:11,792 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 15:31:11,792 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.45it/s] 50%|█████     | 2/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.83it/s]
2025-03-13 15:31:58,712 [INFO]: 	>>> Finished "Compute fast metrics" in 46.9200 secs
2025-03-13 15:31:58,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.7140 secs
2025-03-13 15:31:58,714 [INFO]: {
2025-03-13 15:31:58,714 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:58,714 [INFO]: 	index_param: efSearch=241
2025-03-13 15:31:58,714 [INFO]: 	index_path: knn.index
2025-03-13 15:31:58,714 [INFO]: 	size in bytes: 1342778170
2025-03-13 15:31:58,714 [INFO]: 	avg_search_speed_ms: 13.002501976337623
2025-03-13 15:31:58,714 [INFO]: 	99p_search_speed_ms: 17.01921693515031
2025-03-13 15:31:58,714 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:58,714 [INFO]: 	nb vectors: 6825
2025-03-13 15:31:58,714 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:58,715 [INFO]: 	compression ratio: 0.9993084710336034
2025-03-13 15:31:58,715 [INFO]: }
2025-03-13 15:31:58,715 [INFO]: 	>>> Finished "Creating the index" in 111.7156 secs
2025-03-13 15:31:58,715 [INFO]: >>> Finished "Launching the whole pipeline" in 111.7431 secs
2025-03-13 15:32:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 15649 [episode count 18/20]
[retrieval_preprocessing] for episode 31011 [episode count 19/20], we have num_retrieval=np.int64(6907) num_query=np.int64(222)
2025-03-13 15:32:05,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:06,585 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:06
2025-03-13 15:32:06,585 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.54it/s]
2025-03-13 15:32:06,613 [INFO]: There are 6907 embeddings of dim 49152
2025-03-13 15:32:06,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:32:06,613 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:06
2025-03-13 15:32:06,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:06,613 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 15:32:06,613 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:06,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:06,613 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:06
2025-03-13 15:32:06,613 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:06,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:06,613 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:06
2025-03-13 15:32:06,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:06,613 [INFO]: 	Creating the index 03/13/2025, 15:32:06
2025-03-13 15:32:06,614 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:06
2025-03-13 15:32:06,615 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:32:06,615 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:06
2025-03-13 15:32:06,615 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:32:06,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:06,  4.08it/s]  7%|▋         | 2/29 [00:00<00:04,  5.86it/s] 10%|█         | 3/29 [00:00<00:03,  6.75it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.27it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.66it/s] 21%|██        | 6/29 [00:00<00:02,  8.04it/s] 24%|██▍       | 7/29 [00:00<00:02,  8.29it/s] 28%|██▊       | 8/29 [00:01<00:02,  8.35it/s] 31%|███       | 9/29 [00:01<00:02,  8.48it/s] 34%|███▍      | 10/29 [00:01<00:02,  8.18it/s] 38%|███▊      | 11/29 [00:01<00:02,  8.13it/s] 41%|████▏     | 12/29 [00:01<00:02,  8.22it/s] 45%|████▍     | 13/29 [00:01<00:01,  8.17it/s] 48%|████▊     | 14/29 [00:01<00:01,  8.10it/s] 52%|█████▏    | 15/29 [00:02<00:02,  6.55it/s] 55%|█████▌    | 16/29 [00:02<00:02,  6.18it/s] 59%|█████▊    | 17/29 [00:02<00:01,  6.61it/s] 62%|██████▏   | 18/29 [00:02<00:01,  6.91it/s] 66%|██████▌   | 19/29 [00:02<00:01,  7.13it/s] 69%|██████▉   | 20/29 [00:02<00:01,  7.31it/s] 72%|███████▏  | 21/29 [00:07<00:11,  1.46s/it] 76%|███████▌  | 22/29 [00:07<00:07,  1.06s/it] 83%|████████▎ | 24/29 [00:07<00:03,  1.63it/s] 86%|████████▌ | 25/29 [00:07<00:01,  2.04it/s] 90%|████████▉ | 26/29 [00:07<00:01,  2.57it/s] 93%|█████████▎| 27/29 [00:07<00:00,  3.22it/s] 97%|█████████▋| 28/29 [00:07<00:00,  3.96it/s]100%|██████████| 29/29 [00:10<00:00,  1.20it/s]100%|██████████| 29/29 [00:10<00:00,  2.82it/s]
2025-03-13 15:32:16,910 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:16
2025-03-13 15:33:20,094 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.1841 secs
2025-03-13 15:33:20,094 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 15:33:20,094 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-13 15:34:09,925 [INFO]: 	>>> Finished "Compute fast metrics" in 49.8303 secs
2025-03-13 15:34:09,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.3121 secs
2025-03-13 15:34:09,927 [INFO]: {
2025-03-13 15:34:09,927 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:09,927 [INFO]: 	index_param: efSearch=237
2025-03-13 15:34:09,927 [INFO]: 	index_path: knn.index
2025-03-13 15:34:09,927 [INFO]: 	size in bytes: 1358911270
2025-03-13 15:34:09,927 [INFO]: 	avg_search_speed_ms: 13.69790248285775
2025-03-13 15:34:09,927 [INFO]: 	99p_search_speed_ms: 21.592908161692325
2025-03-13 15:34:09,927 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:09,927 [INFO]: 	nb vectors: 6907
2025-03-13 15:34:09,927 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:09,927 [INFO]: 	compression ratio: 0.9993084066482133
2025-03-13 15:34:09,927 [INFO]: }
2025-03-13 15:34:09,927 [INFO]: 	>>> Finished "Creating the index" in 123.3137 secs
2025-03-13 15:34:09,927 [INFO]: >>> Finished "Launching the whole pipeline" in 123.3424 secs
2025-03-13 15:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 31011 [episode count 19/20]
2025-03-13 15:34:13: [retrieval_preprocessing] finished for 4130977918_fold_towel [chosen_id count 1/196]
2025-03-13 15:34:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4130977918_unfold_towel [chosen_id count 2/196]
2025-03-13 15:34:21: [retrieval_preprocessing] we have num_total=8567 embedding_dim=49152
[retrieval_preprocessing] for episode 36877 [episode count 0/20], we have num_retrieval=np.int64(8089) num_query=np.int64(478)
2025-03-13 15:34:25,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:26,840 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:26
2025-03-13 15:34:26,840 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.85it/s]
2025-03-13 15:34:26,865 [INFO]: There are 8089 embeddings of dim 49152
2025-03-13 15:34:26,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:34:26,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:26
2025-03-13 15:34:26,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:26,866 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 15:34:26,866 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:26,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:26,866 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:26
2025-03-13 15:34:26,866 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:26,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:26,866 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:26
2025-03-13 15:34:26,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:26,866 [INFO]: 	Creating the index 03/13/2025, 15:34:26
2025-03-13 15:34:26,866 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:26
2025-03-13 15:34:26,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:34:26,867 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:26
2025-03-13 15:34:26,867 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:34:26,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  4.97it/s]  9%|▉         | 3/33 [00:00<00:03,  8.23it/s] 15%|█▌        | 5/33 [00:00<00:03,  9.15it/s] 18%|█▊        | 6/33 [00:00<00:02,  9.31it/s] 24%|██▍       | 8/33 [00:00<00:02, 10.12it/s] 30%|███       | 10/33 [00:01<00:02, 10.45it/s] 36%|███▋      | 12/33 [00:01<00:01, 10.52it/s] 42%|████▏     | 14/33 [00:01<00:01, 10.55it/s] 48%|████▊     | 16/33 [00:01<00:01, 10.58it/s] 55%|█████▍    | 18/33 [00:01<00:01, 10.62it/s] 61%|██████    | 20/33 [00:01<00:01, 10.65it/s] 67%|██████▋   | 22/33 [00:06<00:08,  1.34it/s] 73%|███████▎  | 24/33 [00:06<00:04,  1.83it/s] 79%|███████▉  | 26/33 [00:06<00:02,  2.45it/s] 85%|████████▍ | 28/33 [00:06<00:01,  3.19it/s] 91%|█████████ | 30/33 [00:07<00:00,  4.03it/s] 97%|█████████▋| 32/33 [00:07<00:00,  4.94it/s]100%|██████████| 33/33 [00:10<00:00,  1.34it/s]100%|██████████| 33/33 [00:10<00:00,  3.11it/s]
2025-03-13 15:34:37,487 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:37
2025-03-13 15:35:41,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1695 secs
2025-03-13 15:35:41,657 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 15:35:41,657 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 15:36:37,407 [INFO]: 	>>> Finished "Compute fast metrics" in 55.7498 secs
2025-03-13 15:36:37,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.5443 secs
2025-03-13 15:36:37,412 [INFO]: {
2025-03-13 15:36:37,412 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:37,412 [INFO]: 	index_param: efSearch=218
2025-03-13 15:36:37,412 [INFO]: 	index_path: knn.index
2025-03-13 15:36:37,412 [INFO]: 	size in bytes: 1591463110
2025-03-13 15:36:37,412 [INFO]: 	avg_search_speed_ms: 12.540415598705112
2025-03-13 15:36:37,412 [INFO]: 	99p_search_speed_ms: 18.429220160469413
2025-03-13 15:36:37,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:37,412 [INFO]: 	nb vectors: 8089
2025-03-13 15:36:37,412 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:37,412 [INFO]: 	compression ratio: 0.9993081850323254
2025-03-13 15:36:37,412 [INFO]: }
2025-03-13 15:36:37,412 [INFO]: 	>>> Finished "Creating the index" in 130.5463 secs
2025-03-13 15:36:37,412 [INFO]: >>> Finished "Launching the whole pipeline" in 130.5725 secs
2025-03-13 15:36:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 36877 [episode count 0/20]
[retrieval_preprocessing] for episode 46608 [episode count 1/20], we have num_retrieval=np.int64(8115) num_query=np.int64(452)
2025-03-13 15:36:45,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:47,064 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:47
2025-03-13 15:36:47,064 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1229.28it/s]
2025-03-13 15:36:47,091 [INFO]: There are 8115 embeddings of dim 49152
2025-03-13 15:36:47,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:36:47,092 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:47
2025-03-13 15:36:47,092 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:47,092 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:36:47,092 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:47,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:36:47,093 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:47
2025-03-13 15:36:47,093 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:47,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:36:47,093 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:47
2025-03-13 15:36:47,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:47,093 [INFO]: 	Creating the index 03/13/2025, 15:36:47
2025-03-13 15:36:47,093 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:47
2025-03-13 15:36:47,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:36:47,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:47
2025-03-13 15:36:47,096 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:36:47,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.57it/s]  9%|▉         | 3/33 [00:00<00:03,  7.93it/s] 15%|█▌        | 5/33 [00:00<00:03,  8.97it/s] 21%|██        | 7/33 [00:00<00:02,  9.48it/s] 27%|██▋       | 9/33 [00:00<00:02,  9.84it/s] 33%|███▎      | 11/33 [00:01<00:02, 10.03it/s] 39%|███▉      | 13/33 [00:01<00:01, 10.26it/s] 45%|████▌     | 15/33 [00:01<00:01, 10.26it/s] 52%|█████▏    | 17/33 [00:01<00:01, 10.52it/s] 58%|█████▊    | 19/33 [00:01<00:01, 10.78it/s] 64%|██████▎   | 21/33 [00:05<00:07,  1.61it/s] 67%|██████▋   | 22/33 [00:05<00:05,  1.88it/s] 70%|██████▉   | 23/33 [00:05<00:04,  2.23it/s] 73%|███████▎  | 24/33 [00:05<00:03,  2.67it/s] 76%|███████▌  | 25/33 [00:06<00:02,  3.20it/s] 79%|███████▉  | 26/33 [00:06<00:01,  3.76it/s] 82%|████████▏ | 27/33 [00:06<00:01,  4.35it/s] 85%|████████▍ | 28/33 [00:06<00:01,  4.96it/s] 88%|████████▊ | 29/33 [00:06<00:00,  5.58it/s] 91%|█████████ | 30/33 [00:06<00:00,  6.15it/s] 94%|█████████▍| 31/33 [00:07<00:00,  2.76it/s] 97%|█████████▋| 32/33 [00:07<00:00,  3.50it/s]100%|██████████| 33/33 [00:11<00:00,  1.47s/it]100%|██████████| 33/33 [00:11<00:00,  2.77it/s]
2025-03-13 15:36:59,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:59
2025-03-13 15:38:06,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.0000 secs
2025-03-13 15:38:06,021 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 15:38:06,021 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.64s/it] 50%|█████     | 2/4 [00:02<00:01,  1.08it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.71it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.06it/s]
2025-03-13 15:38:45,179 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1584 secs
2025-03-13 15:38:45,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.0854 secs
2025-03-13 15:38:45,182 [INFO]: {
2025-03-13 15:38:45,182 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:45,182 [INFO]: 	index_param: efSearch=161
2025-03-13 15:38:45,182 [INFO]: 	index_path: knn.index
2025-03-13 15:38:45,182 [INFO]: 	size in bytes: 1596578410
2025-03-13 15:38:45,182 [INFO]: 	avg_search_speed_ms: 7.360627948284555
2025-03-13 15:38:45,182 [INFO]: 	99p_search_speed_ms: 11.338469395413997
2025-03-13 15:38:45,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:45,182 [INFO]: 	nb vectors: 8115
2025-03-13 15:38:45,182 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:45,182 [INFO]: 	compression ratio: 0.9993082143707556
2025-03-13 15:38:45,182 [INFO]: }
2025-03-13 15:38:45,182 [INFO]: 	>>> Finished "Creating the index" in 118.0885 secs
2025-03-13 15:38:45,182 [INFO]: >>> Finished "Launching the whole pipeline" in 118.1180 secs
2025-03-13 15:38:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 46608 [episode count 1/20]
[retrieval_preprocessing] for episode 70184 [episode count 2/20], we have num_retrieval=np.int64(8311) num_query=np.int64(256)
2025-03-13 15:38:52,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:54,344 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:54
2025-03-13 15:38:54,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.01it/s]
2025-03-13 15:38:54,368 [INFO]: There are 8311 embeddings of dim 49152
2025-03-13 15:38:54,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 15:38:54,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:54
2025-03-13 15:38:54,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:54,368 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:38:54,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:54,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:54,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:54
2025-03-13 15:38:54,368 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:54,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:54,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:54
2025-03-13 15:38:54,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:54,368 [INFO]: 	Creating the index 03/13/2025, 15:38:54
2025-03-13 15:38:54,368 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:54
2025-03-13 15:38:54,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:38:54,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:54
2025-03-13 15:38:54,370 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:38:54,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.10it/s]  6%|▌         | 2/34 [00:01<00:19,  1.64it/s]  9%|▉         | 3/34 [00:01<00:15,  2.03it/s] 12%|█▏        | 4/34 [00:01<00:13,  2.22it/s] 15%|█▍        | 5/34 [00:02<00:10,  2.67it/s] 18%|█▊        | 6/34 [00:02<00:09,  3.05it/s] 21%|██        | 7/34 [00:02<00:08,  3.35it/s] 24%|██▎       | 8/34 [00:02<00:06,  3.78it/s] 26%|██▋       | 9/34 [00:02<00:05,  4.32it/s] 29%|██▉       | 10/34 [00:03<00:05,  4.26it/s] 32%|███▏      | 11/34 [00:03<00:05,  4.07it/s] 35%|███▌      | 12/34 [00:03<00:04,  4.41it/s] 38%|███▊      | 13/34 [00:03<00:04,  4.69it/s] 41%|████      | 14/34 [00:03<00:03,  5.02it/s] 47%|████▋     | 16/34 [00:04<00:02,  7.37it/s] 56%|█████▌    | 19/34 [00:04<00:01,  9.74it/s] 62%|██████▏   | 21/34 [00:08<00:09,  1.35it/s] 65%|██████▍   | 22/34 [00:08<00:07,  1.60it/s] 68%|██████▊   | 23/34 [00:08<00:05,  1.94it/s] 71%|███████   | 24/34 [00:08<00:04,  2.37it/s] 74%|███████▎  | 25/34 [00:08<00:03,  2.93it/s] 79%|███████▉  | 27/34 [00:09<00:01,  4.24it/s] 85%|████████▌ | 29/34 [00:09<00:00,  5.57it/s] 91%|█████████ | 31/34 [00:09<00:00,  6.30it/s] 94%|█████████▍| 32/34 [00:10<00:00,  2.37it/s] 97%|█████████▋| 33/34 [00:11<00:00,  2.59it/s]100%|██████████| 34/34 [00:14<00:00,  1.10s/it]100%|██████████| 34/34 [00:14<00:00,  2.34it/s]
2025-03-13 15:39:08,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:08
2025-03-13 15:40:11,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.0741 secs
2025-03-13 15:40:11,007 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:40:11,007 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 15:41:01,331 [INFO]: 	>>> Finished "Compute fast metrics" in 50.3242 secs
2025-03-13 15:41:01,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.9669 secs
2025-03-13 15:41:01,337 [INFO]: {
2025-03-13 15:41:01,337 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:01,337 [INFO]: 	index_param: efSearch=176
2025-03-13 15:41:01,337 [INFO]: 	index_path: knn.index
2025-03-13 15:41:01,337 [INFO]: 	size in bytes: 1635140110
2025-03-13 15:41:01,337 [INFO]: 	avg_search_speed_ms: 10.193208124532262
2025-03-13 15:41:01,337 [INFO]: 	99p_search_speed_ms: 19.322028709575584
2025-03-13 15:41:01,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:01,337 [INFO]: 	nb vectors: 8311
2025-03-13 15:41:01,337 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:01,337 [INFO]: 	compression ratio: 0.9993083026995161
2025-03-13 15:41:01,337 [INFO]: }
2025-03-13 15:41:01,337 [INFO]: 	>>> Finished "Creating the index" in 126.9684 secs
2025-03-13 15:41:01,337 [INFO]: >>> Finished "Launching the whole pipeline" in 126.9930 secs
2025-03-13 15:41:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 70184 [episode count 2/20]
[retrieval_preprocessing] for episode 13867 [episode count 3/20], we have num_retrieval=np.int64(8181) num_query=np.int64(386)
2025-03-13 15:41:06,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:07,548 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:07
2025-03-13 15:41:07,549 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.99it/s]
2025-03-13 15:41:07,574 [INFO]: There are 8181 embeddings of dim 49152
2025-03-13 15:41:07,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:41:07,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:07
2025-03-13 15:41:07,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:07,574 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:41:07,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:07,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:41:07,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:07
2025-03-13 15:41:07,574 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:07,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:41:07,574 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:07
2025-03-13 15:41:07,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:07,574 [INFO]: 	Creating the index 03/13/2025, 15:41:07
2025-03-13 15:41:07,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:07
2025-03-13 15:41:07,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:41:07,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:07
2025-03-13 15:41:07,576 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:41:07,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.87it/s]  9%|▉         | 3/34 [00:00<00:03,  8.29it/s] 15%|█▍        | 5/34 [00:00<00:03,  9.58it/s] 18%|█▊        | 6/34 [00:00<00:03,  9.21it/s] 21%|██        | 7/34 [00:00<00:03,  8.78it/s] 24%|██▎       | 8/34 [00:00<00:03,  8.45it/s] 26%|██▋       | 9/34 [00:01<00:03,  8.26it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.65it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.17it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.89it/s] 41%|████      | 14/34 [00:01<00:02,  8.67it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.49it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.40it/s] 50%|█████     | 17/34 [00:01<00:02,  8.18it/s] 53%|█████▎    | 18/34 [00:02<00:01,  8.03it/s] 56%|█████▌    | 19/34 [00:02<00:01,  7.70it/s] 59%|█████▉    | 20/34 [00:02<00:01,  7.64it/s] 62%|██████▏   | 21/34 [00:07<00:21,  1.67s/it] 65%|██████▍   | 22/34 [00:07<00:14,  1.21s/it] 68%|██████▊   | 23/34 [00:07<00:09,  1.13it/s] 71%|███████   | 24/34 [00:08<00:06,  1.52it/s] 74%|███████▎  | 25/34 [00:08<00:04,  2.01it/s] 76%|███████▋  | 26/34 [00:08<00:03,  2.61it/s] 82%|████████▏ | 28/34 [00:08<00:01,  3.96it/s] 85%|████████▌ | 29/34 [00:08<00:01,  4.63it/s] 88%|████████▊ | 30/34 [00:08<00:00,  5.34it/s] 94%|█████████▍| 32/34 [00:08<00:00,  6.83it/s]100%|██████████| 34/34 [00:12<00:00,  1.41it/s]100%|██████████| 34/34 [00:12<00:00,  2.79it/s]
2025-03-13 15:41:19,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:19
2025-03-13 15:42:28,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1300 secs
2025-03-13 15:42:28,879 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 15:42:28,879 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 15:43:07,341 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4613 secs
2025-03-13 15:43:07,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.7675 secs
2025-03-13 15:43:07,343 [INFO]: {
2025-03-13 15:43:07,343 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:07,343 [INFO]: 	index_param: efSearch=172
2025-03-13 15:43:07,343 [INFO]: 	index_path: knn.index
2025-03-13 15:43:07,343 [INFO]: 	size in bytes: 1609563610
2025-03-13 15:43:07,343 [INFO]: 	avg_search_speed_ms: 10.23144137587097
2025-03-13 15:43:07,343 [INFO]: 	99p_search_speed_ms: 15.702275326475505
2025-03-13 15:43:07,343 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:07,343 [INFO]: 	nb vectors: 8181
2025-03-13 15:43:07,343 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:07,343 [INFO]: 	compression ratio: 0.9993081590605791
2025-03-13 15:43:07,343 [INFO]: }
2025-03-13 15:43:07,343 [INFO]: 	>>> Finished "Creating the index" in 119.7690 secs
2025-03-13 15:43:07,343 [INFO]: >>> Finished "Launching the whole pipeline" in 119.7949 secs
2025-03-13 15:43:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 13867 [episode count 3/20]
[retrieval_preprocessing] for episode 87092 [episode count 4/20], we have num_retrieval=np.int64(8186) num_query=np.int64(381)
2025-03-13 15:43:14,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:16,396 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:16
2025-03-13 15:43:16,396 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.75it/s]
2025-03-13 15:43:16,422 [INFO]: There are 8186 embeddings of dim 49152
2025-03-13 15:43:16,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:43:16,423 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:16
2025-03-13 15:43:16,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:16,423 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:43:16,423 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:16,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:43:16,423 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:16
2025-03-13 15:43:16,423 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:16,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:43:16,423 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:16
2025-03-13 15:43:16,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:16,423 [INFO]: 	Creating the index 03/13/2025, 15:43:16
2025-03-13 15:43:16,423 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:16
2025-03-13 15:43:16,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:43:16,425 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:16
2025-03-13 15:43:16,425 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:43:16,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.72it/s]  6%|▌         | 2/34 [00:00<00:04,  6.84it/s] 12%|█▏        | 4/34 [00:00<00:03,  8.70it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.85it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.85it/s] 21%|██        | 7/34 [00:00<00:03,  8.97it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.12it/s] 26%|██▋       | 9/34 [00:01<00:02,  9.14it/s] 29%|██▉       | 10/34 [00:01<00:02,  9.18it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.52it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.81it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.96it/s] 41%|████      | 14/34 [00:01<00:02,  9.12it/s] 44%|████▍     | 15/34 [00:01<00:02,  9.10it/s] 47%|████▋     | 16/34 [00:01<00:01,  9.32it/s] 53%|█████▎    | 18/34 [00:02<00:01,  9.79it/s] 56%|█████▌    | 19/34 [00:02<00:01,  9.74it/s] 62%|██████▏   | 21/34 [00:07<00:14,  1.15s/it] 65%|██████▍   | 22/34 [00:07<00:10,  1.10it/s] 68%|██████▊   | 23/34 [00:07<00:07,  1.41it/s] 71%|███████   | 24/34 [00:07<00:05,  1.81it/s] 74%|███████▎  | 25/34 [00:07<00:03,  2.33it/s] 79%|███████▉  | 27/34 [00:07<00:01,  3.53it/s] 85%|████████▌ | 29/34 [00:08<00:01,  4.74it/s] 91%|█████████ | 31/34 [00:08<00:00,  5.89it/s] 97%|█████████▋| 33/34 [00:08<00:00,  6.70it/s]100%|██████████| 34/34 [00:12<00:00,  1.14it/s]100%|██████████| 34/34 [00:12<00:00,  2.73it/s]
2025-03-13 15:43:28,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:28
2025-03-13 15:44:32,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1059 secs
2025-03-13 15:44:32,985 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:44:32,985 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 15:45:27,485 [INFO]: 	>>> Finished "Compute fast metrics" in 54.4996 secs
2025-03-13 15:45:27,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.0630 secs
2025-03-13 15:45:27,488 [INFO]: {
2025-03-13 15:45:27,488 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:27,488 [INFO]: 	index_param: efSearch=176
2025-03-13 15:45:27,488 [INFO]: 	index_path: knn.index
2025-03-13 15:45:27,488 [INFO]: 	size in bytes: 1610547310
2025-03-13 15:45:27,488 [INFO]: 	avg_search_speed_ms: 8.678368049206458
2025-03-13 15:45:27,488 [INFO]: 	99p_search_speed_ms: 16.81938636349515
2025-03-13 15:45:27,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:27,488 [INFO]: 	nb vectors: 8186
2025-03-13 15:45:27,488 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:27,488 [INFO]: 	compression ratio: 0.9993081718288673
2025-03-13 15:45:27,488 [INFO]: }
2025-03-13 15:45:27,488 [INFO]: 	>>> Finished "Creating the index" in 131.0647 secs
2025-03-13 15:45:27,488 [INFO]: >>> Finished "Launching the whole pipeline" in 131.0918 secs
2025-03-13 15:45:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 87092 [episode count 4/20]
[retrieval_preprocessing] for episode 32310 [episode count 5/20], we have num_retrieval=np.int64(8309) num_query=np.int64(258)
2025-03-13 15:45:34,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:36,552 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:36
2025-03-13 15:45:36,552 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.45it/s]
2025-03-13 15:45:36,579 [INFO]: There are 8309 embeddings of dim 49152
2025-03-13 15:45:36,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:45:36,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:36
2025-03-13 15:45:36,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:36,579 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:45:36,579 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:36,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:36,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:36
2025-03-13 15:45:36,580 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:36,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:45:36,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:36
2025-03-13 15:45:36,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:36,580 [INFO]: 	Creating the index 03/13/2025, 15:45:36
2025-03-13 15:45:36,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:36
2025-03-13 15:45:36,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:45:36,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:36
2025-03-13 15:45:36,581 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:45:36,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.75it/s]  9%|▉         | 3/34 [00:00<00:03,  8.30it/s] 15%|█▍        | 5/34 [00:00<00:02,  9.88it/s] 21%|██        | 7/34 [00:00<00:02, 10.73it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.56it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.81it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.06it/s] 41%|████      | 14/34 [00:01<00:02,  8.74it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.52it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.28it/s] 50%|█████     | 17/34 [00:01<00:02,  8.13it/s] 53%|█████▎    | 18/34 [00:02<00:01,  8.05it/s] 56%|█████▌    | 19/34 [00:02<00:01,  7.92it/s] 59%|█████▉    | 20/34 [00:02<00:01,  7.86it/s] 62%|██████▏   | 21/34 [00:06<00:17,  1.32s/it] 65%|██████▍   | 22/34 [00:06<00:11,  1.03it/s] 68%|██████▊   | 23/34 [00:06<00:07,  1.39it/s] 71%|███████   | 24/34 [00:06<00:05,  1.86it/s] 74%|███████▎  | 25/34 [00:07<00:03,  2.44it/s] 76%|███████▋  | 26/34 [00:07<00:02,  3.12it/s] 79%|███████▉  | 27/34 [00:07<00:01,  3.92it/s] 85%|████████▌ | 29/34 [00:07<00:00,  6.02it/s] 91%|█████████ | 31/34 [00:07<00:00,  7.00it/s] 97%|█████████▋| 33/34 [00:07<00:00,  7.44it/s]100%|██████████| 34/34 [00:11<00:00,  1.05it/s]100%|██████████| 34/34 [00:11<00:00,  2.85it/s]
2025-03-13 15:45:48,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:48
2025-03-13 15:46:55,510 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.9733 secs
2025-03-13 15:46:55,510 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 15:46:55,510 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 15:47:31,169 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6586 secs
2025-03-13 15:47:31,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.5908 secs
2025-03-13 15:47:31,172 [INFO]: {
2025-03-13 15:47:31,172 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:31,172 [INFO]: 	index_param: efSearch=137
2025-03-13 15:47:31,172 [INFO]: 	index_path: knn.index
2025-03-13 15:47:31,172 [INFO]: 	size in bytes: 1634746630
2025-03-13 15:47:31,172 [INFO]: 	avg_search_speed_ms: 8.051013128401564
2025-03-13 15:47:31,172 [INFO]: 	99p_search_speed_ms: 13.754265902098266
2025-03-13 15:47:31,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:31,172 [INFO]: 	nb vectors: 8309
2025-03-13 15:47:31,172 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:31,172 [INFO]: 	compression ratio: 0.9993082977023785
2025-03-13 15:47:31,172 [INFO]: }
2025-03-13 15:47:31,172 [INFO]: 	>>> Finished "Creating the index" in 114.5924 secs
2025-03-13 15:47:31,172 [INFO]: >>> Finished "Launching the whole pipeline" in 114.6202 secs
2025-03-13 15:47:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 32310 [episode count 5/20]
[retrieval_preprocessing] for episode 45626 [episode count 6/20], we have num_retrieval=np.int64(8325) num_query=np.int64(242)
2025-03-13 15:47:37,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:39,341 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:39
2025-03-13 15:47:39,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.58it/s]
2025-03-13 15:47:39,370 [INFO]: There are 8325 embeddings of dim 49152
2025-03-13 15:47:39,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:47:39,370 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:39
2025-03-13 15:47:39,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:39,370 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:47:39,370 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:39,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:47:39,371 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:39
2025-03-13 15:47:39,371 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:39,371 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:47:39,371 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:39
2025-03-13 15:47:39,371 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:39,371 [INFO]: 	Creating the index 03/13/2025, 15:47:39
2025-03-13 15:47:39,371 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:39
2025-03-13 15:47:39,372 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:47:39,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:39
2025-03-13 15:47:39,372 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:47:39,372 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:08,  3.97it/s]  9%|▉         | 3/34 [00:00<00:04,  7.14it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.79it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.60it/s] 24%|██▎       | 8/34 [00:00<00:02, 10.49it/s] 29%|██▉       | 10/34 [00:01<00:02, 12.00it/s] 35%|███▌      | 12/34 [00:01<00:01, 13.01it/s] 41%|████      | 14/34 [00:01<00:01, 13.16it/s] 47%|████▋     | 16/34 [00:01<00:01, 12.75it/s] 53%|█████▎    | 18/34 [00:01<00:01, 13.03it/s] 59%|█████▉    | 20/34 [00:01<00:01, 11.81it/s] 65%|██████▍   | 22/34 [00:08<00:13,  1.16s/it] 68%|██████▊   | 23/34 [00:11<00:14,  1.33s/it] 71%|███████   | 24/34 [00:12<00:12,  1.30s/it] 74%|███████▎  | 25/34 [00:13<00:12,  1.39s/it] 79%|███████▉  | 27/34 [00:14<00:06,  1.15it/s] 85%|████████▌ | 29/34 [00:14<00:03,  1.41it/s] 88%|████████▊ | 30/34 [00:15<00:02,  1.45it/s] 91%|█████████ | 31/34 [00:15<00:01,  1.62it/s] 94%|█████████▍| 32/34 [00:16<00:01,  1.92it/s] 97%|█████████▋| 33/34 [00:16<00:00,  2.25it/s]100%|██████████| 34/34 [00:20<00:00,  1.33s/it]100%|██████████| 34/34 [00:20<00:00,  1.69it/s]
2025-03-13 15:47:59,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:59
2025-03-13 15:49:01,901 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.4187 secs
2025-03-13 15:49:01,901 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 15:49:01,901 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.70it/s]
2025-03-13 15:50:08,260 [INFO]: 	>>> Finished "Compute fast metrics" in 66.3586 secs
2025-03-13 15:50:08,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.9011 secs
2025-03-13 15:50:08,273 [INFO]: {
2025-03-13 15:50:08,273 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:08,273 [INFO]: 	index_param: efSearch=121
2025-03-13 15:50:08,273 [INFO]: 	index_path: knn.index
2025-03-13 15:50:08,273 [INFO]: 	size in bytes: 1637894530
2025-03-13 15:50:08,273 [INFO]: 	avg_search_speed_ms: 7.263819003286964
2025-03-13 15:50:08,273 [INFO]: 	99p_search_speed_ms: 12.635758584365249
2025-03-13 15:50:08,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:08,273 [INFO]: 	nb vectors: 8325
2025-03-13 15:50:08,273 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:08,273 [INFO]: 	compression ratio: 0.9993083010051935
2025-03-13 15:50:08,273 [INFO]: }
2025-03-13 15:50:08,273 [INFO]: 	>>> Finished "Creating the index" in 148.9025 secs
2025-03-13 15:50:08,273 [INFO]: >>> Finished "Launching the whole pipeline" in 148.9324 secs
2025-03-13 15:50:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 45626 [episode count 6/20]
[retrieval_preprocessing] for episode 78933 [episode count 7/20], we have num_retrieval=np.int64(8224) num_query=np.int64(343)
2025-03-13 15:50:14,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:15,952 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:15
2025-03-13 15:50:15,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-13 15:50:15,981 [INFO]: There are 8224 embeddings of dim 49152
2025-03-13 15:50:15,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 15:50:15,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:15
2025-03-13 15:50:15,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:15,982 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:50:15,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:15,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:50:15,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:15
2025-03-13 15:50:15,983 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:15,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:50:15,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:15
2025-03-13 15:50:15,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:15,983 [INFO]: 	Creating the index 03/13/2025, 15:50:15
2025-03-13 15:50:15,983 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:15
2025-03-13 15:50:15,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:50:15,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:15
2025-03-13 15:50:15,987 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:50:15,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.27it/s]  9%|▉         | 3/34 [00:00<00:03,  9.28it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.98it/s] 21%|██        | 7/34 [00:00<00:02, 11.86it/s] 26%|██▋       | 9/34 [00:00<00:02, 12.44it/s] 32%|███▏      | 11/34 [00:00<00:01, 12.90it/s] 38%|███▊      | 13/34 [00:01<00:01, 13.12it/s] 44%|████▍     | 15/34 [00:01<00:01, 13.71it/s] 50%|█████     | 17/34 [00:01<00:01, 13.81it/s] 56%|█████▌    | 19/34 [00:01<00:01, 13.98it/s] 62%|██████▏   | 21/34 [00:07<00:12,  1.04it/s] 65%|██████▍   | 22/34 [00:07<00:09,  1.23it/s] 71%|███████   | 24/34 [00:07<00:05,  1.76it/s] 74%|███████▎  | 25/34 [00:07<00:04,  2.09it/s] 76%|███████▋  | 26/34 [00:07<00:03,  2.50it/s] 79%|███████▉  | 27/34 [00:08<00:02,  3.02it/s] 82%|████████▏ | 28/34 [00:08<00:01,  3.64it/s] 85%|████████▌ | 29/34 [00:08<00:01,  4.36it/s] 88%|████████▊ | 30/34 [00:08<00:00,  5.12it/s] 91%|█████████ | 31/34 [00:08<00:00,  5.90it/s] 94%|█████████▍| 32/34 [00:08<00:00,  6.60it/s] 97%|█████████▋| 33/34 [00:08<00:00,  7.26it/s]100%|██████████| 34/34 [00:12<00:00,  1.15s/it]100%|██████████| 34/34 [00:12<00:00,  2.76it/s]
2025-03-13 15:50:28,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:28
2025-03-13 15:51:45,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.6269 secs
2025-03-13 15:51:45,924 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 15:51:45,924 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.48it/s] 50%|█████     | 2/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.59it/s]
2025-03-13 15:52:23,581 [INFO]: 	>>> Finished "Compute fast metrics" in 37.6567 secs
2025-03-13 15:52:23,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.5967 secs
2025-03-13 15:52:23,584 [INFO]: {
2025-03-13 15:52:23,584 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:23,584 [INFO]: 	index_param: efSearch=140
2025-03-13 15:52:23,584 [INFO]: 	index_path: knn.index
2025-03-13 15:52:23,584 [INFO]: 	size in bytes: 1618023550
2025-03-13 15:52:23,585 [INFO]: 	avg_search_speed_ms: 8.793445037826961
2025-03-13 15:52:23,585 [INFO]: 	99p_search_speed_ms: 14.925070693716412
2025-03-13 15:52:23,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:23,585 [INFO]: 	nb vectors: 8224
2025-03-13 15:52:23,585 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:23,585 [INFO]: 	compression ratio: 0.9993081942472345
2025-03-13 15:52:23,585 [INFO]: }
2025-03-13 15:52:23,585 [INFO]: 	>>> Finished "Creating the index" in 127.6012 secs
2025-03-13 15:52:23,585 [INFO]: >>> Finished "Launching the whole pipeline" in 127.6323 secs
2025-03-13 15:52:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 78933 [episode count 7/20]
[retrieval_preprocessing] for episode 78485 [episode count 8/20], we have num_retrieval=np.int64(8262) num_query=np.int64(305)
2025-03-13 15:52:30,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:32,017 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:32
2025-03-13 15:52:32,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.69it/s]
2025-03-13 15:52:32,045 [INFO]: There are 8262 embeddings of dim 49152
2025-03-13 15:52:32,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:52:32,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:32
2025-03-13 15:52:32,045 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:32,045 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:52:32,045 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:32,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:32,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:32
2025-03-13 15:52:32,046 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:32,046 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:52:32,046 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:32
2025-03-13 15:52:32,046 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:32,046 [INFO]: 	Creating the index 03/13/2025, 15:52:32
2025-03-13 15:52:32,046 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:32
2025-03-13 15:52:32,047 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:52:32,047 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:32
2025-03-13 15:52:32,048 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:52:32,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.17it/s]  6%|▌         | 2/34 [00:00<00:05,  5.69it/s]  9%|▉         | 3/34 [00:00<00:04,  6.40it/s] 12%|█▏        | 4/34 [00:00<00:04,  6.66it/s] 15%|█▍        | 5/34 [00:00<00:04,  6.91it/s] 18%|█▊        | 6/34 [00:00<00:03,  7.06it/s] 21%|██        | 7/34 [00:01<00:03,  7.00it/s] 24%|██▎       | 8/34 [00:01<00:03,  6.91it/s] 26%|██▋       | 9/34 [00:01<00:03,  6.89it/s] 29%|██▉       | 10/34 [00:01<00:03,  6.72it/s] 32%|███▏      | 11/34 [00:01<00:03,  6.72it/s] 35%|███▌      | 12/34 [00:01<00:03,  6.81it/s] 38%|███▊      | 13/34 [00:01<00:03,  6.87it/s] 41%|████      | 14/34 [00:02<00:02,  6.86it/s] 44%|████▍     | 15/34 [00:02<00:02,  6.91it/s] 47%|████▋     | 16/34 [00:02<00:02,  7.05it/s] 50%|█████     | 17/34 [00:02<00:02,  7.04it/s] 53%|█████▎    | 18/34 [00:02<00:02,  7.06it/s] 56%|█████▌    | 19/34 [00:02<00:02,  7.06it/s] 59%|█████▉    | 20/34 [00:02<00:01,  7.14it/s] 62%|██████▏   | 21/34 [00:07<00:20,  1.59s/it] 71%|███████   | 24/34 [00:08<00:07,  1.39it/s] 79%|███████▉  | 27/34 [00:08<00:02,  2.39it/s] 88%|████████▊ | 30/34 [00:08<00:01,  3.67it/s] 97%|█████████▋| 33/34 [00:08<00:00,  5.24it/s]100%|██████████| 34/34 [00:11<00:00,  2.84it/s]
2025-03-13 15:52:44,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:44
2025-03-13 15:54:02,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.8615 secs
2025-03-13 15:54:02,895 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 15:54:02,895 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.97it/s] 50%|█████     | 2/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 15:54:57,389 [INFO]: 	>>> Finished "Compute fast metrics" in 54.4931 secs
2025-03-13 15:54:57,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.3442 secs
2025-03-13 15:54:57,392 [INFO]: {
2025-03-13 15:54:57,392 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:57,392 [INFO]: 	index_param: efSearch=148
2025-03-13 15:54:57,392 [INFO]: 	index_path: knn.index
2025-03-13 15:54:57,392 [INFO]: 	size in bytes: 1625499670
2025-03-13 15:54:57,392 [INFO]: 	avg_search_speed_ms: 12.348731744022649
2025-03-13 15:54:57,392 [INFO]: 	99p_search_speed_ms: 20.423672823235393
2025-03-13 15:54:57,392 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:57,392 [INFO]: 	nb vectors: 8262
2025-03-13 15:54:57,392 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:57,392 [INFO]: 	compression ratio: 0.999308290231766
2025-03-13 15:54:57,392 [INFO]: }
2025-03-13 15:54:57,392 [INFO]: 	>>> Finished "Creating the index" in 145.3464 secs
2025-03-13 15:54:57,392 [INFO]: >>> Finished "Launching the whole pipeline" in 145.3750 secs
2025-03-13 15:54:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 78485 [episode count 8/20]
[retrieval_preprocessing] for episode 59548 [episode count 9/20], we have num_retrieval=np.int64(8304) num_query=np.int64(263)
2025-03-13 15:55:02,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:04,418 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:04
2025-03-13 15:55:04,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1419.39it/s]
2025-03-13 15:55:04,444 [INFO]: There are 8304 embeddings of dim 49152
2025-03-13 15:55:04,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:55:04,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:04,444 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 15:55:04,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:04,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:04,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,444 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:04,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:55:04,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:04
2025-03-13 15:55:04,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:04,444 [INFO]: 	Creating the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:04
2025-03-13 15:55:04,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:55:04,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,446 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:55:04,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.15it/s]  9%|▉         | 3/34 [00:00<00:02, 11.07it/s] 15%|█▍        | 5/34 [00:00<00:02, 12.92it/s] 21%|██        | 7/34 [00:00<00:02, 10.84it/s] 26%|██▋       | 9/34 [00:00<00:02,  9.62it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.11it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.82it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.56it/s] 41%|████      | 14/34 [00:01<00:02,  8.34it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.57it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.84it/s] 50%|█████     | 17/34 [00:01<00:01,  9.06it/s] 56%|█████▌    | 19/34 [00:02<00:01,  9.43it/s] 62%|██████▏   | 21/34 [00:07<00:13,  1.04s/it] 65%|██████▍   | 22/34 [00:07<00:10,  1.20it/s] 71%|███████   | 24/34 [00:07<00:05,  1.82it/s] 76%|███████▋  | 26/34 [00:07<00:03,  2.59it/s] 79%|███████▉  | 27/34 [00:07<00:02,  3.05it/s] 85%|████████▌ | 29/34 [00:07<00:01,  4.10it/s] 91%|█████████ | 31/34 [00:08<00:00,  4.92it/s] 94%|█████████▍| 32/34 [00:08<00:00,  5.37it/s]100%|██████████| 34/34 [00:11<00:00,  1.24it/s]100%|██████████| 34/34 [00:11<00:00,  2.84it/s]
2025-03-13 15:55:16,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:16
2025-03-13 15:56:40,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.0629 secs
2025-03-13 15:56:40,506 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 15:56:40,506 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.49it/s]
2025-03-13 15:57:24,080 [INFO]: 	>>> Finished "Compute fast metrics" in 43.5734 secs
2025-03-13 15:57:24,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.6367 secs
2025-03-13 15:57:24,082 [INFO]: {
2025-03-13 15:57:24,082 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:24,083 [INFO]: 	index_param: efSearch=125
2025-03-13 15:57:24,083 [INFO]: 	index_path: knn.index
2025-03-13 15:57:24,083 [INFO]: 	size in bytes: 1633762870
2025-03-13 15:57:24,083 [INFO]: 	avg_search_speed_ms: 9.787652294111389
2025-03-13 15:57:24,083 [INFO]: 	99p_search_speed_ms: 18.084633767139167
2025-03-13 15:57:24,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:24,083 [INFO]: 	nb vectors: 8304
2025-03-13 15:57:24,083 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:24,083 [INFO]: 	compression ratio: 0.9993083218986364
2025-03-13 15:57:24,083 [INFO]: }
2025-03-13 15:57:24,083 [INFO]: 	>>> Finished "Creating the index" in 139.6383 secs
2025-03-13 15:57:24,083 [INFO]: >>> Finished "Launching the whole pipeline" in 139.6646 secs
2025-03-13 15:57:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 59548 [episode count 9/20]
[retrieval_preprocessing] for episode 80061 [episode count 10/20], we have num_retrieval=np.int64(7537) num_query=np.int64(1030)
2025-03-13 15:57:29,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:31,612 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:31
2025-03-13 15:57:31,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.47it/s]
2025-03-13 15:57:31,640 [INFO]: There are 7537 embeddings of dim 49152
2025-03-13 15:57:31,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:57:31,640 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:31
2025-03-13 15:57:31,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:31,640 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 15:57:31,640 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:31,640 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:31,640 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:31
2025-03-13 15:57:31,640 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:31,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:57:31,641 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:31
2025-03-13 15:57:31,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:31,641 [INFO]: 	Creating the index 03/13/2025, 15:57:31
2025-03-13 15:57:31,641 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:31
2025-03-13 15:57:31,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:57:31,642 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:31
2025-03-13 15:57:31,642 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:57:31,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:06,  4.58it/s]  6%|▋         | 2/31 [00:00<00:04,  6.63it/s] 10%|▉         | 3/31 [00:00<00:03,  7.77it/s] 13%|█▎        | 4/31 [00:00<00:03,  8.37it/s] 19%|█▉        | 6/31 [00:00<00:02,  9.08it/s] 23%|██▎       | 7/31 [00:00<00:02,  8.88it/s] 26%|██▌       | 8/31 [00:01<00:08,  2.87it/s] 32%|███▏      | 10/31 [00:01<00:04,  4.29it/s] 35%|███▌      | 11/31 [00:02<00:04,  4.94it/s] 39%|███▊      | 12/31 [00:02<00:03,  5.65it/s] 42%|████▏     | 13/31 [00:02<00:02,  6.39it/s] 45%|████▌     | 14/31 [00:02<00:02,  7.01it/s] 48%|████▊     | 15/31 [00:02<00:02,  7.59it/s] 52%|█████▏    | 16/31 [00:02<00:01,  8.08it/s] 58%|█████▊    | 18/31 [00:02<00:01, 10.41it/s] 65%|██████▍   | 20/31 [00:02<00:00, 12.02it/s] 71%|███████   | 22/31 [00:08<00:08,  1.01it/s] 74%|███████▍  | 23/31 [00:08<00:06,  1.24it/s] 77%|███████▋  | 24/31 [00:08<00:04,  1.53it/s] 81%|████████  | 25/31 [00:08<00:03,  1.92it/s] 84%|████████▍ | 26/31 [00:08<00:02,  2.40it/s] 87%|████████▋ | 27/31 [00:08<00:01,  2.98it/s] 90%|█████████ | 28/31 [00:08<00:00,  3.65it/s] 94%|█████████▎| 29/31 [00:08<00:00,  4.37it/s] 97%|█████████▋| 30/31 [00:08<00:00,  5.09it/s]100%|██████████| 31/31 [00:12<00:00,  1.08s/it]100%|██████████| 31/31 [00:12<00:00,  2.54it/s]
2025-03-13 15:57:43,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:43
2025-03-13 15:58:42,630 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7929 secs
2025-03-13 15:58:42,631 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:58:42,631 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.89it/s] 50%|█████     | 2/4 [00:00<00:00,  5.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 15:59:20,893 [INFO]: 	>>> Finished "Compute fast metrics" in 38.2618 secs
2025-03-13 15:59:20,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.2544 secs
2025-03-13 15:59:20,896 [INFO]: {
2025-03-13 15:59:20,896 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:20,897 [INFO]: 	index_param: efSearch=154
2025-03-13 15:59:20,897 [INFO]: 	index_path: knn.index
2025-03-13 15:59:20,897 [INFO]: 	size in bytes: 1482860410
2025-03-13 15:59:20,897 [INFO]: 	avg_search_speed_ms: 9.727585170207842
2025-03-13 15:59:20,897 [INFO]: 	99p_search_speed_ms: 17.682567390147597
2025-03-13 15:59:20,897 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:20,897 [INFO]: 	nb vectors: 7537
2025-03-13 15:59:20,897 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:20,897 [INFO]: 	compression ratio: 0.9993081520060273
2025-03-13 15:59:20,897 [INFO]: }
2025-03-13 15:59:20,897 [INFO]: 	>>> Finished "Creating the index" in 109.2560 secs
2025-03-13 15:59:20,897 [INFO]: >>> Finished "Launching the whole pipeline" in 109.2848 secs
2025-03-13 15:59:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 80061 [episode count 10/20]
[retrieval_preprocessing] for episode 17147 [episode count 11/20], we have num_retrieval=np.int64(8196) num_query=np.int64(371)
2025-03-13 15:59:33,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:34,706 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:34
2025-03-13 15:59:34,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.05it/s]
2025-03-13 15:59:34,731 [INFO]: There are 8196 embeddings of dim 49152
2025-03-13 15:59:34,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 15:59:34,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:34
2025-03-13 15:59:34,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:34,731 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 15:59:34,731 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:34,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:34,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:34
2025-03-13 15:59:34,731 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:34,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:59:34,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:34
2025-03-13 15:59:34,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:34,732 [INFO]: 	Creating the index 03/13/2025, 15:59:34
2025-03-13 15:59:34,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:34
2025-03-13 15:59:34,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:59:34,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:34
2025-03-13 15:59:34,733 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:59:34,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.35it/s]  6%|▌         | 2/34 [00:00<00:05,  6.01it/s]  9%|▉         | 3/34 [00:00<00:04,  7.21it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.89it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.28it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.59it/s] 21%|██        | 7/34 [00:00<00:03,  8.86it/s] 24%|██▎       | 8/34 [00:00<00:02,  8.97it/s] 26%|██▋       | 9/34 [00:01<00:02,  8.56it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.37it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.21it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.38it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.48it/s] 41%|████      | 14/34 [00:01<00:02,  8.85it/s] 44%|████▍     | 15/34 [00:01<00:02,  9.05it/s] 50%|█████     | 17/34 [00:01<00:01,  9.84it/s] 56%|█████▌    | 19/34 [00:02<00:01, 10.31it/s] 62%|██████▏   | 21/34 [00:06<00:10,  1.19it/s] 65%|██████▍   | 22/34 [00:06<00:08,  1.42it/s] 68%|██████▊   | 23/34 [00:06<00:06,  1.75it/s] 71%|███████   | 24/34 [00:06<00:04,  2.17it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.70it/s] 76%|███████▋  | 26/34 [00:07<00:02,  3.34it/s] 79%|███████▉  | 27/34 [00:07<00:01,  4.05it/s] 85%|████████▌ | 29/34 [00:07<00:00,  5.49it/s] 88%|████████▊ | 30/34 [00:07<00:00,  6.13it/s] 91%|█████████ | 31/34 [00:07<00:00,  6.80it/s] 94%|█████████▍| 32/34 [00:07<00:00,  7.38it/s] 97%|█████████▋| 33/34 [00:07<00:00,  7.28it/s]100%|██████████| 34/34 [00:11<00:00,  1.13s/it]100%|██████████| 34/34 [00:11<00:00,  2.96it/s]
2025-03-13 15:59:46,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:46
2025-03-13 16:00:47,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7646 secs
2025-03-13 16:00:47,999 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 16:00:47,999 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 16:01:51,439 [INFO]: 	>>> Finished "Compute fast metrics" in 63.4394 secs
2025-03-13 16:01:51,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.7091 secs
2025-03-13 16:01:51,442 [INFO]: {
2025-03-13 16:01:51,442 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:51,442 [INFO]: 	index_param: efSearch=189
2025-03-13 16:01:51,442 [INFO]: 	index_path: knn.index
2025-03-13 16:01:51,442 [INFO]: 	size in bytes: 1612514830
2025-03-13 16:01:51,442 [INFO]: 	avg_search_speed_ms: 11.383663035454536
2025-03-13 16:01:51,442 [INFO]: 	99p_search_speed_ms: 19.480477450415496
2025-03-13 16:01:51,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:51,442 [INFO]: 	nb vectors: 8196
2025-03-13 16:01:51,442 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:51,442 [INFO]: 	compression ratio: 0.9993081229522708
2025-03-13 16:01:51,442 [INFO]: }
2025-03-13 16:01:51,442 [INFO]: 	>>> Finished "Creating the index" in 136.7107 secs
2025-03-13 16:01:51,442 [INFO]: >>> Finished "Launching the whole pipeline" in 136.7365 secs
2025-03-13 16:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 17147 [episode count 11/20]
[retrieval_preprocessing] for episode 49400 [episode count 12/20], we have num_retrieval=np.int64(8266) num_query=np.int64(301)
2025-03-13 16:01:58,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:00,223 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:00
2025-03-13 16:02:00,223 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2109.81it/s]
2025-03-13 16:02:00,248 [INFO]: There are 8266 embeddings of dim 49152
2025-03-13 16:02:00,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 16:02:00,248 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:00,248 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:02:00,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:00,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:02:00,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,248 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:00,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:02:00,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:00
2025-03-13 16:02:00,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:00,248 [INFO]: 	Creating the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:00
2025-03-13 16:02:00,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:02:00,249 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,249 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:02:00,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.06it/s]  9%|▉         | 3/34 [00:00<00:03,  8.81it/s] 15%|█▍        | 5/34 [00:00<00:02,  9.91it/s] 21%|██        | 7/34 [00:00<00:02, 10.30it/s] 26%|██▋       | 9/34 [00:00<00:02,  9.94it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.14it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.10it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.78it/s] 41%|████      | 14/34 [00:01<00:02,  8.34it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.22it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.33it/s] 50%|█████     | 17/34 [00:01<00:02,  8.20it/s] 53%|█████▎    | 18/34 [00:02<00:01,  8.14it/s] 56%|█████▌    | 19/34 [00:02<00:01,  7.80it/s] 59%|█████▉    | 20/34 [00:02<00:01,  7.61it/s] 62%|██████▏   | 21/34 [00:08<00:23,  1.82s/it] 65%|██████▍   | 22/34 [00:08<00:15,  1.31s/it] 68%|██████▊   | 23/34 [00:08<00:10,  1.05it/s] 71%|███████   | 24/34 [00:08<00:07,  1.43it/s] 76%|███████▋  | 26/34 [00:08<00:03,  2.36it/s] 82%|████████▏ | 28/34 [00:08<00:01,  3.45it/s] 85%|████████▌ | 29/34 [00:09<00:01,  4.03it/s] 88%|████████▊ | 30/34 [00:09<00:00,  4.70it/s] 94%|█████████▍| 32/34 [00:09<00:00,  6.07it/s]100%|██████████| 34/34 [00:12<00:00,  1.30it/s]100%|██████████| 34/34 [00:12<00:00,  2.63it/s]
2025-03-13 16:02:13,173 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:13
2025-03-13 16:03:15,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6696 secs
2025-03-13 16:03:15,843 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:03:15,843 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 16:04:28,659 [INFO]: 	>>> Finished "Compute fast metrics" in 72.8163 secs
2025-03-13 16:04:28,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.4139 secs
2025-03-13 16:04:28,664 [INFO]: {
2025-03-13 16:04:28,664 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:28,664 [INFO]: 	index_param: efSearch=177
2025-03-13 16:04:28,664 [INFO]: 	index_path: knn.index
2025-03-13 16:04:28,664 [INFO]: 	size in bytes: 1626286630
2025-03-13 16:04:28,664 [INFO]: 	avg_search_speed_ms: 10.637114836556956
2025-03-13 16:04:28,664 [INFO]: 	99p_search_speed_ms: 20.34031087765471
2025-03-13 16:04:28,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:28,664 [INFO]: 	nb vectors: 8266
2025-03-13 16:04:28,664 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:28,664 [INFO]: 	compression ratio: 0.9993083002840649
2025-03-13 16:04:28,664 [INFO]: }
2025-03-13 16:04:28,664 [INFO]: 	>>> Finished "Creating the index" in 148.4153 secs
2025-03-13 16:04:28,664 [INFO]: >>> Finished "Launching the whole pipeline" in 148.4403 secs
2025-03-13 16:04:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 49400 [episode count 12/20]
[retrieval_preprocessing] for episode 12031 [episode count 13/20], we have num_retrieval=np.int64(8159) num_query=np.int64(408)
2025-03-13 16:04:36,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:38,339 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:38
2025-03-13 16:04:38,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 16:04:38,363 [INFO]: There are 8159 embeddings of dim 49152
2025-03-13 16:04:38,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:04:38,364 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:38
2025-03-13 16:04:38,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:38,364 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:04:38,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:38,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:38,364 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:38
2025-03-13 16:04:38,364 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:38,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:04:38,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:38
2025-03-13 16:04:38,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:38,364 [INFO]: 	Creating the index 03/13/2025, 16:04:38
2025-03-13 16:04:38,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:38
2025-03-13 16:04:38,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:04:38,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:38
2025-03-13 16:04:38,365 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:04:38,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:08,  3.73it/s]  6%|▌         | 2/34 [00:00<00:06,  5.20it/s] 12%|█▏        | 4/34 [00:00<00:03,  7.70it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.78it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.92it/s] 29%|██▉       | 10/34 [00:01<00:02, 10.54it/s] 35%|███▌      | 12/34 [00:01<00:02, 10.95it/s] 41%|████      | 14/34 [00:01<00:01, 11.15it/s] 47%|████▋     | 16/34 [00:01<00:01, 11.35it/s] 53%|█████▎    | 18/34 [00:01<00:01, 11.35it/s] 59%|█████▉    | 20/34 [00:02<00:01, 10.94it/s] 65%|██████▍   | 22/34 [00:08<00:11,  1.00it/s] 68%|██████▊   | 23/34 [00:08<00:09,  1.19it/s] 71%|███████   | 24/34 [00:08<00:06,  1.45it/s] 74%|███████▎  | 25/34 [00:08<00:05,  1.79it/s] 76%|███████▋  | 26/34 [00:08<00:03,  2.23it/s] 79%|███████▉  | 27/34 [00:08<00:02,  2.78it/s] 82%|████████▏ | 28/34 [00:08<00:01,  3.45it/s] 85%|████████▌ | 29/34 [00:08<00:01,  4.21it/s] 88%|████████▊ | 30/34 [00:08<00:00,  5.03it/s] 91%|█████████ | 31/34 [00:09<00:00,  5.64it/s] 97%|█████████▋| 33/34 [00:09<00:00,  7.16it/s]100%|██████████| 34/34 [00:13<00:00,  1.16s/it]100%|██████████| 34/34 [00:13<00:00,  2.50it/s]
2025-03-13 16:04:51,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:51
2025-03-13 16:05:53,101 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1341 secs
2025-03-13 16:05:53,102 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 16:05:53,102 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 16:07:00,983 [INFO]: 	>>> Finished "Compute fast metrics" in 67.8813 secs
2025-03-13 16:07:00,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.6206 secs
2025-03-13 16:07:00,986 [INFO]: {
2025-03-13 16:07:00,986 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:00,986 [INFO]: 	index_param: efSearch=148
2025-03-13 16:07:00,986 [INFO]: 	index_path: knn.index
2025-03-13 16:07:00,986 [INFO]: 	size in bytes: 1605235090
2025-03-13 16:07:00,986 [INFO]: 	avg_search_speed_ms: 8.83785634018336
2025-03-13 16:07:00,986 [INFO]: 	99p_search_speed_ms: 16.164736216887835
2025-03-13 16:07:00,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:00,986 [INFO]: 	nb vectors: 8159
2025-03-13 16:07:00,986 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:00,986 [INFO]: 	compression ratio: 0.999308252101566
2025-03-13 16:07:00,986 [INFO]: }
2025-03-13 16:07:00,986 [INFO]: 	>>> Finished "Creating the index" in 142.6221 secs
2025-03-13 16:07:00,986 [INFO]: >>> Finished "Launching the whole pipeline" in 142.6471 secs
2025-03-13 16:07:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 12031 [episode count 13/20]
[retrieval_preprocessing] for episode 61695 [episode count 14/20], we have num_retrieval=np.int64(8265) num_query=np.int64(302)
2025-03-13 16:07:07,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:09,175 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:09
2025-03-13 16:07:09,175 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1099.42it/s]
2025-03-13 16:07:09,205 [INFO]: There are 8265 embeddings of dim 49152
2025-03-13 16:07:09,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:07:09,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:09
2025-03-13 16:07:09,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:09,206 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:07:09,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:09,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:09,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:09
2025-03-13 16:07:09,206 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:09,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:09,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:09
2025-03-13 16:07:09,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:09,206 [INFO]: 	Creating the index 03/13/2025, 16:07:09
2025-03-13 16:07:09,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:09
2025-03-13 16:07:09,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:07:09,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:09
2025-03-13 16:07:09,208 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:07:09,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.35it/s]  9%|▉         | 3/34 [00:00<00:03,  7.82it/s] 12%|█▏        | 4/34 [00:00<00:04,  6.89it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.34it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.16it/s] 29%|██▉       | 10/34 [00:01<00:02,  9.49it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.83it/s] 41%|████      | 14/34 [00:01<00:01, 10.16it/s] 47%|████▋     | 16/34 [00:01<00:01, 10.50it/s] 53%|█████▎    | 18/34 [00:01<00:01, 10.61it/s] 59%|█████▉    | 20/34 [00:02<00:01, 11.08it/s] 65%|██████▍   | 22/34 [00:06<00:09,  1.28it/s] 68%|██████▊   | 23/34 [00:06<00:07,  1.51it/s] 71%|███████   | 24/34 [00:06<00:05,  1.82it/s] 76%|███████▋  | 26/34 [00:07<00:03,  2.61it/s] 79%|███████▉  | 27/34 [00:07<00:02,  3.08it/s] 82%|████████▏ | 28/34 [00:07<00:01,  3.66it/s] 85%|████████▌ | 29/34 [00:07<00:01,  4.31it/s] 88%|████████▊ | 30/34 [00:07<00:00,  5.04it/s] 91%|█████████ | 31/34 [00:07<00:00,  5.81it/s] 94%|█████████▍| 32/34 [00:07<00:00,  6.58it/s]100%|██████████| 34/34 [00:11<00:00,  1.07it/s]100%|██████████| 34/34 [00:11<00:00,  2.93it/s]
2025-03-13 16:07:20,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:20
2025-03-13 16:08:35,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.9499 secs
2025-03-13 16:08:35,760 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 16:08:35,760 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 16:09:32,245 [INFO]: 	>>> Finished "Compute fast metrics" in 56.4853 secs
2025-03-13 16:09:32,248 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.0397 secs
2025-03-13 16:09:32,248 [INFO]: {
2025-03-13 16:09:32,248 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:32,248 [INFO]: 	index_param: efSearch=159
2025-03-13 16:09:32,248 [INFO]: 	index_path: knn.index
2025-03-13 16:09:32,248 [INFO]: 	size in bytes: 1626089890
2025-03-13 16:09:32,248 [INFO]: 	avg_search_speed_ms: 6.906182875018052
2025-03-13 16:09:32,248 [INFO]: 	99p_search_speed_ms: 13.978848354890943
2025-03-13 16:09:32,248 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:32,248 [INFO]: 	nb vectors: 8265
2025-03-13 16:09:32,248 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:32,248 [INFO]: 	compression ratio: 0.9993082977719024
2025-03-13 16:09:32,248 [INFO]: }
2025-03-13 16:09:32,248 [INFO]: 	>>> Finished "Creating the index" in 143.0415 secs
2025-03-13 16:09:32,248 [INFO]: >>> Finished "Launching the whole pipeline" in 143.0727 secs
2025-03-13 16:09:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 61695 [episode count 14/20]
[retrieval_preprocessing] for episode 26375 [episode count 15/20], we have num_retrieval=np.int64(7685) num_query=np.int64(882)
2025-03-13 16:09:38,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:39,980 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:39
2025-03-13 16:09:39,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.83it/s]
2025-03-13 16:09:40,006 [INFO]: There are 7685 embeddings of dim 49152
2025-03-13 16:09:40,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:09:40,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:40
2025-03-13 16:09:40,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:40,006 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 16:09:40,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:40,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:09:40,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:40
2025-03-13 16:09:40,007 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:40,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:09:40,007 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:40
2025-03-13 16:09:40,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:40,007 [INFO]: 	Creating the index 03/13/2025, 16:09:40
2025-03-13 16:09:40,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:40
2025-03-13 16:09:40,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:09:40,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:40
2025-03-13 16:09:40,008 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:09:40,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  4.91it/s]  9%|▉         | 3/32 [00:00<00:03,  8.50it/s] 16%|█▌        | 5/32 [00:00<00:02,  9.70it/s] 22%|██▏       | 7/32 [00:00<00:02,  9.79it/s] 25%|██▌       | 8/32 [00:00<00:02,  9.62it/s] 28%|██▊       | 9/32 [00:00<00:02,  9.47it/s] 31%|███▏      | 10/32 [00:01<00:02,  9.34it/s] 34%|███▍      | 11/32 [00:01<00:02,  9.25it/s] 38%|███▊      | 12/32 [00:01<00:02,  9.18it/s] 41%|████      | 13/32 [00:01<00:02,  8.91it/s] 47%|████▋     | 15/32 [00:01<00:01,  9.83it/s] 53%|█████▎    | 17/32 [00:01<00:01, 10.23it/s] 59%|█████▉    | 19/32 [00:01<00:01, 10.65it/s] 66%|██████▌   | 21/32 [00:05<00:08,  1.37it/s] 72%|███████▏  | 23/32 [00:06<00:04,  1.92it/s] 78%|███████▊  | 25/32 [00:06<00:02,  2.60it/s] 84%|████████▍ | 27/32 [00:06<00:01,  3.39it/s] 91%|█████████ | 29/32 [00:06<00:00,  4.25it/s] 94%|█████████▍| 30/32 [00:06<00:00,  4.70it/s] 97%|█████████▋| 31/32 [00:06<00:00,  5.23it/s]100%|██████████| 32/32 [00:09<00:00,  1.32it/s]100%|██████████| 32/32 [00:09<00:00,  3.34it/s]
2025-03-13 16:09:49,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:49
2025-03-13 16:10:51,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.3320 secs
2025-03-13 16:10:51,916 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 16:10:51,916 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 16:11:24,529 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6135 secs
2025-03-13 16:11:24,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.5236 secs
2025-03-13 16:11:24,532 [INFO]: {
2025-03-13 16:11:24,532 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:24,532 [INFO]: 	index_param: efSearch=125
2025-03-13 16:11:24,532 [INFO]: 	index_path: knn.index
2025-03-13 16:11:24,532 [INFO]: 	size in bytes: 1511978650
2025-03-13 16:11:24,532 [INFO]: 	avg_search_speed_ms: 7.500134247202968
2025-03-13 16:11:24,532 [INFO]: 	99p_search_speed_ms: 12.538689298089595
2025-03-13 16:11:24,532 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:24,532 [INFO]: 	nb vectors: 7685
2025-03-13 16:11:24,532 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:24,532 [INFO]: 	compression ratio: 0.9993080788541557
2025-03-13 16:11:24,532 [INFO]: }
2025-03-13 16:11:24,532 [INFO]: 	>>> Finished "Creating the index" in 104.5253 secs
2025-03-13 16:11:24,532 [INFO]: >>> Finished "Launching the whole pipeline" in 104.5527 secs
2025-03-13 16:11:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 26375 [episode count 15/20]
[retrieval_preprocessing] for episode 4413 [episode count 16/20], we have num_retrieval=np.int64(8100) num_query=np.int64(467)
2025-03-13 16:11:35,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:36,624 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:36
2025-03-13 16:11:36,624 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 846.31it/s]
2025-03-13 16:11:36,681 [INFO]: There are 8100 embeddings of dim 49152
2025-03-13 16:11:36,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0573 secs
2025-03-13 16:11:36,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:36
2025-03-13 16:11:36,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:36,682 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 16:11:36,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:36,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:11:36,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:36
2025-03-13 16:11:36,682 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:36,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:11:36,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:36
2025-03-13 16:11:36,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:36,683 [INFO]: 	Creating the index 03/13/2025, 16:11:36
2025-03-13 16:11:36,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:36
2025-03-13 16:11:36,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:11:36,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:36
2025-03-13 16:11:36,684 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:11:36,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.99it/s] 18%|█▊        | 6/33 [00:00<00:00, 29.35it/s] 30%|███       | 10/33 [00:00<00:00, 31.73it/s] 45%|████▌     | 15/33 [00:00<00:00, 35.94it/s] 61%|██████    | 20/33 [00:00<00:00, 38.24it/s] 73%|███████▎  | 24/33 [00:05<00:03,  2.43it/s] 82%|████████▏ | 27/33 [00:05<00:01,  3.04it/s] 91%|█████████ | 30/33 [00:06<00:00,  3.78it/s] 97%|█████████▋| 32/33 [00:06<00:00,  4.38it/s]100%|██████████| 33/33 [00:10<00:00,  3.18it/s]
2025-03-13 16:11:47,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:47
2025-03-13 16:12:50,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.2385 secs
2025-03-13 16:12:50,297 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 16:12:50,297 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.97s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.08s/it]
2025-03-13 16:14:02,607 [INFO]: 	>>> Finished "Compute fast metrics" in 72.3100 secs
2025-03-13 16:14:02,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.9261 secs
2025-03-13 16:14:02,611 [INFO]: {
2025-03-13 16:14:02,611 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:02,611 [INFO]: 	index_param: efSearch=162
2025-03-13 16:14:02,611 [INFO]: 	index_path: knn.index
2025-03-13 16:14:02,611 [INFO]: 	size in bytes: 1593627250
2025-03-13 16:14:02,611 [INFO]: 	avg_search_speed_ms: 9.163433087282874
2025-03-13 16:14:02,611 [INFO]: 	99p_search_speed_ms: 15.953077608719466
2025-03-13 16:14:02,611 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:02,611 [INFO]: 	nb vectors: 8100
2025-03-13 16:14:02,611 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:02,611 [INFO]: 	compression ratio: 0.9993082133855329
2025-03-13 16:14:02,611 [INFO]: }
2025-03-13 16:14:02,611 [INFO]: 	>>> Finished "Creating the index" in 145.9283 secs
2025-03-13 16:14:02,611 [INFO]: >>> Finished "Launching the whole pipeline" in 145.9866 secs
2025-03-13 16:14:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 4413 [episode count 16/20]
[retrieval_preprocessing] for episode 2913 [episode count 17/20], we have num_retrieval=np.int64(8035) num_query=np.int64(532)
2025-03-13 16:14:20,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:21,918 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:21
2025-03-13 16:14:21,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.25it/s]
2025-03-13 16:14:21,948 [INFO]: There are 8035 embeddings of dim 49152
2025-03-13 16:14:21,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:14:21,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:21
2025-03-13 16:14:21,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:21,949 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 16:14:21,949 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:21,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:14:21,949 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:21
2025-03-13 16:14:21,950 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:21,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:14:21,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:21
2025-03-13 16:14:21,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:21,950 [INFO]: 	Creating the index 03/13/2025, 16:14:21
2025-03-13 16:14:21,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:21
2025-03-13 16:14:21,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:14:21,954 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:21
2025-03-13 16:14:21,954 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:14:21,954 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:04<02:31,  4.72s/it]  6%|▌         | 2/33 [00:04<01:02,  2.01s/it] 12%|█▏        | 4/33 [00:05<00:23,  1.24it/s] 15%|█▌        | 5/33 [00:05<00:16,  1.68it/s] 18%|█▊        | 6/33 [00:05<00:12,  2.24it/s] 21%|██        | 7/33 [00:05<00:08,  2.90it/s] 24%|██▍       | 8/33 [00:05<00:06,  3.67it/s] 27%|██▋       | 9/33 [00:05<00:05,  4.46it/s] 30%|███       | 10/33 [00:05<00:04,  5.24it/s] 33%|███▎      | 11/33 [00:05<00:03,  6.07it/s] 36%|███▋      | 12/33 [00:05<00:03,  6.83it/s] 42%|████▏     | 14/33 [00:06<00:02,  7.97it/s] 45%|████▌     | 15/33 [00:06<00:02,  8.34it/s] 52%|█████▏    | 17/33 [00:06<00:01,  8.99it/s] 55%|█████▍    | 18/33 [00:06<00:01,  8.92it/s] 61%|██████    | 20/33 [00:06<00:01, 10.54it/s] 67%|██████▋   | 22/33 [00:10<00:08,  1.28it/s] 73%|███████▎  | 24/33 [00:10<00:04,  1.83it/s] 79%|███████▉  | 26/33 [00:11<00:02,  2.51it/s] 82%|████████▏ | 27/33 [00:11<00:02,  2.90it/s] 85%|████████▍ | 28/33 [00:11<00:01,  3.38it/s] 88%|████████▊ | 29/33 [00:11<00:01,  2.55it/s] 91%|█████████ | 30/33 [00:12<00:00,  3.10it/s] 94%|█████████▍| 31/33 [00:12<00:00,  3.73it/s] 97%|█████████▋| 32/33 [00:12<00:00,  4.35it/s]100%|██████████| 33/33 [00:15<00:00,  1.17s/it]100%|██████████| 33/33 [00:15<00:00,  2.08it/s]
2025-03-13 16:14:37,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:37
2025-03-13 16:15:51,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.0471 secs
2025-03-13 16:15:51,910 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:15:51,910 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 16:16:55,289 [INFO]: 	>>> Finished "Compute fast metrics" in 63.3790 secs
2025-03-13 16:16:55,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 153.3379 secs
2025-03-13 16:16:55,292 [INFO]: {
2025-03-13 16:16:55,292 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:55,292 [INFO]: 	index_param: efSearch=187
2025-03-13 16:16:55,292 [INFO]: 	index_path: knn.index
2025-03-13 16:16:55,292 [INFO]: 	size in bytes: 1580838790
2025-03-13 16:16:55,292 [INFO]: 	avg_search_speed_ms: 9.77382631148535
2025-03-13 16:16:55,292 [INFO]: 	99p_search_speed_ms: 20.272969668731086
2025-03-13 16:16:55,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:55,292 [INFO]: 	nb vectors: 8035
2025-03-13 16:16:55,292 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:55,292 [INFO]: 	compression ratio: 0.9993082722875241
2025-03-13 16:16:55,292 [INFO]: }
2025-03-13 16:16:55,292 [INFO]: 	>>> Finished "Creating the index" in 153.3417 secs
2025-03-13 16:16:55,292 [INFO]: >>> Finished "Launching the whole pipeline" in 153.3743 secs
2025-03-13 16:16:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 2913 [episode count 17/20]
[retrieval_preprocessing] for episode 82790 [episode count 18/20], we have num_retrieval=np.int64(8126) num_query=np.int64(441)
2025-03-13 16:17:04,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:05,696 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:05
2025-03-13 16:17:05,696 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-13 16:17:05,721 [INFO]: There are 8126 embeddings of dim 49152
2025-03-13 16:17:05,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:17:05,722 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:05
2025-03-13 16:17:05,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:05,722 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 16:17:05,722 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:05,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:05,722 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:05
2025-03-13 16:17:05,722 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:05,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:17:05,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:05
2025-03-13 16:17:05,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:05,722 [INFO]: 	Creating the index 03/13/2025, 16:17:05
2025-03-13 16:17:05,722 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:05
2025-03-13 16:17:05,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:17:05,724 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:05
2025-03-13 16:17:05,724 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:17:05,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.56it/s]  6%|▌         | 2/33 [00:00<00:04,  6.58it/s] 12%|█▏        | 4/33 [00:00<00:03,  8.41it/s] 18%|█▊        | 6/33 [00:00<00:02,  9.22it/s] 21%|██        | 7/33 [00:00<00:02,  9.40it/s] 24%|██▍       | 8/33 [00:00<00:02,  9.54it/s] 27%|██▋       | 9/33 [00:01<00:02,  9.60it/s] 30%|███       | 10/33 [00:01<00:02,  9.46it/s] 33%|███▎      | 11/33 [00:01<00:02,  9.59it/s] 36%|███▋      | 12/33 [00:01<00:02,  9.61it/s] 39%|███▉      | 13/33 [00:01<00:02,  9.58it/s] 42%|████▏     | 14/33 [00:01<00:01,  9.55it/s] 45%|████▌     | 15/33 [00:01<00:01,  9.56it/s] 52%|█████▏    | 17/33 [00:01<00:01,  9.71it/s] 55%|█████▍    | 18/33 [00:01<00:01,  9.74it/s] 58%|█████▊    | 19/33 [00:02<00:01,  9.79it/s] 64%|██████▎   | 21/33 [00:06<00:11,  1.02it/s] 70%|██████▉   | 23/33 [00:06<00:06,  1.56it/s] 76%|███████▌  | 25/33 [00:06<00:03,  2.27it/s] 82%|████████▏ | 27/33 [00:06<00:01,  3.14it/s] 88%|████████▊ | 29/33 [00:07<00:00,  4.11it/s] 94%|█████████▍| 31/33 [00:07<00:00,  5.25it/s]100%|██████████| 33/33 [00:10<00:00,  1.63it/s]100%|██████████| 33/33 [00:10<00:00,  3.21it/s]
2025-03-13 16:17:16,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:16
2025-03-13 16:18:20,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.9051 secs
2025-03-13 16:18:20,909 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 16:18:20,909 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.01it/s] 50%|█████     | 2/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-13 16:19:18,106 [INFO]: 	>>> Finished "Compute fast metrics" in 57.1973 secs
2025-03-13 16:19:18,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.3863 secs
2025-03-13 16:19:18,110 [INFO]: {
2025-03-13 16:19:18,110 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:18,110 [INFO]: 	index_param: efSearch=174
2025-03-13 16:19:18,110 [INFO]: 	index_path: knn.index
2025-03-13 16:19:18,110 [INFO]: 	size in bytes: 1598742550
2025-03-13 16:19:18,110 [INFO]: 	avg_search_speed_ms: 10.375284507949894
2025-03-13 16:19:18,110 [INFO]: 	99p_search_speed_ms: 28.152373146731406
2025-03-13 16:19:18,110 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:18,110 [INFO]: 	nb vectors: 8126
2025-03-13 16:19:18,110 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:18,110 [INFO]: 	compression ratio: 0.9993082425935308
2025-03-13 16:19:18,110 [INFO]: }
2025-03-13 16:19:18,110 [INFO]: 	>>> Finished "Creating the index" in 132.3880 secs
2025-03-13 16:19:18,110 [INFO]: >>> Finished "Launching the whole pipeline" in 132.4145 secs
2025-03-13 16:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 82790 [episode count 18/20]
[retrieval_preprocessing] for episode 92521 [episode count 19/20], we have num_retrieval=np.int64(8098) num_query=np.int64(469)
2025-03-13 16:19:26,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:28,384 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:28
2025-03-13 16:19:28,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.09it/s]
2025-03-13 16:19:28,409 [INFO]: There are 8098 embeddings of dim 49152
2025-03-13 16:19:28,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:19:28,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:28
2025-03-13 16:19:28,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:28,410 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 16:19:28,410 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:28,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:28,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:28
2025-03-13 16:19:28,410 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:28,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:19:28,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:28
2025-03-13 16:19:28,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:28,410 [INFO]: 	Creating the index 03/13/2025, 16:19:28
2025-03-13 16:19:28,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:28
2025-03-13 16:19:28,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:19:28,411 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:28
2025-03-13 16:19:28,411 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 16:19:28,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.48it/s]  9%|▉         | 3/33 [00:00<00:03,  8.19it/s] 15%|█▌        | 5/33 [00:00<00:02,  9.75it/s] 21%|██        | 7/33 [00:00<00:02, 10.27it/s] 27%|██▋       | 9/33 [00:00<00:02, 10.42it/s] 33%|███▎      | 11/33 [00:01<00:02, 10.56it/s] 39%|███▉      | 13/33 [00:01<00:01, 10.25it/s] 45%|████▌     | 15/33 [00:01<00:01, 10.14it/s] 52%|█████▏    | 17/33 [00:01<00:01, 10.04it/s] 58%|█████▊    | 19/33 [00:01<00:01,  9.71it/s] 61%|██████    | 20/33 [00:02<00:01,  9.57it/s] 64%|██████▎   | 21/33 [00:07<00:13,  1.13s/it] 70%|██████▉   | 23/33 [00:07<00:07,  1.35it/s] 76%|███████▌  | 25/33 [00:07<00:04,  1.97it/s] 82%|████████▏ | 27/33 [00:07<00:02,  2.75it/s] 88%|████████▊ | 29/33 [00:07<00:01,  3.65it/s] 94%|█████████▍| 31/33 [00:07<00:00,  4.70it/s]100%|██████████| 33/33 [00:11<00:00,  1.37it/s]100%|██████████| 33/33 [00:11<00:00,  2.82it/s]
2025-03-13 16:19:40,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:40
2025-03-13 16:20:46,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.0995 secs
2025-03-13 16:20:46,208 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 16:20:46,208 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-13 16:21:36,236 [INFO]: 	>>> Finished "Compute fast metrics" in 50.0278 secs
2025-03-13 16:21:36,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.8278 secs
2025-03-13 16:21:36,239 [INFO]: {
2025-03-13 16:21:36,239 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:36,239 [INFO]: 	index_param: efSearch=146
2025-03-13 16:21:36,239 [INFO]: 	index_path: knn.index
2025-03-13 16:21:36,239 [INFO]: 	size in bytes: 1593233770
2025-03-13 16:21:36,239 [INFO]: 	avg_search_speed_ms: 9.298948712083837
2025-03-13 16:21:36,240 [INFO]: 	99p_search_speed_ms: 19.312536902725693
2025-03-13 16:21:36,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:36,240 [INFO]: 	nb vectors: 8098
2025-03-13 16:21:36,240 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:36,240 [INFO]: 	compression ratio: 0.9993082082361335
2025-03-13 16:21:36,240 [INFO]: }
2025-03-13 16:21:36,240 [INFO]: 	>>> Finished "Creating the index" in 127.8296 secs
2025-03-13 16:21:36,240 [INFO]: >>> Finished "Launching the whole pipeline" in 127.8560 secs
2025-03-13 16:21:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 92521 [episode count 19/20]
2025-03-13 16:21:40: [retrieval_preprocessing] finished for 4130977918_unfold_towel [chosen_id count 2/196]
2025-03-13 16:21:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4130977918_close_kettle [chosen_id count 3/196]
2025-03-13 16:21:44: [retrieval_preprocessing] we have num_total=3668 embedding_dim=49152
[retrieval_preprocessing] for episode 18948 [episode count 0/20], we have num_retrieval=np.int64(3522) num_query=np.int64(146)
2025-03-13 16:21:45,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:46,276 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:46
2025-03-13 16:21:46,276 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.15it/s]
2025-03-13 16:21:46,302 [INFO]: There are 3522 embeddings of dim 49152
2025-03-13 16:21:46,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:21:46,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:46
2025-03-13 16:21:46,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:46,303 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:21:46,303 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:46,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:46,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:46
2025-03-13 16:21:46,303 [INFO]: 726.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:46,303 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:46,303 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:46
2025-03-13 16:21:46,303 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:46,303 [INFO]: 	Creating the index 03/13/2025, 16:21:46
2025-03-13 16:21:46,303 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:46
2025-03-13 16:21:46,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:21:46,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:46
2025-03-13 16:21:46,305 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:21:46,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.66it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.28it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.02it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.99it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.15it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.60it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.71it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.85it/s]100%|██████████| 14/14 [00:04<00:00,  1.69it/s]100%|██████████| 14/14 [00:04<00:00,  3.18it/s]
2025-03-13 16:21:50,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:50
2025-03-13 16:22:27,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4330 secs
2025-03-13 16:22:27,149 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 16:22:27,149 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s]
2025-03-13 16:22:57,445 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2951 secs
2025-03-13 16:22:57,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1428 secs
2025-03-13 16:22:57,447 [INFO]: {
2025-03-13 16:22:57,447 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:57,447 [INFO]: 	index_param: efSearch=170
2025-03-13 16:22:57,447 [INFO]: 	index_path: knn.index
2025-03-13 16:22:57,447 [INFO]: 	size in bytes: 692931790
2025-03-13 16:22:57,447 [INFO]: 	avg_search_speed_ms: 7.947285285564539
2025-03-13 16:22:57,447 [INFO]: 	99p_search_speed_ms: 13.154369774274532
2025-03-13 16:22:57,448 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:57,448 [INFO]: 	nb vectors: 3522
2025-03-13 16:22:57,448 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:57,448 [INFO]: 	compression ratio: 0.9993095799515851
2025-03-13 16:22:57,448 [INFO]: }
2025-03-13 16:22:57,448 [INFO]: 	>>> Finished "Creating the index" in 71.1444 secs
2025-03-13 16:22:57,448 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1718 secs
2025-03-13 16:22:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18948 [episode count 0/20]
[retrieval_preprocessing] for episode 50181 [episode count 1/20], we have num_retrieval=np.int64(3550) num_query=np.int64(118)
2025-03-13 16:22:59,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:00,195 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:00
2025-03-13 16:23:00,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.23it/s]
2025-03-13 16:23:00,219 [INFO]: There are 3550 embeddings of dim 49152
2025-03-13 16:23:00,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 16:23:00,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:00
2025-03-13 16:23:00,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:00,219 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 16:23:00,219 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:00,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:00,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:00
2025-03-13 16:23:00,219 [INFO]: 732.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:00,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:23:00,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:00
2025-03-13 16:23:00,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:00,219 [INFO]: 	Creating the index 03/13/2025, 16:23:00
2025-03-13 16:23:00,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:00
2025-03-13 16:23:00,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:23:00,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:00
2025-03-13 16:23:00,220 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:23:00,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.36it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.27it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.16it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.44it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.55it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.60it/s] 50%|█████     | 7/14 [00:00<00:00,  8.75it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.72it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.75it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.75it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.77it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.89it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.86it/s]100%|██████████| 14/14 [00:04<00:00,  1.11it/s]100%|██████████| 14/14 [00:04<00:00,  3.30it/s]
2025-03-13 16:23:04,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:04
2025-03-13 16:23:41,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0202 secs
2025-03-13 16:23:41,497 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 16:23:41,497 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 16:24:13,947 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4492 secs
2025-03-13 16:24:13,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7730 secs
2025-03-13 16:24:13,994 [INFO]: {
2025-03-13 16:24:13,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:13,994 [INFO]: 	index_param: efSearch=153
2025-03-13 16:24:13,994 [INFO]: 	index_path: knn.index
2025-03-13 16:24:13,994 [INFO]: 	size in bytes: 698440690
2025-03-13 16:24:13,994 [INFO]: 	avg_search_speed_ms: 7.900950215840757
2025-03-13 16:24:13,994 [INFO]: 	99p_search_speed_ms: 11.571892583742706
2025-03-13 16:24:13,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:13,994 [INFO]: 	nb vectors: 3550
2025-03-13 16:24:13,994 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:13,994 [INFO]: 	compression ratio: 0.9993094760845047
2025-03-13 16:24:13,994 [INFO]: }
2025-03-13 16:24:13,994 [INFO]: 	>>> Finished "Creating the index" in 73.7752 secs
2025-03-13 16:24:13,995 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7990 secs
2025-03-13 16:24:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 50181 [episode count 1/20]
[retrieval_preprocessing] for episode 7187 [episode count 2/20], we have num_retrieval=np.int64(3492) num_query=np.int64(176)
2025-03-13 16:24:16,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:16,910 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:16
2025-03-13 16:24:16,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 16:24:16,935 [INFO]: There are 3492 embeddings of dim 49152
2025-03-13 16:24:16,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 16:24:16,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:16
2025-03-13 16:24:16,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:16,935 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:24:16,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:16,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:16,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:16
2025-03-13 16:24:16,935 [INFO]: 720.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:16,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:24:16,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:16
2025-03-13 16:24:16,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:16,935 [INFO]: 	Creating the index 03/13/2025, 16:24:16
2025-03-13 16:24:16,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:16
2025-03-13 16:24:16,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:24:16,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:16
2025-03-13 16:24:16,937 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:24:16,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.40it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.25it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.41it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.56it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.61it/s] 50%|█████     | 7/14 [00:00<00:00,  8.79it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.69it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.81it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.86it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.99it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.41it/s]100%|██████████| 14/14 [00:05<00:00,  1.03s/it]100%|██████████| 14/14 [00:05<00:00,  2.65it/s]
2025-03-13 16:24:22,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:22
2025-03-13 16:25:04,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2124 secs
2025-03-13 16:25:04,450 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 16:25:04,450 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 16:25:26,524 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0745 secs
2025-03-13 16:25:26,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5904 secs
2025-03-13 16:25:26,527 [INFO]: {
2025-03-13 16:25:26,527 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:26,527 [INFO]: 	index_param: efSearch=181
2025-03-13 16:25:26,527 [INFO]: 	index_path: knn.index
2025-03-13 16:25:26,527 [INFO]: 	size in bytes: 687029530
2025-03-13 16:25:26,527 [INFO]: 	avg_search_speed_ms: 9.062642408897958
2025-03-13 16:25:26,527 [INFO]: 	99p_search_speed_ms: 12.41089893039316
2025-03-13 16:25:26,527 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:26,527 [INFO]: 	nb vectors: 3492
2025-03-13 16:25:26,527 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:26,527 [INFO]: 	compression ratio: 0.9993094998405673
2025-03-13 16:25:26,527 [INFO]: }
2025-03-13 16:25:26,527 [INFO]: 	>>> Finished "Creating the index" in 69.5918 secs
2025-03-13 16:25:26,527 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6175 secs
2025-03-13 16:25:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 7187 [episode count 2/20]
[retrieval_preprocessing] for episode 57398 [episode count 3/20], we have num_retrieval=np.int64(3517) num_query=np.int64(151)
2025-03-13 16:25:29,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:29,641 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:29
2025-03-13 16:25:29,641 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 16:25:29,665 [INFO]: There are 3517 embeddings of dim 49152
2025-03-13 16:25:29,666 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 16:25:29,666 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:29
2025-03-13 16:25:29,666 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:29,666 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:25:29,666 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:29,666 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:29,666 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:29
2025-03-13 16:25:29,666 [INFO]: 725.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:29,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:25:29,666 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:29
2025-03-13 16:25:29,666 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:29,666 [INFO]: 	Creating the index 03/13/2025, 16:25:29
2025-03-13 16:25:29,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:29
2025-03-13 16:25:29,667 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:25:29,667 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:29
2025-03-13 16:25:29,668 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:25:29,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.82it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.97it/s] 36%|███▌      | 5/14 [00:00<00:00, 13.92it/s] 50%|█████     | 7/14 [00:00<00:00, 15.19it/s] 64%|██████▍   | 9/14 [00:00<00:00, 15.42it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.86it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.06it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-13 16:25:33,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:33
2025-03-13 16:26:10,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2853 secs
2025-03-13 16:26:10,820 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 16:26:10,820 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 16:26:47,362 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5421 secs
2025-03-13 16:26:47,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.6980 secs
2025-03-13 16:26:47,366 [INFO]: {
2025-03-13 16:26:47,366 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:47,366 [INFO]: 	index_param: efSearch=224
2025-03-13 16:26:47,366 [INFO]: 	index_path: knn.index
2025-03-13 16:26:47,366 [INFO]: 	size in bytes: 691948090
2025-03-13 16:26:47,366 [INFO]: 	avg_search_speed_ms: 12.992127425363892
2025-03-13 16:26:47,366 [INFO]: 	99p_search_speed_ms: 23.38507779873907
2025-03-13 16:26:47,366 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:47,366 [INFO]: 	nb vectors: 3517
2025-03-13 16:26:47,366 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:47,366 [INFO]: 	compression ratio: 0.9993095522526841
2025-03-13 16:26:47,366 [INFO]: }
2025-03-13 16:26:47,366 [INFO]: 	>>> Finished "Creating the index" in 77.6998 secs
2025-03-13 16:26:47,366 [INFO]: >>> Finished "Launching the whole pipeline" in 77.7253 secs
2025-03-13 16:26:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 57398 [episode count 3/20]
[retrieval_preprocessing] for episode 62028 [episode count 4/20], we have num_retrieval=np.int64(3478) num_query=np.int64(190)
2025-03-13 16:26:51,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:52,049 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:52
2025-03-13 16:26:52,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.29it/s]
2025-03-13 16:26:52,074 [INFO]: There are 3478 embeddings of dim 49152
2025-03-13 16:26:52,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:26:52,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:52,075 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:26:52,075 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:52,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:26:52,075 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,075 [INFO]: 717.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:52,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:52,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:52
2025-03-13 16:26:52,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:52,075 [INFO]: 	Creating the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:52
2025-03-13 16:26:52,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:26:52,076 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,076 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:26:52,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.79it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.97it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.67it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.71it/s] 50%|█████     | 7/14 [00:00<00:00,  9.31it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.47it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.02it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.35it/s]100%|██████████| 14/14 [00:04<00:00,  1.62it/s]100%|██████████| 14/14 [00:04<00:00,  3.22it/s]
2025-03-13 16:26:56,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:56
2025-03-13 16:27:41,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0756 secs
2025-03-13 16:27:41,503 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:27:41,503 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 16:28:01,854 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3512 secs
2025-03-13 16:28:02,656 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5796 secs
2025-03-13 16:28:02,656 [INFO]: {
2025-03-13 16:28:02,656 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:02,656 [INFO]: 	index_param: efSearch=172
2025-03-13 16:28:02,657 [INFO]: 	index_path: knn.index
2025-03-13 16:28:02,657 [INFO]: 	size in bytes: 684275170
2025-03-13 16:28:02,657 [INFO]: 	avg_search_speed_ms: 8.452646488627687
2025-03-13 16:28:02,657 [INFO]: 	99p_search_speed_ms: 12.685947343707086
2025-03-13 16:28:02,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:02,657 [INFO]: 	nb vectors: 3478
2025-03-13 16:28:02,657 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:02,657 [INFO]: 	compression ratio: 0.9993094210915179
2025-03-13 16:28:02,657 [INFO]: }
2025-03-13 16:28:02,657 [INFO]: 	>>> Finished "Creating the index" in 70.5818 secs
2025-03-13 16:28:02,657 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6078 secs
2025-03-13 16:28:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 62028 [episode count 4/20]
[retrieval_preprocessing] for episode 75867 [episode count 5/20], we have num_retrieval=np.int64(3494) num_query=np.int64(174)
2025-03-13 16:28:05,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:05,686 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:05
2025-03-13 16:28:05,686 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-13 16:28:05,711 [INFO]: There are 3494 embeddings of dim 49152
2025-03-13 16:28:05,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 16:28:05,711 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:05
2025-03-13 16:28:05,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:05,712 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:28:05,712 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:05,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:28:05,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:05
2025-03-13 16:28:05,712 [INFO]: 721.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:05,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:28:05,712 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:05
2025-03-13 16:28:05,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:05,712 [INFO]: 	Creating the index 03/13/2025, 16:28:05
2025-03-13 16:28:05,712 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:05
2025-03-13 16:28:05,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 16:28:05,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:05
2025-03-13 16:28:05,714 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:28:05,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  4.21it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.55it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.86it/s] 50%|█████     | 7/14 [00:00<00:00, 10.08it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.36it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.24it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.43it/s]100%|██████████| 14/14 [00:03<00:00,  3.83it/s]
2025-03-13 16:28:09,375 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:09
2025-03-13 16:28:42,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8193 secs
2025-03-13 16:28:42,195 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 16:28:42,195 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.98it/s]
2025-03-13 16:29:18,540 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3439 secs
2025-03-13 16:29:19,047 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3326 secs
2025-03-13 16:29:19,047 [INFO]: {
2025-03-13 16:29:19,047 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:19,047 [INFO]: 	index_param: efSearch=166
2025-03-13 16:29:19,047 [INFO]: 	index_path: knn.index
2025-03-13 16:29:19,047 [INFO]: 	size in bytes: 687423010
2025-03-13 16:29:19,047 [INFO]: 	avg_search_speed_ms: 10.04980208267968
2025-03-13 16:29:19,048 [INFO]: 	99p_search_speed_ms: 20.310533847659823
2025-03-13 16:29:19,048 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:19,048 [INFO]: 	nb vectors: 3494
2025-03-13 16:29:19,048 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:19,048 [INFO]: 	compression ratio: 0.9993095110389162
2025-03-13 16:29:19,048 [INFO]: }
2025-03-13 16:29:19,048 [INFO]: 	>>> Finished "Creating the index" in 73.3355 secs
2025-03-13 16:29:19,048 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3614 secs
2025-03-13 16:29:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 75867 [episode count 5/20]
[retrieval_preprocessing] for episode 51807 [episode count 6/20], we have num_retrieval=np.int64(3498) num_query=np.int64(170)
2025-03-13 16:29:21,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:21,691 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:21
2025-03-13 16:29:21,691 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.05it/s]
2025-03-13 16:29:21,731 [INFO]: There are 3498 embeddings of dim 49152
2025-03-13 16:29:21,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 16:29:21,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:21
2025-03-13 16:29:21,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:21,732 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:29:21,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:21,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:29:21,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:21
2025-03-13 16:29:21,732 [INFO]: 721.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:21,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:21,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:21
2025-03-13 16:29:21,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:21,732 [INFO]: 	Creating the index 03/13/2025, 16:29:21
2025-03-13 16:29:21,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:21
2025-03-13 16:29:21,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:29:21,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:21
2025-03-13 16:29:21,734 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:29:21,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.56it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.79it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.33it/s] 50%|█████     | 7/14 [00:00<00:00, 11.06it/s] 71%|███████▏  | 10/14 [00:00<00:00, 14.24it/s] 86%|████████▌ | 12/14 [00:00<00:00, 13.39it/s]100%|██████████| 14/14 [00:04<00:00,  1.66it/s]100%|██████████| 14/14 [00:04<00:00,  3.06it/s]
2025-03-13 16:29:26,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:26
2025-03-13 16:30:08,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1808 secs
2025-03-13 16:30:08,038 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:30:08,038 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-13 16:30:28,664 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6267 secs
2025-03-13 16:30:28,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9332 secs
2025-03-13 16:30:28,667 [INFO]: {
2025-03-13 16:30:28,667 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:28,667 [INFO]: 	index_param: efSearch=157
2025-03-13 16:30:28,667 [INFO]: 	index_path: knn.index
2025-03-13 16:30:28,667 [INFO]: 	size in bytes: 688209970
2025-03-13 16:30:28,667 [INFO]: 	avg_search_speed_ms: 9.228682527155359
2025-03-13 16:30:28,668 [INFO]: 	99p_search_speed_ms: 12.75109292473644
2025-03-13 16:30:28,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:28,668 [INFO]: 	nb vectors: 3498
2025-03-13 16:30:28,668 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:28,668 [INFO]: 	compression ratio: 0.9993095333971985
2025-03-13 16:30:28,668 [INFO]: }
2025-03-13 16:30:28,668 [INFO]: 	>>> Finished "Creating the index" in 66.9353 secs
2025-03-13 16:30:28,668 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9767 secs
2025-03-13 16:30:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 51807 [episode count 6/20]
[retrieval_preprocessing] for episode 85094 [episode count 7/20], we have num_retrieval=np.int64(3520) num_query=np.int64(148)
2025-03-13 16:30:30,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:31,319 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:31
2025-03-13 16:30:31,319 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1005.83it/s]
2025-03-13 16:30:31,351 [INFO]: There are 3520 embeddings of dim 49152
2025-03-13 16:30:31,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 16:30:31,352 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:31
2025-03-13 16:30:31,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:31,352 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:30:31,353 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:31,353 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:30:31,353 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:31
2025-03-13 16:30:31,353 [INFO]: 726.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:31,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:30:31,353 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:31
2025-03-13 16:30:31,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:31,354 [INFO]: 	Creating the index 03/13/2025, 16:30:31
2025-03-13 16:30:31,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:31
2025-03-13 16:30:31,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:30:31,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:31
2025-03-13 16:30:31,357 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:30:31,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.23it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.19it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.75it/s] 50%|█████     | 7/14 [00:00<00:00, 12.01it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.61it/s] 79%|███████▊  | 11/14 [00:00<00:00, 14.77it/s] 93%|█████████▎| 13/14 [00:00<00:00, 15.52it/s]100%|██████████| 14/14 [00:03<00:00,  4.12it/s]
2025-03-13 16:30:34,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:34
2025-03-13 16:31:09,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3584 secs
2025-03-13 16:31:09,126 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:31:09,126 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 16:31:39,528 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4026 secs
2025-03-13 16:31:39,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1803 secs
2025-03-13 16:31:39,537 [INFO]: {
2025-03-13 16:31:39,537 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:39,537 [INFO]: 	index_param: efSearch=187
2025-03-13 16:31:39,537 [INFO]: 	index_path: knn.index
2025-03-13 16:31:39,537 [INFO]: 	size in bytes: 692538310
2025-03-13 16:31:39,537 [INFO]: 	avg_search_speed_ms: 11.259689256402051
2025-03-13 16:31:39,537 [INFO]: 	99p_search_speed_ms: 21.87001439742744
2025-03-13 16:31:39,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:39,537 [INFO]: 	nb vectors: 3520
2025-03-13 16:31:39,537 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:39,537 [INFO]: 	compression ratio: 0.9993095688814674
2025-03-13 16:31:39,537 [INFO]: }
2025-03-13 16:31:39,537 [INFO]: 	>>> Finished "Creating the index" in 68.1835 secs
2025-03-13 16:31:39,537 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2183 secs
2025-03-13 16:31:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 85094 [episode count 7/20]
[retrieval_preprocessing] for episode 23176 [episode count 8/20], we have num_retrieval=np.int64(3541) num_query=np.int64(127)
2025-03-13 16:31:41,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:42,514 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:42
2025-03-13 16:31:42,514 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.83it/s]
2025-03-13 16:31:42,542 [INFO]: There are 3541 embeddings of dim 49152
2025-03-13 16:31:42,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 16:31:42,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:42
2025-03-13 16:31:42,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:42,542 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:31:42,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:42,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:42,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:42
2025-03-13 16:31:42,542 [INFO]: 730.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:42,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:31:42,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:42
2025-03-13 16:31:42,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:42,543 [INFO]: 	Creating the index 03/13/2025, 16:31:42
2025-03-13 16:31:42,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:42
2025-03-13 16:31:42,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:31:42,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:42
2025-03-13 16:31:42,544 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:31:42,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.17it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.47it/s] 36%|███▌      | 5/14 [00:00<00:00, 14.74it/s] 50%|█████     | 7/14 [00:00<00:00, 15.38it/s] 64%|██████▍   | 9/14 [00:00<00:00, 15.78it/s] 79%|███████▊  | 11/14 [00:00<00:00, 15.27it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.88it/s]100%|██████████| 14/14 [00:03<00:00,  4.02it/s]
2025-03-13 16:31:46,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:46
2025-03-13 16:32:26,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3102 secs
2025-03-13 16:32:26,345 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:32:26,345 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 16:33:01,449 [INFO]: 	>>> Finished "Compute fast metrics" in 35.1030 secs
2025-03-13 16:33:01,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9078 secs
2025-03-13 16:33:01,452 [INFO]: {
2025-03-13 16:33:01,452 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:01,452 [INFO]: 	index_param: efSearch=192
2025-03-13 16:33:01,452 [INFO]: 	index_path: knn.index
2025-03-13 16:33:01,452 [INFO]: 	size in bytes: 696669910
2025-03-13 16:33:01,452 [INFO]: 	avg_search_speed_ms: 8.370303764557427
2025-03-13 16:33:01,452 [INFO]: 	99p_search_speed_ms: 14.89528999663889
2025-03-13 16:33:01,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:01,452 [INFO]: 	nb vectors: 3541
2025-03-13 16:33:01,452 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:01,452 [INFO]: 	compression ratio: 0.9993095984294772
2025-03-13 16:33:01,452 [INFO]: }
2025-03-13 16:33:01,452 [INFO]: 	>>> Finished "Creating the index" in 78.9095 secs
2025-03-13 16:33:01,452 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9380 secs
2025-03-13 16:33:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 23176 [episode count 8/20]
[retrieval_preprocessing] for episode 40618 [episode count 9/20], we have num_retrieval=np.int64(3472) num_query=np.int64(196)
2025-03-13 16:33:09,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:09,701 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:09
2025-03-13 16:33:09,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.48it/s]
2025-03-13 16:33:09,726 [INFO]: There are 3472 embeddings of dim 49152
2025-03-13 16:33:09,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:33:09,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:09
2025-03-13 16:33:09,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:09,727 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:33:09,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:09,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:33:09,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:09
2025-03-13 16:33:09,727 [INFO]: 716.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:09,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:33:09,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:09
2025-03-13 16:33:09,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:09,727 [INFO]: 	Creating the index 03/13/2025, 16:33:09
2025-03-13 16:33:09,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:09
2025-03-13 16:33:09,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:33:09,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:09
2025-03-13 16:33:09,729 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:33:09,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.40it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.68it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.46it/s] 50%|█████     | 7/14 [00:00<00:00, 10.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.30it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.47it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.61it/s]100%|██████████| 14/14 [00:03<00:00,  3.89it/s]
2025-03-13 16:33:13,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:13
2025-03-13 16:33:52,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4759 secs
2025-03-13 16:33:52,804 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:33:52,804 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 16:34:11,952 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1473 secs
2025-03-13 16:34:11,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2263 secs
2025-03-13 16:34:11,955 [INFO]: {
2025-03-13 16:34:11,955 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:11,955 [INFO]: 	index_param: efSearch=201
2025-03-13 16:34:11,955 [INFO]: 	index_path: knn.index
2025-03-13 16:34:11,955 [INFO]: 	size in bytes: 683094730
2025-03-13 16:34:11,955 [INFO]: 	avg_search_speed_ms: 11.689970842355898
2025-03-13 16:34:11,955 [INFO]: 	99p_search_speed_ms: 18.85219879914075
2025-03-13 16:34:11,955 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:11,955 [INFO]: 	nb vectors: 3472
2025-03-13 16:34:11,955 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:11,955 [INFO]: 	compression ratio: 0.999309387147519
2025-03-13 16:34:11,955 [INFO]: }
2025-03-13 16:34:11,955 [INFO]: 	>>> Finished "Creating the index" in 62.2281 secs
2025-03-13 16:34:11,955 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2543 secs
2025-03-13 16:34:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 40618 [episode count 9/20]
[retrieval_preprocessing] for episode 4797 [episode count 10/20], we have num_retrieval=np.int64(3331) num_query=np.int64(337)
2025-03-13 16:34:15,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:16,288 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:16
2025-03-13 16:34:16,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.71it/s]
2025-03-13 16:34:16,314 [INFO]: There are 3331 embeddings of dim 49152
2025-03-13 16:34:16,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:34:16,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:16
2025-03-13 16:34:16,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:16,315 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:34:16,316 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:16,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:34:16,316 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:16
2025-03-13 16:34:16,316 [INFO]: 687.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:16,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:34:16,316 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:16
2025-03-13 16:34:16,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:16,317 [INFO]: 	Creating the index 03/13/2025, 16:34:16
2025-03-13 16:34:16,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:16
2025-03-13 16:34:16,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:34:16,320 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:16
2025-03-13 16:34:16,320 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:34:16,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.93it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.75it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.01it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.68it/s] 57%|█████▋    | 8/14 [00:00<00:00, 10.28it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.27it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.37it/s]100%|██████████| 14/14 [00:04<00:00,  1.86it/s]100%|██████████| 14/14 [00:04<00:00,  3.41it/s]
2025-03-13 16:34:20,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:20
2025-03-13 16:34:58,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2553 secs
2025-03-13 16:34:58,684 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 16:34:58,684 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 16:35:18,972 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2880 secs
2025-03-13 16:35:18,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6547 secs
2025-03-13 16:35:18,975 [INFO]: {
2025-03-13 16:35:18,975 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:18,975 [INFO]: 	index_param: efSearch=217
2025-03-13 16:35:18,975 [INFO]: 	index_path: knn.index
2025-03-13 16:35:18,975 [INFO]: 	size in bytes: 655354030
2025-03-13 16:35:18,975 [INFO]: 	avg_search_speed_ms: 10.01849005121051
2025-03-13 16:35:18,975 [INFO]: 	99p_search_speed_ms: 15.621788681019092
2025-03-13 16:35:18,975 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:18,975 [INFO]: 	nb vectors: 3331
2025-03-13 16:35:18,975 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:18,975 [INFO]: 	compression ratio: 0.999309103203348
2025-03-13 16:35:18,975 [INFO]: }
2025-03-13 16:35:18,975 [INFO]: 	>>> Finished "Creating the index" in 62.6587 secs
2025-03-13 16:35:18,975 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6868 secs
2025-03-13 16:35:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 4797 [episode count 10/20]
[retrieval_preprocessing] for episode 87229 [episode count 11/20], we have num_retrieval=np.int64(3526) num_query=np.int64(142)
2025-03-13 16:35:25,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:26,273 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:26
2025-03-13 16:35:26,273 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.73it/s]
2025-03-13 16:35:26,297 [INFO]: There are 3526 embeddings of dim 49152
2025-03-13 16:35:26,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:35:26,298 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:26
2025-03-13 16:35:26,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:26,298 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:35:26,298 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:26,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:26,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:26
2025-03-13 16:35:26,298 [INFO]: 727.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:26,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:35:26,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:26
2025-03-13 16:35:26,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:26,298 [INFO]: 	Creating the index 03/13/2025, 16:35:26
2025-03-13 16:35:26,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:26
2025-03-13 16:35:26,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:35:26,300 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:26
2025-03-13 16:35:26,300 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:35:26,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.49it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.87it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.79it/s] 50%|█████     | 7/14 [00:00<00:00,  9.89it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.81it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.69it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.57it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.45it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.37it/s]100%|██████████| 14/14 [00:04<00:00,  1.07it/s]100%|██████████| 14/14 [00:04<00:00,  3.08it/s]
2025-03-13 16:35:30,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:30
2025-03-13 16:36:12,214 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3648 secs
2025-03-13 16:36:12,214 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:36:12,214 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 16:36:43,326 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1118 secs
2025-03-13 16:36:43,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.0294 secs
2025-03-13 16:36:43,329 [INFO]: {
2025-03-13 16:36:43,329 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:43,329 [INFO]: 	index_param: efSearch=193
2025-03-13 16:36:43,329 [INFO]: 	index_path: knn.index
2025-03-13 16:36:43,329 [INFO]: 	size in bytes: 693718750
2025-03-13 16:36:43,329 [INFO]: 	avg_search_speed_ms: 10.384383790537344
2025-03-13 16:36:43,329 [INFO]: 	99p_search_speed_ms: 19.319915468804535
2025-03-13 16:36:43,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:43,329 [INFO]: 	nb vectors: 3526
2025-03-13 16:36:43,329 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:43,329 [INFO]: 	compression ratio: 0.9993096020541465
2025-03-13 16:36:43,329 [INFO]: }
2025-03-13 16:36:43,329 [INFO]: 	>>> Finished "Creating the index" in 77.0311 secs
2025-03-13 16:36:43,329 [INFO]: >>> Finished "Launching the whole pipeline" in 77.0563 secs
2025-03-13 16:36:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 87229 [episode count 11/20]
[retrieval_preprocessing] for episode 85758 [episode count 12/20], we have num_retrieval=np.int64(3372) num_query=np.int64(296)
2025-03-13 16:36:45,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:46,686 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:46
2025-03-13 16:36:46,686 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 894.88it/s]
2025-03-13 16:36:46,714 [INFO]: There are 3372 embeddings of dim 49152
2025-03-13 16:36:46,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 16:36:46,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:46
2025-03-13 16:36:46,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:46,715 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:36:46,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:46,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:36:46,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:46
2025-03-13 16:36:46,715 [INFO]: 695.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:46,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:36:46,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:46
2025-03-13 16:36:46,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:46,716 [INFO]: 	Creating the index 03/13/2025, 16:36:46
2025-03-13 16:36:46,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:46
2025-03-13 16:36:46,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:36:46,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:46
2025-03-13 16:36:46,720 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:36:46,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.29it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.54it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.03it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.38it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.50it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.57it/s] 50%|█████     | 7/14 [00:00<00:00,  7.65it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.35it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.46it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.63it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.74it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.81it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.04it/s]100%|██████████| 14/14 [00:04<00:00,  1.10it/s]100%|██████████| 14/14 [00:04<00:00,  3.15it/s]
2025-03-13 16:36:51,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:51
2025-03-13 16:37:28,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1535 secs
2025-03-13 16:37:28,328 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 16:37:28,328 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 16:38:10,382 [INFO]: 	>>> Finished "Compute fast metrics" in 42.0533 secs
2025-03-13 16:38:10,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6652 secs
2025-03-13 16:38:10,385 [INFO]: {
2025-03-13 16:38:10,385 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:10,385 [INFO]: 	index_param: efSearch=188
2025-03-13 16:38:10,385 [INFO]: 	index_path: knn.index
2025-03-13 16:38:10,385 [INFO]: 	size in bytes: 663420370
2025-03-13 16:38:10,385 [INFO]: 	avg_search_speed_ms: 10.599814891821104
2025-03-13 16:38:10,385 [INFO]: 	99p_search_speed_ms: 18.03926819935441
2025-03-13 16:38:10,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:10,385 [INFO]: 	nb vectors: 3372
2025-03-13 16:38:10,385 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:10,385 [INFO]: 	compression ratio: 0.9993093458978355
2025-03-13 16:38:10,385 [INFO]: }
2025-03-13 16:38:10,385 [INFO]: 	>>> Finished "Creating the index" in 83.6692 secs
2025-03-13 16:38:10,386 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6995 secs
2025-03-13 16:38:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 85758 [episode count 12/20]
[retrieval_preprocessing] for episode 25859 [episode count 13/20], we have num_retrieval=np.int64(3481) num_query=np.int64(187)
2025-03-13 16:38:14,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:14,916 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:14
2025-03-13 16:38:14,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.81it/s]
2025-03-13 16:38:14,942 [INFO]: There are 3481 embeddings of dim 49152
2025-03-13 16:38:14,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:38:14,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:14
2025-03-13 16:38:14,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:14,942 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:38:14,942 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:14,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:14,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:14
2025-03-13 16:38:14,942 [INFO]: 718.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:14,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:38:14,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:14
2025-03-13 16:38:14,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:14,943 [INFO]: 	Creating the index 03/13/2025, 16:38:14
2025-03-13 16:38:14,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:14
2025-03-13 16:38:14,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:14,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:14
2025-03-13 16:38:14,944 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:38:14,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.95it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.89it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.49it/s] 50%|█████     | 7/14 [00:00<00:00, 11.03it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.13it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.77it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.31it/s]100%|██████████| 14/14 [00:03<00:00,  1.77it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-13 16:38:18,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:18
2025-03-13 16:38:56,447 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6427 secs
2025-03-13 16:38:56,448 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:38:56,448 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 16:39:16,483 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0349 secs
2025-03-13 16:39:16,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5424 secs
2025-03-13 16:39:16,486 [INFO]: {
2025-03-13 16:39:16,486 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:16,486 [INFO]: 	index_param: efSearch=172
2025-03-13 16:39:16,486 [INFO]: 	index_path: knn.index
2025-03-13 16:39:16,486 [INFO]: 	size in bytes: 684865390
2025-03-13 16:39:16,487 [INFO]: 	avg_search_speed_ms: 9.536866433128317
2025-03-13 16:39:16,487 [INFO]: 	99p_search_speed_ms: 15.484094237908716
2025-03-13 16:39:16,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:16,487 [INFO]: 	nb vectors: 3481
2025-03-13 16:39:16,487 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:16,487 [INFO]: 	compression ratio: 0.9993094380196377
2025-03-13 16:39:16,487 [INFO]: }
2025-03-13 16:39:16,487 [INFO]: 	>>> Finished "Creating the index" in 61.5441 secs
2025-03-13 16:39:16,487 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5708 secs
2025-03-13 16:39:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 25859 [episode count 13/20]
[retrieval_preprocessing] for episode 75011 [episode count 14/20], we have num_retrieval=np.int64(3470) num_query=np.int64(198)
2025-03-13 16:39:19,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:19,981 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:19
2025-03-13 16:39:19,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.54it/s]
2025-03-13 16:39:20,009 [INFO]: There are 3470 embeddings of dim 49152
2025-03-13 16:39:20,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:39:20,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:20
2025-03-13 16:39:20,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:20,010 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:39:20,010 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:20,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:39:20,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:20
2025-03-13 16:39:20,011 [INFO]: 716.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:20,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:39:20,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:20
2025-03-13 16:39:20,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:20,012 [INFO]: 	Creating the index 03/13/2025, 16:39:20
2025-03-13 16:39:20,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:20
2025-03-13 16:39:20,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:39:20,015 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:20
2025-03-13 16:39:20,015 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:39:20,015 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.07it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.30it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.99it/s] 50%|█████     | 7/14 [00:00<00:00, 10.15it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.16it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.96it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.84it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.77it/s]100%|██████████| 14/14 [00:03<00:00,  1.39it/s]100%|██████████| 14/14 [00:03<00:00,  3.50it/s]
2025-03-13 16:39:24,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:24
2025-03-13 16:39:58,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7968 secs
2025-03-13 16:39:58,813 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 16:39:58,813 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 16:40:42,392 [INFO]: 	>>> Finished "Compute fast metrics" in 43.5789 secs
2025-03-13 16:40:42,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3800 secs
2025-03-13 16:40:42,396 [INFO]: {
2025-03-13 16:40:42,396 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:42,396 [INFO]: 	index_param: efSearch=223
2025-03-13 16:40:42,396 [INFO]: 	index_path: knn.index
2025-03-13 16:40:42,396 [INFO]: 	size in bytes: 682701190
2025-03-13 16:40:42,396 [INFO]: 	avg_search_speed_ms: 10.149925899204945
2025-03-13 16:40:42,396 [INFO]: 	99p_search_speed_ms: 14.671653918921944
2025-03-13 16:40:42,396 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:42,396 [INFO]: 	nb vectors: 3470
2025-03-13 16:40:42,396 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:42,396 [INFO]: 	compression ratio: 0.9993094636322518
2025-03-13 16:40:42,396 [INFO]: }
2025-03-13 16:40:42,396 [INFO]: 	>>> Finished "Creating the index" in 82.3840 secs
2025-03-13 16:40:42,396 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4146 secs
2025-03-13 16:40:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 75011 [episode count 14/20]
[retrieval_preprocessing] for episode 87862 [episode count 15/20], we have num_retrieval=np.int64(3532) num_query=np.int64(136)
2025-03-13 16:40:45,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:46,739 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:46
2025-03-13 16:40:46,739 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-13 16:40:46,767 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 16:40:46,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:40:46,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:46
2025-03-13 16:40:46,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:46,767 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:40:46,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:46,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:40:46,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:46
2025-03-13 16:40:46,767 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:46,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:40:46,767 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:46
2025-03-13 16:40:46,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:46,767 [INFO]: 	Creating the index 03/13/2025, 16:40:46
2025-03-13 16:40:46,768 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:46
2025-03-13 16:40:46,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:40:46,769 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:46
2025-03-13 16:40:46,769 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:40:46,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.41it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.09it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.06it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.42it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.21it/s] 50%|█████     | 7/14 [00:00<00:00,  9.27it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.69it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.68it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.67it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.54it/s]100%|██████████| 14/14 [00:04<00:00,  1.45it/s]100%|██████████| 14/14 [00:04<00:00,  3.30it/s]
2025-03-13 16:40:51,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:51
2025-03-13 16:41:35,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5996 secs
2025-03-13 16:41:35,625 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 16:41:35,625 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.56it/s] 50%|█████     | 2/4 [00:00<00:00,  5.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.31it/s]
2025-03-13 16:42:02,284 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6588 secs
2025-03-13 16:42:02,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5183 secs
2025-03-13 16:42:02,287 [INFO]: {
2025-03-13 16:42:02,287 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:02,287 [INFO]: 	index_param: efSearch=155
2025-03-13 16:42:02,287 [INFO]: 	index_path: knn.index
2025-03-13 16:42:02,287 [INFO]: 	size in bytes: 694899250
2025-03-13 16:42:02,287 [INFO]: 	avg_search_speed_ms: 8.75529206187453
2025-03-13 16:42:02,287 [INFO]: 	99p_search_speed_ms: 14.498844353947778
2025-03-13 16:42:02,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:02,287 [INFO]: 	nb vectors: 3532
2025-03-13 16:42:02,287 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:02,287 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 16:42:02,287 [INFO]: }
2025-03-13 16:42:02,287 [INFO]: 	>>> Finished "Creating the index" in 75.5200 secs
2025-03-13 16:42:02,288 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5481 secs
2025-03-13 16:42:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 87862 [episode count 15/20]
[retrieval_preprocessing] for episode 44855 [episode count 16/20], we have num_retrieval=np.int64(3512) num_query=np.int64(156)
2025-03-13 16:42:04,700 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:05,207 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:05
2025-03-13 16:42:05,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1982.19it/s]
2025-03-13 16:42:05,231 [INFO]: There are 3512 embeddings of dim 49152
2025-03-13 16:42:05,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 16:42:05,231 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:05
2025-03-13 16:42:05,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:05,231 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:42:05,231 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:05,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:42:05,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:05
2025-03-13 16:42:05,231 [INFO]: 724.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:05,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:42:05,231 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:05
2025-03-13 16:42:05,231 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:05,231 [INFO]: 	Creating the index 03/13/2025, 16:42:05
2025-03-13 16:42:05,231 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:05
2025-03-13 16:42:05,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:42:05,232 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:05
2025-03-13 16:42:05,232 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:42:05,232 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.66it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.62it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.35it/s] 50%|█████     | 7/14 [00:00<00:00, 10.68it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.96it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.05it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.09it/s]100%|██████████| 14/14 [00:04<00:00,  3.38it/s]
2025-03-13 16:42:09,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:09
2025-03-13 16:42:47,931 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5460 secs
2025-03-13 16:42:47,931 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:42:47,931 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.57it/s] 50%|█████     | 2/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 16:43:28,681 [INFO]: 	>>> Finished "Compute fast metrics" in 40.7501 secs
2025-03-13 16:43:28,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.4528 secs
2025-03-13 16:43:28,685 [INFO]: {
2025-03-13 16:43:28,685 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:28,685 [INFO]: 	index_param: efSearch=218
2025-03-13 16:43:28,685 [INFO]: 	index_path: knn.index
2025-03-13 16:43:28,685 [INFO]: 	size in bytes: 690964390
2025-03-13 16:43:28,685 [INFO]: 	avg_search_speed_ms: 10.041268835083608
2025-03-13 16:43:28,685 [INFO]: 	99p_search_speed_ms: 12.99512977711856
2025-03-13 16:43:28,685 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:28,685 [INFO]: 	nb vectors: 3512
2025-03-13 16:43:28,685 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:28,685 [INFO]: 	compression ratio: 0.9993095244749154
2025-03-13 16:43:28,685 [INFO]: }
2025-03-13 16:43:28,685 [INFO]: 	>>> Finished "Creating the index" in 83.4541 secs
2025-03-13 16:43:28,686 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4780 secs
2025-03-13 16:43:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 44855 [episode count 16/20]
[retrieval_preprocessing] for episode 92990 [episode count 17/20], we have num_retrieval=np.int64(3481) num_query=np.int64(187)
2025-03-13 16:43:31,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:32,989 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:32
2025-03-13 16:43:32,989 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.87it/s]
2025-03-13 16:43:33,014 [INFO]: There are 3481 embeddings of dim 49152
2025-03-13 16:43:33,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 16:43:33,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:33
2025-03-13 16:43:33,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:33,014 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:43:33,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:33,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:33,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:33
2025-03-13 16:43:33,014 [INFO]: 718.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:33,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:43:33,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:33
2025-03-13 16:43:33,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:33,015 [INFO]: 	Creating the index 03/13/2025, 16:43:33
2025-03-13 16:43:33,015 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:33
2025-03-13 16:43:33,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:33,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:33
2025-03-13 16:43:33,016 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:43:33,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.11it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.36it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.36it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.51it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.66it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.56it/s] 50%|█████     | 7/14 [00:00<00:00,  7.52it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.49it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.61it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.59it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.66it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.36it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.64it/s]100%|██████████| 14/14 [00:05<00:00,  1.09s/it]100%|██████████| 14/14 [00:05<00:00,  2.76it/s]
2025-03-13 16:43:38,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:38
2025-03-13 16:44:26,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1531 secs
2025-03-13 16:44:26,252 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:44:26,252 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.08it/s] 50%|█████     | 2/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 16:44:45,372 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1193 secs
2025-03-13 16:44:45,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3598 secs
2025-03-13 16:44:45,376 [INFO]: {
2025-03-13 16:44:45,376 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:45,376 [INFO]: 	index_param: efSearch=157
2025-03-13 16:44:45,376 [INFO]: 	index_path: knn.index
2025-03-13 16:44:45,376 [INFO]: 	size in bytes: 684865390
2025-03-13 16:44:45,376 [INFO]: 	avg_search_speed_ms: 9.970474391637122
2025-03-13 16:44:45,376 [INFO]: 	99p_search_speed_ms: 16.55228438787163
2025-03-13 16:44:45,376 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:45,376 [INFO]: 	nb vectors: 3481
2025-03-13 16:44:45,376 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:45,376 [INFO]: 	compression ratio: 0.9993094380196377
2025-03-13 16:44:45,376 [INFO]: }
2025-03-13 16:44:45,376 [INFO]: 	>>> Finished "Creating the index" in 72.3614 secs
2025-03-13 16:44:45,376 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3868 secs
2025-03-13 16:44:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 92990 [episode count 17/20]
[retrieval_preprocessing] for episode 12101 [episode count 18/20], we have num_retrieval=np.int64(3530) num_query=np.int64(138)
2025-03-13 16:44:48,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:49,671 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:49
2025-03-13 16:44:49,671 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.33it/s]
2025-03-13 16:44:49,697 [INFO]: There are 3530 embeddings of dim 49152
2025-03-13 16:44:49,697 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:44:49,697 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:49
2025-03-13 16:44:49,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:49,697 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:44:49,697 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:49,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:44:49,697 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:49
2025-03-13 16:44:49,697 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:49,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:44:49,698 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:49
2025-03-13 16:44:49,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:49,698 [INFO]: 	Creating the index 03/13/2025, 16:44:49
2025-03-13 16:44:49,698 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:49
2025-03-13 16:44:49,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:44:49,699 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:49
2025-03-13 16:44:49,699 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:44:49,699 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.80it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.31it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.03it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.45it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.88it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.26it/s] 50%|█████     | 7/14 [00:00<00:00,  8.42it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.64it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.25it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.53it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.52it/s]100%|██████████| 14/14 [00:04<00:00,  1.24it/s]100%|██████████| 14/14 [00:04<00:00,  3.10it/s]
2025-03-13 16:44:54,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:54
2025-03-13 16:45:30,607 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3823 secs
2025-03-13 16:45:30,608 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:45:30,608 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 16:46:01,185 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5774 secs
2025-03-13 16:46:01,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4901 secs
2025-03-13 16:46:01,189 [INFO]: {
2025-03-13 16:46:01,189 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:01,189 [INFO]: 	index_param: efSearch=218
2025-03-13 16:46:01,189 [INFO]: 	index_path: knn.index
2025-03-13 16:46:01,189 [INFO]: 	size in bytes: 694505770
2025-03-13 16:46:01,189 [INFO]: 	avg_search_speed_ms: 10.734254878030315
2025-03-13 16:46:01,189 [INFO]: 	99p_search_speed_ms: 15.895968724507826
2025-03-13 16:46:01,189 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:01,189 [INFO]: 	nb vectors: 3530
2025-03-13 16:46:01,189 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:01,189 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-13 16:46:01,189 [INFO]: }
2025-03-13 16:46:01,189 [INFO]: 	>>> Finished "Creating the index" in 71.4918 secs
2025-03-13 16:46:01,189 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5183 secs
2025-03-13 16:46:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 12101 [episode count 18/20]
[retrieval_preprocessing] for episode 15208 [episode count 19/20], we have num_retrieval=np.int64(3373) num_query=np.int64(295)
2025-03-13 16:46:04,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:05,196 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:05
2025-03-13 16:46:05,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2110.87it/s]
2025-03-13 16:46:05,220 [INFO]: There are 3373 embeddings of dim 49152
2025-03-13 16:46:05,220 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 16:46:05,220 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:05
2025-03-13 16:46:05,220 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:05,220 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 16:46:05,220 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:05,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:05,220 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:05
2025-03-13 16:46:05,220 [INFO]: 696.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:05,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:46:05,221 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:05
2025-03-13 16:46:05,221 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:05,221 [INFO]: 	Creating the index 03/13/2025, 16:46:05
2025-03-13 16:46:05,221 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:05
2025-03-13 16:46:05,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:46:05,222 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:05
2025-03-13 16:46:05,222 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:46:05,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.56it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.51it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.75it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.01it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.22it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.59it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.66it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.69it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.73it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.75it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.81it/s]100%|██████████| 14/14 [00:03<00:00,  1.35it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-13 16:46:08,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:08
2025-03-13 16:46:52,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1537 secs
2025-03-13 16:46:52,074 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:46:52,074 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 16:47:18,937 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8636 secs
2025-03-13 16:47:18,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7192 secs
2025-03-13 16:47:18,941 [INFO]: {
2025-03-13 16:47:18,941 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:18,941 [INFO]: 	index_param: efSearch=193
2025-03-13 16:47:18,941 [INFO]: 	index_path: knn.index
2025-03-13 16:47:18,941 [INFO]: 	size in bytes: 663617110
2025-03-13 16:47:18,941 [INFO]: 	avg_search_speed_ms: 11.108983809697545
2025-03-13 16:47:18,941 [INFO]: 	99p_search_speed_ms: 16.663793176412582
2025-03-13 16:47:18,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:18,941 [INFO]: 	nb vectors: 3373
2025-03-13 16:47:18,941 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:18,941 [INFO]: 	compression ratio: 0.9993093517435077
2025-03-13 16:47:18,941 [INFO]: }
2025-03-13 16:47:18,941 [INFO]: 	>>> Finished "Creating the index" in 73.7207 secs
2025-03-13 16:47:18,941 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7449 secs
2025-03-13 16:47:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 15208 [episode count 19/20]
2025-03-13 16:47:21: [retrieval_preprocessing] finished for 4130977918_close_kettle [chosen_id count 3/196]
2025-03-13 16:47:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4130977918_open_kettle [chosen_id count 4/196]
2025-03-13 16:47:24: [retrieval_preprocessing] we have num_total=4152 embedding_dim=49152
[retrieval_preprocessing] for episode 8196 [episode count 0/20], we have num_retrieval=np.int64(3866) num_query=np.int64(286)
2025-03-13 16:47:26,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:27,208 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:27
2025-03-13 16:47:27,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1355.63it/s]
2025-03-13 16:47:27,486 [INFO]: There are 3866 embeddings of dim 49152
2025-03-13 16:47:27,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2788 secs
2025-03-13 16:47:27,487 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:27
2025-03-13 16:47:27,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:27,488 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:47:27,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:27,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:47:27,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:27
2025-03-13 16:47:27,488 [INFO]: 797.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:27,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:47:27,488 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:27
2025-03-13 16:47:27,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:27,488 [INFO]: 	Creating the index 03/13/2025, 16:47:27
2025-03-13 16:47:27,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:27
2025-03-13 16:47:27,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:47:27,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:27
2025-03-13 16:47:27,491 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:47:27,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.25it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.79it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.62it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.82it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.08it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.24it/s] 50%|█████     | 8/16 [00:01<00:01,  7.37it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.53it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.78it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.94it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.04it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.13it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.29it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.26it/s]100%|██████████| 16/16 [00:04<00:00,  1.13it/s]100%|██████████| 16/16 [00:04<00:00,  3.44it/s]
2025-03-13 16:47:32,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:32
2025-03-13 16:48:10,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6302 secs
2025-03-13 16:48:10,774 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 16:48:10,774 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-13 16:48:37,333 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5592 secs
2025-03-13 16:48:37,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8459 secs
2025-03-13 16:48:37,337 [INFO]: {
2025-03-13 16:48:37,337 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:37,337 [INFO]: 	index_param: efSearch=250
2025-03-13 16:48:37,337 [INFO]: 	index_path: knn.index
2025-03-13 16:48:37,337 [INFO]: 	size in bytes: 760612210
2025-03-13 16:48:37,337 [INFO]: 	avg_search_speed_ms: 11.781961132209524
2025-03-13 16:48:37,337 [INFO]: 	99p_search_speed_ms: 23.293642522767176
2025-03-13 16:48:37,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:37,337 [INFO]: 	nb vectors: 3866
2025-03-13 16:48:37,337 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:37,337 [INFO]: 	compression ratio: 0.9993088698904794
2025-03-13 16:48:37,337 [INFO]: }
2025-03-13 16:48:37,338 [INFO]: 	>>> Finished "Creating the index" in 69.8490 secs
2025-03-13 16:48:37,338 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1295 secs
2025-03-13 16:48:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 8196 [episode count 0/20]
[retrieval_preprocessing] for episode 52809 [episode count 1/20], we have num_retrieval=np.int64(3877) num_query=np.int64(275)
2025-03-13 16:48:42,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:43,718 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:43
2025-03-13 16:48:43,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.88it/s]
2025-03-13 16:48:43,744 [INFO]: There are 3877 embeddings of dim 49152
2025-03-13 16:48:43,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:48:43,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:43
2025-03-13 16:48:43,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:43,744 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:48:43,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:43,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:43,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:43
2025-03-13 16:48:43,744 [INFO]: 800.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:43,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:43,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:43
2025-03-13 16:48:43,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:43,744 [INFO]: 	Creating the index 03/13/2025, 16:48:43
2025-03-13 16:48:43,744 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:43
2025-03-13 16:48:43,745 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:48:43,745 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:43
2025-03-13 16:48:43,745 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:48:43,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.03it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.12it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.42it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.14it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.48it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.61it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.60it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.35it/s]100%|██████████| 16/16 [00:04<00:00,  3.31it/s]
2025-03-13 16:48:48,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:48
2025-03-13 16:49:29,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0530 secs
2025-03-13 16:49:29,639 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 16:49:29,639 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.28it/s] 50%|█████     | 2/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 16:50:16,072 [INFO]: 	>>> Finished "Compute fast metrics" in 46.4328 secs
2025-03-13 16:50:16,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.3295 secs
2025-03-13 16:50:16,075 [INFO]: {
2025-03-13 16:50:16,075 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:16,075 [INFO]: 	index_param: efSearch=204
2025-03-13 16:50:16,075 [INFO]: 	index_path: knn.index
2025-03-13 16:50:16,075 [INFO]: 	size in bytes: 762776350
2025-03-13 16:50:16,075 [INFO]: 	avg_search_speed_ms: 7.483780749865757
2025-03-13 16:50:16,075 [INFO]: 	99p_search_speed_ms: 14.797891292255375
2025-03-13 16:50:16,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:16,075 [INFO]: 	nb vectors: 3877
2025-03-13 16:50:16,075 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:16,075 [INFO]: 	compression ratio: 0.9993089271842264
2025-03-13 16:50:16,075 [INFO]: }
2025-03-13 16:50:16,075 [INFO]: 	>>> Finished "Creating the index" in 92.3308 secs
2025-03-13 16:50:16,075 [INFO]: >>> Finished "Launching the whole pipeline" in 92.3575 secs
2025-03-13 16:50:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 52809 [episode count 1/20]
[retrieval_preprocessing] for episode 49284 [episode count 2/20], we have num_retrieval=np.int64(3991) num_query=np.int64(161)
2025-03-13 16:50:19,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:19,746 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:19
2025-03-13 16:50:19,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-13 16:50:19,771 [INFO]: There are 3991 embeddings of dim 49152
2025-03-13 16:50:19,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:50:19,772 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:19
2025-03-13 16:50:19,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:19,772 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:50:19,772 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:19,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:19,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:19
2025-03-13 16:50:19,772 [INFO]: 823.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:19,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:50:19,772 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:19
2025-03-13 16:50:19,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:19,773 [INFO]: 	Creating the index 03/13/2025, 16:50:19
2025-03-13 16:50:19,773 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:19
2025-03-13 16:50:19,774 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:50:19,774 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:19
2025-03-13 16:50:19,774 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:50:19,774 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.36it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.89it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.35it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.54it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.92it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.07it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.21it/s]100%|██████████| 16/16 [00:03<00:00,  4.10it/s]
2025-03-13 16:50:24,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:24
2025-03-13 16:50:57,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0609 secs
2025-03-13 16:50:57,494 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 16:50:57,494 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.21it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 16:51:30,068 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5737 secs
2025-03-13 16:51:30,752 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9782 secs
2025-03-13 16:51:30,752 [INFO]: {
2025-03-13 16:51:30,752 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:30,753 [INFO]: 	index_param: efSearch=199
2025-03-13 16:51:30,753 [INFO]: 	index_path: knn.index
2025-03-13 16:51:30,753 [INFO]: 	size in bytes: 785205430
2025-03-13 16:51:30,753 [INFO]: 	avg_search_speed_ms: 9.431358372335726
2025-03-13 16:51:30,753 [INFO]: 	99p_search_speed_ms: 15.08433872833848
2025-03-13 16:51:30,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:30,753 [INFO]: 	nb vectors: 3991
2025-03-13 16:51:30,753 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:30,753 [INFO]: 	compression ratio: 0.9993085860346126
2025-03-13 16:51:30,753 [INFO]: }
2025-03-13 16:51:30,753 [INFO]: 	>>> Finished "Creating the index" in 70.9805 secs
2025-03-13 16:51:30,753 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0071 secs
2025-03-13 16:51:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 49284 [episode count 2/20]
[retrieval_preprocessing] for episode 3215 [episode count 3/20], we have num_retrieval=np.int64(3884) num_query=np.int64(268)
2025-03-13 16:51:34,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:35,247 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:35
2025-03-13 16:51:35,247 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2225.09it/s]
2025-03-13 16:51:35,272 [INFO]: There are 3884 embeddings of dim 49152
2025-03-13 16:51:35,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 16:51:35,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:35
2025-03-13 16:51:35,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:35,272 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:51:35,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:35,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:51:35,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:35
2025-03-13 16:51:35,273 [INFO]: 801.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:35,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:35,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:35
2025-03-13 16:51:35,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:35,273 [INFO]: 	Creating the index 03/13/2025, 16:51:35
2025-03-13 16:51:35,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:35
2025-03-13 16:51:35,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:51:35,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:35
2025-03-13 16:51:35,275 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:51:35,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.38it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.78it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.28it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.53it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.72it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.24it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.04it/s] 50%|█████     | 8/16 [00:01<00:01,  7.86it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.71it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.57it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.72it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.73it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.75it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.77it/s] 94%|█████████▍| 15/16 [00:01<00:00,  7.80it/s]100%|██████████| 16/16 [00:04<00:00,  1.00it/s]100%|██████████| 16/16 [00:04<00:00,  3.21it/s]
2025-03-13 16:51:40,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:40
2025-03-13 16:52:16,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5900 secs
2025-03-13 16:52:16,847 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:52:16,847 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 16:52:45,214 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3672 secs
2025-03-13 16:52:45,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9424 secs
2025-03-13 16:52:45,217 [INFO]: {
2025-03-13 16:52:45,217 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:45,218 [INFO]: 	index_param: efSearch=220
2025-03-13 16:52:45,218 [INFO]: 	index_path: knn.index
2025-03-13 16:52:45,218 [INFO]: 	size in bytes: 764153650
2025-03-13 16:52:45,218 [INFO]: 	avg_search_speed_ms: 9.808558648379117
2025-03-13 16:52:45,218 [INFO]: 	99p_search_speed_ms: 17.533916926477097
2025-03-13 16:52:45,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:45,218 [INFO]: 	nb vectors: 3884
2025-03-13 16:52:45,218 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:45,218 [INFO]: 	compression ratio: 0.9993088065469555
2025-03-13 16:52:45,218 [INFO]: }
2025-03-13 16:52:45,218 [INFO]: 	>>> Finished "Creating the index" in 69.9448 secs
2025-03-13 16:52:45,218 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9704 secs
2025-03-13 16:52:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 3215 [episode count 3/20]
[retrieval_preprocessing] for episode 51859 [episode count 4/20], we have num_retrieval=np.int64(3991) num_query=np.int64(161)
2025-03-13 16:52:49,435 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:50,119 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:50
2025-03-13 16:52:50,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-13 16:52:50,146 [INFO]: There are 3991 embeddings of dim 49152
2025-03-13 16:52:50,146 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:52:50,146 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,146 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:50,146 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:52:50,146 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:50,146 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:52:50,146 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,146 [INFO]: 823.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:50,146 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:52:50,146 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:50
2025-03-13 16:52:50,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:50,147 [INFO]: 	Creating the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,147 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:50
2025-03-13 16:52:50,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:52:50,148 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,148 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:52:50,148 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.52it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.56it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.10it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.78it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.76it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.63it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.36it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.59it/s]100%|██████████| 16/16 [00:04<00:00,  4.00it/s]
2025-03-13 16:52:54,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:54
2025-03-13 16:53:28,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3009 secs
2025-03-13 16:53:28,459 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:53:28,459 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 16:54:03,618 [INFO]: 	>>> Finished "Compute fast metrics" in 35.1589 secs
2025-03-13 16:54:03,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4731 secs
2025-03-13 16:54:03,621 [INFO]: {
2025-03-13 16:54:03,621 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:03,621 [INFO]: 	index_param: efSearch=220
2025-03-13 16:54:03,621 [INFO]: 	index_path: knn.index
2025-03-13 16:54:03,621 [INFO]: 	size in bytes: 785205430
2025-03-13 16:54:03,621 [INFO]: 	avg_search_speed_ms: 9.04788926172142
2025-03-13 16:54:03,621 [INFO]: 	99p_search_speed_ms: 14.82687399722636
2025-03-13 16:54:03,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:03,621 [INFO]: 	nb vectors: 3991
2025-03-13 16:54:03,621 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:03,621 [INFO]: 	compression ratio: 0.9993085860346126
2025-03-13 16:54:03,621 [INFO]: }
2025-03-13 16:54:03,621 [INFO]: 	>>> Finished "Creating the index" in 73.4748 secs
2025-03-13 16:54:03,621 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5023 secs
2025-03-13 16:54:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 51859 [episode count 4/20]
[retrieval_preprocessing] for episode 68764 [episode count 5/20], we have num_retrieval=np.int64(3854) num_query=np.int64(298)
2025-03-13 16:54:07,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:08,559 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:08
2025-03-13 16:54:08,559 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.94it/s]
2025-03-13 16:54:08,588 [INFO]: There are 3854 embeddings of dim 49152
2025-03-13 16:54:08,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:54:08,588 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:08
2025-03-13 16:54:08,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:08,589 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:54:08,589 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:08,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:54:08,589 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:08
2025-03-13 16:54:08,590 [INFO]: 795.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:08,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:54:08,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:08
2025-03-13 16:54:08,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:08,591 [INFO]: 	Creating the index 03/13/2025, 16:54:08
2025-03-13 16:54:08,591 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:08
2025-03-13 16:54:08,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:54:08,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:08
2025-03-13 16:54:08,595 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:54:08,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.02it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.52it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.19it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.92it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.75it/s] 50%|█████     | 8/16 [00:01<00:00,  8.76it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.45it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.82it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.97it/s]100%|██████████| 16/16 [00:04<00:00,  1.82it/s]100%|██████████| 16/16 [00:04<00:00,  3.50it/s]
2025-03-13 16:54:13,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:13
2025-03-13 16:54:53,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1811 secs
2025-03-13 16:54:53,359 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:54:53,360 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 16:55:13,034 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6739 secs
2025-03-13 16:55:13,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4426 secs
2025-03-13 16:55:13,037 [INFO]: {
2025-03-13 16:55:13,037 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:13,037 [INFO]: 	index_param: efSearch=207
2025-03-13 16:55:13,037 [INFO]: 	index_path: knn.index
2025-03-13 16:55:13,037 [INFO]: 	size in bytes: 758251210
2025-03-13 16:55:13,037 [INFO]: 	avg_search_speed_ms: 9.205462408689876
2025-03-13 16:55:13,037 [INFO]: 	99p_search_speed_ms: 13.679117616266025
2025-03-13 16:55:13,037 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:13,037 [INFO]: 	nb vectors: 3854
2025-03-13 16:55:13,037 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:13,038 [INFO]: 	compression ratio: 0.9993089651647242
2025-03-13 16:55:13,038 [INFO]: }
2025-03-13 16:55:13,038 [INFO]: 	>>> Finished "Creating the index" in 64.4469 secs
2025-03-13 16:55:13,038 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4783 secs
2025-03-13 16:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 68764 [episode count 5/20]
[retrieval_preprocessing] for episode 1198 [episode count 6/20], we have num_retrieval=np.int64(3958) num_query=np.int64(194)
2025-03-13 16:55:16,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:17,605 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:17
2025-03-13 16:55:17,605 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1325.21it/s]
2025-03-13 16:55:17,629 [INFO]: There are 3958 embeddings of dim 49152
2025-03-13 16:55:17,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 16:55:17,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:17
2025-03-13 16:55:17,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:17,629 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:55:17,629 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:17,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:17,629 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:17
2025-03-13 16:55:17,629 [INFO]: 816.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:17,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:55:17,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:17
2025-03-13 16:55:17,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:17,629 [INFO]: 	Creating the index 03/13/2025, 16:55:17
2025-03-13 16:55:17,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:17
2025-03-13 16:55:17,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:55:17,631 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:17
2025-03-13 16:55:17,631 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:55:17,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.51it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.31it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.40it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.70it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.72it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.71it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.84it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.78it/s]100%|██████████| 16/16 [00:03<00:00,  4.04it/s]
2025-03-13 16:55:21,962 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:21
2025-03-13 16:55:56,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1286 secs
2025-03-13 16:55:56,092 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 16:55:56,092 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 16:56:53,952 [INFO]: 	>>> Finished "Compute fast metrics" in 57.8607 secs
2025-03-13 16:56:53,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.3252 secs
2025-03-13 16:56:53,956 [INFO]: {
2025-03-13 16:56:53,956 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:53,956 [INFO]: 	index_param: efSearch=288
2025-03-13 16:56:53,956 [INFO]: 	index_path: knn.index
2025-03-13 16:56:53,956 [INFO]: 	size in bytes: 778712950
2025-03-13 16:56:53,956 [INFO]: 	avg_search_speed_ms: 9.721523347881824
2025-03-13 16:56:53,956 [INFO]: 	99p_search_speed_ms: 16.272881356999292
2025-03-13 16:56:53,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:53,956 [INFO]: 	nb vectors: 3958
2025-03-13 16:56:53,956 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:53,956 [INFO]: 	compression ratio: 0.999308492301303
2025-03-13 16:56:53,956 [INFO]: }
2025-03-13 16:56:53,956 [INFO]: 	>>> Finished "Creating the index" in 96.3269 secs
2025-03-13 16:56:53,956 [INFO]: >>> Finished "Launching the whole pipeline" in 96.3515 secs
2025-03-13 16:56:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 1198 [episode count 6/20]
[retrieval_preprocessing] for episode 17135 [episode count 7/20], we have num_retrieval=np.int64(3982) num_query=np.int64(170)
2025-03-13 16:56:57,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:57,982 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:57
2025-03-13 16:56:57,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.98it/s]
2025-03-13 16:56:58,011 [INFO]: There are 3982 embeddings of dim 49152
2025-03-13 16:56:58,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 16:56:58,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:58
2025-03-13 16:56:58,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:58,012 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:56:58,013 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:58,013 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:56:58,013 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:58
2025-03-13 16:56:58,013 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:58,013 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:56:58,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:58
2025-03-13 16:56:58,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:58,014 [INFO]: 	Creating the index 03/13/2025, 16:56:58
2025-03-13 16:56:58,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:58
2025-03-13 16:56:58,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:56:58,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:58
2025-03-13 16:56:58,018 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:56:58,018 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.32it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.34it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.34it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.13it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.74it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.00it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.16it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.37it/s]100%|██████████| 16/16 [00:04<00:00,  3.91it/s]
2025-03-13 16:57:02,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:02
2025-03-13 16:57:40,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7542 secs
2025-03-13 16:57:40,473 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 16:57:40,473 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 16:58:02,423 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9500 secs
2025-03-13 16:58:02,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4084 secs
2025-03-13 16:58:02,426 [INFO]: {
2025-03-13 16:58:02,426 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:02,426 [INFO]: 	index_param: efSearch=171
2025-03-13 16:58:02,426 [INFO]: 	index_path: knn.index
2025-03-13 16:58:02,426 [INFO]: 	size in bytes: 783434770
2025-03-13 16:58:02,426 [INFO]: 	avg_search_speed_ms: 8.272473342143572
2025-03-13 16:58:02,426 [INFO]: 	99p_search_speed_ms: 13.25600448064506
2025-03-13 16:58:02,426 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:02,426 [INFO]: 	nb vectors: 3982
2025-03-13 16:58:02,426 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:02,426 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-13 16:58:02,426 [INFO]: }
2025-03-13 16:58:02,426 [INFO]: 	>>> Finished "Creating the index" in 64.4122 secs
2025-03-13 16:58:02,426 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4443 secs
2025-03-13 16:58:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 17135 [episode count 7/20]
[retrieval_preprocessing] for episode 59596 [episode count 8/20], we have num_retrieval=np.int64(3969) num_query=np.int64(183)
2025-03-13 16:58:05,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:06,243 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:06
2025-03-13 16:58:06,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.85it/s]
2025-03-13 16:58:06,268 [INFO]: There are 3969 embeddings of dim 49152
2025-03-13 16:58:06,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 16:58:06,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:06
2025-03-13 16:58:06,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:06,268 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:58:06,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:06,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:06,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:06
2025-03-13 16:58:06,268 [INFO]: 819.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:06,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:06,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:06
2025-03-13 16:58:06,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:06,269 [INFO]: 	Creating the index 03/13/2025, 16:58:06
2025-03-13 16:58:06,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:06
2025-03-13 16:58:06,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:58:06,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:06
2025-03-13 16:58:06,270 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:58:06,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.50it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.30it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.21it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.58it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.52it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.60it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.52it/s] 50%|█████     | 8/16 [00:00<00:00,  8.44it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.73it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.59it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.53it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.28it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.09it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.93it/s] 94%|█████████▍| 15/16 [00:01<00:00,  7.86it/s]100%|██████████| 16/16 [00:05<00:00,  1.14s/it]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]
2025-03-13 16:58:11,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:11
2025-03-13 16:58:47,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6972 secs
2025-03-13 16:58:47,306 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 16:58:47,306 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 16:59:18,127 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8202 secs
2025-03-13 16:59:18,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8594 secs
2025-03-13 16:59:18,130 [INFO]: {
2025-03-13 16:59:18,130 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:18,130 [INFO]: 	index_param: efSearch=202
2025-03-13 16:59:18,130 [INFO]: 	index_path: knn.index
2025-03-13 16:59:18,130 [INFO]: 	size in bytes: 780877090
2025-03-13 16:59:18,130 [INFO]: 	avg_search_speed_ms: 9.207754816112159
2025-03-13 16:59:18,130 [INFO]: 	99p_search_speed_ms: 13.322892284486446
2025-03-13 16:59:18,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:18,130 [INFO]: 	nb vectors: 3969
2025-03-13 16:59:18,130 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:18,130 [INFO]: 	compression ratio: 0.9993085493134394
2025-03-13 16:59:18,130 [INFO]: }
2025-03-13 16:59:18,130 [INFO]: 	>>> Finished "Creating the index" in 71.8609 secs
2025-03-13 16:59:18,130 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8861 secs
2025-03-13 16:59:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 59596 [episode count 8/20]
[retrieval_preprocessing] for episode 37072 [episode count 9/20], we have num_retrieval=np.int64(3979) num_query=np.int64(173)
2025-03-13 16:59:20,685 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:21,250 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:21
2025-03-13 16:59:21,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.10it/s]
2025-03-13 16:59:21,273 [INFO]: There are 3979 embeddings of dim 49152
2025-03-13 16:59:21,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 16:59:21,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:21
2025-03-13 16:59:21,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:21,273 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:59:21,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:21,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:21,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:21
2025-03-13 16:59:21,273 [INFO]: 821.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:21,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:21,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:21
2025-03-13 16:59:21,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:21,274 [INFO]: 	Creating the index 03/13/2025, 16:59:21
2025-03-13 16:59:21,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:21
2025-03-13 16:59:21,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:59:21,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:21
2025-03-13 16:59:21,275 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:59:21,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.39it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.46it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.05it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.64it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.72it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.74it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.61it/s]100%|██████████| 16/16 [00:04<00:00,  3.54it/s]
2025-03-13 16:59:25,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:25
2025-03-13 17:00:04,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8676 secs
2025-03-13 17:00:04,663 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:00:04,663 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 17:00:31,481 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8177 secs
2025-03-13 17:00:31,485 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2091 secs
2025-03-13 17:00:31,485 [INFO]: {
2025-03-13 17:00:31,485 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:31,485 [INFO]: 	index_param: efSearch=227
2025-03-13 17:00:31,485 [INFO]: 	index_path: knn.index
2025-03-13 17:00:31,485 [INFO]: 	size in bytes: 782844550
2025-03-13 17:00:31,485 [INFO]: 	avg_search_speed_ms: 10.307457912281233
2025-03-13 17:00:31,485 [INFO]: 	99p_search_speed_ms: 13.331986006814985
2025-03-13 17:00:31,485 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:31,485 [INFO]: 	nb vectors: 3979
2025-03-13 17:00:31,485 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:31,485 [INFO]: 	compression ratio: 0.9993085242785429
2025-03-13 17:00:31,485 [INFO]: }
2025-03-13 17:00:31,485 [INFO]: 	>>> Finished "Creating the index" in 70.2117 secs
2025-03-13 17:00:31,485 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2357 secs
2025-03-13 17:00:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 37072 [episode count 9/20]
[retrieval_preprocessing] for episode 60123 [episode count 10/20], we have num_retrieval=np.int64(4003) num_query=np.int64(149)
2025-03-13 17:00:35,577 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:36,315 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:36
2025-03-13 17:00:36,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2055.02it/s]
2025-03-13 17:00:36,341 [INFO]: There are 4003 embeddings of dim 49152
2025-03-13 17:00:36,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:00:36,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:36,341 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:00:36,341 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:36,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:36,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,341 [INFO]: 826.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:36,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:00:36,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:36
2025-03-13 17:00:36,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:36,341 [INFO]: 	Creating the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:36
2025-03-13 17:00:36,342 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:00:36,342 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:36
2025-03-13 17:00:36,342 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:00:36,342 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.61it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.55it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.34it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.87it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.36it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.14it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.24it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.31it/s]100%|██████████| 16/16 [00:05<00:00,  3.03it/s]
2025-03-13 17:00:41,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:41
2025-03-13 17:01:21,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1718 secs
2025-03-13 17:01:21,806 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:01:21,806 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:01:52,625 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8191 secs
2025-03-13 17:01:52,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2871 secs
2025-03-13 17:01:52,630 [INFO]: {
2025-03-13 17:01:52,630 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:52,630 [INFO]: 	index_param: efSearch=170
2025-03-13 17:01:52,630 [INFO]: 	index_path: knn.index
2025-03-13 17:01:52,630 [INFO]: 	size in bytes: 787566370
2025-03-13 17:01:52,630 [INFO]: 	avg_search_speed_ms: 7.224733401237949
2025-03-13 17:01:52,630 [INFO]: 	99p_search_speed_ms: 10.610161935910584
2025-03-13 17:01:52,630 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:52,630 [INFO]: 	nb vectors: 4003
2025-03-13 17:01:52,630 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:52,630 [INFO]: 	compression ratio: 0.9993085712890458
2025-03-13 17:01:52,630 [INFO]: }
2025-03-13 17:01:52,630 [INFO]: 	>>> Finished "Creating the index" in 76.2886 secs
2025-03-13 17:01:52,630 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3152 secs
2025-03-13 17:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 60123 [episode count 10/20]
[retrieval_preprocessing] for episode 73449 [episode count 11/20], we have num_retrieval=np.int64(3973) num_query=np.int64(179)
2025-03-13 17:01:55,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:55,971 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:55
2025-03-13 17:01:55,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1405.60it/s]
2025-03-13 17:01:55,995 [INFO]: There are 3973 embeddings of dim 49152
2025-03-13 17:01:55,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 17:01:55,995 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:55
2025-03-13 17:01:55,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:55,995 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:01:55,995 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:55,995 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:55,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:55
2025-03-13 17:01:55,996 [INFO]: 819.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:55,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:01:55,996 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:55
2025-03-13 17:01:55,996 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:55,996 [INFO]: 	Creating the index 03/13/2025, 17:01:55
2025-03-13 17:01:55,996 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:55
2025-03-13 17:01:55,997 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:01:55,997 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:55
2025-03-13 17:01:55,997 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:01:55,997 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.37it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.04it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.23it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.08it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.46it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.66it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.83it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.97it/s]100%|██████████| 16/16 [00:03<00:00,  4.20it/s]
2025-03-13 17:01:59,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:59
2025-03-13 17:02:41,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9995 secs
2025-03-13 17:02:41,814 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 17:02:41,814 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 17:03:04,083 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2693 secs
2025-03-13 17:03:04,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0896 secs
2025-03-13 17:03:04,087 [INFO]: {
2025-03-13 17:03:04,087 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:04,087 [INFO]: 	index_param: efSearch=238
2025-03-13 17:03:04,087 [INFO]: 	index_path: knn.index
2025-03-13 17:03:04,087 [INFO]: 	size in bytes: 781664050
2025-03-13 17:03:04,087 [INFO]: 	avg_search_speed_ms: 10.398122594302633
2025-03-13 17:03:04,087 [INFO]: 	99p_search_speed_ms: 14.539925176650286
2025-03-13 17:03:04,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:04,087 [INFO]: 	nb vectors: 3973
2025-03-13 17:03:04,087 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:04,087 [INFO]: 	compression ratio: 0.9993085699668547
2025-03-13 17:03:04,087 [INFO]: }
2025-03-13 17:03:04,087 [INFO]: 	>>> Finished "Creating the index" in 68.0912 secs
2025-03-13 17:03:04,087 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1162 secs
2025-03-13 17:03:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 73449 [episode count 11/20]
[retrieval_preprocessing] for episode 29987 [episode count 12/20], we have num_retrieval=np.int64(3953) num_query=np.int64(199)
2025-03-13 17:03:07,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:08,488 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:08
2025-03-13 17:03:08,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1541.46it/s]
2025-03-13 17:03:08,515 [INFO]: There are 3953 embeddings of dim 49152
2025-03-13 17:03:08,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:03:08,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:08
2025-03-13 17:03:08,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:08,516 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:03:08,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:08,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:03:08,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:08
2025-03-13 17:03:08,516 [INFO]: 815.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:08,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:03:08,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:08
2025-03-13 17:03:08,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:08,516 [INFO]: 	Creating the index 03/13/2025, 17:03:08
2025-03-13 17:03:08,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:08
2025-03-13 17:03:08,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:03:08,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:08
2025-03-13 17:03:08,517 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:03:08,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.07it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.92it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.07it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.93it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.43it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.58it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.92it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.27it/s]100%|██████████| 16/16 [00:04<00:00,  3.94it/s]
2025-03-13 17:03:12,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:12
2025-03-13 17:03:49,670 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0826 secs
2025-03-13 17:03:49,670 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:03:49,670 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 17:04:16,601 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9304 secs
2025-03-13 17:04:16,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0864 secs
2025-03-13 17:04:16,604 [INFO]: {
2025-03-13 17:04:16,604 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:16,604 [INFO]: 	index_param: efSearch=175
2025-03-13 17:04:16,604 [INFO]: 	index_path: knn.index
2025-03-13 17:04:16,604 [INFO]: 	size in bytes: 777729250
2025-03-13 17:04:16,604 [INFO]: 	avg_search_speed_ms: 9.137066893945269
2025-03-13 17:04:16,604 [INFO]: 	99p_search_speed_ms: 17.384552278090244
2025-03-13 17:04:16,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:16,604 [INFO]: 	nb vectors: 3953
2025-03-13 17:04:16,604 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:16,604 [INFO]: 	compression ratio: 0.9993084662818069
2025-03-13 17:04:16,604 [INFO]: }
2025-03-13 17:04:16,604 [INFO]: 	>>> Finished "Creating the index" in 68.0881 secs
2025-03-13 17:04:16,604 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1156 secs
2025-03-13 17:04:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 29987 [episode count 12/20]
[retrieval_preprocessing] for episode 42796 [episode count 13/20], we have num_retrieval=np.int64(3999) num_query=np.int64(153)
2025-03-13 17:04:19,101 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:19,807 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:19
2025-03-13 17:04:19,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.57it/s]
2025-03-13 17:04:19,833 [INFO]: There are 3999 embeddings of dim 49152
2025-03-13 17:04:19,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:04:19,833 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:19,833 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:04:19,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:19,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:19,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,833 [INFO]: 825.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:19,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:19,833 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:19
2025-03-13 17:04:19,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:19,833 [INFO]: 	Creating the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,833 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:19
2025-03-13 17:04:19,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:04:19,834 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,835 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:04:19,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.36it/s] 19%|█▉        | 3/16 [00:00<00:01, 12.47it/s] 31%|███▏      | 5/16 [00:00<00:00, 13.95it/s] 44%|████▍     | 7/16 [00:00<00:00, 14.03it/s] 56%|█████▋    | 9/16 [00:00<00:00, 14.86it/s] 69%|██████▉   | 11/16 [00:00<00:00, 14.42it/s] 81%|████████▏ | 13/16 [00:00<00:00, 12.95it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.16it/s]100%|██████████| 16/16 [00:04<00:00,  3.88it/s]
2025-03-13 17:04:23,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:23
2025-03-13 17:05:01,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0899 secs
2025-03-13 17:05:01,054 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:05:01,054 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 17:05:46,914 [INFO]: 	>>> Finished "Compute fast metrics" in 45.8598 secs
2025-03-13 17:05:46,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0829 secs
2025-03-13 17:05:46,918 [INFO]: {
2025-03-13 17:05:46,918 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:46,918 [INFO]: 	index_param: efSearch=227
2025-03-13 17:05:46,918 [INFO]: 	index_path: knn.index
2025-03-13 17:05:46,918 [INFO]: 	size in bytes: 786779410
2025-03-13 17:05:46,918 [INFO]: 	avg_search_speed_ms: 10.23263514521846
2025-03-13 17:05:46,918 [INFO]: 	99p_search_speed_ms: 18.176863854750994
2025-03-13 17:05:46,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:46,918 [INFO]: 	nb vectors: 3999
2025-03-13 17:05:46,918 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:46,918 [INFO]: 	compression ratio: 0.9993085507918922
2025-03-13 17:05:46,918 [INFO]: }
2025-03-13 17:05:46,918 [INFO]: 	>>> Finished "Creating the index" in 87.0844 secs
2025-03-13 17:05:46,918 [INFO]: >>> Finished "Launching the whole pipeline" in 87.1104 secs
2025-03-13 17:05:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 42796 [episode count 13/20]
[retrieval_preprocessing] for episode 56119 [episode count 14/20], we have num_retrieval=np.int64(3934) num_query=np.int64(218)
2025-03-13 17:05:50,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:51,168 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:51
2025-03-13 17:05:51,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 714.53it/s]
2025-03-13 17:05:51,196 [INFO]: There are 3934 embeddings of dim 49152
2025-03-13 17:05:51,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:05:51,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:51,198 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:05:51,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:51,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:05:51,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,198 [INFO]: 811.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:51,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:05:51,199 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:51
2025-03-13 17:05:51,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:51,199 [INFO]: 	Creating the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,199 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:51
2025-03-13 17:05:51,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:05:51,202 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,203 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:05:51,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.04it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.75it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.52it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.17it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.42it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.51it/s] 88%|████████▊ | 14/16 [00:01<00:00, 14.24it/s]100%|██████████| 16/16 [00:04<00:00,  1.79it/s]100%|██████████| 16/16 [00:04<00:00,  3.40it/s]
2025-03-13 17:05:55,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:55
2025-03-13 17:06:32,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3883 secs
2025-03-13 17:06:32,305 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:06:32,305 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 17:07:00,088 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7830 secs
2025-03-13 17:07:00,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8902 secs
2025-03-13 17:07:00,093 [INFO]: {
2025-03-13 17:07:00,093 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:00,093 [INFO]: 	index_param: efSearch=202
2025-03-13 17:07:00,093 [INFO]: 	index_path: knn.index
2025-03-13 17:07:00,093 [INFO]: 	size in bytes: 773991130
2025-03-13 17:07:00,093 [INFO]: 	avg_search_speed_ms: 9.861423276250914
2025-03-13 17:07:00,093 [INFO]: 	99p_search_speed_ms: 17.739043573383242
2025-03-13 17:07:00,093 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:00,093 [INFO]: 	nb vectors: 3934
2025-03-13 17:07:00,093 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:00,093 [INFO]: 	compression ratio: 0.9993084442711895
2025-03-13 17:07:00,093 [INFO]: }
2025-03-13 17:07:00,093 [INFO]: 	>>> Finished "Creating the index" in 68.8938 secs
2025-03-13 17:07:00,093 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9249 secs
2025-03-13 17:07:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 56119 [episode count 14/20]
[retrieval_preprocessing] for episode 10603 [episode count 15/20], we have num_retrieval=np.int64(3917) num_query=np.int64(235)
2025-03-13 17:07:03,933 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:04,643 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:04
2025-03-13 17:07:04,643 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1914.33it/s]
2025-03-13 17:07:04,669 [INFO]: There are 3917 embeddings of dim 49152
2025-03-13 17:07:04,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:07:04,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:04
2025-03-13 17:07:04,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:04,670 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:07:04,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:04,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:07:04,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:04
2025-03-13 17:07:04,670 [INFO]: 808.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:04,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:07:04,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:04
2025-03-13 17:07:04,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:04,670 [INFO]: 	Creating the index 03/13/2025, 17:07:04
2025-03-13 17:07:04,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:04
2025-03-13 17:07:04,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:07:04,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:04
2025-03-13 17:07:04,672 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:07:04,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.42it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.22it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.01it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.44it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.85it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.94it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.17it/s] 50%|█████     | 8/16 [00:00<00:00,  9.14it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.18it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.23it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.04it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.90it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.66it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.72it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.92it/s]100%|██████████| 16/16 [00:05<00:00,  1.08s/it]100%|██████████| 16/16 [00:05<00:00,  3.17it/s]
2025-03-13 17:07:09,723 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:09
2025-03-13 17:07:44,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6840 secs
2025-03-13 17:07:44,407 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:07:44,407 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.56it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 17:08:24,847 [INFO]: 	>>> Finished "Compute fast metrics" in 40.4393 secs
2025-03-13 17:08:24,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.1783 secs
2025-03-13 17:08:24,850 [INFO]: {
2025-03-13 17:08:24,850 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:24,850 [INFO]: 	index_param: efSearch=209
2025-03-13 17:08:24,850 [INFO]: 	index_path: knn.index
2025-03-13 17:08:24,850 [INFO]: 	size in bytes: 770646430
2025-03-13 17:08:24,850 [INFO]: 	avg_search_speed_ms: 11.111789678689092
2025-03-13 17:08:24,850 [INFO]: 	99p_search_speed_ms: 21.624686801806085
2025-03-13 17:08:24,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:24,850 [INFO]: 	nb vectors: 3917
2025-03-13 17:08:24,850 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:24,850 [INFO]: 	compression ratio: 0.9993085103891288
2025-03-13 17:08:24,850 [INFO]: }
2025-03-13 17:08:24,850 [INFO]: 	>>> Finished "Creating the index" in 80.1799 secs
2025-03-13 17:08:24,850 [INFO]: >>> Finished "Launching the whole pipeline" in 80.2071 secs
2025-03-13 17:08:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 10603 [episode count 15/20]
[retrieval_preprocessing] for episode 79219 [episode count 16/20], we have num_retrieval=np.int64(3926) num_query=np.int64(226)
2025-03-13 17:08:28,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:29,331 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:29
2025-03-13 17:08:29,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.07it/s]
2025-03-13 17:08:29,357 [INFO]: There are 3926 embeddings of dim 49152
2025-03-13 17:08:29,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:08:29,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:29,357 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:08:29,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:29,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:29,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,358 [INFO]: 810.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:29,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:29,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:29
2025-03-13 17:08:29,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:29,358 [INFO]: 	Creating the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:29
2025-03-13 17:08:29,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:08:29,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,359 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:08:29,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.39it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.35it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.54it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.17it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.91it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.01it/s] 50%|█████     | 8/16 [00:01<00:00,  8.19it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.58it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.76it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.03it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.03it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.63it/s] 94%|█████████▍| 15/16 [00:01<00:00,  7.52it/s]100%|██████████| 16/16 [00:06<00:00,  1.40s/it]100%|██████████| 16/16 [00:06<00:00,  2.54it/s]
2025-03-13 17:08:35,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:35
2025-03-13 17:09:19,250 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2523 secs
2025-03-13 17:09:19,251 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 17:09:19,251 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 17:09:53,162 [INFO]: 	>>> Finished "Compute fast metrics" in 33.9109 secs
2025-03-13 17:09:53,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.8056 secs
2025-03-13 17:09:53,165 [INFO]: {
2025-03-13 17:09:53,165 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:53,165 [INFO]: 	index_param: efSearch=204
2025-03-13 17:09:53,165 [INFO]: 	index_path: knn.index
2025-03-13 17:09:53,165 [INFO]: 	size in bytes: 772417150
2025-03-13 17:09:53,165 [INFO]: 	avg_search_speed_ms: 9.411890265380269
2025-03-13 17:09:53,165 [INFO]: 	99p_search_speed_ms: 15.605874750763064
2025-03-13 17:09:53,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:53,165 [INFO]: 	nb vectors: 3926
2025-03-13 17:09:53,165 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:53,165 [INFO]: 	compression ratio: 0.9993084798803341
2025-03-13 17:09:53,165 [INFO]: }
2025-03-13 17:09:53,165 [INFO]: 	>>> Finished "Creating the index" in 83.8074 secs
2025-03-13 17:09:53,165 [INFO]: >>> Finished "Launching the whole pipeline" in 83.8348 secs
2025-03-13 17:09:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 79219 [episode count 16/20]
[retrieval_preprocessing] for episode 49012 [episode count 17/20], we have num_retrieval=np.int64(3940) num_query=np.int64(212)
2025-03-13 17:09:56,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:57,541 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:57
2025-03-13 17:09:57,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-13 17:09:57,577 [INFO]: There are 3940 embeddings of dim 49152
2025-03-13 17:09:57,577 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 17:09:57,578 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:57
2025-03-13 17:09:57,578 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:57,578 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:09:57,578 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:57,578 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:09:57,578 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:57
2025-03-13 17:09:57,578 [INFO]: 813.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:57,578 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:09:57,578 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:57
2025-03-13 17:09:57,578 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:57,578 [INFO]: 	Creating the index 03/13/2025, 17:09:57
2025-03-13 17:09:57,579 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:57
2025-03-13 17:09:57,580 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:09:57,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:57
2025-03-13 17:09:57,581 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:09:57,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.07it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.98it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.63it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.94it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.15it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.37it/s] 50%|█████     | 8/16 [00:00<00:00,  9.55it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.59it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.63it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.64it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.94it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.03it/s]100%|██████████| 16/16 [00:04<00:00,  1.39it/s]100%|██████████| 16/16 [00:04<00:00,  3.54it/s]
2025-03-13 17:10:02,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:02
2025-03-13 17:10:37,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2791 secs
2025-03-13 17:10:37,386 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 17:10:37,387 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-13 17:11:17,292 [INFO]: 	>>> Finished "Compute fast metrics" in 39.9057 secs
2025-03-13 17:11:17,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.7156 secs
2025-03-13 17:11:17,297 [INFO]: {
2025-03-13 17:11:17,297 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:17,297 [INFO]: 	index_param: efSearch=303
2025-03-13 17:11:17,297 [INFO]: 	index_path: knn.index
2025-03-13 17:11:17,297 [INFO]: 	size in bytes: 775171570
2025-03-13 17:11:17,297 [INFO]: 	avg_search_speed_ms: 11.120426519515199
2025-03-13 17:11:17,297 [INFO]: 	99p_search_speed_ms: 19.92201645858586
2025-03-13 17:11:17,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:17,297 [INFO]: 	nb vectors: 3940
2025-03-13 17:11:17,297 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:17,297 [INFO]: 	compression ratio: 0.9993084756707473
2025-03-13 17:11:17,297 [INFO]: }
2025-03-13 17:11:17,297 [INFO]: 	>>> Finished "Creating the index" in 79.7183 secs
2025-03-13 17:11:17,297 [INFO]: >>> Finished "Launching the whole pipeline" in 79.7560 secs
2025-03-13 17:11:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 49012 [episode count 17/20]
[retrieval_preprocessing] for episode 33143 [episode count 18/20], we have num_retrieval=np.int64(3892) num_query=np.int64(260)
2025-03-13 17:11:24,908 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:25,587 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:25
2025-03-13 17:11:25,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1688.53it/s]
2025-03-13 17:11:25,612 [INFO]: There are 3892 embeddings of dim 49152
2025-03-13 17:11:25,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:11:25,612 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:25
2025-03-13 17:11:25,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:25,613 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:11:25,613 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:25,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:11:25,613 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:25
2025-03-13 17:11:25,613 [INFO]: 803.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:25,614 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:11:25,614 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:25
2025-03-13 17:11:25,614 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:25,614 [INFO]: 	Creating the index 03/13/2025, 17:11:25
2025-03-13 17:11:25,614 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:25
2025-03-13 17:11:25,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:11:25,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:25
2025-03-13 17:11:25,618 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:11:25,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.30it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.82it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.05it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.69it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.09it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.29it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.67it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.93it/s]100%|██████████| 16/16 [00:04<00:00,  3.92it/s]
2025-03-13 17:11:29,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:29
2025-03-13 17:12:09,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2878 secs
2025-03-13 17:12:09,080 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:12:09,080 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.72it/s]
2025-03-13 17:12:28,357 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2768 secs
2025-03-13 17:12:28,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7428 secs
2025-03-13 17:12:28,361 [INFO]: {
2025-03-13 17:12:28,361 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:28,361 [INFO]: 	index_param: efSearch=187
2025-03-13 17:12:28,361 [INFO]: 	index_path: knn.index
2025-03-13 17:12:28,361 [INFO]: 	size in bytes: 765727630
2025-03-13 17:12:28,361 [INFO]: 	avg_search_speed_ms: 12.85435270191683
2025-03-13 17:12:28,361 [INFO]: 	99p_search_speed_ms: 27.43264328222727
2025-03-13 17:12:28,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:28,361 [INFO]: 	nb vectors: 3892
2025-03-13 17:12:28,361 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:28,361 [INFO]: 	compression ratio: 0.9993087698820532
2025-03-13 17:12:28,361 [INFO]: }
2025-03-13 17:12:28,361 [INFO]: 	>>> Finished "Creating the index" in 62.7470 secs
2025-03-13 17:12:28,361 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7743 secs
2025-03-13 17:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 33143 [episode count 18/20]
[retrieval_preprocessing] for episode 90504 [episode count 19/20], we have num_retrieval=np.int64(4000) num_query=np.int64(152)
2025-03-13 17:12:32,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:33,313 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:33
2025-03-13 17:12:33,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-13 17:12:33,341 [INFO]: There are 4000 embeddings of dim 49152
2025-03-13 17:12:33,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:12:33,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:33
2025-03-13 17:12:33,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:33,342 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:12:33,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:33,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:12:33,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:33
2025-03-13 17:12:33,343 [INFO]: 825.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:33,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:12:33,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:33
2025-03-13 17:12:33,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:33,344 [INFO]: 	Creating the index 03/13/2025, 17:12:33
2025-03-13 17:12:33,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:33
2025-03-13 17:12:33,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:12:33,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:33
2025-03-13 17:12:33,347 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:12:33,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.47it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.79it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.99it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.64it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.79it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.90it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.89it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.85it/s]100%|██████████| 16/16 [00:04<00:00,  3.73it/s]
2025-03-13 17:12:37,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:37
2025-03-13 17:13:15,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6983 secs
2025-03-13 17:13:15,341 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:13:15,341 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.13it/s]
2025-03-13 17:13:51,647 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3063 secs
2025-03-13 17:13:51,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3028 secs
2025-03-13 17:13:51,650 [INFO]: {
2025-03-13 17:13:51,650 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:51,650 [INFO]: 	index_param: efSearch=251
2025-03-13 17:13:51,650 [INFO]: 	index_path: knn.index
2025-03-13 17:13:51,650 [INFO]: 	size in bytes: 786976150
2025-03-13 17:13:51,650 [INFO]: 	avg_search_speed_ms: 10.666258681291488
2025-03-13 17:13:51,650 [INFO]: 	99p_search_speed_ms: 16.69573264196515
2025-03-13 17:13:51,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:51,650 [INFO]: 	nb vectors: 4000
2025-03-13 17:13:51,650 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:51,650 [INFO]: 	compression ratio: 0.9993085559200238
2025-03-13 17:13:51,650 [INFO]: }
2025-03-13 17:13:51,650 [INFO]: 	>>> Finished "Creating the index" in 78.3067 secs
2025-03-13 17:13:51,650 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3368 secs
2025-03-13 17:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 90504 [episode count 19/20]
2025-03-13 17:13:56: [retrieval_preprocessing] finished for 4130977918_open_kettle [chosen_id count 4/196]
2025-03-13 17:14:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4142994792_put_spoon_in_mug [chosen_id count 5/196]
2025-03-13 17:14:00: [retrieval_preprocessing] we have num_total=5448 embedding_dim=49152
[retrieval_preprocessing] for episode 46113 [episode count 0/20], we have num_retrieval=np.int64(5143) num_query=np.int64(305)
2025-03-13 17:14:02,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:03,270 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:03
2025-03-13 17:14:03,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.78it/s]
2025-03-13 17:14:03,300 [INFO]: There are 5143 embeddings of dim 49152
2025-03-13 17:14:03,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:14:03,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:03
2025-03-13 17:14:03,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:03,301 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:14:03,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:03,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:03,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:03
2025-03-13 17:14:03,301 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:03,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:03,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:03
2025-03-13 17:14:03,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:03,301 [INFO]: 	Creating the index 03/13/2025, 17:14:03
2025-03-13 17:14:03,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:03
2025-03-13 17:14:03,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:14:03,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:03
2025-03-13 17:14:03,302 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:14:03,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.61it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.52it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.41it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.38it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.32it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.32it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.04it/s] 41%|████      | 9/22 [00:01<00:01,  8.20it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.63it/s] 50%|█████     | 11/22 [00:01<00:01,  8.30it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.14it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.05it/s] 64%|██████▎   | 14/22 [00:01<00:01,  7.80it/s] 68%|██████▊   | 15/22 [00:01<00:00,  7.64it/s] 73%|███████▎  | 16/22 [00:02<00:00,  7.52it/s] 77%|███████▋  | 17/22 [00:02<00:00,  7.83it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.29it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.34it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.51it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.43s/it]100%|██████████| 22/22 [00:07<00:00,  1.22s/it]100%|██████████| 22/22 [00:07<00:00,  2.86it/s]
2025-03-13 17:14:10,995 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:10
2025-03-13 17:15:05,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9439 secs
2025-03-13 17:15:05,940 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 17:15:05,940 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 17:15:53,303 [INFO]: 	>>> Finished "Compute fast metrics" in 47.3634 secs
2025-03-13 17:15:53,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.0026 secs
2025-03-13 17:15:53,305 [INFO]: {
2025-03-13 17:15:53,305 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:53,305 [INFO]: 	index_param: efSearch=125
2025-03-13 17:15:53,305 [INFO]: 	index_path: knn.index
2025-03-13 17:15:53,305 [INFO]: 	size in bytes: 1011854650
2025-03-13 17:15:53,305 [INFO]: 	avg_search_speed_ms: 7.744307093947007
2025-03-13 17:15:53,305 [INFO]: 	99p_search_speed_ms: 12.18564927112311
2025-03-13 17:15:53,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:53,305 [INFO]: 	nb vectors: 5143
2025-03-13 17:15:53,305 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:53,305 [INFO]: 	compression ratio: 0.9993084915901705
2025-03-13 17:15:53,305 [INFO]: }
2025-03-13 17:15:53,305 [INFO]: 	>>> Finished "Creating the index" in 110.0041 secs
2025-03-13 17:15:53,305 [INFO]: >>> Finished "Launching the whole pipeline" in 110.0350 secs
2025-03-13 17:15:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 46113 [episode count 0/20]
[retrieval_preprocessing] for episode 57402 [episode count 1/20], we have num_retrieval=np.int64(5198) num_query=np.int64(250)
2025-03-13 17:15:57,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:58,018 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:58
2025-03-13 17:15:58,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 973.61it/s]
2025-03-13 17:15:58,052 [INFO]: There are 5198 embeddings of dim 49152
2025-03-13 17:15:58,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 17:15:58,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:58
2025-03-13 17:15:58,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:58,054 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:15:58,054 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:58,054 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:15:58,054 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:58
2025-03-13 17:15:58,054 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:58,055 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:15:58,055 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:58
2025-03-13 17:15:58,055 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:58,055 [INFO]: 	Creating the index 03/13/2025, 17:15:58
2025-03-13 17:15:58,055 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:58
2025-03-13 17:15:58,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:15:58,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:58
2025-03-13 17:15:58,060 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:15:58,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.22it/s]  9%|▉         | 2/22 [00:00<00:02,  6.97it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.99it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.34it/s] 23%|██▎       | 5/22 [00:00<00:01,  8.63it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.82it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.85it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.90it/s] 41%|████      | 9/22 [00:01<00:01,  8.81it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.72it/s] 50%|█████     | 11/22 [00:01<00:01,  8.69it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.59it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.55it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.43it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.38it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.33it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.33it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.39it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.64it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.73it/s] 95%|█████████▌| 21/22 [00:07<00:01,  1.61s/it]100%|██████████| 22/22 [00:08<00:00,  1.40s/it]100%|██████████| 22/22 [00:08<00:00,  2.62it/s]
2025-03-13 17:16:06,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:06
2025-03-13 17:17:06,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6112 secs
2025-03-13 17:17:06,063 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:17:06,063 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 17:17:34,192 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1293 secs
2025-03-13 17:17:34,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.1333 secs
2025-03-13 17:17:34,193 [INFO]: {
2025-03-13 17:17:34,193 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:34,193 [INFO]: 	index_param: efSearch=187
2025-03-13 17:17:34,193 [INFO]: 	index_path: knn.index
2025-03-13 17:17:34,193 [INFO]: 	size in bytes: 1022675710
2025-03-13 17:17:34,193 [INFO]: 	avg_search_speed_ms: 11.291185154791913
2025-03-13 17:17:34,193 [INFO]: 	99p_search_speed_ms: 16.673353535588824
2025-03-13 17:17:34,193 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:34,193 [INFO]: 	nb vectors: 5198
2025-03-13 17:17:34,193 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:34,193 [INFO]: 	compression ratio: 0.9993083574850917
2025-03-13 17:17:34,193 [INFO]: }
2025-03-13 17:17:34,193 [INFO]: 	>>> Finished "Creating the index" in 96.1376 secs
2025-03-13 17:17:34,193 [INFO]: >>> Finished "Launching the whole pipeline" in 96.1745 secs
2025-03-13 17:17:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 57402 [episode count 1/20]
[retrieval_preprocessing] for episode 13901 [episode count 2/20], we have num_retrieval=np.int64(5239) num_query=np.int64(209)
2025-03-13 17:17:40,852 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:41,930 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:41
2025-03-13 17:17:41,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-13 17:17:41,958 [INFO]: There are 5239 embeddings of dim 49152
2025-03-13 17:17:41,959 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 17:17:41,959 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:41
2025-03-13 17:17:41,959 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:41,959 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:17:41,959 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:41,959 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:17:41,959 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:41
2025-03-13 17:17:41,959 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:41,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:17:41,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:41
2025-03-13 17:17:41,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:41,959 [INFO]: 	Creating the index 03/13/2025, 17:17:41
2025-03-13 17:17:41,959 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:41
2025-03-13 17:17:41,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:17:41,961 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:41
2025-03-13 17:17:41,961 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:17:41,961 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.54it/s]  9%|▉         | 2/22 [00:00<00:03,  6.16it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.08it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.52it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.78it/s] 27%|██▋       | 6/22 [00:00<00:02,  7.88it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.02it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.21it/s] 41%|████      | 9/22 [00:01<00:01,  8.17it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.14it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.15it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.80it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.76it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.69it/s] 82%|████████▏ | 18/22 [00:02<00:00, 10.23it/s] 91%|█████████ | 20/22 [00:02<00:00, 10.61it/s]100%|██████████| 22/22 [00:06<00:00,  1.19it/s]100%|██████████| 22/22 [00:06<00:00,  3.25it/s]
2025-03-13 17:17:48,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:48
2025-03-13 17:18:35,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0911 secs
2025-03-13 17:18:35,830 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:18:35,830 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.63it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 17:19:07,295 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4642 secs
2025-03-13 17:19:07,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7726 secs
2025-03-13 17:19:07,734 [INFO]: {
2025-03-13 17:19:07,734 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:07,734 [INFO]: 	index_param: efSearch=196
2025-03-13 17:19:07,734 [INFO]: 	index_path: knn.index
2025-03-13 17:19:07,734 [INFO]: 	size in bytes: 1030742290
2025-03-13 17:19:07,734 [INFO]: 	avg_search_speed_ms: 9.520402849164038
2025-03-13 17:19:07,734 [INFO]: 	99p_search_speed_ms: 14.060068314429373
2025-03-13 17:19:07,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:07,734 [INFO]: 	nb vectors: 5239
2025-03-13 17:19:07,734 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:07,734 [INFO]: 	compression ratio: 0.9993082868463659
2025-03-13 17:19:07,734 [INFO]: }
2025-03-13 17:19:07,734 [INFO]: 	>>> Finished "Creating the index" in 85.7750 secs
2025-03-13 17:19:07,734 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8046 secs
2025-03-13 17:19:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 13901 [episode count 2/20]
[retrieval_preprocessing] for episode 47696 [episode count 3/20], we have num_retrieval=np.int64(5214) num_query=np.int64(234)
2025-03-13 17:19:11,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:12,089 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:12
2025-03-13 17:19:12,089 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2204.05it/s]
2025-03-13 17:19:12,113 [INFO]: There are 5214 embeddings of dim 49152
2025-03-13 17:19:12,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 17:19:12,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:12
2025-03-13 17:19:12,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:12,113 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:19:12,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:12,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:19:12,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:12
2025-03-13 17:19:12,113 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:12,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:12,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:12
2025-03-13 17:19:12,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:12,113 [INFO]: 	Creating the index 03/13/2025, 17:19:12
2025-03-13 17:19:12,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:12
2025-03-13 17:19:12,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:19:12,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:12
2025-03-13 17:19:12,114 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:19:12,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.58it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.66it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.77it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.10it/s] 41%|████      | 9/22 [00:00<00:01, 10.45it/s] 50%|█████     | 11/22 [00:01<00:01, 10.38it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.29it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.51it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.42it/s] 86%|████████▋ | 19/22 [00:01<00:00, 10.21it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.31it/s]100%|██████████| 22/22 [00:07<00:00,  1.28it/s]100%|██████████| 22/22 [00:07<00:00,  3.02it/s]
2025-03-13 17:19:19,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:19
2025-03-13 17:20:13,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.7123 secs
2025-03-13 17:20:13,106 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:20:13,106 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 17:20:45,178 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0725 secs
2025-03-13 17:20:45,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0664 secs
2025-03-13 17:20:45,181 [INFO]: {
2025-03-13 17:20:45,181 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:45,181 [INFO]: 	index_param: efSearch=184
2025-03-13 17:20:45,181 [INFO]: 	index_path: knn.index
2025-03-13 17:20:45,181 [INFO]: 	size in bytes: 1025823610
2025-03-13 17:20:45,181 [INFO]: 	avg_search_speed_ms: 9.093620739453895
2025-03-13 17:20:45,181 [INFO]: 	99p_search_speed_ms: 16.83090900303796
2025-03-13 17:20:45,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:45,181 [INFO]: 	nb vectors: 5214
2025-03-13 17:20:45,181 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:45,181 [INFO]: 	compression ratio: 0.9993083625751215
2025-03-13 17:20:45,181 [INFO]: }
2025-03-13 17:20:45,181 [INFO]: 	>>> Finished "Creating the index" in 93.0679 secs
2025-03-13 17:20:45,181 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0923 secs
2025-03-13 17:20:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 47696 [episode count 3/20]
[retrieval_preprocessing] for episode 24669 [episode count 4/20], we have num_retrieval=np.int64(5183) num_query=np.int64(265)
2025-03-13 17:20:49,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:50,179 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:50
2025-03-13 17:20:50,180 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.25it/s]
2025-03-13 17:20:50,205 [INFO]: There are 5183 embeddings of dim 49152
2025-03-13 17:20:50,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:20:50,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:50
2025-03-13 17:20:50,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:50,206 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:20:50,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:50,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:50,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:50
2025-03-13 17:20:50,206 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:50,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:20:50,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:50
2025-03-13 17:20:50,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:50,206 [INFO]: 	Creating the index 03/13/2025, 17:20:50
2025-03-13 17:20:50,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:50
2025-03-13 17:20:50,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:20:50,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:50
2025-03-13 17:20:50,207 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:20:50,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.09it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.20it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.03it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.14it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.16it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.31it/s] 41%|████      | 9/22 [00:01<00:01,  9.22it/s] 50%|█████     | 11/22 [00:01<00:01,  9.63it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.90it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.03it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.01it/s] 82%|████████▏ | 18/22 [00:01<00:00,  9.96it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.97it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.07it/s]100%|██████████| 22/22 [00:07<00:00,  1.04it/s]100%|██████████| 22/22 [00:07<00:00,  2.99it/s]
2025-03-13 17:20:57,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:57
2025-03-13 17:21:52,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0760 secs
2025-03-13 17:21:52,639 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:21:52,639 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 17:22:22,442 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8032 secs
2025-03-13 17:22:22,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.2375 secs
2025-03-13 17:22:22,445 [INFO]: {
2025-03-13 17:22:22,445 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:22,445 [INFO]: 	index_param: efSearch=196
2025-03-13 17:22:22,445 [INFO]: 	index_path: knn.index
2025-03-13 17:22:22,445 [INFO]: 	size in bytes: 1019724490
2025-03-13 17:22:22,445 [INFO]: 	avg_search_speed_ms: 9.353454476544742
2025-03-13 17:22:22,445 [INFO]: 	99p_search_speed_ms: 17.102444637566798
2025-03-13 17:22:22,445 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:22,445 [INFO]: 	nb vectors: 5183
2025-03-13 17:22:22,445 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:22,445 [INFO]: 	compression ratio: 0.9993084151582944
2025-03-13 17:22:22,445 [INFO]: }
2025-03-13 17:22:22,445 [INFO]: 	>>> Finished "Creating the index" in 92.2392 secs
2025-03-13 17:22:22,445 [INFO]: >>> Finished "Launching the whole pipeline" in 92.2656 secs
2025-03-13 17:22:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 24669 [episode count 4/20]
[retrieval_preprocessing] for episode 29303 [episode count 5/20], we have num_retrieval=np.int64(5194) num_query=np.int64(254)
2025-03-13 17:22:26,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:27,155 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:27
2025-03-13 17:22:27,155 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.16it/s]
2025-03-13 17:22:27,178 [INFO]: There are 5194 embeddings of dim 49152
2025-03-13 17:22:27,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:22:27,178 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:27
2025-03-13 17:22:27,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:27,178 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:22:27,178 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:27,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:27,178 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:27
2025-03-13 17:22:27,179 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:27,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:27,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:27
2025-03-13 17:22:27,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:27,179 [INFO]: 	Creating the index 03/13/2025, 17:22:27
2025-03-13 17:22:27,179 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:27
2025-03-13 17:22:27,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:22:27,180 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:27
2025-03-13 17:22:27,180 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:22:27,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.00it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.22it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.82it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.43it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.65it/s] 41%|████      | 9/22 [00:00<00:01, 10.21it/s] 50%|█████     | 11/22 [00:01<00:01, 10.45it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.83it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.06it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.30it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.67it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.60it/s]100%|██████████| 22/22 [00:06<00:00,  1.31it/s]100%|██████████| 22/22 [00:06<00:00,  3.20it/s]
2025-03-13 17:22:34,050 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:34
2025-03-13 17:23:20,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3588 secs
2025-03-13 17:23:20,409 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 17:23:20,409 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 17:23:49,673 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2630 secs
2025-03-13 17:23:49,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4931 secs
2025-03-13 17:23:49,673 [INFO]: {
2025-03-13 17:23:49,673 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:49,673 [INFO]: 	index_param: efSearch=211
2025-03-13 17:23:49,673 [INFO]: 	index_path: knn.index
2025-03-13 17:23:49,673 [INFO]: 	size in bytes: 1021888750
2025-03-13 17:23:49,673 [INFO]: 	avg_search_speed_ms: 8.492726642292164
2025-03-13 17:23:49,673 [INFO]: 	99p_search_speed_ms: 12.584443318191916
2025-03-13 17:23:49,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:49,673 [INFO]: 	nb vectors: 5194
2025-03-13 17:23:49,673 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:49,673 [INFO]: 	compression ratio: 0.9993083415391353
2025-03-13 17:23:49,673 [INFO]: }
2025-03-13 17:23:49,673 [INFO]: 	>>> Finished "Creating the index" in 82.4943 secs
2025-03-13 17:23:49,673 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5183 secs
2025-03-13 17:23:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 29303 [episode count 5/20]
[retrieval_preprocessing] for episode 80019 [episode count 6/20], we have num_retrieval=np.int64(5134) num_query=np.int64(314)
2025-03-13 17:23:53,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:54,731 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:54
2025-03-13 17:23:54,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1684.46it/s]
2025-03-13 17:23:54,756 [INFO]: There are 5134 embeddings of dim 49152
2025-03-13 17:23:54,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:23:54,756 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:54
2025-03-13 17:23:54,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:54,756 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:23:54,756 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:54,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:23:54,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:54
2025-03-13 17:23:54,756 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:54,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:23:54,756 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:54
2025-03-13 17:23:54,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:54,756 [INFO]: 	Creating the index 03/13/2025, 17:23:54
2025-03-13 17:23:54,756 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:54
2025-03-13 17:23:54,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:23:54,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:54
2025-03-13 17:23:54,758 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:23:54,758 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.08it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.66it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.85it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.41it/s] 41%|████      | 9/22 [00:00<00:01, 10.82it/s] 50%|█████     | 11/22 [00:01<00:01, 10.99it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.16it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.30it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.71it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.97it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.66it/s]100%|██████████| 22/22 [00:06<00:00,  1.51it/s]100%|██████████| 22/22 [00:06<00:00,  3.54it/s]
2025-03-13 17:24:00,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:00
2025-03-13 17:24:48,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6512 secs
2025-03-13 17:24:48,622 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:24:48,622 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.61it/s]
2025-03-13 17:25:27,694 [INFO]: 	>>> Finished "Compute fast metrics" in 39.0721 secs
2025-03-13 17:25:27,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.9374 secs
2025-03-13 17:25:27,695 [INFO]: {
2025-03-13 17:25:27,695 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:27,695 [INFO]: 	index_param: efSearch=212
2025-03-13 17:25:27,695 [INFO]: 	index_path: knn.index
2025-03-13 17:25:27,695 [INFO]: 	size in bytes: 1010083990
2025-03-13 17:25:27,695 [INFO]: 	avg_search_speed_ms: 10.23653823622105
2025-03-13 17:25:27,695 [INFO]: 	99p_search_speed_ms: 17.31539093889296
2025-03-13 17:25:27,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:27,695 [INFO]: 	nb vectors: 5134
2025-03-13 17:25:27,695 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:27,695 [INFO]: 	compression ratio: 0.9993084555275448
2025-03-13 17:25:27,695 [INFO]: }
2025-03-13 17:25:27,695 [INFO]: 	>>> Finished "Creating the index" in 92.9387 secs
2025-03-13 17:25:27,695 [INFO]: >>> Finished "Launching the whole pipeline" in 92.9638 secs
2025-03-13 17:25:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 80019 [episode count 6/20]
[retrieval_preprocessing] for episode 50858 [episode count 7/20], we have num_retrieval=np.int64(5282) num_query=np.int64(166)
2025-03-13 17:25:31,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:32,414 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:32
2025-03-13 17:25:32,414 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 927.53it/s]
2025-03-13 17:25:32,465 [INFO]: There are 5282 embeddings of dim 49152
2025-03-13 17:25:32,465 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0509 secs
2025-03-13 17:25:32,466 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:32,466 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:25:32,466 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:32,466 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:25:32,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,466 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:32,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:25:32,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:32
2025-03-13 17:25:32,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:32,467 [INFO]: 	Creating the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:32
2025-03-13 17:25:32,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:25:32,469 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,469 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:25:32,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.16it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.76it/s] 50%|█████     | 11/22 [00:00<00:00, 34.63it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.97it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.67it/s]100%|██████████| 22/22 [00:05<00:00,  3.68it/s]
2025-03-13 17:25:38,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:38
2025-03-13 17:26:42,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.2499 secs
2025-03-13 17:26:42,711 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 17:26:42,711 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.69it/s]
2025-03-13 17:27:11,710 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9990 secs
2025-03-13 17:27:11,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.2418 secs
2025-03-13 17:27:11,711 [INFO]: {
2025-03-13 17:27:11,711 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:11,711 [INFO]: 	index_param: efSearch=139
2025-03-13 17:27:11,711 [INFO]: 	index_path: knn.index
2025-03-13 17:27:11,711 [INFO]: 	size in bytes: 1039202290
2025-03-13 17:27:11,711 [INFO]: 	avg_search_speed_ms: 7.878777110131591
2025-03-13 17:27:11,711 [INFO]: 	99p_search_speed_ms: 13.068245826289054
2025-03-13 17:27:11,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:11,711 [INFO]: 	nb vectors: 5282
2025-03-13 17:27:11,711 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:11,711 [INFO]: 	compression ratio: 0.9993082828945652
2025-03-13 17:27:11,711 [INFO]: }
2025-03-13 17:27:11,711 [INFO]: 	>>> Finished "Creating the index" in 99.2445 secs
2025-03-13 17:27:11,711 [INFO]: >>> Finished "Launching the whole pipeline" in 99.2969 secs
2025-03-13 17:27:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 50858 [episode count 7/20]
[retrieval_preprocessing] for episode 88243 [episode count 8/20], we have num_retrieval=np.int64(5166) num_query=np.int64(282)
2025-03-13 17:27:13,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:14,508 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:14
2025-03-13 17:27:14,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 6364.65it/s]
2025-03-13 17:27:15,605 [INFO]: There are 5166 embeddings of dim 49152
2025-03-13 17:27:15,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 1.0973 secs
2025-03-13 17:27:15,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:15
2025-03-13 17:27:15,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:15,607 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:27:15,607 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:15,607 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:27:15,607 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:15
2025-03-13 17:27:15,608 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:15,608 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:27:15,608 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:15
2025-03-13 17:27:15,608 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:15,608 [INFO]: 	Creating the index 03/13/2025, 17:27:15
2025-03-13 17:27:15,608 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:15
2025-03-13 17:27:15,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:27:15,611 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:15
2025-03-13 17:27:15,611 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:27:15,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.64it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.52it/s] 50%|█████     | 11/22 [00:00<00:00, 34.69it/s] 73%|███████▎  | 16/22 [00:00<00:00, 38.60it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.09it/s]100%|██████████| 22/22 [00:05<00:00,  4.22it/s]
2025-03-13 17:27:20,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:20
2025-03-13 17:28:14,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5931 secs
2025-03-13 17:28:14,424 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:28:14,425 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 17:29:05,149 [INFO]: 	>>> Finished "Compute fast metrics" in 50.7246 secs
2025-03-13 17:29:05,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.5395 secs
2025-03-13 17:29:05,151 [INFO]: {
2025-03-13 17:29:05,151 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:05,151 [INFO]: 	index_param: efSearch=164
2025-03-13 17:29:05,151 [INFO]: 	index_path: knn.index
2025-03-13 17:29:05,151 [INFO]: 	size in bytes: 1016379790
2025-03-13 17:29:05,151 [INFO]: 	avg_search_speed_ms: 8.366325243949017
2025-03-13 17:29:05,151 [INFO]: 	99p_search_speed_ms: 14.615980619564645
2025-03-13 17:29:05,151 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:05,151 [INFO]: 	nb vectors: 5166
2025-03-13 17:29:05,151 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:05,151 [INFO]: 	compression ratio: 0.9993084651948855
2025-03-13 17:29:05,151 [INFO]: }
2025-03-13 17:29:05,151 [INFO]: 	>>> Finished "Creating the index" in 109.5426 secs
2025-03-13 17:29:05,151 [INFO]: >>> Finished "Launching the whole pipeline" in 110.6425 secs
2025-03-13 17:29:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 88243 [episode count 8/20]
[retrieval_preprocessing] for episode 48344 [episode count 9/20], we have num_retrieval=np.int64(5152) num_query=np.int64(296)
2025-03-13 17:29:07,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:07,790 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:07
2025-03-13 17:29:07,790 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.58it/s]
2025-03-13 17:29:07,819 [INFO]: There are 5152 embeddings of dim 49152
2025-03-13 17:29:07,819 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 17:29:07,819 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:07
2025-03-13 17:29:07,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:07,820 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:29:07,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:07,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:29:07,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:07
2025-03-13 17:29:07,820 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:07,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:07,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:07
2025-03-13 17:29:07,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:07,820 [INFO]: 	Creating the index 03/13/2025, 17:29:07
2025-03-13 17:29:07,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:07
2025-03-13 17:29:07,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:29:07,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:07
2025-03-13 17:29:07,822 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:29:07,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.32it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.22it/s] 55%|█████▍    | 12/22 [00:00<00:00, 38.14it/s] 77%|███████▋  | 17/22 [00:00<00:00, 40.71it/s]100%|██████████| 22/22 [00:05<00:00,  2.45it/s]100%|██████████| 22/22 [00:05<00:00,  3.88it/s]
2025-03-13 17:29:13,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:13
2025-03-13 17:30:14,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0359 secs
2025-03-13 17:30:14,536 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 17:30:14,536 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-13 17:30:52,272 [INFO]: 	>>> Finished "Compute fast metrics" in 37.7362 secs
2025-03-13 17:30:52,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.4515 secs
2025-03-13 17:30:52,273 [INFO]: {
2025-03-13 17:30:52,273 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:52,273 [INFO]: 	index_param: efSearch=150
2025-03-13 17:30:52,273 [INFO]: 	index_path: knn.index
2025-03-13 17:30:52,273 [INFO]: 	size in bytes: 1013625370
2025-03-13 17:30:52,273 [INFO]: 	avg_search_speed_ms: 9.149059231502957
2025-03-13 17:30:52,273 [INFO]: 	99p_search_speed_ms: 15.61650332994759
2025-03-13 17:30:52,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:52,273 [INFO]: 	nb vectors: 5152
2025-03-13 17:30:52,273 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:52,273 [INFO]: 	compression ratio: 0.9993084683742673
2025-03-13 17:30:52,273 [INFO]: }
2025-03-13 17:30:52,273 [INFO]: 	>>> Finished "Creating the index" in 104.4532 secs
2025-03-13 17:30:52,273 [INFO]: >>> Finished "Launching the whole pipeline" in 104.4833 secs
2025-03-13 17:30:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 48344 [episode count 9/20]
[retrieval_preprocessing] for episode 13549 [episode count 10/20], we have num_retrieval=np.int64(5128) num_query=np.int64(320)
2025-03-13 17:30:54,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:55,347 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:55
2025-03-13 17:30:55,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.14it/s]
2025-03-13 17:30:55,378 [INFO]: There are 5128 embeddings of dim 49152
2025-03-13 17:30:55,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:30:55,379 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:55
2025-03-13 17:30:55,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:55,379 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:30:55,379 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:55,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:30:55,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:55
2025-03-13 17:30:55,379 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:55,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:30:55,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:55
2025-03-13 17:30:55,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:55,379 [INFO]: 	Creating the index 03/13/2025, 17:30:55
2025-03-13 17:30:55,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:55
2025-03-13 17:30:55,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:30:55,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:55
2025-03-13 17:30:55,381 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:30:55,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.41it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.71it/s] 50%|█████     | 11/22 [00:00<00:00, 34.55it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.91it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.74it/s]100%|██████████| 22/22 [00:05<00:00,  3.93it/s]
2025-03-13 17:31:00,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:00
2025-03-13 17:31:52,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3320 secs
2025-03-13 17:31:52,311 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 17:31:52,311 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-13 17:32:21,502 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1911 secs
2025-03-13 17:32:21,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.1224 secs
2025-03-13 17:32:21,503 [INFO]: {
2025-03-13 17:32:21,503 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:21,503 [INFO]: 	index_param: efSearch=193
2025-03-13 17:32:21,503 [INFO]: 	index_path: knn.index
2025-03-13 17:32:21,503 [INFO]: 	size in bytes: 1008903550
2025-03-13 17:32:21,503 [INFO]: 	avg_search_speed_ms: 8.598490736286315
2025-03-13 17:32:21,503 [INFO]: 	99p_search_speed_ms: 11.80078454315662
2025-03-13 17:32:21,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:21,503 [INFO]: 	nb vectors: 5128
2025-03-13 17:32:21,503 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:21,503 [INFO]: 	compression ratio: 0.9993084314154708
2025-03-13 17:32:21,503 [INFO]: }
2025-03-13 17:32:21,503 [INFO]: 	>>> Finished "Creating the index" in 86.1240 secs
2025-03-13 17:32:21,503 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1565 secs
2025-03-13 17:32:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 13549 [episode count 10/20]
[retrieval_preprocessing] for episode 80157 [episode count 11/20], we have num_retrieval=np.int64(5132) num_query=np.int64(316)
2025-03-13 17:32:24,400 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:25,165 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:25
2025-03-13 17:32:25,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 942.96it/s]
2025-03-13 17:32:25,197 [INFO]: There are 5132 embeddings of dim 49152
2025-03-13 17:32:25,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 17:32:25,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:25
2025-03-13 17:32:25,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:25,198 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:32:25,199 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:25,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:32:25,199 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:25
2025-03-13 17:32:25,199 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:25,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:32:25,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:25
2025-03-13 17:32:25,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:25,200 [INFO]: 	Creating the index 03/13/2025, 17:32:25
2025-03-13 17:32:25,200 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:25
2025-03-13 17:32:25,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:32:25,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:25
2025-03-13 17:32:25,203 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:32:25,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.49it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.10it/s] 50%|█████     | 11/22 [00:00<00:00, 38.12it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.64it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.26it/s]100%|██████████| 22/22 [00:04<00:00,  4.51it/s]
2025-03-13 17:32:30,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:30
2025-03-13 17:33:18,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8540 secs
2025-03-13 17:33:18,945 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:33:18,945 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.28it/s]
2025-03-13 17:33:46,653 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7077 secs
2025-03-13 17:33:46,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4507 secs
2025-03-13 17:33:46,654 [INFO]: {
2025-03-13 17:33:46,654 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:46,654 [INFO]: 	index_param: efSearch=156
2025-03-13 17:33:46,654 [INFO]: 	index_path: knn.index
2025-03-13 17:33:46,654 [INFO]: 	size in bytes: 1009690510
2025-03-13 17:33:46,654 [INFO]: 	avg_search_speed_ms: 7.811614781167009
2025-03-13 17:33:46,654 [INFO]: 	99p_search_speed_ms: 11.142758326604964
2025-03-13 17:33:46,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:46,654 [INFO]: 	nb vectors: 5132
2025-03-13 17:33:46,654 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:46,654 [INFO]: 	compression ratio: 0.9993084474964512
2025-03-13 17:33:46,654 [INFO]: }
2025-03-13 17:33:46,654 [INFO]: 	>>> Finished "Creating the index" in 81.4542 secs
2025-03-13 17:33:46,654 [INFO]: >>> Finished "Launching the whole pipeline" in 81.4886 secs
2025-03-13 17:33:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 80157 [episode count 11/20]
[retrieval_preprocessing] for episode 94513 [episode count 12/20], we have num_retrieval=np.int64(5230) num_query=np.int64(218)
2025-03-13 17:33:49,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:50,150 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:50
2025-03-13 17:33:50,150 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.01it/s]
2025-03-13 17:33:50,179 [INFO]: There are 5230 embeddings of dim 49152
2025-03-13 17:33:50,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 17:33:50,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:50
2025-03-13 17:33:50,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:50,179 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:33:50,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:50,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:50,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:50
2025-03-13 17:33:50,179 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:50,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:33:50,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:50
2025-03-13 17:33:50,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:50,180 [INFO]: 	Creating the index 03/13/2025, 17:33:50
2025-03-13 17:33:50,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:50
2025-03-13 17:33:50,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:33:50,180 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:50
2025-03-13 17:33:50,181 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:33:50,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.69it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.04it/s] 50%|█████     | 11/22 [00:00<00:00, 36.60it/s] 73%|███████▎  | 16/22 [00:00<00:00, 40.45it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.02it/s]100%|██████████| 22/22 [00:05<00:00,  4.28it/s]
2025-03-13 17:33:55,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:55
2025-03-13 17:34:39,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0306 secs
2025-03-13 17:34:39,351 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 17:34:39,351 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 17:35:05,453 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1023 secs
2025-03-13 17:35:05,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2733 secs
2025-03-13 17:35:05,454 [INFO]: {
2025-03-13 17:35:05,454 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:05,454 [INFO]: 	index_param: efSearch=127
2025-03-13 17:35:05,454 [INFO]: 	index_path: knn.index
2025-03-13 17:35:05,454 [INFO]: 	size in bytes: 1028971570
2025-03-13 17:35:05,454 [INFO]: 	avg_search_speed_ms: 7.163096373409759
2025-03-13 17:35:05,454 [INFO]: 	99p_search_speed_ms: 15.46341781504452
2025-03-13 17:35:05,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:05,454 [INFO]: 	nb vectors: 5230
2025-03-13 17:35:05,454 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:05,454 [INFO]: 	compression ratio: 0.9993083093636882
2025-03-13 17:35:05,454 [INFO]: }
2025-03-13 17:35:05,454 [INFO]: 	>>> Finished "Creating the index" in 75.2747 secs
2025-03-13 17:35:05,454 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3045 secs
2025-03-13 17:35:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 94513 [episode count 12/20]
[retrieval_preprocessing] for episode 13676 [episode count 13/20], we have num_retrieval=np.int64(5249) num_query=np.int64(199)
2025-03-13 17:35:07,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:09,219 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:09
2025-03-13 17:35:09,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 789.29it/s]
2025-03-13 17:35:09,257 [INFO]: There are 5249 embeddings of dim 49152
2025-03-13 17:35:09,258 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 17:35:09,258 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:09
2025-03-13 17:35:09,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:09,258 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:35:09,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:09,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:35:09,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:09
2025-03-13 17:35:09,259 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:09,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:35:09,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:09
2025-03-13 17:35:09,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:09,260 [INFO]: 	Creating the index 03/13/2025, 17:35:09
2025-03-13 17:35:09,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:09
2025-03-13 17:35:09,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:35:09,264 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:09
2025-03-13 17:35:09,265 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:35:09,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.38it/s] 14%|█▎        | 3/22 [00:00<00:01, 11.42it/s] 27%|██▋       | 6/22 [00:00<00:00, 17.13it/s] 41%|████      | 9/22 [00:00<00:00, 21.01it/s] 55%|█████▍    | 12/22 [00:00<00:00, 23.36it/s] 73%|███████▎  | 16/22 [00:00<00:00, 26.12it/s] 91%|█████████ | 20/22 [00:00<00:00, 28.18it/s]100%|██████████| 22/22 [00:05<00:00,  4.28it/s]
2025-03-13 17:35:14,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:14
2025-03-13 17:36:03,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0782 secs
2025-03-13 17:36:03,495 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:36:03,495 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-13 17:36:38,156 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6610 secs
2025-03-13 17:36:38,157 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.8924 secs
2025-03-13 17:36:38,157 [INFO]: {
2025-03-13 17:36:38,157 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:38,157 [INFO]: 	index_param: efSearch=198
2025-03-13 17:36:38,157 [INFO]: 	index_path: knn.index
2025-03-13 17:36:38,157 [INFO]: 	size in bytes: 1032709810
2025-03-13 17:36:38,157 [INFO]: 	avg_search_speed_ms: 9.09223485484042
2025-03-13 17:36:38,157 [INFO]: 	99p_search_speed_ms: 13.70985220884904
2025-03-13 17:36:38,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:38,157 [INFO]: 	nb vectors: 5249
2025-03-13 17:36:38,157 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:38,157 [INFO]: 	compression ratio: 0.9993082103093414
2025-03-13 17:36:38,157 [INFO]: }
2025-03-13 17:36:38,157 [INFO]: 	>>> Finished "Creating the index" in 88.8968 secs
2025-03-13 17:36:38,157 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9377 secs
2025-03-13 17:36:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 13676 [episode count 13/20]
[retrieval_preprocessing] for episode 58820 [episode count 14/20], we have num_retrieval=np.int64(5081) num_query=np.int64(367)
2025-03-13 17:36:40,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:41,683 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:41
2025-03-13 17:36:41,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.84it/s]
2025-03-13 17:36:41,713 [INFO]: There are 5081 embeddings of dim 49152
2025-03-13 17:36:41,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:36:41,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:41
2025-03-13 17:36:41,714 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:41,714 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:36:41,714 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:41,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:41,714 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:41
2025-03-13 17:36:41,714 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:41,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:41,714 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:41
2025-03-13 17:36:41,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:41,714 [INFO]: 	Creating the index 03/13/2025, 17:36:41
2025-03-13 17:36:41,714 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:41
2025-03-13 17:36:41,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:36:41,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:41
2025-03-13 17:36:41,716 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:36:41,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/21 [00:00<?, ?it/s] 10%|▉         | 2/21 [00:00<00:01, 17.52it/s] 33%|███▎      | 7/21 [00:00<00:00, 34.90it/s] 57%|█████▋    | 12/21 [00:00<00:00, 40.88it/s] 81%|████████  | 17/21 [00:00<00:00, 43.90it/s]100%|██████████| 21/21 [00:04<00:00,  4.66it/s]
2025-03-13 17:36:46,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:46
2025-03-13 17:37:42,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0808 secs
2025-03-13 17:37:42,302 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:37:42,302 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.26it/s]
2025-03-13 17:38:17,325 [INFO]: 	>>> Finished "Compute fast metrics" in 35.0227 secs
2025-03-13 17:38:17,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.6139 secs
2025-03-13 17:38:17,330 [INFO]: {
2025-03-13 17:38:17,330 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:17,330 [INFO]: 	index_param: efSearch=183
2025-03-13 17:38:17,330 [INFO]: 	index_path: knn.index
2025-03-13 17:38:17,330 [INFO]: 	size in bytes: 999656530
2025-03-13 17:38:17,330 [INFO]: 	avg_search_speed_ms: 9.306195789384981
2025-03-13 17:38:17,330 [INFO]: 	99p_search_speed_ms: 14.83867617789656
2025-03-13 17:38:17,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:17,330 [INFO]: 	nb vectors: 5081
2025-03-13 17:38:17,330 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:17,330 [INFO]: 	compression ratio: 0.9993084804837917
2025-03-13 17:38:17,330 [INFO]: }
2025-03-13 17:38:17,330 [INFO]: 	>>> Finished "Creating the index" in 95.6160 secs
2025-03-13 17:38:17,330 [INFO]: >>> Finished "Launching the whole pipeline" in 95.6466 secs
2025-03-13 17:38:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 58820 [episode count 14/20]
[retrieval_preprocessing] for episode 58831 [episode count 15/20], we have num_retrieval=np.int64(4999) num_query=np.int64(449)
2025-03-13 17:38:20,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:21,453 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:21
2025-03-13 17:38:21,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.59it/s]
2025-03-13 17:38:21,487 [INFO]: There are 4999 embeddings of dim 49152
2025-03-13 17:38:21,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 17:38:21,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:21
2025-03-13 17:38:21,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:21,488 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:38:21,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:21,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:21,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:21
2025-03-13 17:38:21,488 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:21,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:38:21,488 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:21
2025-03-13 17:38:21,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:21,488 [INFO]: 	Creating the index 03/13/2025, 17:38:21
2025-03-13 17:38:21,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:21
2025-03-13 17:38:21,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:38:21,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:21
2025-03-13 17:38:21,490 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:38:21,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 16.28it/s] 35%|███▌      | 7/20 [00:00<00:00, 31.48it/s] 60%|██████    | 12/20 [00:00<00:00, 36.93it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.44it/s]100%|██████████| 20/20 [00:03<00:00,  5.19it/s]
2025-03-13 17:38:25,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:25
2025-03-13 17:39:09,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0425 secs
2025-03-13 17:39:09,672 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:39:09,672 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 17:39:36,839 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1672 secs
2025-03-13 17:39:36,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3527 secs
2025-03-13 17:39:36,843 [INFO]: {
2025-03-13 17:39:36,843 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:36,843 [INFO]: 	index_param: efSearch=197
2025-03-13 17:39:36,843 [INFO]: 	index_path: knn.index
2025-03-13 17:39:36,843 [INFO]: 	size in bytes: 983523490
2025-03-13 17:39:36,843 [INFO]: 	avg_search_speed_ms: 9.015698150485566
2025-03-13 17:39:36,843 [INFO]: 	99p_search_speed_ms: 15.398685587570084
2025-03-13 17:39:36,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:36,843 [INFO]: 	nb vectors: 4999
2025-03-13 17:39:36,843 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:36,843 [INFO]: 	compression ratio: 0.9993085086356199
2025-03-13 17:39:36,843 [INFO]: }
2025-03-13 17:39:36,843 [INFO]: 	>>> Finished "Creating the index" in 75.3546 secs
2025-03-13 17:39:36,843 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3901 secs
2025-03-13 17:39:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 58831 [episode count 15/20]
[retrieval_preprocessing] for episode 41425 [episode count 16/20], we have num_retrieval=np.int64(5209) num_query=np.int64(239)
2025-03-13 17:39:40,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:41,362 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:41
2025-03-13 17:39:41,362 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.38it/s]
2025-03-13 17:39:41,412 [INFO]: There are 5209 embeddings of dim 49152
2025-03-13 17:39:41,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0506 secs
2025-03-13 17:39:41,413 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:41
2025-03-13 17:39:41,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:41,414 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:39:41,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:41,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:39:41,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:41
2025-03-13 17:39:41,414 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:41,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:41,414 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:41
2025-03-13 17:39:41,414 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:41,414 [INFO]: 	Creating the index 03/13/2025, 17:39:41
2025-03-13 17:39:41,414 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:41
2025-03-13 17:39:41,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:39:41,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:41
2025-03-13 17:39:41,416 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:39:41,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.98it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.41it/s] 50%|█████     | 11/22 [00:00<00:00, 36.06it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.06it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.18it/s]100%|██████████| 22/22 [00:04<00:00,  4.49it/s]
2025-03-13 17:39:46,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:46
2025-03-13 17:40:28,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6698 secs
2025-03-13 17:40:28,990 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 17:40:28,990 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.67it/s]
2025-03-13 17:40:56,675 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6848 secs
2025-03-13 17:40:56,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2591 secs
2025-03-13 17:40:56,675 [INFO]: {
2025-03-13 17:40:56,675 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:56,675 [INFO]: 	index_param: efSearch=161
2025-03-13 17:40:56,675 [INFO]: 	index_path: knn.index
2025-03-13 17:40:56,675 [INFO]: 	size in bytes: 1024839910
2025-03-13 17:40:56,675 [INFO]: 	avg_search_speed_ms: 8.586317855792815
2025-03-13 17:40:56,675 [INFO]: 	99p_search_speed_ms: 13.392863664776078
2025-03-13 17:40:56,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:56,675 [INFO]: 	nb vectors: 5209
2025-03-13 17:40:56,675 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:56,675 [INFO]: 	compression ratio: 0.9993083427049596
2025-03-13 17:40:56,675 [INFO]: }
2025-03-13 17:40:56,675 [INFO]: 	>>> Finished "Creating the index" in 75.2613 secs
2025-03-13 17:40:56,675 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3133 secs
2025-03-13 17:40:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 41425 [episode count 16/20]
[retrieval_preprocessing] for episode 91099 [episode count 17/20], we have num_retrieval=np.int64(5217) num_query=np.int64(231)
2025-03-13 17:41:01,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:02,258 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:02
2025-03-13 17:41:02,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2113.00it/s]
2025-03-13 17:41:02,283 [INFO]: There are 5217 embeddings of dim 49152
2025-03-13 17:41:02,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:41:02,283 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:02
2025-03-13 17:41:02,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:02,283 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:41:02,283 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:02,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:02,283 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:02
2025-03-13 17:41:02,283 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:02,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:41:02,284 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:02
2025-03-13 17:41:02,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:02,284 [INFO]: 	Creating the index 03/13/2025, 17:41:02
2025-03-13 17:41:02,284 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:02
2025-03-13 17:41:02,285 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:41:02,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:02
2025-03-13 17:41:02,285 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:41:02,285 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.07it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.84it/s] 50%|█████     | 11/22 [00:00<00:00, 36.42it/s] 73%|███████▎  | 16/22 [00:00<00:00, 40.86it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.83it/s]100%|██████████| 22/22 [00:05<00:00,  3.95it/s]
2025-03-13 17:41:07,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:07
2025-03-13 17:42:01,857 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0015 secs
2025-03-13 17:42:01,858 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 17:42:01,858 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 17:42:29,816 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9577 secs
2025-03-13 17:42:29,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5315 secs
2025-03-13 17:42:29,816 [INFO]: {
2025-03-13 17:42:29,816 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:29,816 [INFO]: 	index_param: efSearch=179
2025-03-13 17:42:29,816 [INFO]: 	index_path: knn.index
2025-03-13 17:42:29,816 [INFO]: 	size in bytes: 1026413830
2025-03-13 17:42:29,816 [INFO]: 	avg_search_speed_ms: 8.312029030146148
2025-03-13 17:42:29,816 [INFO]: 	99p_search_speed_ms: 13.52382226381451
2025-03-13 17:42:29,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:29,816 [INFO]: 	nb vectors: 5217
2025-03-13 17:42:29,816 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:29,816 [INFO]: 	compression ratio: 0.9993083744789371
2025-03-13 17:42:29,816 [INFO]: }
2025-03-13 17:42:29,816 [INFO]: 	>>> Finished "Creating the index" in 87.5328 secs
2025-03-13 17:42:29,816 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5585 secs
2025-03-13 17:42:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 91099 [episode count 17/20]
[retrieval_preprocessing] for episode 44019 [episode count 18/20], we have num_retrieval=np.int64(5248) num_query=np.int64(200)
2025-03-13 17:42:31,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:32,781 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:32
2025-03-13 17:42:32,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.35it/s]
2025-03-13 17:42:32,809 [INFO]: There are 5248 embeddings of dim 49152
2025-03-13 17:42:32,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:42:32,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:32
2025-03-13 17:42:32,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:32,810 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 17:42:32,810 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:32,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:42:32,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:32
2025-03-13 17:42:32,810 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:32,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:42:32,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:32
2025-03-13 17:42:32,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:32,810 [INFO]: 	Creating the index 03/13/2025, 17:42:32
2025-03-13 17:42:32,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:32
2025-03-13 17:42:32,811 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:42:32,811 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:32
2025-03-13 17:42:32,811 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 17:42:32,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.79it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.14it/s] 59%|█████▉    | 13/22 [00:00<00:00, 44.71it/s] 86%|████████▋ | 19/22 [00:00<00:00, 49.33it/s]100%|██████████| 22/22 [00:04<00:00,  4.69it/s]
2025-03-13 17:42:37,510 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:37
2025-03-13 17:43:24,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9514 secs
2025-03-13 17:43:24,462 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 17:43:24,462 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.69it/s]
2025-03-13 17:43:55,265 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8030 secs
2025-03-13 17:43:55,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4539 secs
2025-03-13 17:43:55,265 [INFO]: {
2025-03-13 17:43:55,265 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:55,265 [INFO]: 	index_param: efSearch=216
2025-03-13 17:43:55,265 [INFO]: 	index_path: knn.index
2025-03-13 17:43:55,265 [INFO]: 	size in bytes: 1032513010
2025-03-13 17:43:55,265 [INFO]: 	avg_search_speed_ms: 9.382871845623523
2025-03-13 17:43:55,265 [INFO]: 	99p_search_speed_ms: 17.754870501812547
2025-03-13 17:43:55,265 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:55,265 [INFO]: 	nb vectors: 5248
2025-03-13 17:43:55,265 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:55,266 [INFO]: 	compression ratio: 0.9993082644062761
2025-03-13 17:43:55,266 [INFO]: }
2025-03-13 17:43:55,266 [INFO]: 	>>> Finished "Creating the index" in 82.4556 secs
2025-03-13 17:43:55,266 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4845 secs
2025-03-13 17:43:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 44019 [episode count 18/20]
[retrieval_preprocessing] for episode 89484 [episode count 19/20], we have num_retrieval=np.int64(5114) num_query=np.int64(334)
2025-03-13 17:43:57,229 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:57,978 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:57
2025-03-13 17:43:57,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-13 17:43:58,007 [INFO]: There are 5114 embeddings of dim 49152
2025-03-13 17:43:58,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 17:43:58,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:58
2025-03-13 17:43:58,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:58,007 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 17:43:58,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:58,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:58,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:58
2025-03-13 17:43:58,007 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:58,008 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:58,008 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:58
2025-03-13 17:43:58,008 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:58,008 [INFO]: 	Creating the index 03/13/2025, 17:43:58
2025-03-13 17:43:58,008 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:58
2025-03-13 17:43:58,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:43:58,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:58
2025-03-13 17:43:58,009 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:43:58,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.35it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.44it/s] 50%|█████     | 11/22 [00:00<00:00, 38.26it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.10it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.19it/s]100%|██████████| 22/22 [00:04<00:00,  4.62it/s]
2025-03-13 17:44:02,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:02
2025-03-13 17:44:46,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3438 secs
2025-03-13 17:44:46,114 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 17:44:46,114 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 17:45:07,087 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9726 secs
2025-03-13 17:45:07,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3886 secs
2025-03-13 17:45:07,398 [INFO]: {
2025-03-13 17:45:07,398 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:07,398 [INFO]: 	index_param: efSearch=160
2025-03-13 17:45:07,398 [INFO]: 	index_path: knn.index
2025-03-13 17:45:07,398 [INFO]: 	size in bytes: 1006149130
2025-03-13 17:45:07,398 [INFO]: 	avg_search_speed_ms: 10.049734053075612
2025-03-13 17:45:07,398 [INFO]: 	99p_search_speed_ms: 18.492783475667224
2025-03-13 17:45:07,399 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:07,399 [INFO]: 	nb vectors: 5114
2025-03-13 17:45:07,399 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:07,399 [INFO]: 	compression ratio: 0.9993084345260032
2025-03-13 17:45:07,399 [INFO]: }
2025-03-13 17:45:07,399 [INFO]: 	>>> Finished "Creating the index" in 69.3910 secs
2025-03-13 17:45:07,399 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4211 secs
2025-03-13 17:45:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 89484 [episode count 19/20]
2025-03-13 17:45:09: [retrieval_preprocessing] finished for 4142994792_put_spoon_in_mug [chosen_id count 5/196]
2025-03-13 17:45:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4251465834_coffee_machine_press_button [chosen_id count 6/196]
2025-03-13 17:45:11: [retrieval_preprocessing] we have num_total=2314 embedding_dim=49152
[retrieval_preprocessing] for episode 11776 [episode count 0/20], we have num_retrieval=np.int64(2207) num_query=np.int64(107)
2025-03-13 17:45:11,234 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:11,608 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:11
2025-03-13 17:45:11,608 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.22it/s]
2025-03-13 17:45:11,640 [INFO]: There are 2207 embeddings of dim 49152
2025-03-13 17:45:11,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 17:45:11,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:11
2025-03-13 17:45:11,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:11,641 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:45:11,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:11,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:11,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:11
2025-03-13 17:45:11,641 [INFO]: 455.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:11,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:45:11,641 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:11
2025-03-13 17:45:11,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:11,641 [INFO]: 	Creating the index 03/13/2025, 17:45:11
2025-03-13 17:45:11,641 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:11
2025-03-13 17:45:11,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:45:11,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:11
2025-03-13 17:45:11,643 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:45:11,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.91it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.99it/s]100%|██████████| 9/9 [00:01<00:00,  5.88it/s]
2025-03-13 17:45:13,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:13
2025-03-13 17:45:48,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5837 secs
2025-03-13 17:45:48,762 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 17:45:48,762 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 17:46:06,463 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7009 secs
2025-03-13 17:46:06,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8223 secs
2025-03-13 17:46:06,465 [INFO]: {
2025-03-13 17:46:06,465 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:06,465 [INFO]: 	index_param: efSearch=258
2025-03-13 17:46:06,465 [INFO]: 	index_path: knn.index
2025-03-13 17:46:06,465 [INFO]: 	size in bytes: 434213890
2025-03-13 17:46:06,465 [INFO]: 	avg_search_speed_ms: 11.0861664452588
2025-03-13 17:46:06,465 [INFO]: 	99p_search_speed_ms: 21.228649504482746
2025-03-13 17:46:06,465 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:06,465 [INFO]: 	nb vectors: 2207
2025-03-13 17:46:06,465 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:06,465 [INFO]: 	compression ratio: 0.9993090179588682
2025-03-13 17:46:06,465 [INFO]: }
2025-03-13 17:46:06,465 [INFO]: 	>>> Finished "Creating the index" in 54.8238 secs
2025-03-13 17:46:06,465 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8570 secs
2025-03-13 17:46:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 11776 [episode count 0/20]
[retrieval_preprocessing] for episode 75777 [episode count 1/20], we have num_retrieval=np.int64(2092) num_query=np.int64(222)
2025-03-13 17:46:07,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:08,103 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:08
2025-03-13 17:46:08,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2049.00it/s]
2025-03-13 17:46:08,128 [INFO]: There are 2092 embeddings of dim 49152
2025-03-13 17:46:08,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:46:08,129 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:08
2025-03-13 17:46:08,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:08,129 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:46:08,129 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:08,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:46:08,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:08
2025-03-13 17:46:08,129 [INFO]: 431.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:08,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:08,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:08
2025-03-13 17:46:08,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:08,129 [INFO]: 	Creating the index 03/13/2025, 17:46:08
2025-03-13 17:46:08,129 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:08
2025-03-13 17:46:08,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:46:08,130 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:08
2025-03-13 17:46:08,130 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:08,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.87it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.41it/s]100%|██████████| 9/9 [00:01<00:00,  5.95it/s]
2025-03-13 17:46:09,910 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:09
2025-03-13 17:46:39,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3300 secs
2025-03-13 17:46:39,241 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:46:39,241 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 17:46:59,861 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6200 secs
2025-03-13 17:46:59,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8601 secs
2025-03-13 17:46:59,992 [INFO]: {
2025-03-13 17:46:59,992 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:59,992 [INFO]: 	index_param: efSearch=195
2025-03-13 17:46:59,992 [INFO]: 	index_path: knn.index
2025-03-13 17:46:59,992 [INFO]: 	size in bytes: 411588310
2025-03-13 17:46:59,992 [INFO]: 	avg_search_speed_ms: 7.92116031497894
2025-03-13 17:46:59,992 [INFO]: 	99p_search_speed_ms: 14.067973333876582
2025-03-13 17:46:59,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:59,992 [INFO]: 	nb vectors: 2092
2025-03-13 17:46:59,992 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:59,992 [INFO]: 	compression ratio: 0.9993090814459721
2025-03-13 17:46:59,992 [INFO]: }
2025-03-13 17:46:59,992 [INFO]: 	>>> Finished "Creating the index" in 51.8632 secs
2025-03-13 17:46:59,992 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8896 secs
2025-03-13 17:47:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 75777 [episode count 1/20]
[retrieval_preprocessing] for episode 91658 [episode count 2/20], we have num_retrieval=np.int64(2198) num_query=np.int64(116)
2025-03-13 17:47:01,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:02,086 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:02
2025-03-13 17:47:02,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.36it/s]
2025-03-13 17:47:02,118 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 17:47:02,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:47:02,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:02
2025-03-13 17:47:02,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:02,118 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:47:02,118 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:02,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:02,118 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:02
2025-03-13 17:47:02,118 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:02,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:47:02,118 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:02
2025-03-13 17:47:02,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:02,118 [INFO]: 	Creating the index 03/13/2025, 17:47:02
2025-03-13 17:47:02,118 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:02
2025-03-13 17:47:02,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:47:02,120 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:02
2025-03-13 17:47:02,120 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:47:02,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.00it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.58it/s]100%|██████████| 9/9 [00:01<00:00,  5.65it/s]
2025-03-13 17:47:03,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:03
2025-03-13 17:47:34,382 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6676 secs
2025-03-13 17:47:34,382 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 17:47:34,383 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.90it/s]
2025-03-13 17:48:02,684 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3018 secs
2025-03-13 17:48:02,686 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5663 secs
2025-03-13 17:48:02,686 [INFO]: {
2025-03-13 17:48:02,686 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:02,686 [INFO]: 	index_param: efSearch=247
2025-03-13 17:48:02,686 [INFO]: 	index_path: knn.index
2025-03-13 17:48:02,686 [INFO]: 	size in bytes: 432443230
2025-03-13 17:48:02,686 [INFO]: 	avg_search_speed_ms: 8.80174045934683
2025-03-13 17:48:02,686 [INFO]: 	99p_search_speed_ms: 12.159274856094273
2025-03-13 17:48:02,686 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:02,686 [INFO]: 	nb vectors: 2198
2025-03-13 17:48:02,686 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:02,686 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 17:48:02,686 [INFO]: }
2025-03-13 17:48:02,686 [INFO]: 	>>> Finished "Creating the index" in 60.5678 secs
2025-03-13 17:48:02,686 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6000 secs
2025-03-13 17:48:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 91658 [episode count 2/20]
[retrieval_preprocessing] for episode 9747 [episode count 3/20], we have num_retrieval=np.int64(2224) num_query=np.int64(90)
2025-03-13 17:48:10,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:10,416 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:10
2025-03-13 17:48:10,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.12it/s]
2025-03-13 17:48:10,451 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 17:48:10,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 17:48:10,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:10,452 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:48:10,452 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:10,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:48:10,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,452 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:10,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:10,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:10
2025-03-13 17:48:10,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:10,452 [INFO]: 	Creating the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,452 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:10
2025-03-13 17:48:10,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:48:10,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,454 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:48:10,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.90it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.23it/s]100%|██████████| 9/9 [00:01<00:00,  5.95it/s]
2025-03-13 17:48:11,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:11
2025-03-13 17:48:40,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1965 secs
2025-03-13 17:48:40,167 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 17:48:40,167 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.66it/s]
2025-03-13 17:49:01,263 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0956 secs
2025-03-13 17:49:01,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8110 secs
2025-03-13 17:49:01,266 [INFO]: {
2025-03-13 17:49:01,266 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:01,266 [INFO]: 	index_param: efSearch=165
2025-03-13 17:49:01,266 [INFO]: 	index_path: knn.index
2025-03-13 17:49:01,266 [INFO]: 	size in bytes: 437558470
2025-03-13 17:49:01,266 [INFO]: 	avg_search_speed_ms: 9.041508900761187
2025-03-13 17:49:01,266 [INFO]: 	99p_search_speed_ms: 14.205762301571667
2025-03-13 17:49:01,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:01,266 [INFO]: 	nb vectors: 2224
2025-03-13 17:49:01,266 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:01,266 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 17:49:01,266 [INFO]: }
2025-03-13 17:49:01,266 [INFO]: 	>>> Finished "Creating the index" in 50.8137 secs
2025-03-13 17:49:01,266 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8497 secs
2025-03-13 17:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 9747 [episode count 3/20]
[retrieval_preprocessing] for episode 12825 [episode count 4/20], we have num_retrieval=np.int64(2198) num_query=np.int64(116)
2025-03-13 17:49:02,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:02,691 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:02
2025-03-13 17:49:02,692 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1762.31it/s]
2025-03-13 17:49:02,724 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 17:49:02,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 17:49:02,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:02
2025-03-13 17:49:02,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:02,725 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:49:02,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:02,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:49:02,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:02
2025-03-13 17:49:02,725 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:02,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:49:02,726 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:02
2025-03-13 17:49:02,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:02,726 [INFO]: 	Creating the index 03/13/2025, 17:49:02
2025-03-13 17:49:02,726 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:02
2025-03-13 17:49:02,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:49:02,730 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:02
2025-03-13 17:49:02,730 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:49:02,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.47it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.30it/s]100%|██████████| 9/9 [00:01<00:00,  5.01it/s]
2025-03-13 17:49:04,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:04
2025-03-13 17:49:34,216 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6047 secs
2025-03-13 17:49:34,216 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 17:49:34,216 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.49it/s]
2025-03-13 17:49:55,741 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5250 secs
2025-03-13 17:49:55,743 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0128 secs
2025-03-13 17:49:55,743 [INFO]: {
2025-03-13 17:49:55,743 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:55,743 [INFO]: 	index_param: efSearch=274
2025-03-13 17:49:55,743 [INFO]: 	index_path: knn.index
2025-03-13 17:49:55,743 [INFO]: 	size in bytes: 432443230
2025-03-13 17:49:55,743 [INFO]: 	avg_search_speed_ms: 9.302839675571683
2025-03-13 17:49:55,743 [INFO]: 	99p_search_speed_ms: 12.972426041960716
2025-03-13 17:49:55,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:55,743 [INFO]: 	nb vectors: 2198
2025-03-13 17:49:55,743 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:55,743 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 17:49:55,743 [INFO]: }
2025-03-13 17:49:55,743 [INFO]: 	>>> Finished "Creating the index" in 53.0169 secs
2025-03-13 17:49:55,743 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0513 secs
2025-03-13 17:49:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 12825 [episode count 4/20]
[retrieval_preprocessing] for episode 55833 [episode count 5/20], we have num_retrieval=np.int64(2221) num_query=np.int64(93)
2025-03-13 17:49:57,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:57,383 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:57
2025-03-13 17:49:57,383 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.77it/s]
2025-03-13 17:49:57,414 [INFO]: There are 2221 embeddings of dim 49152
2025-03-13 17:49:57,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:49:57,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:57
2025-03-13 17:49:57,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:57,414 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:49:57,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:57,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:57,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:57
2025-03-13 17:49:57,414 [INFO]: 458.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:57,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:57,414 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:57
2025-03-13 17:49:57,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:57,415 [INFO]: 	Creating the index 03/13/2025, 17:49:57
2025-03-13 17:49:57,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:57
2025-03-13 17:49:57,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:49:57,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:57
2025-03-13 17:49:57,416 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:49:57,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.94it/s] 67%|██████▋   | 6/9 [00:00<00:00, 32.61it/s]100%|██████████| 9/9 [00:01<00:00,  5.73it/s]
2025-03-13 17:49:58,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:58
2025-03-13 17:50:21,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6492 secs
2025-03-13 17:50:21,641 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 17:50:21,641 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 17:50:39,963 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3223 secs
2025-03-13 17:50:39,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5499 secs
2025-03-13 17:50:39,966 [INFO]: {
2025-03-13 17:50:39,966 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:39,966 [INFO]: 	index_param: efSearch=238
2025-03-13 17:50:39,966 [INFO]: 	index_path: knn.index
2025-03-13 17:50:39,966 [INFO]: 	size in bytes: 436968250
2025-03-13 17:50:39,966 [INFO]: 	avg_search_speed_ms: 10.488630591186869
2025-03-13 17:50:39,966 [INFO]: 	99p_search_speed_ms: 19.0930595388636
2025-03-13 17:50:39,966 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:39,966 [INFO]: 	nb vectors: 2221
2025-03-13 17:50:39,966 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:39,966 [INFO]: 	compression ratio: 0.9993091443142608
2025-03-13 17:50:39,966 [INFO]: }
2025-03-13 17:50:39,966 [INFO]: 	>>> Finished "Creating the index" in 42.5518 secs
2025-03-13 17:50:39,966 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5835 secs
2025-03-13 17:50:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 55833 [episode count 5/20]
[retrieval_preprocessing] for episode 67122 [episode count 6/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 17:50:41,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:42,365 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:42
2025-03-13 17:50:42,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.56it/s]
2025-03-13 17:50:42,397 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 17:50:42,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 17:50:42,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:42
2025-03-13 17:50:42,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:42,398 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:50:42,398 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:42,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:42,398 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:42
2025-03-13 17:50:42,398 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:42,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:42,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:42
2025-03-13 17:50:42,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:42,398 [INFO]: 	Creating the index 03/13/2025, 17:50:42
2025-03-13 17:50:42,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:42
2025-03-13 17:50:42,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:50:42,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:42
2025-03-13 17:50:42,399 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:50:42,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.83it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.72it/s]100%|██████████| 9/9 [00:02<00:00,  3.62it/s]100%|██████████| 9/9 [00:02<00:00,  4.28it/s]
2025-03-13 17:50:44,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:44
2025-03-13 17:51:12,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6792 secs
2025-03-13 17:51:12,187 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 17:51:12,187 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.46it/s]
2025-03-13 17:51:32,333 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1459 secs
2025-03-13 17:51:32,334 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9350 secs
2025-03-13 17:51:32,335 [INFO]: {
2025-03-13 17:51:32,335 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:32,335 [INFO]: 	index_param: efSearch=302
2025-03-13 17:51:32,335 [INFO]: 	index_path: knn.index
2025-03-13 17:51:32,335 [INFO]: 	size in bytes: 434410630
2025-03-13 17:51:32,335 [INFO]: 	avg_search_speed_ms: 10.987014166497586
2025-03-13 17:51:32,335 [INFO]: 	99p_search_speed_ms: 15.775169269181786
2025-03-13 17:51:32,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:32,335 [INFO]: 	nb vectors: 2208
2025-03-13 17:51:32,335 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:32,335 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 17:51:32,335 [INFO]: }
2025-03-13 17:51:32,335 [INFO]: 	>>> Finished "Creating the index" in 49.9368 secs
2025-03-13 17:51:32,335 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9700 secs
2025-03-13 17:51:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 67122 [episode count 6/20]
[retrieval_preprocessing] for episode 28725 [episode count 7/20], we have num_retrieval=np.int64(2217) num_query=np.int64(97)
2025-03-13 17:51:33,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:33,898 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:33
2025-03-13 17:51:33,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.24it/s]100%|██████████| 1/1 [00:00<00:00,  1.24it/s]
2025-03-13 17:51:34,734 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 17:51:34,735 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.8361 secs
2025-03-13 17:51:34,735 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:34
2025-03-13 17:51:34,735 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:34,735 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:51:34,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:34,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:51:34,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:34
2025-03-13 17:51:34,736 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:34,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:51:34,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:34
2025-03-13 17:51:34,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:34,737 [INFO]: 	Creating the index 03/13/2025, 17:51:34
2025-03-13 17:51:34,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:34
2025-03-13 17:51:34,740 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:51:34,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:34
2025-03-13 17:51:34,740 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:51:34,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.54it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.09it/s]100%|██████████| 9/9 [00:01<00:00,  5.08it/s]
2025-03-13 17:51:36,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:36
2025-03-13 17:52:05,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0138 secs
2025-03-13 17:52:05,532 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 17:52:05,532 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.04it/s]
2025-03-13 17:52:22,871 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3393 secs
2025-03-13 17:52:22,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1334 secs
2025-03-13 17:52:22,874 [INFO]: {
2025-03-13 17:52:22,874 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:22,874 [INFO]: 	index_param: efSearch=286
2025-03-13 17:52:22,874 [INFO]: 	index_path: knn.index
2025-03-13 17:52:22,874 [INFO]: 	size in bytes: 436181290
2025-03-13 17:52:22,874 [INFO]: 	avg_search_speed_ms: 14.301863366604916
2025-03-13 17:52:22,874 [INFO]: 	99p_search_speed_ms: 24.661648580804467
2025-03-13 17:52:22,874 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:22,874 [INFO]: 	nb vectors: 2217
2025-03-13 17:52:22,874 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:22,874 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 17:52:22,874 [INFO]: }
2025-03-13 17:52:22,874 [INFO]: 	>>> Finished "Creating the index" in 48.1374 secs
2025-03-13 17:52:22,874 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9757 secs
2025-03-13 17:52:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 28725 [episode count 7/20]
[retrieval_preprocessing] for episode 12863 [episode count 8/20], we have num_retrieval=np.int64(2220) num_query=np.int64(94)
2025-03-13 17:52:26,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:27,445 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:27
2025-03-13 17:52:27,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-13 17:52:27,477 [INFO]: There are 2220 embeddings of dim 49152
2025-03-13 17:52:27,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:52:27,477 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:27
2025-03-13 17:52:27,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:27,477 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:52:27,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:27,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:27,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:27
2025-03-13 17:52:27,477 [INFO]: 458.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:27,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:27,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:27
2025-03-13 17:52:27,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:27,477 [INFO]: 	Creating the index 03/13/2025, 17:52:27
2025-03-13 17:52:27,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:27
2025-03-13 17:52:27,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:52:27,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:27
2025-03-13 17:52:27,479 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:27,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.78it/s] 44%|████▍     | 4/9 [00:00<00:00, 19.22it/s] 89%|████████▉ | 8/9 [00:00<00:00, 26.03it/s]100%|██████████| 9/9 [00:01<00:00,  5.22it/s]
2025-03-13 17:52:29,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:29
2025-03-13 17:52:57,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4609 secs
2025-03-13 17:52:57,669 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:52:57,670 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.60it/s]
2025-03-13 17:53:16,690 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0204 secs
2025-03-13 17:53:16,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2137 secs
2025-03-13 17:53:16,692 [INFO]: {
2025-03-13 17:53:16,692 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:16,692 [INFO]: 	index_param: efSearch=155
2025-03-13 17:53:16,692 [INFO]: 	index_path: knn.index
2025-03-13 17:53:16,692 [INFO]: 	size in bytes: 436771510
2025-03-13 17:53:16,693 [INFO]: 	avg_search_speed_ms: 8.180010339790885
2025-03-13 17:53:16,693 [INFO]: 	99p_search_speed_ms: 12.887591011822222
2025-03-13 17:53:16,693 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:16,693 [INFO]: 	nb vectors: 2220
2025-03-13 17:53:16,693 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:16,693 [INFO]: 	compression ratio: 0.9993091353417259
2025-03-13 17:53:16,693 [INFO]: }
2025-03-13 17:53:16,693 [INFO]: 	>>> Finished "Creating the index" in 49.2151 secs
2025-03-13 17:53:16,693 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2476 secs
2025-03-13 17:53:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 12863 [episode count 8/20]
[retrieval_preprocessing] for episode 59457 [episode count 9/20], we have num_retrieval=np.int64(2217) num_query=np.int64(97)
2025-03-13 17:53:17,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:18,031 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:18
2025-03-13 17:53:18,031 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 17:53:18,061 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 17:53:18,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:53:18,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:18,062 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:53:18,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:18,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:18,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,062 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:18,062 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:53:18,062 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:18
2025-03-13 17:53:18,062 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:18,062 [INFO]: 	Creating the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,062 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:18
2025-03-13 17:53:18,063 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:53:18,063 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,063 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:53:18,063 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.82it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.13it/s]100%|██████████| 9/9 [00:01<00:00,  4.91it/s]
2025-03-13 17:53:19,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:19
2025-03-13 17:53:44,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4596 secs
2025-03-13 17:53:44,362 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 17:53:44,363 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-13 17:54:07,858 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4953 secs
2025-03-13 17:54:07,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7972 secs
2025-03-13 17:54:07,861 [INFO]: {
2025-03-13 17:54:07,861 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:07,861 [INFO]: 	index_param: efSearch=263
2025-03-13 17:54:07,861 [INFO]: 	index_path: knn.index
2025-03-13 17:54:07,861 [INFO]: 	size in bytes: 436181290
2025-03-13 17:54:07,861 [INFO]: 	avg_search_speed_ms: 10.259225423185107
2025-03-13 17:54:07,861 [INFO]: 	99p_search_speed_ms: 13.65814656484872
2025-03-13 17:54:07,861 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:07,861 [INFO]: 	nb vectors: 2217
2025-03-13 17:54:07,861 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:07,861 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 17:54:07,861 [INFO]: }
2025-03-13 17:54:07,861 [INFO]: 	>>> Finished "Creating the index" in 49.7989 secs
2025-03-13 17:54:07,861 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8300 secs
2025-03-13 17:54:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 59457 [episode count 9/20]
[retrieval_preprocessing] for episode 21070 [episode count 10/20], we have num_retrieval=np.int64(2190) num_query=np.int64(124)
2025-03-13 17:54:09,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:09,631 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:09
2025-03-13 17:54:09,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.68it/s]
2025-03-13 17:54:09,665 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 17:54:09,666 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 17:54:09,666 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:09
2025-03-13 17:54:09,666 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:09,666 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:54:09,666 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:09,666 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:09,666 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:09
2025-03-13 17:54:09,666 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:09,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:54:09,666 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:09
2025-03-13 17:54:09,666 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:09,666 [INFO]: 	Creating the index 03/13/2025, 17:54:09
2025-03-13 17:54:09,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:09
2025-03-13 17:54:09,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:54:09,668 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:09
2025-03-13 17:54:09,668 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:54:09,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.74it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.45it/s]100%|██████████| 9/9 [00:01<00:00,  3.94it/s]100%|██████████| 9/9 [00:01<00:00,  4.62it/s]
2025-03-13 17:54:11,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:11
2025-03-13 17:54:47,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5558 secs
2025-03-13 17:54:47,175 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 17:54:47,175 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 17:55:16,152 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9767 secs
2025-03-13 17:55:16,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4860 secs
2025-03-13 17:55:16,154 [INFO]: {
2025-03-13 17:55:16,154 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:16,154 [INFO]: 	index_param: efSearch=250
2025-03-13 17:55:16,154 [INFO]: 	index_path: knn.index
2025-03-13 17:55:16,154 [INFO]: 	size in bytes: 430869310
2025-03-13 17:55:16,154 [INFO]: 	avg_search_speed_ms: 11.627535083666878
2025-03-13 17:55:16,154 [INFO]: 	99p_search_speed_ms: 22.973586306907237
2025-03-13 17:55:16,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:16,154 [INFO]: 	nb vectors: 2190
2025-03-13 17:55:16,154 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:16,154 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 17:55:16,154 [INFO]: }
2025-03-13 17:55:16,154 [INFO]: 	>>> Finished "Creating the index" in 66.4879 secs
2025-03-13 17:55:16,154 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5232 secs
2025-03-13 17:55:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 21070 [episode count 10/20]
[retrieval_preprocessing] for episode 32351 [episode count 11/20], we have num_retrieval=np.int64(2156) num_query=np.int64(158)
2025-03-13 17:55:17,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:17,858 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:17
2025-03-13 17:55:17,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 17:55:17,890 [INFO]: There are 2156 embeddings of dim 49152
2025-03-13 17:55:17,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 17:55:17,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:17
2025-03-13 17:55:17,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:17,891 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:55:17,891 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:17,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:55:17,891 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:17
2025-03-13 17:55:17,891 [INFO]: 444.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:17,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:55:17,892 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:17
2025-03-13 17:55:17,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:17,892 [INFO]: 	Creating the index 03/13/2025, 17:55:17
2025-03-13 17:55:17,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:17
2025-03-13 17:55:17,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:55:17,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:17
2025-03-13 17:55:17,896 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:55:17,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.88it/s] 67%|██████▋   | 6/9 [00:00<00:00, 27.85it/s]100%|██████████| 9/9 [00:01<00:00,  4.73it/s]100%|██████████| 9/9 [00:01<00:00,  5.90it/s]
2025-03-13 17:55:19,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:19
2025-03-13 17:55:50,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8669 secs
2025-03-13 17:55:50,578 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 17:55:50,578 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.59it/s]
2025-03-13 17:56:12,856 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2779 secs
2025-03-13 17:56:12,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9618 secs
2025-03-13 17:56:12,858 [INFO]: {
2025-03-13 17:56:12,858 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:12,858 [INFO]: 	index_param: efSearch=261
2025-03-13 17:56:12,858 [INFO]: 	index_path: knn.index
2025-03-13 17:56:12,858 [INFO]: 	size in bytes: 424179910
2025-03-13 17:56:12,858 [INFO]: 	avg_search_speed_ms: 10.623895371922636
2025-03-13 17:56:12,858 [INFO]: 	99p_search_speed_ms: 17.429835535585884
2025-03-13 17:56:12,858 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:12,858 [INFO]: 	nb vectors: 2156
2025-03-13 17:56:12,858 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:12,858 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 17:56:12,858 [INFO]: }
2025-03-13 17:56:12,858 [INFO]: 	>>> Finished "Creating the index" in 54.9657 secs
2025-03-13 17:56:12,858 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9996 secs
2025-03-13 17:56:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 32351 [episode count 11/20]
[retrieval_preprocessing] for episode 82536 [episode count 12/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 17:56:14,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:15,070 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:15
2025-03-13 17:56:15,070 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.48it/s]
2025-03-13 17:56:15,101 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 17:56:15,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 17:56:15,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:15
2025-03-13 17:56:15,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:15,102 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:56:15,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:15,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:56:15,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:15
2025-03-13 17:56:15,103 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:15,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:56:15,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:15
2025-03-13 17:56:15,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:15,103 [INFO]: 	Creating the index 03/13/2025, 17:56:15
2025-03-13 17:56:15,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:15
2025-03-13 17:56:15,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:56:15,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:15
2025-03-13 17:56:15,108 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:56:15,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.86it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.50it/s]100%|██████████| 9/9 [00:01<00:00,  5.17it/s]
2025-03-13 17:56:16,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:16
2025-03-13 17:56:47,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2251 secs
2025-03-13 17:56:47,081 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 17:56:47,081 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-13 17:57:13,749 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6680 secs
2025-03-13 17:57:13,750 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6424 secs
2025-03-13 17:57:13,750 [INFO]: {
2025-03-13 17:57:13,750 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:13,750 [INFO]: 	index_param: efSearch=282
2025-03-13 17:57:13,750 [INFO]: 	index_path: knn.index
2025-03-13 17:57:13,750 [INFO]: 	size in bytes: 434410630
2025-03-13 17:57:13,750 [INFO]: 	avg_search_speed_ms: 10.036117586409047
2025-03-13 17:57:13,750 [INFO]: 	99p_search_speed_ms: 14.12516423501074
2025-03-13 17:57:13,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:13,750 [INFO]: 	nb vectors: 2208
2025-03-13 17:57:13,750 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:13,750 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 17:57:13,750 [INFO]: }
2025-03-13 17:57:13,750 [INFO]: 	>>> Finished "Creating the index" in 58.6469 secs
2025-03-13 17:57:13,751 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6808 secs
2025-03-13 17:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 82536 [episode count 12/20]
[retrieval_preprocessing] for episode 10373 [episode count 13/20], we have num_retrieval=np.int64(2222) num_query=np.int64(92)
2025-03-13 17:57:15,355 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:15,666 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:15
2025-03-13 17:57:15,666 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1703.62it/s]
2025-03-13 17:57:15,694 [INFO]: There are 2222 embeddings of dim 49152
2025-03-13 17:57:15,695 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 17:57:15,695 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:15
2025-03-13 17:57:15,695 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:15,695 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:57:15,695 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:15,695 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:57:15,695 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:15
2025-03-13 17:57:15,695 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:15,695 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:15,695 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:15
2025-03-13 17:57:15,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:15,695 [INFO]: 	Creating the index 03/13/2025, 17:57:15
2025-03-13 17:57:15,695 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:15
2025-03-13 17:57:15,696 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:57:15,696 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:15
2025-03-13 17:57:15,696 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:57:15,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.90it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.03it/s]100%|██████████| 9/9 [00:01<00:00,  6.09it/s]
2025-03-13 17:57:17,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:17
2025-03-13 17:57:43,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6784 secs
2025-03-13 17:57:43,856 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:57:43,857 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 17:57:58,826 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9686 secs
2025-03-13 17:57:58,828 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1315 secs
2025-03-13 17:57:58,828 [INFO]: {
2025-03-13 17:57:58,828 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:58,828 [INFO]: 	index_param: efSearch=220
2025-03-13 17:57:58,828 [INFO]: 	index_path: knn.index
2025-03-13 17:57:58,828 [INFO]: 	size in bytes: 437164990
2025-03-13 17:57:58,828 [INFO]: 	avg_search_speed_ms: 11.848608231043963
2025-03-13 17:57:58,828 [INFO]: 	99p_search_speed_ms: 16.866551130078726
2025-03-13 17:57:58,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:58,828 [INFO]: 	nb vectors: 2222
2025-03-13 17:57:58,828 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:58,828 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-13 17:57:58,828 [INFO]: }
2025-03-13 17:57:58,828 [INFO]: 	>>> Finished "Creating the index" in 43.1331 secs
2025-03-13 17:57:58,828 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1622 secs
2025-03-13 17:57:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 10373 [episode count 13/20]
[retrieval_preprocessing] for episode 649 [episode count 14/20], we have num_retrieval=np.int64(2208) num_query=np.int64(106)
2025-03-13 17:57:59,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:00,298 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:00
2025-03-13 17:58:00,299 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 848.88it/s]
2025-03-13 17:58:00,327 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 17:58:00,327 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:58:00,327 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,327 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:00,327 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:58:00,327 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:00,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:00,327 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,328 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:00,328 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:00,328 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:00
2025-03-13 17:58:00,328 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:00,328 [INFO]: 	Creating the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,328 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:00
2025-03-13 17:58:00,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:00,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,329 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:58:00,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.98it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.71it/s]100%|██████████| 9/9 [00:02<00:00,  4.49it/s]
2025-03-13 17:58:02,336 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:02
2025-03-13 17:58:37,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1339 secs
2025-03-13 17:58:37,471 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:58:37,471 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 17:59:00,216 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7445 secs
2025-03-13 17:59:00,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8883 secs
2025-03-13 17:59:00,217 [INFO]: {
2025-03-13 17:59:00,217 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:00,217 [INFO]: 	index_param: efSearch=230
2025-03-13 17:59:00,217 [INFO]: 	index_path: knn.index
2025-03-13 17:59:00,217 [INFO]: 	size in bytes: 434410630
2025-03-13 17:59:00,217 [INFO]: 	avg_search_speed_ms: 9.006769487399373
2025-03-13 17:59:00,217 [INFO]: 	99p_search_speed_ms: 11.674657941330226
2025-03-13 17:59:00,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:00,217 [INFO]: 	nb vectors: 2208
2025-03-13 17:59:00,217 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:00,217 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 17:59:00,217 [INFO]: }
2025-03-13 17:59:00,217 [INFO]: 	>>> Finished "Creating the index" in 59.8897 secs
2025-03-13 17:59:00,217 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9190 secs
2025-03-13 17:59:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 649 [episode count 14/20]
[retrieval_preprocessing] for episode 61577 [episode count 15/20], we have num_retrieval=np.int64(2199) num_query=np.int64(115)
2025-03-13 17:59:01,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:01,805 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:01
2025-03-13 17:59:01,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1797.82it/s]
2025-03-13 17:59:01,834 [INFO]: There are 2199 embeddings of dim 49152
2025-03-13 17:59:01,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 17:59:01,834 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:01
2025-03-13 17:59:01,834 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:01,834 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:59:01,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:01,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:01,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:01
2025-03-13 17:59:01,835 [INFO]: 453.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:01,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:01,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:01
2025-03-13 17:59:01,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:01,835 [INFO]: 	Creating the index 03/13/2025, 17:59:01
2025-03-13 17:59:01,835 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:01
2025-03-13 17:59:01,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:59:01,836 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:01
2025-03-13 17:59:01,836 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:59:01,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.99it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.12it/s]100%|██████████| 9/9 [00:01<00:00,  3.74it/s]100%|██████████| 9/9 [00:01<00:00,  4.59it/s]
2025-03-13 17:59:03,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:03
2025-03-13 17:59:34,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1452 secs
2025-03-13 17:59:34,945 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 17:59:34,945 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-13 18:00:00,282 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3372 secs
2025-03-13 18:00:00,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0875 secs
2025-03-13 18:00:00,924 [INFO]: {
2025-03-13 18:00:00,924 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:00,924 [INFO]: 	index_param: efSearch=255
2025-03-13 18:00:00,924 [INFO]: 	index_path: knn.index
2025-03-13 18:00:00,924 [INFO]: 	size in bytes: 432639970
2025-03-13 18:00:00,924 [INFO]: 	avg_search_speed_ms: 10.208851924578106
2025-03-13 18:00:00,924 [INFO]: 	99p_search_speed_ms: 17.74441697634758
2025-03-13 18:00:00,924 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:00,924 [INFO]: 	nb vectors: 2199
2025-03-13 18:00:00,924 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:00,924 [INFO]: 	compression ratio: 0.999308945033442
2025-03-13 18:00:00,924 [INFO]: }
2025-03-13 18:00:00,924 [INFO]: 	>>> Finished "Creating the index" in 59.0895 secs
2025-03-13 18:00:00,925 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1193 secs
2025-03-13 18:00:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 61577 [episode count 15/20]
[retrieval_preprocessing] for episode 28309 [episode count 16/20], we have num_retrieval=np.int64(2202) num_query=np.int64(112)
2025-03-13 18:00:02,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:03,072 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:03
2025-03-13 18:00:03,072 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.84it/s]
2025-03-13 18:00:03,104 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 18:00:03,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 18:00:03,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:03
2025-03-13 18:00:03,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:03,105 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:00:03,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:03,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:03,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:03
2025-03-13 18:00:03,105 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:03,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:03,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:03
2025-03-13 18:00:03,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:03,105 [INFO]: 	Creating the index 03/13/2025, 18:00:03
2025-03-13 18:00:03,105 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:03
2025-03-13 18:00:03,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:03,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:03
2025-03-13 18:00:03,106 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:00:03,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.86it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.99it/s]100%|██████████| 9/9 [00:01<00:00,  4.56it/s]100%|██████████| 9/9 [00:01<00:00,  5.34it/s]
2025-03-13 18:00:04,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:04
2025-03-13 18:00:34,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4366 secs
2025-03-13 18:00:34,232 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:00:34,232 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 18:00:46,724 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4920 secs
2025-03-13 18:00:46,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6201 secs
2025-03-13 18:00:46,727 [INFO]: {
2025-03-13 18:00:46,727 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:46,727 [INFO]: 	index_param: efSearch=196
2025-03-13 18:00:46,727 [INFO]: 	index_path: knn.index
2025-03-13 18:00:46,727 [INFO]: 	size in bytes: 433230190
2025-03-13 18:00:46,727 [INFO]: 	avg_search_speed_ms: 8.642045404023728
2025-03-13 18:00:46,727 [INFO]: 	99p_search_speed_ms: 13.127604755572978
2025-03-13 18:00:46,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:46,727 [INFO]: 	nb vectors: 2202
2025-03-13 18:00:46,727 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:46,727 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 18:00:46,727 [INFO]: }
2025-03-13 18:00:46,727 [INFO]: 	>>> Finished "Creating the index" in 43.6216 secs
2025-03-13 18:00:46,727 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6548 secs
2025-03-13 18:00:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 28309 [episode count 16/20]
[retrieval_preprocessing] for episode 75928 [episode count 17/20], we have num_retrieval=np.int64(2161) num_query=np.int64(153)
2025-03-13 18:00:47,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:48,118 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:48
2025-03-13 18:00:48,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1342.18it/s]
2025-03-13 18:00:48,147 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 18:00:48,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:00:48,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:48,147 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:00:48,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:48,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:48,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,147 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:48,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:48,147 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:48
2025-03-13 18:00:48,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:48,147 [INFO]: 	Creating the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,147 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:48
2025-03-13 18:00:48,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:00:48,148 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,148 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:00:48,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.94it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.73it/s]100%|██████████| 9/9 [00:01<00:00,  4.45it/s]100%|██████████| 9/9 [00:01<00:00,  5.43it/s]
2025-03-13 18:00:49,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:49
2025-03-13 18:01:15,685 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8751 secs
2025-03-13 18:01:15,686 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 18:01:15,686 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-13 18:01:38,076 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3906 secs
2025-03-13 18:01:38,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9295 secs
2025-03-13 18:01:38,078 [INFO]: {
2025-03-13 18:01:38,078 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:38,078 [INFO]: 	index_param: efSearch=252
2025-03-13 18:01:38,078 [INFO]: 	index_path: knn.index
2025-03-13 18:01:38,078 [INFO]: 	size in bytes: 425163610
2025-03-13 18:01:38,078 [INFO]: 	avg_search_speed_ms: 10.406826343193542
2025-03-13 18:01:38,078 [INFO]: 	99p_search_speed_ms: 15.277787158265708
2025-03-13 18:01:38,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:38,078 [INFO]: 	nb vectors: 2161
2025-03-13 18:01:38,078 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:38,078 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 18:01:38,078 [INFO]: }
2025-03-13 18:01:38,078 [INFO]: 	>>> Finished "Creating the index" in 49.9308 secs
2025-03-13 18:01:38,078 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9597 secs
2025-03-13 18:01:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 75928 [episode count 17/20]
[retrieval_preprocessing] for episode 66735 [episode count 18/20], we have num_retrieval=np.int64(2204) num_query=np.int64(110)
2025-03-13 18:01:39,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:40,185 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:40
2025-03-13 18:01:40,185 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.16it/s]
2025-03-13 18:01:40,218 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 18:01:40,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 18:01:40,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:40
2025-03-13 18:01:40,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:40,218 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:01:40,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:40,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:40,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:40
2025-03-13 18:01:40,218 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:40,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:01:40,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:40
2025-03-13 18:01:40,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:40,219 [INFO]: 	Creating the index 03/13/2025, 18:01:40
2025-03-13 18:01:40,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:40
2025-03-13 18:01:40,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:01:40,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:40
2025-03-13 18:01:40,220 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:01:40,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.06it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.33it/s]100%|██████████| 9/9 [00:02<00:00,  3.61it/s]100%|██████████| 9/9 [00:02<00:00,  4.25it/s]
2025-03-13 18:01:42,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:42
2025-03-13 18:02:12,640 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2993 secs
2025-03-13 18:02:12,640 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 18:02:12,640 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 18:02:32,413 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7730 secs
2025-03-13 18:02:32,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1950 secs
2025-03-13 18:02:32,415 [INFO]: {
2025-03-13 18:02:32,415 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:32,415 [INFO]: 	index_param: efSearch=259
2025-03-13 18:02:32,415 [INFO]: 	index_path: knn.index
2025-03-13 18:02:32,415 [INFO]: 	size in bytes: 433623670
2025-03-13 18:02:32,415 [INFO]: 	avg_search_speed_ms: 9.811759552113179
2025-03-13 18:02:32,415 [INFO]: 	99p_search_speed_ms: 14.246959509328006
2025-03-13 18:02:32,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:32,415 [INFO]: 	nb vectors: 2204
2025-03-13 18:02:32,415 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:32,415 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 18:02:32,415 [INFO]: }
2025-03-13 18:02:32,415 [INFO]: 	>>> Finished "Creating the index" in 52.1966 secs
2025-03-13 18:02:32,415 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2307 secs
2025-03-13 18:02:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 66735 [episode count 18/20]
[retrieval_preprocessing] for episode 65210 [episode count 19/20], we have num_retrieval=np.int64(2214) num_query=np.int64(100)
2025-03-13 18:02:33,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:34,298 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:34
2025-03-13 18:02:34,298 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.00it/s]
2025-03-13 18:02:34,326 [INFO]: There are 2214 embeddings of dim 49152
2025-03-13 18:02:34,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:02:34,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:34
2025-03-13 18:02:34,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:34,326 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:02:34,326 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:34,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:34,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:34
2025-03-13 18:02:34,326 [INFO]: 456.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:34,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:02:34,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:34
2025-03-13 18:02:34,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:34,326 [INFO]: 	Creating the index 03/13/2025, 18:02:34
2025-03-13 18:02:34,327 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:34
2025-03-13 18:02:34,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:02:34,328 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:34
2025-03-13 18:02:34,328 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:02:34,328 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.94it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.72it/s]100%|██████████| 9/9 [00:01<00:00,  4.61it/s]
2025-03-13 18:02:36,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:36
2025-03-13 18:03:04,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3731 secs
2025-03-13 18:03:04,656 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:03:04,656 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 18:03:19,865 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2090 secs
2025-03-13 18:03:19,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5396 secs
2025-03-13 18:03:19,868 [INFO]: {
2025-03-13 18:03:19,868 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:19,868 [INFO]: 	index_param: efSearch=174
2025-03-13 18:03:19,868 [INFO]: 	index_path: knn.index
2025-03-13 18:03:19,868 [INFO]: 	size in bytes: 435591070
2025-03-13 18:03:19,868 [INFO]: 	avg_search_speed_ms: 10.351323059617346
2025-03-13 18:03:19,868 [INFO]: 	99p_search_speed_ms: 17.074709071312103
2025-03-13 18:03:19,868 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:19,868 [INFO]: 	nb vectors: 2214
2025-03-13 18:03:19,868 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:19,868 [INFO]: 	compression ratio: 0.9993090813363094
2025-03-13 18:03:19,868 [INFO]: }
2025-03-13 18:03:19,868 [INFO]: 	>>> Finished "Creating the index" in 45.5414 secs
2025-03-13 18:03:19,868 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5702 secs
2025-03-13 18:03:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 65210 [episode count 19/20]
2025-03-13 18:03:21: [retrieval_preprocessing] finished for 4251465834_coffee_machine_press_button [chosen_id count 6/196]
2025-03-13 18:03:22: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4329524892_put_cup_in_bowl [chosen_id count 7/196]
2025-03-13 18:03:22: [retrieval_preprocessing] we have num_total=2289 embedding_dim=49152
[retrieval_preprocessing] for episode 8707 [episode count 0/20], we have num_retrieval=np.int64(2134) num_query=np.int64(155)
2025-03-13 18:03:22,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:22,611 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:22
2025-03-13 18:03:22,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1859.18it/s]
2025-03-13 18:03:22,641 [INFO]: There are 2134 embeddings of dim 49152
2025-03-13 18:03:22,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:03:22,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:22
2025-03-13 18:03:22,642 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:22,642 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:03:22,642 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:22,642 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:22,642 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:22
2025-03-13 18:03:22,642 [INFO]: 440.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:22,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:03:22,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:22
2025-03-13 18:03:22,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:22,642 [INFO]: 	Creating the index 03/13/2025, 18:03:22
2025-03-13 18:03:22,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:22
2025-03-13 18:03:22,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:03:22,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:22
2025-03-13 18:03:22,643 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:03:22,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.11it/s] 44%|████▍     | 4/9 [00:00<00:00, 18.42it/s] 78%|███████▊  | 7/9 [00:00<00:00, 22.40it/s]100%|██████████| 9/9 [00:02<00:00,  4.06it/s]
2025-03-13 18:03:24,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:24
2025-03-13 18:03:51,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4474 secs
2025-03-13 18:03:51,310 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 18:03:51,310 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 18:04:12,754 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4434 secs
2025-03-13 18:04:12,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1120 secs
2025-03-13 18:04:12,755 [INFO]: {
2025-03-13 18:04:12,755 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:12,755 [INFO]: 	index_param: efSearch=277
2025-03-13 18:04:12,755 [INFO]: 	index_path: knn.index
2025-03-13 18:04:12,755 [INFO]: 	size in bytes: 419851510
2025-03-13 18:04:12,755 [INFO]: 	avg_search_speed_ms: 12.04684951724148
2025-03-13 18:04:12,755 [INFO]: 	99p_search_speed_ms: 19.324263483285907
2025-03-13 18:04:12,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:12,755 [INFO]: 	nb vectors: 2134
2025-03-13 18:04:12,755 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:12,755 [INFO]: 	compression ratio: 0.999309189098784
2025-03-13 18:04:12,755 [INFO]: }
2025-03-13 18:04:12,755 [INFO]: 	>>> Finished "Creating the index" in 50.1134 secs
2025-03-13 18:04:12,755 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1447 secs
2025-03-13 18:04:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 8707 [episode count 0/20]
[retrieval_preprocessing] for episode 90627 [episode count 1/20], we have num_retrieval=np.int64(2183) num_query=np.int64(106)
2025-03-13 18:04:14,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:14,974 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:14
2025-03-13 18:04:14,974 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-13 18:04:15,013 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 18:04:15,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0389 secs
2025-03-13 18:04:15,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:15
2025-03-13 18:04:15,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:15,014 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:04:15,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:15,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:04:15,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:15
2025-03-13 18:04:15,015 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:15,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:04:15,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:15
2025-03-13 18:04:15,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:15,016 [INFO]: 	Creating the index 03/13/2025, 18:04:15
2025-03-13 18:04:15,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:15
2025-03-13 18:04:15,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:04:15,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:15
2025-03-13 18:04:15,019 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:04:15,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.82it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.97it/s]100%|██████████| 9/9 [00:01<00:00,  5.27it/s]
2025-03-13 18:04:16,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:16
2025-03-13 18:04:53,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3797 secs
2025-03-13 18:04:53,112 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:04:53,112 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 18:05:19,662 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5503 secs
2025-03-13 18:05:19,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6447 secs
2025-03-13 18:05:19,664 [INFO]: {
2025-03-13 18:05:19,664 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:19,664 [INFO]: 	index_param: efSearch=201
2025-03-13 18:05:19,664 [INFO]: 	index_path: knn.index
2025-03-13 18:05:19,664 [INFO]: 	size in bytes: 429492010
2025-03-13 18:05:19,664 [INFO]: 	avg_search_speed_ms: 8.686963547883696
2025-03-13 18:05:19,664 [INFO]: 	99p_search_speed_ms: 12.765594990924
2025-03-13 18:05:19,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:19,664 [INFO]: 	nb vectors: 2183
2025-03-13 18:05:19,664 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:19,664 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 18:05:19,664 [INFO]: }
2025-03-13 18:05:19,664 [INFO]: 	>>> Finished "Creating the index" in 64.6484 secs
2025-03-13 18:05:19,664 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6897 secs
2025-03-13 18:05:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 90627 [episode count 1/20]
[retrieval_preprocessing] for episode 72197 [episode count 2/20], we have num_retrieval=np.int64(2184) num_query=np.int64(105)
2025-03-13 18:05:20,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:20,965 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:20
2025-03-13 18:05:20,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1795.51it/s]
2025-03-13 18:05:20,992 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 18:05:20,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:05:20,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:20
2025-03-13 18:05:20,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:20,993 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:05:20,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:20,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:05:20,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:20
2025-03-13 18:05:20,993 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:20,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:05:20,993 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:20
2025-03-13 18:05:20,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:20,993 [INFO]: 	Creating the index 03/13/2025, 18:05:20
2025-03-13 18:05:20,993 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:20
2025-03-13 18:05:20,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:05:20,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:20
2025-03-13 18:05:20,994 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:05:20,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.35it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.08it/s]100%|██████████| 9/9 [00:01<00:00,  4.82it/s]
2025-03-13 18:05:22,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:22
2025-03-13 18:05:56,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2377 secs
2025-03-13 18:05:56,103 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:05:56,103 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.94it/s]
2025-03-13 18:06:18,795 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6911 secs
2025-03-13 18:06:19,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2783 secs
2025-03-13 18:06:19,273 [INFO]: {
2025-03-13 18:06:19,273 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:19,273 [INFO]: 	index_param: efSearch=256
2025-03-13 18:06:19,273 [INFO]: 	index_path: knn.index
2025-03-13 18:06:19,273 [INFO]: 	size in bytes: 429688750
2025-03-13 18:06:19,273 [INFO]: 	avg_search_speed_ms: 11.381270425644225
2025-03-13 18:06:19,273 [INFO]: 	99p_search_speed_ms: 19.798179655335844
2025-03-13 18:06:19,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:19,273 [INFO]: 	nb vectors: 2184
2025-03-13 18:06:19,274 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:19,274 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 18:06:19,274 [INFO]: }
2025-03-13 18:06:19,274 [INFO]: 	>>> Finished "Creating the index" in 58.2805 secs
2025-03-13 18:06:19,274 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3089 secs
2025-03-13 18:06:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 72197 [episode count 2/20]
[retrieval_preprocessing] for episode 48152 [episode count 3/20], we have num_retrieval=np.int64(2177) num_query=np.int64(112)
2025-03-13 18:06:20,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:21,148 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:21
2025-03-13 18:06:21,148 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.97it/s]
2025-03-13 18:06:21,182 [INFO]: There are 2177 embeddings of dim 49152
2025-03-13 18:06:21,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 18:06:21,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:21,182 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:06:21,182 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:21,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:21,182 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,183 [INFO]: 449.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:21,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:06:21,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:21
2025-03-13 18:06:21,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:21,183 [INFO]: 	Creating the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:21
2025-03-13 18:06:21,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:06:21,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,184 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:06:21,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.22it/s] 44%|████▍     | 4/9 [00:00<00:00, 16.98it/s] 89%|████████▉ | 8/9 [00:00<00:00, 23.97it/s]100%|██████████| 9/9 [00:01<00:00,  4.51it/s]
2025-03-13 18:06:23,183 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:23
2025-03-13 18:06:56,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7309 secs
2025-03-13 18:06:56,915 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:06:56,915 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.97it/s]
2025-03-13 18:07:10,834 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9187 secs
2025-03-13 18:07:10,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6515 secs
2025-03-13 18:07:10,836 [INFO]: {
2025-03-13 18:07:10,836 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:10,836 [INFO]: 	index_param: efSearch=240
2025-03-13 18:07:10,836 [INFO]: 	index_path: knn.index
2025-03-13 18:07:10,836 [INFO]: 	size in bytes: 428311570
2025-03-13 18:07:10,836 [INFO]: 	avg_search_speed_ms: 13.49759598573049
2025-03-13 18:07:10,836 [INFO]: 	99p_search_speed_ms: 22.53914000466466
2025-03-13 18:07:10,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:10,836 [INFO]: 	nb vectors: 2177
2025-03-13 18:07:10,836 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:10,836 [INFO]: 	compression ratio: 0.9993090217011882
2025-03-13 18:07:10,836 [INFO]: }
2025-03-13 18:07:10,836 [INFO]: 	>>> Finished "Creating the index" in 49.6531 secs
2025-03-13 18:07:10,836 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6882 secs
2025-03-13 18:07:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 48152 [episode count 3/20]
[retrieval_preprocessing] for episode 55324 [episode count 4/20], we have num_retrieval=np.int64(2190) num_query=np.int64(99)
2025-03-13 18:07:12,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:12,613 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:12
2025-03-13 18:07:12,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1995.39it/s]
2025-03-13 18:07:12,644 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 18:07:12,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 18:07:12,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:12
2025-03-13 18:07:12,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:12,645 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:07:12,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:12,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:12,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:12
2025-03-13 18:07:12,645 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:12,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:12,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:12
2025-03-13 18:07:12,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:12,645 [INFO]: 	Creating the index 03/13/2025, 18:07:12
2025-03-13 18:07:12,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:12
2025-03-13 18:07:12,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:07:12,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:12
2025-03-13 18:07:12,646 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:07:12,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.89it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.66it/s]100%|██████████| 9/9 [00:01<00:00,  4.07it/s]100%|██████████| 9/9 [00:01<00:00,  4.99it/s]
2025-03-13 18:07:14,454 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:14
2025-03-13 18:07:47,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7523 secs
2025-03-13 18:07:47,206 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:07:47,206 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 18:08:11,320 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1137 secs
2025-03-13 18:08:11,326 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6792 secs
2025-03-13 18:08:11,326 [INFO]: {
2025-03-13 18:08:11,326 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:11,326 [INFO]: 	index_param: efSearch=211
2025-03-13 18:08:11,326 [INFO]: 	index_path: knn.index
2025-03-13 18:08:11,326 [INFO]: 	size in bytes: 430869310
2025-03-13 18:08:11,326 [INFO]: 	avg_search_speed_ms: 9.194217144848903
2025-03-13 18:08:11,326 [INFO]: 	99p_search_speed_ms: 13.556391727179287
2025-03-13 18:08:11,326 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:11,326 [INFO]: 	nb vectors: 2190
2025-03-13 18:08:11,326 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:11,326 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 18:08:11,326 [INFO]: }
2025-03-13 18:08:11,326 [INFO]: 	>>> Finished "Creating the index" in 58.6808 secs
2025-03-13 18:08:11,326 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7125 secs
2025-03-13 18:08:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 55324 [episode count 4/20]
[retrieval_preprocessing] for episode 87069 [episode count 5/20], we have num_retrieval=np.int64(2204) num_query=np.int64(85)
2025-03-13 18:08:13,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:13,421 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:13
2025-03-13 18:08:13,421 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.98it/s]
2025-03-13 18:08:13,450 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 18:08:13,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:08:13,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:13
2025-03-13 18:08:13,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:13,451 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:08:13,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:13,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:08:13,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:13
2025-03-13 18:08:13,451 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:13,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:13,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:13
2025-03-13 18:08:13,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:13,451 [INFO]: 	Creating the index 03/13/2025, 18:08:13
2025-03-13 18:08:13,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:13
2025-03-13 18:08:13,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:08:13,453 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:13
2025-03-13 18:08:13,453 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:08:13,453 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.66it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.56it/s]100%|██████████| 9/9 [00:02<00:00,  4.37it/s]
2025-03-13 18:08:15,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:15
2025-03-13 18:08:49,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7144 secs
2025-03-13 18:08:49,230 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:08:49,230 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 18:09:10,977 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7479 secs
2025-03-13 18:09:10,979 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5263 secs
2025-03-13 18:09:10,979 [INFO]: {
2025-03-13 18:09:10,979 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:10,979 [INFO]: 	index_param: efSearch=261
2025-03-13 18:09:10,979 [INFO]: 	index_path: knn.index
2025-03-13 18:09:10,979 [INFO]: 	size in bytes: 433623670
2025-03-13 18:09:10,979 [INFO]: 	avg_search_speed_ms: 11.14094466539328
2025-03-13 18:09:10,979 [INFO]: 	99p_search_speed_ms: 15.545571893453594
2025-03-13 18:09:10,979 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:10,979 [INFO]: 	nb vectors: 2204
2025-03-13 18:09:10,979 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:10,979 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 18:09:10,979 [INFO]: }
2025-03-13 18:09:10,979 [INFO]: 	>>> Finished "Creating the index" in 57.5280 secs
2025-03-13 18:09:10,979 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5585 secs
2025-03-13 18:09:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 87069 [episode count 5/20]
[retrieval_preprocessing] for episode 27178 [episode count 6/20], we have num_retrieval=np.int64(2198) num_query=np.int64(91)
2025-03-13 18:09:12,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:12,463 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:12
2025-03-13 18:09:12,463 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2016.49it/s]
2025-03-13 18:09:12,488 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 18:09:12,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:09:12,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:12
2025-03-13 18:09:12,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:12,488 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:09:12,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:12,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:12,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:12
2025-03-13 18:09:12,488 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:12,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:09:12,488 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:12
2025-03-13 18:09:12,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:12,489 [INFO]: 	Creating the index 03/13/2025, 18:09:12
2025-03-13 18:09:12,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:12
2025-03-13 18:09:12,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:09:12,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:12
2025-03-13 18:09:12,490 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:09:12,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.34it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.81it/s]100%|██████████| 9/9 [00:01<00:00,  4.21it/s]100%|██████████| 9/9 [00:01<00:00,  5.13it/s]
2025-03-13 18:09:14,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:14
2025-03-13 18:09:43,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3271 secs
2025-03-13 18:09:43,577 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:09:43,577 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:10:02,199 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6222 secs
2025-03-13 18:10:02,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0401 secs
2025-03-13 18:10:02,530 [INFO]: {
2025-03-13 18:10:02,530 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:02,530 [INFO]: 	index_param: efSearch=236
2025-03-13 18:10:02,530 [INFO]: 	index_path: knn.index
2025-03-13 18:10:02,530 [INFO]: 	size in bytes: 432443230
2025-03-13 18:10:02,531 [INFO]: 	avg_search_speed_ms: 13.641548693042864
2025-03-13 18:10:02,531 [INFO]: 	99p_search_speed_ms: 22.513623367995017
2025-03-13 18:10:02,531 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:02,531 [INFO]: 	nb vectors: 2198
2025-03-13 18:10:02,531 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:02,531 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 18:10:02,531 [INFO]: }
2025-03-13 18:10:02,531 [INFO]: 	>>> Finished "Creating the index" in 50.0424 secs
2025-03-13 18:10:02,531 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0683 secs
2025-03-13 18:10:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 27178 [episode count 6/20]
[retrieval_preprocessing] for episode 28214 [episode count 7/20], we have num_retrieval=np.int64(2173) num_query=np.int64(116)
2025-03-13 18:10:04,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:04,475 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:04
2025-03-13 18:10:04,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.82it/s]
2025-03-13 18:10:04,508 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 18:10:04,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 18:10:04,508 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:04
2025-03-13 18:10:04,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:04,508 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:10:04,508 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:04,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:04,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:04
2025-03-13 18:10:04,509 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:04,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:10:04,509 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:04
2025-03-13 18:10:04,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:04,509 [INFO]: 	Creating the index 03/13/2025, 18:10:04
2025-03-13 18:10:04,509 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:04
2025-03-13 18:10:04,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:10:04,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:04
2025-03-13 18:10:04,510 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:10:04,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.82it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.45it/s]100%|██████████| 9/9 [00:02<00:00,  3.30it/s]100%|██████████| 9/9 [00:02<00:00,  3.91it/s]
2025-03-13 18:10:06,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:06
2025-03-13 18:10:43,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8603 secs
2025-03-13 18:10:43,676 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:10:43,676 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 18:11:01,638 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9616 secs
2025-03-13 18:11:01,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1299 secs
2025-03-13 18:11:01,640 [INFO]: {
2025-03-13 18:11:01,640 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:01,640 [INFO]: 	index_param: efSearch=236
2025-03-13 18:11:01,640 [INFO]: 	index_path: knn.index
2025-03-13 18:11:01,640 [INFO]: 	size in bytes: 427524550
2025-03-13 18:11:01,640 [INFO]: 	avg_search_speed_ms: 11.078458947180085
2025-03-13 18:11:01,640 [INFO]: 	99p_search_speed_ms: 16.698843236081302
2025-03-13 18:11:01,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:01,640 [INFO]: 	nb vectors: 2173
2025-03-13 18:11:01,640 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:01,640 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 18:11:01,640 [INFO]: }
2025-03-13 18:11:01,640 [INFO]: 	>>> Finished "Creating the index" in 57.1314 secs
2025-03-13 18:11:01,640 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1645 secs
2025-03-13 18:11:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 28214 [episode count 7/20]
[retrieval_preprocessing] for episode 63547 [episode count 8/20], we have num_retrieval=np.int64(2204) num_query=np.int64(85)
2025-03-13 18:11:03,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:03,475 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:03
2025-03-13 18:11:03,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1100.29it/s]
2025-03-13 18:11:04,148 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 18:11:04,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6731 secs
2025-03-13 18:11:04,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:04
2025-03-13 18:11:04,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:04,149 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:11:04,149 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:04,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:11:04,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:04
2025-03-13 18:11:04,149 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:04,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:11:04,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:04
2025-03-13 18:11:04,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:04,150 [INFO]: 	Creating the index 03/13/2025, 18:11:04
2025-03-13 18:11:04,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:04
2025-03-13 18:11:04,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:11:04,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:04
2025-03-13 18:11:04,153 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:11:04,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.97it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.26it/s]100%|██████████| 9/9 [00:01<00:00,  5.00it/s]
2025-03-13 18:11:05,961 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:05
2025-03-13 18:11:36,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7278 secs
2025-03-13 18:11:36,689 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 18:11:36,689 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.32it/s]
2025-03-13 18:12:01,059 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3700 secs
2025-03-13 18:12:01,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9083 secs
2025-03-13 18:12:01,062 [INFO]: {
2025-03-13 18:12:01,062 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:01,062 [INFO]: 	index_param: efSearch=287
2025-03-13 18:12:01,062 [INFO]: 	index_path: knn.index
2025-03-13 18:12:01,062 [INFO]: 	size in bytes: 433623670
2025-03-13 18:12:01,062 [INFO]: 	avg_search_speed_ms: 11.749265156795744
2025-03-13 18:12:01,062 [INFO]: 	99p_search_speed_ms: 17.483665491454303
2025-03-13 18:12:01,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:01,062 [INFO]: 	nb vectors: 2204
2025-03-13 18:12:01,062 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:01,062 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 18:12:01,062 [INFO]: }
2025-03-13 18:12:01,062 [INFO]: 	>>> Finished "Creating the index" in 56.9118 secs
2025-03-13 18:12:01,062 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5870 secs
2025-03-13 18:12:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 63547 [episode count 8/20]
[retrieval_preprocessing] for episode 70721 [episode count 9/20], we have num_retrieval=np.int64(2151) num_query=np.int64(138)
2025-03-13 18:12:02,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:03,157 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:03
2025-03-13 18:12:03,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-13 18:12:03,197 [INFO]: There are 2151 embeddings of dim 49152
2025-03-13 18:12:03,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0398 secs
2025-03-13 18:12:03,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:03
2025-03-13 18:12:03,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:03,197 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:12:03,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:03,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:03,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:03
2025-03-13 18:12:03,198 [INFO]: 443.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:03,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:12:03,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:03
2025-03-13 18:12:03,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:03,198 [INFO]: 	Creating the index 03/13/2025, 18:12:03
2025-03-13 18:12:03,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:03
2025-03-13 18:12:03,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:12:03,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:03
2025-03-13 18:12:03,200 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:12:03,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.91it/s] 56%|█████▌    | 5/9 [00:00<00:00, 20.47it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]100%|██████████| 9/9 [00:02<00:00,  4.17it/s]
2025-03-13 18:12:05,361 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:05
2025-03-13 18:12:35,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3174 secs
2025-03-13 18:12:35,679 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 18:12:35,679 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s]
2025-03-13 18:12:55,766 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0873 secs
2025-03-13 18:12:55,769 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5694 secs
2025-03-13 18:12:55,769 [INFO]: {
2025-03-13 18:12:55,769 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:55,769 [INFO]: 	index_param: efSearch=288
2025-03-13 18:12:55,769 [INFO]: 	index_path: knn.index
2025-03-13 18:12:55,769 [INFO]: 	size in bytes: 423196150
2025-03-13 18:12:55,769 [INFO]: 	avg_search_speed_ms: 14.724239782663062
2025-03-13 18:12:55,769 [INFO]: 	99p_search_speed_ms: 22.905952231958516
2025-03-13 18:12:55,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:55,769 [INFO]: 	nb vectors: 2151
2025-03-13 18:12:55,769 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:55,769 [INFO]: 	compression ratio: 0.9993092044906363
2025-03-13 18:12:55,769 [INFO]: }
2025-03-13 18:12:55,769 [INFO]: 	>>> Finished "Creating the index" in 52.5713 secs
2025-03-13 18:12:55,769 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6121 secs
2025-03-13 18:12:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 70721 [episode count 9/20]
[retrieval_preprocessing] for episode 11332 [episode count 10/20], we have num_retrieval=np.int64(2178) num_query=np.int64(111)
2025-03-13 18:12:58,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:58,653 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:58
2025-03-13 18:12:58,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 931.03it/s]
2025-03-13 18:12:58,681 [INFO]: There are 2178 embeddings of dim 49152
2025-03-13 18:12:58,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:12:58,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:58
2025-03-13 18:12:58,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:58,682 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:12:58,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:58,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:58,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:58
2025-03-13 18:12:58,682 [INFO]: 449.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:58,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:12:58,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:58
2025-03-13 18:12:58,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:58,682 [INFO]: 	Creating the index 03/13/2025, 18:12:58
2025-03-13 18:12:58,682 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:58
2025-03-13 18:12:58,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:12:58,683 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:58
2025-03-13 18:12:58,683 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:12:58,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.44it/s] 44%|████▍     | 4/9 [00:00<00:00, 19.99it/s] 78%|███████▊  | 7/9 [00:00<00:00, 21.70it/s]100%|██████████| 9/9 [00:02<00:00,  3.23it/s]
2025-03-13 18:13:01,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:01
2025-03-13 18:13:30,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5670 secs
2025-03-13 18:13:30,044 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 18:13:30,044 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
2025-03-13 18:13:51,001 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9562 secs
2025-03-13 18:13:51,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3189 secs
2025-03-13 18:13:51,002 [INFO]: {
2025-03-13 18:13:51,002 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:51,002 [INFO]: 	index_param: efSearch=279
2025-03-13 18:13:51,002 [INFO]: 	index_path: knn.index
2025-03-13 18:13:51,002 [INFO]: 	size in bytes: 428508310
2025-03-13 18:13:51,003 [INFO]: 	avg_search_speed_ms: 10.446357780429091
2025-03-13 18:13:51,003 [INFO]: 	99p_search_speed_ms: 19.31841991841793
2025-03-13 18:13:51,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:51,003 [INFO]: 	nb vectors: 2178
2025-03-13 18:13:51,003 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:51,003 [INFO]: 	compression ratio: 0.9993090309030414
2025-03-13 18:13:51,003 [INFO]: }
2025-03-13 18:13:51,003 [INFO]: 	>>> Finished "Creating the index" in 52.3204 secs
2025-03-13 18:13:51,003 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3494 secs
2025-03-13 18:13:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 11332 [episode count 10/20]
[retrieval_preprocessing] for episode 16461 [episode count 11/20], we have num_retrieval=np.int64(2187) num_query=np.int64(102)
2025-03-13 18:13:52,160 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:53,207 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:53
2025-03-13 18:13:53,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.08it/s]
2025-03-13 18:13:53,236 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 18:13:53,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:13:53,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:53
2025-03-13 18:13:53,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:53,236 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:13:53,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:53,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:53,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:53
2025-03-13 18:13:53,236 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:53,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:13:53,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:53
2025-03-13 18:13:53,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:53,237 [INFO]: 	Creating the index 03/13/2025, 18:13:53
2025-03-13 18:13:53,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:53
2025-03-13 18:13:53,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:13:53,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:53
2025-03-13 18:13:53,238 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:13:53,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.92it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.66it/s]100%|██████████| 9/9 [00:01<00:00,  5.37it/s]
2025-03-13 18:13:54,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:54
2025-03-13 18:14:21,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7225 secs
2025-03-13 18:14:21,642 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 18:14:21,642 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 18:14:38,612 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9696 secs
2025-03-13 18:14:38,778 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5401 secs
2025-03-13 18:14:38,778 [INFO]: {
2025-03-13 18:14:38,778 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:38,778 [INFO]: 	index_param: efSearch=188
2025-03-13 18:14:38,779 [INFO]: 	index_path: knn.index
2025-03-13 18:14:38,779 [INFO]: 	size in bytes: 430279030
2025-03-13 18:14:38,779 [INFO]: 	avg_search_speed_ms: 11.039653399272536
2025-03-13 18:14:38,779 [INFO]: 	99p_search_speed_ms: 16.225671314168725
2025-03-13 18:14:38,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:38,779 [INFO]: 	nb vectors: 2187
2025-03-13 18:14:38,779 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:38,779 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 18:14:38,779 [INFO]: }
2025-03-13 18:14:38,779 [INFO]: 	>>> Finished "Creating the index" in 45.5424 secs
2025-03-13 18:14:38,779 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5724 secs
2025-03-13 18:14:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 16461 [episode count 11/20]
[retrieval_preprocessing] for episode 91735 [episode count 12/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 18:14:40,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:40,966 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:40
2025-03-13 18:14:40,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.12it/s]
2025-03-13 18:14:41,004 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 18:14:41,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 18:14:41,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:41
2025-03-13 18:14:41,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:41,005 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:14:41,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:41,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:14:41,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:41
2025-03-13 18:14:41,005 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:41,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:14:41,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:41
2025-03-13 18:14:41,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:41,006 [INFO]: 	Creating the index 03/13/2025, 18:14:41
2025-03-13 18:14:41,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:41
2025-03-13 18:14:41,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0039 secs
2025-03-13 18:14:41,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:41
2025-03-13 18:14:41,011 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:14:41,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.74it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]100%|██████████| 9/9 [00:02<00:00,  3.59it/s]
2025-03-13 18:14:43,524 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:43
2025-03-13 18:15:09,691 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1672 secs
2025-03-13 18:15:09,692 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 18:15:09,692 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 18:15:32,687 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9950 secs
2025-03-13 18:15:32,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6785 secs
2025-03-13 18:15:32,689 [INFO]: {
2025-03-13 18:15:32,689 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:32,689 [INFO]: 	index_param: efSearch=292
2025-03-13 18:15:32,689 [INFO]: 	index_path: knn.index
2025-03-13 18:15:32,689 [INFO]: 	size in bytes: 429295270
2025-03-13 18:15:32,690 [INFO]: 	avg_search_speed_ms: 11.914263041745428
2025-03-13 18:15:32,690 [INFO]: 	99p_search_speed_ms: 19.529955482576042
2025-03-13 18:15:32,690 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:32,690 [INFO]: 	nb vectors: 2182
2025-03-13 18:15:32,690 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:32,690 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 18:15:32,690 [INFO]: }
2025-03-13 18:15:32,690 [INFO]: 	>>> Finished "Creating the index" in 51.6836 secs
2025-03-13 18:15:32,690 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7236 secs
2025-03-13 18:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 91735 [episode count 12/20]
[retrieval_preprocessing] for episode 30316 [episode count 13/20], we have num_retrieval=np.int64(2143) num_query=np.int64(146)
2025-03-13 18:15:35,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:35,697 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:35
2025-03-13 18:15:35,697 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-13 18:15:35,727 [INFO]: There are 2143 embeddings of dim 49152
2025-03-13 18:15:35,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:15:35,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:35
2025-03-13 18:15:35,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:35,727 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:15:35,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:35,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:35,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:35
2025-03-13 18:15:35,727 [INFO]: 442.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:35,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:35,728 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:35
2025-03-13 18:15:35,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:35,728 [INFO]: 	Creating the index 03/13/2025, 18:15:35
2025-03-13 18:15:35,728 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:35
2025-03-13 18:15:35,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:15:35,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:35
2025-03-13 18:15:35,729 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:15:35,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.45it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.11it/s]100%|██████████| 9/9 [00:01<00:00,  4.07it/s]100%|██████████| 9/9 [00:01<00:00,  4.95it/s]
2025-03-13 18:15:37,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:37
2025-03-13 18:16:13,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2322 secs
2025-03-13 18:16:13,783 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 18:16:13,783 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 18:16:32,249 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4659 secs
2025-03-13 18:16:32,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5221 secs
2025-03-13 18:16:32,251 [INFO]: {
2025-03-13 18:16:32,251 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:32,251 [INFO]: 	index_param: efSearch=199
2025-03-13 18:16:32,251 [INFO]: 	index_path: knn.index
2025-03-13 18:16:32,251 [INFO]: 	size in bytes: 421622230
2025-03-13 18:16:32,251 [INFO]: 	avg_search_speed_ms: 9.548986158062416
2025-03-13 18:16:32,251 [INFO]: 	99p_search_speed_ms: 14.713693847879766
2025-03-13 18:16:32,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:32,251 [INFO]: 	nb vectors: 2143
2025-03-13 18:16:32,251 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:32,251 [INFO]: 	compression ratio: 0.9993091303558638
2025-03-13 18:16:32,251 [INFO]: }
2025-03-13 18:16:32,251 [INFO]: 	>>> Finished "Creating the index" in 56.5234 secs
2025-03-13 18:16:32,251 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5537 secs
2025-03-13 18:16:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 30316 [episode count 13/20]
[retrieval_preprocessing] for episode 18545 [episode count 14/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 18:16:33,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:33,820 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:33
2025-03-13 18:16:33,820 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.84it/s]
2025-03-13 18:16:33,849 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 18:16:33,849 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:16:33,849 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:33
2025-03-13 18:16:33,849 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:33,849 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:16:33,849 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:33,849 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:33,849 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:33
2025-03-13 18:16:33,849 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:33,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:33,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:33
2025-03-13 18:16:33,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:33,849 [INFO]: 	Creating the index 03/13/2025, 18:16:33
2025-03-13 18:16:33,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:33
2025-03-13 18:16:33,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:16:33,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:33
2025-03-13 18:16:33,850 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:16:33,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.26it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.91it/s]100%|██████████| 9/9 [00:01<00:00,  5.16it/s]
2025-03-13 18:16:35,598 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:35
2025-03-13 18:17:09,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6345 secs
2025-03-13 18:17:09,233 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 18:17:09,233 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 18:17:29,326 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0930 secs
2025-03-13 18:17:29,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4779 secs
2025-03-13 18:17:29,329 [INFO]: {
2025-03-13 18:17:29,329 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:29,329 [INFO]: 	index_param: efSearch=250
2025-03-13 18:17:29,329 [INFO]: 	index_path: knn.index
2025-03-13 18:17:29,329 [INFO]: 	size in bytes: 429295270
2025-03-13 18:17:29,329 [INFO]: 	avg_search_speed_ms: 12.456179302183454
2025-03-13 18:17:29,329 [INFO]: 	99p_search_speed_ms: 21.76191244274378
2025-03-13 18:17:29,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:29,329 [INFO]: 	nb vectors: 2182
2025-03-13 18:17:29,329 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:29,329 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 18:17:29,329 [INFO]: }
2025-03-13 18:17:29,329 [INFO]: 	>>> Finished "Creating the index" in 55.4793 secs
2025-03-13 18:17:29,329 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5084 secs
2025-03-13 18:17:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 18545 [episode count 14/20]
[retrieval_preprocessing] for episode 58490 [episode count 15/20], we have num_retrieval=np.int64(2202) num_query=np.int64(87)
2025-03-13 18:17:31,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:32,052 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:32
2025-03-13 18:17:32,052 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 18:17:32,084 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 18:17:32,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 18:17:32,084 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:32
2025-03-13 18:17:32,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:32,084 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:17:32,084 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:32,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:32,084 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:32
2025-03-13 18:17:32,085 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:32,085 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:32,085 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:32
2025-03-13 18:17:32,085 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:32,085 [INFO]: 	Creating the index 03/13/2025, 18:17:32
2025-03-13 18:17:32,085 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:32
2025-03-13 18:17:32,086 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:17:32,086 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:32
2025-03-13 18:17:32,086 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:17:32,086 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.53it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.36it/s]100%|██████████| 9/9 [00:01<00:00,  5.15it/s]
2025-03-13 18:17:33,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:33
2025-03-13 18:18:08,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9614 secs
2025-03-13 18:18:08,798 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 18:18:08,798 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 18:18:28,720 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9212 secs
2025-03-13 18:18:28,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6352 secs
2025-03-13 18:18:28,721 [INFO]: {
2025-03-13 18:18:28,721 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:28,721 [INFO]: 	index_param: efSearch=225
2025-03-13 18:18:28,721 [INFO]: 	index_path: knn.index
2025-03-13 18:18:28,722 [INFO]: 	size in bytes: 433230190
2025-03-13 18:18:28,722 [INFO]: 	avg_search_speed_ms: 8.766593393199571
2025-03-13 18:18:28,722 [INFO]: 	99p_search_speed_ms: 13.148654159158463
2025-03-13 18:18:28,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:28,722 [INFO]: 	nb vectors: 2202
2025-03-13 18:18:28,722 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:28,722 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 18:18:28,722 [INFO]: }
2025-03-13 18:18:28,722 [INFO]: 	>>> Finished "Creating the index" in 56.6369 secs
2025-03-13 18:18:28,722 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6698 secs
2025-03-13 18:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 58490 [episode count 15/20]
[retrieval_preprocessing] for episode 86649 [episode count 16/20], we have num_retrieval=np.int64(2137) num_query=np.int64(152)
2025-03-13 18:18:29,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:29,873 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:29
2025-03-13 18:18:29,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.95it/s]
2025-03-13 18:18:29,907 [INFO]: There are 2137 embeddings of dim 49152
2025-03-13 18:18:29,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 18:18:29,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:29,908 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:18:29,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:29,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:18:29,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,908 [INFO]: 441.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:29,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:18:29,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:29
2025-03-13 18:18:29,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:29,909 [INFO]: 	Creating the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:29
2025-03-13 18:18:29,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:18:29,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,912 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:18:29,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.12it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.06it/s]100%|██████████| 9/9 [00:01<00:00,  6.01it/s]
2025-03-13 18:18:31,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:31
2025-03-13 18:18:58,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5550 secs
2025-03-13 18:18:58,971 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 18:18:58,971 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.92it/s]
2025-03-13 18:19:20,745 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7734 secs
2025-03-13 18:19:20,746 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8344 secs
2025-03-13 18:19:20,747 [INFO]: {
2025-03-13 18:19:20,747 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:20,747 [INFO]: 	index_param: efSearch=305
2025-03-13 18:19:20,747 [INFO]: 	index_path: knn.index
2025-03-13 18:19:20,747 [INFO]: 	size in bytes: 420441790
2025-03-13 18:19:20,747 [INFO]: 	avg_search_speed_ms: 13.594306648883503
2025-03-13 18:19:20,747 [INFO]: 	99p_search_speed_ms: 22.454602445941415
2025-03-13 18:19:20,747 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:20,747 [INFO]: 	nb vectors: 2137
2025-03-13 18:19:20,747 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:20,747 [INFO]: 	compression ratio: 0.9993090743905357
2025-03-13 18:19:20,747 [INFO]: }
2025-03-13 18:19:20,747 [INFO]: 	>>> Finished "Creating the index" in 50.8377 secs
2025-03-13 18:19:20,747 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8735 secs
2025-03-13 18:19:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 86649 [episode count 16/20]
[retrieval_preprocessing] for episode 14972 [episode count 17/20], we have num_retrieval=np.int64(2182) num_query=np.int64(107)
2025-03-13 18:19:23,029 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:23,740 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:23
2025-03-13 18:19:23,740 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.66it/s]
2025-03-13 18:19:23,771 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 18:19:23,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 18:19:23,772 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:23
2025-03-13 18:19:23,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:23,773 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:19:23,773 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:23,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:19:23,773 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:23
2025-03-13 18:19:23,773 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:23,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:19:23,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:23
2025-03-13 18:19:23,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:23,774 [INFO]: 	Creating the index 03/13/2025, 18:19:23
2025-03-13 18:19:23,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:23
2025-03-13 18:19:23,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:19:23,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:23
2025-03-13 18:19:23,778 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:19:23,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.89it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.21it/s]100%|██████████| 9/9 [00:01<00:00,  4.92it/s]
2025-03-13 18:19:25,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:25
2025-03-13 18:19:59,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9961 secs
2025-03-13 18:19:59,608 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:19:59,608 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 18:20:21,581 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9726 secs
2025-03-13 18:20:21,583 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8052 secs
2025-03-13 18:20:21,583 [INFO]: {
2025-03-13 18:20:21,583 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:21,583 [INFO]: 	index_param: efSearch=268
2025-03-13 18:20:21,583 [INFO]: 	index_path: knn.index
2025-03-13 18:20:21,583 [INFO]: 	size in bytes: 429295270
2025-03-13 18:20:21,583 [INFO]: 	avg_search_speed_ms: 11.7928403531825
2025-03-13 18:20:21,583 [INFO]: 	99p_search_speed_ms: 17.046900577843182
2025-03-13 18:20:21,583 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:21,583 [INFO]: 	nb vectors: 2182
2025-03-13 18:20:21,583 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:21,583 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 18:20:21,583 [INFO]: }
2025-03-13 18:20:21,583 [INFO]: 	>>> Finished "Creating the index" in 57.8092 secs
2025-03-13 18:20:21,583 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8428 secs
2025-03-13 18:20:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 14972 [episode count 17/20]
[retrieval_preprocessing] for episode 78463 [episode count 18/20], we have num_retrieval=np.int64(2091) num_query=np.int64(198)
2025-03-13 18:20:24,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:24,607 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:24
2025-03-13 18:20:24,607 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1385.17it/s]
2025-03-13 18:20:24,657 [INFO]: There are 2091 embeddings of dim 49152
2025-03-13 18:20:24,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0501 secs
2025-03-13 18:20:24,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:24
2025-03-13 18:20:24,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:24,658 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:20:24,658 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:24,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:20:24,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:24
2025-03-13 18:20:24,658 [INFO]: 431.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:24,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:20:24,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:24
2025-03-13 18:20:24,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:24,659 [INFO]: 	Creating the index 03/13/2025, 18:20:24
2025-03-13 18:20:24,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:24
2025-03-13 18:20:24,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:20:24,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:24
2025-03-13 18:20:24,662 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:20:24,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.91it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.05it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 18:20:26,822 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:26
2025-03-13 18:20:58,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0686 secs
2025-03-13 18:20:58,891 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 18:20:58,892 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 18:21:16,028 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1361 secs
2025-03-13 18:21:16,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3676 secs
2025-03-13 18:21:16,030 [INFO]: {
2025-03-13 18:21:16,030 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:16,030 [INFO]: 	index_param: efSearch=280
2025-03-13 18:21:16,030 [INFO]: 	index_path: knn.index
2025-03-13 18:21:16,030 [INFO]: 	size in bytes: 411391570
2025-03-13 18:21:16,030 [INFO]: 	avg_search_speed_ms: 12.267389981807467
2025-03-13 18:21:16,030 [INFO]: 	99p_search_speed_ms: 20.557826338335875
2025-03-13 18:21:16,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:16,030 [INFO]: 	nb vectors: 2091
2025-03-13 18:21:16,030 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:16,030 [INFO]: 	compression ratio: 0.99930907188983
2025-03-13 18:21:16,030 [INFO]: }
2025-03-13 18:21:16,030 [INFO]: 	>>> Finished "Creating the index" in 51.3713 secs
2025-03-13 18:21:16,030 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4235 secs
2025-03-13 18:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 78463 [episode count 18/20]
[retrieval_preprocessing] for episode 16011 [episode count 19/20], we have num_retrieval=np.int64(2209) num_query=np.int64(80)
2025-03-13 18:21:18,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:19,900 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:19
2025-03-13 18:21:19,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.82it/s]
2025-03-13 18:21:19,929 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 18:21:19,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:21:19,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:19,930 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:21:19,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:19,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:19,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,930 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:19,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:21:19,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:19
2025-03-13 18:21:19,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:19,930 [INFO]: 	Creating the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,930 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:19
2025-03-13 18:21:19,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:21:19,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,932 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:21:19,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.28it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.72it/s]100%|██████████| 9/9 [00:02<00:00,  4.46it/s]
2025-03-13 18:21:21,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:21
2025-03-13 18:21:51,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8524 secs
2025-03-13 18:21:51,806 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 18:21:51,807 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 18:22:19,808 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0013 secs
2025-03-13 18:22:19,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8780 secs
2025-03-13 18:22:19,810 [INFO]: {
2025-03-13 18:22:19,810 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:19,810 [INFO]: 	index_param: efSearch=245
2025-03-13 18:22:19,810 [INFO]: 	index_path: knn.index
2025-03-13 18:22:19,810 [INFO]: 	size in bytes: 434607370
2025-03-13 18:22:19,810 [INFO]: 	avg_search_speed_ms: 10.244904412338357
2025-03-13 18:22:19,810 [INFO]: 	99p_search_speed_ms: 14.85915359808132
2025-03-13 18:22:19,810 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:19,810 [INFO]: 	nb vectors: 2209
2025-03-13 18:22:19,810 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:19,810 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 18:22:19,810 [INFO]: }
2025-03-13 18:22:19,810 [INFO]: 	>>> Finished "Creating the index" in 59.8799 secs
2025-03-13 18:22:19,810 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9096 secs
2025-03-13 18:22:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16011 [episode count 19/20]
2025-03-13 18:22:20: [retrieval_preprocessing] finished for 4329524892_put_cup_in_bowl [chosen_id count 7/196]
2025-03-13 18:22:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4329524892_put_orange_cup_in_black_bowl [chosen_id count 8/196]
2025-03-13 18:22:21: [retrieval_preprocessing] we have num_total=2145 embedding_dim=49152
[retrieval_preprocessing] for episode 56842 [episode count 0/20], we have num_retrieval=np.int64(2024) num_query=np.int64(121)
2025-03-13 18:22:21,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:22,233 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:22
2025-03-13 18:22:22,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.09it/s]
2025-03-13 18:22:22,263 [INFO]: There are 2024 embeddings of dim 49152
2025-03-13 18:22:22,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 18:22:22,263 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:22
2025-03-13 18:22:22,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:22,263 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:22:22,263 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:22,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:22,263 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:22
2025-03-13 18:22:22,264 [INFO]: 417.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:22,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:22:22,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:22
2025-03-13 18:22:22,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:22,264 [INFO]: 	Creating the index 03/13/2025, 18:22:22
2025-03-13 18:22:22,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:22
2025-03-13 18:22:22,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:22:22,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:22
2025-03-13 18:22:22,265 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:22:22,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.46it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.33it/s]100%|██████████| 8/8 [00:01<00:00,  4.68it/s]
2025-03-13 18:22:23,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:23
2025-03-13 18:22:58,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7536 secs
2025-03-13 18:22:58,734 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 18:22:58,734 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s]
2025-03-13 18:23:14,090 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3559 secs
2025-03-13 18:23:14,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8274 secs
2025-03-13 18:23:14,093 [INFO]: {
2025-03-13 18:23:14,093 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:14,093 [INFO]: 	index_param: efSearch=140
2025-03-13 18:23:14,093 [INFO]: 	index_path: knn.index
2025-03-13 18:23:14,093 [INFO]: 	size in bytes: 398209870
2025-03-13 18:23:14,093 [INFO]: 	avg_search_speed_ms: 10.225804799268735
2025-03-13 18:23:14,093 [INFO]: 	99p_search_speed_ms: 23.510887103620924
2025-03-13 18:23:14,093 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:14,093 [INFO]: 	nb vectors: 2024
2025-03-13 18:23:14,093 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:14,093 [INFO]: 	compression ratio: 0.9993087112582116
2025-03-13 18:23:14,093 [INFO]: }
2025-03-13 18:23:14,093 [INFO]: 	>>> Finished "Creating the index" in 51.8292 secs
2025-03-13 18:23:14,093 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8601 secs
2025-03-13 18:23:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 56842 [episode count 0/20]
[retrieval_preprocessing] for episode 52755 [episode count 1/20], we have num_retrieval=np.int64(2032) num_query=np.int64(113)
2025-03-13 18:23:15,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:15,800 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:15
2025-03-13 18:23:15,800 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.02it/s]
2025-03-13 18:23:15,833 [INFO]: There are 2032 embeddings of dim 49152
2025-03-13 18:23:15,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:23:15,833 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:15
2025-03-13 18:23:15,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:15,833 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:23:15,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:15,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:15,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:15
2025-03-13 18:23:15,834 [INFO]: 419.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:15,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:15,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:15
2025-03-13 18:23:15,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:15,834 [INFO]: 	Creating the index 03/13/2025, 18:23:15
2025-03-13 18:23:15,834 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:15
2025-03-13 18:23:15,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:23:15,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:15
2025-03-13 18:23:15,835 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:23:15,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.88it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.52it/s]100%|██████████| 8/8 [00:02<00:00,  3.17it/s]100%|██████████| 8/8 [00:02<00:00,  3.83it/s]
2025-03-13 18:23:17,926 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:17
2025-03-13 18:23:42,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4977 secs
2025-03-13 18:23:42,424 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:23:42,424 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 18:24:00,922 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4977 secs
2025-03-13 18:24:00,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0888 secs
2025-03-13 18:24:00,924 [INFO]: {
2025-03-13 18:24:00,924 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:00,924 [INFO]: 	index_param: efSearch=196
2025-03-13 18:24:00,924 [INFO]: 	index_path: knn.index
2025-03-13 18:24:00,924 [INFO]: 	size in bytes: 399783790
2025-03-13 18:24:00,924 [INFO]: 	avg_search_speed_ms: 9.735228622807398
2025-03-13 18:24:00,924 [INFO]: 	99p_search_speed_ms: 14.447899465449154
2025-03-13 18:24:00,924 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:00,924 [INFO]: 	nb vectors: 2032
2025-03-13 18:24:00,924 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:00,924 [INFO]: 	compression ratio: 0.999308791384463
2025-03-13 18:24:00,924 [INFO]: }
2025-03-13 18:24:00,924 [INFO]: 	>>> Finished "Creating the index" in 45.0904 secs
2025-03-13 18:24:00,924 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1240 secs
2025-03-13 18:24:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 52755 [episode count 1/20]
[retrieval_preprocessing] for episode 64531 [episode count 2/20], we have num_retrieval=np.int64(2066) num_query=np.int64(79)
2025-03-13 18:24:02,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:02,804 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:02
2025-03-13 18:24:02,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1626.33it/s]
2025-03-13 18:24:02,832 [INFO]: There are 2066 embeddings of dim 49152
2025-03-13 18:24:02,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:24:02,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:02
2025-03-13 18:24:02,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:02,833 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:24:02,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:02,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:02,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:02
2025-03-13 18:24:02,833 [INFO]: 426.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:02,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:24:02,833 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:02
2025-03-13 18:24:02,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:02,833 [INFO]: 	Creating the index 03/13/2025, 18:24:02
2025-03-13 18:24:02,833 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:02
2025-03-13 18:24:02,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:24:02,834 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:02
2025-03-13 18:24:02,834 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:24:02,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.39it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.60it/s]100%|██████████| 9/9 [00:01<00:00,  5.05it/s]
2025-03-13 18:24:04,620 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:04
2025-03-13 18:24:29,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8257 secs
2025-03-13 18:24:29,446 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 18:24:29,446 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 18:24:44,581 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1348 secs
2025-03-13 18:24:44,875 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0406 secs
2025-03-13 18:24:44,875 [INFO]: {
2025-03-13 18:24:44,875 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:44,875 [INFO]: 	index_param: efSearch=188
2025-03-13 18:24:44,875 [INFO]: 	index_path: knn.index
2025-03-13 18:24:44,875 [INFO]: 	size in bytes: 406473010
2025-03-13 18:24:44,875 [INFO]: 	avg_search_speed_ms: 9.710078035228099
2025-03-13 18:24:44,875 [INFO]: 	99p_search_speed_ms: 17.246060601901267
2025-03-13 18:24:44,875 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:44,875 [INFO]: 	nb vectors: 2066
2025-03-13 18:24:44,875 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:44,875 [INFO]: 	compression ratio: 0.9993089774890589
2025-03-13 18:24:44,876 [INFO]: }
2025-03-13 18:24:44,876 [INFO]: 	>>> Finished "Creating the index" in 42.0427 secs
2025-03-13 18:24:44,876 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0713 secs
2025-03-13 18:24:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 64531 [episode count 2/20]
[retrieval_preprocessing] for episode 15922 [episode count 3/20], we have num_retrieval=np.int64(2017) num_query=np.int64(128)
2025-03-13 18:24:45,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:46,233 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:46
2025-03-13 18:24:46,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-13 18:24:46,263 [INFO]: There are 2017 embeddings of dim 49152
2025-03-13 18:24:46,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 18:24:46,263 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:46
2025-03-13 18:24:46,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:46,263 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:24:46,263 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:46,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:46,263 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:46
2025-03-13 18:24:46,263 [INFO]: 416.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:46,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:24:46,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:46
2025-03-13 18:24:46,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:46,264 [INFO]: 	Creating the index 03/13/2025, 18:24:46
2025-03-13 18:24:46,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:46
2025-03-13 18:24:46,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:24:46,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:46
2025-03-13 18:24:46,265 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:24:46,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.22it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.32it/s]100%|██████████| 8/8 [00:01<00:00,  4.65it/s]
2025-03-13 18:24:47,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:47
2025-03-13 18:25:16,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0540 secs
2025-03-13 18:25:16,043 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:25:16,043 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 18:25:33,882 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8389 secs
2025-03-13 18:25:33,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6628 secs
2025-03-13 18:25:33,928 [INFO]: {
2025-03-13 18:25:33,928 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:33,928 [INFO]: 	index_param: efSearch=256
2025-03-13 18:25:33,928 [INFO]: 	index_path: knn.index
2025-03-13 18:25:33,928 [INFO]: 	size in bytes: 396832570
2025-03-13 18:25:33,928 [INFO]: 	avg_search_speed_ms: 9.524765539293488
2025-03-13 18:25:33,928 [INFO]: 	99p_search_speed_ms: 13.687976652290672
2025-03-13 18:25:33,928 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:33,928 [INFO]: 	nb vectors: 2017
2025-03-13 18:25:33,928 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:33,929 [INFO]: 	compression ratio: 0.9993089428118261
2025-03-13 18:25:33,929 [INFO]: }
2025-03-13 18:25:33,929 [INFO]: 	>>> Finished "Creating the index" in 47.6650 secs
2025-03-13 18:25:33,929 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6951 secs
2025-03-13 18:25:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 15922 [episode count 3/20]
[retrieval_preprocessing] for episode 28219 [episode count 4/20], we have num_retrieval=np.int64(2013) num_query=np.int64(132)
2025-03-13 18:25:35,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:35,909 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:35
2025-03-13 18:25:35,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2177.73it/s]
2025-03-13 18:25:35,937 [INFO]: There are 2013 embeddings of dim 49152
2025-03-13 18:25:35,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:25:35,938 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:35
2025-03-13 18:25:35,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:35,938 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:25:35,938 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:35,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:35,938 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:35
2025-03-13 18:25:35,938 [INFO]: 415.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:35,938 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:25:35,938 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:35
2025-03-13 18:25:35,938 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:35,938 [INFO]: 	Creating the index 03/13/2025, 18:25:35
2025-03-13 18:25:35,938 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:35
2025-03-13 18:25:35,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:25:35,940 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:35
2025-03-13 18:25:35,940 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:25:35,940 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.00it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.11it/s]100%|██████████| 8/8 [00:01<00:00,  4.89it/s]
2025-03-13 18:25:37,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:37
2025-03-13 18:25:59,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3955 secs
2025-03-13 18:25:59,975 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 18:25:59,975 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 18:26:26,564 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5893 secs
2025-03-13 18:26:26,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6261 secs
2025-03-13 18:26:26,566 [INFO]: {
2025-03-13 18:26:26,566 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:26,566 [INFO]: 	index_param: efSearch=287
2025-03-13 18:26:26,566 [INFO]: 	index_path: knn.index
2025-03-13 18:26:26,566 [INFO]: 	size in bytes: 396045610
2025-03-13 18:26:26,566 [INFO]: 	avg_search_speed_ms: 11.053530616397603
2025-03-13 18:26:26,566 [INFO]: 	99p_search_speed_ms: 14.416617378592493
2025-03-13 18:26:26,566 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:26,566 [INFO]: 	nb vectors: 2013
2025-03-13 18:26:26,566 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:26,566 [INFO]: 	compression ratio: 0.9993089028306613
2025-03-13 18:26:26,566 [INFO]: }
2025-03-13 18:26:26,566 [INFO]: 	>>> Finished "Creating the index" in 50.6277 secs
2025-03-13 18:26:26,566 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6569 secs
2025-03-13 18:26:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 28219 [episode count 4/20]
[retrieval_preprocessing] for episode 93247 [episode count 5/20], we have num_retrieval=np.int64(2009) num_query=np.int64(136)
2025-03-13 18:26:28,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:28,738 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:28
2025-03-13 18:26:28,738 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 895.84it/s]
2025-03-13 18:26:28,771 [INFO]: There are 2009 embeddings of dim 49152
2025-03-13 18:26:28,771 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:26:28,771 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:28
2025-03-13 18:26:28,771 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:28,771 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:26:28,771 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:28,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:28,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:28
2025-03-13 18:26:28,772 [INFO]: 414.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:28,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:28,772 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:28
2025-03-13 18:26:28,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:28,772 [INFO]: 	Creating the index 03/13/2025, 18:26:28
2025-03-13 18:26:28,772 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:28
2025-03-13 18:26:28,773 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:26:28,773 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:28
2025-03-13 18:26:28,773 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:26:28,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.09it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.53it/s]100%|██████████| 8/8 [00:01<00:00,  4.35it/s]
2025-03-13 18:26:30,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:30
2025-03-13 18:27:02,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4209 secs
2025-03-13 18:27:02,036 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:27:02,036 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-13 18:27:17,886 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8498 secs
2025-03-13 18:27:17,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1144 secs
2025-03-13 18:27:17,888 [INFO]: {
2025-03-13 18:27:17,888 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:17,888 [INFO]: 	index_param: efSearch=253
2025-03-13 18:27:17,888 [INFO]: 	index_path: knn.index
2025-03-13 18:27:17,888 [INFO]: 	size in bytes: 395258650
2025-03-13 18:27:17,888 [INFO]: 	avg_search_speed_ms: 11.658939077857543
2025-03-13 18:27:17,888 [INFO]: 	99p_search_speed_ms: 17.72561336401849
2025-03-13 18:27:17,888 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:17,888 [INFO]: 	nb vectors: 2009
2025-03-13 18:27:17,888 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:17,888 [INFO]: 	compression ratio: 0.9993088626902915
2025-03-13 18:27:17,888 [INFO]: }
2025-03-13 18:27:17,888 [INFO]: 	>>> Finished "Creating the index" in 49.1164 secs
2025-03-13 18:27:17,888 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1501 secs
2025-03-13 18:27:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 93247 [episode count 5/20]
[retrieval_preprocessing] for episode 72783 [episode count 6/20], we have num_retrieval=np.int64(2035) num_query=np.int64(110)
2025-03-13 18:27:19,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:19,873 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:19
2025-03-13 18:27:19,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.07it/s]
2025-03-13 18:27:19,899 [INFO]: There are 2035 embeddings of dim 49152
2025-03-13 18:27:19,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:27:19,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:19
2025-03-13 18:27:19,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:19,899 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:27:19,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:19,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:19,900 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:19
2025-03-13 18:27:19,900 [INFO]: 420.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:19,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:27:19,900 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:19
2025-03-13 18:27:19,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:19,900 [INFO]: 	Creating the index 03/13/2025, 18:27:19
2025-03-13 18:27:19,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:19
2025-03-13 18:27:19,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:27:19,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:19
2025-03-13 18:27:19,901 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:27:19,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.96it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.23it/s]100%|██████████| 9/9 [00:01<00:00,  5.84it/s]
2025-03-13 18:27:21,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:21
2025-03-13 18:27:46,711 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2659 secs
2025-03-13 18:27:46,712 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 18:27:46,712 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 18:28:02,493 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7808 secs
2025-03-13 18:28:02,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5931 secs
2025-03-13 18:28:02,494 [INFO]: {
2025-03-13 18:28:02,494 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:02,494 [INFO]: 	index_param: efSearch=278
2025-03-13 18:28:02,494 [INFO]: 	index_path: knn.index
2025-03-13 18:28:02,494 [INFO]: 	size in bytes: 400374010
2025-03-13 18:28:02,494 [INFO]: 	avg_search_speed_ms: 10.8621097738621
2025-03-13 18:28:02,494 [INFO]: 	99p_search_speed_ms: 17.61897429823875
2025-03-13 18:28:02,494 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:02,494 [INFO]: 	nb vectors: 2035
2025-03-13 18:28:02,494 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:02,494 [INFO]: 	compression ratio: 0.9993088212693926
2025-03-13 18:28:02,494 [INFO]: }
2025-03-13 18:28:02,494 [INFO]: 	>>> Finished "Creating the index" in 42.5944 secs
2025-03-13 18:28:02,494 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6209 secs
2025-03-13 18:28:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 72783 [episode count 6/20]
[retrieval_preprocessing] for episode 92254 [episode count 7/20], we have num_retrieval=np.int64(2055) num_query=np.int64(90)
2025-03-13 18:28:03,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:03,903 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:03
2025-03-13 18:28:03,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2158.67it/s]
2025-03-13 18:28:03,927 [INFO]: There are 2055 embeddings of dim 49152
2025-03-13 18:28:03,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 18:28:03,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:03
2025-03-13 18:28:03,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:03,928 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:28:03,928 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:03,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:03,928 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:03
2025-03-13 18:28:03,928 [INFO]: 424.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:03,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:28:03,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:03
2025-03-13 18:28:03,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:03,928 [INFO]: 	Creating the index 03/13/2025, 18:28:03
2025-03-13 18:28:03,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:03
2025-03-13 18:28:03,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:28:03,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:03
2025-03-13 18:28:03,929 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:28:03,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.47it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.12it/s]100%|██████████| 9/9 [00:01<00:00,  6.28it/s]
2025-03-13 18:28:05,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:05
2025-03-13 18:28:29,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0169 secs
2025-03-13 18:28:29,384 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 18:28:29,384 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.15it/s]
2025-03-13 18:28:51,145 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7613 secs
2025-03-13 18:28:51,146 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2173 secs
2025-03-13 18:28:51,147 [INFO]: {
2025-03-13 18:28:51,147 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:51,147 [INFO]: 	index_param: efSearch=344
2025-03-13 18:28:51,147 [INFO]: 	index_path: knn.index
2025-03-13 18:28:51,147 [INFO]: 	size in bytes: 404308870
2025-03-13 18:28:51,147 [INFO]: 	avg_search_speed_ms: 11.0996187378763
2025-03-13 18:28:51,147 [INFO]: 	99p_search_speed_ms: 17.07583013921976
2025-03-13 18:28:51,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:51,147 [INFO]: 	nb vectors: 2055
2025-03-13 18:28:51,147 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:51,147 [INFO]: 	compression ratio: 0.9993088699735923
2025-03-13 18:28:51,147 [INFO]: }
2025-03-13 18:28:51,147 [INFO]: 	>>> Finished "Creating the index" in 47.2186 secs
2025-03-13 18:28:51,147 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2432 secs
2025-03-13 18:28:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 92254 [episode count 7/20]
[retrieval_preprocessing] for episode 51295 [episode count 8/20], we have num_retrieval=np.int64(2034) num_query=np.int64(111)
2025-03-13 18:28:52,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:52,716 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:52
2025-03-13 18:28:52,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2257.43it/s]
2025-03-13 18:28:52,743 [INFO]: There are 2034 embeddings of dim 49152
2025-03-13 18:28:52,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 18:28:52,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:52
2025-03-13 18:28:52,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:52,744 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:28:52,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:52,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:28:52,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:52
2025-03-13 18:28:52,744 [INFO]: 419.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:52,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:28:52,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:52
2025-03-13 18:28:52,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:52,745 [INFO]: 	Creating the index 03/13/2025, 18:28:52
2025-03-13 18:28:52,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:52
2025-03-13 18:28:52,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:28:52,748 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:52
2025-03-13 18:28:52,748 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:28:52,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 25.93it/s]100%|██████████| 9/9 [00:01<00:00,  5.66it/s]100%|██████████| 9/9 [00:01<00:00,  6.14it/s]
2025-03-13 18:28:54,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:54
2025-03-13 18:29:19,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8585 secs
2025-03-13 18:29:19,080 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 18:29:19,080 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 18:29:41,198 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1184 secs
2025-03-13 18:29:41,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4515 secs
2025-03-13 18:29:41,200 [INFO]: {
2025-03-13 18:29:41,200 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:41,200 [INFO]: 	index_param: efSearch=289
2025-03-13 18:29:41,200 [INFO]: 	index_path: knn.index
2025-03-13 18:29:41,200 [INFO]: 	size in bytes: 400177270
2025-03-13 18:29:41,200 [INFO]: 	avg_search_speed_ms: 11.851492860096274
2025-03-13 18:29:41,200 [INFO]: 	99p_search_speed_ms: 15.355999486055218
2025-03-13 18:29:41,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:41,200 [INFO]: 	nb vectors: 2034
2025-03-13 18:29:41,200 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:41,200 [INFO]: 	compression ratio: 0.9993088113175443
2025-03-13 18:29:41,200 [INFO]: }
2025-03-13 18:29:41,200 [INFO]: 	>>> Finished "Creating the index" in 48.4552 secs
2025-03-13 18:29:41,200 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4837 secs
2025-03-13 18:29:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 51295 [episode count 8/20]
[retrieval_preprocessing] for episode 95329 [episode count 9/20], we have num_retrieval=np.int64(2054) num_query=np.int64(91)
2025-03-13 18:29:42,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:43,441 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:43
2025-03-13 18:29:43,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.39it/s]
2025-03-13 18:29:43,469 [INFO]: There are 2054 embeddings of dim 49152
2025-03-13 18:29:43,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 18:29:43,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:43
2025-03-13 18:29:43,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:43,470 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:29:43,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:43,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:43,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:43
2025-03-13 18:29:43,470 [INFO]: 423.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:43,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:29:43,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:43
2025-03-13 18:29:43,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:43,470 [INFO]: 	Creating the index 03/13/2025, 18:29:43
2025-03-13 18:29:43,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:43
2025-03-13 18:29:43,471 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:29:43,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:43
2025-03-13 18:29:43,472 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:29:43,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.08it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.19it/s]100%|██████████| 9/9 [00:01<00:00,  5.65it/s]
2025-03-13 18:29:45,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:45
2025-03-13 18:30:12,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6498 secs
2025-03-13 18:30:12,717 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 18:30:12,717 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
2025-03-13 18:30:29,368 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6510 secs
2025-03-13 18:30:29,370 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8984 secs
2025-03-13 18:30:29,370 [INFO]: {
2025-03-13 18:30:29,370 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:29,370 [INFO]: 	index_param: efSearch=184
2025-03-13 18:30:29,370 [INFO]: 	index_path: knn.index
2025-03-13 18:30:29,370 [INFO]: 	size in bytes: 404112130
2025-03-13 18:30:29,370 [INFO]: 	avg_search_speed_ms: 9.634546201177272
2025-03-13 18:30:29,370 [INFO]: 	99p_search_speed_ms: 17.389071306679348
2025-03-13 18:30:29,370 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:29,370 [INFO]: 	nb vectors: 2054
2025-03-13 18:30:29,370 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:29,370 [INFO]: 	compression ratio: 0.999308860142357
2025-03-13 18:30:29,370 [INFO]: }
2025-03-13 18:30:29,370 [INFO]: 	>>> Finished "Creating the index" in 45.9001 secs
2025-03-13 18:30:29,370 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9288 secs
2025-03-13 18:30:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 95329 [episode count 9/20]
[retrieval_preprocessing] for episode 50787 [episode count 10/20], we have num_retrieval=np.int64(2057) num_query=np.int64(88)
2025-03-13 18:30:31,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:31,334 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:31
2025-03-13 18:30:31,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1002.22it/s]
2025-03-13 18:30:31,364 [INFO]: There are 2057 embeddings of dim 49152
2025-03-13 18:30:31,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 18:30:31,364 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:31
2025-03-13 18:30:31,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:31,364 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:30:31,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:31,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:30:31,365 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:31
2025-03-13 18:30:31,365 [INFO]: 424.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:31,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:30:31,365 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:31
2025-03-13 18:30:31,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:31,365 [INFO]: 	Creating the index 03/13/2025, 18:30:31
2025-03-13 18:30:31,365 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:31
2025-03-13 18:30:31,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:30:31,366 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:31
2025-03-13 18:30:31,366 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:30:31,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.06it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.54it/s]100%|██████████| 9/9 [00:01<00:00,  5.62it/s]
2025-03-13 18:30:32,971 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:32
2025-03-13 18:30:55,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6232 secs
2025-03-13 18:30:55,595 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 18:30:55,595 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 18:31:19,315 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7198 secs
2025-03-13 18:31:19,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2218 secs
2025-03-13 18:31:19,588 [INFO]: {
2025-03-13 18:31:19,588 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:19,589 [INFO]: 	index_param: efSearch=335
2025-03-13 18:31:19,589 [INFO]: 	index_path: knn.index
2025-03-13 18:31:19,589 [INFO]: 	size in bytes: 404702350
2025-03-13 18:31:19,589 [INFO]: 	avg_search_speed_ms: 16.719573416058378
2025-03-13 18:31:19,589 [INFO]: 	99p_search_speed_ms: 26.699131727218614
2025-03-13 18:31:19,589 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:19,589 [INFO]: 	nb vectors: 2057
2025-03-13 18:31:19,589 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:19,589 [INFO]: 	compression ratio: 0.9993088896073867
2025-03-13 18:31:19,589 [INFO]: }
2025-03-13 18:31:19,589 [INFO]: 	>>> Finished "Creating the index" in 48.2241 secs
2025-03-13 18:31:19,589 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2546 secs
2025-03-13 18:31:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 50787 [episode count 10/20]
[retrieval_preprocessing] for episode 62565 [episode count 11/20], we have num_retrieval=np.int64(1998) num_query=np.int64(147)
2025-03-13 18:31:21,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:21,905 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:21
2025-03-13 18:31:21,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.50it/s]
2025-03-13 18:31:21,932 [INFO]: There are 1998 embeddings of dim 49152
2025-03-13 18:31:21,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 18:31:21,932 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:21
2025-03-13 18:31:21,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:21,932 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:31:21,932 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:21,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:21,932 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:21
2025-03-13 18:31:21,932 [INFO]: 412.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:21,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:31:21,932 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:21
2025-03-13 18:31:21,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:21,932 [INFO]: 	Creating the index 03/13/2025, 18:31:21
2025-03-13 18:31:21,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:21
2025-03-13 18:31:21,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:31:21,933 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:21
2025-03-13 18:31:21,933 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:31:21,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.24it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.39it/s] 50%|█████     | 4/8 [00:00<00:00,  7.93it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.13it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.57it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.80it/s]100%|██████████| 8/8 [00:02<00:00,  1.60it/s]100%|██████████| 8/8 [00:02<00:00,  3.08it/s]
2025-03-13 18:31:24,540 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:24
2025-03-13 18:31:50,643 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1025 secs
2025-03-13 18:31:50,643 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:31:50,643 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.82it/s]
2025-03-13 18:32:07,740 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0963 secs
2025-03-13 18:32:07,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8086 secs
2025-03-13 18:32:07,742 [INFO]: {
2025-03-13 18:32:07,742 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:07,742 [INFO]: 	index_param: efSearch=204
2025-03-13 18:32:07,742 [INFO]: 	index_path: knn.index
2025-03-13 18:32:07,742 [INFO]: 	size in bytes: 393094450
2025-03-13 18:32:07,742 [INFO]: 	avg_search_speed_ms: 8.192928899407546
2025-03-13 18:32:07,742 [INFO]: 	99p_search_speed_ms: 12.124641751870511
2025-03-13 18:32:07,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:07,742 [INFO]: 	nb vectors: 1998
2025-03-13 18:32:07,742 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:07,742 [INFO]: 	compression ratio: 0.9993089040051316
2025-03-13 18:32:07,742 [INFO]: }
2025-03-13 18:32:07,742 [INFO]: 	>>> Finished "Creating the index" in 45.8099 secs
2025-03-13 18:32:07,742 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8372 secs
2025-03-13 18:32:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 62565 [episode count 11/20]
[retrieval_preprocessing] for episode 68709 [episode count 12/20], we have num_retrieval=np.int64(2053) num_query=np.int64(92)
2025-03-13 18:32:09,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:10,005 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:10
2025-03-13 18:32:10,005 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.24it/s]
2025-03-13 18:32:10,037 [INFO]: There are 2053 embeddings of dim 49152
2025-03-13 18:32:10,037 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 18:32:10,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:10
2025-03-13 18:32:10,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:10,038 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:32:10,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:10,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:32:10,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:10
2025-03-13 18:32:10,038 [INFO]: 423.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:10,039 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:32:10,039 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:10
2025-03-13 18:32:10,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:10,039 [INFO]: 	Creating the index 03/13/2025, 18:32:10
2025-03-13 18:32:10,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:10
2025-03-13 18:32:10,042 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:32:10,042 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:10
2025-03-13 18:32:10,043 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:32:10,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.85it/s]100%|██████████| 9/9 [00:01<00:00,  5.58it/s]100%|██████████| 9/9 [00:01<00:00,  6.05it/s]
2025-03-13 18:32:11,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:11
2025-03-13 18:32:36,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7036 secs
2025-03-13 18:32:36,240 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:32:36,240 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.91it/s]
2025-03-13 18:32:54,053 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8126 secs
2025-03-13 18:32:54,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0126 secs
2025-03-13 18:32:54,055 [INFO]: {
2025-03-13 18:32:54,055 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:54,055 [INFO]: 	index_param: efSearch=224
2025-03-13 18:32:54,055 [INFO]: 	index_path: knn.index
2025-03-13 18:32:54,055 [INFO]: 	size in bytes: 403915390
2025-03-13 18:32:54,056 [INFO]: 	avg_search_speed_ms: 10.25435652034596
2025-03-13 18:32:54,056 [INFO]: 	99p_search_speed_ms: 14.908011071383951
2025-03-13 18:32:54,056 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:54,056 [INFO]: 	nb vectors: 2053
2025-03-13 18:32:54,056 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:54,056 [INFO]: 	compression ratio: 0.9993088503015446
2025-03-13 18:32:54,056 [INFO]: }
2025-03-13 18:32:54,056 [INFO]: 	>>> Finished "Creating the index" in 44.0163 secs
2025-03-13 18:32:54,056 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0505 secs
2025-03-13 18:32:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 68709 [episode count 12/20]
[retrieval_preprocessing] for episode 31339 [episode count 13/20], we have num_retrieval=np.int64(2045) num_query=np.int64(100)
2025-03-13 18:32:55,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:56,202 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:56
2025-03-13 18:32:56,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.30it/s]
2025-03-13 18:32:56,234 [INFO]: There are 2045 embeddings of dim 49152
2025-03-13 18:32:56,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 18:32:56,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:56,236 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:32:56,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:56,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:32:56,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,237 [INFO]: 422.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:56,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:32:56,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:56
2025-03-13 18:32:56,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:56,238 [INFO]: 	Creating the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:56
2025-03-13 18:32:56,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 18:32:56,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,242 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:32:56,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.97it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.16it/s]100%|██████████| 9/9 [00:02<00:00,  4.37it/s]
2025-03-13 18:32:58,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:58
2025-03-13 18:33:23,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6041 secs
2025-03-13 18:33:23,910 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 18:33:23,910 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 18:33:43,820 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9101 secs
2025-03-13 18:33:43,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5804 secs
2025-03-13 18:33:43,822 [INFO]: {
2025-03-13 18:33:43,822 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:43,822 [INFO]: 	index_param: efSearch=282
2025-03-13 18:33:43,822 [INFO]: 	index_path: knn.index
2025-03-13 18:33:43,822 [INFO]: 	size in bytes: 402341470
2025-03-13 18:33:43,822 [INFO]: 	avg_search_speed_ms: 11.532388972075529
2025-03-13 18:33:43,822 [INFO]: 	99p_search_speed_ms: 17.996472911909226
2025-03-13 18:33:43,822 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:43,822 [INFO]: 	nb vectors: 2045
2025-03-13 18:33:43,822 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:43,822 [INFO]: 	compression ratio: 0.9993087712285785
2025-03-13 18:33:43,822 [INFO]: }
2025-03-13 18:33:43,822 [INFO]: 	>>> Finished "Creating the index" in 47.5844 secs
2025-03-13 18:33:43,822 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6197 secs
2025-03-13 18:33:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 31339 [episode count 13/20]
[retrieval_preprocessing] for episode 38013 [episode count 14/20], we have num_retrieval=np.int64(2028) num_query=np.int64(117)
2025-03-13 18:33:44,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:45,120 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:45
2025-03-13 18:33:45,120 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.38it/s]
2025-03-13 18:33:45,146 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 18:33:45,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:33:45,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:45
2025-03-13 18:33:45,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:45,147 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:33:45,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:45,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:33:45,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:45
2025-03-13 18:33:45,147 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:45,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:33:45,147 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:45
2025-03-13 18:33:45,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:45,147 [INFO]: 	Creating the index 03/13/2025, 18:33:45
2025-03-13 18:33:45,147 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:45
2025-03-13 18:33:45,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:33:45,148 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:45
2025-03-13 18:33:45,148 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:33:45,148 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.14it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.31it/s]100%|██████████| 8/8 [00:01<00:00,  4.85it/s]
2025-03-13 18:33:46,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:46
2025-03-13 18:34:11,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7947 secs
2025-03-13 18:34:11,595 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 18:34:11,596 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 18:34:26,877 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2811 secs
2025-03-13 18:34:27,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0503 secs
2025-03-13 18:34:27,199 [INFO]: {
2025-03-13 18:34:27,199 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:27,199 [INFO]: 	index_param: efSearch=251
2025-03-13 18:34:27,199 [INFO]: 	index_path: knn.index
2025-03-13 18:34:27,199 [INFO]: 	size in bytes: 398996830
2025-03-13 18:34:27,199 [INFO]: 	avg_search_speed_ms: 10.907462021872206
2025-03-13 18:34:27,199 [INFO]: 	99p_search_speed_ms: 16.160342842340473
2025-03-13 18:34:27,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:27,199 [INFO]: 	nb vectors: 2028
2025-03-13 18:34:27,200 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:27,200 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 18:34:27,200 [INFO]: }
2025-03-13 18:34:27,200 [INFO]: 	>>> Finished "Creating the index" in 42.0525 secs
2025-03-13 18:34:27,200 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0798 secs
2025-03-13 18:34:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 38013 [episode count 14/20]
[retrieval_preprocessing] for episode 14976 [episode count 15/20], we have num_retrieval=np.int64(2049) num_query=np.int64(96)
2025-03-13 18:34:29,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:29,354 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:29
2025-03-13 18:34:29,354 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-13 18:34:29,384 [INFO]: There are 2049 embeddings of dim 49152
2025-03-13 18:34:29,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 18:34:29,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:29
2025-03-13 18:34:29,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:29,384 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:34:29,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:29,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:29,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:29
2025-03-13 18:34:29,384 [INFO]: 422.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:29,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:29,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:29
2025-03-13 18:34:29,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:29,385 [INFO]: 	Creating the index 03/13/2025, 18:34:29
2025-03-13 18:34:29,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:29
2025-03-13 18:34:29,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:34:29,386 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:29
2025-03-13 18:34:29,386 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:34:29,386 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.32it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.88it/s]100%|██████████| 9/9 [00:01<00:00,  6.18it/s]
2025-03-13 18:34:30,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:30
2025-03-13 18:34:55,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1475 secs
2025-03-13 18:34:55,993 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:34:55,993 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.42it/s]
2025-03-13 18:35:14,416 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4228 secs
2025-03-13 18:35:14,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0316 secs
2025-03-13 18:35:14,418 [INFO]: {
2025-03-13 18:35:14,418 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:14,418 [INFO]: 	index_param: efSearch=236
2025-03-13 18:35:14,418 [INFO]: 	index_path: knn.index
2025-03-13 18:35:14,418 [INFO]: 	size in bytes: 403128430
2025-03-13 18:35:14,418 [INFO]: 	avg_search_speed_ms: 9.972396299497392
2025-03-13 18:35:14,418 [INFO]: 	99p_search_speed_ms: 18.33103763870895
2025-03-13 18:35:14,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:14,418 [INFO]: 	nb vectors: 2049
2025-03-13 18:35:14,418 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:14,418 [INFO]: 	compression ratio: 0.999308810842242
2025-03-13 18:35:14,418 [INFO]: }
2025-03-13 18:35:14,418 [INFO]: 	>>> Finished "Creating the index" in 45.0332 secs
2025-03-13 18:35:14,418 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0638 secs
2025-03-13 18:35:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 14976 [episode count 15/20]
[retrieval_preprocessing] for episode 74372 [episode count 16/20], we have num_retrieval=np.int64(2063) num_query=np.int64(82)
2025-03-13 18:35:15,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:16,137 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:16
2025-03-13 18:35:16,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 18:35:16,162 [INFO]: There are 2063 embeddings of dim 49152
2025-03-13 18:35:16,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:35:16,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:16
2025-03-13 18:35:16,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:16,162 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:35:16,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:16,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:35:16,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:16
2025-03-13 18:35:16,163 [INFO]: 425.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:16,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:35:16,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:16
2025-03-13 18:35:16,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:16,163 [INFO]: 	Creating the index 03/13/2025, 18:35:16
2025-03-13 18:35:16,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:16
2025-03-13 18:35:16,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:35:16,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:16
2025-03-13 18:35:16,164 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:35:16,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.60it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.91it/s]100%|██████████| 9/9 [00:01<00:00,  5.93it/s]
2025-03-13 18:35:17,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:17
2025-03-13 18:35:42,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6857 secs
2025-03-13 18:35:42,373 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 18:35:42,373 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 18:36:07,550 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1772 secs
2025-03-13 18:36:07,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3880 secs
2025-03-13 18:36:07,552 [INFO]: {
2025-03-13 18:36:07,552 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:07,552 [INFO]: 	index_param: efSearch=299
2025-03-13 18:36:07,552 [INFO]: 	index_path: knn.index
2025-03-13 18:36:07,552 [INFO]: 	size in bytes: 405882790
2025-03-13 18:36:07,552 [INFO]: 	avg_search_speed_ms: 13.601016902374914
2025-03-13 18:36:07,552 [INFO]: 	99p_search_speed_ms: 20.126191759482026
2025-03-13 18:36:07,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:07,552 [INFO]: 	nb vectors: 2063
2025-03-13 18:36:07,552 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:07,552 [INFO]: 	compression ratio: 0.9993089482803644
2025-03-13 18:36:07,552 [INFO]: }
2025-03-13 18:36:07,552 [INFO]: 	>>> Finished "Creating the index" in 51.3893 secs
2025-03-13 18:36:07,552 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4149 secs
2025-03-13 18:36:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 74372 [episode count 16/20]
[retrieval_preprocessing] for episode 39573 [episode count 17/20], we have num_retrieval=np.int64(2056) num_query=np.int64(89)
2025-03-13 18:36:08,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:09,001 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:09
2025-03-13 18:36:09,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-13 18:36:09,029 [INFO]: There are 2056 embeddings of dim 49152
2025-03-13 18:36:09,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:36:09,030 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:09
2025-03-13 18:36:09,030 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:09,030 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:36:09,030 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:09,030 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:09,030 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:09
2025-03-13 18:36:09,030 [INFO]: 424.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:09,030 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:36:09,030 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:09
2025-03-13 18:36:09,030 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:09,030 [INFO]: 	Creating the index 03/13/2025, 18:36:09
2025-03-13 18:36:09,030 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:09
2025-03-13 18:36:09,031 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:36:09,032 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:09
2025-03-13 18:36:09,032 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:36:09,032 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.68it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.59it/s]100%|██████████| 9/9 [00:01<00:00,  5.60it/s]
2025-03-13 18:36:10,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:10
2025-03-13 18:36:42,929 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2873 secs
2025-03-13 18:36:42,930 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:36:42,930 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.41it/s]
2025-03-13 18:37:02,665 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7347 secs
2025-03-13 18:37:02,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6350 secs
2025-03-13 18:37:02,667 [INFO]: {
2025-03-13 18:37:02,667 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:02,667 [INFO]: 	index_param: efSearch=206
2025-03-13 18:37:02,667 [INFO]: 	index_path: knn.index
2025-03-13 18:37:02,667 [INFO]: 	size in bytes: 404505610
2025-03-13 18:37:02,667 [INFO]: 	avg_search_speed_ms: 9.119988362446644
2025-03-13 18:37:02,667 [INFO]: 	99p_search_speed_ms: 12.195229372009631
2025-03-13 18:37:02,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:02,667 [INFO]: 	nb vectors: 2056
2025-03-13 18:37:02,667 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:02,667 [INFO]: 	compression ratio: 0.9993088797952642
2025-03-13 18:37:02,667 [INFO]: }
2025-03-13 18:37:02,667 [INFO]: 	>>> Finished "Creating the index" in 53.6368 secs
2025-03-13 18:37:02,667 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6659 secs
2025-03-13 18:37:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 39573 [episode count 17/20]
[retrieval_preprocessing] for episode 94362 [episode count 18/20], we have num_retrieval=np.int64(2043) num_query=np.int64(102)
2025-03-13 18:37:03,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:03,986 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:03
2025-03-13 18:37:03,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1114.32it/s]
2025-03-13 18:37:04,012 [INFO]: There are 2043 embeddings of dim 49152
2025-03-13 18:37:04,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:37:04,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:04
2025-03-13 18:37:04,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:04,012 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:37:04,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:04,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:04,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:04
2025-03-13 18:37:04,013 [INFO]: 421.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:04,013 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:37:04,013 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:04
2025-03-13 18:37:04,013 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:04,013 [INFO]: 	Creating the index 03/13/2025, 18:37:04
2025-03-13 18:37:04,013 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:04
2025-03-13 18:37:04,014 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:37:04,014 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:04
2025-03-13 18:37:04,014 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:37:04,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.70it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.32it/s]100%|██████████| 9/9 [00:01<00:00,  4.99it/s]
2025-03-13 18:37:05,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:05
2025-03-13 18:37:36,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1979 secs
2025-03-13 18:37:36,020 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:37:36,020 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 18:37:51,416 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3963 secs
2025-03-13 18:37:51,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4035 secs
2025-03-13 18:37:51,418 [INFO]: {
2025-03-13 18:37:51,418 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:51,418 [INFO]: 	index_param: efSearch=213
2025-03-13 18:37:51,418 [INFO]: 	index_path: knn.index
2025-03-13 18:37:51,418 [INFO]: 	size in bytes: 401947990
2025-03-13 18:37:51,418 [INFO]: 	avg_search_speed_ms: 9.928807982242672
2025-03-13 18:37:51,418 [INFO]: 	99p_search_speed_ms: 13.857434135861695
2025-03-13 18:37:51,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:51,418 [INFO]: 	nb vectors: 2043
2025-03-13 18:37:51,418 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:51,418 [INFO]: 	compression ratio: 0.9993087513635781
2025-03-13 18:37:51,418 [INFO]: }
2025-03-13 18:37:51,418 [INFO]: 	>>> Finished "Creating the index" in 47.4051 secs
2025-03-13 18:37:51,418 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4319 secs
2025-03-13 18:37:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 94362 [episode count 18/20]
[retrieval_preprocessing] for episode 62630 [episode count 19/20], we have num_retrieval=np.int64(2024) num_query=np.int64(121)
2025-03-13 18:37:52,369 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:52,663 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:52
2025-03-13 18:37:52,663 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2091.92it/s]
2025-03-13 18:37:52,692 [INFO]: There are 2024 embeddings of dim 49152
2025-03-13 18:37:52,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:37:52,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:52
2025-03-13 18:37:52,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:52,692 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:37:52,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:52,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:37:52,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:52
2025-03-13 18:37:52,693 [INFO]: 417.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:52,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:37:52,693 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:52
2025-03-13 18:37:52,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:52,694 [INFO]: 	Creating the index 03/13/2025, 18:37:52
2025-03-13 18:37:52,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:52
2025-03-13 18:37:52,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:37:52,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:52
2025-03-13 18:37:52,697 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:37:52,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.00it/s]100%|██████████| 8/8 [00:01<00:00,  4.29it/s]100%|██████████| 8/8 [00:01<00:00,  4.73it/s]
2025-03-13 18:37:54,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:54
2025-03-13 18:38:18,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2039 secs
2025-03-13 18:38:18,597 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:38:18,597 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 20.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-13 18:38:48,607 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0099 secs
2025-03-13 18:38:48,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9128 secs
2025-03-13 18:38:48,610 [INFO]: {
2025-03-13 18:38:48,610 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:48,610 [INFO]: 	index_param: efSearch=268
2025-03-13 18:38:48,610 [INFO]: 	index_path: knn.index
2025-03-13 18:38:48,610 [INFO]: 	size in bytes: 398209870
2025-03-13 18:38:48,610 [INFO]: 	avg_search_speed_ms: 10.486049357210081
2025-03-13 18:38:48,610 [INFO]: 	99p_search_speed_ms: 14.329809981863946
2025-03-13 18:38:48,610 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:48,610 [INFO]: 	nb vectors: 2024
2025-03-13 18:38:48,610 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:48,610 [INFO]: 	compression ratio: 0.9993087112582116
2025-03-13 18:38:48,610 [INFO]: }
2025-03-13 18:38:48,610 [INFO]: 	>>> Finished "Creating the index" in 55.9165 secs
2025-03-13 18:38:48,610 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9474 secs
2025-03-13 18:38:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 62630 [episode count 19/20]
2025-03-13 18:38:49: [retrieval_preprocessing] finished for 4329524892_put_orange_cup_in_black_bowl [chosen_id count 8/196]
2025-03-13 18:38:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_put_lid_on_pot [chosen_id count 9/196]
2025-03-13 18:38:51: [retrieval_preprocessing] we have num_total=4197 embedding_dim=49152
[retrieval_preprocessing] for episode 20992 [episode count 0/20], we have num_retrieval=np.int64(4003) num_query=np.int64(194)
2025-03-13 18:38:51,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:52,749 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:52
2025-03-13 18:38:52,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1257.66it/s]
2025-03-13 18:38:53,482 [INFO]: There are 4003 embeddings of dim 49152
2025-03-13 18:38:53,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7332 secs
2025-03-13 18:38:53,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:53
2025-03-13 18:38:53,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:53,483 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:38:53,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:53,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:38:53,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:53
2025-03-13 18:38:53,484 [INFO]: 826.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:53,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:38:53,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:53
2025-03-13 18:38:53,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:53,485 [INFO]: 	Creating the index 03/13/2025, 18:38:53
2025-03-13 18:38:53,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:53
2025-03-13 18:38:53,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:38:53,488 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:53
2025-03-13 18:38:53,489 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:38:53,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.86it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.56it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.62it/s]100%|██████████| 16/16 [00:02<00:00,  5.49it/s]
2025-03-13 18:38:56,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:56
2025-03-13 18:39:50,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3573 secs
2025-03-13 18:39:50,766 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:39:50,766 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-13 18:40:09,585 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8192 secs
2025-03-13 18:40:09,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0994 secs
2025-03-13 18:40:09,588 [INFO]: {
2025-03-13 18:40:09,588 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:09,588 [INFO]: 	index_param: efSearch=220
2025-03-13 18:40:09,588 [INFO]: 	index_path: knn.index
2025-03-13 18:40:09,588 [INFO]: 	size in bytes: 787566370
2025-03-13 18:40:09,588 [INFO]: 	avg_search_speed_ms: 7.964054602687692
2025-03-13 18:40:09,588 [INFO]: 	99p_search_speed_ms: 11.25590445008129
2025-03-13 18:40:09,588 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:09,588 [INFO]: 	nb vectors: 4003
2025-03-13 18:40:09,588 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:09,588 [INFO]: 	compression ratio: 0.9993085712890458
2025-03-13 18:40:09,588 [INFO]: }
2025-03-13 18:40:09,588 [INFO]: 	>>> Finished "Creating the index" in 76.1037 secs
2025-03-13 18:40:09,588 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8389 secs
2025-03-13 18:40:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20992 [episode count 0/20]
[retrieval_preprocessing] for episode 38412 [episode count 1/20], we have num_retrieval=np.int64(3879) num_query=np.int64(318)
2025-03-13 18:40:11,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:12,087 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:12
2025-03-13 18:40:12,087 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1881.70it/s]
2025-03-13 18:40:12,114 [INFO]: There are 3879 embeddings of dim 49152
2025-03-13 18:40:12,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 18:40:12,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:12
2025-03-13 18:40:12,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:12,116 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:40:12,116 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:12,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:40:12,116 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:12
2025-03-13 18:40:12,116 [INFO]: 800.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:12,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:40:12,117 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:12
2025-03-13 18:40:12,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:12,117 [INFO]: 	Creating the index 03/13/2025, 18:40:12
2025-03-13 18:40:12,117 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:12
2025-03-13 18:40:12,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:40:12,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:12
2025-03-13 18:40:12,118 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:40:12,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.55it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.38it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.31it/s]100%|██████████| 16/16 [00:03<00:00,  3.68it/s]100%|██████████| 16/16 [00:03<00:00,  4.94it/s]
2025-03-13 18:40:15,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:15
2025-03-13 18:41:06,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8142 secs
2025-03-13 18:41:06,176 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 18:41:06,176 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 18:41:33,593 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4168 secs
2025-03-13 18:41:33,595 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4768 secs
2025-03-13 18:41:33,595 [INFO]: {
2025-03-13 18:41:33,595 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:33,595 [INFO]: 	index_param: efSearch=200
2025-03-13 18:41:33,595 [INFO]: 	index_path: knn.index
2025-03-13 18:41:33,595 [INFO]: 	size in bytes: 763169830
2025-03-13 18:41:33,595 [INFO]: 	avg_search_speed_ms: 9.541273464089729
2025-03-13 18:41:33,595 [INFO]: 	99p_search_speed_ms: 15.094783809036015
2025-03-13 18:41:33,595 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:33,595 [INFO]: 	nb vectors: 3879
2025-03-13 18:41:33,595 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:33,595 [INFO]: 	compression ratio: 0.9993089375663605
2025-03-13 18:41:33,595 [INFO]: }
2025-03-13 18:41:33,596 [INFO]: 	>>> Finished "Creating the index" in 81.4786 secs
2025-03-13 18:41:33,596 [INFO]: >>> Finished "Launching the whole pipeline" in 81.5088 secs
2025-03-13 18:41:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 38412 [episode count 1/20]
[retrieval_preprocessing] for episode 1046 [episode count 2/20], we have num_retrieval=np.int64(3958) num_query=np.int64(239)
2025-03-13 18:41:35,979 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:36,517 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:36
2025-03-13 18:41:36,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.55it/s]
2025-03-13 18:41:36,546 [INFO]: There are 3958 embeddings of dim 49152
2025-03-13 18:41:36,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 18:41:36,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:36,547 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:41:36,547 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:36,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:36,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,547 [INFO]: 816.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:36,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:41:36,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:36
2025-03-13 18:41:36,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:36,547 [INFO]: 	Creating the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:36
2025-03-13 18:41:36,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:41:36,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,548 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:41:36,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.80it/s] 50%|█████     | 8/16 [00:00<00:00, 36.80it/s] 81%|████████▏ | 13/16 [00:00<00:00, 40.10it/s]100%|██████████| 16/16 [00:03<00:00,  5.03it/s]
2025-03-13 18:41:39,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:39
2025-03-13 18:42:29,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0584 secs
2025-03-13 18:42:29,794 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 18:42:29,795 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.10it/s]
2025-03-13 18:42:50,557 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7621 secs
2025-03-13 18:42:50,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.3197 secs
2025-03-13 18:42:50,868 [INFO]: {
2025-03-13 18:42:50,869 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:50,869 [INFO]: 	index_param: efSearch=180
2025-03-13 18:42:50,869 [INFO]: 	index_path: knn.index
2025-03-13 18:42:50,869 [INFO]: 	size in bytes: 778712950
2025-03-13 18:42:50,869 [INFO]: 	avg_search_speed_ms: 8.952881073560865
2025-03-13 18:42:50,869 [INFO]: 	99p_search_speed_ms: 15.715802316553852
2025-03-13 18:42:50,869 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:50,869 [INFO]: 	nb vectors: 3958
2025-03-13 18:42:50,869 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:50,869 [INFO]: 	compression ratio: 0.999308492301303
2025-03-13 18:42:50,869 [INFO]: }
2025-03-13 18:42:50,869 [INFO]: 	>>> Finished "Creating the index" in 74.3220 secs
2025-03-13 18:42:50,869 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3521 secs
2025-03-13 18:42:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 1046 [episode count 2/20]
[retrieval_preprocessing] for episode 20005 [episode count 3/20], we have num_retrieval=np.int64(4031) num_query=np.int64(166)
2025-03-13 18:42:53,851 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:54,619 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:54
2025-03-13 18:42:54,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.85it/s]
2025-03-13 18:42:54,656 [INFO]: There are 4031 embeddings of dim 49152
2025-03-13 18:42:54,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 18:42:54,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:54
2025-03-13 18:42:54,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:54,657 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:42:54,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:54,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:42:54,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:54
2025-03-13 18:42:54,658 [INFO]: 831.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:54,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:42:54,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:54
2025-03-13 18:42:54,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:54,658 [INFO]: 	Creating the index 03/13/2025, 18:42:54
2025-03-13 18:42:54,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:54
2025-03-13 18:42:54,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:42:54,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:54
2025-03-13 18:42:54,663 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:42:54,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.82it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.71it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.56it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.97it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.31it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.69it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.12it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.50it/s]100%|██████████| 16/16 [00:04<00:00,  3.69it/s]
2025-03-13 18:42:59,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:59
2025-03-13 18:43:52,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.0358 secs
2025-03-13 18:43:52,047 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:43:52,047 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 18:44:10,769 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7220 secs
2025-03-13 18:44:10,772 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1099 secs
2025-03-13 18:44:10,773 [INFO]: {
2025-03-13 18:44:10,773 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:10,773 [INFO]: 	index_param: efSearch=204
2025-03-13 18:44:10,773 [INFO]: 	index_path: knn.index
2025-03-13 18:44:10,773 [INFO]: 	size in bytes: 793075210
2025-03-13 18:44:10,773 [INFO]: 	avg_search_speed_ms: 7.910425438585432
2025-03-13 18:44:10,773 [INFO]: 	99p_search_speed_ms: 19.066544943489124
2025-03-13 18:44:10,773 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:10,773 [INFO]: 	nb vectors: 4031
2025-03-13 18:44:10,773 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:10,773 [INFO]: 	compression ratio: 0.9993085624249937
2025-03-13 18:44:10,773 [INFO]: }
2025-03-13 18:44:10,773 [INFO]: 	>>> Finished "Creating the index" in 76.1142 secs
2025-03-13 18:44:10,773 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1532 secs
2025-03-13 18:44:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 20005 [episode count 3/20]
[retrieval_preprocessing] for episode 37953 [episode count 4/20], we have num_retrieval=np.int64(4013) num_query=np.int64(184)
2025-03-13 18:44:13,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:14,089 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:14
2025-03-13 18:44:14,089 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.37it/s]
2025-03-13 18:44:14,116 [INFO]: There are 4013 embeddings of dim 49152
2025-03-13 18:44:14,116 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:44:14,116 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:14
2025-03-13 18:44:14,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:14,116 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:44:14,116 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:14,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:44:14,116 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:14
2025-03-13 18:44:14,116 [INFO]: 828.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:14,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:44:14,116 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:14
2025-03-13 18:44:14,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:14,116 [INFO]: 	Creating the index 03/13/2025, 18:44:14
2025-03-13 18:44:14,116 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:14
2025-03-13 18:44:14,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:44:14,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:14
2025-03-13 18:44:14,118 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:44:14,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.10it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.66it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.42it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.06it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.22it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.44it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.49it/s] 50%|█████     | 8/16 [00:00<00:00,  8.79it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.29it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.65it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.70it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.59it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.69it/s]100%|██████████| 16/16 [00:04<00:00,  1.08it/s]100%|██████████| 16/16 [00:04<00:00,  3.30it/s]
2025-03-13 18:44:18,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:18
2025-03-13 18:45:03,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9161 secs
2025-03-13 18:45:03,894 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:45:03,894 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 18:45:30,203 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3089 secs
2025-03-13 18:45:30,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0885 secs
2025-03-13 18:45:30,207 [INFO]: {
2025-03-13 18:45:30,207 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:30,207 [INFO]: 	index_param: efSearch=256
2025-03-13 18:45:30,207 [INFO]: 	index_path: knn.index
2025-03-13 18:45:30,207 [INFO]: 	size in bytes: 789533890
2025-03-13 18:45:30,207 [INFO]: 	avg_search_speed_ms: 12.505515030643437
2025-03-13 18:45:30,207 [INFO]: 	99p_search_speed_ms: 27.093576479237516
2025-03-13 18:45:30,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:30,207 [INFO]: 	nb vectors: 4013
2025-03-13 18:45:30,207 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:30,207 [INFO]: 	compression ratio: 0.9993084704698363
2025-03-13 18:45:30,207 [INFO]: }
2025-03-13 18:45:30,207 [INFO]: 	>>> Finished "Creating the index" in 76.0906 secs
2025-03-13 18:45:30,207 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1178 secs
2025-03-13 18:45:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 37953 [episode count 4/20]
[retrieval_preprocessing] for episode 60492 [episode count 5/20], we have num_retrieval=np.int64(3956) num_query=np.int64(241)
2025-03-13 18:45:34,462 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:35,027 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:35
2025-03-13 18:45:35,027 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.21it/s]
2025-03-13 18:45:35,053 [INFO]: There are 3956 embeddings of dim 49152
2025-03-13 18:45:35,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:45:35,054 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:35
2025-03-13 18:45:35,054 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:35,054 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:45:35,054 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:35,054 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:35,054 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:35
2025-03-13 18:45:35,054 [INFO]: 816.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:35,054 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:45:35,054 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:35
2025-03-13 18:45:35,054 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:35,054 [INFO]: 	Creating the index 03/13/2025, 18:45:35
2025-03-13 18:45:35,054 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:35
2025-03-13 18:45:35,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:45:35,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:35
2025-03-13 18:45:35,055 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:45:35,056 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.08it/s] 19%|█▉        | 3/16 [00:00<00:01, 12.32it/s] 31%|███▏      | 5/16 [00:00<00:00, 13.82it/s] 44%|████▍     | 7/16 [00:00<00:00, 13.59it/s] 56%|█████▋    | 9/16 [00:00<00:00, 13.28it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.79it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.85it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.66it/s]100%|██████████| 16/16 [00:04<00:00,  3.51it/s]
2025-03-13 18:45:39,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:39
2025-03-13 18:46:18,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9496 secs
2025-03-13 18:46:18,568 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 18:46:18,568 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 18:46:47,601 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0330 secs
2025-03-13 18:46:47,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5488 secs
2025-03-13 18:46:47,604 [INFO]: {
2025-03-13 18:46:47,604 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:47,604 [INFO]: 	index_param: efSearch=284
2025-03-13 18:46:47,604 [INFO]: 	index_path: knn.index
2025-03-13 18:46:47,604 [INFO]: 	size in bytes: 778319470
2025-03-13 18:46:47,605 [INFO]: 	avg_search_speed_ms: 9.198147631545911
2025-03-13 18:46:47,605 [INFO]: 	99p_search_speed_ms: 13.449156032875184
2025-03-13 18:46:47,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:47,605 [INFO]: 	nb vectors: 3956
2025-03-13 18:46:47,605 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:47,605 [INFO]: 	compression ratio: 0.9993084819013971
2025-03-13 18:46:47,605 [INFO]: }
2025-03-13 18:46:47,605 [INFO]: 	>>> Finished "Creating the index" in 72.5506 secs
2025-03-13 18:46:47,605 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5778 secs
2025-03-13 18:46:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 60492 [episode count 5/20]
[retrieval_preprocessing] for episode 54354 [episode count 6/20], we have num_retrieval=np.int64(3974) num_query=np.int64(223)
2025-03-13 18:46:51,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:51,810 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:51
2025-03-13 18:46:51,810 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 18:46:51,835 [INFO]: There are 3974 embeddings of dim 49152
2025-03-13 18:46:51,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 18:46:51,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:51
2025-03-13 18:46:51,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:51,835 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:46:51,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:51,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:51,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:51
2025-03-13 18:46:51,835 [INFO]: 820.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:51,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:51,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:51
2025-03-13 18:46:51,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:51,835 [INFO]: 	Creating the index 03/13/2025, 18:46:51
2025-03-13 18:46:51,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:51
2025-03-13 18:46:51,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:46:51,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:51
2025-03-13 18:46:51,837 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:46:51,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.16it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.67it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.75it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.20it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.43it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.43it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.42it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.49it/s]100%|██████████| 16/16 [00:04<00:00,  3.67it/s]
2025-03-13 18:46:56,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:56
2025-03-13 18:47:32,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9000 secs
2025-03-13 18:47:32,098 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:47:32,098 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 18:47:57,135 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0366 secs
2025-03-13 18:47:57,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3010 secs
2025-03-13 18:47:57,138 [INFO]: {
2025-03-13 18:47:57,138 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:57,138 [INFO]: 	index_param: efSearch=220
2025-03-13 18:47:57,138 [INFO]: 	index_path: knn.index
2025-03-13 18:47:57,138 [INFO]: 	size in bytes: 781860790
2025-03-13 18:47:57,138 [INFO]: 	avg_search_speed_ms: 9.03868750801988
2025-03-13 18:47:57,138 [INFO]: 	99p_search_speed_ms: 13.542665634304287
2025-03-13 18:47:57,138 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:57,138 [INFO]: 	nb vectors: 3974
2025-03-13 18:47:57,138 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:57,138 [INFO]: 	compression ratio: 0.9993085751237123
2025-03-13 18:47:57,138 [INFO]: }
2025-03-13 18:47:57,138 [INFO]: 	>>> Finished "Creating the index" in 65.3025 secs
2025-03-13 18:47:57,138 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3278 secs
2025-03-13 18:47:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 54354 [episode count 6/20]
[retrieval_preprocessing] for episode 85081 [episode count 7/20], we have num_retrieval=np.int64(4000) num_query=np.int64(197)
2025-03-13 18:48:00,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:01,836 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:01
2025-03-13 18:48:01,836 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2102.41it/s]
2025-03-13 18:48:01,863 [INFO]: There are 4000 embeddings of dim 49152
2025-03-13 18:48:01,864 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:48:01,864 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,864 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:01,864 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:48:01,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:01,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:48:01,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,865 [INFO]: 825.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:01,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:48:01,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:01
2025-03-13 18:48:01,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:01,866 [INFO]: 	Creating the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,866 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:01
2025-03-13 18:48:01,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 18:48:01,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,868 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:48:01,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.22it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.72it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.38it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.25it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.36it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.45it/s] 50%|█████     | 8/16 [00:00<00:00,  8.67it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.89it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.96it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.99it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.87it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.79it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.83it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.76it/s]100%|██████████| 16/16 [00:05<00:00,  1.13s/it]100%|██████████| 16/16 [00:05<00:00,  3.06it/s]
2025-03-13 18:48:07,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:07
2025-03-13 18:48:51,176 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0580 secs
2025-03-13 18:48:51,176 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 18:48:51,176 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 18:49:13,986 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8097 secs
2025-03-13 18:49:13,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1208 secs
2025-03-13 18:49:13,989 [INFO]: {
2025-03-13 18:49:13,989 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:13,989 [INFO]: 	index_param: efSearch=274
2025-03-13 18:49:13,989 [INFO]: 	index_path: knn.index
2025-03-13 18:49:13,989 [INFO]: 	size in bytes: 786976150
2025-03-13 18:49:13,989 [INFO]: 	avg_search_speed_ms: 9.92484945879643
2025-03-13 18:49:13,989 [INFO]: 	99p_search_speed_ms: 16.06638482771813
2025-03-13 18:49:13,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:13,989 [INFO]: 	nb vectors: 4000
2025-03-13 18:49:13,989 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:13,989 [INFO]: 	compression ratio: 0.9993085559200238
2025-03-13 18:49:13,989 [INFO]: }
2025-03-13 18:49:13,989 [INFO]: 	>>> Finished "Creating the index" in 72.1236 secs
2025-03-13 18:49:13,989 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1530 secs
2025-03-13 18:49:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 85081 [episode count 7/20]
[retrieval_preprocessing] for episode 92762 [episode count 8/20], we have num_retrieval=np.int64(3982) num_query=np.int64(215)
2025-03-13 18:49:17,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:18,466 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:18
2025-03-13 18:49:18,466 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.80it/s]
2025-03-13 18:49:18,489 [INFO]: There are 3982 embeddings of dim 49152
2025-03-13 18:49:18,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 18:49:18,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:18
2025-03-13 18:49:18,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:18,489 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:49:18,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:18,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:49:18,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:18
2025-03-13 18:49:18,489 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:18,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:49:18,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:18
2025-03-13 18:49:18,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:18,490 [INFO]: 	Creating the index 03/13/2025, 18:49:18
2025-03-13 18:49:18,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:18
2025-03-13 18:49:18,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:49:18,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:18
2025-03-13 18:49:18,491 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:49:18,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.50it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.28it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.51it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.17it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.43it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.64it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.80it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.68it/s]100%|██████████| 16/16 [00:03<00:00,  4.19it/s]
2025-03-13 18:49:22,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:22
2025-03-13 18:49:57,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3601 secs
2025-03-13 18:49:57,681 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 18:49:57,681 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
2025-03-13 18:50:19,571 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8906 secs
2025-03-13 18:50:19,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0846 secs
2025-03-13 18:50:19,576 [INFO]: {
2025-03-13 18:50:19,576 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:19,576 [INFO]: 	index_param: efSearch=295
2025-03-13 18:50:19,576 [INFO]: 	index_path: knn.index
2025-03-13 18:50:19,576 [INFO]: 	size in bytes: 783434770
2025-03-13 18:50:19,576 [INFO]: 	avg_search_speed_ms: 11.202644247797393
2025-03-13 18:50:19,576 [INFO]: 	99p_search_speed_ms: 18.40263451449574
2025-03-13 18:50:19,576 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:19,576 [INFO]: 	nb vectors: 3982
2025-03-13 18:50:19,576 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:19,576 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-13 18:50:19,576 [INFO]: }
2025-03-13 18:50:19,576 [INFO]: 	>>> Finished "Creating the index" in 61.0861 secs
2025-03-13 18:50:19,576 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1096 secs
2025-03-13 18:50:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 92762 [episode count 8/20]
[retrieval_preprocessing] for episode 58998 [episode count 9/20], we have num_retrieval=np.int64(3982) num_query=np.int64(215)
2025-03-13 18:50:23,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:24,095 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:24
2025-03-13 18:50:24,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 18:50:24,122 [INFO]: There are 3982 embeddings of dim 49152
2025-03-13 18:50:24,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:50:24,122 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:24
2025-03-13 18:50:24,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:24,122 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:50:24,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:24,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:24,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:24
2025-03-13 18:50:24,122 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:24,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:24,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:24
2025-03-13 18:50:24,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:24,122 [INFO]: 	Creating the index 03/13/2025, 18:50:24
2025-03-13 18:50:24,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:24
2025-03-13 18:50:24,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:50:24,124 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:24
2025-03-13 18:50:24,124 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:50:24,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.58it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.36it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.91it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.40it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.31it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.38it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.54it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.50it/s]100%|██████████| 16/16 [00:04<00:00,  3.71it/s]
2025-03-13 18:50:28,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:28
2025-03-13 18:51:04,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1412 secs
2025-03-13 18:51:04,586 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 18:51:04,586 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 18:51:31,282 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6961 secs
2025-03-13 18:51:31,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1617 secs
2025-03-13 18:51:31,286 [INFO]: {
2025-03-13 18:51:31,286 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:31,286 [INFO]: 	index_param: efSearch=273
2025-03-13 18:51:31,286 [INFO]: 	index_path: knn.index
2025-03-13 18:51:31,286 [INFO]: 	size in bytes: 783434770
2025-03-13 18:51:31,286 [INFO]: 	avg_search_speed_ms: 9.998001616215333
2025-03-13 18:51:31,286 [INFO]: 	99p_search_speed_ms: 17.149076086934656
2025-03-13 18:51:31,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:31,286 [INFO]: 	nb vectors: 3982
2025-03-13 18:51:31,286 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:31,286 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-13 18:51:31,286 [INFO]: }
2025-03-13 18:51:31,286 [INFO]: 	>>> Finished "Creating the index" in 67.1636 secs
2025-03-13 18:51:31,286 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1909 secs
2025-03-13 18:51:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 58998 [episode count 9/20]
[retrieval_preprocessing] for episode 15511 [episode count 10/20], we have num_retrieval=np.int64(3961) num_query=np.int64(236)
2025-03-13 18:51:34,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:35,621 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:35
2025-03-13 18:51:35,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-13 18:51:35,647 [INFO]: There are 3961 embeddings of dim 49152
2025-03-13 18:51:35,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:51:35,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:35
2025-03-13 18:51:35,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:35,648 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:51:35,648 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:35,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:51:35,648 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:35
2025-03-13 18:51:35,648 [INFO]: 817.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:35,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:51:35,648 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:35
2025-03-13 18:51:35,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:35,648 [INFO]: 	Creating the index 03/13/2025, 18:51:35
2025-03-13 18:51:35,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:35
2025-03-13 18:51:35,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:51:35,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:35
2025-03-13 18:51:35,649 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:51:35,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.79it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.46it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.18it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.94it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.36it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.50it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.67it/s] 50%|█████     | 8/16 [00:00<00:00,  8.73it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.18it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.20it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.23it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.41it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.14it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.03it/s]100%|██████████| 16/16 [00:05<00:00,  1.19s/it]100%|██████████| 16/16 [00:05<00:00,  2.87it/s]
2025-03-13 18:51:41,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:41
2025-03-13 18:52:18,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3788 secs
2025-03-13 18:52:18,604 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 18:52:18,604 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 18:52:48,203 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5989 secs
2025-03-13 18:52:48,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5564 secs
2025-03-13 18:52:48,206 [INFO]: {
2025-03-13 18:52:48,206 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:48,206 [INFO]: 	index_param: efSearch=243
2025-03-13 18:52:48,206 [INFO]: 	index_path: knn.index
2025-03-13 18:52:48,206 [INFO]: 	size in bytes: 779303170
2025-03-13 18:52:48,206 [INFO]: 	avg_search_speed_ms: 9.862526305455207
2025-03-13 18:52:48,206 [INFO]: 	99p_search_speed_ms: 15.23695273557678
2025-03-13 18:52:48,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:48,206 [INFO]: 	nb vectors: 3961
2025-03-13 18:52:48,206 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:48,206 [INFO]: 	compression ratio: 0.9993085078814705
2025-03-13 18:52:48,206 [INFO]: }
2025-03-13 18:52:48,206 [INFO]: 	>>> Finished "Creating the index" in 72.5581 secs
2025-03-13 18:52:48,206 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5852 secs
2025-03-13 18:52:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 15511 [episode count 10/20]
[retrieval_preprocessing] for episode 84120 [episode count 11/20], we have num_retrieval=np.int64(4000) num_query=np.int64(197)
2025-03-13 18:52:52,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:52,819 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:52
2025-03-13 18:52:52,819 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1671.70it/s]
2025-03-13 18:52:52,842 [INFO]: There are 4000 embeddings of dim 49152
2025-03-13 18:52:52,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 18:52:52,842 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:52,842 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:52:52,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:52,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:52,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,842 [INFO]: 825.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:52,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:52:52,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:52
2025-03-13 18:52:52,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:52,842 [INFO]: 	Creating the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:52
2025-03-13 18:52:52,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:52:52,844 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,844 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:52:52,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.08it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.38it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.30it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.80it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.17it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.65it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.16it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.14it/s]100%|██████████| 16/16 [00:04<00:00,  3.30it/s]
2025-03-13 18:52:57,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:57
2025-03-13 18:53:35,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4567 secs
2025-03-13 18:53:35,151 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 18:53:35,151 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s]
2025-03-13 18:54:01,784 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6329 secs
2025-03-13 18:54:01,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9432 secs
2025-03-13 18:54:01,787 [INFO]: {
2025-03-13 18:54:01,787 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:01,787 [INFO]: 	index_param: efSearch=280
2025-03-13 18:54:01,787 [INFO]: 	index_path: knn.index
2025-03-13 18:54:01,787 [INFO]: 	size in bytes: 786976150
2025-03-13 18:54:01,787 [INFO]: 	avg_search_speed_ms: 9.782868936619632
2025-03-13 18:54:01,787 [INFO]: 	99p_search_speed_ms: 13.420477099716654
2025-03-13 18:54:01,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:01,787 [INFO]: 	nb vectors: 4000
2025-03-13 18:54:01,787 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:01,787 [INFO]: 	compression ratio: 0.9993085559200238
2025-03-13 18:54:01,787 [INFO]: }
2025-03-13 18:54:01,788 [INFO]: 	>>> Finished "Creating the index" in 68.9451 secs
2025-03-13 18:54:01,788 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9684 secs
2025-03-13 18:54:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 84120 [episode count 11/20]
[retrieval_preprocessing] for episode 47793 [episode count 12/20], we have num_retrieval=np.int64(3991) num_query=np.int64(206)
2025-03-13 18:54:06,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:07,020 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:07
2025-03-13 18:54:07,020 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.01it/s]
2025-03-13 18:54:07,043 [INFO]: There are 3991 embeddings of dim 49152
2025-03-13 18:54:07,043 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 18:54:07,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:07
2025-03-13 18:54:07,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:07,043 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:54:07,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:07,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:07,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:07
2025-03-13 18:54:07,043 [INFO]: 823.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:07,043 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:54:07,043 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:07
2025-03-13 18:54:07,043 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:07,043 [INFO]: 	Creating the index 03/13/2025, 18:54:07
2025-03-13 18:54:07,043 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:07
2025-03-13 18:54:07,044 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:54:07,044 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:07
2025-03-13 18:54:07,044 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:54:07,044 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.42it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.03it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.57it/s] 44%|████▍     | 7/16 [00:00<00:00, 13.83it/s] 56%|█████▋    | 9/16 [00:00<00:00, 15.08it/s] 69%|██████▉   | 11/16 [00:00<00:00, 16.26it/s] 81%|████████▏ | 13/16 [00:00<00:00, 16.99it/s] 94%|█████████▍| 15/16 [00:00<00:00, 17.30it/s]100%|██████████| 16/16 [00:04<00:00,  4.00it/s]
2025-03-13 18:54:11,054 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:11
2025-03-13 18:54:49,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7135 secs
2025-03-13 18:54:49,768 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 18:54:49,768 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.29it/s]
2025-03-13 18:55:12,362 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5934 secs
2025-03-13 18:55:12,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6254 secs
2025-03-13 18:55:12,670 [INFO]: {
2025-03-13 18:55:12,670 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:12,670 [INFO]: 	index_param: efSearch=314
2025-03-13 18:55:12,670 [INFO]: 	index_path: knn.index
2025-03-13 18:55:12,671 [INFO]: 	size in bytes: 785205430
2025-03-13 18:55:12,671 [INFO]: 	avg_search_speed_ms: 11.301195841956105
2025-03-13 18:55:12,671 [INFO]: 	99p_search_speed_ms: 19.544531889259776
2025-03-13 18:55:12,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:12,671 [INFO]: 	nb vectors: 3991
2025-03-13 18:55:12,671 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:12,671 [INFO]: 	compression ratio: 0.9993085860346126
2025-03-13 18:55:12,671 [INFO]: }
2025-03-13 18:55:12,671 [INFO]: 	>>> Finished "Creating the index" in 65.6276 secs
2025-03-13 18:55:12,671 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6507 secs
2025-03-13 18:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 47793 [episode count 12/20]
[retrieval_preprocessing] for episode 42292 [episode count 13/20], we have num_retrieval=np.int64(4005) num_query=np.int64(192)
2025-03-13 18:55:16,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:16,738 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:16
2025-03-13 18:55:16,738 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.24it/s]
2025-03-13 18:55:16,763 [INFO]: There are 4005 embeddings of dim 49152
2025-03-13 18:55:16,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:55:16,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:16
2025-03-13 18:55:16,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:16,763 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:55:16,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:16,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:16,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:16
2025-03-13 18:55:16,763 [INFO]: 826.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:16,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:55:16,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:16
2025-03-13 18:55:16,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:16,763 [INFO]: 	Creating the index 03/13/2025, 18:55:16
2025-03-13 18:55:16,764 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:16
2025-03-13 18:55:16,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:55:16,765 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:16
2025-03-13 18:55:16,765 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:55:16,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.03it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.46it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.05it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.31it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.50it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.68it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.74it/s] 50%|█████     | 8/16 [00:01<00:01,  7.73it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.68it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.61it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.62it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.96it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.26it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.19it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.16it/s]100%|██████████| 16/16 [00:05<00:00,  1.16s/it]100%|██████████| 16/16 [00:05<00:00,  2.89it/s]
2025-03-13 18:55:22,301 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:22
2025-03-13 18:56:02,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1237 secs
2025-03-13 18:56:02,425 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 18:56:02,425 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 18:56:28,563 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1377 secs
2025-03-13 18:56:28,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8007 secs
2025-03-13 18:56:28,565 [INFO]: {
2025-03-13 18:56:28,565 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:28,565 [INFO]: 	index_param: efSearch=301
2025-03-13 18:56:28,565 [INFO]: 	index_path: knn.index
2025-03-13 18:56:28,566 [INFO]: 	size in bytes: 787959850
2025-03-13 18:56:28,566 [INFO]: 	avg_search_speed_ms: 10.923296956123792
2025-03-13 18:56:28,566 [INFO]: 	99p_search_speed_ms: 18.99426701711491
2025-03-13 18:56:28,566 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:28,566 [INFO]: 	nb vectors: 4005
2025-03-13 18:56:28,566 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:28,566 [INFO]: 	compression ratio: 0.9993085815222692
2025-03-13 18:56:28,566 [INFO]: }
2025-03-13 18:56:28,566 [INFO]: 	>>> Finished "Creating the index" in 71.8021 secs
2025-03-13 18:56:28,566 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8280 secs
2025-03-13 18:56:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 42292 [episode count 13/20]
[retrieval_preprocessing] for episode 31078 [episode count 14/20], we have num_retrieval=np.int64(4006) num_query=np.int64(191)
2025-03-13 18:56:32,209 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:32,851 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:32
2025-03-13 18:56:32,851 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2186.81it/s]
2025-03-13 18:56:32,877 [INFO]: There are 4006 embeddings of dim 49152
2025-03-13 18:56:32,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:56:32,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:32,878 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:56:32,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:32,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:56:32,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,878 [INFO]: 826.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:32,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:56:32,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:32
2025-03-13 18:56:32,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:32,879 [INFO]: 	Creating the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:32
2025-03-13 18:56:32,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:56:32,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,883 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:56:32,883 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.21it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.01it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.06it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.59it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.93it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.00it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.09it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.16it/s]100%|██████████| 16/16 [00:04<00:00,  3.84it/s]
2025-03-13 18:56:37,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:37
2025-03-13 18:57:16,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7815 secs
2025-03-13 18:57:16,849 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 18:57:16,849 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.70it/s] 50%|█████     | 2/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 18:57:41,196 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3473 secs
2025-03-13 18:57:41,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3162 secs
2025-03-13 18:57:41,199 [INFO]: {
2025-03-13 18:57:41,199 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:41,199 [INFO]: 	index_param: efSearch=328
2025-03-13 18:57:41,199 [INFO]: 	index_path: knn.index
2025-03-13 18:57:41,199 [INFO]: 	size in bytes: 788156590
2025-03-13 18:57:41,199 [INFO]: 	avg_search_speed_ms: 10.213384599557129
2025-03-13 18:57:41,199 [INFO]: 	99p_search_speed_ms: 14.437226732261484
2025-03-13 18:57:41,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:41,199 [INFO]: 	nb vectors: 4006
2025-03-13 18:57:41,199 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:41,199 [INFO]: 	compression ratio: 0.9993085866350493
2025-03-13 18:57:41,199 [INFO]: }
2025-03-13 18:57:41,199 [INFO]: 	>>> Finished "Creating the index" in 68.3200 secs
2025-03-13 18:57:41,199 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3483 secs
2025-03-13 18:57:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 31078 [episode count 14/20]
[retrieval_preprocessing] for episode 88437 [episode count 15/20], we have num_retrieval=np.int64(3983) num_query=np.int64(214)
2025-03-13 18:57:44,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:45,958 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:45
2025-03-13 18:57:45,958 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-13 18:57:45,985 [INFO]: There are 3983 embeddings of dim 49152
2025-03-13 18:57:45,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:57:45,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:45
2025-03-13 18:57:45,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:45,986 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:57:45,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:45,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:57:45,986 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:45
2025-03-13 18:57:45,987 [INFO]: 822.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:45,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:57:45,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:45
2025-03-13 18:57:45,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:45,987 [INFO]: 	Creating the index 03/13/2025, 18:57:45
2025-03-13 18:57:45,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:45
2025-03-13 18:57:45,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:57:45,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:45
2025-03-13 18:57:45,991 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:57:45,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.37it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.23it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.19it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.25it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.71it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.22it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.42it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.63it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.76it/s]100%|██████████| 16/16 [00:04<00:00,  3.85it/s]
2025-03-13 18:57:50,156 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:50
2025-03-13 18:58:29,153 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9969 secs
2025-03-13 18:58:29,154 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 18:58:29,154 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 18:58:57,557 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4035 secs
2025-03-13 18:58:57,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5695 secs
2025-03-13 18:58:57,560 [INFO]: {
2025-03-13 18:58:57,560 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:57,560 [INFO]: 	index_param: efSearch=305
2025-03-13 18:58:57,560 [INFO]: 	index_path: knn.index
2025-03-13 18:58:57,560 [INFO]: 	size in bytes: 783631510
2025-03-13 18:58:57,560 [INFO]: 	avg_search_speed_ms: 8.965774377256698
2025-03-13 18:58:57,560 [INFO]: 	99p_search_speed_ms: 13.349024374037937
2025-03-13 18:58:57,560 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:57,560 [INFO]: 	nb vectors: 3983
2025-03-13 18:58:57,560 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:57,560 [INFO]: 	compression ratio: 0.9993085449052451
2025-03-13 18:58:57,560 [INFO]: }
2025-03-13 18:58:57,560 [INFO]: 	>>> Finished "Creating the index" in 71.5731 secs
2025-03-13 18:58:57,560 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6022 secs
2025-03-13 18:58:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 88437 [episode count 15/20]
[retrieval_preprocessing] for episode 6012 [episode count 16/20], we have num_retrieval=np.int64(4011) num_query=np.int64(186)
2025-03-13 18:59:01,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:02,553 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:02
2025-03-13 18:59:02,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2177.73it/s]
2025-03-13 18:59:02,579 [INFO]: There are 4011 embeddings of dim 49152
2025-03-13 18:59:02,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:59:02,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:02
2025-03-13 18:59:02,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:02,579 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:59:02,579 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:02,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:02,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:02
2025-03-13 18:59:02,580 [INFO]: 827.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:02,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:59:02,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:02
2025-03-13 18:59:02,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:02,580 [INFO]: 	Creating the index 03/13/2025, 18:59:02
2025-03-13 18:59:02,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:02
2025-03-13 18:59:02,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:59:02,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:02
2025-03-13 18:59:02,581 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:59:02,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.65it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.99it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.43it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.82it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.84it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.46it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.89it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.72it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.41it/s]100%|██████████| 16/16 [00:04<00:00,  1.52it/s]100%|██████████| 16/16 [00:04<00:00,  3.91it/s]
2025-03-13 18:59:06,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:06
2025-03-13 18:59:41,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4863 secs
2025-03-13 18:59:41,165 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 18:59:41,165 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 19:00:22,539 [INFO]: 	>>> Finished "Compute fast metrics" in 41.3739 secs
2025-03-13 19:00:22,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.9609 secs
2025-03-13 19:00:22,542 [INFO]: {
2025-03-13 19:00:22,542 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:22,542 [INFO]: 	index_param: efSearch=305
2025-03-13 19:00:22,542 [INFO]: 	index_path: knn.index
2025-03-13 19:00:22,542 [INFO]: 	size in bytes: 789140410
2025-03-13 19:00:22,542 [INFO]: 	avg_search_speed_ms: 9.878476135609414
2025-03-13 19:00:22,542 [INFO]: 	99p_search_speed_ms: 12.872698265127838
2025-03-13 19:00:22,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:22,542 [INFO]: 	nb vectors: 4011
2025-03-13 19:00:22,542 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:22,542 [INFO]: 	compression ratio: 0.9993084602016515
2025-03-13 19:00:22,542 [INFO]: }
2025-03-13 19:00:22,542 [INFO]: 	>>> Finished "Creating the index" in 79.9626 secs
2025-03-13 19:00:22,542 [INFO]: >>> Finished "Launching the whole pipeline" in 79.9892 secs
2025-03-13 19:00:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 6012 [episode count 16/20]
[retrieval_preprocessing] for episode 17803 [episode count 17/20], we have num_retrieval=np.int64(3990) num_query=np.int64(207)
2025-03-13 19:00:25,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:26,215 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:26
2025-03-13 19:00:26,215 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-13 19:00:26,237 [INFO]: There are 3990 embeddings of dim 49152
2025-03-13 19:00:26,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 19:00:26,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:26
2025-03-13 19:00:26,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:26,238 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 19:00:26,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:26,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:26,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:26
2025-03-13 19:00:26,238 [INFO]: 823.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:26,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:26,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:26
2025-03-13 19:00:26,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:26,238 [INFO]: 	Creating the index 03/13/2025, 19:00:26
2025-03-13 19:00:26,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:26
2025-03-13 19:00:26,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:00:26,239 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:26
2025-03-13 19:00:26,239 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:00:26,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.86it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.48it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.30it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.64it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.89it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.90it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.08it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.47it/s]100%|██████████| 16/16 [00:03<00:00,  4.47it/s]
2025-03-13 19:00:29,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:29
2025-03-13 19:01:04,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7757 secs
2025-03-13 19:01:04,601 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 19:01:04,601 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 19:01:27,301 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6997 secs
2025-03-13 19:01:27,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0647 secs
2025-03-13 19:01:27,304 [INFO]: {
2025-03-13 19:01:27,304 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:27,304 [INFO]: 	index_param: efSearch=169
2025-03-13 19:01:27,304 [INFO]: 	index_path: knn.index
2025-03-13 19:01:27,304 [INFO]: 	size in bytes: 785008690
2025-03-13 19:01:27,304 [INFO]: 	avg_search_speed_ms: 6.372608071391354
2025-03-13 19:01:27,304 [INFO]: 	99p_search_speed_ms: 9.17610422708094
2025-03-13 19:01:27,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:27,304 [INFO]: 	nb vectors: 3990
2025-03-13 19:01:27,304 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:27,304 [INFO]: 	compression ratio: 0.9993085809024611
2025-03-13 19:01:27,304 [INFO]: }
2025-03-13 19:01:27,304 [INFO]: 	>>> Finished "Creating the index" in 61.0662 secs
2025-03-13 19:01:27,304 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0888 secs
2025-03-13 19:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:01:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 17803 [episode count 17/20]
[retrieval_preprocessing] for episode 56192 [episode count 18/20], we have num_retrieval=np.int64(4014) num_query=np.int64(183)
2025-03-13 19:01:30,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:31,195 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:31
2025-03-13 19:01:31,195 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1585.75it/s]
2025-03-13 19:01:31,218 [INFO]: There are 4014 embeddings of dim 49152
2025-03-13 19:01:31,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 19:01:31,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:31,219 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 19:01:31,219 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:31,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:31,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,219 [INFO]: 828.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:31,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:01:31,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:31
2025-03-13 19:01:31,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:31,219 [INFO]: 	Creating the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:31
2025-03-13 19:01:31,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:01:31,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:31
2025-03-13 19:01:31,220 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:01:31,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.51it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.42it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.00it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.05it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.36it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.38it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.48it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.24it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.40it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.55it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.43it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.94it/s]100%|██████████| 16/16 [00:04<00:00,  1.59it/s]100%|██████████| 16/16 [00:04<00:00,  3.57it/s]
2025-03-13 19:01:35,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:35
2025-03-13 19:02:13,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8442 secs
2025-03-13 19:02:13,561 [INFO]: The best hyperparameters are: efSearch=331
2025-03-13 19:02:13,562 [INFO]: 	Compute fast metrics 03/13/2025, 19:02:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 19:02:40,269 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7074 secs
2025-03-13 19:02:40,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0527 secs
2025-03-13 19:02:40,273 [INFO]: {
2025-03-13 19:02:40,273 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:40,273 [INFO]: 	index_param: efSearch=331
2025-03-13 19:02:40,273 [INFO]: 	index_path: knn.index
2025-03-13 19:02:40,273 [INFO]: 	size in bytes: 789730630
2025-03-13 19:02:40,273 [INFO]: 	avg_search_speed_ms: 11.712248055144395
2025-03-13 19:02:40,273 [INFO]: 	99p_search_speed_ms: 15.87206506403163
2025-03-13 19:02:40,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:40,273 [INFO]: 	nb vectors: 4014
2025-03-13 19:02:40,273 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:40,273 [INFO]: 	compression ratio: 0.9993084756000916
2025-03-13 19:02:40,273 [INFO]: }
2025-03-13 19:02:40,273 [INFO]: 	>>> Finished "Creating the index" in 69.0542 secs
2025-03-13 19:02:40,273 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0780 secs
2025-03-13 19:02:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 56192 [episode count 18/20]
[retrieval_preprocessing] for episode 87977 [episode count 19/20], we have num_retrieval=np.int64(4004) num_query=np.int64(193)
2025-03-13 19:02:43,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:44,125 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:44
2025-03-13 19:02:44,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1961.79it/s]
2025-03-13 19:02:44,150 [INFO]: There are 4004 embeddings of dim 49152
2025-03-13 19:02:44,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 19:02:44,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:44
2025-03-13 19:02:44,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:44,152 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 19:02:44,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:44,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:02:44,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:44
2025-03-13 19:02:44,152 [INFO]: 826.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:44,153 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:02:44,153 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:44
2025-03-13 19:02:44,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:44,153 [INFO]: 	Creating the index 03/13/2025, 19:02:44
2025-03-13 19:02:44,153 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:44
2025-03-13 19:02:44,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 19:02:44,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:44
2025-03-13 19:02:44,156 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:02:44,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.21it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.74it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.49it/s] 56%|█████▋    | 9/16 [00:00<00:00, 19.60it/s] 75%|███████▌  | 12/16 [00:00<00:00, 15.44it/s]100%|██████████| 16/16 [00:03<00:00,  2.75it/s]100%|██████████| 16/16 [00:03<00:00,  4.08it/s]
2025-03-13 19:02:48,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:48
2025-03-13 19:03:33,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4762 secs
2025-03-13 19:03:33,571 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 19:03:33,571 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 19:03:57,994 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4230 secs
2025-03-13 19:03:57,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8410 secs
2025-03-13 19:03:57,997 [INFO]: {
2025-03-13 19:03:57,997 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:57,997 [INFO]: 	index_param: efSearch=274
2025-03-13 19:03:57,997 [INFO]: 	index_path: knn.index
2025-03-13 19:03:57,997 [INFO]: 	size in bytes: 787763110
2025-03-13 19:03:57,997 [INFO]: 	avg_search_speed_ms: 10.610267410078505
2025-03-13 19:03:57,997 [INFO]: 	99p_search_speed_ms: 18.645489462651316
2025-03-13 19:03:57,997 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:57,997 [INFO]: 	nb vectors: 4004
2025-03-13 19:03:57,997 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:57,997 [INFO]: 	compression ratio: 0.9993085764069354
2025-03-13 19:03:57,997 [INFO]: }
2025-03-13 19:03:57,997 [INFO]: 	>>> Finished "Creating the index" in 73.8442 secs
2025-03-13 19:03:57,997 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8728 secs
2025-03-13 19:03:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 87977 [episode count 19/20]
2025-03-13 19:04:00: [retrieval_preprocessing] finished for 4345518188_put_lid_on_pot [chosen_id count 9/196]
2025-03-13 19:04:00: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
