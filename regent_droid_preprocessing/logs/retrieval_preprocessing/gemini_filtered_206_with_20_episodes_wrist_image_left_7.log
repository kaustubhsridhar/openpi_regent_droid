nohup: ignoring input
2025-03-13 10:50:49: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:51:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4938854758_put_pen_in_cup [chosen_id count 0/260]
2025-03-13 10:51:13: [retrieval_preprocessing] we have num_total=4492 embedding_dim=49152
[retrieval_preprocessing] for episode 67077 [episode count 0/20], we have num_retrieval=np.int64(4306) num_query=np.int64(186)
2025-03-13 10:51:16,351 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:17,156 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:17
2025-03-13 10:51:17,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 532.14it/s]
2025-03-13 10:51:17,202 [INFO]: There are 4306 embeddings of dim 49152
2025-03-13 10:51:17,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0465 secs
2025-03-13 10:51:17,203 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:17
2025-03-13 10:51:17,203 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:17,203 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 10:51:17,203 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:17,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:51:17,203 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:17
2025-03-13 10:51:17,204 [INFO]: 888.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:17,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-13 10:51:17,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:17
2025-03-13 10:51:17,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:17,204 [INFO]: 	Creating the index 03/13/2025, 10:51:17
2025-03-13 10:51:17,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:17
2025-03-13 10:51:17,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 10:51:17,206 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:17
2025-03-13 10:51:17,207 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:51:17,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.64it/s] 29%|██▉       | 5/17 [00:00<00:00, 15.43it/s] 47%|████▋     | 8/17 [00:00<00:00, 17.76it/s] 59%|█████▉    | 10/17 [00:00<00:00, 17.32it/s] 71%|███████   | 12/17 [00:02<00:01,  3.78it/s] 82%|████████▏ | 14/17 [00:02<00:00,  4.86it/s] 94%|█████████▍| 16/17 [00:02<00:00,  5.93it/s]100%|██████████| 17/17 [00:06<00:00,  2.79it/s]
2025-03-13 10:51:23,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:23
2025-03-13 10:52:09,593 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2838 secs
2025-03-13 10:52:09,593 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 10:52:09,593 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.26it/s]
2025-03-13 10:52:22,030 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4370 secs
2025-03-13 10:52:22,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8284 secs
2025-03-13 10:52:22,035 [INFO]: {
2025-03-13 10:52:22,035 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:22,035 [INFO]: 	index_param: efSearch=158
2025-03-13 10:52:22,035 [INFO]: 	index_path: knn.index
2025-03-13 10:52:22,035 [INFO]: 	size in bytes: 847179790
2025-03-13 10:52:22,035 [INFO]: 	avg_search_speed_ms: 9.671252575519222
2025-03-13 10:52:22,036 [INFO]: 	99p_search_speed_ms: 16.77898460533467
2025-03-13 10:52:22,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:22,036 [INFO]: 	nb vectors: 4306
2025-03-13 10:52:22,036 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:22,036 [INFO]: 	compression ratio: 0.9993085977652985
2025-03-13 10:52:22,036 [INFO]: }
2025-03-13 10:52:22,036 [INFO]: 	>>> Finished "Creating the index" in 64.8315 secs
2025-03-13 10:52:22,036 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8798 secs
2025-03-13 10:52:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 67077 [episode count 0/20]
[retrieval_preprocessing] for episode 67213 [episode count 1/20], we have num_retrieval=np.int64(4264) num_query=np.int64(228)
2025-03-13 10:52:23,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:24,329 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:24
2025-03-13 10:52:24,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.03it/s]
2025-03-13 10:52:24,357 [INFO]: There are 4264 embeddings of dim 49152
2025-03-13 10:52:24,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 10:52:24,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:24
2025-03-13 10:52:24,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:24,357 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 10:52:24,357 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:24,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:24,357 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:24
2025-03-13 10:52:24,357 [INFO]: 880.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:24,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:52:24,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:24
2025-03-13 10:52:24,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:24,358 [INFO]: 	Creating the index 03/13/2025, 10:52:24
2025-03-13 10:52:24,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:24
2025-03-13 10:52:24,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:52:24,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:24
2025-03-13 10:52:24,359 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:52:24,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.03it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.92it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.62it/s] 88%|████████▊ | 15/17 [00:00<00:00, 23.27it/s]100%|██████████| 17/17 [00:03<00:00,  4.43it/s]
2025-03-13 10:52:28,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:28
2025-03-13 10:53:17,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9037 secs
2025-03-13 10:53:17,108 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 10:53:17,108 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 10:53:29,423 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3148 secs
2025-03-13 10:53:29,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0672 secs
2025-03-13 10:53:29,426 [INFO]: {
2025-03-13 10:53:29,426 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:29,426 [INFO]: 	index_param: efSearch=166
2025-03-13 10:53:29,426 [INFO]: 	index_path: knn.index
2025-03-13 10:53:29,426 [INFO]: 	size in bytes: 838916410
2025-03-13 10:53:29,426 [INFO]: 	avg_search_speed_ms: 8.47300097950087
2025-03-13 10:53:29,426 [INFO]: 	99p_search_speed_ms: 12.001255643554034
2025-03-13 10:53:29,426 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:29,426 [INFO]: 	nb vectors: 4264
2025-03-13 10:53:29,426 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:29,426 [INFO]: 	compression ratio: 0.9993087535383889
2025-03-13 10:53:29,426 [INFO]: }
2025-03-13 10:53:29,426 [INFO]: 	>>> Finished "Creating the index" in 65.0687 secs
2025-03-13 10:53:29,426 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0974 secs
2025-03-13 10:53:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 67213 [episode count 1/20]
[retrieval_preprocessing] for episode 6161 [episode count 2/20], we have num_retrieval=np.int64(4332) num_query=np.int64(160)
2025-03-13 10:53:31,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:31,891 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:31
2025-03-13 10:53:31,891 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.52it/s]
2025-03-13 10:53:31,919 [INFO]: There are 4332 embeddings of dim 49152
2025-03-13 10:53:31,919 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 10:53:31,919 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:31
2025-03-13 10:53:31,919 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:31,919 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 10:53:31,919 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:31,919 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:31,919 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:31
2025-03-13 10:53:31,920 [INFO]: 894.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:31,920 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:31,920 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:31
2025-03-13 10:53:31,920 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:31,920 [INFO]: 	Creating the index 03/13/2025, 10:53:31
2025-03-13 10:53:31,920 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:31
2025-03-13 10:53:31,921 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:53:31,921 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:31
2025-03-13 10:53:31,921 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:53:31,921 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.58it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.30it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.22it/s]100%|██████████| 18/18 [00:03<00:00,  3.63it/s]100%|██████████| 18/18 [00:03<00:00,  4.98it/s]
2025-03-13 10:53:35,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:35
2025-03-13 10:54:14,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6680 secs
2025-03-13 10:54:14,204 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 10:54:14,204 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 10:54:26,688 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4839 secs
2025-03-13 10:54:26,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7695 secs
2025-03-13 10:54:26,690 [INFO]: {
2025-03-13 10:54:26,690 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:26,690 [INFO]: 	index_param: efSearch=159
2025-03-13 10:54:26,690 [INFO]: 	index_path: knn.index
2025-03-13 10:54:26,691 [INFO]: 	size in bytes: 852295150
2025-03-13 10:54:26,691 [INFO]: 	avg_search_speed_ms: 7.876982641091027
2025-03-13 10:54:26,691 [INFO]: 	99p_search_speed_ms: 12.932431213557697
2025-03-13 10:54:26,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:26,691 [INFO]: 	nb vectors: 4332
2025-03-13 10:54:26,691 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:26,691 [INFO]: 	compression ratio: 0.9993085798974686
2025-03-13 10:54:26,691 [INFO]: }
2025-03-13 10:54:26,691 [INFO]: 	>>> Finished "Creating the index" in 54.7709 secs
2025-03-13 10:54:26,691 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7993 secs
2025-03-13 10:54:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 6161 [episode count 2/20]
[retrieval_preprocessing] for episode 18832 [episode count 3/20], we have num_retrieval=np.int64(4243) num_query=np.int64(249)
2025-03-13 10:54:28,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:29,156 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:29
2025-03-13 10:54:29,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.62it/s]
2025-03-13 10:54:29,190 [INFO]: There are 4243 embeddings of dim 49152
2025-03-13 10:54:29,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 10:54:29,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:29
2025-03-13 10:54:29,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:29,193 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 10:54:29,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:29,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:54:29,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:29
2025-03-13 10:54:29,193 [INFO]: 875.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:29,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:54:29,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:29
2025-03-13 10:54:29,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:29,194 [INFO]: 	Creating the index 03/13/2025, 10:54:29
2025-03-13 10:54:29,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:29
2025-03-13 10:54:29,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 10:54:29,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:29
2025-03-13 10:54:29,198 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:54:29,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.85it/s] 41%|████      | 7/17 [00:00<00:00, 32.06it/s] 71%|███████   | 12/17 [00:00<00:00, 37.04it/s]100%|██████████| 17/17 [00:04<00:00,  2.89it/s]100%|██████████| 17/17 [00:04<00:00,  4.05it/s]
2025-03-13 10:54:33,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:33
2025-03-13 10:55:14,158 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7524 secs
2025-03-13 10:55:14,158 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 10:55:14,158 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 10:55:26,452 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2938 secs
2025-03-13 10:55:26,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2562 secs
2025-03-13 10:55:26,454 [INFO]: {
2025-03-13 10:55:26,455 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:26,455 [INFO]: 	index_param: efSearch=203
2025-03-13 10:55:26,455 [INFO]: 	index_path: knn.index
2025-03-13 10:55:26,455 [INFO]: 	size in bytes: 834784870
2025-03-13 10:55:26,455 [INFO]: 	avg_search_speed_ms: 10.50481920990459
2025-03-13 10:55:26,455 [INFO]: 	99p_search_speed_ms: 18.838970633223656
2025-03-13 10:55:26,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:26,455 [INFO]: 	nb vectors: 4243
2025-03-13 10:55:26,455 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:26,455 [INFO]: 	compression ratio: 0.9993086530185915
2025-03-13 10:55:26,455 [INFO]: }
2025-03-13 10:55:26,455 [INFO]: 	>>> Finished "Creating the index" in 57.2606 secs
2025-03-13 10:55:26,455 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2989 secs
2025-03-13 10:55:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 18832 [episode count 3/20]
[retrieval_preprocessing] for episode 42515 [episode count 4/20], we have num_retrieval=np.int64(4317) num_query=np.int64(175)
2025-03-13 10:55:28,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:29,160 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:29
2025-03-13 10:55:29,160 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.19it/s]
2025-03-13 10:55:29,196 [INFO]: There are 4317 embeddings of dim 49152
2025-03-13 10:55:29,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 10:55:29,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:29
2025-03-13 10:55:29,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:29,197 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 10:55:29,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:29,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:55:29,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:29
2025-03-13 10:55:29,197 [INFO]: 890.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:29,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:55:29,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:29
2025-03-13 10:55:29,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:29,197 [INFO]: 	Creating the index 03/13/2025, 10:55:29
2025-03-13 10:55:29,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:29
2025-03-13 10:55:29,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 10:55:29,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:29
2025-03-13 10:55:29,200 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:55:29,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.40it/s] 29%|██▉       | 5/17 [00:00<00:00, 23.74it/s] 59%|█████▉    | 10/17 [00:00<00:00, 32.84it/s] 88%|████████▊ | 15/17 [00:00<00:00, 37.51it/s]100%|██████████| 17/17 [00:03<00:00,  4.48it/s]
2025-03-13 10:55:33,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:33
2025-03-13 10:56:19,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0325 secs
2025-03-13 10:56:19,034 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 10:56:19,035 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 10:56:32,132 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0971 secs
2025-03-13 10:56:32,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9353 secs
2025-03-13 10:56:32,136 [INFO]: {
2025-03-13 10:56:32,136 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:32,136 [INFO]: 	index_param: efSearch=180
2025-03-13 10:56:32,136 [INFO]: 	index_path: knn.index
2025-03-13 10:56:32,136 [INFO]: 	size in bytes: 849343930
2025-03-13 10:56:32,136 [INFO]: 	avg_search_speed_ms: 10.042790340794527
2025-03-13 10:56:32,136 [INFO]: 	99p_search_speed_ms: 15.020496281795197
2025-03-13 10:56:32,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:32,136 [INFO]: 	nb vectors: 4317
2025-03-13 10:56:32,136 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:32,136 [INFO]: 	compression ratio: 0.9993086499128804
2025-03-13 10:56:32,136 [INFO]: }
2025-03-13 10:56:32,136 [INFO]: 	>>> Finished "Creating the index" in 62.9383 secs
2025-03-13 10:56:32,136 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9756 secs
2025-03-13 10:56:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 42515 [episode count 4/20]
[retrieval_preprocessing] for episode 6300 [episode count 5/20], we have num_retrieval=np.int64(4284) num_query=np.int64(208)
2025-03-13 10:56:35,086 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:35,672 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:35
2025-03-13 10:56:35,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 10:56:35,699 [INFO]: There are 4284 embeddings of dim 49152
2025-03-13 10:56:35,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 10:56:35,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:35
2025-03-13 10:56:35,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:35,699 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 10:56:35,699 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:35,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:35,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:35
2025-03-13 10:56:35,699 [INFO]: 884.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:35,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:56:35,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:35
2025-03-13 10:56:35,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:35,700 [INFO]: 	Creating the index 03/13/2025, 10:56:35
2025-03-13 10:56:35,700 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:35
2025-03-13 10:56:35,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:56:35,701 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:35
2025-03-13 10:56:35,701 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:56:35,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.45it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.25it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.70it/s] 41%|████      | 7/17 [00:00<00:00, 11.78it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.17it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.92it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.26it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.60it/s]100%|██████████| 17/17 [00:05<00:00,  1.49it/s]100%|██████████| 17/17 [00:05<00:00,  3.29it/s]
2025-03-13 10:56:40,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:40
2025-03-13 10:57:28,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6076 secs
2025-03-13 10:57:28,495 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 10:57:28,495 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 10:57:41,577 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0821 secs
2025-03-13 10:57:41,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8799 secs
2025-03-13 10:57:41,581 [INFO]: {
2025-03-13 10:57:41,581 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:41,581 [INFO]: 	index_param: efSearch=171
2025-03-13 10:57:41,581 [INFO]: 	index_path: knn.index
2025-03-13 10:57:41,581 [INFO]: 	size in bytes: 842851330
2025-03-13 10:57:41,581 [INFO]: 	avg_search_speed_ms: 10.506757861052193
2025-03-13 10:57:41,581 [INFO]: 	99p_search_speed_ms: 24.78593548992649
2025-03-13 10:57:41,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:41,581 [INFO]: 	nb vectors: 4284
2025-03-13 10:57:41,581 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:41,581 [INFO]: 	compression ratio: 0.999308706079873
2025-03-13 10:57:41,581 [INFO]: }
2025-03-13 10:57:41,581 [INFO]: 	>>> Finished "Creating the index" in 65.8816 secs
2025-03-13 10:57:41,581 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9096 secs
2025-03-13 10:57:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 6300 [episode count 5/20]
[retrieval_preprocessing] for episode 28449 [episode count 6/20], we have num_retrieval=np.int64(4256) num_query=np.int64(236)
2025-03-13 10:57:44,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:45,221 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:45
2025-03-13 10:57:45,221 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.00it/s]
2025-03-13 10:57:45,253 [INFO]: There are 4256 embeddings of dim 49152
2025-03-13 10:57:45,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 10:57:45,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:45,253 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 10:57:45,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:45,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:45,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,254 [INFO]: 878.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:45,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:57:45,254 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:45
2025-03-13 10:57:45,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:45,254 [INFO]: 	Creating the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,254 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:45
2025-03-13 10:57:45,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:57:45,255 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,255 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:57:45,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.67it/s] 41%|████      | 7/17 [00:00<00:00, 32.29it/s] 71%|███████   | 12/17 [00:00<00:00, 37.96it/s]100%|██████████| 17/17 [00:03<00:00,  3.13it/s]100%|██████████| 17/17 [00:03<00:00,  4.36it/s]
2025-03-13 10:57:49,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:49
2025-03-13 10:58:35,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8865 secs
2025-03-13 10:58:35,041 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 10:58:35,042 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 10:58:47,701 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6594 secs
2025-03-13 10:58:47,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4489 secs
2025-03-13 10:58:47,704 [INFO]: {
2025-03-13 10:58:47,704 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:47,704 [INFO]: 	index_param: efSearch=150
2025-03-13 10:58:47,704 [INFO]: 	index_path: knn.index
2025-03-13 10:58:47,704 [INFO]: 	size in bytes: 837342490
2025-03-13 10:58:47,704 [INFO]: 	avg_search_speed_ms: 8.21793705876228
2025-03-13 10:58:47,705 [INFO]: 	99p_search_speed_ms: 12.231259755790232
2025-03-13 10:58:47,705 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:47,705 [INFO]: 	nb vectors: 4256
2025-03-13 10:58:47,705 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:47,705 [INFO]: 	compression ratio: 0.9993087153620975
2025-03-13 10:58:47,705 [INFO]: }
2025-03-13 10:58:47,705 [INFO]: 	>>> Finished "Creating the index" in 62.4507 secs
2025-03-13 10:58:47,705 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4834 secs
2025-03-13 10:58:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 28449 [episode count 6/20]
[retrieval_preprocessing] for episode 49954 [episode count 7/20], we have num_retrieval=np.int64(4248) num_query=np.int64(244)
2025-03-13 10:58:49,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:50,113 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:50
2025-03-13 10:58:50,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.14it/s]
2025-03-13 10:58:50,144 [INFO]: There are 4248 embeddings of dim 49152
2025-03-13 10:58:50,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 10:58:50,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:50
2025-03-13 10:58:50,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:50,144 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 10:58:50,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:50,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:50,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:50
2025-03-13 10:58:50,145 [INFO]: 876.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:50,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:50,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:50
2025-03-13 10:58:50,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:50,145 [INFO]: 	Creating the index 03/13/2025, 10:58:50
2025-03-13 10:58:50,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:50
2025-03-13 10:58:50,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:58:50,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:50
2025-03-13 10:58:50,146 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:58:50,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.90it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.08it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.98it/s] 94%|█████████▍| 16/17 [00:00<00:00, 40.97it/s]100%|██████████| 17/17 [00:03<00:00,  5.08it/s]
2025-03-13 10:58:53,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:53
2025-03-13 10:59:36,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3723 secs
2025-03-13 10:59:36,867 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 10:59:36,867 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 10:59:50,574 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7061 secs
2025-03-13 10:59:50,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4311 secs
2025-03-13 10:59:50,578 [INFO]: {
2025-03-13 10:59:50,578 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:50,578 [INFO]: 	index_param: efSearch=207
2025-03-13 10:59:50,578 [INFO]: 	index_path: knn.index
2025-03-13 10:59:50,578 [INFO]: 	size in bytes: 835768570
2025-03-13 10:59:50,578 [INFO]: 	avg_search_speed_ms: 12.798426435221835
2025-03-13 10:59:50,578 [INFO]: 	99p_search_speed_ms: 19.130624036770314
2025-03-13 10:59:50,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:50,578 [INFO]: 	nb vectors: 4248
2025-03-13 10:59:50,578 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:50,578 [INFO]: 	compression ratio: 0.999308677042019
2025-03-13 10:59:50,578 [INFO]: }
2025-03-13 10:59:50,578 [INFO]: 	>>> Finished "Creating the index" in 60.4327 secs
2025-03-13 10:59:50,578 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4650 secs
2025-03-13 10:59:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 49954 [episode count 7/20]
[retrieval_preprocessing] for episode 5795 [episode count 8/20], we have num_retrieval=np.int64(4276) num_query=np.int64(216)
2025-03-13 10:59:54,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:54,860 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:54
2025-03-13 10:59:54,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.14it/s]
2025-03-13 10:59:54,885 [INFO]: There are 4276 embeddings of dim 49152
2025-03-13 10:59:54,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 10:59:54,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:54
2025-03-13 10:59:54,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:54,885 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 10:59:54,885 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:54,885 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:59:54,885 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:54
2025-03-13 10:59:54,885 [INFO]: 882.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:54,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:59:54,885 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:54
2025-03-13 10:59:54,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:54,886 [INFO]: 	Creating the index 03/13/2025, 10:59:54
2025-03-13 10:59:54,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:54
2025-03-13 10:59:54,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:59:54,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:54
2025-03-13 10:59:54,887 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 10:59:54,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.76it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.60it/s] 24%|██▎       | 4/17 [00:00<00:01,  9.91it/s] 35%|███▌      | 6/17 [00:00<00:01, 10.94it/s] 47%|████▋     | 8/17 [00:00<00:00, 11.38it/s] 59%|█████▉    | 10/17 [00:00<00:00, 11.67it/s] 71%|███████   | 12/17 [00:01<00:00, 11.89it/s] 82%|████████▏ | 14/17 [00:01<00:00, 12.41it/s]100%|██████████| 17/17 [00:04<00:00,  2.02it/s]100%|██████████| 17/17 [00:04<00:00,  3.80it/s]
2025-03-13 10:59:59,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:59
2025-03-13 11:00:47,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2866 secs
2025-03-13 11:00:47,655 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 11:00:47,655 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.08it/s] 50%|█████     | 2/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 11:01:01,532 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8769 secs
2025-03-13 11:01:01,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6482 secs
2025-03-13 11:01:01,535 [INFO]: {
2025-03-13 11:01:01,535 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:01,535 [INFO]: 	index_param: efSearch=165
2025-03-13 11:01:01,535 [INFO]: 	index_path: knn.index
2025-03-13 11:01:01,535 [INFO]: 	size in bytes: 841277350
2025-03-13 11:01:01,535 [INFO]: 	avg_search_speed_ms: 9.204748877441544
2025-03-13 11:01:01,535 [INFO]: 	99p_search_speed_ms: 20.894092856906404
2025-03-13 11:01:01,535 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:01,535 [INFO]: 	nb vectors: 4276
2025-03-13 11:01:01,535 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:01,535 [INFO]: 	compression ratio: 0.9993087392641677
2025-03-13 11:01:01,535 [INFO]: }
2025-03-13 11:01:01,535 [INFO]: 	>>> Finished "Creating the index" in 66.6498 secs
2025-03-13 11:01:01,535 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6755 secs
2025-03-13 11:01:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 5795 [episode count 8/20]
[retrieval_preprocessing] for episode 88110 [episode count 9/20], we have num_retrieval=np.int64(4332) num_query=np.int64(160)
2025-03-13 11:01:04,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:04,979 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:04
2025-03-13 11:01:04,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1033.59it/s]
2025-03-13 11:01:05,005 [INFO]: There are 4332 embeddings of dim 49152
2025-03-13 11:01:05,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:01:05,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:05
2025-03-13 11:01:05,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:05,005 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:01:05,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:05,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:05,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:05
2025-03-13 11:01:05,005 [INFO]: 894.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:05,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:01:05,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:05
2025-03-13 11:01:05,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:05,005 [INFO]: 	Creating the index 03/13/2025, 11:01:05
2025-03-13 11:01:05,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:05
2025-03-13 11:01:05,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:01:05,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:05
2025-03-13 11:01:05,006 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:01:05,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.65it/s] 11%|█         | 2/18 [00:00<00:02,  7.57it/s] 22%|██▏       | 4/18 [00:00<00:01,  9.23it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.79it/s] 44%|████▍     | 8/18 [00:00<00:00, 10.03it/s] 50%|█████     | 9/18 [00:00<00:00,  9.90it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.89it/s] 61%|██████    | 11/18 [00:01<00:00,  9.79it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.46it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.52it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.85it/s]100%|██████████| 18/18 [00:05<00:00,  3.51it/s]
2025-03-13 11:01:10,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:10
2025-03-13 11:01:48,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5001 secs
2025-03-13 11:01:48,636 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 11:01:48,636 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 11:02:04,322 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6859 secs
2025-03-13 11:02:04,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3186 secs
2025-03-13 11:02:04,325 [INFO]: {
2025-03-13 11:02:04,325 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:04,325 [INFO]: 	index_param: efSearch=207
2025-03-13 11:02:04,325 [INFO]: 	index_path: knn.index
2025-03-13 11:02:04,325 [INFO]: 	size in bytes: 852295150
2025-03-13 11:02:04,325 [INFO]: 	avg_search_speed_ms: 9.327232733207282
2025-03-13 11:02:04,325 [INFO]: 	99p_search_speed_ms: 12.262913398444653
2025-03-13 11:02:04,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:04,325 [INFO]: 	nb vectors: 4332
2025-03-13 11:02:04,325 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:04,325 [INFO]: 	compression ratio: 0.9993085798974686
2025-03-13 11:02:04,325 [INFO]: }
2025-03-13 11:02:04,325 [INFO]: 	>>> Finished "Creating the index" in 59.3200 secs
2025-03-13 11:02:04,325 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3466 secs
2025-03-13 11:02:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 88110 [episode count 9/20]
[retrieval_preprocessing] for episode 36018 [episode count 10/20], we have num_retrieval=np.int64(4284) num_query=np.int64(208)
2025-03-13 11:02:07,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:07,994 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:07
2025-03-13 11:02:07,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.84it/s]
2025-03-13 11:02:08,017 [INFO]: There are 4284 embeddings of dim 49152
2025-03-13 11:02:08,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 11:02:08,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:08
2025-03-13 11:02:08,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:08,017 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:02:08,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:08,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:08,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:08
2025-03-13 11:02:08,017 [INFO]: 884.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:08,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:08,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:08
2025-03-13 11:02:08,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:08,018 [INFO]: 	Creating the index 03/13/2025, 11:02:08
2025-03-13 11:02:08,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:08
2025-03-13 11:02:08,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:02:08,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:08
2025-03-13 11:02:08,019 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:02:08,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.24it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.46it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.55it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.23it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.06it/s] 41%|████      | 7/17 [00:00<00:01,  7.90it/s] 47%|████▋     | 8/17 [00:01<00:01,  7.91it/s] 53%|█████▎    | 9/17 [00:01<00:01,  7.84it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.04it/s] 71%|███████   | 12/17 [00:01<00:00,  8.92it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.79it/s] 82%|████████▏ | 14/17 [00:01<00:00,  6.76it/s] 94%|█████████▍| 16/17 [00:02<00:00,  5.27it/s]100%|██████████| 17/17 [00:05<00:00,  1.17it/s]100%|██████████| 17/17 [00:05<00:00,  3.18it/s]
2025-03-13 11:02:13,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:13
2025-03-13 11:02:55,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8023 secs
2025-03-13 11:02:55,166 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 11:02:55,166 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 11:03:08,318 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1517 secs
2025-03-13 11:03:08,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3041 secs
2025-03-13 11:03:08,323 [INFO]: {
2025-03-13 11:03:08,323 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:08,323 [INFO]: 	index_param: efSearch=174
2025-03-13 11:03:08,323 [INFO]: 	index_path: knn.index
2025-03-13 11:03:08,323 [INFO]: 	size in bytes: 842851330
2025-03-13 11:03:08,324 [INFO]: 	avg_search_speed_ms: 11.388174340114048
2025-03-13 11:03:08,324 [INFO]: 	99p_search_speed_ms: 23.881690858397643
2025-03-13 11:03:08,324 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:08,324 [INFO]: 	nb vectors: 4284
2025-03-13 11:03:08,324 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:08,324 [INFO]: 	compression ratio: 0.999308706079873
2025-03-13 11:03:08,324 [INFO]: }
2025-03-13 11:03:08,324 [INFO]: 	>>> Finished "Creating the index" in 60.3061 secs
2025-03-13 11:03:08,324 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3297 secs
2025-03-13 11:03:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 36018 [episode count 10/20]
[retrieval_preprocessing] for episode 52920 [episode count 11/20], we have num_retrieval=np.int64(4282) num_query=np.int64(210)
2025-03-13 11:03:12,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:12,996 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:12
2025-03-13 11:03:12,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.23it/s]
2025-03-13 11:03:13,023 [INFO]: There are 4282 embeddings of dim 49152
2025-03-13 11:03:13,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:03:13,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:13
2025-03-13 11:03:13,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:13,023 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:03:13,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:13,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:13,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:13
2025-03-13 11:03:13,023 [INFO]: 883.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:13,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:03:13,023 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:13
2025-03-13 11:03:13,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:13,024 [INFO]: 	Creating the index 03/13/2025, 11:03:13
2025-03-13 11:03:13,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:13
2025-03-13 11:03:13,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:03:13,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:13
2025-03-13 11:03:13,025 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:03:13,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.67it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.60it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.71it/s] 41%|████      | 7/17 [00:00<00:00, 11.26it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.51it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.40it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.29it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.93it/s]100%|██████████| 17/17 [00:05<00:00,  1.43it/s]100%|██████████| 17/17 [00:05<00:00,  3.13it/s]
2025-03-13 11:03:18,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:18
2025-03-13 11:03:56,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9340 secs
2025-03-13 11:03:56,400 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 11:03:56,400 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-13 11:04:10,165 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7652 secs
2025-03-13 11:04:10,168 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1432 secs
2025-03-13 11:04:10,168 [INFO]: {
2025-03-13 11:04:10,168 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:10,168 [INFO]: 	index_param: efSearch=180
2025-03-13 11:04:10,168 [INFO]: 	index_path: knn.index
2025-03-13 11:04:10,168 [INFO]: 	size in bytes: 842457850
2025-03-13 11:04:10,168 [INFO]: 	avg_search_speed_ms: 8.209894765481927
2025-03-13 11:04:10,168 [INFO]: 	99p_search_speed_ms: 11.294816101435568
2025-03-13 11:04:10,168 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:10,168 [INFO]: 	nb vectors: 4282
2025-03-13 11:04:10,168 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:10,168 [INFO]: 	compression ratio: 0.9993086965715852
2025-03-13 11:04:10,168 [INFO]: }
2025-03-13 11:04:10,168 [INFO]: 	>>> Finished "Creating the index" in 57.1447 secs
2025-03-13 11:04:10,168 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1718 secs
2025-03-13 11:04:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 52920 [episode count 11/20]
[retrieval_preprocessing] for episode 78904 [episode count 12/20], we have num_retrieval=np.int64(4301) num_query=np.int64(191)
2025-03-13 11:04:13,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:14,037 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:14
2025-03-13 11:04:14,038 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1710.56it/s]
2025-03-13 11:04:14,061 [INFO]: There are 4301 embeddings of dim 49152
2025-03-13 11:04:14,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:04:14,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:14
2025-03-13 11:04:14,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:14,062 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:04:14,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:14,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:14,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:14
2025-03-13 11:04:14,062 [INFO]: 887.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:14,062 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:04:14,062 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:14
2025-03-13 11:04:14,062 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:14,062 [INFO]: 	Creating the index 03/13/2025, 11:04:14
2025-03-13 11:04:14,062 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:14
2025-03-13 11:04:14,063 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:04:14,063 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:14
2025-03-13 11:04:14,063 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:04:14,063 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.79it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.38it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.71it/s] 41%|████      | 7/17 [00:00<00:00, 11.24it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.54it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.83it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.92it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.09it/s]100%|██████████| 17/17 [00:04<00:00,  1.70it/s]100%|██████████| 17/17 [00:04<00:00,  3.62it/s]
2025-03-13 11:04:18,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:18
2025-03-13 11:05:00,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0139 secs
2025-03-13 11:05:00,780 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 11:05:00,781 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.72it/s] 50%|█████     | 2/4 [00:00<00:00,  3.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.73it/s]
2025-03-13 11:05:16,062 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2811 secs
2025-03-13 11:05:16,065 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0019 secs
2025-03-13 11:05:16,065 [INFO]: {
2025-03-13 11:05:16,065 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:16,065 [INFO]: 	index_param: efSearch=235
2025-03-13 11:05:16,065 [INFO]: 	index_path: knn.index
2025-03-13 11:05:16,065 [INFO]: 	size in bytes: 846196090
2025-03-13 11:05:16,066 [INFO]: 	avg_search_speed_ms: 9.237748642330809
2025-03-13 11:05:16,066 [INFO]: 	99p_search_speed_ms: 13.023027935996659
2025-03-13 11:05:16,066 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:16,066 [INFO]: 	nb vectors: 4301
2025-03-13 11:05:16,066 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:16,066 [INFO]: 	compression ratio: 0.9993085739736756
2025-03-13 11:05:16,066 [INFO]: }
2025-03-13 11:05:16,066 [INFO]: 	>>> Finished "Creating the index" in 62.0035 secs
2025-03-13 11:05:16,066 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0282 secs
2025-03-13 11:05:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 78904 [episode count 12/20]
[retrieval_preprocessing] for episode 89911 [episode count 13/20], we have num_retrieval=np.int64(4030) num_query=np.int64(462)
2025-03-13 11:05:19,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:20,137 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:20
2025-03-13 11:05:20,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.46it/s]
2025-03-13 11:05:20,162 [INFO]: There are 4030 embeddings of dim 49152
2025-03-13 11:05:20,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:05:20,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:20
2025-03-13 11:05:20,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:20,163 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:05:20,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:20,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:20,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:20
2025-03-13 11:05:20,163 [INFO]: 831.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:20,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:05:20,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:20
2025-03-13 11:05:20,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:20,163 [INFO]: 	Creating the index 03/13/2025, 11:05:20
2025-03-13 11:05:20,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:20
2025-03-13 11:05:20,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:05:20,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:20
2025-03-13 11:05:20,165 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:05:20,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.41it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.06it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.88it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.34it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.63it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.81it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.02it/s] 50%|█████     | 8/16 [00:00<00:00,  9.10it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.02it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.07it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.09it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.22it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.17it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.17it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.13it/s]100%|██████████| 16/16 [00:04<00:00,  1.03it/s]100%|██████████| 16/16 [00:04<00:00,  3.41it/s]
2025-03-13 11:05:24,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:24
2025-03-13 11:06:01,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5431 secs
2025-03-13 11:06:01,404 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:06:01,404 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 11:06:15,139 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7349 secs
2025-03-13 11:06:15,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9769 secs
2025-03-13 11:06:15,142 [INFO]: {
2025-03-13 11:06:15,142 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:15,142 [INFO]: 	index_param: efSearch=249
2025-03-13 11:06:15,142 [INFO]: 	index_path: knn.index
2025-03-13 11:06:15,142 [INFO]: 	size in bytes: 792878470
2025-03-13 11:06:15,142 [INFO]: 	avg_search_speed_ms: 9.502514306864853
2025-03-13 11:06:15,142 [INFO]: 	99p_search_speed_ms: 12.510825456120074
2025-03-13 11:06:15,142 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:15,142 [INFO]: 	nb vectors: 4030
2025-03-13 11:06:15,142 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:15,142 [INFO]: 	compression ratio: 0.9993085573379235
2025-03-13 11:06:15,142 [INFO]: }
2025-03-13 11:06:15,142 [INFO]: 	>>> Finished "Creating the index" in 54.9784 secs
2025-03-13 11:06:15,142 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0049 secs
2025-03-13 11:06:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 89911 [episode count 13/20]
[retrieval_preprocessing] for episode 54977 [episode count 14/20], we have num_retrieval=np.int64(4288) num_query=np.int64(204)
2025-03-13 11:06:21,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:22,489 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:22
2025-03-13 11:06:22,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2355.03it/s]
2025-03-13 11:06:22,511 [INFO]: There are 4288 embeddings of dim 49152
2025-03-13 11:06:22,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 11:06:22,511 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:22
2025-03-13 11:06:22,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:22,511 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:06:22,511 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:22,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:22,511 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:22
2025-03-13 11:06:22,511 [INFO]: 884.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:22,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:22,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:22
2025-03-13 11:06:22,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:22,511 [INFO]: 	Creating the index 03/13/2025, 11:06:22
2025-03-13 11:06:22,511 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:22
2025-03-13 11:06:22,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:06:22,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:22
2025-03-13 11:06:22,512 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:06:22,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.76it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.03it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.74it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.49it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.67it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.61it/s] 41%|████      | 7/17 [00:00<00:01,  8.32it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.12it/s] 53%|█████▎    | 9/17 [00:01<00:01,  7.93it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.73it/s] 65%|██████▍   | 11/17 [00:01<00:00,  7.55it/s] 71%|███████   | 12/17 [00:01<00:00,  7.31it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.25it/s] 82%|████████▏ | 14/17 [00:01<00:00,  7.72it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.13it/s] 94%|█████████▍| 16/17 [00:02<00:00,  8.52it/s]100%|██████████| 17/17 [00:05<00:00,  1.02s/it]100%|██████████| 17/17 [00:05<00:00,  3.30it/s]
2025-03-13 11:06:27,665 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:27
2025-03-13 11:07:04,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9973 secs
2025-03-13 11:07:04,663 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 11:07:04,663 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 11:07:18,946 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2825 secs
2025-03-13 11:07:18,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4362 secs
2025-03-13 11:07:18,949 [INFO]: {
2025-03-13 11:07:18,949 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:18,949 [INFO]: 	index_param: efSearch=177
2025-03-13 11:07:18,949 [INFO]: 	index_path: knn.index
2025-03-13 11:07:18,949 [INFO]: 	size in bytes: 843638290
2025-03-13 11:07:18,949 [INFO]: 	avg_search_speed_ms: 8.160083409284754
2025-03-13 11:07:18,949 [INFO]: 	99p_search_speed_ms: 11.457646302878855
2025-03-13 11:07:18,949 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:18,949 [INFO]: 	nb vectors: 4288
2025-03-13 11:07:18,949 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:18,949 [INFO]: 	compression ratio: 0.99930872506984
2025-03-13 11:07:18,949 [INFO]: }
2025-03-13 11:07:18,949 [INFO]: 	>>> Finished "Creating the index" in 56.4375 secs
2025-03-13 11:07:18,949 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4599 secs
2025-03-13 11:07:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 54977 [episode count 14/20]
[retrieval_preprocessing] for episode 10950 [episode count 15/20], we have num_retrieval=np.int64(4263) num_query=np.int64(229)
2025-03-13 11:07:22,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:22,653 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:22
2025-03-13 11:07:22,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.04it/s]
2025-03-13 11:07:22,676 [INFO]: There are 4263 embeddings of dim 49152
2025-03-13 11:07:22,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 11:07:22,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:22
2025-03-13 11:07:22,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:22,676 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:07:22,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:22,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:22,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:22
2025-03-13 11:07:22,676 [INFO]: 879.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:22,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:07:22,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:22
2025-03-13 11:07:22,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:22,676 [INFO]: 	Creating the index 03/13/2025, 11:07:22
2025-03-13 11:07:22,676 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:22
2025-03-13 11:07:22,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:07:22,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:22
2025-03-13 11:07:22,677 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:07:22,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.52it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.45it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.68it/s] 41%|████      | 7/17 [00:00<00:00, 12.77it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.31it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.81it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.67it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.49it/s]100%|██████████| 17/17 [00:05<00:00,  1.49it/s]100%|██████████| 17/17 [00:05<00:00,  3.30it/s]
2025-03-13 11:07:27,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:27
2025-03-13 11:08:10,528 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6888 secs
2025-03-13 11:08:10,528 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:08:10,528 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 11:08:24,065 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5372 secs
2025-03-13 11:08:24,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3906 secs
2025-03-13 11:08:24,068 [INFO]: {
2025-03-13 11:08:24,068 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:24,068 [INFO]: 	index_param: efSearch=215
2025-03-13 11:08:24,068 [INFO]: 	index_path: knn.index
2025-03-13 11:08:24,068 [INFO]: 	size in bytes: 838719670
2025-03-13 11:08:24,068 [INFO]: 	avg_search_speed_ms: 9.811768597092431
2025-03-13 11:08:24,068 [INFO]: 	99p_search_speed_ms: 14.488996546715494
2025-03-13 11:08:24,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:24,068 [INFO]: 	nb vectors: 4263
2025-03-13 11:08:24,068 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:24,068 [INFO]: 	compression ratio: 0.9993087487741882
2025-03-13 11:08:24,068 [INFO]: }
2025-03-13 11:08:24,068 [INFO]: 	>>> Finished "Creating the index" in 61.3920 secs
2025-03-13 11:08:24,068 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4150 secs
2025-03-13 11:08:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 10950 [episode count 15/20]
[retrieval_preprocessing] for episode 51028 [episode count 16/20], we have num_retrieval=np.int64(4229) num_query=np.int64(263)
2025-03-13 11:08:27,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:28,191 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:28
2025-03-13 11:08:28,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.48it/s]
2025-03-13 11:08:28,217 [INFO]: There are 4229 embeddings of dim 49152
2025-03-13 11:08:28,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:08:28,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:28
2025-03-13 11:08:28,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:28,218 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:08:28,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:28,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:08:28,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:28
2025-03-13 11:08:28,218 [INFO]: 872.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:28,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:28,218 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:28
2025-03-13 11:08:28,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:28,218 [INFO]: 	Creating the index 03/13/2025, 11:08:28
2025-03-13 11:08:28,218 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:28
2025-03-13 11:08:28,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:08:28,219 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:28
2025-03-13 11:08:28,219 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:08:28,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.74it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.20it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.94it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.31it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.55it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.84it/s] 41%|████      | 7/17 [00:00<00:01,  8.12it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.56it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.85it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.89it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.91it/s] 71%|███████   | 12/17 [00:01<00:00,  8.81it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.66it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.81it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.66it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.58it/s]100%|██████████| 17/17 [00:05<00:00,  1.13s/it]100%|██████████| 17/17 [00:05<00:00,  3.12it/s]
2025-03-13 11:08:33,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:33
2025-03-13 11:09:11,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1832 secs
2025-03-13 11:09:11,853 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 11:09:11,853 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.57it/s] 50%|█████     | 2/4 [00:00<00:00,  4.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.30it/s]
2025-03-13 11:09:26,956 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1028 secs
2025-03-13 11:09:26,959 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7395 secs
2025-03-13 11:09:26,959 [INFO]: {
2025-03-13 11:09:26,959 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:26,959 [INFO]: 	index_param: efSearch=207
2025-03-13 11:09:26,959 [INFO]: 	index_path: knn.index
2025-03-13 11:09:26,959 [INFO]: 	size in bytes: 832030330
2025-03-13 11:09:26,959 [INFO]: 	avg_search_speed_ms: 8.868520568143113
2025-03-13 11:09:26,959 [INFO]: 	99p_search_speed_ms: 12.478140790481122
2025-03-13 11:09:26,959 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:26,959 [INFO]: 	nb vectors: 4229
2025-03-13 11:09:26,959 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:26,959 [INFO]: 	compression ratio: 0.9993088016394787
2025-03-13 11:09:26,959 [INFO]: }
2025-03-13 11:09:26,959 [INFO]: 	>>> Finished "Creating the index" in 58.7410 secs
2025-03-13 11:09:26,959 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7685 secs
2025-03-13 11:09:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 51028 [episode count 16/20]
[retrieval_preprocessing] for episode 45018 [episode count 17/20], we have num_retrieval=np.int64(4336) num_query=np.int64(156)
2025-03-13 11:09:30,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:31,454 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:31
2025-03-13 11:09:31,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.84it/s]
2025-03-13 11:09:31,481 [INFO]: There are 4336 embeddings of dim 49152
2025-03-13 11:09:31,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:09:31,482 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:31
2025-03-13 11:09:31,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:31,482 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:09:31,482 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:31,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:09:31,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:31
2025-03-13 11:09:31,483 [INFO]: 894.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:31,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:09:31,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:31
2025-03-13 11:09:31,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:31,484 [INFO]: 	Creating the index 03/13/2025, 11:09:31
2025-03-13 11:09:31,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:31
2025-03-13 11:09:31,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:09:31,487 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:31
2025-03-13 11:09:31,487 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:09:31,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.50it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.11it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.13it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.56it/s] 50%|█████     | 9/18 [00:00<00:00, 11.97it/s] 61%|██████    | 11/18 [00:00<00:00, 12.04it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.13it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.25it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.30it/s]100%|██████████| 18/18 [00:04<00:00,  4.04it/s]
2025-03-13 11:09:35,948 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:35
2025-03-13 11:10:14,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5284 secs
2025-03-13 11:10:14,477 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 11:10:14,477 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 11:10:33,907 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4292 secs
2025-03-13 11:10:33,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4221 secs
2025-03-13 11:10:33,910 [INFO]: {
2025-03-13 11:10:33,910 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:33,910 [INFO]: 	index_param: efSearch=229
2025-03-13 11:10:33,910 [INFO]: 	index_path: knn.index
2025-03-13 11:10:33,910 [INFO]: 	size in bytes: 853082110
2025-03-13 11:10:33,910 [INFO]: 	avg_search_speed_ms: 9.495870258653818
2025-03-13 11:10:33,910 [INFO]: 	99p_search_speed_ms: 14.293300984427333
2025-03-13 11:10:33,910 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:33,910 [INFO]: 	nb vectors: 4336
2025-03-13 11:10:33,910 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:33,910 [INFO]: 	compression ratio: 0.9993085987936143
2025-03-13 11:10:33,910 [INFO]: }
2025-03-13 11:10:33,910 [INFO]: 	>>> Finished "Creating the index" in 62.4259 secs
2025-03-13 11:10:33,910 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4557 secs
2025-03-13 11:10:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 45018 [episode count 17/20]
[retrieval_preprocessing] for episode 5343 [episode count 18/20], we have num_retrieval=np.int64(4255) num_query=np.int64(237)
2025-03-13 11:10:37,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:38,462 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:38
2025-03-13 11:10:38,462 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.44it/s]
2025-03-13 11:10:38,487 [INFO]: There are 4255 embeddings of dim 49152
2025-03-13 11:10:38,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 11:10:38,487 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:38,487 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:10:38,487 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:38,487 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:38,487 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,487 [INFO]: 878.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:38,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:10:38,487 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:38
2025-03-13 11:10:38,487 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:38,487 [INFO]: 	Creating the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,487 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:38
2025-03-13 11:10:38,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:38,488 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,488 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:10:38,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.18it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.01it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.04it/s] 35%|███▌      | 6/17 [00:00<00:01, 10.00it/s] 41%|████      | 7/17 [00:00<00:01,  9.47it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.10it/s] 53%|█████▎    | 9/17 [00:00<00:00,  9.08it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.30it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.85it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.90it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.74it/s]100%|██████████| 17/17 [00:04<00:00,  1.30it/s]100%|██████████| 17/17 [00:04<00:00,  3.61it/s]
2025-03-13 11:10:43,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:43
2025-03-13 11:11:21,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3696 secs
2025-03-13 11:11:21,569 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 11:11:21,569 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s]
2025-03-13 11:11:37,002 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4331 secs
2025-03-13 11:11:37,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5168 secs
2025-03-13 11:11:37,005 [INFO]: {
2025-03-13 11:11:37,005 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:37,005 [INFO]: 	index_param: efSearch=173
2025-03-13 11:11:37,005 [INFO]: 	index_path: knn.index
2025-03-13 11:11:37,005 [INFO]: 	size in bytes: 837145750
2025-03-13 11:11:37,005 [INFO]: 	avg_search_speed_ms: 7.880162683640694
2025-03-13 11:11:37,005 [INFO]: 	99p_search_speed_ms: 11.944272546097634
2025-03-13 11:11:37,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:37,005 [INFO]: 	nb vectors: 4255
2025-03-13 11:11:37,005 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:37,006 [INFO]: 	compression ratio: 0.9993087105799677
2025-03-13 11:11:37,006 [INFO]: }
2025-03-13 11:11:37,006 [INFO]: 	>>> Finished "Creating the index" in 58.5181 secs
2025-03-13 11:11:37,006 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5436 secs
2025-03-13 11:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 5343 [episode count 18/20]
[retrieval_preprocessing] for episode 75629 [episode count 19/20], we have num_retrieval=np.int64(4222) num_query=np.int64(270)
2025-03-13 11:11:40,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:40,764 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:40
2025-03-13 11:11:40,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.90it/s]
2025-03-13 11:11:40,793 [INFO]: There are 4222 embeddings of dim 49152
2025-03-13 11:11:40,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:11:40,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:40
2025-03-13 11:11:40,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:40,794 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:11:40,794 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:40,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:11:40,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:40
2025-03-13 11:11:40,794 [INFO]: 871.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:40,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:11:40,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:40
2025-03-13 11:11:40,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:40,795 [INFO]: 	Creating the index 03/13/2025, 11:11:40
2025-03-13 11:11:40,795 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:40
2025-03-13 11:11:40,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:11:40,798 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:40
2025-03-13 11:11:40,799 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:11:40,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.65it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.30it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.46it/s] 41%|████      | 7/17 [00:00<00:00, 11.00it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.33it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.54it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.75it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.82it/s]100%|██████████| 17/17 [00:04<00:00,  1.83it/s]100%|██████████| 17/17 [00:04<00:00,  3.82it/s]
2025-03-13 11:11:45,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:45
2025-03-13 11:12:20,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5693 secs
2025-03-13 11:12:20,824 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 11:12:20,824 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s]
2025-03-13 11:12:34,328 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5045 secs
2025-03-13 11:12:34,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5328 secs
2025-03-13 11:12:34,332 [INFO]: {
2025-03-13 11:12:34,332 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:34,332 [INFO]: 	index_param: efSearch=241
2025-03-13 11:12:34,332 [INFO]: 	index_path: knn.index
2025-03-13 11:12:34,332 [INFO]: 	size in bytes: 830653150
2025-03-13 11:12:34,332 [INFO]: 	avg_search_speed_ms: 9.463979009945957
2025-03-13 11:12:34,332 [INFO]: 	99p_search_speed_ms: 14.460173165425662
2025-03-13 11:12:34,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:34,332 [INFO]: 	nb vectors: 4222
2025-03-13 11:12:34,332 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:34,332 [INFO]: 	compression ratio: 0.9993087680459648
2025-03-13 11:12:34,332 [INFO]: }
2025-03-13 11:12:34,332 [INFO]: 	>>> Finished "Creating the index" in 53.5370 secs
2025-03-13 11:12:34,332 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5678 secs
2025-03-13 11:12:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 75629 [episode count 19/20]
2025-03-13 11:12:37: [retrieval_preprocessing] finished for 4938854758_put_pen_in_cup [chosen_id count 0/260]
2025-03-13 11:12:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5059283044_put_screwdriver_in_drawer_and_close [chosen_id count 1/260]
2025-03-13 11:12:39: [retrieval_preprocessing] we have num_total=3254 embedding_dim=49152
[retrieval_preprocessing] for episode 58369 [episode count 0/20], we have num_retrieval=np.int64(3131) num_query=np.int64(123)
2025-03-13 11:12:40,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:41,205 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:41
2025-03-13 11:12:41,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-13 11:12:41,230 [INFO]: There are 3131 embeddings of dim 49152
2025-03-13 11:12:41,230 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:12:41,230 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:41
2025-03-13 11:12:41,230 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:41,230 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:12:41,230 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:41,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:41,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:41
2025-03-13 11:12:41,231 [INFO]: 646.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:41,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:12:41,231 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:41
2025-03-13 11:12:41,231 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:41,231 [INFO]: 	Creating the index 03/13/2025, 11:12:41
2025-03-13 11:12:41,231 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:41
2025-03-13 11:12:41,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:12:41,232 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:41
2025-03-13 11:12:41,232 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:12:41,232 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.08it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.72it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.95it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.35it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.07it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.22it/s]100%|██████████| 13/13 [00:03<00:00,  2.08it/s]100%|██████████| 13/13 [00:03<00:00,  3.68it/s]
2025-03-13 11:12:44,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:44
2025-03-13 11:13:14,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7458 secs
2025-03-13 11:13:14,511 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 11:13:14,511 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s]
2025-03-13 11:13:28,183 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6717 secs
2025-03-13 11:13:28,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9528 secs
2025-03-13 11:13:28,185 [INFO]: {
2025-03-13 11:13:28,185 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:28,185 [INFO]: 	index_param: efSearch=263
2025-03-13 11:13:28,185 [INFO]: 	index_path: knn.index
2025-03-13 11:13:28,185 [INFO]: 	size in bytes: 616004950
2025-03-13 11:13:28,185 [INFO]: 	avg_search_speed_ms: 10.621426778058511
2025-03-13 11:13:28,185 [INFO]: 	99p_search_speed_ms: 14.391285071615131
2025-03-13 11:13:28,185 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:28,185 [INFO]: 	nb vectors: 3131
2025-03-13 11:13:28,185 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:28,185 [INFO]: 	compression ratio: 0.9993095802233407
2025-03-13 11:13:28,185 [INFO]: }
2025-03-13 11:13:28,185 [INFO]: 	>>> Finished "Creating the index" in 46.9544 secs
2025-03-13 11:13:28,185 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9805 secs
2025-03-13 11:13:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 58369 [episode count 0/20]
[retrieval_preprocessing] for episode 71681 [episode count 1/20], we have num_retrieval=np.int64(3109) num_query=np.int64(145)
2025-03-13 11:13:30,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:30,986 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:30
2025-03-13 11:13:30,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1854.25it/s]
2025-03-13 11:13:31,008 [INFO]: There are 3109 embeddings of dim 49152
2025-03-13 11:13:31,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 11:13:31,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:31
2025-03-13 11:13:31,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:31,008 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:13:31,008 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:31,008 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:31,008 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:31
2025-03-13 11:13:31,009 [INFO]: 641.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:31,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:31,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:31
2025-03-13 11:13:31,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:31,009 [INFO]: 	Creating the index 03/13/2025, 11:13:31
2025-03-13 11:13:31,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:31
2025-03-13 11:13:31,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:13:31,010 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:31
2025-03-13 11:13:31,010 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:13:31,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.58it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.30it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.15it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.38it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.54it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.97it/s]100%|██████████| 13/13 [00:03<00:00,  1.84it/s]100%|██████████| 13/13 [00:03<00:00,  3.27it/s]
2025-03-13 11:13:34,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:34
2025-03-13 11:14:07,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3546 secs
2025-03-13 11:14:07,344 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:14:07,344 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-13 11:14:20,389 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0448 secs
2025-03-13 11:14:20,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3815 secs
2025-03-13 11:14:20,392 [INFO]: {
2025-03-13 11:14:20,392 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:20,392 [INFO]: 	index_param: efSearch=242
2025-03-13 11:14:20,392 [INFO]: 	index_path: knn.index
2025-03-13 11:14:20,392 [INFO]: 	size in bytes: 611676490
2025-03-13 11:14:20,392 [INFO]: 	avg_search_speed_ms: 9.75558352588517
2025-03-13 11:14:20,392 [INFO]: 	99p_search_speed_ms: 14.43470174446702
2025-03-13 11:14:20,392 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:20,392 [INFO]: 	nb vectors: 3109
2025-03-13 11:14:20,392 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:20,392 [INFO]: 	compression ratio: 0.9993097364261948
2025-03-13 11:14:20,392 [INFO]: }
2025-03-13 11:14:20,392 [INFO]: 	>>> Finished "Creating the index" in 49.3830 secs
2025-03-13 11:14:20,392 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4053 secs
2025-03-13 11:14:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 71681 [episode count 1/20]
[retrieval_preprocessing] for episode 36358 [episode count 2/20], we have num_retrieval=np.int64(3105) num_query=np.int64(149)
2025-03-13 11:14:22,735 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:23,159 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:23
2025-03-13 11:14:23,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1893.59it/s]
2025-03-13 11:14:23,185 [INFO]: There are 3105 embeddings of dim 49152
2025-03-13 11:14:23,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 11:14:23,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:23,186 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:14:23,186 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:23,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:14:23,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,186 [INFO]: 640.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:23,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:14:23,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:23
2025-03-13 11:14:23,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:23,187 [INFO]: 	Creating the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,187 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:23
2025-03-13 11:14:23,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:14:23,191 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,191 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:14:23,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.77it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.84it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.75it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.42it/s] 69%|██████▉   | 9/13 [00:00<00:00, 13.09it/s]100%|██████████| 13/13 [00:03<00:00,  2.91it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-13 11:14:26,332 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:26
2025-03-13 11:14:56,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1006 secs
2025-03-13 11:14:56,433 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 11:14:56,434 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 11:15:09,517 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0837 secs
2025-03-13 11:15:09,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3287 secs
2025-03-13 11:15:09,520 [INFO]: {
2025-03-13 11:15:09,520 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:09,520 [INFO]: 	index_param: efSearch=296
2025-03-13 11:15:09,520 [INFO]: 	index_path: knn.index
2025-03-13 11:15:09,520 [INFO]: 	size in bytes: 610889530
2025-03-13 11:15:09,520 [INFO]: 	avg_search_speed_ms: 12.300776045936702
2025-03-13 11:15:09,520 [INFO]: 	99p_search_speed_ms: 24.206253159791224
2025-03-13 11:15:09,520 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:09,520 [INFO]: 	nb vectors: 3105
2025-03-13 11:15:09,520 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:09,520 [INFO]: 	compression ratio: 0.9993097115283675
2025-03-13 11:15:09,520 [INFO]: }
2025-03-13 11:15:09,520 [INFO]: 	>>> Finished "Creating the index" in 46.3326 secs
2025-03-13 11:15:09,520 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3608 secs
2025-03-13 11:15:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 36358 [episode count 2/20]
[retrieval_preprocessing] for episode 12822 [episode count 3/20], we have num_retrieval=np.int64(2987) num_query=np.int64(267)
2025-03-13 11:15:12,172 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:12,585 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:12
2025-03-13 11:15:12,585 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.27it/s]
2025-03-13 11:15:12,609 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 11:15:12,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:15:12,609 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:12
2025-03-13 11:15:12,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:12,609 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 11:15:12,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:12,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:12,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:12
2025-03-13 11:15:12,609 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:12,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:12,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:12
2025-03-13 11:15:12,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:12,610 [INFO]: 	Creating the index 03/13/2025, 11:15:12
2025-03-13 11:15:12,610 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:12
2025-03-13 11:15:12,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:15:12,611 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:12
2025-03-13 11:15:12,611 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:15:12,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.99it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.65it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.88it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.54it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.82it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.12it/s]100%|██████████| 12/12 [00:03<00:00,  3.76it/s]
2025-03-13 11:15:15,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:15
2025-03-13 11:15:45,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9762 secs
2025-03-13 11:15:45,789 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:15:45,789 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 11:15:59,278 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4892 secs
2025-03-13 11:15:59,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6698 secs
2025-03-13 11:15:59,281 [INFO]: {
2025-03-13 11:15:59,281 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:59,281 [INFO]: 	index_param: efSearch=256
2025-03-13 11:15:59,281 [INFO]: 	index_path: knn.index
2025-03-13 11:15:59,281 [INFO]: 	size in bytes: 587673790
2025-03-13 11:15:59,281 [INFO]: 	avg_search_speed_ms: 9.827299682562531
2025-03-13 11:15:59,281 [INFO]: 	99p_search_speed_ms: 14.132569099310786
2025-03-13 11:15:59,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:59,281 [INFO]: 	nb vectors: 2987
2025-03-13 11:15:59,281 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:59,281 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 11:15:59,281 [INFO]: }
2025-03-13 11:15:59,281 [INFO]: 	>>> Finished "Creating the index" in 46.6714 secs
2025-03-13 11:15:59,281 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6959 secs
2025-03-13 11:16:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 12822 [episode count 3/20]
[retrieval_preprocessing] for episode 54294 [episode count 4/20], we have num_retrieval=np.int64(3101) num_query=np.int64(153)
2025-03-13 11:16:03,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:03,626 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:03
2025-03-13 11:16:03,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1324.38it/s]
2025-03-13 11:16:03,653 [INFO]: There are 3101 embeddings of dim 49152
2025-03-13 11:16:03,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 11:16:03,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,655 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:03,655 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:16:03,655 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:03,655 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:16:03,655 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,655 [INFO]: 640.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:03,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:16:03,656 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:03
2025-03-13 11:16:03,656 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:03,656 [INFO]: 	Creating the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:03
2025-03-13 11:16:03,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:16:03,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,660 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:16:03,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.42it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.18it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.87it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.32it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.63it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.96it/s]100%|██████████| 13/13 [00:03<00:00,  2.24it/s]100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
2025-03-13 11:16:07,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:07
2025-03-13 11:16:36,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2147 secs
2025-03-13 11:16:36,258 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:16:36,258 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s]
2025-03-13 11:16:48,875 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6169 secs
2025-03-13 11:16:48,877 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2168 secs
2025-03-13 11:16:48,877 [INFO]: {
2025-03-13 11:16:48,877 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:48,877 [INFO]: 	index_param: efSearch=233
2025-03-13 11:16:48,877 [INFO]: 	index_path: knn.index
2025-03-13 11:16:48,877 [INFO]: 	size in bytes: 610102510
2025-03-13 11:16:48,877 [INFO]: 	avg_search_speed_ms: 9.705768695363359
2025-03-13 11:16:48,877 [INFO]: 	99p_search_speed_ms: 13.105191774666316
2025-03-13 11:16:48,877 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:48,877 [INFO]: 	nb vectors: 3101
2025-03-13 11:16:48,877 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:48,877 [INFO]: 	compression ratio: 0.9993097848425505
2025-03-13 11:16:48,877 [INFO]: }
2025-03-13 11:16:48,877 [INFO]: 	>>> Finished "Creating the index" in 45.2208 secs
2025-03-13 11:16:48,877 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2507 secs
2025-03-13 11:16:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 54294 [episode count 4/20]
[retrieval_preprocessing] for episode 39963 [episode count 5/20], we have num_retrieval=np.int64(3086) num_query=np.int64(168)
2025-03-13 11:16:51,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:52,191 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:52
2025-03-13 11:16:52,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.25it/s]
2025-03-13 11:16:52,216 [INFO]: There are 3086 embeddings of dim 49152
2025-03-13 11:16:52,216 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:16:52,216 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:52
2025-03-13 11:16:52,216 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:52,216 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:16:52,216 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:52,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:52,217 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:52
2025-03-13 11:16:52,217 [INFO]: 636.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:52,217 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:52,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:52
2025-03-13 11:16:52,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:52,217 [INFO]: 	Creating the index 03/13/2025, 11:16:52
2025-03-13 11:16:52,217 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:52
2025-03-13 11:16:52,218 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:16:52,218 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:52
2025-03-13 11:16:52,218 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:16:52,218 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.74it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.57it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.41it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.54it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.64it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.82it/s]100%|██████████| 13/13 [00:03<00:00,  2.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.89it/s]
2025-03-13 11:16:55,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:55
2025-03-13 11:17:30,603 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0401 secs
2025-03-13 11:17:30,603 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 11:17:30,604 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 11:17:43,202 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5987 secs
2025-03-13 11:17:43,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9866 secs
2025-03-13 11:17:43,205 [INFO]: {
2025-03-13 11:17:43,205 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:43,205 [INFO]: 	index_param: efSearch=244
2025-03-13 11:17:43,205 [INFO]: 	index_path: knn.index
2025-03-13 11:17:43,205 [INFO]: 	size in bytes: 607151350
2025-03-13 11:17:43,205 [INFO]: 	avg_search_speed_ms: 9.699976065166288
2025-03-13 11:17:43,205 [INFO]: 	99p_search_speed_ms: 17.38959713838996
2025-03-13 11:17:43,205 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:43,205 [INFO]: 	nb vectors: 3086
2025-03-13 11:17:43,205 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:43,205 [INFO]: 	compression ratio: 0.9993097898901155
2025-03-13 11:17:43,205 [INFO]: }
2025-03-13 11:17:43,205 [INFO]: 	>>> Finished "Creating the index" in 50.9881 secs
2025-03-13 11:17:43,205 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0143 secs
2025-03-13 11:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 39963 [episode count 5/20]
[retrieval_preprocessing] for episode 36893 [episode count 6/20], we have num_retrieval=np.int64(3010) num_query=np.int64(244)
2025-03-13 11:17:45,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:46,165 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:46
2025-03-13 11:17:46,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.74it/s]
2025-03-13 11:17:46,187 [INFO]: There are 3010 embeddings of dim 49152
2025-03-13 11:17:46,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 11:17:46,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:46
2025-03-13 11:17:46,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:46,187 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:17:46,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:46,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:46,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:46
2025-03-13 11:17:46,187 [INFO]: 621.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:46,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:46,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:46
2025-03-13 11:17:46,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:46,188 [INFO]: 	Creating the index 03/13/2025, 11:17:46
2025-03-13 11:17:46,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:46
2025-03-13 11:17:46,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:17:46,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:46
2025-03-13 11:17:46,189 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:17:46,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.44it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.00it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.67it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.03it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.35it/s] 50%|█████     | 6/12 [00:00<00:00,  8.45it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.50it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.56it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.58it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.68it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.68it/s]100%|██████████| 12/12 [00:03<00:00,  1.36it/s]100%|██████████| 12/12 [00:03<00:00,  3.44it/s]
2025-03-13 11:17:49,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:49
2025-03-13 11:18:20,882 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1897 secs
2025-03-13 11:18:20,882 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:18:20,882 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 11:18:33,745 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8631 secs
2025-03-13 11:18:33,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5595 secs
2025-03-13 11:18:33,748 [INFO]: {
2025-03-13 11:18:33,748 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:33,748 [INFO]: 	index_param: efSearch=279
2025-03-13 11:18:33,748 [INFO]: 	index_path: knn.index
2025-03-13 11:18:33,748 [INFO]: 	size in bytes: 592198810
2025-03-13 11:18:33,748 [INFO]: 	avg_search_speed_ms: 11.451973152567739
2025-03-13 11:18:33,748 [INFO]: 	99p_search_speed_ms: 16.865997593849894
2025-03-13 11:18:33,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:33,748 [INFO]: 	nb vectors: 3010
2025-03-13 11:18:33,748 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:33,748 [INFO]: 	compression ratio: 0.9993098094877968
2025-03-13 11:18:33,748 [INFO]: }
2025-03-13 11:18:33,748 [INFO]: 	>>> Finished "Creating the index" in 47.5608 secs
2025-03-13 11:18:33,748 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5834 secs
2025-03-13 11:18:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 36893 [episode count 6/20]
[retrieval_preprocessing] for episode 76849 [episode count 7/20], we have num_retrieval=np.int64(3143) num_query=np.int64(111)
2025-03-13 11:18:37,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:37,754 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:37
2025-03-13 11:18:37,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.98it/s]
2025-03-13 11:18:37,786 [INFO]: There are 3143 embeddings of dim 49152
2025-03-13 11:18:37,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:18:37,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:37
2025-03-13 11:18:37,787 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:37,787 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:18:37,787 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:37,787 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:18:37,787 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:37
2025-03-13 11:18:37,788 [INFO]: 648.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:37,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:18:37,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:37
2025-03-13 11:18:37,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:37,788 [INFO]: 	Creating the index 03/13/2025, 11:18:37
2025-03-13 11:18:37,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:37
2025-03-13 11:18:37,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:18:37,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:37
2025-03-13 11:18:37,792 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:18:37,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.55it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.44it/s] 31%|███       | 4/13 [00:00<00:01,  8.54it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.64it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.68it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.75it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.92it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.90it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.89it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.89it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.89it/s]100%|██████████| 13/13 [00:03<00:00,  1.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]
2025-03-13 11:18:41,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:41
2025-03-13 11:19:10,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2996 secs
2025-03-13 11:19:10,722 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:19:10,722 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
2025-03-13 11:19:23,570 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8474 secs
2025-03-13 11:19:23,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7801 secs
2025-03-13 11:19:23,572 [INFO]: {
2025-03-13 11:19:23,572 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:23,572 [INFO]: 	index_param: efSearch=223
2025-03-13 11:19:23,572 [INFO]: 	index_path: knn.index
2025-03-13 11:19:23,572 [INFO]: 	size in bytes: 618365830
2025-03-13 11:19:23,572 [INFO]: 	avg_search_speed_ms: 8.794355619430096
2025-03-13 11:19:23,572 [INFO]: 	99p_search_speed_ms: 12.383438656106597
2025-03-13 11:19:23,572 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:23,572 [INFO]: 	nb vectors: 3143
2025-03-13 11:19:23,572 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:23,572 [INFO]: 	compression ratio: 0.9993096546101197
2025-03-13 11:19:23,572 [INFO]: }
2025-03-13 11:19:23,572 [INFO]: 	>>> Finished "Creating the index" in 45.7841 secs
2025-03-13 11:19:23,572 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8187 secs
2025-03-13 11:19:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 76849 [episode count 7/20]
[retrieval_preprocessing] for episode 30259 [episode count 8/20], we have num_retrieval=np.int64(3082) num_query=np.int64(172)
2025-03-13 11:19:25,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:25,909 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:25
2025-03-13 11:19:25,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1572.08it/s]
2025-03-13 11:19:25,937 [INFO]: There are 3082 embeddings of dim 49152
2025-03-13 11:19:25,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:19:25,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:25
2025-03-13 11:19:25,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:25,938 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:19:25,938 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:25,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:19:25,938 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:25
2025-03-13 11:19:25,938 [INFO]: 636.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:25,938 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:19:25,939 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:25
2025-03-13 11:19:25,939 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:25,939 [INFO]: 	Creating the index 03/13/2025, 11:19:25
2025-03-13 11:19:25,939 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:25
2025-03-13 11:19:25,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:19:25,943 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:25
2025-03-13 11:19:25,943 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:19:25,943 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.70it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.55it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.76it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.13it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.20it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.30it/s]100%|██████████| 13/13 [00:03<00:00,  2.31it/s]100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
2025-03-13 11:19:29,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:29
2025-03-13 11:20:02,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3545 secs
2025-03-13 11:20:02,547 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 11:20:02,547 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 11:20:15,751 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2036 secs
2025-03-13 11:20:15,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8111 secs
2025-03-13 11:20:15,754 [INFO]: {
2025-03-13 11:20:15,754 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:15,754 [INFO]: 	index_param: efSearch=245
2025-03-13 11:20:15,754 [INFO]: 	index_path: knn.index
2025-03-13 11:20:15,754 [INFO]: 	size in bytes: 606364330
2025-03-13 11:20:15,754 [INFO]: 	avg_search_speed_ms: 9.736565444999336
2025-03-13 11:20:15,754 [INFO]: 	99p_search_speed_ms: 14.283348675817253
2025-03-13 11:20:15,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:15,754 [INFO]: 	nb vectors: 3082
2025-03-13 11:20:15,754 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:15,754 [INFO]: 	compression ratio: 0.9993098637579819
2025-03-13 11:20:15,754 [INFO]: }
2025-03-13 11:20:15,754 [INFO]: 	>>> Finished "Creating the index" in 49.8148 secs
2025-03-13 11:20:15,754 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8446 secs
2025-03-13 11:20:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 30259 [episode count 8/20]
[retrieval_preprocessing] for episode 42035 [episode count 9/20], we have num_retrieval=np.int64(3116) num_query=np.int64(138)
2025-03-13 11:20:20,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:20,589 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:20
2025-03-13 11:20:20,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.49it/s]
2025-03-13 11:20:20,613 [INFO]: There are 3116 embeddings of dim 49152
2025-03-13 11:20:20,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 11:20:20,614 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:20,614 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:20:20,614 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:20,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:20,614 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,614 [INFO]: 643.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:20,614 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:20,614 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:20
2025-03-13 11:20:20,614 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:20,614 [INFO]: 	Creating the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,614 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:20
2025-03-13 11:20:20,615 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:20:20,615 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:20
2025-03-13 11:20:20,615 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:20:20,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.45it/s] 31%|███       | 4/13 [00:00<00:00, 17.77it/s] 46%|████▌     | 6/13 [00:00<00:00, 12.46it/s] 62%|██████▏   | 8/13 [00:00<00:00, 13.07it/s] 85%|████████▍ | 11/13 [00:00<00:00, 16.29it/s]100%|██████████| 13/13 [00:03<00:00,  2.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
2025-03-13 11:20:23,950 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:23
2025-03-13 11:20:56,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8475 secs
2025-03-13 11:20:56,798 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 11:20:56,798 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.68it/s]
2025-03-13 11:21:09,559 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7608 secs
2025-03-13 11:21:09,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9459 secs
2025-03-13 11:21:09,561 [INFO]: {
2025-03-13 11:21:09,561 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:09,561 [INFO]: 	index_param: efSearch=213
2025-03-13 11:21:09,561 [INFO]: 	index_path: knn.index
2025-03-13 11:21:09,561 [INFO]: 	size in bytes: 613053670
2025-03-13 11:21:09,561 [INFO]: 	avg_search_speed_ms: 9.709548245147955
2025-03-13 11:21:09,561 [INFO]: 	99p_search_speed_ms: 18.654278088361036
2025-03-13 11:21:09,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:09,561 [INFO]: 	nb vectors: 3116
2025-03-13 11:21:09,561 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:09,561 [INFO]: 	compression ratio: 0.999309779843582
2025-03-13 11:21:09,562 [INFO]: }
2025-03-13 11:21:09,562 [INFO]: 	>>> Finished "Creating the index" in 48.9475 secs
2025-03-13 11:21:09,562 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9726 secs
2025-03-13 11:21:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 42035 [episode count 9/20]
[retrieval_preprocessing] for episode 38454 [episode count 10/20], we have num_retrieval=np.int64(3121) num_query=np.int64(133)
2025-03-13 11:21:12,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:12,524 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:12
2025-03-13 11:21:12,524 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1910.84it/s]
2025-03-13 11:21:12,546 [INFO]: There are 3121 embeddings of dim 49152
2025-03-13 11:21:12,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 11:21:12,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:12
2025-03-13 11:21:12,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:12,547 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:21:12,547 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:12,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:21:12,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:12
2025-03-13 11:21:12,547 [INFO]: 644.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:12,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:12,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:12
2025-03-13 11:21:12,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:12,547 [INFO]: 	Creating the index 03/13/2025, 11:21:12
2025-03-13 11:21:12,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:12
2025-03-13 11:21:12,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:21:12,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:12
2025-03-13 11:21:12,548 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:21:12,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.84it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.65it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.71it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.31it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.59it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.75it/s]100%|██████████| 13/13 [00:03<00:00,  2.43it/s]100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
2025-03-13 11:21:15,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:15
2025-03-13 11:21:47,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6741 secs
2025-03-13 11:21:47,351 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 11:21:47,351 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s]
2025-03-13 11:22:00,985 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6336 secs
2025-03-13 11:22:00,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4393 secs
2025-03-13 11:22:00,988 [INFO]: {
2025-03-13 11:22:00,988 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:00,988 [INFO]: 	index_param: efSearch=250
2025-03-13 11:22:00,988 [INFO]: 	index_path: knn.index
2025-03-13 11:22:00,988 [INFO]: 	size in bytes: 614037370
2025-03-13 11:22:00,988 [INFO]: 	avg_search_speed_ms: 10.527622863209169
2025-03-13 11:22:00,988 [INFO]: 	99p_search_speed_ms: 18.327202997170385
2025-03-13 11:22:00,988 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:00,988 [INFO]: 	nb vectors: 3121
2025-03-13 11:22:00,988 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:00,988 [INFO]: 	compression ratio: 0.9993098107367635
2025-03-13 11:22:00,988 [INFO]: }
2025-03-13 11:22:00,988 [INFO]: 	>>> Finished "Creating the index" in 48.4408 secs
2025-03-13 11:22:00,988 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4637 secs
2025-03-13 11:22:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 38454 [episode count 10/20]
[retrieval_preprocessing] for episode 70710 [episode count 11/20], we have num_retrieval=np.int64(3057) num_query=np.int64(197)
2025-03-13 11:22:03,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:04,199 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:04
2025-03-13 11:22:04,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.79it/s]
2025-03-13 11:22:04,224 [INFO]: There are 3057 embeddings of dim 49152
2025-03-13 11:22:04,224 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:22:04,224 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:04
2025-03-13 11:22:04,224 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:04,224 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:22:04,224 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:04,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:04,224 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:04
2025-03-13 11:22:04,224 [INFO]: 630.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:04,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:22:04,224 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:04
2025-03-13 11:22:04,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:04,224 [INFO]: 	Creating the index 03/13/2025, 11:22:04
2025-03-13 11:22:04,224 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:04
2025-03-13 11:22:04,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:22:04,226 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:04
2025-03-13 11:22:04,226 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:22:04,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.12it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.66it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.18it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.36it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.35it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.71it/s]100%|██████████| 13/13 [00:03<00:00,  2.36it/s]100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
2025-03-13 11:22:07,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:07
2025-03-13 11:22:36,094 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6927 secs
2025-03-13 11:22:36,095 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:22:36,095 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 11:22:50,212 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1171 secs
2025-03-13 11:22:50,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9890 secs
2025-03-13 11:22:50,215 [INFO]: {
2025-03-13 11:22:50,215 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:50,215 [INFO]: 	index_param: efSearch=242
2025-03-13 11:22:50,215 [INFO]: 	index_path: knn.index
2025-03-13 11:22:50,215 [INFO]: 	size in bytes: 601445710
2025-03-13 11:22:50,215 [INFO]: 	avg_search_speed_ms: 11.373775275328766
2025-03-13 11:22:50,215 [INFO]: 	99p_search_speed_ms: 26.289805630221974
2025-03-13 11:22:50,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:50,215 [INFO]: 	nb vectors: 3057
2025-03-13 11:22:50,215 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:50,215 [INFO]: 	compression ratio: 0.9993099061260242
2025-03-13 11:22:50,215 [INFO]: }
2025-03-13 11:22:50,215 [INFO]: 	>>> Finished "Creating the index" in 45.9906 secs
2025-03-13 11:22:50,215 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0155 secs
2025-03-13 11:22:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 70710 [episode count 11/20]
[retrieval_preprocessing] for episode 69696 [episode count 12/20], we have num_retrieval=np.int64(3072) num_query=np.int64(182)
2025-03-13 11:22:53,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:54,263 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:54
2025-03-13 11:22:54,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-13 11:22:54,289 [INFO]: There are 3072 embeddings of dim 49152
2025-03-13 11:22:54,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:22:54,289 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:54
2025-03-13 11:22:54,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:54,289 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:22:54,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:54,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:54,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:54
2025-03-13 11:22:54,289 [INFO]: 634.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:54,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:54,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:54
2025-03-13 11:22:54,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:54,290 [INFO]: 	Creating the index 03/13/2025, 11:22:54
2025-03-13 11:22:54,290 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:54
2025-03-13 11:22:54,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:22:54,291 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:54
2025-03-13 11:22:54,291 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:22:54,291 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.37it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.81it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.00it/s] 31%|███       | 4/13 [00:00<00:01,  7.16it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.77it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.72it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.07it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.35it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.32it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.21it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.56it/s]100%|██████████| 13/13 [00:03<00:00,  1.60it/s]100%|██████████| 13/13 [00:03<00:00,  3.42it/s]
2025-03-13 11:22:58,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:58
2025-03-13 11:23:31,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2252 secs
2025-03-13 11:23:31,325 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 11:23:31,326 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.57it/s] 50%|█████     | 2/4 [00:00<00:00,  4.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.27it/s]
2025-03-13 11:23:46,151 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8257 secs
2025-03-13 11:23:46,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8624 secs
2025-03-13 11:23:46,154 [INFO]: {
2025-03-13 11:23:46,154 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:46,154 [INFO]: 	index_param: efSearch=253
2025-03-13 11:23:46,154 [INFO]: 	index_path: knn.index
2025-03-13 11:23:46,154 [INFO]: 	size in bytes: 604396930
2025-03-13 11:23:46,154 [INFO]: 	avg_search_speed_ms: 9.710071135077227
2025-03-13 11:23:46,154 [INFO]: 	99p_search_speed_ms: 14.058196190744638
2025-03-13 11:23:46,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:46,154 [INFO]: 	nb vectors: 3072
2025-03-13 11:23:46,154 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:46,154 [INFO]: 	compression ratio: 0.9993098012592486
2025-03-13 11:23:46,154 [INFO]: }
2025-03-13 11:23:46,154 [INFO]: 	>>> Finished "Creating the index" in 51.8641 secs
2025-03-13 11:23:46,154 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8911 secs
2025-03-13 11:23:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 69696 [episode count 12/20]
[retrieval_preprocessing] for episode 10817 [episode count 13/20], we have num_retrieval=np.int64(3104) num_query=np.int64(150)
2025-03-13 11:23:49,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:50,248 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:50
2025-03-13 11:23:50,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2159.79it/s]
2025-03-13 11:23:50,272 [INFO]: There are 3104 embeddings of dim 49152
2025-03-13 11:23:50,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:23:50,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:50,273 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:23:50,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:50,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:50,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,273 [INFO]: 640.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:50,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:23:50,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:50
2025-03-13 11:23:50,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:50,273 [INFO]: 	Creating the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:50
2025-03-13 11:23:50,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:23:50,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,275 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:23:50,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.77it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.25it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.72it/s] 31%|███       | 4/13 [00:00<00:01,  7.21it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.51it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.80it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.96it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.02it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.02it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.02it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.04it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.99it/s]100%|██████████| 13/13 [00:04<00:00,  1.07it/s]100%|██████████| 13/13 [00:04<00:00,  2.98it/s]
2025-03-13 11:23:54,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:54
2025-03-13 11:24:27,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9936 secs
2025-03-13 11:24:27,636 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:24:27,636 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.42it/s] 50%|█████     | 2/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-13 11:24:42,017 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3814 secs
2025-03-13 11:24:42,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7452 secs
2025-03-13 11:24:42,020 [INFO]: {
2025-03-13 11:24:42,020 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:42,020 [INFO]: 	index_param: efSearch=198
2025-03-13 11:24:42,020 [INFO]: 	index_path: knn.index
2025-03-13 11:24:42,020 [INFO]: 	size in bytes: 610692790
2025-03-13 11:24:42,020 [INFO]: 	avg_search_speed_ms: 8.708827573163532
2025-03-13 11:24:42,020 [INFO]: 	99p_search_speed_ms: 15.969274365343136
2025-03-13 11:24:42,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:42,020 [INFO]: 	nb vectors: 3104
2025-03-13 11:24:42,020 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:42,020 [INFO]: 	compression ratio: 0.9993097052938843
2025-03-13 11:24:42,020 [INFO]: }
2025-03-13 11:24:42,020 [INFO]: 	>>> Finished "Creating the index" in 51.7470 secs
2025-03-13 11:24:42,020 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7720 secs
2025-03-13 11:24:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 10817 [episode count 13/20]
[retrieval_preprocessing] for episode 7746 [episode count 14/20], we have num_retrieval=np.int64(3079) num_query=np.int64(175)
2025-03-13 11:24:44,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:45,268 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:45
2025-03-13 11:24:45,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.57it/s]
2025-03-13 11:24:45,292 [INFO]: There are 3079 embeddings of dim 49152
2025-03-13 11:24:45,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 11:24:45,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:45,292 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:24:45,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:45,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:45,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,292 [INFO]: 635.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:45,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:45,293 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:45
2025-03-13 11:24:45,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:45,293 [INFO]: 	Creating the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:45
2025-03-13 11:24:45,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:24:45,294 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,294 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:24:45,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.04it/s] 15%|█▌        | 2/13 [00:00<00:02,  4.42it/s] 23%|██▎       | 3/13 [00:00<00:01,  5.12it/s] 31%|███       | 4/13 [00:00<00:01,  5.64it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.34it/s] 54%|█████▍    | 7/13 [00:01<00:00,  7.57it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.82it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.95it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.02it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.21it/s]100%|██████████| 13/13 [00:03<00:00,  1.79it/s]100%|██████████| 13/13 [00:03<00:00,  3.47it/s]
2025-03-13 11:24:49,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:49
2025-03-13 11:25:27,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1609 secs
2025-03-13 11:25:27,207 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:25:27,208 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 11:25:40,772 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5644 secs
2025-03-13 11:25:40,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4810 secs
2025-03-13 11:25:40,775 [INFO]: {
2025-03-13 11:25:40,775 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:40,775 [INFO]: 	index_param: efSearch=194
2025-03-13 11:25:40,775 [INFO]: 	index_path: knn.index
2025-03-13 11:25:40,775 [INFO]: 	size in bytes: 605774110
2025-03-13 11:25:40,775 [INFO]: 	avg_search_speed_ms: 9.323049253564525
2025-03-13 11:25:40,775 [INFO]: 	99p_search_speed_ms: 17.44062387384474
2025-03-13 11:25:40,775 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:40,775 [INFO]: 	nb vectors: 3079
2025-03-13 11:25:40,775 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:40,775 [INFO]: 	compression ratio: 0.9993098450509877
2025-03-13 11:25:40,775 [INFO]: }
2025-03-13 11:25:40,775 [INFO]: 	>>> Finished "Creating the index" in 55.4824 secs
2025-03-13 11:25:40,775 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5067 secs
2025-03-13 11:25:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 7746 [episode count 14/20]
[retrieval_preprocessing] for episode 4170 [episode count 15/20], we have num_retrieval=np.int64(3095) num_query=np.int64(159)
2025-03-13 11:25:43,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:43,723 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:43
2025-03-13 11:25:43,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.54it/s]
2025-03-13 11:25:43,748 [INFO]: There are 3095 embeddings of dim 49152
2025-03-13 11:25:43,748 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:25:43,748 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:43
2025-03-13 11:25:43,748 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:43,748 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:25:43,748 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:43,748 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:43,748 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:43
2025-03-13 11:25:43,748 [INFO]: 638.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:43,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:25:43,748 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:43
2025-03-13 11:25:43,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:43,748 [INFO]: 	Creating the index 03/13/2025, 11:25:43
2025-03-13 11:25:43,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:43
2025-03-13 11:25:43,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:25:43,749 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:43
2025-03-13 11:25:43,749 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:25:43,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.61it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.14it/s] 31%|███       | 4/13 [00:00<00:00,  9.35it/s] 46%|████▌     | 6/13 [00:00<00:00, 10.20it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.69it/s] 77%|███████▋  | 10/13 [00:00<00:00, 10.96it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.14it/s]100%|██████████| 13/13 [00:03<00:00,  3.67it/s]
2025-03-13 11:25:47,295 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:47
2025-03-13 11:26:20,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3984 secs
2025-03-13 11:26:20,694 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:26:20,694 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 11:26:35,023 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3287 secs
2025-03-13 11:26:35,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2765 secs
2025-03-13 11:26:35,027 [INFO]: {
2025-03-13 11:26:35,027 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:35,027 [INFO]: 	index_param: efSearch=239
2025-03-13 11:26:35,027 [INFO]: 	index_path: knn.index
2025-03-13 11:26:35,027 [INFO]: 	size in bytes: 608922070
2025-03-13 11:26:35,027 [INFO]: 	avg_search_speed_ms: 10.192412129725794
2025-03-13 11:26:35,027 [INFO]: 	99p_search_speed_ms: 18.94281175918878
2025-03-13 11:26:35,027 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:35,027 [INFO]: 	nb vectors: 3095
2025-03-13 11:26:35,027 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:35,027 [INFO]: 	compression ratio: 0.9993097474689988
2025-03-13 11:26:35,027 [INFO]: }
2025-03-13 11:26:35,027 [INFO]: 	>>> Finished "Creating the index" in 51.2786 secs
2025-03-13 11:26:35,027 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3033 secs
2025-03-13 11:26:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 4170 [episode count 15/20]
[retrieval_preprocessing] for episode 68173 [episode count 16/20], we have num_retrieval=np.int64(3071) num_query=np.int64(183)
2025-03-13 11:26:37,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:38,010 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:38
2025-03-13 11:26:38,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.18it/s]
2025-03-13 11:26:38,036 [INFO]: There are 3071 embeddings of dim 49152
2025-03-13 11:26:38,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:26:38,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:38,036 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:26:38,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:38,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:38,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,036 [INFO]: 633.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:38,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:26:38,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:38
2025-03-13 11:26:38,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:38,036 [INFO]: 	Creating the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:38
2025-03-13 11:26:38,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:26:38,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,037 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:26:38,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.56it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.70it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.38it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.48it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.13it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.57it/s]100%|██████████| 13/13 [00:03<00:00,  2.37it/s]100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
2025-03-13 11:26:41,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:41
2025-03-13 11:27:15,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1793 secs
2025-03-13 11:27:15,402 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:27:15,402 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 11:27:27,666 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2634 secs
2025-03-13 11:27:27,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6313 secs
2025-03-13 11:27:27,669 [INFO]: {
2025-03-13 11:27:27,669 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:27,669 [INFO]: 	index_param: efSearch=238
2025-03-13 11:27:27,669 [INFO]: 	index_path: knn.index
2025-03-13 11:27:27,669 [INFO]: 	size in bytes: 604200190
2025-03-13 11:27:27,669 [INFO]: 	avg_search_speed_ms: 9.859243187860683
2025-03-13 11:27:27,669 [INFO]: 	99p_search_speed_ms: 15.883221342228353
2025-03-13 11:27:27,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:27,669 [INFO]: 	nb vectors: 3071
2025-03-13 11:27:27,669 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:27,669 [INFO]: 	compression ratio: 0.9993097949869894
2025-03-13 11:27:27,669 [INFO]: }
2025-03-13 11:27:27,669 [INFO]: 	>>> Finished "Creating the index" in 49.6329 secs
2025-03-13 11:27:27,669 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6587 secs
2025-03-13 11:27:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 68173 [episode count 16/20]
[retrieval_preprocessing] for episode 63576 [episode count 17/20], we have num_retrieval=np.int64(3103) num_query=np.int64(151)
2025-03-13 11:27:30,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:30,883 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:30
2025-03-13 11:27:30,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 11:27:30,908 [INFO]: There are 3103 embeddings of dim 49152
2025-03-13 11:27:30,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:27:30,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:30
2025-03-13 11:27:30,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:30,908 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:27:30,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:30,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:30,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:30
2025-03-13 11:27:30,909 [INFO]: 640.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:30,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:30,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:30
2025-03-13 11:27:30,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:30,909 [INFO]: 	Creating the index 03/13/2025, 11:27:30
2025-03-13 11:27:30,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:30
2025-03-13 11:27:30,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:27:30,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:30
2025-03-13 11:27:30,910 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:27:30,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.75it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.15it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.09it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.45it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.55it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.63it/s]100%|██████████| 13/13 [00:03<00:00,  2.32it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-13 11:27:34,144 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:34
2025-03-13 11:28:06,250 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1057 secs
2025-03-13 11:28:06,250 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:28:06,250 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-13 11:28:21,282 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0318 secs
2025-03-13 11:28:21,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3743 secs
2025-03-13 11:28:21,284 [INFO]: {
2025-03-13 11:28:21,284 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:21,284 [INFO]: 	index_param: efSearch=262
2025-03-13 11:28:21,285 [INFO]: 	index_path: knn.index
2025-03-13 11:28:21,285 [INFO]: 	size in bytes: 610496050
2025-03-13 11:28:21,285 [INFO]: 	avg_search_speed_ms: 10.027567589321102
2025-03-13 11:28:21,285 [INFO]: 	99p_search_speed_ms: 13.80809091962874
2025-03-13 11:28:21,285 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:21,285 [INFO]: 	nb vectors: 3103
2025-03-13 11:28:21,285 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:21,285 [INFO]: 	compression ratio: 0.9993096990553829
2025-03-13 11:28:21,285 [INFO]: }
2025-03-13 11:28:21,285 [INFO]: 	>>> Finished "Creating the index" in 50.3758 secs
2025-03-13 11:28:21,285 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4018 secs
2025-03-13 11:28:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 63576 [episode count 17/20]
[retrieval_preprocessing] for episode 14425 [episode count 18/20], we have num_retrieval=np.int64(3130) num_query=np.int64(124)
2025-03-13 11:28:24,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:24,783 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:24
2025-03-13 11:28:24,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1005.83it/s]
2025-03-13 11:28:24,810 [INFO]: There are 3130 embeddings of dim 49152
2025-03-13 11:28:24,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:28:24,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:24,810 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:28:24,810 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:24,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:24,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,810 [INFO]: 646.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:24,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:28:24,811 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:24
2025-03-13 11:28:24,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:24,811 [INFO]: 	Creating the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,811 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:24
2025-03-13 11:28:24,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:28:24,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:24
2025-03-13 11:28:24,812 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:28:24,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.89it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.66it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.01it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.88it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.80it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.43it/s]100%|██████████| 13/13 [00:03<00:00,  2.30it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-13 11:28:28,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:28
2025-03-13 11:29:00,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4496 secs
2025-03-13 11:29:00,497 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 11:29:00,497 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 11:29:15,152 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6554 secs
2025-03-13 11:29:15,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3427 secs
2025-03-13 11:29:15,155 [INFO]: {
2025-03-13 11:29:15,155 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:15,155 [INFO]: 	index_param: efSearch=220
2025-03-13 11:29:15,155 [INFO]: 	index_path: knn.index
2025-03-13 11:29:15,155 [INFO]: 	size in bytes: 615808210
2025-03-13 11:29:15,155 [INFO]: 	avg_search_speed_ms: 10.525690482831315
2025-03-13 11:29:15,155 [INFO]: 	99p_search_speed_ms: 21.315774982795116
2025-03-13 11:29:15,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:15,155 [INFO]: 	nb vectors: 3130
2025-03-13 11:29:15,155 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:15,155 [INFO]: 	compression ratio: 0.9993095739986968
2025-03-13 11:29:15,155 [INFO]: }
2025-03-13 11:29:15,155 [INFO]: 	>>> Finished "Creating the index" in 50.3443 secs
2025-03-13 11:29:15,155 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3720 secs
2025-03-13 11:29:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 14425 [episode count 18/20]
[retrieval_preprocessing] for episode 40549 [episode count 19/20], we have num_retrieval=np.int64(3124) num_query=np.int64(130)
2025-03-13 11:29:17,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:17,646 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:17
2025-03-13 11:29:17,646 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.50it/s]
2025-03-13 11:29:17,670 [INFO]: There are 3124 embeddings of dim 49152
2025-03-13 11:29:17,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:29:17,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:17
2025-03-13 11:29:17,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:17,671 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:29:17,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:17,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:29:17,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:17
2025-03-13 11:29:17,671 [INFO]: 644.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:17,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:17,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:17
2025-03-13 11:29:17,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:17,671 [INFO]: 	Creating the index 03/13/2025, 11:29:17
2025-03-13 11:29:17,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:17
2025-03-13 11:29:17,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:29:17,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:17
2025-03-13 11:29:17,672 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:29:17,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:05,  2.39it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.34it/s] 31%|███       | 4/13 [00:00<00:01,  6.07it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.80it/s] 62%|██████▏   | 8/13 [00:01<00:00, 11.03it/s] 77%|███████▋  | 10/13 [00:01<00:00, 12.36it/s] 92%|█████████▏| 12/13 [00:01<00:00, 13.49it/s]100%|██████████| 13/13 [00:03<00:00,  3.25it/s]
2025-03-13 11:29:21,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:21
2025-03-13 11:29:55,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9131 secs
2025-03-13 11:29:55,589 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:29:55,589 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s]
2025-03-13 11:30:08,638 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0498 secs
2025-03-13 11:30:08,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9683 secs
2025-03-13 11:30:08,641 [INFO]: {
2025-03-13 11:30:08,641 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:08,641 [INFO]: 	index_param: efSearch=256
2025-03-13 11:30:08,641 [INFO]: 	index_path: knn.index
2025-03-13 11:30:08,641 [INFO]: 	size in bytes: 614627770
2025-03-13 11:30:08,641 [INFO]: 	avg_search_speed_ms: 10.396617466899452
2025-03-13 11:30:08,641 [INFO]: 	99p_search_speed_ms: 15.756725741084665
2025-03-13 11:30:08,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:08,641 [INFO]: 	nb vectors: 3124
2025-03-13 11:30:08,641 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:08,641 [INFO]: 	compression ratio: 0.9993095365671486
2025-03-13 11:30:08,641 [INFO]: }
2025-03-13 11:30:08,641 [INFO]: 	>>> Finished "Creating the index" in 50.9698 secs
2025-03-13 11:30:08,641 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9947 secs
2025-03-13 11:30:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 40549 [episode count 19/20]
2025-03-13 11:30:10: [retrieval_preprocessing] finished for 5059283044_put_screwdriver_in_drawer_and_close [chosen_id count 1/260]
2025-03-13 11:30:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_left_click_mouse [chosen_id count 2/260]
2025-03-13 11:30:12: [retrieval_preprocessing] we have num_total=2311 embedding_dim=49152
[retrieval_preprocessing] for episode 59392 [episode count 0/20], we have num_retrieval=np.int64(2188) num_query=np.int64(123)
2025-03-13 11:30:12,925 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:13,213 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:13
2025-03-13 11:30:13,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1855.07it/s]
2025-03-13 11:30:13,235 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 11:30:13,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 11:30:13,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:13
2025-03-13 11:30:13,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:13,236 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:30:13,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:13,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:13,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:13
2025-03-13 11:30:13,236 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:13,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:13,236 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:13
2025-03-13 11:30:13,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:13,236 [INFO]: 	Creating the index 03/13/2025, 11:30:13
2025-03-13 11:30:13,236 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:13
2025-03-13 11:30:13,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:30:13,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:13
2025-03-13 11:30:13,237 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:30:13,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.27it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.11it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.49it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.99it/s]100%|██████████| 9/9 [00:02<00:00,  3.16it/s]100%|██████████| 9/9 [00:02<00:00,  4.44it/s]
2025-03-13 11:30:15,267 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:15
2025-03-13 11:30:40,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2964 secs
2025-03-13 11:30:40,564 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 11:30:40,564 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 11:30:53,749 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1851 secs
2025-03-13 11:30:53,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.5140 secs
2025-03-13 11:30:53,751 [INFO]: {
2025-03-13 11:30:53,751 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:53,751 [INFO]: 	index_param: efSearch=267
2025-03-13 11:30:53,751 [INFO]: 	index_path: knn.index
2025-03-13 11:30:53,751 [INFO]: 	size in bytes: 430475830
2025-03-13 11:30:53,751 [INFO]: 	avg_search_speed_ms: 9.641857292609094
2025-03-13 11:30:53,751 [INFO]: 	99p_search_speed_ms: 14.548943368718044
2025-03-13 11:30:53,751 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:53,751 [INFO]: 	nb vectors: 2188
2025-03-13 11:30:53,751 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:53,751 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 11:30:53,751 [INFO]: }
2025-03-13 11:30:53,751 [INFO]: 	>>> Finished "Creating the index" in 40.5153 secs
2025-03-13 11:30:53,751 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5385 secs
2025-03-13 11:30:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 59392 [episode count 0/20]
[retrieval_preprocessing] for episode 36875 [episode count 1/20], we have num_retrieval=np.int64(2203) num_query=np.int64(108)
2025-03-13 11:30:55,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:55,920 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:55
2025-03-13 11:30:55,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-13 11:30:55,945 [INFO]: There are 2203 embeddings of dim 49152
2025-03-13 11:30:55,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:30:55,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:55
2025-03-13 11:30:55,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:55,946 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:30:55,946 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:55,946 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:55,946 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:55
2025-03-13 11:30:55,946 [INFO]: 454.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:55,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:55,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:55
2025-03-13 11:30:55,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:55,946 [INFO]: 	Creating the index 03/13/2025, 11:30:55
2025-03-13 11:30:55,946 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:55
2025-03-13 11:30:55,947 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:55,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:55
2025-03-13 11:30:55,947 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:30:55,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.90it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.00it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.73it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.19it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]100%|██████████| 9/9 [00:02<00:00,  4.29it/s]
2025-03-13 11:30:58,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:58
2025-03-13 11:31:22,831 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7763 secs
2025-03-13 11:31:22,832 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 11:31:22,832 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-13 11:31:37,924 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0923 secs
2025-03-13 11:31:37,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9783 secs
2025-03-13 11:31:37,926 [INFO]: {
2025-03-13 11:31:37,926 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:37,926 [INFO]: 	index_param: efSearch=286
2025-03-13 11:31:37,926 [INFO]: 	index_path: knn.index
2025-03-13 11:31:37,926 [INFO]: 	size in bytes: 433426930
2025-03-13 11:31:37,926 [INFO]: 	avg_search_speed_ms: 10.192038587728376
2025-03-13 11:31:37,926 [INFO]: 	99p_search_speed_ms: 12.884621741250157
2025-03-13 11:31:37,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:37,926 [INFO]: 	nb vectors: 2203
2025-03-13 11:31:37,926 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:37,926 [INFO]: 	compression ratio: 0.9993089815623594
2025-03-13 11:31:37,926 [INFO]: }
2025-03-13 11:31:37,926 [INFO]: 	>>> Finished "Creating the index" in 41.9797 secs
2025-03-13 11:31:37,926 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0056 secs
2025-03-13 11:31:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 36875 [episode count 1/20]
[retrieval_preprocessing] for episode 86072 [episode count 2/20], we have num_retrieval=np.int64(2167) num_query=np.int64(144)
2025-03-13 11:31:40,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:40,375 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:40
2025-03-13 11:31:40,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.81it/s]
2025-03-13 11:31:40,398 [INFO]: There are 2167 embeddings of dim 49152
2025-03-13 11:31:40,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:31:40,399 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:40
2025-03-13 11:31:40,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:40,399 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:31:40,399 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:40,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:31:40,399 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:40
2025-03-13 11:31:40,399 [INFO]: 447.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:40,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:40,399 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:40
2025-03-13 11:31:40,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:40,399 [INFO]: 	Creating the index 03/13/2025, 11:31:40
2025-03-13 11:31:40,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:40
2025-03-13 11:31:40,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:40,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:40
2025-03-13 11:31:40,400 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:40,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.31it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.90it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.64it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.02it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.36it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.49it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.56it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.63it/s]100%|██████████| 9/9 [00:02<00:00,  1.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.22it/s]
2025-03-13 11:31:43,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:43
2025-03-13 11:32:11,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2264 secs
2025-03-13 11:32:11,424 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 11:32:11,424 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.82it/s] 50%|█████     | 2/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 11:32:28,495 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0708 secs
2025-03-13 11:32:28,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0964 secs
2025-03-13 11:32:28,497 [INFO]: {
2025-03-13 11:32:28,497 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:28,497 [INFO]: 	index_param: efSearch=289
2025-03-13 11:32:28,497 [INFO]: 	index_path: knn.index
2025-03-13 11:32:28,497 [INFO]: 	size in bytes: 426344110
2025-03-13 11:32:28,497 [INFO]: 	avg_search_speed_ms: 10.437730444101364
2025-03-13 11:32:28,497 [INFO]: 	99p_search_speed_ms: 14.242310533300035
2025-03-13 11:32:28,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:28,497 [INFO]: 	nb vectors: 2167
2025-03-13 11:32:28,497 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:28,497 [INFO]: 	compression ratio: 0.9993090698497042
2025-03-13 11:32:28,497 [INFO]: }
2025-03-13 11:32:28,497 [INFO]: 	>>> Finished "Creating the index" in 48.0977 secs
2025-03-13 11:32:28,497 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1217 secs
2025-03-13 11:32:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 86072 [episode count 2/20]
[retrieval_preprocessing] for episode 14393 [episode count 3/20], we have num_retrieval=np.int64(2186) num_query=np.int64(125)
2025-03-13 11:32:30,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:31,693 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:31
2025-03-13 11:32:31,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.47it/s]
2025-03-13 11:32:31,719 [INFO]: There are 2186 embeddings of dim 49152
2025-03-13 11:32:31,719 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:32:31,719 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:31
2025-03-13 11:32:31,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:31,719 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:32:31,719 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:31,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:31,719 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:31
2025-03-13 11:32:31,719 [INFO]: 451.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:31,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:31,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:31
2025-03-13 11:32:31,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:31,720 [INFO]: 	Creating the index 03/13/2025, 11:32:31
2025-03-13 11:32:31,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:31
2025-03-13 11:32:31,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:32:31,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:31
2025-03-13 11:32:31,721 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:32:31,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.71it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.47it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.38it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.38it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.50it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.57it/s]100%|██████████| 9/9 [00:02<00:00,  1.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.29it/s]
2025-03-13 11:32:34,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:34
2025-03-13 11:33:01,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2920 secs
2025-03-13 11:33:01,754 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 11:33:01,754 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 11:33:15,674 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9198 secs
2025-03-13 11:33:15,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9551 secs
2025-03-13 11:33:15,676 [INFO]: {
2025-03-13 11:33:15,676 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:15,676 [INFO]: 	index_param: efSearch=269
2025-03-13 11:33:15,676 [INFO]: 	index_path: knn.index
2025-03-13 11:33:15,676 [INFO]: 	size in bytes: 430082230
2025-03-13 11:33:15,676 [INFO]: 	avg_search_speed_ms: 9.966974892743593
2025-03-13 11:33:15,676 [INFO]: 	99p_search_speed_ms: 15.669415872544063
2025-03-13 11:33:15,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:15,676 [INFO]: 	nb vectors: 2186
2025-03-13 11:33:15,676 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:15,676 [INFO]: 	compression ratio: 0.9993091042147917
2025-03-13 11:33:15,676 [INFO]: }
2025-03-13 11:33:15,676 [INFO]: 	>>> Finished "Creating the index" in 43.9566 secs
2025-03-13 11:33:15,676 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9833 secs
2025-03-13 11:33:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 14393 [episode count 3/20]
[retrieval_preprocessing] for episode 6228 [episode count 4/20], we have num_retrieval=np.int64(2218) num_query=np.int64(93)
2025-03-13 11:33:17,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:17,885 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:17
2025-03-13 11:33:17,885 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 11:33:17,910 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 11:33:17,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:33:17,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:17
2025-03-13 11:33:17,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:17,911 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:33:17,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:17,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:33:17,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:17
2025-03-13 11:33:17,911 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:17,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:33:17,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:17
2025-03-13 11:33:17,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:17,912 [INFO]: 	Creating the index 03/13/2025, 11:33:17
2025-03-13 11:33:17,912 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:17
2025-03-13 11:33:17,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 11:33:17,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:17
2025-03-13 11:33:17,914 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:17,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.60it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.36it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.29it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.81it/s]100%|██████████| 9/9 [00:02<00:00,  2.96it/s]100%|██████████| 9/9 [00:02<00:00,  4.08it/s]
2025-03-13 11:33:20,130 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:20
2025-03-13 11:33:48,159 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0293 secs
2025-03-13 11:33:48,160 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 11:33:48,160 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 11:34:02,561 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4016 secs
2025-03-13 11:34:02,596 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6825 secs
2025-03-13 11:34:02,597 [INFO]: {
2025-03-13 11:34:02,597 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:02,597 [INFO]: 	index_param: efSearch=261
2025-03-13 11:34:02,597 [INFO]: 	index_path: knn.index
2025-03-13 11:34:02,597 [INFO]: 	size in bytes: 436378030
2025-03-13 11:34:02,597 [INFO]: 	avg_search_speed_ms: 9.612108766360997
2025-03-13 11:34:02,597 [INFO]: 	99p_search_speed_ms: 12.762999087572098
2025-03-13 11:34:02,597 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:02,597 [INFO]: 	nb vectors: 2218
2025-03-13 11:34:02,597 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:02,597 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 11:34:02,597 [INFO]: }
2025-03-13 11:34:02,597 [INFO]: 	>>> Finished "Creating the index" in 44.6853 secs
2025-03-13 11:34:02,597 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7119 secs
2025-03-13 11:34:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 6228 [episode count 4/20]
[retrieval_preprocessing] for episode 63689 [episode count 5/20], we have num_retrieval=np.int64(2211) num_query=np.int64(100)
2025-03-13 11:34:04,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:04,553 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:04
2025-03-13 11:34:04,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.33it/s]
2025-03-13 11:34:04,577 [INFO]: There are 2211 embeddings of dim 49152
2025-03-13 11:34:04,577 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:34:04,577 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:04
2025-03-13 11:34:04,578 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:04,578 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:34:04,578 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:04,578 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:04,578 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:04
2025-03-13 11:34:04,578 [INFO]: 456.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:04,578 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:34:04,578 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:04
2025-03-13 11:34:04,578 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:04,578 [INFO]: 	Creating the index 03/13/2025, 11:34:04
2025-03-13 11:34:04,578 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:04
2025-03-13 11:34:04,579 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:34:04,579 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:04
2025-03-13 11:34:04,579 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:04,579 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.41it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.75it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.24it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.34it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.24it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.27it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.29it/s]100%|██████████| 9/9 [00:02<00:00,  1.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]
2025-03-13 11:34:07,280 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:07
2025-03-13 11:34:35,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9932 secs
2025-03-13 11:34:35,273 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:34:35,273 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s]
2025-03-13 11:34:48,309 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0355 secs
2025-03-13 11:34:48,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1107 secs
2025-03-13 11:34:48,690 [INFO]: {
2025-03-13 11:34:48,690 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:48,690 [INFO]: 	index_param: efSearch=238
2025-03-13 11:34:48,691 [INFO]: 	index_path: knn.index
2025-03-13 11:34:48,691 [INFO]: 	size in bytes: 435000850
2025-03-13 11:34:48,691 [INFO]: 	avg_search_speed_ms: 11.09521034133355
2025-03-13 11:34:48,691 [INFO]: 	99p_search_speed_ms: 21.18596783839166
2025-03-13 11:34:48,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:48,691 [INFO]: 	nb vectors: 2211
2025-03-13 11:34:48,691 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:48,691 [INFO]: 	compression ratio: 0.9993090542236871
2025-03-13 11:34:48,691 [INFO]: }
2025-03-13 11:34:48,691 [INFO]: 	>>> Finished "Creating the index" in 44.1130 secs
2025-03-13 11:34:48,691 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1380 secs
2025-03-13 11:34:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 63689 [episode count 5/20]
[retrieval_preprocessing] for episode 31081 [episode count 6/20], we have num_retrieval=np.int64(2224) num_query=np.int64(87)
2025-03-13 11:34:50,424 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:50,728 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:50
2025-03-13 11:34:50,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 11:34:50,753 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 11:34:50,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:34:50,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:50
2025-03-13 11:34:50,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:50,753 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:34:50,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:50,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:50,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:50
2025-03-13 11:34:50,753 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:50,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:50,753 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:50
2025-03-13 11:34:50,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:50,753 [INFO]: 	Creating the index 03/13/2025, 11:34:50
2025-03-13 11:34:50,753 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:50
2025-03-13 11:34:50,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:34:50,754 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:50
2025-03-13 11:34:50,754 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:50,754 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.83it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.32it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.56it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.19it/s]100%|██████████| 9/9 [00:02<00:00,  2.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.82it/s]
2025-03-13 11:34:53,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:53
2025-03-13 11:35:17,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9537 secs
2025-03-13 11:35:17,069 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 11:35:17,069 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 11:35:30,013 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9434 secs
2025-03-13 11:35:30,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2601 secs
2025-03-13 11:35:30,015 [INFO]: {
2025-03-13 11:35:30,015 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:30,015 [INFO]: 	index_param: efSearch=228
2025-03-13 11:35:30,015 [INFO]: 	index_path: knn.index
2025-03-13 11:35:30,015 [INFO]: 	size in bytes: 437558470
2025-03-13 11:35:30,015 [INFO]: 	avg_search_speed_ms: 8.670499542459897
2025-03-13 11:35:30,015 [INFO]: 	99p_search_speed_ms: 11.506516560912132
2025-03-13 11:35:30,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:30,015 [INFO]: 	nb vectors: 2224
2025-03-13 11:35:30,015 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:30,015 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 11:35:30,015 [INFO]: }
2025-03-13 11:35:30,015 [INFO]: 	>>> Finished "Creating the index" in 39.2615 secs
2025-03-13 11:35:30,015 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2863 secs
2025-03-13 11:35:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 31081 [episode count 6/20]
[retrieval_preprocessing] for episode 37322 [episode count 7/20], we have num_retrieval=np.int64(2181) num_query=np.int64(130)
2025-03-13 11:35:31,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:32,390 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:32
2025-03-13 11:35:32,390 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 11:35:32,416 [INFO]: There are 2181 embeddings of dim 49152
2025-03-13 11:35:32,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:35:32,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:32
2025-03-13 11:35:32,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:32,416 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:35:32,416 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:32,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:32,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:32
2025-03-13 11:35:32,416 [INFO]: 450.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:32,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:32,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:32
2025-03-13 11:35:32,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:32,416 [INFO]: 	Creating the index 03/13/2025, 11:35:32
2025-03-13 11:35:32,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:32
2025-03-13 11:35:32,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:35:32,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:32
2025-03-13 11:35:32,418 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:35:32,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.37it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.26it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.97it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.86it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.74it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.54it/s]100%|██████████| 9/9 [00:02<00:00,  1.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.10it/s]
2025-03-13 11:35:35,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:35
2025-03-13 11:36:01,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9326 secs
2025-03-13 11:36:01,257 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:36:01,257 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  4.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.52it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s]
2025-03-13 11:36:16,553 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2961 secs
2025-03-13 11:36:16,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1368 secs
2025-03-13 11:36:16,555 [INFO]: {
2025-03-13 11:36:16,555 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:16,555 [INFO]: 	index_param: efSearch=233
2025-03-13 11:36:16,555 [INFO]: 	index_path: knn.index
2025-03-13 11:36:16,555 [INFO]: 	size in bytes: 429098530
2025-03-13 11:36:16,555 [INFO]: 	avg_search_speed_ms: 9.620662441683145
2025-03-13 11:36:16,555 [INFO]: 	99p_search_speed_ms: 13.503660173155353
2025-03-13 11:36:16,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:16,555 [INFO]: 	nb vectors: 2181
2025-03-13 11:36:16,555 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:16,555 [INFO]: 	compression ratio: 0.9993090584579724
2025-03-13 11:36:16,555 [INFO]: }
2025-03-13 11:36:16,555 [INFO]: 	>>> Finished "Creating the index" in 44.1385 secs
2025-03-13 11:36:16,555 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1650 secs
2025-03-13 11:36:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 37322 [episode count 7/20]
[retrieval_preprocessing] for episode 12809 [episode count 8/20], we have num_retrieval=np.int64(2201) num_query=np.int64(110)
2025-03-13 11:36:18,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:19,270 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:19
2025-03-13 11:36:19,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2061.08it/s]
2025-03-13 11:36:19,295 [INFO]: There are 2201 embeddings of dim 49152
2025-03-13 11:36:19,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:36:19,296 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:19
2025-03-13 11:36:19,296 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:19,296 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:36:19,296 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:19,296 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:19,296 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:19
2025-03-13 11:36:19,296 [INFO]: 454.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:19,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:36:19,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:19
2025-03-13 11:36:19,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:19,296 [INFO]: 	Creating the index 03/13/2025, 11:36:19
2025-03-13 11:36:19,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:19
2025-03-13 11:36:19,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:36:19,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:19
2025-03-13 11:36:19,298 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:36:19,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.67it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.90it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.35it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.57it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.70it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.79it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.95it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.17it/s]100%|██████████| 9/9 [00:03<00:00,  1.42it/s]100%|██████████| 9/9 [00:03<00:00,  2.87it/s]
2025-03-13 11:36:22,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:22
2025-03-13 11:36:52,655 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2151 secs
2025-03-13 11:36:52,656 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:36:52,656 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-13 11:37:09,652 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9961 secs
2025-03-13 11:37:09,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3566 secs
2025-03-13 11:37:09,654 [INFO]: {
2025-03-13 11:37:09,654 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:09,654 [INFO]: 	index_param: efSearch=223
2025-03-13 11:37:09,654 [INFO]: 	index_path: knn.index
2025-03-13 11:37:09,654 [INFO]: 	size in bytes: 433033450
2025-03-13 11:37:09,654 [INFO]: 	avg_search_speed_ms: 8.987738206348343
2025-03-13 11:37:09,654 [INFO]: 	99p_search_speed_ms: 12.068517198786115
2025-03-13 11:37:09,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:09,654 [INFO]: 	nb vectors: 2201
2025-03-13 11:37:09,654 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:09,655 [INFO]: 	compression ratio: 0.9993089633144968
2025-03-13 11:37:09,655 [INFO]: }
2025-03-13 11:37:09,655 [INFO]: 	>>> Finished "Creating the index" in 50.3585 secs
2025-03-13 11:37:09,655 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3846 secs
2025-03-13 11:37:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 12809 [episode count 8/20]
[retrieval_preprocessing] for episode 92685 [episode count 9/20], we have num_retrieval=np.int64(2210) num_query=np.int64(101)
2025-03-13 11:37:14,132 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:14,457 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:14
2025-03-13 11:37:14,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 11:37:14,485 [INFO]: There are 2210 embeddings of dim 49152
2025-03-13 11:37:14,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 11:37:14,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:14
2025-03-13 11:37:14,486 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:14,486 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:37:14,486 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:14,486 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:37:14,486 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:14
2025-03-13 11:37:14,486 [INFO]: 456.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:14,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:37:14,487 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:14
2025-03-13 11:37:14,487 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:14,487 [INFO]: 	Creating the index 03/13/2025, 11:37:14
2025-03-13 11:37:14,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:14
2025-03-13 11:37:14,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:37:14,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:14
2025-03-13 11:37:14,490 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:37:14,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.12it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.78it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.53it/s]100%|██████████| 9/9 [00:02<00:00,  2.52it/s]100%|██████████| 9/9 [00:02<00:00,  3.56it/s]
2025-03-13 11:37:17,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:17
2025-03-13 11:37:42,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4603 secs
2025-03-13 11:37:42,491 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 11:37:42,491 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s]
2025-03-13 11:37:56,317 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8263 secs
2025-03-13 11:37:56,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8291 secs
2025-03-13 11:37:56,319 [INFO]: {
2025-03-13 11:37:56,319 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:56,319 [INFO]: 	index_param: efSearch=140
2025-03-13 11:37:56,319 [INFO]: 	index_path: knn.index
2025-03-13 11:37:56,319 [INFO]: 	size in bytes: 434804110
2025-03-13 11:37:56,319 [INFO]: 	avg_search_speed_ms: 6.5731959940068405
2025-03-13 11:37:56,319 [INFO]: 	99p_search_speed_ms: 10.479503963142626
2025-03-13 11:37:56,319 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:56,319 [INFO]: 	nb vectors: 2210
2025-03-13 11:37:56,319 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:56,319 [INFO]: 	compression ratio: 0.9993090451697892
2025-03-13 11:37:56,319 [INFO]: }
2025-03-13 11:37:56,319 [INFO]: 	>>> Finished "Creating the index" in 41.8320 secs
2025-03-13 11:37:56,319 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8620 secs
2025-03-13 11:37:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 92685 [episode count 9/20]
[retrieval_preprocessing] for episode 66182 [episode count 10/20], we have num_retrieval=np.int64(2182) num_query=np.int64(129)
2025-03-13 11:37:57,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:58,009 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:58
2025-03-13 11:37:58,010 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-13 11:37:58,037 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:37:58,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 11:37:58,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:58
2025-03-13 11:37:58,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:58,038 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:37:58,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:58,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:37:58,039 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:58
2025-03-13 11:37:58,039 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:58,039 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:37:58,040 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:58
2025-03-13 11:37:58,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:58,040 [INFO]: 	Creating the index 03/13/2025, 11:37:58
2025-03-13 11:37:58,040 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:58
2025-03-13 11:37:58,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:37:58,043 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:58
2025-03-13 11:37:58,044 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:37:58,044 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.03it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.38it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.11it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.59it/s]100%|██████████| 9/9 [00:02<00:00,  2.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.79it/s]
2025-03-13 11:38:00,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:00
2025-03-13 11:38:30,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2146 secs
2025-03-13 11:38:30,637 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 11:38:30,637 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 11:38:46,443 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8058 secs
2025-03-13 11:38:46,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4016 secs
2025-03-13 11:38:46,445 [INFO]: {
2025-03-13 11:38:46,445 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:46,445 [INFO]: 	index_param: efSearch=274
2025-03-13 11:38:46,445 [INFO]: 	index_path: knn.index
2025-03-13 11:38:46,445 [INFO]: 	size in bytes: 429295270
2025-03-13 11:38:46,445 [INFO]: 	avg_search_speed_ms: 10.72717644099362
2025-03-13 11:38:46,445 [INFO]: 	99p_search_speed_ms: 16.307998709380552
2025-03-13 11:38:46,445 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:46,445 [INFO]: 	nb vectors: 2182
2025-03-13 11:38:46,445 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:46,445 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:38:46,445 [INFO]: }
2025-03-13 11:38:46,445 [INFO]: 	>>> Finished "Creating the index" in 48.4056 secs
2025-03-13 11:38:46,445 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4359 secs
2025-03-13 11:38:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 66182 [episode count 10/20]
[retrieval_preprocessing] for episode 21129 [episode count 11/20], we have num_retrieval=np.int64(2191) num_query=np.int64(120)
2025-03-13 11:38:48,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:49,244 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:49
2025-03-13 11:38:49,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.11it/s]
2025-03-13 11:38:49,271 [INFO]: There are 2191 embeddings of dim 49152
2025-03-13 11:38:49,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:38:49,271 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:49
2025-03-13 11:38:49,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:49,271 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:38:49,271 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:49,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:49,271 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:49
2025-03-13 11:38:49,271 [INFO]: 452.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:49,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:38:49,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:49
2025-03-13 11:38:49,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:49,272 [INFO]: 	Creating the index 03/13/2025, 11:38:49
2025-03-13 11:38:49,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:49
2025-03-13 11:38:49,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:38:49,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:49
2025-03-13 11:38:49,273 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:38:49,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.34it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.83it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.52it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.82it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.94it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.92it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.01it/s]100%|██████████| 9/9 [00:02<00:00,  1.80it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]
2025-03-13 11:38:51,820 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:51
2025-03-13 11:39:20,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2112 secs
2025-03-13 11:39:20,031 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 11:39:20,032 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.54it/s]
2025-03-13 11:39:34,849 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8171 secs
2025-03-13 11:39:34,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5780 secs
2025-03-13 11:39:34,851 [INFO]: {
2025-03-13 11:39:34,851 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:34,851 [INFO]: 	index_param: efSearch=243
2025-03-13 11:39:34,851 [INFO]: 	index_path: knn.index
2025-03-13 11:39:34,851 [INFO]: 	size in bytes: 431066050
2025-03-13 11:39:34,851 [INFO]: 	avg_search_speed_ms: 9.97101577441742
2025-03-13 11:39:34,851 [INFO]: 	99p_search_speed_ms: 13.788314634002745
2025-03-13 11:39:34,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:34,851 [INFO]: 	nb vectors: 2191
2025-03-13 11:39:34,851 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:34,851 [INFO]: 	compression ratio: 0.9993088715754813
2025-03-13 11:39:34,851 [INFO]: }
2025-03-13 11:39:34,851 [INFO]: 	>>> Finished "Creating the index" in 45.5796 secs
2025-03-13 11:39:34,851 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6075 secs
2025-03-13 11:39:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 21129 [episode count 11/20]
[retrieval_preprocessing] for episode 27283 [episode count 12/20], we have num_retrieval=np.int64(2166) num_query=np.int64(145)
2025-03-13 11:39:37,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:37,555 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:37
2025-03-13 11:39:37,555 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.52it/s]
2025-03-13 11:39:37,582 [INFO]: There are 2166 embeddings of dim 49152
2025-03-13 11:39:37,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:39:37,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:37
2025-03-13 11:39:37,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:37,583 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:39:37,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:37,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:39:37,583 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:37
2025-03-13 11:39:37,583 [INFO]: 447.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:37,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:39:37,583 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:37
2025-03-13 11:39:37,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:37,583 [INFO]: 	Creating the index 03/13/2025, 11:39:37
2025-03-13 11:39:37,583 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:37
2025-03-13 11:39:37,584 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:39:37,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:37
2025-03-13 11:39:37,585 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:39:37,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.88it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.14it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.03it/s] 78%|███████▊  | 7/9 [00:00<00:00, 15.96it/s]100%|██████████| 9/9 [00:01<00:00,  3.16it/s]100%|██████████| 9/9 [00:01<00:00,  4.61it/s]
2025-03-13 11:39:39,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:39
2025-03-13 11:40:06,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7190 secs
2025-03-13 11:40:06,260 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 11:40:06,260 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s]
2025-03-13 11:40:19,360 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0995 secs
2025-03-13 11:40:19,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7772 secs
2025-03-13 11:40:19,362 [INFO]: {
2025-03-13 11:40:19,362 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:19,362 [INFO]: 	index_param: efSearch=165
2025-03-13 11:40:19,363 [INFO]: 	index_path: knn.index
2025-03-13 11:40:19,363 [INFO]: 	size in bytes: 426147310
2025-03-13 11:40:19,363 [INFO]: 	avg_search_speed_ms: 7.199452206347597
2025-03-13 11:40:19,363 [INFO]: 	99p_search_speed_ms: 14.480572342872577
2025-03-13 11:40:19,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:19,363 [INFO]: 	nb vectors: 2166
2025-03-13 11:40:19,363 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:19,363 [INFO]: 	compression ratio: 0.9993092013182014
2025-03-13 11:40:19,363 [INFO]: }
2025-03-13 11:40:19,363 [INFO]: 	>>> Finished "Creating the index" in 41.7793 secs
2025-03-13 11:40:19,363 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8080 secs
2025-03-13 11:40:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 27283 [episode count 12/20]
[retrieval_preprocessing] for episode 33428 [episode count 13/20], we have num_retrieval=np.int64(2204) num_query=np.int64(107)
2025-03-13 11:40:20,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:21,245 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:21
2025-03-13 11:40:21,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-13 11:40:21,269 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 11:40:21,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:40:21,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:21
2025-03-13 11:40:21,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:21,269 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:40:21,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:21,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:21,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:21
2025-03-13 11:40:21,270 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:21,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:21,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:21
2025-03-13 11:40:21,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:21,270 [INFO]: 	Creating the index 03/13/2025, 11:40:21
2025-03-13 11:40:21,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:21
2025-03-13 11:40:21,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:40:21,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:21
2025-03-13 11:40:21,271 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:40:21,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.66it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.27it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.88it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.21it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.67it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.71it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.86it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.83it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.67it/s]
2025-03-13 11:40:23,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:23
2025-03-13 11:40:52,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9348 secs
2025-03-13 11:40:52,664 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:40:52,664 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-13 11:41:05,938 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2734 secs
2025-03-13 11:41:05,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6700 secs
2025-03-13 11:41:05,941 [INFO]: {
2025-03-13 11:41:05,941 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:05,941 [INFO]: 	index_param: efSearch=264
2025-03-13 11:41:05,941 [INFO]: 	index_path: knn.index
2025-03-13 11:41:05,941 [INFO]: 	size in bytes: 433623670
2025-03-13 11:41:05,941 [INFO]: 	avg_search_speed_ms: 9.97677921436489
2025-03-13 11:41:05,941 [INFO]: 	99p_search_speed_ms: 14.93973515694961
2025-03-13 11:41:05,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:05,941 [INFO]: 	nb vectors: 2204
2025-03-13 11:41:05,941 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:05,941 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 11:41:05,941 [INFO]: }
2025-03-13 11:41:05,941 [INFO]: 	>>> Finished "Creating the index" in 44.6715 secs
2025-03-13 11:41:05,941 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6958 secs
2025-03-13 11:41:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 33428 [episode count 13/20]
[retrieval_preprocessing] for episode 12987 [episode count 14/20], we have num_retrieval=np.int64(2209) num_query=np.int64(102)
2025-03-13 11:41:08,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:08,845 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:08
2025-03-13 11:41:08,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.15it/s]
2025-03-13 11:41:08,872 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 11:41:08,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:41:08,872 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:08
2025-03-13 11:41:08,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:08,873 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:41:08,873 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:08,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:41:08,873 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:08
2025-03-13 11:41:08,873 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:08,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:41:08,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:08
2025-03-13 11:41:08,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:08,874 [INFO]: 	Creating the index 03/13/2025, 11:41:08
2025-03-13 11:41:08,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:08
2025-03-13 11:41:08,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:41:08,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:08
2025-03-13 11:41:08,877 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:41:08,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.11it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.61it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.57it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.11it/s]100%|██████████| 9/9 [00:02<00:00,  3.17it/s]100%|██████████| 9/9 [00:02<00:00,  4.40it/s]
2025-03-13 11:41:10,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:10
2025-03-13 11:41:35,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6377 secs
2025-03-13 11:41:35,570 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 11:41:35,570 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 11:41:51,765 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1947 secs
2025-03-13 11:41:51,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8896 secs
2025-03-13 11:41:51,767 [INFO]: {
2025-03-13 11:41:51,767 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:51,767 [INFO]: 	index_param: efSearch=305
2025-03-13 11:41:51,767 [INFO]: 	index_path: knn.index
2025-03-13 11:41:51,767 [INFO]: 	size in bytes: 434607370
2025-03-13 11:41:51,767 [INFO]: 	avg_search_speed_ms: 11.42226685381805
2025-03-13 11:41:51,767 [INFO]: 	99p_search_speed_ms: 16.597274865489453
2025-03-13 11:41:51,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:51,767 [INFO]: 	nb vectors: 2209
2025-03-13 11:41:51,767 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:51,767 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 11:41:51,767 [INFO]: }
2025-03-13 11:41:51,767 [INFO]: 	>>> Finished "Creating the index" in 42.8930 secs
2025-03-13 11:41:51,767 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9215 secs
2025-03-13 11:41:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 12987 [episode count 14/20]
[retrieval_preprocessing] for episode 17237 [episode count 15/20], we have num_retrieval=np.int64(2194) num_query=np.int64(117)
2025-03-13 11:41:53,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:54,489 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:54
2025-03-13 11:41:54,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 11:41:54,516 [INFO]: There are 2194 embeddings of dim 49152
2025-03-13 11:41:54,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:41:54,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:54,517 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:41:54,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:54,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:54,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,517 [INFO]: 452.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:54,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:54,517 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:54
2025-03-13 11:41:54,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:54,517 [INFO]: 	Creating the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:54
2025-03-13 11:41:54,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:41:54,518 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,518 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:41:54,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.44it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.32it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.19it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.19it/s]100%|██████████| 9/9 [00:02<00:00,  2.78it/s]100%|██████████| 9/9 [00:02<00:00,  3.90it/s]
2025-03-13 11:41:56,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:56
2025-03-13 11:42:20,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5200 secs
2025-03-13 11:42:20,347 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 11:42:20,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s]
2025-03-13 11:42:33,827 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4800 secs
2025-03-13 11:42:33,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3108 secs
2025-03-13 11:42:33,829 [INFO]: {
2025-03-13 11:42:33,829 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:33,829 [INFO]: 	index_param: efSearch=289
2025-03-13 11:42:33,829 [INFO]: 	index_path: knn.index
2025-03-13 11:42:33,829 [INFO]: 	size in bytes: 431656270
2025-03-13 11:42:33,829 [INFO]: 	avg_search_speed_ms: 9.759996984063125
2025-03-13 11:42:33,829 [INFO]: 	99p_search_speed_ms: 14.363548178225754
2025-03-13 11:42:33,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:33,829 [INFO]: 	nb vectors: 2194
2025-03-13 11:42:33,829 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:33,829 [INFO]: 	compression ratio: 0.9993088991849928
2025-03-13 11:42:33,829 [INFO]: }
2025-03-13 11:42:33,829 [INFO]: 	>>> Finished "Creating the index" in 39.3123 secs
2025-03-13 11:42:33,829 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3402 secs
2025-03-13 11:42:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 17237 [episode count 15/20]
[retrieval_preprocessing] for episode 87080 [episode count 16/20], we have num_retrieval=np.int64(2180) num_query=np.int64(131)
2025-03-13 11:42:36,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:36,483 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:36
2025-03-13 11:42:36,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.46it/s]
2025-03-13 11:42:36,508 [INFO]: There are 2180 embeddings of dim 49152
2025-03-13 11:42:36,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:42:36,508 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:36
2025-03-13 11:42:36,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:36,509 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:42:36,509 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:36,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:36,509 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:36
2025-03-13 11:42:36,509 [INFO]: 449.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:36,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:42:36,509 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:36
2025-03-13 11:42:36,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:36,509 [INFO]: 	Creating the index 03/13/2025, 11:42:36
2025-03-13 11:42:36,509 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:36
2025-03-13 11:42:36,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:42:36,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:36
2025-03-13 11:42:36,510 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:42:36,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.92it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.39it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.83it/s]100%|██████████| 9/9 [00:02<00:00,  2.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.99it/s]
2025-03-13 11:42:38,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:38
2025-03-13 11:43:04,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6567 secs
2025-03-13 11:43:04,425 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:43:04,425 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-13 11:43:18,198 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7725 secs
2025-03-13 11:43:18,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6895 secs
2025-03-13 11:43:18,200 [INFO]: {
2025-03-13 11:43:18,200 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:18,200 [INFO]: 	index_param: efSearch=262
2025-03-13 11:43:18,200 [INFO]: 	index_path: knn.index
2025-03-13 11:43:18,200 [INFO]: 	size in bytes: 428901790
2025-03-13 11:43:18,200 [INFO]: 	avg_search_speed_ms: 9.953255277933247
2025-03-13 11:43:18,200 [INFO]: 	99p_search_speed_ms: 15.446951473131778
2025-03-13 11:43:18,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:18,200 [INFO]: 	nb vectors: 2180
2025-03-13 11:43:18,200 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:18,200 [INFO]: 	compression ratio: 0.9993090492814217
2025-03-13 11:43:18,200 [INFO]: }
2025-03-13 11:43:18,200 [INFO]: 	>>> Finished "Creating the index" in 41.6911 secs
2025-03-13 11:43:18,200 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7174 secs
2025-03-13 11:43:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 87080 [episode count 16/20]
[retrieval_preprocessing] for episode 31838 [episode count 17/20], we have num_retrieval=np.int64(2196) num_query=np.int64(115)
2025-03-13 11:43:20,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:20,487 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:20
2025-03-13 11:43:20,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.16it/s]
2025-03-13 11:43:20,512 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 11:43:20,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:43:20,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:20
2025-03-13 11:43:20,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:20,513 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:43:20,513 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:20,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:43:20,513 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:20
2025-03-13 11:43:20,513 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:20,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:43:20,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:20
2025-03-13 11:43:20,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:20,514 [INFO]: 	Creating the index 03/13/2025, 11:43:20
2025-03-13 11:43:20,514 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:20
2025-03-13 11:43:20,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:43:20,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:20
2025-03-13 11:43:20,517 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:43:20,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.87it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.93it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.60it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.69it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.87it/s]
2025-03-13 11:43:22,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:22
2025-03-13 11:43:47,533 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6452 secs
2025-03-13 11:43:47,534 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:43:47,534 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-13 11:44:02,062 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5285 secs
2025-03-13 11:44:02,065 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5480 secs
2025-03-13 11:44:02,065 [INFO]: {
2025-03-13 11:44:02,065 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:02,065 [INFO]: 	index_param: efSearch=215
2025-03-13 11:44:02,065 [INFO]: 	index_path: knn.index
2025-03-13 11:44:02,065 [INFO]: 	size in bytes: 432049750
2025-03-13 11:44:02,065 [INFO]: 	avg_search_speed_ms: 8.61721590516686
2025-03-13 11:44:02,065 [INFO]: 	99p_search_speed_ms: 11.305932607501745
2025-03-13 11:44:02,065 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:02,065 [INFO]: 	nb vectors: 2196
2025-03-13 11:44:02,065 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:02,065 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 11:44:02,065 [INFO]: }
2025-03-13 11:44:02,065 [INFO]: 	>>> Finished "Creating the index" in 41.5517 secs
2025-03-13 11:44:02,065 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5779 secs
2025-03-13 11:44:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 31838 [episode count 17/20]
[retrieval_preprocessing] for episode 27780 [episode count 18/20], we have num_retrieval=np.int64(2198) num_query=np.int64(113)
2025-03-13 11:44:04,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:04,460 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:04
2025-03-13 11:44:04,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 11:44:04,485 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 11:44:04,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:44:04,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:04
2025-03-13 11:44:04,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:04,485 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:44:04,485 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:04,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:04,485 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:04
2025-03-13 11:44:04,485 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:04,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:44:04,485 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:04
2025-03-13 11:44:04,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:04,485 [INFO]: 	Creating the index 03/13/2025, 11:44:04
2025-03-13 11:44:04,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:04
2025-03-13 11:44:04,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:44:04,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:04
2025-03-13 11:44:04,486 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:44:04,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.93it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.36it/s]100%|██████████| 9/9 [00:02<00:00,  4.07it/s]
2025-03-13 11:44:06,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:06
2025-03-13 11:44:38,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6729 secs
2025-03-13 11:44:38,375 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 11:44:38,375 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 11:44:53,445 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0698 secs
2025-03-13 11:44:54,378 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8920 secs
2025-03-13 11:44:54,379 [INFO]: {
2025-03-13 11:44:54,379 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:54,379 [INFO]: 	index_param: efSearch=134
2025-03-13 11:44:54,379 [INFO]: 	index_path: knn.index
2025-03-13 11:44:54,379 [INFO]: 	size in bytes: 432443230
2025-03-13 11:44:54,379 [INFO]: 	avg_search_speed_ms: 7.35811375556452
2025-03-13 11:44:54,379 [INFO]: 	99p_search_speed_ms: 11.401232988573618
2025-03-13 11:44:54,379 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:54,379 [INFO]: 	nb vectors: 2198
2025-03-13 11:44:54,379 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:54,379 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 11:44:54,379 [INFO]: }
2025-03-13 11:44:54,379 [INFO]: 	>>> Finished "Creating the index" in 49.8940 secs
2025-03-13 11:44:54,379 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9189 secs
2025-03-13 11:44:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 27780 [episode count 18/20]
[retrieval_preprocessing] for episode 40114 [episode count 19/20], we have num_retrieval=np.int64(2200) num_query=np.int64(111)
2025-03-13 11:44:55,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:56,085 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:56
2025-03-13 11:44:56,085 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-13 11:44:56,109 [INFO]: There are 2200 embeddings of dim 49152
2025-03-13 11:44:56,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:44:56,109 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:56
2025-03-13 11:44:56,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:56,109 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:44:56,109 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:56,109 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:56,109 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:56
2025-03-13 11:44:56,110 [INFO]: 454.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:56,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:56,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:56
2025-03-13 11:44:56,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:56,110 [INFO]: 	Creating the index 03/13/2025, 11:44:56
2025-03-13 11:44:56,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:56
2025-03-13 11:44:56,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:44:56,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:56
2025-03-13 11:44:56,111 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:44:56,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.29it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.90it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.78it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.17it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.42it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.59it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.67it/s]100%|██████████| 9/9 [00:02<00:00,  2.03it/s]100%|██████████| 9/9 [00:02<00:00,  3.39it/s]
2025-03-13 11:44:58,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:58
2025-03-13 11:45:23,102 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3326 secs
2025-03-13 11:45:23,102 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 11:45:23,102 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 11:45:37,339 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2368 secs
2025-03-13 11:45:37,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2307 secs
2025-03-13 11:45:37,342 [INFO]: {
2025-03-13 11:45:37,342 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:37,342 [INFO]: 	index_param: efSearch=167
2025-03-13 11:45:37,342 [INFO]: 	index_path: knn.index
2025-03-13 11:45:37,342 [INFO]: 	size in bytes: 432836710
2025-03-13 11:45:37,342 [INFO]: 	avg_search_speed_ms: 7.282643748015892
2025-03-13 11:45:37,342 [INFO]: 	99p_search_speed_ms: 10.974367037415501
2025-03-13 11:45:37,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:37,342 [INFO]: 	nb vectors: 2200
2025-03-13 11:45:37,342 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:37,342 [INFO]: 	compression ratio: 0.9993089541781242
2025-03-13 11:45:37,342 [INFO]: }
2025-03-13 11:45:37,342 [INFO]: 	>>> Finished "Creating the index" in 41.2322 secs
2025-03-13 11:45:37,342 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2572 secs
2025-03-13 11:45:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 40114 [episode count 19/20]
2025-03-13 11:45:38: [retrieval_preprocessing] finished for 5207831207_left_click_mouse [chosen_id count 2/260]
2025-03-13 11:45:46: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_pour_cup_into_bowl [chosen_id count 3/260]
2025-03-13 11:45:46: [retrieval_preprocessing] we have num_total=10734 embedding_dim=49152
[retrieval_preprocessing] for episode 53248 [episode count 0/20], we have num_retrieval=np.int64(10172) num_query=np.int64(562)
2025-03-13 11:45:49,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:51,024 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:51
2025-03-13 11:45:51,025 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.35it/s]
2025-03-13 11:45:51,050 [INFO]: There are 10172 embeddings of dim 49152
2025-03-13 11:45:51,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:45:51,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:51,050 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:45:51,050 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:45:51,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:51,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,051 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:51,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:45:51,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:51
2025-03-13 11:45:51,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:51,051 [INFO]: 	Creating the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,051 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:45:51
2025-03-13 11:45:51,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 11:45:51,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,052 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:45:51,052 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/42 [00:00<?, ?it/s]  2%|▏         | 1/42 [00:00<00:07,  5.72it/s]  7%|▋         | 3/42 [00:00<00:04,  9.47it/s] 12%|█▏        | 5/42 [00:00<00:03, 10.56it/s] 17%|█▋        | 7/42 [00:00<00:03, 11.13it/s] 21%|██▏       | 9/42 [00:00<00:02, 11.41it/s] 26%|██▌       | 11/42 [00:01<00:07,  4.27it/s] 29%|██▊       | 12/42 [00:02<00:06,  4.40it/s] 36%|███▌      | 15/42 [00:02<00:03,  6.84it/s] 43%|████▎     | 18/42 [00:02<00:02,  9.53it/s] 48%|████▊     | 20/42 [00:02<00:02,  9.02it/s] 52%|█████▏    | 22/42 [00:09<00:21,  1.07s/it] 55%|█████▍    | 23/42 [00:10<00:20,  1.08s/it] 57%|█████▋    | 24/42 [00:10<00:16,  1.10it/s] 60%|█████▉    | 25/42 [00:11<00:13,  1.25it/s] 62%|██████▏   | 26/42 [00:12<00:13,  1.20it/s] 64%|██████▍   | 27/42 [00:12<00:11,  1.31it/s] 67%|██████▋   | 28/42 [00:14<00:12,  1.10it/s] 69%|██████▉   | 29/42 [00:15<00:12,  1.07it/s] 71%|███████▏  | 30/42 [00:15<00:08,  1.41it/s] 76%|███████▌  | 32/42 [00:15<00:04,  2.26it/s] 79%|███████▊  | 33/42 [00:16<00:05,  1.75it/s] 81%|████████  | 34/42 [00:17<00:04,  1.78it/s] 83%|████████▎ | 35/42 [00:17<00:03,  1.97it/s] 86%|████████▌ | 36/42 [00:17<00:02,  2.38it/s] 88%|████████▊ | 37/42 [00:17<00:01,  2.63it/s] 90%|█████████ | 38/42 [00:18<00:01,  2.57it/s] 95%|█████████▌| 40/42 [00:18<00:00,  3.90it/s]100%|██████████| 42/42 [00:25<00:00,  1.49s/it]100%|██████████| 42/42 [00:25<00:00,  1.66it/s]
2025-03-13 11:46:16,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:16
2025-03-13 11:47:23,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.4653 secs
2025-03-13 11:47:23,813 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 11:47:23,813 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 11:47:48,664 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8503 secs
2025-03-13 11:47:48,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.6159 secs
2025-03-13 11:47:48,668 [INFO]: {
2025-03-13 11:47:48,668 [INFO]: 	index_key: HNSW32
2025-03-13 11:47:48,668 [INFO]: 	index_param: efSearch=117
2025-03-13 11:47:48,668 [INFO]: 	index_path: knn.index
2025-03-13 11:47:48,668 [INFO]: 	size in bytes: 2002661170
2025-03-13 11:47:48,668 [INFO]: 	avg_search_speed_ms: 9.123634081758748
2025-03-13 11:47:48,668 [INFO]: 	99p_search_speed_ms: 19.49194233166053
2025-03-13 11:47:48,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:48,668 [INFO]: 	nb vectors: 10172
2025-03-13 11:47:48,668 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:48,668 [INFO]: 	compression ratio: 0.9986195398196092
2025-03-13 11:47:48,668 [INFO]: }
2025-03-13 11:47:48,668 [INFO]: 	>>> Finished "Creating the index" in 117.6173 secs
2025-03-13 11:47:48,668 [INFO]: >>> Finished "Launching the whole pipeline" in 117.6437 secs
2025-03-13 11:47:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 53248 [episode count 0/20]
[retrieval_preprocessing] for episode 53291 [episode count 1/20], we have num_retrieval=np.int64(10246) num_query=np.int64(488)
2025-03-13 11:47:55,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:57,774 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:57
2025-03-13 11:47:57,774 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.73it/s]
2025-03-13 11:47:57,800 [INFO]: There are 10246 embeddings of dim 49152
2025-03-13 11:47:57,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:47:57,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:57
2025-03-13 11:47:57,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:57,801 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:47:57,801 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:47:57,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:47:57,802 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:57
2025-03-13 11:47:57,802 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:57,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:47:57,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:57
2025-03-13 11:47:57,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:47:57,803 [INFO]: 	Creating the index 03/13/2025, 11:47:57
2025-03-13 11:47:57,803 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:47:57
2025-03-13 11:47:57,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 11:47:57,807 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:57
2025-03-13 11:47:57,807 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:47:57,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  5.24it/s]  7%|▋         | 3/43 [00:00<00:04,  9.49it/s] 12%|█▏        | 5/43 [00:00<00:03, 10.92it/s] 16%|█▋        | 7/43 [00:00<00:03, 11.01it/s] 21%|██        | 9/43 [00:00<00:03, 10.52it/s] 26%|██▌       | 11/43 [00:01<00:03, 10.05it/s] 30%|███       | 13/43 [00:01<00:03,  9.99it/s] 35%|███▍      | 15/43 [00:01<00:02, 10.43it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.08it/s] 44%|████▍     | 19/43 [00:01<00:02, 11.51it/s] 49%|████▉     | 21/43 [00:07<00:20,  1.06it/s] 51%|█████     | 22/43 [00:07<00:16,  1.27it/s] 56%|█████▌    | 24/43 [00:07<00:10,  1.81it/s] 60%|██████    | 26/43 [00:07<00:06,  2.50it/s] 65%|██████▌   | 28/43 [00:08<00:04,  3.33it/s] 70%|██████▉   | 30/43 [00:08<00:03,  4.27it/s] 74%|███████▍  | 32/43 [00:08<00:02,  5.31it/s] 79%|███████▉  | 34/43 [00:08<00:01,  6.33it/s] 84%|████████▎ | 36/43 [00:08<00:00,  7.29it/s] 88%|████████▊ | 38/43 [00:09<00:00,  8.19it/s] 93%|█████████▎| 40/43 [00:09<00:00,  8.91it/s] 98%|█████████▊| 42/43 [00:15<00:01,  1.06s/it]100%|██████████| 43/43 [00:17<00:00,  1.21s/it]100%|██████████| 43/43 [00:17<00:00,  2.44it/s]
2025-03-13 11:48:15,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:15
2025-03-13 11:49:23,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.3116 secs
2025-03-13 11:49:23,762 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 11:49:23,762 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 11:49:50,650 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8874 secs
2025-03-13 11:49:50,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.8442 secs
2025-03-13 11:49:50,651 [INFO]: {
2025-03-13 11:49:50,651 [INFO]: 	index_key: HNSW32
2025-03-13 11:49:50,651 [INFO]: 	index_param: efSearch=127
2025-03-13 11:49:50,651 [INFO]: 	index_path: knn.index
2025-03-13 11:49:50,651 [INFO]: 	size in bytes: 2017230378
2025-03-13 11:49:50,651 [INFO]: 	avg_search_speed_ms: 9.440026791921067
2025-03-13 11:49:50,651 [INFO]: 	99p_search_speed_ms: 19.341671969741597
2025-03-13 11:49:50,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:50,651 [INFO]: 	nb vectors: 10246
2025-03-13 11:49:50,651 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:50,651 [INFO]: 	compression ratio: 0.998619488368621
2025-03-13 11:49:50,651 [INFO]: }
2025-03-13 11:49:50,651 [INFO]: 	>>> Finished "Creating the index" in 112.8483 secs
2025-03-13 11:49:50,651 [INFO]: >>> Finished "Launching the whole pipeline" in 112.8777 secs
2025-03-13 11:49:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 53291 [episode count 1/20]
[retrieval_preprocessing] for episode 69925 [episode count 2/20], we have num_retrieval=np.int64(10227) num_query=np.int64(507)
2025-03-13 11:49:57,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:59,348 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:59
2025-03-13 11:49:59,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 11:49:59,373 [INFO]: There are 10227 embeddings of dim 49152
2025-03-13 11:49:59,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:49:59,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:59
2025-03-13 11:49:59,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:59,374 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:49:59,374 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:49:59,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:59,374 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:59
2025-03-13 11:49:59,374 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:59,374 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:49:59,374 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:59
2025-03-13 11:49:59,374 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:59,374 [INFO]: 	Creating the index 03/13/2025, 11:49:59
2025-03-13 11:49:59,374 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:49:59
2025-03-13 11:49:59,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 11:49:59,375 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:59
2025-03-13 11:49:59,375 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:49:59,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.23it/s]  5%|▍         | 2/43 [00:00<00:06,  6.13it/s]  7%|▋         | 3/43 [00:00<00:05,  7.02it/s]  9%|▉         | 4/43 [00:00<00:05,  7.54it/s] 12%|█▏        | 5/43 [00:00<00:04,  7.66it/s] 14%|█▍        | 6/43 [00:00<00:04,  7.55it/s] 16%|█▋        | 7/43 [00:00<00:04,  7.58it/s] 19%|█▊        | 8/43 [00:01<00:04,  7.42it/s] 21%|██        | 9/43 [00:01<00:04,  7.19it/s] 23%|██▎       | 10/43 [00:01<00:04,  6.92it/s] 26%|██▌       | 11/43 [00:01<00:04,  7.15it/s] 28%|██▊       | 12/43 [00:01<00:04,  7.57it/s] 30%|███       | 13/43 [00:01<00:03,  7.56it/s] 33%|███▎      | 14/43 [00:01<00:03,  7.74it/s] 37%|███▋      | 16/43 [00:02<00:02,  9.04it/s] 42%|████▏     | 18/43 [00:02<00:02, 10.12it/s] 47%|████▋     | 20/43 [00:02<00:02, 11.47it/s] 51%|█████     | 22/43 [00:07<00:19,  1.06it/s] 56%|█████▌    | 24/43 [00:07<00:12,  1.53it/s] 60%|██████    | 26/43 [00:07<00:08,  2.11it/s] 65%|██████▌   | 28/43 [00:08<00:05,  2.84it/s] 70%|██████▉   | 30/43 [00:08<00:03,  3.73it/s] 74%|███████▍  | 32/43 [00:08<00:02,  4.71it/s] 79%|███████▉  | 34/43 [00:08<00:01,  5.78it/s] 84%|████████▎ | 36/43 [00:08<00:01,  6.92it/s] 88%|████████▊ | 38/43 [00:08<00:00,  7.95it/s] 93%|█████████▎| 40/43 [00:09<00:00,  8.89it/s] 98%|█████████▊| 42/43 [00:15<00:01,  1.03s/it]100%|██████████| 43/43 [00:16<00:00,  1.11s/it]100%|██████████| 43/43 [00:16<00:00,  2.56it/s]
2025-03-13 11:50:16,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:16
2025-03-13 11:51:27,191 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.9966 secs
2025-03-13 11:51:27,191 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 11:51:27,191 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s]
2025-03-13 11:51:55,691 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4996 secs
2025-03-13 11:51:55,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.3184 secs
2025-03-13 11:51:55,694 [INFO]: {
2025-03-13 11:51:55,694 [INFO]: 	index_key: HNSW32
2025-03-13 11:51:55,694 [INFO]: 	index_param: efSearch=143
2025-03-13 11:51:55,694 [INFO]: 	index_path: knn.index
2025-03-13 11:51:55,694 [INFO]: 	size in bytes: 2013489734
2025-03-13 11:51:55,694 [INFO]: 	avg_search_speed_ms: 9.536558284101966
2025-03-13 11:51:55,695 [INFO]: 	99p_search_speed_ms: 18.064768798649308
2025-03-13 11:51:55,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:55,695 [INFO]: 	nb vectors: 10227
2025-03-13 11:51:55,695 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:55,695 [INFO]: 	compression ratio: 0.9986194526085426
2025-03-13 11:51:55,695 [INFO]: }
2025-03-13 11:51:55,695 [INFO]: 	>>> Finished "Creating the index" in 116.3206 secs
2025-03-13 11:51:55,695 [INFO]: >>> Finished "Launching the whole pipeline" in 116.3470 secs
2025-03-13 11:51:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 69925 [episode count 2/20]
[retrieval_preprocessing] for episode 27029 [episode count 3/20], we have num_retrieval=np.int64(10188) num_query=np.int64(546)
2025-03-13 11:52:02,097 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:03,984 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:03
2025-03-13 11:52:03,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.36it/s]
2025-03-13 11:52:04,012 [INFO]: There are 10188 embeddings of dim 49152
2025-03-13 11:52:04,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:52:04,013 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:04
2025-03-13 11:52:04,013 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:04,013 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:52:04,013 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:52:04,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:52:04,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:04
2025-03-13 11:52:04,014 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:04,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:52:04,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:04
2025-03-13 11:52:04,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:52:04,015 [INFO]: 	Creating the index 03/13/2025, 11:52:04
2025-03-13 11:52:04,015 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:52:04
2025-03-13 11:52:04,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 11:52:04,018 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:04
2025-03-13 11:52:04,019 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:52:04,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.35it/s]  7%|▋         | 3/43 [00:00<00:03, 10.46it/s] 12%|█▏        | 5/43 [00:00<00:03, 12.04it/s] 16%|█▋        | 7/43 [00:00<00:02, 13.54it/s] 21%|██        | 9/43 [00:00<00:02, 13.28it/s] 26%|██▌       | 11/43 [00:00<00:02, 12.57it/s] 30%|███       | 13/43 [00:01<00:02, 12.95it/s] 35%|███▍      | 15/43 [00:01<00:02, 12.92it/s] 40%|███▉      | 17/43 [00:01<00:02, 12.96it/s] 44%|████▍     | 19/43 [00:01<00:01, 12.89it/s] 49%|████▉     | 21/43 [00:06<00:19,  1.13it/s] 53%|█████▎    | 23/43 [00:07<00:12,  1.56it/s] 58%|█████▊    | 25/43 [00:07<00:08,  2.11it/s] 63%|██████▎   | 27/43 [00:07<00:05,  2.79it/s] 67%|██████▋   | 29/43 [00:07<00:03,  3.58it/s] 72%|███████▏  | 31/43 [00:07<00:02,  4.42it/s] 77%|███████▋  | 33/43 [00:08<00:01,  5.28it/s] 81%|████████▏ | 35/43 [00:08<00:01,  6.03it/s] 84%|████████▎ | 36/43 [00:08<00:01,  6.45it/s] 88%|████████▊ | 38/43 [00:08<00:00,  7.31it/s] 93%|█████████▎| 40/43 [00:08<00:00,  8.14it/s] 98%|█████████▊| 42/43 [00:15<00:01,  1.10s/it]100%|██████████| 43/43 [00:16<00:00,  1.12s/it]100%|██████████| 43/43 [00:16<00:00,  2.62it/s]
2025-03-13 11:52:20,443 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:20
2025-03-13 11:53:44,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.0311 secs
2025-03-13 11:53:44,475 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 11:53:44,475 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-13 11:54:17,816 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3415 secs
2025-03-13 11:54:17,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.7986 secs
2025-03-13 11:54:17,817 [INFO]: {
2025-03-13 11:54:17,817 [INFO]: 	index_key: HNSW32
2025-03-13 11:54:17,817 [INFO]: 	index_param: efSearch=113
2025-03-13 11:54:17,817 [INFO]: 	index_path: knn.index
2025-03-13 11:54:17,817 [INFO]: 	size in bytes: 2005811186
2025-03-13 11:54:17,817 [INFO]: 	avg_search_speed_ms: 10.89825563301172
2025-03-13 11:54:17,817 [INFO]: 	99p_search_speed_ms: 18.67130965692923
2025-03-13 11:54:17,817 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:17,817 [INFO]: 	nb vectors: 10188
2025-03-13 11:54:17,817 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:17,817 [INFO]: 	compression ratio: 0.9986195699678384
2025-03-13 11:54:17,817 [INFO]: }
2025-03-13 11:54:17,817 [INFO]: 	>>> Finished "Creating the index" in 133.8021 secs
2025-03-13 11:54:17,817 [INFO]: >>> Finished "Launching the whole pipeline" in 133.8330 secs
2025-03-13 11:54:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 27029 [episode count 3/20]
[retrieval_preprocessing] for episode 78209 [episode count 4/20], we have num_retrieval=np.int64(10168) num_query=np.int64(566)
2025-03-13 11:54:27,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:28,756 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:28
2025-03-13 11:54:28,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 11:54:28,780 [INFO]: There are 10168 embeddings of dim 49152
2025-03-13 11:54:28,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:54:28,780 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:28
2025-03-13 11:54:28,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:28,780 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:54:28,780 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:54:28,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:28,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:28
2025-03-13 11:54:28,780 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:28,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:54:28,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:28
2025-03-13 11:54:28,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:28,780 [INFO]: 	Creating the index 03/13/2025, 11:54:28
2025-03-13 11:54:28,780 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:54:28
2025-03-13 11:54:28,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 11:54:28,781 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:28
2025-03-13 11:54:28,781 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:54:28,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/42 [00:00<?, ?it/s]  2%|▏         | 1/42 [00:00<00:10,  4.01it/s]  5%|▍         | 2/42 [00:00<00:07,  5.65it/s]  7%|▋         | 3/42 [00:00<00:05,  6.62it/s] 10%|▉         | 4/42 [00:00<00:05,  7.09it/s] 12%|█▏        | 5/42 [00:00<00:05,  7.39it/s] 14%|█▍        | 6/42 [00:00<00:04,  7.56it/s] 17%|█▋        | 7/42 [00:00<00:04,  7.69it/s] 19%|█▉        | 8/42 [00:01<00:04,  7.73it/s] 21%|██▏       | 9/42 [00:01<00:04,  7.83it/s] 24%|██▍       | 10/42 [00:01<00:04,  7.84it/s] 26%|██▌       | 11/42 [00:01<00:03,  7.87it/s] 29%|██▊       | 12/42 [00:01<00:03,  7.87it/s] 31%|███       | 13/42 [00:01<00:03,  8.01it/s] 33%|███▎      | 14/42 [00:01<00:03,  8.19it/s] 36%|███▌      | 15/42 [00:01<00:03,  8.18it/s] 38%|███▊      | 16/42 [00:02<00:03,  8.18it/s] 43%|████▎     | 18/42 [00:02<00:02,  8.99it/s] 45%|████▌     | 19/42 [00:02<00:02,  9.09it/s] 48%|████▊     | 20/42 [00:02<00:02,  9.22it/s] 50%|█████     | 21/42 [00:08<00:35,  1.68s/it] 57%|█████▋    | 24/42 [00:08<00:14,  1.25it/s] 64%|██████▍   | 27/42 [00:08<00:07,  2.11it/s] 71%|███████▏  | 30/42 [00:08<00:03,  3.23it/s] 79%|███████▊  | 33/42 [00:08<00:01,  4.63it/s] 86%|████████▌ | 36/42 [00:09<00:00,  6.37it/s] 93%|█████████▎| 39/42 [00:09<00:00,  8.50it/s]100%|██████████| 42/42 [00:16<00:00,  1.15it/s]100%|██████████| 42/42 [00:16<00:00,  2.52it/s]
2025-03-13 11:54:45,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:45
2025-03-13 11:55:58,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.0504 secs
2025-03-13 11:55:58,482 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 11:55:58,482 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 11:56:19,728 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2453 secs
2025-03-13 11:56:19,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.9503 secs
2025-03-13 11:56:19,732 [INFO]: {
2025-03-13 11:56:19,732 [INFO]: 	index_key: HNSW32
2025-03-13 11:56:19,732 [INFO]: 	index_param: efSearch=142
2025-03-13 11:56:19,732 [INFO]: 	index_path: knn.index
2025-03-13 11:56:19,732 [INFO]: 	size in bytes: 2001873666
2025-03-13 11:56:19,732 [INFO]: 	avg_search_speed_ms: 10.177113592817939
2025-03-13 11:56:19,732 [INFO]: 	99p_search_speed_ms: 17.52810794394463
2025-03-13 11:56:19,732 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:19,732 [INFO]: 	nb vectors: 10168
2025-03-13 11:56:19,732 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:19,732 [INFO]: 	compression ratio: 0.998619532267727
2025-03-13 11:56:19,732 [INFO]: }
2025-03-13 11:56:19,732 [INFO]: 	>>> Finished "Creating the index" in 110.9516 secs
2025-03-13 11:56:19,732 [INFO]: >>> Finished "Launching the whole pipeline" in 110.9761 secs
2025-03-13 11:56:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 78209 [episode count 4/20]
[retrieval_preprocessing] for episode 27094 [episode count 5/20], we have num_retrieval=np.int64(10110) num_query=np.int64(624)
2025-03-13 11:56:26,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:28,097 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:28
2025-03-13 11:56:28,097 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 975.19it/s]
2025-03-13 11:56:28,126 [INFO]: There are 10110 embeddings of dim 49152
2025-03-13 11:56:28,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 11:56:28,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:28
2025-03-13 11:56:28,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:28,127 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:56:28,127 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:56:28,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:56:28,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:28
2025-03-13 11:56:28,128 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:28,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:56:28,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:28
2025-03-13 11:56:28,128 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:56:28,128 [INFO]: 	Creating the index 03/13/2025, 11:56:28
2025-03-13 11:56:28,128 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:56:28
2025-03-13 11:56:28,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 11:56:28,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:28
2025-03-13 11:56:28,132 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:56:28,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.16it/s]  7%|▋         | 3/41 [00:00<00:04,  9.00it/s] 12%|█▏        | 5/41 [00:00<00:03, 10.69it/s] 17%|█▋        | 7/41 [00:00<00:02, 11.39it/s] 22%|██▏       | 9/41 [00:00<00:02, 11.74it/s] 27%|██▋       | 11/41 [00:01<00:02, 11.46it/s] 32%|███▏      | 13/41 [00:01<00:02, 11.61it/s] 37%|███▋      | 15/41 [00:01<00:02, 11.19it/s] 41%|████▏     | 17/41 [00:01<00:02, 11.04it/s] 46%|████▋     | 19/41 [00:01<00:01, 11.03it/s] 51%|█████     | 21/41 [00:07<00:18,  1.09it/s] 54%|█████▎    | 22/41 [00:07<00:14,  1.30it/s] 59%|█████▊    | 24/41 [00:07<00:09,  1.87it/s] 63%|██████▎   | 26/41 [00:07<00:05,  2.56it/s] 68%|██████▊   | 28/41 [00:07<00:03,  3.42it/s] 73%|███████▎  | 30/41 [00:08<00:02,  4.49it/s] 78%|███████▊  | 32/41 [00:08<00:01,  5.48it/s] 83%|████████▎ | 34/41 [00:08<00:01,  6.46it/s] 88%|████████▊ | 36/41 [00:08<00:00,  6.98it/s] 93%|█████████▎| 38/41 [00:08<00:00,  7.80it/s] 98%|█████████▊| 40/41 [00:09<00:00,  8.43it/s]100%|██████████| 41/41 [00:15<00:00,  2.57it/s]
2025-03-13 11:56:44,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:44
2025-03-13 11:57:53,066 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.9797 secs
2025-03-13 11:57:53,067 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 11:57:53,067 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.51it/s] 50%|█████     | 2/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.69it/s]
2025-03-13 11:58:16,478 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4116 secs
2025-03-13 11:58:16,482 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.3500 secs
2025-03-13 11:58:16,482 [INFO]: {
2025-03-13 11:58:16,482 [INFO]: 	index_key: HNSW32
2025-03-13 11:58:16,482 [INFO]: 	index_param: efSearch=117
2025-03-13 11:58:16,482 [INFO]: 	index_path: knn.index
2025-03-13 11:58:16,482 [INFO]: 	size in bytes: 1990454730
2025-03-13 11:58:16,482 [INFO]: 	avg_search_speed_ms: 8.68479344511581
2025-03-13 11:58:16,482 [INFO]: 	99p_search_speed_ms: 16.86585054267198
2025-03-13 11:58:16,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:16,482 [INFO]: 	nb vectors: 10110
2025-03-13 11:58:16,482 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:16,482 [INFO]: 	compression ratio: 0.9986194863120549
2025-03-13 11:58:16,482 [INFO]: }
2025-03-13 11:58:16,482 [INFO]: 	>>> Finished "Creating the index" in 108.3535 secs
2025-03-13 11:58:16,482 [INFO]: >>> Finished "Launching the whole pipeline" in 108.3852 secs
2025-03-13 11:58:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 27094 [episode count 5/20]
[retrieval_preprocessing] for episode 83114 [episode count 6/20], we have num_retrieval=np.int64(10240) num_query=np.int64(494)
2025-03-13 11:58:23,662 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:26,058 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:26
2025-03-13 11:58:26,058 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.30it/s]
2025-03-13 11:58:26,085 [INFO]: There are 10240 embeddings of dim 49152
2025-03-13 11:58:26,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:58:26,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:26,086 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 11:58:26,087 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:58:26,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:58:26,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,087 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:26,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 11:58:26,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:26
2025-03-13 11:58:26,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:58:26,088 [INFO]: 	Creating the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,088 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 11:58:26
2025-03-13 11:58:26,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 11:58:26,092 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,092 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 11:58:26,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  4.75it/s]  7%|▋         | 3/43 [00:00<00:04,  8.45it/s] 12%|█▏        | 5/43 [00:00<00:03, 10.28it/s] 16%|█▋        | 7/43 [00:00<00:03, 11.41it/s] 21%|██        | 9/43 [00:00<00:02, 11.72it/s] 26%|██▌       | 11/43 [00:01<00:02, 12.08it/s] 30%|███       | 13/43 [00:01<00:02, 11.89it/s] 35%|███▍      | 15/43 [00:01<00:02, 11.64it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.41it/s] 44%|████▍     | 19/43 [00:01<00:02, 11.25it/s] 49%|████▉     | 21/43 [00:07<00:19,  1.14it/s] 58%|█████▊    | 25/43 [00:07<00:08,  2.08it/s] 63%|██████▎   | 27/43 [00:07<00:06,  2.65it/s] 67%|██████▋   | 29/43 [00:07<00:04,  3.35it/s] 72%|███████▏  | 31/43 [00:07<00:02,  4.18it/s] 77%|███████▋  | 33/43 [00:07<00:01,  5.15it/s] 81%|████████▏ | 35/43 [00:07<00:01,  6.20it/s] 86%|████████▌ | 37/43 [00:08<00:00,  7.28it/s] 91%|█████████ | 39/43 [00:08<00:00,  8.29it/s] 95%|█████████▌| 41/43 [00:08<00:00,  9.26it/s]100%|██████████| 43/43 [00:18<00:00,  1.62s/it]100%|██████████| 43/43 [00:18<00:00,  2.29it/s]
2025-03-13 11:58:44,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:44
2025-03-13 11:59:53,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.2640 secs
2025-03-13 11:59:53,152 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 11:59:53,152 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.89it/s] 50%|█████     | 2/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.89it/s]
2025-03-13 12:00:33,615 [INFO]: 	>>> Finished "Compute fast metrics" in 40.4626 secs
2025-03-13 12:00:33,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.5235 secs
2025-03-13 12:00:33,615 [INFO]: {
2025-03-13 12:00:33,615 [INFO]: 	index_key: HNSW32
2025-03-13 12:00:33,615 [INFO]: 	index_param: efSearch=141
2025-03-13 12:00:33,615 [INFO]: 	index_path: knn.index
2025-03-13 12:00:33,615 [INFO]: 	size in bytes: 2016049122
2025-03-13 12:00:33,615 [INFO]: 	avg_search_speed_ms: 10.333459206648971
2025-03-13 12:00:33,615 [INFO]: 	99p_search_speed_ms: 20.34636693308131
2025-03-13 12:00:33,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:33,615 [INFO]: 	nb vectors: 10240
2025-03-13 12:00:33,615 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:33,615 [INFO]: 	compression ratio: 0.9986194770903007
2025-03-13 12:00:33,615 [INFO]: }
2025-03-13 12:00:33,615 [INFO]: 	>>> Finished "Creating the index" in 127.5271 secs
2025-03-13 12:00:33,615 [INFO]: >>> Finished "Launching the whole pipeline" in 127.5573 secs
2025-03-13 12:00:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 83114 [episode count 6/20]
[retrieval_preprocessing] for episode 76339 [episode count 7/20], we have num_retrieval=np.int64(10263) num_query=np.int64(471)
2025-03-13 12:00:40,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:42,592 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:42
2025-03-13 12:00:42,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1930.19it/s]
2025-03-13 12:00:42,620 [INFO]: There are 10263 embeddings of dim 49152
2025-03-13 12:00:42,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 12:00:42,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:42
2025-03-13 12:00:42,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:42,622 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:00:42,622 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:00:42,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:00:42,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:42
2025-03-13 12:00:42,622 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:42,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:00:42,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:42
2025-03-13 12:00:42,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:00:42,623 [INFO]: 	Creating the index 03/13/2025, 12:00:42
2025-03-13 12:00:42,624 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:00:42
2025-03-13 12:00:42,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0025 secs
2025-03-13 12:00:42,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:42
2025-03-13 12:00:42,627 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:00:42,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:10,  3.82it/s]  7%|▋         | 3/43 [00:00<00:05,  7.09it/s] 12%|█▏        | 5/43 [00:00<00:04,  8.78it/s] 16%|█▋        | 7/43 [00:00<00:03,  9.83it/s] 21%|██        | 9/43 [00:00<00:03, 10.45it/s] 26%|██▌       | 11/43 [00:01<00:02, 10.82it/s] 30%|███       | 13/43 [00:01<00:02, 11.01it/s] 35%|███▍      | 15/43 [00:01<00:02, 11.18it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.29it/s] 44%|████▍     | 19/43 [00:01<00:02, 11.18it/s] 49%|████▉     | 21/43 [00:07<00:20,  1.09it/s] 51%|█████     | 22/43 [00:07<00:16,  1.29it/s] 56%|█████▌    | 24/43 [00:07<00:10,  1.83it/s] 58%|█████▊    | 25/43 [00:07<00:08,  2.17it/s] 60%|██████    | 26/43 [00:07<00:06,  2.60it/s] 63%|██████▎   | 27/43 [00:08<00:05,  3.14it/s] 65%|██████▌   | 28/43 [00:08<00:03,  3.77it/s] 67%|██████▋   | 29/43 [00:08<00:03,  4.46it/s] 70%|██████▉   | 30/43 [00:08<00:02,  5.12it/s] 72%|███████▏  | 31/43 [00:08<00:02,  5.83it/s] 74%|███████▍  | 32/43 [00:08<00:01,  6.48it/s] 77%|███████▋  | 33/43 [00:08<00:01,  7.04it/s] 79%|███████▉  | 34/43 [00:08<00:01,  7.57it/s] 81%|████████▏ | 35/43 [00:08<00:00,  8.02it/s] 86%|████████▌ | 37/43 [00:09<00:00,  9.41it/s] 91%|█████████ | 39/43 [00:09<00:00, 10.67it/s] 95%|█████████▌| 41/43 [00:09<00:00, 10.70it/s]100%|██████████| 43/43 [00:17<00:00,  1.43s/it]100%|██████████| 43/43 [00:17<00:00,  2.45it/s]
2025-03-13 12:01:00,150 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:00
2025-03-13 12:02:20,085 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.9348 secs
2025-03-13 12:02:20,086 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 12:02:20,086 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
2025-03-13 12:02:40,529 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4426 secs
2025-03-13 12:02:40,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.9033 secs
2025-03-13 12:02:40,530 [INFO]: {
2025-03-13 12:02:40,530 [INFO]: 	index_key: HNSW32
2025-03-13 12:02:40,530 [INFO]: 	index_param: efSearch=91
2025-03-13 12:02:40,530 [INFO]: 	index_path: knn.index
2025-03-13 12:02:40,530 [INFO]: 	size in bytes: 2020577270
2025-03-13 12:02:40,530 [INFO]: 	avg_search_speed_ms: 11.725062918210575
2025-03-13 12:02:40,530 [INFO]: 	99p_search_speed_ms: 23.28191649168731
2025-03-13 12:02:40,530 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:40,530 [INFO]: 	nb vectors: 10263
2025-03-13 12:02:40,530 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:40,530 [INFO]: 	compression ratio: 0.9986195202522495
2025-03-13 12:02:40,530 [INFO]: }
2025-03-13 12:02:40,530 [INFO]: 	>>> Finished "Creating the index" in 117.9069 secs
2025-03-13 12:02:40,530 [INFO]: >>> Finished "Launching the whole pipeline" in 117.9382 secs
2025-03-13 12:02:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 76339 [episode count 7/20]
[retrieval_preprocessing] for episode 28934 [episode count 8/20], we have num_retrieval=np.int64(10284) num_query=np.int64(450)
2025-03-13 12:02:47,693 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:49,272 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:49
2025-03-13 12:02:49,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.46it/s]
2025-03-13 12:02:49,299 [INFO]: There are 10284 embeddings of dim 49152
2025-03-13 12:02:49,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 12:02:49,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:49
2025-03-13 12:02:49,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:49,300 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:02:49,300 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:02:49,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:02:49,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:49
2025-03-13 12:02:49,301 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:49,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:02:49,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:49
2025-03-13 12:02:49,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:49,301 [INFO]: 	Creating the index 03/13/2025, 12:02:49
2025-03-13 12:02:49,301 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:02:49
2025-03-13 12:02:49,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0015 secs
2025-03-13 12:02:49,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:49
2025-03-13 12:02:49,303 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:02:49,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:10,  4.16it/s]  5%|▍         | 2/43 [00:00<00:06,  6.32it/s]  9%|▉         | 4/43 [00:00<00:04,  9.17it/s] 14%|█▍        | 6/43 [00:00<00:03, 11.26it/s] 19%|█▊        | 8/43 [00:00<00:02, 12.43it/s] 23%|██▎       | 10/43 [00:00<00:02, 13.15it/s] 28%|██▊       | 12/43 [00:01<00:02, 13.85it/s] 33%|███▎      | 14/43 [00:01<00:02, 14.40it/s] 37%|███▋      | 16/43 [00:01<00:01, 14.79it/s] 42%|████▏     | 18/43 [00:01<00:01, 15.37it/s] 47%|████▋     | 20/43 [00:01<00:01, 15.55it/s] 51%|█████     | 22/43 [00:07<00:20,  1.03it/s] 58%|█████▊    | 25/43 [00:07<00:10,  1.66it/s] 65%|██████▌   | 28/43 [00:07<00:05,  2.51it/s] 72%|███████▏  | 31/43 [00:07<00:03,  3.62it/s] 79%|███████▉  | 34/43 [00:08<00:01,  5.03it/s] 86%|████████▌ | 37/43 [00:08<00:00,  6.75it/s] 93%|█████████▎| 40/43 [00:08<00:00,  8.87it/s]100%|██████████| 43/43 [00:16<00:00,  1.13it/s]100%|██████████| 43/43 [00:16<00:00,  2.67it/s]
2025-03-13 12:03:05,418 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:05
2025-03-13 12:04:21,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.1899 secs
2025-03-13 12:04:21,609 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 12:04:21,609 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.02s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.43it/s]
2025-03-13 12:04:49,714 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1053 secs
2025-03-13 12:04:50,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.7149 secs
2025-03-13 12:04:50,018 [INFO]: {
2025-03-13 12:04:50,018 [INFO]: 	index_key: HNSW32
2025-03-13 12:04:50,018 [INFO]: 	index_param: efSearch=110
2025-03-13 12:04:50,018 [INFO]: 	index_path: knn.index
2025-03-13 12:04:50,018 [INFO]: 	size in bytes: 2024711666
2025-03-13 12:04:50,019 [INFO]: 	avg_search_speed_ms: 8.281652141626099
2025-03-13 12:04:50,019 [INFO]: 	99p_search_speed_ms: 13.063294754829258
2025-03-13 12:04:50,019 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:50,019 [INFO]: 	nb vectors: 10284
2025-03-13 12:04:50,019 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:50,019 [INFO]: 	compression ratio: 0.9986195594923786
2025-03-13 12:04:50,019 [INFO]: }
2025-03-13 12:04:50,019 [INFO]: 	>>> Finished "Creating the index" in 120.7180 secs
2025-03-13 12:04:50,019 [INFO]: >>> Finished "Launching the whole pipeline" in 120.7466 secs
2025-03-13 12:04:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 28934 [episode count 8/20]
[retrieval_preprocessing] for episode 39439 [episode count 9/20], we have num_retrieval=np.int64(10130) num_query=np.int64(604)
2025-03-13 12:04:54,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:56,186 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:56
2025-03-13 12:04:56,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-13 12:04:56,214 [INFO]: There are 10130 embeddings of dim 49152
2025-03-13 12:04:56,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 12:04:56,214 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:56,214 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:04:56,214 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:04:56,214 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:56,214 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,215 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:56,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:04:56,215 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:56
2025-03-13 12:04:56,215 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:56,215 [INFO]: 	Creating the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,215 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:04:56
2025-03-13 12:04:56,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:04:56,216 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,216 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:04:56,216 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.40it/s] 15%|█▍        | 6/41 [00:00<00:01, 26.94it/s] 27%|██▋       | 11/41 [00:00<00:00, 34.15it/s] 39%|███▉      | 16/41 [00:00<00:00, 37.43it/s] 49%|████▉     | 20/41 [00:00<00:00, 38.09it/s] 59%|█████▊    | 24/41 [00:07<00:09,  1.83it/s] 71%|███████   | 29/41 [00:07<00:04,  2.83it/s] 83%|████████▎ | 34/41 [00:07<00:01,  4.18it/s] 95%|█████████▌| 39/41 [00:07<00:00,  5.98it/s]100%|██████████| 41/41 [00:13<00:00,  2.99it/s]
2025-03-13 12:05:09,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:09
2025-03-13 12:06:21,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.7850 secs
2025-03-13 12:06:21,741 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 12:06:21,741 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-13 12:06:53,198 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4570 secs
2025-03-13 12:06:53,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.9852 secs
2025-03-13 12:06:53,202 [INFO]: {
2025-03-13 12:06:53,202 [INFO]: 	index_key: HNSW32
2025-03-13 12:06:53,202 [INFO]: 	index_param: efSearch=127
2025-03-13 12:06:53,202 [INFO]: 	index_path: knn.index
2025-03-13 12:06:53,202 [INFO]: 	size in bytes: 1994392378
2025-03-13 12:06:53,202 [INFO]: 	avg_search_speed_ms: 12.786882957193496
2025-03-13 12:06:53,202 [INFO]: 	99p_search_speed_ms: 24.929206341039368
2025-03-13 12:06:53,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:53,202 [INFO]: 	nb vectors: 10130
2025-03-13 12:06:53,202 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:53,202 [INFO]: 	compression ratio: 0.9986194602273997
2025-03-13 12:06:53,202 [INFO]: }
2025-03-13 12:06:53,202 [INFO]: 	>>> Finished "Creating the index" in 116.9870 secs
2025-03-13 12:06:53,202 [INFO]: >>> Finished "Launching the whole pipeline" in 117.0159 secs
2025-03-13 12:06:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 39439 [episode count 9/20]
[retrieval_preprocessing] for episode 12618 [episode count 10/20], we have num_retrieval=np.int64(10221) num_query=np.int64(513)
2025-03-13 12:06:57,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:59,981 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:59
2025-03-13 12:06:59,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2111.94it/s]
2025-03-13 12:07:00,013 [INFO]: There are 10221 embeddings of dim 49152
2025-03-13 12:07:00,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 12:07:00,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:00,014 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:07:00,015 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:07:00,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:07:00,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,015 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:00,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:07:00,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:00
2025-03-13 12:07:00,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:07:00,016 [INFO]: 	Creating the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,016 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:07:00
2025-03-13 12:07:00,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0023 secs
2025-03-13 12:07:00,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:00
2025-03-13 12:07:00,019 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:07:00,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:06,  6.33it/s] 14%|█▍        | 6/43 [00:00<00:01, 24.46it/s] 26%|██▌       | 11/43 [00:00<00:01, 31.71it/s] 35%|███▍      | 15/43 [00:00<00:00, 34.23it/s] 44%|████▍     | 19/43 [00:00<00:00, 35.28it/s] 53%|█████▎    | 23/43 [00:07<00:12,  1.61it/s] 67%|██████▋   | 29/43 [00:07<00:05,  2.72it/s] 79%|███████▉  | 34/43 [00:07<00:02,  3.97it/s] 93%|█████████▎| 40/43 [00:08<00:00,  5.99it/s]100%|██████████| 43/43 [00:15<00:00,  2.74it/s]
2025-03-13 12:07:15,704 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:15
2025-03-13 12:08:27,184 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.4794 secs
2025-03-13 12:08:27,184 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 12:08:27,184 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 12:08:50,304 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1196 secs
2025-03-13 12:08:50,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.6119 secs
2025-03-13 12:08:50,631 [INFO]: {
2025-03-13 12:08:50,631 [INFO]: 	index_key: HNSW32
2025-03-13 12:08:50,631 [INFO]: 	index_param: efSearch=124
2025-03-13 12:08:50,631 [INFO]: 	index_path: knn.index
2025-03-13 12:08:50,631 [INFO]: 	size in bytes: 2012308478
2025-03-13 12:08:50,631 [INFO]: 	avg_search_speed_ms: 9.923204065195197
2025-03-13 12:08:50,631 [INFO]: 	99p_search_speed_ms: 16.35373668046668
2025-03-13 12:08:50,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:50,631 [INFO]: 	nb vectors: 10221
2025-03-13 12:08:50,632 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:50,632 [INFO]: 	compression ratio: 0.9986194412882655
2025-03-13 12:08:50,632 [INFO]: }
2025-03-13 12:08:50,632 [INFO]: 	>>> Finished "Creating the index" in 110.6158 secs
2025-03-13 12:08:50,632 [INFO]: >>> Finished "Launching the whole pipeline" in 110.6508 secs
2025-03-13 12:08:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 12618 [episode count 10/20]
[retrieval_preprocessing] for episode 82884 [episode count 11/20], we have num_retrieval=np.int64(9976) num_query=np.int64(758)
2025-03-13 12:08:54,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:56,802 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:56
2025-03-13 12:08:56,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.25it/s]
2025-03-13 12:08:56,830 [INFO]: There are 9976 embeddings of dim 49152
2025-03-13 12:08:56,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 12:08:56,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:56
2025-03-13 12:08:56,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:56,831 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 12:08:56,831 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:08:56,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:56,831 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:56
2025-03-13 12:08:56,831 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:56,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:08:56,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:56
2025-03-13 12:08:56,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:56,831 [INFO]: 	Creating the index 03/13/2025, 12:08:56
2025-03-13 12:08:56,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:56
2025-03-13 12:08:56,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:08:56,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:56
2025-03-13 12:08:56,832 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:08:56,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.36it/s] 15%|█▍        | 6/41 [00:00<00:01, 25.09it/s] 27%|██▋       | 11/41 [00:00<00:00, 33.49it/s] 39%|███▉      | 16/41 [00:00<00:00, 37.98it/s] 49%|████▉     | 20/41 [00:00<00:00, 34.45it/s] 59%|█████▊    | 24/41 [00:04<00:06,  2.73it/s] 73%|███████▎  | 30/41 [00:05<00:02,  4.46it/s] 85%|████████▌ | 35/41 [00:05<00:00,  6.35it/s] 98%|█████████▊| 40/41 [00:05<00:00,  8.80it/s]100%|██████████| 41/41 [00:09<00:00,  4.22it/s]
2025-03-13 12:09:06,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:06
2025-03-13 12:10:10,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3075 secs
2025-03-13 12:10:10,855 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 12:10:10,855 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 12:10:42,875 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0194 secs
2025-03-13 12:10:42,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.0459 secs
2025-03-13 12:10:42,878 [INFO]: {
2025-03-13 12:10:42,878 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:42,878 [INFO]: 	index_param: efSearch=183
2025-03-13 12:10:42,878 [INFO]: 	index_path: knn.index
2025-03-13 12:10:42,878 [INFO]: 	size in bytes: 1962719170
2025-03-13 12:10:42,878 [INFO]: 	avg_search_speed_ms: 10.234893055369614
2025-03-13 12:10:42,878 [INFO]: 	99p_search_speed_ms: 14.300008360296488
2025-03-13 12:10:42,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:42,878 [INFO]: 	nb vectors: 9976
2025-03-13 12:10:42,878 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:42,878 [INFO]: 	compression ratio: 0.9993082240084301
2025-03-13 12:10:42,878 [INFO]: }
2025-03-13 12:10:42,878 [INFO]: 	>>> Finished "Creating the index" in 106.0473 secs
2025-03-13 12:10:42,878 [INFO]: >>> Finished "Launching the whole pipeline" in 106.0767 secs
2025-03-13 12:10:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 82884 [episode count 11/20]
[retrieval_preprocessing] for episode 11213 [episode count 12/20], we have num_retrieval=np.int64(10278) num_query=np.int64(456)
2025-03-13 12:10:49,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:50,870 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:50
2025-03-13 12:10:50,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.21it/s]
2025-03-13 12:10:50,900 [INFO]: There are 10278 embeddings of dim 49152
2025-03-13 12:10:50,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 12:10:50,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:50
2025-03-13 12:10:50,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:50,900 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:10:50,901 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:10:50,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:50,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:50
2025-03-13 12:10:50,901 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:50,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:10:50,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:50
2025-03-13 12:10:50,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:50,901 [INFO]: 	Creating the index 03/13/2025, 12:10:50
2025-03-13 12:10:50,901 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:10:50
2025-03-13 12:10:50,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:10:50,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:50
2025-03-13 12:10:50,902 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:10:50,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.86it/s] 12%|█▏        | 5/43 [00:00<00:01, 23.09it/s] 23%|██▎       | 10/43 [00:00<00:00, 33.12it/s] 35%|███▍      | 15/43 [00:00<00:00, 37.90it/s] 47%|████▋     | 20/43 [00:00<00:00, 40.66it/s] 58%|█████▊    | 25/43 [00:06<00:07,  2.42it/s] 72%|███████▏  | 31/43 [00:06<00:03,  3.82it/s] 86%|████████▌ | 37/43 [00:06<00:01,  5.70it/s] 98%|█████████▊| 42/43 [00:12<00:00,  2.00it/s]100%|██████████| 43/43 [00:13<00:00,  3.16it/s]
2025-03-13 12:11:04,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:04
2025-03-13 12:12:21,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1506 secs
2025-03-13 12:12:21,652 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 12:12:21,652 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.86it/s]
2025-03-13 12:12:49,583 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9303 secs
2025-03-13 12:12:49,583 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.6807 secs
2025-03-13 12:12:49,583 [INFO]: {
2025-03-13 12:12:49,583 [INFO]: 	index_key: HNSW32
2025-03-13 12:12:49,583 [INFO]: 	index_param: efSearch=113
2025-03-13 12:12:49,583 [INFO]: 	index_path: knn.index
2025-03-13 12:12:49,583 [INFO]: 	size in bytes: 2023530410
2025-03-13 12:12:49,583 [INFO]: 	avg_search_speed_ms: 8.592533284703853
2025-03-13 12:12:49,583 [INFO]: 	99p_search_speed_ms: 14.502813094295522
2025-03-13 12:12:49,583 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:49,583 [INFO]: 	nb vectors: 10278
2025-03-13 12:12:49,583 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:49,583 [INFO]: 	compression ratio: 0.9986195482972752
2025-03-13 12:12:49,583 [INFO]: }
2025-03-13 12:12:49,583 [INFO]: 	>>> Finished "Creating the index" in 118.6823 secs
2025-03-13 12:12:49,583 [INFO]: >>> Finished "Launching the whole pipeline" in 118.7132 secs
2025-03-13 12:12:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 11213 [episode count 12/20]
[retrieval_preprocessing] for episode 90721 [episode count 13/20], we have num_retrieval=np.int64(10190) num_query=np.int64(544)
2025-03-13 12:12:53,655 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:55,145 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:55
2025-03-13 12:12:55,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-13 12:12:55,174 [INFO]: There are 10190 embeddings of dim 49152
2025-03-13 12:12:55,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 12:12:55,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:55
2025-03-13 12:12:55,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:55,174 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:12:55,174 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:12:55,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:12:55,174 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:55
2025-03-13 12:12:55,175 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:55,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:12:55,175 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:55
2025-03-13 12:12:55,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:55,175 [INFO]: 	Creating the index 03/13/2025, 12:12:55
2025-03-13 12:12:55,175 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:12:55
2025-03-13 12:12:55,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:12:55,176 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:55
2025-03-13 12:12:55,176 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:12:55,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:04,  9.56it/s]  9%|▉         | 4/43 [00:00<00:01, 19.92it/s] 23%|██▎       | 10/43 [00:00<00:00, 34.62it/s] 35%|███▍      | 15/43 [00:00<00:00, 40.02it/s] 47%|████▋     | 20/43 [00:00<00:00, 43.43it/s] 58%|█████▊    | 25/43 [00:05<00:07,  2.54it/s] 70%|██████▉   | 30/43 [00:05<00:03,  3.74it/s] 81%|████████▏ | 35/43 [00:06<00:01,  5.34it/s] 93%|█████████▎| 40/43 [00:06<00:00,  7.42it/s]100%|██████████| 43/43 [00:14<00:00,  2.99it/s]
2025-03-13 12:13:09,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:09
2025-03-13 12:14:24,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.5240 secs
2025-03-13 12:14:24,092 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 12:14:24,092 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 12:14:59,003 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9115 secs
2025-03-13 12:14:59,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.8276 secs
2025-03-13 12:14:59,004 [INFO]: {
2025-03-13 12:14:59,004 [INFO]: 	index_key: HNSW32
2025-03-13 12:14:59,004 [INFO]: 	index_param: efSearch=106
2025-03-13 12:14:59,004 [INFO]: 	index_path: knn.index
2025-03-13 12:14:59,004 [INFO]: 	size in bytes: 2006205194
2025-03-13 12:14:59,004 [INFO]: 	avg_search_speed_ms: 7.208412879589131
2025-03-13 12:14:59,004 [INFO]: 	99p_search_speed_ms: 11.463514016941192
2025-03-13 12:14:59,004 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:59,004 [INFO]: 	nb vectors: 10190
2025-03-13 12:14:59,004 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:59,004 [INFO]: 	compression ratio: 0.9986194463017625
2025-03-13 12:14:59,004 [INFO]: }
2025-03-13 12:14:59,004 [INFO]: 	>>> Finished "Creating the index" in 123.8290 secs
2025-03-13 12:14:59,004 [INFO]: >>> Finished "Launching the whole pipeline" in 123.8589 secs
2025-03-13 12:15:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 90721 [episode count 13/20]
[retrieval_preprocessing] for episode 87509 [episode count 14/20], we have num_retrieval=np.int64(10291) num_query=np.int64(443)
2025-03-13 12:15:03,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:05,045 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:05
2025-03-13 12:15:05,045 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.31it/s]
2025-03-13 12:15:05,072 [INFO]: There are 10291 embeddings of dim 49152
2025-03-13 12:15:05,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:15:05,072 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:05
2025-03-13 12:15:05,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:05,072 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 12:15:05,072 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:15:05,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:05,072 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:05
2025-03-13 12:15:05,072 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:05,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:15:05,072 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:05
2025-03-13 12:15:05,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:05,072 [INFO]: 	Creating the index 03/13/2025, 12:15:05
2025-03-13 12:15:05,072 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:15:05
2025-03-13 12:15:05,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:15:05,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:05
2025-03-13 12:15:05,073 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:15:05,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.76it/s] 14%|█▍        | 6/43 [00:00<00:01, 28.59it/s] 26%|██▌       | 11/43 [00:00<00:00, 36.44it/s] 40%|███▉      | 17/43 [00:00<00:00, 43.39it/s] 51%|█████     | 22/43 [00:05<00:08,  2.57it/s] 65%|██████▌   | 28/43 [00:05<00:03,  4.07it/s] 79%|███████▉  | 34/43 [00:05<00:01,  6.08it/s] 93%|█████████▎| 40/43 [00:05<00:00,  8.66it/s]100%|██████████| 43/43 [00:14<00:00,  3.02it/s]
2025-03-13 12:15:19,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:19
2025-03-13 12:16:30,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.7289 secs
2025-03-13 12:16:30,060 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 12:16:30,060 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 12:17:07,006 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9452 secs
2025-03-13 12:17:07,006 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.9327 secs
2025-03-13 12:17:07,006 [INFO]: {
2025-03-13 12:17:07,006 [INFO]: 	index_key: HNSW32
2025-03-13 12:17:07,006 [INFO]: 	index_param: efSearch=126
2025-03-13 12:17:07,006 [INFO]: 	index_path: knn.index
2025-03-13 12:17:07,006 [INFO]: 	size in bytes: 2026089926
2025-03-13 12:17:07,006 [INFO]: 	avg_search_speed_ms: 11.204024366168817
2025-03-13 12:17:07,006 [INFO]: 	99p_search_speed_ms: 26.00036549381915
2025-03-13 12:17:07,006 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:07,006 [INFO]: 	nb vectors: 10291
2025-03-13 12:17:07,006 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:07,006 [INFO]: 	compression ratio: 0.9986195094481705
2025-03-13 12:17:07,006 [INFO]: }
2025-03-13 12:17:07,006 [INFO]: 	>>> Finished "Creating the index" in 121.9342 secs
2025-03-13 12:17:07,006 [INFO]: >>> Finished "Launching the whole pipeline" in 121.9612 secs
2025-03-13 12:17:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 87509 [episode count 14/20]
[retrieval_preprocessing] for episode 13360 [episode count 15/20], we have num_retrieval=np.int64(10235) num_query=np.int64(499)
2025-03-13 12:17:11,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:12,879 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:12
2025-03-13 12:17:12,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.55it/s]
2025-03-13 12:17:12,906 [INFO]: There are 10235 embeddings of dim 49152
2025-03-13 12:17:12,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:17:12,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:12,906 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:17:12,906 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:17:12,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:12,906 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,907 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:12,907 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:17:12,907 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:12
2025-03-13 12:17:12,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:12,907 [INFO]: 	Creating the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,907 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:17:12
2025-03-13 12:17:12,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:17:12,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,908 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:17:12,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:04,  9.56it/s] 14%|█▍        | 6/43 [00:00<00:01, 29.68it/s] 26%|██▌       | 11/43 [00:00<00:00, 37.32it/s] 37%|███▋      | 16/43 [00:00<00:00, 41.93it/s] 49%|████▉     | 21/43 [00:06<00:10,  2.10it/s] 58%|█████▊    | 25/43 [00:06<00:06,  2.96it/s] 67%|██████▋   | 29/43 [00:06<00:03,  4.12it/s] 79%|███████▉  | 34/43 [00:06<00:01,  6.06it/s] 91%|█████████ | 39/43 [00:06<00:00,  8.53it/s]100%|██████████| 43/43 [00:14<00:00,  1.63it/s]100%|██████████| 43/43 [00:14<00:00,  2.97it/s]
2025-03-13 12:17:27,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:27
2025-03-13 12:18:40,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.4436 secs
2025-03-13 12:18:40,817 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 12:18:40,817 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.59it/s]
2025-03-13 12:19:06,062 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2448 secs
2025-03-13 12:19:06,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.1538 secs
2025-03-13 12:19:06,062 [INFO]: {
2025-03-13 12:19:06,062 [INFO]: 	index_key: HNSW32
2025-03-13 12:19:06,062 [INFO]: 	index_param: efSearch=118
2025-03-13 12:19:06,062 [INFO]: 	index_path: knn.index
2025-03-13 12:19:06,062 [INFO]: 	size in bytes: 2015064742
2025-03-13 12:19:06,062 [INFO]: 	avg_search_speed_ms: 9.015326028751886
2025-03-13 12:19:06,062 [INFO]: 	99p_search_speed_ms: 14.212013548240071
2025-03-13 12:19:06,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:06,062 [INFO]: 	nb vectors: 10235
2025-03-13 12:19:06,062 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:06,062 [INFO]: 	compression ratio: 0.9986194676815997
2025-03-13 12:19:06,062 [INFO]: }
2025-03-13 12:19:06,062 [INFO]: 	>>> Finished "Creating the index" in 113.1553 secs
2025-03-13 12:19:06,062 [INFO]: >>> Finished "Launching the whole pipeline" in 113.1833 secs
2025-03-13 12:19:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 13360 [episode count 15/20]
[retrieval_preprocessing] for episode 80954 [episode count 16/20], we have num_retrieval=np.int64(10085) num_query=np.int64(649)
2025-03-13 12:19:09,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:11,564 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:11
2025-03-13 12:19:11,564 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-13 12:19:11,592 [INFO]: There are 10085 embeddings of dim 49152
2025-03-13 12:19:11,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 12:19:11,592 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:11
2025-03-13 12:19:11,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:11,593 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 12:19:11,593 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:19:11,593 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:19:11,593 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:11
2025-03-13 12:19:11,593 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:11,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:19:11,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:11
2025-03-13 12:19:11,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:19:11,594 [INFO]: 	Creating the index 03/13/2025, 12:19:11
2025-03-13 12:19:11,595 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:19:11
2025-03-13 12:19:11,597 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 12:19:11,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:11
2025-03-13 12:19:11,598 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:19:11,598 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.89it/s] 15%|█▍        | 6/41 [00:00<00:01, 31.23it/s] 27%|██▋       | 11/41 [00:00<00:00, 39.03it/s] 39%|███▉      | 16/41 [00:00<00:00, 42.94it/s] 51%|█████     | 21/41 [00:05<00:07,  2.50it/s] 63%|██████▎   | 26/41 [00:05<00:03,  3.78it/s] 78%|███████▊  | 32/41 [00:05<00:01,  5.85it/s] 93%|█████████▎| 38/41 [00:05<00:00,  8.53it/s]100%|██████████| 41/41 [00:12<00:00,  3.41it/s]
2025-03-13 12:19:23,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:23
2025-03-13 12:20:32,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.0049 secs
2025-03-13 12:20:32,619 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 12:20:32,620 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.08it/s]
2025-03-13 12:20:51,401 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7810 secs
2025-03-13 12:20:51,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.8059 secs
2025-03-13 12:20:51,404 [INFO]: {
2025-03-13 12:20:51,404 [INFO]: 	index_key: HNSW32
2025-03-13 12:20:51,404 [INFO]: 	index_param: efSearch=154
2025-03-13 12:20:51,404 [INFO]: 	index_path: knn.index
2025-03-13 12:20:51,404 [INFO]: 	size in bytes: 1985532830
2025-03-13 12:20:51,404 [INFO]: 	avg_search_speed_ms: 11.377033744689683
2025-03-13 12:20:51,404 [INFO]: 	99p_search_speed_ms: 21.902475804090503
2025-03-13 12:20:51,404 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:51,404 [INFO]: 	nb vectors: 10085
2025-03-13 12:20:51,404 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:51,404 [INFO]: 	compression ratio: 0.9986194385917054
2025-03-13 12:20:51,404 [INFO]: }
2025-03-13 12:20:51,404 [INFO]: 	>>> Finished "Creating the index" in 99.8096 secs
2025-03-13 12:20:51,404 [INFO]: >>> Finished "Launching the whole pipeline" in 99.8396 secs
2025-03-13 12:20:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 80954 [episode count 16/20]
[retrieval_preprocessing] for episode 65112 [episode count 17/20], we have num_retrieval=np.int64(10227) num_query=np.int64(507)
2025-03-13 12:20:55,835 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:57,110 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:57
2025-03-13 12:20:57,110 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-13 12:20:57,140 [INFO]: There are 10227 embeddings of dim 49152
2025-03-13 12:20:57,140 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 12:20:57,140 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:57
2025-03-13 12:20:57,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:57,141 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:20:57,141 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:20:57,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:20:57,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:57
2025-03-13 12:20:57,141 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:57,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:20:57,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:57
2025-03-13 12:20:57,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:20:57,142 [INFO]: 	Creating the index 03/13/2025, 12:20:57
2025-03-13 12:20:57,142 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:20:57
2025-03-13 12:20:57,145 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 12:20:57,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:57
2025-03-13 12:20:57,146 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:20:57,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:04,  8.79it/s] 14%|█▍        | 6/43 [00:00<00:01, 30.21it/s] 26%|██▌       | 11/43 [00:00<00:00, 38.25it/s] 37%|███▋      | 16/43 [00:00<00:00, 42.18it/s] 49%|████▉     | 21/43 [00:05<00:09,  2.41it/s] 60%|██████    | 26/43 [00:05<00:04,  3.64it/s] 74%|███████▍  | 32/43 [00:05<00:01,  5.62it/s] 88%|████████▊ | 38/43 [00:05<00:00,  8.19it/s]100%|██████████| 43/43 [00:14<00:00,  1.76it/s]100%|██████████| 43/43 [00:14<00:00,  3.05it/s]
2025-03-13 12:21:11,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:11
2025-03-13 12:22:25,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.2680 secs
2025-03-13 12:22:25,521 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 12:22:25,521 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 12:23:03,381 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8595 secs
2025-03-13 12:23:03,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.2353 secs
2025-03-13 12:23:03,381 [INFO]: {
2025-03-13 12:23:03,381 [INFO]: 	index_key: HNSW32
2025-03-13 12:23:03,381 [INFO]: 	index_param: efSearch=137
2025-03-13 12:23:03,381 [INFO]: 	index_path: knn.index
2025-03-13 12:23:03,381 [INFO]: 	size in bytes: 2013489734
2025-03-13 12:23:03,381 [INFO]: 	avg_search_speed_ms: 10.028481848468797
2025-03-13 12:23:03,381 [INFO]: 	99p_search_speed_ms: 16.20313552208244
2025-03-13 12:23:03,381 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:03,381 [INFO]: 	nb vectors: 10227
2025-03-13 12:23:03,381 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:03,381 [INFO]: 	compression ratio: 0.9986194526085426
2025-03-13 12:23:03,381 [INFO]: }
2025-03-13 12:23:03,381 [INFO]: 	>>> Finished "Creating the index" in 126.2389 secs
2025-03-13 12:23:03,381 [INFO]: >>> Finished "Launching the whole pipeline" in 126.2709 secs
2025-03-13 12:23:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 65112 [episode count 17/20]
[retrieval_preprocessing] for episode 81537 [episode count 18/20], we have num_retrieval=np.int64(10138) num_query=np.int64(596)
2025-03-13 12:23:07,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:09,448 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:09
2025-03-13 12:23:09,448 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-13 12:23:09,476 [INFO]: There are 10138 embeddings of dim 49152
2025-03-13 12:23:09,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:23:09,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:09,477 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:23:09,477 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:23:09,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:09,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,477 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:09,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:23:09,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:09
2025-03-13 12:23:09,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:09,477 [INFO]: 	Creating the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,477 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:23:09
2025-03-13 12:23:09,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 12:23:09,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,479 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:23:09,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  6.84it/s]  7%|▋         | 3/41 [00:00<00:02, 13.07it/s] 17%|█▋        | 7/41 [00:00<00:01, 24.03it/s] 24%|██▍       | 10/41 [00:00<00:01, 25.13it/s] 34%|███▍      | 14/41 [00:00<00:00, 28.78it/s] 44%|████▍     | 18/41 [00:00<00:00, 31.94it/s] 54%|█████▎    | 22/41 [00:07<00:11,  1.68it/s] 63%|██████▎   | 26/41 [00:07<00:06,  2.49it/s] 73%|███████▎  | 30/41 [00:07<00:03,  3.58it/s] 83%|████████▎ | 34/41 [00:07<00:01,  5.03it/s] 95%|█████████▌| 39/41 [00:07<00:00,  7.37it/s]100%|██████████| 41/41 [00:14<00:00,  2.83it/s]
2025-03-13 12:23:23,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:23
2025-03-13 12:24:35,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.7786 secs
2025-03-13 12:24:35,770 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 12:24:35,770 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 12:25:06,320 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5494 secs
2025-03-13 12:25:06,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.8459 secs
2025-03-13 12:25:06,325 [INFO]: {
2025-03-13 12:25:06,325 [INFO]: 	index_key: HNSW32
2025-03-13 12:25:06,325 [INFO]: 	index_param: efSearch=120
2025-03-13 12:25:06,325 [INFO]: 	index_path: knn.index
2025-03-13 12:25:06,325 [INFO]: 	size in bytes: 1995967386
2025-03-13 12:25:06,325 [INFO]: 	avg_search_speed_ms: 9.902683228696928
2025-03-13 12:25:06,325 [INFO]: 	99p_search_speed_ms: 15.43383810436353
2025-03-13 12:25:06,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:06,325 [INFO]: 	nb vectors: 10138
2025-03-13 12:25:06,325 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:06,325 [INFO]: 	compression ratio: 0.9986194754386633
2025-03-13 12:25:06,325 [INFO]: }
2025-03-13 12:25:06,325 [INFO]: 	>>> Finished "Creating the index" in 116.8479 secs
2025-03-13 12:25:06,325 [INFO]: >>> Finished "Launching the whole pipeline" in 116.8769 secs
2025-03-13 12:25:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 81537 [episode count 18/20]
[retrieval_preprocessing] for episode 57027 [episode count 19/20], we have num_retrieval=np.int64(10277) num_query=np.int64(457)
2025-03-13 12:25:10,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:12,274 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:12
2025-03-13 12:25:12,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.07it/s]
2025-03-13 12:25:12,301 [INFO]: There are 10277 embeddings of dim 49152
2025-03-13 12:25:12,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:25:12,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:12
2025-03-13 12:25:12,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:12,301 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:25:12,301 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:25:12,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:12,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:12
2025-03-13 12:25:12,301 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:12,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:25:12,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:12
2025-03-13 12:25:12,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:12,302 [INFO]: 	Creating the index 03/13/2025, 12:25:12
2025-03-13 12:25:12,302 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:25:12
2025-03-13 12:25:12,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 12:25:12,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:12
2025-03-13 12:25:12,303 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:25:12,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:04,  9.55it/s]  9%|▉         | 4/43 [00:00<00:02, 19.49it/s] 21%|██        | 9/43 [00:00<00:01, 30.94it/s] 33%|███▎      | 14/43 [00:00<00:00, 36.40it/s] 44%|████▍     | 19/43 [00:00<00:00, 39.33it/s] 53%|█████▎    | 23/43 [00:06<00:09,  2.07it/s] 65%|██████▌   | 28/43 [00:06<00:04,  3.17it/s] 77%|███████▋  | 33/43 [00:06<00:02,  4.66it/s] 88%|████████▊ | 38/43 [00:06<00:00,  6.61it/s]100%|██████████| 43/43 [00:15<00:00,  1.58it/s]100%|██████████| 43/43 [00:15<00:00,  2.86it/s]
2025-03-13 12:25:27,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:27
2025-03-13 12:26:46,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.0944 secs
2025-03-13 12:26:46,423 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 12:26:46,423 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 12:27:11,670 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2467 secs
2025-03-13 12:27:11,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.3678 secs
2025-03-13 12:27:11,671 [INFO]: {
2025-03-13 12:27:11,671 [INFO]: 	index_key: HNSW32
2025-03-13 12:27:11,671 [INFO]: 	index_param: efSearch=131
2025-03-13 12:27:11,671 [INFO]: 	index_path: knn.index
2025-03-13 12:27:11,671 [INFO]: 	size in bytes: 2023333534
2025-03-13 12:27:11,671 [INFO]: 	avg_search_speed_ms: 10.27800503927728
2025-03-13 12:27:11,671 [INFO]: 	99p_search_speed_ms: 16.123528527095914
2025-03-13 12:27:11,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:11,671 [INFO]: 	nb vectors: 10277
2025-03-13 12:27:11,671 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:11,671 [INFO]: 	compression ratio: 0.9986195464301537
2025-03-13 12:27:11,671 [INFO]: }
2025-03-13 12:27:11,671 [INFO]: 	>>> Finished "Creating the index" in 119.3692 secs
2025-03-13 12:27:11,671 [INFO]: >>> Finished "Launching the whole pipeline" in 119.3966 secs
2025-03-13 12:27:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 57027 [episode count 19/20]
2025-03-13 12:27:14: [retrieval_preprocessing] finished for 5207831207_pour_cup_into_bowl [chosen_id count 3/260]
2025-03-13 12:27:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_stack_cups [chosen_id count 4/260]
2025-03-13 12:27:17: [retrieval_preprocessing] we have num_total=7511 embedding_dim=49152
[retrieval_preprocessing] for episode 69662 [episode count 0/20], we have num_retrieval=np.int64(7194) num_query=np.int64(317)
2025-03-13 12:27:17,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:18,815 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:18
2025-03-13 12:27:18,815 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1958.13it/s]
2025-03-13 12:27:18,839 [INFO]: There are 7194 embeddings of dim 49152
2025-03-13 12:27:18,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 12:27:18,839 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:18
2025-03-13 12:27:18,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:18,839 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:27:18,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:18,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:27:18,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:18
2025-03-13 12:27:18,839 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:18,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:27:18,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:18
2025-03-13 12:27:18,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:18,840 [INFO]: 	Creating the index 03/13/2025, 12:27:18
2025-03-13 12:27:18,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:18
2025-03-13 12:27:18,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:27:18,841 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:18
2025-03-13 12:27:18,841 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:27:18,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 15.43it/s] 23%|██▎       | 7/30 [00:00<00:00, 32.01it/s] 43%|████▎     | 13/30 [00:00<00:00, 41.51it/s] 63%|██████▎   | 19/30 [00:00<00:00, 47.19it/s] 80%|████████  | 24/30 [00:03<00:01,  3.85it/s]100%|██████████| 30/30 [00:05<00:00,  3.59it/s]100%|██████████| 30/30 [00:05<00:00,  5.13it/s]
2025-03-13 12:27:24,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:24
2025-03-13 12:28:27,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.9442 secs
2025-03-13 12:28:27,639 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 12:28:27,639 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 12:28:54,709 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0692 secs
2025-03-13 12:28:54,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8698 secs
2025-03-13 12:28:54,711 [INFO]: {
2025-03-13 12:28:54,711 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:54,711 [INFO]: 	index_param: efSearch=191
2025-03-13 12:28:54,711 [INFO]: 	index_path: knn.index
2025-03-13 12:28:54,711 [INFO]: 	size in bytes: 1415377030
2025-03-13 12:28:54,711 [INFO]: 	avg_search_speed_ms: 10.55249068684648
2025-03-13 12:28:54,711 [INFO]: 	99p_search_speed_ms: 16.05673721991478
2025-03-13 12:28:54,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:54,711 [INFO]: 	nb vectors: 7194
2025-03-13 12:28:54,711 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:54,711 [INFO]: 	compression ratio: 0.9993082564014762
2025-03-13 12:28:54,711 [INFO]: }
2025-03-13 12:28:54,711 [INFO]: 	>>> Finished "Creating the index" in 95.8712 secs
2025-03-13 12:28:54,711 [INFO]: >>> Finished "Launching the whole pipeline" in 95.8954 secs
2025-03-13 12:28:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 69662 [episode count 0/20]
[retrieval_preprocessing] for episode 45160 [episode count 1/20], we have num_retrieval=np.int64(7223) num_query=np.int64(288)
2025-03-13 12:28:58,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:00,642 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:00
2025-03-13 12:29:00,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.87it/s]
2025-03-13 12:29:00,670 [INFO]: There are 7223 embeddings of dim 49152
2025-03-13 12:29:00,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:29:00,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:00
2025-03-13 12:29:00,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:00,671 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:29:00,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:00,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:29:00,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:00
2025-03-13 12:29:00,672 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:00,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:29:00,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:00
2025-03-13 12:29:00,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:00,672 [INFO]: 	Creating the index 03/13/2025, 12:29:00
2025-03-13 12:29:00,673 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:00
2025-03-13 12:29:00,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:29:00,676 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:00
2025-03-13 12:29:00,677 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:29:00,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 16.72it/s] 23%|██▎       | 7/30 [00:00<00:00, 34.40it/s] 40%|████      | 12/30 [00:00<00:00, 41.02it/s] 57%|█████▋    | 17/30 [00:00<00:00, 44.35it/s] 73%|███████▎  | 22/30 [00:04<00:02,  3.36it/s] 93%|█████████▎| 28/30 [00:04<00:00,  5.35it/s]100%|██████████| 30/30 [00:06<00:00,  4.87it/s]
2025-03-13 12:29:06,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:06
2025-03-13 12:30:09,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2098 secs
2025-03-13 12:30:09,053 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:30:09,053 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 12:30:33,669 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6154 secs
2025-03-13 12:30:33,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.9938 secs
2025-03-13 12:30:33,670 [INFO]: {
2025-03-13 12:30:33,670 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:33,670 [INFO]: 	index_param: efSearch=203
2025-03-13 12:30:33,670 [INFO]: 	index_path: knn.index
2025-03-13 12:30:33,670 [INFO]: 	size in bytes: 1421082670
2025-03-13 12:30:33,671 [INFO]: 	avg_search_speed_ms: 11.9669416687634
2025-03-13 12:30:33,671 [INFO]: 	99p_search_speed_ms: 19.047324534039944
2025-03-13 12:30:33,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:33,671 [INFO]: 	nb vectors: 7223
2025-03-13 12:30:33,671 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:33,671 [INFO]: 	compression ratio: 0.9993082133638291
2025-03-13 12:30:33,671 [INFO]: }
2025-03-13 12:30:33,671 [INFO]: 	>>> Finished "Creating the index" in 92.9981 secs
2025-03-13 12:30:33,671 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0286 secs
2025-03-13 12:30:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 45160 [episode count 1/20]
[retrieval_preprocessing] for episode 26816 [episode count 2/20], we have num_retrieval=np.int64(7057) num_query=np.int64(454)
2025-03-13 12:30:36,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:37,673 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:37
2025-03-13 12:30:37,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1148.18it/s]
2025-03-13 12:30:37,705 [INFO]: There are 7057 embeddings of dim 49152
2025-03-13 12:30:37,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:30:37,706 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:37
2025-03-13 12:30:37,706 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:37,706 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:30:37,706 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:37,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:30:37,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:37
2025-03-13 12:30:37,707 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:37,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:30:37,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:37
2025-03-13 12:30:37,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:37,707 [INFO]: 	Creating the index 03/13/2025, 12:30:37
2025-03-13 12:30:37,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:37
2025-03-13 12:30:37,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:30:37,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:37
2025-03-13 12:30:37,709 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:30:37,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.51it/s] 21%|██        | 6/29 [00:00<00:00, 28.75it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.62it/s] 55%|█████▌    | 16/29 [00:00<00:00, 41.91it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.12it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.68it/s]100%|██████████| 29/29 [00:06<00:00,  4.43it/s]
2025-03-13 12:30:44,267 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:44
2025-03-13 12:31:42,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0273 secs
2025-03-13 12:31:42,295 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 12:31:42,295 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.43it/s]
2025-03-13 12:32:07,482 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1867 secs
2025-03-13 12:32:07,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.7747 secs
2025-03-13 12:32:07,484 [INFO]: {
2025-03-13 12:32:07,484 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:07,484 [INFO]: 	index_param: efSearch=238
2025-03-13 12:32:07,484 [INFO]: 	index_path: knn.index
2025-03-13 12:32:07,484 [INFO]: 	size in bytes: 1388422990
2025-03-13 12:32:07,484 [INFO]: 	avg_search_speed_ms: 12.257094947249154
2025-03-13 12:32:07,484 [INFO]: 	99p_search_speed_ms: 17.185291112400595
2025-03-13 12:32:07,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:07,484 [INFO]: 	nb vectors: 7057
2025-03-13 12:32:07,484 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:07,484 [INFO]: 	compression ratio: 0.9993083275003967
2025-03-13 12:32:07,484 [INFO]: }
2025-03-13 12:32:07,484 [INFO]: 	>>> Finished "Creating the index" in 89.7770 secs
2025-03-13 12:32:07,484 [INFO]: >>> Finished "Launching the whole pipeline" in 89.8112 secs
2025-03-13 12:32:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 26816 [episode count 2/20]
[retrieval_preprocessing] for episode 41163 [episode count 3/20], we have num_retrieval=np.int64(7231) num_query=np.int64(280)
2025-03-13 12:32:14,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:15,797 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:15
2025-03-13 12:32:15,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.45it/s]
2025-03-13 12:32:15,824 [INFO]: There are 7231 embeddings of dim 49152
2025-03-13 12:32:15,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:32:15,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:15
2025-03-13 12:32:15,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:15,824 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:32:15,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:15,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:15,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:15
2025-03-13 12:32:15,824 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:15,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:32:15,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:15
2025-03-13 12:32:15,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:15,825 [INFO]: 	Creating the index 03/13/2025, 12:32:15
2025-03-13 12:32:15,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:15
2025-03-13 12:32:15,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:32:15,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:15
2025-03-13 12:32:15,826 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:32:15,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.77it/s] 20%|██        | 6/30 [00:00<00:00, 30.59it/s] 37%|███▋      | 11/30 [00:00<00:00, 38.70it/s] 53%|█████▎    | 16/30 [00:00<00:00, 41.85it/s] 70%|███████   | 21/30 [00:04<00:03,  2.86it/s] 87%|████████▋ | 26/30 [00:04<00:00,  4.29it/s]100%|██████████| 30/30 [00:06<00:00,  3.18it/s]100%|██████████| 30/30 [00:06<00:00,  4.33it/s]
2025-03-13 12:32:23,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:23
2025-03-13 12:33:20,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9921 secs
2025-03-13 12:33:20,039 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:33:20,039 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-13 12:33:44,933 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8943 secs
2025-03-13 12:33:44,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.1083 secs
2025-03-13 12:33:44,935 [INFO]: {
2025-03-13 12:33:44,935 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:44,935 [INFO]: 	index_param: efSearch=207
2025-03-13 12:33:44,935 [INFO]: 	index_path: knn.index
2025-03-13 12:33:44,935 [INFO]: 	size in bytes: 1422656650
2025-03-13 12:33:44,935 [INFO]: 	avg_search_speed_ms: 10.293798856513858
2025-03-13 12:33:44,935 [INFO]: 	99p_search_speed_ms: 14.700819840654725
2025-03-13 12:33:44,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:44,935 [INFO]: 	nb vectors: 7231
2025-03-13 12:33:44,935 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:44,935 [INFO]: 	compression ratio: 0.9993081942856697
2025-03-13 12:33:44,935 [INFO]: }
2025-03-13 12:33:44,935 [INFO]: 	>>> Finished "Creating the index" in 89.1100 secs
2025-03-13 12:33:44,935 [INFO]: >>> Finished "Launching the whole pipeline" in 89.1377 secs
2025-03-13 12:33:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 41163 [episode count 3/20]
[retrieval_preprocessing] for episode 63721 [episode count 4/20], we have num_retrieval=np.int64(7020) num_query=np.int64(491)
2025-03-13 12:33:47,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:48,566 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:48
2025-03-13 12:33:48,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1553.45it/s]
2025-03-13 12:33:48,886 [INFO]: There are 7020 embeddings of dim 49152
2025-03-13 12:33:48,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3200 secs
2025-03-13 12:33:48,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:48
2025-03-13 12:33:48,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:48,886 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:33:48,887 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:48,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:33:48,887 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:48
2025-03-13 12:33:48,887 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:48,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:33:48,888 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:48
2025-03-13 12:33:48,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:48,888 [INFO]: 	Creating the index 03/13/2025, 12:33:48
2025-03-13 12:33:48,888 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:48
2025-03-13 12:33:48,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 12:33:48,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:48
2025-03-13 12:33:48,890 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:33:48,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.44it/s] 21%|██        | 6/29 [00:00<00:00, 31.47it/s] 41%|████▏     | 12/29 [00:00<00:00, 41.24it/s] 62%|██████▏   | 18/29 [00:00<00:00, 45.62it/s] 79%|███████▉  | 23/29 [00:04<00:01,  3.37it/s]100%|██████████| 29/29 [00:06<00:00,  3.29it/s]100%|██████████| 29/29 [00:06<00:00,  4.59it/s]
2025-03-13 12:33:55,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:55
2025-03-13 12:34:52,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0441 secs
2025-03-13 12:34:52,261 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:34:52,261 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.25it/s]
2025-03-13 12:35:16,723 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4625 secs
2025-03-13 12:35:16,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.8352 secs
2025-03-13 12:35:16,726 [INFO]: {
2025-03-13 12:35:16,726 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:16,726 [INFO]: 	index_param: efSearch=228
2025-03-13 12:35:16,726 [INFO]: 	index_path: knn.index
2025-03-13 12:35:16,726 [INFO]: 	size in bytes: 1381143490
2025-03-13 12:35:16,726 [INFO]: 	avg_search_speed_ms: 11.606618275286808
2025-03-13 12:35:16,726 [INFO]: 	99p_search_speed_ms: 17.356166723184288
2025-03-13 12:35:16,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:16,726 [INFO]: 	nb vectors: 7020
2025-03-13 12:35:16,726 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:16,726 [INFO]: 	compression ratio: 0.9993083050335342
2025-03-13 12:35:16,726 [INFO]: }
2025-03-13 12:35:16,726 [INFO]: 	>>> Finished "Creating the index" in 87.8383 secs
2025-03-13 12:35:16,726 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1601 secs
2025-03-13 12:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 63721 [episode count 4/20]
[retrieval_preprocessing] for episode 86297 [episode count 5/20], we have num_retrieval=np.int64(7135) num_query=np.int64(376)
2025-03-13 12:35:24,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:26,614 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:26
2025-03-13 12:35:26,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1153.23it/s]
2025-03-13 12:35:27,138 [INFO]: There are 7135 embeddings of dim 49152
2025-03-13 12:35:27,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5248 secs
2025-03-13 12:35:27,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:27
2025-03-13 12:35:27,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:27,139 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:35:27,139 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:27,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:35:27,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:27
2025-03-13 12:35:27,140 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:27,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:35:27,140 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:27
2025-03-13 12:35:27,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:27,140 [INFO]: 	Creating the index 03/13/2025, 12:35:27
2025-03-13 12:35:27,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:27
2025-03-13 12:35:27,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 12:35:27,142 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:27
2025-03-13 12:35:27,143 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:35:27,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.48it/s]  7%|▋         | 2/30 [00:00<00:03,  7.30it/s] 13%|█▎        | 4/30 [00:00<00:02,  9.48it/s] 20%|██        | 6/30 [00:00<00:02, 10.57it/s] 27%|██▋       | 8/30 [00:00<00:01, 11.12it/s] 33%|███▎      | 10/30 [00:00<00:01, 11.46it/s] 40%|████      | 12/30 [00:01<00:01, 11.73it/s] 47%|████▋     | 14/30 [00:01<00:01, 11.76it/s] 53%|█████▎    | 16/30 [00:01<00:01, 12.37it/s] 60%|██████    | 18/30 [00:01<00:00, 12.45it/s] 67%|██████▋   | 20/30 [00:01<00:00, 12.36it/s] 73%|███████▎  | 22/30 [00:06<00:06,  1.29it/s] 80%|████████  | 24/30 [00:06<00:03,  1.77it/s] 87%|████████▋ | 26/30 [00:06<00:01,  2.38it/s] 93%|█████████▎| 28/30 [00:06<00:00,  3.13it/s]100%|██████████| 30/30 [00:09<00:00,  1.67it/s]100%|██████████| 30/30 [00:09<00:00,  3.17it/s]
2025-03-13 12:35:36,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:36
2025-03-13 12:36:40,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4301 secs
2025-03-13 12:36:40,036 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:36:40,036 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 12:37:06,484 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4478 secs
2025-03-13 12:37:06,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.3434 secs
2025-03-13 12:37:06,486 [INFO]: {
2025-03-13 12:37:06,486 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:06,486 [INFO]: 	index_param: efSearch=208
2025-03-13 12:37:06,486 [INFO]: 	index_path: knn.index
2025-03-13 12:37:06,486 [INFO]: 	size in bytes: 1403769070
2025-03-13 12:37:06,486 [INFO]: 	avg_search_speed_ms: 10.86920491121102
2025-03-13 12:37:06,486 [INFO]: 	99p_search_speed_ms: 15.501970103941856
2025-03-13 12:37:06,486 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:06,486 [INFO]: 	nb vectors: 7135
2025-03-13 12:37:06,486 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:06,486 [INFO]: 	compression ratio: 0.9993082979097124
2025-03-13 12:37:06,486 [INFO]: }
2025-03-13 12:37:06,486 [INFO]: 	>>> Finished "Creating the index" in 99.3462 secs
2025-03-13 12:37:06,486 [INFO]: >>> Finished "Launching the whole pipeline" in 99.8723 secs
2025-03-13 12:37:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 86297 [episode count 5/20]
[retrieval_preprocessing] for episode 35282 [episode count 6/20], we have num_retrieval=np.int64(7137) num_query=np.int64(374)
2025-03-13 12:37:10,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:12,217 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:12
2025-03-13 12:37:12,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.98it/s]
2025-03-13 12:37:12,243 [INFO]: There are 7137 embeddings of dim 49152
2025-03-13 12:37:12,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 12:37:12,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:12
2025-03-13 12:37:12,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:12,244 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:37:12,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:12,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:37:12,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:12
2025-03-13 12:37:12,245 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:12,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:37:12,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:12
2025-03-13 12:37:12,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:12,246 [INFO]: 	Creating the index 03/13/2025, 12:37:12
2025-03-13 12:37:12,246 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:12
2025-03-13 12:37:12,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:37:12,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:12
2025-03-13 12:37:12,250 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:37:12,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 17.67it/s] 27%|██▋       | 8/30 [00:00<00:00, 37.51it/s] 47%|████▋     | 14/30 [00:00<00:00, 43.78it/s] 63%|██████▎   | 19/30 [00:00<00:00, 44.67it/s] 80%|████████  | 24/30 [00:05<00:02,  2.69it/s] 90%|█████████ | 27/30 [00:05<00:00,  3.26it/s]100%|██████████| 30/30 [00:08<00:00,  2.11it/s]100%|██████████| 30/30 [00:08<00:00,  3.47it/s]
2025-03-13 12:37:20,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:20
2025-03-13 12:38:24,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.9940 secs
2025-03-13 12:38:24,900 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 12:38:24,900 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.56it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 12:38:58,377 [INFO]: 	>>> Finished "Compute fast metrics" in 33.4772 secs
2025-03-13 12:38:58,379 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.1291 secs
2025-03-13 12:38:58,379 [INFO]: {
2025-03-13 12:38:58,379 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:58,379 [INFO]: 	index_param: efSearch=249
2025-03-13 12:38:58,379 [INFO]: 	index_path: knn.index
2025-03-13 12:38:58,379 [INFO]: 	size in bytes: 1404162610
2025-03-13 12:38:58,379 [INFO]: 	avg_search_speed_ms: 11.45698720795174
2025-03-13 12:38:58,379 [INFO]: 	99p_search_speed_ms: 15.415008077397943
2025-03-13 12:38:58,379 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:58,379 [INFO]: 	nb vectors: 7137
2025-03-13 12:38:58,379 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:58,379 [INFO]: 	compression ratio: 0.999308261028258
2025-03-13 12:38:58,379 [INFO]: }
2025-03-13 12:38:58,379 [INFO]: 	>>> Finished "Creating the index" in 106.1331 secs
2025-03-13 12:38:58,379 [INFO]: >>> Finished "Launching the whole pipeline" in 106.1616 secs
2025-03-13 12:39:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 35282 [episode count 6/20]
[retrieval_preprocessing] for episode 88618 [episode count 7/20], we have num_retrieval=np.int64(7022) num_query=np.int64(489)
2025-03-13 12:39:05,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:07,375 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:07
2025-03-13 12:39:07,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.40it/s]
2025-03-13 12:39:07,401 [INFO]: There are 7022 embeddings of dim 49152
2025-03-13 12:39:07,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 12:39:07,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:07
2025-03-13 12:39:07,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:07,401 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:39:07,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:07,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:07,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:07
2025-03-13 12:39:07,401 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:07,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:07,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:07
2025-03-13 12:39:07,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:07,401 [INFO]: 	Creating the index 03/13/2025, 12:39:07
2025-03-13 12:39:07,401 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:07
2025-03-13 12:39:07,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:39:07,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:07
2025-03-13 12:39:07,403 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:39:07,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.30it/s] 10%|█         | 3/29 [00:00<00:02,  9.71it/s] 17%|█▋        | 5/29 [00:00<00:01, 12.33it/s] 24%|██▍       | 7/29 [00:00<00:01, 13.22it/s] 31%|███       | 9/29 [00:00<00:01, 13.31it/s] 38%|███▊      | 11/29 [00:00<00:01, 12.52it/s] 45%|████▍     | 13/29 [00:01<00:01, 12.44it/s] 52%|█████▏    | 15/29 [00:01<00:01, 12.94it/s] 59%|█████▊    | 17/29 [00:01<00:00, 13.37it/s] 66%|██████▌   | 19/29 [00:01<00:00, 13.28it/s] 72%|███████▏  | 21/29 [00:05<00:05,  1.60it/s] 79%|███████▉  | 23/29 [00:05<00:02,  2.18it/s] 86%|████████▌ | 25/29 [00:05<00:01,  2.94it/s] 93%|█████████▎| 27/29 [00:05<00:00,  3.89it/s]100%|██████████| 29/29 [00:07<00:00,  1.96it/s]100%|██████████| 29/29 [00:07<00:00,  3.68it/s]
2025-03-13 12:39:15,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:15
2025-03-13 12:40:10,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8890 secs
2025-03-13 12:40:10,167 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 12:40:10,167 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 12:40:44,028 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8610 secs
2025-03-13 12:40:44,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.6274 secs
2025-03-13 12:40:44,030 [INFO]: {
2025-03-13 12:40:44,030 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:44,030 [INFO]: 	index_param: efSearch=256
2025-03-13 12:40:44,030 [INFO]: 	index_path: knn.index
2025-03-13 12:40:44,030 [INFO]: 	size in bytes: 1381536970
2025-03-13 12:40:44,030 [INFO]: 	avg_search_speed_ms: 14.088130698368794
2025-03-13 12:40:44,030 [INFO]: 	99p_search_speed_ms: 26.80923970649017
2025-03-13 12:40:44,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:44,030 [INFO]: 	nb vectors: 7022
2025-03-13 12:40:44,030 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:44,030 [INFO]: 	compression ratio: 0.999308310945888
2025-03-13 12:40:44,030 [INFO]: }
2025-03-13 12:40:44,030 [INFO]: 	>>> Finished "Creating the index" in 96.6290 secs
2025-03-13 12:40:44,030 [INFO]: >>> Finished "Launching the whole pipeline" in 96.6553 secs
2025-03-13 12:40:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 88618 [episode count 7/20]
[retrieval_preprocessing] for episode 78489 [episode count 8/20], we have num_retrieval=np.int64(7191) num_query=np.int64(320)
2025-03-13 12:40:55,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:56,628 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:56
2025-03-13 12:40:56,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-13 12:40:56,652 [INFO]: There are 7191 embeddings of dim 49152
2025-03-13 12:40:56,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:40:56,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:56
2025-03-13 12:40:56,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:56,653 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:40:56,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:56,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:40:56,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:56
2025-03-13 12:40:56,654 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:56,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:40:56,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:56
2025-03-13 12:40:56,655 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:56,655 [INFO]: 	Creating the index 03/13/2025, 12:40:56
2025-03-13 12:40:56,655 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:56
2025-03-13 12:40:56,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 12:40:56,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:56
2025-03-13 12:40:56,658 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:40:56,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  9.05it/s]  7%|▋         | 2/30 [00:00<00:03,  7.56it/s] 10%|█         | 3/30 [00:00<00:03,  7.49it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.26it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.26it/s] 20%|██        | 6/30 [00:00<00:03,  7.41it/s] 23%|██▎       | 7/30 [00:00<00:03,  7.41it/s] 27%|██▋       | 8/30 [00:01<00:02,  7.57it/s] 30%|███       | 9/30 [00:01<00:02,  7.63it/s] 33%|███▎      | 10/30 [00:01<00:02,  7.65it/s] 37%|███▋      | 11/30 [00:01<00:02,  7.72it/s] 40%|████      | 12/30 [00:01<00:02,  7.77it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.77it/s] 47%|████▋     | 14/30 [00:01<00:02,  7.65it/s] 50%|█████     | 15/30 [00:01<00:01,  7.68it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.68it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.52it/s] 60%|██████    | 18/30 [00:02<00:01,  7.63it/s] 63%|██████▎   | 19/30 [00:02<00:01,  7.35it/s] 67%|██████▋   | 20/30 [00:02<00:01,  7.46it/s] 70%|███████   | 21/30 [00:06<00:12,  1.35s/it] 83%|████████▎ | 25/30 [00:06<00:02,  1.95it/s] 97%|█████████▋| 29/30 [00:07<00:00,  3.52it/s]100%|██████████| 30/30 [00:09<00:00,  3.14it/s]
2025-03-13 12:41:06,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:06
2025-03-13 12:42:32,314 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.0932 secs
2025-03-13 12:42:32,315 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 12:42:32,315 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.53it/s] 50%|█████     | 2/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s]
2025-03-13 12:42:54,165 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8498 secs
2025-03-13 12:42:54,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.5093 secs
2025-03-13 12:42:54,168 [INFO]: {
2025-03-13 12:42:54,168 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:54,168 [INFO]: 	index_param: efSearch=244
2025-03-13 12:42:54,168 [INFO]: 	index_path: knn.index
2025-03-13 12:42:54,168 [INFO]: 	size in bytes: 1414786810
2025-03-13 12:42:54,168 [INFO]: 	avg_search_speed_ms: 17.563450392417348
2025-03-13 12:42:54,168 [INFO]: 	99p_search_speed_ms: 28.03088956046849
2025-03-13 12:42:54,168 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:54,168 [INFO]: 	nb vectors: 7191
2025-03-13 12:42:54,168 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:54,168 [INFO]: 	compression ratio: 0.9993082477210824
2025-03-13 12:42:54,168 [INFO]: }
2025-03-13 12:42:54,168 [INFO]: 	>>> Finished "Creating the index" in 117.5128 secs
2025-03-13 12:42:54,168 [INFO]: >>> Finished "Launching the whole pipeline" in 117.5396 secs
2025-03-13 12:42:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 78489 [episode count 8/20]
[retrieval_preprocessing] for episode 82673 [episode count 9/20], we have num_retrieval=np.int64(6956) num_query=np.int64(555)
2025-03-13 12:43:02,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:03,480 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:03
2025-03-13 12:43:03,481 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.21it/s]
2025-03-13 12:43:03,516 [INFO]: There are 6956 embeddings of dim 49152
2025-03-13 12:43:03,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 12:43:03,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:03
2025-03-13 12:43:03,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:03,518 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:43:03,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:03,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:43:03,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:03
2025-03-13 12:43:03,519 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:03,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 12:43:03,519 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:03
2025-03-13 12:43:03,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:03,520 [INFO]: 	Creating the index 03/13/2025, 12:43:03
2025-03-13 12:43:03,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:03
2025-03-13 12:43:03,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:43:03,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:03
2025-03-13 12:43:03,523 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:43:03,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:06,  4.55it/s]  7%|▋         | 2/29 [00:00<00:04,  5.85it/s] 10%|█         | 3/29 [00:00<00:04,  6.38it/s] 14%|█▍        | 4/29 [00:00<00:03,  6.63it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.08it/s] 24%|██▍       | 7/29 [00:00<00:02,  9.14it/s] 31%|███       | 9/29 [00:01<00:01, 10.34it/s] 38%|███▊      | 11/29 [00:01<00:01, 10.00it/s] 45%|████▍     | 13/29 [00:01<00:01,  9.35it/s] 48%|████▊     | 14/29 [00:01<00:01,  8.94it/s] 52%|█████▏    | 15/29 [00:01<00:01,  8.62it/s] 55%|█████▌    | 16/29 [00:01<00:01,  8.38it/s] 59%|█████▊    | 17/29 [00:02<00:01,  8.11it/s] 62%|██████▏   | 18/29 [00:02<00:01,  7.93it/s] 66%|██████▌   | 19/29 [00:02<00:01,  7.88it/s] 69%|██████▉   | 20/29 [00:02<00:01,  8.10it/s] 72%|███████▏  | 21/29 [00:07<00:11,  1.46s/it] 79%|███████▉  | 23/29 [00:07<00:05,  1.20it/s] 86%|████████▌ | 25/29 [00:07<00:02,  1.86it/s] 93%|█████████▎| 27/29 [00:07<00:00,  2.66it/s]100%|██████████| 29/29 [00:09<00:00,  1.59it/s]100%|██████████| 29/29 [00:09<00:00,  2.92it/s]
2025-03-13 12:43:13,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:13
2025-03-13 12:44:14,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8350 secs
2025-03-13 12:44:14,283 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:44:14,283 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 12:44:39,404 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1208 secs
2025-03-13 12:44:39,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8825 secs
2025-03-13 12:44:39,406 [INFO]: {
2025-03-13 12:44:39,406 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:39,406 [INFO]: 	index_param: efSearch=218
2025-03-13 12:44:39,406 [INFO]: 	index_path: knn.index
2025-03-13 12:44:39,406 [INFO]: 	size in bytes: 1368551890
2025-03-13 12:44:39,406 [INFO]: 	avg_search_speed_ms: 11.008367715946452
2025-03-13 12:44:39,406 [INFO]: 	99p_search_speed_ms: 16.122053908184164
2025-03-13 12:44:39,406 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:39,406 [INFO]: 	nb vectors: 6956
2025-03-13 12:44:39,406 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:39,406 [INFO]: 	compression ratio: 0.9993082892896373
2025-03-13 12:44:39,406 [INFO]: }
2025-03-13 12:44:39,406 [INFO]: 	>>> Finished "Creating the index" in 95.8865 secs
2025-03-13 12:44:39,406 [INFO]: >>> Finished "Launching the whole pipeline" in 95.9255 secs
2025-03-13 12:44:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 82673 [episode count 9/20]
[retrieval_preprocessing] for episode 9435 [episode count 10/20], we have num_retrieval=np.int64(7090) num_query=np.int64(421)
2025-03-13 12:44:46,210 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:47,161 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:47
2025-03-13 12:44:47,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-13 12:44:47,186 [INFO]: There are 7090 embeddings of dim 49152
2025-03-13 12:44:47,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 12:44:47,186 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:47
2025-03-13 12:44:47,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:47,186 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:44:47,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:47,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:44:47,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:47
2025-03-13 12:44:47,187 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:47,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:44:47,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:47
2025-03-13 12:44:47,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:47,187 [INFO]: 	Creating the index 03/13/2025, 12:44:47
2025-03-13 12:44:47,187 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:47
2025-03-13 12:44:47,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:44:47,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:47
2025-03-13 12:44:47,188 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:44:47,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:07,  3.53it/s]  7%|▋         | 2/29 [00:00<00:05,  4.99it/s] 10%|█         | 3/29 [00:00<00:04,  6.25it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.11it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.68it/s] 21%|██        | 6/29 [00:00<00:02,  8.20it/s] 24%|██▍       | 7/29 [00:00<00:02,  8.39it/s] 28%|██▊       | 8/29 [00:01<00:02,  8.56it/s] 31%|███       | 9/29 [00:01<00:02,  8.73it/s] 34%|███▍      | 10/29 [00:01<00:02,  8.82it/s] 38%|███▊      | 11/29 [00:01<00:02,  8.96it/s] 41%|████▏     | 12/29 [00:01<00:01,  8.92it/s] 45%|████▍     | 13/29 [00:01<00:01,  8.91it/s] 48%|████▊     | 14/29 [00:01<00:01,  8.90it/s] 55%|█████▌    | 16/29 [00:01<00:01,  9.23it/s] 59%|█████▊    | 17/29 [00:02<00:01,  9.26it/s] 62%|██████▏   | 18/29 [00:02<00:01,  9.18it/s] 66%|██████▌   | 19/29 [00:02<00:01,  9.17it/s] 69%|██████▉   | 20/29 [00:02<00:00,  9.23it/s] 72%|███████▏  | 21/29 [00:06<00:10,  1.34s/it] 86%|████████▌ | 25/29 [00:06<00:02,  1.91it/s]100%|██████████| 29/29 [00:09<00:00,  1.79it/s]100%|██████████| 29/29 [00:09<00:00,  3.12it/s]
2025-03-13 12:44:56,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:56
2025-03-13 12:46:06,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.7865 secs
2025-03-13 12:46:06,303 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 12:46:06,303 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 12:46:32,786 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4828 secs
2025-03-13 12:46:32,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.5999 secs
2025-03-13 12:46:32,788 [INFO]: {
2025-03-13 12:46:32,788 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:32,788 [INFO]: 	index_param: efSearch=189
2025-03-13 12:46:32,788 [INFO]: 	index_path: knn.index
2025-03-13 12:46:32,788 [INFO]: 	size in bytes: 1394915530
2025-03-13 12:46:32,788 [INFO]: 	avg_search_speed_ms: 13.215165844253576
2025-03-13 12:46:32,788 [INFO]: 	99p_search_speed_ms: 19.369233697652817
2025-03-13 12:46:32,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:32,788 [INFO]: 	nb vectors: 7090
2025-03-13 12:46:32,788 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:32,789 [INFO]: 	compression ratio: 0.9993083380468206
2025-03-13 12:46:32,789 [INFO]: }
2025-03-13 12:46:32,789 [INFO]: 	>>> Finished "Creating the index" in 105.6016 secs
2025-03-13 12:46:32,789 [INFO]: >>> Finished "Launching the whole pipeline" in 105.6273 secs
2025-03-13 12:46:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 9435 [episode count 10/20]
[retrieval_preprocessing] for episode 9066 [episode count 11/20], we have num_retrieval=np.int64(7113) num_query=np.int64(398)
2025-03-13 12:46:40,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:41,646 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:41
2025-03-13 12:46:41,646 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-13 12:46:41,672 [INFO]: There are 7113 embeddings of dim 49152
2025-03-13 12:46:41,672 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 12:46:41,672 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:41
2025-03-13 12:46:41,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:41,672 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:46:41,672 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:41,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:46:41,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:41
2025-03-13 12:46:41,672 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:41,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:46:41,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:41
2025-03-13 12:46:41,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:41,672 [INFO]: 	Creating the index 03/13/2025, 12:46:41
2025-03-13 12:46:41,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:41
2025-03-13 12:46:41,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:46:41,674 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:41
2025-03-13 12:46:41,674 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:46:41,674 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.65it/s] 10%|█         | 3/29 [00:00<00:02,  9.75it/s] 17%|█▋        | 5/29 [00:00<00:02, 11.04it/s] 24%|██▍       | 7/29 [00:00<00:01, 11.78it/s] 31%|███       | 9/29 [00:00<00:01, 12.34it/s] 38%|███▊      | 11/29 [00:00<00:01, 12.93it/s] 45%|████▍     | 13/29 [00:01<00:01, 13.06it/s] 52%|█████▏    | 15/29 [00:01<00:01, 13.51it/s] 59%|█████▊    | 17/29 [00:01<00:00, 13.95it/s] 66%|██████▌   | 19/29 [00:01<00:00, 13.74it/s] 72%|███████▏  | 21/29 [00:06<00:07,  1.13it/s] 76%|███████▌  | 22/29 [00:07<00:05,  1.35it/s] 83%|████████▎ | 24/29 [00:07<00:02,  1.91it/s] 90%|████████▉ | 26/29 [00:07<00:01,  2.61it/s] 97%|█████████▋| 28/29 [00:07<00:00,  3.44it/s]100%|██████████| 29/29 [00:10<00:00,  2.75it/s]
2025-03-13 12:46:52,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:52
2025-03-13 12:48:07,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.6698 secs
2025-03-13 12:48:07,905 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 12:48:07,905 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:16,  5.53s/it] 50%|█████     | 2/4 [00:06<00:05,  2.76s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.31s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.76s/it]
2025-03-13 12:48:34,593 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6880 secs
2025-03-13 12:48:34,596 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.9221 secs
2025-03-13 12:48:34,596 [INFO]: {
2025-03-13 12:48:34,596 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:34,596 [INFO]: 	index_param: efSearch=240
2025-03-13 12:48:34,596 [INFO]: 	index_path: knn.index
2025-03-13 12:48:34,596 [INFO]: 	size in bytes: 1399440550
2025-03-13 12:48:34,596 [INFO]: 	avg_search_speed_ms: 11.411139886760436
2025-03-13 12:48:34,596 [INFO]: 	99p_search_speed_ms: 17.51041676849127
2025-03-13 12:48:34,596 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:34,596 [INFO]: 	nb vectors: 7113
2025-03-13 12:48:34,596 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:34,596 [INFO]: 	compression ratio: 0.9993084050622943
2025-03-13 12:48:34,596 [INFO]: }
2025-03-13 12:48:34,596 [INFO]: 	>>> Finished "Creating the index" in 112.9236 secs
2025-03-13 12:48:34,596 [INFO]: >>> Finished "Launching the whole pipeline" in 112.9496 secs
2025-03-13 12:48:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 9066 [episode count 11/20]
[retrieval_preprocessing] for episode 85384 [episode count 12/20], we have num_retrieval=np.int64(7227) num_query=np.int64(284)
2025-03-13 12:48:43,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:45,103 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:45
2025-03-13 12:48:45,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-13 12:48:45,129 [INFO]: There are 7227 embeddings of dim 49152
2025-03-13 12:48:45,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 12:48:45,130 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:45
2025-03-13 12:48:45,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:45,130 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:48:45,130 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:45,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:48:45,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:45
2025-03-13 12:48:45,130 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:45,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:48:45,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:45
2025-03-13 12:48:45,131 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:45,131 [INFO]: 	Creating the index 03/13/2025, 12:48:45
2025-03-13 12:48:45,131 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:45
2025-03-13 12:48:45,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:48:45,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:45
2025-03-13 12:48:45,132 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:48:45,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.03it/s] 10%|█         | 3/30 [00:00<00:02,  9.44it/s] 13%|█▎        | 4/30 [00:00<00:02,  9.32it/s] 17%|█▋        | 5/30 [00:00<00:02,  8.96it/s] 23%|██▎       | 7/30 [00:00<00:02,  9.61it/s] 30%|███       | 9/30 [00:00<00:02,  9.35it/s] 33%|███▎      | 10/30 [00:01<00:02,  9.23it/s] 40%|████      | 12/30 [00:01<00:01,  9.75it/s] 47%|████▋     | 14/30 [00:01<00:01, 10.80it/s] 53%|█████▎    | 16/30 [00:01<00:01, 10.32it/s] 60%|██████    | 18/30 [00:01<00:01,  8.36it/s] 63%|██████▎   | 19/30 [00:02<00:01,  8.30it/s] 67%|██████▋   | 20/30 [00:02<00:01,  8.25it/s] 70%|███████   | 21/30 [00:06<00:09,  1.02s/it] 73%|███████▎  | 22/30 [00:06<00:06,  1.26it/s] 80%|████████  | 24/30 [00:06<00:03,  1.98it/s] 83%|████████▎ | 25/30 [00:06<00:02,  2.41it/s] 87%|████████▋ | 26/30 [00:06<00:01,  2.94it/s] 90%|█████████ | 27/30 [00:06<00:00,  3.57it/s] 93%|█████████▎| 28/30 [00:06<00:00,  4.30it/s] 97%|█████████▋| 29/30 [00:07<00:00,  5.00it/s]100%|██████████| 30/30 [00:09<00:00,  1.07it/s]100%|██████████| 30/30 [00:09<00:00,  3.04it/s]
2025-03-13 12:48:54,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:54
2025-03-13 12:50:02,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.0964 secs
2025-03-13 12:50:02,090 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 12:50:02,090 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 12:50:32,067 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9765 secs
2025-03-13 12:50:32,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.9374 secs
2025-03-13 12:50:32,070 [INFO]: {
2025-03-13 12:50:32,070 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:32,070 [INFO]: 	index_param: efSearch=265
2025-03-13 12:50:32,070 [INFO]: 	index_path: knn.index
2025-03-13 12:50:32,070 [INFO]: 	size in bytes: 1421869690
2025-03-13 12:50:32,070 [INFO]: 	avg_search_speed_ms: 13.214976205078386
2025-03-13 12:50:32,070 [INFO]: 	99p_search_speed_ms: 23.574223248287964
2025-03-13 12:50:32,070 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:32,070 [INFO]: 	nb vectors: 7227
2025-03-13 12:50:32,070 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:32,070 [INFO]: 	compression ratio: 0.9993081827350859
2025-03-13 12:50:32,070 [INFO]: }
2025-03-13 12:50:32,070 [INFO]: 	>>> Finished "Creating the index" in 106.9392 secs
2025-03-13 12:50:32,070 [INFO]: >>> Finished "Launching the whole pipeline" in 106.9668 secs
2025-03-13 12:50:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 85384 [episode count 12/20]
[retrieval_preprocessing] for episode 46585 [episode count 13/20], we have num_retrieval=np.int64(7187) num_query=np.int64(324)
2025-03-13 12:50:39,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:40,503 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:40
2025-03-13 12:50:40,503 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.47it/s]
2025-03-13 12:50:40,532 [INFO]: There are 7187 embeddings of dim 49152
2025-03-13 12:50:40,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 12:50:40,533 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:40
2025-03-13 12:50:40,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:40,533 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:50:40,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:40,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:50:40,534 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:40
2025-03-13 12:50:40,534 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:40,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:50:40,535 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:40
2025-03-13 12:50:40,535 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:40,535 [INFO]: 	Creating the index 03/13/2025, 12:50:40
2025-03-13 12:50:40,535 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:40
2025-03-13 12:50:40,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:50:40,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:40
2025-03-13 12:50:40,538 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:50:40,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.02it/s]  7%|▋         | 2/30 [00:00<00:03,  7.06it/s] 10%|█         | 3/30 [00:00<00:03,  8.13it/s] 17%|█▋        | 5/30 [00:00<00:02,  9.12it/s] 23%|██▎       | 7/30 [00:00<00:02,  9.62it/s] 27%|██▋       | 8/30 [00:00<00:02,  9.64it/s] 33%|███▎      | 10/30 [00:01<00:02,  9.90it/s] 40%|████      | 12/30 [00:01<00:01, 10.09it/s] 47%|████▋     | 14/30 [00:01<00:01,  9.99it/s] 50%|█████     | 15/30 [00:01<00:01,  9.96it/s] 53%|█████▎    | 16/30 [00:01<00:01,  9.88it/s] 60%|██████    | 18/30 [00:01<00:01, 10.09it/s] 67%|██████▋   | 20/30 [00:02<00:01,  9.93it/s] 70%|███████   | 21/30 [00:06<00:08,  1.12it/s] 77%|███████▋  | 23/30 [00:06<00:04,  1.67it/s] 83%|████████▎ | 25/30 [00:06<00:02,  2.35it/s] 90%|█████████ | 27/30 [00:06<00:00,  3.20it/s] 97%|█████████▋| 29/30 [00:06<00:00,  4.12it/s]100%|██████████| 30/30 [00:09<00:00,  3.12it/s]
2025-03-13 12:50:50,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:50
2025-03-13 12:51:47,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1691 secs
2025-03-13 12:51:47,338 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:51:47,338 [INFO]: 	Compute fast metrics 03/13/2025, 12:51:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 12:52:23,864 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5254 secs
2025-03-13 12:52:23,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.3279 secs
2025-03-13 12:52:23,866 [INFO]: {
2025-03-13 12:52:23,866 [INFO]: 	index_key: HNSW15
2025-03-13 12:52:23,866 [INFO]: 	index_param: efSearch=252
2025-03-13 12:52:23,866 [INFO]: 	index_path: knn.index
2025-03-13 12:52:23,866 [INFO]: 	size in bytes: 1413999850
2025-03-13 12:52:23,866 [INFO]: 	avg_search_speed_ms: 13.914788080967435
2025-03-13 12:52:23,866 [INFO]: 	99p_search_speed_ms: 32.75779218878598
2025-03-13 12:52:23,866 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:52:23,866 [INFO]: 	nb vectors: 7187
2025-03-13 12:52:23,866 [INFO]: 	vectors dimension: 49152
2025-03-13 12:52:23,866 [INFO]: 	compression ratio: 0.9993082361359515
2025-03-13 12:52:23,866 [INFO]: }
2025-03-13 12:52:23,867 [INFO]: 	>>> Finished "Creating the index" in 103.3316 secs
2025-03-13 12:52:23,867 [INFO]: >>> Finished "Launching the whole pipeline" in 103.3637 secs
2025-03-13 12:52:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:52:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 46585 [episode count 13/20]
[retrieval_preprocessing] for episode 31682 [episode count 14/20], we have num_retrieval=np.int64(7206) num_query=np.int64(305)
2025-03-13 12:52:33,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:52:34,665 [INFO]: Launching the whole pipeline 03/13/2025, 12:52:34
2025-03-13 12:52:34,665 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:52:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.35it/s]
2025-03-13 12:52:34,690 [INFO]: There are 7206 embeddings of dim 49152
2025-03-13 12:52:34,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 12:52:34,691 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:52:34
2025-03-13 12:52:34,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:52:34,691 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:52:34,691 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:52:34,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:52:34,691 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:52:34
2025-03-13 12:52:34,691 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:52:34,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:52:34,691 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:52:34
2025-03-13 12:52:34,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:52:34,691 [INFO]: 	Creating the index 03/13/2025, 12:52:34
2025-03-13 12:52:34,691 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:52:34
2025-03-13 12:52:34,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:52:34,693 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:52:34
2025-03-13 12:52:34,693 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:52:34,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:20,  1.41it/s]  7%|▋         | 2/30 [00:00<00:12,  2.20it/s] 10%|█         | 3/30 [00:01<00:10,  2.54it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.54it/s] 20%|██        | 6/30 [00:01<00:04,  5.91it/s] 27%|██▋       | 8/30 [00:01<00:02,  7.49it/s] 33%|███▎      | 10/30 [00:01<00:02,  8.45it/s] 37%|███▋      | 11/30 [00:02<00:02,  8.67it/s] 40%|████      | 12/30 [00:02<00:02,  8.92it/s] 47%|████▋     | 14/30 [00:02<00:01, 10.14it/s] 53%|█████▎    | 16/30 [00:02<00:01, 11.34it/s] 60%|██████    | 18/30 [00:02<00:00, 12.37it/s] 67%|██████▋   | 20/30 [00:02<00:00, 13.23it/s] 73%|███████▎  | 22/30 [00:07<00:06,  1.27it/s] 77%|███████▋  | 23/30 [00:07<00:05,  1.37it/s] 83%|████████▎ | 25/30 [00:07<00:02,  2.00it/s] 90%|█████████ | 27/30 [00:08<00:01,  2.80it/s] 97%|█████████▋| 29/30 [00:08<00:00,  3.75it/s]100%|██████████| 30/30 [00:10<00:00,  2.85it/s]
2025-03-13 12:52:45,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:52:45
2025-03-13 12:54:06,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.7075 secs
2025-03-13 12:54:06,934 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 12:54:06,935 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.29it/s] 50%|█████     | 2/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 12:54:28,540 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6051 secs
2025-03-13 12:54:28,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.8496 secs
2025-03-13 12:54:28,542 [INFO]: {
2025-03-13 12:54:28,543 [INFO]: 	index_key: HNSW15
2025-03-13 12:54:28,543 [INFO]: 	index_param: efSearch=205
2025-03-13 12:54:28,543 [INFO]: 	index_path: knn.index
2025-03-13 12:54:28,543 [INFO]: 	size in bytes: 1417737970
2025-03-13 12:54:28,543 [INFO]: 	avg_search_speed_ms: 11.425614651222395
2025-03-13 12:54:28,543 [INFO]: 	99p_search_speed_ms: 18.93423974979669
2025-03-13 12:54:28,543 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:54:28,543 [INFO]: 	nb vectors: 7206
2025-03-13 12:54:28,543 [INFO]: 	vectors dimension: 49152
2025-03-13 12:54:28,543 [INFO]: 	compression ratio: 0.9993082487591131
2025-03-13 12:54:28,543 [INFO]: }
2025-03-13 12:54:28,543 [INFO]: 	>>> Finished "Creating the index" in 113.8515 secs
2025-03-13 12:54:28,543 [INFO]: >>> Finished "Launching the whole pipeline" in 113.8780 secs
2025-03-13 12:54:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:54:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 31682 [episode count 14/20]
[retrieval_preprocessing] for episode 27879 [episode count 15/20], we have num_retrieval=np.int64(7178) num_query=np.int64(333)
2025-03-13 12:54:32,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:54:33,643 [INFO]: Launching the whole pipeline 03/13/2025, 12:54:33
2025-03-13 12:54:33,643 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:54:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 954.12it/s]
2025-03-13 12:54:33,690 [INFO]: There are 7178 embeddings of dim 49152
2025-03-13 12:54:33,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0468 secs
2025-03-13 12:54:33,690 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:54:33
2025-03-13 12:54:33,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:54:33,690 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:54:33,691 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:54:33,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:54:33,691 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:54:33
2025-03-13 12:54:33,691 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:54:33,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:54:33,691 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:54:33
2025-03-13 12:54:33,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:54:33,692 [INFO]: 	Creating the index 03/13/2025, 12:54:33
2025-03-13 12:54:33,692 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:54:33
2025-03-13 12:54:33,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 12:54:33,694 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:54:33
2025-03-13 12:54:33,694 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:54:33,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.97it/s] 20%|██        | 6/30 [00:00<00:00, 30.20it/s] 37%|███▋      | 11/30 [00:00<00:00, 37.30it/s] 53%|█████▎    | 16/30 [00:00<00:00, 40.60it/s] 70%|███████   | 21/30 [00:05<00:03,  2.64it/s] 80%|████████  | 24/30 [00:13<00:05,  1.06it/s] 87%|████████▋ | 26/30 [00:21<00:06,  1.53s/it] 93%|█████████▎| 28/30 [00:24<00:03,  1.54s/it]100%|██████████| 30/30 [00:26<00:00,  1.46s/it]100%|██████████| 30/30 [00:26<00:00,  1.13it/s]
2025-03-13 12:55:00,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:00
2025-03-13 12:56:03,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3458 secs
2025-03-13 12:56:03,677 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 12:56:03,677 [INFO]: 	Compute fast metrics 03/13/2025, 12:56:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 12:56:35,080 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4026 secs
2025-03-13 12:56:35,096 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.4019 secs
2025-03-13 12:56:35,096 [INFO]: {
2025-03-13 12:56:35,096 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:35,096 [INFO]: 	index_param: efSearch=224
2025-03-13 12:56:35,096 [INFO]: 	index_path: knn.index
2025-03-13 12:56:35,096 [INFO]: 	size in bytes: 1412229190
2025-03-13 12:56:35,096 [INFO]: 	avg_search_speed_ms: 10.42485993069325
2025-03-13 12:56:35,096 [INFO]: 	99p_search_speed_ms: 14.517772539984435
2025-03-13 12:56:35,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:35,096 [INFO]: 	nb vectors: 7178
2025-03-13 12:56:35,096 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:35,096 [INFO]: 	compression ratio: 0.999308210022199
2025-03-13 12:56:35,096 [INFO]: }
2025-03-13 12:56:35,096 [INFO]: 	>>> Finished "Creating the index" in 121.4045 secs
2025-03-13 12:56:35,096 [INFO]: >>> Finished "Launching the whole pipeline" in 121.4530 secs
2025-03-13 12:56:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 27879 [episode count 15/20]
[retrieval_preprocessing] for episode 95404 [episode count 16/20], we have num_retrieval=np.int64(7191) num_query=np.int64(320)
2025-03-13 12:56:39,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:40,529 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:40
2025-03-13 12:56:40,529 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.02it/s]
2025-03-13 12:56:40,553 [INFO]: There are 7191 embeddings of dim 49152
2025-03-13 12:56:40,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:56:40,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:40
2025-03-13 12:56:40,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:40,554 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 12:56:40,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:40,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:56:40,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:40
2025-03-13 12:56:40,554 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:40,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:56:40,554 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:40
2025-03-13 12:56:40,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:40,554 [INFO]: 	Creating the index 03/13/2025, 12:56:40
2025-03-13 12:56:40,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:40
2025-03-13 12:56:40,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:56:40,555 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:40
2025-03-13 12:56:40,555 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:56:40,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.07it/s] 10%|█         | 3/30 [00:00<00:03,  8.28it/s] 17%|█▋        | 5/30 [00:00<00:02,  9.51it/s] 23%|██▎       | 7/30 [00:00<00:02,  9.95it/s] 30%|███       | 9/30 [00:00<00:02, 10.25it/s] 37%|███▋      | 11/30 [00:01<00:01, 10.46it/s] 43%|████▎     | 13/30 [00:01<00:01, 10.54it/s] 50%|█████     | 15/30 [00:01<00:01, 10.61it/s] 57%|█████▋    | 17/30 [00:01<00:01, 10.65it/s] 63%|██████▎   | 19/30 [00:01<00:01, 10.57it/s] 70%|███████   | 21/30 [00:05<00:06,  1.45it/s] 73%|███████▎  | 22/30 [00:06<00:04,  1.71it/s] 80%|████████  | 24/30 [00:06<00:02,  2.41it/s] 87%|████████▋ | 26/30 [00:06<00:01,  3.28it/s] 93%|█████████▎| 28/30 [00:06<00:00,  4.28it/s]100%|██████████| 30/30 [00:08<00:00,  2.02it/s]100%|██████████| 30/30 [00:08<00:00,  3.46it/s]
2025-03-13 12:56:49,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:49
2025-03-13 12:57:41,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8264 secs
2025-03-13 12:57:41,056 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 12:57:41,056 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 12:58:17,488 [INFO]: 	>>> Finished "Compute fast metrics" in 36.4324 secs
2025-03-13 12:58:17,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.9346 secs
2025-03-13 12:58:17,490 [INFO]: {
2025-03-13 12:58:17,490 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:17,490 [INFO]: 	index_param: efSearch=282
2025-03-13 12:58:17,490 [INFO]: 	index_path: knn.index
2025-03-13 12:58:17,490 [INFO]: 	size in bytes: 1414786810
2025-03-13 12:58:17,490 [INFO]: 	avg_search_speed_ms: 12.6407860614025
2025-03-13 12:58:17,490 [INFO]: 	99p_search_speed_ms: 20.40267887059599
2025-03-13 12:58:17,490 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:17,490 [INFO]: 	nb vectors: 7191
2025-03-13 12:58:17,490 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:17,490 [INFO]: 	compression ratio: 0.9993082477210824
2025-03-13 12:58:17,490 [INFO]: }
2025-03-13 12:58:17,490 [INFO]: 	>>> Finished "Creating the index" in 96.9363 secs
2025-03-13 12:58:17,490 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9614 secs
2025-03-13 12:58:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 95404 [episode count 16/20]
[retrieval_preprocessing] for episode 75711 [episode count 17/20], we have num_retrieval=np.int64(7186) num_query=np.int64(325)
2025-03-13 12:58:23,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:25,061 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:25
2025-03-13 12:58:25,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.47it/s]
2025-03-13 12:58:25,088 [INFO]: There are 7186 embeddings of dim 49152
2025-03-13 12:58:25,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:58:25,088 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:25
2025-03-13 12:58:25,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:25,088 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:58:25,088 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:25,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:25,088 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:25
2025-03-13 12:58:25,088 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:25,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:25,089 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:25
2025-03-13 12:58:25,089 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:25,089 [INFO]: 	Creating the index 03/13/2025, 12:58:25
2025-03-13 12:58:25,089 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:25
2025-03-13 12:58:25,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:58:25,090 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:25
2025-03-13 12:58:25,090 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:58:25,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.18it/s]  7%|▋         | 2/30 [00:00<00:03,  7.06it/s] 10%|█         | 3/30 [00:00<00:03,  7.91it/s] 13%|█▎        | 4/30 [00:00<00:03,  8.44it/s] 20%|██        | 6/30 [00:00<00:02,  9.13it/s] 23%|██▎       | 7/30 [00:00<00:02,  9.12it/s] 30%|███       | 9/30 [00:01<00:02,  9.67it/s] 33%|███▎      | 10/30 [00:01<00:02,  9.73it/s] 40%|████      | 12/30 [00:01<00:01,  9.86it/s] 43%|████▎     | 13/30 [00:01<00:01,  9.86it/s] 50%|█████     | 15/30 [00:01<00:01,  9.96it/s] 57%|█████▋    | 17/30 [00:01<00:01, 10.35it/s] 63%|██████▎   | 19/30 [00:01<00:01, 10.21it/s] 70%|███████   | 21/30 [00:05<00:06,  1.39it/s] 73%|███████▎  | 22/30 [00:06<00:04,  1.66it/s] 80%|████████  | 24/30 [00:06<00:02,  2.35it/s] 87%|████████▋ | 26/30 [00:06<00:01,  3.17it/s] 93%|█████████▎| 28/30 [00:06<00:00,  4.09it/s]100%|██████████| 30/30 [00:09<00:00,  1.49it/s]100%|██████████| 30/30 [00:09<00:00,  3.04it/s]
2025-03-13 12:58:34,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:34
2025-03-13 12:59:42,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.8290 secs
2025-03-13 12:59:42,798 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:59:42,798 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 13:00:05,486 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6883 secs
2025-03-13 13:00:05,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.3983 secs
2025-03-13 13:00:05,488 [INFO]: {
2025-03-13 13:00:05,488 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:05,488 [INFO]: 	index_param: efSearch=231
2025-03-13 13:00:05,488 [INFO]: 	index_path: knn.index
2025-03-13 13:00:05,488 [INFO]: 	size in bytes: 1413803110
2025-03-13 13:00:05,488 [INFO]: 	avg_search_speed_ms: 10.422449710798295
2025-03-13 13:00:05,488 [INFO]: 	99p_search_speed_ms: 13.976224069483576
2025-03-13 13:00:05,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:05,488 [INFO]: 	nb vectors: 7186
2025-03-13 13:00:05,488 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:05,488 [INFO]: 	compression ratio: 0.9993082332376536
2025-03-13 13:00:05,488 [INFO]: }
2025-03-13 13:00:05,488 [INFO]: 	>>> Finished "Creating the index" in 100.3996 secs
2025-03-13 13:00:05,488 [INFO]: >>> Finished "Launching the whole pipeline" in 100.4273 secs
2025-03-13 13:00:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 75711 [episode count 17/20]
[retrieval_preprocessing] for episode 12138 [episode count 18/20], we have num_retrieval=np.int64(7104) num_query=np.int64(407)
2025-03-13 13:00:11,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:12,696 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:12
2025-03-13 13:00:12,696 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.57it/s]
2025-03-13 13:00:12,720 [INFO]: There are 7104 embeddings of dim 49152
2025-03-13 13:00:12,720 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 13:00:12,720 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:12
2025-03-13 13:00:12,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:12,720 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 13:00:12,720 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:00:12,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:12,720 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:12
2025-03-13 13:00:12,720 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:12,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:00:12,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:12
2025-03-13 13:00:12,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:12,720 [INFO]: 	Creating the index 03/13/2025, 13:00:12
2025-03-13 13:00:12,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:12
2025-03-13 13:00:12,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:00:12,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:12
2025-03-13 13:00:12,721 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 13:00:12,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.39it/s] 10%|█         | 3/29 [00:00<00:02,  9.25it/s] 17%|█▋        | 5/29 [00:00<00:02, 10.78it/s] 24%|██▍       | 7/29 [00:00<00:01, 11.57it/s] 31%|███       | 9/29 [00:00<00:01, 12.08it/s] 38%|███▊      | 11/29 [00:00<00:01, 12.36it/s] 45%|████▍     | 13/29 [00:01<00:01, 12.49it/s] 52%|█████▏    | 15/29 [00:01<00:01, 12.60it/s] 59%|█████▊    | 17/29 [00:01<00:00, 12.68it/s] 66%|██████▌   | 19/29 [00:01<00:00, 12.68it/s] 72%|███████▏  | 21/29 [00:04<00:04,  1.77it/s] 79%|███████▉  | 23/29 [00:05<00:02,  2.39it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.17it/s] 93%|█████████▎| 27/29 [00:05<00:00,  4.10it/s]100%|██████████| 29/29 [00:07<00:00,  2.14it/s]100%|██████████| 29/29 [00:07<00:00,  3.93it/s]
2025-03-13 13:00:20,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:20
2025-03-13 13:01:17,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.3459 secs
2025-03-13 13:01:17,447 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 13:01:17,447 [INFO]: 	Compute fast metrics 03/13/2025, 13:01:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 13:01:40,985 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5378 secs
2025-03-13 13:01:40,987 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.2660 secs
2025-03-13 13:01:40,987 [INFO]: {
2025-03-13 13:01:40,987 [INFO]: 	index_key: HNSW15
2025-03-13 13:01:40,987 [INFO]: 	index_param: efSearch=206
2025-03-13 13:01:40,987 [INFO]: 	index_path: knn.index
2025-03-13 13:01:40,987 [INFO]: 	size in bytes: 1397669890
2025-03-13 13:01:40,987 [INFO]: 	avg_search_speed_ms: 10.330811896734708
2025-03-13 13:01:40,987 [INFO]: 	99p_search_speed_ms: 17.048321892507396
2025-03-13 13:01:40,988 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:01:40,988 [INFO]: 	nb vectors: 7104
2025-03-13 13:01:40,988 [INFO]: 	vectors dimension: 49152
2025-03-13 13:01:40,988 [INFO]: 	compression ratio: 0.9993083788905261
2025-03-13 13:01:40,988 [INFO]: }
2025-03-13 13:01:40,988 [INFO]: 	>>> Finished "Creating the index" in 88.2674 secs
2025-03-13 13:01:40,988 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2913 secs
2025-03-13 13:01:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:01:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 12138 [episode count 18/20]
[retrieval_preprocessing] for episode 77564 [episode count 19/20], we have num_retrieval=np.int64(7061) num_query=np.int64(450)
2025-03-13 13:02:05,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:06,881 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:06
2025-03-13 13:02:06,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.62it/s]
2025-03-13 13:02:06,904 [INFO]: There are 7061 embeddings of dim 49152
2025-03-13 13:02:06,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 13:02:06,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:06,904 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 13:02:06,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:06,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:06,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,904 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:06,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:02:06,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:06
2025-03-13 13:02:06,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:06,904 [INFO]: 	Creating the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:06
2025-03-13 13:02:06,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:02:06,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,906 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 13:02:06,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  4.76it/s]  7%|▋         | 2/29 [00:00<00:03,  6.79it/s] 10%|█         | 3/29 [00:00<00:03,  7.80it/s] 14%|█▍        | 4/29 [00:00<00:02,  8.48it/s] 17%|█▋        | 5/29 [00:00<00:02,  8.91it/s] 24%|██▍       | 7/29 [00:00<00:02,  9.51it/s] 31%|███       | 9/29 [00:01<00:02,  9.77it/s] 38%|███▊      | 11/29 [00:01<00:01,  9.83it/s] 41%|████▏     | 12/29 [00:01<00:01,  9.44it/s] 45%|████▍     | 13/29 [00:01<00:01,  9.22it/s] 48%|████▊     | 14/29 [00:01<00:01,  8.99it/s] 52%|█████▏    | 15/29 [00:01<00:01,  8.72it/s] 55%|█████▌    | 16/29 [00:01<00:01,  8.49it/s] 62%|██████▏   | 18/29 [00:02<00:01,  9.34it/s] 69%|██████▉   | 20/29 [00:05<00:06,  1.35it/s] 72%|███████▏  | 21/29 [00:09<00:10,  1.33s/it] 79%|███████▉  | 23/29 [00:09<00:05,  1.16it/s] 86%|████████▌ | 25/29 [00:09<00:02,  1.71it/s] 93%|█████████▎| 27/29 [00:09<00:00,  2.41it/s]100%|██████████| 29/29 [00:11<00:00,  1.67it/s]100%|██████████| 29/29 [00:11<00:00,  2.53it/s]
2025-03-13 13:02:18,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:18
2025-03-13 13:03:16,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4416 secs
2025-03-13 13:03:16,833 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 13:03:16,834 [INFO]: 	Compute fast metrics 03/13/2025, 13:03:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 13:03:38,574 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7399 secs
2025-03-13 13:03:38,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6695 secs
2025-03-13 13:03:38,575 [INFO]: {
2025-03-13 13:03:38,575 [INFO]: 	index_key: HNSW15
2025-03-13 13:03:38,575 [INFO]: 	index_param: efSearch=230
2025-03-13 13:03:38,575 [INFO]: 	index_path: knn.index
2025-03-13 13:03:38,575 [INFO]: 	size in bytes: 1389210010
2025-03-13 13:03:38,575 [INFO]: 	avg_search_speed_ms: 11.353613058196023
2025-03-13 13:03:38,575 [INFO]: 	99p_search_speed_ms: 17.931076278910044
2025-03-13 13:03:38,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:03:38,575 [INFO]: 	nb vectors: 7061
2025-03-13 13:03:38,575 [INFO]: 	vectors dimension: 49152
2025-03-13 13:03:38,575 [INFO]: 	compression ratio: 0.999308296086925
2025-03-13 13:03:38,575 [INFO]: }
2025-03-13 13:03:38,576 [INFO]: 	>>> Finished "Creating the index" in 91.6710 secs
2025-03-13 13:03:38,576 [INFO]: >>> Finished "Launching the whole pipeline" in 91.6943 secs
2025-03-13 13:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:03:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 77564 [episode count 19/20]
2025-03-13 13:03:43: [retrieval_preprocessing] finished for 5207831207_stack_cups [chosen_id count 4/260]
2025-03-13 13:04:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_put_blocks_in_measuring_cup [chosen_id count 5/260]
2025-03-13 13:04:05: [retrieval_preprocessing] we have num_total=9000 embedding_dim=49152
[retrieval_preprocessing] for episode 84143 [episode count 0/20], we have num_retrieval=np.int64(8582) num_query=np.int64(418)
2025-03-13 13:04:29,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:31,554 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:31
2025-03-13 13:04:31,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-13 13:04:31,576 [INFO]: There are 8582 embeddings of dim 49152
2025-03-13 13:04:31,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 13:04:31,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:31
2025-03-13 13:04:31,577 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:31,577 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:04:31,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:31,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:31,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:31
2025-03-13 13:04:31,577 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:31,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:04:31,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:31
2025-03-13 13:04:31,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:31,577 [INFO]: 	Creating the index 03/13/2025, 13:04:31
2025-03-13 13:04:31,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:31
2025-03-13 13:04:31,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:04:31,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:31
2025-03-13 13:04:31,578 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:04:31,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:01<00:55,  1.63s/it]  9%|▊         | 3/35 [00:01<00:15,  2.04it/s] 11%|█▏        | 4/35 [00:03<00:23,  1.30it/s] 14%|█▍        | 5/35 [00:03<00:22,  1.36it/s] 23%|██▎       | 8/35 [00:03<00:09,  3.00it/s] 29%|██▊       | 10/35 [00:04<00:06,  4.15it/s] 37%|███▋      | 13/35 [00:04<00:03,  6.48it/s] 46%|████▌     | 16/35 [00:04<00:02,  7.57it/s] 51%|█████▏    | 18/35 [00:04<00:02,  7.73it/s] 57%|█████▋    | 20/35 [00:04<00:01,  8.71it/s] 63%|██████▎   | 22/35 [00:10<00:10,  1.18it/s] 69%|██████▊   | 24/35 [00:10<00:06,  1.59it/s] 71%|███████▏  | 25/35 [00:10<00:05,  1.85it/s] 74%|███████▍  | 26/35 [00:11<00:05,  1.54it/s] 77%|███████▋  | 27/35 [00:12<00:05,  1.47it/s] 80%|████████  | 28/35 [00:15<00:08,  1.24s/it] 83%|████████▎ | 29/35 [00:15<00:05,  1.05it/s] 86%|████████▌ | 30/35 [00:15<00:03,  1.31it/s] 91%|█████████▏| 32/35 [00:17<00:02,  1.23it/s] 94%|█████████▍| 33/35 [00:19<00:02,  1.12s/it] 97%|█████████▋| 34/35 [00:19<00:00,  1.10it/s]100%|██████████| 35/35 [00:24<00:00,  1.87s/it]100%|██████████| 35/35 [00:24<00:00,  1.43it/s]
2025-03-13 13:04:56,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:56
2025-03-13 13:06:05,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.6991 secs
2025-03-13 13:06:05,823 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 13:06:05,823 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-13 13:06:31,554 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7314 secs
2025-03-13 13:06:32,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.8421 secs
2025-03-13 13:06:32,420 [INFO]: {
2025-03-13 13:06:32,421 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:32,421 [INFO]: 	index_param: efSearch=218
2025-03-13 13:06:32,421 [INFO]: 	index_path: knn.index
2025-03-13 13:06:32,421 [INFO]: 	size in bytes: 1688457610
2025-03-13 13:06:32,421 [INFO]: 	avg_search_speed_ms: 9.958496701530741
2025-03-13 13:06:32,421 [INFO]: 	99p_search_speed_ms: 17.317186207510535
2025-03-13 13:06:32,421 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:32,421 [INFO]: 	nb vectors: 8582
2025-03-13 13:06:32,421 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:32,421 [INFO]: 	compression ratio: 0.9993083900992931
2025-03-13 13:06:32,421 [INFO]: }
2025-03-13 13:06:32,421 [INFO]: 	>>> Finished "Creating the index" in 120.8442 secs
2025-03-13 13:06:32,421 [INFO]: >>> Finished "Launching the whole pipeline" in 120.8676 secs
2025-03-13 13:06:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 84143 [episode count 0/20]
[retrieval_preprocessing] for episode 94411 [episode count 1/20], we have num_retrieval=np.int64(8054) num_query=np.int64(946)
2025-03-13 13:06:39,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:41,050 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:41
2025-03-13 13:06:41,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-13 13:06:41,078 [INFO]: There are 8054 embeddings of dim 49152
2025-03-13 13:06:41,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 13:06:41,079 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:41
2025-03-13 13:06:41,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:41,079 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 13:06:41,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:41,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 13:06:41,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:41
2025-03-13 13:06:41,080 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:41,080 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:06:41,080 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:41
2025-03-13 13:06:41,080 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:41,080 [INFO]: 	Creating the index 03/13/2025, 13:06:41
2025-03-13 13:06:41,080 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:41
2025-03-13 13:06:41,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:06:41,084 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:41
2025-03-13 13:06:41,084 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 13:06:41,084 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:05,  5.70it/s]  9%|▉         | 3/33 [00:00<00:02, 10.11it/s] 15%|█▌        | 5/33 [00:00<00:02, 11.48it/s] 21%|██        | 7/33 [00:00<00:02, 11.88it/s] 27%|██▋       | 9/33 [00:00<00:01, 12.89it/s] 33%|███▎      | 11/33 [00:00<00:01, 14.06it/s] 39%|███▉      | 13/33 [00:01<00:01, 14.94it/s] 45%|████▌     | 15/33 [00:01<00:01, 15.45it/s] 52%|█████▏    | 17/33 [00:01<00:00, 16.05it/s] 58%|█████▊    | 19/33 [00:01<00:00, 16.14it/s] 64%|██████▎   | 21/33 [00:05<00:09,  1.33it/s] 70%|██████▉   | 23/33 [00:06<00:05,  1.81it/s] 76%|███████▌  | 25/33 [00:06<00:03,  2.43it/s] 82%|████████▏ | 27/33 [00:06<00:01,  3.21it/s] 88%|████████▊ | 29/33 [00:06<00:00,  4.10it/s] 94%|█████████▍| 31/33 [00:06<00:00,  5.17it/s]100%|██████████| 33/33 [00:10<00:00,  1.60it/s]100%|██████████| 33/33 [00:10<00:00,  3.27it/s]
2025-03-13 13:06:51,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:51
2025-03-13 13:07:53,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.3856 secs
2025-03-13 13:07:53,566 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 13:07:53,566 [INFO]: 	Compute fast metrics 03/13/2025, 13:07:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 13:08:11,645 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0789 secs
2025-03-13 13:08:11,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.5633 secs
2025-03-13 13:08:11,647 [INFO]: {
2025-03-13 13:08:11,647 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:11,647 [INFO]: 	index_param: efSearch=219
2025-03-13 13:08:11,647 [INFO]: 	index_path: knn.index
2025-03-13 13:08:11,647 [INFO]: 	size in bytes: 1584577030
2025-03-13 13:08:11,647 [INFO]: 	avg_search_speed_ms: 11.730109387571986
2025-03-13 13:08:11,647 [INFO]: 	99p_search_speed_ms: 16.522468887269497
2025-03-13 13:08:11,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:11,647 [INFO]: 	nb vectors: 8054
2025-03-13 13:08:11,647 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:11,647 [INFO]: 	compression ratio: 0.9993082078187137
2025-03-13 13:08:11,647 [INFO]: }
2025-03-13 13:08:11,647 [INFO]: 	>>> Finished "Creating the index" in 90.5671 secs
2025-03-13 13:08:11,647 [INFO]: >>> Finished "Launching the whole pipeline" in 90.5974 secs
2025-03-13 13:08:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 94411 [episode count 1/20]
[retrieval_preprocessing] for episode 20720 [episode count 2/20], we have num_retrieval=np.int64(8654) num_query=np.int64(346)
2025-03-13 13:08:23,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:25,520 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:25
2025-03-13 13:08:25,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.63it/s]
2025-03-13 13:08:25,550 [INFO]: There are 8654 embeddings of dim 49152
2025-03-13 13:08:25,551 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 13:08:25,551 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:25
2025-03-13 13:08:25,551 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:25,551 [INFO]: 		-> Add: 4.8 seconds
2025-03-13 13:08:25,551 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:25,551 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:08:25,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:25
2025-03-13 13:08:25,552 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:25,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:08:25,552 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:25
2025-03-13 13:08:25,553 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:25,553 [INFO]: 	Creating the index 03/13/2025, 13:08:25
2025-03-13 13:08:25,553 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:25
2025-03-13 13:08:25,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 13:08:25,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:25
2025-03-13 13:08:25,557 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:08:25,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.83it/s]  8%|▊         | 3/36 [00:00<00:03,  8.48it/s] 14%|█▍        | 5/36 [00:00<00:03,  9.83it/s] 19%|█▉        | 7/36 [00:00<00:02, 10.27it/s] 25%|██▌       | 9/36 [00:00<00:02, 10.92it/s] 31%|███       | 11/36 [00:01<00:02, 11.42it/s] 36%|███▌      | 13/36 [00:01<00:01, 11.89it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.22it/s] 47%|████▋     | 17/36 [00:01<00:01, 12.77it/s] 53%|█████▎    | 19/36 [00:01<00:01, 12.81it/s] 58%|█████▊    | 21/36 [00:05<00:09,  1.56it/s] 64%|██████▍   | 23/36 [00:05<00:06,  2.12it/s] 69%|██████▉   | 25/36 [00:05<00:03,  2.84it/s] 75%|███████▌  | 27/36 [00:05<00:02,  3.72it/s] 81%|████████  | 29/36 [00:06<00:01,  4.74it/s] 86%|████████▌ | 31/36 [00:06<00:00,  5.86it/s] 92%|█████████▏| 33/36 [00:06<00:00,  6.98it/s] 97%|█████████▋| 35/36 [00:06<00:00,  8.08it/s]100%|██████████| 36/36 [00:09<00:00,  3.67it/s]
2025-03-13 13:08:35,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:35
2025-03-13 13:09:40,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.7182 secs
2025-03-13 13:09:40,083 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 13:09:40,083 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.55it/s] 50%|█████     | 2/4 [00:01<00:01,  1.07it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.68it/s]
2025-03-13 13:10:13,452 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3687 secs
2025-03-13 13:10:13,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.8981 secs
2025-03-13 13:10:13,455 [INFO]: {
2025-03-13 13:10:13,455 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:13,455 [INFO]: 	index_param: efSearch=237
2025-03-13 13:10:13,455 [INFO]: 	index_path: knn.index
2025-03-13 13:10:13,455 [INFO]: 	size in bytes: 1702623250
2025-03-13 13:10:13,455 [INFO]: 	avg_search_speed_ms: 13.00674949994284
2025-03-13 13:10:13,455 [INFO]: 	99p_search_speed_ms: 20.305250287055966
2025-03-13 13:10:13,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:13,455 [INFO]: 	nb vectors: 8654
2025-03-13 13:10:13,455 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:13,455 [INFO]: 	compression ratio: 0.9993083508051472
2025-03-13 13:10:13,455 [INFO]: }
2025-03-13 13:10:13,455 [INFO]: 	>>> Finished "Creating the index" in 107.9024 secs
2025-03-13 13:10:13,455 [INFO]: >>> Finished "Launching the whole pipeline" in 107.9346 secs
2025-03-13 13:10:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 20720 [episode count 2/20]
[retrieval_preprocessing] for episode 74030 [episode count 3/20], we have num_retrieval=np.int64(8683) num_query=np.int64(317)
2025-03-13 13:10:20,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:21,849 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:21
2025-03-13 13:10:21,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-13 13:10:21,875 [INFO]: There are 8683 embeddings of dim 49152
2025-03-13 13:10:21,875 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 13:10:21,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:21
2025-03-13 13:10:21,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:21,876 [INFO]: 		-> Add: 4.8 seconds
2025-03-13 13:10:21,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:21,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:10:21,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:21
2025-03-13 13:10:21,876 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:21,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:10:21,877 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:21
2025-03-13 13:10:21,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:21,877 [INFO]: 	Creating the index 03/13/2025, 13:10:21
2025-03-13 13:10:21,877 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:21
2025-03-13 13:10:21,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 13:10:21,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:21
2025-03-13 13:10:21,880 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:10:21,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.82it/s]  8%|▊         | 3/36 [00:00<00:04,  8.10it/s] 14%|█▍        | 5/36 [00:00<00:03,  9.18it/s] 19%|█▉        | 7/36 [00:00<00:02,  9.69it/s] 25%|██▌       | 9/36 [00:00<00:02,  9.98it/s] 31%|███       | 11/36 [00:01<00:02, 10.10it/s] 36%|███▌      | 13/36 [00:01<00:02, 10.23it/s] 42%|████▏     | 15/36 [00:01<00:02, 10.23it/s] 47%|████▋     | 17/36 [00:01<00:01, 10.18it/s] 53%|█████▎    | 19/36 [00:01<00:01, 10.11it/s] 58%|█████▊    | 21/36 [00:05<00:10,  1.47it/s] 69%|██████▉   | 25/36 [00:06<00:04,  2.66it/s] 83%|████████▎ | 30/36 [00:06<00:01,  4.63it/s] 94%|█████████▍| 34/36 [00:06<00:00,  6.64it/s]100%|██████████| 36/36 [00:10<00:00,  3.30it/s]
2025-03-13 13:10:32,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:32
2025-03-13 13:12:08,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.9616 secs
2025-03-13 13:12:08,743 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 13:12:08,743 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 13:12:33,737 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9940 secs
2025-03-13 13:12:34,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.5148 secs
2025-03-13 13:12:34,395 [INFO]: {
2025-03-13 13:12:34,395 [INFO]: 	index_key: HNSW15
2025-03-13 13:12:34,395 [INFO]: 	index_param: efSearch=152
2025-03-13 13:12:34,396 [INFO]: 	index_path: knn.index
2025-03-13 13:12:34,396 [INFO]: 	size in bytes: 1708328770
2025-03-13 13:12:34,396 [INFO]: 	avg_search_speed_ms: 8.666030048155443
2025-03-13 13:12:34,396 [INFO]: 	99p_search_speed_ms: 13.50537985097617
2025-03-13 13:12:34,396 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:34,396 [INFO]: 	nb vectors: 8683
2025-03-13 13:12:34,396 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:34,396 [INFO]: 	compression ratio: 0.9993083848842516
2025-03-13 13:12:34,396 [INFO]: }
2025-03-13 13:12:34,396 [INFO]: 	>>> Finished "Creating the index" in 132.5186 secs
2025-03-13 13:12:34,396 [INFO]: >>> Finished "Launching the whole pipeline" in 132.5464 secs
2025-03-13 13:12:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:12:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 74030 [episode count 3/20]
[retrieval_preprocessing] for episode 27200 [episode count 4/20], we have num_retrieval=np.int64(8708) num_query=np.int64(292)
2025-03-13 13:12:37,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:12:38,787 [INFO]: Launching the whole pipeline 03/13/2025, 13:12:38
2025-03-13 13:12:38,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:12:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 991.33it/s]
2025-03-13 13:12:38,824 [INFO]: There are 8708 embeddings of dim 49152
2025-03-13 13:12:38,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 13:12:38,825 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:12:38
2025-03-13 13:12:38,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:12:38,825 [INFO]: 		-> Add: 4.8 seconds
2025-03-13 13:12:38,825 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:12:38,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:12:38,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:12:38
2025-03-13 13:12:38,826 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:12:38,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:12:38,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:12:38
2025-03-13 13:12:38,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:12:38,827 [INFO]: 	Creating the index 03/13/2025, 13:12:38
2025-03-13 13:12:38,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:12:38
2025-03-13 13:12:38,830 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 13:12:38,831 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:12:38
2025-03-13 13:12:38,831 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:12:38,831 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:03,  8.93it/s] 19%|█▉        | 7/36 [00:00<00:00, 35.51it/s] 36%|███▌      | 13/36 [00:00<00:00, 42.96it/s] 53%|█████▎    | 19/36 [00:00<00:00, 47.02it/s] 67%|██████▋   | 24/36 [00:04<00:03,  3.39it/s] 86%|████████▌ | 31/36 [00:04<00:00,  5.53it/s]100%|██████████| 36/36 [00:07<00:00,  3.17it/s]100%|██████████| 36/36 [00:07<00:00,  4.60it/s]
2025-03-13 13:12:46,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:46
2025-03-13 13:14:05,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1356 secs
2025-03-13 13:14:05,792 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 13:14:05,792 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.85it/s]
2025-03-13 13:14:36,904 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1118 secs
2025-03-13 13:14:36,906 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.0753 secs
2025-03-13 13:14:36,906 [INFO]: {
2025-03-13 13:14:36,906 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:36,906 [INFO]: 	index_param: efSearch=220
2025-03-13 13:14:36,906 [INFO]: 	index_path: knn.index
2025-03-13 13:14:36,906 [INFO]: 	size in bytes: 1713247270
2025-03-13 13:14:36,906 [INFO]: 	avg_search_speed_ms: 12.283425460368193
2025-03-13 13:14:36,906 [INFO]: 	99p_search_speed_ms: 17.375061102211475
2025-03-13 13:14:36,906 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:36,906 [INFO]: 	nb vectors: 8708
2025-03-13 13:14:36,906 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:36,906 [INFO]: 	compression ratio: 0.9993084442504321
2025-03-13 13:14:36,906 [INFO]: }
2025-03-13 13:14:36,906 [INFO]: 	>>> Finished "Creating the index" in 118.0798 secs
2025-03-13 13:14:36,907 [INFO]: >>> Finished "Launching the whole pipeline" in 118.1190 secs
2025-03-13 13:14:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 27200 [episode count 4/20]
[retrieval_preprocessing] for episode 12893 [episode count 5/20], we have num_retrieval=np.int64(8530) num_query=np.int64(470)
2025-03-13 13:14:40,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:14:41,837 [INFO]: Launching the whole pipeline 03/13/2025, 13:14:41
2025-03-13 13:14:41,837 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:14:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1090.00it/s]
2025-03-13 13:14:41,864 [INFO]: There are 8530 embeddings of dim 49152
2025-03-13 13:14:41,864 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 13:14:41,864 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:14:41
2025-03-13 13:14:41,864 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:14:41,864 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:14:41,864 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:14:41,864 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:14:41,864 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:14:41
2025-03-13 13:14:41,865 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:14:41,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:14:41,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:14:41
2025-03-13 13:14:41,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:14:41,865 [INFO]: 	Creating the index 03/13/2025, 13:14:41
2025-03-13 13:14:41,865 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:14:41
2025-03-13 13:14:41,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:14:41,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:14:41
2025-03-13 13:14:41,866 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:14:41,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.64it/s] 14%|█▍        | 5/35 [00:00<00:01, 27.05it/s] 29%|██▊       | 10/35 [00:00<00:00, 37.35it/s] 46%|████▌     | 16/35 [00:00<00:00, 43.72it/s] 60%|██████    | 21/35 [00:04<00:04,  3.28it/s] 77%|███████▋  | 27/35 [00:04<00:01,  5.19it/s] 94%|█████████▍| 33/35 [00:04<00:00,  7.71it/s]100%|██████████| 35/35 [00:07<00:00,  4.71it/s]
2025-03-13 13:14:49,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:14:49
2025-03-13 13:16:07,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0477 secs
2025-03-13 13:16:07,347 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 13:16:07,347 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 13:16:38,335 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9885 secs
2025-03-13 13:16:39,070 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.2037 secs
2025-03-13 13:16:39,070 [INFO]: {
2025-03-13 13:16:39,070 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:39,070 [INFO]: 	index_param: efSearch=183
2025-03-13 13:16:39,070 [INFO]: 	index_path: knn.index
2025-03-13 13:16:39,070 [INFO]: 	size in bytes: 1678226950
2025-03-13 13:16:39,070 [INFO]: 	avg_search_speed_ms: 11.141346075534738
2025-03-13 13:16:39,070 [INFO]: 	99p_search_speed_ms: 18.941601114347577
2025-03-13 13:16:39,071 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:39,071 [INFO]: 	nb vectors: 8530
2025-03-13 13:16:39,071 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:39,071 [INFO]: 	compression ratio: 0.9993083712545553
2025-03-13 13:16:39,071 [INFO]: }
2025-03-13 13:16:39,071 [INFO]: 	>>> Finished "Creating the index" in 117.2061 secs
2025-03-13 13:16:39,071 [INFO]: >>> Finished "Launching the whole pipeline" in 117.2342 secs
2025-03-13 13:16:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 12893 [episode count 5/20]
[retrieval_preprocessing] for episode 27184 [episode count 6/20], we have num_retrieval=np.int64(8526) num_query=np.int64(474)
2025-03-13 13:16:43,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:44,807 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:44
2025-03-13 13:16:44,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.24it/s]
2025-03-13 13:16:44,837 [INFO]: There are 8526 embeddings of dim 49152
2025-03-13 13:16:44,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 13:16:44,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:44
2025-03-13 13:16:44,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:44,837 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:16:44,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:44,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:16:44,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:44
2025-03-13 13:16:44,838 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:44,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:16:44,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:44
2025-03-13 13:16:44,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:44,838 [INFO]: 	Creating the index 03/13/2025, 13:16:44
2025-03-13 13:16:44,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:44
2025-03-13 13:16:44,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:16:44,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:44
2025-03-13 13:16:44,839 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:16:44,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  8.05it/s] 17%|█▋        | 6/35 [00:00<00:00, 29.19it/s] 31%|███▏      | 11/35 [00:00<00:00, 37.66it/s] 46%|████▌     | 16/35 [00:00<00:00, 41.99it/s] 60%|██████    | 21/35 [00:04<00:04,  3.05it/s] 74%|███████▍  | 26/35 [00:04<00:01,  4.58it/s] 91%|█████████▏| 32/35 [00:04<00:00,  6.99it/s]100%|██████████| 35/35 [00:08<00:00,  4.23it/s]
2025-03-13 13:16:53,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:53
2025-03-13 13:17:59,765 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.6448 secs
2025-03-13 13:17:59,765 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 13:17:59,765 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 13:18:43,790 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0242 secs
2025-03-13 13:18:43,792 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.9523 secs
2025-03-13 13:18:43,792 [INFO]: {
2025-03-13 13:18:43,792 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:43,792 [INFO]: 	index_param: efSearch=227
2025-03-13 13:18:43,792 [INFO]: 	index_path: knn.index
2025-03-13 13:18:43,792 [INFO]: 	size in bytes: 1677439990
2025-03-13 13:18:43,792 [INFO]: 	avg_search_speed_ms: 13.317065534508043
2025-03-13 13:18:43,792 [INFO]: 	99p_search_speed_ms: 22.68685947638005
2025-03-13 13:18:43,792 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:43,792 [INFO]: 	nb vectors: 8526
2025-03-13 13:18:43,792 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:43,792 [INFO]: 	compression ratio: 0.9993083615468116
2025-03-13 13:18:43,792 [INFO]: }
2025-03-13 13:18:43,792 [INFO]: 	>>> Finished "Creating the index" in 118.9541 secs
2025-03-13 13:18:43,792 [INFO]: >>> Finished "Launching the whole pipeline" in 118.9849 secs
2025-03-13 13:18:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 27184 [episode count 6/20]
[retrieval_preprocessing] for episode 86668 [episode count 7/20], we have num_retrieval=np.int64(8280) num_query=np.int64(720)
2025-03-13 13:18:49,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:52,370 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:52
2025-03-13 13:18:52,370 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-13 13:18:52,407 [INFO]: There are 8280 embeddings of dim 49152
2025-03-13 13:18:52,407 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 13:18:52,407 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:52
2025-03-13 13:18:52,407 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:52,407 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 13:18:52,408 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:18:52,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:18:52,408 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:52
2025-03-13 13:18:52,408 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:52,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:18:52,408 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:52
2025-03-13 13:18:52,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:52,408 [INFO]: 	Creating the index 03/13/2025, 13:18:52
2025-03-13 13:18:52,408 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:18:52
2025-03-13 13:18:52,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:18:52,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:52
2025-03-13 13:18:52,409 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 13:18:52,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.66it/s] 15%|█▍        | 5/34 [00:00<00:01, 23.64it/s] 26%|██▋       | 9/34 [00:00<00:00, 30.24it/s] 38%|███▊      | 13/34 [00:00<00:00, 33.83it/s] 50%|█████     | 17/34 [00:00<00:00, 35.79it/s] 62%|██████▏   | 21/34 [00:05<00:06,  2.10it/s] 74%|███████▎  | 25/34 [00:05<00:02,  3.08it/s] 88%|████████▊ | 30/34 [00:05<00:00,  4.72it/s]100%|██████████| 34/34 [00:10<00:00,  2.07it/s]100%|██████████| 34/34 [00:10<00:00,  3.27it/s]
2025-03-13 13:19:02,975 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:02
2025-03-13 13:20:20,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1525 secs
2025-03-13 13:20:20,128 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 13:20:20,128 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 13:20:44,012 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8831 secs
2025-03-13 13:20:44,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.6046 secs
2025-03-13 13:20:44,014 [INFO]: {
2025-03-13 13:20:44,014 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:44,014 [INFO]: 	index_param: efSearch=206
2025-03-13 13:20:44,014 [INFO]: 	index_path: knn.index
2025-03-13 13:20:44,014 [INFO]: 	size in bytes: 1629041050
2025-03-13 13:20:44,014 [INFO]: 	avg_search_speed_ms: 11.323439672701102
2025-03-13 13:20:44,014 [INFO]: 	99p_search_speed_ms: 16.24526518862693
2025-03-13 13:20:44,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:44,014 [INFO]: 	nb vectors: 8280
2025-03-13 13:20:44,014 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:44,014 [INFO]: 	compression ratio: 0.9993082985846182
2025-03-13 13:20:44,014 [INFO]: }
2025-03-13 13:20:44,014 [INFO]: 	>>> Finished "Creating the index" in 111.6063 secs
2025-03-13 13:20:44,014 [INFO]: >>> Finished "Launching the whole pipeline" in 111.6438 secs
2025-03-13 13:20:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 86668 [episode count 7/20]
[retrieval_preprocessing] for episode 17282 [episode count 8/20], we have num_retrieval=np.int64(8511) num_query=np.int64(489)
2025-03-13 13:20:50,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:52,083 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:52
2025-03-13 13:20:52,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 13:20:52,110 [INFO]: There are 8511 embeddings of dim 49152
2025-03-13 13:20:52,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 13:20:52,111 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:52
2025-03-13 13:20:52,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:52,111 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:20:52,111 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:52,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:20:52,111 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:52
2025-03-13 13:20:52,111 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:52,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:20:52,111 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:52
2025-03-13 13:20:52,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:52,111 [INFO]: 	Creating the index 03/13/2025, 13:20:52
2025-03-13 13:20:52,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:52
2025-03-13 13:20:52,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:20:52,113 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:52
2025-03-13 13:20:52,113 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:20:52,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.14it/s] 17%|█▋        | 6/35 [00:00<00:01, 28.49it/s] 31%|███▏      | 11/35 [00:00<00:00, 37.27it/s] 46%|████▌     | 16/35 [00:00<00:00, 41.95it/s] 60%|██████    | 21/35 [00:04<00:04,  2.88it/s] 77%|███████▋  | 27/35 [00:04<00:01,  4.61it/s] 94%|█████████▍| 33/35 [00:04<00:00,  6.92it/s]100%|██████████| 35/35 [00:08<00:00,  4.09it/s]
2025-03-13 13:21:00,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:00
2025-03-13 13:22:19,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1188 secs
2025-03-13 13:22:19,790 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 13:22:19,790 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-13 13:22:44,650 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8595 secs
2025-03-13 13:22:44,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.5393 secs
2025-03-13 13:22:44,652 [INFO]: {
2025-03-13 13:22:44,652 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:44,652 [INFO]: 	index_param: efSearch=189
2025-03-13 13:22:44,652 [INFO]: 	index_path: knn.index
2025-03-13 13:22:44,652 [INFO]: 	size in bytes: 1674488890
2025-03-13 13:22:44,652 [INFO]: 	avg_search_speed_ms: 9.258371540259018
2025-03-13 13:22:44,652 [INFO]: 	99p_search_speed_ms: 14.277849358040841
2025-03-13 13:22:44,652 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:44,652 [INFO]: 	nb vectors: 8511
2025-03-13 13:22:44,652 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:44,652 [INFO]: 	compression ratio: 0.9993083250615058
2025-03-13 13:22:44,652 [INFO]: }
2025-03-13 13:22:44,652 [INFO]: 	>>> Finished "Creating the index" in 112.5409 secs
2025-03-13 13:22:44,652 [INFO]: >>> Finished "Launching the whole pipeline" in 112.5693 secs
2025-03-13 13:22:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 17282 [episode count 8/20]
[retrieval_preprocessing] for episode 25339 [episode count 9/20], we have num_retrieval=np.int64(8515) num_query=np.int64(485)
2025-03-13 13:22:49,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:50,530 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:50
2025-03-13 13:22:50,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1740.38it/s]
2025-03-13 13:22:50,557 [INFO]: There are 8515 embeddings of dim 49152
2025-03-13 13:22:50,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 13:22:50,558 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:50
2025-03-13 13:22:50,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:50,558 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:22:50,558 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:22:50,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:22:50,558 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:50
2025-03-13 13:22:50,558 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:50,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:22:50,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:50
2025-03-13 13:22:50,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:50,558 [INFO]: 	Creating the index 03/13/2025, 13:22:50
2025-03-13 13:22:50,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:22:50
2025-03-13 13:22:50,559 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:22:50,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:50
2025-03-13 13:22:50,560 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:22:50,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  8.58it/s] 17%|█▋        | 6/35 [00:00<00:00, 30.51it/s] 34%|███▍      | 12/35 [00:00<00:00, 40.03it/s] 51%|█████▏    | 18/35 [00:00<00:00, 44.37it/s] 66%|██████▌   | 23/35 [00:04<00:03,  3.03it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.69it/s] 83%|████████▎ | 29/35 [00:05<00:01,  4.51it/s] 91%|█████████▏| 32/35 [00:05<00:00,  5.34it/s] 97%|█████████▋| 34/35 [00:05<00:00,  5.99it/s]100%|██████████| 35/35 [00:10<00:00,  3.35it/s]
2025-03-13 13:23:01,026 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:01
2025-03-13 13:24:21,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.8483 secs
2025-03-13 13:24:21,876 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 13:24:21,876 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-13 13:24:47,778 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9022 secs
2025-03-13 13:24:47,781 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.2215 secs
2025-03-13 13:24:47,781 [INFO]: {
2025-03-13 13:24:47,781 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:47,781 [INFO]: 	index_param: efSearch=160
2025-03-13 13:24:47,781 [INFO]: 	index_path: knn.index
2025-03-13 13:24:47,781 [INFO]: 	size in bytes: 1675275850
2025-03-13 13:24:47,781 [INFO]: 	avg_search_speed_ms: 10.73260347272945
2025-03-13 13:24:47,781 [INFO]: 	99p_search_speed_ms: 15.084440645296121
2025-03-13 13:24:47,781 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:47,781 [INFO]: 	nb vectors: 8515
2025-03-13 13:24:47,781 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:47,782 [INFO]: 	compression ratio: 0.9993083348034892
2025-03-13 13:24:47,782 [INFO]: }
2025-03-13 13:24:47,782 [INFO]: 	>>> Finished "Creating the index" in 117.2233 secs
2025-03-13 13:24:47,782 [INFO]: >>> Finished "Launching the whole pipeline" in 117.2519 secs
2025-03-13 13:24:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 25339 [episode count 9/20]
[retrieval_preprocessing] for episode 78099 [episode count 10/20], we have num_retrieval=np.int64(8703) num_query=np.int64(297)
2025-03-13 13:24:53,072 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:54,422 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:54
2025-03-13 13:24:54,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1342.61it/s]
2025-03-13 13:24:54,450 [INFO]: There are 8703 embeddings of dim 49152
2025-03-13 13:24:54,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 13:24:54,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:54
2025-03-13 13:24:54,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:54,451 [INFO]: 		-> Add: 4.8 seconds
2025-03-13 13:24:54,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:54,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 13:24:54,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:54
2025-03-13 13:24:54,451 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:54,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:24:54,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:54
2025-03-13 13:24:54,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:54,451 [INFO]: 	Creating the index 03/13/2025, 13:24:54
2025-03-13 13:24:54,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:54
2025-03-13 13:24:54,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:24:54,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:54
2025-03-13 13:24:54,452 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:24:54,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:04,  7.91it/s] 17%|█▋        | 6/36 [00:00<00:01, 27.31it/s] 31%|███       | 11/36 [00:00<00:00, 36.42it/s] 44%|████▍     | 16/36 [00:00<00:00, 41.28it/s] 58%|█████▊    | 21/36 [00:04<00:04,  3.29it/s] 75%|███████▌  | 27/36 [00:04<00:01,  5.25it/s] 89%|████████▉ | 32/36 [00:04<00:00,  7.36it/s]100%|██████████| 36/36 [00:07<00:00,  3.15it/s]100%|██████████| 36/36 [00:07<00:00,  4.71it/s]
2025-03-13 13:25:02,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:02
2025-03-13 13:26:13,544 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.4482 secs
2025-03-13 13:26:13,544 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 13:26:13,544 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-13 13:26:43,895 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3504 secs
2025-03-13 13:26:44,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.9497 secs
2025-03-13 13:26:44,403 [INFO]: {
2025-03-13 13:26:44,403 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:44,403 [INFO]: 	index_param: efSearch=209
2025-03-13 13:26:44,403 [INFO]: 	index_path: knn.index
2025-03-13 13:26:44,403 [INFO]: 	size in bytes: 1712263570
2025-03-13 13:26:44,403 [INFO]: 	avg_search_speed_ms: 12.351906976524603
2025-03-13 13:26:44,403 [INFO]: 	99p_search_speed_ms: 17.223669439554214
2025-03-13 13:26:44,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:44,403 [INFO]: 	nb vectors: 8703
2025-03-13 13:26:44,403 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:44,403 [INFO]: 	compression ratio: 0.9993084324044809
2025-03-13 13:26:44,403 [INFO]: }
2025-03-13 13:26:44,403 [INFO]: 	>>> Finished "Creating the index" in 109.9519 secs
2025-03-13 13:26:44,403 [INFO]: >>> Finished "Launching the whole pipeline" in 109.9816 secs
2025-03-13 13:26:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 78099 [episode count 10/20]
[retrieval_preprocessing] for episode 9201 [episode count 11/20], we have num_retrieval=np.int64(8464) num_query=np.int64(536)
2025-03-13 13:26:48,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:49,266 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:49
2025-03-13 13:26:49,266 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.58it/s]
2025-03-13 13:26:49,296 [INFO]: There are 8464 embeddings of dim 49152
2025-03-13 13:26:49,296 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 13:26:49,296 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:49
2025-03-13 13:26:49,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:49,297 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 13:26:49,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:49,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:26:49,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:49
2025-03-13 13:26:49,297 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:49,297 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:26:49,297 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:49
2025-03-13 13:26:49,297 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:49,297 [INFO]: 	Creating the index 03/13/2025, 13:26:49
2025-03-13 13:26:49,297 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:49
2025-03-13 13:26:49,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:26:49,298 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:49
2025-03-13 13:26:49,298 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:26:49,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.17it/s] 14%|█▍        | 5/35 [00:00<00:01, 23.18it/s] 29%|██▊       | 10/35 [00:00<00:00, 32.08it/s] 43%|████▎     | 15/35 [00:00<00:00, 36.48it/s] 57%|█████▋    | 20/35 [00:00<00:00, 38.86it/s] 69%|██████▊   | 24/35 [00:04<00:03,  2.97it/s] 83%|████████▎ | 29/35 [00:04<00:01,  4.48it/s] 97%|█████████▋| 34/35 [00:04<00:00,  6.47it/s]100%|██████████| 35/35 [00:08<00:00,  3.89it/s]
2025-03-13 13:26:58,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:58
2025-03-13 13:28:14,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.0410 secs
2025-03-13 13:28:14,340 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 13:28:14,341 [INFO]: 	Compute fast metrics 03/13/2025, 13:28:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.36it/s]
2025-03-13 13:28:36,320 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9795 secs
2025-03-13 13:28:36,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.0239 secs
2025-03-13 13:28:36,322 [INFO]: {
2025-03-13 13:28:36,322 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:36,322 [INFO]: 	index_param: efSearch=175
2025-03-13 13:28:36,322 [INFO]: 	index_path: knn.index
2025-03-13 13:28:36,322 [INFO]: 	size in bytes: 1665241810
2025-03-13 13:28:36,322 [INFO]: 	avg_search_speed_ms: 9.205089417855644
2025-03-13 13:28:36,322 [INFO]: 	99p_search_speed_ms: 13.928372727241374
2025-03-13 13:28:36,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:36,322 [INFO]: 	nb vectors: 8464
2025-03-13 13:28:36,322 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:36,322 [INFO]: 	compression ratio: 0.9993083899328711
2025-03-13 13:28:36,322 [INFO]: }
2025-03-13 13:28:36,322 [INFO]: 	>>> Finished "Creating the index" in 107.0253 secs
2025-03-13 13:28:36,322 [INFO]: >>> Finished "Launching the whole pipeline" in 107.0564 secs
2025-03-13 13:28:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 9201 [episode count 11/20]
[retrieval_preprocessing] for episode 65193 [episode count 12/20], we have num_retrieval=np.int64(8611) num_query=np.int64(389)
2025-03-13 13:28:41,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:42,681 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:42
2025-03-13 13:28:42,681 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.25it/s]
2025-03-13 13:28:42,706 [INFO]: There are 8611 embeddings of dim 49152
2025-03-13 13:28:42,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 13:28:42,706 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:42
2025-03-13 13:28:42,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:42,707 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:28:42,707 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:42,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:42,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:42
2025-03-13 13:28:42,707 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:42,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:28:42,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:42
2025-03-13 13:28:42,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:42,707 [INFO]: 	Creating the index 03/13/2025, 13:28:42
2025-03-13 13:28:42,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:42
2025-03-13 13:28:42,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:28:42,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:42
2025-03-13 13:28:42,708 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:28:42,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  8.51it/s] 14%|█▍        | 5/35 [00:00<00:01, 24.96it/s] 31%|███▏      | 11/35 [00:00<00:00, 38.48it/s] 49%|████▊     | 17/35 [00:00<00:00, 44.94it/s] 63%|██████▎   | 22/35 [00:04<00:03,  3.66it/s] 80%|████████  | 28/35 [00:04<00:01,  5.69it/s] 94%|█████████▍| 33/35 [00:04<00:00,  7.84it/s]100%|██████████| 35/35 [00:07<00:00,  4.43it/s]
2025-03-13 13:28:50,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:50
