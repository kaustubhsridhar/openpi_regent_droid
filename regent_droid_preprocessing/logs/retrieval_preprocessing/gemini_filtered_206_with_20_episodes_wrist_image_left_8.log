nohup: ignoring input
2025-03-13 10:51:21: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:51:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5539130832_stack_cups [chosen_id count 0/260]
2025-03-13 10:51:32: [retrieval_preprocessing] we have num_total=5788 embedding_dim=49152
[retrieval_preprocessing] for episode 81431 [episode count 0/20], we have num_retrieval=np.int64(5501) num_query=np.int64(287)
2025-03-13 10:51:35,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:36,845 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:36
2025-03-13 10:51:36,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 439.61it/s]
2025-03-13 10:51:36,904 [INFO]: There are 5501 embeddings of dim 49152
2025-03-13 10:51:36,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0593 secs
2025-03-13 10:51:36,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:36
2025-03-13 10:51:36,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:36,904 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:51:36,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:36,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:51:36,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:36
2025-03-13 10:51:36,905 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:36,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-13 10:51:36,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:36
2025-03-13 10:51:36,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:36,906 [INFO]: 	Creating the index 03/13/2025, 10:51:36
2025-03-13 10:51:36,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:36
2025-03-13 10:51:36,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 10:51:36,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:36
2025-03-13 10:51:36,908 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:51:36,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  9%|▊         | 2/23 [00:00<00:01, 17.33it/s]
 30%|███       | 7/23 [00:00<00:00, 33.44it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 38.30it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 20.86it/s]
 83%|████████▎ | 19/23 [00:00<00:00, 22.81it/s]
 96%|█████████▌| 22/23 [00:05<00:00,  1.89it/s]
100%|██████████| 23/23 [00:07<00:00,  3.13it/s]
2025-03-13 10:51:44,264 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:44
2025-03-13 10:52:44,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.1072 secs
2025-03-13 10:52:44,372 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 10:52:44,372 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:44

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]
2025-03-13 10:52:59,281 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9092 secs
2025-03-13 10:52:59,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3744 secs
2025-03-13 10:52:59,282 [INFO]: {
2025-03-13 10:52:59,282 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:59,282 [INFO]: 	index_param: efSearch=174
2025-03-13 10:52:59,282 [INFO]: 	index_path: knn.index
2025-03-13 10:52:59,282 [INFO]: 	size in bytes: 1082289550
2025-03-13 10:52:59,282 [INFO]: 	avg_search_speed_ms: 11.081032770565182
2025-03-13 10:52:59,282 [INFO]: 	99p_search_speed_ms: 16.148696104064587
2025-03-13 10:52:59,282 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:59,282 [INFO]: 	nb vectors: 5501
2025-03-13 10:52:59,282 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:59,282 [INFO]: 	compression ratio: 0.9993080021885086
2025-03-13 10:52:59,282 [INFO]: }
2025-03-13 10:52:59,282 [INFO]: 	>>> Finished "Creating the index" in 82.3768 secs
2025-03-13 10:52:59,283 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4378 secs
2025-03-13 10:53:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 81431 [episode count 0/20]
[retrieval_preprocessing] for episode 67611 [episode count 1/20], we have num_retrieval=np.int64(5404) num_query=np.int64(384)
2025-03-13 10:53:02,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:03,278 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:03
2025-03-13 10:53:03,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:03

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 807.22it/s]
2025-03-13 10:53:03,311 [INFO]: There are 5404 embeddings of dim 49152
2025-03-13 10:53:03,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 10:53:03,312 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:03
2025-03-13 10:53:03,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:03,312 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:53:03,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:03,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:53:03,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:03
2025-03-13 10:53:03,313 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:03,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 10:53:03,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:03
2025-03-13 10:53:03,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:03,314 [INFO]: 	Creating the index 03/13/2025, 10:53:03
2025-03-13 10:53:03,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:03
2025-03-13 10:53:03,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:53:03,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:03
2025-03-13 10:53:03,318 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:53:03,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  8.95it/s]
 22%|██▏       | 5/23 [00:00<00:00, 25.58it/s]
 39%|███▉      | 9/23 [00:00<00:00, 31.39it/s]
 57%|█████▋    | 13/23 [00:00<00:00, 33.97it/s]
 74%|███████▍  | 17/23 [00:00<00:00, 36.01it/s]
 91%|█████████▏| 21/23 [00:05<00:00,  2.05it/s]
100%|██████████| 23/23 [00:07<00:00,  3.27it/s]
2025-03-13 10:53:10,368 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:10
2025-03-13 10:54:08,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.6243 secs
2025-03-13 10:54:08,993 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 10:54:08,993 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:08

  0%|          | 0/4 [00:00<?, ?it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 24.68it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.64it/s]
2025-03-13 10:54:21,812 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8191 secs
2025-03-13 10:54:21,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4951 secs
2025-03-13 10:54:21,813 [INFO]: {
2025-03-13 10:54:21,813 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:21,813 [INFO]: 	index_param: efSearch=154
2025-03-13 10:54:21,813 [INFO]: 	index_path: knn.index
2025-03-13 10:54:21,813 [INFO]: 	size in bytes: 1063205350
2025-03-13 10:54:21,813 [INFO]: 	avg_search_speed_ms: 10.196633991774904
2025-03-13 10:54:21,813 [INFO]: 	99p_search_speed_ms: 14.173041936010122
2025-03-13 10:54:21,813 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:21,813 [INFO]: 	nb vectors: 5404
2025-03-13 10:54:21,813 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:21,813 [INFO]: 	compression ratio: 0.9993080189071659
2025-03-13 10:54:21,813 [INFO]: }
2025-03-13 10:54:21,813 [INFO]: 	>>> Finished "Creating the index" in 78.4990 secs
2025-03-13 10:54:21,813 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5348 secs
2025-03-13 10:54:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 67611 [episode count 1/20]
[retrieval_preprocessing] for episode 73757 [episode count 2/20], we have num_retrieval=np.int64(5448) num_query=np.int64(340)
2025-03-13 10:54:25,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:26,382 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:26
2025-03-13 10:54:26,382 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:26

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 995.80it/s]
2025-03-13 10:54:26,411 [INFO]: There are 5448 embeddings of dim 49152
2025-03-13 10:54:26,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 10:54:26,412 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,412 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:26,412 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:54:26,412 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:26,412 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:26,412 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,412 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:26,412 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:54:26,412 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:26
2025-03-13 10:54:26,412 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:26,412 [INFO]: 	Creating the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,412 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:26
2025-03-13 10:54:26,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:54:26,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,413 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:54:26,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.97it/s]
 26%|██▌       | 6/23 [00:00<00:00, 27.72it/s]
 48%|████▊     | 11/23 [00:00<00:00, 36.18it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 39.56it/s]
 91%|█████████▏| 21/23 [00:06<00:00,  2.14it/s]
100%|██████████| 23/23 [00:07<00:00,  3.08it/s]
2025-03-13 10:54:33,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:33
2025-03-13 10:55:24,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.5407 secs
2025-03-13 10:55:24,428 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 10:55:24,428 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:24

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.87it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 10:55:37,417 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9889 secs
2025-03-13 10:55:37,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0049 secs
2025-03-13 10:55:37,418 [INFO]: {
2025-03-13 10:55:37,418 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:37,418 [INFO]: 	index_param: efSearch=160
2025-03-13 10:55:37,418 [INFO]: 	index_path: knn.index
2025-03-13 10:55:37,418 [INFO]: 	size in bytes: 1071862030
2025-03-13 10:55:37,418 [INFO]: 	avg_search_speed_ms: 11.213336682840847
2025-03-13 10:55:37,418 [INFO]: 	99p_search_speed_ms: 16.247302831616256
2025-03-13 10:55:37,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:37,418 [INFO]: 	nb vectors: 5448
2025-03-13 10:55:37,418 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:37,418 [INFO]: 	compression ratio: 0.9993080769919613
2025-03-13 10:55:37,418 [INFO]: }
2025-03-13 10:55:37,418 [INFO]: 	>>> Finished "Creating the index" in 71.0063 secs
2025-03-13 10:55:37,419 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0361 secs
2025-03-13 10:55:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 73757 [episode count 2/20]
[retrieval_preprocessing] for episode 14375 [episode count 3/20], we have num_retrieval=np.int64(5556) num_query=np.int64(232)
2025-03-13 10:55:40,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:41,143 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:41
2025-03-13 10:55:41,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:41

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1258.04it/s]
2025-03-13 10:55:41,173 [INFO]: There are 5556 embeddings of dim 49152
2025-03-13 10:55:41,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 10:55:41,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:41
2025-03-13 10:55:41,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:41,175 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 10:55:41,175 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:41,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:55:41,175 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:41
2025-03-13 10:55:41,175 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:41,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:55:41,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:41
2025-03-13 10:55:41,176 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:41,176 [INFO]: 	Creating the index 03/13/2025, 10:55:41
2025-03-13 10:55:41,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:41
2025-03-13 10:55:41,179 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:55:41,180 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:41
2025-03-13 10:55:41,180 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:55:41,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  9%|▊         | 2/23 [00:00<00:01, 17.88it/s]
 30%|███       | 7/23 [00:00<00:00, 33.97it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 39.34it/s]
 74%|███████▍  | 17/23 [00:00<00:00, 41.95it/s]
 96%|█████████▌| 22/23 [00:05<00:00,  2.61it/s]
100%|██████████| 23/23 [00:06<00:00,  3.57it/s]
2025-03-13 10:55:47,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:47
2025-03-13 10:56:45,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8158 secs
2025-03-13 10:56:45,449 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 10:56:45,449 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:45

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-13 10:56:58,462 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0121 secs
2025-03-13 10:56:58,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.2827 secs
2025-03-13 10:56:58,462 [INFO]: {
2025-03-13 10:56:58,462 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:58,463 [INFO]: 	index_param: efSearch=168
2025-03-13 10:56:58,463 [INFO]: 	index_path: knn.index
2025-03-13 10:56:58,463 [INFO]: 	size in bytes: 1093110430
2025-03-13 10:56:58,463 [INFO]: 	avg_search_speed_ms: 11.09338771993761
2025-03-13 10:56:58,463 [INFO]: 	99p_search_speed_ms: 17.57497927872464
2025-03-13 10:56:58,463 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:58,463 [INFO]: 	nb vectors: 5556
2025-03-13 10:56:58,463 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:58,463 [INFO]: 	compression ratio: 0.9993080461230253
2025-03-13 10:56:58,463 [INFO]: }
2025-03-13 10:56:58,463 [INFO]: 	>>> Finished "Creating the index" in 77.2867 secs
2025-03-13 10:56:58,463 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3197 secs
2025-03-13 10:56:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 14375 [episode count 3/20]
[retrieval_preprocessing] for episode 53288 [episode count 4/20], we have num_retrieval=np.int64(5447) num_query=np.int64(341)
2025-03-13 10:57:00,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:01,443 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:01
2025-03-13 10:57:01,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:01

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-13 10:57:01,467 [INFO]: There are 5447 embeddings of dim 49152
2025-03-13 10:57:01,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 10:57:01,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:01
2025-03-13 10:57:01,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:01,467 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:57:01,467 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:01,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:01,467 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:01
2025-03-13 10:57:01,467 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:01,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:01,467 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:01
2025-03-13 10:57:01,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:01,468 [INFO]: 	Creating the index 03/13/2025, 10:57:01
2025-03-13 10:57:01,468 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:01
2025-03-13 10:57:01,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:57:01,469 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:01
2025-03-13 10:57:01,469 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:57:01,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  7.91it/s]
 26%|██▌       | 6/23 [00:00<00:00, 30.16it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 40.13it/s]
 78%|███████▊  | 18/23 [00:00<00:00, 44.46it/s]
100%|██████████| 23/23 [00:06<00:00,  2.31it/s]
100%|██████████| 23/23 [00:06<00:00,  3.61it/s]
2025-03-13 10:57:07,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:07
2025-03-13 10:58:01,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6674 secs
2025-03-13 10:58:01,506 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 10:58:01,506 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:01

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.87it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 10:58:14,131 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6257 secs
2025-03-13 10:58:14,132 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6636 secs
2025-03-13 10:58:14,132 [INFO]: {
2025-03-13 10:58:14,132 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:14,132 [INFO]: 	index_param: efSearch=178
2025-03-13 10:58:14,132 [INFO]: 	index_path: knn.index
2025-03-13 10:58:14,132 [INFO]: 	size in bytes: 1071665290
2025-03-13 10:58:14,132 [INFO]: 	avg_search_speed_ms: 10.384555497213517
2025-03-13 10:58:14,132 [INFO]: 	99p_search_speed_ms: 14.346724785864353
2025-03-13 10:58:14,132 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:14,133 [INFO]: 	nb vectors: 5447
2025-03-13 10:58:14,133 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:14,133 [INFO]: 	compression ratio: 0.9993080731391422
2025-03-13 10:58:14,133 [INFO]: }
2025-03-13 10:58:14,133 [INFO]: 	>>> Finished "Creating the index" in 72.6650 secs
2025-03-13 10:58:14,133 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6895 secs
2025-03-13 10:58:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 53288 [episode count 4/20]
[retrieval_preprocessing] for episode 75303 [episode count 5/20], we have num_retrieval=np.int64(5517) num_query=np.int64(271)
2025-03-13 10:58:17,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:18,231 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:18
2025-03-13 10:58:18,231 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1474.79it/s]
2025-03-13 10:58:18,253 [INFO]: There are 5517 embeddings of dim 49152
2025-03-13 10:58:18,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 10:58:18,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:18,253 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:58:18,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:18,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:18,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,253 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:18,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:18,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:18
2025-03-13 10:58:18,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:18,254 [INFO]: 	Creating the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,254 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:18
2025-03-13 10:58:18,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:58:18,255 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,255 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:58:18,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.30it/s]
 26%|██▌       | 6/23 [00:00<00:00, 25.58it/s]
 48%|████▊     | 11/23 [00:00<00:00, 33.70it/s]
 65%|██████▌   | 15/23 [00:00<00:00, 34.01it/s]
 87%|████████▋ | 20/23 [00:00<00:00, 36.79it/s]
100%|██████████| 23/23 [00:06<00:00,  3.45it/s]
2025-03-13 10:58:24,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:24
2025-03-13 10:59:23,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1115 secs
2025-03-13 10:59:23,043 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 10:59:23,043 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:23

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.36it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.60it/s]
2025-03-13 10:59:36,129 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0862 secs
2025-03-13 10:59:36,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.8756 secs
2025-03-13 10:59:36,130 [INFO]: {
2025-03-13 10:59:36,130 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:36,130 [INFO]: 	index_param: efSearch=159
2025-03-13 10:59:36,130 [INFO]: 	index_path: knn.index
2025-03-13 10:59:36,130 [INFO]: 	size in bytes: 1085437450
2025-03-13 10:59:36,130 [INFO]: 	avg_search_speed_ms: 10.14906129517364
2025-03-13 10:59:36,130 [INFO]: 	99p_search_speed_ms: 20.224442821927358
2025-03-13 10:59:36,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:36,130 [INFO]: 	nb vectors: 5517
2025-03-13 10:59:36,130 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:36,130 [INFO]: 	compression ratio: 0.9993080080293895
2025-03-13 10:59:36,131 [INFO]: }
2025-03-13 10:59:36,131 [INFO]: 	>>> Finished "Creating the index" in 77.8769 secs
2025-03-13 10:59:36,131 [INFO]: >>> Finished "Launching the whole pipeline" in 77.8997 secs
2025-03-13 10:59:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 75303 [episode count 5/20]
[retrieval_preprocessing] for episode 38958 [episode count 6/20], we have num_retrieval=np.int64(5570) num_query=np.int64(218)
2025-03-13 10:59:38,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:39,285 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:39
2025-03-13 10:59:39,285 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:39

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2081.54it/s]
2025-03-13 10:59:39,310 [INFO]: There are 5570 embeddings of dim 49152
2025-03-13 10:59:39,310 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 10:59:39,310 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:39
2025-03-13 10:59:39,310 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:39,310 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 10:59:39,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:39,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:39,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:39
2025-03-13 10:59:39,311 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:39,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:59:39,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:39
2025-03-13 10:59:39,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:39,311 [INFO]: 	Creating the index 03/13/2025, 10:59:39
2025-03-13 10:59:39,311 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:39
2025-03-13 10:59:39,312 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:59:39,312 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:39
2025-03-13 10:59:39,312 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:59:39,312 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  7.96it/s]
 26%|██▌       | 6/23 [00:00<00:00, 29.57it/s]
 48%|████▊     | 11/23 [00:00<00:00, 37.47it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 41.45it/s]
 91%|█████████▏| 21/23 [00:04<00:00,  2.78it/s]
100%|██████████| 23/23 [00:06<00:00,  3.79it/s]
2025-03-13 10:59:45,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:45
2025-03-13 11:00:42,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0659 secs
2025-03-13 11:00:42,453 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 11:00:42,453 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:42

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.42it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.04it/s]
2025-03-13 11:00:57,661 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2076 secs
2025-03-13 11:00:57,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3497 secs
2025-03-13 11:00:57,662 [INFO]: {
2025-03-13 11:00:57,662 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:57,662 [INFO]: 	index_param: efSearch=175
2025-03-13 11:00:57,662 [INFO]: 	index_path: knn.index
2025-03-13 11:00:57,662 [INFO]: 	size in bytes: 1095864910
2025-03-13 11:00:57,662 [INFO]: 	avg_search_speed_ms: 12.961231546363084
2025-03-13 11:00:57,662 [INFO]: 	99p_search_speed_ms: 24.26693069748579
2025-03-13 11:00:57,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:57,662 [INFO]: 	nb vectors: 5570
2025-03-13 11:00:57,662 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:57,662 [INFO]: 	compression ratio: 0.9993079895221757
2025-03-13 11:00:57,662 [INFO]: }
2025-03-13 11:00:57,662 [INFO]: 	>>> Finished "Creating the index" in 78.3513 secs
2025-03-13 11:00:57,662 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3771 secs
2025-03-13 11:00:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 38958 [episode count 6/20]
[retrieval_preprocessing] for episode 3119 [episode count 7/20], we have num_retrieval=np.int64(5595) num_query=np.int64(193)
2025-03-13 11:01:01,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:02,510 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:02
2025-03-13 11:01:02,510 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:02

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1346.05it/s]
2025-03-13 11:01:02,539 [INFO]: There are 5595 embeddings of dim 49152
2025-03-13 11:01:02,539 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:01:02,539 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:02
2025-03-13 11:01:02,540 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:02,540 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:01:02,540 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:02,540 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:01:02,540 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:02
2025-03-13 11:01:02,541 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:02,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:01:02,541 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:02
2025-03-13 11:01:02,541 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:02,542 [INFO]: 	Creating the index 03/13/2025, 11:01:02
2025-03-13 11:01:02,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:02
2025-03-13 11:01:02,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:01:02,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:02
2025-03-13 11:01:02,546 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:01:02,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/24 [00:00<?, ?it/s]
  8%|▊         | 2/24 [00:00<00:01, 18.08it/s]
 29%|██▉       | 7/24 [00:00<00:00, 34.76it/s]
 50%|█████     | 12/24 [00:00<00:00, 40.41it/s]
 71%|███████   | 17/24 [00:00<00:00, 43.22it/s]
 92%|█████████▏| 22/24 [00:04<00:00,  2.93it/s]
100%|██████████| 24/24 [00:06<00:00,  3.96it/s]
2025-03-13 11:01:08,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:08
2025-03-13 11:02:02,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.2452 secs
2025-03-13 11:02:02,856 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 11:02:02,856 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:02

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 11:02:16,551 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6952 secs
2025-03-13 11:02:16,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0064 secs
2025-03-13 11:02:16,552 [INFO]: {
2025-03-13 11:02:16,552 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:16,552 [INFO]: 	index_param: efSearch=152
2025-03-13 11:02:16,552 [INFO]: 	index_path: knn.index
2025-03-13 11:02:16,552 [INFO]: 	size in bytes: 1100783530
2025-03-13 11:02:16,552 [INFO]: 	avg_search_speed_ms: 9.375451563184534
2025-03-13 11:02:16,552 [INFO]: 	99p_search_speed_ms: 12.697243853472171
2025-03-13 11:02:16,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:16,552 [INFO]: 	nb vectors: 5595
2025-03-13 11:02:16,552 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:16,552 [INFO]: 	compression ratio: 0.999307974747769
2025-03-13 11:02:16,552 [INFO]: }
2025-03-13 11:02:16,552 [INFO]: 	>>> Finished "Creating the index" in 74.0107 secs
2025-03-13 11:02:16,552 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0423 secs
2025-03-13 11:02:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 3119 [episode count 7/20]
[retrieval_preprocessing] for episode 5686 [episode count 8/20], we have num_retrieval=np.int64(5539) num_query=np.int64(249)
2025-03-13 11:02:18,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:19,356 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:19
2025-03-13 11:02:19,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:19

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 938.11it/s]
2025-03-13 11:02:19,386 [INFO]: There are 5539 embeddings of dim 49152
2025-03-13 11:02:19,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 11:02:19,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:19
2025-03-13 11:02:19,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:19,387 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:02:19,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:19,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:02:19,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:19
2025-03-13 11:02:19,388 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:19,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:02:19,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:19
2025-03-13 11:02:19,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:19,389 [INFO]: 	Creating the index 03/13/2025, 11:02:19
2025-03-13 11:02:19,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:19
2025-03-13 11:02:19,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:02:19,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:19
2025-03-13 11:02:19,392 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:02:19,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  9%|▊         | 2/23 [00:00<00:01, 18.12it/s]
 30%|███       | 7/23 [00:00<00:00, 35.94it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 41.72it/s]
 78%|███████▊  | 18/23 [00:00<00:00, 45.58it/s]
100%|██████████| 23/23 [00:06<00:00,  2.18it/s]
100%|██████████| 23/23 [00:06<00:00,  3.48it/s]
2025-03-13 11:02:26,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:26
2025-03-13 11:03:28,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.5237 secs
2025-03-13 11:03:28,526 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 11:03:28,526 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:28

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.96it/s]
2025-03-13 11:03:41,712 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1858 secs
2025-03-13 11:03:41,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3210 secs
2025-03-13 11:03:41,713 [INFO]: {
2025-03-13 11:03:41,713 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:41,713 [INFO]: 	index_param: efSearch=154
2025-03-13 11:03:41,713 [INFO]: 	index_path: knn.index
2025-03-13 11:03:41,713 [INFO]: 	size in bytes: 1089765850
2025-03-13 11:03:41,713 [INFO]: 	avg_search_speed_ms: 9.971196059618565
2025-03-13 11:03:41,713 [INFO]: 	99p_search_speed_ms: 14.803291549906135
2025-03-13 11:03:41,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:41,713 [INFO]: 	nb vectors: 5539
2025-03-13 11:03:41,713 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:41,713 [INFO]: 	compression ratio: 0.9993079816182532
2025-03-13 11:03:41,713 [INFO]: }
2025-03-13 11:03:41,713 [INFO]: 	>>> Finished "Creating the index" in 82.3244 secs
2025-03-13 11:03:41,713 [INFO]: >>> Finished "Launching the whole pipeline" in 82.3569 secs
2025-03-13 11:03:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 5686 [episode count 8/20]
[retrieval_preprocessing] for episode 6199 [episode count 9/20], we have num_retrieval=np.int64(5513) num_query=np.int64(275)
2025-03-13 11:03:44,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:44,776 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:44
2025-03-13 11:03:44,776 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:44

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2438.55it/s]
2025-03-13 11:03:44,799 [INFO]: There are 5513 embeddings of dim 49152
2025-03-13 11:03:44,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:03:44,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:44
2025-03-13 11:03:44,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:44,800 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:03:44,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:44,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:44,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:44
2025-03-13 11:03:44,800 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:44,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:44,800 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:44
2025-03-13 11:03:44,800 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:44,800 [INFO]: 	Creating the index 03/13/2025, 11:03:44
2025-03-13 11:03:44,800 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:44
2025-03-13 11:03:44,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:03:44,801 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:44
2025-03-13 11:03:44,801 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:03:44,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  7.75it/s]
 22%|██▏       | 5/23 [00:00<00:00, 24.30it/s]
 43%|████▎     | 10/23 [00:00<00:00, 33.73it/s]
 65%|██████▌   | 15/23 [00:00<00:00, 38.31it/s]
 87%|████████▋ | 20/23 [00:00<00:00, 40.30it/s]
100%|██████████| 23/23 [00:07<00:00,  3.02it/s]
2025-03-13 11:03:52,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:52
2025-03-13 11:04:57,218 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.7876 secs
2025-03-13 11:04:57,218 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 11:04:57,218 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:57

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.51it/s]
2025-03-13 11:05:10,046 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8276 secs
2025-03-13 11:05:10,047 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.2463 secs
2025-03-13 11:05:10,047 [INFO]: {
2025-03-13 11:05:10,048 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:10,048 [INFO]: 	index_param: efSearch=164
2025-03-13 11:05:10,048 [INFO]: 	index_path: knn.index
2025-03-13 11:05:10,048 [INFO]: 	size in bytes: 1084650490
2025-03-13 11:05:10,048 [INFO]: 	avg_search_speed_ms: 10.542630620332174
2025-03-13 11:05:10,048 [INFO]: 	99p_search_speed_ms: 16.340289888903495
2025-03-13 11:05:10,048 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:10,048 [INFO]: 	nb vectors: 5513
2025-03-13 11:05:10,048 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:10,048 [INFO]: 	compression ratio: 0.9993079927525779
2025-03-13 11:05:10,048 [INFO]: }
2025-03-13 11:05:10,048 [INFO]: 	>>> Finished "Creating the index" in 85.2476 secs
2025-03-13 11:05:10,048 [INFO]: >>> Finished "Launching the whole pipeline" in 85.2715 secs
2025-03-13 11:05:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 6199 [episode count 9/20]
[retrieval_preprocessing] for episode 59959 [episode count 10/20], we have num_retrieval=np.int64(5579) num_query=np.int64(209)
2025-03-13 11:05:12,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:13,782 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:13
2025-03-13 11:05:13,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 991.80it/s]
2025-03-13 11:05:13,810 [INFO]: There are 5579 embeddings of dim 49152
2025-03-13 11:05:13,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:05:13,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:13
2025-03-13 11:05:13,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:13,810 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:05:13,810 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:13,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:13,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:13
2025-03-13 11:05:13,810 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:13,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:05:13,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:13
2025-03-13 11:05:13,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:13,810 [INFO]: 	Creating the index 03/13/2025, 11:05:13
2025-03-13 11:05:13,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:13
2025-03-13 11:05:13,811 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:05:13,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:13
2025-03-13 11:05:13,812 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:05:13,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.36it/s]
 22%|██▏       | 5/23 [00:00<00:00, 20.50it/s]
 39%|███▉      | 9/23 [00:00<00:00, 27.05it/s]
 57%|█████▋    | 13/23 [00:00<00:00, 30.68it/s]
 78%|███████▊  | 18/23 [00:00<00:00, 34.33it/s]
 96%|█████████▌| 22/23 [00:05<00:00,  2.41it/s]
100%|██████████| 23/23 [00:06<00:00,  3.40it/s]
2025-03-13 11:05:20,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:20
2025-03-13 11:06:20,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0389 secs
2025-03-13 11:06:20,611 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 11:06:20,611 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:20

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 16.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 11:06:34,610 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9984 secs
2025-03-13 11:06:34,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.7989 secs
2025-03-13 11:06:34,611 [INFO]: {
2025-03-13 11:06:34,611 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:34,611 [INFO]: 	index_param: efSearch=162
2025-03-13 11:06:34,611 [INFO]: 	index_path: knn.index
2025-03-13 11:06:34,611 [INFO]: 	size in bytes: 1097635690
2025-03-13 11:06:34,611 [INFO]: 	avg_search_speed_ms: 10.018705960572184
2025-03-13 11:06:34,611 [INFO]: 	99p_search_speed_ms: 15.22746796486899
2025-03-13 11:06:34,611 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:34,611 [INFO]: 	nb vectors: 5579
2025-03-13 11:06:34,611 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:34,611 [INFO]: 	compression ratio: 0.9993079142679845
2025-03-13 11:06:34,611 [INFO]: }
2025-03-13 11:06:34,611 [INFO]: 	>>> Finished "Creating the index" in 80.8003 secs
2025-03-13 11:06:34,611 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8283 secs
2025-03-13 11:06:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 59959 [episode count 10/20]
[retrieval_preprocessing] for episode 53819 [episode count 11/20], we have num_retrieval=np.int64(5431) num_query=np.int64(357)
2025-03-13 11:06:36,925 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:37,696 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:37
2025-03-13 11:06:37,696 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:37

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-13 11:06:37,720 [INFO]: There are 5431 embeddings of dim 49152
2025-03-13 11:06:37,720 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:06:37,720 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:37
2025-03-13 11:06:37,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:37,720 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:06:37,720 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:37,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:37,720 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:37
2025-03-13 11:06:37,720 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:37,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:06:37,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:37
2025-03-13 11:06:37,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:37,721 [INFO]: 	Creating the index 03/13/2025, 11:06:37
2025-03-13 11:06:37,721 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:37
2025-03-13 11:06:37,722 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:06:37,722 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:37
2025-03-13 11:06:37,722 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:06:37,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.86it/s]
 26%|██▌       | 6/23 [00:00<00:00, 26.09it/s]
 48%|████▊     | 11/23 [00:00<00:00, 33.45it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 37.16it/s]
 91%|█████████▏| 21/23 [00:05<00:00,  2.58it/s]
100%|██████████| 23/23 [00:06<00:00,  3.62it/s]
2025-03-13 11:06:44,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:44
2025-03-13 11:07:35,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2539 secs
2025-03-13 11:07:35,336 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 11:07:35,336 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:35

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 11:07:49,809 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4729 secs
2025-03-13 11:07:49,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0883 secs
2025-03-13 11:07:49,810 [INFO]: {
2025-03-13 11:07:49,810 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:49,810 [INFO]: 	index_param: efSearch=186
2025-03-13 11:07:49,810 [INFO]: 	index_path: knn.index
2025-03-13 11:07:49,810 [INFO]: 	size in bytes: 1068517390
2025-03-13 11:07:49,810 [INFO]: 	avg_search_speed_ms: 12.161868563281736
2025-03-13 11:07:49,810 [INFO]: 	99p_search_speed_ms: 17.78443651739508
2025-03-13 11:07:49,810 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:49,810 [INFO]: 	nb vectors: 5431
2025-03-13 11:07:49,810 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:49,810 [INFO]: 	compression ratio: 0.9993080674147943
2025-03-13 11:07:49,810 [INFO]: }
2025-03-13 11:07:49,810 [INFO]: 	>>> Finished "Creating the index" in 72.0899 secs
2025-03-13 11:07:49,810 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1143 secs
2025-03-13 11:07:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 53819 [episode count 11/20]
[retrieval_preprocessing] for episode 17469 [episode count 12/20], we have num_retrieval=np.int64(5492) num_query=np.int64(296)
2025-03-13 11:07:54,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:55,025 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:55
2025-03-13 11:07:55,025 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:55

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1376.08it/s]
2025-03-13 11:07:55,053 [INFO]: There are 5492 embeddings of dim 49152
2025-03-13 11:07:55,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 11:07:55,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:55
2025-03-13 11:07:55,054 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:55,054 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:07:55,054 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:55,054 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:55,054 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:55
2025-03-13 11:07:55,054 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:55,054 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:07:55,054 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:55
2025-03-13 11:07:55,054 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:55,054 [INFO]: 	Creating the index 03/13/2025, 11:07:55
2025-03-13 11:07:55,054 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:55
2025-03-13 11:07:55,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:07:55,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:55
2025-03-13 11:07:55,055 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:07:55,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  9.95it/s]
 26%|██▌       | 6/23 [00:00<00:00, 32.00it/s]
 48%|████▊     | 11/23 [00:00<00:00, 38.76it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 41.82it/s]
 91%|█████████▏| 21/23 [00:05<00:00,  2.61it/s]
100%|██████████| 23/23 [00:06<00:00,  3.65it/s]
2025-03-13 11:08:01,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:01
2025-03-13 11:08:58,933 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5806 secs
2025-03-13 11:08:58,933 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 11:08:58,933 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:58

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.22it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 11:09:13,824 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8905 secs
2025-03-13 11:09:13,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7694 secs
2025-03-13 11:09:13,825 [INFO]: {
2025-03-13 11:09:13,825 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:13,825 [INFO]: 	index_param: efSearch=164
2025-03-13 11:09:13,825 [INFO]: 	index_path: knn.index
2025-03-13 11:09:13,825 [INFO]: 	size in bytes: 1080518890
2025-03-13 11:09:13,825 [INFO]: 	avg_search_speed_ms: 10.404346953654947
2025-03-13 11:09:13,825 [INFO]: 	99p_search_speed_ms: 15.086081484332679
2025-03-13 11:09:13,825 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:13,825 [INFO]: 	nb vectors: 5492
2025-03-13 11:09:13,825 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:13,825 [INFO]: 	compression ratio: 0.999307967674679
2025-03-13 11:09:13,825 [INFO]: }
2025-03-13 11:09:13,825 [INFO]: 	>>> Finished "Creating the index" in 78.7711 secs
2025-03-13 11:09:13,825 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7999 secs
2025-03-13 11:09:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 17469 [episode count 12/20]
[retrieval_preprocessing] for episode 80447 [episode count 13/20], we have num_retrieval=np.int64(5489) num_query=np.int64(299)
2025-03-13 11:09:17,119 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:18,082 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:18
2025-03-13 11:09:18,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-13 11:09:18,113 [INFO]: There are 5489 embeddings of dim 49152
2025-03-13 11:09:18,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 11:09:18,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:18
2025-03-13 11:09:18,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:18,114 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:09:18,114 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:18,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:09:18,114 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:18
2025-03-13 11:09:18,115 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:18,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:09:18,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:18
2025-03-13 11:09:18,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:18,115 [INFO]: 	Creating the index 03/13/2025, 11:09:18
2025-03-13 11:09:18,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:18
2025-03-13 11:09:18,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:09:18,119 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:18
2025-03-13 11:09:18,119 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:09:18,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  9%|▊         | 2/23 [00:00<00:01, 16.70it/s]
 30%|███       | 7/23 [00:00<00:00, 33.18it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 38.78it/s]
 74%|███████▍  | 17/23 [00:00<00:00, 41.48it/s]
 96%|█████████▌| 22/23 [00:05<00:00,  2.59it/s]
100%|██████████| 23/23 [00:06<00:00,  3.54it/s]
2025-03-13 11:09:24,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:24
2025-03-13 11:10:18,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6234 secs
2025-03-13 11:10:18,245 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 11:10:18,245 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:18

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.88it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 11:10:31,155 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9100 secs
2025-03-13 11:10:31,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.0365 secs
2025-03-13 11:10:31,156 [INFO]: {
2025-03-13 11:10:31,156 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:31,156 [INFO]: 	index_param: efSearch=175
2025-03-13 11:10:31,156 [INFO]: 	index_path: knn.index
2025-03-13 11:10:31,156 [INFO]: 	size in bytes: 1079928670
2025-03-13 11:10:31,156 [INFO]: 	avg_search_speed_ms: 11.676498962068537
2025-03-13 11:10:31,156 [INFO]: 	99p_search_speed_ms: 17.18271645717323
2025-03-13 11:10:31,156 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:31,156 [INFO]: 	nb vectors: 5489
2025-03-13 11:10:31,156 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:31,156 [INFO]: 	compression ratio: 0.9993079561449183
2025-03-13 11:10:31,156 [INFO]: }
2025-03-13 11:10:31,156 [INFO]: 	>>> Finished "Creating the index" in 73.0407 secs
2025-03-13 11:10:31,156 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0743 secs
2025-03-13 11:10:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 80447 [episode count 13/20]
[retrieval_preprocessing] for episode 19017 [episode count 14/20], we have num_retrieval=np.int64(5461) num_query=np.int64(327)
2025-03-13 11:10:34,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:35,580 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:35
2025-03-13 11:10:35,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:35

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1393.92it/s]
2025-03-13 11:10:35,605 [INFO]: There are 5461 embeddings of dim 49152
2025-03-13 11:10:35,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:10:35,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:35
2025-03-13 11:10:35,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:35,605 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:10:35,605 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:35,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:35,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:35
2025-03-13 11:10:35,606 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:35,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:10:35,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:35
2025-03-13 11:10:35,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:35,606 [INFO]: 	Creating the index 03/13/2025, 11:10:35
2025-03-13 11:10:35,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:35
2025-03-13 11:10:35,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:10:35,607 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:35
2025-03-13 11:10:35,607 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:10:35,607 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  8.82it/s]
 26%|██▌       | 6/23 [00:00<00:00, 31.36it/s]
 48%|████▊     | 11/23 [00:00<00:00, 39.20it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 43.02it/s]
 91%|█████████▏| 21/23 [00:05<00:00,  2.52it/s]
100%|██████████| 23/23 [00:06<00:00,  3.46it/s]
2025-03-13 11:10:42,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:42
2025-03-13 11:11:37,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9885 secs
2025-03-13 11:11:37,252 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 11:11:37,252 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:37

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  9.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-13 11:11:50,494 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2416 secs
2025-03-13 11:11:50,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8878 secs
2025-03-13 11:11:50,495 [INFO]: {
2025-03-13 11:11:50,495 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:50,495 [INFO]: 	index_param: efSearch=155
2025-03-13 11:11:50,495 [INFO]: 	index_path: knn.index
2025-03-13 11:11:50,495 [INFO]: 	size in bytes: 1074419770
2025-03-13 11:11:50,495 [INFO]: 	avg_search_speed_ms: 9.565994434858215
2025-03-13 11:11:50,495 [INFO]: 	99p_search_speed_ms: 13.734746340196578
2025-03-13 11:11:50,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:50,495 [INFO]: 	nb vectors: 5461
2025-03-13 11:11:50,495 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:50,495 [INFO]: 	compression ratio: 0.9993080153392934
2025-03-13 11:11:50,495 [INFO]: }
2025-03-13 11:11:50,495 [INFO]: 	>>> Finished "Creating the index" in 74.8894 secs
2025-03-13 11:11:50,495 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9154 secs
2025-03-13 11:11:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 19017 [episode count 14/20]
[retrieval_preprocessing] for episode 68684 [episode count 15/20], we have num_retrieval=np.int64(5468) num_query=np.int64(320)
2025-03-13 11:11:53,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:54,371 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:54
2025-03-13 11:11:54,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:54

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2081.54it/s]
2025-03-13 11:11:54,397 [INFO]: There are 5468 embeddings of dim 49152
2025-03-13 11:11:54,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:11:54,398 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:54
2025-03-13 11:11:54,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:54,398 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:11:54,398 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:54,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:54,398 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:54
2025-03-13 11:11:54,398 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:54,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:54,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:54
2025-03-13 11:11:54,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:54,398 [INFO]: 	Creating the index 03/13/2025, 11:11:54
2025-03-13 11:11:54,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:54
2025-03-13 11:11:54,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:11:54,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:54
2025-03-13 11:11:54,399 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:11:54,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.71it/s]
 30%|███       | 7/23 [00:00<00:00, 30.05it/s]
 57%|█████▋    | 13/23 [00:00<00:00, 39.18it/s]
 83%|████████▎ | 19/23 [00:00<00:00, 43.77it/s]
100%|██████████| 23/23 [00:06<00:00,  3.82it/s]
2025-03-13 11:12:00,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:00
2025-03-13 11:12:58,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3568 secs
2025-03-13 11:12:58,780 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 11:12:58,780 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:58

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 11:13:11,991 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2108 secs
2025-03-13 11:13:11,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5921 secs
2025-03-13 11:13:11,991 [INFO]: {
2025-03-13 11:13:11,991 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:11,992 [INFO]: 	index_param: efSearch=168
2025-03-13 11:13:11,992 [INFO]: 	index_path: knn.index
2025-03-13 11:13:11,992 [INFO]: 	size in bytes: 1075797010
2025-03-13 11:13:11,992 [INFO]: 	avg_search_speed_ms: 12.180776715314925
2025-03-13 11:13:11,992 [INFO]: 	99p_search_speed_ms: 19.36959601007402
2025-03-13 11:13:11,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:11,992 [INFO]: 	nb vectors: 5468
2025-03-13 11:13:11,992 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:11,992 [INFO]: 	compression ratio: 0.9993079865503623
2025-03-13 11:13:11,992 [INFO]: }
2025-03-13 11:13:11,992 [INFO]: 	>>> Finished "Creating the index" in 77.5936 secs
2025-03-13 11:13:11,992 [INFO]: >>> Finished "Launching the whole pipeline" in 77.6201 secs
2025-03-13 11:13:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 68684 [episode count 15/20]
[retrieval_preprocessing] for episode 26193 [episode count 16/20], we have num_retrieval=np.int64(5591) num_query=np.int64(197)
2025-03-13 11:13:15,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:15,829 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:15
2025-03-13 11:13:15,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:15

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1016.80it/s]
2025-03-13 11:13:15,853 [INFO]: There are 5591 embeddings of dim 49152
2025-03-13 11:13:15,854 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:13:15,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:15,854 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:13:15,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:15,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:15,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,854 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:15,854 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:13:15,854 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:15
2025-03-13 11:13:15,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:15,854 [INFO]: 	Creating the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:15
2025-03-13 11:13:15,855 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:13:15,855 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,856 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:13:15,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.11it/s]
 26%|██▌       | 6/23 [00:00<00:00, 28.65it/s]
 52%|█████▏    | 12/23 [00:00<00:00, 39.04it/s]
 78%|███████▊  | 18/23 [00:00<00:00, 43.58it/s]
100%|██████████| 23/23 [00:07<00:00,  1.93it/s]
100%|██████████| 23/23 [00:07<00:00,  3.03it/s]
2025-03-13 11:13:23,452 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:23
2025-03-13 11:14:19,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7884 secs
2025-03-13 11:14:19,241 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 11:14:19,241 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:19

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.26it/s]
2025-03-13 11:14:32,378 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1364 secs
2025-03-13 11:14:32,379 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5231 secs
2025-03-13 11:14:32,379 [INFO]: {
2025-03-13 11:14:32,379 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:32,379 [INFO]: 	index_param: efSearch=158
2025-03-13 11:14:32,379 [INFO]: 	index_path: knn.index
2025-03-13 11:14:32,379 [INFO]: 	size in bytes: 1099996570
2025-03-13 11:14:32,379 [INFO]: 	avg_search_speed_ms: 9.76538710733621
2025-03-13 11:14:32,379 [INFO]: 	99p_search_speed_ms: 13.59651274047792
2025-03-13 11:14:32,379 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:32,379 [INFO]: 	nb vectors: 5591
2025-03-13 11:14:32,379 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:32,379 [INFO]: 	compression ratio: 0.9993079596602742
2025-03-13 11:14:32,379 [INFO]: }
2025-03-13 11:14:32,379 [INFO]: 	>>> Finished "Creating the index" in 76.5248 secs
2025-03-13 11:14:32,379 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5502 secs
2025-03-13 11:14:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 26193 [episode count 16/20]
[retrieval_preprocessing] for episode 87121 [episode count 17/20], we have num_retrieval=np.int64(5425) num_query=np.int64(363)
2025-03-13 11:14:34,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:35,227 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:35
2025-03-13 11:14:35,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:35

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2252.58it/s]
2025-03-13 11:14:35,251 [INFO]: There are 5425 embeddings of dim 49152
2025-03-13 11:14:35,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:14:35,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:35
2025-03-13 11:14:35,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:35,251 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:14:35,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:35,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:35,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:35
2025-03-13 11:14:35,251 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:35,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:35,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:35
2025-03-13 11:14:35,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:35,252 [INFO]: 	Creating the index 03/13/2025, 11:14:35
2025-03-13 11:14:35,252 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:35
2025-03-13 11:14:35,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:14:35,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:35
2025-03-13 11:14:35,253 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:14:35,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.78it/s]
 22%|██▏       | 5/23 [00:00<00:00, 21.08it/s]
 39%|███▉      | 9/23 [00:00<00:00, 27.72it/s]
 57%|█████▋    | 13/23 [00:00<00:00, 30.79it/s]
 74%|███████▍  | 17/23 [00:00<00:00, 32.62it/s]
 91%|█████████▏| 21/23 [00:06<00:01,  2.00it/s]
100%|██████████| 23/23 [00:07<00:00,  3.28it/s]
2025-03-13 11:14:42,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:42
2025-03-13 11:15:38,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4603 secs
2025-03-13 11:15:38,739 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:15:38,740 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:38

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.93it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 11:15:51,662 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9224 secs
2025-03-13 11:15:51,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.4107 secs
2025-03-13 11:15:51,663 [INFO]: {
2025-03-13 11:15:51,664 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:51,664 [INFO]: 	index_param: efSearch=166
2025-03-13 11:15:51,664 [INFO]: 	index_path: knn.index
2025-03-13 11:15:51,664 [INFO]: 	size in bytes: 1067336950
2025-03-13 11:15:51,664 [INFO]: 	avg_search_speed_ms: 11.185152664281137
2025-03-13 11:15:51,664 [INFO]: 	99p_search_speed_ms: 17.01540818903595
2025-03-13 11:15:51,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:51,664 [INFO]: 	nb vectors: 5425
2025-03-13 11:15:51,664 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:51,664 [INFO]: 	compression ratio: 0.9993080441935417
2025-03-13 11:15:51,664 [INFO]: }
2025-03-13 11:15:51,664 [INFO]: 	>>> Finished "Creating the index" in 76.4121 secs
2025-03-13 11:15:51,664 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4368 secs
2025-03-13 11:15:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 87121 [episode count 17/20]
[retrieval_preprocessing] for episode 84565 [episode count 18/20], we have num_retrieval=np.int64(5561) num_query=np.int64(227)
2025-03-13 11:15:55,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:56,037 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:56
2025-03-13 11:15:56,037 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:56

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 864.63it/s]
2025-03-13 11:15:56,063 [INFO]: There are 5561 embeddings of dim 49152
2025-03-13 11:15:56,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:15:56,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:56
2025-03-13 11:15:56,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:56,064 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:15:56,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:56,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:56,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:56
2025-03-13 11:15:56,064 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:56,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:56,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:56
2025-03-13 11:15:56,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:56,064 [INFO]: 	Creating the index 03/13/2025, 11:15:56
2025-03-13 11:15:56,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:56
2025-03-13 11:15:56,065 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:15:56,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:56
2025-03-13 11:15:56,066 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:15:56,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  9.17it/s]
 22%|██▏       | 5/23 [00:00<00:00, 24.61it/s]
 48%|████▊     | 11/23 [00:00<00:00, 36.70it/s]
 70%|██████▉   | 16/23 [00:00<00:00, 41.26it/s]
 91%|█████████▏| 21/23 [00:05<00:00,  2.67it/s]
100%|██████████| 23/23 [00:06<00:00,  3.47it/s]
2025-03-13 11:16:02,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:02
2025-03-13 11:17:04,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2540 secs
2025-03-13 11:17:04,957 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 11:17:04,957 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:04

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.36it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 11:17:19,030 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0736 secs
2025-03-13 11:17:19,032 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9659 secs
2025-03-13 11:17:19,032 [INFO]: {
2025-03-13 11:17:19,032 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:19,032 [INFO]: 	index_param: efSearch=168
2025-03-13 11:17:19,032 [INFO]: 	index_path: knn.index
2025-03-13 11:17:19,032 [INFO]: 	size in bytes: 1094094250
2025-03-13 11:17:19,032 [INFO]: 	avg_search_speed_ms: 11.174316556250167
2025-03-13 11:17:19,032 [INFO]: 	99p_search_speed_ms: 17.868363694287837
2025-03-13 11:17:19,032 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:19,032 [INFO]: 	nb vectors: 5561
2025-03-13 11:17:19,032 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:19,032 [INFO]: 	compression ratio: 0.9993079554160896
2025-03-13 11:17:19,032 [INFO]: }
2025-03-13 11:17:19,032 [INFO]: 	>>> Finished "Creating the index" in 82.9675 secs
2025-03-13 11:17:19,032 [INFO]: >>> Finished "Launching the whole pipeline" in 82.9950 secs
2025-03-13 11:17:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 84565 [episode count 18/20]
[retrieval_preprocessing] for episode 19035 [episode count 19/20], we have num_retrieval=np.int64(5385) num_query=np.int64(403)
2025-03-13 11:17:22,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:23,770 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:23
2025-03-13 11:17:23,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:23

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2106.63it/s]
2025-03-13 11:17:23,795 [INFO]: There are 5385 embeddings of dim 49152
2025-03-13 11:17:23,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:17:23,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:23
2025-03-13 11:17:23,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:23,795 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:17:23,795 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:23,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:23,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:23
2025-03-13 11:17:23,795 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:23,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:17:23,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:23
2025-03-13 11:17:23,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:23,796 [INFO]: 	Creating the index 03/13/2025, 11:17:23
2025-03-13 11:17:23,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:23
2025-03-13 11:17:23,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:17:23,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:23
2025-03-13 11:17:23,797 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:17:23,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:02,  7.94it/s]
 17%|█▋        | 4/23 [00:00<00:01, 11.53it/s]
 26%|██▌       | 6/23 [00:00<00:01, 10.95it/s]
 35%|███▍      | 8/23 [00:00<00:01, 10.76it/s]
 43%|████▎     | 10/23 [00:00<00:01, 10.78it/s]
 52%|█████▏    | 12/23 [00:01<00:01, 10.78it/s]
 61%|██████    | 14/23 [00:01<00:00, 11.03it/s]
 70%|██████▉   | 16/23 [00:01<00:00, 11.09it/s]
 78%|███████▊  | 18/23 [00:01<00:00, 11.28it/s]
 87%|████████▋ | 20/23 [00:01<00:00, 11.34it/s]
 96%|█████████▌| 22/23 [00:06<00:00,  1.24it/s]
100%|██████████| 23/23 [00:07<00:00,  1.16it/s]
100%|██████████| 23/23 [00:07<00:00,  2.94it/s]
2025-03-13 11:17:31,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:31
2025-03-13 11:18:29,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.2366 secs
2025-03-13 11:18:29,852 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:18:29,852 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:29

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.83it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 11:18:46,662 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8098 secs
2025-03-13 11:18:46,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8666 secs
2025-03-13 11:18:46,663 [INFO]: {
2025-03-13 11:18:46,663 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:46,663 [INFO]: 	index_param: efSearch=166
2025-03-13 11:18:46,663 [INFO]: 	index_path: knn.index
2025-03-13 11:18:46,663 [INFO]: 	size in bytes: 1059467230
2025-03-13 11:18:46,664 [INFO]: 	avg_search_speed_ms: 9.816955889267179
2025-03-13 11:18:46,664 [INFO]: 	99p_search_speed_ms: 18.120499812066548
2025-03-13 11:18:46,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:46,664 [INFO]: 	nb vectors: 5385
2025-03-13 11:18:46,664 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:46,664 [INFO]: 	compression ratio: 0.9993080012488919
2025-03-13 11:18:46,664 [INFO]: }
2025-03-13 11:18:46,664 [INFO]: 	>>> Finished "Creating the index" in 82.8679 secs
2025-03-13 11:18:46,664 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8938 secs
2025-03-13 11:18:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 19035 [episode count 19/20]
2025-03-13 11:18:49: [retrieval_preprocessing] finished for 5539130832_stack_cups [chosen_id count 0/260]
2025-03-13 11:18:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5550260365_put_lid_on_container [chosen_id count 1/260]
2025-03-13 11:18:59: [retrieval_preprocessing] we have num_total=10082 embedding_dim=49152
[retrieval_preprocessing] for episode 93243 [episode count 0/20], we have num_retrieval=np.int64(9710) num_query=np.int64(372)
2025-03-13 11:19:02,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:04,347 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:04
2025-03-13 11:19:04,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:04

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 11:19:04,374 [INFO]: There are 9710 embeddings of dim 49152
2025-03-13 11:19:04,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:19:04,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:04
2025-03-13 11:19:04,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:04,375 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:19:04,376 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:19:04,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:19:04,376 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:04
2025-03-13 11:19:04,376 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:04,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:19:04,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:04
2025-03-13 11:19:04,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:04,377 [INFO]: 	Creating the index 03/13/2025, 11:19:04
2025-03-13 11:19:04,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:04
2025-03-13 11:19:04,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:19:04,380 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:04
2025-03-13 11:19:04,380 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:19:04,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:05,  6.65it/s]
  8%|▊         | 3/40 [00:00<00:04,  7.99it/s]
 10%|█         | 4/40 [00:00<00:04,  7.80it/s]
 12%|█▎        | 5/40 [00:00<00:04,  7.79it/s]
 15%|█▌        | 6/40 [00:00<00:04,  8.35it/s]
 20%|██        | 8/40 [00:00<00:03,  9.04it/s]
 22%|██▎       | 9/40 [00:01<00:03,  8.60it/s]
 25%|██▌       | 10/40 [00:01<00:03,  8.79it/s]
 28%|██▊       | 11/40 [00:01<00:03,  9.02it/s]
 30%|███       | 12/40 [00:01<00:03,  8.53it/s]
 32%|███▎      | 13/40 [00:01<00:03,  8.08it/s]
 35%|███▌      | 14/40 [00:01<00:03,  7.77it/s]
 38%|███▊      | 15/40 [00:01<00:03,  7.66it/s]
 40%|████      | 16/40 [00:01<00:03,  7.50it/s]
 42%|████▎     | 17/40 [00:02<00:02,  7.80it/s]
 45%|████▌     | 18/40 [00:02<00:02,  8.29it/s]
 48%|████▊     | 19/40 [00:02<00:02,  8.56it/s]
 50%|█████     | 20/40 [00:02<00:02,  8.80it/s]
 52%|█████▎    | 21/40 [00:05<00:21,  1.13s/it]
 55%|█████▌    | 22/40 [00:06<00:14,  1.21it/s]
 60%|██████    | 24/40 [00:06<00:07,  2.04it/s]
 62%|██████▎   | 25/40 [00:06<00:05,  2.55it/s]
 68%|██████▊   | 27/40 [00:06<00:03,  3.66it/s]
 70%|███████   | 28/40 [00:06<00:02,  4.15it/s]
 72%|███████▎  | 29/40 [00:06<00:02,  4.83it/s]
 75%|███████▌  | 30/40 [00:06<00:01,  5.25it/s]
 80%|████████  | 32/40 [00:07<00:01,  7.38it/s]
 85%|████████▌ | 34/40 [00:07<00:00,  8.25it/s]
 90%|█████████ | 36/40 [00:07<00:00,  8.95it/s]
 95%|█████████▌| 38/40 [00:07<00:00,  9.77it/s]
100%|██████████| 40/40 [00:11<00:00,  1.34it/s]
100%|██████████| 40/40 [00:11<00:00,  3.39it/s]
2025-03-13 11:19:16,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:16
2025-03-13 11:20:20,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.0758 secs
2025-03-13 11:20:20,264 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 11:20:20,264 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:20

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  4.69it/s]
2025-03-13 11:20:37,751 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4875 secs
2025-03-13 11:20:37,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.3739 secs
2025-03-13 11:20:37,754 [INFO]: {
2025-03-13 11:20:37,754 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:37,754 [INFO]: 	index_param: efSearch=308
2025-03-13 11:20:37,754 [INFO]: 	index_path: knn.index
2025-03-13 11:20:37,754 [INFO]: 	size in bytes: 1910384650
2025-03-13 11:20:37,754 [INFO]: 	avg_search_speed_ms: 14.783451900758301
2025-03-13 11:20:37,755 [INFO]: 	99p_search_speed_ms: 20.52809284999967
2025-03-13 11:20:37,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:37,755 [INFO]: 	nb vectors: 9710
2025-03-13 11:20:37,755 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:37,755 [INFO]: 	compression ratio: 0.9993085319231392
2025-03-13 11:20:37,755 [INFO]: }
2025-03-13 11:20:37,755 [INFO]: 	>>> Finished "Creating the index" in 93.3774 secs
2025-03-13 11:20:37,755 [INFO]: >>> Finished "Launching the whole pipeline" in 93.4074 secs
2025-03-13 11:20:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 93243 [episode count 0/20]
[retrieval_preprocessing] for episode 48728 [episode count 1/20], we have num_retrieval=np.int64(9617) num_query=np.int64(465)
2025-03-13 11:20:47,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:49,145 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:49
2025-03-13 11:20:49,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:49

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1590.56it/s]
2025-03-13 11:20:49,170 [INFO]: There are 9617 embeddings of dim 49152
2025-03-13 11:20:49,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:20:49,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:49
2025-03-13 11:20:49,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:49,170 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:20:49,170 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:20:49,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:49,170 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:49
2025-03-13 11:20:49,170 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:49,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:20:49,170 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:49
2025-03-13 11:20:49,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:49,170 [INFO]: 	Creating the index 03/13/2025, 11:20:49
2025-03-13 11:20:49,170 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:49
2025-03-13 11:20:49,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:20:49,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:49
2025-03-13 11:20:49,172 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:20:49,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:08,  4.37it/s]
  8%|▊         | 3/39 [00:00<00:04,  8.23it/s]
 13%|█▎        | 5/39 [00:00<00:03,  9.70it/s]
 18%|█▊        | 7/39 [00:00<00:03, 10.57it/s]
 23%|██▎       | 9/39 [00:00<00:02, 10.97it/s]
 28%|██▊       | 11/39 [00:01<00:02, 11.33it/s]
 33%|███▎      | 13/39 [00:01<00:02, 11.48it/s]
 38%|███▊      | 15/39 [00:01<00:02, 11.59it/s]
 44%|████▎     | 17/39 [00:01<00:01, 11.65it/s]
 49%|████▊     | 19/39 [00:01<00:01, 11.63it/s]
 54%|█████▍    | 21/39 [00:05<00:10,  1.66it/s]
 62%|██████▏   | 24/39 [00:06<00:07,  2.13it/s]
 64%|██████▍   | 25/39 [00:06<00:05,  2.38it/s]
 67%|██████▋   | 26/39 [00:06<00:05,  2.51it/s]
 69%|██████▉   | 27/39 [00:07<00:06,  1.94it/s]
 72%|███████▏  | 28/39 [00:07<00:04,  2.28it/s]
 77%|███████▋  | 30/39 [00:07<00:02,  3.36it/s]
 82%|████████▏ | 32/39 [00:07<00:01,  4.65it/s]
 85%|████████▍ | 33/39 [00:08<00:01,  3.42it/s]
 87%|████████▋ | 34/39 [00:08<00:01,  3.85it/s]
 90%|████████▉ | 35/39 [00:08<00:00,  4.28it/s]
 92%|█████████▏| 36/39 [00:09<00:00,  4.77it/s]
 95%|█████████▍| 37/39 [00:09<00:00,  5.14it/s]
100%|██████████| 39/39 [00:13<00:00,  1.02it/s]
100%|██████████| 39/39 [00:13<00:00,  2.96it/s]
2025-03-13 11:21:02,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:02
2025-03-13 11:22:00,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4819 secs
2025-03-13 11:22:00,832 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 11:22:00,832 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:00

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  7.00it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-13 11:22:19,526 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6940 secs
2025-03-13 11:22:19,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3584 secs
2025-03-13 11:22:19,530 [INFO]: {
2025-03-13 11:22:19,530 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:19,530 [INFO]: 	index_param: efSearch=302
2025-03-13 11:22:19,530 [INFO]: 	index_path: knn.index
2025-03-13 11:22:19,530 [INFO]: 	size in bytes: 1892087770
2025-03-13 11:22:19,530 [INFO]: 	avg_search_speed_ms: 12.906994753547254
2025-03-13 11:22:19,530 [INFO]: 	99p_search_speed_ms: 20.44265874661505
2025-03-13 11:22:19,530 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:19,530 [INFO]: 	nb vectors: 9617
2025-03-13 11:22:19,530 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:19,530 [INFO]: 	compression ratio: 0.999308365065961
2025-03-13 11:22:19,530 [INFO]: }
2025-03-13 11:22:19,530 [INFO]: 	>>> Finished "Creating the index" in 90.3601 secs
2025-03-13 11:22:19,530 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3857 secs
2025-03-13 11:22:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 48728 [episode count 1/20]
[retrieval_preprocessing] for episode 63065 [episode count 2/20], we have num_retrieval=np.int64(9797) num_query=np.int64(285)
2025-03-13 11:22:28,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:29,876 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:29
2025-03-13 11:22:29,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:29

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1142.55it/s]
2025-03-13 11:22:29,903 [INFO]: There are 9797 embeddings of dim 49152
2025-03-13 11:22:29,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:22:29,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:29
2025-03-13 11:22:29,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:29,904 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 11:22:29,905 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:22:29,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:22:29,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:29
2025-03-13 11:22:29,905 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:29,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:22:29,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:29
2025-03-13 11:22:29,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:29,905 [INFO]: 	Creating the index 03/13/2025, 11:22:29
2025-03-13 11:22:29,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:29
2025-03-13 11:22:29,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:22:29,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:29
2025-03-13 11:22:29,908 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:22:29,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:11,  3.28it/s]
  5%|▌         | 2/40 [00:00<00:08,  4.53it/s]
  8%|▊         | 3/40 [00:00<00:06,  5.72it/s]
 10%|█         | 4/40 [00:00<00:05,  6.53it/s]
 12%|█▎        | 5/40 [00:00<00:04,  7.06it/s]
 15%|█▌        | 6/40 [00:00<00:04,  7.52it/s]
 18%|█▊        | 7/40 [00:01<00:04,  7.86it/s]
 22%|██▎       | 9/40 [00:01<00:03,  8.67it/s]
 25%|██▌       | 10/40 [00:01<00:03,  8.66it/s]
 28%|██▊       | 11/40 [00:01<00:03,  8.73it/s]
 30%|███       | 12/40 [00:01<00:03,  8.70it/s]
 32%|███▎      | 13/40 [00:01<00:03,  8.63it/s]
 38%|███▊      | 15/40 [00:01<00:02,  9.00it/s]
 40%|████      | 16/40 [00:02<00:02,  9.01it/s]
 42%|████▎     | 17/40 [00:02<00:02,  8.91it/s]
 45%|████▌     | 18/40 [00:02<00:02,  8.79it/s]
 48%|████▊     | 19/40 [00:02<00:02,  8.69it/s]
 50%|█████     | 20/40 [00:02<00:02,  8.73it/s]
 52%|█████▎    | 21/40 [00:05<00:20,  1.07s/it]
 57%|█████▊    | 23/40 [00:06<00:10,  1.60it/s]
 62%|██████▎   | 25/40 [00:06<00:06,  2.44it/s]
 68%|██████▊   | 27/40 [00:06<00:03,  3.43it/s]
 72%|███████▎  | 29/40 [00:06<00:02,  4.55it/s]
 78%|███████▊  | 31/40 [00:06<00:01,  5.78it/s]
 82%|████████▎ | 33/40 [00:06<00:00,  7.00it/s]
 88%|████████▊ | 35/40 [00:07<00:00,  8.16it/s]
 92%|█████████▎| 37/40 [00:07<00:00,  8.93it/s]
 98%|█████████▊| 39/40 [00:07<00:00,  9.47it/s]
100%|██████████| 40/40 [00:11<00:00,  3.54it/s]
2025-03-13 11:22:41,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:41
2025-03-13 11:23:41,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.5699 secs
2025-03-13 11:23:41,790 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 11:23:41,790 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:41

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 15.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 16.45it/s]
2025-03-13 11:23:58,077 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2866 secs
2025-03-13 11:23:58,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1725 secs
2025-03-13 11:23:58,080 [INFO]: {
2025-03-13 11:23:58,080 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:58,080 [INFO]: 	index_param: efSearch=307
2025-03-13 11:23:58,081 [INFO]: 	index_path: knn.index
2025-03-13 11:23:58,081 [INFO]: 	size in bytes: 1927501750
2025-03-13 11:23:58,081 [INFO]: 	avg_search_speed_ms: 15.45527590211291
2025-03-13 11:23:58,081 [INFO]: 	99p_search_speed_ms: 29.66579527594147
2025-03-13 11:23:58,081 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:58,081 [INFO]: 	nb vectors: 9797
2025-03-13 11:23:58,081 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:58,081 [INFO]: 	compression ratio: 0.9993083409651898
2025-03-13 11:23:58,081 [INFO]: }
2025-03-13 11:23:58,081 [INFO]: 	>>> Finished "Creating the index" in 88.1751 secs
2025-03-13 11:23:58,081 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2043 secs
2025-03-13 11:24:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 63065 [episode count 2/20]
[retrieval_preprocessing] for episode 78944 [episode count 3/20], we have num_retrieval=np.int64(9785) num_query=np.int64(297)
2025-03-13 11:24:06,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:08,082 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:08
2025-03-13 11:24:08,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:08

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 11:24:08,106 [INFO]: There are 9785 embeddings of dim 49152
2025-03-13 11:24:08,106 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:24:08,106 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:08
2025-03-13 11:24:08,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:08,106 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 11:24:08,106 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:24:08,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:08,106 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:08
2025-03-13 11:24:08,106 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:08,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:08,106 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:08
2025-03-13 11:24:08,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:08,107 [INFO]: 	Creating the index 03/13/2025, 11:24:08
2025-03-13 11:24:08,107 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:08
2025-03-13 11:24:08,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:24:08,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:08
2025-03-13 11:24:08,108 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:24:08,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:07,  5.15it/s]
  8%|▊         | 3/40 [00:00<00:04,  8.79it/s]
 12%|█▎        | 5/40 [00:00<00:03,  9.78it/s]
 18%|█▊        | 7/40 [00:00<00:03, 10.17it/s]
 22%|██▎       | 9/40 [00:00<00:02, 10.80it/s]
 28%|██▊       | 11/40 [00:01<00:02, 12.51it/s]
 32%|███▎      | 13/40 [00:01<00:02, 12.47it/s]
 38%|███▊      | 15/40 [00:01<00:01, 12.59it/s]
 42%|████▎     | 17/40 [00:01<00:01, 13.02it/s]
 48%|████▊     | 19/40 [00:01<00:01, 13.30it/s]
 52%|█████▎    | 21/40 [00:05<00:13,  1.40it/s]
 55%|█████▌    | 22/40 [00:06<00:10,  1.64it/s]
 57%|█████▊    | 23/40 [00:06<00:08,  1.96it/s]
 60%|██████    | 24/40 [00:06<00:06,  2.36it/s]
 62%|██████▎   | 25/40 [00:06<00:05,  2.85it/s]
 65%|██████▌   | 26/40 [00:06<00:04,  3.41it/s]
 68%|██████▊   | 27/40 [00:06<00:03,  4.03it/s]
 70%|███████   | 28/40 [00:06<00:02,  4.69it/s]
 72%|███████▎  | 29/40 [00:06<00:02,  5.31it/s]
 75%|███████▌  | 30/40 [00:07<00:01,  5.87it/s]
 78%|███████▊  | 31/40 [00:07<00:01,  6.34it/s]
 80%|████████  | 32/40 [00:07<00:01,  6.75it/s]
 82%|████████▎ | 33/40 [00:07<00:00,  7.07it/s]
 85%|████████▌ | 34/40 [00:07<00:00,  7.38it/s]
 88%|████████▊ | 35/40 [00:07<00:00,  7.73it/s]
 92%|█████████▎| 37/40 [00:07<00:00,  8.78it/s]
 98%|█████████▊| 39/40 [00:08<00:00,  9.58it/s]
100%|██████████| 40/40 [00:12<00:00,  1.07s/it]
100%|██████████| 40/40 [00:12<00:00,  3.19it/s]
2025-03-13 11:24:20,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:20
2025-03-13 11:25:27,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.2509 secs
2025-03-13 11:25:27,910 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 11:25:27,910 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:27

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s]
 50%|█████     | 2/4 [00:00<00:00,  5.97it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 11:25:44,516 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6062 secs
2025-03-13 11:25:44,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.4119 secs
2025-03-13 11:25:44,520 [INFO]: {
2025-03-13 11:25:44,520 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:44,520 [INFO]: 	index_param: efSearch=285
2025-03-13 11:25:44,520 [INFO]: 	index_path: knn.index
2025-03-13 11:25:44,520 [INFO]: 	size in bytes: 1925140810
2025-03-13 11:25:44,520 [INFO]: 	avg_search_speed_ms: 13.177319481043693
2025-03-13 11:25:44,520 [INFO]: 	99p_search_speed_ms: 19.008929794654247
2025-03-13 11:25:44,520 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:44,520 [INFO]: 	nb vectors: 9785
2025-03-13 11:25:44,520 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:44,520 [INFO]: 	compression ratio: 0.9993083466969879
2025-03-13 11:25:44,520 [INFO]: }
2025-03-13 11:25:44,520 [INFO]: 	>>> Finished "Creating the index" in 96.4133 secs
2025-03-13 11:25:44,520 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4380 secs
2025-03-13 11:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 78944 [episode count 3/20]
[retrieval_preprocessing] for episode 31876 [episode count 4/20], we have num_retrieval=np.int64(9676) num_query=np.int64(406)
2025-03-13 11:25:53,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:54,763 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:54
2025-03-13 11:25:54,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:54

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1193.60it/s]
2025-03-13 11:25:54,788 [INFO]: There are 9676 embeddings of dim 49152
2025-03-13 11:25:54,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:25:54,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:54,788 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:25:54,788 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:25:54,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:54,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,788 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:54,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:54,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:54
2025-03-13 11:25:54,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:54,789 [INFO]: 	Creating the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:54
2025-03-13 11:25:54,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:25:54,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,790 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:25:54,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:09,  4.16it/s]
  5%|▌         | 2/40 [00:00<00:06,  5.92it/s]
  8%|▊         | 3/40 [00:00<00:05,  6.87it/s]
 10%|█         | 4/40 [00:00<00:04,  7.43it/s]
 12%|█▎        | 5/40 [00:00<00:04,  7.74it/s]
 15%|█▌        | 6/40 [00:00<00:04,  8.04it/s]
 18%|█▊        | 7/40 [00:00<00:04,  8.17it/s]
 20%|██        | 8/40 [00:01<00:03,  8.23it/s]
 22%|██▎       | 9/40 [00:01<00:03,  8.26it/s]
 25%|██▌       | 10/40 [00:01<00:03,  8.32it/s]
 28%|██▊       | 11/40 [00:01<00:03,  8.45it/s]
 30%|███       | 12/40 [00:01<00:03,  8.44it/s]
 32%|███▎      | 13/40 [00:01<00:03,  8.43it/s]
 35%|███▌      | 14/40 [00:01<00:03,  8.44it/s]
 38%|███▊      | 15/40 [00:01<00:02,  8.39it/s]
 40%|████      | 16/40 [00:02<00:02,  8.45it/s]
 42%|████▎     | 17/40 [00:02<00:02,  8.46it/s]
 48%|████▊     | 19/40 [00:02<00:02,  9.46it/s]
 52%|█████▎    | 21/40 [00:06<00:15,  1.22it/s]
 55%|█████▌    | 22/40 [00:06<00:11,  1.52it/s]
 60%|██████    | 24/40 [00:06<00:06,  2.30it/s]
 65%|██████▌   | 26/40 [00:06<00:04,  3.21it/s]
 70%|███████   | 28/40 [00:06<00:02,  4.20it/s]
 75%|███████▌  | 30/40 [00:06<00:01,  5.36it/s]
 80%|████████  | 32/40 [00:07<00:01,  6.58it/s]
 85%|████████▌ | 34/40 [00:07<00:00,  7.69it/s]
 90%|█████████ | 36/40 [00:07<00:00,  8.70it/s]
 95%|█████████▌| 38/40 [00:07<00:00,  9.24it/s]
100%|██████████| 40/40 [00:11<00:00,  1.42it/s]
100%|██████████| 40/40 [00:11<00:00,  3.42it/s]
2025-03-13 11:26:06,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:06
2025-03-13 11:27:05,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7003 secs
2025-03-13 11:27:05,173 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:27:05,174 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:05

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 11:27:23,160 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9865 secs
2025-03-13 11:27:23,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.3738 secs
2025-03-13 11:27:23,164 [INFO]: {
2025-03-13 11:27:23,164 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:23,164 [INFO]: 	index_param: efSearch=294
2025-03-13 11:27:23,164 [INFO]: 	index_path: knn.index
2025-03-13 11:27:23,164 [INFO]: 	size in bytes: 1903695490
2025-03-13 11:27:23,164 [INFO]: 	avg_search_speed_ms: 12.98985389369697
2025-03-13 11:27:23,164 [INFO]: 	99p_search_speed_ms: 20.9584073186852
2025-03-13 11:27:23,164 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:23,164 [INFO]: 	nb vectors: 9676
2025-03-13 11:27:23,164 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:23,164 [INFO]: 	compression ratio: 0.9993084597789323
2025-03-13 11:27:23,164 [INFO]: }
2025-03-13 11:27:23,164 [INFO]: 	>>> Finished "Creating the index" in 88.3754 secs
2025-03-13 11:27:23,164 [INFO]: >>> Finished "Launching the whole pipeline" in 88.4014 secs
2025-03-13 11:27:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 31876 [episode count 4/20]
[retrieval_preprocessing] for episode 39583 [episode count 5/20], we have num_retrieval=np.int64(9702) num_query=np.int64(380)
2025-03-13 11:27:31,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:32,759 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:32
2025-03-13 11:27:32,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:32

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1104.35it/s]
2025-03-13 11:27:32,785 [INFO]: There are 9702 embeddings of dim 49152
2025-03-13 11:27:32,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:27:32,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:32
2025-03-13 11:27:32,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:32,785 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:27:32,785 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:27:32,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:32,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:32
2025-03-13 11:27:32,785 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:32,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:27:32,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:32
2025-03-13 11:27:32,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:32,785 [INFO]: 	Creating the index 03/13/2025, 11:27:32
2025-03-13 11:27:32,785 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:32
2025-03-13 11:27:32,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:27:32,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:32
2025-03-13 11:27:32,786 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:27:32,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:08,  4.53it/s]
  8%|▊         | 3/40 [00:00<00:04,  8.40it/s]
 12%|█▎        | 5/40 [00:00<00:04,  7.88it/s]
 15%|█▌        | 6/40 [00:00<00:04,  7.76it/s]
 18%|█▊        | 7/40 [00:00<00:04,  7.74it/s]
 20%|██        | 8/40 [00:01<00:04,  7.88it/s]
 22%|██▎       | 9/40 [00:01<00:03,  7.92it/s]
 28%|██▊       | 11/40 [00:01<00:02,  9.83it/s]
 32%|███▎      | 13/40 [00:01<00:02, 11.26it/s]
 38%|███▊      | 15/40 [00:01<00:02, 12.01it/s]
 42%|████▎     | 17/40 [00:01<00:01, 13.38it/s]
 48%|████▊     | 19/40 [00:01<00:01, 14.46it/s]
 52%|█████▎    | 21/40 [00:05<00:11,  1.71it/s]
 57%|█████▊    | 23/40 [00:05<00:07,  2.30it/s]
 62%|██████▎   | 25/40 [00:05<00:04,  3.04it/s]
 68%|██████▊   | 27/40 [00:05<00:03,  3.90it/s]
 72%|███████▎  | 29/40 [00:05<00:02,  4.87it/s]
 78%|███████▊  | 31/40 [00:06<00:01,  5.92it/s]
 82%|████████▎ | 33/40 [00:06<00:01,  6.89it/s]
 88%|████████▊ | 35/40 [00:06<00:00,  7.84it/s]
 92%|█████████▎| 37/40 [00:06<00:00,  8.62it/s]
 98%|█████████▊| 39/40 [00:06<00:00,  9.19it/s]
100%|██████████| 40/40 [00:10<00:00,  3.71it/s]
2025-03-13 11:27:43,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:43
2025-03-13 11:28:44,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0699 secs
2025-03-13 11:28:44,632 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 11:28:44,632 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:44

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.20it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 11:29:05,401 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7683 secs
2025-03-13 11:29:05,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.6173 secs
2025-03-13 11:29:05,404 [INFO]: {
2025-03-13 11:29:05,404 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:05,404 [INFO]: 	index_param: efSearch=272
2025-03-13 11:29:05,404 [INFO]: 	index_path: knn.index
2025-03-13 11:29:05,404 [INFO]: 	size in bytes: 1908810730
2025-03-13 11:29:05,404 [INFO]: 	avg_search_speed_ms: 13.202928090504908
2025-03-13 11:29:05,404 [INFO]: 	99p_search_speed_ms: 20.88790935231369
2025-03-13 11:29:05,404 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:05,404 [INFO]: 	nb vectors: 9702
2025-03-13 11:29:05,404 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:05,404 [INFO]: 	compression ratio: 0.9993085149935217
2025-03-13 11:29:05,404 [INFO]: }
2025-03-13 11:29:05,404 [INFO]: 	>>> Finished "Creating the index" in 92.6187 secs
2025-03-13 11:29:05,404 [INFO]: >>> Finished "Launching the whole pipeline" in 92.6451 secs
2025-03-13 11:29:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 39583 [episode count 5/20]
[retrieval_preprocessing] for episode 89759 [episode count 6/20], we have num_retrieval=np.int64(9480) num_query=np.int64(602)
2025-03-13 11:29:13,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:15,533 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:15
2025-03-13 11:29:15,533 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:15

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1060.77it/s]
2025-03-13 11:29:15,560 [INFO]: There are 9480 embeddings of dim 49152
2025-03-13 11:29:15,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:29:15,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:15
2025-03-13 11:29:15,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:15,561 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 11:29:15,561 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:29:15,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:29:15,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:15
2025-03-13 11:29:15,562 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:15,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:29:15,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:15
2025-03-13 11:29:15,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:15,562 [INFO]: 	Creating the index 03/13/2025, 11:29:15
2025-03-13 11:29:15,563 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:15
2025-03-13 11:29:15,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:29:15,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:15
2025-03-13 11:29:15,566 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 11:29:15,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:07,  4.76it/s]
  8%|▊         | 3/39 [00:00<00:04,  8.28it/s]
 13%|█▎        | 5/39 [00:00<00:03, 10.33it/s]
 18%|█▊        | 7/39 [00:00<00:02, 11.09it/s]
 23%|██▎       | 9/39 [00:00<00:02, 11.50it/s]
 28%|██▊       | 11/39 [00:01<00:02, 11.88it/s]
 33%|███▎      | 13/39 [00:01<00:02, 12.07it/s]
 38%|███▊      | 15/39 [00:01<00:01, 12.20it/s]
 44%|████▎     | 17/39 [00:01<00:01, 12.33it/s]
 49%|████▊     | 19/39 [00:01<00:01, 12.45it/s]
 54%|█████▍    | 21/39 [00:05<00:11,  1.52it/s]
 56%|█████▋    | 22/39 [00:05<00:09,  1.78it/s]
 59%|█████▉    | 23/39 [00:05<00:07,  2.14it/s]
 62%|██████▏   | 24/39 [00:05<00:05,  2.59it/s]
 67%|██████▋   | 26/39 [00:06<00:03,  3.68it/s]
 72%|███████▏  | 28/39 [00:06<00:02,  4.83it/s]
 77%|███████▋  | 30/39 [00:06<00:01,  5.96it/s]
 82%|████████▏ | 32/39 [00:06<00:00,  7.01it/s]
 87%|████████▋ | 34/39 [00:06<00:00,  7.88it/s]
 92%|█████████▏| 36/39 [00:07<00:00,  8.61it/s]
 97%|█████████▋| 38/39 [00:07<00:00,  9.25it/s]
100%|██████████| 39/39 [00:11<00:00,  3.40it/s]
2025-03-13 11:29:27,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:27
2025-03-13 11:30:29,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.1178 secs
2025-03-13 11:30:29,162 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 11:30:29,162 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:29

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s]
2025-03-13 11:30:46,019 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8576 secs
2025-03-13 11:30:46,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.4569 secs
2025-03-13 11:30:46,023 [INFO]: {
2025-03-13 11:30:46,023 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:46,023 [INFO]: 	index_param: efSearch=289
2025-03-13 11:30:46,023 [INFO]: 	index_path: knn.index
2025-03-13 11:30:46,023 [INFO]: 	size in bytes: 1865133790
2025-03-13 11:30:46,023 [INFO]: 	avg_search_speed_ms: 12.244002713173208
2025-03-13 11:30:46,023 [INFO]: 	99p_search_speed_ms: 18.6038310173899
2025-03-13 11:30:46,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:46,023 [INFO]: 	nb vectors: 9480
2025-03-13 11:30:46,023 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:46,023 [INFO]: 	compression ratio: 0.999308387416004
2025-03-13 11:30:46,023 [INFO]: }
2025-03-13 11:30:46,023 [INFO]: 	>>> Finished "Creating the index" in 90.4605 secs
2025-03-13 11:30:46,023 [INFO]: >>> Finished "Launching the whole pipeline" in 90.4898 secs
2025-03-13 11:30:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 89759 [episode count 6/20]
[retrieval_preprocessing] for episode 5872 [episode count 7/20], we have num_retrieval=np.int64(9571) num_query=np.int64(511)
2025-03-13 11:30:55,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:57,163 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:57
2025-03-13 11:30:57,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:57

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-13 11:30:57,198 [INFO]: There are 9571 embeddings of dim 49152
2025-03-13 11:30:57,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 11:30:57,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:57
2025-03-13 11:30:57,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:57,199 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:30:57,199 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:30:57,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:30:57,199 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:57
2025-03-13 11:30:57,200 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:57,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:30:57,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:57
2025-03-13 11:30:57,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:57,201 [INFO]: 	Creating the index 03/13/2025, 11:30:57
2025-03-13 11:30:57,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:57
2025-03-13 11:30:57,204 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:30:57,204 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:57
2025-03-13 11:30:57,205 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:30:57,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:08,  4.69it/s]
  8%|▊         | 3/39 [00:00<00:04,  7.97it/s]
 13%|█▎        | 5/39 [00:00<00:03,  9.29it/s]
 18%|█▊        | 7/39 [00:00<00:03,  9.80it/s]
 23%|██▎       | 9/39 [00:00<00:02, 10.28it/s]
 28%|██▊       | 11/39 [00:01<00:02, 11.07it/s]
 33%|███▎      | 13/39 [00:01<00:02, 11.79it/s]
 38%|███▊      | 15/39 [00:01<00:01, 12.16it/s]
 44%|████▎     | 17/39 [00:01<00:01, 12.12it/s]
 49%|████▊     | 19/39 [00:01<00:01, 12.20it/s]
 54%|█████▍    | 21/39 [00:05<00:11,  1.61it/s]
 56%|█████▋    | 22/39 [00:05<00:08,  1.90it/s]
 62%|██████▏   | 24/39 [00:05<00:05,  2.67it/s]
 67%|██████▋   | 26/39 [00:05<00:03,  3.59it/s]
 72%|███████▏  | 28/39 [00:05<00:02,  4.66it/s]
 77%|███████▋  | 30/39 [00:06<00:01,  5.87it/s]
 82%|████████▏ | 32/39 [00:06<00:00,  7.14it/s]
 87%|████████▋ | 34/39 [00:06<00:00,  8.52it/s]
 92%|█████████▏| 36/39 [00:06<00:00, 10.01it/s]
 97%|█████████▋| 38/39 [00:06<00:00, 11.34it/s]
100%|██████████| 39/39 [00:10<00:00,  3.71it/s]
2025-03-13 11:31:07,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:07
2025-03-13 11:32:08,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.7669 secs
2025-03-13 11:32:08,487 [INFO]: The best hyperparameters are: efSearch=318
2025-03-13 11:32:08,487 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:08

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.69it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 11:32:32,287 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7999 secs
2025-03-13 11:32:32,291 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0861 secs
2025-03-13 11:32:32,291 [INFO]: {
2025-03-13 11:32:32,291 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:32,291 [INFO]: 	index_param: efSearch=318
2025-03-13 11:32:32,291 [INFO]: 	index_path: knn.index
2025-03-13 11:32:32,291 [INFO]: 	size in bytes: 1883037490
2025-03-13 11:32:32,291 [INFO]: 	avg_search_speed_ms: 14.18209275845491
2025-03-13 11:32:32,291 [INFO]: 	99p_search_speed_ms: 23.92805442214017
2025-03-13 11:32:32,291 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:32,291 [INFO]: 	nb vectors: 9571
2025-03-13 11:32:32,291 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:32,291 [INFO]: 	compression ratio: 0.9993083929518578
2025-03-13 11:32:32,291 [INFO]: }
2025-03-13 11:32:32,291 [INFO]: 	>>> Finished "Creating the index" in 95.0901 secs
2025-03-13 11:32:32,291 [INFO]: >>> Finished "Launching the whole pipeline" in 95.1280 secs
2025-03-13 11:32:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 5872 [episode count 7/20]
[retrieval_preprocessing] for episode 15606 [episode count 8/20], we have num_retrieval=np.int64(9722) num_query=np.int64(360)
2025-03-13 11:32:42,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:43,904 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:43
2025-03-13 11:32:43,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:43

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1025.00it/s]
2025-03-13 11:32:43,930 [INFO]: There are 9722 embeddings of dim 49152
2025-03-13 11:32:43,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:32:43,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:43,930 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:32:43,930 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:32:43,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:43,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,930 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:43,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:32:43,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:43
2025-03-13 11:32:43,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:43,930 [INFO]: 	Creating the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:43
2025-03-13 11:32:43,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:32:43,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,932 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:32:43,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:08,  4.61it/s]
  8%|▊         | 3/40 [00:00<00:03,  9.64it/s]
 12%|█▎        | 5/40 [00:00<00:03, 10.78it/s]
 18%|█▊        | 7/40 [00:00<00:03, 10.70it/s]
 22%|██▎       | 9/40 [00:00<00:02, 10.60it/s]
 28%|██▊       | 11/40 [00:01<00:02, 10.64it/s]
 32%|███▎      | 13/40 [00:01<00:02, 10.69it/s]
 38%|███▊      | 15/40 [00:01<00:02, 10.69it/s]
 42%|████▎     | 17/40 [00:01<00:02, 10.79it/s]
 48%|████▊     | 19/40 [00:01<00:01, 10.84it/s]
 52%|█████▎    | 21/40 [00:05<00:11,  1.62it/s]
 62%|██████▎   | 25/40 [00:05<00:05,  2.94it/s]
 68%|██████▊   | 27/40 [00:05<00:03,  3.56it/s]
 72%|███████▎  | 29/40 [00:05<00:02,  4.34it/s]
 78%|███████▊  | 31/40 [00:06<00:01,  5.20it/s]
 82%|████████▎ | 33/40 [00:06<00:01,  6.10it/s]
 88%|████████▊ | 35/40 [00:06<00:00,  7.00it/s]
 92%|█████████▎| 37/40 [00:06<00:00,  7.82it/s]
 98%|█████████▊| 39/40 [00:06<00:00,  8.56it/s]
100%|██████████| 40/40 [00:11<00:00,  3.58it/s]
2025-03-13 11:32:55,118 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:55
2025-03-13 11:33:58,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.8715 secs
2025-03-13 11:33:58,991 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 11:33:58,991 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:58

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.16it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-13 11:34:19,624 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6335 secs
2025-03-13 11:34:19,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.6955 secs
2025-03-13 11:34:19,628 [INFO]: {
2025-03-13 11:34:19,628 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:19,628 [INFO]: 	index_param: efSearch=301
2025-03-13 11:34:19,628 [INFO]: 	index_path: knn.index
2025-03-13 11:34:19,628 [INFO]: 	size in bytes: 1912745590
2025-03-13 11:34:19,628 [INFO]: 	avg_search_speed_ms: 13.049618734442658
2025-03-13 11:34:19,628 [INFO]: 	99p_search_speed_ms: 20.18001244869084
2025-03-13 11:34:19,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:19,628 [INFO]: 	nb vectors: 9722
2025-03-13 11:34:19,628 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:19,628 [INFO]: 	compression ratio: 0.999308525918494
2025-03-13 11:34:19,628 [INFO]: }
2025-03-13 11:34:19,628 [INFO]: 	>>> Finished "Creating the index" in 95.6973 secs
2025-03-13 11:34:19,628 [INFO]: >>> Finished "Launching the whole pipeline" in 95.7235 secs
2025-03-13 11:34:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 15606 [episode count 8/20]
[retrieval_preprocessing] for episode 48896 [episode count 9/20], we have num_retrieval=np.int64(9703) num_query=np.int64(379)
2025-03-13 11:34:28,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:29,579 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:29
2025-03-13 11:34:29,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:29

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1131.15it/s]
2025-03-13 11:34:29,603 [INFO]: There are 9703 embeddings of dim 49152
2025-03-13 11:34:29,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:34:29,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:29
2025-03-13 11:34:29,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:29,604 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:34:29,604 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:34:29,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:29,604 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:29
2025-03-13 11:34:29,604 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:29,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:29,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:29
2025-03-13 11:34:29,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:29,604 [INFO]: 	Creating the index 03/13/2025, 11:34:29
2025-03-13 11:34:29,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:29
2025-03-13 11:34:29,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:34:29,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:29
2025-03-13 11:34:29,605 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:34:29,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:08,  4.51it/s]
  8%|▊         | 3/40 [00:00<00:04,  7.62it/s]
 12%|█▎        | 5/40 [00:00<00:03,  8.77it/s]
 18%|█▊        | 7/40 [00:00<00:03,  9.38it/s]
 22%|██▎       | 9/40 [00:00<00:03,  9.82it/s]
 28%|██▊       | 11/40 [00:01<00:02, 11.19it/s]
 32%|███▎      | 13/40 [00:01<00:02, 10.62it/s]
 38%|███▊      | 15/40 [00:01<00:02, 10.26it/s]
 42%|████▎     | 17/40 [00:01<00:02, 10.10it/s]
 48%|████▊     | 19/40 [00:01<00:02, 10.03it/s]
 52%|█████▎    | 21/40 [00:05<00:11,  1.68it/s]
 55%|█████▌    | 22/40 [00:05<00:09,  1.98it/s]
 60%|██████    | 24/40 [00:05<00:05,  2.76it/s]
 65%|██████▌   | 26/40 [00:05<00:03,  3.69it/s]
 70%|███████   | 28/40 [00:05<00:02,  4.76it/s]
 75%|███████▌  | 30/40 [00:06<00:01,  6.22it/s]
 80%|████████  | 32/40 [00:06<00:01,  7.15it/s]
 85%|████████▌ | 34/40 [00:06<00:00,  8.82it/s]
 90%|█████████ | 36/40 [00:06<00:00, 10.58it/s]
 98%|█████████▊| 39/40 [00:06<00:00, 13.07it/s]
100%|██████████| 40/40 [00:11<00:00,  3.45it/s]
2025-03-13 11:34:41,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:41
2025-03-13 11:35:42,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7183 secs
2025-03-13 11:35:42,927 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 11:35:42,928 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:42

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s]
2025-03-13 11:36:06,929 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0018 secs
2025-03-13 11:36:06,933 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.3277 secs
2025-03-13 11:36:06,933 [INFO]: {
2025-03-13 11:36:06,933 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:06,933 [INFO]: 	index_param: efSearch=315
2025-03-13 11:36:06,933 [INFO]: 	index_path: knn.index
2025-03-13 11:36:06,933 [INFO]: 	size in bytes: 1909007470
2025-03-13 11:36:06,933 [INFO]: 	avg_search_speed_ms: 13.247237519502935
2025-03-13 11:36:06,933 [INFO]: 	99p_search_speed_ms: 17.98796427436174
2025-03-13 11:36:06,933 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:06,933 [INFO]: 	nb vectors: 9703
2025-03-13 11:36:06,933 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:06,933 [INFO]: 	compression ratio: 0.9993085171112505
2025-03-13 11:36:06,933 [INFO]: }
2025-03-13 11:36:06,933 [INFO]: 	>>> Finished "Creating the index" in 97.3291 secs
2025-03-13 11:36:06,933 [INFO]: >>> Finished "Launching the whole pipeline" in 97.3541 secs
2025-03-13 11:36:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 48896 [episode count 9/20]
[retrieval_preprocessing] for episode 782 [episode count 10/20], we have num_retrieval=np.int64(9185) num_query=np.int64(897)
2025-03-13 11:36:14,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:16,356 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:16
2025-03-13 11:36:16,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:16

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1389.30it/s]
2025-03-13 11:36:16,382 [INFO]: There are 9185 embeddings of dim 49152
2025-03-13 11:36:16,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 11:36:16,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:16
2025-03-13 11:36:16,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:16,383 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 11:36:16,383 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:36:16,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:16,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:16
2025-03-13 11:36:16,383 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:16,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:36:16,383 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:16
2025-03-13 11:36:16,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:16,383 [INFO]: 	Creating the index 03/13/2025, 11:36:16
2025-03-13 11:36:16,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:16
2025-03-13 11:36:16,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:36:16,384 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:16
2025-03-13 11:36:16,384 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 11:36:16,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/38 [00:00<?, ?it/s]
  3%|▎         | 1/38 [00:00<00:10,  3.64it/s]
  5%|▌         | 2/38 [00:00<00:07,  4.54it/s]
  8%|▊         | 3/38 [00:00<00:06,  5.19it/s]
 11%|█         | 4/38 [00:00<00:05,  5.96it/s]
 13%|█▎        | 5/38 [00:00<00:05,  6.55it/s]
 16%|█▌        | 6/38 [00:01<00:04,  6.89it/s]
 18%|█▊        | 7/38 [00:01<00:07,  4.35it/s]
 21%|██        | 8/38 [00:01<00:08,  3.72it/s]
 24%|██▎       | 9/38 [00:01<00:06,  4.26it/s]
 26%|██▋       | 10/38 [00:02<00:05,  5.02it/s]
 29%|██▉       | 11/38 [00:02<00:04,  5.47it/s]
 32%|███▏      | 12/38 [00:02<00:04,  6.23it/s]
 34%|███▍      | 13/38 [00:02<00:03,  6.86it/s]
 37%|███▋      | 14/38 [00:02<00:03,  7.49it/s]
 39%|███▉      | 15/38 [00:02<00:02,  7.85it/s]
 42%|████▏     | 16/38 [00:02<00:02,  8.22it/s]
 45%|████▍     | 17/38 [00:02<00:02,  8.44it/s]
 47%|████▋     | 18/38 [00:02<00:02,  8.42it/s]
 53%|█████▎    | 20/38 [00:03<00:01,  9.76it/s]
 55%|█████▌    | 21/38 [00:07<00:18,  1.07s/it]
 61%|██████    | 23/38 [00:07<00:09,  1.51it/s]
 66%|██████▌   | 25/38 [00:07<00:05,  2.24it/s]
 71%|███████   | 27/38 [00:07<00:03,  3.16it/s]
 76%|███████▋  | 29/38 [00:07<00:02,  4.23it/s]
 82%|████████▏ | 31/38 [00:07<00:01,  5.38it/s]
 87%|████████▋ | 33/38 [00:08<00:00,  6.61it/s]
 92%|█████████▏| 35/38 [00:08<00:00,  7.82it/s]
 97%|█████████▋| 37/38 [00:08<00:00,  9.18it/s]
100%|██████████| 38/38 [00:12<00:00,  3.16it/s]
2025-03-13 11:36:28,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:28
2025-03-13 11:37:30,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.0783 secs
2025-03-13 11:37:30,487 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 11:37:30,487 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:30

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.23it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 11:37:50,431 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9445 secs
2025-03-13 11:37:50,435 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.0504 secs
2025-03-13 11:37:50,435 [INFO]: {
2025-03-13 11:37:50,435 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:50,435 [INFO]: 	index_param: efSearch=286
2025-03-13 11:37:50,435 [INFO]: 	index_path: knn.index
2025-03-13 11:37:50,435 [INFO]: 	size in bytes: 1807094470
2025-03-13 11:37:50,435 [INFO]: 	avg_search_speed_ms: 14.07149081405268
2025-03-13 11:37:50,435 [INFO]: 	99p_search_speed_ms: 25.38368757814168
2025-03-13 11:37:50,435 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:50,435 [INFO]: 	nb vectors: 9185
2025-03-13 11:37:50,435 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:50,435 [INFO]: 	compression ratio: 0.9993082874079073
2025-03-13 11:37:50,435 [INFO]: }
2025-03-13 11:37:50,435 [INFO]: 	>>> Finished "Creating the index" in 94.0518 secs
2025-03-13 11:37:50,435 [INFO]: >>> Finished "Launching the whole pipeline" in 94.0785 secs
2025-03-13 11:37:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 782 [episode count 10/20]
[retrieval_preprocessing] for episode 89369 [episode count 11/20], we have num_retrieval=np.int64(9556) num_query=np.int64(526)
2025-03-13 11:38:04,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:06,232 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:06
2025-03-13 11:38:06,232 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:06

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1479.47it/s]
2025-03-13 11:38:06,257 [INFO]: There are 9556 embeddings of dim 49152
2025-03-13 11:38:06,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:38:06,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:06
2025-03-13 11:38:06,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:06,257 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 11:38:06,257 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:38:06,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:06,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:06
2025-03-13 11:38:06,258 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:06,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:38:06,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:06
2025-03-13 11:38:06,258 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:06,258 [INFO]: 	Creating the index 03/13/2025, 11:38:06
2025-03-13 11:38:06,258 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:06
2025-03-13 11:38:06,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:38:06,259 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:06
2025-03-13 11:38:06,259 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:38:06,259 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:08,  4.46it/s]
  8%|▊         | 3/39 [00:00<00:04,  8.26it/s]
 13%|█▎        | 5/39 [00:00<00:03,  9.74it/s]
 18%|█▊        | 7/39 [00:00<00:03, 10.47it/s]
 23%|██▎       | 9/39 [00:00<00:02, 10.71it/s]
 28%|██▊       | 11/39 [00:01<00:02, 10.86it/s]
 33%|███▎      | 13/39 [00:01<00:02, 10.95it/s]
 38%|███▊      | 15/39 [00:01<00:02, 11.01it/s]
 44%|████▎     | 17/39 [00:01<00:01, 11.07it/s]
 49%|████▊     | 19/39 [00:01<00:01, 11.09it/s]
 54%|█████▍    | 21/39 [00:05<00:10,  1.68it/s]
 59%|█████▉    | 23/39 [00:05<00:06,  2.29it/s]
 64%|██████▍   | 25/39 [00:05<00:04,  3.04it/s]
 69%|██████▉   | 27/39 [00:05<00:03,  3.95it/s]
 74%|███████▍  | 29/39 [00:05<00:02,  4.97it/s]
 79%|███████▉  | 31/39 [00:06<00:01,  6.05it/s]
 85%|████████▍ | 33/39 [00:06<00:00,  7.07it/s]
 90%|████████▉ | 35/39 [00:06<00:00,  8.11it/s]
 95%|█████████▍| 37/39 [00:06<00:00,  9.07it/s]
100%|██████████| 39/39 [00:11<00:00,  1.29it/s]
100%|██████████| 39/39 [00:11<00:00,  3.48it/s]
2025-03-13 11:38:17,483 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:17
2025-03-13 11:39:21,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6802 secs
2025-03-13 11:39:21,164 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 11:39:21,164 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:21

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.35it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 11:39:41,959 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7953 secs
2025-03-13 11:39:41,962 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.7030 secs
2025-03-13 11:39:41,962 [INFO]: {
2025-03-13 11:39:41,962 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:41,962 [INFO]: 	index_param: efSearch=302
2025-03-13 11:39:41,962 [INFO]: 	index_path: knn.index
2025-03-13 11:39:41,962 [INFO]: 	size in bytes: 1880086390
2025-03-13 11:39:41,962 [INFO]: 	avg_search_speed_ms: 13.044971352530524
2025-03-13 11:39:41,962 [INFO]: 	99p_search_speed_ms: 19.832647629082206
2025-03-13 11:39:41,962 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:41,962 [INFO]: 	nb vectors: 9556
2025-03-13 11:39:41,962 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:41,962 [INFO]: 	compression ratio: 0.9993083605057106
2025-03-13 11:39:41,962 [INFO]: }
2025-03-13 11:39:41,962 [INFO]: 	>>> Finished "Creating the index" in 95.7046 secs
2025-03-13 11:39:41,963 [INFO]: >>> Finished "Launching the whole pipeline" in 95.7308 secs
2025-03-13 11:39:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 89369 [episode count 11/20]
[retrieval_preprocessing] for episode 62295 [episode count 12/20], we have num_retrieval=np.int64(9597) num_query=np.int64(485)
2025-03-13 11:39:50,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:52,274 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:52
2025-03-13 11:39:52,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:52

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1447.31it/s]
2025-03-13 11:39:52,302 [INFO]: There are 9597 embeddings of dim 49152
2025-03-13 11:39:52,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:39:52,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:52
2025-03-13 11:39:52,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:52,303 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:39:52,303 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:39:52,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:39:52,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:52
2025-03-13 11:39:52,303 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:52,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:39:52,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:52
2025-03-13 11:39:52,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:52,304 [INFO]: 	Creating the index 03/13/2025, 11:39:52
2025-03-13 11:39:52,304 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:52
2025-03-13 11:39:52,307 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:39:52,307 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:52
2025-03-13 11:39:52,308 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:39:52,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:06,  5.75it/s]
  8%|▊         | 3/39 [00:00<00:03,  9.56it/s]
 10%|█         | 4/39 [00:00<00:04,  8.75it/s]
 13%|█▎        | 5/39 [00:00<00:04,  8.15it/s]
 15%|█▌        | 6/39 [00:00<00:04,  7.75it/s]
 18%|█▊        | 7/39 [00:00<00:04,  7.60it/s]
 21%|██        | 8/39 [00:00<00:03,  8.19it/s]
 26%|██▌       | 10/39 [00:01<00:02, 10.12it/s]
 31%|███       | 12/39 [00:01<00:02, 10.67it/s]
 36%|███▌      | 14/39 [00:01<00:02, 10.88it/s]
 41%|████      | 16/39 [00:01<00:02, 10.74it/s]
 46%|████▌     | 18/39 [00:01<00:01, 11.29it/s]
 51%|█████▏    | 20/39 [00:01<00:01, 11.93it/s]
 56%|█████▋    | 22/39 [00:05<00:10,  1.58it/s]
 59%|█████▉    | 23/39 [00:05<00:08,  1.85it/s]
 62%|██████▏   | 24/39 [00:05<00:06,  2.20it/s]
 67%|██████▋   | 26/39 [00:06<00:04,  3.13it/s]
 69%|██████▉   | 27/39 [00:06<00:03,  3.63it/s]
 72%|███████▏  | 28/39 [00:06<00:02,  4.22it/s]
 74%|███████▍  | 29/39 [00:06<00:02,  4.86it/s]
 77%|███████▋  | 30/39 [00:06<00:01,  5.44it/s]
 79%|███████▉  | 31/39 [00:06<00:01,  5.86it/s]
 82%|████████▏ | 32/39 [00:06<00:01,  6.28it/s]
 85%|████████▍ | 33/39 [00:06<00:00,  6.62it/s]
 87%|████████▋ | 34/39 [00:07<00:00,  6.87it/s]
 90%|████████▉ | 35/39 [00:07<00:00,  7.12it/s]
 92%|█████████▏| 36/39 [00:07<00:00,  7.24it/s]
 95%|█████████▍| 37/39 [00:07<00:00,  7.33it/s]
 97%|█████████▋| 38/39 [00:07<00:00,  7.75it/s]
100%|██████████| 39/39 [00:12<00:00,  1.57s/it]
100%|██████████| 39/39 [00:12<00:00,  3.12it/s]
2025-03-13 11:40:04,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:04
2025-03-13 11:41:04,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.1485 secs
2025-03-13 11:41:04,989 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 11:41:04,989 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:04

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 11:41:26,728 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7391 secs
2025-03-13 11:41:26,731 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.4236 secs
2025-03-13 11:41:26,731 [INFO]: {
2025-03-13 11:41:26,731 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:26,731 [INFO]: 	index_param: efSearch=277
2025-03-13 11:41:26,731 [INFO]: 	index_path: knn.index
2025-03-13 11:41:26,731 [INFO]: 	size in bytes: 1888152970
2025-03-13 11:41:26,731 [INFO]: 	avg_search_speed_ms: 12.731771143011123
2025-03-13 11:41:26,731 [INFO]: 	99p_search_speed_ms: 20.32779112923887
2025-03-13 11:41:26,731 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:26,732 [INFO]: 	nb vectors: 9597
2025-03-13 11:41:26,732 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:26,732 [INFO]: 	compression ratio: 0.9993083219311409
2025-03-13 11:41:26,732 [INFO]: }
2025-03-13 11:41:26,732 [INFO]: 	>>> Finished "Creating the index" in 94.4275 secs
2025-03-13 11:41:26,732 [INFO]: >>> Finished "Launching the whole pipeline" in 94.4579 secs
2025-03-13 11:41:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 62295 [episode count 12/20]
[retrieval_preprocessing] for episode 69450 [episode count 13/20], we have num_retrieval=np.int64(9684) num_query=np.int64(398)
2025-03-13 11:41:36,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:37,764 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:37
2025-03-13 11:41:37,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:37

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1209.43it/s]
2025-03-13 11:41:37,788 [INFO]: There are 9684 embeddings of dim 49152
2025-03-13 11:41:37,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:41:37,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:37,788 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:41:37,788 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:41:37,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:37,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,789 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:37,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:37,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:37
2025-03-13 11:41:37,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:37,789 [INFO]: 	Creating the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:37
2025-03-13 11:41:37,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:41:37,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,790 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:41:37,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:08,  4.71it/s]
  8%|▊         | 3/40 [00:00<00:04,  9.20it/s]
 12%|█▎        | 5/40 [00:00<00:03, 11.44it/s]
 18%|█▊        | 7/40 [00:00<00:02, 12.88it/s]
 22%|██▎       | 9/40 [00:00<00:02, 13.64it/s]
 28%|██▊       | 11/40 [00:00<00:01, 14.68it/s]
 32%|███▎      | 13/40 [00:00<00:01, 15.33it/s]
 38%|███▊      | 15/40 [00:01<00:01, 15.70it/s]
 42%|████▎     | 17/40 [00:01<00:01, 16.41it/s]
 48%|████▊     | 19/40 [00:01<00:01, 16.87it/s]
 52%|█████▎    | 21/40 [00:04<00:10,  1.85it/s]
 62%|██████▎   | 25/40 [00:04<00:04,  3.34it/s]
 75%|███████▌  | 30/40 [00:04<00:01,  5.74it/s]
 88%|████████▊ | 35/40 [00:04<00:00,  8.70it/s]
 98%|█████████▊| 39/40 [00:05<00:00, 11.46it/s]
100%|██████████| 40/40 [00:09<00:00,  4.13it/s]
2025-03-13 11:41:47,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:47
2025-03-13 11:43:03,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.9048 secs
2025-03-13 11:43:03,378 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:43:03,378 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:03

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 11:43:27,863 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4849 secs
2025-03-13 11:43:27,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.0767 secs
2025-03-13 11:43:27,867 [INFO]: {
2025-03-13 11:43:27,867 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:27,867 [INFO]: 	index_param: efSearch=238
2025-03-13 11:43:27,867 [INFO]: 	index_path: knn.index
2025-03-13 11:43:27,867 [INFO]: 	size in bytes: 1905269410
2025-03-13 11:43:27,867 [INFO]: 	avg_search_speed_ms: 12.969535557449289
2025-03-13 11:43:27,867 [INFO]: 	99p_search_speed_ms: 19.572104583494337
2025-03-13 11:43:27,867 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:27,867 [INFO]: 	nb vectors: 9684
2025-03-13 11:43:27,867 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:27,867 [INFO]: 	compression ratio: 0.9993084767996144
2025-03-13 11:43:27,867 [INFO]: }
2025-03-13 11:43:27,867 [INFO]: 	>>> Finished "Creating the index" in 110.0781 secs
2025-03-13 11:43:27,867 [INFO]: >>> Finished "Launching the whole pipeline" in 110.1027 secs
2025-03-13 11:43:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 69450 [episode count 13/20]
[retrieval_preprocessing] for episode 59752 [episode count 14/20], we have num_retrieval=np.int64(9590) num_query=np.int64(492)
2025-03-13 11:43:33,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:35,172 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:35
2025-03-13 11:43:35,173 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:35

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 938.95it/s]
2025-03-13 11:43:35,201 [INFO]: There are 9590 embeddings of dim 49152
2025-03-13 11:43:35,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 11:43:35,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:35
2025-03-13 11:43:35,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:35,201 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:43:35,201 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:43:35,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:35,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:35
2025-03-13 11:43:35,202 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:35,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:43:35,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:35
2025-03-13 11:43:35,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:35,202 [INFO]: 	Creating the index 03/13/2025, 11:43:35
2025-03-13 11:43:35,202 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:35
2025-03-13 11:43:35,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:35,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:35
2025-03-13 11:43:35,203 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:43:35,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:05,  6.95it/s]
 13%|█▎        | 5/39 [00:00<00:01, 22.62it/s]
 26%|██▌       | 10/39 [00:00<00:00, 31.75it/s]
 38%|███▊      | 15/39 [00:00<00:00, 36.26it/s]
 51%|█████▏    | 20/39 [00:00<00:00, 35.11it/s]
 62%|██████▏   | 24/39 [00:05<00:05,  2.64it/s]
 69%|██████▉   | 27/39 [00:05<00:03,  3.28it/s]
 77%|███████▋  | 30/39 [00:05<00:02,  4.06it/s]
 82%|████████▏ | 32/39 [00:05<00:01,  4.69it/s]
 87%|████████▋ | 34/39 [00:06<00:00,  5.43it/s]
 92%|█████████▏| 36/39 [00:06<00:00,  6.22it/s]
 97%|█████████▋| 38/39 [00:06<00:00,  7.09it/s]
100%|██████████| 39/39 [00:11<00:00,  3.42it/s]
2025-03-13 11:43:46,598 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:46
2025-03-13 11:44:47,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3063 secs
2025-03-13 11:44:47,905 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:44:47,905 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:47

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.60it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 11:45:08,180 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2747 secs
2025-03-13 11:45:08,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0575 secs
2025-03-13 11:45:08,261 [INFO]: {
2025-03-13 11:45:08,261 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:08,261 [INFO]: 	index_param: efSearch=299
2025-03-13 11:45:08,261 [INFO]: 	index_path: knn.index
2025-03-13 11:45:08,261 [INFO]: 	size in bytes: 1886775730
2025-03-13 11:45:08,261 [INFO]: 	avg_search_speed_ms: 12.881828698256513
2025-03-13 11:45:08,261 [INFO]: 	99p_search_speed_ms: 17.297347607091073
2025-03-13 11:45:08,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:08,261 [INFO]: 	nb vectors: 9590
2025-03-13 11:45:08,261 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:08,261 [INFO]: 	compression ratio: 0.9993083385697356
2025-03-13 11:45:08,261 [INFO]: }
2025-03-13 11:45:08,261 [INFO]: 	>>> Finished "Creating the index" in 93.0597 secs
2025-03-13 11:45:08,262 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0890 secs
2025-03-13 11:45:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 59752 [episode count 14/20]
[retrieval_preprocessing] for episode 34178 [episode count 15/20], we have num_retrieval=np.int64(9325) num_query=np.int64(757)
2025-03-13 11:45:17,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:18,997 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:18
2025-03-13 11:45:18,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1622.55it/s]
2025-03-13 11:45:19,030 [INFO]: There are 9325 embeddings of dim 49152
2025-03-13 11:45:19,031 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 11:45:19,031 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,031 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:19,031 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 11:45:19,031 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:45:19,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:45:19,032 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,032 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:19,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 11:45:19,033 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:19
2025-03-13 11:45:19,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:19,033 [INFO]: 	Creating the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,033 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:19
2025-03-13 11:45:19,036 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:45:19,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:19
2025-03-13 11:45:19,037 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 11:45:19,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/38 [00:00<?, ?it/s]
  3%|▎         | 1/38 [00:00<00:04,  8.40it/s]
 16%|█▌        | 6/38 [00:00<00:01, 30.27it/s]
 29%|██▉       | 11/38 [00:00<00:00, 36.86it/s]
 42%|████▏     | 16/38 [00:00<00:00, 39.92it/s]
 55%|█████▌    | 21/38 [00:05<00:07,  2.38it/s]
 66%|██████▌   | 25/38 [00:05<00:03,  3.35it/s]
 79%|███████▉  | 30/38 [00:05<00:01,  4.98it/s]
 92%|█████████▏| 35/38 [00:05<00:00,  7.09it/s]
100%|██████████| 38/38 [00:10<00:00,  3.75it/s]
2025-03-13 11:45:29,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:29
2025-03-13 11:46:40,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.5332 secs
2025-03-13 11:46:40,715 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 11:46:40,715 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:40

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.45it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 11:47:03,771 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0559 secs
2025-03-13 11:47:03,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.7373 secs
2025-03-13 11:47:03,774 [INFO]: {
2025-03-13 11:47:03,774 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:03,774 [INFO]: 	index_param: efSearch=197
2025-03-13 11:47:03,774 [INFO]: 	index_path: knn.index
2025-03-13 11:47:03,774 [INFO]: 	size in bytes: 1834638850
2025-03-13 11:47:03,774 [INFO]: 	avg_search_speed_ms: 10.35088311334181
2025-03-13 11:47:03,774 [INFO]: 	99p_search_speed_ms: 16.1067923414521
2025-03-13 11:47:03,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:03,774 [INFO]: 	nb vectors: 9325
2025-03-13 11:47:03,774 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:03,774 [INFO]: 	compression ratio: 0.9993081744671438
2025-03-13 11:47:03,775 [INFO]: }
2025-03-13 11:47:03,775 [INFO]: 	>>> Finished "Creating the index" in 104.7413 secs
2025-03-13 11:47:03,775 [INFO]: >>> Finished "Launching the whole pipeline" in 104.7777 secs
2025-03-13 11:47:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 34178 [episode count 15/20]
[retrieval_preprocessing] for episode 56692 [episode count 16/20], we have num_retrieval=np.int64(9162) num_query=np.int64(920)
2025-03-13 11:47:10,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:12,267 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:12
2025-03-13 11:47:12,267 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:12

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1356.06it/s]
2025-03-13 11:47:12,296 [INFO]: There are 9162 embeddings of dim 49152
2025-03-13 11:47:12,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:47:12,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:12,297 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 11:47:12,298 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:47:12,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:47:12,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,298 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:12,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:47:12,299 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:12
2025-03-13 11:47:12,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:12,299 [INFO]: 	Creating the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,299 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:12
2025-03-13 11:47:12,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:47:12,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,303 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 11:47:12,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/38 [00:00<?, ?it/s]
  3%|▎         | 1/38 [00:00<00:04,  8.82it/s]
 16%|█▌        | 6/38 [00:00<00:01, 31.42it/s]
 32%|███▏      | 12/38 [00:00<00:00, 41.35it/s]
 45%|████▍     | 17/38 [00:00<00:00, 40.03it/s]
 58%|█████▊    | 22/38 [00:04<00:05,  2.98it/s]
 71%|███████   | 27/38 [00:04<00:02,  4.42it/s]
 87%|████████▋ | 33/38 [00:04<00:00,  6.72it/s]
100%|██████████| 38/38 [00:09<00:00,  2.77it/s]
100%|██████████| 38/38 [00:09<00:00,  4.15it/s]
2025-03-13 11:47:21,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:21
2025-03-13 11:48:23,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.3615 secs
2025-03-13 11:48:23,823 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 11:48:23,823 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:23

  0%|          | 0/4 [00:00<?, ?it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 22.09it/s]
2025-03-13 11:48:55,631 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8081 secs
2025-03-13 11:48:55,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.3313 secs
2025-03-13 11:48:55,634 [INFO]: {
2025-03-13 11:48:55,634 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:55,634 [INFO]: 	index_param: efSearch=282
2025-03-13 11:48:55,634 [INFO]: 	index_path: knn.index
2025-03-13 11:48:55,634 [INFO]: 	size in bytes: 1802569390
2025-03-13 11:48:55,634 [INFO]: 	avg_search_speed_ms: 11.467169070458295
2025-03-13 11:48:55,634 [INFO]: 	99p_search_speed_ms: 15.715323577169327
2025-03-13 11:48:55,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:55,634 [INFO]: 	nb vectors: 9162
2025-03-13 11:48:55,634 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:55,634 [INFO]: 	compression ratio: 0.9993082685155327
2025-03-13 11:48:55,634 [INFO]: }
2025-03-13 11:48:55,634 [INFO]: 	>>> Finished "Creating the index" in 103.3351 secs
2025-03-13 11:48:55,634 [INFO]: >>> Finished "Launching the whole pipeline" in 103.3668 secs
2025-03-13 11:49:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 56692 [episode count 16/20]
[retrieval_preprocessing] for episode 42451 [episode count 17/20], we have num_retrieval=np.int64(9727) num_query=np.int64(355)
2025-03-13 11:49:08,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:09,986 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:09
2025-03-13 11:49:09,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:09

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1180.16it/s]
2025-03-13 11:49:10,018 [INFO]: There are 9727 embeddings of dim 49152
2025-03-13 11:49:10,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 11:49:10,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:10
2025-03-13 11:49:10,019 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:10,019 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:49:10,019 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:49:10,019 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 11:49:10,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:10
2025-03-13 11:49:10,020 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:10,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:49:10,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:10
2025-03-13 11:49:10,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:10,021 [INFO]: 	Creating the index 03/13/2025, 11:49:10
2025-03-13 11:49:10,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:10
2025-03-13 11:49:10,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:49:10,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:10
2025-03-13 11:49:10,025 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:49:10,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/40 [00:00<?, ?it/s]
  2%|▎         | 1/40 [00:00<00:04,  8.88it/s]
 15%|█▌        | 6/40 [00:00<00:01, 29.51it/s]
 28%|██▊       | 11/40 [00:00<00:00, 36.84it/s]
 40%|████      | 16/40 [00:00<00:00, 40.39it/s]
 52%|█████▎    | 21/40 [00:04<00:05,  3.37it/s]
 65%|██████▌   | 26/40 [00:04<00:02,  5.03it/s]
 80%|████████  | 32/40 [00:04<00:01,  7.65it/s]
 95%|█████████▌| 38/40 [00:04<00:00, 10.93it/s]
100%|██████████| 40/40 [00:09<00:00,  4.22it/s]
2025-03-13 11:49:19,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:19
2025-03-13 11:50:20,628 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1123 secs
2025-03-13 11:50:20,629 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 11:50:20,629 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:20

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.12it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.58it/s]
2025-03-13 11:50:55,217 [INFO]: 	>>> Finished "Compute fast metrics" in 34.5886 secs
2025-03-13 11:50:55,220 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.1950 secs
2025-03-13 11:50:55,220 [INFO]: {
2025-03-13 11:50:55,220 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:55,220 [INFO]: 	index_param: efSearch=323
2025-03-13 11:50:55,220 [INFO]: 	index_path: knn.index
2025-03-13 11:50:55,220 [INFO]: 	size in bytes: 1913729290
2025-03-13 11:50:55,220 [INFO]: 	avg_search_speed_ms: 15.443527098762354
2025-03-13 11:50:55,220 [INFO]: 	99p_search_speed_ms: 22.81577340094371
2025-03-13 11:50:55,220 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:55,220 [INFO]: 	nb vectors: 9727
2025-03-13 11:50:55,220 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:55,220 [INFO]: 	compression ratio: 0.9993085364753966
2025-03-13 11:50:55,220 [INFO]: }
2025-03-13 11:50:55,220 [INFO]: 	>>> Finished "Creating the index" in 105.1993 secs
2025-03-13 11:50:55,220 [INFO]: >>> Finished "Launching the whole pipeline" in 105.2337 secs
2025-03-13 11:50:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 42451 [episode count 17/20]
[retrieval_preprocessing] for episode 18391 [episode count 18/20], we have num_retrieval=np.int64(9408) num_query=np.int64(674)
2025-03-13 11:51:01,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:03,291 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:03
2025-03-13 11:51:03,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:03

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1272.54it/s]
2025-03-13 11:51:03,320 [INFO]: There are 9408 embeddings of dim 49152
2025-03-13 11:51:03,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 11:51:03,321 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:03
2025-03-13 11:51:03,321 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:03,321 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 11:51:03,321 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:51:03,321 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:51:03,321 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:03
2025-03-13 11:51:03,321 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:03,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:51:03,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:03
2025-03-13 11:51:03,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:03,321 [INFO]: 	Creating the index 03/13/2025, 11:51:03
2025-03-13 11:51:03,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:03
2025-03-13 11:51:03,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:51:03,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:03
2025-03-13 11:51:03,323 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 11:51:03,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:08,  4.35it/s]
  8%|▊         | 3/39 [00:00<00:04,  7.84it/s]
 13%|█▎        | 5/39 [00:00<00:03,  9.17it/s]
 18%|█▊        | 7/39 [00:00<00:03,  9.93it/s]
 23%|██▎       | 9/39 [00:00<00:02, 10.33it/s]
 28%|██▊       | 11/39 [00:01<00:02, 10.63it/s]
 33%|███▎      | 13/39 [00:01<00:02, 10.57it/s]
 38%|███▊      | 15/39 [00:01<00:02, 10.67it/s]
 44%|████▎     | 17/39 [00:01<00:02, 10.85it/s]
 49%|████▊     | 19/39 [00:01<00:01, 10.88it/s]
 54%|█████▍    | 21/39 [00:06<00:13,  1.38it/s]
 56%|█████▋    | 22/39 [00:06<00:10,  1.62it/s]
 59%|█████▉    | 23/39 [00:06<00:08,  1.96it/s]
 62%|██████▏   | 24/39 [00:06<00:06,  2.39it/s]
 64%|██████▍   | 25/39 [00:06<00:04,  2.92it/s]
 67%|██████▋   | 26/39 [00:06<00:03,  3.57it/s]
 72%|███████▏  | 28/39 [00:06<00:02,  4.94it/s]
 77%|███████▋  | 30/39 [00:07<00:01,  6.12it/s]
 82%|████████▏ | 32/39 [00:07<00:00,  7.14it/s]
 87%|████████▋ | 34/39 [00:07<00:00,  7.92it/s]
 92%|█████████▏| 36/39 [00:07<00:00,  8.52it/s]
 97%|█████████▋| 38/39 [00:07<00:00,  8.99it/s]
100%|██████████| 39/39 [00:12<00:00,  3.14it/s]
2025-03-13 11:51:15,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:15
2025-03-13 11:52:30,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.8711 secs
2025-03-13 11:52:30,612 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:52:30,612 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:30

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 11:52:57,317 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7050 secs
2025-03-13 11:52:57,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.9981 secs
2025-03-13 11:52:57,321 [INFO]: {
2025-03-13 11:52:57,321 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:57,321 [INFO]: 	index_param: efSearch=193
2025-03-13 11:52:57,321 [INFO]: 	index_path: knn.index
2025-03-13 11:52:57,321 [INFO]: 	size in bytes: 1850968390
2025-03-13 11:52:57,321 [INFO]: 	avg_search_speed_ms: 11.874424708142186
2025-03-13 11:52:57,321 [INFO]: 	99p_search_speed_ms: 24.503936280962087
2025-03-13 11:52:57,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:57,321 [INFO]: 	nb vectors: 9408
2025-03-13 11:52:57,321 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:57,321 [INFO]: 	compression ratio: 0.9993082939682184
2025-03-13 11:52:57,321 [INFO]: }
2025-03-13 11:52:57,321 [INFO]: 	>>> Finished "Creating the index" in 113.9997 secs
2025-03-13 11:52:57,321 [INFO]: >>> Finished "Launching the whole pipeline" in 114.0301 secs
2025-03-13 11:53:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 18391 [episode count 18/20]
[retrieval_preprocessing] for episode 92637 [episode count 19/20], we have num_retrieval=np.int64(9561) num_query=np.int64(521)
2025-03-13 11:53:06,995 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:08,209 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:08
2025-03-13 11:53:08,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:08

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1410.32it/s]
2025-03-13 11:53:08,240 [INFO]: There are 9561 embeddings of dim 49152
2025-03-13 11:53:08,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:53:08,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:08
2025-03-13 11:53:08,241 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:08,241 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 11:53:08,241 [INFO]: 		Total: 16.8 minutes
2025-03-13 11:53:08,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:53:08,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:08
2025-03-13 11:53:08,242 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:08,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:53:08,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:08
2025-03-13 11:53:08,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:08,243 [INFO]: 	Creating the index 03/13/2025, 11:53:08
2025-03-13 11:53:08,243 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:08
2025-03-13 11:53:08,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:53:08,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:08
2025-03-13 11:53:08,247 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 11:53:08,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/39 [00:00<?, ?it/s]
  3%|▎         | 1/39 [00:00<00:10,  3.78it/s]
  5%|▌         | 2/39 [00:00<00:06,  5.46it/s]
  8%|▊         | 3/39 [00:00<00:05,  6.39it/s]
 10%|█         | 4/39 [00:00<00:05,  6.92it/s]
 13%|█▎        | 5/39 [00:00<00:04,  7.53it/s]
 18%|█▊        | 7/39 [00:00<00:03,  8.86it/s]
 21%|██        | 8/39 [00:01<00:03,  8.65it/s]
 23%|██▎       | 9/39 [00:01<00:03,  8.44it/s]
 26%|██▌       | 10/39 [00:01<00:03,  8.30it/s]
 28%|██▊       | 11/39 [00:01<00:03,  8.27it/s]
 31%|███       | 12/39 [00:01<00:03,  8.17it/s]
 33%|███▎      | 13/39 [00:01<00:03,  8.07it/s]
 36%|███▌      | 14/39 [00:01<00:03,  8.04it/s]
 38%|███▊      | 15/39 [00:01<00:03,  7.97it/s]
 41%|████      | 16/39 [00:02<00:02,  7.96it/s]
 44%|████▎     | 17/39 [00:02<00:02,  7.86it/s]
 46%|████▌     | 18/39 [00:02<00:02,  7.80it/s]
 49%|████▊     | 19/39 [00:02<00:02,  7.76it/s]
 51%|█████▏    | 20/39 [00:02<00:02,  7.84it/s]
 54%|█████▍    | 21/39 [00:06<00:20,  1.13s/it]
 56%|█████▋    | 22/39 [00:06<00:14,  1.21it/s]
 62%|██████▏   | 24/39 [00:06<00:07,  2.04it/s]
 67%|██████▋   | 26/39 [00:06<00:04,  3.01it/s]
 69%|██████▉   | 27/39 [00:06<00:03,  3.55it/s]
 72%|███████▏  | 28/39 [00:06<00:02,  4.17it/s]
 74%|███████▍  | 29/39 [00:06<00:02,  4.86it/s]
 77%|███████▋  | 30/39 [00:06<00:01,  5.59it/s]
 79%|███████▉  | 31/39 [00:07<00:01,  6.28it/s]
 82%|████████▏ | 32/39 [00:07<00:01,  6.98it/s]
 85%|████████▍ | 33/39 [00:07<00:00,  7.51it/s]
 87%|████████▋ | 34/39 [00:07<00:00,  7.89it/s]
 92%|█████████▏| 36/39 [00:07<00:00,  8.88it/s]
 97%|█████████▋| 38/39 [00:07<00:00,  9.36it/s]
100%|██████████| 39/39 [00:12<00:00,  1.08s/it]
100%|██████████| 39/39 [00:12<00:00,  3.16it/s]
2025-03-13 11:53:20,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:20
2025-03-13 11:54:23,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.9184 secs
2025-03-13 11:54:23,497 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 11:54:23,497 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:23

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 11:54:45,435 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9377 secs
2025-03-13 11:54:45,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.1919 secs
2025-03-13 11:54:45,439 [INFO]: {
2025-03-13 11:54:45,439 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:45,439 [INFO]: 	index_param: efSearch=287
2025-03-13 11:54:45,439 [INFO]: 	index_path: knn.index
2025-03-13 11:54:45,439 [INFO]: 	size in bytes: 1881070090
2025-03-13 11:54:45,439 [INFO]: 	avg_search_speed_ms: 14.976593780102666
2025-03-13 11:54:45,439 [INFO]: 	99p_search_speed_ms: 25.05295858019964
2025-03-13 11:54:45,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:45,439 [INFO]: 	nb vectors: 9561
2025-03-13 11:54:45,439 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:45,439 [INFO]: 	compression ratio: 0.9993083713324047
2025-03-13 11:54:45,439 [INFO]: }
2025-03-13 11:54:45,439 [INFO]: 	>>> Finished "Creating the index" in 97.1961 secs
2025-03-13 11:54:45,439 [INFO]: >>> Finished "Launching the whole pipeline" in 97.2296 secs
2025-03-13 11:54:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 92637 [episode count 19/20]
2025-03-13 11:54:51: [retrieval_preprocessing] finished for 5550260365_put_lid_on_container [chosen_id count 1/260]
2025-03-13 11:54:54: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5594497977_Close the air fryer [chosen_id count 2/260]
2025-03-13 11:54:54: [retrieval_preprocessing] we have num_total=3920 embedding_dim=49152
[retrieval_preprocessing] for episode 35356 [episode count 0/20], we have num_retrieval=np.int64(3827) num_query=np.int64(93)
2025-03-13 11:54:56,558 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:57,232 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:57
2025-03-13 11:54:57,232 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:57

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1193.94it/s]
2025-03-13 11:54:57,259 [INFO]: There are 3827 embeddings of dim 49152
2025-03-13 11:54:57,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:54:57,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:57
2025-03-13 11:54:57,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:57,259 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 11:54:57,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:57,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:57,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:57
2025-03-13 11:54:57,260 [INFO]: 789.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:57,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:54:57,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:57
2025-03-13 11:54:57,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:57,260 [INFO]: 	Creating the index 03/13/2025, 11:54:57
2025-03-13 11:54:57,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:57
2025-03-13 11:54:57,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:54:57,261 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:57
2025-03-13 11:54:57,261 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:54:57,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:03,  4.86it/s]
 12%|█▎        | 2/16 [00:00<00:02,  6.53it/s]
 19%|█▉        | 3/16 [00:00<00:01,  7.22it/s]
 25%|██▌       | 4/16 [00:00<00:01,  7.58it/s]
 31%|███▏      | 5/16 [00:00<00:01,  7.80it/s]
 38%|███▊      | 6/16 [00:00<00:01,  7.94it/s]
 44%|████▍     | 7/16 [00:00<00:01,  8.14it/s]
 50%|█████     | 8/16 [00:01<00:00,  8.18it/s]
 56%|█████▋    | 9/16 [00:01<00:00,  8.21it/s]
 62%|██████▎   | 10/16 [00:01<00:00,  8.21it/s]
 69%|██████▉   | 11/16 [00:01<00:00,  8.24it/s]
 75%|███████▌  | 12/16 [00:01<00:00,  8.32it/s]
 81%|████████▏ | 13/16 [00:01<00:00,  8.28it/s]
 94%|█████████▍| 15/16 [00:01<00:00,  9.24it/s]
100%|██████████| 16/16 [00:04<00:00,  1.37it/s]
100%|██████████| 16/16 [00:04<00:00,  3.60it/s]
2025-03-13 11:55:01,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:01
2025-03-13 11:55:39,333 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6201 secs
2025-03-13 11:55:39,333 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 11:55:39,333 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:39

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.63it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 11:55:56,923 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5898 secs
2025-03-13 11:55:56,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6648 secs
2025-03-13 11:55:56,926 [INFO]: {
2025-03-13 11:55:56,926 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:56,926 [INFO]: 	index_param: efSearch=254
2025-03-13 11:55:56,926 [INFO]: 	index_path: knn.index
2025-03-13 11:55:56,926 [INFO]: 	size in bytes: 752939050
2025-03-13 11:55:56,926 [INFO]: 	avg_search_speed_ms: 10.89418319907153
2025-03-13 11:55:56,926 [INFO]: 	99p_search_speed_ms: 19.230122878216232
2025-03-13 11:55:56,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:56,926 [INFO]: 	nb vectors: 3827
2025-03-13 11:55:56,926 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:56,926 [INFO]: 	compression ratio: 0.9993090622673907
2025-03-13 11:55:56,926 [INFO]: }
2025-03-13 11:55:56,926 [INFO]: 	>>> Finished "Creating the index" in 59.6667 secs
2025-03-13 11:55:56,926 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6941 secs
2025-03-13 11:55:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 35356 [episode count 0/20]
[retrieval_preprocessing] for episode 91181 [episode count 1/20], we have num_retrieval=np.int64(3725) num_query=np.int64(195)
2025-03-13 11:55:59,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:59,761 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:59
2025-03-13 11:55:59,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:59

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1192.24it/s]
2025-03-13 11:55:59,787 [INFO]: There are 3725 embeddings of dim 49152
2025-03-13 11:55:59,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:55:59,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:59
2025-03-13 11:55:59,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:59,788 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:55:59,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:59,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:55:59,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:59
2025-03-13 11:55:59,788 [INFO]: 768.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:59,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:55:59,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:59
2025-03-13 11:55:59,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:59,788 [INFO]: 	Creating the index 03/13/2025, 11:55:59
2025-03-13 11:55:59,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:59
2025-03-13 11:55:59,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:55:59,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:59
2025-03-13 11:55:59,789 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:55:59,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.36it/s]
 20%|██        | 3/15 [00:00<00:01,  8.68it/s]
 33%|███▎      | 5/15 [00:00<00:01,  9.36it/s]
 40%|████      | 6/15 [00:00<00:00,  9.42it/s]
 47%|████▋     | 7/15 [00:00<00:00,  9.53it/s]
 53%|█████▎    | 8/15 [00:00<00:00,  9.64it/s]
 60%|██████    | 9/15 [00:00<00:00,  9.69it/s]
 73%|███████▎  | 11/15 [00:01<00:00,  9.59it/s]
 80%|████████  | 12/15 [00:01<00:00,  9.64it/s]
 87%|████████▋ | 13/15 [00:01<00:00,  9.73it/s]
100%|██████████| 15/15 [00:04<00:00,  1.31it/s]
100%|██████████| 15/15 [00:04<00:00,  3.19it/s]
2025-03-13 11:56:04,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:04
2025-03-13 11:56:43,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4719 secs
2025-03-13 11:56:43,973 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 11:56:43,973 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:43

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 11:57:02,094 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1215 secs
2025-03-13 11:57:02,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3183 secs
2025-03-13 11:57:02,108 [INFO]: {
2025-03-13 11:57:02,108 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:02,108 [INFO]: 	index_param: efSearch=181
2025-03-13 11:57:02,108 [INFO]: 	index_path: knn.index
2025-03-13 11:57:02,108 [INFO]: 	size in bytes: 732870970
2025-03-13 11:57:02,108 [INFO]: 	avg_search_speed_ms: 8.08308403634089
2025-03-13 11:57:02,108 [INFO]: 	99p_search_speed_ms: 11.995242061093453
2025-03-13 11:57:02,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:02,108 [INFO]: 	nb vectors: 3725
2025-03-13 11:57:02,108 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:02,108 [INFO]: 	compression ratio: 0.999309332719237
2025-03-13 11:57:02,108 [INFO]: }
2025-03-13 11:57:02,108 [INFO]: 	>>> Finished "Creating the index" in 62.3199 secs
2025-03-13 11:57:02,108 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3467 secs
2025-03-13 11:57:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 91181 [episode count 1/20]
[retrieval_preprocessing] for episode 35917 [episode count 2/20], we have num_retrieval=np.int64(3797) num_query=np.int64(123)
2025-03-13 11:57:04,880 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:05,552 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:05
2025-03-13 11:57:05,552 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:05

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1748.36it/s]
2025-03-13 11:57:05,576 [INFO]: There are 3797 embeddings of dim 49152
2025-03-13 11:57:05,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 11:57:05,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:05
2025-03-13 11:57:05,577 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:05,577 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 11:57:05,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:05,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:05,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:05
2025-03-13 11:57:05,577 [INFO]: 783.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:05,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:57:05,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:05
2025-03-13 11:57:05,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:05,577 [INFO]: 	Creating the index 03/13/2025, 11:57:05
2025-03-13 11:57:05,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:05
2025-03-13 11:57:05,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:57:05,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:05
2025-03-13 11:57:05,578 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:57:05,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:01,  9.17it/s]
 20%|██        | 3/15 [00:00<00:00, 12.20it/s]
 33%|███▎      | 5/15 [00:00<00:00, 12.48it/s]
 47%|████▋     | 7/15 [00:00<00:00, 12.63it/s]
 60%|██████    | 9/15 [00:00<00:00, 12.59it/s]
 73%|███████▎  | 11/15 [00:00<00:00, 12.68it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 12.62it/s]
100%|██████████| 15/15 [00:03<00:00,  2.00it/s]
100%|██████████| 15/15 [00:03<00:00,  3.94it/s]
2025-03-13 11:57:09,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:09
2025-03-13 11:57:45,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0763 secs
2025-03-13 11:57:45,473 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:57:45,473 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:45

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 11:57:59,772 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2988 secs
2025-03-13 11:57:59,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1966 secs
2025-03-13 11:57:59,775 [INFO]: {
2025-03-13 11:57:59,775 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:59,775 [INFO]: 	index_param: efSearch=238
2025-03-13 11:57:59,775 [INFO]: 	index_path: knn.index
2025-03-13 11:57:59,775 [INFO]: 	size in bytes: 747036610
2025-03-13 11:57:59,775 [INFO]: 	avg_search_speed_ms: 9.666067533024052
2025-03-13 11:57:59,775 [INFO]: 	99p_search_speed_ms: 15.098894983530045
2025-03-13 11:57:59,775 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:59,775 [INFO]: 	nb vectors: 3797
2025-03-13 11:57:59,775 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:59,775 [INFO]: 	compression ratio: 0.9993092252868303
2025-03-13 11:57:59,775 [INFO]: }
2025-03-13 11:57:59,775 [INFO]: 	>>> Finished "Creating the index" in 54.1982 secs
2025-03-13 11:57:59,775 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2235 secs
2025-03-13 11:58:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 35917 [episode count 2/20]
[retrieval_preprocessing] for episode 27727 [episode count 3/20], we have num_retrieval=np.int64(3169) num_query=np.int64(751)
2025-03-13 11:58:02,328 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:02,893 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:02
2025-03-13 11:58:02,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:02

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-13 11:58:02,934 [INFO]: There are 3169 embeddings of dim 49152
2025-03-13 11:58:02,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 11:58:02,934 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:02,934 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:58:02,934 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:02,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:58:02,934 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,935 [INFO]: 654.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:02,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:02,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:02
2025-03-13 11:58:02,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:02,935 [INFO]: 	Creating the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:02
2025-03-13 11:58:02,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:58:02,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:02
2025-03-13 11:58:02,937 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:58:02,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:02,  5.63it/s]
 23%|██▎       | 3/13 [00:00<00:01,  8.89it/s]
 38%|███▊      | 5/13 [00:00<00:00, 10.01it/s]
 54%|█████▍    | 7/13 [00:00<00:00, 10.27it/s]
 69%|██████▉   | 9/13 [00:00<00:00, 11.20it/s]
 85%|████████▍ | 11/13 [00:00<00:00, 12.63it/s]
100%|██████████| 13/13 [00:03<00:00,  2.38it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
2025-03-13 11:58:06,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:06
2025-03-13 11:58:44,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4159 secs
2025-03-13 11:58:44,553 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 11:58:44,553 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:44

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.55it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 11:59:01,529 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9761 secs
2025-03-13 11:59:01,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5954 secs
2025-03-13 11:59:01,532 [INFO]: {
2025-03-13 11:59:01,532 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:01,532 [INFO]: 	index_param: efSearch=180
2025-03-13 11:59:01,532 [INFO]: 	index_path: knn.index
2025-03-13 11:59:01,532 [INFO]: 	size in bytes: 623481130
2025-03-13 11:59:01,532 [INFO]: 	avg_search_speed_ms: 8.573676998436286
2025-03-13 11:59:01,533 [INFO]: 	99p_search_speed_ms: 15.820288984104966
2025-03-13 11:59:01,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:01,533 [INFO]: 	nb vectors: 3169
2025-03-13 11:59:01,533 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:01,533 [INFO]: 	compression ratio: 0.9993097176814316
2025-03-13 11:59:01,533 [INFO]: }
2025-03-13 11:59:01,533 [INFO]: 	>>> Finished "Creating the index" in 58.5977 secs
2025-03-13 11:59:01,533 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6392 secs
2025-03-13 11:59:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 27727 [episode count 3/20]
[retrieval_preprocessing] for episode 72814 [episode count 4/20], we have num_retrieval=np.int64(3844) num_query=np.int64(76)
2025-03-13 11:59:10,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:10,905 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:10
2025-03-13 11:59:10,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:10

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1518.57it/s]
2025-03-13 11:59:10,933 [INFO]: There are 3844 embeddings of dim 49152
2025-03-13 11:59:10,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 11:59:10,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:10
2025-03-13 11:59:10,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:10,934 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 11:59:10,934 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:10,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:59:10,934 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:10
2025-03-13 11:59:10,934 [INFO]: 793.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:10,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:59:10,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:10
2025-03-13 11:59:10,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:10,935 [INFO]: 	Creating the index 03/13/2025, 11:59:10
2025-03-13 11:59:10,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:10
2025-03-13 11:59:10,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:59:10,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:10
2025-03-13 11:59:10,939 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:59:10,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:02,  5.80it/s]
 19%|█▉        | 3/16 [00:00<00:01,  8.85it/s]
 31%|███▏      | 5/16 [00:00<00:01,  9.89it/s]
 38%|███▊      | 6/16 [00:00<00:01,  8.97it/s]
 44%|████▍     | 7/16 [00:00<00:01,  8.99it/s]
 56%|█████▋    | 9/16 [00:00<00:00,  9.98it/s]
 69%|██████▉   | 11/16 [00:01<00:00, 10.60it/s]
 81%|████████▏ | 13/16 [00:01<00:00, 10.86it/s]
 94%|█████████▍| 15/16 [00:01<00:00, 11.06it/s]
100%|██████████| 16/16 [00:04<00:00,  3.72it/s]
2025-03-13 11:59:15,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:15
2025-03-13 11:59:53,740 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4921 secs
2025-03-13 11:59:53,741 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 11:59:53,741 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:53

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s]
2025-03-13 12:00:14,915 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1737 secs
2025-03-13 12:00:14,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9787 secs
2025-03-13 12:00:14,917 [INFO]: {
2025-03-13 12:00:14,917 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:14,917 [INFO]: 	index_param: efSearch=214
2025-03-13 12:00:14,917 [INFO]: 	index_path: knn.index
2025-03-13 12:00:14,917 [INFO]: 	size in bytes: 756283810
2025-03-13 12:00:14,917 [INFO]: 	avg_search_speed_ms: 8.441144678710257
2025-03-13 12:00:14,917 [INFO]: 	99p_search_speed_ms: 16.252984246239077
2025-03-13 12:00:14,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:14,918 [INFO]: 	nb vectors: 3844
2025-03-13 12:00:14,918 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:14,918 [INFO]: 	compression ratio: 0.9993089128802056
2025-03-13 12:00:14,918 [INFO]: }
2025-03-13 12:00:14,918 [INFO]: 	>>> Finished "Creating the index" in 63.9825 secs
2025-03-13 12:00:14,918 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0125 secs
2025-03-13 12:00:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 72814 [episode count 4/20]
[retrieval_preprocessing] for episode 46179 [episode count 5/20], we have num_retrieval=np.int64(3305) num_query=np.int64(615)
2025-03-13 12:00:16,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:17,270 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:17
2025-03-13 12:00:17,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:17

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1536.94it/s]
2025-03-13 12:00:17,296 [INFO]: There are 3305 embeddings of dim 49152
2025-03-13 12:00:17,296 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 12:00:17,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:17
2025-03-13 12:00:17,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:17,297 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 12:00:17,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:17,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:00:17,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:17
2025-03-13 12:00:17,298 [INFO]: 682.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:17,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:00:17,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:17
2025-03-13 12:00:17,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:17,298 [INFO]: 	Creating the index 03/13/2025, 12:00:17
2025-03-13 12:00:17,299 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:17
2025-03-13 12:00:17,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:00:17,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:17
2025-03-13 12:00:17,302 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:00:17,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  6.67it/s]
 21%|██▏       | 3/14 [00:00<00:01, 10.05it/s]
 36%|███▌      | 5/14 [00:00<00:00, 11.04it/s]
 50%|█████     | 7/14 [00:00<00:00, 11.53it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 11.65it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 11.83it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 11.90it/s]
100%|██████████| 14/14 [00:03<00:00,  3.75it/s]
2025-03-13 12:00:21,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:21
2025-03-13 12:00:56,064 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0201 secs
2025-03-13 12:00:56,064 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 12:00:56,064 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:56

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.40it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 12:01:19,972 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9080 secs
2025-03-13 12:01:19,976 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6737 secs
2025-03-13 12:01:19,976 [INFO]: {
2025-03-13 12:01:19,976 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:19,976 [INFO]: 	index_param: efSearch=171
2025-03-13 12:01:19,976 [INFO]: 	index_path: knn.index
2025-03-13 12:01:19,976 [INFO]: 	size in bytes: 650238730
2025-03-13 12:01:19,976 [INFO]: 	avg_search_speed_ms: 7.412170268491739
2025-03-13 12:01:19,976 [INFO]: 	99p_search_speed_ms: 11.666409713216124
2025-03-13 12:01:19,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:19,976 [INFO]: 	nb vectors: 3305
2025-03-13 12:01:19,976 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:19,976 [INFO]: 	compression ratio: 0.9993090383896388
2025-03-13 12:01:19,976 [INFO]: }
2025-03-13 12:01:19,976 [INFO]: 	>>> Finished "Creating the index" in 62.6774 secs
2025-03-13 12:01:19,976 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7057 secs
2025-03-13 12:01:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 46179 [episode count 5/20]
[retrieval_preprocessing] for episode 84091 [episode count 6/20], we have num_retrieval=np.int64(3820) num_query=np.int64(100)
2025-03-13 12:01:25,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:26,293 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:26
2025-03-13 12:01:26,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:26

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2272.10it/s]
2025-03-13 12:01:26,315 [INFO]: There are 3820 embeddings of dim 49152
2025-03-13 12:01:26,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 12:01:26,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:26
2025-03-13 12:01:26,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:26,315 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:01:26,315 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:26,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:26,315 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:26
2025-03-13 12:01:26,316 [INFO]: 788.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:26,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:01:26,316 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:26
2025-03-13 12:01:26,316 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:26,316 [INFO]: 	Creating the index 03/13/2025, 12:01:26
2025-03-13 12:01:26,316 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:26
2025-03-13 12:01:26,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:01:26,317 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:26
2025-03-13 12:01:26,317 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:01:26,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:02,  6.18it/s]
 19%|█▉        | 3/16 [00:00<00:01,  9.64it/s]
 31%|███▏      | 5/16 [00:00<00:01, 10.96it/s]
 44%|████▍     | 7/16 [00:00<00:00, 11.42it/s]
 56%|█████▋    | 9/16 [00:00<00:00, 11.61it/s]
 69%|██████▉   | 11/16 [00:00<00:00, 11.87it/s]
 81%|████████▏ | 13/16 [00:01<00:00, 11.98it/s]
 94%|█████████▍| 15/16 [00:01<00:00, 12.08it/s]
100%|██████████| 16/16 [00:03<00:00,  4.07it/s]
2025-03-13 12:01:30,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:30
2025-03-13 12:02:04,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3748 secs
2025-03-13 12:02:04,636 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:02:04,636 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:04

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.16it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 12:02:24,401 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7654 secs
2025-03-13 12:02:24,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0872 secs
2025-03-13 12:02:24,404 [INFO]: {
2025-03-13 12:02:24,404 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:24,404 [INFO]: 	index_param: efSearch=258
2025-03-13 12:02:24,404 [INFO]: 	index_path: knn.index
2025-03-13 12:02:24,404 [INFO]: 	size in bytes: 751561810
2025-03-13 12:02:24,404 [INFO]: 	avg_search_speed_ms: 11.68458963440792
2025-03-13 12:02:24,404 [INFO]: 	99p_search_speed_ms: 16.327641054522246
2025-03-13 12:02:24,404 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:24,404 [INFO]: 	nb vectors: 3820
2025-03-13 12:02:24,404 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:24,404 [INFO]: 	compression ratio: 0.9993091053948044
2025-03-13 12:02:24,404 [INFO]: }
2025-03-13 12:02:24,404 [INFO]: 	>>> Finished "Creating the index" in 58.0887 secs
2025-03-13 12:02:24,404 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1116 secs
2025-03-13 12:02:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 84091 [episode count 6/20]
[retrieval_preprocessing] for episode 68749 [episode count 7/20], we have num_retrieval=np.int64(3850) num_query=np.int64(70)
2025-03-13 12:02:26,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:28,194 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:28
2025-03-13 12:02:28,194 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:28

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1680.41it/s]
2025-03-13 12:02:28,220 [INFO]: There are 3850 embeddings of dim 49152
2025-03-13 12:02:28,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 12:02:28,221 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:28,221 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:02:28,222 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:28,222 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:02:28,222 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,222 [INFO]: 794.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:28,222 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:02:28,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:28
2025-03-13 12:02:28,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:28,223 [INFO]: 	Creating the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:28
2025-03-13 12:02:28,226 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:02:28,226 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,226 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:02:28,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:02,  5.24it/s]
 12%|█▎        | 2/16 [00:00<00:02,  6.59it/s]
 19%|█▉        | 3/16 [00:00<00:01,  7.16it/s]
 25%|██▌       | 4/16 [00:00<00:01,  7.49it/s]
 31%|███▏      | 5/16 [00:00<00:01,  7.77it/s]
 38%|███▊      | 6/16 [00:00<00:01,  7.92it/s]
 44%|████▍     | 7/16 [00:00<00:01,  8.29it/s]
 50%|█████     | 8/16 [00:01<00:00,  8.56it/s]
 56%|█████▋    | 9/16 [00:01<00:00,  8.90it/s]
 62%|██████▎   | 10/16 [00:01<00:00,  9.14it/s]
 75%|███████▌  | 12/16 [00:01<00:00,  9.38it/s]
 81%|████████▏ | 13/16 [00:01<00:00,  9.03it/s]
 88%|████████▊ | 14/16 [00:01<00:00,  8.79it/s]
 94%|█████████▍| 15/16 [00:01<00:00,  8.86it/s]
100%|██████████| 16/16 [00:04<00:00,  1.10it/s]
100%|██████████| 16/16 [00:04<00:00,  3.37it/s]
2025-03-13 12:02:32,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:32
2025-03-13 12:03:05,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9643 secs
2025-03-13 12:03:05,938 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 12:03:05,938 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:05

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.47it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s]
2025-03-13 12:03:23,017 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0784 secs
2025-03-13 12:03:23,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7939 secs
2025-03-13 12:03:23,020 [INFO]: {
2025-03-13 12:03:23,020 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:23,020 [INFO]: 	index_param: efSearch=225
2025-03-13 12:03:23,020 [INFO]: 	index_path: knn.index
2025-03-13 12:03:23,020 [INFO]: 	size in bytes: 757464250
2025-03-13 12:03:23,020 [INFO]: 	avg_search_speed_ms: 9.870046013102847
2025-03-13 12:03:23,020 [INFO]: 	99p_search_speed_ms: 18.938605019357063
2025-03-13 12:03:23,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:23,021 [INFO]: 	nb vectors: 3850
2025-03-13 12:03:23,021 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:23,021 [INFO]: 	compression ratio: 0.9993089442835091
2025-03-13 12:03:23,021 [INFO]: }
2025-03-13 12:03:23,021 [INFO]: 	>>> Finished "Creating the index" in 54.7975 secs
2025-03-13 12:03:23,021 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8265 secs
2025-03-13 12:03:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 68749 [episode count 7/20]
[retrieval_preprocessing] for episode 58012 [episode count 8/20], we have num_retrieval=np.int64(3823) num_query=np.int64(97)
2025-03-13 12:03:25,062 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:25,612 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:25
2025-03-13 12:03:25,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:25

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-13 12:03:25,637 [INFO]: There are 3823 embeddings of dim 49152
2025-03-13 12:03:25,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 12:03:25,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:25
2025-03-13 12:03:25,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:25,637 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:03:25,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:25,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:25,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:25
2025-03-13 12:03:25,637 [INFO]: 789.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:25,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:03:25,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:25
2025-03-13 12:03:25,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:25,637 [INFO]: 	Creating the index 03/13/2025, 12:03:25
2025-03-13 12:03:25,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:25
2025-03-13 12:03:25,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:03:25,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:25
2025-03-13 12:03:25,639 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:03:25,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:01,  7.54it/s]
 19%|█▉        | 3/16 [00:00<00:01, 10.38it/s]
 31%|███▏      | 5/16 [00:00<00:00, 11.30it/s]
 44%|████▍     | 7/16 [00:00<00:00, 11.78it/s]
 56%|█████▋    | 9/16 [00:00<00:00, 11.90it/s]
 69%|██████▉   | 11/16 [00:00<00:00, 12.30it/s]
 81%|████████▏ | 13/16 [00:01<00:00, 12.43it/s]
 94%|█████████▍| 15/16 [00:01<00:00, 12.42it/s]
100%|██████████| 16/16 [00:03<00:00,  4.23it/s]
2025-03-13 12:03:29,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:29
2025-03-13 12:04:02,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5062 secs
2025-03-13 12:04:02,936 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 12:04:02,936 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:02

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.87it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 12:04:19,886 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9500 secs
2025-03-13 12:04:19,889 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2499 secs
2025-03-13 12:04:19,889 [INFO]: {
2025-03-13 12:04:19,889 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:19,889 [INFO]: 	index_param: efSearch=254
2025-03-13 12:04:19,889 [INFO]: 	index_path: knn.index
2025-03-13 12:04:19,889 [INFO]: 	size in bytes: 752152030
2025-03-13 12:04:19,889 [INFO]: 	avg_search_speed_ms: 10.725899105851614
2025-03-13 12:04:19,889 [INFO]: 	99p_search_speed_ms: 14.385262797586618
2025-03-13 12:04:19,889 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:19,889 [INFO]: 	nb vectors: 3823
2025-03-13 12:04:19,889 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:19,889 [INFO]: 	compression ratio: 0.9993091210562843
2025-03-13 12:04:19,889 [INFO]: }
2025-03-13 12:04:19,889 [INFO]: 	>>> Finished "Creating the index" in 54.2513 secs
2025-03-13 12:04:19,889 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2770 secs
2025-03-13 12:04:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 58012 [episode count 8/20]
[retrieval_preprocessing] for episode 76460 [episode count 9/20], we have num_retrieval=np.int64(3804) num_query=np.int64(116)
2025-03-13 12:04:22,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:22,836 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:22
2025-03-13 12:04:22,836 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:22

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-13 12:04:22,858 [INFO]: There are 3804 embeddings of dim 49152
2025-03-13 12:04:22,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 12:04:22,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:22
2025-03-13 12:04:22,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:22,858 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:04:22,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:22,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:22,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:22
2025-03-13 12:04:22,859 [INFO]: 785.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:22,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:22,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:22
2025-03-13 12:04:22,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:22,859 [INFO]: 	Creating the index 03/13/2025, 12:04:22
2025-03-13 12:04:22,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:22
2025-03-13 12:04:22,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:04:22,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:22
2025-03-13 12:04:22,860 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:04:22,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.53it/s]
 20%|██        | 3/15 [00:00<00:01,  9.35it/s]
 33%|███▎      | 5/15 [00:00<00:00, 10.59it/s]
 47%|████▋     | 7/15 [00:00<00:00, 11.24it/s]
 60%|██████    | 9/15 [00:00<00:00, 11.70it/s]
 73%|███████▎  | 11/15 [00:00<00:00, 11.91it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 12.13it/s]
100%|██████████| 15/15 [00:03<00:00,  2.09it/s]
100%|██████████| 15/15 [00:03<00:00,  3.98it/s]
2025-03-13 12:04:26,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:26
2025-03-13 12:04:58,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2047 secs
2025-03-13 12:04:58,837 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:04:58,837 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:58

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 12:05:21,180 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3427 secs
2025-03-13 12:05:21,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3229 secs
2025-03-13 12:05:21,183 [INFO]: {
2025-03-13 12:05:21,183 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:21,183 [INFO]: 	index_param: efSearch=253
2025-03-13 12:05:21,183 [INFO]: 	index_path: knn.index
2025-03-13 12:05:21,183 [INFO]: 	size in bytes: 748413850
2025-03-13 12:05:21,183 [INFO]: 	avg_search_speed_ms: 11.584972086452112
2025-03-13 12:05:21,183 [INFO]: 	99p_search_speed_ms: 18.889285027980804
2025-03-13 12:05:21,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:21,183 [INFO]: 	nb vectors: 3804
2025-03-13 12:05:21,183 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:21,183 [INFO]: 	compression ratio: 0.9993091816780248
2025-03-13 12:05:21,183 [INFO]: }
2025-03-13 12:05:21,183 [INFO]: 	>>> Finished "Creating the index" in 58.3245 secs
2025-03-13 12:05:21,183 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3476 secs
2025-03-13 12:05:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 76460 [episode count 9/20]
[retrieval_preprocessing] for episode 15264 [episode count 10/20], we have num_retrieval=np.int64(3806) num_query=np.int64(114)
2025-03-13 12:05:23,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:24,558 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:24
2025-03-13 12:05:24,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:24

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-13 12:05:24,583 [INFO]: There are 3806 embeddings of dim 49152
2025-03-13 12:05:24,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:05:24,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:24,583 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:05:24,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:24,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:24,583 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,584 [INFO]: 785.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:24,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:05:24,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:24
2025-03-13 12:05:24,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:24,584 [INFO]: 	Creating the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:24
2025-03-13 12:05:24,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:05:24,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,586 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:05:24,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.99it/s]
 13%|█▎        | 2/15 [00:00<00:01,  7.72it/s]
 20%|██        | 3/15 [00:00<00:01,  8.21it/s]
 27%|██▋       | 4/15 [00:00<00:01,  8.71it/s]
 33%|███▎      | 5/15 [00:00<00:01,  8.93it/s]
 40%|████      | 6/15 [00:00<00:01,  8.92it/s]
 53%|█████▎    | 8/15 [00:00<00:00, 10.06it/s]
 67%|██████▋   | 10/15 [00:01<00:00, 10.24it/s]
 80%|████████  | 12/15 [00:01<00:00,  9.81it/s]
 87%|████████▋ | 13/15 [00:01<00:00,  9.61it/s]
 93%|█████████▎| 14/15 [00:01<00:00,  9.39it/s]
100%|██████████| 15/15 [00:04<00:00,  1.23it/s]
100%|██████████| 15/15 [00:04<00:00,  3.35it/s]
2025-03-13 12:05:29,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:29
2025-03-13 12:06:01,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4914 secs
2025-03-13 12:06:01,558 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 12:06:01,558 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:01

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s]
 50%|█████     | 2/4 [00:00<00:00,  5.57it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 12:06:17,884 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3265 secs
2025-03-13 12:06:17,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3015 secs
2025-03-13 12:06:17,887 [INFO]: {
2025-03-13 12:06:17,887 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:17,887 [INFO]: 	index_param: efSearch=267
2025-03-13 12:06:17,887 [INFO]: 	index_path: knn.index
2025-03-13 12:06:17,887 [INFO]: 	size in bytes: 748807390
2025-03-13 12:06:17,887 [INFO]: 	avg_search_speed_ms: 11.703370924636024
2025-03-13 12:06:17,887 [INFO]: 	99p_search_speed_ms: 16.158235473558314
2025-03-13 12:06:17,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:17,887 [INFO]: 	nb vectors: 3806
2025-03-13 12:06:17,887 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:17,887 [INFO]: 	compression ratio: 0.9993091120535015
2025-03-13 12:06:17,887 [INFO]: }
2025-03-13 12:06:17,887 [INFO]: 	>>> Finished "Creating the index" in 53.3037 secs
2025-03-13 12:06:17,887 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3291 secs
2025-03-13 12:06:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 15264 [episode count 10/20]
[retrieval_preprocessing] for episode 39301 [episode count 11/20], we have num_retrieval=np.int64(3807) num_query=np.int64(113)
2025-03-13 12:06:19,979 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:20,606 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:20
2025-03-13 12:06:20,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:20

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1839.61it/s]
2025-03-13 12:06:20,630 [INFO]: There are 3807 embeddings of dim 49152
2025-03-13 12:06:20,630 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 12:06:20,630 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:20
2025-03-13 12:06:20,630 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:20,630 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:06:20,630 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:20,630 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:06:20,630 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:20
2025-03-13 12:06:20,631 [INFO]: 785.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:20,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:06:20,631 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:20
2025-03-13 12:06:20,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:20,631 [INFO]: 	Creating the index 03/13/2025, 12:06:20
2025-03-13 12:06:20,631 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:20
2025-03-13 12:06:20,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 12:06:20,633 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:20
2025-03-13 12:06:20,633 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:06:20,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.51it/s]
 13%|█▎        | 2/15 [00:00<00:02,  6.45it/s]
 20%|██        | 3/15 [00:00<00:01,  7.31it/s]
 27%|██▋       | 4/15 [00:00<00:01,  7.96it/s]
 33%|███▎      | 5/15 [00:00<00:01,  8.30it/s]
 40%|████      | 6/15 [00:00<00:01,  8.41it/s]
 47%|████▋     | 7/15 [00:00<00:00,  8.24it/s]
 53%|█████▎    | 8/15 [00:00<00:00,  8.70it/s]
 67%|██████▋   | 10/15 [00:01<00:00,  9.22it/s]
 80%|████████  | 12/15 [00:01<00:00,  9.58it/s]
 87%|████████▋ | 13/15 [00:01<00:00,  9.41it/s]
 93%|█████████▎| 14/15 [00:01<00:00,  9.25it/s]
100%|██████████| 15/15 [00:04<00:00,  1.22it/s]
100%|██████████| 15/15 [00:04<00:00,  3.34it/s]
2025-03-13 12:06:25,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:25
2025-03-13 12:06:58,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1668 secs
2025-03-13 12:06:58,295 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:06:58,295 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:58

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.35it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 12:07:15,937 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6422 secs
2025-03-13 12:07:15,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3072 secs
2025-03-13 12:07:15,940 [INFO]: {
2025-03-13 12:07:15,940 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:15,940 [INFO]: 	index_param: efSearch=250
2025-03-13 12:07:15,940 [INFO]: 	index_path: knn.index
2025-03-13 12:07:15,940 [INFO]: 	size in bytes: 749004130
2025-03-13 12:07:15,940 [INFO]: 	avg_search_speed_ms: 11.65931898094323
2025-03-13 12:07:15,940 [INFO]: 	99p_search_speed_ms: 18.012593102175696
2025-03-13 12:07:15,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:15,940 [INFO]: 	nb vectors: 3807
2025-03-13 12:07:15,940 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:15,940 [INFO]: 	compression ratio: 0.9993091172941864
2025-03-13 12:07:15,940 [INFO]: }
2025-03-13 12:07:15,940 [INFO]: 	>>> Finished "Creating the index" in 55.3093 secs
2025-03-13 12:07:15,940 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3345 secs
2025-03-13 12:07:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 39301 [episode count 11/20]
[retrieval_preprocessing] for episode 31968 [episode count 12/20], we have num_retrieval=np.int64(3771) num_query=np.int64(149)
2025-03-13 12:07:18,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:18,915 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:18
2025-03-13 12:07:18,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 12:07:18,939 [INFO]: There are 3771 embeddings of dim 49152
2025-03-13 12:07:18,939 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 12:07:18,939 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:18
2025-03-13 12:07:18,939 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:18,939 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:07:18,939 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:18,939 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:07:18,939 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:18
2025-03-13 12:07:18,940 [INFO]: 778.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:18,940 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:07:18,940 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:18
2025-03-13 12:07:18,940 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:18,940 [INFO]: 	Creating the index 03/13/2025, 12:07:18
2025-03-13 12:07:18,940 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:18
2025-03-13 12:07:18,941 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:07:18,941 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:18
2025-03-13 12:07:18,941 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:07:18,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  6.31it/s]
 20%|██        | 3/15 [00:00<00:01, 10.18it/s]
 33%|███▎      | 5/15 [00:00<00:00, 11.41it/s]
 47%|████▋     | 7/15 [00:00<00:00, 12.03it/s]
 60%|██████    | 9/15 [00:00<00:00, 12.40it/s]
 73%|███████▎  | 11/15 [00:00<00:00, 12.54it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 12.63it/s]
100%|██████████| 15/15 [00:03<00:00,  2.11it/s]
100%|██████████| 15/15 [00:03<00:00,  4.06it/s]
2025-03-13 12:07:22,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:22
2025-03-13 12:07:55,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6931 secs
2025-03-13 12:07:55,336 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 12:07:55,336 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:55

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-13 12:08:14,558 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2220 secs
2025-03-13 12:08:14,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7439 secs
2025-03-13 12:08:14,685 [INFO]: {
2025-03-13 12:08:14,685 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:14,685 [INFO]: 	index_param: efSearch=238
2025-03-13 12:08:14,685 [INFO]: 	index_path: knn.index
2025-03-13 12:08:14,685 [INFO]: 	size in bytes: 741921310
2025-03-13 12:08:14,685 [INFO]: 	avg_search_speed_ms: 8.720470828052088
2025-03-13 12:08:14,685 [INFO]: 	99p_search_speed_ms: 12.265819385647774
2025-03-13 12:08:14,685 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:14,685 [INFO]: 	nb vectors: 3771
2025-03-13 12:08:14,686 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:14,686 [INFO]: 	compression ratio: 0.99930916932417
2025-03-13 12:08:14,686 [INFO]: }
2025-03-13 12:08:14,686 [INFO]: 	>>> Finished "Creating the index" in 55.7459 secs
2025-03-13 12:08:14,686 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7702 secs
2025-03-13 12:08:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 31968 [episode count 12/20]
[retrieval_preprocessing] for episode 87356 [episode count 13/20], we have num_retrieval=np.int64(3840) num_query=np.int64(80)
2025-03-13 12:08:17,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:18,147 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:18
2025-03-13 12:08:18,147 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1766.77it/s]
2025-03-13 12:08:18,170 [INFO]: There are 3840 embeddings of dim 49152
2025-03-13 12:08:18,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 12:08:18,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:18
2025-03-13 12:08:18,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:18,171 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:08:18,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:18,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:08:18,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:18
2025-03-13 12:08:18,171 [INFO]: 792.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:18,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:08:18,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:18
2025-03-13 12:08:18,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:18,171 [INFO]: 	Creating the index 03/13/2025, 12:08:18
2025-03-13 12:08:18,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:18
2025-03-13 12:08:18,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:08:18,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:18
2025-03-13 12:08:18,172 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:08:18,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|▋         | 1/16 [00:00<00:03,  5.00it/s]
 12%|█▎        | 2/16 [00:00<00:02,  6.66it/s]
 19%|█▉        | 3/16 [00:00<00:01,  7.35it/s]
 25%|██▌       | 4/16 [00:00<00:01,  7.77it/s]
 31%|███▏      | 5/16 [00:00<00:01,  8.05it/s]
 38%|███▊      | 6/16 [00:00<00:01,  8.27it/s]
 44%|████▍     | 7/16 [00:00<00:01,  8.35it/s]
 50%|█████     | 8/16 [00:01<00:00,  8.40it/s]
 56%|█████▋    | 9/16 [00:01<00:00,  8.47it/s]
 62%|██████▎   | 10/16 [00:01<00:00,  8.55it/s]
 69%|██████▉   | 11/16 [00:01<00:00,  8.68it/s]
 75%|███████▌  | 12/16 [00:01<00:00,  8.69it/s]
 81%|████████▏ | 13/16 [00:01<00:00,  8.66it/s]
 94%|█████████▍| 15/16 [00:01<00:00,  9.79it/s]
100%|██████████| 16/16 [00:04<00:00,  1.36it/s]
100%|██████████| 16/16 [00:04<00:00,  3.64it/s]
2025-03-13 12:08:22,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:22
2025-03-13 12:08:55,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0418 secs
2025-03-13 12:08:55,619 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 12:08:55,619 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:55

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.36it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 12:09:14,341 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7221 secs
2025-03-13 12:09:14,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1715 secs
2025-03-13 12:09:14,344 [INFO]: {
2025-03-13 12:09:14,344 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:14,344 [INFO]: 	index_param: efSearch=264
2025-03-13 12:09:14,344 [INFO]: 	index_path: knn.index
2025-03-13 12:09:14,344 [INFO]: 	size in bytes: 755496850
2025-03-13 12:09:14,344 [INFO]: 	avg_search_speed_ms: 10.886135750018012
2025-03-13 12:09:14,344 [INFO]: 	99p_search_speed_ms: 15.566891690250486
2025-03-13 12:09:14,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:14,344 [INFO]: 	nb vectors: 3840
2025-03-13 12:09:14,344 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:14,344 [INFO]: 	compression ratio: 0.9993088918901515
2025-03-13 12:09:14,344 [INFO]: }
2025-03-13 12:09:14,344 [INFO]: 	>>> Finished "Creating the index" in 56.1729 secs
2025-03-13 12:09:14,344 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1971 secs
2025-03-13 12:09:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 87356 [episode count 13/20]
[retrieval_preprocessing] for episode 17845 [episode count 14/20], we have num_retrieval=np.int64(3776) num_query=np.int64(144)
2025-03-13 12:09:17,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:17,758 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:17
2025-03-13 12:09:17,758 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:17

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2113.00it/s]
2025-03-13 12:09:17,783 [INFO]: There are 3776 embeddings of dim 49152
2025-03-13 12:09:17,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 12:09:17,784 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:17
2025-03-13 12:09:17,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:17,784 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:09:17,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:17,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:09:17,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:17
2025-03-13 12:09:17,785 [INFO]: 779.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:17,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:09:17,786 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:17
2025-03-13 12:09:17,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:17,786 [INFO]: 	Creating the index 03/13/2025, 12:09:17
2025-03-13 12:09:17,786 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:17
2025-03-13 12:09:17,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:09:17,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:17
2025-03-13 12:09:17,790 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:09:17,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  6.70it/s]
 20%|██        | 3/15 [00:00<00:01,  9.95it/s]
 33%|███▎      | 5/15 [00:00<00:00, 11.74it/s]
 47%|████▋     | 7/15 [00:00<00:00, 13.39it/s]
 60%|██████    | 9/15 [00:00<00:00, 14.67it/s]
 73%|███████▎  | 11/15 [00:00<00:00, 15.32it/s]
 87%|████████▋ | 13/15 [00:00<00:00, 15.09it/s]
100%|██████████| 15/15 [00:03<00:00,  2.14it/s]
100%|██████████| 15/15 [00:03<00:00,  4.20it/s]
2025-03-13 12:09:21,367 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:21
2025-03-13 12:09:52,968 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6006 secs
2025-03-13 12:09:52,968 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 12:09:52,968 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:52

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 12:10:12,695 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7269 secs
2025-03-13 12:10:12,699 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9097 secs
2025-03-13 12:10:12,699 [INFO]: {
2025-03-13 12:10:12,699 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:12,699 [INFO]: 	index_param: efSearch=262
2025-03-13 12:10:12,699 [INFO]: 	index_path: knn.index
2025-03-13 12:10:12,699 [INFO]: 	size in bytes: 742905010
2025-03-13 12:10:12,699 [INFO]: 	avg_search_speed_ms: 11.491366313641954
2025-03-13 12:10:12,699 [INFO]: 	99p_search_speed_ms: 16.013847140129652
2025-03-13 12:10:12,699 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:12,699 [INFO]: 	nb vectors: 3776
2025-03-13 12:10:12,699 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:12,699 [INFO]: 	compression ratio: 0.9993091956668861
2025-03-13 12:10:12,699 [INFO]: }
2025-03-13 12:10:12,699 [INFO]: 	>>> Finished "Creating the index" in 54.9133 secs
2025-03-13 12:10:12,699 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9413 secs
2025-03-13 12:10:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 17845 [episode count 14/20]
[retrieval_preprocessing] for episode 84439 [episode count 15/20], we have num_retrieval=np.int64(3795) num_query=np.int64(125)
2025-03-13 12:10:16,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:16,881 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:16
2025-03-13 12:10:16,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:16

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1151.96it/s]
2025-03-13 12:10:16,905 [INFO]: There are 3795 embeddings of dim 49152
2025-03-13 12:10:16,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 12:10:16,905 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:16
2025-03-13 12:10:16,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:16,905 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:10:16,905 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:16,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:16,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:16
2025-03-13 12:10:16,905 [INFO]: 783.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:16,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:10:16,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:16
2025-03-13 12:10:16,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:16,905 [INFO]: 	Creating the index 03/13/2025, 12:10:16
2025-03-13 12:10:16,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:16
2025-03-13 12:10:16,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:10:16,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:16
2025-03-13 12:10:16,906 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:10:16,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.80it/s]
 20%|██        | 3/15 [00:00<00:01,  9.06it/s]
 33%|███▎      | 5/15 [00:00<00:01,  9.93it/s]
 47%|████▋     | 7/15 [00:00<00:00, 10.42it/s]
 60%|██████    | 9/15 [00:00<00:00, 10.76it/s]
 73%|███████▎  | 11/15 [00:01<00:00, 11.13it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 11.48it/s]
100%|██████████| 15/15 [00:03<00:00,  1.98it/s]
100%|██████████| 15/15 [00:03<00:00,  3.77it/s]
2025-03-13 12:10:20,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:20
2025-03-13 12:10:54,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5088 secs
2025-03-13 12:10:54,404 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 12:10:54,405 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:54

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s]
2025-03-13 12:11:11,674 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2694 secs
2025-03-13 12:11:11,677 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7709 secs
2025-03-13 12:11:11,677 [INFO]: {
2025-03-13 12:11:11,677 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:11,677 [INFO]: 	index_param: efSearch=103
2025-03-13 12:11:11,677 [INFO]: 	index_path: knn.index
2025-03-13 12:11:11,677 [INFO]: 	size in bytes: 746643130
2025-03-13 12:11:11,677 [INFO]: 	avg_search_speed_ms: 4.988038112409413
2025-03-13 12:11:11,678 [INFO]: 	99p_search_speed_ms: 10.046422290615737
2025-03-13 12:11:11,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:11,678 [INFO]: 	nb vectors: 3795
2025-03-13 12:11:11,678 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:11,678 [INFO]: 	compression ratio: 0.9993092148319908
2025-03-13 12:11:11,678 [INFO]: }
2025-03-13 12:11:11,678 [INFO]: 	>>> Finished "Creating the index" in 54.7723 secs
2025-03-13 12:11:11,678 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7965 secs
2025-03-13 12:11:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 84439 [episode count 15/20]
[retrieval_preprocessing] for episode 29148 [episode count 16/20], we have num_retrieval=np.int64(3662) num_query=np.int64(258)
2025-03-13 12:11:13,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:14,378 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:14
2025-03-13 12:11:14,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:14

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 12:11:14,401 [INFO]: There are 3662 embeddings of dim 49152
2025-03-13 12:11:14,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 12:11:14,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:14,401 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:11:14,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:14,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:14,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,402 [INFO]: 755.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:14,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:14,402 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:14
2025-03-13 12:11:14,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:14,402 [INFO]: 	Creating the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:14
2025-03-13 12:11:14,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:14,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,403 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:11:14,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  6.28it/s]
 20%|██        | 3/15 [00:00<00:01,  9.53it/s]
 33%|███▎      | 5/15 [00:00<00:00, 10.47it/s]
 47%|████▋     | 7/15 [00:00<00:00, 10.54it/s]
 60%|██████    | 9/15 [00:00<00:00, 10.69it/s]
 73%|███████▎  | 11/15 [00:01<00:00, 11.71it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 11.87it/s]
100%|██████████| 15/15 [00:04<00:00,  1.91it/s]
100%|██████████| 15/15 [00:04<00:00,  3.68it/s]
2025-03-13 12:11:18,486 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:18
2025-03-13 12:11:49,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2273 secs
2025-03-13 12:11:49,714 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 12:11:49,714 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:49

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.13it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 12:12:09,180 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4660 secs
2025-03-13 12:12:09,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7801 secs
2025-03-13 12:12:09,183 [INFO]: {
2025-03-13 12:12:09,183 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:09,183 [INFO]: 	index_param: efSearch=234
2025-03-13 12:12:09,183 [INFO]: 	index_path: knn.index
2025-03-13 12:12:09,183 [INFO]: 	size in bytes: 720476170
2025-03-13 12:12:09,183 [INFO]: 	avg_search_speed_ms: 11.411370583554755
2025-03-13 12:12:09,183 [INFO]: 	99p_search_speed_ms: 22.904510668013245
2025-03-13 12:12:09,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:09,183 [INFO]: 	nb vectors: 3662
2025-03-13 12:12:09,183 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:09,183 [INFO]: 	compression ratio: 0.999309242941373
2025-03-13 12:12:09,183 [INFO]: }
2025-03-13 12:12:09,183 [INFO]: 	>>> Finished "Creating the index" in 54.7815 secs
2025-03-13 12:12:09,183 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8055 secs
2025-03-13 12:12:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 29148 [episode count 16/20]
[retrieval_preprocessing] for episode 52725 [episode count 17/20], we have num_retrieval=np.int64(3768) num_query=np.int64(152)
2025-03-13 12:12:12,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:13,262 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:13
2025-03-13 12:12:13,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-13 12:12:13,289 [INFO]: There are 3768 embeddings of dim 49152
2025-03-13 12:12:13,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:12:13,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:13
2025-03-13 12:12:13,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:13,291 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 12:12:13,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:13,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:12:13,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:13
2025-03-13 12:12:13,291 [INFO]: 777.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:13,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:12:13,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:13
2025-03-13 12:12:13,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:13,292 [INFO]: 	Creating the index 03/13/2025, 12:12:13
2025-03-13 12:12:13,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:13
2025-03-13 12:12:13,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:12:13,295 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:13
2025-03-13 12:12:13,295 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:12:13,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  6.33it/s]
 20%|██        | 3/15 [00:00<00:01,  9.18it/s]
 33%|███▎      | 5/15 [00:00<00:00, 10.18it/s]
 47%|████▋     | 7/15 [00:00<00:00, 10.67it/s]
 60%|██████    | 9/15 [00:00<00:00, 10.96it/s]
 73%|███████▎  | 11/15 [00:01<00:00, 11.03it/s]
 87%|████████▋ | 13/15 [00:01<00:00, 10.95it/s]
100%|██████████| 15/15 [00:03<00:00,  2.03it/s]
100%|██████████| 15/15 [00:03<00:00,  3.84it/s]
2025-03-13 12:12:17,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:17
2025-03-13 12:12:52,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4489 secs
2025-03-13 12:12:52,664 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:12:52,664 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:52

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 12:13:12,722 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0579 secs
2025-03-13 12:13:12,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5079 secs
2025-03-13 12:13:12,803 [INFO]: {
2025-03-13 12:13:12,803 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:12,803 [INFO]: 	index_param: efSearch=228
2025-03-13 12:13:12,803 [INFO]: 	index_path: knn.index
2025-03-13 12:13:12,803 [INFO]: 	size in bytes: 741331090
2025-03-13 12:13:12,804 [INFO]: 	avg_search_speed_ms: 10.647738164219374
2025-03-13 12:13:12,804 [INFO]: 	99p_search_speed_ms: 15.771501665003598
2025-03-13 12:13:12,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:12,804 [INFO]: 	nb vectors: 3768
2025-03-13 12:13:12,804 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:12,804 [INFO]: 	compression ratio: 0.9993091534849834
2025-03-13 12:13:12,804 [INFO]: }
2025-03-13 12:13:12,804 [INFO]: 	>>> Finished "Creating the index" in 59.5120 secs
2025-03-13 12:13:12,804 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5414 secs
2025-03-13 12:13:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 52725 [episode count 17/20]
[retrieval_preprocessing] for episode 17854 [episode count 18/20], we have num_retrieval=np.int64(3680) num_query=np.int64(240)
2025-03-13 12:13:16,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:16,917 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:16
2025-03-13 12:13:16,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:16

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1884.23it/s]
2025-03-13 12:13:16,943 [INFO]: There are 3680 embeddings of dim 49152
2025-03-13 12:13:16,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:13:16,944 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:16
2025-03-13 12:13:16,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:16,944 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:13:16,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:16,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:16,944 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:16
2025-03-13 12:13:16,944 [INFO]: 759.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:16,944 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:13:16,944 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:16
2025-03-13 12:13:16,944 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:16,944 [INFO]: 	Creating the index 03/13/2025, 12:13:16
2025-03-13 12:13:16,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:16
2025-03-13 12:13:16,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:13:16,946 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:16
2025-03-13 12:13:16,946 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:13:16,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.16it/s]
 13%|█▎        | 2/15 [00:00<00:01,  6.60it/s]
 20%|██        | 3/15 [00:00<00:01,  7.25it/s]
 27%|██▋       | 4/15 [00:00<00:01,  7.59it/s]
 33%|███▎      | 5/15 [00:00<00:01,  7.79it/s]
 40%|████      | 6/15 [00:00<00:01,  8.03it/s]
 47%|████▋     | 7/15 [00:00<00:00,  8.05it/s]
 53%|█████▎    | 8/15 [00:01<00:00,  8.12it/s]
 60%|██████    | 9/15 [00:01<00:00,  8.33it/s]
 67%|██████▋   | 10/15 [00:01<00:00,  8.51it/s]
 73%|███████▎  | 11/15 [00:01<00:00,  8.72it/s]
 80%|████████  | 12/15 [00:01<00:00,  8.81it/s]
 87%|████████▋ | 13/15 [00:01<00:00,  8.82it/s]
 93%|█████████▎| 14/15 [00:01<00:00,  8.81it/s]
100%|██████████| 15/15 [00:04<00:00,  1.19it/s]
100%|██████████| 15/15 [00:04<00:00,  3.54it/s]
2025-03-13 12:13:21,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:21
2025-03-13 12:13:52,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1497 secs
2025-03-13 12:13:52,338 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 12:13:52,339 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:52

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 12:14:12,885 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5468 secs
2025-03-13 12:14:12,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9428 secs
2025-03-13 12:14:12,889 [INFO]: {
2025-03-13 12:14:12,889 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:12,889 [INFO]: 	index_param: efSearch=201
2025-03-13 12:14:12,889 [INFO]: 	index_path: knn.index
2025-03-13 12:14:12,889 [INFO]: 	size in bytes: 724017490
2025-03-13 12:14:12,889 [INFO]: 	avg_search_speed_ms: 8.903571878056493
2025-03-13 12:14:12,889 [INFO]: 	99p_search_speed_ms: 13.510122545994816
2025-03-13 12:14:12,889 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:12,889 [INFO]: 	nb vectors: 3680
2025-03-13 12:14:12,889 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:12,889 [INFO]: 	compression ratio: 0.9993093398890129
2025-03-13 12:14:12,889 [INFO]: }
2025-03-13 12:14:12,889 [INFO]: 	>>> Finished "Creating the index" in 55.9445 secs
2025-03-13 12:14:12,889 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9719 secs
2025-03-13 12:14:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17854 [episode count 18/20]
[retrieval_preprocessing] for episode 22483 [episode count 19/20], we have num_retrieval=np.int64(3611) num_query=np.int64(309)
2025-03-13 12:14:16,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:17,012 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:17
2025-03-13 12:14:17,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:17

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1829.98it/s]
2025-03-13 12:14:17,034 [INFO]: There are 3611 embeddings of dim 49152
2025-03-13 12:14:17,034 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0212 secs
2025-03-13 12:14:17,034 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:17,034 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:14:17,034 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:17,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:14:17,034 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,034 [INFO]: 745.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:17,034 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:14:17,034 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:17
2025-03-13 12:14:17,034 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:17,034 [INFO]: 	Creating the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,034 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:17
2025-03-13 12:14:17,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:14:17,035 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,035 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:14:17,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:00<00:02,  5.83it/s]
 20%|██        | 3/15 [00:00<00:01,  8.95it/s]
 33%|███▎      | 5/15 [00:00<00:01,  9.52it/s]
 40%|████      | 6/15 [00:00<00:00,  9.27it/s]
 47%|████▋     | 7/15 [00:00<00:00,  9.16it/s]
 53%|█████▎    | 8/15 [00:00<00:00,  9.19it/s]
 60%|██████    | 9/15 [00:00<00:00,  9.34it/s]
 73%|███████▎  | 11/15 [00:01<00:00,  9.89it/s]
 87%|████████▋ | 13/15 [00:01<00:00,  9.99it/s]
100%|██████████| 15/15 [00:04<00:00,  1.58it/s]
100%|██████████| 15/15 [00:04<00:00,  3.31it/s]
2025-03-13 12:14:21,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:21
2025-03-13 12:14:53,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5213 secs
2025-03-13 12:14:53,098 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:14:53,098 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:53

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-13 12:15:15,438 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3393 secs
2025-03-13 12:15:15,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4053 secs
2025-03-13 12:15:15,441 [INFO]: {
2025-03-13 12:15:15,441 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:15,441 [INFO]: 	index_param: efSearch=266
2025-03-13 12:15:15,441 [INFO]: 	index_path: knn.index
2025-03-13 12:15:15,441 [INFO]: 	size in bytes: 710442070
2025-03-13 12:15:15,441 [INFO]: 	avg_search_speed_ms: 12.001165881191715
2025-03-13 12:15:15,441 [INFO]: 	99p_search_speed_ms: 20.977316256612504
2025-03-13 12:15:15,441 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:15,441 [INFO]: 	nb vectors: 3611
2025-03-13 12:15:15,441 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:15,441 [INFO]: 	compression ratio: 0.999309469384323
2025-03-13 12:15:15,441 [INFO]: }
2025-03-13 12:15:15,441 [INFO]: 	>>> Finished "Creating the index" in 58.4067 secs
2025-03-13 12:15:15,441 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4284 secs
2025-03-13 12:15:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 22483 [episode count 19/20]
2025-03-13 12:15:19: [retrieval_preprocessing] finished for 5594497977_Close the air fryer [chosen_id count 2/260]
2025-03-13 12:15:23: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5664924394_put_glue_stick_in_mug [chosen_id count 3/260]
2025-03-13 12:15:23: [retrieval_preprocessing] we have num_total=3612 embedding_dim=49152
[retrieval_preprocessing] for episode 54656 [episode count 0/20], we have num_retrieval=np.int64(3332) num_query=np.int64(280)
2025-03-13 12:15:24,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:25,268 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:25
2025-03-13 12:15:25,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:25

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1469.62it/s]
2025-03-13 12:15:25,294 [INFO]: There are 3332 embeddings of dim 49152
2025-03-13 12:15:25,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:15:25,295 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:25
2025-03-13 12:15:25,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:25,295 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 12:15:25,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:25,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:25,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:25
2025-03-13 12:15:25,295 [INFO]: 687.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:25,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:15:25,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:25
2025-03-13 12:15:25,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:25,295 [INFO]: 	Creating the index 03/13/2025, 12:15:25
2025-03-13 12:15:25,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:25
2025-03-13 12:15:25,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:15:25,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:25
2025-03-13 12:15:25,297 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:15:25,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:03,  4.14it/s]
 14%|█▍        | 2/14 [00:00<00:02,  5.82it/s]
 29%|██▊       | 4/14 [00:00<00:01,  8.58it/s]
 43%|████▎     | 6/14 [00:00<00:00,  9.84it/s]
 57%|█████▋    | 8/14 [00:00<00:00, 10.40it/s]
 71%|███████▏  | 10/14 [00:01<00:00, 11.40it/s]
 86%|████████▌ | 12/14 [00:01<00:00, 13.09it/s]
100%|██████████| 14/14 [00:03<00:00,  2.33it/s]
100%|██████████| 14/14 [00:03<00:00,  4.07it/s]
2025-03-13 12:15:28,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:28
2025-03-13 12:16:00,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8317 secs
2025-03-13 12:16:00,570 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 12:16:00,570 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:00

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.37it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 12:16:18,417 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8468 secs
2025-03-13 12:16:18,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1229 secs
2025-03-13 12:16:18,420 [INFO]: {
2025-03-13 12:16:18,420 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:18,420 [INFO]: 	index_param: efSearch=269
2025-03-13 12:16:18,420 [INFO]: 	index_path: knn.index
2025-03-13 12:16:18,420 [INFO]: 	size in bytes: 655550770
2025-03-13 12:16:18,420 [INFO]: 	avg_search_speed_ms: 11.91490424541934
2025-03-13 12:16:18,420 [INFO]: 	99p_search_speed_ms: 24.4143022899516
2025-03-13 12:16:18,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:18,420 [INFO]: 	nb vectors: 3332
2025-03-13 12:16:18,420 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:18,420 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 12:16:18,420 [INFO]: }
2025-03-13 12:16:18,420 [INFO]: 	>>> Finished "Creating the index" in 53.1246 secs
2025-03-13 12:16:18,420 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1524 secs
2025-03-13 12:16:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 54656 [episode count 0/20]
[retrieval_preprocessing] for episode 54532 [episode count 1/20], we have num_retrieval=np.int64(3438) num_query=np.int64(174)
2025-03-13 12:16:22,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:22,980 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:22
2025-03-13 12:16:22,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:22

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1087.73it/s]
2025-03-13 12:16:23,009 [INFO]: There are 3438 embeddings of dim 49152
2025-03-13 12:16:23,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:16:23,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:23,010 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:16:23,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:23,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:16:23,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,012 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:23,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:16:23,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:23
2025-03-13 12:16:23,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:23,013 [INFO]: 	Creating the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,013 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:23
2025-03-13 12:16:23,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:16:23,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,017 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:16:23,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  5.76it/s]
 21%|██▏       | 3/14 [00:00<00:01,  8.59it/s]
 36%|███▌      | 5/14 [00:00<00:00,  9.72it/s]
 50%|█████     | 7/14 [00:00<00:00, 10.24it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 10.50it/s]
 79%|███████▊  | 11/14 [00:01<00:00, 10.50it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 10.82it/s]
100%|██████████| 14/14 [00:03<00:00,  3.70it/s]
2025-03-13 12:16:26,805 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:26
2025-03-13 12:17:02,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7750 secs
2025-03-13 12:17:02,580 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 12:17:02,580 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:02

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s]
2025-03-13 12:17:20,069 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4885 secs
2025-03-13 12:17:20,072 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0553 secs
2025-03-13 12:17:20,072 [INFO]: {
2025-03-13 12:17:20,072 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:20,072 [INFO]: 	index_param: efSearch=306
2025-03-13 12:17:20,072 [INFO]: 	index_path: knn.index
2025-03-13 12:17:20,072 [INFO]: 	size in bytes: 676405450
2025-03-13 12:17:20,072 [INFO]: 	avg_search_speed_ms: 13.37782053879517
2025-03-13 12:17:20,072 [INFO]: 	99p_search_speed_ms: 24.656359376385794
2025-03-13 12:17:20,072 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:20,072 [INFO]: 	nb vectors: 3438
2025-03-13 12:17:20,072 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:20,072 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-13 12:17:20,072 [INFO]: }
2025-03-13 12:17:20,072 [INFO]: 	>>> Finished "Creating the index" in 57.0597 secs
2025-03-13 12:17:20,073 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0925 secs
2025-03-13 12:17:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 54532 [episode count 1/20]
[retrieval_preprocessing] for episode 10759 [episode count 2/20], we have num_retrieval=np.int64(3466) num_query=np.int64(146)
2025-03-13 12:17:23,983 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:24,614 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:24
2025-03-13 12:17:24,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:24

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 989.22it/s]
2025-03-13 12:17:24,640 [INFO]: There are 3466 embeddings of dim 49152
2025-03-13 12:17:24,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:17:24,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:24
2025-03-13 12:17:24,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:24,641 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:17:24,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:24,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:24,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:24
2025-03-13 12:17:24,641 [INFO]: 715.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:24,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:24,641 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:24
2025-03-13 12:17:24,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:24,641 [INFO]: 	Creating the index 03/13/2025, 12:17:24
2025-03-13 12:17:24,641 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:24
2025-03-13 12:17:24,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:17:24,642 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:24
2025-03-13 12:17:24,642 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:17:24,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  5.22it/s]
 14%|█▍        | 2/14 [00:00<00:01,  6.63it/s]
 21%|██▏       | 3/14 [00:00<00:01,  7.15it/s]
 29%|██▊       | 4/14 [00:00<00:01,  7.41it/s]
 36%|███▌      | 5/14 [00:00<00:01,  7.54it/s]
 43%|████▎     | 6/14 [00:00<00:01,  7.63it/s]
 50%|█████     | 7/14 [00:00<00:00,  7.81it/s]
 57%|█████▋    | 8/14 [00:01<00:00,  7.83it/s]
 64%|██████▍   | 9/14 [00:01<00:00,  7.90it/s]
 71%|███████▏  | 10/14 [00:01<00:00,  8.01it/s]
 79%|███████▊  | 11/14 [00:01<00:00,  8.09it/s]
 86%|████████▌ | 12/14 [00:01<00:00,  8.19it/s]
 93%|█████████▎| 13/14 [00:01<00:00,  8.18it/s]
100%|██████████| 14/14 [00:04<00:00,  1.14it/s]
100%|██████████| 14/14 [00:04<00:00,  3.25it/s]
2025-03-13 12:17:28,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:28
2025-03-13 12:18:15,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9116 secs
2025-03-13 12:18:15,870 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 12:18:15,870 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:15

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-13 12:18:33,855 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9843 secs
2025-03-13 12:18:33,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2158 secs
2025-03-13 12:18:33,858 [INFO]: {
2025-03-13 12:18:33,858 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:33,858 [INFO]: 	index_param: efSearch=192
2025-03-13 12:18:33,858 [INFO]: 	index_path: knn.index
2025-03-13 12:18:33,858 [INFO]: 	size in bytes: 681914230
2025-03-13 12:18:33,858 [INFO]: 	avg_search_speed_ms: 9.867786985582066
2025-03-13 12:18:33,859 [INFO]: 	99p_search_speed_ms: 15.071866195648909
2025-03-13 12:18:33,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:33,859 [INFO]: 	nb vectors: 3466
2025-03-13 12:18:33,859 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:33,859 [INFO]: 	compression ratio: 0.9993094410128383
2025-03-13 12:18:33,859 [INFO]: }
2025-03-13 12:18:33,859 [INFO]: 	>>> Finished "Creating the index" in 69.2175 secs
2025-03-13 12:18:33,859 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2449 secs
2025-03-13 12:18:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 10759 [episode count 2/20]
[retrieval_preprocessing] for episode 4247 [episode count 3/20], we have num_retrieval=np.int64(3329) num_query=np.int64(283)
2025-03-13 12:18:36,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:37,484 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:37
2025-03-13 12:18:37,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:37

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-13 12:18:37,508 [INFO]: There are 3329 embeddings of dim 49152
2025-03-13 12:18:37,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:18:37,509 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:37
2025-03-13 12:18:37,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:37,509 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 12:18:37,509 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:37,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:37,509 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:37
2025-03-13 12:18:37,509 [INFO]: 687.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:37,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:18:37,509 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:37
2025-03-13 12:18:37,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:37,509 [INFO]: 	Creating the index 03/13/2025, 12:18:37
2025-03-13 12:18:37,509 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:37
2025-03-13 12:18:37,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:18:37,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:37
2025-03-13 12:18:37,510 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:18:37,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  5.75it/s]
 21%|██▏       | 3/14 [00:00<00:01,  8.71it/s]
 36%|███▌      | 5/14 [00:00<00:00,  9.77it/s]
 50%|█████     | 7/14 [00:00<00:00, 10.20it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 10.52it/s]
 79%|███████▊  | 11/14 [00:01<00:00, 11.21it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 11.65it/s]
100%|██████████| 14/14 [00:03<00:00,  4.15it/s]
2025-03-13 12:18:40,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:40
2025-03-13 12:19:22,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4536 secs
2025-03-13 12:19:22,342 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 12:19:22,342 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:22

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 12:19:38,279 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9367 secs
2025-03-13 12:19:38,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7705 secs
2025-03-13 12:19:38,281 [INFO]: {
2025-03-13 12:19:38,281 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:38,281 [INFO]: 	index_param: efSearch=234
2025-03-13 12:19:38,281 [INFO]: 	index_path: knn.index
2025-03-13 12:19:38,281 [INFO]: 	size in bytes: 654960550
2025-03-13 12:19:38,281 [INFO]: 	avg_search_speed_ms: 10.101337697488642
2025-03-13 12:19:38,281 [INFO]: 	99p_search_speed_ms: 14.439230910502376
2025-03-13 12:19:38,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:38,281 [INFO]: 	nb vectors: 3329
2025-03-13 12:19:38,281 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:38,281 [INFO]: 	compression ratio: 0.9993090912116768
2025-03-13 12:19:38,281 [INFO]: }
2025-03-13 12:19:38,281 [INFO]: 	>>> Finished "Creating the index" in 60.7721 secs
2025-03-13 12:19:38,281 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7968 secs
2025-03-13 12:19:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 4247 [episode count 3/20]
[retrieval_preprocessing] for episode 59258 [episode count 4/20], we have num_retrieval=np.int64(3485) num_query=np.int64(127)
2025-03-13 12:19:42,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:42,830 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:42
2025-03-13 12:19:42,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:42

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1415.56it/s]
2025-03-13 12:19:42,852 [INFO]: There are 3485 embeddings of dim 49152
2025-03-13 12:19:42,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 12:19:42,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:42
2025-03-13 12:19:42,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:42,852 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:19:42,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:42,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:42,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:42
2025-03-13 12:19:42,853 [INFO]: 719.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:42,853 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:42,853 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:42
2025-03-13 12:19:42,853 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:42,853 [INFO]: 	Creating the index 03/13/2025, 12:19:42
2025-03-13 12:19:42,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:42
2025-03-13 12:19:42,854 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:19:42,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:42
2025-03-13 12:19:42,854 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:19:42,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  4.66it/s]
 14%|█▍        | 2/14 [00:00<00:01,  6.31it/s]
 21%|██▏       | 3/14 [00:00<00:01,  7.40it/s]
 29%|██▊       | 4/14 [00:00<00:01,  7.86it/s]
 36%|███▌      | 5/14 [00:00<00:01,  8.08it/s]
 43%|████▎     | 6/14 [00:00<00:00,  8.31it/s]
 50%|█████     | 7/14 [00:00<00:00,  8.64it/s]
 64%|██████▍   | 9/14 [00:01<00:00,  9.50it/s]
 79%|███████▊  | 11/14 [00:01<00:00,  9.84it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 10.01it/s]
100%|██████████| 14/14 [00:04<00:00,  1.43it/s]
100%|██████████| 14/14 [00:04<00:00,  3.15it/s]
2025-03-13 12:19:47,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:47
2025-03-13 12:20:30,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2876 secs
2025-03-13 12:20:30,588 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 12:20:30,588 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:30

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-13 12:20:47,386 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7973 secs
2025-03-13 12:20:47,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5354 secs
2025-03-13 12:20:47,390 [INFO]: {
2025-03-13 12:20:47,390 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:47,390 [INFO]: 	index_param: efSearch=236
2025-03-13 12:20:47,390 [INFO]: 	index_path: knn.index
2025-03-13 12:20:47,390 [INFO]: 	size in bytes: 685652350
2025-03-13 12:20:47,390 [INFO]: 	avg_search_speed_ms: 10.463703555602857
2025-03-13 12:20:47,390 [INFO]: 	99p_search_speed_ms: 14.577129753306496
2025-03-13 12:20:47,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:47,390 [INFO]: 	nb vectors: 3485
2025-03-13 12:20:47,390 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:47,390 [INFO]: 	compression ratio: 0.999309460545129
2025-03-13 12:20:47,390 [INFO]: }
2025-03-13 12:20:47,390 [INFO]: 	>>> Finished "Creating the index" in 64.5368 secs
2025-03-13 12:20:47,390 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5597 secs
2025-03-13 12:20:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 59258 [episode count 4/20]
[retrieval_preprocessing] for episode 55839 [episode count 5/20], we have num_retrieval=np.int64(3477) num_query=np.int64(135)
2025-03-13 12:20:49,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:50,523 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:50
2025-03-13 12:20:50,523 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:50

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1538.07it/s]
2025-03-13 12:20:50,547 [INFO]: There are 3477 embeddings of dim 49152
2025-03-13 12:20:50,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:20:50,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:50
2025-03-13 12:20:50,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:50,547 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:20:50,547 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:50,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:50,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:50
2025-03-13 12:20:50,548 [INFO]: 717.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:50,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:20:50,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:50
2025-03-13 12:20:50,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:50,548 [INFO]: 	Creating the index 03/13/2025, 12:20:50
2025-03-13 12:20:50,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:50
2025-03-13 12:20:50,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:20:50,549 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:50
2025-03-13 12:20:50,549 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:20:50,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  6.19it/s]
 21%|██▏       | 3/14 [00:00<00:01,  9.84it/s]
 36%|███▌      | 5/14 [00:00<00:00, 11.02it/s]
 50%|█████     | 7/14 [00:00<00:00, 11.62it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 11.87it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 11.94it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 11.86it/s]
100%|██████████| 14/14 [00:03<00:00,  3.98it/s]
2025-03-13 12:20:54,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:54
2025-03-13 12:21:32,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7435 secs
2025-03-13 12:21:32,815 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:21:32,815 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:32

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.45it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 12:21:53,138 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3221 secs
2025-03-13 12:21:53,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5916 secs
2025-03-13 12:21:53,141 [INFO]: {
2025-03-13 12:21:53,141 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:53,141 [INFO]: 	index_param: efSearch=266
2025-03-13 12:21:53,141 [INFO]: 	index_path: knn.index
2025-03-13 12:21:53,141 [INFO]: 	size in bytes: 684078430
2025-03-13 12:21:53,141 [INFO]: 	avg_search_speed_ms: 12.554542578107103
2025-03-13 12:21:53,141 [INFO]: 	99p_search_speed_ms: 19.015810508280985
2025-03-13 12:21:53,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:53,141 [INFO]: 	nb vectors: 3477
2025-03-13 12:21:53,141 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:53,141 [INFO]: 	compression ratio: 0.99930941544232
2025-03-13 12:21:53,141 [INFO]: }
2025-03-13 12:21:53,141 [INFO]: 	>>> Finished "Creating the index" in 62.5929 secs
2025-03-13 12:21:53,141 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6176 secs
2025-03-13 12:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 55839 [episode count 5/20]
[retrieval_preprocessing] for episode 86561 [episode count 6/20], we have num_retrieval=np.int64(3388) num_query=np.int64(224)
2025-03-13 12:21:56,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:56,802 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:56
2025-03-13 12:21:56,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:56

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2239.35it/s]
2025-03-13 12:21:56,828 [INFO]: There are 3388 embeddings of dim 49152
2025-03-13 12:21:56,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 12:21:56,828 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:56
2025-03-13 12:21:56,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:56,829 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:21:56,829 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:56,829 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:21:56,829 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:56
2025-03-13 12:21:56,829 [INFO]: 699.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:56,829 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:21:56,829 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:56
2025-03-13 12:21:56,830 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:56,830 [INFO]: 	Creating the index 03/13/2025, 12:21:56
2025-03-13 12:21:56,830 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:56
2025-03-13 12:21:56,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:21:56,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:56
2025-03-13 12:21:56,833 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:21:56,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  5.93it/s]
 21%|██▏       | 3/14 [00:00<00:01,  9.63it/s]
 36%|███▌      | 5/14 [00:00<00:00, 10.77it/s]
 50%|█████     | 7/14 [00:00<00:00, 11.22it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 11.45it/s]
 79%|███████▊  | 11/14 [00:01<00:00, 11.53it/s]
 93%|█████████▎| 13/14 [00:01<00:00, 11.64it/s]
100%|██████████| 14/14 [00:03<00:00,  3.51it/s]
2025-03-13 12:22:00,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:00
2025-03-13 12:22:39,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7297 secs
2025-03-13 12:22:39,561 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 12:22:39,561 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:39

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.70it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 12:23:04,296 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7343 secs
2025-03-13 12:23:04,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4655 secs
2025-03-13 12:23:04,299 [INFO]: {
2025-03-13 12:23:04,299 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:04,299 [INFO]: 	index_param: efSearch=297
2025-03-13 12:23:04,299 [INFO]: 	index_path: knn.index
2025-03-13 12:23:04,299 [INFO]: 	size in bytes: 666568270
2025-03-13 12:23:04,299 [INFO]: 	avg_search_speed_ms: 11.835210390124448
2025-03-13 12:23:04,299 [INFO]: 	99p_search_speed_ms: 16.16045594215392
2025-03-13 12:23:04,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:04,299 [INFO]: 	nb vectors: 3388
2025-03-13 12:23:04,299 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:04,299 [INFO]: 	compression ratio: 0.999309349063375
2025-03-13 12:23:04,299 [INFO]: }
2025-03-13 12:23:04,299 [INFO]: 	>>> Finished "Creating the index" in 67.4693 secs
2025-03-13 12:23:04,299 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4967 secs
2025-03-13 12:23:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 86561 [episode count 6/20]
[retrieval_preprocessing] for episode 79271 [episode count 7/20], we have num_retrieval=np.int64(3486) num_query=np.int64(126)
2025-03-13 12:23:08,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:09,565 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:09
2025-03-13 12:23:09,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:09

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1450.81it/s]
2025-03-13 12:23:09,598 [INFO]: There are 3486 embeddings of dim 49152
2025-03-13 12:23:09,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:23:09,598 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:09,599 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:23:09,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:09,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:23:09,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,600 [INFO]: 719.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:09,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:23:09,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:09
2025-03-13 12:23:09,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:09,600 [INFO]: 	Creating the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:09
2025-03-13 12:23:09,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:23:09,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:09
2025-03-13 12:23:09,604 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:23:09,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:03,  3.67it/s]
 14%|█▍        | 2/14 [00:00<00:02,  4.84it/s]
 21%|██▏       | 3/14 [00:00<00:01,  5.83it/s]
 29%|██▊       | 4/14 [00:00<00:01,  6.47it/s]
 36%|███▌      | 5/14 [00:00<00:01,  6.87it/s]
 43%|████▎     | 6/14 [00:00<00:01,  7.29it/s]
 50%|█████     | 7/14 [00:01<00:00,  7.48it/s]
 57%|█████▋    | 8/14 [00:01<00:00,  7.68it/s]
 64%|██████▍   | 9/14 [00:01<00:00,  7.90it/s]
 71%|███████▏  | 10/14 [00:01<00:00,  8.08it/s]
 79%|███████▊  | 11/14 [00:01<00:00,  8.32it/s]
 86%|████████▌ | 12/14 [00:01<00:00,  8.37it/s]
 93%|█████████▎| 13/14 [00:01<00:00,  8.40it/s]
100%|██████████| 14/14 [00:04<00:00,  1.15it/s]
100%|██████████| 14/14 [00:04<00:00,  3.20it/s]
2025-03-13 12:23:13,985 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:13
2025-03-13 12:23:52,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1646 secs
2025-03-13 12:23:52,151 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 12:23:52,151 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:52

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.76it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 12:24:12,714 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5632 secs
2025-03-13 12:24:12,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1134 secs
2025-03-13 12:24:12,717 [INFO]: {
2025-03-13 12:24:12,718 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:12,718 [INFO]: 	index_param: efSearch=246
2025-03-13 12:24:12,718 [INFO]: 	index_path: knn.index
2025-03-13 12:24:12,718 [INFO]: 	size in bytes: 685849090
2025-03-13 12:24:12,718 [INFO]: 	avg_search_speed_ms: 11.042229238862612
2025-03-13 12:24:12,718 [INFO]: 	99p_search_speed_ms: 16.58890630351382
2025-03-13 12:24:12,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:12,718 [INFO]: 	nb vectors: 3486
2025-03-13 12:24:12,718 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:12,718 [INFO]: 	compression ratio: 0.9993094661684249
2025-03-13 12:24:12,718 [INFO]: }
2025-03-13 12:24:12,718 [INFO]: 	>>> Finished "Creating the index" in 63.1173 secs
2025-03-13 12:24:12,718 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1522 secs
2025-03-13 12:24:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 79271 [episode count 7/20]
[retrieval_preprocessing] for episode 51240 [episode count 8/20], we have num_retrieval=np.int64(3443) num_query=np.int64(169)
2025-03-13 12:24:15,588 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:16,192 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:16
2025-03-13 12:24:16,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:16

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1280.31it/s]
2025-03-13 12:24:16,225 [INFO]: There are 3443 embeddings of dim 49152
2025-03-13 12:24:16,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 12:24:16,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:16
2025-03-13 12:24:16,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:16,225 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:24:16,225 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:16,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:24:16,225 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:16
2025-03-13 12:24:16,225 [INFO]: 710.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:16,226 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:24:16,226 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:16
2025-03-13 12:24:16,226 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:16,226 [INFO]: 	Creating the index 03/13/2025, 12:24:16
2025-03-13 12:24:16,226 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:16
2025-03-13 12:24:16,228 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:24:16,228 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:16
2025-03-13 12:24:16,228 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:24:16,228 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:02,  5.95it/s]
 21%|██▏       | 3/14 [00:00<00:01,  9.11it/s]
 36%|███▌      | 5/14 [00:00<00:00,  9.76it/s]
 50%|█████     | 7/14 [00:00<00:00, 10.09it/s]
 64%|██████▍   | 9/14 [00:00<00:00, 11.67it/s]
 93%|█████████▎| 13/14 [00:00<00:00, 17.84it/s]
100%|██████████| 14/14 [00:04<00:00,  3.42it/s]
2025-03-13 12:24:20,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:20
2025-03-13 12:25:13,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5496 secs
2025-03-13 12:25:13,874 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 12:25:13,874 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:13

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  9.43it/s]
 50%|█████     | 2/4 [00:00<00:00,  9.57it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 12:25:28,410 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5353 secs
2025-03-13 12:25:28,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1843 secs
2025-03-13 12:25:28,412 [INFO]: {
2025-03-13 12:25:28,412 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:28,412 [INFO]: 	index_param: efSearch=175
2025-03-13 12:25:28,412 [INFO]: 	index_path: knn.index
2025-03-13 12:25:28,412 [INFO]: 	size in bytes: 677389210
2025-03-13 12:25:28,412 [INFO]: 	avg_search_speed_ms: 11.240194147201569
2025-03-13 12:25:28,412 [INFO]: 	99p_search_speed_ms: 17.95013351598755
2025-03-13 12:25:28,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:28,412 [INFO]: 	nb vectors: 3443
2025-03-13 12:25:28,412 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:28,412 [INFO]: 	compression ratio: 0.9993093099312875
2025-03-13 12:25:28,412 [INFO]: }
2025-03-13 12:25:28,412 [INFO]: 	>>> Finished "Creating the index" in 72.1866 secs
2025-03-13 12:25:28,412 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2200 secs
2025-03-13 12:25:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 51240 [episode count 8/20]
[retrieval_preprocessing] for episode 45867 [episode count 9/20], we have num_retrieval=np.int64(3438) num_query=np.int64(174)
2025-03-13 12:25:30,133 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:30,556 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:30
2025-03-13 12:25:30,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:30

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1088.58it/s]
2025-03-13 12:25:30,583 [INFO]: There are 3438 embeddings of dim 49152
2025-03-13 12:25:30,584 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 12:25:30,584 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:30
2025-03-13 12:25:30,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:30,584 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:25:30,584 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:30,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:30,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:30
2025-03-13 12:25:30,584 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:30,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:25:30,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:30
2025-03-13 12:25:30,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:30,584 [INFO]: 	Creating the index 03/13/2025, 12:25:30
2025-03-13 12:25:30,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:30
2025-03-13 12:25:30,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:25:30,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:30
2025-03-13 12:25:30,586 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:25:30,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  8.25it/s]
 43%|████▎     | 6/14 [00:00<00:00, 30.36it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 38.14it/s]
100%|██████████| 14/14 [00:02<00:00,  4.77it/s]
2025-03-13 12:25:33,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:33
2025-03-13 12:26:16,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7357 secs
2025-03-13 12:26:16,259 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 12:26:16,259 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:16

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.04it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 12:26:34,096 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8376 secs
2025-03-13 12:26:34,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5137 secs
2025-03-13 12:26:34,100 [INFO]: {
2025-03-13 12:26:34,100 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:34,100 [INFO]: 	index_param: efSearch=142
2025-03-13 12:26:34,100 [INFO]: 	index_path: knn.index
2025-03-13 12:26:34,100 [INFO]: 	size in bytes: 676405450
2025-03-13 12:26:34,100 [INFO]: 	avg_search_speed_ms: 8.802194070418588
2025-03-13 12:26:34,100 [INFO]: 	99p_search_speed_ms: 11.932346597313888
2025-03-13 12:26:34,100 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:34,100 [INFO]: 	nb vectors: 3438
2025-03-13 12:26:34,100 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:34,100 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-13 12:26:34,100 [INFO]: }
2025-03-13 12:26:34,100 [INFO]: 	>>> Finished "Creating the index" in 63.5156 secs
2025-03-13 12:26:34,100 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5440 secs
2025-03-13 12:26:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 45867 [episode count 9/20]
[retrieval_preprocessing] for episode 52524 [episode count 10/20], we have num_retrieval=np.int64(3435) num_query=np.int64(177)
2025-03-13 12:26:35,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:36,354 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:36
2025-03-13 12:26:36,355 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1435.91it/s]
2025-03-13 12:26:36,384 [INFO]: There are 3435 embeddings of dim 49152
2025-03-13 12:26:36,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 12:26:36,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:36
2025-03-13 12:26:36,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:36,384 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:26:36,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:36,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:36,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:36
2025-03-13 12:26:36,385 [INFO]: 708.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:36,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:26:36,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:36
2025-03-13 12:26:36,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:36,385 [INFO]: 	Creating the index 03/13/2025, 12:26:36
2025-03-13 12:26:36,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:36
2025-03-13 12:26:36,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:26:36,386 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:36
2025-03-13 12:26:36,386 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:26:36,386 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  8.94it/s]
 43%|████▎     | 6/14 [00:00<00:00, 30.26it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 37.15it/s]
100%|██████████| 14/14 [00:03<00:00,  4.10it/s]
2025-03-13 12:26:39,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:39
2025-03-13 12:27:17,366 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5588 secs
2025-03-13 12:27:17,367 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 12:27:17,367 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:17

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.81it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-13 12:27:43,681 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3140 secs
2025-03-13 12:27:43,684 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2972 secs
2025-03-13 12:27:43,684 [INFO]: {
2025-03-13 12:27:43,684 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:43,684 [INFO]: 	index_param: efSearch=150
2025-03-13 12:27:43,684 [INFO]: 	index_path: knn.index
2025-03-13 12:27:43,684 [INFO]: 	size in bytes: 675815170
2025-03-13 12:27:43,684 [INFO]: 	avg_search_speed_ms: 8.662677352256956
2025-03-13 12:27:43,684 [INFO]: 	99p_search_speed_ms: 13.334072106517855
2025-03-13 12:27:43,684 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:43,684 [INFO]: 	nb vectors: 3435
2025-03-13 12:27:43,684 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:43,684 [INFO]: 	compression ratio: 0.9993094413669347
2025-03-13 12:27:43,684 [INFO]: }
2025-03-13 12:27:43,684 [INFO]: 	>>> Finished "Creating the index" in 67.2991 secs
2025-03-13 12:27:43,684 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3295 secs
2025-03-13 12:27:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 52524 [episode count 10/20]
[retrieval_preprocessing] for episode 85181 [episode count 11/20], we have num_retrieval=np.int64(3462) num_query=np.int64(150)
2025-03-13 12:27:45,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:45,948 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:45
2025-03-13 12:27:45,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:45

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1349.08it/s]
2025-03-13 12:27:45,973 [INFO]: There are 3462 embeddings of dim 49152
2025-03-13 12:27:45,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:27:45,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:45
2025-03-13 12:27:45,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:45,973 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:27:45,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:45,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:27:45,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:45
2025-03-13 12:27:45,973 [INFO]: 714.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:45,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:27:45,973 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:45
2025-03-13 12:27:45,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:45,973 [INFO]: 	Creating the index 03/13/2025, 12:27:45
2025-03-13 12:27:45,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:45
2025-03-13 12:27:45,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:27:45,974 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:45
2025-03-13 12:27:45,975 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:27:45,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  6.94it/s]
 43%|████▎     | 6/14 [00:00<00:00, 26.83it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 34.49it/s]
100%|██████████| 14/14 [00:03<00:00,  4.18it/s]
2025-03-13 12:27:49,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:49
2025-03-13 12:28:35,006 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6807 secs
2025-03-13 12:28:35,006 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 12:28:35,006 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:35

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.45it/s]
2025-03-13 12:28:54,012 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0064 secs
2025-03-13 12:28:54,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0403 secs
2025-03-13 12:28:54,015 [INFO]: {
2025-03-13 12:28:54,015 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:54,015 [INFO]: 	index_param: efSearch=215
2025-03-13 12:28:54,015 [INFO]: 	index_path: knn.index
2025-03-13 12:28:54,015 [INFO]: 	size in bytes: 681127270
2025-03-13 12:28:54,015 [INFO]: 	avg_search_speed_ms: 10.744601558137656
2025-03-13 12:28:54,015 [INFO]: 	99p_search_speed_ms: 14.283153438009323
2025-03-13 12:28:54,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:54,015 [INFO]: 	nb vectors: 3462
2025-03-13 12:28:54,015 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:54,015 [INFO]: 	compression ratio: 0.9993094183411567
2025-03-13 12:28:54,015 [INFO]: }
2025-03-13 12:28:54,015 [INFO]: 	>>> Finished "Creating the index" in 68.0417 secs
2025-03-13 12:28:54,015 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0668 secs
2025-03-13 12:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 85181 [episode count 11/20]
[retrieval_preprocessing] for episode 90052 [episode count 12/20], we have num_retrieval=np.int64(3457) num_query=np.int64(155)
2025-03-13 12:28:55,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:56,436 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:56
2025-03-13 12:28:56,436 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:56

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1347.78it/s]
2025-03-13 12:28:56,462 [INFO]: There are 3457 embeddings of dim 49152
2025-03-13 12:28:56,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 12:28:56,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:56
2025-03-13 12:28:56,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:56,462 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:28:56,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:56,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:56,463 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:56
2025-03-13 12:28:56,463 [INFO]: 713.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:56,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:28:56,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:56
2025-03-13 12:28:56,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:56,463 [INFO]: 	Creating the index 03/13/2025, 12:28:56
2025-03-13 12:28:56,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:56
2025-03-13 12:28:56,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:28:56,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:56
2025-03-13 12:28:56,464 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:28:56,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  8.66it/s]
 43%|████▎     | 6/14 [00:00<00:00, 30.54it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 38.00it/s]
100%|██████████| 14/14 [00:03<00:00,  4.35it/s]
2025-03-13 12:28:59,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:59
2025-03-13 12:29:45,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3338 secs
2025-03-13 12:29:45,020 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:29:45,020 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:45

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.77it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 12:30:00,012 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9921 secs
2025-03-13 12:30:00,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5497 secs
2025-03-13 12:30:00,014 [INFO]: {
2025-03-13 12:30:00,014 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:00,014 [INFO]: 	index_param: efSearch=203
2025-03-13 12:30:00,014 [INFO]: 	index_path: knn.index
2025-03-13 12:30:00,014 [INFO]: 	size in bytes: 680143570
2025-03-13 12:30:00,014 [INFO]: 	avg_search_speed_ms: 12.008402968666294
2025-03-13 12:30:00,014 [INFO]: 	99p_search_speed_ms: 15.83814445883035
2025-03-13 12:30:00,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:00,014 [INFO]: 	nb vectors: 3457
2025-03-13 12:30:00,014 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:00,014 [INFO]: 	compression ratio: 0.9993093899277766
2025-03-13 12:30:00,014 [INFO]: }
2025-03-13 12:30:00,014 [INFO]: 	>>> Finished "Creating the index" in 63.5511 secs
2025-03-13 12:30:00,014 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5786 secs
2025-03-13 12:30:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 90052 [episode count 12/20]
[retrieval_preprocessing] for episode 42697 [episode count 13/20], we have num_retrieval=np.int64(3410) num_query=np.int64(202)
2025-03-13 12:30:01,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:02,109 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:02
2025-03-13 12:30:02,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:02

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1637.12it/s]
2025-03-13 12:30:02,135 [INFO]: There are 3410 embeddings of dim 49152
2025-03-13 12:30:02,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:30:02,135 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:02
2025-03-13 12:30:02,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:02,136 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:30:02,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:02,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:02,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:02
2025-03-13 12:30:02,136 [INFO]: 703.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:02,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:30:02,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:02
2025-03-13 12:30:02,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:02,136 [INFO]: 	Creating the index 03/13/2025, 12:30:02
2025-03-13 12:30:02,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:02
2025-03-13 12:30:02,137 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:30:02,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:02
2025-03-13 12:30:02,137 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:30:02,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  7.26it/s]
 43%|████▎     | 6/14 [00:00<00:00, 26.08it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 34.05it/s]
100%|██████████| 14/14 [00:03<00:00,  3.96it/s]
2025-03-13 12:30:05,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:05
2025-03-13 12:30:45,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7573 secs
2025-03-13 12:30:45,437 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:30:45,437 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:45

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.94it/s]
2025-03-13 12:31:03,020 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5824 secs
2025-03-13 12:31:03,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8846 secs
2025-03-13 12:31:03,022 [INFO]: {
2025-03-13 12:31:03,022 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:03,022 [INFO]: 	index_param: efSearch=241
2025-03-13 12:31:03,022 [INFO]: 	index_path: knn.index
2025-03-13 12:31:03,022 [INFO]: 	size in bytes: 670896670
2025-03-13 12:31:03,022 [INFO]: 	avg_search_speed_ms: 11.259346698811445
2025-03-13 12:31:03,022 [INFO]: 	99p_search_speed_ms: 15.265344472136348
2025-03-13 12:31:03,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:03,022 [INFO]: 	nb vectors: 3410
2025-03-13 12:31:03,022 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:03,022 [INFO]: 	compression ratio: 0.9993092975107478
2025-03-13 12:31:03,022 [INFO]: }
2025-03-13 12:31:03,022 [INFO]: 	>>> Finished "Creating the index" in 60.8860 secs
2025-03-13 12:31:03,022 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9130 secs
2025-03-13 12:31:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 42697 [episode count 13/20]
[retrieval_preprocessing] for episode 20811 [episode count 14/20], we have num_retrieval=np.int64(3425) num_query=np.int64(187)
2025-03-13 12:31:06,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:06,622 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:06
2025-03-13 12:31:06,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:06

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-13 12:31:06,645 [INFO]: There are 3425 embeddings of dim 49152
2025-03-13 12:31:06,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 12:31:06,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:06
2025-03-13 12:31:06,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:06,646 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:31:06,646 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:06,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:31:06,646 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:06
2025-03-13 12:31:06,646 [INFO]: 706.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:06,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:31:06,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:06
2025-03-13 12:31:06,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:06,646 [INFO]: 	Creating the index 03/13/2025, 12:31:06
2025-03-13 12:31:06,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:06
2025-03-13 12:31:06,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:31:06,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:06
2025-03-13 12:31:06,647 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:31:06,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
 14%|█▍        | 2/14 [00:00<00:00, 17.64it/s]
 57%|█████▋    | 8/14 [00:00<00:00, 37.40it/s]
100%|██████████| 14/14 [00:02<00:00,  4.13it/s]
100%|██████████| 14/14 [00:02<00:00,  4.99it/s]
2025-03-13 12:31:09,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:09
2025-03-13 12:31:50,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3233 secs
2025-03-13 12:31:50,777 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 12:31:50,777 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:50

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 16.26it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 17.20it/s]
2025-03-13 12:32:08,952 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1748 secs
2025-03-13 12:32:08,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3069 secs
2025-03-13 12:32:08,954 [INFO]: {
2025-03-13 12:32:08,954 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:08,954 [INFO]: 	index_param: efSearch=243
2025-03-13 12:32:08,954 [INFO]: 	index_path: knn.index
2025-03-13 12:32:08,954 [INFO]: 	size in bytes: 673847770
2025-03-13 12:32:08,954 [INFO]: 	avg_search_speed_ms: 11.50347332994657
2025-03-13 12:32:08,954 [INFO]: 	99p_search_speed_ms: 16.22867990517987
2025-03-13 12:32:08,954 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:08,954 [INFO]: 	nb vectors: 3425
2025-03-13 12:32:08,954 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:08,954 [INFO]: 	compression ratio: 0.9993093840764659
2025-03-13 12:32:08,955 [INFO]: }
2025-03-13 12:32:08,955 [INFO]: 	>>> Finished "Creating the index" in 62.3083 secs
2025-03-13 12:32:08,955 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3323 secs
2025-03-13 12:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20811 [episode count 14/20]
[retrieval_preprocessing] for episode 20431 [episode count 15/20], we have num_retrieval=np.int64(3338) num_query=np.int64(274)
2025-03-13 12:32:11,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:12,428 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:12
2025-03-13 12:32:12,428 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:12

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2204.05it/s]
2025-03-13 12:32:12,453 [INFO]: There are 3338 embeddings of dim 49152
2025-03-13 12:32:12,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:32:12,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:12
2025-03-13 12:32:12,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:12,453 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 12:32:12,453 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:12,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:12,453 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:12
2025-03-13 12:32:12,453 [INFO]: 688.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:12,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:12,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:12
2025-03-13 12:32:12,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:12,453 [INFO]: 	Creating the index 03/13/2025, 12:32:12
2025-03-13 12:32:12,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:12
2025-03-13 12:32:12,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:32:12,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:12
2025-03-13 12:32:12,455 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:32:12,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  9.42it/s]
 43%|████▎     | 6/14 [00:00<00:00, 32.69it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 39.71it/s]
100%|██████████| 14/14 [00:02<00:00,  4.91it/s]
2025-03-13 12:32:15,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:15
2025-03-13 12:32:56,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7087 secs
2025-03-13 12:32:56,019 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:32:56,019 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:56

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.42it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-13 12:33:14,687 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6673 secs
2025-03-13 12:33:14,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2341 secs
2025-03-13 12:33:14,689 [INFO]: {
2025-03-13 12:33:14,689 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:14,689 [INFO]: 	index_param: efSearch=248
2025-03-13 12:33:14,689 [INFO]: 	index_path: knn.index
2025-03-13 12:33:14,689 [INFO]: 	size in bytes: 656731210
2025-03-13 12:33:14,689 [INFO]: 	avg_search_speed_ms: 12.59229277461176
2025-03-13 12:33:14,689 [INFO]: 	99p_search_speed_ms: 20.477747730910767
2025-03-13 12:33:14,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:14,689 [INFO]: 	nb vectors: 3338
2025-03-13 12:33:14,689 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:14,689 [INFO]: 	compression ratio: 0.9993091450610364
2025-03-13 12:33:14,689 [INFO]: }
2025-03-13 12:33:14,689 [INFO]: 	>>> Finished "Creating the index" in 62.2356 secs
2025-03-13 12:33:14,689 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2611 secs
2025-03-13 12:33:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 20431 [episode count 15/20]
[retrieval_preprocessing] for episode 82895 [episode count 16/20], we have num_retrieval=np.int64(3475) num_query=np.int64(137)
2025-03-13 12:33:18,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:19,443 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:19
2025-03-13 12:33:19,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:19

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1768.26it/s]
2025-03-13 12:33:19,467 [INFO]: There are 3475 embeddings of dim 49152
2025-03-13 12:33:19,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 12:33:19,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:19
2025-03-13 12:33:19,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:19,468 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:33:19,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:19,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:19,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:19
2025-03-13 12:33:19,468 [INFO]: 717.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:19,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:33:19,468 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:19
2025-03-13 12:33:19,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:19,468 [INFO]: 	Creating the index 03/13/2025, 12:33:19
2025-03-13 12:33:19,468 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:19
2025-03-13 12:33:19,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:33:19,469 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:19
2025-03-13 12:33:19,469 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:33:19,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  9.03it/s]
 43%|████▎     | 6/14 [00:00<00:00, 32.00it/s]
 86%|████████▌ | 12/14 [00:00<00:00, 41.11it/s]
100%|██████████| 14/14 [00:03<00:00,  4.63it/s]
2025-03-13 12:33:22,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:22
2025-03-13 12:33:55,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2894 secs
2025-03-13 12:33:55,785 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 12:33:55,785 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:55

  0%|          | 0/4 [00:00<?, ?it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 25.00it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-13 12:34:11,024 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2392 secs
2025-03-13 12:34:11,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5570 secs
2025-03-13 12:34:11,026 [INFO]: {
2025-03-13 12:34:11,026 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:11,026 [INFO]: 	index_param: efSearch=163
2025-03-13 12:34:11,026 [INFO]: 	index_path: knn.index
2025-03-13 12:34:11,026 [INFO]: 	size in bytes: 683684950
2025-03-13 12:34:11,026 [INFO]: 	avg_search_speed_ms: 8.565670012676616
2025-03-13 12:34:11,026 [INFO]: 	99p_search_speed_ms: 13.488253799732766
2025-03-13 12:34:11,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:11,026 [INFO]: 	nb vectors: 3475
2025-03-13 12:34:11,026 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:11,026 [INFO]: 	compression ratio: 0.9993094041341702
2025-03-13 12:34:11,026 [INFO]: }
2025-03-13 12:34:11,026 [INFO]: 	>>> Finished "Creating the index" in 51.5584 secs
2025-03-13 12:34:11,026 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5832 secs
2025-03-13 12:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 82895 [episode count 16/20]
[retrieval_preprocessing] for episode 44129 [episode count 17/20], we have num_retrieval=np.int64(3470) num_query=np.int64(142)
2025-03-13 12:34:12,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:13,530 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:13
2025-03-13 12:34:13,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1111.37it/s]
2025-03-13 12:34:13,558 [INFO]: There are 3470 embeddings of dim 49152
2025-03-13 12:34:13,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:34:13,559 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:13
2025-03-13 12:34:13,559 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:13,559 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:34:13,559 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:13,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 12:34:13,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:13
2025-03-13 12:34:13,560 [INFO]: 716.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:13,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:34:13,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:13
2025-03-13 12:34:13,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:13,561 [INFO]: 	Creating the index 03/13/2025, 12:34:13
2025-03-13 12:34:13,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:13
2025-03-13 12:34:13,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:34:13,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:13
2025-03-13 12:34:13,565 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:34:13,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
 14%|█▍        | 2/14 [00:00<00:00, 17.38it/s]
 43%|████▎     | 6/14 [00:00<00:00, 29.82it/s]
 71%|███████▏  | 10/14 [00:00<00:00, 33.96it/s]
100%|██████████| 14/14 [00:03<00:00,  2.99it/s]
100%|██████████| 14/14 [00:03<00:00,  4.22it/s]
2025-03-13 12:34:16,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:16
2025-03-13 12:34:54,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7728 secs
2025-03-13 12:34:54,665 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:34:54,665 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:54

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 16.03it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 16.89it/s]
2025-03-13 12:35:11,732 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0673 secs
2025-03-13 12:35:11,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1695 secs
2025-03-13 12:35:11,735 [INFO]: {
2025-03-13 12:35:11,735 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:11,735 [INFO]: 	index_param: efSearch=228
2025-03-13 12:35:11,735 [INFO]: 	index_path: knn.index
2025-03-13 12:35:11,735 [INFO]: 	size in bytes: 682701190
2025-03-13 12:35:11,735 [INFO]: 	avg_search_speed_ms: 10.817171919184762
2025-03-13 12:35:11,735 [INFO]: 	99p_search_speed_ms: 14.810467064380646
2025-03-13 12:35:11,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:11,735 [INFO]: 	nb vectors: 3470
2025-03-13 12:35:11,735 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:11,735 [INFO]: 	compression ratio: 0.9993094636322518
2025-03-13 12:35:11,735 [INFO]: }
2025-03-13 12:35:11,735 [INFO]: 	>>> Finished "Creating the index" in 58.1737 secs
2025-03-13 12:35:11,735 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2052 secs
2025-03-13 12:35:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 44129 [episode count 17/20]
[retrieval_preprocessing] for episode 41459 [episode count 18/20], we have num_retrieval=np.int64(3412) num_query=np.int64(200)
2025-03-13 12:35:13,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:13,918 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:13
2025-03-13 12:35:13,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1537.50it/s]
2025-03-13 12:35:13,945 [INFO]: There are 3412 embeddings of dim 49152
2025-03-13 12:35:13,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 12:35:13,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:13
2025-03-13 12:35:13,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:13,947 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:35:13,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:13,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:35:13,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:13
2025-03-13 12:35:13,947 [INFO]: 704.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:13,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:35:13,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:13
2025-03-13 12:35:13,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:13,948 [INFO]: 	Creating the index 03/13/2025, 12:35:13
2025-03-13 12:35:13,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:13
2025-03-13 12:35:13,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:35:13,952 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:13
2025-03-13 12:35:13,952 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:35:13,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
 14%|█▍        | 2/14 [00:00<00:00, 19.62it/s]
 57%|█████▋    | 8/14 [00:00<00:00, 38.77it/s]
 93%|█████████▎| 13/14 [00:00<00:00, 43.46it/s]
100%|██████████| 14/14 [00:02<00:00,  4.77it/s]
2025-03-13 12:35:16,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:16
2025-03-13 12:36:00,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2208 secs
2025-03-13 12:36:00,116 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 12:36:00,116 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:00

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 12:36:18,230 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1132 secs
2025-03-13 12:36:18,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2797 secs
2025-03-13 12:36:18,232 [INFO]: {
2025-03-13 12:36:18,232 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:18,232 [INFO]: 	index_param: efSearch=217
2025-03-13 12:36:18,232 [INFO]: 	index_path: knn.index
2025-03-13 12:36:18,233 [INFO]: 	size in bytes: 671290150
2025-03-13 12:36:18,233 [INFO]: 	avg_search_speed_ms: 10.888200494946185
2025-03-13 12:36:18,233 [INFO]: 	99p_search_speed_ms: 15.08842651266603
2025-03-13 12:36:18,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:18,233 [INFO]: 	nb vectors: 3412
2025-03-13 12:36:18,233 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:18,233 [INFO]: 	compression ratio: 0.999309309096819
2025-03-13 12:36:18,233 [INFO]: }
2025-03-13 12:36:18,233 [INFO]: 	>>> Finished "Creating the index" in 64.2843 secs
2025-03-13 12:36:18,233 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3142 secs
2025-03-13 12:36:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 41459 [episode count 18/20]
[retrieval_preprocessing] for episode 17656 [episode count 19/20], we have num_retrieval=np.int64(3462) num_query=np.int64(150)
2025-03-13 12:36:20,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:20,681 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:20
2025-03-13 12:36:20,681 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:20

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1195.30it/s]
2025-03-13 12:36:20,706 [INFO]: There are 3462 embeddings of dim 49152
2025-03-13 12:36:20,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 12:36:20,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:20
2025-03-13 12:36:20,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:20,707 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:36:20,707 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:20,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:36:20,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:20
2025-03-13 12:36:20,707 [INFO]: 714.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:20,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:36:20,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:20
2025-03-13 12:36:20,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:20,707 [INFO]: 	Creating the index 03/13/2025, 12:36:20
2025-03-13 12:36:20,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:20
2025-03-13 12:36:20,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:36:20,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:20
2025-03-13 12:36:20,708 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:36:20,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/14 [00:00<?, ?it/s]
  7%|▋         | 1/14 [00:00<00:01,  8.43it/s]
 43%|████▎     | 6/14 [00:00<00:00, 29.37it/s]
 79%|███████▊  | 11/14 [00:00<00:00, 36.30it/s]
100%|██████████| 14/14 [00:03<00:00,  4.10it/s]
2025-03-13 12:36:24,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:24
2025-03-13 12:37:11,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1950 secs
2025-03-13 12:37:11,325 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 12:37:11,325 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:11

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.77it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 12:37:28,925 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5994 secs
2025-03-13 12:37:28,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2186 secs
2025-03-13 12:37:28,927 [INFO]: {
2025-03-13 12:37:28,927 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:28,927 [INFO]: 	index_param: efSearch=183
2025-03-13 12:37:28,927 [INFO]: 	index_path: knn.index
2025-03-13 12:37:28,927 [INFO]: 	size in bytes: 681127270
2025-03-13 12:37:28,927 [INFO]: 	avg_search_speed_ms: 9.690693364606794
2025-03-13 12:37:28,927 [INFO]: 	99p_search_speed_ms: 20.250743199139745
2025-03-13 12:37:28,927 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:28,927 [INFO]: 	nb vectors: 3462
2025-03-13 12:37:28,927 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:28,927 [INFO]: 	compression ratio: 0.9993094183411567
2025-03-13 12:37:28,927 [INFO]: }
2025-03-13 12:37:28,927 [INFO]: 	>>> Finished "Creating the index" in 68.2201 secs
2025-03-13 12:37:28,927 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2463 secs
2025-03-13 12:37:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 17656 [episode count 19/20]
2025-03-13 12:37:30: [retrieval_preprocessing] finished for 5664924394_put_glue_stick_in_mug [chosen_id count 3/260]
2025-03-13 12:37:31: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5879622450_put_yellow_block_in_blue_cup [chosen_id count 4/260]
2025-03-13 12:37:31: [retrieval_preprocessing] we have num_total=2005 embedding_dim=49152
[retrieval_preprocessing] for episode 23056 [episode count 0/20], we have num_retrieval=np.int64(1925) num_query=np.int64(80)
2025-03-13 12:37:31,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:31,740 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:31
2025-03-13 12:37:31,740 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:31

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1193.26it/s]
2025-03-13 12:37:31,768 [INFO]: There are 1925 embeddings of dim 49152
2025-03-13 12:37:31,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:37:31,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:31
2025-03-13 12:37:31,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:31,769 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:37:31,769 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:31,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:31,769 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:31
2025-03-13 12:37:31,769 [INFO]: 397.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:31,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:37:31,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:31
2025-03-13 12:37:31,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:31,769 [INFO]: 	Creating the index 03/13/2025, 12:37:31
2025-03-13 12:37:31,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:31
2025-03-13 12:37:31,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:37:31,770 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:31
2025-03-13 12:37:31,771 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:37:31,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  9.29it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 30.62it/s]
100%|██████████| 8/8 [00:01<00:00,  5.10it/s]
2025-03-13 12:37:33,342 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:33
2025-03-13 12:37:58,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6547 secs
2025-03-13 12:37:58,998 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:37:58,998 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:58

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.17it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 12:38:14,158 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1608 secs
2025-03-13 12:38:14,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3894 secs
2025-03-13 12:38:14,160 [INFO]: {
2025-03-13 12:38:14,160 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:14,160 [INFO]: 	index_param: efSearch=194
2025-03-13 12:38:14,160 [INFO]: 	index_path: knn.index
2025-03-13 12:38:14,160 [INFO]: 	size in bytes: 378732250
2025-03-13 12:38:14,160 [INFO]: 	avg_search_speed_ms: 11.328654066582516
2025-03-13 12:38:14,160 [INFO]: 	99p_search_speed_ms: 16.893740538507696
2025-03-13 12:38:14,160 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:14,160 [INFO]: 	nb vectors: 1925
2025-03-13 12:38:14,160 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:14,160 [INFO]: 	compression ratio: 0.99930861446312
2025-03-13 12:38:14,160 [INFO]: }
2025-03-13 12:38:14,160 [INFO]: 	>>> Finished "Creating the index" in 42.3910 secs
2025-03-13 12:38:14,160 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4202 secs
2025-03-13 12:38:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 23056 [episode count 0/20]
[retrieval_preprocessing] for episode 23 [episode count 1/20], we have num_retrieval=np.int64(1915) num_query=np.int64(90)
2025-03-13 12:38:14,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:15,286 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:15
2025-03-13 12:38:15,286 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:15

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1599.05it/s]
2025-03-13 12:38:15,312 [INFO]: There are 1915 embeddings of dim 49152
2025-03-13 12:38:15,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:38:15,312 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:15
2025-03-13 12:38:15,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:15,312 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:38:15,312 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:15,312 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:38:15,312 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:15
2025-03-13 12:38:15,312 [INFO]: 395.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:15,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:38:15,313 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:15
2025-03-13 12:38:15,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:15,313 [INFO]: 	Creating the index 03/13/2025, 12:38:15
2025-03-13 12:38:15,313 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:15
2025-03-13 12:38:15,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:38:15,314 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:15
2025-03-13 12:38:15,314 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:38:15,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 17.58it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 32.27it/s]
100%|██████████| 8/8 [00:01<00:00,  4.78it/s]
2025-03-13 12:38:17,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:17
2025-03-13 12:38:42,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0735 secs
2025-03-13 12:38:42,346 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 12:38:42,346 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:42

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.79it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 12:38:59,151 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8048 secs
2025-03-13 12:38:59,152 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8384 secs
2025-03-13 12:38:59,152 [INFO]: {
2025-03-13 12:38:59,153 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:59,153 [INFO]: 	index_param: efSearch=249
2025-03-13 12:38:59,153 [INFO]: 	index_path: knn.index
2025-03-13 12:38:59,153 [INFO]: 	size in bytes: 376764850
2025-03-13 12:38:59,153 [INFO]: 	avg_search_speed_ms: 11.086344539792899
2025-03-13 12:38:59,153 [INFO]: 	99p_search_speed_ms: 16.279654963873327
2025-03-13 12:38:59,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:59,153 [INFO]: 	nb vectors: 1915
2025-03-13 12:38:59,153 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:59,153 [INFO]: 	compression ratio: 0.9993085076805864
2025-03-13 12:38:59,153 [INFO]: }
2025-03-13 12:38:59,153 [INFO]: 	>>> Finished "Creating the index" in 43.8400 secs
2025-03-13 12:38:59,153 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8670 secs
2025-03-13 12:38:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 23 [episode count 1/20]
[retrieval_preprocessing] for episode 81492 [episode count 2/20], we have num_retrieval=np.int64(1896) num_query=np.int64(109)
2025-03-13 12:39:00,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:00,615 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:00
2025-03-13 12:39:00,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:00

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1200.09it/s]
2025-03-13 12:39:00,640 [INFO]: There are 1896 embeddings of dim 49152
2025-03-13 12:39:00,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 12:39:00,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:00
2025-03-13 12:39:00,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:00,641 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:39:00,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:00,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:00,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:00
2025-03-13 12:39:00,641 [INFO]: 391.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:00,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:00,641 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:00
2025-03-13 12:39:00,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:00,641 [INFO]: 	Creating the index 03/13/2025, 12:39:00
2025-03-13 12:39:00,641 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:00
2025-03-13 12:39:00,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:39:00,642 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:00
2025-03-13 12:39:00,642 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:39:00,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  9.45it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 31.04it/s]
100%|██████████| 8/8 [00:01<00:00,  5.07it/s]
2025-03-13 12:39:02,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:02
2025-03-13 12:39:31,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3136 secs
2025-03-13 12:39:31,538 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:39:31,538 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:31

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.94it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-13 12:39:45,563 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0247 secs
2025-03-13 12:39:45,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9226 secs
2025-03-13 12:39:45,565 [INFO]: {
2025-03-13 12:39:45,565 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:45,565 [INFO]: 	index_param: efSearch=190
2025-03-13 12:39:45,565 [INFO]: 	index_path: knn.index
2025-03-13 12:39:45,565 [INFO]: 	size in bytes: 373026670
2025-03-13 12:39:45,565 [INFO]: 	avg_search_speed_ms: 8.634539788937927
2025-03-13 12:39:45,565 [INFO]: 	99p_search_speed_ms: 11.517993055749685
2025-03-13 12:39:45,565 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:45,565 [INFO]: 	nb vectors: 1896
2025-03-13 12:39:45,565 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:45,565 [INFO]: 	compression ratio: 0.9993086231609123
2025-03-13 12:39:45,565 [INFO]: }
2025-03-13 12:39:45,565 [INFO]: 	>>> Finished "Creating the index" in 44.9240 secs
2025-03-13 12:39:45,565 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9502 secs
2025-03-13 12:39:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 81492 [episode count 2/20]
[retrieval_preprocessing] for episode 54374 [episode count 3/20], we have num_retrieval=np.int64(1905) num_query=np.int64(100)
2025-03-13 12:39:46,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:46,835 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:46
2025-03-13 12:39:46,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:46

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1144.73it/s]
2025-03-13 12:39:46,860 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 12:39:46,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 12:39:46,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:46
2025-03-13 12:39:46,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:46,861 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:39:46,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:46,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:46,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:46
2025-03-13 12:39:46,861 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:46,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:46,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:46
2025-03-13 12:39:46,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:46,861 [INFO]: 	Creating the index 03/13/2025, 12:39:46
2025-03-13 12:39:46,861 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:46
2025-03-13 12:39:46,862 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:39:46,862 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:46
2025-03-13 12:39:46,862 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:39:46,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 17.94it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 35.36it/s]
100%|██████████| 8/8 [00:01<00:00,  5.48it/s]
2025-03-13 12:39:48,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:48
2025-03-13 12:40:11,430 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1044 secs
2025-03-13 12:40:11,430 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 12:40:11,430 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:11

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.77it/s]
2025-03-13 12:40:35,906 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4757 secs
2025-03-13 12:40:35,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0453 secs
2025-03-13 12:40:35,908 [INFO]: {
2025-03-13 12:40:35,908 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:35,908 [INFO]: 	index_param: efSearch=291
2025-03-13 12:40:35,908 [INFO]: 	index_path: knn.index
2025-03-13 12:40:35,908 [INFO]: 	size in bytes: 374797450
2025-03-13 12:40:35,908 [INFO]: 	avg_search_speed_ms: 13.74299497795189
2025-03-13 12:40:35,908 [INFO]: 	99p_search_speed_ms: 30.142871651332833
2025-03-13 12:40:35,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:35,908 [INFO]: 	nb vectors: 1905
2025-03-13 12:40:35,908 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:35,908 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 12:40:35,908 [INFO]: }
2025-03-13 12:40:35,908 [INFO]: 	>>> Finished "Creating the index" in 49.0468 secs
2025-03-13 12:40:35,908 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0733 secs
2025-03-13 12:40:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 54374 [episode count 3/20]
[retrieval_preprocessing] for episode 39544 [episode count 4/20], we have num_retrieval=np.int64(1912) num_query=np.int64(93)
2025-03-13 12:40:37,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:37,564 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:37
2025-03-13 12:40:37,564 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:37

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1776.49it/s]
2025-03-13 12:40:37,588 [INFO]: There are 1912 embeddings of dim 49152
2025-03-13 12:40:37,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:40:37,588 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,588 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:37,589 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:40:37,589 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:37,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:40:37,589 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,589 [INFO]: 394.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:37,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:40:37,589 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:37
2025-03-13 12:40:37,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:37,589 [INFO]: 	Creating the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,589 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:37
2025-03-13 12:40:37,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:40:37,590 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:37
2025-03-13 12:40:37,590 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:40:37,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  8.31it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 29.79it/s]
100%|██████████| 8/8 [00:01<00:00,  4.37it/s]
2025-03-13 12:40:39,423 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:39
2025-03-13 12:41:07,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4377 secs
2025-03-13 12:41:07,862 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:41:07,862 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:07

  0%|          | 0/4 [00:00<?, ?it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 27.02it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 22.96it/s]
2025-03-13 12:41:33,474 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6117 secs
2025-03-13 12:41:33,475 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8855 secs
2025-03-13 12:41:33,476 [INFO]: {
2025-03-13 12:41:33,476 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:33,476 [INFO]: 	index_param: efSearch=190
2025-03-13 12:41:33,476 [INFO]: 	index_path: knn.index
2025-03-13 12:41:33,476 [INFO]: 	size in bytes: 376174630
2025-03-13 12:41:33,476 [INFO]: 	avg_search_speed_ms: 9.042682152899962
2025-03-13 12:41:33,476 [INFO]: 	99p_search_speed_ms: 11.89398573478684
2025-03-13 12:41:33,476 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:33,476 [INFO]: 	nb vectors: 1912
2025-03-13 12:41:33,476 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:33,476 [INFO]: 	compression ratio: 0.9993084754280213
2025-03-13 12:41:33,476 [INFO]: }
2025-03-13 12:41:33,476 [INFO]: 	>>> Finished "Creating the index" in 55.8870 secs
2025-03-13 12:41:33,476 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9119 secs
2025-03-13 12:41:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 39544 [episode count 4/20]
[retrieval_preprocessing] for episode 83598 [episode count 5/20], we have num_retrieval=np.int64(1876) num_query=np.int64(129)
2025-03-13 12:41:34,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:34,926 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:34
2025-03-13 12:41:34,926 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:34

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1774.24it/s]
2025-03-13 12:41:34,951 [INFO]: There are 1876 embeddings of dim 49152
2025-03-13 12:41:34,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:41:34,951 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:34
2025-03-13 12:41:34,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:34,951 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:41:34,952 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:41:34,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:41:34,952 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:34
2025-03-13 12:41:34,952 [INFO]: 387.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:34,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:41:34,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:34
2025-03-13 12:41:34,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:41:34,952 [INFO]: 	Creating the index 03/13/2025, 12:41:34
2025-03-13 12:41:34,952 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:41:34
2025-03-13 12:41:34,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:41:34,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:34
2025-03-13 12:41:34,953 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:41:34,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  8.55it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 28.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.86it/s]
2025-03-13 12:41:37,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:37
2025-03-13 12:42:09,737 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7065 secs
2025-03-13 12:42:09,737 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 12:42:09,737 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:09

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:03<00:10,  3.53s/it]
 50%|█████     | 2/4 [00:05<00:05,  2.70s/it]
 75%|███████▌  | 3/4 [00:06<00:01,  1.77s/it]
 75%|███████▌  | 3/4 [00:06<00:02,  2.30s/it]
2025-03-13 12:42:32,548 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8111 secs
2025-03-13 12:42:32,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5971 secs
2025-03-13 12:42:32,550 [INFO]: {
2025-03-13 12:42:32,550 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:32,550 [INFO]: 	index_param: efSearch=163
2025-03-13 12:42:32,550 [INFO]: 	index_path: knn.index
2025-03-13 12:42:32,550 [INFO]: 	size in bytes: 369091750
2025-03-13 12:42:32,550 [INFO]: 	avg_search_speed_ms: 7.518022500951879
2025-03-13 12:42:32,550 [INFO]: 	99p_search_speed_ms: 10.72882846463472
2025-03-13 12:42:32,550 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:32,550 [INFO]: 	nb vectors: 1876
2025-03-13 12:42:32,550 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:32,550 [INFO]: 	compression ratio: 0.999308730146366
2025-03-13 12:42:32,550 [INFO]: }
2025-03-13 12:42:32,550 [INFO]: 	>>> Finished "Creating the index" in 57.5985 secs
2025-03-13 12:42:32,550 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6244 secs
2025-03-13 12:42:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 83598 [episode count 5/20]
[retrieval_preprocessing] for episode 25757 [episode count 6/20], we have num_retrieval=np.int64(1893) num_query=np.int64(112)
2025-03-13 12:42:33,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:34,010 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:34
2025-03-13 12:42:34,010 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:34

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1626.96it/s]
2025-03-13 12:42:34,045 [INFO]: There are 1893 embeddings of dim 49152
2025-03-13 12:42:34,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 12:42:34,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:34
2025-03-13 12:42:34,045 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:34,045 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:42:34,045 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:34,045 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:42:34,045 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:34
2025-03-13 12:42:34,045 [INFO]: 390.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:34,045 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:42:34,045 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:34
2025-03-13 12:42:34,045 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:34,045 [INFO]: 	Creating the index 03/13/2025, 12:42:34
2025-03-13 12:42:34,045 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:34
2025-03-13 12:42:34,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:42:34,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:34
2025-03-13 12:42:34,046 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:42:34,047 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  9.34it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 26.81it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
2025-03-13 12:42:36,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:36
2025-03-13 12:43:03,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2072 secs
2025-03-13 12:43:03,481 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:43:03,481 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:03

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  8.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 14.82it/s]
2025-03-13 12:43:27,298 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8165 secs
2025-03-13 12:43:27,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2532 secs
2025-03-13 12:43:27,300 [INFO]: {
2025-03-13 12:43:27,300 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:27,300 [INFO]: 	index_param: efSearch=221
2025-03-13 12:43:27,300 [INFO]: 	index_path: knn.index
2025-03-13 12:43:27,300 [INFO]: 	size in bytes: 372436450
2025-03-13 12:43:27,300 [INFO]: 	avg_search_speed_ms: 11.749209696864742
2025-03-13 12:43:27,300 [INFO]: 	99p_search_speed_ms: 22.10986311547458
2025-03-13 12:43:27,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:27,300 [INFO]: 	nb vectors: 1893
2025-03-13 12:43:27,300 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:27,300 [INFO]: 	compression ratio: 0.999308590767633
2025-03-13 12:43:27,300 [INFO]: }
2025-03-13 12:43:27,300 [INFO]: 	>>> Finished "Creating the index" in 53.2546 secs
2025-03-13 12:43:27,300 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2898 secs
2025-03-13 12:43:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 25757 [episode count 6/20]
[retrieval_preprocessing] for episode 16545 [episode count 7/20], we have num_retrieval=np.int64(1922) num_query=np.int64(83)
2025-03-13 12:43:28,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:28,654 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:28
2025-03-13 12:43:28,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:28

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-13 12:43:28,680 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 12:43:28,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 12:43:28,680 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:28
2025-03-13 12:43:28,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:28,681 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:43:28,681 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:28,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:43:28,681 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:28
2025-03-13 12:43:28,681 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:28,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:43:28,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:28
2025-03-13 12:43:28,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:28,682 [INFO]: 	Creating the index 03/13/2025, 12:43:28
2025-03-13 12:43:28,682 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:28
2025-03-13 12:43:28,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:43:28,685 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:28
2025-03-13 12:43:28,686 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:43:28,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 19.49it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 36.24it/s]
100%|██████████| 8/8 [00:02<00:00,  3.67it/s]
2025-03-13 12:43:30,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:30
2025-03-13 12:43:58,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7011 secs
2025-03-13 12:43:58,573 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 12:43:58,573 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:58

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 16.85it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 17.37it/s]
2025-03-13 12:44:11,503 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9306 secs
2025-03-13 12:44:11,505 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8195 secs
2025-03-13 12:44:11,505 [INFO]: {
2025-03-13 12:44:11,505 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:11,505 [INFO]: 	index_param: efSearch=236
2025-03-13 12:44:11,505 [INFO]: 	index_path: knn.index
2025-03-13 12:44:11,505 [INFO]: 	size in bytes: 378142030
2025-03-13 12:44:11,505 [INFO]: 	avg_search_speed_ms: 10.800757560301692
2025-03-13 12:44:11,505 [INFO]: 	99p_search_speed_ms: 17.1638767933473
2025-03-13 12:44:11,505 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:11,505 [INFO]: 	nb vectors: 1922
2025-03-13 12:44:11,505 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:11,505 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 12:44:11,505 [INFO]: }
2025-03-13 12:44:11,505 [INFO]: 	>>> Finished "Creating the index" in 42.8232 secs
2025-03-13 12:44:11,505 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8513 secs
2025-03-13 12:44:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 16545 [episode count 7/20]
[retrieval_preprocessing] for episode 23751 [episode count 8/20], we have num_retrieval=np.int64(1906) num_query=np.int64(99)
2025-03-13 12:44:12,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:13,145 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:13
2025-03-13 12:44:13,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1095.69it/s]
2025-03-13 12:44:13,584 [INFO]: There are 1906 embeddings of dim 49152
2025-03-13 12:44:13,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4398 secs
2025-03-13 12:44:13,585 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:13
2025-03-13 12:44:13,585 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:13,585 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:44:13,585 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:13,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:44:13,585 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:13
2025-03-13 12:44:13,586 [INFO]: 393.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:13,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:44:13,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:13
2025-03-13 12:44:13,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:13,586 [INFO]: 	Creating the index 03/13/2025, 12:44:13
2025-03-13 12:44:13,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:13
2025-03-13 12:44:13,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:44:13,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:13
2025-03-13 12:44:13,589 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:44:13,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 38%|███▊      | 3/8 [00:00<00:00, 25.24it/s]
100%|██████████| 8/8 [00:01<00:00,  4.51it/s]
100%|██████████| 8/8 [00:01<00:00,  4.96it/s]
2025-03-13 12:44:15,206 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:15
2025-03-13 12:44:41,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8075 secs
2025-03-13 12:44:41,014 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 12:44:41,014 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:41

  0%|          | 0/4 [00:00<?, ?it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 28.28it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 23.71it/s]
2025-03-13 12:45:00,925 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9102 secs
2025-03-13 12:45:00,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3378 secs
2025-03-13 12:45:00,927 [INFO]: {
2025-03-13 12:45:00,927 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:00,927 [INFO]: 	index_param: efSearch=217
2025-03-13 12:45:00,927 [INFO]: 	index_path: knn.index
2025-03-13 12:45:00,927 [INFO]: 	size in bytes: 374994190
2025-03-13 12:45:00,927 [INFO]: 	avg_search_speed_ms: 10.238188719272065
2025-03-13 12:45:00,927 [INFO]: 	99p_search_speed_ms: 17.13896762579681
2025-03-13 12:45:00,927 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:00,927 [INFO]: 	nb vectors: 1906
2025-03-13 12:45:00,927 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:00,927 [INFO]: 	compression ratio: 0.9993084106183086
2025-03-13 12:45:00,927 [INFO]: }
2025-03-13 12:45:00,927 [INFO]: 	>>> Finished "Creating the index" in 47.3405 secs
2025-03-13 12:45:00,927 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7824 secs
2025-03-13 12:45:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 23751 [episode count 8/20]
[retrieval_preprocessing] for episode 70352 [episode count 9/20], we have num_retrieval=np.int64(1927) num_query=np.int64(78)
2025-03-13 12:45:01,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:02,121 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:02
2025-03-13 12:45:02,121 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:02

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 12:45:02,148 [INFO]: There are 1927 embeddings of dim 49152
2025-03-13 12:45:02,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 12:45:02,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:02
2025-03-13 12:45:02,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:02,148 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:45:02,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:02,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:02,148 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:02
2025-03-13 12:45:02,148 [INFO]: 397.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:02,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:45:02,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:02
2025-03-13 12:45:02,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:02,148 [INFO]: 	Creating the index 03/13/2025, 12:45:02
2025-03-13 12:45:02,149 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:02
2025-03-13 12:45:02,150 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:45:02,150 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:02
2025-03-13 12:45:02,150 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:45:02,150 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  9.50it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 35.65it/s]
100%|██████████| 8/8 [00:01<00:00,  5.27it/s]
2025-03-13 12:45:03,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:03
2025-03-13 12:45:32,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7812 secs
2025-03-13 12:45:32,453 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 12:45:32,453 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:32

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 18.88it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.49it/s]
2025-03-13 12:45:49,065 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6118 secs
2025-03-13 12:45:49,067 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9170 secs
2025-03-13 12:45:49,067 [INFO]: {
2025-03-13 12:45:49,067 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:49,067 [INFO]: 	index_param: efSearch=205
2025-03-13 12:45:49,067 [INFO]: 	index_path: knn.index
2025-03-13 12:45:49,067 [INFO]: 	size in bytes: 379125790
2025-03-13 12:45:49,067 [INFO]: 	avg_search_speed_ms: 11.844432177352747
2025-03-13 12:45:49,067 [INFO]: 	99p_search_speed_ms: 18.799905879423022
2025-03-13 12:45:49,067 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:49,067 [INFO]: 	nb vectors: 1927
2025-03-13 12:45:49,067 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:49,067 [INFO]: 	compression ratio: 0.9993084775372311
2025-03-13 12:45:49,067 [INFO]: }
2025-03-13 12:45:49,067 [INFO]: 	>>> Finished "Creating the index" in 46.9187 secs
2025-03-13 12:45:49,067 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9463 secs
2025-03-13 12:45:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 70352 [episode count 9/20]
[retrieval_preprocessing] for episode 4313 [episode count 10/20], we have num_retrieval=np.int64(1903) num_query=np.int64(102)
2025-03-13 12:45:50,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:50,381 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:50
2025-03-13 12:45:50,381 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:50

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-13 12:45:50,407 [INFO]: There are 1903 embeddings of dim 49152
2025-03-13 12:45:50,407 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:45:50,408 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:50
2025-03-13 12:45:50,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:50,408 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:45:50,408 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:50,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:45:50,409 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:50
2025-03-13 12:45:50,409 [INFO]: 392.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:50,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:45:50,409 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:50
2025-03-13 12:45:50,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:50,410 [INFO]: 	Creating the index 03/13/2025, 12:45:50
2025-03-13 12:45:50,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:50
2025-03-13 12:45:50,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:45:50,414 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:50
2025-03-13 12:45:50,414 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:45:50,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 19.98it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 34.31it/s]
100%|██████████| 8/8 [00:01<00:00,  4.50it/s]
2025-03-13 12:45:52,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:52
2025-03-13 12:46:17,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9201 secs
2025-03-13 12:46:17,118 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 12:46:17,118 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:17

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 12:46:33,797 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6792 secs
2025-03-13 12:46:33,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3849 secs
2025-03-13 12:46:33,799 [INFO]: {
2025-03-13 12:46:33,799 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:33,799 [INFO]: 	index_param: efSearch=257
2025-03-13 12:46:33,799 [INFO]: 	index_path: knn.index
2025-03-13 12:46:33,799 [INFO]: 	size in bytes: 374403970
2025-03-13 12:46:33,799 [INFO]: 	avg_search_speed_ms: 13.326697525867173
2025-03-13 12:46:33,799 [INFO]: 	99p_search_speed_ms: 18.65771703887731
2025-03-13 12:46:33,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:33,799 [INFO]: 	nb vectors: 1903
2025-03-13 12:46:33,799 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:33,799 [INFO]: 	compression ratio: 0.9993083780602006
2025-03-13 12:46:33,799 [INFO]: }
2025-03-13 12:46:33,799 [INFO]: 	>>> Finished "Creating the index" in 43.3893 secs
2025-03-13 12:46:33,799 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4184 secs
2025-03-13 12:46:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 4313 [episode count 10/20]
[retrieval_preprocessing] for episode 88813 [episode count 11/20], we have num_retrieval=np.int64(1906) num_query=np.int64(99)
2025-03-13 12:46:35,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:35,683 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:35
2025-03-13 12:46:35,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:35

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-13 12:46:35,715 [INFO]: There are 1906 embeddings of dim 49152
2025-03-13 12:46:35,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 12:46:35,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:35
2025-03-13 12:46:35,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:35,716 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:46:35,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:35,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:46:35,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:35
2025-03-13 12:46:35,717 [INFO]: 393.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:35,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:46:35,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:35
2025-03-13 12:46:35,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:35,718 [INFO]: 	Creating the index 03/13/2025, 12:46:35
2025-03-13 12:46:35,718 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:35
2025-03-13 12:46:35,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:46:35,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:35
2025-03-13 12:46:35,721 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:46:35,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 16.98it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 28.91it/s]
100%|██████████| 8/8 [00:01<00:00,  4.21it/s]
2025-03-13 12:46:37,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:37
2025-03-13 12:47:05,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1708 secs
2025-03-13 12:47:05,798 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:47:05,799 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:05

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 15.94it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 12:47:20,458 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6588 secs
2025-03-13 12:47:20,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7378 secs
2025-03-13 12:47:20,459 [INFO]: {
2025-03-13 12:47:20,459 [INFO]: 	index_key: HNSW15
2025-03-13 12:47:20,459 [INFO]: 	index_param: efSearch=194
2025-03-13 12:47:20,459 [INFO]: 	index_path: knn.index
2025-03-13 12:47:20,459 [INFO]: 	size in bytes: 374994190
2025-03-13 12:47:20,459 [INFO]: 	avg_search_speed_ms: 9.181377863643146
2025-03-13 12:47:20,459 [INFO]: 	99p_search_speed_ms: 14.138551820069543
2025-03-13 12:47:20,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:20,459 [INFO]: 	nb vectors: 1906
2025-03-13 12:47:20,459 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:20,459 [INFO]: 	compression ratio: 0.9993084106183086
2025-03-13 12:47:20,459 [INFO]: }
2025-03-13 12:47:20,459 [INFO]: 	>>> Finished "Creating the index" in 44.7416 secs
2025-03-13 12:47:20,459 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7765 secs
2025-03-13 12:47:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 88813 [episode count 11/20]
[retrieval_preprocessing] for episode 87298 [episode count 12/20], we have num_retrieval=np.int64(1913) num_query=np.int64(92)
2025-03-13 12:47:21,355 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:47:21,608 [INFO]: Launching the whole pipeline 03/13/2025, 12:47:21
2025-03-13 12:47:21,608 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:47:21

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1218.57it/s]
2025-03-13 12:47:21,637 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 12:47:21,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 12:47:21,638 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:47:21
2025-03-13 12:47:21,638 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:47:21,639 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:47:21,639 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:47:21,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:47:21,639 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:47:21
2025-03-13 12:47:21,639 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:47:21,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:47:21,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:47:21
2025-03-13 12:47:21,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:47:21,640 [INFO]: 	Creating the index 03/13/2025, 12:47:21
2025-03-13 12:47:21,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:47:21
2025-03-13 12:47:21,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:47:21,644 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:47:21
2025-03-13 12:47:21,644 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:47:21,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 25%|██▌       | 2/8 [00:00<00:00, 19.34it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 35.86it/s]
100%|██████████| 8/8 [00:01<00:00,  4.88it/s]
2025-03-13 12:47:23,287 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:23
2025-03-13 12:47:59,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5079 secs
2025-03-13 12:47:59,796 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:47:59,796 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:59

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 12.91it/s]
2025-03-13 12:48:22,667 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8714 secs
2025-03-13 12:48:22,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0249 secs
2025-03-13 12:48:22,669 [INFO]: {
2025-03-13 12:48:22,669 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:22,669 [INFO]: 	index_param: efSearch=208
2025-03-13 12:48:22,669 [INFO]: 	index_path: knn.index
2025-03-13 12:48:22,669 [INFO]: 	size in bytes: 376371370
2025-03-13 12:48:22,669 [INFO]: 	avg_search_speed_ms: 10.047996687426714
2025-03-13 12:48:22,669 [INFO]: 	99p_search_speed_ms: 15.876739220693691
2025-03-13 12:48:22,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:22,669 [INFO]: 	nb vectors: 1913
2025-03-13 12:48:22,669 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:22,669 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 12:48:22,669 [INFO]: }
2025-03-13 12:48:22,669 [INFO]: 	>>> Finished "Creating the index" in 61.0289 secs
2025-03-13 12:48:22,669 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0616 secs
2025-03-13 12:48:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 87298 [episode count 12/20]
[retrieval_preprocessing] for episode 41219 [episode count 13/20], we have num_retrieval=np.int64(1908) num_query=np.int64(97)
2025-03-13 12:48:23,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:24,033 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:24
2025-03-13 12:48:24,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:24

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1474.27it/s]
2025-03-13 12:48:24,061 [INFO]: There are 1908 embeddings of dim 49152
2025-03-13 12:48:24,061 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 12:48:24,061 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:24
2025-03-13 12:48:24,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:24,062 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:48:24,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:24,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:48:24,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:24
2025-03-13 12:48:24,063 [INFO]: 393.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:24,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:48:24,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:24
2025-03-13 12:48:24,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:24,064 [INFO]: 	Creating the index 03/13/2025, 12:48:24
2025-03-13 12:48:24,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:24
2025-03-13 12:48:24,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:48:24,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:24
2025-03-13 12:48:24,067 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:48:24,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 38%|███▊      | 3/8 [00:00<00:00, 24.67it/s]
100%|██████████| 8/8 [00:01<00:00,  4.00it/s]
100%|██████████| 8/8 [00:01<00:00,  4.41it/s]
2025-03-13 12:48:25,889 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:25
2025-03-13 12:48:54,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9129 secs
2025-03-13 12:48:54,803 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 12:48:54,803 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:54

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.98it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-13 12:49:22,408 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6053 secs
2025-03-13 12:49:22,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3427 secs
2025-03-13 12:49:22,410 [INFO]: {
2025-03-13 12:49:22,410 [INFO]: 	index_key: HNSW15
2025-03-13 12:49:22,410 [INFO]: 	index_param: efSearch=210
2025-03-13 12:49:22,410 [INFO]: 	index_path: knn.index
2025-03-13 12:49:22,410 [INFO]: 	size in bytes: 375387670
2025-03-13 12:49:22,410 [INFO]: 	avg_search_speed_ms: 9.392869585530368
2025-03-13 12:49:22,410 [INFO]: 	99p_search_speed_ms: 12.022718060761688
2025-03-13 12:49:22,410 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:49:22,410 [INFO]: 	nb vectors: 1908
2025-03-13 12:49:22,410 [INFO]: 	vectors dimension: 49152
2025-03-13 12:49:22,410 [INFO]: 	compression ratio: 0.999308432266835
2025-03-13 12:49:22,410 [INFO]: }
2025-03-13 12:49:22,410 [INFO]: 	>>> Finished "Creating the index" in 58.3464 secs
2025-03-13 12:49:22,410 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3768 secs
2025-03-13 12:49:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:49:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 41219 [episode count 13/20]
[retrieval_preprocessing] for episode 68368 [episode count 14/20], we have num_retrieval=np.int64(1896) num_query=np.int64(109)
2025-03-13 12:49:23,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:49:23,533 [INFO]: Launching the whole pipeline 03/13/2025, 12:49:23
2025-03-13 12:49:23,533 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:49:23

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1728.18it/s]
2025-03-13 12:49:23,557 [INFO]: There are 1896 embeddings of dim 49152
2025-03-13 12:49:23,557 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:49:23,557 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:49:23
2025-03-13 12:49:23,557 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:49:23,557 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:49:23,557 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:49:23,557 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:49:23,557 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:49:23
2025-03-13 12:49:23,557 [INFO]: 391.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:49:23,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:49:23,557 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:49:23
2025-03-13 12:49:23,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:49:23,557 [INFO]: 	Creating the index 03/13/2025, 12:49:23
2025-03-13 12:49:23,557 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:49:23
2025-03-13 12:49:23,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:49:23,558 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:49:23
2025-03-13 12:49:23,558 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:49:23,559 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  8.80it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 31.07it/s]
100%|██████████| 8/8 [00:01<00:00,  5.64it/s]
2025-03-13 12:49:24,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:49:24
2025-03-13 12:49:56,218 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2378 secs
2025-03-13 12:49:56,218 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:49:56,218 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:56

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 20.00it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 12:50:13,677 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4584 secs
2025-03-13 12:50:13,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1196 secs
2025-03-13 12:50:13,678 [INFO]: {
2025-03-13 12:50:13,678 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:13,678 [INFO]: 	index_param: efSearch=253
2025-03-13 12:50:13,678 [INFO]: 	index_path: knn.index
2025-03-13 12:50:13,678 [INFO]: 	size in bytes: 373026670
2025-03-13 12:50:13,678 [INFO]: 	avg_search_speed_ms: 10.344812591370454
2025-03-13 12:50:13,678 [INFO]: 	99p_search_speed_ms: 17.887700768187642
2025-03-13 12:50:13,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:13,678 [INFO]: 	nb vectors: 1896
2025-03-13 12:50:13,678 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:13,678 [INFO]: 	compression ratio: 0.9993086231609123
2025-03-13 12:50:13,678 [INFO]: }
2025-03-13 12:50:13,678 [INFO]: 	>>> Finished "Creating the index" in 50.1209 secs
2025-03-13 12:50:13,678 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1456 secs
2025-03-13 12:50:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 68368 [episode count 14/20]
[retrieval_preprocessing] for episode 60181 [episode count 15/20], we have num_retrieval=np.int64(1919) num_query=np.int64(86)
2025-03-13 12:50:14,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:15,588 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:15
2025-03-13 12:50:15,588 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:15

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1459.90it/s]
2025-03-13 12:50:15,614 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 12:50:15,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 12:50:15,614 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:15
2025-03-13 12:50:15,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:15,615 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:50:15,615 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:15,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:50:15,615 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:15
2025-03-13 12:50:15,616 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:15,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:50:15,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:15
2025-03-13 12:50:15,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:15,616 [INFO]: 	Creating the index 03/13/2025, 12:50:15
2025-03-13 12:50:15,617 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:15
2025-03-13 12:50:15,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:50:15,620 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:15
2025-03-13 12:50:15,620 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:50:15,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 38%|███▊      | 3/8 [00:00<00:00, 26.14it/s]
100%|██████████| 8/8 [00:01<00:00,  4.89it/s]
100%|██████████| 8/8 [00:01<00:00,  5.38it/s]
2025-03-13 12:50:17,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:17
2025-03-13 12:50:45,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6242 secs
2025-03-13 12:50:45,735 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:50:45,735 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:45

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 12:51:00,953 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2184 secs
2025-03-13 12:51:00,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3354 secs
2025-03-13 12:51:00,956 [INFO]: {
2025-03-13 12:51:00,956 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:00,956 [INFO]: 	index_param: efSearch=187
2025-03-13 12:51:00,956 [INFO]: 	index_path: knn.index
2025-03-13 12:51:00,956 [INFO]: 	size in bytes: 377551810
2025-03-13 12:51:00,956 [INFO]: 	avg_search_speed_ms: 10.195562671528224
2025-03-13 12:51:00,956 [INFO]: 	99p_search_speed_ms: 15.723915258422496
2025-03-13 12:51:00,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:00,956 [INFO]: 	nb vectors: 1919
2025-03-13 12:51:00,956 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:00,956 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 12:51:00,956 [INFO]: }
2025-03-13 12:51:00,956 [INFO]: 	>>> Finished "Creating the index" in 45.3393 secs
2025-03-13 12:51:00,956 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3677 secs
2025-03-13 12:51:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 60181 [episode count 15/20]
[retrieval_preprocessing] for episode 21699 [episode count 16/20], we have num_retrieval=np.int64(1830) num_query=np.int64(175)
2025-03-13 12:51:02,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:02,523 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:02
2025-03-13 12:51:02,523 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:02

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1426.63it/s]
2025-03-13 12:51:02,549 [INFO]: There are 1830 embeddings of dim 49152
2025-03-13 12:51:02,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:51:02,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:02
2025-03-13 12:51:02,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:02,549 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:51:02,549 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:02,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:02,549 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:02
2025-03-13 12:51:02,549 [INFO]: 377.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:02,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:51:02,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:02
2025-03-13 12:51:02,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:02,550 [INFO]: 	Creating the index 03/13/2025, 12:51:02
2025-03-13 12:51:02,550 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:02
2025-03-13 12:51:02,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:51:02,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:02
2025-03-13 12:51:02,551 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:51:02,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  7.67it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 24.35it/s]
100%|██████████| 8/8 [00:01<00:00,  3.39it/s]
100%|██████████| 8/8 [00:01<00:00,  4.10it/s]
2025-03-13 12:51:04,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:04
2025-03-13 12:51:28,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6204 secs
2025-03-13 12:51:28,129 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:51:28,129 [INFO]: 	Compute fast metrics 03/13/2025, 12:51:28

  0%|          | 0/4 [00:00<?, ?it/s]
 50%|█████     | 2/4 [00:00<00:00, 19.31it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-13 12:51:43,544 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4147 secs
2025-03-13 12:51:43,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9942 secs
2025-03-13 12:51:43,545 [INFO]: {
2025-03-13 12:51:43,545 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:43,545 [INFO]: 	index_param: efSearch=207
2025-03-13 12:51:43,545 [INFO]: 	index_path: knn.index
2025-03-13 12:51:43,545 [INFO]: 	size in bytes: 360041410
2025-03-13 12:51:43,545 [INFO]: 	avg_search_speed_ms: 8.974885637203109
2025-03-13 12:51:43,545 [INFO]: 	99p_search_speed_ms: 11.517667814623557
2025-03-13 12:51:43,545 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:43,545 [INFO]: 	nb vectors: 1830
2025-03-13 12:51:43,545 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:43,545 [INFO]: 	compression ratio: 0.9993090517004697
2025-03-13 12:51:43,545 [INFO]: }
2025-03-13 12:51:43,545 [INFO]: 	>>> Finished "Creating the index" in 40.9955 secs
2025-03-13 12:51:43,545 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0224 secs
2025-03-13 12:51:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 21699 [episode count 16/20]
[retrieval_preprocessing] for episode 94016 [episode count 17/20], we have num_retrieval=np.int64(1914) num_query=np.int64(91)
2025-03-13 12:51:45,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:46,112 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:46
2025-03-13 12:51:46,112 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:46

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1996.34it/s]
2025-03-13 12:51:46,138 [INFO]: There are 1914 embeddings of dim 49152
2025-03-13 12:51:46,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 12:51:46,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:46
2025-03-13 12:51:46,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:46,138 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:51:46,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:46,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:46,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:46
2025-03-13 12:51:46,138 [INFO]: 395.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:46,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:51:46,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:46
2025-03-13 12:51:46,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:46,138 [INFO]: 	Creating the index 03/13/2025, 12:51:46
2025-03-13 12:51:46,139 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:46
2025-03-13 12:51:46,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:51:46,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:46
2025-03-13 12:51:46,140 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:51:46,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.24it/s]
 25%|██▌       | 2/8 [00:00<00:00,  6.81it/s]
 38%|███▊      | 3/8 [00:00<00:00,  7.66it/s]
 50%|█████     | 4/8 [00:00<00:00,  8.04it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.23it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  8.36it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  8.43it/s]
100%|██████████| 8/8 [00:02<00:00,  1.80it/s]
100%|██████████| 8/8 [00:02<00:00,  3.36it/s]
2025-03-13 12:51:48,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:48
2025-03-13 12:52:18,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7248 secs
2025-03-13 12:52:18,253 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 12:52:18,253 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:18

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:02<00:07,  2.51s/it]
 50%|█████     | 2/4 [00:02<00:02,  1.17s/it]
 75%|███████▌  | 3/4 [00:02<00:00,  1.06it/s]
2025-03-13 12:52:34,653 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3997 secs
2025-03-13 12:52:34,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5148 secs
2025-03-13 12:52:34,655 [INFO]: {
2025-03-13 12:52:34,655 [INFO]: 	index_key: HNSW15
2025-03-13 12:52:34,655 [INFO]: 	index_param: efSearch=183
2025-03-13 12:52:34,655 [INFO]: 	index_path: knn.index
2025-03-13 12:52:34,655 [INFO]: 	size in bytes: 376568110
2025-03-13 12:52:34,655 [INFO]: 	avg_search_speed_ms: 8.147251611983839
2025-03-13 12:52:34,655 [INFO]: 	99p_search_speed_ms: 15.599771165288987
2025-03-13 12:52:34,655 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:52:34,655 [INFO]: 	nb vectors: 1914
2025-03-13 12:52:34,655 [INFO]: 	vectors dimension: 49152
2025-03-13 12:52:34,655 [INFO]: 	compression ratio: 0.9993084969409651
2025-03-13 12:52:34,655 [INFO]: }
2025-03-13 12:52:34,655 [INFO]: 	>>> Finished "Creating the index" in 48.5166 secs
2025-03-13 12:52:34,655 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5430 secs
2025-03-13 12:52:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:52:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 94016 [episode count 17/20]
[retrieval_preprocessing] for episode 6027 [episode count 18/20], we have num_retrieval=np.int64(1920) num_query=np.int64(85)
2025-03-13 12:52:36,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:52:36,649 [INFO]: Launching the whole pipeline 03/13/2025, 12:52:36
2025-03-13 12:52:36,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:52:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1114.02it/s]
2025-03-13 12:52:36,679 [INFO]: There are 1920 embeddings of dim 49152
2025-03-13 12:52:36,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 12:52:36,680 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:52:36
2025-03-13 12:52:36,680 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:52:36,680 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:52:36,680 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:52:36,680 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:52:36,680 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:52:36
2025-03-13 12:52:36,680 [INFO]: 396.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:52:36,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:52:36,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:52:36
2025-03-13 12:52:36,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:52:36,680 [INFO]: 	Creating the index 03/13/2025, 12:52:36
2025-03-13 12:52:36,680 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:52:36
2025-03-13 12:52:36,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:52:36,682 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:52:36
2025-03-13 12:52:36,682 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:52:36,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  6.25it/s]
 38%|███▊      | 3/8 [00:00<00:00, 10.48it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 12.36it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 13.57it/s]
100%|██████████| 8/8 [00:01<00:00,  4.31it/s]
2025-03-13 12:52:38,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:52:38
2025-03-13 12:53:13,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1380 secs
2025-03-13 12:53:13,684 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 12:53:13,684 [INFO]: 	Compute fast metrics 03/13/2025, 12:53:13

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:04<00:12,  4.18s/it]
 50%|█████     | 2/4 [00:06<00:05,  2.94s/it]
 75%|███████▌  | 3/4 [00:06<00:02,  2.12s/it]
2025-03-13 12:53:33,647 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9632 secs
2025-03-13 12:53:33,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9676 secs
2025-03-13 12:53:33,650 [INFO]: {
2025-03-13 12:53:33,650 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:33,650 [INFO]: 	index_param: efSearch=287
2025-03-13 12:53:33,650 [INFO]: 	index_path: knn.index
2025-03-13 12:53:33,650 [INFO]: 	size in bytes: 377748550
2025-03-13 12:53:33,650 [INFO]: 	avg_search_speed_ms: 10.451958675079569
2025-03-13 12:53:33,650 [INFO]: 	99p_search_speed_ms: 18.072439311072195
2025-03-13 12:53:33,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:33,650 [INFO]: 	nb vectors: 1920
2025-03-13 12:53:33,650 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:33,650 [INFO]: 	compression ratio: 0.9993085612108902
2025-03-13 12:53:33,650 [INFO]: }
2025-03-13 12:53:33,650 [INFO]: 	>>> Finished "Creating the index" in 56.9696 secs
2025-03-13 12:53:33,650 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0002 secs
2025-03-13 12:53:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 6027 [episode count 18/20]
[retrieval_preprocessing] for episode 26516 [episode count 19/20], we have num_retrieval=np.int64(1909) num_query=np.int64(96)
2025-03-13 12:53:35,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:36,165 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:36
2025-03-13 12:53:36,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1405.60it/s]
2025-03-13 12:53:36,193 [INFO]: There are 1909 embeddings of dim 49152
2025-03-13 12:53:36,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:53:36,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:36
2025-03-13 12:53:36,193 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:36,193 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:53:36,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:53:36,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:53:36,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:36
2025-03-13 12:53:36,194 [INFO]: 394.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:36,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:53:36,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:36
2025-03-13 12:53:36,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:36,194 [INFO]: 	Creating the index 03/13/2025, 12:53:36
2025-03-13 12:53:36,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:36
2025-03-13 12:53:36,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:53:36,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:36
2025-03-13 12:53:36,195 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:53:36,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.36it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.24it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  9.56it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 11.07it/s]
100%|██████████| 8/8 [00:01<00:00,  4.10it/s]
2025-03-13 12:53:38,150 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:53:38
2025-03-13 12:54:01,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8646 secs
2025-03-13 12:54:01,016 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:54:01,016 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:01

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  3.73it/s]
 50%|█████     | 2/4 [00:00<00:00,  5.76it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 12:54:16,487 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4708 secs
2025-03-13 12:54:16,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4655 secs
2025-03-13 12:54:16,661 [INFO]: {
2025-03-13 12:54:16,661 [INFO]: 	index_key: HNSW15
2025-03-13 12:54:16,661 [INFO]: 	index_param: efSearch=187
2025-03-13 12:54:16,661 [INFO]: 	index_path: knn.index
2025-03-13 12:54:16,661 [INFO]: 	size in bytes: 375584410
2025-03-13 12:54:16,661 [INFO]: 	avg_search_speed_ms: 8.795547387959958
2025-03-13 12:54:16,661 [INFO]: 	99p_search_speed_ms: 16.586766494438063
2025-03-13 12:54:16,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:54:16,661 [INFO]: 	nb vectors: 1909
2025-03-13 12:54:16,661 [INFO]: 	vectors dimension: 49152
2025-03-13 12:54:16,661 [INFO]: 	compression ratio: 0.9993084430740882
2025-03-13 12:54:16,661 [INFO]: }
2025-03-13 12:54:16,662 [INFO]: 	>>> Finished "Creating the index" in 40.4678 secs
2025-03-13 12:54:16,662 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4969 secs
2025-03-13 12:54:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:54:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 26516 [episode count 19/20]
2025-03-13 12:54:18: [retrieval_preprocessing] finished for 5879622450_put_yellow_block_in_blue_cup [chosen_id count 4/260]
2025-03-13 12:54:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5879622450_put_yellow_block_in_cup [chosen_id count 5/260]
2025-03-13 12:54:19: [retrieval_preprocessing] we have num_total=1985 embedding_dim=49152
[retrieval_preprocessing] for episode 64528 [episode count 0/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 12:54:20,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:54:20,766 [INFO]: Launching the whole pipeline 03/13/2025, 12:54:20
2025-03-13 12:54:20,766 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:54:20

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1473.24it/s]
2025-03-13 12:54:20,794 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 12:54:20,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:54:20,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:54:20
2025-03-13 12:54:20,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:54:20,795 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:54:20,795 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:54:20,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:54:20,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:54:20
2025-03-13 12:54:20,795 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:54:20,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:54:20,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:54:20
2025-03-13 12:54:20,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:54:20,796 [INFO]: 	Creating the index 03/13/2025, 12:54:20
2025-03-13 12:54:20,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:54:20
2025-03-13 12:54:20,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:54:20,799 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:54:20
2025-03-13 12:54:20,799 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:54:20,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  7.01it/s]
 38%|███▊      | 3/8 [00:00<00:00, 10.41it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 11.30it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 11.74it/s]
100%|██████████| 8/8 [00:01<00:00,  4.29it/s]
2025-03-13 12:54:22,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:54:22
2025-03-13 12:54:58,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5732 secs
2025-03-13 12:54:58,244 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 12:54:58,244 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:58

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  8.02it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 12.10it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.85it/s]
2025-03-13 12:55:14,025 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7804 secs
2025-03-13 12:55:14,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6071 secs
2025-03-13 12:55:14,407 [INFO]: {
2025-03-13 12:55:14,407 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:14,407 [INFO]: 	index_param: efSearch=287
2025-03-13 12:55:14,407 [INFO]: 	index_path: knn.index
2025-03-13 12:55:14,407 [INFO]: 	size in bytes: 373420150
2025-03-13 12:55:14,407 [INFO]: 	avg_search_speed_ms: 12.259659226401709
2025-03-13 12:55:14,407 [INFO]: 	99p_search_speed_ms: 23.46666170051322
2025-03-13 12:55:14,407 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:14,407 [INFO]: 	nb vectors: 1898
2025-03-13 12:55:14,407 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:14,407 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 12:55:14,407 [INFO]: }
2025-03-13 12:55:14,408 [INFO]: 	>>> Finished "Creating the index" in 53.6114 secs
2025-03-13 12:55:14,408 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6414 secs
2025-03-13 12:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 64528 [episode count 0/20]
[retrieval_preprocessing] for episode 92700 [episode count 1/20], we have num_retrieval=np.int64(1889) num_query=np.int64(96)
2025-03-13 12:55:16,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:16,505 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:16
2025-03-13 12:55:16,505 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:16

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1527.42it/s]
2025-03-13 12:55:16,532 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 12:55:16,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 12:55:16,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:16
2025-03-13 12:55:16,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:16,533 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:55:16,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:16,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:55:16,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:16
2025-03-13 12:55:16,533 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:16,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:55:16,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:16
2025-03-13 12:55:16,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:16,534 [INFO]: 	Creating the index 03/13/2025, 12:55:16
2025-03-13 12:55:16,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:16
2025-03-13 12:55:16,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:55:16,537 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:16
2025-03-13 12:55:16,537 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:55:16,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.52it/s]
 25%|██▌       | 2/8 [00:00<00:00,  7.24it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.04it/s]
 50%|█████     | 4/8 [00:00<00:00,  8.46it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.79it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  8.90it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  9.13it/s]
100%|██████████| 8/8 [00:01<00:00,  2.27it/s]
100%|██████████| 8/8 [00:01<00:00,  4.05it/s]
2025-03-13 12:55:18,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:18
2025-03-13 12:55:39,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.1631 secs
2025-03-13 12:55:39,679 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 12:55:39,679 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:39

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.35it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s]
2025-03-13 12:55:53,305 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6250 secs
2025-03-13 12:55:53,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.7689 secs
2025-03-13 12:55:53,306 [INFO]: {
2025-03-13 12:55:53,306 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:53,306 [INFO]: 	index_param: efSearch=261
2025-03-13 12:55:53,306 [INFO]: 	index_path: knn.index
2025-03-13 12:55:53,306 [INFO]: 	size in bytes: 371649490
2025-03-13 12:55:53,306 [INFO]: 	avg_search_speed_ms: 11.367027606783351
2025-03-13 12:55:53,306 [INFO]: 	99p_search_speed_ms: 19.841640074737374
2025-03-13 12:55:53,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:53,306 [INFO]: 	nb vectors: 1889
2025-03-13 12:55:53,306 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:53,306 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 12:55:53,306 [INFO]: }
2025-03-13 12:55:53,306 [INFO]: 	>>> Finished "Creating the index" in 36.7724 secs
2025-03-13 12:55:53,306 [INFO]: >>> Finished "Launching the whole pipeline" in 36.8016 secs
2025-03-13 12:55:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 92700 [episode count 1/20]
[retrieval_preprocessing] for episode 57391 [episode count 2/20], we have num_retrieval=np.int64(1885) num_query=np.int64(100)
2025-03-13 12:55:55,045 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:55,329 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:55
2025-03-13 12:55:55,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:55

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1111.37it/s]
2025-03-13 12:55:55,366 [INFO]: There are 1885 embeddings of dim 49152
2025-03-13 12:55:55,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 12:55:55,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:55,368 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:55:55,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:55,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:55:55,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,369 [INFO]: 389.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:55,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:55:55,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:55
2025-03-13 12:55:55,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:55,369 [INFO]: 	Creating the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:55
2025-03-13 12:55:55,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 12:55:55,373 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,374 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:55:55,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.71it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.28it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  9.03it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  9.05it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  9.21it/s]
100%|██████████| 8/8 [00:02<00:00,  2.28it/s]
100%|██████████| 8/8 [00:02<00:00,  3.87it/s]
2025-03-13 12:55:57,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:57
2025-03-13 12:56:22,025 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5782 secs
2025-03-13 12:56:22,025 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 12:56:22,026 [INFO]: 	Compute fast metrics 03/13/2025, 12:56:22

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-13 12:56:36,611 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5854 secs
2025-03-13 12:56:36,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2393 secs
2025-03-13 12:56:36,613 [INFO]: {
2025-03-13 12:56:36,613 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:36,613 [INFO]: 	index_param: efSearch=277
2025-03-13 12:56:36,613 [INFO]: 	index_path: knn.index
2025-03-13 12:56:36,613 [INFO]: 	size in bytes: 370862470
2025-03-13 12:56:36,613 [INFO]: 	avg_search_speed_ms: 10.897706781690514
2025-03-13 12:56:36,613 [INFO]: 	99p_search_speed_ms: 13.842640705406666
2025-03-13 12:56:36,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:36,613 [INFO]: 	nb vectors: 1885
2025-03-13 12:56:36,613 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:36,613 [INFO]: 	compression ratio: 0.9993086655546461
2025-03-13 12:56:36,613 [INFO]: }
2025-03-13 12:56:36,613 [INFO]: 	>>> Finished "Creating the index" in 41.2439 secs
2025-03-13 12:56:36,613 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2842 secs
2025-03-13 12:56:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 57391 [episode count 2/20]
[retrieval_preprocessing] for episode 18992 [episode count 3/20], we have num_retrieval=np.int64(1897) num_query=np.int64(88)
2025-03-13 12:56:38,119 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:38,866 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:38
2025-03-13 12:56:38,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:38

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1044.66it/s]
2025-03-13 12:56:38,893 [INFO]: There are 1897 embeddings of dim 49152
2025-03-13 12:56:38,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:56:38,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:38,893 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:56:38,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:38,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:56:38,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,894 [INFO]: 391.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:38,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:56:38,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:38
2025-03-13 12:56:38,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:38,894 [INFO]: 	Creating the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:38
2025-03-13 12:56:38,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:56:38,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,895 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:56:38,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  6.85it/s]
 38%|███▊      | 3/8 [00:00<00:00, 12.53it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 14.59it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 15.85it/s]
100%|██████████| 8/8 [00:01<00:00,  4.40it/s]
2025-03-13 12:56:40,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:40
2025-03-13 12:57:04,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5669 secs
2025-03-13 12:57:04,282 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:57:04,283 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:04

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.31it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 12:57:34,217 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9342 secs
2025-03-13 12:57:34,219 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3235 secs
2025-03-13 12:57:34,219 [INFO]: {
2025-03-13 12:57:34,219 [INFO]: 	index_key: HNSW15
2025-03-13 12:57:34,219 [INFO]: 	index_param: efSearch=235
2025-03-13 12:57:34,219 [INFO]: 	index_path: knn.index
2025-03-13 12:57:34,219 [INFO]: 	size in bytes: 373223410
2025-03-13 12:57:34,219 [INFO]: 	avg_search_speed_ms: 9.843438706318592
2025-03-13 12:57:34,219 [INFO]: 	99p_search_speed_ms: 13.821666396688672
2025-03-13 12:57:34,219 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:57:34,219 [INFO]: 	nb vectors: 1897
2025-03-13 12:57:34,219 [INFO]: 	vectors dimension: 49152
2025-03-13 12:57:34,219 [INFO]: 	compression ratio: 0.9993086339359045
2025-03-13 12:57:34,219 [INFO]: }
2025-03-13 12:57:34,219 [INFO]: 	>>> Finished "Creating the index" in 55.3252 secs
2025-03-13 12:57:34,219 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3529 secs
2025-03-13 12:57:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:57:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 18992 [episode count 3/20]
[retrieval_preprocessing] for episode 31289 [episode count 4/20], we have num_retrieval=np.int64(1863) num_query=np.int64(122)
2025-03-13 12:57:35,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:57:35,809 [INFO]: Launching the whole pipeline 03/13/2025, 12:57:35
2025-03-13 12:57:35,809 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:57:35

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-13 12:57:35,837 [INFO]: There are 1863 embeddings of dim 49152
2025-03-13 12:57:35,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 12:57:35,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:57:35
2025-03-13 12:57:35,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:57:35,838 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:57:35,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:57:35,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:57:35,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:57:35
2025-03-13 12:57:35,839 [INFO]: 384.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:57:35,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:57:35,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:57:35
2025-03-13 12:57:35,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:57:35,839 [INFO]: 	Creating the index 03/13/2025, 12:57:35
2025-03-13 12:57:35,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:57:35
2025-03-13 12:57:35,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:57:35,843 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:57:35
2025-03-13 12:57:35,843 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:57:35,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:04,  1.65it/s]
 25%|██▌       | 2/8 [00:00<00:02,  2.84it/s]
 38%|███▊      | 3/8 [00:01<00:01,  2.73it/s]
 50%|█████     | 4/8 [00:01<00:01,  2.64it/s]
 62%|██████▎   | 5/8 [00:01<00:01,  2.88it/s]
 75%|███████▌  | 6/8 [00:01<00:00,  3.62it/s]
 88%|████████▊ | 7/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:03<00:00,  1.76it/s]
100%|██████████| 8/8 [00:03<00:00,  2.30it/s]
2025-03-13 12:57:39,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:57:39
2025-03-13 12:58:00,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5819 secs
2025-03-13 12:58:00,907 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 12:58:00,907 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:00

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.55it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 12:58:19,265 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3577 secs
2025-03-13 12:58:19,582 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7389 secs
2025-03-13 12:58:19,582 [INFO]: {
2025-03-13 12:58:19,582 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:19,582 [INFO]: 	index_param: efSearch=264
2025-03-13 12:58:19,582 [INFO]: 	index_path: knn.index
2025-03-13 12:58:19,582 [INFO]: 	size in bytes: 366534010
2025-03-13 12:58:19,582 [INFO]: 	avg_search_speed_ms: 10.246795890557
2025-03-13 12:58:19,582 [INFO]: 	99p_search_speed_ms: 13.612983166240156
2025-03-13 12:58:19,582 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:19,582 [INFO]: 	nb vectors: 1863
2025-03-13 12:58:19,583 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:19,583 [INFO]: 	compression ratio: 0.9993089154264293
2025-03-13 12:58:19,583 [INFO]: }
2025-03-13 12:58:19,583 [INFO]: 	>>> Finished "Creating the index" in 43.7431 secs
2025-03-13 12:58:19,583 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7741 secs
2025-03-13 12:58:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 31289 [episode count 4/20]
[retrieval_preprocessing] for episode 27714 [episode count 5/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 12:58:21,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:21,697 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:21
2025-03-13 12:58:21,697 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:21

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1189.54it/s]
2025-03-13 12:58:21,722 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 12:58:21,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 12:58:21,723 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,723 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:21,723 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:58:21,723 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:21,723 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:21,723 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,723 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:21,723 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:58:21,723 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:21
2025-03-13 12:58:21,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:21,723 [INFO]: 	Creating the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,723 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:21
2025-03-13 12:58:21,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:58:21,724 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:21
2025-03-13 12:58:21,724 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:58:21,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.51it/s]
 38%|███▊      | 3/8 [00:00<00:00,  9.25it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 10.18it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 11.23it/s]
100%|██████████| 8/8 [00:01<00:00,  4.13it/s]
2025-03-13 12:58:23,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:23
2025-03-13 12:58:50,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0605 secs
2025-03-13 12:58:50,724 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 12:58:50,724 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:50

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-13 12:59:04,773 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0489 secs
2025-03-13 12:59:04,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0508 secs
2025-03-13 12:59:04,775 [INFO]: {
2025-03-13 12:59:04,775 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:04,775 [INFO]: 	index_param: efSearch=244
2025-03-13 12:59:04,775 [INFO]: 	index_path: knn.index
2025-03-13 12:59:04,775 [INFO]: 	size in bytes: 372829930
2025-03-13 12:59:04,775 [INFO]: 	avg_search_speed_ms: 11.157319791371785
2025-03-13 12:59:04,775 [INFO]: 	99p_search_speed_ms: 22.02440140536052
2025-03-13 12:59:04,775 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:04,775 [INFO]: 	nb vectors: 1895
2025-03-13 12:59:04,775 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:04,776 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 12:59:04,776 [INFO]: }
2025-03-13 12:59:04,776 [INFO]: 	>>> Finished "Creating the index" in 43.0522 secs
2025-03-13 12:59:04,776 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0784 secs
2025-03-13 12:59:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 27714 [episode count 5/20]
[retrieval_preprocessing] for episode 11846 [episode count 6/20], we have num_retrieval=np.int64(1899) num_query=np.int64(86)
2025-03-13 12:59:06,872 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:07,188 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:07
2025-03-13 12:59:07,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:07

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1143.49it/s]
2025-03-13 12:59:07,217 [INFO]: There are 1899 embeddings of dim 49152
2025-03-13 12:59:07,217 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 12:59:07,217 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:07
2025-03-13 12:59:07,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:07,218 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:59:07,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:07,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:59:07,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:07
2025-03-13 12:59:07,218 [INFO]: 391.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:07,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:59:07,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:07
2025-03-13 12:59:07,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:07,219 [INFO]: 	Creating the index 03/13/2025, 12:59:07
2025-03-13 12:59:07,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:07
2025-03-13 12:59:07,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:59:07,222 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:07
2025-03-13 12:59:07,223 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:59:07,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.97it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.79it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  9.69it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 10.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.95it/s]
2025-03-13 12:59:09,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:09
2025-03-13 12:59:32,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0229 secs
2025-03-13 12:59:32,278 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:59:32,278 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:32

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 12:59:48,962 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6837 secs
2025-03-13 12:59:48,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7416 secs
2025-03-13 12:59:48,964 [INFO]: {
2025-03-13 12:59:48,964 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:48,964 [INFO]: 	index_param: efSearch=231
2025-03-13 12:59:48,964 [INFO]: 	index_path: knn.index
2025-03-13 12:59:48,964 [INFO]: 	size in bytes: 373616890
2025-03-13 12:59:48,964 [INFO]: 	avg_search_speed_ms: 10.778388326108487
2025-03-13 12:59:48,964 [INFO]: 	99p_search_speed_ms: 21.27892201300711
2025-03-13 12:59:48,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:48,964 [INFO]: 	nb vectors: 1899
2025-03-13 12:59:48,964 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:48,964 [INFO]: 	compression ratio: 0.9993086554518453
2025-03-13 12:59:48,965 [INFO]: }
2025-03-13 12:59:48,965 [INFO]: 	>>> Finished "Creating the index" in 41.7452 secs
2025-03-13 12:59:48,965 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7761 secs
2025-03-13 12:59:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 11846 [episode count 6/20]
[retrieval_preprocessing] for episode 66173 [episode count 7/20], we have num_retrieval=np.int64(1836) num_query=np.int64(149)
2025-03-13 12:59:50,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:50,783 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:50
2025-03-13 12:59:50,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:50

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1049.89it/s]
2025-03-13 12:59:50,811 [INFO]: There are 1836 embeddings of dim 49152
2025-03-13 12:59:50,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:59:50,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:50
2025-03-13 12:59:50,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:50,812 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:59:50,813 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:50,813 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:59:50,813 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:50
2025-03-13 12:59:50,813 [INFO]: 378.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:50,813 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:59:50,813 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:50
2025-03-13 12:59:50,813 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:50,813 [INFO]: 	Creating the index 03/13/2025, 12:59:50
2025-03-13 12:59:50,814 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:50
2025-03-13 12:59:50,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:59:50,817 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:50
2025-03-13 12:59:50,817 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:59:50,817 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  7.43it/s]
 38%|███▊      | 3/8 [00:00<00:00, 11.30it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  9.62it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  9.43it/s]
100%|██████████| 8/8 [00:01<00:00,  2.87it/s]
100%|██████████| 8/8 [00:01<00:00,  4.25it/s]
2025-03-13 12:59:52,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:52
2025-03-13 13:00:14,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.7266 secs
2025-03-13 13:00:14,432 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 13:00:14,432 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:14

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.33it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-13 13:00:31,705 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2721 secs
2025-03-13 13:00:31,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8891 secs
2025-03-13 13:00:31,706 [INFO]: {
2025-03-13 13:00:31,706 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:31,706 [INFO]: 	index_param: efSearch=291
2025-03-13 13:00:31,706 [INFO]: 	index_path: knn.index
2025-03-13 13:00:31,706 [INFO]: 	size in bytes: 361221850
2025-03-13 13:00:31,706 [INFO]: 	avg_search_speed_ms: 10.880061478725958
2025-03-13 13:00:31,706 [INFO]: 	99p_search_speed_ms: 19.877121974714072
2025-03-13 13:00:31,706 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:31,706 [INFO]: 	nb vectors: 1836
2025-03-13 13:00:31,706 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:31,706 [INFO]: 	compression ratio: 0.9993091170979829
2025-03-13 13:00:31,706 [INFO]: }
2025-03-13 13:00:31,706 [INFO]: 	>>> Finished "Creating the index" in 40.8929 secs
2025-03-13 13:00:31,706 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9230 secs
2025-03-13 13:00:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 66173 [episode count 7/20]
[retrieval_preprocessing] for episode 74415 [episode count 8/20], we have num_retrieval=np.int64(1846) num_query=np.int64(139)
2025-03-13 13:00:33,852 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:34,152 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:34
2025-03-13 13:00:34,152 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:34

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1216.45it/s]
2025-03-13 13:00:34,176 [INFO]: There are 1846 embeddings of dim 49152
2025-03-13 13:00:34,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 13:00:34,176 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:34
2025-03-13 13:00:34,177 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:34,177 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:00:34,177 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:00:34,177 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:34,177 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:34
2025-03-13 13:00:34,177 [INFO]: 381.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:34,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:00:34,177 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:34
2025-03-13 13:00:34,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:34,177 [INFO]: 	Creating the index 03/13/2025, 13:00:34
2025-03-13 13:00:34,177 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:34
2025-03-13 13:00:34,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:00:34,178 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:34
2025-03-13 13:00:34,178 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:00:34,178 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.38it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.23it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  9.85it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 10.24it/s]
100%|██████████| 8/8 [00:02<00:00,  3.72it/s]
2025-03-13 13:00:36,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:36
2025-03-13 13:00:56,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0396 secs
2025-03-13 13:00:56,374 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 13:00:56,374 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:56

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 13:01:11,299 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9242 secs
2025-03-13 13:01:11,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1225 secs
2025-03-13 13:01:11,301 [INFO]: {
2025-03-13 13:01:11,301 [INFO]: 	index_key: HNSW15
2025-03-13 13:01:11,301 [INFO]: 	index_param: efSearch=196
2025-03-13 13:01:11,301 [INFO]: 	index_path: knn.index
2025-03-13 13:01:11,301 [INFO]: 	size in bytes: 363189250
2025-03-13 13:01:11,301 [INFO]: 	avg_search_speed_ms: 8.777238887099385
2025-03-13 13:01:11,301 [INFO]: 	99p_search_speed_ms: 15.498238555155673
2025-03-13 13:01:11,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:01:11,301 [INFO]: 	nb vectors: 1846
2025-03-13 13:01:11,301 [INFO]: 	vectors dimension: 49152
2025-03-13 13:01:11,301 [INFO]: 	compression ratio: 0.9993092251491474
2025-03-13 13:01:11,301 [INFO]: }
2025-03-13 13:01:11,301 [INFO]: 	>>> Finished "Creating the index" in 37.1239 secs
2025-03-13 13:01:11,301 [INFO]: >>> Finished "Launching the whole pipeline" in 37.1489 secs
2025-03-13 13:01:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:01:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 74415 [episode count 8/20]
[retrieval_preprocessing] for episode 50353 [episode count 9/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 13:01:12,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:01:13,145 [INFO]: Launching the whole pipeline 03/13/2025, 13:01:13
2025-03-13 13:01:13,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:01:13

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-13 13:01:13,169 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 13:01:13,169 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 13:01:13,169 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:01:13
2025-03-13 13:01:13,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:01:13,169 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:01:13,169 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:01:13,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:01:13,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:01:13
2025-03-13 13:01:13,169 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:01:13,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:01:13,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:01:13
2025-03-13 13:01:13,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:01:13,169 [INFO]: 	Creating the index 03/13/2025, 13:01:13
2025-03-13 13:01:13,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:01:13
2025-03-13 13:01:13,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:01:13,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:01:13
2025-03-13 13:01:13,170 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:01:13,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.36it/s]
 25%|██▌       | 2/8 [00:00<00:00,  6.97it/s]
 38%|███▊      | 3/8 [00:00<00:00,  7.72it/s]
 50%|█████     | 4/8 [00:00<00:00,  8.10it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.45it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  8.54it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  8.62it/s]
100%|██████████| 8/8 [00:02<00:00,  2.08it/s]
100%|██████████| 8/8 [00:02<00:00,  3.76it/s]
2025-03-13 13:01:15,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:01:15
2025-03-13 13:01:37,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2086 secs
2025-03-13 13:01:37,508 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 13:01:37,508 [INFO]: 	Compute fast metrics 03/13/2025, 13:01:37

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s]
2025-03-13 13:02:04,921 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4129 secs
2025-03-13 13:02:04,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7522 secs
2025-03-13 13:02:04,923 [INFO]: {
2025-03-13 13:02:04,923 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:04,923 [INFO]: 	index_param: efSearch=240
2025-03-13 13:02:04,923 [INFO]: 	index_path: knn.index
2025-03-13 13:02:04,923 [INFO]: 	size in bytes: 372829930
2025-03-13 13:02:04,923 [INFO]: 	avg_search_speed_ms: 9.33725401075656
2025-03-13 13:02:04,923 [INFO]: 	99p_search_speed_ms: 11.953716212883588
2025-03-13 13:02:04,923 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:04,923 [INFO]: 	nb vectors: 1895
2025-03-13 13:02:04,923 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:04,923 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 13:02:04,923 [INFO]: }
2025-03-13 13:02:04,923 [INFO]: 	>>> Finished "Creating the index" in 51.7533 secs
2025-03-13 13:02:04,923 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7779 secs
2025-03-13 13:02:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 50353 [episode count 9/20]
[retrieval_preprocessing] for episode 95416 [episode count 10/20], we have num_retrieval=np.int64(1882) num_query=np.int64(103)
2025-03-13 13:02:06,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:06,789 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:06
2025-03-13 13:02:06,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:06

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2445.66it/s]
2025-03-13 13:02:06,812 [INFO]: There are 1882 embeddings of dim 49152
2025-03-13 13:02:06,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 13:02:06,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:06,812 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:02:06,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:06,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:06,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,813 [INFO]: 388.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:06,813 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:02:06,813 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:06
2025-03-13 13:02:06,813 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:06,813 [INFO]: 	Creating the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,813 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:06
2025-03-13 13:02:06,814 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:02:06,814 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:06
2025-03-13 13:02:06,814 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:02:06,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.34it/s]
 25%|██▌       | 2/8 [00:00<00:00,  7.02it/s]
 38%|███▊      | 3/8 [00:00<00:00,  8.03it/s]
 50%|█████     | 4/8 [00:00<00:00,  8.55it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.95it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  9.20it/s]
100%|██████████| 8/8 [00:02<00:00,  1.98it/s]
100%|██████████| 8/8 [00:02<00:00,  3.15it/s]
2025-03-13 13:02:09,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:09
2025-03-13 13:02:31,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1020 secs
2025-03-13 13:02:31,461 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 13:02:31,461 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:31

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-13 13:02:47,431 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9696 secs
2025-03-13 13:02:47,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6191 secs
2025-03-13 13:02:47,433 [INFO]: {
2025-03-13 13:02:47,433 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:47,433 [INFO]: 	index_param: efSearch=252
2025-03-13 13:02:47,433 [INFO]: 	index_path: knn.index
2025-03-13 13:02:47,433 [INFO]: 	size in bytes: 370272250
2025-03-13 13:02:47,433 [INFO]: 	avg_search_speed_ms: 11.17725167917764
2025-03-13 13:02:47,433 [INFO]: 	99p_search_speed_ms: 18.678247453644865
2025-03-13 13:02:47,433 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:47,433 [INFO]: 	nb vectors: 1882
2025-03-13 13:02:47,433 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:47,433 [INFO]: 	compression ratio: 0.999308633039608
2025-03-13 13:02:47,433 [INFO]: }
2025-03-13 13:02:47,433 [INFO]: 	>>> Finished "Creating the index" in 40.6204 secs
2025-03-13 13:02:47,433 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6439 secs
2025-03-13 13:02:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 95416 [episode count 10/20]
[retrieval_preprocessing] for episode 43710 [episode count 11/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 13:02:48,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:49,211 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:49
2025-03-13 13:02:49,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:49

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-13 13:02:49,235 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 13:02:49,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 13:02:49,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:49
2025-03-13 13:02:49,235 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:49,235 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:02:49,235 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:49,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:49,235 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:49
2025-03-13 13:02:49,235 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:49,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:02:49,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:49
2025-03-13 13:02:49,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:49,235 [INFO]: 	Creating the index 03/13/2025, 13:02:49
2025-03-13 13:02:49,235 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:49
2025-03-13 13:02:49,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:02:49,236 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:49
2025-03-13 13:02:49,237 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:02:49,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  6.74it/s]
 38%|███▊      | 3/8 [00:00<00:00, 12.41it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 14.48it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 15.54it/s]
100%|██████████| 8/8 [00:01<00:00,  4.54it/s]
2025-03-13 13:02:51,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:51
2025-03-13 13:03:16,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3848 secs
2025-03-13 13:03:16,388 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 13:03:16,388 [INFO]: 	Compute fast metrics 03/13/2025, 13:03:16

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.40it/s]
 50%|█████     | 2/4 [00:00<00:00,  5.46it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s]
2025-03-13 13:03:32,334 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9461 secs
2025-03-13 13:03:32,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0994 secs
2025-03-13 13:03:32,336 [INFO]: {
2025-03-13 13:03:32,336 [INFO]: 	index_key: HNSW15
2025-03-13 13:03:32,336 [INFO]: 	index_param: efSearch=182
2025-03-13 13:03:32,336 [INFO]: 	index_path: knn.index
2025-03-13 13:03:32,336 [INFO]: 	size in bytes: 372829930
2025-03-13 13:03:32,336 [INFO]: 	avg_search_speed_ms: 8.383870210884215
2025-03-13 13:03:32,336 [INFO]: 	99p_search_speed_ms: 11.046377131715415
2025-03-13 13:03:32,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:03:32,336 [INFO]: 	nb vectors: 1895
2025-03-13 13:03:32,336 [INFO]: 	vectors dimension: 49152
2025-03-13 13:03:32,336 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 13:03:32,336 [INFO]: }
2025-03-13 13:03:32,336 [INFO]: 	>>> Finished "Creating the index" in 43.1009 secs
2025-03-13 13:03:32,336 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1256 secs
2025-03-13 13:03:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:03:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 43710 [episode count 11/20]
[retrieval_preprocessing] for episode 90814 [episode count 12/20], we have num_retrieval=np.int64(1894) num_query=np.int64(91)
2025-03-13 13:03:33,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:03:33,976 [INFO]: Launching the whole pipeline 03/13/2025, 13:03:33
2025-03-13 13:03:33,976 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:03:33

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1342.18it/s]
2025-03-13 13:03:33,999 [INFO]: There are 1894 embeddings of dim 49152
2025-03-13 13:03:33,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 13:03:33,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:03:33
2025-03-13 13:03:33,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:03:33,999 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:03:33,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:03:33,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:03:33,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:03:33
2025-03-13 13:03:33,999 [INFO]: 390.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:03:33,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:03:33,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:03:33
2025-03-13 13:03:33,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:03:33,999 [INFO]: 	Creating the index 03/13/2025, 13:03:33
2025-03-13 13:03:33,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:03:33
2025-03-13 13:03:34,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:03:34,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:03:34
2025-03-13 13:03:34,000 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:03:34,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.50it/s]
 25%|██▌       | 2/8 [00:00<00:00,  6.93it/s]
 38%|███▊      | 3/8 [00:00<00:00,  7.54it/s]
 50%|█████     | 4/8 [00:00<00:00,  7.86it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.22it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  8.60it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  8.60it/s]
100%|██████████| 8/8 [00:02<00:00,  2.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.72it/s]
2025-03-13 13:03:36,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:36
2025-03-13 13:04:07,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7567 secs
2025-03-13 13:04:07,909 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 13:04:07,909 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:07

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:03<00:09,  3.33s/it]
 50%|█████     | 2/4 [00:03<00:02,  1.44s/it]
 75%|███████▌  | 3/4 [00:03<00:00,  1.10it/s]
 75%|███████▌  | 3/4 [00:03<00:01,  1.26s/it]
2025-03-13 13:04:35,321 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4120 secs
2025-03-13 13:04:35,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3228 secs
2025-03-13 13:04:35,323 [INFO]: {
2025-03-13 13:04:35,323 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:35,323 [INFO]: 	index_param: efSearch=243
2025-03-13 13:04:35,323 [INFO]: 	index_path: knn.index
2025-03-13 13:04:35,323 [INFO]: 	size in bytes: 372633190
2025-03-13 13:04:35,323 [INFO]: 	avg_search_speed_ms: 10.111949174675273
2025-03-13 13:04:35,323 [INFO]: 	99p_search_speed_ms: 21.52568287216127
2025-03-13 13:04:35,323 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:35,323 [INFO]: 	nb vectors: 1894
2025-03-13 13:04:35,323 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:35,323 [INFO]: 	compression ratio: 0.9993086015767946
2025-03-13 13:04:35,323 [INFO]: }
2025-03-13 13:04:35,323 [INFO]: 	>>> Finished "Creating the index" in 61.3242 secs
2025-03-13 13:04:35,323 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3474 secs
2025-03-13 13:04:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 90814 [episode count 12/20]
[retrieval_preprocessing] for episode 86212 [episode count 13/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 13:04:36,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:36,966 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:36
2025-03-13 13:04:36,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1496.36it/s]
2025-03-13 13:04:36,993 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 13:04:36,994 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 13:04:36,994 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,994 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:36,994 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:04:36,994 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:36,994 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:04:36,994 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,995 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:36,995 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:04:36,995 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:36
2025-03-13 13:04:36,995 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:36,995 [INFO]: 	Creating the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,996 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:36
2025-03-13 13:04:36,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 13:04:36,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,999 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:04:36,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  3.91it/s]
 25%|██▌       | 2/8 [00:00<00:00,  6.02it/s]
 38%|███▊      | 3/8 [00:02<00:04,  1.05it/s]
 50%|█████     | 4/8 [00:04<00:06,  1.54s/it]
 75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]
100%|██████████| 8/8 [00:06<00:00,  1.30it/s]
100%|██████████| 8/8 [00:06<00:00,  1.25it/s]
2025-03-13 13:04:43,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:43
2025-03-13 13:05:08,769 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3714 secs
2025-03-13 13:05:08,769 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:05:08,769 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:08

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.42it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-13 13:05:24,393 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6238 secs
2025-03-13 13:05:24,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4029 secs
2025-03-13 13:05:24,402 [INFO]: {
2025-03-13 13:05:24,402 [INFO]: 	index_key: HNSW15
2025-03-13 13:05:24,402 [INFO]: 	index_param: efSearch=241
2025-03-13 13:05:24,402 [INFO]: 	index_path: knn.index
2025-03-13 13:05:24,402 [INFO]: 	size in bytes: 373420150
2025-03-13 13:05:24,402 [INFO]: 	avg_search_speed_ms: 11.206941921336938
2025-03-13 13:05:24,402 [INFO]: 	99p_search_speed_ms: 15.82854268141091
2025-03-13 13:05:24,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:05:24,402 [INFO]: 	nb vectors: 1898
2025-03-13 13:05:24,402 [INFO]: 	vectors dimension: 49152
2025-03-13 13:05:24,402 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 13:05:24,402 [INFO]: }
2025-03-13 13:05:24,402 [INFO]: 	>>> Finished "Creating the index" in 47.4064 secs
2025-03-13 13:05:24,402 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4363 secs
2025-03-13 13:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:05:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 86212 [episode count 13/20]
[retrieval_preprocessing] for episode 12489 [episode count 14/20], we have num_retrieval=np.int64(1875) num_query=np.int64(110)
2025-03-13 13:05:26,044 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:05:26,292 [INFO]: Launching the whole pipeline 03/13/2025, 13:05:26
2025-03-13 13:05:26,292 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:05:26

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1912.59it/s]
2025-03-13 13:05:26,319 [INFO]: There are 1875 embeddings of dim 49152
2025-03-13 13:05:26,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 13:05:26,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:05:26
2025-03-13 13:05:26,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:05:26,320 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:05:26,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:05:26,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:05:26,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:05:26
2025-03-13 13:05:26,320 [INFO]: 387.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:05:26,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:05:26,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:05:26
2025-03-13 13:05:26,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:05:26,321 [INFO]: 	Creating the index 03/13/2025, 13:05:26
2025-03-13 13:05:26,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:05:26
2025-03-13 13:05:26,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 13:05:26,324 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:05:26
2025-03-13 13:05:26,324 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:05:26,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.50it/s]
 25%|██▌       | 2/8 [00:00<00:00,  7.03it/s]
 38%|███▊      | 3/8 [00:00<00:00,  7.75it/s]
 50%|█████     | 4/8 [00:00<00:00,  8.13it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  8.46it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  8.57it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  8.68it/s]
100%|██████████| 8/8 [00:02<00:00,  2.01it/s]
100%|██████████| 8/8 [00:02<00:00,  3.68it/s]
2025-03-13 13:05:28,502 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:05:28
2025-03-13 13:05:49,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.2481 secs
2025-03-13 13:05:49,751 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 13:05:49,751 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:49

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:02,  1.37it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  4.20it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  3.07it/s]
2025-03-13 13:06:10,241 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4902 secs
2025-03-13 13:06:10,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9191 secs
2025-03-13 13:06:10,243 [INFO]: {
2025-03-13 13:06:10,243 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:10,243 [INFO]: 	index_param: efSearch=291
2025-03-13 13:06:10,243 [INFO]: 	index_path: knn.index
2025-03-13 13:06:10,243 [INFO]: 	size in bytes: 368895010
2025-03-13 13:06:10,243 [INFO]: 	avg_search_speed_ms: 10.653727434236353
2025-03-13 13:06:10,243 [INFO]: 	99p_search_speed_ms: 15.40264040697366
2025-03-13 13:06:10,243 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:10,243 [INFO]: 	nb vectors: 1875
2025-03-13 13:06:10,243 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:10,243 [INFO]: 	compression ratio: 0.9993087193020042
2025-03-13 13:06:10,243 [INFO]: }
2025-03-13 13:06:10,243 [INFO]: 	>>> Finished "Creating the index" in 43.9225 secs
2025-03-13 13:06:10,243 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9515 secs
2025-03-13 13:06:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 12489 [episode count 14/20]
[retrieval_preprocessing] for episode 14546 [episode count 15/20], we have num_retrieval=np.int64(1878) num_query=np.int64(107)
2025-03-13 13:06:12,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:12,841 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:12
2025-03-13 13:06:12,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:12

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1332.79it/s]
2025-03-13 13:06:12,870 [INFO]: There are 1878 embeddings of dim 49152
2025-03-13 13:06:12,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 13:06:12,871 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:12,871 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:06:12,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:12,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:06:12,872 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,872 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:12,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:06:12,873 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:12
2025-03-13 13:06:12,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:12,873 [INFO]: 	Creating the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,873 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:12
2025-03-13 13:06:12,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:06:12,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,876 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:06:12,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.24it/s]
 25%|██▌       | 2/8 [00:00<00:00,  6.30it/s]
 38%|███▊      | 3/8 [00:00<00:00,  6.73it/s]
 50%|█████     | 4/8 [00:00<00:00,  6.93it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  7.46it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  7.43it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  7.99it/s]
100%|██████████| 8/8 [00:02<00:00,  1.71it/s]
100%|██████████| 8/8 [00:02<00:00,  3.17it/s]
2025-03-13 13:06:15,406 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:15
2025-03-13 13:06:37,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.7852 secs
2025-03-13 13:06:37,192 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 13:06:37,192 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:37

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.50it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 13:06:54,184 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9918 secs
2025-03-13 13:06:54,186 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3098 secs
2025-03-13 13:06:54,186 [INFO]: {
2025-03-13 13:06:54,186 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:54,186 [INFO]: 	index_param: efSearch=262
2025-03-13 13:06:54,186 [INFO]: 	index_path: knn.index
2025-03-13 13:06:54,186 [INFO]: 	size in bytes: 369485230
2025-03-13 13:06:54,186 [INFO]: 	avg_search_speed_ms: 10.796021715110292
2025-03-13 13:06:54,186 [INFO]: 	99p_search_speed_ms: 15.326501510571688
2025-03-13 13:06:54,186 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:54,186 [INFO]: 	nb vectors: 1878
2025-03-13 13:06:54,186 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:54,186 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-13 13:06:54,186 [INFO]: }
2025-03-13 13:06:54,186 [INFO]: 	>>> Finished "Creating the index" in 41.3136 secs
2025-03-13 13:06:54,186 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3449 secs
2025-03-13 13:06:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 14546 [episode count 15/20]
[retrieval_preprocessing] for episode 87305 [episode count 16/20], we have num_retrieval=np.int64(1892) num_query=np.int64(93)
2025-03-13 13:06:55,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:56,108 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:56
2025-03-13 13:06:56,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:56

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 13:06:56,133 [INFO]: There are 1892 embeddings of dim 49152
2025-03-13 13:06:56,134 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 13:06:56,134 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:56
2025-03-13 13:06:56,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:56,134 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:06:56,134 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:56,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:06:56,134 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:56
2025-03-13 13:06:56,135 [INFO]: 390.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:56,135 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:06:56,135 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:56
2025-03-13 13:06:56,135 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:56,135 [INFO]: 	Creating the index 03/13/2025, 13:06:56
2025-03-13 13:06:56,135 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:56
2025-03-13 13:06:56,137 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 13:06:56,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:56
2025-03-13 13:06:56,137 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:06:56,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:00,  7.51it/s]
 38%|███▊      | 3/8 [00:00<00:00, 10.27it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 11.50it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 11.96it/s]
100%|██████████| 8/8 [00:01<00:00,  4.20it/s]
2025-03-13 13:06:58,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:58
2025-03-13 13:07:19,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.8201 secs
2025-03-13 13:07:19,867 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 13:07:19,867 [INFO]: 	Compute fast metrics 03/13/2025, 13:07:19

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-13 13:07:34,951 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0842 secs
2025-03-13 13:07:34,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8156 secs
2025-03-13 13:07:34,953 [INFO]: {
2025-03-13 13:07:34,953 [INFO]: 	index_key: HNSW15
2025-03-13 13:07:34,953 [INFO]: 	index_param: efSearch=227
2025-03-13 13:07:34,953 [INFO]: 	index_path: knn.index
2025-03-13 13:07:34,953 [INFO]: 	size in bytes: 372239710
2025-03-13 13:07:34,953 [INFO]: 	avg_search_speed_ms: 9.476442738642534
2025-03-13 13:07:34,953 [INFO]: 	99p_search_speed_ms: 13.125715497881178
2025-03-13 13:07:34,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:34,953 [INFO]: 	nb vectors: 1892
2025-03-13 13:07:34,953 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:34,953 [INFO]: 	compression ratio: 0.9993085799470454
2025-03-13 13:07:34,953 [INFO]: }
2025-03-13 13:07:34,953 [INFO]: 	>>> Finished "Creating the index" in 38.8179 secs
2025-03-13 13:07:34,953 [INFO]: >>> Finished "Launching the whole pipeline" in 38.8450 secs
2025-03-13 13:07:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 87305 [episode count 16/20]
[retrieval_preprocessing] for episode 50974 [episode count 17/20], we have num_retrieval=np.int64(1910) num_query=np.int64(75)
2025-03-13 13:07:36,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:36,867 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:36
2025-03-13 13:07:36,867 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:36

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1110.49it/s]
2025-03-13 13:07:36,892 [INFO]: There are 1910 embeddings of dim 49152
2025-03-13 13:07:36,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 13:07:36,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:36
2025-03-13 13:07:36,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:36,893 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:07:36,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:07:36,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:07:36,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:36
2025-03-13 13:07:36,893 [INFO]: 394.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:36,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:07:36,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:36
2025-03-13 13:07:36,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:36,893 [INFO]: 	Creating the index 03/13/2025, 13:07:36
2025-03-13 13:07:36,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:07:36
2025-03-13 13:07:36,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:07:36,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:36
2025-03-13 13:07:36,894 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:07:36,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  6.33it/s]
 38%|███▊      | 3/8 [00:00<00:00,  9.25it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 10.05it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 10.08it/s]
100%|██████████| 8/8 [00:02<00:00,  3.27it/s]
2025-03-13 13:07:39,344 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:39
2025-03-13 13:08:02,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7391 secs
2025-03-13 13:08:02,084 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 13:08:02,084 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:02

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.98it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 13:08:15,920 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8361 secs
2025-03-13 13:08:15,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0270 secs
2025-03-13 13:08:15,922 [INFO]: {
2025-03-13 13:08:15,922 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:15,922 [INFO]: 	index_param: efSearch=258
2025-03-13 13:08:15,922 [INFO]: 	index_path: knn.index
2025-03-13 13:08:15,922 [INFO]: 	size in bytes: 375781150
2025-03-13 13:08:15,922 [INFO]: 	avg_search_speed_ms: 10.065911129731647
2025-03-13 13:08:15,922 [INFO]: 	99p_search_speed_ms: 13.602340484503651
2025-03-13 13:08:15,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:15,922 [INFO]: 	nb vectors: 1910
2025-03-13 13:08:15,922 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:15,922 [INFO]: 	compression ratio: 0.9993084538700251
2025-03-13 13:08:15,922 [INFO]: }
2025-03-13 13:08:15,922 [INFO]: 	>>> Finished "Creating the index" in 39.0285 secs
2025-03-13 13:08:15,922 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0548 secs
2025-03-13 13:08:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 50974 [episode count 17/20]
[retrieval_preprocessing] for episode 37671 [episode count 18/20], we have num_retrieval=np.int64(1890) num_query=np.int64(95)
2025-03-13 13:08:17,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:19,076 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:19
2025-03-13 13:08:19,077 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:19

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1738.21it/s]
2025-03-13 13:08:19,104 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 13:08:19,104 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 13:08:19,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:19,105 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:08:19,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:19,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:08:19,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,105 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:19,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:08:19,106 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:19
2025-03-13 13:08:19,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:19,106 [INFO]: 	Creating the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,106 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:19
2025-03-13 13:08:19,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 13:08:19,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,109 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:08:19,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  6.58it/s]
 38%|███▊      | 3/8 [00:00<00:00, 10.36it/s]
 62%|██████▎   | 5/8 [00:00<00:00, 11.62it/s]
 88%|████████▊ | 7/8 [00:00<00:00, 12.26it/s]
100%|██████████| 8/8 [00:02<00:00,  3.96it/s]
2025-03-13 13:08:21,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:21
2025-03-13 13:08:45,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5694 secs
2025-03-13 13:08:45,706 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 13:08:45,706 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:45

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.41it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 13:09:02,016 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3102 secs
2025-03-13 13:09:02,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9090 secs
2025-03-13 13:09:02,018 [INFO]: {
2025-03-13 13:09:02,018 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:02,018 [INFO]: 	index_param: efSearch=222
2025-03-13 13:09:02,018 [INFO]: 	index_path: knn.index
2025-03-13 13:09:02,018 [INFO]: 	size in bytes: 371846230
2025-03-13 13:09:02,018 [INFO]: 	avg_search_speed_ms: 8.974120607332091
2025-03-13 13:09:02,018 [INFO]: 	99p_search_speed_ms: 11.314560687169422
2025-03-13 13:09:02,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:02,018 [INFO]: 	nb vectors: 1890
2025-03-13 13:09:02,018 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:02,018 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 13:09:02,018 [INFO]: }
2025-03-13 13:09:02,018 [INFO]: 	>>> Finished "Creating the index" in 42.9123 secs
2025-03-13 13:09:02,018 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9416 secs
2025-03-13 13:09:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 37671 [episode count 18/20]
[retrieval_preprocessing] for episode 87860 [episode count 19/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 13:09:03,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:03,991 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:03
2025-03-13 13:09:03,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:03

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1874.97it/s]
2025-03-13 13:09:04,024 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 13:09:04,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 13:09:04,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:04
2025-03-13 13:09:04,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:04,025 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 13:09:04,025 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:09:04,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:09:04,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:04
2025-03-13 13:09:04,026 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:04,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:09:04,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:04
2025-03-13 13:09:04,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:04,026 [INFO]: 	Creating the index 03/13/2025, 13:09:04
2025-03-13 13:09:04,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:09:04
2025-03-13 13:09:04,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 13:09:04,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:04
2025-03-13 13:09:04,029 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 13:09:04,029 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/8 [00:00<?, ?it/s]
 12%|█▎        | 1/8 [00:00<00:01,  5.56it/s]
 25%|██▌       | 2/8 [00:00<00:00,  7.02it/s]
 38%|███▊      | 3/8 [00:00<00:00,  5.75it/s]
 50%|█████     | 4/8 [00:00<00:00,  6.54it/s]
 62%|██████▎   | 5/8 [00:00<00:00,  7.05it/s]
 75%|███████▌  | 6/8 [00:00<00:00,  7.41it/s]
 88%|████████▊ | 7/8 [00:00<00:00,  7.90it/s]
100%|██████████| 8/8 [00:02<00:00,  2.09it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
2025-03-13 13:09:06,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:09:06
2025-03-13 13:09:26,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.5782 secs
2025-03-13 13:09:26,825 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 13:09:26,825 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:26

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.34it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 10.38it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s]
2025-03-13 13:09:40,856 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0313 secs
2025-03-13 13:09:40,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8297 secs
2025-03-13 13:09:40,858 [INFO]: {
2025-03-13 13:09:40,858 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:40,858 [INFO]: 	index_param: efSearch=281
2025-03-13 13:09:40,858 [INFO]: 	index_path: knn.index
2025-03-13 13:09:40,858 [INFO]: 	size in bytes: 373420150
2025-03-13 13:09:40,858 [INFO]: 	avg_search_speed_ms: 10.332262127377355
2025-03-13 13:09:40,858 [INFO]: 	99p_search_speed_ms: 13.880584847647699
2025-03-13 13:09:40,858 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:40,858 [INFO]: 	nb vectors: 1898
2025-03-13 13:09:40,858 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:40,858 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 13:09:40,858 [INFO]: }
2025-03-13 13:09:40,858 [INFO]: 	>>> Finished "Creating the index" in 36.8325 secs
2025-03-13 13:09:40,859 [INFO]: >>> Finished "Launching the whole pipeline" in 36.8676 secs
2025-03-13 13:09:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 87860 [episode count 19/20]
2025-03-13 13:09:42: [retrieval_preprocessing] finished for 5879622450_put_yellow_block_in_cup [chosen_id count 5/260]
2025-03-13 13:10:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5945410292_put_item_in_bin [chosen_id count 6/260]
2025-03-13 13:10:00: [retrieval_preprocessing] we have num_total=7909 embedding_dim=49152
[retrieval_preprocessing] for episode 10625 [episode count 0/20], we have num_retrieval=np.int64(7411) num_query=np.int64(498)
2025-03-13 13:10:06,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:07,658 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:07
2025-03-13 13:10:07,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:07

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1338.32it/s]
2025-03-13 13:10:07,714 [INFO]: There are 7411 embeddings of dim 49152
2025-03-13 13:10:07,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0557 secs
2025-03-13 13:10:07,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:07
2025-03-13 13:10:07,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:07,715 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:10:07,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:07,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:10:07,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:07
2025-03-13 13:10:07,716 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:07,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:10:07,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:07
2025-03-13 13:10:07,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:07,716 [INFO]: 	Creating the index 03/13/2025, 13:10:07
2025-03-13 13:10:07,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:07
2025-03-13 13:10:07,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:10:07,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:07
2025-03-13 13:10:07,720 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:10:07,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:01<00:59,  2.00s/it]
  6%|▋         | 2/31 [00:03<00:54,  1.89s/it]
 10%|▉         | 3/31 [00:04<00:34,  1.24s/it]
 13%|█▎        | 4/31 [00:04<00:22,  1.21it/s]
 16%|█▌        | 5/31 [00:04<00:16,  1.55it/s]
 19%|█▉        | 6/31 [00:04<00:11,  2.14it/s]
 23%|██▎       | 7/31 [00:05<00:08,  2.82it/s]
 26%|██▌       | 8/31 [00:05<00:06,  3.47it/s]
 32%|███▏      | 10/31 [00:05<00:04,  4.86it/s]
 45%|████▌     | 14/31 [00:05<00:01,  9.44it/s]
 55%|█████▍    | 17/31 [00:05<00:01, 12.56it/s]
 61%|██████▏   | 19/31 [00:05<00:00, 13.78it/s]
 68%|██████▊   | 21/31 [00:09<00:06,  1.66it/s]
 74%|███████▍  | 23/31 [00:09<00:03,  2.20it/s]
 81%|████████  | 25/31 [00:10<00:02,  2.89it/s]
 87%|████████▋ | 27/31 [00:10<00:01,  3.71it/s]
 94%|█████████▎| 29/31 [00:10<00:00,  4.60it/s]
100%|██████████| 31/31 [00:12<00:00,  1.94it/s]
100%|██████████| 31/31 [00:12<00:00,  2.41it/s]
2025-03-13 13:10:20,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:20
2025-03-13 13:11:16,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6705 secs
2025-03-13 13:11:16,455 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 13:11:16,455 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:16

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.79it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 13:11:38,250 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7945 secs
2025-03-13 13:11:38,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.6376 secs
2025-03-13 13:11:38,358 [INFO]: {
2025-03-13 13:11:38,358 [INFO]: 	index_key: HNSW15
2025-03-13 13:11:38,358 [INFO]: 	index_param: efSearch=202
2025-03-13 13:11:38,358 [INFO]: 	index_path: knn.index
2025-03-13 13:11:38,358 [INFO]: 	size in bytes: 1458070510
2025-03-13 13:11:38,358 [INFO]: 	avg_search_speed_ms: 8.53721730559778
2025-03-13 13:11:38,358 [INFO]: 	99p_search_speed_ms: 12.866684724576768
2025-03-13 13:11:38,358 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:11:38,358 [INFO]: 	nb vectors: 7411
2025-03-13 13:11:38,358 [INFO]: 	vectors dimension: 49152
2025-03-13 13:11:38,358 [INFO]: 	compression ratio: 0.9993082488171302
2025-03-13 13:11:38,358 [INFO]: }
2025-03-13 13:11:38,358 [INFO]: 	>>> Finished "Creating the index" in 90.6421 secs
2025-03-13 13:11:38,358 [INFO]: >>> Finished "Launching the whole pipeline" in 90.6999 secs
2025-03-13 13:11:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:11:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 10625 [episode count 0/20]
[retrieval_preprocessing] for episode 47361 [episode count 1/20], we have num_retrieval=np.int64(7532) num_query=np.int64(377)
2025-03-13 13:11:44,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:11:45,374 [INFO]: Launching the whole pipeline 03/13/2025, 13:11:45
2025-03-13 13:11:45,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:11:45

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1787.09it/s]
2025-03-13 13:11:45,398 [INFO]: There are 7532 embeddings of dim 49152
2025-03-13 13:11:45,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 13:11:45,398 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:11:45
2025-03-13 13:11:45,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:11:45,398 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:11:45,398 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:11:45,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:11:45,398 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:11:45
2025-03-13 13:11:45,398 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:11:45,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:11:45,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:11:45
2025-03-13 13:11:45,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:11:45,398 [INFO]: 	Creating the index 03/13/2025, 13:11:45
2025-03-13 13:11:45,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:11:45
2025-03-13 13:11:45,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:11:45,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:11:45
2025-03-13 13:11:45,400 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:11:45,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:06,  5.00it/s]
 10%|▉         | 3/31 [00:00<00:03,  9.18it/s]
 16%|█▌        | 5/31 [00:00<00:02, 10.95it/s]
 23%|██▎       | 7/31 [00:00<00:02, 11.74it/s]
 29%|██▉       | 9/31 [00:00<00:01, 12.26it/s]
 35%|███▌      | 11/31 [00:00<00:01, 12.59it/s]
 42%|████▏     | 13/31 [00:01<00:01, 12.71it/s]
 48%|████▊     | 15/31 [00:01<00:01, 12.92it/s]
 55%|█████▍    | 17/31 [00:01<00:01, 12.97it/s]
 61%|██████▏   | 19/31 [00:01<00:00, 12.99it/s]
 68%|██████▊   | 21/31 [00:05<00:05,  1.72it/s]
 74%|███████▍  | 23/31 [00:05<00:03,  2.31it/s]
 81%|████████  | 25/31 [00:05<00:01,  3.08it/s]
 87%|████████▋ | 27/31 [00:05<00:00,  4.01it/s]
 94%|█████████▎| 29/31 [00:05<00:00,  5.06it/s]
100%|██████████| 31/31 [00:07<00:00,  2.17it/s]
100%|██████████| 31/31 [00:07<00:00,  3.97it/s]
2025-03-13 13:11:53,206 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:11:53
2025-03-13 13:12:43,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0025 secs
2025-03-13 13:12:43,209 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 13:12:43,209 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:43

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.96it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 13:13:16,883 [INFO]: 	>>> Finished "Compute fast metrics" in 33.6732 secs
2025-03-13 13:13:16,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.4851 secs
2025-03-13 13:13:16,885 [INFO]: {
2025-03-13 13:13:16,885 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:16,885 [INFO]: 	index_param: efSearch=197
2025-03-13 13:13:16,885 [INFO]: 	index_path: knn.index
2025-03-13 13:13:16,885 [INFO]: 	size in bytes: 1481876710
2025-03-13 13:13:16,885 [INFO]: 	avg_search_speed_ms: 7.788633134192859
2025-03-13 13:13:16,885 [INFO]: 	99p_search_speed_ms: 12.307363043073577
2025-03-13 13:13:16,885 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:16,885 [INFO]: 	nb vectors: 7532
2025-03-13 13:13:16,885 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:16,885 [INFO]: 	compression ratio: 0.9993081381243922
2025-03-13 13:13:16,885 [INFO]: }
2025-03-13 13:13:16,885 [INFO]: 	>>> Finished "Creating the index" in 91.4868 secs
2025-03-13 13:13:16,885 [INFO]: >>> Finished "Launching the whole pipeline" in 91.5111 secs
2025-03-13 13:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 47361 [episode count 1/20]
[retrieval_preprocessing] for episode 23433 [episode count 2/20], we have num_retrieval=np.int64(7393) num_query=np.int64(516)
2025-03-13 13:13:23,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:24,394 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:24
2025-03-13 13:13:24,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:24

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1283.05it/s]
2025-03-13 13:13:24,419 [INFO]: There are 7393 embeddings of dim 49152
2025-03-13 13:13:24,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 13:13:24,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:24
2025-03-13 13:13:24,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:24,420 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:13:24,420 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:24,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:24,420 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:24
2025-03-13 13:13:24,420 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:24,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:13:24,420 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:24
2025-03-13 13:13:24,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:24,420 [INFO]: 	Creating the index 03/13/2025, 13:13:24
2025-03-13 13:13:24,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:24
2025-03-13 13:13:24,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:13:24,421 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:24
2025-03-13 13:13:24,421 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:13:24,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:05,  5.46it/s]
 10%|▉         | 3/31 [00:00<00:03,  8.97it/s]
 16%|█▌        | 5/31 [00:00<00:02, 10.23it/s]
 23%|██▎       | 7/31 [00:00<00:02, 10.97it/s]
 29%|██▉       | 9/31 [00:00<00:01, 11.19it/s]
 35%|███▌      | 11/31 [00:01<00:01, 11.30it/s]
 42%|████▏     | 13/31 [00:01<00:01, 11.38it/s]
 48%|████▊     | 15/31 [00:01<00:01, 11.38it/s]
 55%|█████▍    | 17/31 [00:01<00:01, 11.46it/s]
 61%|██████▏   | 19/31 [00:01<00:01, 11.41it/s]
 68%|██████▊   | 21/31 [00:05<00:06,  1.66it/s]
 71%|███████   | 22/31 [00:05<00:04,  1.95it/s]
 77%|███████▋  | 24/31 [00:05<00:02,  2.71it/s]
 84%|████████▍ | 26/31 [00:05<00:01,  3.62it/s]
 90%|█████████ | 28/31 [00:05<00:00,  4.61it/s]
 97%|█████████▋| 30/31 [00:06<00:00,  5.68it/s]
100%|██████████| 31/31 [00:08<00:00,  3.72it/s]
2025-03-13 13:13:32,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:32
2025-03-13 13:14:25,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7312 secs
2025-03-13 13:14:25,498 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 13:14:25,498 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:25

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.57it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 13:14:58,868 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3693 secs
2025-03-13 13:14:58,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.4489 secs
2025-03-13 13:14:58,870 [INFO]: {
2025-03-13 13:14:58,870 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:58,870 [INFO]: 	index_param: efSearch=248
2025-03-13 13:14:58,870 [INFO]: 	index_path: knn.index
2025-03-13 13:14:58,870 [INFO]: 	size in bytes: 1454529010
2025-03-13 13:14:58,870 [INFO]: 	avg_search_speed_ms: 10.463069622437995
2025-03-13 13:14:58,870 [INFO]: 	99p_search_speed_ms: 16.95647900924087
2025-03-13 13:14:58,870 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:58,870 [INFO]: 	nb vectors: 7393
2025-03-13 13:14:58,870 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:58,870 [INFO]: 	compression ratio: 0.9993083218051457
2025-03-13 13:14:58,870 [INFO]: }
2025-03-13 13:14:58,870 [INFO]: 	>>> Finished "Creating the index" in 94.4503 secs
2025-03-13 13:14:58,870 [INFO]: >>> Finished "Launching the whole pipeline" in 94.4760 secs
2025-03-13 13:15:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 23433 [episode count 2/20]
[retrieval_preprocessing] for episode 62475 [episode count 3/20], we have num_retrieval=np.int64(7735) num_query=np.int64(174)
2025-03-13 13:15:07,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:08,920 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:08
2025-03-13 13:15:08,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:08

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-13 13:15:08,944 [INFO]: There are 7735 embeddings of dim 49152
2025-03-13 13:15:08,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 13:15:08,944 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:08
2025-03-13 13:15:08,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:08,944 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 13:15:08,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:08,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:08,944 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:08
2025-03-13 13:15:08,944 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:08,944 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:15:08,944 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:08
2025-03-13 13:15:08,944 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:08,944 [INFO]: 	Creating the index 03/13/2025, 13:15:08
2025-03-13 13:15:08,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:08
2025-03-13 13:15:08,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:15:08,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:08
2025-03-13 13:15:08,945 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:15:08,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/32 [00:00<?, ?it/s]
  3%|▎         | 1/32 [00:00<00:06,  4.83it/s]
  9%|▉         | 3/32 [00:00<00:03,  8.45it/s]
 16%|█▌        | 5/32 [00:00<00:02, 10.06it/s]
 22%|██▏       | 7/32 [00:00<00:02, 11.06it/s]
 28%|██▊       | 9/32 [00:00<00:01, 11.53it/s]
 34%|███▍      | 11/32 [00:01<00:01, 11.36it/s]
 41%|████      | 13/32 [00:01<00:01, 11.67it/s]
 47%|████▋     | 15/32 [00:01<00:01, 12.10it/s]
 53%|█████▎    | 17/32 [00:01<00:01, 12.64it/s]
 59%|█████▉    | 19/32 [00:01<00:01, 12.61it/s]
 66%|██████▌   | 21/32 [00:07<00:09,  1.13it/s]
 69%|██████▉   | 22/32 [00:07<00:07,  1.34it/s]
 72%|███████▏  | 23/32 [00:07<00:05,  1.63it/s]
 75%|███████▌  | 24/32 [00:07<00:03,  2.00it/s]
 78%|███████▊  | 25/32 [00:07<00:02,  2.48it/s]
 84%|████████▍ | 27/32 [00:07<00:01,  3.59it/s]
 91%|█████████ | 29/32 [00:07<00:00,  4.72it/s]
 97%|█████████▋| 31/32 [00:08<00:00,  5.80it/s]
100%|██████████| 32/32 [00:11<00:00,  1.17it/s]
100%|██████████| 32/32 [00:11<00:00,  2.74it/s]
2025-03-13 13:15:20,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:20
2025-03-13 13:16:14,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.4425 secs
2025-03-13 13:16:14,087 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 13:16:14,087 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:14

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.54it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 13:16:41,671 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5840 secs
2025-03-13 13:16:41,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.7276 secs
2025-03-13 13:16:41,673 [INFO]: {
2025-03-13 13:16:41,673 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:41,673 [INFO]: 	index_param: efSearch=251
2025-03-13 13:16:41,673 [INFO]: 	index_path: knn.index
2025-03-13 13:16:41,673 [INFO]: 	size in bytes: 1521815950
2025-03-13 13:16:41,673 [INFO]: 	avg_search_speed_ms: 11.327343210810005
2025-03-13 13:16:41,673 [INFO]: 	99p_search_speed_ms: 17.62996250763533
2025-03-13 13:16:41,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:41,673 [INFO]: 	nb vectors: 7735
2025-03-13 13:16:41,673 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:41,673 [INFO]: 	compression ratio: 0.9993080175036936
2025-03-13 13:16:41,673 [INFO]: }
2025-03-13 13:16:41,673 [INFO]: 	>>> Finished "Creating the index" in 92.7289 secs
2025-03-13 13:16:41,673 [INFO]: >>> Finished "Launching the whole pipeline" in 92.7531 secs
2025-03-13 13:16:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 62475 [episode count 3/20]
[retrieval_preprocessing] for episode 6031 [episode count 4/20], we have num_retrieval=np.int64(7545) num_query=np.int64(364)
2025-03-13 13:16:46,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:47,342 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:47
2025-03-13 13:16:47,342 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:47

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 2039.04it/s]
2025-03-13 13:16:47,366 [INFO]: There are 7545 embeddings of dim 49152
2025-03-13 13:16:47,366 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 13:16:47,366 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:47
2025-03-13 13:16:47,366 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:47,366 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:16:47,366 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:47,366 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:16:47,367 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:47
2025-03-13 13:16:47,367 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:47,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:16:47,367 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:47
2025-03-13 13:16:47,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:47,367 [INFO]: 	Creating the index 03/13/2025, 13:16:47
2025-03-13 13:16:47,367 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:47
2025-03-13 13:16:47,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:16:47,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:47
2025-03-13 13:16:47,368 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:16:47,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:05,  5.19it/s]
 10%|▉         | 3/31 [00:00<00:03,  8.81it/s]
 16%|█▌        | 5/31 [00:00<00:02, 10.10it/s]
 23%|██▎       | 7/31 [00:00<00:02, 10.74it/s]
 29%|██▉       | 9/31 [00:00<00:01, 11.07it/s]
 35%|███▌      | 11/31 [00:01<00:01, 11.18it/s]
 42%|████▏     | 13/31 [00:01<00:01, 11.53it/s]
 48%|████▊     | 15/31 [00:01<00:01, 11.53it/s]
 55%|█████▍    | 17/31 [00:01<00:01, 11.54it/s]
 61%|██████▏   | 19/31 [00:01<00:01, 11.55it/s]
 68%|██████▊   | 21/31 [00:05<00:05,  1.72it/s]
 74%|███████▍  | 23/31 [00:05<00:03,  2.32it/s]
 81%|████████  | 25/31 [00:05<00:01,  3.07it/s]
 87%|████████▋ | 27/31 [00:05<00:01,  4.00it/s]
 94%|█████████▎| 29/31 [00:05<00:00,  5.06it/s]
100%|██████████| 31/31 [00:08<00:00,  1.62it/s]
100%|██████████| 31/31 [00:08<00:00,  3.46it/s]
2025-03-13 13:16:56,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:56
2025-03-13 13:17:49,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.0907 secs
2025-03-13 13:17:49,420 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 13:17:49,420 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:49

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s]
 50%|█████     | 2/4 [00:00<00:00,  7.24it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-13 13:18:12,106 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6857 secs
2025-03-13 13:18:12,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.7391 secs
2025-03-13 13:18:12,108 [INFO]: {
2025-03-13 13:18:12,108 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:12,108 [INFO]: 	index_param: efSearch=219
2025-03-13 13:18:12,108 [INFO]: 	index_path: knn.index
2025-03-13 13:18:12,108 [INFO]: 	size in bytes: 1484434510
2025-03-13 13:18:12,108 [INFO]: 	avg_search_speed_ms: 8.978238711350963
2025-03-13 13:18:12,108 [INFO]: 	99p_search_speed_ms: 12.421982465311881
2025-03-13 13:18:12,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:12,108 [INFO]: 	nb vectors: 7545
2025-03-13 13:18:12,108 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:12,108 [INFO]: 	compression ratio: 0.9993080530039685
2025-03-13 13:18:12,108 [INFO]: }
2025-03-13 13:18:12,108 [INFO]: 	>>> Finished "Creating the index" in 84.7406 secs
2025-03-13 13:18:12,108 [INFO]: >>> Finished "Launching the whole pipeline" in 84.7659 secs
2025-03-13 13:18:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 6031 [episode count 4/20]
[retrieval_preprocessing] for episode 30866 [episode count 5/20], we have num_retrieval=np.int64(7536) num_query=np.int64(373)
2025-03-13 13:18:17,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:18,283 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:18
2025-03-13 13:18:18,283 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:18

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-13 13:18:18,307 [INFO]: There are 7536 embeddings of dim 49152
2025-03-13 13:18:18,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 13:18:18,307 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:18
2025-03-13 13:18:18,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:18,307 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:18:18,307 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:18:18,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:18:18,307 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:18
2025-03-13 13:18:18,307 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:18,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:18:18,307 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:18
2025-03-13 13:18:18,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:18,307 [INFO]: 	Creating the index 03/13/2025, 13:18:18
2025-03-13 13:18:18,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:18:18
2025-03-13 13:18:18,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:18:18,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:18
2025-03-13 13:18:18,309 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:18:18,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:05,  5.25it/s]
 10%|▉         | 3/31 [00:00<00:03,  9.25it/s]
 16%|█▌        | 5/31 [00:00<00:02, 10.88it/s]
 23%|██▎       | 7/31 [00:00<00:02, 11.62it/s]
 29%|██▉       | 9/31 [00:00<00:01, 12.05it/s]
 35%|███▌      | 11/31 [00:00<00:01, 12.22it/s]
 42%|████▏     | 13/31 [00:01<00:01, 12.29it/s]
 48%|████▊     | 15/31 [00:01<00:01, 12.53it/s]
 55%|█████▍    | 17/31 [00:01<00:01, 12.53it/s]
 61%|██████▏   | 19/31 [00:01<00:00, 12.53it/s]
 68%|██████▊   | 21/31 [00:05<00:06,  1.61it/s]
 74%|███████▍  | 23/31 [00:05<00:03,  2.19it/s]
 81%|████████  | 25/31 [00:05<00:02,  2.92it/s]
 87%|████████▋ | 27/31 [00:05<00:01,  3.67it/s]
 94%|█████████▎| 29/31 [00:06<00:00,  4.36it/s]
 97%|█████████▋| 30/31 [00:06<00:00,  4.80it/s]
100%|██████████| 31/31 [00:08<00:00,  1.44it/s]
100%|██████████| 31/31 [00:08<00:00,  3.51it/s]
2025-03-13 13:18:27,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:18:27
2025-03-13 13:19:26,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8818 secs
2025-03-13 13:19:26,021 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 13:19:26,021 [INFO]: 	Compute fast metrics 03/13/2025, 13:19:26

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.81it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 13:19:49,272 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2511 secs
2025-03-13 13:19:49,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9663 secs
2025-03-13 13:19:49,275 [INFO]: {
2025-03-13 13:19:49,275 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:49,275 [INFO]: 	index_param: efSearch=167
2025-03-13 13:19:49,275 [INFO]: 	index_path: knn.index
2025-03-13 13:19:49,275 [INFO]: 	size in bytes: 1482663670
2025-03-13 13:19:49,275 [INFO]: 	avg_search_speed_ms: 7.696762869028436
2025-03-13 13:19:49,275 [INFO]: 	99p_search_speed_ms: 11.659000399522483
2025-03-13 13:19:49,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:49,275 [INFO]: 	nb vectors: 7536
2025-03-13 13:19:49,275 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:49,275 [INFO]: 	compression ratio: 0.999308149231174
2025-03-13 13:19:49,275 [INFO]: }
2025-03-13 13:19:49,275 [INFO]: 	>>> Finished "Creating the index" in 90.9679 secs
2025-03-13 13:19:49,275 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9919 secs
2025-03-13 13:19:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 30866 [episode count 5/20]
[retrieval_preprocessing] for episode 91802 [episode count 6/20], we have num_retrieval=np.int64(7338) num_query=np.int64(571)
2025-03-13 13:19:55,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:56,368 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:56
2025-03-13 13:19:56,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:56

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1150.70it/s]
2025-03-13 13:19:56,393 [INFO]: There are 7338 embeddings of dim 49152
2025-03-13 13:19:56,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 13:19:56,393 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:56
2025-03-13 13:19:56,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:56,393 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 13:19:56,393 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:56,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:56,393 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:56
2025-03-13 13:19:56,394 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:56,394 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:19:56,394 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:56
2025-03-13 13:19:56,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:56,394 [INFO]: 	Creating the index 03/13/2025, 13:19:56
2025-03-13 13:19:56,394 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:56
2025-03-13 13:19:56,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:19:56,395 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:56
2025-03-13 13:19:56,396 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 13:19:56,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/30 [00:00<?, ?it/s]
  3%|▎         | 1/30 [00:00<00:05,  5.45it/s]
 10%|█         | 3/30 [00:00<00:02,  9.58it/s]
 17%|█▋        | 5/30 [00:00<00:02, 10.97it/s]
 23%|██▎       | 7/30 [00:00<00:01, 11.62it/s]
 30%|███       | 9/30 [00:00<00:01, 11.92it/s]
 37%|███▋      | 11/30 [00:00<00:01, 12.07it/s]
 43%|████▎     | 13/30 [00:01<00:01, 12.27it/s]
 50%|█████     | 15/30 [00:01<00:01, 12.49it/s]
 57%|█████▋    | 17/30 [00:01<00:01, 12.72it/s]
 63%|██████▎   | 19/30 [00:01<00:00, 13.46it/s]
 70%|███████   | 21/30 [00:05<00:05,  1.67it/s]
 77%|███████▋  | 23/30 [00:05<00:03,  2.26it/s]
 83%|████████▎ | 25/30 [00:05<00:01,  3.01it/s]
 90%|█████████ | 27/30 [00:05<00:00,  3.92it/s]
 97%|█████████▋| 29/30 [00:05<00:00,  4.95it/s]
100%|██████████| 30/30 [00:08<00:00,  3.73it/s]
2025-03-13 13:20:04,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:04
2025-03-13 13:20:51,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3193 secs
2025-03-13 13:20:51,776 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 13:20:51,776 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:51

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s]
 75%|███████▌  | 3/4 [00:00<00:00, 10.11it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s]
2025-03-13 13:21:13,011 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2350 secs
2025-03-13 13:21:13,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7862 secs
2025-03-13 13:21:13,182 [INFO]: {
2025-03-13 13:21:13,182 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:13,182 [INFO]: 	index_param: efSearch=233
2025-03-13 13:21:13,182 [INFO]: 	index_path: knn.index
2025-03-13 13:21:13,182 [INFO]: 	size in bytes: 1443708310
2025-03-13 13:21:13,182 [INFO]: 	avg_search_speed_ms: 9.458040230437874
2025-03-13 13:21:13,182 [INFO]: 	99p_search_speed_ms: 18.24941743165255
2025-03-13 13:21:13,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:13,182 [INFO]: 	nb vectors: 7338
2025-03-13 13:21:13,182 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:13,183 [INFO]: 	compression ratio: 0.9993081663428258
2025-03-13 13:21:13,183 [INFO]: }
2025-03-13 13:21:13,183 [INFO]: 	>>> Finished "Creating the index" in 76.7889 secs
2025-03-13 13:21:13,183 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8144 secs
2025-03-13 13:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91802 [episode count 6/20]
[retrieval_preprocessing] for episode 284 [episode count 7/20], we have num_retrieval=np.int64(7534) num_query=np.int64(375)
2025-03-13 13:21:21,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:22,843 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:22
2025-03-13 13:21:22,843 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:22

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1222.12it/s]
2025-03-13 13:21:22,870 [INFO]: There are 7534 embeddings of dim 49152
2025-03-13 13:21:22,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 13:21:22,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:22
2025-03-13 13:21:22,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:22,870 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:21:22,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:22,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:21:22,870 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:22
2025-03-13 13:21:22,871 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:22,871 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:21:22,871 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:22
2025-03-13 13:21:22,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:22,871 [INFO]: 	Creating the index 03/13/2025, 13:21:22
2025-03-13 13:21:22,871 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:22
2025-03-13 13:21:22,872 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:21:22,872 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:22
2025-03-13 13:21:22,872 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:21:22,872 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:06,  4.76it/s]
  6%|▋         | 2/31 [00:00<00:04,  6.35it/s]
 10%|▉         | 3/31 [00:00<00:03,  7.17it/s]
 13%|█▎        | 4/31 [00:00<00:03,  7.79it/s]
 16%|█▌        | 5/31 [00:00<00:03,  8.08it/s]
 19%|█▉        | 6/31 [00:00<00:03,  8.23it/s]
 23%|██▎       | 7/31 [00:00<00:02,  8.39it/s]
 26%|██▌       | 8/31 [00:01<00:02,  8.52it/s]
 29%|██▉       | 9/31 [00:01<00:02,  8.66it/s]
 32%|███▏      | 10/31 [00:01<00:02,  8.85it/s]
 35%|███▌      | 11/31 [00:01<00:02,  9.17it/s]
 42%|████▏     | 13/31 [00:01<00:01, 10.80it/s]
 52%|█████▏    | 16/31 [00:01<00:01, 14.26it/s]
 58%|█████▊    | 18/31 [00:01<00:00, 15.30it/s]
 65%|██████▍   | 20/31 [00:01<00:00, 16.22it/s]
 71%|███████   | 22/31 [00:05<00:04,  1.85it/s]
 77%|███████▋  | 24/31 [00:05<00:02,  2.49it/s]
 84%|████████▍ | 26/31 [00:05<00:01,  3.25it/s]
 90%|█████████ | 28/31 [00:05<00:00,  4.29it/s]
 97%|█████████▋| 30/31 [00:05<00:00,  5.40it/s]
100%|██████████| 31/31 [00:07<00:00,  4.01it/s]
2025-03-13 13:21:31,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:31
2025-03-13 13:22:25,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1762 secs
2025-03-13 13:22:25,349 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 13:22:25,349 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:25

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 13:22:55,280 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9312 secs
2025-03-13 13:22:55,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.4105 secs
2025-03-13 13:22:55,282 [INFO]: {
2025-03-13 13:22:55,282 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:55,282 [INFO]: 	index_param: efSearch=271
2025-03-13 13:22:55,282 [INFO]: 	index_path: knn.index
2025-03-13 13:22:55,282 [INFO]: 	size in bytes: 1482270190
2025-03-13 13:22:55,282 [INFO]: 	avg_search_speed_ms: 10.41638276874437
2025-03-13 13:22:55,282 [INFO]: 	99p_search_speed_ms: 14.690789713058619
2025-03-13 13:22:55,282 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:55,282 [INFO]: 	nb vectors: 7534
2025-03-13 13:22:55,283 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:55,283 [INFO]: 	compression ratio: 0.9993081436792572
2025-03-13 13:22:55,283 [INFO]: }
2025-03-13 13:22:55,283 [INFO]: 	>>> Finished "Creating the index" in 92.4118 secs
2025-03-13 13:22:55,283 [INFO]: >>> Finished "Launching the whole pipeline" in 92.4397 secs
2025-03-13 13:22:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:23:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 284 [episode count 7/20]
[retrieval_preprocessing] for episode 21153 [episode count 8/20], we have num_retrieval=np.int64(7558) num_query=np.int64(351)
2025-03-13 13:23:03,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:23:05,292 [INFO]: Launching the whole pipeline 03/13/2025, 13:23:05
2025-03-13 13:23:05,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:23:05

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1258.04it/s]
2025-03-13 13:23:05,317 [INFO]: There are 7558 embeddings of dim 49152
2025-03-13 13:23:05,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 13:23:05,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:23:05
2025-03-13 13:23:05,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:23:05,317 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 13:23:05,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:23:05,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:23:05,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:23:05
2025-03-13 13:23:05,317 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:23:05,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:23:05,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:23:05
2025-03-13 13:23:05,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:23:05,318 [INFO]: 	Creating the index 03/13/2025, 13:23:05
2025-03-13 13:23:05,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:23:05
2025-03-13 13:23:05,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:23:05,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:23:05
2025-03-13 13:23:05,319 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:23:05,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:05,  5.64it/s]
 10%|▉         | 3/31 [00:00<00:02, 10.61it/s]
 16%|█▌        | 5/31 [00:00<00:02, 12.70it/s]
 23%|██▎       | 7/31 [00:00<00:01, 13.84it/s]
 29%|██▉       | 9/31 [00:00<00:01, 14.38it/s]
 35%|███▌      | 11/31 [00:00<00:01, 14.49it/s]
 42%|████▏     | 13/31 [00:00<00:01, 14.83it/s]
 48%|████▊     | 15/31 [00:01<00:01, 15.60it/s]
 55%|█████▍    | 17/31 [00:01<00:00, 16.09it/s]
 61%|██████▏   | 19/31 [00:01<00:00, 16.33it/s]
 68%|██████▊   | 21/31 [00:05<00:06,  1.61it/s]
 74%|███████▍  | 23/31 [00:05<00:03,  2.17it/s]
 81%|████████  | 25/31 [00:05<00:02,  2.88it/s]
 87%|████████▋ | 27/31 [00:05<00:01,  3.72it/s]
 94%|█████████▎| 29/31 [00:05<00:00,  4.66it/s]
100%|██████████| 31/31 [00:08<00:00,  1.69it/s]
100%|██████████| 31/31 [00:08<00:00,  3.55it/s]
2025-03-13 13:23:14,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:14
2025-03-13 13:24:12,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5455 secs
2025-03-13 13:24:12,609 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 13:24:12,609 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:12

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 13:24:38,095 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4866 secs
2025-03-13 13:24:38,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.7785 secs
2025-03-13 13:24:38,098 [INFO]: {
2025-03-13 13:24:38,098 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:38,098 [INFO]: 	index_param: efSearch=244
2025-03-13 13:24:38,098 [INFO]: 	index_path: knn.index
2025-03-13 13:24:38,098 [INFO]: 	size in bytes: 1486992130
2025-03-13 13:24:38,098 [INFO]: 	avg_search_speed_ms: 10.99702659150033
2025-03-13 13:24:38,098 [INFO]: 	99p_search_speed_ms: 16.962079510558393
2025-03-13 13:24:38,098 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:38,098 [INFO]: 	nb vectors: 7558
2025-03-13 13:24:38,098 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:38,098 [INFO]: 	compression ratio: 0.9993080891423414
2025-03-13 13:24:38,098 [INFO]: }
2025-03-13 13:24:38,098 [INFO]: 	>>> Finished "Creating the index" in 92.7801 secs
2025-03-13 13:24:38,098 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8052 secs
2025-03-13 13:24:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 21153 [episode count 8/20]
[retrieval_preprocessing] for episode 39210 [episode count 9/20], we have num_retrieval=np.int64(7537) num_query=np.int64(372)
2025-03-13 13:24:44,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:45,433 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:45
2025-03-13 13:24:45,434 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:45

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00, 1212.58it/s]
2025-03-13 13:24:45,460 [INFO]: There are 7537 embeddings of dim 49152
2025-03-13 13:24:45,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 13:24:45,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:45
2025-03-13 13:24:45,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:45,460 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:24:45,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:45,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:24:45,461 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:45
2025-03-13 13:24:45,461 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:45,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:24:45,461 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:45
2025-03-13 13:24:45,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:45,461 [INFO]: 	Creating the index 03/13/2025, 13:24:45
2025-03-13 13:24:45,461 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:45
2025-03-13 13:24:45,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:24:45,462 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:45
2025-03-13 13:24:45,462 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:24:45,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)

  0%|          | 0/31 [00:00<?, ?it/s]
  3%|▎         | 1/31 [00:00<00:05,  5.47it/s]
 10%|▉         | 3/31 [00:00<00:02, 10.72it/s]
 16%|█▌        | 5/31 [00:00<00:01, 13.27it/s]
 23%|██▎       | 7/31 [00:00<00:01, 13.25it/s]
 29%|██▉       | 9/31 [00:00<00:01, 12.65it/s]
 35%|███▌      | 11/31 [00:00<00:01, 12.14it/s]
 42%|████▏     | 13/31 [00:01<00:01, 11.88it/s]
 48%|████▊     | 15/31 [00:01<00:01, 11.63it/s]
 55%|█████▍    | 17/31 [00:01<00:01, 11.49it/s]
 61%|██████▏   | 19/31 [00:01<00:01, 11.46it/s]
 68%|██████▊   | 21/31 [00:05<00:06,  1.55it/s]
 71%|███████   | 22/31 [00:05<00:04,  1.83it/s]
 77%|███████▋  | 24/31 [00:05<00:02,  2.54it/s]
 81%|████████  | 25/31 [00:05<00:02,  2.96it/s]
 84%|████████▍ | 26/31 [00:05<00:01,  3.45it/s]
 87%|████████▋ | 27/31 [00:06<00:00,  4.06it/s]
 90%|█████████ | 28/31 [00:06<00:00,  4.73it/s]
 94%|█████████▎| 29/31 [00:06<00:00,  5.45it/s]
100%|██████████| 31/31 [00:09<00:00,  1.43it/s]
100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
2025-03-13 13:24:54,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:54
2025-03-13 13:25:45,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4314 secs
2025-03-13 13:25:45,927 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 13:25:45,927 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 13:26:08,160 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2330 secs
2025-03-13 13:26:08,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.2294 secs
2025-03-13 13:26:08,692 [INFO]: {
2025-03-13 13:26:08,692 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:08,692 [INFO]: 	index_param: efSearch=238
2025-03-13 13:26:08,692 [INFO]: 	index_path: knn.index
2025-03-13 13:26:08,692 [INFO]: 	size in bytes: 1482860410
2025-03-13 13:26:08,692 [INFO]: 	avg_search_speed_ms: 9.869391780331922
2025-03-13 13:26:08,692 [INFO]: 	99p_search_speed_ms: 13.740851823240519
2025-03-13 13:26:08,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:08,692 [INFO]: 	nb vectors: 7537
2025-03-13 13:26:08,692 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:08,692 [INFO]: 	compression ratio: 0.9993081520060273
2025-03-13 13:26:08,692 [INFO]: }
2025-03-13 13:26:08,692 [INFO]: 	>>> Finished "Creating the index" in 83.2314 secs
2025-03-13 13:26:08,692 [INFO]: >>> Finished "Launching the whole pipeline" in 83.2588 secs
2025-03-13 13:26:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 39210 [episode count 9/20]
[retrieval_preprocessing] for episode 28339 [episode count 10/20], we have num_retrieval=np.int64(7473) num_query=np.int64(436)
2025-03-13 13:26:15,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:16,262 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:16
2025-03-13 13:26:16,262 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.92it/s]
2025-03-13 13:26:16,287 [INFO]: There are 7473 embeddings of dim 49152
2025-03-13 13:26:16,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 13:26:16,288 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:16,288 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 13:26:16,288 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:16,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:26:16,288 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,289 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:16,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:26:16,289 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:16
2025-03-13 13:26:16,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:16,289 [INFO]: 	Creating the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:16
2025-03-13 13:26:16,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:26:16,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,293 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 13:26:16,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:05,  5.43it/s] 10%|▉         | 3/31 [00:00<00:03,  9.21it/s] 16%|█▌        | 5/31 [00:00<00:02, 10.63it/s] 23%|██▎       | 7/31 [00:00<00:02, 11.55it/s] 29%|██▉       | 9/31 [00:00<00:01, 11.92it/s] 35%|███▌      | 11/31 [00:00<00:01, 12.21it/s] 42%|████▏     | 13/31 [00:01<00:01, 12.42it/s] 48%|████▊     | 15/31 [00:01<00:01, 12.49it/s] 55%|█████▍    | 17/31 [00:01<00:01, 12.56it/s] 61%|██████▏   | 19/31 [00:01<00:00, 12.55it/s] 68%|██████▊   | 21/31 [00:04<00:05,  1.76it/s] 74%|███████▍  | 23/31 [00:05<00:03,  2.37it/s] 81%|████████  | 25/31 [00:05<00:01,  3.15it/s] 87%|████████▋ | 27/31 [00:05<00:00,  4.08it/s] 94%|█████████▎| 29/31 [00:05<00:00,  5.14it/s]100%|██████████| 31/31 [00:07<00:00,  2.05it/s]100%|██████████| 31/31 [00:07<00:00,  3.91it/s]
2025-03-13 13:26:24,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:24
2025-03-13 13:27:23,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7832 secs
2025-03-13 13:27:23,013 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 13:27:23,013 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
