2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_remove_lid_from_pot [chosen_id count 0/196]
2025-03-13 14:35:01: [retrieval_preprocessing] we have num_total=3188 embedding_dim=49152
[retrieval_preprocessing] for episode 26652 [episode count 0/20], we have num_retrieval=np.int64(3009) num_query=np.int64(179)
2025-03-13 14:35:02,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:02,599 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:02
2025-03-13 14:35:02,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 788.70it/s]
2025-03-13 14:35:02,663 [INFO]: There are 3009 embeddings of dim 49152
2025-03-13 14:35:02,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0641 secs
2025-03-13 14:35:02,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:02
2025-03-13 14:35:02,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:02,664 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:35:02,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:02,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:35:02,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:02
2025-03-13 14:35:02,666 [INFO]: 621.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:02,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0014 secs
2025-03-13 14:35:02,666 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:02
2025-03-13 14:35:02,666 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:02,666 [INFO]: 	Creating the index 03/13/2025, 14:35:02
2025-03-13 14:35:02,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:02
2025-03-13 14:35:02,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:35:02,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:02
2025-03-13 14:35:02,670 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:35:02,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.39it/s] 75%|███████▌  | 9/12 [00:00<00:00, 41.55it/s]100%|██████████| 12/12 [00:02<00:00,  4.95it/s]
2025-03-13 14:35:05,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:05
2025-03-13 14:35:51,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7567 secs
2025-03-13 14:35:51,856 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 14:35:51,857 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 14:36:08,672 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8150 secs
2025-03-13 14:36:08,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0045 secs
2025-03-13 14:36:08,675 [INFO]: {
2025-03-13 14:36:08,675 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:08,675 [INFO]: 	index_param: efSearch=132
2025-03-13 14:36:08,675 [INFO]: 	index_path: knn.index
2025-03-13 14:36:08,675 [INFO]: 	size in bytes: 592002070
2025-03-13 14:36:08,675 [INFO]: 	avg_search_speed_ms: 7.0768100293900265
2025-03-13 14:36:08,675 [INFO]: 	99p_search_speed_ms: 13.797455932944999
2025-03-13 14:36:08,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:08,675 [INFO]: 	nb vectors: 3009
2025-03-13 14:36:08,675 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:08,675 [INFO]: 	compression ratio: 0.9993098030890332
2025-03-13 14:36:08,675 [INFO]: }
2025-03-13 14:36:08,675 [INFO]: 	>>> Finished "Creating the index" in 66.0088 secs
2025-03-13 14:36:08,675 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0756 secs
2025-03-13 14:36:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 26652 [episode count 0/20]
[retrieval_preprocessing] for episode 9760 [episode count 1/20], we have num_retrieval=np.int64(2996) num_query=np.int64(192)
2025-03-13 14:36:10,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:10,574 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:10
2025-03-13 14:36:10,574 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.90it/s]
2025-03-13 14:36:10,600 [INFO]: There are 2996 embeddings of dim 49152
2025-03-13 14:36:10,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 14:36:10,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:10,600 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:36:10,600 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:10,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:10,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,600 [INFO]: 618.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:10,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:36:10,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:10
2025-03-13 14:36:10,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:10,601 [INFO]: 	Creating the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,601 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:10
2025-03-13 14:36:10,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:36:10,602 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,602 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:36:10,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.85it/s] 50%|█████     | 6/12 [00:00<00:00, 30.92it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.20it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-13 14:36:13,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:13
2025-03-13 14:36:46,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0923 secs
2025-03-13 14:36:46,229 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 14:36:46,229 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 14:37:03,485 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2556 secs
2025-03-13 14:37:03,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8856 secs
2025-03-13 14:37:03,487 [INFO]: {
2025-03-13 14:37:03,487 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:03,487 [INFO]: 	index_param: efSearch=141
2025-03-13 14:37:03,487 [INFO]: 	index_path: knn.index
2025-03-13 14:37:03,487 [INFO]: 	size in bytes: 589444450
2025-03-13 14:37:03,487 [INFO]: 	avg_search_speed_ms: 6.725753210491245
2025-03-13 14:37:03,487 [INFO]: 	99p_search_speed_ms: 8.990651397034528
2025-03-13 14:37:03,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:03,487 [INFO]: 	nb vectors: 2996
2025-03-13 14:37:03,487 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:03,487 [INFO]: 	compression ratio: 0.9993097195164022
2025-03-13 14:37:03,487 [INFO]: }
2025-03-13 14:37:03,488 [INFO]: 	>>> Finished "Creating the index" in 52.8870 secs
2025-03-13 14:37:03,488 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9139 secs
2025-03-13 14:37:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 9760 [episode count 1/20]
[retrieval_preprocessing] for episode 87110 [episode count 2/20], we have num_retrieval=np.int64(3038) num_query=np.int64(150)
2025-03-13 14:37:05,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:06,619 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:06
2025-03-13 14:37:06,619 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1626.33it/s]
2025-03-13 14:37:06,647 [INFO]: There are 3038 embeddings of dim 49152
2025-03-13 14:37:06,647 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 14:37:06,647 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,647 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:06,647 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:37:06,647 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:06,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:06,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,647 [INFO]: 627.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:06,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:06,648 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:06
2025-03-13 14:37:06,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:06,648 [INFO]: 	Creating the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:06
2025-03-13 14:37:06,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:37:06,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,649 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:37:06,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 15.80it/s] 50%|█████     | 6/12 [00:00<00:00, 26.98it/s] 92%|█████████▏| 11/12 [00:00<00:00, 33.94it/s]100%|██████████| 12/12 [00:02<00:00,  4.23it/s]
2025-03-13 14:37:09,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:09
2025-03-13 14:37:49,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0901 secs
2025-03-13 14:37:49,582 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 14:37:49,582 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 14:38:09,265 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6826 secs
2025-03-13 14:38:09,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6193 secs
2025-03-13 14:38:09,268 [INFO]: {
2025-03-13 14:38:09,268 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:09,268 [INFO]: 	index_param: efSearch=157
2025-03-13 14:38:09,268 [INFO]: 	index_path: knn.index
2025-03-13 14:38:09,268 [INFO]: 	size in bytes: 597707590
2025-03-13 14:38:09,268 [INFO]: 	avg_search_speed_ms: 8.335268997858899
2025-03-13 14:38:09,268 [INFO]: 	99p_search_speed_ms: 15.13068065047264
2025-03-13 14:38:09,269 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:09,269 [INFO]: 	nb vectors: 3038
2025-03-13 14:38:09,269 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:09,269 [INFO]: 	compression ratio: 0.9993098866286774
2025-03-13 14:38:09,269 [INFO]: }
2025-03-13 14:38:09,269 [INFO]: 	>>> Finished "Creating the index" in 62.6209 secs
2025-03-13 14:38:09,269 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6500 secs
2025-03-13 14:38:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 87110 [episode count 2/20]
[retrieval_preprocessing] for episode 93271 [episode count 3/20], we have num_retrieval=np.int64(3018) num_query=np.int64(170)
2025-03-13 14:38:10,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:11,646 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:11
2025-03-13 14:38:11,646 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 8289.14it/s]
2025-03-13 14:38:12,141 [INFO]: There are 3018 embeddings of dim 49152
2025-03-13 14:38:12,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4948 secs
2025-03-13 14:38:12,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:12
2025-03-13 14:38:12,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:12,141 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:38:12,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:12,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:38:12,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:12
2025-03-13 14:38:12,141 [INFO]: 622.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:12,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:12,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:12
2025-03-13 14:38:12,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:12,142 [INFO]: 	Creating the index 03/13/2025, 14:38:12
2025-03-13 14:38:12,142 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:12
2025-03-13 14:38:12,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:38:12,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:12
2025-03-13 14:38:12,144 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:38:12,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.87it/s] 50%|█████     | 6/12 [00:00<00:00, 28.32it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.00it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-13 14:38:14,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:14
2025-03-13 14:38:50,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6123 secs
2025-03-13 14:38:50,199 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 14:38:50,199 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.37it/s]
2025-03-13 14:39:08,412 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2126 secs
2025-03-13 14:39:08,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2711 secs
2025-03-13 14:39:08,415 [INFO]: {
2025-03-13 14:39:08,415 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:08,415 [INFO]: 	index_param: efSearch=254
2025-03-13 14:39:08,415 [INFO]: 	index_path: knn.index
2025-03-13 14:39:08,415 [INFO]: 	size in bytes: 593772730
2025-03-13 14:39:08,415 [INFO]: 	avg_search_speed_ms: 16.62096690171494
2025-03-13 14:39:08,415 [INFO]: 	99p_search_speed_ms: 35.0916640670039
2025-03-13 14:39:08,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:08,416 [INFO]: 	nb vectors: 3018
2025-03-13 14:39:08,416 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:08,416 [INFO]: 	compression ratio: 0.9993098605252552
2025-03-13 14:39:08,416 [INFO]: }
2025-03-13 14:39:08,416 [INFO]: 	>>> Finished "Creating the index" in 56.2739 secs
2025-03-13 14:39:08,416 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7696 secs
2025-03-13 14:39:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 93271 [episode count 3/20]
[retrieval_preprocessing] for episode 41051 [episode count 4/20], we have num_retrieval=np.int64(3026) num_query=np.int64(162)
2025-03-13 14:39:11,825 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:12,521 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:12
2025-03-13 14:39:12,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 896.22it/s]
2025-03-13 14:39:12,557 [INFO]: There are 3026 embeddings of dim 49152
2025-03-13 14:39:12,557 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 14:39:12,557 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,557 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:12,557 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:39:12,557 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:12,557 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:12,557 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,557 [INFO]: 624.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:12,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:39:12,557 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:12
2025-03-13 14:39:12,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:12,557 [INFO]: 	Creating the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:12
2025-03-13 14:39:12,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:39:12,559 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,559 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:39:12,559 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.84it/s] 50%|█████     | 6/12 [00:00<00:00, 26.95it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.16it/s]100%|██████████| 12/12 [00:03<00:00,  3.30it/s]
2025-03-13 14:39:16,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:16
2025-03-13 14:39:52,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8816 secs
2025-03-13 14:39:52,079 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 14:39:52,079 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.71it/s]
2025-03-13 14:40:11,336 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2564 secs
2025-03-13 14:40:11,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7809 secs
2025-03-13 14:40:11,340 [INFO]: {
2025-03-13 14:40:11,340 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:11,340 [INFO]: 	index_param: efSearch=238
2025-03-13 14:40:11,340 [INFO]: 	index_path: knn.index
2025-03-13 14:40:11,340 [INFO]: 	size in bytes: 595346650
2025-03-13 14:40:11,340 [INFO]: 	avg_search_speed_ms: 17.12134020436517
2025-03-13 14:40:11,340 [INFO]: 	99p_search_speed_ms: 31.61054831696673
2025-03-13 14:40:11,340 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:11,340 [INFO]: 	nb vectors: 3026
2025-03-13 14:40:11,340 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:11,340 [INFO]: 	compression ratio: 0.9993099112928577
2025-03-13 14:40:11,340 [INFO]: }
2025-03-13 14:40:11,340 [INFO]: 	>>> Finished "Creating the index" in 58.7826 secs
2025-03-13 14:40:11,340 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8193 secs
2025-03-13 14:40:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 41051 [episode count 4/20]
[retrieval_preprocessing] for episode 91227 [episode count 5/20], we have num_retrieval=np.int64(3041) num_query=np.int64(147)
2025-03-13 14:40:13,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:14,341 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:14
2025-03-13 14:40:14,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.97it/s]
2025-03-13 14:40:14,381 [INFO]: There are 3041 embeddings of dim 49152
2025-03-13 14:40:14,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 14:40:14,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:14,382 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:40:14,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:14,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:14,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,382 [INFO]: 627.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:14,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:40:14,382 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:14
2025-03-13 14:40:14,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:14,382 [INFO]: 	Creating the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,382 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:14
2025-03-13 14:40:14,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:40:14,384 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,384 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:40:14,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.13it/s] 42%|████▏     | 5/12 [00:00<00:00, 19.66it/s] 75%|███████▌  | 9/12 [00:00<00:00, 25.06it/s]100%|██████████| 12/12 [00:02<00:00,  3.12it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]
2025-03-13 14:40:17,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:17
2025-03-13 14:40:50,594 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3925 secs
2025-03-13 14:40:50,595 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 14:40:50,595 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.15it/s]
2025-03-13 14:41:09,792 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1974 secs
2025-03-13 14:41:09,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4109 secs
2025-03-13 14:41:09,795 [INFO]: {
2025-03-13 14:41:09,795 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:09,795 [INFO]: 	index_param: efSearch=162
2025-03-13 14:41:09,795 [INFO]: 	index_path: knn.index
2025-03-13 14:41:09,795 [INFO]: 	size in bytes: 598297810
2025-03-13 14:41:09,795 [INFO]: 	avg_search_speed_ms: 8.179112596822657
2025-03-13 14:41:09,795 [INFO]: 	99p_search_speed_ms: 12.043998595327137
2025-03-13 14:41:09,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:09,795 [INFO]: 	nb vectors: 3041
2025-03-13 14:41:09,795 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:09,795 [INFO]: 	compression ratio: 0.9993099055468714
2025-03-13 14:41:09,795 [INFO]: }
2025-03-13 14:41:09,795 [INFO]: 	>>> Finished "Creating the index" in 55.4126 secs
2025-03-13 14:41:09,795 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4539 secs
2025-03-13 14:41:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 91227 [episode count 5/20]
[retrieval_preprocessing] for episode 49252 [episode count 6/20], we have num_retrieval=np.int64(3023) num_query=np.int64(165)
2025-03-13 14:41:11,121 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:11,806 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:11
2025-03-13 14:41:11,806 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2160.90it/s]
2025-03-13 14:41:11,836 [INFO]: There are 3023 embeddings of dim 49152
2025-03-13 14:41:11,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 14:41:11,836 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:11
2025-03-13 14:41:11,836 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:11,836 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:41:11,836 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:11,836 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:11,836 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:11
2025-03-13 14:41:11,837 [INFO]: 623.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:11,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:11,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:11
2025-03-13 14:41:11,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:11,837 [INFO]: 	Creating the index 03/13/2025, 14:41:11
2025-03-13 14:41:11,837 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:11
2025-03-13 14:41:11,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:41:11,838 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:11
2025-03-13 14:41:11,838 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:41:11,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.48it/s] 50%|█████     | 6/12 [00:00<00:00, 30.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]100%|██████████| 12/12 [00:02<00:00,  5.49it/s]
2025-03-13 14:41:14,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:14
2025-03-13 14:41:48,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6997 secs
2025-03-13 14:41:48,729 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 14:41:48,729 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 14:42:05,789 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0596 secs
2025-03-13 14:42:05,791 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9534 secs
2025-03-13 14:42:05,791 [INFO]: {
2025-03-13 14:42:05,791 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:05,791 [INFO]: 	index_param: efSearch=235
2025-03-13 14:42:05,791 [INFO]: 	index_path: knn.index
2025-03-13 14:42:05,791 [INFO]: 	size in bytes: 594756430
2025-03-13 14:42:05,792 [INFO]: 	avg_search_speed_ms: 9.178234981757443
2025-03-13 14:42:05,792 [INFO]: 	99p_search_speed_ms: 16.931354431435466
2025-03-13 14:42:05,792 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:05,792 [INFO]: 	nb vectors: 3023
2025-03-13 14:42:05,792 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:05,792 [INFO]: 	compression ratio: 0.9993098922864945
2025-03-13 14:42:05,792 [INFO]: }
2025-03-13 14:42:05,792 [INFO]: 	>>> Finished "Creating the index" in 53.9549 secs
2025-03-13 14:42:05,792 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9856 secs
2025-03-13 14:42:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 49252 [episode count 6/20]
[retrieval_preprocessing] for episode 58509 [episode count 7/20], we have num_retrieval=np.int64(3019) num_query=np.int64(169)
2025-03-13 14:42:07,350 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:07,748 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:07
2025-03-13 14:42:07,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.20it/s]
2025-03-13 14:42:07,780 [INFO]: There are 3019 embeddings of dim 49152
2025-03-13 14:42:07,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 14:42:07,780 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:07
2025-03-13 14:42:07,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:07,780 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:42:07,780 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:07,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:07,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:07
2025-03-13 14:42:07,780 [INFO]: 623.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:07,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:42:07,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:07
2025-03-13 14:42:07,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:07,780 [INFO]: 	Creating the index 03/13/2025, 14:42:07
2025-03-13 14:42:07,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:07
2025-03-13 14:42:07,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:42:07,781 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:07
2025-03-13 14:42:07,782 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:42:07,782 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.17it/s] 50%|█████     | 6/12 [00:00<00:00, 31.83it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.40it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-13 14:42:10,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:10
2025-03-13 14:42:47,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6721 secs
2025-03-13 14:42:47,684 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 14:42:47,684 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.19it/s]
2025-03-13 14:43:04,273 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5886 secs
2025-03-13 14:43:04,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4957 secs
2025-03-13 14:43:04,278 [INFO]: {
2025-03-13 14:43:04,278 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:04,278 [INFO]: 	index_param: efSearch=224
2025-03-13 14:43:04,278 [INFO]: 	index_path: knn.index
2025-03-13 14:43:04,278 [INFO]: 	size in bytes: 593969470
2025-03-13 14:43:04,278 [INFO]: 	avg_search_speed_ms: 13.821570496962442
2025-03-13 14:43:04,278 [INFO]: 	99p_search_speed_ms: 21.32993523031473
2025-03-13 14:43:04,278 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:04,278 [INFO]: 	nb vectors: 3019
2025-03-13 14:43:04,278 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:04,278 [INFO]: 	compression ratio: 0.9993098668859193
2025-03-13 14:43:04,278 [INFO]: }
2025-03-13 14:43:04,278 [INFO]: 	>>> Finished "Creating the index" in 56.4973 secs
2025-03-13 14:43:04,278 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5295 secs
2025-03-13 14:43:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 58509 [episode count 7/20]
[retrieval_preprocessing] for episode 44689 [episode count 8/20], we have num_retrieval=np.int64(3063) num_query=np.int64(125)
2025-03-13 14:43:06,530 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:07,357 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:07
2025-03-13 14:43:07,357 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1322.71it/s]
2025-03-13 14:43:07,392 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 14:43:07,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 14:43:07,393 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:07
2025-03-13 14:43:07,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:07,393 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:43:07,393 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:07,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:07,393 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:07
2025-03-13 14:43:07,393 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:07,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:07,393 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:07
2025-03-13 14:43:07,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:07,393 [INFO]: 	Creating the index 03/13/2025, 14:43:07
2025-03-13 14:43:07,393 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:07
2025-03-13 14:43:07,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 14:43:07,395 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:07
2025-03-13 14:43:07,395 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:43:07,395 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.05it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.72it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.18it/s]100%|██████████| 13/13 [00:02<00:00,  5.72it/s]
2025-03-13 14:43:09,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:09
2025-03-13 14:43:49,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0220 secs
2025-03-13 14:43:49,697 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 14:43:49,697 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-13 14:44:08,763 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0662 secs
2025-03-13 14:44:09,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7514 secs
2025-03-13 14:44:09,147 [INFO]: {
2025-03-13 14:44:09,147 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:09,147 [INFO]: 	index_param: efSearch=243
2025-03-13 14:44:09,147 [INFO]: 	index_path: knn.index
2025-03-13 14:44:09,147 [INFO]: 	size in bytes: 602626270
2025-03-13 14:44:09,147 [INFO]: 	avg_search_speed_ms: 9.472168633223962
2025-03-13 14:44:09,147 [INFO]: 	99p_search_speed_ms: 13.361890183296055
2025-03-13 14:44:09,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:09,147 [INFO]: 	nb vectors: 3063
2025-03-13 14:44:09,147 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:09,147 [INFO]: 	compression ratio: 0.9993097446614798
2025-03-13 14:44:09,148 [INFO]: }
2025-03-13 14:44:09,148 [INFO]: 	>>> Finished "Creating the index" in 61.7544 secs
2025-03-13 14:44:09,148 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7903 secs
2025-03-13 14:44:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 44689 [episode count 8/20]
[retrieval_preprocessing] for episode 82630 [episode count 9/20], we have num_retrieval=np.int64(3024) num_query=np.int64(164)
2025-03-13 14:44:11,232 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:11,832 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:11
2025-03-13 14:44:11,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-13 14:44:11,872 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 14:44:11,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-13 14:44:11,872 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:11
2025-03-13 14:44:11,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:11,873 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:44:11,873 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:11,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:44:11,873 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:11
2025-03-13 14:44:11,873 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:11,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:11,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:11
2025-03-13 14:44:11,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:11,874 [INFO]: 	Creating the index 03/13/2025, 14:44:11
2025-03-13 14:44:11,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:11
2025-03-13 14:44:11,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 14:44:11,878 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:11
2025-03-13 14:44:11,879 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:44:11,879 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.56it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.83it/s] 75%|███████▌  | 9/12 [00:00<00:00, 30.52it/s]100%|██████████| 12/12 [00:02<00:00,  4.15it/s]
2025-03-13 14:44:14,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:14
2025-03-13 14:44:51,707 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9303 secs
2025-03-13 14:44:51,708 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 14:44:51,708 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.66it/s]
2025-03-13 14:45:06,040 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3324 secs
2025-03-13 14:45:06,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1643 secs
2025-03-13 14:45:06,043 [INFO]: {
2025-03-13 14:45:06,043 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:06,043 [INFO]: 	index_param: efSearch=222
2025-03-13 14:45:06,043 [INFO]: 	index_path: knn.index
2025-03-13 14:45:06,043 [INFO]: 	size in bytes: 594953170
2025-03-13 14:45:06,043 [INFO]: 	avg_search_speed_ms: 11.0203799517776
2025-03-13 14:45:06,043 [INFO]: 	99p_search_speed_ms: 18.03255568258464
2025-03-13 14:45:06,043 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:06,043 [INFO]: 	nb vectors: 3024
2025-03-13 14:45:06,043 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:06,043 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 14:45:06,043 [INFO]: }
2025-03-13 14:45:06,043 [INFO]: 	>>> Finished "Creating the index" in 54.1687 secs
2025-03-13 14:45:06,043 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2113 secs
2025-03-13 14:45:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 82630 [episode count 9/20]
[retrieval_preprocessing] for episode 9988 [episode count 10/20], we have num_retrieval=np.int64(3044) num_query=np.int64(144)
2025-03-13 14:45:07,933 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:09,051 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:09
2025-03-13 14:45:09,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 934.98it/s]
2025-03-13 14:45:09,109 [INFO]: There are 3044 embeddings of dim 49152
2025-03-13 14:45:09,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0580 secs
2025-03-13 14:45:09,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:09
2025-03-13 14:45:09,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:09,110 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:45:09,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:09,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:45:09,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:09
2025-03-13 14:45:09,111 [INFO]: 628.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:09,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:45:09,111 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:09
2025-03-13 14:45:09,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:09,112 [INFO]: 	Creating the index 03/13/2025, 14:45:09
2025-03-13 14:45:09,112 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:09
2025-03-13 14:45:09,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 14:45:09,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:09
2025-03-13 14:45:09,116 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:45:09,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.00it/s] 33%|███▎      | 4/12 [00:00<00:00, 20.64it/s] 67%|██████▋   | 8/12 [00:00<00:00, 25.41it/s]100%|██████████| 12/12 [00:03<00:00,  2.77it/s]100%|██████████| 12/12 [00:03<00:00,  3.66it/s]
2025-03-13 14:45:12,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:12
2025-03-13 14:45:50,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7043 secs
2025-03-13 14:45:50,108 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 14:45:50,108 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.13it/s]
2025-03-13 14:46:06,350 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2424 secs
2025-03-13 14:46:06,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2366 secs
2025-03-13 14:46:06,353 [INFO]: {
2025-03-13 14:46:06,353 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:06,353 [INFO]: 	index_param: efSearch=205
2025-03-13 14:46:06,353 [INFO]: 	index_path: knn.index
2025-03-13 14:46:06,353 [INFO]: 	size in bytes: 598888030
2025-03-13 14:46:06,353 [INFO]: 	avg_search_speed_ms: 9.387230613499558
2025-03-13 14:46:06,353 [INFO]: 	99p_search_speed_ms: 12.28908359771594
2025-03-13 14:46:06,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:06,353 [INFO]: 	nb vectors: 3044
2025-03-13 14:46:06,353 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:06,353 [INFO]: 	compression ratio: 0.9993099244277766
2025-03-13 14:46:06,353 [INFO]: }
2025-03-13 14:46:06,353 [INFO]: 	>>> Finished "Creating the index" in 57.2410 secs
2025-03-13 14:46:06,353 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3020 secs
2025-03-13 14:46:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 9988 [episode count 10/20]
[retrieval_preprocessing] for episode 62185 [episode count 11/20], we have num_retrieval=np.int64(3052) num_query=np.int64(136)
2025-03-13 14:46:07,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:08,299 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:08
2025-03-13 14:46:08,299 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1764.54it/s]
2025-03-13 14:46:08,328 [INFO]: There are 3052 embeddings of dim 49152
2025-03-13 14:46:08,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:46:08,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:08
2025-03-13 14:46:08,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:08,328 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:46:08,328 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:08,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:46:08,328 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:08
2025-03-13 14:46:08,328 [INFO]: 629.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:08,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:46:08,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:08
2025-03-13 14:46:08,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:08,329 [INFO]: 	Creating the index 03/13/2025, 14:46:08
2025-03-13 14:46:08,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:08
2025-03-13 14:46:08,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:46:08,330 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:08
2025-03-13 14:46:08,330 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:46:08,330 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.43it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.67it/s] 85%|████████▍ | 11/13 [00:00<00:00, 39.05it/s]100%|██████████| 13/13 [00:02<00:00,  5.34it/s]
2025-03-13 14:46:10,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:10
2025-03-13 14:46:52,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7252 secs
2025-03-13 14:46:52,493 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 14:46:52,493 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 14:47:11,744 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2514 secs
2025-03-13 14:47:11,746 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4163 secs
2025-03-13 14:47:11,746 [INFO]: {
2025-03-13 14:47:11,746 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:11,746 [INFO]: 	index_param: efSearch=149
2025-03-13 14:47:11,746 [INFO]: 	index_path: knn.index
2025-03-13 14:47:11,746 [INFO]: 	size in bytes: 600461950
2025-03-13 14:47:11,746 [INFO]: 	avg_search_speed_ms: 7.521850313603082
2025-03-13 14:47:11,746 [INFO]: 	99p_search_speed_ms: 10.034624617546797
2025-03-13 14:47:11,746 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:11,746 [INFO]: 	nb vectors: 3052
2025-03-13 14:47:11,746 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:11,746 [INFO]: 	compression ratio: 0.9993099745953927
2025-03-13 14:47:11,746 [INFO]: }
2025-03-13 14:47:11,746 [INFO]: 	>>> Finished "Creating the index" in 63.4177 secs
2025-03-13 14:47:11,746 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4468 secs
2025-03-13 14:47:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 62185 [episode count 11/20]
[retrieval_preprocessing] for episode 37186 [episode count 12/20], we have num_retrieval=np.int64(3026) num_query=np.int64(162)
2025-03-13 14:47:12,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:13,313 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:13
2025-03-13 14:47:13,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-13 14:47:13,341 [INFO]: There are 3026 embeddings of dim 49152
2025-03-13 14:47:13,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 14:47:13,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:13
2025-03-13 14:47:13,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:13,342 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:47:13,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:13,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:13,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:13
2025-03-13 14:47:13,342 [INFO]: 624.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:13,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:47:13,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:13
2025-03-13 14:47:13,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:13,342 [INFO]: 	Creating the index 03/13/2025, 14:47:13
2025-03-13 14:47:13,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:13
2025-03-13 14:47:13,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:47:13,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:13
2025-03-13 14:47:13,343 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:47:13,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.07it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.79it/s]100%|██████████| 12/12 [00:02<00:00,  3.87it/s]100%|██████████| 12/12 [00:02<00:00,  4.73it/s]
2025-03-13 14:47:15,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:15
2025-03-13 14:47:50,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4157 secs
2025-03-13 14:47:50,302 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 14:47:50,303 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 14:48:13,452 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1495 secs
2025-03-13 14:48:13,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1113 secs
2025-03-13 14:48:13,455 [INFO]: {
2025-03-13 14:48:13,455 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:13,455 [INFO]: 	index_param: efSearch=185
2025-03-13 14:48:13,455 [INFO]: 	index_path: knn.index
2025-03-13 14:48:13,455 [INFO]: 	size in bytes: 595346650
2025-03-13 14:48:13,455 [INFO]: 	avg_search_speed_ms: 8.832892674505183
2025-03-13 14:48:13,455 [INFO]: 	99p_search_speed_ms: 11.63636688841507
2025-03-13 14:48:13,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:13,455 [INFO]: 	nb vectors: 3026
2025-03-13 14:48:13,455 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:13,455 [INFO]: 	compression ratio: 0.9993099112928577
2025-03-13 14:48:13,455 [INFO]: }
2025-03-13 14:48:13,455 [INFO]: 	>>> Finished "Creating the index" in 60.1129 secs
2025-03-13 14:48:13,455 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1422 secs
2025-03-13 14:48:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 37186 [episode count 12/20]
[retrieval_preprocessing] for episode 13644 [episode count 13/20], we have num_retrieval=np.int64(3028) num_query=np.int64(160)
2025-03-13 14:48:16,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:16,773 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:16
2025-03-13 14:48:16,773 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.92it/s]
2025-03-13 14:48:16,806 [INFO]: There are 3028 embeddings of dim 49152
2025-03-13 14:48:16,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 14:48:16,807 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:16,807 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:48:16,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:16,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:48:16,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,807 [INFO]: 624.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:16,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:48:16,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:16
2025-03-13 14:48:16,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:16,807 [INFO]: 	Creating the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:16
2025-03-13 14:48:16,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:48:16,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,808 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:48:16,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.89it/s] 50%|█████     | 6/12 [00:00<00:00, 27.88it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.45it/s]100%|██████████| 12/12 [00:03<00:00,  3.12it/s]
2025-03-13 14:48:20,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:20
2025-03-13 14:48:54,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6783 secs
2025-03-13 14:48:54,341 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 14:48:54,341 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 14:49:17,885 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5435 secs
2025-03-13 14:49:17,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0789 secs
2025-03-13 14:49:17,887 [INFO]: {
2025-03-13 14:49:17,887 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:17,887 [INFO]: 	index_param: efSearch=167
2025-03-13 14:49:17,887 [INFO]: 	index_path: knn.index
2025-03-13 14:49:17,887 [INFO]: 	size in bytes: 595740130
2025-03-13 14:49:17,887 [INFO]: 	avg_search_speed_ms: 6.964434323829798
2025-03-13 14:49:17,887 [INFO]: 	99p_search_speed_ms: 9.835817897692323
2025-03-13 14:49:17,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:17,887 [INFO]: 	nb vectors: 3028
2025-03-13 14:49:17,887 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:17,887 [INFO]: 	compression ratio: 0.999309923942844
2025-03-13 14:49:17,887 [INFO]: }
2025-03-13 14:49:17,887 [INFO]: 	>>> Finished "Creating the index" in 61.0803 secs
2025-03-13 14:49:17,887 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1140 secs
2025-03-13 14:49:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 13644 [episode count 13/20]
[retrieval_preprocessing] for episode 47961 [episode count 14/20], we have num_retrieval=np.int64(3028) num_query=np.int64(160)
2025-03-13 14:49:19,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:19,620 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:19
2025-03-13 14:49:19,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.97it/s]
2025-03-13 14:49:19,648 [INFO]: There are 3028 embeddings of dim 49152
2025-03-13 14:49:19,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 14:49:19,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:19,648 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:49:19,648 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:19,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:19,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,649 [INFO]: 624.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:19,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:19,649 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:19
2025-03-13 14:49:19,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:19,649 [INFO]: 	Creating the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,649 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:19
2025-03-13 14:49:19,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:49:19,650 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:19
2025-03-13 14:49:19,650 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:49:19,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.54it/s] 50%|█████     | 6/12 [00:00<00:00, 32.15it/s] 92%|█████████▏| 11/12 [00:00<00:00, 40.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]
2025-03-13 14:49:22,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:22
2025-03-13 14:49:50,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9532 secs
2025-03-13 14:49:50,123 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 14:49:50,123 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 14:50:10,059 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9361 secs
2025-03-13 14:50:10,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4119 secs
2025-03-13 14:50:10,062 [INFO]: {
2025-03-13 14:50:10,062 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:10,062 [INFO]: 	index_param: efSearch=230
2025-03-13 14:50:10,062 [INFO]: 	index_path: knn.index
2025-03-13 14:50:10,062 [INFO]: 	size in bytes: 595740130
2025-03-13 14:50:10,062 [INFO]: 	avg_search_speed_ms: 9.459379609957661
2025-03-13 14:50:10,062 [INFO]: 	99p_search_speed_ms: 12.188812035601588
2025-03-13 14:50:10,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:10,062 [INFO]: 	nb vectors: 3028
2025-03-13 14:50:10,062 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:10,062 [INFO]: 	compression ratio: 0.999309923942844
2025-03-13 14:50:10,062 [INFO]: }
2025-03-13 14:50:10,062 [INFO]: 	>>> Finished "Creating the index" in 50.4134 secs
2025-03-13 14:50:10,062 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4422 secs
2025-03-13 14:50:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 47961 [episode count 14/20]
[retrieval_preprocessing] for episode 22948 [episode count 15/20], we have num_retrieval=np.int64(3024) num_query=np.int64(164)
2025-03-13 14:50:12,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:13,305 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:13
2025-03-13 14:50:13,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1801.68it/s]
2025-03-13 14:50:13,455 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 14:50:13,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1506 secs
2025-03-13 14:50:13,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:13,456 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:50:13,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:13,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:50:13,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,456 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:13,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:50:13,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:13
2025-03-13 14:50:13,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:13,457 [INFO]: 	Creating the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:13
2025-03-13 14:50:13,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 14:50:13,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,459 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:50:13,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.31it/s] 50%|█████     | 6/12 [00:00<00:00, 28.63it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.85it/s]
2025-03-13 14:50:16,580 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:16
2025-03-13 14:50:55,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9331 secs
2025-03-13 14:50:55,514 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 14:50:55,514 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 14:51:15,103 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5882 secs
2025-03-13 14:51:15,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6458 secs
2025-03-13 14:51:15,105 [INFO]: {
2025-03-13 14:51:15,105 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:15,105 [INFO]: 	index_param: efSearch=134
2025-03-13 14:51:15,105 [INFO]: 	index_path: knn.index
2025-03-13 14:51:15,105 [INFO]: 	size in bytes: 594953170
2025-03-13 14:51:15,105 [INFO]: 	avg_search_speed_ms: 6.697880759322485
2025-03-13 14:51:15,105 [INFO]: 	99p_search_speed_ms: 8.77658347599208
2025-03-13 14:51:15,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:15,105 [INFO]: 	nb vectors: 3024
2025-03-13 14:51:15,105 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:15,105 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 14:51:15,105 [INFO]: }
2025-03-13 14:51:15,105 [INFO]: 	>>> Finished "Creating the index" in 61.6485 secs
2025-03-13 14:51:15,105 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8004 secs
2025-03-13 14:51:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 22948 [episode count 15/20]
[retrieval_preprocessing] for episode 67022 [episode count 16/20], we have num_retrieval=np.int64(3020) num_query=np.int64(168)
2025-03-13 14:51:16,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:16,749 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:16
2025-03-13 14:51:16,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2169.84it/s]
2025-03-13 14:51:16,778 [INFO]: There are 3020 embeddings of dim 49152
2025-03-13 14:51:16,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:51:16,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:16
2025-03-13 14:51:16,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:16,778 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:51:16,778 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:16,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:16,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:16
2025-03-13 14:51:16,778 [INFO]: 623.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:16,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:16,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:16
2025-03-13 14:51:16,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:16,779 [INFO]: 	Creating the index 03/13/2025, 14:51:16
2025-03-13 14:51:16,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:16
2025-03-13 14:51:16,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:51:16,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:16
2025-03-13 14:51:16,780 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:51:16,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.78it/s] 50%|█████     | 6/12 [00:00<00:00, 25.24it/s] 83%|████████▎ | 10/12 [00:00<00:00, 30.50it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]
2025-03-13 14:51:19,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:19
2025-03-13 14:51:59,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6394 secs
2025-03-13 14:51:59,938 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 14:51:59,938 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 14:52:23,954 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0157 secs
2025-03-13 14:52:23,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1760 secs
2025-03-13 14:52:23,956 [INFO]: {
2025-03-13 14:52:23,956 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:23,956 [INFO]: 	index_param: efSearch=189
2025-03-13 14:52:23,956 [INFO]: 	index_path: knn.index
2025-03-13 14:52:23,956 [INFO]: 	size in bytes: 594166210
2025-03-13 14:52:23,956 [INFO]: 	avg_search_speed_ms: 8.121873735708741
2025-03-13 14:52:23,956 [INFO]: 	99p_search_speed_ms: 13.9491859823466
2025-03-13 14:52:23,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:23,956 [INFO]: 	nb vectors: 3020
2025-03-13 14:52:23,956 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:23,956 [INFO]: 	compression ratio: 0.999309873242371
2025-03-13 14:52:23,956 [INFO]: }
2025-03-13 14:52:23,956 [INFO]: 	>>> Finished "Creating the index" in 67.1776 secs
2025-03-13 14:52:23,956 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2067 secs
2025-03-13 14:52:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67022 [episode count 16/20]
[retrieval_preprocessing] for episode 73186 [episode count 17/20], we have num_retrieval=np.int64(3036) num_query=np.int64(152)
2025-03-13 14:52:25,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:26,324 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:26
2025-03-13 14:52:26,324 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.85it/s]
2025-03-13 14:52:26,356 [INFO]: There are 3036 embeddings of dim 49152
2025-03-13 14:52:26,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 14:52:26,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:26
2025-03-13 14:52:26,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:26,356 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:52:26,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:26,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:26,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:26
2025-03-13 14:52:26,356 [INFO]: 626.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:26,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:52:26,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:26
2025-03-13 14:52:26,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:26,357 [INFO]: 	Creating the index 03/13/2025, 14:52:26
2025-03-13 14:52:26,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:26
2025-03-13 14:52:26,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:52:26,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:26
2025-03-13 14:52:26,358 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:52:26,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.67it/s] 50%|█████     | 6/12 [00:00<00:00, 30.66it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.97it/s]100%|██████████| 12/12 [00:02<00:00,  5.16it/s]
2025-03-13 14:52:28,687 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:28
2025-03-13 14:53:06,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5937 secs
2025-03-13 14:53:06,282 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 14:53:06,282 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-13 14:53:29,318 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0362 secs
2025-03-13 14:53:29,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9633 secs
2025-03-13 14:53:29,321 [INFO]: {
2025-03-13 14:53:29,321 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:29,321 [INFO]: 	index_param: efSearch=273
2025-03-13 14:53:29,321 [INFO]: 	index_path: knn.index
2025-03-13 14:53:29,321 [INFO]: 	size in bytes: 597314110
2025-03-13 14:53:29,321 [INFO]: 	avg_search_speed_ms: 12.088226050966316
2025-03-13 14:53:29,321 [INFO]: 	99p_search_speed_ms: 16.778431299608204
2025-03-13 14:53:29,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:29,321 [INFO]: 	nb vectors: 3036
2025-03-13 14:53:29,321 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:29,321 [INFO]: 	compression ratio: 0.9993098739957775
2025-03-13 14:53:29,321 [INFO]: }
2025-03-13 14:53:29,321 [INFO]: 	>>> Finished "Creating the index" in 62.9649 secs
2025-03-13 14:53:29,321 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9970 secs
2025-03-13 14:53:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 73186 [episode count 17/20]
[retrieval_preprocessing] for episode 37352 [episode count 18/20], we have num_retrieval=np.int64(3035) num_query=np.int64(153)
2025-03-13 14:53:31,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:32,198 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:32
2025-03-13 14:53:32,198 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2067.18it/s]
2025-03-13 14:53:32,227 [INFO]: There are 3035 embeddings of dim 49152
2025-03-13 14:53:32,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 14:53:32,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:32,228 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:53:32,228 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:32,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:32,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,228 [INFO]: 626.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:32,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:32,228 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:32
2025-03-13 14:53:32,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:32,228 [INFO]: 	Creating the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:32
2025-03-13 14:53:32,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:32,229 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,229 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:53:32,229 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.64it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.75it/s]100%|██████████| 12/12 [00:02<00:00,  3.62it/s]100%|██████████| 12/12 [00:02<00:00,  4.42it/s]
2025-03-13 14:53:35,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:35
2025-03-13 14:54:12,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0093 secs
2025-03-13 14:54:12,325 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 14:54:12,325 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s]
2025-03-13 14:54:34,756 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4310 secs
2025-03-13 14:54:34,760 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5305 secs
2025-03-13 14:54:34,760 [INFO]: {
2025-03-13 14:54:34,760 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:34,760 [INFO]: 	index_param: efSearch=287
2025-03-13 14:54:34,760 [INFO]: 	index_path: knn.index
2025-03-13 14:54:34,760 [INFO]: 	size in bytes: 597117370
2025-03-13 14:54:34,760 [INFO]: 	avg_search_speed_ms: 15.006736700609885
2025-03-13 14:54:34,760 [INFO]: 	99p_search_speed_ms: 22.306537965778272
2025-03-13 14:54:34,760 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:34,760 [INFO]: 	nb vectors: 3035
2025-03-13 14:54:34,760 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:34,760 [INFO]: 	compression ratio: 0.999309867673084
2025-03-13 14:54:34,760 [INFO]: }
2025-03-13 14:54:34,760 [INFO]: 	>>> Finished "Creating the index" in 62.5321 secs
2025-03-13 14:54:34,760 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5622 secs
2025-03-13 14:54:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 37352 [episode count 18/20]
[retrieval_preprocessing] for episode 40940 [episode count 19/20], we have num_retrieval=np.int64(3022) num_query=np.int64(166)
2025-03-13 14:54:38,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:39,222 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:39
2025-03-13 14:54:39,222 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.03it/s]
2025-03-13 14:54:39,258 [INFO]: There are 3022 embeddings of dim 49152
2025-03-13 14:54:39,258 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 14:54:39,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:39,259 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:54:39,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:39,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:54:39,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,259 [INFO]: 623.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:39,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:54:39,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:39
2025-03-13 14:54:39,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:39,260 [INFO]: 	Creating the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:39
2025-03-13 14:54:39,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:54:39,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,263 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:54:39,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.02it/s] 50%|█████     | 6/12 [00:00<00:00, 26.00it/s] 83%|████████▎ | 10/12 [00:00<00:00, 30.53it/s]100%|██████████| 12/12 [00:03<00:00,  3.04it/s]
2025-03-13 14:54:43,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:43
2025-03-13 14:55:29,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2234 secs
2025-03-13 14:55:29,437 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 14:55:29,437 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.19it/s]
2025-03-13 14:56:14,460 [INFO]: 	>>> Finished "Compute fast metrics" in 45.0233 secs
2025-03-13 14:56:14,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.1997 secs
2025-03-13 14:56:14,463 [INFO]: {
2025-03-13 14:56:14,463 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:14,463 [INFO]: 	index_param: efSearch=258
2025-03-13 14:56:14,463 [INFO]: 	index_path: knn.index
2025-03-13 14:56:14,463 [INFO]: 	size in bytes: 594559690
2025-03-13 14:56:14,463 [INFO]: 	avg_search_speed_ms: 14.734452069477783
2025-03-13 14:56:14,463 [INFO]: 	99p_search_speed_ms: 24.36720076948406
2025-03-13 14:56:14,463 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:14,463 [INFO]: 	nb vectors: 3022
2025-03-13 14:56:14,463 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:14,463 [INFO]: 	compression ratio: 0.9993098859426545
2025-03-13 14:56:14,463 [INFO]: }
2025-03-13 14:56:14,463 [INFO]: 	>>> Finished "Creating the index" in 95.2034 secs
2025-03-13 14:56:14,463 [INFO]: >>> Finished "Launching the whole pipeline" in 95.2413 secs
2025-03-13 14:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 40940 [episode count 19/20]
2025-03-13 14:56:16: [retrieval_preprocessing] finished for 4345518188_remove_lid_from_pot [chosen_id count 0/196]
2025-03-13 14:56:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4345518188_hang_cloth_on_stand [chosen_id count 1/196]
2025-03-13 14:56:18: [retrieval_preprocessing] we have num_total=4585 embedding_dim=49152
[retrieval_preprocessing] for episode 65034 [episode count 0/20], we have num_retrieval=np.int64(4362) num_query=np.int64(223)
2025-03-13 14:56:19,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:20,500 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:20
2025-03-13 14:56:20,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 968.66it/s]
2025-03-13 14:56:20,537 [INFO]: There are 4362 embeddings of dim 49152
2025-03-13 14:56:20,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 14:56:20,538 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,538 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:20,538 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 14:56:20,538 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:20,538 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:56:20,538 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,538 [INFO]: 900.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:20,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:56:20,538 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:20
2025-03-13 14:56:20,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:20,538 [INFO]: 	Creating the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,538 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:20
2025-03-13 14:56:20,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:56:20,540 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,540 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:56:20,540 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:04<01:15,  4.43s/it] 33%|███▎      | 6/18 [00:04<00:06,  1.77it/s] 50%|█████     | 9/18 [00:05<00:03,  2.46it/s] 72%|███████▏  | 13/18 [00:05<00:01,  4.25it/s] 94%|█████████▍| 17/18 [00:05<00:00,  6.52it/s]100%|██████████| 18/18 [00:09<00:00,  1.86it/s]
2025-03-13 14:56:30,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:30
2025-03-13 14:57:20,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7305 secs
2025-03-13 14:57:20,942 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 14:57:20,942 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.26s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.58s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.76s/it]
2025-03-13 14:58:00,660 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7181 secs
2025-03-13 14:58:00,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.2282 secs
2025-03-13 14:58:00,768 [INFO]: {
2025-03-13 14:58:00,769 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:00,769 [INFO]: 	index_param: efSearch=152
2025-03-13 14:58:00,769 [INFO]: 	index_path: knn.index
2025-03-13 14:58:00,769 [INFO]: 	size in bytes: 858197470
2025-03-13 14:58:00,769 [INFO]: 	avg_search_speed_ms: 10.357726319774013
2025-03-13 14:58:00,769 [INFO]: 	99p_search_speed_ms: 17.607714748010046
2025-03-13 14:58:00,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:00,769 [INFO]: 	nb vectors: 4362
2025-03-13 14:58:00,769 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:00,769 [INFO]: 	compression ratio: 0.9993085810425426
2025-03-13 14:58:00,769 [INFO]: }
2025-03-13 14:58:00,769 [INFO]: 	>>> Finished "Creating the index" in 100.2310 secs
2025-03-13 14:58:00,769 [INFO]: >>> Finished "Launching the whole pipeline" in 100.2695 secs
2025-03-13 14:58:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 65034 [episode count 0/20]
[retrieval_preprocessing] for episode 71712 [episode count 1/20], we have num_retrieval=np.int64(4078) num_query=np.int64(507)
2025-03-13 14:58:03,350 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:04,252 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:04
2025-03-13 14:58:04,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.46it/s]
2025-03-13 14:58:04,281 [INFO]: There are 4078 embeddings of dim 49152
2025-03-13 14:58:04,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 14:58:04,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:04
2025-03-13 14:58:04,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:04,282 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 14:58:04,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:04,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:04,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:04
2025-03-13 14:58:04,282 [INFO]: 841.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:04,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:04,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:04
2025-03-13 14:58:04,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:04,282 [INFO]: 	Creating the index 03/13/2025, 14:58:04
2025-03-13 14:58:04,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:04
2025-03-13 14:58:04,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:58:04,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:04
2025-03-13 14:58:04,284 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:58:04,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.43it/s] 29%|██▉       | 5/17 [00:00<00:00, 23.18it/s] 53%|█████▎    | 9/17 [00:00<00:00, 28.61it/s] 76%|███████▋  | 13/17 [00:00<00:00, 30.95it/s]100%|██████████| 17/17 [00:05<00:00,  1.90it/s]100%|██████████| 17/17 [00:05<00:00,  2.97it/s]
2025-03-13 14:58:10,006 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:10
2025-03-13 14:59:04,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8985 secs
2025-03-13 14:59:04,905 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 14:59:04,905 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 14:59:38,313 [INFO]: 	>>> Finished "Compute fast metrics" in 33.4080 secs
2025-03-13 14:59:38,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.0327 secs
2025-03-13 14:59:38,317 [INFO]: {
2025-03-13 14:59:38,317 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:38,317 [INFO]: 	index_param: efSearch=230
2025-03-13 14:59:38,317 [INFO]: 	index_path: knn.index
2025-03-13 14:59:38,317 [INFO]: 	size in bytes: 802322110
2025-03-13 14:59:38,317 [INFO]: 	avg_search_speed_ms: 12.682322015235123
2025-03-13 14:59:38,317 [INFO]: 	99p_search_speed_ms: 18.302825214341283
2025-03-13 14:59:38,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:38,317 [INFO]: 	nb vectors: 4078
2025-03-13 14:59:38,317 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:38,317 [INFO]: 	compression ratio: 0.9993086492406398
2025-03-13 14:59:38,317 [INFO]: }
2025-03-13 14:59:38,317 [INFO]: 	>>> Finished "Creating the index" in 94.0344 secs
2025-03-13 14:59:38,317 [INFO]: >>> Finished "Launching the whole pipeline" in 94.0647 secs
2025-03-13 14:59:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 71712 [episode count 1/20]
[retrieval_preprocessing] for episode 41017 [episode count 2/20], we have num_retrieval=np.int64(4350) num_query=np.int64(235)
2025-03-13 14:59:45,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:46,470 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:46
2025-03-13 14:59:46,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.17it/s]
2025-03-13 14:59:46,498 [INFO]: There are 4350 embeddings of dim 49152
2025-03-13 14:59:46,498 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 14:59:46,498 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:46
2025-03-13 14:59:46,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:46,498 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 14:59:46,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:46,499 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:46,499 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:46
2025-03-13 14:59:46,499 [INFO]: 897.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:46,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:46,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:46
2025-03-13 14:59:46,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:46,499 [INFO]: 	Creating the index 03/13/2025, 14:59:46
2025-03-13 14:59:46,499 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:46
2025-03-13 14:59:46,500 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:59:46,500 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:46
2025-03-13 14:59:46,501 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:59:46,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.60it/s] 22%|██▏       | 4/18 [00:00<00:00, 14.41it/s] 44%|████▍     | 8/18 [00:00<00:00, 22.43it/s] 67%|██████▋   | 12/18 [00:00<00:00, 26.33it/s] 89%|████████▉ | 16/18 [00:00<00:00, 27.86it/s]100%|██████████| 18/18 [00:06<00:00,  2.71it/s]
2025-03-13 14:59:53,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:53
2025-03-13 15:00:44,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8847 secs
2025-03-13 15:00:44,029 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:00:44,029 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.16it/s]
2025-03-13 15:01:03,783 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7538 secs
2025-03-13 15:01:03,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.2862 secs
2025-03-13 15:01:03,787 [INFO]: {
2025-03-13 15:01:03,787 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:03,787 [INFO]: 	index_param: efSearch=201
2025-03-13 15:01:03,787 [INFO]: 	index_path: knn.index
2025-03-13 15:01:03,787 [INFO]: 	size in bytes: 855836590
2025-03-13 15:01:03,787 [INFO]: 	avg_search_speed_ms: 13.132353306545086
2025-03-13 15:01:03,787 [INFO]: 	99p_search_speed_ms: 30.76065857196226
2025-03-13 15:01:03,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:03,787 [INFO]: 	nb vectors: 4350
2025-03-13 15:01:03,787 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:03,787 [INFO]: 	compression ratio: 0.9993085245397139
2025-03-13 15:01:03,787 [INFO]: }
2025-03-13 15:01:03,787 [INFO]: 	>>> Finished "Creating the index" in 77.2881 secs
2025-03-13 15:01:03,787 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3167 secs
2025-03-13 15:01:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 41017 [episode count 2/20]
[retrieval_preprocessing] for episode 75817 [episode count 3/20], we have num_retrieval=np.int64(4419) num_query=np.int64(166)
2025-03-13 15:01:07,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:07,858 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:07
2025-03-13 15:01:07,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-13 15:01:07,882 [INFO]: There are 4419 embeddings of dim 49152
2025-03-13 15:01:07,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:01:07,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:07
2025-03-13 15:01:07,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:07,883 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:01:07,883 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:07,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:01:07,883 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:07
2025-03-13 15:01:07,883 [INFO]: 912.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:07,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:01:07,883 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:07
2025-03-13 15:01:07,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:07,883 [INFO]: 	Creating the index 03/13/2025, 15:01:07
2025-03-13 15:01:07,883 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:07
2025-03-13 15:01:07,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:01:07,885 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:07
2025-03-13 15:01:07,885 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:01:07,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.94it/s] 28%|██▊       | 5/18 [00:00<00:00, 22.92it/s] 50%|█████     | 9/18 [00:00<00:00, 29.11it/s] 72%|███████▏  | 13/18 [00:00<00:00, 31.87it/s] 94%|█████████▍| 17/18 [00:00<00:00, 32.94it/s]100%|██████████| 18/18 [00:05<00:00,  3.26it/s]
2025-03-13 15:01:13,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:13
2025-03-13 15:02:02,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7102 secs
2025-03-13 15:02:02,123 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:02:02,124 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 15:02:37,889 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7648 secs
2025-03-13 15:02:37,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.0090 secs
2025-03-13 15:02:37,894 [INFO]: {
2025-03-13 15:02:37,894 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:37,894 [INFO]: 	index_param: efSearch=214
2025-03-13 15:02:37,894 [INFO]: 	index_path: knn.index
2025-03-13 15:02:37,894 [INFO]: 	size in bytes: 869411890
2025-03-13 15:02:37,894 [INFO]: 	avg_search_speed_ms: 15.27880905267164
2025-03-13 15:02:37,894 [INFO]: 	99p_search_speed_ms: 24.973062709905232
2025-03-13 15:02:37,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:37,894 [INFO]: 	nb vectors: 4419
2025-03-13 15:02:37,894 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:37,894 [INFO]: 	compression ratio: 0.9993085693824593
2025-03-13 15:02:37,894 [INFO]: }
2025-03-13 15:02:37,894 [INFO]: 	>>> Finished "Creating the index" in 90.0107 secs
2025-03-13 15:02:37,894 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0362 secs
2025-03-13 15:02:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 75817 [episode count 3/20]
[retrieval_preprocessing] for episode 63557 [episode count 4/20], we have num_retrieval=np.int64(4342) num_query=np.int64(243)
2025-03-13 15:02:41,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:42,340 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:42
2025-03-13 15:02:42,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-13 15:02:42,368 [INFO]: There are 4342 embeddings of dim 49152
2025-03-13 15:02:42,369 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:02:42,369 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:42,370 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:02:42,370 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:42,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:02:42,370 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,370 [INFO]: 896.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:42,371 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:02:42,371 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:42
2025-03-13 15:02:42,371 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:42,371 [INFO]: 	Creating the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,372 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:42
2025-03-13 15:02:42,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:02:42,375 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,375 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:02:42,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.29it/s] 28%|██▊       | 5/18 [00:00<00:00, 21.22it/s] 50%|█████     | 9/18 [00:00<00:00, 27.97it/s] 72%|███████▏  | 13/18 [00:00<00:00, 30.54it/s] 94%|█████████▍| 17/18 [00:00<00:00, 31.42it/s]100%|██████████| 18/18 [00:06<00:00,  2.59it/s]
2025-03-13 15:02:49,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:49
2025-03-13 15:03:42,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6650 secs
2025-03-13 15:03:42,997 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 15:03:42,997 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.60it/s]
2025-03-13 15:04:09,221 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2233 secs
2025-03-13 15:04:09,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.8493 secs
2025-03-13 15:04:09,225 [INFO]: {
2025-03-13 15:04:09,225 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:09,225 [INFO]: 	index_param: efSearch=181
2025-03-13 15:04:09,225 [INFO]: 	index_path: knn.index
2025-03-13 15:04:09,225 [INFO]: 	size in bytes: 854262550
2025-03-13 15:04:09,225 [INFO]: 	avg_search_speed_ms: 15.104112706676103
2025-03-13 15:04:09,225 [INFO]: 	99p_search_speed_ms: 20.805184000637382
2025-03-13 15:04:09,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:09,225 [INFO]: 	nb vectors: 4342
2025-03-13 15:04:09,225 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:09,225 [INFO]: 	compression ratio: 0.9993086270725552
2025-03-13 15:04:09,225 [INFO]: }
2025-03-13 15:04:09,225 [INFO]: 	>>> Finished "Creating the index" in 86.8533 secs
2025-03-13 15:04:09,225 [INFO]: >>> Finished "Launching the whole pipeline" in 86.8846 secs
2025-03-13 15:04:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 63557 [episode count 4/20]
[retrieval_preprocessing] for episode 78926 [episode count 5/20], we have num_retrieval=np.int64(4210) num_query=np.int64(375)
2025-03-13 15:04:12,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:13,408 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:13
2025-03-13 15:04:13,409 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.35it/s]
2025-03-13 15:04:13,439 [INFO]: There are 4210 embeddings of dim 49152
2025-03-13 15:04:13,440 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:04:13,440 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:13
2025-03-13 15:04:13,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:13,440 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:04:13,440 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:13,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:13,440 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:13
2025-03-13 15:04:13,440 [INFO]: 868.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:13,440 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:04:13,440 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:13
2025-03-13 15:04:13,440 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:13,440 [INFO]: 	Creating the index 03/13/2025, 15:04:13
2025-03-13 15:04:13,440 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:13
2025-03-13 15:04:13,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:04:13,441 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:13
2025-03-13 15:04:13,442 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:04:13,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.22it/s] 29%|██▉       | 5/17 [00:00<00:00, 20.74it/s] 53%|█████▎    | 9/17 [00:00<00:00, 25.79it/s] 76%|███████▋  | 13/17 [00:00<00:00, 28.97it/s]100%|██████████| 17/17 [00:04<00:00,  2.45it/s]100%|██████████| 17/17 [00:04<00:00,  3.75it/s]
2025-03-13 15:04:17,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:17
2025-03-13 15:05:05,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0784 secs
2025-03-13 15:05:05,065 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 15:05:05,065 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 15:05:31,286 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2208 secs
2025-03-13 15:05:31,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.8483 secs
2025-03-13 15:05:31,290 [INFO]: {
2025-03-13 15:05:31,290 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:31,290 [INFO]: 	index_param: efSearch=134
2025-03-13 15:05:31,290 [INFO]: 	index_path: knn.index
2025-03-13 15:05:31,290 [INFO]: 	size in bytes: 828292210
2025-03-13 15:05:31,290 [INFO]: 	avg_search_speed_ms: 10.53517562061454
2025-03-13 15:05:31,290 [INFO]: 	99p_search_speed_ms: 17.765601091086864
2025-03-13 15:05:31,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:31,290 [INFO]: 	nb vectors: 4210
2025-03-13 15:05:31,290 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:31,290 [INFO]: 	compression ratio: 0.9993087825853149
2025-03-13 15:05:31,290 [INFO]: }
2025-03-13 15:05:31,290 [INFO]: 	>>> Finished "Creating the index" in 77.8499 secs
2025-03-13 15:05:31,290 [INFO]: >>> Finished "Launching the whole pipeline" in 77.8816 secs
2025-03-13 15:05:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 78926 [episode count 5/20]
[retrieval_preprocessing] for episode 76371 [episode count 6/20], we have num_retrieval=np.int64(4383) num_query=np.int64(202)
2025-03-13 15:05:35,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:36,442 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:36
2025-03-13 15:05:36,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 602.28it/s]
2025-03-13 15:05:36,475 [INFO]: There are 4383 embeddings of dim 49152
2025-03-13 15:05:36,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 15:05:36,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:36
2025-03-13 15:05:36,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:36,476 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:05:36,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:36,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:05:36,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:36
2025-03-13 15:05:36,477 [INFO]: 904.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:36,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:05:36,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:36
2025-03-13 15:05:36,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:36,478 [INFO]: 	Creating the index 03/13/2025, 15:05:36
2025-03-13 15:05:36,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:36
2025-03-13 15:05:36,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:05:36,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:36
2025-03-13 15:05:36,482 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:05:36,483 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.72it/s] 22%|██▏       | 4/18 [00:00<00:00, 17.31it/s] 39%|███▉      | 7/18 [00:00<00:00, 21.34it/s] 56%|█████▌    | 10/18 [00:00<00:00, 23.29it/s] 72%|███████▏  | 13/18 [00:00<00:00, 24.44it/s] 89%|████████▉ | 16/18 [00:00<00:00, 25.12it/s]100%|██████████| 18/18 [00:06<00:00,  2.66it/s]
2025-03-13 15:05:43,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:43
2025-03-13 15:06:31,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6638 secs
2025-03-13 15:06:31,925 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:06:31,925 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 15:07:08,457 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5318 secs
2025-03-13 15:07:08,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.9779 secs
2025-03-13 15:07:08,460 [INFO]: {
2025-03-13 15:07:08,460 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:08,460 [INFO]: 	index_param: efSearch=196
2025-03-13 15:07:08,460 [INFO]: 	index_path: knn.index
2025-03-13 15:07:08,460 [INFO]: 	size in bytes: 862329070
2025-03-13 15:07:08,460 [INFO]: 	avg_search_speed_ms: 13.122276725061727
2025-03-13 15:07:08,460 [INFO]: 	99p_search_speed_ms: 20.359059136826538
2025-03-13 15:07:08,460 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:08,460 [INFO]: 	nb vectors: 4383
2025-03-13 15:07:08,460 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:08,460 [INFO]: 	compression ratio: 0.999308609647127
2025-03-13 15:07:08,460 [INFO]: }
2025-03-13 15:07:08,460 [INFO]: 	>>> Finished "Creating the index" in 91.9820 secs
2025-03-13 15:07:08,461 [INFO]: >>> Finished "Launching the whole pipeline" in 92.0186 secs
2025-03-13 15:07:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 76371 [episode count 6/20]
[retrieval_preprocessing] for episode 19046 [episode count 7/20], we have num_retrieval=np.int64(4394) num_query=np.int64(191)
2025-03-13 15:07:10,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:11,449 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:11
2025-03-13 15:07:11,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 928.15it/s]
2025-03-13 15:07:11,478 [INFO]: There are 4394 embeddings of dim 49152
2025-03-13 15:07:11,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:07:11,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:11
2025-03-13 15:07:11,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:11,478 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:07:11,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:11,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:11,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:11
2025-03-13 15:07:11,478 [INFO]: 906.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:11,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:11,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:11
2025-03-13 15:07:11,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:11,479 [INFO]: 	Creating the index 03/13/2025, 15:07:11
2025-03-13 15:07:11,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:11
2025-03-13 15:07:11,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:07:11,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:11
2025-03-13 15:07:11,480 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:07:11,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.96it/s] 33%|███▎      | 6/18 [00:00<00:00, 26.92it/s] 61%|██████    | 11/18 [00:00<00:00, 33.10it/s] 89%|████████▉ | 16/18 [00:00<00:00, 35.92it/s]100%|██████████| 18/18 [00:04<00:00,  3.81it/s]
2025-03-13 15:07:16,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:16
2025-03-13 15:08:12,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7168 secs
2025-03-13 15:08:12,930 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:08:12,930 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.38it/s]
2025-03-13 15:08:37,954 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0231 secs
2025-03-13 15:08:37,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4774 secs
2025-03-13 15:08:37,958 [INFO]: {
2025-03-13 15:08:37,958 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:37,958 [INFO]: 	index_param: efSearch=192
2025-03-13 15:08:37,958 [INFO]: 	index_path: knn.index
2025-03-13 15:08:37,958 [INFO]: 	size in bytes: 864493210
2025-03-13 15:08:37,958 [INFO]: 	avg_search_speed_ms: 14.727420773664393
2025-03-13 15:08:37,958 [INFO]: 	99p_search_speed_ms: 20.95204757060856
2025-03-13 15:08:37,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:37,958 [INFO]: 	nb vectors: 4394
2025-03-13 15:08:37,958 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:37,958 [INFO]: 	compression ratio: 0.9993086608511361
2025-03-13 15:08:37,958 [INFO]: }
2025-03-13 15:08:37,958 [INFO]: 	>>> Finished "Creating the index" in 86.4793 secs
2025-03-13 15:08:37,958 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5092 secs
2025-03-13 15:08:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 19046 [episode count 7/20]
[retrieval_preprocessing] for episode 61564 [episode count 8/20], we have num_retrieval=np.int64(4422) num_query=np.int64(163)
2025-03-13 15:08:40,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:40,751 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:40
2025-03-13 15:08:40,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1124.48it/s]
2025-03-13 15:08:40,778 [INFO]: There are 4422 embeddings of dim 49152
2025-03-13 15:08:40,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:08:40,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:40
2025-03-13 15:08:40,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:40,778 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:08:40,778 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:40,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:40,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:40
2025-03-13 15:08:40,778 [INFO]: 912.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:40,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:08:40,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:40
2025-03-13 15:08:40,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:40,778 [INFO]: 	Creating the index 03/13/2025, 15:08:40
2025-03-13 15:08:40,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:40
2025-03-13 15:08:40,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:08:40,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:40
2025-03-13 15:08:40,780 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:08:40,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.85it/s] 33%|███▎      | 6/18 [00:00<00:00, 26.22it/s] 61%|██████    | 11/18 [00:00<00:00, 32.56it/s] 89%|████████▉ | 16/18 [00:00<00:00, 36.41it/s]100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
2025-03-13 15:08:45,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:45
2025-03-13 15:09:46,814 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6863 secs
2025-03-13 15:09:46,814 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:09:46,814 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.20it/s]
2025-03-13 15:10:09,809 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9946 secs
2025-03-13 15:10:09,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.0319 secs
2025-03-13 15:10:09,812 [INFO]: {
2025-03-13 15:10:09,812 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:09,812 [INFO]: 	index_param: efSearch=180
2025-03-13 15:10:09,812 [INFO]: 	index_path: knn.index
2025-03-13 15:10:09,812 [INFO]: 	size in bytes: 870002110
2025-03-13 15:10:09,812 [INFO]: 	avg_search_speed_ms: 10.784614546136064
2025-03-13 15:10:09,812 [INFO]: 	99p_search_speed_ms: 16.530992914922535
2025-03-13 15:10:09,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:09,812 [INFO]: 	nb vectors: 4422
2025-03-13 15:10:09,812 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:09,812 [INFO]: 	compression ratio: 0.9993085832860796
2025-03-13 15:10:09,812 [INFO]: }
2025-03-13 15:10:09,812 [INFO]: 	>>> Finished "Creating the index" in 89.0337 secs
2025-03-13 15:10:09,812 [INFO]: >>> Finished "Launching the whole pipeline" in 89.0616 secs
2025-03-13 15:10:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 61564 [episode count 8/20]
[retrieval_preprocessing] for episode 42110 [episode count 9/20], we have num_retrieval=np.int64(4415) num_query=np.int64(170)
2025-03-13 15:10:15,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:16,307 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:16
2025-03-13 15:10:16,307 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.30it/s]
2025-03-13 15:10:16,338 [INFO]: There are 4415 embeddings of dim 49152
2025-03-13 15:10:16,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 15:10:16,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:16
2025-03-13 15:10:16,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:16,340 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:10:16,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:16,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:10:16,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:16
2025-03-13 15:10:16,341 [INFO]: 911.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:16,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:10:16,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:16
2025-03-13 15:10:16,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:16,341 [INFO]: 	Creating the index 03/13/2025, 15:10:16
2025-03-13 15:10:16,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:16
2025-03-13 15:10:16,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 15:10:16,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:16
2025-03-13 15:10:16,346 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:10:16,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:01, 15.90it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.33it/s] 56%|█████▌    | 10/18 [00:00<00:00, 30.71it/s] 78%|███████▊  | 14/18 [00:00<00:00, 32.68it/s]100%|██████████| 18/18 [00:05<00:00,  2.17it/s]100%|██████████| 18/18 [00:05<00:00,  3.50it/s]
2025-03-13 15:10:21,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:21
2025-03-13 15:11:09,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0055 secs
2025-03-13 15:11:09,505 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 15:11:09,505 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.34it/s]
2025-03-13 15:11:32,597 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0921 secs
2025-03-13 15:11:32,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2551 secs
2025-03-13 15:11:32,601 [INFO]: {
2025-03-13 15:11:32,601 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:32,601 [INFO]: 	index_param: efSearch=178
2025-03-13 15:11:32,601 [INFO]: 	index_path: knn.index
2025-03-13 15:11:32,601 [INFO]: 	size in bytes: 868624930
2025-03-13 15:11:32,601 [INFO]: 	avg_search_speed_ms: 12.389955530058515
2025-03-13 15:11:32,601 [INFO]: 	99p_search_speed_ms: 20.694340039044608
2025-03-13 15:11:32,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:32,601 [INFO]: 	nb vectors: 4415
2025-03-13 15:11:32,601 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:32,601 [INFO]: 	compression ratio: 0.999308550814907
2025-03-13 15:11:32,601 [INFO]: }
2025-03-13 15:11:32,601 [INFO]: 	>>> Finished "Creating the index" in 76.2599 secs
2025-03-13 15:11:32,601 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2939 secs
2025-03-13 15:11:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 42110 [episode count 9/20]
[retrieval_preprocessing] for episode 46210 [episode count 10/20], we have num_retrieval=np.int64(4348) num_query=np.int64(237)
2025-03-13 15:11:34,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:35,687 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:35
2025-03-13 15:11:35,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.43it/s]
2025-03-13 15:11:35,713 [INFO]: There are 4348 embeddings of dim 49152
2025-03-13 15:11:35,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:11:35,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:35
2025-03-13 15:11:35,714 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:35,714 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:11:35,714 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:35,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:11:35,714 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:35
2025-03-13 15:11:35,714 [INFO]: 897.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:35,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:35,714 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:35
2025-03-13 15:11:35,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:35,715 [INFO]: 	Creating the index 03/13/2025, 15:11:35
2025-03-13 15:11:35,715 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:35
2025-03-13 15:11:35,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:11:35,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:35
2025-03-13 15:11:35,716 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:11:35,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.66it/s] 22%|██▏       | 4/18 [00:00<00:00, 16.67it/s] 44%|████▍     | 8/18 [00:00<00:00, 24.04it/s] 67%|██████▋   | 12/18 [00:00<00:00, 27.64it/s] 89%|████████▉ | 16/18 [00:00<00:00, 29.76it/s]100%|██████████| 18/18 [00:07<00:00,  2.47it/s]
2025-03-13 15:11:43,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:43
2025-03-13 15:12:35,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3873 secs
2025-03-13 15:12:35,398 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 15:12:35,398 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.66it/s]
2025-03-13 15:12:50,244 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8453 secs
2025-03-13 15:12:51,013 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2966 secs
2025-03-13 15:12:51,013 [INFO]: {
2025-03-13 15:12:51,013 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:51,013 [INFO]: 	index_param: efSearch=107
2025-03-13 15:12:51,014 [INFO]: 	index_path: knn.index
2025-03-13 15:12:51,014 [INFO]: 	size in bytes: 855443050
2025-03-13 15:12:51,014 [INFO]: 	avg_search_speed_ms: 7.587706231885224
2025-03-13 15:12:51,014 [INFO]: 	99p_search_speed_ms: 12.304707863368089
2025-03-13 15:12:51,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:51,014 [INFO]: 	nb vectors: 4348
2025-03-13 15:12:51,014 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:51,014 [INFO]: 	compression ratio: 0.9993085851828476
2025-03-13 15:12:51,014 [INFO]: }
2025-03-13 15:12:51,014 [INFO]: 	>>> Finished "Creating the index" in 75.2994 secs
2025-03-13 15:12:51,014 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3266 secs
2025-03-13 15:12:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 46210 [episode count 10/20]
[retrieval_preprocessing] for episode 45190 [episode count 11/20], we have num_retrieval=np.int64(4371) num_query=np.int64(214)
2025-03-13 15:12:52,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:53,455 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:53
2025-03-13 15:12:53,455 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.78it/s]
2025-03-13 15:12:53,481 [INFO]: There are 4371 embeddings of dim 49152
2025-03-13 15:12:53,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:12:53,481 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:53
2025-03-13 15:12:53,481 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:53,481 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:12:53,481 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:53,481 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:53,481 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:53
2025-03-13 15:12:53,481 [INFO]: 902.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:53,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:53,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:53
2025-03-13 15:12:53,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:53,481 [INFO]: 	Creating the index 03/13/2025, 15:12:53
2025-03-13 15:12:53,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:53
2025-03-13 15:12:53,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:12:53,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:53
2025-03-13 15:12:53,482 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:12:53,483 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.43it/s] 28%|██▊       | 5/18 [00:00<00:00, 22.90it/s] 50%|█████     | 9/18 [00:00<00:00, 27.98it/s] 72%|███████▏  | 13/18 [00:00<00:00, 30.99it/s] 94%|█████████▍| 17/18 [00:00<00:00, 32.77it/s]100%|██████████| 18/18 [00:05<00:00,  3.27it/s]
2025-03-13 15:12:58,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:58
2025-03-13 15:13:49,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7656 secs
2025-03-13 15:13:49,759 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:13:49,759 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 15:14:28,627 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8672 secs
2025-03-13 15:14:28,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.1475 secs
2025-03-13 15:14:28,630 [INFO]: {
2025-03-13 15:14:28,630 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:28,630 [INFO]: 	index_param: efSearch=215
2025-03-13 15:14:28,630 [INFO]: 	index_path: knn.index
2025-03-13 15:14:28,630 [INFO]: 	size in bytes: 859968130
2025-03-13 15:14:28,630 [INFO]: 	avg_search_speed_ms: 11.986780223230312
2025-03-13 15:14:28,630 [INFO]: 	99p_search_speed_ms: 17.591350912116468
2025-03-13 15:14:28,630 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:28,630 [INFO]: 	nb vectors: 4371
2025-03-13 15:14:28,630 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:28,630 [INFO]: 	compression ratio: 0.999308623216072
2025-03-13 15:14:28,630 [INFO]: }
2025-03-13 15:14:28,630 [INFO]: 	>>> Finished "Creating the index" in 95.1490 secs
2025-03-13 15:14:28,630 [INFO]: >>> Finished "Launching the whole pipeline" in 95.1756 secs
2025-03-13 15:14:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 45190 [episode count 11/20]
[retrieval_preprocessing] for episode 12936 [episode count 12/20], we have num_retrieval=np.int64(4367) num_query=np.int64(218)
2025-03-13 15:14:30,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:31,768 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:31
2025-03-13 15:14:31,768 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1063.19it/s]
2025-03-13 15:14:31,798 [INFO]: There are 4367 embeddings of dim 49152
2025-03-13 15:14:31,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 15:14:31,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:31
2025-03-13 15:14:31,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:31,799 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:14:31,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:31,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:31,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:31
2025-03-13 15:14:31,799 [INFO]: 901.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:31,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:14:31,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:31
2025-03-13 15:14:31,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:31,799 [INFO]: 	Creating the index 03/13/2025, 15:14:31
2025-03-13 15:14:31,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:31
2025-03-13 15:14:31,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:14:31,801 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:31
2025-03-13 15:14:31,801 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:14:31,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.77it/s] 11%|█         | 2/18 [00:00<00:02,  6.87it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.93it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.03it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.80it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.73it/s] 56%|█████▌    | 10/18 [00:01<00:00, 10.51it/s] 67%|██████▋   | 12/18 [00:01<00:00, 10.83it/s] 78%|███████▊  | 14/18 [00:01<00:00, 11.10it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.65it/s] 94%|█████████▍| 17/18 [00:01<00:00,  7.52it/s]100%|██████████| 18/18 [00:07<00:00,  1.37s/it]100%|██████████| 18/18 [00:07<00:00,  2.26it/s]
2025-03-13 15:14:39,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:39
2025-03-13 15:15:41,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6799 secs
2025-03-13 15:15:41,457 [INFO]: The best hyperparameters are: efSearch=82
2025-03-13 15:15:41,457 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 15:15:58,934 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4769 secs
2025-03-13 15:15:58,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.1393 secs
2025-03-13 15:15:58,941 [INFO]: {
2025-03-13 15:15:58,941 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:58,941 [INFO]: 	index_param: efSearch=82
2025-03-13 15:15:58,941 [INFO]: 	index_path: knn.index
2025-03-13 15:15:58,941 [INFO]: 	size in bytes: 859181170
2025-03-13 15:15:58,941 [INFO]: 	avg_search_speed_ms: 9.696029810682951
2025-03-13 15:15:58,941 [INFO]: 	99p_search_speed_ms: 18.237154372036457
2025-03-13 15:15:58,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:58,941 [INFO]: 	nb vectors: 4367
2025-03-13 15:15:58,941 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:58,941 [INFO]: 	compression ratio: 0.9993086044937414
2025-03-13 15:15:58,941 [INFO]: }
2025-03-13 15:15:58,941 [INFO]: 	>>> Finished "Creating the index" in 87.1416 secs
2025-03-13 15:15:58,941 [INFO]: >>> Finished "Launching the whole pipeline" in 87.1732 secs
2025-03-13 15:15:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 12936 [episode count 12/20]
[retrieval_preprocessing] for episode 43147 [episode count 13/20], we have num_retrieval=np.int64(4407) num_query=np.int64(178)
2025-03-13 15:16:00,949 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:01,794 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:01
2025-03-13 15:16:01,794 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.81it/s]
2025-03-13 15:16:01,826 [INFO]: There are 4407 embeddings of dim 49152
2025-03-13 15:16:01,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 15:16:01,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:01
2025-03-13 15:16:01,827 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:01,827 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:16:01,827 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:01,827 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:01,827 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:01
2025-03-13 15:16:01,827 [INFO]: 909.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:01,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:16:01,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:01
2025-03-13 15:16:01,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:01,827 [INFO]: 	Creating the index 03/13/2025, 15:16:01
2025-03-13 15:16:01,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:01
2025-03-13 15:16:01,829 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:16:01,829 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:01
2025-03-13 15:16:01,829 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:16:01,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:04,  3.84it/s] 22%|██▏       | 4/18 [00:00<00:01, 11.88it/s] 39%|███▉      | 7/18 [00:00<00:00, 15.14it/s] 50%|█████     | 9/18 [00:00<00:00, 16.18it/s] 61%|██████    | 11/18 [00:00<00:00, 16.91it/s] 72%|███████▏  | 13/18 [00:00<00:00, 17.50it/s] 83%|████████▎ | 15/18 [00:00<00:00, 18.08it/s]100%|██████████| 18/18 [00:06<00:00,  1.38it/s]100%|██████████| 18/18 [00:06<00:00,  2.92it/s]
2025-03-13 15:16:07,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:07
2025-03-13 15:17:09,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6926 secs
2025-03-13 15:17:09,685 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:17:09,685 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 15:17:33,458 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7735 secs
2025-03-13 15:17:33,464 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6351 secs
2025-03-13 15:17:33,464 [INFO]: {
2025-03-13 15:17:33,464 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:33,464 [INFO]: 	index_param: efSearch=157
2025-03-13 15:17:33,464 [INFO]: 	index_path: knn.index
2025-03-13 15:17:33,464 [INFO]: 	size in bytes: 867050890
2025-03-13 15:17:33,464 [INFO]: 	avg_search_speed_ms: 13.100016198403821
2025-03-13 15:17:33,464 [INFO]: 	99p_search_speed_ms: 18.08554767863825
2025-03-13 15:17:33,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:33,464 [INFO]: 	nb vectors: 4407
2025-03-13 15:17:33,464 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:33,464 [INFO]: 	compression ratio: 0.9993086518831669
2025-03-13 15:17:33,464 [INFO]: }
2025-03-13 15:17:33,464 [INFO]: 	>>> Finished "Creating the index" in 91.6372 secs
2025-03-13 15:17:33,464 [INFO]: >>> Finished "Launching the whole pipeline" in 91.6701 secs
2025-03-13 15:17:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 43147 [episode count 13/20]
[retrieval_preprocessing] for episode 73395 [episode count 14/20], we have num_retrieval=np.int64(4376) num_query=np.int64(209)
2025-03-13 15:17:38,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:39,509 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:39
2025-03-13 15:17:39,509 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2083.61it/s]
2025-03-13 15:17:39,536 [INFO]: There are 4376 embeddings of dim 49152
2025-03-13 15:17:39,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:17:39,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:39,536 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:17:39,536 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:39,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:17:39,537 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,537 [INFO]: 903.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:39,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:17:39,537 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:39
2025-03-13 15:17:39,537 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:39,537 [INFO]: 	Creating the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,537 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:39
2025-03-13 15:17:39,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:17:39,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,539 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:17:39,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.38it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.59it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.46it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.69it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.68it/s] 50%|█████     | 9/18 [00:00<00:00,  9.63it/s] 61%|██████    | 11/18 [00:01<00:00,  9.83it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.85it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.79it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.90it/s]100%|██████████| 18/18 [00:07<00:00,  1.02it/s]100%|██████████| 18/18 [00:07<00:00,  2.56it/s]
2025-03-13 15:17:46,581 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:46
2025-03-13 15:18:41,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3836 secs
2025-03-13 15:18:41,966 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 15:18:41,966 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.91it/s]
2025-03-13 15:19:10,469 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5028 secs
2025-03-13 15:19:10,473 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9348 secs
2025-03-13 15:19:10,474 [INFO]: {
2025-03-13 15:19:10,474 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:10,474 [INFO]: 	index_param: efSearch=225
2025-03-13 15:19:10,474 [INFO]: 	index_path: knn.index
2025-03-13 15:19:10,474 [INFO]: 	size in bytes: 860951890
2025-03-13 15:19:10,474 [INFO]: 	avg_search_speed_ms: 12.94088870453206
2025-03-13 15:19:10,474 [INFO]: 	99p_search_speed_ms: 18.033485254272787
2025-03-13 15:19:10,474 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:10,474 [INFO]: 	nb vectors: 4376
2025-03-13 15:19:10,474 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:10,474 [INFO]: 	compression ratio: 0.9993085769287294
2025-03-13 15:19:10,474 [INFO]: }
2025-03-13 15:19:10,474 [INFO]: 	>>> Finished "Creating the index" in 90.9367 secs
2025-03-13 15:19:10,474 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9650 secs
2025-03-13 15:19:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 73395 [episode count 14/20]
[retrieval_preprocessing] for episode 46261 [episode count 15/20], we have num_retrieval=np.int64(4391) num_query=np.int64(194)
2025-03-13 15:19:13,990 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:14,764 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:14
2025-03-13 15:19:14,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.80it/s]
2025-03-13 15:19:14,790 [INFO]: There are 4391 embeddings of dim 49152
2025-03-13 15:19:14,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:19:14,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:14,790 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:19:14,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:14,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:19:14,791 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,791 [INFO]: 906.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:14,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:19:14,791 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:14
2025-03-13 15:19:14,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:14,791 [INFO]: 	Creating the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:14
2025-03-13 15:19:14,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:19:14,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:14
2025-03-13 15:19:14,792 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:19:14,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.28it/s] 11%|█         | 2/18 [00:00<00:02,  6.71it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.32it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.64it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.82it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.94it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.16it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.21it/s] 50%|█████     | 9/18 [00:01<00:01,  8.34it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.43it/s] 61%|██████    | 11/18 [00:01<00:00,  8.45it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.62it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.60it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.57it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.53it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.47it/s] 94%|█████████▍| 17/18 [00:02<00:00,  8.55it/s]100%|██████████| 18/18 [00:05<00:00,  1.12s/it]100%|██████████| 18/18 [00:05<00:00,  3.25it/s]
2025-03-13 15:19:20,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:20
2025-03-13 15:20:11,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4476 secs
2025-03-13 15:20:11,782 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:20:11,782 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 15:20:32,859 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0765 secs
2025-03-13 15:20:32,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0710 secs
2025-03-13 15:20:32,863 [INFO]: {
2025-03-13 15:20:32,864 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:32,864 [INFO]: 	index_param: efSearch=199
2025-03-13 15:20:32,864 [INFO]: 	index_path: knn.index
2025-03-13 15:20:32,864 [INFO]: 	size in bytes: 863902990
2025-03-13 15:20:32,864 [INFO]: 	avg_search_speed_ms: 12.392598298658724
2025-03-13 15:20:32,864 [INFO]: 	99p_search_speed_ms: 18.96519757341592
2025-03-13 15:20:32,864 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:32,864 [INFO]: 	nb vectors: 4391
2025-03-13 15:20:32,864 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:32,864 [INFO]: 	compression ratio: 0.9993086469118483
2025-03-13 15:20:32,864 [INFO]: }
2025-03-13 15:20:32,864 [INFO]: 	>>> Finished "Creating the index" in 78.0728 secs
2025-03-13 15:20:32,864 [INFO]: >>> Finished "Launching the whole pipeline" in 78.0994 secs
2025-03-13 15:20:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 46261 [episode count 15/20]
[retrieval_preprocessing] for episode 84672 [episode count 16/20], we have num_retrieval=np.int64(4378) num_query=np.int64(207)
2025-03-13 15:20:37,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:38,621 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:38
2025-03-13 15:20:38,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1955.39it/s]
2025-03-13 15:20:38,897 [INFO]: There are 4378 embeddings of dim 49152
2025-03-13 15:20:38,897 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2762 secs
2025-03-13 15:20:38,897 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:38,897 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:20:38,897 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:38,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:20:38,897 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,897 [INFO]: 903.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:38,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:38,898 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:38
2025-03-13 15:20:38,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:38,898 [INFO]: 	Creating the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,898 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:38
2025-03-13 15:20:38,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:20:38,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,899 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:20:38,899 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.21it/s] 11%|█         | 2/18 [00:00<00:02,  7.47it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.68it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.49it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.46it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.35it/s] 39%|███▉      | 7/18 [00:00<00:01,  7.28it/s] 44%|████▍     | 8/18 [00:01<00:01,  7.14it/s] 50%|█████     | 9/18 [00:01<00:01,  7.22it/s] 56%|█████▌    | 10/18 [00:01<00:01,  7.81it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.59it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.33it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.21it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.12it/s] 89%|████████▉ | 16/18 [00:02<00:00,  8.03it/s] 94%|█████████▍| 17/18 [00:02<00:00,  8.03it/s]100%|██████████| 18/18 [00:05<00:00,  1.08s/it]100%|██████████| 18/18 [00:05<00:00,  3.21it/s]
2025-03-13 15:20:44,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:44
2025-03-13 15:21:34,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8628 secs
2025-03-13 15:21:34,380 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 15:21:34,380 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.98it/s]
2025-03-13 15:21:54,314 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9345 secs
2025-03-13 15:21:54,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4182 secs
2025-03-13 15:21:54,318 [INFO]: {
2025-03-13 15:21:54,318 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:54,318 [INFO]: 	index_param: efSearch=204
2025-03-13 15:21:54,318 [INFO]: 	index_path: knn.index
2025-03-13 15:21:54,318 [INFO]: 	size in bytes: 861345370
2025-03-13 15:21:54,318 [INFO]: 	avg_search_speed_ms: 12.496927645406686
2025-03-13 15:21:54,318 [INFO]: 	99p_search_speed_ms: 17.709201388061043
2025-03-13 15:21:54,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:54,318 [INFO]: 	nb vectors: 4378
2025-03-13 15:21:54,318 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:54,318 [INFO]: 	compression ratio: 0.9993085862875191
2025-03-13 15:21:54,318 [INFO]: }
2025-03-13 15:21:54,318 [INFO]: 	>>> Finished "Creating the index" in 75.4201 secs
2025-03-13 15:21:54,318 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6971 secs
2025-03-13 15:21:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 84672 [episode count 16/20]
[retrieval_preprocessing] for episode 39689 [episode count 17/20], we have num_retrieval=np.int64(4370) num_query=np.int64(215)
2025-03-13 15:21:57,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:58,494 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:58
2025-03-13 15:21:58,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2031.14it/s]
2025-03-13 15:21:58,521 [INFO]: There are 4370 embeddings of dim 49152
2025-03-13 15:21:58,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:21:58,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:58
2025-03-13 15:21:58,521 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:58,521 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:21:58,521 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:58,521 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:58,521 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:58
2025-03-13 15:21:58,521 [INFO]: 901.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:58,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:21:58,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:58
2025-03-13 15:21:58,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:58,522 [INFO]: 	Creating the index 03/13/2025, 15:21:58
2025-03-13 15:21:58,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:58
2025-03-13 15:21:58,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:21:58,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:58
2025-03-13 15:21:58,523 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:21:58,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.92it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.24it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.39it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.54it/s] 50%|█████     | 9/18 [00:00<00:00, 10.95it/s] 61%|██████    | 11/18 [00:01<00:00, 11.41it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.65it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.78it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.86it/s]100%|██████████| 18/18 [00:05<00:00,  3.43it/s]
2025-03-13 15:22:03,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:03
2025-03-13 15:22:46,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9672 secs
2025-03-13 15:22:46,748 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:22:46,749 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 50%|█████     | 2/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 15:23:17,960 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2117 secs
2025-03-13 15:23:17,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4418 secs
2025-03-13 15:23:17,965 [INFO]: {
2025-03-13 15:23:17,965 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:17,965 [INFO]: 	index_param: efSearch=224
2025-03-13 15:23:17,965 [INFO]: 	index_path: knn.index
2025-03-13 15:23:17,965 [INFO]: 	size in bytes: 859771390
2025-03-13 15:23:17,965 [INFO]: 	avg_search_speed_ms: 12.788267248807966
2025-03-13 15:23:17,965 [INFO]: 	99p_search_speed_ms: 19.719403232447803
2025-03-13 15:23:17,965 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:17,965 [INFO]: 	nb vectors: 4370
2025-03-13 15:23:17,965 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:17,965 [INFO]: 	compression ratio: 0.9993086185387025
2025-03-13 15:23:17,965 [INFO]: }
2025-03-13 15:23:17,965 [INFO]: 	>>> Finished "Creating the index" in 79.4433 secs
2025-03-13 15:23:17,965 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4706 secs
2025-03-13 15:23:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 39689 [episode count 17/20]
[retrieval_preprocessing] for episode 91409 [episode count 18/20], we have num_retrieval=np.int64(4319) num_query=np.int64(266)
2025-03-13 15:23:22,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:23,473 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:23
2025-03-13 15:23:23,473 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.58it/s]
2025-03-13 15:23:23,502 [INFO]: There are 4319 embeddings of dim 49152
2025-03-13 15:23:23,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:23:23,503 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:23,503 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:23:23,503 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:23,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:23:23,503 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,504 [INFO]: 891.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:23,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:23:23,504 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:23
2025-03-13 15:23:23,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:23,504 [INFO]: 	Creating the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:23
2025-03-13 15:23:23,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:23:23,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,508 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:23:23,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.46it/s] 17%|█▋        | 3/18 [00:00<00:01, 12.13it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.88it/s] 39%|███▉      | 7/18 [00:00<00:00, 14.84it/s] 50%|█████     | 9/18 [00:00<00:00, 15.07it/s] 61%|██████    | 11/18 [00:00<00:00, 15.38it/s] 72%|███████▏  | 13/18 [00:00<00:00, 15.54it/s] 83%|████████▎ | 15/18 [00:01<00:00, 14.91it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.50it/s]100%|██████████| 18/18 [00:05<00:00,  3.23it/s]
2025-03-13 15:23:29,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:29
2025-03-13 15:24:20,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4918 secs
2025-03-13 15:24:20,589 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:24:20,589 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 15:24:48,833 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2445 secs
2025-03-13 15:24:49,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5192 secs
2025-03-13 15:24:49,028 [INFO]: {
2025-03-13 15:24:49,028 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:49,028 [INFO]: 	index_param: efSearch=200
2025-03-13 15:24:49,028 [INFO]: 	index_path: knn.index
2025-03-13 15:24:49,028 [INFO]: 	size in bytes: 849737410
2025-03-13 15:24:49,028 [INFO]: 	avg_search_speed_ms: 10.84571132974784
2025-03-13 15:24:49,028 [INFO]: 	99p_search_speed_ms: 14.99390185577794
2025-03-13 15:24:49,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:49,028 [INFO]: 	nb vectors: 4319
2025-03-13 15:24:49,028 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:49,028 [INFO]: 	compression ratio: 0.999308659365721
2025-03-13 15:24:49,028 [INFO]: }
2025-03-13 15:24:49,028 [INFO]: 	>>> Finished "Creating the index" in 85.5240 secs
2025-03-13 15:24:49,028 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5550 secs
2025-03-13 15:24:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 91409 [episode count 18/20]
[retrieval_preprocessing] for episode 21857 [episode count 19/20], we have num_retrieval=np.int64(4413) num_query=np.int64(172)
2025-03-13 15:24:52,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:53,292 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:53
2025-03-13 15:24:53,292 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.07it/s]
2025-03-13 15:24:53,316 [INFO]: There are 4413 embeddings of dim 49152
2025-03-13 15:24:53,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 15:24:53,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:53
2025-03-13 15:24:53,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:53,317 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:24:53,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:53,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:53,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:53
2025-03-13 15:24:53,317 [INFO]: 910.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:53,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:53,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:53
2025-03-13 15:24:53,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:53,317 [INFO]: 	Creating the index 03/13/2025, 15:24:53
2025-03-13 15:24:53,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:53
2025-03-13 15:24:53,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:24:53,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:53
2025-03-13 15:24:53,318 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:24:53,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.87it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.58it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.04it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.53it/s] 50%|█████     | 9/18 [00:00<00:00, 11.83it/s] 61%|██████    | 11/18 [00:00<00:00, 12.09it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.09it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.11it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.88it/s]100%|██████████| 18/18 [00:05<00:00,  3.28it/s]
2025-03-13 15:24:58,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:58
2025-03-13 15:25:41,135 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3212 secs
2025-03-13 15:25:41,135 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 15:25:41,135 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
2025-03-13 15:26:04,206 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0706 secs
2025-03-13 15:26:04,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5290 secs
2025-03-13 15:26:04,847 [INFO]: {
2025-03-13 15:26:04,848 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:04,848 [INFO]: 	index_param: efSearch=227
2025-03-13 15:26:04,848 [INFO]: 	index_path: knn.index
2025-03-13 15:26:04,848 [INFO]: 	size in bytes: 868231450
2025-03-13 15:26:04,848 [INFO]: 	avg_search_speed_ms: 12.76831066183565
2025-03-13 15:26:04,848 [INFO]: 	99p_search_speed_ms: 21.22658585663884
2025-03-13 15:26:04,848 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:04,848 [INFO]: 	nb vectors: 4413
2025-03-13 15:26:04,848 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:04,848 [INFO]: 	compression ratio: 0.9993085415185087
2025-03-13 15:26:04,848 [INFO]: }
2025-03-13 15:26:04,848 [INFO]: 	>>> Finished "Creating the index" in 71.5311 secs
2025-03-13 15:26:04,848 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5561 secs
2025-03-13 15:26:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 21857 [episode count 19/20]
2025-03-13 15:26:07: [retrieval_preprocessing] finished for 4345518188_hang_cloth_on_stand [chosen_id count 1/196]
2025-03-13 15:26:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4385851547_Place Plate in Dishwasher [chosen_id count 2/196]
2025-03-13 15:26:16: [retrieval_preprocessing] we have num_total=11251 embedding_dim=49152
[retrieval_preprocessing] for episode 26133 [episode count 0/20], we have num_retrieval=np.int64(10915) num_query=np.int64(336)
2025-03-13 15:26:20,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:22,348 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:22
2025-03-13 15:26:22,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.04it/s]
2025-03-13 15:26:22,374 [INFO]: There are 10915 embeddings of dim 49152
2025-03-13 15:26:22,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:26:22,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:22
2025-03-13 15:26:22,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:22,375 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 15:26:22,375 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:26:22,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:26:22,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:22
2025-03-13 15:26:22,376 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:22,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:26:22,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:22
2025-03-13 15:26:22,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:22,376 [INFO]: 	Creating the index 03/13/2025, 15:26:22
2025-03-13 15:26:22,376 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:26:22
2025-03-13 15:26:22,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0017 secs
2025-03-13 15:26:22,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:22
2025-03-13 15:26:22,378 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:26:22,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  6.29it/s]  7%|▋         | 3/45 [00:00<00:06,  6.97it/s]  9%|▉         | 4/45 [00:00<00:06,  6.61it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.44it/s] 18%|█▊        | 8/45 [00:00<00:03, 10.12it/s] 22%|██▏       | 10/45 [00:01<00:03, 11.61it/s] 27%|██▋       | 12/45 [00:01<00:02, 13.01it/s] 31%|███       | 14/45 [00:01<00:02, 13.50it/s] 36%|███▌      | 16/45 [00:01<00:02, 14.16it/s] 40%|████      | 18/45 [00:01<00:02, 13.30it/s] 44%|████▍     | 20/45 [00:01<00:01, 12.94it/s] 49%|████▉     | 22/45 [00:07<00:21,  1.09it/s] 51%|█████     | 23/45 [00:07<00:17,  1.29it/s] 53%|█████▎    | 24/45 [00:07<00:13,  1.57it/s] 58%|█████▊    | 26/45 [00:07<00:08,  2.30it/s] 62%|██████▏   | 28/45 [00:08<00:05,  3.12it/s] 64%|██████▍   | 29/45 [00:08<00:04,  3.57it/s] 67%|██████▋   | 30/45 [00:08<00:03,  4.10it/s] 69%|██████▉   | 31/45 [00:08<00:02,  4.68it/s] 71%|███████   | 32/45 [00:08<00:02,  5.27it/s] 73%|███████▎  | 33/45 [00:08<00:02,  5.88it/s] 76%|███████▌  | 34/45 [00:08<00:01,  6.31it/s] 78%|███████▊  | 35/45 [00:08<00:01,  6.89it/s] 80%|████████  | 36/45 [00:08<00:01,  7.52it/s] 82%|████████▏ | 37/45 [00:09<00:00,  8.03it/s] 84%|████████▍ | 38/45 [00:09<00:00,  8.46it/s] 87%|████████▋ | 39/45 [00:09<00:00,  8.52it/s] 89%|████████▉ | 40/45 [00:09<00:00,  8.70it/s] 93%|█████████▎| 42/45 [00:15<00:04,  1.54s/it] 96%|█████████▌| 43/45 [00:15<00:02,  1.19s/it] 98%|█████████▊| 44/45 [00:16<00:00,  1.11it/s]100%|██████████| 45/45 [00:18<00:00,  1.38s/it]100%|██████████| 45/45 [00:18<00:00,  2.41it/s]
2025-03-13 15:26:41,045 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:41
2025-03-13 15:27:51,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.5065 secs
2025-03-13 15:27:51,552 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 15:27:51,552 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s] 50%|█████     | 2/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 15:28:31,539 [INFO]: 	>>> Finished "Compute fast metrics" in 39.9867 secs
2025-03-13 15:28:31,540 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.1624 secs
2025-03-13 15:28:31,540 [INFO]: {
2025-03-13 15:28:31,540 [INFO]: 	index_key: HNSW32
2025-03-13 15:28:31,540 [INFO]: 	index_param: efSearch=148
2025-03-13 15:28:31,540 [INFO]: 	index_path: knn.index
2025-03-13 15:28:31,540 [INFO]: 	size in bytes: 2148943622
2025-03-13 15:28:31,540 [INFO]: 	avg_search_speed_ms: 12.801774279017684
2025-03-13 15:28:31,540 [INFO]: 	99p_search_speed_ms: 27.763848938047897
2025-03-13 15:28:31,540 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:31,540 [INFO]: 	nb vectors: 10915
2025-03-13 15:28:31,540 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:31,540 [INFO]: 	compression ratio: 0.9986191810852448
2025-03-13 15:28:31,540 [INFO]: }
2025-03-13 15:28:31,540 [INFO]: 	>>> Finished "Creating the index" in 129.1646 secs
2025-03-13 15:28:31,540 [INFO]: >>> Finished "Launching the whole pipeline" in 129.1922 secs
2025-03-13 15:28:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 26133 [episode count 0/20]
[retrieval_preprocessing] for episode 25641 [episode count 1/20], we have num_retrieval=np.int64(10436) num_query=np.int64(815)
2025-03-13 15:28:39,435 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:41,162 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:41
2025-03-13 15:28:41,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.34it/s]
2025-03-13 15:28:41,188 [INFO]: There are 10436 embeddings of dim 49152
2025-03-13 15:28:41,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:28:41,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:41
2025-03-13 15:28:41,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:41,188 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:28:41,188 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:28:41,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:41,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:41
2025-03-13 15:28:41,188 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:41,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:28:41,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:41
2025-03-13 15:28:41,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:41,188 [INFO]: 	Creating the index 03/13/2025, 15:28:41
2025-03-13 15:28:41,188 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:28:41
2025-03-13 15:28:41,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:28:41,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:41
2025-03-13 15:28:41,189 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:28:41,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:09,  4.66it/s]  7%|▋         | 3/44 [00:00<00:04,  8.74it/s] 11%|█▏        | 5/44 [00:00<00:03, 10.33it/s] 16%|█▌        | 7/44 [00:00<00:03, 11.10it/s] 20%|██        | 9/44 [00:00<00:03, 11.65it/s] 25%|██▌       | 11/44 [00:01<00:02, 11.46it/s] 30%|██▉       | 13/44 [00:01<00:02, 11.25it/s] 34%|███▍      | 15/44 [00:01<00:02, 10.99it/s] 39%|███▊      | 17/44 [00:01<00:02, 10.78it/s] 43%|████▎     | 19/44 [00:01<00:02, 10.53it/s] 48%|████▊     | 21/44 [00:07<00:21,  1.09it/s] 52%|█████▏    | 23/44 [00:07<00:13,  1.50it/s] 57%|█████▋    | 25/44 [00:07<00:09,  2.04it/s] 61%|██████▏   | 27/44 [00:07<00:06,  2.73it/s] 66%|██████▌   | 29/44 [00:08<00:04,  3.54it/s] 70%|███████   | 31/44 [00:08<00:02,  4.42it/s] 75%|███████▌  | 33/44 [00:08<00:02,  5.27it/s] 80%|███████▉  | 35/44 [00:08<00:01,  6.01it/s] 82%|████████▏ | 36/44 [00:08<00:01,  6.40it/s] 84%|████████▍ | 37/44 [00:08<00:01,  6.86it/s] 86%|████████▋ | 38/44 [00:08<00:00,  7.37it/s] 91%|█████████ | 40/44 [00:09<00:00,  8.20it/s] 95%|█████████▌| 42/44 [00:16<00:02,  1.37s/it]100%|██████████| 44/44 [00:18<00:00,  1.23s/it]100%|██████████| 44/44 [00:18<00:00,  2.40it/s]
2025-03-13 15:28:59,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:59
2025-03-13 15:30:22,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.9380 secs
2025-03-13 15:30:22,453 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 15:30:22,453 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s]
2025-03-13 15:31:08,022 [INFO]: 	>>> Finished "Compute fast metrics" in 45.5696 secs
2025-03-13 15:31:08,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.8340 secs
2025-03-13 15:31:08,023 [INFO]: {
2025-03-13 15:31:08,024 [INFO]: 	index_key: HNSW32
2025-03-13 15:31:08,024 [INFO]: 	index_param: efSearch=103
2025-03-13 15:31:08,024 [INFO]: 	index_path: knn.index
2025-03-13 15:31:08,024 [INFO]: 	size in bytes: 2054637970
2025-03-13 15:31:08,024 [INFO]: 	avg_search_speed_ms: 9.84084723044304
2025-03-13 15:31:08,024 [INFO]: 	99p_search_speed_ms: 17.512846621684734
2025-03-13 15:31:08,024 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:08,024 [INFO]: 	nb vectors: 10436
2025-03-13 15:31:08,024 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:08,024 [INFO]: 	compression ratio: 0.9986192788990461
2025-03-13 15:31:08,024 [INFO]: }
2025-03-13 15:31:08,024 [INFO]: 	>>> Finished "Creating the index" in 146.8354 secs
2025-03-13 15:31:08,024 [INFO]: >>> Finished "Launching the whole pipeline" in 146.8613 secs
2025-03-13 15:31:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 25641 [episode count 1/20]
[retrieval_preprocessing] for episode 1580 [episode count 2/20], we have num_retrieval=np.int64(10818) num_query=np.int64(433)
2025-03-13 15:31:17,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:19,055 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:19
2025-03-13 15:31:19,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.64it/s]
2025-03-13 15:31:19,081 [INFO]: There are 10818 embeddings of dim 49152
2025-03-13 15:31:19,082 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:31:19,082 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,082 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:19,082 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 15:31:19,082 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:31:19,082 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:31:19,082 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,082 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:19,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:31:19,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:19
2025-03-13 15:31:19,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:19,082 [INFO]: 	Creating the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,082 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:31:19
2025-03-13 15:31:19,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:31:19,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,084 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:31:19,084 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.49it/s]  4%|▍         | 2/45 [00:00<00:06,  6.26it/s]  9%|▉         | 4/45 [00:00<00:04,  8.44it/s] 13%|█▎        | 6/45 [00:00<00:03, 10.66it/s] 18%|█▊        | 8/45 [00:00<00:04,  9.17it/s] 20%|██        | 9/45 [00:01<00:03,  9.12it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.13it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.93it/s] 31%|███       | 14/45 [00:01<00:02, 10.64it/s] 36%|███▌      | 16/45 [00:01<00:02, 11.14it/s] 40%|████      | 18/45 [00:01<00:02, 11.28it/s] 44%|████▍     | 20/45 [00:01<00:02, 11.37it/s] 49%|████▉     | 22/45 [00:07<00:21,  1.08it/s] 51%|█████     | 23/45 [00:07<00:17,  1.29it/s] 53%|█████▎    | 24/45 [00:07<00:13,  1.57it/s] 56%|█████▌    | 25/45 [00:07<00:10,  1.93it/s] 58%|█████▊    | 26/45 [00:07<00:07,  2.39it/s] 62%|██████▏   | 28/45 [00:08<00:04,  3.56it/s] 64%|██████▍   | 29/45 [00:08<00:04,  3.77it/s] 67%|██████▋   | 30/45 [00:08<00:04,  3.73it/s] 69%|██████▉   | 31/45 [00:08<00:03,  4.35it/s] 71%|███████   | 32/45 [00:08<00:02,  5.07it/s] 73%|███████▎  | 33/45 [00:08<00:02,  5.80it/s] 76%|███████▌  | 34/45 [00:09<00:01,  6.49it/s] 78%|███████▊  | 35/45 [00:09<00:01,  7.13it/s] 82%|████████▏ | 37/45 [00:09<00:00,  9.15it/s] 87%|████████▋ | 39/45 [00:09<00:00, 10.63it/s] 91%|█████████ | 41/45 [00:09<00:00, 11.42it/s] 96%|█████████▌| 43/45 [00:15<00:02,  1.12s/it] 98%|█████████▊| 44/45 [00:15<00:00,  1.08it/s]100%|██████████| 45/45 [00:18<00:00,  1.19s/it]100%|██████████| 45/45 [00:18<00:00,  2.49it/s]
2025-03-13 15:31:37,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:37
2025-03-13 15:33:00,933 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.6385 secs
2025-03-13 15:33:00,933 [INFO]: The best hyperparameters are: efSearch=66
2025-03-13 15:33:00,933 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.79it/s]
2025-03-13 15:33:51,162 [INFO]: 	>>> Finished "Compute fast metrics" in 50.2287 secs
2025-03-13 15:33:51,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.0796 secs
2025-03-13 15:33:51,163 [INFO]: {
2025-03-13 15:33:51,163 [INFO]: 	index_key: HNSW32
2025-03-13 15:33:51,163 [INFO]: 	index_param: efSearch=66
2025-03-13 15:33:51,163 [INFO]: 	index_path: knn.index
2025-03-13 15:33:51,163 [INFO]: 	size in bytes: 2129845882
2025-03-13 15:33:51,163 [INFO]: 	avg_search_speed_ms: 6.914872699803615
2025-03-13 15:33:51,163 [INFO]: 	99p_search_speed_ms: 13.365284027531725
2025-03-13 15:33:51,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:51,163 [INFO]: 	nb vectors: 10818
2025-03-13 15:33:51,163 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:51,163 [INFO]: 	compression ratio: 0.9986193658307151
2025-03-13 15:33:51,163 [INFO]: }
2025-03-13 15:33:51,163 [INFO]: 	>>> Finished "Creating the index" in 152.0811 secs
2025-03-13 15:33:51,163 [INFO]: >>> Finished "Launching the whole pipeline" in 152.1081 secs
2025-03-13 15:33:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 1580 [episode count 2/20]
[retrieval_preprocessing] for episode 22090 [episode count 3/20], we have num_retrieval=np.int64(10844) num_query=np.int64(407)
2025-03-13 15:34:02,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:04,505 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:04
2025-03-13 15:34:04,505 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1038.19it/s]
2025-03-13 15:34:04,532 [INFO]: There are 10844 embeddings of dim 49152
2025-03-13 15:34:04,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:34:04,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:04
2025-03-13 15:34:04,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:04,532 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 15:34:04,532 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:34:04,532 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:04,532 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:04
2025-03-13 15:34:04,532 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:04,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:04,533 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:04
2025-03-13 15:34:04,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:04,533 [INFO]: 	Creating the index 03/13/2025, 15:34:04
2025-03-13 15:34:04,533 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:34:04
2025-03-13 15:34:04,534 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:34:04,534 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:04
2025-03-13 15:34:04,534 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:34:04,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:11,  3.75it/s]  4%|▍         | 2/45 [00:00<00:08,  5.23it/s]  7%|▋         | 3/45 [00:00<00:06,  6.05it/s]  9%|▉         | 4/45 [00:00<00:06,  6.46it/s] 11%|█         | 5/45 [00:00<00:05,  6.70it/s] 13%|█▎        | 6/45 [00:00<00:05,  6.84it/s] 16%|█▌        | 7/45 [00:01<00:05,  6.93it/s] 18%|█▊        | 8/45 [00:01<00:05,  7.04it/s] 20%|██        | 9/45 [00:01<00:05,  7.02it/s] 22%|██▏       | 10/45 [00:01<00:05,  6.89it/s] 24%|██▍       | 11/45 [00:01<00:05,  6.79it/s] 27%|██▋       | 12/45 [00:01<00:05,  5.93it/s] 29%|██▉       | 13/45 [00:02<00:05,  6.10it/s] 31%|███       | 14/45 [00:02<00:05,  6.19it/s] 33%|███▎      | 15/45 [00:02<00:04,  6.16it/s] 36%|███▌      | 16/45 [00:02<00:04,  6.73it/s] 38%|███▊      | 17/45 [00:02<00:04,  6.55it/s] 40%|████      | 18/45 [00:02<00:04,  6.39it/s] 42%|████▏     | 19/45 [00:02<00:04,  6.20it/s] 44%|████▍     | 20/45 [00:03<00:04,  5.99it/s] 47%|████▋     | 21/45 [00:09<00:50,  2.09s/it] 49%|████▉     | 22/45 [00:09<00:34,  1.50s/it] 53%|█████▎    | 24/45 [00:10<00:17,  1.17it/s] 56%|█████▌    | 25/45 [00:10<00:13,  1.50it/s] 60%|██████    | 27/45 [00:10<00:07,  2.34it/s] 64%|██████▍   | 29/45 [00:10<00:04,  3.30it/s] 69%|██████▉   | 31/45 [00:10<00:03,  4.34it/s] 73%|███████▎  | 33/45 [00:10<00:02,  5.53it/s] 78%|███████▊  | 35/45 [00:11<00:01,  6.78it/s] 82%|████████▏ | 37/45 [00:11<00:01,  7.95it/s] 87%|████████▋ | 39/45 [00:11<00:00,  8.96it/s] 91%|█████████ | 41/45 [00:11<00:00, 10.30it/s] 96%|█████████▌| 43/45 [00:19<00:02,  1.32s/it]100%|██████████| 45/45 [00:22<00:00,  1.35s/it]100%|██████████| 45/45 [00:22<00:00,  2.00it/s]
2025-03-13 15:34:27,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:27
2025-03-13 15:36:09,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.2270 secs
2025-03-13 15:36:09,275 [INFO]: The best hyperparameters are: efSearch=74
2025-03-13 15:36:09,275 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-13 15:37:05,923 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6473 secs
2025-03-13 15:37:05,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 181.3902 secs
2025-03-13 15:37:05,924 [INFO]: {
2025-03-13 15:37:05,924 [INFO]: 	index_key: HNSW32
2025-03-13 15:37:05,924 [INFO]: 	index_param: efSearch=74
2025-03-13 15:37:05,924 [INFO]: 	index_path: knn.index
2025-03-13 15:37:05,924 [INFO]: 	size in bytes: 2134965042
2025-03-13 15:37:05,924 [INFO]: 	avg_search_speed_ms: 9.948838185240973
2025-03-13 15:37:05,924 [INFO]: 	99p_search_speed_ms: 21.19521099142731
2025-03-13 15:37:05,924 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:05,924 [INFO]: 	nb vectors: 10844
2025-03-13 15:37:05,924 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:05,924 [INFO]: 	compression ratio: 0.9986192326609533
2025-03-13 15:37:05,924 [INFO]: }
2025-03-13 15:37:05,924 [INFO]: 	>>> Finished "Creating the index" in 181.3917 secs
2025-03-13 15:37:05,924 [INFO]: >>> Finished "Launching the whole pipeline" in 181.4195 secs
2025-03-13 15:37:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 22090 [episode count 3/20]
[retrieval_preprocessing] for episode 21592 [episode count 4/20], we have num_retrieval=np.int64(10718) num_query=np.int64(533)
2025-03-13 15:37:16,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:19,144 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:19
2025-03-13 15:37:19,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1024.25it/s]
2025-03-13 15:37:19,178 [INFO]: There are 10718 embeddings of dim 49152
2025-03-13 15:37:19,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 15:37:19,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:19
2025-03-13 15:37:19,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:19,180 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 15:37:19,180 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:37:19,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:37:19,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:19
2025-03-13 15:37:19,181 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:19,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:37:19,181 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:19
2025-03-13 15:37:19,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:37:19,181 [INFO]: 	Creating the index 03/13/2025, 15:37:19
2025-03-13 15:37:19,182 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:37:19
2025-03-13 15:37:19,185 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0032 secs
2025-03-13 15:37:19,186 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:19
2025-03-13 15:37:19,186 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:37:19,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.71it/s]  9%|▉         | 4/45 [00:00<00:02, 14.46it/s] 16%|█▌        | 7/45 [00:00<00:01, 19.57it/s] 22%|██▏       | 10/45 [00:00<00:01, 22.76it/s] 29%|██▉       | 13/45 [00:00<00:01, 24.91it/s] 36%|███▌      | 16/45 [00:00<00:01, 25.92it/s] 42%|████▏     | 19/45 [00:00<00:00, 27.02it/s] 49%|████▉     | 22/45 [00:08<00:19,  1.20it/s] 53%|█████▎    | 24/45 [00:08<00:13,  1.52it/s] 58%|█████▊    | 26/45 [00:08<00:09,  1.90it/s] 62%|██████▏   | 28/45 [00:08<00:07,  2.40it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.00it/s] 71%|███████   | 32/45 [00:09<00:03,  3.64it/s] 76%|███████▌  | 34/45 [00:09<00:02,  4.39it/s] 78%|███████▊  | 35/45 [00:09<00:02,  4.80it/s] 80%|████████  | 36/45 [00:09<00:01,  5.27it/s] 82%|████████▏ | 37/45 [00:10<00:01,  5.47it/s] 84%|████████▍ | 38/45 [00:10<00:01,  5.80it/s] 87%|████████▋ | 39/45 [00:10<00:00,  6.04it/s] 89%|████████▉ | 40/45 [00:10<00:00,  6.30it/s] 91%|█████████ | 41/45 [00:10<00:00,  6.65it/s] 93%|█████████▎| 42/45 [00:23<00:10,  3.65s/it] 96%|█████████▌| 43/45 [00:23<00:05,  2.64s/it] 98%|█████████▊| 44/45 [00:23<00:01,  1.90s/it]100%|██████████| 45/45 [00:26<00:00,  2.14s/it]100%|██████████| 45/45 [00:26<00:00,  1.72it/s]
2025-03-13 15:37:45,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:45
2025-03-13 15:39:29,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 104.1324 secs
2025-03-13 15:39:29,449 [INFO]: The best hyperparameters are: efSearch=61
2025-03-13 15:39:29,449 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.51it/s] 50%|█████     | 2/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 15:40:10,875 [INFO]: 	>>> Finished "Compute fast metrics" in 41.4252 secs
2025-03-13 15:40:10,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 171.6900 secs
2025-03-13 15:40:10,876 [INFO]: {
2025-03-13 15:40:10,876 [INFO]: 	index_key: HNSW32
2025-03-13 15:40:10,876 [INFO]: 	index_param: efSearch=61
2025-03-13 15:40:10,876 [INFO]: 	index_path: knn.index
2025-03-13 15:40:10,876 [INFO]: 	size in bytes: 2110157770
2025-03-13 15:40:10,876 [INFO]: 	avg_search_speed_ms: 7.475068784167707
2025-03-13 15:40:10,876 [INFO]: 	99p_search_speed_ms: 15.071396604180363
2025-03-13 15:40:10,876 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:10,876 [INFO]: 	nb vectors: 10718
2025-03-13 15:40:10,876 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:10,876 [INFO]: 	compression ratio: 0.9986194273994973
2025-03-13 15:40:10,876 [INFO]: }
2025-03-13 15:40:10,876 [INFO]: 	>>> Finished "Creating the index" in 171.6945 secs
2025-03-13 15:40:10,876 [INFO]: >>> Finished "Launching the whole pipeline" in 171.7317 secs
2025-03-13 15:40:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 21592 [episode count 4/20]
[retrieval_preprocessing] for episode 61029 [episode count 5/20], we have num_retrieval=np.int64(10156) num_query=np.int64(1095)
2025-03-13 15:40:17,961 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:19,455 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:19
2025-03-13 15:40:19,455 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1304.60it/s]
2025-03-13 15:40:19,480 [INFO]: There are 10156 embeddings of dim 49152
2025-03-13 15:40:19,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 15:40:19,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:19,480 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:40:19,480 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:40:19,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:19,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,480 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:19,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:40:19,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:19
2025-03-13 15:40:19,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:19,480 [INFO]: 	Creating the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,480 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:40:19
2025-03-13 15:40:19,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:40:19,481 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,481 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:40:19,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.51it/s]  5%|▍         | 2/41 [00:00<00:05,  6.60it/s]  7%|▋         | 3/41 [00:00<00:04,  7.79it/s] 10%|▉         | 4/41 [00:00<00:04,  8.46it/s] 12%|█▏        | 5/41 [00:00<00:04,  8.77it/s] 15%|█▍        | 6/41 [00:00<00:03,  9.10it/s] 20%|█▉        | 8/41 [00:00<00:02, 12.29it/s] 27%|██▋       | 11/41 [00:00<00:01, 15.96it/s] 34%|███▍      | 14/41 [00:01<00:01, 18.15it/s] 41%|████▏     | 17/41 [00:01<00:01, 18.98it/s] 49%|████▉     | 20/41 [00:01<00:01, 18.35it/s] 54%|█████▎    | 22/41 [00:06<00:12,  1.57it/s] 59%|█████▊    | 24/41 [00:06<00:08,  2.03it/s] 63%|██████▎   | 26/41 [00:06<00:05,  2.61it/s] 68%|██████▊   | 28/41 [00:06<00:03,  3.33it/s] 73%|███████▎  | 30/41 [00:06<00:02,  4.17it/s] 78%|███████▊  | 32/41 [00:07<00:01,  5.09it/s] 83%|████████▎ | 34/41 [00:07<00:01,  6.07it/s] 88%|████████▊ | 36/41 [00:07<00:00,  7.01it/s] 93%|█████████▎| 38/41 [00:07<00:00,  8.05it/s] 98%|█████████▊| 40/41 [00:07<00:00,  9.13it/s]100%|██████████| 41/41 [00:14<00:00,  2.83it/s]
2025-03-13 15:40:33,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:33
2025-03-13 15:42:15,556 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.5895 secs
2025-03-13 15:42:15,556 [INFO]: The best hyperparameters are: efSearch=94
2025-03-13 15:42:15,556 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s]
2025-03-13 15:43:03,429 [INFO]: 	>>> Finished "Compute fast metrics" in 47.8730 secs
2025-03-13 15:43:03,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.9514 secs
2025-03-13 15:43:03,433 [INFO]: {
2025-03-13 15:43:03,433 [INFO]: 	index_key: HNSW32
2025-03-13 15:43:03,433 [INFO]: 	index_param: efSearch=94
2025-03-13 15:43:03,433 [INFO]: 	index_path: knn.index
2025-03-13 15:43:03,433 [INFO]: 	size in bytes: 1999511154
2025-03-13 15:43:03,433 [INFO]: 	avg_search_speed_ms: 8.485900330775124
2025-03-13 15:43:03,433 [INFO]: 	99p_search_speed_ms: 12.941055060364308
2025-03-13 15:43:03,433 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:03,433 [INFO]: 	nb vectors: 10156
2025-03-13 15:43:03,433 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:03,433 [INFO]: 	compression ratio: 0.9986195095763892
2025-03-13 15:43:03,433 [INFO]: }
2025-03-13 15:43:03,433 [INFO]: 	>>> Finished "Creating the index" in 163.9528 secs
2025-03-13 15:43:03,433 [INFO]: >>> Finished "Launching the whole pipeline" in 163.9780 secs
2025-03-13 15:43:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 61029 [episode count 5/20]
[retrieval_preprocessing] for episode 93849 [episode count 6/20], we have num_retrieval=np.int64(10844) num_query=np.int64(407)
2025-03-13 15:43:15,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:17,535 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:17
2025-03-13 15:43:17,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.04it/s]
2025-03-13 15:43:17,561 [INFO]: There are 10844 embeddings of dim 49152
2025-03-13 15:43:17,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:43:17,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:17
2025-03-13 15:43:17,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:17,562 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 15:43:17,562 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:43:17,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:17,562 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:17
2025-03-13 15:43:17,562 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:17,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:43:17,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:17
2025-03-13 15:43:17,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:17,562 [INFO]: 	Creating the index 03/13/2025, 15:43:17
2025-03-13 15:43:17,562 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:43:17
2025-03-13 15:43:17,563 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 15:43:17,563 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:17
2025-03-13 15:43:17,563 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:43:17,563 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.44it/s]  7%|▋         | 3/45 [00:00<00:05,  7.96it/s] 11%|█         | 5/45 [00:00<00:04,  9.32it/s] 16%|█▌        | 7/45 [00:00<00:03, 10.36it/s] 20%|██        | 9/45 [00:00<00:03, 10.71it/s] 24%|██▍       | 11/45 [00:01<00:03, 10.11it/s] 29%|██▉       | 13/45 [00:01<00:03,  9.14it/s] 31%|███       | 14/45 [00:01<00:03,  8.85it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.23it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.19it/s] 38%|███▊      | 17/45 [00:01<00:03,  8.28it/s] 40%|████      | 18/45 [00:02<00:03,  8.14it/s] 42%|████▏     | 19/45 [00:02<00:03,  8.48it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.85it/s] 47%|████▋     | 21/45 [00:09<00:52,  2.19s/it] 49%|████▉     | 22/45 [00:09<00:36,  1.58s/it] 51%|█████     | 23/45 [00:09<00:25,  1.15s/it] 53%|█████▎    | 24/45 [00:09<00:17,  1.19it/s] 56%|█████▌    | 25/45 [00:10<00:12,  1.60it/s] 58%|█████▊    | 26/45 [00:10<00:08,  2.12it/s] 60%|██████    | 27/45 [00:10<00:06,  2.75it/s] 62%|██████▏   | 28/45 [00:10<00:04,  3.44it/s] 64%|██████▍   | 29/45 [00:10<00:03,  4.22it/s] 67%|██████▋   | 30/45 [00:10<00:02,  5.07it/s] 69%|██████▉   | 31/45 [00:10<00:02,  5.95it/s] 73%|███████▎  | 33/45 [00:10<00:01,  7.38it/s] 76%|███████▌  | 34/45 [00:10<00:01,  7.85it/s] 78%|███████▊  | 35/45 [00:11<00:01,  8.11it/s] 80%|████████  | 36/45 [00:11<00:01,  8.15it/s] 84%|████████▍ | 38/45 [00:11<00:00,  9.13it/s] 89%|████████▉ | 40/45 [00:11<00:00,  9.84it/s] 93%|█████████▎| 42/45 [00:18<00:04,  1.38s/it] 96%|█████████▌| 43/45 [00:19<00:02,  1.12s/it]100%|██████████| 45/45 [00:21<00:00,  1.20s/it]100%|██████████| 45/45 [00:21<00:00,  2.07it/s]
2025-03-13 15:43:39,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:39
2025-03-13 15:45:06,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.0480 secs
2025-03-13 15:45:06,398 [INFO]: The best hyperparameters are: efSearch=61
2025-03-13 15:45:06,398 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.26it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.89it/s]
2025-03-13 15:45:59,109 [INFO]: 	>>> Finished "Compute fast metrics" in 52.7100 secs
2025-03-13 15:45:59,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.5465 secs
2025-03-13 15:45:59,111 [INFO]: {
2025-03-13 15:45:59,111 [INFO]: 	index_key: HNSW32
2025-03-13 15:45:59,111 [INFO]: 	index_param: efSearch=61
2025-03-13 15:45:59,111 [INFO]: 	index_path: knn.index
2025-03-13 15:45:59,111 [INFO]: 	size in bytes: 2134965042
2025-03-13 15:45:59,111 [INFO]: 	avg_search_speed_ms: 9.476343649360139
2025-03-13 15:45:59,111 [INFO]: 	99p_search_speed_ms: 19.787603639997553
2025-03-13 15:45:59,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:59,111 [INFO]: 	nb vectors: 10844
2025-03-13 15:45:59,111 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:59,111 [INFO]: 	compression ratio: 0.9986192326609533
2025-03-13 15:45:59,111 [INFO]: }
2025-03-13 15:45:59,111 [INFO]: 	>>> Finished "Creating the index" in 161.5488 secs
2025-03-13 15:45:59,111 [INFO]: >>> Finished "Launching the whole pipeline" in 161.5756 secs
2025-03-13 15:46:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 93849 [episode count 6/20]
[retrieval_preprocessing] for episode 5292 [episode count 7/20], we have num_retrieval=np.int64(10202) num_query=np.int64(1049)
2025-03-13 15:46:07,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:09,666 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:09
2025-03-13 15:46:09,666 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.17it/s]
2025-03-13 15:46:09,693 [INFO]: There are 10202 embeddings of dim 49152
2025-03-13 15:46:09,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:46:09,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:09
2025-03-13 15:46:09,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:09,693 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:46:09,693 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:46:09,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:09,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:09
2025-03-13 15:46:09,693 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:09,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:46:09,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:09
2025-03-13 15:46:09,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:09,694 [INFO]: 	Creating the index 03/13/2025, 15:46:09
2025-03-13 15:46:09,694 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:46:09
2025-03-13 15:46:09,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:46:09,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:09
2025-03-13 15:46:09,695 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:46:09,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.20it/s]  5%|▍         | 2/43 [00:00<00:06,  6.28it/s]  7%|▋         | 3/43 [00:00<00:05,  7.44it/s]  9%|▉         | 4/43 [00:00<00:04,  8.26it/s] 12%|█▏        | 5/43 [00:00<00:04,  8.67it/s] 14%|█▍        | 6/43 [00:00<00:04,  8.98it/s] 16%|█▋        | 7/43 [00:00<00:03,  9.23it/s] 21%|██        | 9/43 [00:01<00:03,  9.78it/s] 26%|██▌       | 11/43 [00:01<00:03,  9.91it/s] 30%|███       | 13/43 [00:01<00:02, 10.29it/s] 35%|███▍      | 15/43 [00:01<00:02, 10.34it/s] 40%|███▉      | 17/43 [00:01<00:02, 10.58it/s] 44%|████▍     | 19/43 [00:01<00:02, 10.80it/s] 49%|████▉     | 21/43 [00:08<00:22,  1.04s/it] 58%|█████▊    | 25/43 [00:08<00:10,  1.78it/s] 67%|██████▋   | 29/43 [00:08<00:04,  2.89it/s] 77%|███████▋  | 33/43 [00:08<00:02,  4.36it/s] 86%|████████▌ | 37/43 [00:08<00:00,  6.27it/s] 95%|█████████▌| 41/43 [00:08<00:00,  8.67it/s]100%|██████████| 43/43 [00:18<00:00,  2.31it/s]
2025-03-13 15:46:28,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:28
2025-03-13 15:48:00,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 91.8847 secs
2025-03-13 15:48:00,163 [INFO]: The best hyperparameters are: efSearch=73
2025-03-13 15:48:00,163 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 15:48:58,871 [INFO]: 	>>> Finished "Compute fast metrics" in 58.7075 secs
2025-03-13 15:48:58,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 169.1767 secs
2025-03-13 15:48:58,872 [INFO]: {
2025-03-13 15:48:58,872 [INFO]: 	index_key: HNSW32
2025-03-13 15:48:58,872 [INFO]: 	index_param: efSearch=73
2025-03-13 15:48:58,872 [INFO]: 	index_path: knn.index
2025-03-13 15:48:58,872 [INFO]: 	size in bytes: 2008567706
2025-03-13 15:48:58,872 [INFO]: 	avg_search_speed_ms: 7.959812351059062
2025-03-13 15:48:58,872 [INFO]: 	99p_search_speed_ms: 18.331089732237178
2025-03-13 15:48:58,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:58,872 [INFO]: 	nb vectors: 10202
2025-03-13 15:48:58,872 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:58,872 [INFO]: 	compression ratio: 0.9986194689919007
2025-03-13 15:48:58,872 [INFO]: }
2025-03-13 15:48:58,872 [INFO]: 	>>> Finished "Creating the index" in 169.1780 secs
2025-03-13 15:48:58,872 [INFO]: >>> Finished "Launching the whole pipeline" in 169.2059 secs
2025-03-13 15:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 5292 [episode count 7/20]
[retrieval_preprocessing] for episode 71935 [episode count 8/20], we have num_retrieval=np.int64(10762) num_query=np.int64(489)
2025-03-13 15:49:09,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:11,824 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:11
2025-03-13 15:49:11,824 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1255.40it/s]
2025-03-13 15:49:11,854 [INFO]: There are 10762 embeddings of dim 49152
2025-03-13 15:49:11,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 15:49:11,855 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:11,856 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 15:49:11,856 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:49:11,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:49:11,856 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,857 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:11,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:49:11,857 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:11
2025-03-13 15:49:11,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:49:11,857 [INFO]: 	Creating the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,858 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:49:11
2025-03-13 15:49:11,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 15:49:11,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,861 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:49:11,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:07,  5.92it/s]  7%|▋         | 3/45 [00:00<00:03, 11.95it/s] 13%|█▎        | 6/45 [00:00<00:02, 16.40it/s] 20%|██        | 9/45 [00:00<00:01, 18.79it/s] 24%|██▍       | 11/45 [00:00<00:02, 16.58it/s] 31%|███       | 14/45 [00:00<00:01, 18.52it/s] 38%|███▊      | 17/45 [00:00<00:01, 20.30it/s] 44%|████▍     | 20/45 [00:01<00:01, 18.40it/s] 49%|████▉     | 22/45 [00:06<00:16,  1.44it/s] 53%|█████▎    | 24/45 [00:06<00:11,  1.84it/s] 58%|█████▊    | 26/45 [00:06<00:07,  2.42it/s] 62%|██████▏   | 28/45 [00:07<00:05,  3.10it/s] 67%|██████▋   | 30/45 [00:07<00:03,  3.76it/s] 71%|███████   | 32/45 [00:07<00:02,  4.74it/s] 76%|███████▌  | 34/45 [00:07<00:01,  5.58it/s] 80%|████████  | 36/45 [00:07<00:01,  6.63it/s] 84%|████████▍ | 38/45 [00:08<00:01,  6.87it/s] 89%|████████▉ | 40/45 [00:08<00:00,  7.97it/s] 93%|█████████▎| 42/45 [00:16<00:03,  1.26s/it] 98%|█████████▊| 44/45 [00:16<00:00,  1.10it/s]100%|██████████| 45/45 [00:18<00:00,  1.09s/it]100%|██████████| 45/45 [00:18<00:00,  2.48it/s]
2025-03-13 15:49:30,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:30
2025-03-13 15:50:49,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.8355 secs
2025-03-13 15:50:49,864 [INFO]: The best hyperparameters are: efSearch=78
2025-03-13 15:50:49,864 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.41it/s] 50%|█████     | 2/4 [00:00<00:00,  4.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.01it/s]
2025-03-13 15:51:47,056 [INFO]: 	>>> Finished "Compute fast metrics" in 57.1923 secs
2025-03-13 15:51:47,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.1959 secs
2025-03-13 15:51:47,057 [INFO]: {
2025-03-13 15:51:47,057 [INFO]: 	index_key: HNSW32
2025-03-13 15:51:47,057 [INFO]: 	index_param: efSearch=78
2025-03-13 15:51:47,057 [INFO]: 	index_path: knn.index
2025-03-13 15:51:47,057 [INFO]: 	size in bytes: 2118820442
2025-03-13 15:51:47,057 [INFO]: 	avg_search_speed_ms: 8.793864686700632
2025-03-13 15:51:47,057 [INFO]: 	99p_search_speed_ms: 19.913269709795728
2025-03-13 15:51:47,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:47,057 [INFO]: 	nb vectors: 10762
2025-03-13 15:51:47,057 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:47,057 [INFO]: 	compression ratio: 0.9986194460172194
2025-03-13 15:51:47,057 [INFO]: }
2025-03-13 15:51:47,058 [INFO]: 	>>> Finished "Creating the index" in 155.2000 secs
2025-03-13 15:51:47,058 [INFO]: >>> Finished "Launching the whole pipeline" in 155.2336 secs
2025-03-13 15:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 71935 [episode count 8/20]
[retrieval_preprocessing] for episode 48902 [episode count 9/20], we have num_retrieval=np.int64(10866) num_query=np.int64(385)
2025-03-13 15:51:55,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:57,194 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:57
2025-03-13 15:51:57,194 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.95it/s]
2025-03-13 15:51:57,221 [INFO]: There are 10866 embeddings of dim 49152
2025-03-13 15:51:57,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:51:57,221 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:57
2025-03-13 15:51:57,222 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:57,222 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 15:51:57,222 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:51:57,222 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:51:57,222 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:57
2025-03-13 15:51:57,222 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:57,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:51:57,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:57
2025-03-13 15:51:57,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:51:57,224 [INFO]: 	Creating the index 03/13/2025, 15:51:57
2025-03-13 15:51:57,224 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:51:57
2025-03-13 15:51:57,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 15:51:57,227 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:57
2025-03-13 15:51:57,227 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:51:57,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:10,  4.36it/s]  4%|▍         | 2/45 [00:00<00:06,  6.42it/s]  7%|▋         | 3/45 [00:00<00:05,  7.45it/s]  9%|▉         | 4/45 [00:00<00:05,  8.00it/s] 11%|█         | 5/45 [00:00<00:04,  8.44it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.76it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.96it/s] 18%|█▊        | 8/45 [00:00<00:04,  9.25it/s] 20%|██        | 9/45 [00:01<00:03,  9.24it/s] 24%|██▍       | 11/45 [00:01<00:03,  9.34it/s] 29%|██▉       | 13/45 [00:01<00:03,  9.83it/s] 33%|███▎      | 15/45 [00:01<00:02, 10.16it/s] 38%|███▊      | 17/45 [00:01<00:02, 10.32it/s] 42%|████▏     | 19/45 [00:02<00:03,  6.74it/s] 44%|████▍     | 20/45 [00:02<00:04,  5.92it/s] 47%|████▋     | 21/45 [00:07<00:29,  1.23s/it] 49%|████▉     | 22/45 [00:07<00:22,  1.03it/s] 51%|█████     | 23/45 [00:07<00:16,  1.32it/s] 53%|█████▎    | 24/45 [00:08<00:12,  1.71it/s] 56%|█████▌    | 25/45 [00:08<00:09,  2.19it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.78it/s] 60%|██████    | 27/45 [00:08<00:05,  3.45it/s] 62%|██████▏   | 28/45 [00:08<00:04,  4.23it/s] 67%|██████▋   | 30/45 [00:08<00:02,  5.74it/s] 71%|███████   | 32/45 [00:08<00:01,  7.02it/s] 76%|███████▌  | 34/45 [00:09<00:01,  8.16it/s] 80%|████████  | 36/45 [00:09<00:00,  9.12it/s] 84%|████████▍ | 38/45 [00:09<00:00,  9.88it/s] 89%|████████▉ | 40/45 [00:09<00:00, 10.68it/s] 93%|█████████▎| 42/45 [00:16<00:03,  1.18s/it] 98%|█████████▊| 44/45 [00:16<00:00,  1.18it/s]100%|██████████| 45/45 [00:19<00:00,  1.16s/it]100%|██████████| 45/45 [00:19<00:00,  2.31it/s]
2025-03-13 15:52:16,759 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:16
2025-03-13 15:54:03,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 106.6511 secs
2025-03-13 15:54:03,411 [INFO]: The best hyperparameters are: efSearch=61
2025-03-13 15:54:03,411 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 15:55:01,968 [INFO]: 	>>> Finished "Compute fast metrics" in 58.5574 secs
2025-03-13 15:55:02,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 184.9027 secs
2025-03-13 15:55:02,130 [INFO]: {
2025-03-13 15:55:02,130 [INFO]: 	index_key: HNSW32
2025-03-13 15:55:02,130 [INFO]: 	index_param: efSearch=61
2025-03-13 15:55:02,131 [INFO]: 	index_path: knn.index
2025-03-13 15:55:02,131 [INFO]: 	size in bytes: 2139296442
2025-03-13 15:55:02,131 [INFO]: 	avg_search_speed_ms: 9.009119322280156
2025-03-13 15:55:02,131 [INFO]: 	99p_search_speed_ms: 16.405589259229615
2025-03-13 15:55:02,131 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:02,131 [INFO]: 	nb vectors: 10866
2025-03-13 15:55:02,131 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:02,131 [INFO]: 	compression ratio: 0.9986192123999241
2025-03-13 15:55:02,131 [INFO]: }
2025-03-13 15:55:02,131 [INFO]: 	>>> Finished "Creating the index" in 184.9078 secs
2025-03-13 15:55:02,132 [INFO]: >>> Finished "Launching the whole pipeline" in 184.9378 secs
2025-03-13 15:55:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 48902 [episode count 9/20]
[retrieval_preprocessing] for episode 88842 [episode count 10/20], we have num_retrieval=np.int64(10671) num_query=np.int64(580)
2025-03-13 15:55:09,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:11,874 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:11
2025-03-13 15:55:11,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.72it/s]
2025-03-13 15:55:12,403 [INFO]: There are 10671 embeddings of dim 49152
2025-03-13 15:55:12,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5292 secs
2025-03-13 15:55:12,404 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:12
2025-03-13 15:55:12,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:12,404 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 15:55:12,405 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:55:12,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:55:12,405 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:12
2025-03-13 15:55:12,405 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:12,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:55:12,406 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:12
2025-03-13 15:55:12,406 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:55:12,406 [INFO]: 	Creating the index 03/13/2025, 15:55:12
2025-03-13 15:55:12,406 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:55:12
2025-03-13 15:55:12,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 15:55:12,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:12
2025-03-13 15:55:12,409 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:55:12,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:09,  4.65it/s]  7%|▋         | 3/44 [00:00<00:04,  8.27it/s] 11%|█▏        | 5/44 [00:00<00:04,  9.46it/s] 16%|█▌        | 7/44 [00:00<00:03,  9.89it/s] 20%|██        | 9/44 [00:00<00:03, 10.49it/s] 25%|██▌       | 11/44 [00:01<00:03, 10.91it/s] 30%|██▉       | 13/44 [00:01<00:02, 11.18it/s] 34%|███▍      | 15/44 [00:01<00:02, 10.05it/s] 39%|███▊      | 17/44 [00:01<00:02,  9.03it/s] 43%|████▎     | 19/44 [00:01<00:02,  9.47it/s] 48%|████▊     | 21/44 [00:08<00:24,  1.06s/it] 50%|█████     | 22/44 [00:12<00:35,  1.60s/it] 52%|█████▏    | 23/44 [00:16<00:42,  2.03s/it] 55%|█████▍    | 24/44 [00:16<00:33,  1.67s/it] 57%|█████▋    | 25/44 [00:16<00:24,  1.29s/it] 59%|█████▉    | 26/44 [00:16<00:18,  1.00s/it] 61%|██████▏   | 27/44 [00:17<00:13,  1.27it/s] 64%|██████▎   | 28/44 [00:17<00:10,  1.52it/s] 66%|██████▌   | 29/44 [00:17<00:09,  1.64it/s] 68%|██████▊   | 30/44 [00:18<00:07,  1.83it/s] 70%|███████   | 31/44 [00:18<00:05,  2.17it/s] 75%|███████▌  | 33/44 [00:21<00:10,  1.08it/s] 77%|███████▋  | 34/44 [00:22<00:09,  1.01it/s] 82%|████████▏ | 36/44 [00:22<00:05,  1.60it/s] 84%|████████▍ | 37/44 [00:23<00:03,  1.95it/s] 86%|████████▋ | 38/44 [00:23<00:02,  2.34it/s] 89%|████████▊ | 39/44 [00:23<00:01,  2.90it/s] 91%|█████████ | 40/44 [00:23<00:01,  3.59it/s] 95%|█████████▌| 42/44 [00:31<00:03,  1.98s/it]100%|██████████| 44/44 [00:34<00:00,  1.74s/it]100%|██████████| 44/44 [00:34<00:00,  1.28it/s]
2025-03-13 15:55:46,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:46
2025-03-13 15:57:22,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.9517 secs
2025-03-13 15:57:22,880 [INFO]: The best hyperparameters are: efSearch=48
2025-03-13 15:57:22,881 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.99it/s]
2025-03-13 15:58:07,540 [INFO]: 	>>> Finished "Compute fast metrics" in 44.6586 secs
2025-03-13 15:58:07,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 175.1323 secs
2025-03-13 15:58:07,542 [INFO]: {
2025-03-13 15:58:07,542 [INFO]: 	index_key: HNSW32
2025-03-13 15:58:07,542 [INFO]: 	index_param: efSearch=48
2025-03-13 15:58:07,542 [INFO]: 	index_path: knn.index
2025-03-13 15:58:07,542 [INFO]: 	size in bytes: 2100904598
2025-03-13 15:58:07,542 [INFO]: 	avg_search_speed_ms: 7.988902962039085
2025-03-13 15:58:07,542 [INFO]: 	99p_search_speed_ms: 15.252943376544865
2025-03-13 15:58:07,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:07,542 [INFO]: 	nb vectors: 10671
2025-03-13 15:58:07,542 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:07,542 [INFO]: 	compression ratio: 0.9986193423524508
2025-03-13 15:58:07,542 [INFO]: }
2025-03-13 15:58:07,542 [INFO]: 	>>> Finished "Creating the index" in 175.1362 secs
2025-03-13 15:58:07,542 [INFO]: >>> Finished "Launching the whole pipeline" in 175.6679 secs
2025-03-13 15:58:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 88842 [episode count 10/20]
[retrieval_preprocessing] for episode 2801 [episode count 11/20], we have num_retrieval=np.int64(10929) num_query=np.int64(322)
2025-03-13 15:58:11,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:13,458 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:13
2025-03-13 15:58:13,458 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 15:58:13,500 [INFO]: There are 10929 embeddings of dim 49152
2025-03-13 15:58:13,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0421 secs
2025-03-13 15:58:13,501 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:13
2025-03-13 15:58:13,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:13,501 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 15:58:13,501 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:58:13,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:58:13,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:13
2025-03-13 15:58:13,501 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:13,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:58:13,502 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:13
2025-03-13 15:58:13,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:58:13,502 [INFO]: 	Creating the index 03/13/2025, 15:58:13
2025-03-13 15:58:13,502 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:58:13
2025-03-13 15:58:13,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0020 secs
2025-03-13 15:58:13,504 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:13
2025-03-13 15:58:13,505 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 15:58:13,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  6.56it/s] 13%|█▎        | 6/45 [00:00<00:01, 25.22it/s] 24%|██▍       | 11/45 [00:00<00:01, 32.74it/s] 36%|███▌      | 16/45 [00:00<00:00, 36.49it/s] 47%|████▋     | 21/45 [00:06<00:11,  2.06it/s] 53%|█████▎    | 24/45 [00:06<00:07,  2.67it/s] 67%|██████▋   | 30/45 [00:06<00:03,  4.43it/s] 80%|████████  | 36/45 [00:06<00:01,  6.74it/s] 93%|█████████▎| 42/45 [00:14<00:01,  1.92it/s]100%|██████████| 45/45 [00:16<00:00,  1.80it/s]100%|██████████| 45/45 [00:16<00:00,  2.76it/s]
2025-03-13 15:58:29,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:29
2025-03-13 16:00:00,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.3410 secs
2025-03-13 16:00:00,157 [INFO]: The best hyperparameters are: efSearch=65
2025-03-13 16:00:00,157 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 16:00:42,574 [INFO]: 	>>> Finished "Compute fast metrics" in 42.4165 secs
2025-03-13 16:00:43,076 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.5715 secs
2025-03-13 16:00:43,076 [INFO]: {
2025-03-13 16:00:43,077 [INFO]: 	index_key: HNSW32
2025-03-13 16:00:43,077 [INFO]: 	index_param: efSearch=65
2025-03-13 16:00:43,077 [INFO]: 	index_path: knn.index
2025-03-13 16:00:43,077 [INFO]: 	size in bytes: 2151700014
2025-03-13 16:00:43,077 [INFO]: 	avg_search_speed_ms: 7.602708611112247
2025-03-13 16:00:43,077 [INFO]: 	99p_search_speed_ms: 14.381395280361168
2025-03-13 16:00:43,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:43,077 [INFO]: 	nb vectors: 10929
2025-03-13 16:00:43,077 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:43,077 [INFO]: 	compression ratio: 0.9986191467301817
2025-03-13 16:00:43,077 [INFO]: }
2025-03-13 16:00:43,077 [INFO]: 	>>> Finished "Creating the index" in 149.5749 secs
2025-03-13 16:00:43,077 [INFO]: >>> Finished "Launching the whole pipeline" in 149.6188 secs
2025-03-13 16:00:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 2801 [episode count 11/20]
[retrieval_preprocessing] for episode 69406 [episode count 12/20], we have num_retrieval=np.int64(10756) num_query=np.int64(495)
2025-03-13 16:00:49,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:50,903 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:50
2025-03-13 16:00:50,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 700.92it/s]
2025-03-13 16:00:50,945 [INFO]: There are 10756 embeddings of dim 49152
2025-03-13 16:00:50,945 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 16:00:50,945 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,945 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:50,945 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 16:00:50,945 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:00:50,945 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:00:50,945 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,946 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:50,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:00:50,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:50
2025-03-13 16:00:50,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:50,946 [INFO]: 	Creating the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,946 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:00:50
2025-03-13 16:00:50,947 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 16:00:50,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,947 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:00:50,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:07,  6.25it/s] 11%|█         | 5/45 [00:00<00:01, 20.44it/s] 22%|██▏       | 10/45 [00:00<00:01, 31.64it/s] 33%|███▎      | 15/45 [00:00<00:00, 38.09it/s] 44%|████▍     | 20/45 [00:00<00:00, 41.87it/s] 56%|█████▌    | 25/45 [00:06<00:08,  2.39it/s] 69%|██████▉   | 31/45 [00:06<00:03,  3.76it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.59it/s] 93%|█████████▎| 42/45 [00:13<00:01,  1.75it/s]100%|██████████| 45/45 [00:16<00:00,  1.62it/s]100%|██████████| 45/45 [00:16<00:00,  2.76it/s]
2025-03-13 16:01:07,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:07
2025-03-13 16:02:36,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.9663 secs
2025-03-13 16:02:36,233 [INFO]: The best hyperparameters are: efSearch=80
2025-03-13 16:02:36,233 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 16:03:27,103 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8698 secs
2025-03-13 16:03:27,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.1567 secs
2025-03-13 16:03:27,104 [INFO]: {
2025-03-13 16:03:27,104 [INFO]: 	index_key: HNSW32
2025-03-13 16:03:27,104 [INFO]: 	index_param: efSearch=80
2025-03-13 16:03:27,104 [INFO]: 	index_path: knn.index
2025-03-13 16:03:27,104 [INFO]: 	size in bytes: 2117639058
2025-03-13 16:03:27,104 [INFO]: 	avg_search_speed_ms: 6.780943254058172
2025-03-13 16:03:27,104 [INFO]: 	99p_search_speed_ms: 11.35615071747452
2025-03-13 16:03:27,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:27,104 [INFO]: 	nb vectors: 10756
2025-03-13 16:03:27,104 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:27,104 [INFO]: 	compression ratio: 0.9986194956175577
2025-03-13 16:03:27,104 [INFO]: }
2025-03-13 16:03:27,104 [INFO]: 	>>> Finished "Creating the index" in 156.1586 secs
2025-03-13 16:03:27,104 [INFO]: >>> Finished "Launching the whole pipeline" in 156.2008 secs
2025-03-13 16:03:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 69406 [episode count 12/20]
[retrieval_preprocessing] for episode 75097 [episode count 13/20], we have num_retrieval=np.int64(10677) num_query=np.int64(574)
2025-03-13 16:03:34,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:35,979 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:35
2025-03-13 16:03:35,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.48it/s]
2025-03-13 16:03:36,014 [INFO]: There are 10677 embeddings of dim 49152
2025-03-13 16:03:36,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 16:03:36,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:36
2025-03-13 16:03:36,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:36,015 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 16:03:36,015 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:03:36,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:36,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:36
2025-03-13 16:03:36,015 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:36,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:03:36,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:36
2025-03-13 16:03:36,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:36,015 [INFO]: 	Creating the index 03/13/2025, 16:03:36
2025-03-13 16:03:36,015 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:03:36
2025-03-13 16:03:36,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:03:36,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:36
2025-03-13 16:03:36,016 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:03:36,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:05,  7.39it/s] 14%|█▎        | 6/44 [00:00<00:01, 26.79it/s] 25%|██▌       | 11/44 [00:00<00:00, 35.37it/s] 39%|███▊      | 17/44 [00:00<00:00, 41.31it/s] 50%|█████     | 22/44 [00:06<00:09,  2.29it/s] 57%|█████▋    | 25/44 [00:06<00:06,  2.85it/s] 64%|██████▎   | 28/44 [00:06<00:04,  3.55it/s] 68%|██████▊   | 30/44 [00:06<00:03,  4.13it/s] 73%|███████▎  | 32/44 [00:07<00:02,  4.84it/s] 77%|███████▋  | 34/44 [00:07<00:01,  5.68it/s] 82%|████████▏ | 36/44 [00:07<00:01,  6.61it/s] 86%|████████▋ | 38/44 [00:07<00:00,  7.57it/s] 91%|█████████ | 40/44 [00:07<00:00,  8.57it/s] 95%|█████████▌| 42/44 [00:13<00:01,  1.10it/s]100%|██████████| 44/44 [00:14<00:00,  1.17it/s]100%|██████████| 44/44 [00:14<00:00,  2.95it/s]
2025-03-13 16:03:50,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:50
2025-03-13 16:05:27,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.1121 secs
2025-03-13 16:05:27,065 [INFO]: The best hyperparameters are: efSearch=53
2025-03-13 16:05:27,065 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 16:06:31,984 [INFO]: 	>>> Finished "Compute fast metrics" in 64.9192 secs
2025-03-13 16:06:31,985 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 175.9690 secs
2025-03-13 16:06:31,986 [INFO]: {
2025-03-13 16:06:31,986 [INFO]: 	index_key: HNSW32
2025-03-13 16:06:31,986 [INFO]: 	index_param: efSearch=53
2025-03-13 16:06:31,986 [INFO]: 	index_path: knn.index
2025-03-13 16:06:31,986 [INFO]: 	size in bytes: 2102085854
2025-03-13 16:06:31,986 [INFO]: 	avg_search_speed_ms: 6.74828740778825
2025-03-13 16:06:31,986 [INFO]: 	99p_search_speed_ms: 13.623001100495458
2025-03-13 16:06:31,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:31,986 [INFO]: 	nb vectors: 10677
2025-03-13 16:06:31,986 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:31,986 [INFO]: 	compression ratio: 0.9986193532512112
2025-03-13 16:06:31,986 [INFO]: }
2025-03-13 16:06:31,986 [INFO]: 	>>> Finished "Creating the index" in 175.9705 secs
2025-03-13 16:06:31,986 [INFO]: >>> Finished "Launching the whole pipeline" in 176.0065 secs
2025-03-13 16:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 75097 [episode count 13/20]
[retrieval_preprocessing] for episode 54974 [episode count 14/20], we have num_retrieval=np.int64(10914) num_query=np.int64(337)
2025-03-13 16:06:35,966 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:37,286 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:37
2025-03-13 16:06:37,287 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1578.59it/s]
2025-03-13 16:06:37,316 [INFO]: There are 10914 embeddings of dim 49152
2025-03-13 16:06:37,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 16:06:37,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:37
2025-03-13 16:06:37,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:37,317 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:06:37,317 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:06:37,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:37,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:37
2025-03-13 16:06:37,317 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:37,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:06:37,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:37
2025-03-13 16:06:37,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:37,317 [INFO]: 	Creating the index 03/13/2025, 16:06:37
2025-03-13 16:06:37,317 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:06:37
2025-03-13 16:06:37,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:06:37,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:37
2025-03-13 16:06:37,318 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:06:37,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:05,  7.64it/s] 13%|█▎        | 6/45 [00:00<00:01, 29.22it/s] 24%|██▍       | 11/45 [00:00<00:00, 37.66it/s] 36%|███▌      | 16/45 [00:00<00:00, 40.45it/s] 47%|████▋     | 21/45 [00:05<00:09,  2.46it/s] 58%|█████▊    | 26/45 [00:05<00:05,  3.71it/s] 71%|███████   | 32/45 [00:05<00:02,  5.73it/s] 84%|████████▍ | 38/45 [00:05<00:00,  8.35it/s] 96%|█████████▌| 43/45 [00:12<00:00,  2.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.02it/s]
2025-03-13 16:06:52,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:52
2025-03-13 16:08:26,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 94.2129 secs
2025-03-13 16:08:26,423 [INFO]: The best hyperparameters are: efSearch=74
2025-03-13 16:08:26,423 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-13 16:08:56,545 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1220 secs
2025-03-13 16:08:56,546 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.2283 secs
2025-03-13 16:08:56,547 [INFO]: {
2025-03-13 16:08:56,547 [INFO]: 	index_key: HNSW32
2025-03-13 16:08:56,547 [INFO]: 	index_param: efSearch=74
2025-03-13 16:08:56,547 [INFO]: 	index_path: knn.index
2025-03-13 16:08:56,547 [INFO]: 	size in bytes: 2148746746
2025-03-13 16:08:56,547 [INFO]: 	avg_search_speed_ms: 7.424031664308302
2025-03-13 16:08:56,547 [INFO]: 	99p_search_speed_ms: 12.495196340605615
2025-03-13 16:08:56,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:56,547 [INFO]: 	nb vectors: 10914
2025-03-13 16:08:56,547 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:56,547 [INFO]: 	compression ratio: 0.9986191792934541
2025-03-13 16:08:56,547 [INFO]: }
2025-03-13 16:08:56,547 [INFO]: 	>>> Finished "Creating the index" in 139.2304 secs
2025-03-13 16:08:56,548 [INFO]: >>> Finished "Launching the whole pipeline" in 139.2610 secs
2025-03-13 16:08:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 54974 [episode count 14/20]
[retrieval_preprocessing] for episode 14189 [episode count 15/20], we have num_retrieval=np.int64(10580) num_query=np.int64(671)
2025-03-13 16:08:59,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:01,372 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:01
2025-03-13 16:09:01,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.57it/s]
2025-03-13 16:09:01,410 [INFO]: There are 10580 embeddings of dim 49152
2025-03-13 16:09:01,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 16:09:01,411 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:01
2025-03-13 16:09:01,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:01,411 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 16:09:01,411 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:09:01,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:09:01,411 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:01
2025-03-13 16:09:01,411 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:01,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:09:01,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:01
2025-03-13 16:09:01,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:01,411 [INFO]: 	Creating the index 03/13/2025, 16:09:01
2025-03-13 16:09:01,411 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:09:01
2025-03-13 16:09:01,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 16:09:01,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:01
2025-03-13 16:09:01,413 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:09:01,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:05,  8.32it/s] 14%|█▎        | 6/44 [00:00<00:01, 28.36it/s] 27%|██▋       | 12/44 [00:00<00:00, 38.63it/s] 41%|████      | 18/44 [00:00<00:00, 43.79it/s] 52%|█████▏    | 23/44 [00:05<00:07,  2.81it/s] 64%|██████▎   | 28/44 [00:05<00:03,  4.11it/s] 75%|███████▌  | 33/44 [00:05<00:01,  5.82it/s] 86%|████████▋ | 38/44 [00:05<00:00,  8.07it/s] 98%|█████████▊| 43/44 [00:11<00:00,  2.12it/s]100%|██████████| 44/44 [00:13<00:00,  3.37it/s]
2025-03-13 16:09:14,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:14
2025-03-13 16:10:33,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.2026 secs
2025-03-13 16:10:33,680 [INFO]: The best hyperparameters are: efSearch=68
2025-03-13 16:10:33,681 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.79it/s]
2025-03-13 16:11:07,533 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8527 secs
2025-03-13 16:11:07,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.1216 secs
2025-03-13 16:11:07,534 [INFO]: {
2025-03-13 16:11:07,534 [INFO]: 	index_key: HNSW32
2025-03-13 16:11:07,534 [INFO]: 	index_param: efSearch=68
2025-03-13 16:11:07,534 [INFO]: 	index_path: knn.index
2025-03-13 16:11:07,534 [INFO]: 	size in bytes: 2082988626
2025-03-13 16:11:07,534 [INFO]: 	avg_search_speed_ms: 7.790594186918154
2025-03-13 16:11:07,534 [INFO]: 	99p_search_speed_ms: 14.301259031053632
2025-03-13 16:11:07,534 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:07,534 [INFO]: 	nb vectors: 10580
2025-03-13 16:11:07,534 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:07,535 [INFO]: 	compression ratio: 0.9986192982697545
2025-03-13 16:11:07,535 [INFO]: }
2025-03-13 16:11:07,535 [INFO]: 	>>> Finished "Creating the index" in 126.1233 secs
2025-03-13 16:11:07,535 [INFO]: >>> Finished "Launching the whole pipeline" in 126.1625 secs
2025-03-13 16:11:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 14189 [episode count 15/20]
[retrieval_preprocessing] for episode 31087 [episode count 16/20], we have num_retrieval=np.int64(10983) num_query=np.int64(268)
2025-03-13 16:11:13,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:15,057 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:15
2025-03-13 16:11:15,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 16:11:15,094 [INFO]: There are 10983 embeddings of dim 49152
2025-03-13 16:11:15,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 16:11:15,095 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:15
2025-03-13 16:11:15,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:15,095 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:11:15,095 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:11:15,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:11:15,095 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:15
2025-03-13 16:11:15,095 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:15,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:11:15,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:15
2025-03-13 16:11:15,095 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:15,095 [INFO]: 	Creating the index 03/13/2025, 16:11:15
2025-03-13 16:11:15,095 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:11:15
2025-03-13 16:11:15,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 16:11:15,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:15
2025-03-13 16:11:15,096 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:11:15,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.99it/s] 11%|█         | 5/46 [00:00<00:01, 21.97it/s] 22%|██▏       | 10/46 [00:00<00:01, 30.85it/s] 33%|███▎      | 15/46 [00:00<00:00, 35.16it/s] 43%|████▎     | 20/46 [00:00<00:00, 37.58it/s] 52%|█████▏    | 24/46 [00:07<00:11,  1.86it/s] 59%|█████▊    | 27/46 [00:07<00:08,  2.30it/s] 63%|██████▎   | 29/46 [00:07<00:06,  2.66it/s] 67%|██████▋   | 31/46 [00:08<00:04,  3.12it/s] 72%|███████▏  | 33/46 [00:08<00:03,  3.67it/s] 76%|███████▌  | 35/46 [00:08<00:02,  4.34it/s] 80%|████████  | 37/46 [00:08<00:01,  5.08it/s] 85%|████████▍ | 39/46 [00:08<00:01,  5.92it/s] 89%|████████▉ | 41/46 [00:09<00:00,  6.71it/s] 93%|█████████▎| 43/46 [00:17<00:03,  1.30s/it] 96%|█████████▌| 44/46 [00:17<00:02,  1.10s/it] 98%|█████████▊| 45/46 [00:17<00:00,  1.11it/s]100%|██████████| 46/46 [00:21<00:00,  1.45s/it]100%|██████████| 46/46 [00:21<00:00,  2.18it/s]
2025-03-13 16:11:36,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:36
2025-03-13 16:13:22,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 106.4335 secs
2025-03-13 16:13:22,650 [INFO]: The best hyperparameters are: efSearch=76
2025-03-13 16:13:22,650 [INFO]: 	Compute fast metrics 03/13/2025, 16:13:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.77s/it] 50%|█████     | 2/4 [00:03<00:03,  1.75s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.75s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.77s/it]
2025-03-13 16:14:06,050 [INFO]: 	>>> Finished "Compute fast metrics" in 43.4000 secs
2025-03-13 16:14:06,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 170.9552 secs
2025-03-13 16:14:06,052 [INFO]: {
2025-03-13 16:14:06,052 [INFO]: 	index_key: HNSW32
2025-03-13 16:14:06,052 [INFO]: 	index_param: efSearch=76
2025-03-13 16:14:06,052 [INFO]: 	index_path: knn.index
2025-03-13 16:14:06,052 [INFO]: 	size in bytes: 2162331446
2025-03-13 16:14:06,052 [INFO]: 	avg_search_speed_ms: 8.775402028971401
2025-03-13 16:14:06,052 [INFO]: 	99p_search_speed_ms: 23.41234044404698
2025-03-13 16:14:06,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:06,052 [INFO]: 	nb vectors: 10983
2025-03-13 16:14:06,052 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:06,052 [INFO]: 	compression ratio: 0.9986191839343024
2025-03-13 16:14:06,052 [INFO]: }
2025-03-13 16:14:06,052 [INFO]: 	>>> Finished "Creating the index" in 170.9568 secs
2025-03-13 16:14:06,052 [INFO]: >>> Finished "Launching the whole pipeline" in 170.9952 secs
2025-03-13 16:14:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 31087 [episode count 16/20]
[retrieval_preprocessing] for episode 25977 [episode count 17/20], we have num_retrieval=np.int64(10684) num_query=np.int64(567)
2025-03-13 16:14:18,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:20,321 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:20
2025-03-13 16:14:20,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1090.85it/s]
2025-03-13 16:14:20,360 [INFO]: There are 10684 embeddings of dim 49152
2025-03-13 16:14:20,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 16:14:20,361 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:20
2025-03-13 16:14:20,361 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:20,361 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 16:14:20,361 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:14:20,361 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:20,361 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:20
2025-03-13 16:14:20,361 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:20,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:20,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:20
2025-03-13 16:14:20,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:20,361 [INFO]: 	Creating the index 03/13/2025, 16:14:20
2025-03-13 16:14:20,361 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:14:20
2025-03-13 16:14:20,362 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:14:20,362 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:20
2025-03-13 16:14:20,362 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:14:20,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:04<03:08,  4.27s/it]  4%|▍         | 2/45 [00:06<02:00,  2.80s/it] 16%|█▌        | 7/45 [00:06<00:21,  1.79it/s] 24%|██▍       | 11/45 [00:06<00:10,  3.30it/s] 36%|███▌      | 16/45 [00:06<00:05,  5.74it/s] 47%|████▋     | 21/45 [00:11<00:12,  1.94it/s] 56%|█████▌    | 25/45 [00:11<00:07,  2.75it/s] 67%|██████▋   | 30/45 [00:11<00:03,  4.13it/s] 76%|███████▌  | 34/45 [00:11<00:01,  5.58it/s] 84%|████████▍ | 38/45 [00:12<00:00,  7.45it/s] 93%|█████████▎| 42/45 [00:20<00:02,  1.42it/s]100%|██████████| 45/45 [00:22<00:00,  1.47it/s]100%|██████████| 45/45 [00:22<00:00,  2.04it/s]
2025-03-13 16:14:42,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:42
2025-03-13 16:16:25,430 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.7035 secs
2025-03-13 16:16:25,430 [INFO]: The best hyperparameters are: efSearch=86
2025-03-13 16:16:25,430 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s]
2025-03-13 16:17:40,788 [INFO]: 	>>> Finished "Compute fast metrics" in 75.3577 secs
2025-03-13 16:17:41,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 201.1890 secs
2025-03-13 16:17:41,552 [INFO]: {
2025-03-13 16:17:41,552 [INFO]: 	index_key: HNSW32
2025-03-13 16:17:41,552 [INFO]: 	index_param: efSearch=86
2025-03-13 16:17:41,552 [INFO]: 	index_path: knn.index
2025-03-13 16:17:41,552 [INFO]: 	size in bytes: 2103463986
2025-03-13 16:17:41,552 [INFO]: 	avg_search_speed_ms: 11.898035854079033
2025-03-13 16:17:41,552 [INFO]: 	99p_search_speed_ms: 23.33191800862553
2025-03-13 16:17:41,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:41,552 [INFO]: 	nb vectors: 10684
2025-03-13 16:17:41,552 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:41,552 [INFO]: 	compression ratio: 0.9986193659509605
2025-03-13 16:17:41,552 [INFO]: }
2025-03-13 16:17:41,552 [INFO]: 	>>> Finished "Creating the index" in 201.1912 secs
2025-03-13 16:17:41,552 [INFO]: >>> Finished "Launching the whole pipeline" in 201.2318 secs
2025-03-13 16:17:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 25977 [episode count 17/20]
[retrieval_preprocessing] for episode 12671 [episode count 18/20], we have num_retrieval=np.int64(10622) num_query=np.int64(629)
2025-03-13 16:17:46,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:48,384 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:48
2025-03-13 16:17:48,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1490.51it/s]
2025-03-13 16:17:48,420 [INFO]: There are 10622 embeddings of dim 49152
2025-03-13 16:17:48,420 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 16:17:48,420 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:48,420 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 16:17:48,420 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:17:48,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:48,420 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,421 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:48,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:48,421 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:48
2025-03-13 16:17:48,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:48,421 [INFO]: 	Creating the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,421 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:17:48
2025-03-13 16:17:48,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:17:48,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:48
2025-03-13 16:17:48,422 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:17:48,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:12,  3.45it/s] 14%|█▎        | 6/44 [00:00<00:02, 18.23it/s] 25%|██▌       | 11/44 [00:00<00:01, 27.13it/s] 36%|███▋      | 16/44 [00:00<00:00, 31.84it/s] 45%|████▌     | 20/44 [00:00<00:00, 34.18it/s] 55%|█████▍    | 24/44 [00:08<00:13,  1.53it/s] 61%|██████▏   | 27/44 [00:08<00:08,  2.01it/s] 68%|██████▊   | 30/44 [00:09<00:05,  2.55it/s] 73%|███████▎  | 32/44 [00:09<00:03,  3.01it/s] 80%|███████▉  | 35/44 [00:09<00:02,  3.97it/s] 84%|████████▍ | 37/44 [00:09<00:01,  4.84it/s] 89%|████████▊ | 39/44 [00:09<00:00,  5.91it/s] 93%|█████████▎| 41/44 [00:09<00:00,  7.18it/s] 98%|█████████▊| 43/44 [00:18<00:01,  1.24s/it]100%|██████████| 44/44 [00:19<00:00,  2.21it/s]
2025-03-13 16:18:08,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:08
2025-03-13 16:19:25,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.2959 secs
2025-03-13 16:19:25,680 [INFO]: The best hyperparameters are: efSearch=65
2025-03-13 16:19:25,680 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.58it/s]
2025-03-13 16:20:24,320 [INFO]: 	>>> Finished "Compute fast metrics" in 58.6395 secs
2025-03-13 16:20:24,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.8987 secs
2025-03-13 16:20:24,321 [INFO]: {
2025-03-13 16:20:24,321 [INFO]: 	index_key: HNSW32
2025-03-13 16:20:24,321 [INFO]: 	index_param: efSearch=65
2025-03-13 16:20:24,321 [INFO]: 	index_path: knn.index
2025-03-13 16:20:24,321 [INFO]: 	size in bytes: 2091257418
2025-03-13 16:20:24,321 [INFO]: 	avg_search_speed_ms: 8.297074079722227
2025-03-13 16:20:24,321 [INFO]: 	99p_search_speed_ms: 13.172013591974975
2025-03-13 16:20:24,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:24,321 [INFO]: 	nb vectors: 10622
2025-03-13 16:20:24,321 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:24,321 [INFO]: 	compression ratio: 0.9986193751304125
2025-03-13 16:20:24,321 [INFO]: }
2025-03-13 16:20:24,321 [INFO]: 	>>> Finished "Creating the index" in 155.9001 secs
2025-03-13 16:20:24,321 [INFO]: >>> Finished "Launching the whole pipeline" in 155.9363 secs
2025-03-13 16:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 12671 [episode count 18/20]
[retrieval_preprocessing] for episode 21377 [episode count 19/20], we have num_retrieval=np.int64(10392) num_query=np.int64(859)
2025-03-13 16:20:31,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:34,122 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:34
2025-03-13 16:20:34,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 913.79it/s]
2025-03-13 16:20:34,167 [INFO]: There are 10392 embeddings of dim 49152
2025-03-13 16:20:34,167 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0452 secs
2025-03-13 16:20:34,167 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:34
2025-03-13 16:20:34,167 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:34,167 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 16:20:34,167 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:20:34,167 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:20:34,167 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:34
2025-03-13 16:20:34,168 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:34,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:20:34,168 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:34
2025-03-13 16:20:34,168 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:34,168 [INFO]: 	Creating the index 03/13/2025, 16:20:34
2025-03-13 16:20:34,168 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:20:34
2025-03-13 16:20:34,169 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:20:34,169 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:34
2025-03-13 16:20:34,169 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:20:34,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.48it/s]  7%|▋         | 3/43 [00:00<00:03, 10.25it/s] 14%|█▍        | 6/43 [00:00<00:02, 15.22it/s] 23%|██▎       | 10/43 [00:00<00:01, 20.97it/s] 33%|███▎      | 14/43 [00:00<00:01, 24.30it/s] 40%|███▉      | 17/43 [00:00<00:01, 25.79it/s] 49%|████▉     | 21/43 [00:06<00:12,  1.78it/s] 60%|██████    | 26/43 [00:06<00:05,  2.91it/s] 72%|███████▏  | 31/43 [00:06<00:02,  4.42it/s] 84%|████████▎ | 36/43 [00:06<00:01,  6.43it/s] 95%|█████████▌| 41/43 [00:06<00:00,  9.00it/s]100%|██████████| 43/43 [00:14<00:00,  2.94it/s]
2025-03-13 16:20:48,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:48
2025-03-13 16:22:03,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.0779 secs
2025-03-13 16:22:03,866 [INFO]: The best hyperparameters are: efSearch=62
2025-03-13 16:22:03,866 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-13 16:23:14,366 [INFO]: 	>>> Finished "Compute fast metrics" in 70.4996 secs
2025-03-13 16:23:14,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.1977 secs
2025-03-13 16:23:14,367 [INFO]: {
2025-03-13 16:23:14,367 [INFO]: 	index_key: HNSW32
2025-03-13 16:23:14,367 [INFO]: 	index_param: efSearch=62
2025-03-13 16:23:14,367 [INFO]: 	index_path: knn.index
2025-03-13 16:23:14,367 [INFO]: 	size in bytes: 2045974914
2025-03-13 16:23:14,367 [INFO]: 	avg_search_speed_ms: 7.0599784879250675
2025-03-13 16:23:14,367 [INFO]: 	99p_search_speed_ms: 11.56299239955842
2025-03-13 16:23:14,367 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:14,367 [INFO]: 	nb vectors: 10392
2025-03-13 16:23:14,367 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:14,367 [INFO]: 	compression ratio: 0.9986194464161451
2025-03-13 16:23:14,367 [INFO]: }
2025-03-13 16:23:14,367 [INFO]: 	>>> Finished "Creating the index" in 160.1997 secs
2025-03-13 16:23:14,367 [INFO]: >>> Finished "Launching the whole pipeline" in 160.2456 secs
2025-03-13 16:23:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 21377 [episode count 19/20]
2025-03-13 16:23:22: [retrieval_preprocessing] finished for 4385851547_Place Plate in Dishwasher [chosen_id count 2/196]
2025-03-13 16:23:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 440287856_put_black_objects_in_drawer_and_close [chosen_id count 3/196]
2025-03-13 16:23:24: [retrieval_preprocessing] we have num_total=11537 embedding_dim=49152
[retrieval_preprocessing] for episode 25090 [episode count 0/20], we have num_retrieval=np.int64(10952) num_query=np.int64(585)
2025-03-13 16:23:25,003 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:26,416 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:26
2025-03-13 16:23:26,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1275.64it/s]
2025-03-13 16:23:26,452 [INFO]: There are 10952 embeddings of dim 49152
2025-03-13 16:23:26,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 16:23:26,452 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:26
2025-03-13 16:23:26,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:26,452 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:23:26,452 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:23:26,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:26,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:26
2025-03-13 16:23:26,452 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:26,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:26,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:26
2025-03-13 16:23:26,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:26,453 [INFO]: 	Creating the index 03/13/2025, 16:23:26
2025-03-13 16:23:26,453 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:23:26
2025-03-13 16:23:26,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:23:26,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:26
2025-03-13 16:23:26,454 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:23:26,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  8.43it/s] 11%|█         | 5/46 [00:00<00:01, 24.83it/s] 22%|██▏       | 10/46 [00:00<00:01, 33.71it/s] 33%|███▎      | 15/46 [00:00<00:00, 37.65it/s] 43%|████▎     | 20/46 [00:00<00:00, 40.45it/s] 54%|█████▍    | 25/46 [00:07<00:10,  1.97it/s] 65%|██████▌   | 30/46 [00:07<00:05,  2.92it/s] 76%|███████▌  | 35/46 [00:07<00:02,  4.22it/s] 87%|████████▋ | 40/46 [00:07<00:01,  5.94it/s] 98%|█████████▊| 45/46 [00:17<00:00,  1.33it/s]100%|██████████| 46/46 [00:20<00:00,  1.13it/s]100%|██████████| 46/46 [00:20<00:00,  2.28it/s]
2025-03-13 16:23:46,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:46
2025-03-13 16:25:38,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 112.2483 secs
2025-03-13 16:25:38,894 [INFO]: The best hyperparameters are: efSearch=83
2025-03-13 16:25:38,894 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 16:26:59,110 [INFO]: 	>>> Finished "Compute fast metrics" in 80.2160 secs
2025-03-13 16:26:59,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 212.6578 secs
2025-03-13 16:26:59,112 [INFO]: {
2025-03-13 16:26:59,112 [INFO]: 	index_key: HNSW32
2025-03-13 16:26:59,112 [INFO]: 	index_param: efSearch=83
2025-03-13 16:26:59,112 [INFO]: 	index_path: knn.index
2025-03-13 16:26:59,112 [INFO]: 	size in bytes: 2156228290
2025-03-13 16:26:59,112 [INFO]: 	avg_search_speed_ms: 11.303667678881837
2025-03-13 16:26:59,112 [INFO]: 	99p_search_speed_ms: 19.304129332303997
2025-03-13 16:26:59,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:59,112 [INFO]: 	nb vectors: 10952
2025-03-13 16:26:59,112 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:59,112 [INFO]: 	compression ratio: 0.9986191285895799
2025-03-13 16:26:59,112 [INFO]: }
2025-03-13 16:26:59,112 [INFO]: 	>>> Finished "Creating the index" in 212.6593 secs
2025-03-13 16:26:59,112 [INFO]: >>> Finished "Launching the whole pipeline" in 212.6958 secs
2025-03-13 16:27:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 25090 [episode count 0/20]
[retrieval_preprocessing] for episode 26631 [episode count 1/20], we have num_retrieval=np.int64(11009) num_query=np.int64(528)
2025-03-13 16:27:04,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:08,329 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:08
2025-03-13 16:27:08,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.17it/s]
2025-03-13 16:27:08,376 [INFO]: There are 11009 embeddings of dim 49152
2025-03-13 16:27:08,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0473 secs
2025-03-13 16:27:08,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:08,377 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:27:08,377 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:27:08,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:27:08,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,378 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:08,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:27:08,378 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:08
2025-03-13 16:27:08,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:27:08,379 [INFO]: 	Creating the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,379 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:27:08
2025-03-13 16:27:08,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0021 secs
2025-03-13 16:27:08,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:08
2025-03-13 16:27:08,382 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:27:08,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  6.19it/s]  9%|▊         | 4/46 [00:00<00:02, 17.24it/s] 17%|█▋        | 8/46 [00:00<00:01, 25.45it/s] 26%|██▌       | 12/46 [00:00<00:01, 29.70it/s] 35%|███▍      | 16/46 [00:00<00:00, 31.98it/s] 43%|████▎     | 20/46 [00:00<00:00, 33.77it/s] 52%|█████▏    | 24/46 [00:11<00:20,  1.06it/s] 63%|██████▎   | 29/46 [00:11<00:10,  1.68it/s] 74%|███████▍  | 34/46 [00:11<00:04,  2.53it/s] 85%|████████▍ | 39/46 [00:11<00:01,  3.70it/s] 96%|█████████▌| 44/46 [00:21<00:01,  1.20it/s]100%|██████████| 46/46 [00:24<00:00,  1.10it/s]100%|██████████| 46/46 [00:24<00:00,  1.87it/s]
2025-03-13 16:27:32,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:32
2025-03-13 16:28:50,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.6342 secs
2025-03-13 16:28:50,595 [INFO]: The best hyperparameters are: efSearch=66
2025-03-13 16:28:50,595 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.54it/s]
2025-03-13 16:29:46,280 [INFO]: 	>>> Finished "Compute fast metrics" in 55.6843 secs
2025-03-13 16:29:46,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 157.8992 secs
2025-03-13 16:29:46,281 [INFO]: {
2025-03-13 16:29:46,281 [INFO]: 	index_key: HNSW32
2025-03-13 16:29:46,281 [INFO]: 	index_param: efSearch=66
2025-03-13 16:29:46,281 [INFO]: 	index_path: knn.index
2025-03-13 16:29:46,281 [INFO]: 	size in bytes: 2167450478
2025-03-13 16:29:46,281 [INFO]: 	avg_search_speed_ms: 12.70617467080263
2025-03-13 16:29:46,281 [INFO]: 	99p_search_speed_ms: 25.63071569427848
2025-03-13 16:29:46,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:46,281 [INFO]: 	nb vectors: 11009
2025-03-13 16:29:46,281 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:46,281 [INFO]: 	compression ratio: 0.9986191121640935
2025-03-13 16:29:46,281 [INFO]: }
2025-03-13 16:29:46,281 [INFO]: 	>>> Finished "Creating the index" in 157.9024 secs
2025-03-13 16:29:46,281 [INFO]: >>> Finished "Launching the whole pipeline" in 157.9523 secs
2025-03-13 16:29:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 26631 [episode count 1/20]
[retrieval_preprocessing] for episode 27146 [episode count 2/20], we have num_retrieval=np.int64(11117) num_query=np.int64(420)
2025-03-13 16:29:50,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:52,335 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:52
2025-03-13 16:29:52,335 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.52it/s]
2025-03-13 16:29:52,371 [INFO]: There are 11117 embeddings of dim 49152
2025-03-13 16:29:52,371 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 16:29:52,371 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:52
2025-03-13 16:29:52,371 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:52,371 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 16:29:52,371 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:29:52,371 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:52,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:52
2025-03-13 16:29:52,372 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:52,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:52,372 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:52
2025-03-13 16:29:52,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:52,372 [INFO]: 	Creating the index 03/13/2025, 16:29:52
2025-03-13 16:29:52,372 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:29:52
2025-03-13 16:29:52,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0017 secs
2025-03-13 16:29:52,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:52
2025-03-13 16:29:52,374 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:29:52,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.82it/s] 11%|█         | 5/46 [00:00<00:01, 22.61it/s] 20%|█▉        | 9/46 [00:00<00:01, 28.58it/s] 28%|██▊       | 13/46 [00:00<00:01, 31.43it/s] 37%|███▋      | 17/46 [00:00<00:00, 32.87it/s] 46%|████▌     | 21/46 [00:09<00:19,  1.29it/s] 54%|█████▍    | 25/46 [00:09<00:10,  1.91it/s] 65%|██████▌   | 30/46 [00:09<00:05,  2.97it/s] 76%|███████▌  | 35/46 [00:09<00:02,  4.41it/s] 85%|████████▍ | 39/46 [00:09<00:01,  5.85it/s] 93%|█████████▎| 43/46 [00:19<00:02,  1.22it/s]100%|██████████| 46/46 [00:22<00:00,  1.09it/s]100%|██████████| 46/46 [00:22<00:00,  2.01it/s]
2025-03-13 16:30:15,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:15
2025-03-13 16:31:40,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.9091 secs
2025-03-13 16:31:40,182 [INFO]: The best hyperparameters are: efSearch=54
2025-03-13 16:31:40,182 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 16:32:35,423 [INFO]: 	>>> Finished "Compute fast metrics" in 55.2410 secs
2025-03-13 16:32:35,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.0508 secs
2025-03-13 16:32:35,425 [INFO]: {
2025-03-13 16:32:35,425 [INFO]: 	index_key: HNSW32
2025-03-13 16:32:35,425 [INFO]: 	index_param: efSearch=54
2025-03-13 16:32:35,425 [INFO]: 	index_path: knn.index
2025-03-13 16:32:35,425 [INFO]: 	size in bytes: 2188713982
2025-03-13 16:32:35,425 [INFO]: 	avg_search_speed_ms: 8.209612222628481
2025-03-13 16:32:35,425 [INFO]: 	99p_search_speed_ms: 13.133796753827479
2025-03-13 16:32:35,425 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:35,425 [INFO]: 	nb vectors: 11117
2025-03-13 16:32:35,425 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:35,425 [INFO]: 	compression ratio: 0.9986188940058592
2025-03-13 16:32:35,425 [INFO]: }
2025-03-13 16:32:35,425 [INFO]: 	>>> Finished "Creating the index" in 163.0533 secs
2025-03-13 16:32:35,425 [INFO]: >>> Finished "Launching the whole pipeline" in 163.0902 secs
2025-03-13 16:32:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 27146 [episode count 2/20]
[retrieval_preprocessing] for episode 39442 [episode count 3/20], we have num_retrieval=np.int64(10935) num_query=np.int64(602)
2025-03-13 16:32:42,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:44,372 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:44
2025-03-13 16:32:44,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1970.08it/s]
2025-03-13 16:32:44,410 [INFO]: There are 10935 embeddings of dim 49152
2025-03-13 16:32:44,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 16:32:44,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:44
2025-03-13 16:32:44,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:44,410 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:32:44,410 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:32:44,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:32:44,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:44
2025-03-13 16:32:44,411 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:44,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:32:44,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:44
2025-03-13 16:32:44,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:44,411 [INFO]: 	Creating the index 03/13/2025, 16:32:44
2025-03-13 16:32:44,411 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:32:44
2025-03-13 16:32:44,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0016 secs
2025-03-13 16:32:44,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:44
2025-03-13 16:32:44,413 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:32:44,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.44it/s] 13%|█▎        | 6/46 [00:00<00:01, 28.18it/s] 24%|██▍       | 11/46 [00:00<00:00, 35.89it/s] 35%|███▍      | 16/46 [00:00<00:00, 38.88it/s] 46%|████▌     | 21/46 [00:07<00:13,  1.81it/s] 54%|█████▍    | 25/46 [00:07<00:08,  2.55it/s] 65%|██████▌   | 30/46 [00:07<00:04,  3.82it/s] 76%|███████▌  | 35/46 [00:07<00:02,  5.49it/s] 87%|████████▋ | 40/46 [00:07<00:00,  7.63it/s] 96%|█████████▌| 44/46 [00:16<00:01,  1.54it/s]100%|██████████| 46/46 [00:18<00:00,  2.50it/s]
2025-03-13 16:33:02,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:02
2025-03-13 16:34:31,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.7794 secs
2025-03-13 16:34:31,589 [INFO]: The best hyperparameters are: efSearch=62
2025-03-13 16:34:31,589 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 16:35:13,234 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6447 secs
2025-03-13 16:35:13,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.8220 secs
2025-03-13 16:35:13,235 [INFO]: {
2025-03-13 16:35:13,235 [INFO]: 	index_key: HNSW32
2025-03-13 16:35:13,235 [INFO]: 	index_param: efSearch=62
2025-03-13 16:35:13,235 [INFO]: 	index_path: knn.index
2025-03-13 16:35:13,235 [INFO]: 	size in bytes: 2152881398
2025-03-13 16:35:13,235 [INFO]: 	avg_search_speed_ms: 10.647273352925087
2025-03-13 16:35:13,235 [INFO]: 	99p_search_speed_ms: 20.22893871180713
2025-03-13 16:35:13,235 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:13,235 [INFO]: 	nb vectors: 10935
2025-03-13 16:35:13,235 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:13,235 [INFO]: 	compression ratio: 0.9986190981060258
2025-03-13 16:35:13,235 [INFO]: }
2025-03-13 16:35:13,235 [INFO]: 	>>> Finished "Creating the index" in 148.8242 secs
2025-03-13 16:35:13,235 [INFO]: >>> Finished "Launching the whole pipeline" in 148.8630 secs
2025-03-13 16:35:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 39442 [episode count 3/20]
[retrieval_preprocessing] for episode 70173 [episode count 4/20], we have num_retrieval=np.int64(10553) num_query=np.int64(984)
2025-03-13 16:35:18,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:19,606 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:19
2025-03-13 16:35:19,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 16:35:19,640 [INFO]: There are 10553 embeddings of dim 49152
2025-03-13 16:35:19,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 16:35:19,640 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:19
2025-03-13 16:35:19,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:19,640 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 16:35:19,640 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:35:19,640 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:19,640 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:19
2025-03-13 16:35:19,640 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:19,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:35:19,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:19
2025-03-13 16:35:19,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:19,640 [INFO]: 	Creating the index 03/13/2025, 16:35:19
2025-03-13 16:35:19,640 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:35:19
2025-03-13 16:35:19,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:35:19,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:19
2025-03-13 16:35:19,641 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:35:19,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:06,  6.57it/s] 14%|█▎        | 6/44 [00:00<00:01, 25.64it/s] 27%|██▋       | 12/44 [00:00<00:00, 36.48it/s] 41%|████      | 18/44 [00:00<00:00, 41.79it/s] 52%|█████▏    | 23/44 [00:06<00:08,  2.40it/s] 64%|██████▎   | 28/44 [00:06<00:04,  3.54it/s] 77%|███████▋  | 34/44 [00:06<00:01,  5.37it/s] 93%|█████████▎| 41/44 [00:06<00:00,  8.20it/s]100%|██████████| 44/44 [00:14<00:00,  3.06it/s]
2025-03-13 16:35:34,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:34
2025-03-13 16:36:59,527 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4968 secs
2025-03-13 16:36:59,527 [INFO]: The best hyperparameters are: efSearch=38
2025-03-13 16:36:59,527 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 16:38:00,905 [INFO]: 	>>> Finished "Compute fast metrics" in 61.3778 secs
2025-03-13 16:38:00,906 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.2646 secs
2025-03-13 16:38:00,906 [INFO]: {
2025-03-13 16:38:00,906 [INFO]: 	index_key: HNSW32
2025-03-13 16:38:00,906 [INFO]: 	index_param: efSearch=38
2025-03-13 16:38:00,906 [INFO]: 	index_path: knn.index
2025-03-13 16:38:00,906 [INFO]: 	size in bytes: 2077672974
2025-03-13 16:38:00,906 [INFO]: 	avg_search_speed_ms: 6.021687754497202
2025-03-13 16:38:00,906 [INFO]: 	99p_search_speed_ms: 10.025011810939768
2025-03-13 16:38:00,906 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:00,906 [INFO]: 	nb vectors: 10553
2025-03-13 16:38:00,906 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:00,906 [INFO]: 	compression ratio: 0.9986192485362714
2025-03-13 16:38:00,906 [INFO]: }
2025-03-13 16:38:00,906 [INFO]: 	>>> Finished "Creating the index" in 161.2660 secs
2025-03-13 16:38:00,906 [INFO]: >>> Finished "Launching the whole pipeline" in 161.3007 secs
2025-03-13 16:38:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 70173 [episode count 4/20]
[retrieval_preprocessing] for episode 31264 [episode count 5/20], we have num_retrieval=np.int64(11158) num_query=np.int64(379)
2025-03-13 16:38:06,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:08,662 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:08
2025-03-13 16:38:08,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2000.14it/s]
2025-03-13 16:38:08,699 [INFO]: There are 11158 embeddings of dim 49152
2025-03-13 16:38:08,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 16:38:08,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:08
2025-03-13 16:38:08,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:08,699 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 16:38:08,699 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:38:08,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:08,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:08
2025-03-13 16:38:08,699 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:08,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:38:08,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:08
2025-03-13 16:38:08,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:08,699 [INFO]: 	Creating the index 03/13/2025, 16:38:08
2025-03-13 16:38:08,699 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:38:08
2025-03-13 16:38:08,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:38:08,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:08
2025-03-13 16:38:08,701 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:38:08,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  6.32it/s]  7%|▋         | 3/46 [00:00<00:03, 12.58it/s] 15%|█▌        | 7/46 [00:00<00:01, 23.39it/s] 24%|██▍       | 11/46 [00:00<00:01, 29.14it/s] 33%|███▎      | 15/46 [00:00<00:00, 32.60it/s] 41%|████▏     | 19/46 [00:00<00:00, 34.86it/s] 50%|█████     | 23/46 [00:08<00:15,  1.50it/s] 61%|██████    | 28/46 [00:08<00:07,  2.38it/s] 72%|███████▏  | 33/46 [00:08<00:03,  3.58it/s] 83%|████████▎ | 38/46 [00:08<00:01,  5.16it/s] 91%|█████████▏| 42/46 [00:21<00:04,  1.06s/it] 96%|█████████▌| 44/46 [00:21<00:01,  1.12it/s]100%|██████████| 46/46 [00:29<00:00,  1.58it/s]
2025-03-13 16:38:37,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:37
2025-03-13 16:40:15,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.2664 secs
2025-03-13 16:40:15,164 [INFO]: The best hyperparameters are: efSearch=67
2025-03-13 16:40:15,164 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.50it/s]
2025-03-13 16:41:40,028 [INFO]: 	>>> Finished "Compute fast metrics" in 84.8640 secs
2025-03-13 16:41:40,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 211.3291 secs
2025-03-13 16:41:40,030 [INFO]: {
2025-03-13 16:41:40,030 [INFO]: 	index_key: HNSW32
2025-03-13 16:41:40,030 [INFO]: 	index_param: efSearch=67
2025-03-13 16:41:40,030 [INFO]: 	index_path: knn.index
2025-03-13 16:41:40,030 [INFO]: 	size in bytes: 2196786026
2025-03-13 16:41:40,030 [INFO]: 	avg_search_speed_ms: 11.059530797923879
2025-03-13 16:41:40,030 [INFO]: 	99p_search_speed_ms: 19.788348898291588
2025-03-13 16:41:40,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:40,030 [INFO]: 	nb vectors: 11158
2025-03-13 16:41:40,030 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:40,030 [INFO]: 	compression ratio: 0.9986189087311683
2025-03-13 16:41:40,030 [INFO]: }
2025-03-13 16:41:40,030 [INFO]: 	>>> Finished "Creating the index" in 211.3306 secs
2025-03-13 16:41:40,030 [INFO]: >>> Finished "Launching the whole pipeline" in 211.3675 secs
2025-03-13 16:41:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 31264 [episode count 5/20]
[retrieval_preprocessing] for episode 8230 [episode count 6/20], we have num_retrieval=np.int64(11022) num_query=np.int64(515)
2025-03-13 16:41:43,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:45,737 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:45
2025-03-13 16:41:45,737 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.77it/s]
2025-03-13 16:41:45,782 [INFO]: There are 11022 embeddings of dim 49152
2025-03-13 16:41:45,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0460 secs
2025-03-13 16:41:45,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:45,784 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 16:41:45,784 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:41:45,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:41:45,784 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,784 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:45,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:41:45,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:45
2025-03-13 16:41:45,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:41:45,785 [INFO]: 	Creating the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,785 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:41:45
2025-03-13 16:41:45,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 16:41:45,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:45
2025-03-13 16:41:45,789 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:41:45,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.96it/s]  9%|▊         | 4/46 [00:00<00:02, 17.63it/s] 17%|█▋        | 8/46 [00:00<00:01, 24.67it/s] 26%|██▌       | 12/46 [00:00<00:01, 29.96it/s] 35%|███▍      | 16/46 [00:00<00:00, 33.02it/s] 46%|████▌     | 21/46 [00:07<00:14,  1.75it/s] 57%|█████▋    | 26/46 [00:07<00:07,  2.72it/s] 67%|██████▋   | 31/46 [00:07<00:03,  4.04it/s] 78%|███████▊  | 36/46 [00:07<00:01,  5.80it/s] 89%|████████▉ | 41/46 [00:07<00:00,  8.08it/s]100%|██████████| 46/46 [00:18<00:00,  1.30it/s]100%|██████████| 46/46 [00:18<00:00,  2.48it/s]
2025-03-13 16:42:04,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:04
2025-03-13 16:43:32,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.4382 secs
2025-03-13 16:43:32,773 [INFO]: The best hyperparameters are: efSearch=46
2025-03-13 16:43:32,773 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.23it/s]
2025-03-13 16:44:20,727 [INFO]: 	>>> Finished "Compute fast metrics" in 47.9531 secs
2025-03-13 16:44:20,728 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.9390 secs
2025-03-13 16:44:20,728 [INFO]: {
2025-03-13 16:44:20,728 [INFO]: 	index_key: HNSW32
2025-03-13 16:44:20,728 [INFO]: 	index_param: efSearch=46
2025-03-13 16:44:20,728 [INFO]: 	index_path: knn.index
2025-03-13 16:44:20,728 [INFO]: 	size in bytes: 2170010122
2025-03-13 16:44:20,728 [INFO]: 	avg_search_speed_ms: 8.56579797627323
2025-03-13 16:44:20,728 [INFO]: 	99p_search_speed_ms: 14.885622416622935
2025-03-13 16:44:20,728 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:20,728 [INFO]: 	nb vectors: 11022
2025-03-13 16:44:20,728 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:20,728 [INFO]: 	compression ratio: 0.9986190175015229
2025-03-13 16:44:20,728 [INFO]: }
2025-03-13 16:44:20,728 [INFO]: 	>>> Finished "Creating the index" in 154.9428 secs
2025-03-13 16:44:20,728 [INFO]: >>> Finished "Launching the whole pipeline" in 154.9914 secs
2025-03-13 16:44:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 8230 [episode count 6/20]
[retrieval_preprocessing] for episode 4139 [episode count 7/20], we have num_retrieval=np.int64(10982) num_query=np.int64(555)
2025-03-13 16:44:25,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:28,550 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:28
2025-03-13 16:44:28,550 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.93it/s]
2025-03-13 16:44:28,595 [INFO]: There are 10982 embeddings of dim 49152
2025-03-13 16:44:28,596 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0455 secs
2025-03-13 16:44:28,596 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:28
2025-03-13 16:44:28,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:28,597 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:44:28,597 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:44:28,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:44:28,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:28
2025-03-13 16:44:28,598 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:28,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:44:28,598 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:28
2025-03-13 16:44:28,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:44:28,599 [INFO]: 	Creating the index 03/13/2025, 16:44:28
2025-03-13 16:44:28,599 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:44:28
2025-03-13 16:44:28,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0036 secs
2025-03-13 16:44:28,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:28
2025-03-13 16:44:28,604 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:44:28,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.18it/s] 11%|█         | 5/46 [00:00<00:01, 23.11it/s] 20%|█▉        | 9/46 [00:00<00:01, 29.53it/s] 28%|██▊       | 13/46 [00:00<00:01, 32.97it/s] 37%|███▋      | 17/46 [00:00<00:00, 34.90it/s] 46%|████▌     | 21/46 [00:09<00:20,  1.20it/s] 54%|█████▍    | 25/46 [00:09<00:11,  1.79it/s] 65%|██████▌   | 30/46 [00:09<00:05,  2.79it/s] 76%|███████▌  | 35/46 [00:10<00:02,  4.14it/s] 87%|████████▋ | 40/46 [00:10<00:01,  5.92it/s] 96%|█████████▌| 44/46 [00:20<00:01,  1.21it/s]100%|██████████| 46/46 [00:22<00:00,  1.12it/s]100%|██████████| 46/46 [00:22<00:00,  2.02it/s]
2025-03-13 16:44:51,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:51
2025-03-13 16:46:16,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4776 secs
2025-03-13 16:46:16,918 [INFO]: The best hyperparameters are: efSearch=46
2025-03-13 16:46:16,918 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 16:47:11,426 [INFO]: 	>>> Finished "Compute fast metrics" in 54.5082 secs
2025-03-13 16:47:11,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 162.8242 secs
2025-03-13 16:47:11,428 [INFO]: {
2025-03-13 16:47:11,428 [INFO]: 	index_key: HNSW32
2025-03-13 16:47:11,428 [INFO]: 	index_param: efSearch=46
2025-03-13 16:47:11,428 [INFO]: 	index_path: knn.index
2025-03-13 16:47:11,428 [INFO]: 	size in bytes: 2162134570
2025-03-13 16:47:11,428 [INFO]: 	avg_search_speed_ms: 7.775568899924506
2025-03-13 16:47:11,428 [INFO]: 	99p_search_speed_ms: 13.392707647290088
2025-03-13 16:47:11,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:11,428 [INFO]: 	nb vectors: 10982
2025-03-13 16:47:11,428 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:11,428 [INFO]: 	compression ratio: 0.9986191821538657
2025-03-13 16:47:11,428 [INFO]: }
2025-03-13 16:47:11,428 [INFO]: 	>>> Finished "Creating the index" in 162.8293 secs
2025-03-13 16:47:11,428 [INFO]: >>> Finished "Launching the whole pipeline" in 162.8776 secs
2025-03-13 16:47:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 4139 [episode count 7/20]
[retrieval_preprocessing] for episode 25643 [episode count 8/20], we have num_retrieval=np.int64(11008) num_query=np.int64(529)
2025-03-13 16:47:15,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:17,831 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:17
2025-03-13 16:47:17,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.12it/s]
2025-03-13 16:47:17,866 [INFO]: There are 11008 embeddings of dim 49152
2025-03-13 16:47:17,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 16:47:17,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:17,866 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:47:17,866 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:47:17,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:17,866 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,867 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:17,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:47:17,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:17
2025-03-13 16:47:17,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:17,867 [INFO]: 	Creating the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,867 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:47:17
2025-03-13 16:47:17,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:47:17,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,868 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:47:17,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  7.58it/s]  9%|▊         | 4/46 [00:00<00:02, 18.42it/s] 20%|█▉        | 9/46 [00:00<00:01, 30.10it/s] 30%|███       | 14/46 [00:00<00:00, 35.68it/s] 41%|████▏     | 19/46 [00:00<00:00, 38.64it/s] 50%|█████     | 23/46 [00:07<00:13,  1.66it/s] 61%|██████    | 28/46 [00:08<00:07,  2.55it/s] 72%|███████▏  | 33/46 [00:08<00:03,  3.77it/s] 83%|████████▎ | 38/46 [00:08<00:01,  5.39it/s] 93%|█████████▎| 43/46 [00:15<00:01,  1.61it/s]100%|██████████| 46/46 [00:18<00:00,  1.57it/s]100%|██████████| 46/46 [00:18<00:00,  2.55it/s]
2025-03-13 16:47:35,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:35
2025-03-13 16:49:14,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 98.4024 secs
2025-03-13 16:49:14,343 [INFO]: The best hyperparameters are: efSearch=46
2025-03-13 16:49:14,343 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.73it/s]
2025-03-13 16:50:35,172 [INFO]: 	>>> Finished "Compute fast metrics" in 80.8293 secs
2025-03-13 16:50:35,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 197.3055 secs
2025-03-13 16:50:35,174 [INFO]: {
2025-03-13 16:50:35,174 [INFO]: 	index_key: HNSW32
2025-03-13 16:50:35,174 [INFO]: 	index_param: efSearch=46
2025-03-13 16:50:35,174 [INFO]: 	index_path: knn.index
2025-03-13 16:50:35,174 [INFO]: 	size in bytes: 2167253602
2025-03-13 16:50:35,174 [INFO]: 	avg_search_speed_ms: 7.240147838351478
2025-03-13 16:50:35,174 [INFO]: 	99p_search_speed_ms: 12.261544680222876
2025-03-13 16:50:35,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:35,174 [INFO]: 	nb vectors: 11008
2025-03-13 16:50:35,174 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:35,174 [INFO]: 	compression ratio: 0.9986191103813424
2025-03-13 16:50:35,174 [INFO]: }
2025-03-13 16:50:35,174 [INFO]: 	>>> Finished "Creating the index" in 197.3069 secs
2025-03-13 16:50:35,174 [INFO]: >>> Finished "Launching the whole pipeline" in 197.3431 secs
2025-03-13 16:50:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 25643 [episode count 8/20]
[retrieval_preprocessing] for episode 72758 [episode count 9/20], we have num_retrieval=np.int64(10988) num_query=np.int64(549)
2025-03-13 16:50:39,204 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:40,848 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:40
2025-03-13 16:50:40,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-13 16:50:40,882 [INFO]: There are 10988 embeddings of dim 49152
2025-03-13 16:50:40,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 16:50:40,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:40
2025-03-13 16:50:40,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:40,883 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:50:40,883 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:50:40,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:40,883 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:40
2025-03-13 16:50:40,883 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:40,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:50:40,883 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:40
2025-03-13 16:50:40,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:40,883 [INFO]: 	Creating the index 03/13/2025, 16:50:40
2025-03-13 16:50:40,883 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:50:40
2025-03-13 16:50:40,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:50:40,884 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:40
2025-03-13 16:50:40,884 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:50:40,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  8.06it/s] 11%|█         | 5/46 [00:00<00:01, 24.62it/s] 22%|██▏       | 10/46 [00:00<00:01, 34.47it/s] 33%|███▎      | 15/46 [00:00<00:00, 39.28it/s] 43%|████▎     | 20/46 [00:00<00:00, 41.99it/s] 54%|█████▍    | 25/46 [00:07<00:10,  1.98it/s] 65%|██████▌   | 30/46 [00:07<00:05,  2.94it/s] 76%|███████▌  | 35/46 [00:07<00:02,  4.25it/s] 87%|████████▋ | 40/46 [00:07<00:01,  5.99it/s] 98%|█████████▊| 45/46 [00:16<00:00,  1.56it/s]100%|██████████| 46/46 [00:18<00:00,  2.50it/s]
2025-03-13 16:50:59,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:59
2025-03-13 16:52:41,703 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.3803 secs
2025-03-13 16:52:41,703 [INFO]: The best hyperparameters are: efSearch=57
2025-03-13 16:52:41,704 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 16:53:50,523 [INFO]: 	>>> Finished "Compute fast metrics" in 68.8198 secs
2025-03-13 16:53:50,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 189.6403 secs
2025-03-13 16:53:50,525 [INFO]: {
2025-03-13 16:53:50,525 [INFO]: 	index_key: HNSW32
2025-03-13 16:53:50,525 [INFO]: 	index_param: efSearch=57
2025-03-13 16:53:50,525 [INFO]: 	index_path: knn.index
2025-03-13 16:53:50,525 [INFO]: 	size in bytes: 2163315826
2025-03-13 16:53:50,525 [INFO]: 	avg_search_speed_ms: 8.26851339013962
2025-03-13 16:53:50,525 [INFO]: 	99p_search_speed_ms: 13.238330259919168
2025-03-13 16:53:50,525 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:50,525 [INFO]: 	nb vectors: 10988
2025-03-13 16:53:50,525 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:50,525 [INFO]: 	compression ratio: 0.9986191928316249
2025-03-13 16:53:50,525 [INFO]: }
2025-03-13 16:53:50,525 [INFO]: 	>>> Finished "Creating the index" in 189.6418 secs
2025-03-13 16:53:50,525 [INFO]: >>> Finished "Launching the whole pipeline" in 189.6764 secs
2025-03-13 16:53:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 72758 [episode count 9/20]
[retrieval_preprocessing] for episode 45123 [episode count 10/20], we have num_retrieval=np.int64(10980) num_query=np.int64(557)
2025-03-13 16:53:54,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:56,627 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:56
2025-03-13 16:53:56,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.11it/s]
2025-03-13 16:53:56,662 [INFO]: There are 10980 embeddings of dim 49152
2025-03-13 16:53:56,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 16:53:56,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:56,662 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 16:53:56,662 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:53:56,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:56,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,662 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:56,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:53:56,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:56
2025-03-13 16:53:56,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:56,662 [INFO]: 	Creating the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,662 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:53:56
2025-03-13 16:53:56,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 16:53:56,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,664 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:53:56,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.74it/s] 11%|█         | 5/46 [00:00<00:01, 20.79it/s] 22%|██▏       | 10/46 [00:00<00:01, 31.60it/s] 35%|███▍      | 16/46 [00:00<00:00, 38.87it/s] 46%|████▌     | 21/46 [00:07<00:12,  1.93it/s] 54%|█████▍    | 25/46 [00:07<00:07,  2.71it/s] 63%|██████▎   | 29/46 [00:07<00:04,  3.76it/s] 74%|███████▍  | 34/46 [00:07<00:02,  5.52it/s] 85%|████████▍ | 39/46 [00:07<00:00,  7.80it/s] 93%|█████████▎| 43/46 [00:17<00:02,  1.26it/s]100%|██████████| 46/46 [00:20<00:00,  1.21it/s]100%|██████████| 46/46 [00:20<00:00,  2.24it/s]
2025-03-13 16:54:17,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:17
2025-03-13 16:55:44,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.9003 secs
2025-03-13 16:55:44,099 [INFO]: The best hyperparameters are: efSearch=59
2025-03-13 16:55:44,099 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-13 16:57:12,367 [INFO]: 	>>> Finished "Compute fast metrics" in 88.2680 secs
2025-03-13 16:57:12,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 195.7055 secs
2025-03-13 16:57:12,369 [INFO]: {
2025-03-13 16:57:12,369 [INFO]: 	index_key: HNSW32
2025-03-13 16:57:12,369 [INFO]: 	index_param: efSearch=59
2025-03-13 16:57:12,369 [INFO]: 	index_path: knn.index
2025-03-13 16:57:12,369 [INFO]: 	size in bytes: 2161740818
2025-03-13 16:57:12,369 [INFO]: 	avg_search_speed_ms: 10.526879022731201
2025-03-13 16:57:12,369 [INFO]: 	99p_search_speed_ms: 17.708976364228874
2025-03-13 16:57:12,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:12,369 [INFO]: 	nb vectors: 10980
2025-03-13 16:57:12,369 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:12,369 [INFO]: 	compression ratio: 0.9986191785920193
2025-03-13 16:57:12,369 [INFO]: }
2025-03-13 16:57:12,369 [INFO]: 	>>> Finished "Creating the index" in 195.7070 secs
2025-03-13 16:57:12,369 [INFO]: >>> Finished "Launching the whole pipeline" in 195.7421 secs
2025-03-13 16:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 45123 [episode count 10/20]
[retrieval_preprocessing] for episode 43597 [episode count 11/20], we have num_retrieval=np.int64(11039) num_query=np.int64(498)
2025-03-13 16:57:22,101 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:24,769 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:24
2025-03-13 16:57:24,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 924.06it/s]
2025-03-13 16:57:24,803 [INFO]: There are 11039 embeddings of dim 49152
2025-03-13 16:57:24,803 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 16:57:24,804 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:24
2025-03-13 16:57:24,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:24,804 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 16:57:24,804 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:57:24,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:24,804 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:24
2025-03-13 16:57:24,804 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:24,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:57:24,804 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:24
2025-03-13 16:57:24,804 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:24,804 [INFO]: 	Creating the index 03/13/2025, 16:57:24
2025-03-13 16:57:24,804 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:57:24
2025-03-13 16:57:24,805 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 16:57:24,806 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:24
2025-03-13 16:57:24,806 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 16:57:24,806 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:11,  3.90it/s]  4%|▍         | 2/46 [00:00<00:07,  5.53it/s]  7%|▋         | 3/46 [00:00<00:06,  6.37it/s]  9%|▊         | 4/46 [00:00<00:05,  7.01it/s] 11%|█         | 5/46 [00:00<00:05,  7.40it/s] 13%|█▎        | 6/46 [00:00<00:05,  7.71it/s] 15%|█▌        | 7/46 [00:00<00:04,  7.97it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.15it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.37it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.46it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.51it/s] 26%|██▌       | 12/46 [00:01<00:03,  8.75it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.03it/s] 33%|███▎      | 15/46 [00:01<00:03,  9.78it/s] 37%|███▋      | 17/46 [00:02<00:02,  9.97it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.98it/s] 46%|████▌     | 21/46 [00:11<00:41,  1.66s/it] 54%|█████▍    | 25/46 [00:11<00:17,  1.17it/s] 59%|█████▊    | 27/46 [00:11<00:12,  1.55it/s] 67%|██████▋   | 31/46 [00:11<00:05,  2.60it/s] 74%|███████▍  | 34/46 [00:12<00:03,  3.56it/s] 83%|████████▎ | 38/46 [00:12<00:01,  5.33it/s] 91%|█████████▏| 42/46 [00:24<00:04,  1.18s/it] 96%|█████████▌| 44/46 [00:24<00:01,  1.04it/s]100%|██████████| 46/46 [00:27<00:00,  1.65it/s]
2025-03-13 16:57:52,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:52
2025-03-13 16:59:21,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2457 secs
2025-03-13 16:59:21,986 [INFO]: The best hyperparameters are: efSearch=64
2025-03-13 16:59:21,986 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 17:00:04,493 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5067 secs
2025-03-13 17:00:04,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 159.6885 secs
2025-03-13 17:00:04,494 [INFO]: {
2025-03-13 17:00:04,494 [INFO]: 	index_key: HNSW32
2025-03-13 17:00:04,494 [INFO]: 	index_param: efSearch=64
2025-03-13 17:00:04,494 [INFO]: 	index_path: knn.index
2025-03-13 17:00:04,494 [INFO]: 	size in bytes: 2173357014
2025-03-13 17:00:04,494 [INFO]: 	avg_search_speed_ms: 9.597557680654534
2025-03-13 17:00:04,494 [INFO]: 	99p_search_speed_ms: 15.201426947023718
2025-03-13 17:00:04,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:04,495 [INFO]: 	nb vectors: 11039
2025-03-13 17:00:04,495 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:04,495 [INFO]: 	compression ratio: 0.9986190478689573
2025-03-13 17:00:04,495 [INFO]: }
2025-03-13 17:00:04,495 [INFO]: 	>>> Finished "Creating the index" in 159.6904 secs
2025-03-13 17:00:04,495 [INFO]: >>> Finished "Launching the whole pipeline" in 159.7251 secs
2025-03-13 17:00:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 43597 [episode count 11/20]
[retrieval_preprocessing] for episode 70734 [episode count 12/20], we have num_retrieval=np.int64(10940) num_query=np.int64(597)
2025-03-13 17:00:08,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:10,287 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:10
2025-03-13 17:00:10,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.31it/s]
2025-03-13 17:00:10,327 [INFO]: There are 10940 embeddings of dim 49152
2025-03-13 17:00:10,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-13 17:00:10,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:10
2025-03-13 17:00:10,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:10,328 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:00:10,328 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:00:10,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:10,328 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:10
2025-03-13 17:00:10,328 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:10,328 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:00:10,328 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:10
2025-03-13 17:00:10,328 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:10,328 [INFO]: 	Creating the index 03/13/2025, 17:00:10
2025-03-13 17:00:10,328 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:00:10
2025-03-13 17:00:10,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 17:00:10,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:10
2025-03-13 17:00:10,329 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:00:10,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  6.19it/s] 11%|█         | 5/46 [00:00<00:02, 19.71it/s] 20%|█▉        | 9/46 [00:00<00:01, 26.99it/s] 30%|███       | 14/46 [00:00<00:00, 32.61it/s] 41%|████▏     | 19/46 [00:00<00:00, 35.31it/s] 50%|█████     | 23/46 [00:07<00:13,  1.65it/s] 61%|██████    | 28/46 [00:08<00:07,  2.55it/s] 72%|███████▏  | 33/46 [00:08<00:03,  3.76it/s] 83%|████████▎ | 38/46 [00:08<00:01,  5.38it/s] 91%|█████████▏| 42/46 [00:18<00:03,  1.19it/s]100%|██████████| 46/46 [00:21<00:00,  1.23it/s]100%|██████████| 46/46 [00:21<00:00,  2.13it/s]
2025-03-13 17:00:31,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:31
2025-03-13 17:01:54,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.4704 secs
2025-03-13 17:01:54,373 [INFO]: The best hyperparameters are: efSearch=50
2025-03-13 17:01:54,373 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.99it/s]
2025-03-13 17:02:42,550 [INFO]: 	>>> Finished "Compute fast metrics" in 48.1773 secs
2025-03-13 17:02:42,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.2223 secs
2025-03-13 17:02:42,552 [INFO]: {
2025-03-13 17:02:42,552 [INFO]: 	index_key: HNSW32
2025-03-13 17:02:42,552 [INFO]: 	index_param: efSearch=50
2025-03-13 17:02:42,552 [INFO]: 	index_path: knn.index
2025-03-13 17:02:42,552 [INFO]: 	size in bytes: 2153865778
2025-03-13 17:02:42,552 [INFO]: 	avg_search_speed_ms: 11.39864777156485
2025-03-13 17:02:42,552 [INFO]: 	99p_search_speed_ms: 19.126356646884236
2025-03-13 17:02:42,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:42,552 [INFO]: 	nb vectors: 10940
2025-03-13 17:02:42,552 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:42,552 [INFO]: 	compression ratio: 0.9986191070816113
2025-03-13 17:02:42,552 [INFO]: }
2025-03-13 17:02:42,552 [INFO]: 	>>> Finished "Creating the index" in 152.2238 secs
2025-03-13 17:02:42,552 [INFO]: >>> Finished "Launching the whole pipeline" in 152.2644 secs
2025-03-13 17:02:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 70734 [episode count 12/20]
[retrieval_preprocessing] for episode 93776 [episode count 13/20], we have num_retrieval=np.int64(10955) num_query=np.int64(582)
2025-03-13 17:02:47,383 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:48,858 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:48
2025-03-13 17:02:48,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.20it/s]
2025-03-13 17:02:48,893 [INFO]: There are 10955 embeddings of dim 49152
2025-03-13 17:02:48,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 17:02:48,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:48
2025-03-13 17:02:48,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:48,894 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:02:48,894 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:02:48,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:48,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:48
2025-03-13 17:02:48,894 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:48,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:48,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:48
2025-03-13 17:02:48,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:48,894 [INFO]: 	Creating the index 03/13/2025, 17:02:48
2025-03-13 17:02:48,894 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:02:48
2025-03-13 17:02:48,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:02:48,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:48
2025-03-13 17:02:48,895 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:02:48,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  7.87it/s] 13%|█▎        | 6/46 [00:00<00:01, 27.38it/s] 24%|██▍       | 11/46 [00:00<00:01, 34.47it/s] 35%|███▍      | 16/46 [00:00<00:00, 37.99it/s] 46%|████▌     | 21/46 [00:08<00:15,  1.66it/s] 57%|█████▋    | 26/46 [00:08<00:07,  2.52it/s] 67%|██████▋   | 31/46 [00:08<00:04,  3.71it/s] 78%|███████▊  | 36/46 [00:08<00:01,  5.28it/s] 89%|████████▉ | 41/46 [00:08<00:00,  7.33it/s]100%|██████████| 46/46 [00:20<00:00,  1.21it/s]100%|██████████| 46/46 [00:20<00:00,  2.28it/s]
2025-03-13 17:03:09,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:09
2025-03-13 17:04:30,660 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.5748 secs
2025-03-13 17:04:30,660 [INFO]: The best hyperparameters are: efSearch=56
2025-03-13 17:04:30,660 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.47it/s]
2025-03-13 17:05:26,342 [INFO]: 	>>> Finished "Compute fast metrics" in 55.6819 secs
2025-03-13 17:05:26,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 157.4481 secs
2025-03-13 17:05:26,344 [INFO]: {
2025-03-13 17:05:26,344 [INFO]: 	index_key: HNSW32
2025-03-13 17:05:26,344 [INFO]: 	index_param: efSearch=56
2025-03-13 17:05:26,344 [INFO]: 	index_path: knn.index
2025-03-13 17:05:26,344 [INFO]: 	size in bytes: 2156818918
2025-03-13 17:05:26,344 [INFO]: 	avg_search_speed_ms: 6.535445154321934
2025-03-13 17:05:26,344 [INFO]: 	99p_search_speed_ms: 11.591673018410802
2025-03-13 17:05:26,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:26,344 [INFO]: 	nb vectors: 10955
2025-03-13 17:05:26,344 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:26,344 [INFO]: 	compression ratio: 0.9986191339592099
2025-03-13 17:05:26,344 [INFO]: }
2025-03-13 17:05:26,344 [INFO]: 	>>> Finished "Creating the index" in 157.4496 secs
2025-03-13 17:05:26,344 [INFO]: >>> Finished "Launching the whole pipeline" in 157.4859 secs
2025-03-13 17:05:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 93776 [episode count 13/20]
[retrieval_preprocessing] for episode 69717 [episode count 14/20], we have num_retrieval=np.int64(10844) num_query=np.int64(693)
2025-03-13 17:05:30,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:31,500 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:31
2025-03-13 17:05:31,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.86it/s]
2025-03-13 17:05:31,535 [INFO]: There are 10844 embeddings of dim 49152
2025-03-13 17:05:31,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 17:05:31,535 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:31
2025-03-13 17:05:31,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:31,536 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:05:31,536 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:05:31,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:31,536 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:31
2025-03-13 17:05:31,536 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:31,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:31,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:31
2025-03-13 17:05:31,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:31,536 [INFO]: 	Creating the index 03/13/2025, 17:05:31
2025-03-13 17:05:31,536 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:05:31
2025-03-13 17:05:31,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 17:05:31,537 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:31
2025-03-13 17:05:31,537 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:05:31,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:05,  8.08it/s] 13%|█▎        | 6/45 [00:00<00:01, 29.41it/s] 27%|██▋       | 12/45 [00:00<00:00, 39.85it/s] 40%|████      | 18/45 [00:00<00:00, 46.05it/s] 51%|█████     | 23/45 [00:06<00:10,  2.11it/s] 60%|██████    | 27/45 [00:07<00:06,  2.91it/s] 69%|██████▉   | 31/45 [00:07<00:03,  3.98it/s] 78%|███████▊  | 35/45 [00:07<00:01,  5.40it/s] 87%|████████▋ | 39/45 [00:07<00:00,  7.23it/s] 96%|█████████▌| 43/45 [00:15<00:01,  1.36it/s]100%|██████████| 45/45 [00:18<00:00,  2.50it/s]
2025-03-13 17:05:49,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:49
2025-03-13 17:07:22,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.4339 secs
2025-03-13 17:07:22,000 [INFO]: The best hyperparameters are: efSearch=76
2025-03-13 17:07:22,000 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.99it/s]
2025-03-13 17:08:30,115 [INFO]: 	>>> Finished "Compute fast metrics" in 68.1148 secs
2025-03-13 17:08:30,116 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 178.5792 secs
2025-03-13 17:08:30,117 [INFO]: {
2025-03-13 17:08:30,117 [INFO]: 	index_key: HNSW32
2025-03-13 17:08:30,117 [INFO]: 	index_param: efSearch=76
2025-03-13 17:08:30,117 [INFO]: 	index_path: knn.index
2025-03-13 17:08:30,117 [INFO]: 	size in bytes: 2134965042
2025-03-13 17:08:30,117 [INFO]: 	avg_search_speed_ms: 11.69263624567669
2025-03-13 17:08:30,117 [INFO]: 	99p_search_speed_ms: 18.755664629861716
2025-03-13 17:08:30,117 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:30,117 [INFO]: 	nb vectors: 10844
2025-03-13 17:08:30,117 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:30,117 [INFO]: 	compression ratio: 0.9986192326609533
2025-03-13 17:08:30,117 [INFO]: }
2025-03-13 17:08:30,117 [INFO]: 	>>> Finished "Creating the index" in 178.5809 secs
2025-03-13 17:08:30,117 [INFO]: >>> Finished "Launching the whole pipeline" in 178.6165 secs
2025-03-13 17:08:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 69717 [episode count 14/20]
[retrieval_preprocessing] for episode 54889 [episode count 15/20], we have num_retrieval=np.int64(10953) num_query=np.int64(584)
2025-03-13 17:08:37,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:39,805 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:39
2025-03-13 17:08:39,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-13 17:08:39,841 [INFO]: There are 10953 embeddings of dim 49152
2025-03-13 17:08:39,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 17:08:39,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:39
2025-03-13 17:08:39,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:39,841 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:08:39,841 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:08:39,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:39,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:39
2025-03-13 17:08:39,842 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:39,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:39,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:39
2025-03-13 17:08:39,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:39,842 [INFO]: 	Creating the index 03/13/2025, 17:08:39
2025-03-13 17:08:39,842 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:08:39
2025-03-13 17:08:39,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 17:08:39,843 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:39
2025-03-13 17:08:39,843 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:08:39,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.94it/s] 11%|█         | 5/46 [00:00<00:01, 21.56it/s] 22%|██▏       | 10/46 [00:00<00:01, 31.97it/s] 33%|███▎      | 15/46 [00:00<00:00, 37.01it/s] 43%|████▎     | 20/46 [00:00<00:00, 40.37it/s] 54%|█████▍    | 25/46 [00:07<00:10,  1.95it/s] 65%|██████▌   | 30/46 [00:07<00:05,  2.90it/s] 76%|███████▌  | 35/46 [00:07<00:02,  4.18it/s] 87%|████████▋ | 40/46 [00:07<00:01,  5.88it/s] 98%|█████████▊| 45/46 [00:16<00:00,  1.53it/s]100%|██████████| 46/46 [00:19<00:00,  2.37it/s]
2025-03-13 17:08:59,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:59
2025-03-13 17:10:23,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.2578 secs
2025-03-13 17:10:23,480 [INFO]: The best hyperparameters are: efSearch=67
2025-03-13 17:10:23,480 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 17:11:35,141 [INFO]: 	>>> Finished "Compute fast metrics" in 71.6610 secs
2025-03-13 17:11:35,143 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 175.2998 secs
2025-03-13 17:11:35,143 [INFO]: {
2025-03-13 17:11:35,143 [INFO]: 	index_key: HNSW32
2025-03-13 17:11:35,143 [INFO]: 	index_param: efSearch=67
2025-03-13 17:11:35,143 [INFO]: 	index_path: knn.index
2025-03-13 17:11:35,143 [INFO]: 	size in bytes: 2156425166
2025-03-13 17:11:35,143 [INFO]: 	avg_search_speed_ms: 11.314763009866354
2025-03-13 17:11:35,143 [INFO]: 	99p_search_speed_ms: 20.150440980214622
2025-03-13 17:11:35,143 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:35,143 [INFO]: 	nb vectors: 10953
2025-03-13 17:11:35,143 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:35,143 [INFO]: 	compression ratio: 0.9986191303797833
2025-03-13 17:11:35,143 [INFO]: }
2025-03-13 17:11:35,143 [INFO]: 	>>> Finished "Creating the index" in 175.3016 secs
2025-03-13 17:11:35,143 [INFO]: >>> Finished "Launching the whole pipeline" in 175.3386 secs
2025-03-13 17:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 54889 [episode count 15/20]
[retrieval_preprocessing] for episode 6768 [episode count 16/20], we have num_retrieval=np.int64(10970) num_query=np.int64(567)
2025-03-13 17:11:41,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:42,986 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:42
2025-03-13 17:11:42,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.43it/s]
2025-03-13 17:11:43,023 [INFO]: There are 10970 embeddings of dim 49152
2025-03-13 17:11:43,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 17:11:43,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:43
2025-03-13 17:11:43,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:43,023 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:11:43,023 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:11:43,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:43,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:43
2025-03-13 17:11:43,024 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:43,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:43,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:43
2025-03-13 17:11:43,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:43,024 [INFO]: 	Creating the index 03/13/2025, 17:11:43
2025-03-13 17:11:43,024 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:11:43
2025-03-13 17:11:43,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:11:43,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:43
2025-03-13 17:11:43,025 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:11:43,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  7.55it/s] 11%|█         | 5/46 [00:00<00:01, 23.04it/s] 22%|██▏       | 10/46 [00:00<00:01, 32.26it/s] 33%|███▎      | 15/46 [00:00<00:00, 36.76it/s] 43%|████▎     | 20/46 [00:00<00:00, 39.40it/s] 52%|█████▏    | 24/46 [00:07<00:11,  1.85it/s] 61%|██████    | 28/46 [00:07<00:06,  2.62it/s] 70%|██████▉   | 32/46 [00:07<00:03,  3.67it/s] 78%|███████▊  | 36/46 [00:07<00:01,  5.06it/s] 87%|████████▋ | 40/46 [00:07<00:00,  6.88it/s] 96%|█████████▌| 44/46 [00:19<00:02,  1.01s/it]100%|██████████| 46/46 [00:23<00:00,  1.13s/it]100%|██████████| 46/46 [00:23<00:00,  2.00it/s]
2025-03-13 17:12:06,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:06
2025-03-13 17:13:34,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.0787 secs
2025-03-13 17:13:34,166 [INFO]: The best hyperparameters are: efSearch=67
2025-03-13 17:13:34,166 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.68it/s]
2025-03-13 17:14:29,176 [INFO]: 	>>> Finished "Compute fast metrics" in 55.0099 secs
2025-03-13 17:14:29,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 166.3581 secs
2025-03-13 17:14:29,383 [INFO]: {
2025-03-13 17:14:29,384 [INFO]: 	index_key: HNSW32
2025-03-13 17:14:29,384 [INFO]: 	index_param: efSearch=67
2025-03-13 17:14:29,384 [INFO]: 	index_path: knn.index
2025-03-13 17:14:29,384 [INFO]: 	size in bytes: 2159772058
2025-03-13 17:14:29,384 [INFO]: 	avg_search_speed_ms: 11.465834964487549
2025-03-13 17:14:29,384 [INFO]: 	99p_search_speed_ms: 19.477678486146022
2025-03-13 17:14:29,384 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:29,384 [INFO]: 	nb vectors: 10970
2025-03-13 17:14:29,384 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:29,384 [INFO]: 	compression ratio: 0.9986191607633068
2025-03-13 17:14:29,384 [INFO]: }
2025-03-13 17:14:29,384 [INFO]: 	>>> Finished "Creating the index" in 166.3603 secs
2025-03-13 17:14:29,384 [INFO]: >>> Finished "Launching the whole pipeline" in 166.3976 secs
2025-03-13 17:14:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 6768 [episode count 16/20]
[retrieval_preprocessing] for episode 7281 [episode count 17/20], we have num_retrieval=np.int64(10980) num_query=np.int64(557)
2025-03-13 17:14:34,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:36,568 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:36
2025-03-13 17:14:36,568 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 17:14:36,606 [INFO]: There are 10980 embeddings of dim 49152
2025-03-13 17:14:36,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 17:14:36,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:36
2025-03-13 17:14:36,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:36,606 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:14:36,606 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:14:36,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:36,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:36
2025-03-13 17:14:36,607 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:36,607 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:36,607 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:36
2025-03-13 17:14:36,607 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:36,607 [INFO]: 	Creating the index 03/13/2025, 17:14:36
2025-03-13 17:14:36,607 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:14:36
2025-03-13 17:14:36,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:14:36,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:36
2025-03-13 17:14:36,608 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:14:36,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.99it/s]  9%|▊         | 4/46 [00:00<00:02, 17.73it/s] 20%|█▉        | 9/46 [00:00<00:01, 28.81it/s] 30%|███       | 14/46 [00:00<00:00, 34.12it/s] 41%|████▏     | 19/46 [00:00<00:00, 37.16it/s] 50%|█████     | 23/46 [00:07<00:13,  1.70it/s] 61%|██████    | 28/46 [00:07<00:06,  2.61it/s] 72%|███████▏  | 33/46 [00:07<00:03,  3.85it/s] 83%|████████▎ | 38/46 [00:08<00:01,  5.51it/s] 93%|█████████▎| 43/46 [00:17<00:02,  1.37it/s]100%|██████████| 46/46 [00:20<00:00,  1.33it/s]100%|██████████| 46/46 [00:20<00:00,  2.29it/s]
2025-03-13 17:14:56,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:56
2025-03-13 17:16:17,382 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.6813 secs
2025-03-13 17:16:17,383 [INFO]: The best hyperparameters are: efSearch=52
2025-03-13 17:16:17,383 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.24it/s]
2025-03-13 17:17:02,934 [INFO]: 	>>> Finished "Compute fast metrics" in 45.5517 secs
2025-03-13 17:17:02,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.3279 secs
2025-03-13 17:17:02,936 [INFO]: {
2025-03-13 17:17:02,936 [INFO]: 	index_key: HNSW32
2025-03-13 17:17:02,936 [INFO]: 	index_param: efSearch=52
2025-03-13 17:17:02,936 [INFO]: 	index_path: knn.index
2025-03-13 17:17:02,936 [INFO]: 	size in bytes: 2161740818
2025-03-13 17:17:02,936 [INFO]: 	avg_search_speed_ms: 9.92145533728901
2025-03-13 17:17:02,936 [INFO]: 	99p_search_speed_ms: 16.256629014387723
2025-03-13 17:17:02,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:02,936 [INFO]: 	nb vectors: 10980
2025-03-13 17:17:02,936 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:02,936 [INFO]: 	compression ratio: 0.9986191785920193
2025-03-13 17:17:02,936 [INFO]: }
2025-03-13 17:17:02,936 [INFO]: 	>>> Finished "Creating the index" in 146.3294 secs
2025-03-13 17:17:02,936 [INFO]: >>> Finished "Launching the whole pipeline" in 146.3682 secs
2025-03-13 17:17:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 7281 [episode count 17/20]
[retrieval_preprocessing] for episode 35981 [episode count 18/20], we have num_retrieval=np.int64(10881) num_query=np.int64(656)
2025-03-13 17:17:08,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:10,023 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:10
2025-03-13 17:17:10,023 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-13 17:17:10,060 [INFO]: There are 10881 embeddings of dim 49152
2025-03-13 17:17:10,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 17:17:10,060 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:10
2025-03-13 17:17:10,061 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:10,061 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:17:10,061 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:17:10,061 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:10,061 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:10
2025-03-13 17:17:10,061 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:10,061 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:17:10,061 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:10
2025-03-13 17:17:10,061 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:10,061 [INFO]: 	Creating the index 03/13/2025, 17:17:10
2025-03-13 17:17:10,061 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:17:10
2025-03-13 17:17:10,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:17:10,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:10
2025-03-13 17:17:10,062 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:17:10,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:06,  6.56it/s] 11%|█         | 5/45 [00:00<00:01, 22.19it/s] 22%|██▏       | 10/45 [00:00<00:01, 33.37it/s] 33%|███▎      | 15/45 [00:00<00:00, 38.91it/s] 44%|████▍     | 20/45 [00:00<00:00, 42.62it/s] 56%|█████▌    | 25/45 [00:07<00:10,  1.93it/s] 64%|██████▍   | 29/45 [00:07<00:05,  2.68it/s] 76%|███████▌  | 34/45 [00:07<00:02,  3.94it/s] 87%|████████▋ | 39/45 [00:07<00:01,  5.61it/s] 96%|█████████▌| 43/45 [00:18<00:01,  1.21it/s]100%|██████████| 45/45 [00:20<00:00,  1.15it/s]100%|██████████| 45/45 [00:20<00:00,  2.22it/s]
2025-03-13 17:17:30,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:30
2025-03-13 17:18:57,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.4860 secs
2025-03-13 17:18:57,812 [INFO]: The best hyperparameters are: efSearch=46
2025-03-13 17:18:57,812 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.53it/s]
2025-03-13 17:19:50,297 [INFO]: 	>>> Finished "Compute fast metrics" in 52.4854 secs
2025-03-13 17:19:50,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.2362 secs
2025-03-13 17:19:50,298 [INFO]: {
2025-03-13 17:19:50,298 [INFO]: 	index_key: HNSW32
2025-03-13 17:19:50,298 [INFO]: 	index_param: efSearch=46
2025-03-13 17:19:50,298 [INFO]: 	index_path: knn.index
2025-03-13 17:19:50,299 [INFO]: 	size in bytes: 2142249582
2025-03-13 17:19:50,299 [INFO]: 	avg_search_speed_ms: 7.218793083977506
2025-03-13 17:19:50,299 [INFO]: 	99p_search_speed_ms: 11.154393153265124
2025-03-13 17:19:50,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:50,299 [INFO]: 	nb vectors: 10881
2025-03-13 17:19:50,299 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:50,299 [INFO]: 	compression ratio: 0.9986192393151322
2025-03-13 17:19:50,299 [INFO]: }
2025-03-13 17:19:50,299 [INFO]: 	>>> Finished "Creating the index" in 160.2377 secs
2025-03-13 17:19:50,299 [INFO]: >>> Finished "Launching the whole pipeline" in 160.2753 secs
2025-03-13 17:19:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 35981 [episode count 18/20]
[retrieval_preprocessing] for episode 94861 [episode count 19/20], we have num_retrieval=np.int64(10937) num_query=np.int64(600)
2025-03-13 17:19:55,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:57,162 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:57
2025-03-13 17:19:57,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1958.13it/s]
2025-03-13 17:19:57,196 [INFO]: There are 10937 embeddings of dim 49152
2025-03-13 17:19:57,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 17:19:57,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:57
2025-03-13 17:19:57,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:57,196 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 17:19:57,196 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:19:57,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:57,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:57
2025-03-13 17:19:57,196 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:57,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:19:57,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:57
2025-03-13 17:19:57,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:57,197 [INFO]: 	Creating the index 03/13/2025, 17:19:57
2025-03-13 17:19:57,197 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:19:57
2025-03-13 17:19:57,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:19:57,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:57
2025-03-13 17:19:57,198 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 17:19:57,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.55it/s]  9%|▊         | 4/46 [00:00<00:02, 17.76it/s] 20%|█▉        | 9/46 [00:00<00:01, 29.17it/s] 30%|███       | 14/46 [00:00<00:00, 34.75it/s] 41%|████▏     | 19/46 [00:00<00:00, 37.81it/s] 50%|█████     | 23/46 [00:07<00:13,  1.65it/s] 61%|██████    | 28/46 [00:08<00:07,  2.53it/s] 72%|███████▏  | 33/46 [00:08<00:03,  3.74it/s] 83%|████████▎ | 38/46 [00:08<00:01,  5.35it/s] 91%|█████████▏| 42/46 [00:17<00:03,  1.31it/s]100%|██████████| 46/46 [00:19<00:00,  1.42it/s]100%|██████████| 46/46 [00:19<00:00,  2.33it/s]
2025-03-13 17:20:16,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:16
2025-03-13 17:21:50,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 93.7931 secs
2025-03-13 17:21:50,731 [INFO]: The best hyperparameters are: efSearch=24
2025-03-13 17:21:50,732 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-13 17:22:36,868 [INFO]: 	>>> Finished "Compute fast metrics" in 46.1359 secs
2025-03-13 17:22:36,869 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 159.6708 secs
2025-03-13 17:22:36,869 [INFO]: {
2025-03-13 17:22:36,869 [INFO]: 	index_key: HNSW32
2025-03-13 17:22:36,869 [INFO]: 	index_param: efSearch=24
2025-03-13 17:22:36,869 [INFO]: 	index_path: knn.index
2025-03-13 17:22:36,869 [INFO]: 	size in bytes: 2153275150
2025-03-13 17:22:36,869 [INFO]: 	avg_search_speed_ms: 5.332984894762436
2025-03-13 17:22:36,869 [INFO]: 	99p_search_speed_ms: 9.253315525129437
2025-03-13 17:22:36,869 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:36,869 [INFO]: 	nb vectors: 10937
2025-03-13 17:22:36,869 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:36,869 [INFO]: 	compression ratio: 0.9986191016972448
2025-03-13 17:22:36,869 [INFO]: }
2025-03-13 17:22:36,869 [INFO]: 	>>> Finished "Creating the index" in 159.6722 secs
2025-03-13 17:22:36,869 [INFO]: >>> Finished "Launching the whole pipeline" in 159.7072 secs
2025-03-13 17:22:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 94861 [episode count 19/20]
2025-03-13 17:22:40: [retrieval_preprocessing] finished for 440287856_put_black_objects_in_drawer_and_close [chosen_id count 3/196]
2025-03-13 17:22:41: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4465064685_put_marker_in_pot [chosen_id count 4/196]
2025-03-13 17:22:41: [retrieval_preprocessing] we have num_total=3606 embedding_dim=49152
[retrieval_preprocessing] for episode 24578 [episode count 0/20], we have num_retrieval=np.int64(3466) num_query=np.int64(140)
2025-03-13 17:22:41,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:42,414 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:42
2025-03-13 17:22:42,414 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-13 17:22:42,693 [INFO]: There are 3466 embeddings of dim 49152
2025-03-13 17:22:42,694 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2792 secs
2025-03-13 17:22:42,694 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:42,694 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:22:42,694 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:42,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:22:42,694 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,694 [INFO]: 715.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:42,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:22:42,695 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:42
2025-03-13 17:22:42,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:42,695 [INFO]: 	Creating the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,695 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:42
2025-03-13 17:22:42,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:22:42,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:42
2025-03-13 17:22:42,697 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:22:42,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.51it/s] 43%|████▎     | 6/14 [00:00<00:00, 27.94it/s] 71%|███████▏  | 10/14 [00:00<00:00, 32.08it/s]100%|██████████| 14/14 [00:02<00:00,  3.55it/s]100%|██████████| 14/14 [00:02<00:00,  4.87it/s]
2025-03-13 17:22:45,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:45
2025-03-13 17:23:34,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6795 secs
2025-03-13 17:23:34,256 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 17:23:34,256 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.88it/s]
2025-03-13 17:24:04,318 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0621 secs
2025-03-13 17:24:04,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6240 secs
2025-03-13 17:24:04,321 [INFO]: {
2025-03-13 17:24:04,321 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:04,321 [INFO]: 	index_param: efSearch=142
2025-03-13 17:24:04,321 [INFO]: 	index_path: knn.index
2025-03-13 17:24:04,321 [INFO]: 	size in bytes: 681914230
2025-03-13 17:24:04,321 [INFO]: 	avg_search_speed_ms: 8.006507421010811
2025-03-13 17:24:04,321 [INFO]: 	99p_search_speed_ms: 11.772816600278016
2025-03-13 17:24:04,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:04,321 [INFO]: 	nb vectors: 3466
2025-03-13 17:24:04,321 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:04,321 [INFO]: 	compression ratio: 0.9993094410128383
2025-03-13 17:24:04,321 [INFO]: }
2025-03-13 17:24:04,321 [INFO]: 	>>> Finished "Creating the index" in 81.6267 secs
2025-03-13 17:24:04,321 [INFO]: >>> Finished "Launching the whole pipeline" in 81.9072 secs
2025-03-13 17:24:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 24578 [episode count 0/20]
[retrieval_preprocessing] for episode 83983 [episode count 1/20], we have num_retrieval=np.int64(3465) num_query=np.int64(141)
2025-03-13 17:24:07,328 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:08,294 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:08
2025-03-13 17:24:08,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2182.26it/s]
2025-03-13 17:24:08,323 [INFO]: There are 3465 embeddings of dim 49152
2025-03-13 17:24:08,323 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:24:08,323 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:08
2025-03-13 17:24:08,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:08,323 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:24:08,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:08,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:08,324 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:08
2025-03-13 17:24:08,324 [INFO]: 715.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:08,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:24:08,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:08
2025-03-13 17:24:08,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:08,324 [INFO]: 	Creating the index 03/13/2025, 17:24:08
2025-03-13 17:24:08,324 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:08
2025-03-13 17:24:08,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:24:08,325 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:08
2025-03-13 17:24:08,325 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:24:08,325 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.67it/s] 43%|████▎     | 6/14 [00:00<00:00, 27.19it/s] 79%|███████▊  | 11/14 [00:00<00:00, 34.12it/s]100%|██████████| 14/14 [00:02<00:00,  4.83it/s]
2025-03-13 17:24:11,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:11
2025-03-13 17:24:47,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4372 secs
2025-03-13 17:24:47,665 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 17:24:47,665 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 17:25:17,240 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5757 secs
2025-03-13 17:25:17,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9184 secs
2025-03-13 17:25:17,244 [INFO]: {
2025-03-13 17:25:17,244 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:17,244 [INFO]: 	index_param: efSearch=277
2025-03-13 17:25:17,244 [INFO]: 	index_path: knn.index
2025-03-13 17:25:17,244 [INFO]: 	size in bytes: 681717490
2025-03-13 17:25:17,244 [INFO]: 	avg_search_speed_ms: 13.374590106995747
2025-03-13 17:25:17,244 [INFO]: 	99p_search_speed_ms: 20.04037378821522
2025-03-13 17:25:17,244 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:17,244 [INFO]: 	nb vectors: 3465
2025-03-13 17:25:17,244 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:17,244 [INFO]: 	compression ratio: 0.9993094353498251
2025-03-13 17:25:17,244 [INFO]: }
2025-03-13 17:25:17,244 [INFO]: 	>>> Finished "Creating the index" in 68.9199 secs
2025-03-13 17:25:17,244 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9492 secs
2025-03-13 17:25:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 83983 [episode count 1/20]
[retrieval_preprocessing] for episode 22563 [episode count 2/20], we have num_retrieval=np.int64(3459) num_query=np.int64(147)
2025-03-13 17:25:19,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:20,013 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:20
2025-03-13 17:25:20,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1921.35it/s]
2025-03-13 17:25:20,044 [INFO]: There are 3459 embeddings of dim 49152
2025-03-13 17:25:20,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:25:20,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:20
2025-03-13 17:25:20,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:20,046 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:25:20,046 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:20,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:25:20,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:20
2025-03-13 17:25:20,047 [INFO]: 713.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:20,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:25:20,047 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:20
2025-03-13 17:25:20,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:20,047 [INFO]: 	Creating the index 03/13/2025, 17:25:20
2025-03-13 17:25:20,047 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:20
2025-03-13 17:25:20,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:25:20,050 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:20
2025-03-13 17:25:20,050 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:25:20,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.86it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.72it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.61it/s]100%|██████████| 14/14 [00:03<00:00,  3.93it/s]
2025-03-13 17:25:23,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:23
2025-03-13 17:26:03,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6393 secs
2025-03-13 17:26:03,257 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:26:03,257 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.76it/s]
2025-03-13 17:26:20,741 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4830 secs
2025-03-13 17:26:20,743 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6931 secs
2025-03-13 17:26:20,743 [INFO]: {
2025-03-13 17:26:20,743 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:20,743 [INFO]: 	index_param: efSearch=175
2025-03-13 17:26:20,743 [INFO]: 	index_path: knn.index
2025-03-13 17:26:20,743 [INFO]: 	size in bytes: 680537050
2025-03-13 17:26:20,743 [INFO]: 	avg_search_speed_ms: 13.00104145930719
2025-03-13 17:26:20,743 [INFO]: 	99p_search_speed_ms: 19.23218288458881
2025-03-13 17:26:20,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:20,743 [INFO]: 	nb vectors: 3459
2025-03-13 17:26:20,743 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:20,743 [INFO]: 	compression ratio: 0.9993094013029856
2025-03-13 17:26:20,744 [INFO]: }
2025-03-13 17:26:20,744 [INFO]: 	>>> Finished "Creating the index" in 60.6961 secs
2025-03-13 17:26:20,744 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7301 secs
2025-03-13 17:26:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 22563 [episode count 2/20]
[retrieval_preprocessing] for episode 88612 [episode count 3/20], we have num_retrieval=np.int64(3490) num_query=np.int64(116)
2025-03-13 17:26:22,614 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:23,229 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:23
2025-03-13 17:26:23,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.40it/s]
2025-03-13 17:26:23,263 [INFO]: There are 3490 embeddings of dim 49152
2025-03-13 17:26:23,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 17:26:23,263 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:23
2025-03-13 17:26:23,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:23,263 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:26:23,263 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:23,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:23,263 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:23
2025-03-13 17:26:23,264 [INFO]: 720.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:23,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:23,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:23
2025-03-13 17:26:23,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:23,264 [INFO]: 	Creating the index 03/13/2025, 17:26:23
2025-03-13 17:26:23,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:23
2025-03-13 17:26:23,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:26:23,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:23
2025-03-13 17:26:23,265 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:26:23,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 15.94it/s] 43%|████▎     | 6/14 [00:00<00:00, 27.88it/s] 71%|███████▏  | 10/14 [00:00<00:00, 31.08it/s]100%|██████████| 14/14 [00:04<00:00,  2.12it/s]100%|██████████| 14/14 [00:04<00:00,  3.02it/s]
2025-03-13 17:26:28,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:28
2025-03-13 17:27:08,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0348 secs
2025-03-13 17:27:08,414 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 17:27:08,414 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.26it/s]
2025-03-13 17:27:33,091 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6771 secs
2025-03-13 17:27:33,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8292 secs
2025-03-13 17:27:33,094 [INFO]: {
2025-03-13 17:27:33,094 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:33,094 [INFO]: 	index_param: efSearch=283
2025-03-13 17:27:33,094 [INFO]: 	index_path: knn.index
2025-03-13 17:27:33,094 [INFO]: 	size in bytes: 686636050
2025-03-13 17:27:33,094 [INFO]: 	avg_search_speed_ms: 14.00956214296029
2025-03-13 17:27:33,094 [INFO]: 	99p_search_speed_ms: 26.471291531343017
2025-03-13 17:27:33,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:33,094 [INFO]: 	nb vectors: 3490
2025-03-13 17:27:33,094 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:33,094 [INFO]: 	compression ratio: 0.9993094886293837
2025-03-13 17:27:33,094 [INFO]: }
2025-03-13 17:27:33,094 [INFO]: 	>>> Finished "Creating the index" in 69.8305 secs
2025-03-13 17:27:33,094 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8654 secs
2025-03-13 17:27:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 88612 [episode count 3/20]
[retrieval_preprocessing] for episode 35891 [episode count 4/20], we have num_retrieval=np.int64(3427) num_query=np.int64(179)
2025-03-13 17:27:34,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:35,785 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:35
2025-03-13 17:27:35,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.38it/s]
2025-03-13 17:27:35,819 [INFO]: There are 3427 embeddings of dim 49152
2025-03-13 17:27:35,819 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 17:27:35,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:35
2025-03-13 17:27:35,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:35,820 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:27:35,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:35,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:27:35,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:35
2025-03-13 17:27:35,821 [INFO]: 707.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:35,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:27:35,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:35
2025-03-13 17:27:35,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:35,821 [INFO]: 	Creating the index 03/13/2025, 17:27:35
2025-03-13 17:27:35,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:35
2025-03-13 17:27:35,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:27:35,824 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:35
2025-03-13 17:27:35,824 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:27:35,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.68it/s] 36%|███▌      | 5/14 [00:00<00:00, 25.25it/s] 64%|██████▍   | 9/14 [00:00<00:00, 30.52it/s] 93%|█████████▎| 13/14 [00:00<00:00, 32.34it/s]100%|██████████| 14/14 [00:03<00:00,  3.69it/s]
2025-03-13 17:27:39,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:39
2025-03-13 17:28:16,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1759 secs
2025-03-13 17:28:16,805 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:28:16,805 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.80it/s]
2025-03-13 17:28:54,310 [INFO]: 	>>> Finished "Compute fast metrics" in 37.5052 secs
2025-03-13 17:28:54,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4886 secs
2025-03-13 17:28:54,313 [INFO]: {
2025-03-13 17:28:54,313 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:54,313 [INFO]: 	index_param: efSearch=270
2025-03-13 17:28:54,313 [INFO]: 	index_path: knn.index
2025-03-13 17:28:54,313 [INFO]: 	size in bytes: 674241250
2025-03-13 17:28:54,313 [INFO]: 	avg_search_speed_ms: 10.764298467837731
2025-03-13 17:28:54,313 [INFO]: 	99p_search_speed_ms: 15.328736798837783
2025-03-13 17:28:54,313 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:54,313 [INFO]: 	nb vectors: 3427
2025-03-13 17:28:54,313 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:54,313 [INFO]: 	compression ratio: 0.9993093955613068
2025-03-13 17:28:54,313 [INFO]: }
2025-03-13 17:28:54,313 [INFO]: 	>>> Finished "Creating the index" in 78.4917 secs
2025-03-13 17:28:54,313 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5277 secs
2025-03-13 17:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 35891 [episode count 4/20]
[retrieval_preprocessing] for episode 56883 [episode count 5/20], we have num_retrieval=np.int64(3444) num_query=np.int64(162)
2025-03-13 17:28:56,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:57,278 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:57
2025-03-13 17:28:57,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 965.98it/s]
2025-03-13 17:28:57,309 [INFO]: There are 3444 embeddings of dim 49152
2025-03-13 17:28:57,309 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:28:57,309 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:57
2025-03-13 17:28:57,310 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:57,310 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:28:57,310 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:57,310 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:57,310 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:57
2025-03-13 17:28:57,310 [INFO]: 710.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:57,310 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:28:57,310 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:57
2025-03-13 17:28:57,310 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:57,310 [INFO]: 	Creating the index 03/13/2025, 17:28:57
2025-03-13 17:28:57,310 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:57
2025-03-13 17:28:57,311 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:28:57,311 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:57
2025-03-13 17:28:57,311 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:28:57,311 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.29it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.25it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.71it/s]100%|██████████| 14/14 [00:02<00:00,  5.01it/s]
2025-03-13 17:29:00,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:00
2025-03-13 17:29:45,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9549 secs
2025-03-13 17:29:45,063 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:29:45,063 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 17:30:03,377 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3141 secs
2025-03-13 17:30:03,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0823 secs
2025-03-13 17:30:03,394 [INFO]: {
2025-03-13 17:30:03,394 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:03,394 [INFO]: 	index_param: efSearch=191
2025-03-13 17:30:03,394 [INFO]: 	index_path: knn.index
2025-03-13 17:30:03,394 [INFO]: 	size in bytes: 677585950
2025-03-13 17:30:03,394 [INFO]: 	avg_search_speed_ms: 9.920108979309184
2025-03-13 17:30:03,394 [INFO]: 	99p_search_speed_ms: 14.221091750077894
2025-03-13 17:30:03,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:03,394 [INFO]: 	nb vectors: 3444
2025-03-13 17:30:03,394 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:03,394 [INFO]: 	compression ratio: 0.9993093156668906
2025-03-13 17:30:03,394 [INFO]: }
2025-03-13 17:30:03,394 [INFO]: 	>>> Finished "Creating the index" in 66.0839 secs
2025-03-13 17:30:03,394 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1161 secs
2025-03-13 17:30:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 56883 [episode count 5/20]
[retrieval_preprocessing] for episode 94774 [episode count 6/20], we have num_retrieval=np.int64(3410) num_query=np.int64(196)
2025-03-13 17:30:04,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:05,443 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:05
2025-03-13 17:30:05,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.22it/s]
2025-03-13 17:30:05,475 [INFO]: There are 3410 embeddings of dim 49152
2025-03-13 17:30:05,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:30:05,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:05
2025-03-13 17:30:05,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:05,475 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:30:05,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:05,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:05,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:05
2025-03-13 17:30:05,476 [INFO]: 703.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:05,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:05,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:05
2025-03-13 17:30:05,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:05,476 [INFO]: 	Creating the index 03/13/2025, 17:30:05
2025-03-13 17:30:05,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:05
2025-03-13 17:30:05,477 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:30:05,477 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:05
2025-03-13 17:30:05,477 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:30:05,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.13it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.03it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.78it/s]100%|██████████| 14/14 [00:03<00:00,  4.56it/s]
2025-03-13 17:30:08,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:08
2025-03-13 17:30:46,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4993 secs
2025-03-13 17:30:46,053 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:30:46,053 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-13 17:31:06,201 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1475 secs
2025-03-13 17:31:06,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7274 secs
2025-03-13 17:31:06,205 [INFO]: {
2025-03-13 17:31:06,205 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:06,205 [INFO]: 	index_param: efSearch=227
2025-03-13 17:31:06,205 [INFO]: 	index_path: knn.index
2025-03-13 17:31:06,205 [INFO]: 	size in bytes: 670896670
2025-03-13 17:31:06,205 [INFO]: 	avg_search_speed_ms: 13.41277299150475
2025-03-13 17:31:06,205 [INFO]: 	99p_search_speed_ms: 25.882430723868204
2025-03-13 17:31:06,205 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:06,205 [INFO]: 	nb vectors: 3410
2025-03-13 17:31:06,205 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:06,205 [INFO]: 	compression ratio: 0.9993092975107478
2025-03-13 17:31:06,205 [INFO]: }
2025-03-13 17:31:06,205 [INFO]: 	>>> Finished "Creating the index" in 60.7291 secs
2025-03-13 17:31:06,205 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7618 secs
2025-03-13 17:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 94774 [episode count 6/20]
[retrieval_preprocessing] for episode 43080 [episode count 7/20], we have num_retrieval=np.int64(3428) num_query=np.int64(178)
2025-03-13 17:31:08,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:09,776 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:09
2025-03-13 17:31:09,776 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-13 17:31:09,806 [INFO]: There are 3428 embeddings of dim 49152
2025-03-13 17:31:09,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:31:09,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:09
2025-03-13 17:31:09,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:09,806 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:31:09,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:09,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:09,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:09
2025-03-13 17:31:09,806 [INFO]: 707.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:09,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:09,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:09
2025-03-13 17:31:09,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:09,807 [INFO]: 	Creating the index 03/13/2025, 17:31:09
2025-03-13 17:31:09,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:09
2025-03-13 17:31:09,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:31:09,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:09
2025-03-13 17:31:09,808 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:31:09,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.40it/s] 43%|████▎     | 6/14 [00:00<00:00, 31.12it/s] 79%|███████▊  | 11/14 [00:00<00:00, 38.45it/s]100%|██████████| 14/14 [00:02<00:00,  4.95it/s]
2025-03-13 17:31:12,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:12
2025-03-13 17:31:51,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3969 secs
2025-03-13 17:31:51,039 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:31:51,039 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.51it/s]
2025-03-13 17:32:11,229 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1902 secs
2025-03-13 17:32:11,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4237 secs
2025-03-13 17:32:11,232 [INFO]: {
2025-03-13 17:32:11,232 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:11,232 [INFO]: 	index_param: efSearch=200
2025-03-13 17:32:11,232 [INFO]: 	index_path: knn.index
2025-03-13 17:32:11,232 [INFO]: 	size in bytes: 674437990
2025-03-13 17:32:11,232 [INFO]: 	avg_search_speed_ms: 9.056696373010999
2025-03-13 17:32:11,232 [INFO]: 	99p_search_speed_ms: 18.04091085446999
2025-03-13 17:32:11,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:11,232 [INFO]: 	nb vectors: 3428
2025-03-13 17:32:11,232 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:11,232 [INFO]: 	compression ratio: 0.999309401298702
2025-03-13 17:32:11,232 [INFO]: }
2025-03-13 17:32:11,232 [INFO]: 	>>> Finished "Creating the index" in 61.4253 secs
2025-03-13 17:32:11,232 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4558 secs
2025-03-13 17:32:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 43080 [episode count 7/20]
[retrieval_preprocessing] for episode 46170 [episode count 8/20], we have num_retrieval=np.int64(3448) num_query=np.int64(158)
2025-03-13 17:32:12,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:13,261 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:13
2025-03-13 17:32:13,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.98it/s]
2025-03-13 17:32:13,291 [INFO]: There are 3448 embeddings of dim 49152
2025-03-13 17:32:13,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 17:32:13,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:13
2025-03-13 17:32:13,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:13,291 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:32:13,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:13,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:13,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:13
2025-03-13 17:32:13,292 [INFO]: 711.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:13,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:13,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:13
2025-03-13 17:32:13,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:13,292 [INFO]: 	Creating the index 03/13/2025, 17:32:13
2025-03-13 17:32:13,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:13
2025-03-13 17:32:13,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:32:13,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:13
2025-03-13 17:32:13,293 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:32:13,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.24it/s] 43%|████▎     | 6/14 [00:00<00:00, 31.88it/s] 79%|███████▊  | 11/14 [00:00<00:00, 39.86it/s]100%|██████████| 14/14 [00:02<00:00,  5.45it/s]
2025-03-13 17:32:15,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:15
2025-03-13 17:32:55,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8086 secs
2025-03-13 17:32:55,677 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 17:32:55,677 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-13 17:33:17,712 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0351 secs
2025-03-13 17:33:17,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4225 secs
2025-03-13 17:33:17,715 [INFO]: {
2025-03-13 17:33:17,715 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:17,715 [INFO]: 	index_param: efSearch=225
2025-03-13 17:33:17,716 [INFO]: 	index_path: knn.index
2025-03-13 17:33:17,716 [INFO]: 	size in bytes: 678372910
2025-03-13 17:33:17,716 [INFO]: 	avg_search_speed_ms: 11.366639263525775
2025-03-13 17:33:17,716 [INFO]: 	99p_search_speed_ms: 17.169093231204897
2025-03-13 17:33:17,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:17,716 [INFO]: 	nb vectors: 3448
2025-03-13 17:33:17,716 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:17,716 [INFO]: 	compression ratio: 0.9993093385760349
2025-03-13 17:33:17,716 [INFO]: }
2025-03-13 17:33:17,716 [INFO]: 	>>> Finished "Creating the index" in 64.4240 secs
2025-03-13 17:33:17,716 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4545 secs
2025-03-13 17:33:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 46170 [episode count 8/20]
[retrieval_preprocessing] for episode 76893 [episode count 9/20], we have num_retrieval=np.int64(3357) num_query=np.int64(249)
2025-03-13 17:33:19,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:19,891 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:19
2025-03-13 17:33:19,891 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-13 17:33:19,921 [INFO]: There are 3357 embeddings of dim 49152
2025-03-13 17:33:19,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:33:19,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:19
2025-03-13 17:33:19,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:19,921 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:33:19,921 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:19,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:19,921 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:19
2025-03-13 17:33:19,921 [INFO]: 692.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:19,921 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:19,921 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:19
2025-03-13 17:33:19,921 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:19,921 [INFO]: 	Creating the index 03/13/2025, 17:33:19
2025-03-13 17:33:19,921 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:19
2025-03-13 17:33:19,922 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:33:19,922 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:19
2025-03-13 17:33:19,922 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:33:19,922 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.46it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.19it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.82it/s]100%|██████████| 14/14 [00:03<00:00,  4.30it/s]
2025-03-13 17:33:23,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:23
2025-03-13 17:33:57,247 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0675 secs
2025-03-13 17:33:57,247 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 17:33:57,247 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.91it/s]
2025-03-13 17:34:25,481 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2338 secs
2025-03-13 17:34:25,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5614 secs
2025-03-13 17:34:25,484 [INFO]: {
2025-03-13 17:34:25,484 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:25,484 [INFO]: 	index_param: efSearch=256
2025-03-13 17:34:25,484 [INFO]: 	index_path: knn.index
2025-03-13 17:34:25,484 [INFO]: 	size in bytes: 660469270
2025-03-13 17:34:25,484 [INFO]: 	avg_search_speed_ms: 11.589226154297556
2025-03-13 17:34:25,484 [INFO]: 	99p_search_speed_ms: 14.920999789610505
2025-03-13 17:34:25,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:25,484 [INFO]: 	nb vectors: 3357
2025-03-13 17:34:25,484 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:25,484 [INFO]: 	compression ratio: 0.9993092577948404
2025-03-13 17:34:25,484 [INFO]: }
2025-03-13 17:34:25,484 [INFO]: 	>>> Finished "Creating the index" in 65.5629 secs
2025-03-13 17:34:25,484 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5934 secs
2025-03-13 17:34:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 76893 [episode count 9/20]
[retrieval_preprocessing] for episode 71781 [episode count 10/20], we have num_retrieval=np.int64(3455) num_query=np.int64(151)
2025-03-13 17:34:28,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:29,126 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:29
2025-03-13 17:34:29,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1644.18it/s]
2025-03-13 17:34:29,431 [INFO]: There are 3455 embeddings of dim 49152
2025-03-13 17:34:29,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3050 secs
2025-03-13 17:34:29,431 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:29
2025-03-13 17:34:29,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:29,431 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:34:29,431 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:29,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:34:29,432 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:29
2025-03-13 17:34:29,432 [INFO]: 713.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:29,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:29,432 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:29
2025-03-13 17:34:29,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:29,432 [INFO]: 	Creating the index 03/13/2025, 17:34:29
2025-03-13 17:34:29,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:29
2025-03-13 17:34:29,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:34:29,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:29
2025-03-13 17:34:29,434 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:34:29,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.60it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.08it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.60it/s]100%|██████████| 14/14 [00:03<00:00,  4.49it/s]
2025-03-13 17:34:32,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:32
2025-03-13 17:35:12,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3131 secs
2025-03-13 17:35:12,871 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:35:12,871 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.91it/s]
2025-03-13 17:35:39,525 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6541 secs
2025-03-13 17:35:39,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0938 secs
2025-03-13 17:35:39,528 [INFO]: {
2025-03-13 17:35:39,528 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:39,528 [INFO]: 	index_param: efSearch=171
2025-03-13 17:35:39,528 [INFO]: 	index_path: knn.index
2025-03-13 17:35:39,528 [INFO]: 	size in bytes: 679750090
2025-03-13 17:35:39,528 [INFO]: 	avg_search_speed_ms: 9.245828396379052
2025-03-13 17:35:39,528 [INFO]: 	99p_search_speed_ms: 13.62557222135365
2025-03-13 17:35:39,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:39,528 [INFO]: 	nb vectors: 3455
2025-03-13 17:35:39,528 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:39,528 [INFO]: 	compression ratio: 0.9993093785393982
2025-03-13 17:35:39,528 [INFO]: }
2025-03-13 17:35:39,528 [INFO]: 	>>> Finished "Creating the index" in 70.0963 secs
2025-03-13 17:35:39,528 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4023 secs
2025-03-13 17:35:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 71781 [episode count 10/20]
[retrieval_preprocessing] for episode 71794 [episode count 11/20], we have num_retrieval=np.int64(3348) num_query=np.int64(258)
2025-03-13 17:35:40,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:41,543 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:41
2025-03-13 17:35:41,543 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.84it/s]
2025-03-13 17:35:41,574 [INFO]: There are 3348 embeddings of dim 49152
2025-03-13 17:35:41,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:35:41,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:41,574 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:35:41,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:41,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:35:41,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,574 [INFO]: 690.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:41,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:35:41,574 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:41
2025-03-13 17:35:41,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:41,574 [INFO]: 	Creating the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:41
2025-03-13 17:35:41,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:35:41,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,576 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:35:41,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.60it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.14it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.64it/s]100%|██████████| 14/14 [00:02<00:00,  5.17it/s]
2025-03-13 17:35:44,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:44
2025-03-13 17:36:19,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2046 secs
2025-03-13 17:36:19,494 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 17:36:19,494 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-13 17:36:47,049 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5551 secs
2025-03-13 17:36:47,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4762 secs
2025-03-13 17:36:47,052 [INFO]: {
2025-03-13 17:36:47,052 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:47,052 [INFO]: 	index_param: efSearch=258
2025-03-13 17:36:47,052 [INFO]: 	index_path: knn.index
2025-03-13 17:36:47,052 [INFO]: 	size in bytes: 658698610
2025-03-13 17:36:47,052 [INFO]: 	avg_search_speed_ms: 12.007850454002172
2025-03-13 17:36:47,052 [INFO]: 	99p_search_speed_ms: 18.329165242612355
2025-03-13 17:36:47,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:47,052 [INFO]: 	nb vectors: 3348
2025-03-13 17:36:47,052 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:47,052 [INFO]: 	compression ratio: 0.9993092045541131
2025-03-13 17:36:47,052 [INFO]: }
2025-03-13 17:36:47,052 [INFO]: 	>>> Finished "Creating the index" in 65.4779 secs
2025-03-13 17:36:47,052 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5095 secs
2025-03-13 17:36:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 71794 [episode count 11/20]
[retrieval_preprocessing] for episode 35959 [episode count 12/20], we have num_retrieval=np.int64(3403) num_query=np.int64(203)
2025-03-13 17:36:50,022 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:50,750 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:50
2025-03-13 17:36:50,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 17:36:50,781 [INFO]: There are 3403 embeddings of dim 49152
2025-03-13 17:36:50,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 17:36:50,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:50
2025-03-13 17:36:50,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:50,782 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:36:50,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:50,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:50,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:50
2025-03-13 17:36:50,782 [INFO]: 702.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:50,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:50,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:50
2025-03-13 17:36:50,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:50,782 [INFO]: 	Creating the index 03/13/2025, 17:36:50
2025-03-13 17:36:50,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:50
2025-03-13 17:36:50,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:36:50,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:50
2025-03-13 17:36:50,784 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:36:50,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.05it/s] 50%|█████     | 7/14 [00:00<00:00, 33.48it/s] 86%|████████▌ | 12/14 [00:00<00:00, 38.74it/s]100%|██████████| 14/14 [00:03<00:00,  4.10it/s]
2025-03-13 17:36:54,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:54
2025-03-13 17:37:34,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5869 secs
2025-03-13 17:37:34,795 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:37:34,795 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.41it/s]
2025-03-13 17:37:59,885 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0907 secs
2025-03-13 17:37:59,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1038 secs
2025-03-13 17:37:59,888 [INFO]: {
2025-03-13 17:37:59,888 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:59,888 [INFO]: 	index_param: efSearch=162
2025-03-13 17:37:59,888 [INFO]: 	index_path: knn.index
2025-03-13 17:37:59,888 [INFO]: 	size in bytes: 669519490
2025-03-13 17:37:59,888 [INFO]: 	avg_search_speed_ms: 7.327545134541698
2025-03-13 17:37:59,888 [INFO]: 	99p_search_speed_ms: 12.43599795736372
2025-03-13 17:37:59,888 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:59,888 [INFO]: 	nb vectors: 3403
2025-03-13 17:37:59,888 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:59,888 [INFO]: 	compression ratio: 0.9993092568522538
2025-03-13 17:37:59,888 [INFO]: }
2025-03-13 17:37:59,888 [INFO]: 	>>> Finished "Creating the index" in 69.1058 secs
2025-03-13 17:37:59,888 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1372 secs
2025-03-13 17:38:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 35959 [episode count 12/20]
[retrieval_preprocessing] for episode 65658 [episode count 13/20], we have num_retrieval=np.int64(3440) num_query=np.int64(166)
2025-03-13 17:38:01,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:02,136 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:02
2025-03-13 17:38:02,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 17:38:02,168 [INFO]: There are 3440 embeddings of dim 49152
2025-03-13 17:38:02,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 17:38:02,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:02
2025-03-13 17:38:02,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:02,169 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:38:02,169 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:02,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:38:02,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:02
2025-03-13 17:38:02,170 [INFO]: 709.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:02,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:38:02,170 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:02
2025-03-13 17:38:02,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:02,170 [INFO]: 	Creating the index 03/13/2025, 17:38:02
2025-03-13 17:38:02,170 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:02
2025-03-13 17:38:02,173 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:38:02,174 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:02
2025-03-13 17:38:02,174 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:38:02,174 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 25.67it/s] 64%|██████▍   | 9/14 [00:00<00:00, 40.48it/s]100%|██████████| 14/14 [00:02<00:00,  4.31it/s]100%|██████████| 14/14 [00:02<00:00,  5.44it/s]
2025-03-13 17:38:04,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:04
2025-03-13 17:38:41,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1646 secs
2025-03-13 17:38:41,917 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 17:38:41,917 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-13 17:39:06,561 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6442 secs
2025-03-13 17:39:06,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3896 secs
2025-03-13 17:39:06,564 [INFO]: {
2025-03-13 17:39:06,564 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:06,564 [INFO]: 	index_param: efSearch=243
2025-03-13 17:39:06,564 [INFO]: 	index_path: knn.index
2025-03-13 17:39:06,564 [INFO]: 	size in bytes: 676798930
2025-03-13 17:39:06,564 [INFO]: 	avg_search_speed_ms: 10.581656623010835
2025-03-13 17:39:06,564 [INFO]: 	99p_search_speed_ms: 13.716192403808234
2025-03-13 17:39:06,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:06,564 [INFO]: 	nb vectors: 3440
2025-03-13 17:39:06,564 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:06,564 [INFO]: 	compression ratio: 0.9993093812958599
2025-03-13 17:39:06,564 [INFO]: }
2025-03-13 17:39:06,564 [INFO]: 	>>> Finished "Creating the index" in 64.3935 secs
2025-03-13 17:39:06,564 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4280 secs
2025-03-13 17:39:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 65658 [episode count 13/20]
[retrieval_preprocessing] for episode 44163 [episode count 14/20], we have num_retrieval=np.int64(3335) num_query=np.int64(271)
2025-03-13 17:39:08,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:09,122 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:09
2025-03-13 17:39:09,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1735.33it/s]
2025-03-13 17:39:09,153 [INFO]: There are 3335 embeddings of dim 49152
2025-03-13 17:39:09,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:39:09,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:09
2025-03-13 17:39:09,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:09,153 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:39:09,153 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:09,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:09,153 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:09
2025-03-13 17:39:09,153 [INFO]: 688.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:09,153 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:09,153 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:09
2025-03-13 17:39:09,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:09,153 [INFO]: 	Creating the index 03/13/2025, 17:39:09
2025-03-13 17:39:09,154 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:09
2025-03-13 17:39:09,154 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:39:09,155 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:09
2025-03-13 17:39:09,155 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:39:09,155 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.45it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.98it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.95it/s]100%|██████████| 14/14 [00:02<00:00,  4.92it/s]
2025-03-13 17:39:12,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:12
2025-03-13 17:39:46,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0576 secs
2025-03-13 17:39:46,062 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 17:39:46,062 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 17:40:22,178 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1163 secs
2025-03-13 17:40:22,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.0260 secs
2025-03-13 17:40:22,181 [INFO]: {
2025-03-13 17:40:22,181 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:22,181 [INFO]: 	index_param: efSearch=192
2025-03-13 17:40:22,181 [INFO]: 	index_path: knn.index
2025-03-13 17:40:22,181 [INFO]: 	size in bytes: 656140990
2025-03-13 17:40:22,181 [INFO]: 	avg_search_speed_ms: 8.519073302679239
2025-03-13 17:40:22,181 [INFO]: 	99p_search_speed_ms: 13.508551409468055
2025-03-13 17:40:22,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:22,181 [INFO]: 	nb vectors: 3335
2025-03-13 17:40:22,181 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:22,181 [INFO]: 	compression ratio: 0.9993091271435427
2025-03-13 17:40:22,181 [INFO]: }
2025-03-13 17:40:22,181 [INFO]: 	>>> Finished "Creating the index" in 73.0274 secs
2025-03-13 17:40:22,181 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0584 secs
2025-03-13 17:40:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 44163 [episode count 14/20]
[retrieval_preprocessing] for episode 50823 [episode count 15/20], we have num_retrieval=np.int64(3427) num_query=np.int64(179)
2025-03-13 17:40:24,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:25,276 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:25
2025-03-13 17:40:25,276 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-13 17:40:25,307 [INFO]: There are 3427 embeddings of dim 49152
2025-03-13 17:40:25,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 17:40:25,308 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:25
2025-03-13 17:40:25,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:25,308 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:40:25,308 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:25,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:25,308 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:25
2025-03-13 17:40:25,308 [INFO]: 707.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:25,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:25,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:25
2025-03-13 17:40:25,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:25,308 [INFO]: 	Creating the index 03/13/2025, 17:40:25
2025-03-13 17:40:25,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:25
2025-03-13 17:40:25,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:40:25,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:25
2025-03-13 17:40:25,309 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:40:25,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.75it/s] 36%|███▌      | 5/14 [00:00<00:00, 23.83it/s] 71%|███████▏  | 10/14 [00:00<00:00, 32.50it/s]100%|██████████| 14/14 [00:03<00:00,  3.35it/s]100%|██████████| 14/14 [00:03<00:00,  4.51it/s]
2025-03-13 17:40:28,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:28
2025-03-13 17:41:11,827 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4128 secs
2025-03-13 17:41:11,828 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:41:11,828 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-13 17:41:32,821 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9929 secs
2025-03-13 17:41:32,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5152 secs
2025-03-13 17:41:32,825 [INFO]: {
2025-03-13 17:41:32,825 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:32,825 [INFO]: 	index_param: efSearch=185
2025-03-13 17:41:32,825 [INFO]: 	index_path: knn.index
2025-03-13 17:41:32,825 [INFO]: 	size in bytes: 674241250
2025-03-13 17:41:32,825 [INFO]: 	avg_search_speed_ms: 10.939833583031053
2025-03-13 17:41:32,825 [INFO]: 	99p_search_speed_ms: 17.465855351183563
2025-03-13 17:41:32,825 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:32,825 [INFO]: 	nb vectors: 3427
2025-03-13 17:41:32,825 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:32,825 [INFO]: 	compression ratio: 0.9993093955613068
2025-03-13 17:41:32,825 [INFO]: }
2025-03-13 17:41:32,825 [INFO]: 	>>> Finished "Creating the index" in 67.5169 secs
2025-03-13 17:41:32,825 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5491 secs
2025-03-13 17:41:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 50823 [episode count 15/20]
[retrieval_preprocessing] for episode 80568 [episode count 16/20], we have num_retrieval=np.int64(3423) num_query=np.int64(183)
2025-03-13 17:41:35,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:35,981 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:35
2025-03-13 17:41:35,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1830.77it/s]
2025-03-13 17:41:36,014 [INFO]: There are 3423 embeddings of dim 49152
2025-03-13 17:41:36,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 17:41:36,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:36
2025-03-13 17:41:36,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:36,014 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:41:36,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:36,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:41:36,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:36
2025-03-13 17:41:36,015 [INFO]: 706.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:36,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:36,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:36
2025-03-13 17:41:36,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:36,015 [INFO]: 	Creating the index 03/13/2025, 17:41:36
2025-03-13 17:41:36,015 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:36
2025-03-13 17:41:36,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:41:36,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:36
2025-03-13 17:41:36,017 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:41:36,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.01it/s] 50%|█████     | 7/14 [00:00<00:00, 34.51it/s] 86%|████████▌ | 12/14 [00:00<00:00, 39.48it/s]100%|██████████| 14/14 [00:02<00:00,  5.07it/s]
2025-03-13 17:41:38,786 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:38
2025-03-13 17:42:16,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3303 secs
2025-03-13 17:42:16,117 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 17:42:16,117 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 17:42:36,059 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9427 secs
2025-03-13 17:42:36,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0457 secs
2025-03-13 17:42:36,063 [INFO]: {
2025-03-13 17:42:36,063 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:36,063 [INFO]: 	index_param: efSearch=237
2025-03-13 17:42:36,063 [INFO]: 	index_path: knn.index
2025-03-13 17:42:36,063 [INFO]: 	size in bytes: 673454290
2025-03-13 17:42:36,063 [INFO]: 	avg_search_speed_ms: 9.962201973959521
2025-03-13 17:42:36,063 [INFO]: 	99p_search_speed_ms: 15.805403790436687
2025-03-13 17:42:36,063 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:36,063 [INFO]: 	nb vectors: 3423
2025-03-13 17:42:36,063 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:36,063 [INFO]: 	compression ratio: 0.9993093725782042
2025-03-13 17:42:36,063 [INFO]: }
2025-03-13 17:42:36,063 [INFO]: 	>>> Finished "Creating the index" in 60.0482 secs
2025-03-13 17:42:36,063 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0823 secs
2025-03-13 17:42:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 80568 [episode count 16/20]
[retrieval_preprocessing] for episode 11509 [episode count 17/20], we have num_retrieval=np.int64(3413) num_query=np.int64(193)
2025-03-13 17:42:38,701 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:39,207 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:39
2025-03-13 17:42:39,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 17:42:39,240 [INFO]: There are 3413 embeddings of dim 49152
2025-03-13 17:42:39,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 17:42:39,241 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:39
2025-03-13 17:42:39,241 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:39,241 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:42:39,241 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:39,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:42:39,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:39
2025-03-13 17:42:39,242 [INFO]: 704.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:39,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:42:39,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:39
2025-03-13 17:42:39,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:39,242 [INFO]: 	Creating the index 03/13/2025, 17:42:39
2025-03-13 17:42:39,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:39
2025-03-13 17:42:39,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:42:39,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:39
2025-03-13 17:42:39,245 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:42:39,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.91it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.67it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.86it/s]100%|██████████| 14/14 [00:02<00:00,  4.81it/s]
2025-03-13 17:42:42,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:42
2025-03-13 17:43:16,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0682 secs
2025-03-13 17:43:16,233 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:43:16,233 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 17:43:41,784 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5505 secs
2025-03-13 17:43:41,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5406 secs
2025-03-13 17:43:41,786 [INFO]: {
2025-03-13 17:43:41,786 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:41,786 [INFO]: 	index_param: efSearch=176
2025-03-13 17:43:41,786 [INFO]: 	index_path: knn.index
2025-03-13 17:43:41,786 [INFO]: 	size in bytes: 671486890
2025-03-13 17:43:41,786 [INFO]: 	avg_search_speed_ms: 9.462546269068373
2025-03-13 17:43:41,786 [INFO]: 	99p_search_speed_ms: 15.627738339826488
2025-03-13 17:43:41,786 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:41,786 [INFO]: 	nb vectors: 3413
2025-03-13 17:43:41,786 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:41,786 [INFO]: 	compression ratio: 0.9993093148847627
2025-03-13 17:43:41,786 [INFO]: }
2025-03-13 17:43:41,786 [INFO]: 	>>> Finished "Creating the index" in 62.5438 secs
2025-03-13 17:43:41,786 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5786 secs
2025-03-13 17:43:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 11509 [episode count 17/20]
[retrieval_preprocessing] for episode 37609 [episode count 18/20], we have num_retrieval=np.int64(3443) num_query=np.int64(163)
2025-03-13 17:43:43,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:44,188 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:44
2025-03-13 17:43:44,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 962.66it/s]
2025-03-13 17:43:44,222 [INFO]: There are 3443 embeddings of dim 49152
2025-03-13 17:43:44,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 17:43:44,222 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:44
2025-03-13 17:43:44,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:44,223 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:43:44,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:44,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:44,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:44
2025-03-13 17:43:44,223 [INFO]: 710.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:44,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:43:44,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:44
2025-03-13 17:43:44,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:44,223 [INFO]: 	Creating the index 03/13/2025, 17:43:44
2025-03-13 17:43:44,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:44
2025-03-13 17:43:44,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:43:44,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:44
2025-03-13 17:43:44,224 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:43:44,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.10it/s] 36%|███▌      | 5/14 [00:00<00:00, 24.46it/s] 64%|██████▍   | 9/14 [00:00<00:00, 29.31it/s] 93%|█████████▎| 13/14 [00:00<00:00, 30.66it/s]100%|██████████| 14/14 [00:03<00:00,  4.39it/s]
2025-03-13 17:43:47,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:47
2025-03-13 17:44:20,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6828 secs
2025-03-13 17:44:20,546 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 17:44:20,546 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.15it/s]
2025-03-13 17:44:45,981 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4352 secs
2025-03-13 17:44:45,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7595 secs
2025-03-13 17:44:45,984 [INFO]: {
2025-03-13 17:44:45,984 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:45,984 [INFO]: 	index_param: efSearch=297
2025-03-13 17:44:45,984 [INFO]: 	index_path: knn.index
2025-03-13 17:44:45,984 [INFO]: 	size in bytes: 677389210
2025-03-13 17:44:45,984 [INFO]: 	avg_search_speed_ms: 16.45119071403506
2025-03-13 17:44:45,984 [INFO]: 	99p_search_speed_ms: 26.600895083975036
2025-03-13 17:44:45,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:45,984 [INFO]: 	nb vectors: 3443
2025-03-13 17:44:45,984 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:45,984 [INFO]: 	compression ratio: 0.9993093099312875
2025-03-13 17:44:45,984 [INFO]: }
2025-03-13 17:44:45,984 [INFO]: 	>>> Finished "Creating the index" in 61.7612 secs
2025-03-13 17:44:45,984 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7960 secs
2025-03-13 17:44:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 37609 [episode count 18/20]
[retrieval_preprocessing] for episode 82769 [episode count 19/20], we have num_retrieval=np.int64(3433) num_query=np.int64(173)
2025-03-13 17:44:48,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:48,980 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:48
2025-03-13 17:44:48,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1600.88it/s]
2025-03-13 17:44:49,016 [INFO]: There are 3433 embeddings of dim 49152
2025-03-13 17:44:49,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 17:44:49,016 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:49
2025-03-13 17:44:49,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:49,017 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:44:49,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:49,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:44:49,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:49
2025-03-13 17:44:49,017 [INFO]: 708.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:49,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:44:49,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:49
2025-03-13 17:44:49,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:49,018 [INFO]: 	Creating the index 03/13/2025, 17:44:49
2025-03-13 17:44:49,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:49
2025-03-13 17:44:49,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:44:49,021 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:49
2025-03-13 17:44:49,021 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:44:49,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.47it/s] 50%|█████     | 7/14 [00:00<00:00, 31.49it/s] 79%|███████▊  | 11/14 [00:00<00:00, 34.86it/s]100%|██████████| 14/14 [00:03<00:00,  4.42it/s]
2025-03-13 17:44:52,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:52
2025-03-13 17:45:30,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3003 secs
2025-03-13 17:45:30,495 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 17:45:30,495 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.69it/s]
2025-03-13 17:45:53,653 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1583 secs
2025-03-13 17:45:53,656 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6344 secs
2025-03-13 17:45:53,656 [INFO]: {
2025-03-13 17:45:53,656 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:53,656 [INFO]: 	index_param: efSearch=225
2025-03-13 17:45:53,656 [INFO]: 	index_path: knn.index
2025-03-13 17:45:53,656 [INFO]: 	size in bytes: 675421690
2025-03-13 17:45:53,656 [INFO]: 	avg_search_speed_ms: 10.247509875268003
2025-03-13 17:45:53,656 [INFO]: 	99p_search_speed_ms: 13.109605410136282
2025-03-13 17:45:53,656 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:53,656 [INFO]: 	nb vectors: 3433
2025-03-13 17:45:53,656 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:53,656 [INFO]: 	compression ratio: 0.9993094299355415
2025-03-13 17:45:53,656 [INFO]: }
2025-03-13 17:45:53,656 [INFO]: 	>>> Finished "Creating the index" in 64.6381 secs
2025-03-13 17:45:53,656 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6760 secs
2025-03-13 17:45:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 82769 [episode count 19/20]
2025-03-13 17:45:55: [retrieval_preprocessing] finished for 4465064685_put_marker_in_pot [chosen_id count 4/196]
2025-03-13 17:45:56: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4465064685_remove_marker_from_pot_put_on_table [chosen_id count 5/196]
2025-03-13 17:45:56: [retrieval_preprocessing] we have num_total=3209 embedding_dim=49152
[retrieval_preprocessing] for episode 20996 [episode count 0/20], we have num_retrieval=np.int64(2987) num_query=np.int64(222)
2025-03-13 17:45:57,232 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:58,142 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:58
2025-03-13 17:45:58,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.96it/s]
2025-03-13 17:45:58,178 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 17:45:58,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 17:45:58,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:58
2025-03-13 17:45:58,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:58,179 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:45:58,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:58,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:45:58,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:58
2025-03-13 17:45:58,179 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:58,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:45:58,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:58
2025-03-13 17:45:58,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:58,179 [INFO]: 	Creating the index 03/13/2025, 17:45:58
2025-03-13 17:45:58,179 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:58
2025-03-13 17:45:58,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:45:58,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:58
2025-03-13 17:45:58,181 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:45:58,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.87it/s] 33%|███▎      | 4/12 [00:00<00:00, 15.89it/s] 75%|███████▌  | 9/12 [00:00<00:00, 27.38it/s]100%|██████████| 12/12 [00:02<00:00,  3.72it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-13 17:46:00,750 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:00
2025-03-13 17:46:39,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6049 secs
2025-03-13 17:46:39,356 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:46:39,356 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.54it/s]
2025-03-13 17:47:04,890 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5339 secs
2025-03-13 17:47:04,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7109 secs
2025-03-13 17:47:04,892 [INFO]: {
2025-03-13 17:47:04,892 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:04,892 [INFO]: 	index_param: efSearch=207
2025-03-13 17:47:04,892 [INFO]: 	index_path: knn.index
2025-03-13 17:47:04,892 [INFO]: 	size in bytes: 587673790
2025-03-13 17:47:04,892 [INFO]: 	avg_search_speed_ms: 9.115275706579686
2025-03-13 17:47:04,892 [INFO]: 	99p_search_speed_ms: 15.458216881379482
2025-03-13 17:47:04,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:04,892 [INFO]: 	nb vectors: 2987
2025-03-13 17:47:04,892 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:04,892 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 17:47:04,892 [INFO]: }
2025-03-13 17:47:04,892 [INFO]: 	>>> Finished "Creating the index" in 66.7130 secs
2025-03-13 17:47:04,892 [INFO]: >>> Finished "Launching the whole pipeline" in 66.7502 secs
2025-03-13 17:47:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 20996 [episode count 0/20]
[retrieval_preprocessing] for episode 517 [episode count 1/20], we have num_retrieval=np.int64(3050) num_query=np.int64(159)
2025-03-13 17:47:06,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:07,372 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:07
2025-03-13 17:47:07,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1768.26it/s]
2025-03-13 17:47:07,397 [INFO]: There are 3050 embeddings of dim 49152
2025-03-13 17:47:07,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:47:07,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:07
2025-03-13 17:47:07,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:07,397 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:47:07,397 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:07,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:07,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:07
2025-03-13 17:47:07,397 [INFO]: 629.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:07,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:47:07,397 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:07
2025-03-13 17:47:07,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:07,398 [INFO]: 	Creating the index 03/13/2025, 17:47:07
2025-03-13 17:47:07,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:07
2025-03-13 17:47:07,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:47:07,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:07
2025-03-13 17:47:07,399 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:47:07,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.38it/s] 31%|███       | 4/13 [00:00<00:00, 19.75it/s] 62%|██████▏   | 8/13 [00:00<00:00, 25.19it/s] 92%|█████████▏| 12/13 [00:00<00:00, 28.01it/s]100%|██████████| 13/13 [00:02<00:00,  4.93it/s]
2025-03-13 17:47:10,040 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:10
2025-03-13 17:47:45,994 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9536 secs
2025-03-13 17:47:45,994 [INFO]: The best hyperparameters are: efSearch=327
2025-03-13 17:47:45,994 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]
2025-03-13 17:48:20,961 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9667 secs
2025-03-13 17:48:20,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.5645 secs
2025-03-13 17:48:20,963 [INFO]: {
2025-03-13 17:48:20,963 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:20,963 [INFO]: 	index_param: efSearch=327
2025-03-13 17:48:20,963 [INFO]: 	index_path: knn.index
2025-03-13 17:48:20,963 [INFO]: 	size in bytes: 600068470
2025-03-13 17:48:20,963 [INFO]: 	avg_search_speed_ms: 12.902591586293232
2025-03-13 17:48:20,964 [INFO]: 	99p_search_speed_ms: 18.494274048134685
2025-03-13 17:48:20,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:20,964 [INFO]: 	nb vectors: 3050
2025-03-13 17:48:20,964 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:20,964 [INFO]: 	compression ratio: 0.9993099620781608
2025-03-13 17:48:20,964 [INFO]: }
2025-03-13 17:48:20,964 [INFO]: 	>>> Finished "Creating the index" in 73.5660 secs
2025-03-13 17:48:20,964 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5913 secs
2025-03-13 17:48:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 517 [episode count 1/20]
[retrieval_preprocessing] for episode 84485 [episode count 2/20], we have num_retrieval=np.int64(3037) num_query=np.int64(172)
2025-03-13 17:48:22,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:23,361 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:23
2025-03-13 17:48:23,362 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.57it/s]
2025-03-13 17:48:23,394 [INFO]: There are 3037 embeddings of dim 49152
2025-03-13 17:48:23,395 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 17:48:23,395 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:23
2025-03-13 17:48:23,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:23,395 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:48:23,395 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:23,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:23,395 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:23
2025-03-13 17:48:23,395 [INFO]: 626.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:23,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:48:23,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:23
2025-03-13 17:48:23,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:23,395 [INFO]: 	Creating the index 03/13/2025, 17:48:23
2025-03-13 17:48:23,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:23
2025-03-13 17:48:23,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:48:23,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:23
2025-03-13 17:48:23,396 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:48:23,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.85it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.81it/s]100%|██████████| 12/12 [00:02<00:00,  4.49it/s]100%|██████████| 12/12 [00:02<00:00,  5.44it/s]
2025-03-13 17:48:25,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:25
2025-03-13 17:49:03,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8366 secs
2025-03-13 17:49:03,442 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 17:49:03,442 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.17it/s]
2025-03-13 17:49:21,126 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6839 secs
2025-03-13 17:49:21,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7319 secs
2025-03-13 17:49:21,128 [INFO]: {
2025-03-13 17:49:21,128 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:21,128 [INFO]: 	index_param: efSearch=241
2025-03-13 17:49:21,128 [INFO]: 	index_path: knn.index
2025-03-13 17:49:21,128 [INFO]: 	size in bytes: 597510850
2025-03-13 17:49:21,128 [INFO]: 	avg_search_speed_ms: 10.6436809643786
2025-03-13 17:49:21,129 [INFO]: 	99p_search_speed_ms: 14.357317488174886
2025-03-13 17:49:21,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:21,129 [INFO]: 	nb vectors: 3037
2025-03-13 17:49:21,129 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:21,129 [INFO]: 	compression ratio: 0.9993098803143072
2025-03-13 17:49:21,129 [INFO]: }
2025-03-13 17:49:21,129 [INFO]: 	>>> Finished "Creating the index" in 57.7333 secs
2025-03-13 17:49:21,129 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7671 secs
2025-03-13 17:49:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 84485 [episode count 2/20]
[retrieval_preprocessing] for episode 61980 [episode count 3/20], we have num_retrieval=np.int64(3061) num_query=np.int64(148)
2025-03-13 17:49:23,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:23,790 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:23
2025-03-13 17:49:23,790 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2173.21it/s]
2025-03-13 17:49:23,814 [INFO]: There are 3061 embeddings of dim 49152
2025-03-13 17:49:23,814 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:49:23,815 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:23
2025-03-13 17:49:23,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:23,815 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:49:23,815 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:23,815 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:23,815 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:23
2025-03-13 17:49:23,815 [INFO]: 631.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:23,815 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:23,815 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:23
2025-03-13 17:49:23,815 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:23,815 [INFO]: 	Creating the index 03/13/2025, 17:49:23
2025-03-13 17:49:23,815 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:23
2025-03-13 17:49:23,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:49:23,816 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:23
2025-03-13 17:49:23,816 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:49:23,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.45it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.79it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.26it/s]100%|██████████| 13/13 [00:02<00:00,  5.13it/s]
2025-03-13 17:49:26,353 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:26
2025-03-13 17:49:55,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3029 secs
2025-03-13 17:49:55,656 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 17:49:55,656 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-13 17:50:27,642 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9854 secs
2025-03-13 17:50:27,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8274 secs
2025-03-13 17:50:27,644 [INFO]: {
2025-03-13 17:50:27,644 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:27,644 [INFO]: 	index_param: efSearch=326
2025-03-13 17:50:27,644 [INFO]: 	index_path: knn.index
2025-03-13 17:50:27,644 [INFO]: 	size in bytes: 602232730
2025-03-13 17:50:27,644 [INFO]: 	avg_search_speed_ms: 12.072374080886348
2025-03-13 17:50:27,644 [INFO]: 	99p_search_speed_ms: 18.544028745964173
2025-03-13 17:50:27,644 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:27,644 [INFO]: 	nb vectors: 3061
2025-03-13 17:50:27,644 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:27,644 [INFO]: 	compression ratio: 0.9993098315994882
2025-03-13 17:50:27,644 [INFO]: }
2025-03-13 17:50:27,644 [INFO]: 	>>> Finished "Creating the index" in 63.8290 secs
2025-03-13 17:50:27,644 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8544 secs
2025-03-13 17:50:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 61980 [episode count 3/20]
[retrieval_preprocessing] for episode 84009 [episode count 4/20], we have num_retrieval=np.int64(3031) num_query=np.int64(178)
2025-03-13 17:50:30,161 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:30,618 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:30
2025-03-13 17:50:30,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2552.83it/s]
2025-03-13 17:50:30,648 [INFO]: There are 3031 embeddings of dim 49152
2025-03-13 17:50:30,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 17:50:30,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:30
2025-03-13 17:50:30,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:30,648 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:50:30,648 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:30,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:30,648 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:30
2025-03-13 17:50:30,649 [INFO]: 625.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:30,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:50:30,649 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:30
2025-03-13 17:50:30,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:30,649 [INFO]: 	Creating the index 03/13/2025, 17:50:30
2025-03-13 17:50:30,649 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:30
2025-03-13 17:50:30,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:50:30,650 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:30
2025-03-13 17:50:30,650 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:50:30,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.55it/s] 50%|█████     | 6/12 [00:00<00:00, 29.44it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.50it/s]100%|██████████| 12/12 [00:02<00:00,  4.84it/s]
2025-03-13 17:50:33,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:33
2025-03-13 17:51:09,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9885 secs
2025-03-13 17:51:09,122 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 17:51:09,122 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 17:51:34,892 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7700 secs
2025-03-13 17:51:34,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2443 secs
2025-03-13 17:51:34,894 [INFO]: {
2025-03-13 17:51:34,894 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:34,894 [INFO]: 	index_param: efSearch=314
2025-03-13 17:51:34,894 [INFO]: 	index_path: knn.index
2025-03-13 17:51:34,894 [INFO]: 	size in bytes: 596330350
2025-03-13 17:51:34,894 [INFO]: 	avg_search_speed_ms: 11.879566202997594
2025-03-13 17:51:34,894 [INFO]: 	99p_search_speed_ms: 15.845424155704677
2025-03-13 17:51:34,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:34,894 [INFO]: 	nb vectors: 3031
2025-03-13 17:51:34,894 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:34,894 [INFO]: 	compression ratio: 0.9993099428865225
2025-03-13 17:51:34,894 [INFO]: }
2025-03-13 17:51:34,894 [INFO]: 	>>> Finished "Creating the index" in 64.2456 secs
2025-03-13 17:51:34,894 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2765 secs
2025-03-13 17:51:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 84009 [episode count 4/20]
[retrieval_preprocessing] for episode 10795 [episode count 5/20], we have num_retrieval=np.int64(3033) num_query=np.int64(176)
2025-03-13 17:51:37,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:38,239 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:38
2025-03-13 17:51:38,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1944.51it/s]
2025-03-13 17:51:38,266 [INFO]: There are 3033 embeddings of dim 49152
2025-03-13 17:51:38,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:51:38,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:38
2025-03-13 17:51:38,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:38,266 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:51:38,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:38,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:38,266 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:38
2025-03-13 17:51:38,267 [INFO]: 625.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:38,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:51:38,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:38
2025-03-13 17:51:38,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:38,267 [INFO]: 	Creating the index 03/13/2025, 17:51:38
2025-03-13 17:51:38,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:38
2025-03-13 17:51:38,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:51:38,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:38
2025-03-13 17:51:38,268 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:51:38,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.51it/s] 50%|█████     | 6/12 [00:00<00:00, 27.95it/s] 92%|█████████▏| 11/12 [00:00<00:00, 33.61it/s]100%|██████████| 12/12 [00:02<00:00,  4.95it/s]
2025-03-13 17:51:40,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:40
2025-03-13 17:52:17,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0681 secs
2025-03-13 17:52:17,764 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:52:17,764 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s]
2025-03-13 17:52:41,250 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4853 secs
2025-03-13 17:52:41,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9839 secs
2025-03-13 17:52:41,252 [INFO]: {
2025-03-13 17:52:41,252 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:41,252 [INFO]: 	index_param: efSearch=232
2025-03-13 17:52:41,252 [INFO]: 	index_path: knn.index
2025-03-13 17:52:41,252 [INFO]: 	size in bytes: 596723890
2025-03-13 17:52:41,252 [INFO]: 	avg_search_speed_ms: 9.999034027103335
2025-03-13 17:52:41,252 [INFO]: 	99p_search_speed_ms: 15.79128221841529
2025-03-13 17:52:41,252 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:41,252 [INFO]: 	nb vectors: 3033
2025-03-13 17:52:41,252 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:41,252 [INFO]: 	compression ratio: 0.9993098550151897
2025-03-13 17:52:41,252 [INFO]: }
2025-03-13 17:52:41,252 [INFO]: 	>>> Finished "Creating the index" in 62.9855 secs
2025-03-13 17:52:41,252 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0136 secs
2025-03-13 17:52:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 10795 [episode count 5/20]
[retrieval_preprocessing] for episode 79404 [episode count 6/20], we have num_retrieval=np.int64(3129) num_query=np.int64(80)
2025-03-13 17:52:43,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:43,803 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:43
2025-03-13 17:52:43,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1007.28it/s]
2025-03-13 17:52:43,842 [INFO]: There are 3129 embeddings of dim 49152
2025-03-13 17:52:43,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 17:52:43,842 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:43
2025-03-13 17:52:43,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:43,842 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:52:43,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:43,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:43,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:43
2025-03-13 17:52:43,842 [INFO]: 645.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:43,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:43,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:43
2025-03-13 17:52:43,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:43,842 [INFO]: 	Creating the index 03/13/2025, 17:52:43
2025-03-13 17:52:43,843 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:43
2025-03-13 17:52:43,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:52:43,844 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:43
2025-03-13 17:52:43,844 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:52:43,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.22it/s] 38%|███▊      | 5/13 [00:00<00:00, 22.33it/s] 69%|██████▉   | 9/13 [00:00<00:00, 27.75it/s]100%|██████████| 13/13 [00:02<00:00,  3.42it/s]100%|██████████| 13/13 [00:02<00:00,  4.56it/s]
2025-03-13 17:52:46,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:46
2025-03-13 17:53:21,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6443 secs
2025-03-13 17:53:21,342 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 17:53:21,343 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.26it/s]
2025-03-13 17:53:38,906 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5639 secs
2025-03-13 17:53:38,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0646 secs
2025-03-13 17:53:38,908 [INFO]: {
2025-03-13 17:53:38,908 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:38,909 [INFO]: 	index_param: efSearch=165
2025-03-13 17:53:38,909 [INFO]: 	index_path: knn.index
2025-03-13 17:53:38,909 [INFO]: 	size in bytes: 615611470
2025-03-13 17:53:38,909 [INFO]: 	avg_search_speed_ms: 7.067670916657987
2025-03-13 17:53:38,909 [INFO]: 	99p_search_speed_ms: 9.506601789034901
2025-03-13 17:53:38,909 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:38,909 [INFO]: 	nb vectors: 3129
2025-03-13 17:53:38,909 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:38,909 [INFO]: 	compression ratio: 0.9993095677700742
2025-03-13 17:53:38,909 [INFO]: }
2025-03-13 17:53:38,909 [INFO]: 	>>> Finished "Creating the index" in 55.0661 secs
2025-03-13 17:53:38,909 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1051 secs
2025-03-13 17:53:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 79404 [episode count 6/20]
[retrieval_preprocessing] for episode 41005 [episode count 7/20], we have num_retrieval=np.int64(3086) num_query=np.int64(123)
2025-03-13 17:53:40,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:40,964 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:40
2025-03-13 17:53:40,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.11it/s]
2025-03-13 17:53:40,993 [INFO]: There are 3086 embeddings of dim 49152
2025-03-13 17:53:40,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:53:40,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:40
2025-03-13 17:53:40,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:40,993 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:53:40,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:40,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:40,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:40
2025-03-13 17:53:40,994 [INFO]: 636.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:40,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:40,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:40
2025-03-13 17:53:40,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:40,994 [INFO]: 	Creating the index 03/13/2025, 17:53:40
2025-03-13 17:53:40,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:40
2025-03-13 17:53:40,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:53:40,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:40
2025-03-13 17:53:40,995 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:53:40,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.27it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.15it/s] 46%|████▌     | 6/13 [00:00<00:00, 17.36it/s] 77%|███████▋  | 10/13 [00:00<00:00, 24.64it/s]100%|██████████| 13/13 [00:02<00:00,  3.33it/s]100%|██████████| 13/13 [00:02<00:00,  4.57it/s]
2025-03-13 17:53:43,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:43
2025-03-13 17:54:19,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2410 secs
2025-03-13 17:54:19,083 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:54:19,084 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 17:54:47,716 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6324 secs
2025-03-13 17:54:48,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4088 secs
2025-03-13 17:54:48,404 [INFO]: {
2025-03-13 17:54:48,404 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:48,404 [INFO]: 	index_param: efSearch=171
2025-03-13 17:54:48,404 [INFO]: 	index_path: knn.index
2025-03-13 17:54:48,404 [INFO]: 	size in bytes: 607151350
2025-03-13 17:54:48,405 [INFO]: 	avg_search_speed_ms: 9.617013331556405
2025-03-13 17:54:48,405 [INFO]: 	99p_search_speed_ms: 15.028221211396126
2025-03-13 17:54:48,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:48,405 [INFO]: 	nb vectors: 3086
2025-03-13 17:54:48,405 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:48,405 [INFO]: 	compression ratio: 0.9993097898901155
2025-03-13 17:54:48,405 [INFO]: }
2025-03-13 17:54:48,405 [INFO]: 	>>> Finished "Creating the index" in 67.4111 secs
2025-03-13 17:54:48,405 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4403 secs
2025-03-13 17:54:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 41005 [episode count 7/20]
[retrieval_preprocessing] for episode 34870 [episode count 8/20], we have num_retrieval=np.int64(3064) num_query=np.int64(145)
2025-03-13 17:54:50,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:50,585 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:50
2025-03-13 17:54:50,585 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.55it/s]
2025-03-13 17:54:50,615 [INFO]: There are 3064 embeddings of dim 49152
2025-03-13 17:54:50,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 17:54:50,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:50
2025-03-13 17:54:50,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:50,616 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:54:50,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:50,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:50,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:50
2025-03-13 17:54:50,616 [INFO]: 632.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:50,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:54:50,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:50
2025-03-13 17:54:50,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:50,616 [INFO]: 	Creating the index 03/13/2025, 17:54:50
2025-03-13 17:54:50,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:50
2025-03-13 17:54:50,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:54:50,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:50
2025-03-13 17:54:50,618 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:54:50,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.46it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.34it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.37it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.69it/s] 77%|███████▋  | 10/13 [00:00<00:00, 14.49it/s]100%|██████████| 13/13 [00:03<00:00,  2.93it/s]100%|██████████| 13/13 [00:03<00:00,  4.23it/s]
2025-03-13 17:54:53,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:53
2025-03-13 17:55:31,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5580 secs
2025-03-13 17:55:31,254 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 17:55:31,254 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.74it/s]
2025-03-13 17:55:54,813 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5587 secs
2025-03-13 17:55:54,815 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1972 secs
2025-03-13 17:55:54,816 [INFO]: {
2025-03-13 17:55:54,816 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:54,816 [INFO]: 	index_param: efSearch=238
2025-03-13 17:55:54,816 [INFO]: 	index_path: knn.index
2025-03-13 17:55:54,816 [INFO]: 	size in bytes: 602823010
2025-03-13 17:55:54,816 [INFO]: 	avg_search_speed_ms: 12.00944466666192
2025-03-13 17:55:54,816 [INFO]: 	99p_search_speed_ms: 23.809512173756946
2025-03-13 17:55:54,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:54,816 [INFO]: 	nb vectors: 3064
2025-03-13 17:55:54,816 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:54,816 [INFO]: 	compression ratio: 0.99930975096654
2025-03-13 17:55:54,816 [INFO]: }
2025-03-13 17:55:54,816 [INFO]: 	>>> Finished "Creating the index" in 64.1993 secs
2025-03-13 17:55:54,816 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2309 secs
2025-03-13 17:55:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 34870 [episode count 8/20]
[retrieval_preprocessing] for episode 48246 [episode count 9/20], we have num_retrieval=np.int64(3089) num_query=np.int64(120)
2025-03-13 17:55:58,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:59,316 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:59
2025-03-13 17:55:59,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-13 17:55:59,346 [INFO]: There are 3089 embeddings of dim 49152
2025-03-13 17:55:59,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:55:59,347 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:59,347 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:55:59,347 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:59,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:55:59,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,347 [INFO]: 637.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:59,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:59,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:59
2025-03-13 17:55:59,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:59,348 [INFO]: 	Creating the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:59
2025-03-13 17:55:59,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:55:59,349 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,349 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:55:59,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.93it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.03it/s] 31%|███       | 4/13 [00:00<00:01,  8.48it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.58it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.97it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.87it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.84it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.36it/s]100%|██████████| 13/13 [00:04<00:00,  1.08it/s]100%|██████████| 13/13 [00:04<00:00,  2.75it/s]
2025-03-13 17:56:04,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:04
2025-03-13 17:56:43,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9542 secs
2025-03-13 17:56:43,030 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 17:56:43,031 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-13 17:57:18,933 [INFO]: 	>>> Finished "Compute fast metrics" in 35.9027 secs
2025-03-13 17:57:18,937 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5875 secs
2025-03-13 17:57:18,937 [INFO]: {
2025-03-13 17:57:18,937 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:18,937 [INFO]: 	index_param: efSearch=259
2025-03-13 17:57:18,937 [INFO]: 	index_path: knn.index
2025-03-13 17:57:18,937 [INFO]: 	size in bytes: 607741570
2025-03-13 17:57:18,937 [INFO]: 	avg_search_speed_ms: 9.823360756425688
2025-03-13 17:57:18,937 [INFO]: 	99p_search_speed_ms: 15.599417891353378
2025-03-13 17:57:18,937 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:18,937 [INFO]: 	nb vectors: 3089
2025-03-13 17:57:18,937 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:18,937 [INFO]: 	compression ratio: 0.9993098086082872
2025-03-13 17:57:18,937 [INFO]: }
2025-03-13 17:57:18,937 [INFO]: 	>>> Finished "Creating the index" in 79.5894 secs
2025-03-13 17:57:18,937 [INFO]: >>> Finished "Launching the whole pipeline" in 79.6209 secs
2025-03-13 17:57:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 48246 [episode count 9/20]
[retrieval_preprocessing] for episode 45186 [episode count 10/20], we have num_retrieval=np.int64(3035) num_query=np.int64(174)
2025-03-13 17:57:21,356 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:21,810 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:21
2025-03-13 17:57:21,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.59it/s]
2025-03-13 17:57:21,837 [INFO]: There are 3035 embeddings of dim 49152
2025-03-13 17:57:21,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:57:21,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:21
2025-03-13 17:57:21,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:21,838 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:57:21,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:21,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:21,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:21
2025-03-13 17:57:21,838 [INFO]: 626.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:21,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:21,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:21
2025-03-13 17:57:21,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:21,838 [INFO]: 	Creating the index 03/13/2025, 17:57:21
2025-03-13 17:57:21,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:21
2025-03-13 17:57:21,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:57:21,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:21
2025-03-13 17:57:21,839 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:57:21,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.96it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.49it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.29it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.64it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.85it/s] 50%|█████     | 6/12 [00:00<00:00,  7.98it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.07it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.19it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.20it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.23it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.28it/s]100%|██████████| 12/12 [00:03<00:00,  1.31it/s]100%|██████████| 12/12 [00:03<00:00,  3.30it/s]
2025-03-13 17:57:25,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:25
2025-03-13 17:58:00,573 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0911 secs
2025-03-13 17:58:00,574 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 17:58:00,574 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 17:58:22,910 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3350 secs
2025-03-13 17:58:22,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0727 secs
2025-03-13 17:58:22,912 [INFO]: {
2025-03-13 17:58:22,912 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:22,912 [INFO]: 	index_param: efSearch=242
2025-03-13 17:58:22,912 [INFO]: 	index_path: knn.index
2025-03-13 17:58:22,912 [INFO]: 	size in bytes: 597117370
2025-03-13 17:58:22,912 [INFO]: 	avg_search_speed_ms: 9.849007021901864
2025-03-13 17:58:22,912 [INFO]: 	99p_search_speed_ms: 18.692958923056725
2025-03-13 17:58:22,912 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:22,912 [INFO]: 	nb vectors: 3035
2025-03-13 17:58:22,912 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:22,912 [INFO]: 	compression ratio: 0.999309867673084
2025-03-13 17:58:22,912 [INFO]: }
2025-03-13 17:58:22,912 [INFO]: 	>>> Finished "Creating the index" in 61.0743 secs
2025-03-13 17:58:22,912 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1016 secs
2025-03-13 17:58:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 45186 [episode count 10/20]
[retrieval_preprocessing] for episode 52876 [episode count 11/20], we have num_retrieval=np.int64(3012) num_query=np.int64(197)
2025-03-13 17:58:27,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:27,796 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:27
2025-03-13 17:58:27,796 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.15it/s]
2025-03-13 17:58:27,821 [INFO]: There are 3012 embeddings of dim 49152
2025-03-13 17:58:27,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 17:58:27,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:27
2025-03-13 17:58:27,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:27,821 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:58:27,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:27,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:27,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:27
2025-03-13 17:58:27,821 [INFO]: 621.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:27,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:58:27,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:27
2025-03-13 17:58:27,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:27,821 [INFO]: 	Creating the index 03/13/2025, 17:58:27
2025-03-13 17:58:27,822 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:27
2025-03-13 17:58:27,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:27,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:27
2025-03-13 17:58:27,823 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:58:27,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.42it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.00it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.69it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.75it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.05it/s] 50%|█████     | 6/12 [00:00<00:00,  8.25it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.39it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.51it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.67it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.69it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.66it/s]100%|██████████| 12/12 [00:03<00:00,  1.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.38it/s]
2025-03-13 17:58:31,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:31
2025-03-13 17:59:03,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5745 secs
2025-03-13 17:59:03,957 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 17:59:03,957 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 17:59:24,099 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1425 secs
2025-03-13 17:59:24,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2788 secs
2025-03-13 17:59:24,102 [INFO]: {
2025-03-13 17:59:24,102 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:24,102 [INFO]: 	index_param: efSearch=264
2025-03-13 17:59:24,102 [INFO]: 	index_path: knn.index
2025-03-13 17:59:24,102 [INFO]: 	size in bytes: 592592290
2025-03-13 17:59:24,102 [INFO]: 	avg_search_speed_ms: 11.390389541772901
2025-03-13 17:59:24,102 [INFO]: 	99p_search_speed_ms: 17.76649768231437
2025-03-13 17:59:24,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:24,102 [INFO]: 	nb vectors: 3012
2025-03-13 17:59:24,102 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:24,102 [INFO]: 	compression ratio: 0.999309822272578
2025-03-13 17:59:24,102 [INFO]: }
2025-03-13 17:59:24,102 [INFO]: 	>>> Finished "Creating the index" in 56.2804 secs
2025-03-13 17:59:24,102 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3056 secs
2025-03-13 17:59:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 52876 [episode count 11/20]
[retrieval_preprocessing] for episode 42125 [episode count 12/20], we have num_retrieval=np.int64(3054) num_query=np.int64(155)
2025-03-13 17:59:29,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:29,744 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:29
2025-03-13 17:59:29,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-13 17:59:29,769 [INFO]: There are 3054 embeddings of dim 49152
2025-03-13 17:59:29,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 17:59:29,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:29
2025-03-13 17:59:29,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:29,770 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:59:29,770 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:29,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:29,770 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:29
2025-03-13 17:59:29,770 [INFO]: 630.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:29,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:59:29,770 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:29
2025-03-13 17:59:29,770 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:29,770 [INFO]: 	Creating the index 03/13/2025, 17:59:29
2025-03-13 17:59:29,770 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:29
2025-03-13 17:59:29,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:59:29,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:29
2025-03-13 17:59:29,771 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:59:29,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.86it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.00it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.05it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.82it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.18it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.20it/s]100%|██████████| 13/13 [00:03<00:00,  1.97it/s]100%|██████████| 13/13 [00:03<00:00,  3.48it/s]
2025-03-13 17:59:34,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:34
2025-03-13 18:00:08,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7843 secs
2025-03-13 18:00:08,809 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 18:00:08,809 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 18:00:28,599 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7901 secs
2025-03-13 18:00:28,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8314 secs
2025-03-13 18:00:28,603 [INFO]: {
2025-03-13 18:00:28,603 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:28,603 [INFO]: 	index_param: efSearch=242
2025-03-13 18:00:28,603 [INFO]: 	index_path: knn.index
2025-03-13 18:00:28,603 [INFO]: 	size in bytes: 600855430
2025-03-13 18:00:28,603 [INFO]: 	avg_search_speed_ms: 10.545289471798542
2025-03-13 18:00:28,603 [INFO]: 	99p_search_speed_ms: 17.705605397932217
2025-03-13 18:00:28,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:28,603 [INFO]: 	nb vectors: 3054
2025-03-13 18:00:28,603 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:28,603 [INFO]: 	compression ratio: 0.9993099870962304
2025-03-13 18:00:28,603 [INFO]: }
2025-03-13 18:00:28,603 [INFO]: 	>>> Finished "Creating the index" in 58.8331 secs
2025-03-13 18:00:28,603 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8584 secs
2025-03-13 18:00:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 42125 [episode count 12/20]
[retrieval_preprocessing] for episode 60072 [episode count 13/20], we have num_retrieval=np.int64(3035) num_query=np.int64(174)
2025-03-13 18:00:31,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:32,009 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:32
2025-03-13 18:00:32,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.48it/s]
2025-03-13 18:00:32,036 [INFO]: There are 3035 embeddings of dim 49152
2025-03-13 18:00:32,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 18:00:32,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:32
2025-03-13 18:00:32,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:32,037 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:00:32,037 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:32,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:00:32,037 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:32
2025-03-13 18:00:32,037 [INFO]: 626.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:32,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:00:32,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:32
2025-03-13 18:00:32,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:32,037 [INFO]: 	Creating the index 03/13/2025, 18:00:32
2025-03-13 18:00:32,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:32
2025-03-13 18:00:32,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:00:32,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:32
2025-03-13 18:00:32,039 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:00:32,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.06it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.13it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.23it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.63it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.72it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.26it/s]100%|██████████| 12/12 [00:03<00:00,  3.56it/s]
2025-03-13 18:00:35,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:35
2025-03-13 18:01:12,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4849 secs
2025-03-13 18:01:12,909 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:01:12,910 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
2025-03-13 18:01:39,322 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4123 secs
2025-03-13 18:01:39,324 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2853 secs
2025-03-13 18:01:39,324 [INFO]: {
2025-03-13 18:01:39,324 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:39,324 [INFO]: 	index_param: efSearch=271
2025-03-13 18:01:39,324 [INFO]: 	index_path: knn.index
2025-03-13 18:01:39,324 [INFO]: 	size in bytes: 597117370
2025-03-13 18:01:39,324 [INFO]: 	avg_search_speed_ms: 10.158131526578671
2025-03-13 18:01:39,324 [INFO]: 	99p_search_speed_ms: 18.49857838358728
2025-03-13 18:01:39,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:39,325 [INFO]: 	nb vectors: 3035
2025-03-13 18:01:39,325 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:39,325 [INFO]: 	compression ratio: 0.999309867673084
2025-03-13 18:01:39,325 [INFO]: }
2025-03-13 18:01:39,325 [INFO]: 	>>> Finished "Creating the index" in 67.2872 secs
2025-03-13 18:01:39,325 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3159 secs
2025-03-13 18:01:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 60072 [episode count 13/20]
[retrieval_preprocessing] for episode 70890 [episode count 14/20], we have num_retrieval=np.int64(3013) num_query=np.int64(196)
2025-03-13 18:01:42,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:44,075 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:44
2025-03-13 18:01:44,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-13 18:01:44,101 [INFO]: There are 3013 embeddings of dim 49152
2025-03-13 18:01:44,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:01:44,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:44
2025-03-13 18:01:44,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:44,101 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:01:44,101 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:44,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:44,101 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:44
2025-03-13 18:01:44,101 [INFO]: 621.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:44,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:01:44,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:44
2025-03-13 18:01:44,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:44,102 [INFO]: 	Creating the index 03/13/2025, 18:01:44
2025-03-13 18:01:44,102 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:44
2025-03-13 18:01:44,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:01:44,103 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:44
2025-03-13 18:01:44,103 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:01:44,103 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.95it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.03it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.94it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.39it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.73it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.84it/s]100%|██████████| 12/12 [00:03<00:00,  4.00it/s]
2025-03-13 18:01:47,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:47
2025-03-13 18:02:23,824 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7074 secs
2025-03-13 18:02:23,824 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 18:02:23,824 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 18:02:44,986 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1623 secs
2025-03-13 18:02:44,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8858 secs
2025-03-13 18:02:44,989 [INFO]: {
2025-03-13 18:02:44,989 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:44,989 [INFO]: 	index_param: efSearch=307
2025-03-13 18:02:44,989 [INFO]: 	index_path: knn.index
2025-03-13 18:02:44,989 [INFO]: 	size in bytes: 592789030
2025-03-13 18:02:44,989 [INFO]: 	avg_search_speed_ms: 11.098980611876547
2025-03-13 18:02:44,989 [INFO]: 	99p_search_speed_ms: 21.9911050517112
2025-03-13 18:02:44,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:44,989 [INFO]: 	nb vectors: 3013
2025-03-13 18:02:44,989 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:44,989 [INFO]: 	compression ratio: 0.9993098286586038
2025-03-13 18:02:44,989 [INFO]: }
2025-03-13 18:02:44,989 [INFO]: 	>>> Finished "Creating the index" in 60.8876 secs
2025-03-13 18:02:44,989 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9146 secs
2025-03-13 18:02:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 70890 [episode count 14/20]
[retrieval_preprocessing] for episode 39674 [episode count 15/20], we have num_retrieval=np.int64(3071) num_query=np.int64(138)
2025-03-13 18:02:48,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:48,806 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:48
2025-03-13 18:02:48,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.18it/s]
2025-03-13 18:02:48,831 [INFO]: There are 3071 embeddings of dim 49152
2025-03-13 18:02:48,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 18:02:48,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:48
2025-03-13 18:02:48,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:48,831 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:02:48,831 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:48,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:48,831 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:48
2025-03-13 18:02:48,831 [INFO]: 633.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:48,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:48,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:48
2025-03-13 18:02:48,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:48,831 [INFO]: 	Creating the index 03/13/2025, 18:02:48
2025-03-13 18:02:48,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:48
2025-03-13 18:02:48,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:02:48,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:48
2025-03-13 18:02:48,832 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:02:48,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.84it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.68it/s] 31%|███       | 4/13 [00:00<00:00, 11.23it/s] 46%|████▌     | 6/13 [00:00<00:00, 13.27it/s] 62%|██████▏   | 8/13 [00:00<00:00, 14.40it/s] 77%|███████▋  | 10/13 [00:00<00:00, 15.25it/s] 92%|█████████▏| 12/13 [00:00<00:00, 16.15it/s]100%|██████████| 13/13 [00:02<00:00,  4.51it/s]
2025-03-13 18:02:52,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:52
2025-03-13 18:03:30,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0246 secs
2025-03-13 18:03:30,203 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 18:03:30,203 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 18:03:48,741 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5382 secs
2025-03-13 18:03:48,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9115 secs
2025-03-13 18:03:48,744 [INFO]: {
2025-03-13 18:03:48,744 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:48,744 [INFO]: 	index_param: efSearch=284
2025-03-13 18:03:48,744 [INFO]: 	index_path: knn.index
2025-03-13 18:03:48,744 [INFO]: 	size in bytes: 604200190
2025-03-13 18:03:48,744 [INFO]: 	avg_search_speed_ms: 11.33847920632712
2025-03-13 18:03:48,744 [INFO]: 	99p_search_speed_ms: 18.453914811834686
2025-03-13 18:03:48,744 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:48,744 [INFO]: 	nb vectors: 3071
2025-03-13 18:03:48,744 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:48,744 [INFO]: 	compression ratio: 0.9993097949869894
2025-03-13 18:03:48,744 [INFO]: }
2025-03-13 18:03:48,744 [INFO]: 	>>> Finished "Creating the index" in 59.9128 secs
2025-03-13 18:03:48,744 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9377 secs
2025-03-13 18:03:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 39674 [episode count 15/20]
[retrieval_preprocessing] for episode 61783 [episode count 16/20], we have num_retrieval=np.int64(3029) num_query=np.int64(180)
2025-03-13 18:03:51,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:51,788 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:51
2025-03-13 18:03:51,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.18it/s]
2025-03-13 18:03:51,815 [INFO]: There are 3029 embeddings of dim 49152
2025-03-13 18:03:51,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 18:03:51,816 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:51
2025-03-13 18:03:51,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:51,816 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:03:51,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:51,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:03:51,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:51
2025-03-13 18:03:51,816 [INFO]: 625.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:51,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:03:51,817 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:51
2025-03-13 18:03:51,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:51,817 [INFO]: 	Creating the index 03/13/2025, 18:03:51
2025-03-13 18:03:51,817 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:51
2025-03-13 18:03:51,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:03:51,820 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:51
2025-03-13 18:03:51,820 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:03:51,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.77it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.58it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.22it/s] 50%|█████     | 6/12 [00:00<00:00,  9.15it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.98it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.83it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.43it/s]100%|██████████| 12/12 [00:03<00:00,  1.94it/s]100%|██████████| 12/12 [00:03<00:00,  3.51it/s]
2025-03-13 18:03:55,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:55
2025-03-13 18:04:38,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6317 secs
2025-03-13 18:04:38,889 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:04:38,889 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 18:04:57,058 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1687 secs
2025-03-13 18:04:57,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2403 secs
2025-03-13 18:04:57,061 [INFO]: {
2025-03-13 18:04:57,061 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:57,061 [INFO]: 	index_param: efSearch=253
2025-03-13 18:04:57,061 [INFO]: 	index_path: knn.index
2025-03-13 18:04:57,061 [INFO]: 	size in bytes: 595936870
2025-03-13 18:04:57,061 [INFO]: 	avg_search_speed_ms: 10.574178104672825
2025-03-13 18:04:57,061 [INFO]: 	99p_search_speed_ms: 16.628210758790363
2025-03-13 18:04:57,061 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:57,061 [INFO]: 	nb vectors: 3029
2025-03-13 18:04:57,061 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:57,061 [INFO]: 	compression ratio: 0.9993099302615729
2025-03-13 18:04:57,061 [INFO]: }
2025-03-13 18:04:57,061 [INFO]: 	>>> Finished "Creating the index" in 65.2440 secs
2025-03-13 18:04:57,061 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2730 secs
2025-03-13 18:04:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 61783 [episode count 16/20]
[retrieval_preprocessing] for episode 54620 [episode count 17/20], we have num_retrieval=np.int64(3036) num_query=np.int64(173)
2025-03-13 18:05:00,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:00,888 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:00
2025-03-13 18:05:00,888 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.26it/s]
2025-03-13 18:05:00,914 [INFO]: There are 3036 embeddings of dim 49152
2025-03-13 18:05:00,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:05:00,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:00
2025-03-13 18:05:00,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:00,914 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:05:00,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:00,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:00,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:00
2025-03-13 18:05:00,914 [INFO]: 626.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:00,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:05:00,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:00
2025-03-13 18:05:00,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:00,915 [INFO]: 	Creating the index 03/13/2025, 18:05:00
2025-03-13 18:05:00,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:00
2025-03-13 18:05:00,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:05:00,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:00
2025-03-13 18:05:00,916 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:05:00,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.31it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.73it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.69it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.04it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.97it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.08it/s]100%|██████████| 12/12 [00:03<00:00,  3.86it/s]
2025-03-13 18:05:04,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:04
2025-03-13 18:05:35,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4945 secs
2025-03-13 18:05:35,531 [INFO]: The best hyperparameters are: efSearch=298
2025-03-13 18:05:35,532 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 18:05:57,737 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2050 secs
2025-03-13 18:05:57,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8233 secs
2025-03-13 18:05:57,739 [INFO]: {
2025-03-13 18:05:57,739 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:57,739 [INFO]: 	index_param: efSearch=298
2025-03-13 18:05:57,739 [INFO]: 	index_path: knn.index
2025-03-13 18:05:57,739 [INFO]: 	size in bytes: 597314110
2025-03-13 18:05:57,739 [INFO]: 	avg_search_speed_ms: 11.955484068310477
2025-03-13 18:05:57,739 [INFO]: 	99p_search_speed_ms: 20.449880389496684
2025-03-13 18:05:57,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:57,739 [INFO]: 	nb vectors: 3036
2025-03-13 18:05:57,739 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:57,740 [INFO]: 	compression ratio: 0.9993098739957775
2025-03-13 18:05:57,740 [INFO]: }
2025-03-13 18:05:57,740 [INFO]: 	>>> Finished "Creating the index" in 56.8249 secs
2025-03-13 18:05:57,740 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8515 secs
2025-03-13 18:05:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 54620 [episode count 17/20]
[retrieval_preprocessing] for episode 84317 [episode count 18/20], we have num_retrieval=np.int64(3058) num_query=np.int64(151)
2025-03-13 18:06:00,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:00,922 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:00
2025-03-13 18:06:00,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-13 18:06:00,947 [INFO]: There are 3058 embeddings of dim 49152
2025-03-13 18:06:00,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:06:00,947 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:00
2025-03-13 18:06:00,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:00,947 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:06:00,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:00,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:00,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:00
2025-03-13 18:06:00,947 [INFO]: 631.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:00,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:06:00,947 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:00
2025-03-13 18:06:00,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:00,947 [INFO]: 	Creating the index 03/13/2025, 18:06:00
2025-03-13 18:06:00,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:00
2025-03-13 18:06:00,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:06:00,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:00
2025-03-13 18:06:00,948 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:06:00,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.10it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.39it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.12it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.53it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.83it/s]100%|██████████| 13/13 [00:02<00:00,  2.71it/s]100%|██████████| 13/13 [00:02<00:00,  4.51it/s]
2025-03-13 18:06:03,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:03
2025-03-13 18:06:34,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4308 secs
2025-03-13 18:06:34,263 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 18:06:34,263 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 18:07:02,446 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1827 secs
2025-03-13 18:07:02,449 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5004 secs
2025-03-13 18:07:02,449 [INFO]: {
2025-03-13 18:07:02,449 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:02,449 [INFO]: 	index_param: efSearch=273
2025-03-13 18:07:02,449 [INFO]: 	index_path: knn.index
2025-03-13 18:07:02,449 [INFO]: 	size in bytes: 601642510
2025-03-13 18:07:02,449 [INFO]: 	avg_search_speed_ms: 10.419016311061569
2025-03-13 18:07:02,449 [INFO]: 	99p_search_speed_ms: 14.16236442979425
2025-03-13 18:07:02,449 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:02,449 [INFO]: 	nb vectors: 3058
2025-03-13 18:07:02,449 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:02,449 [INFO]: 	compression ratio: 0.9993098127324813
2025-03-13 18:07:02,449 [INFO]: }
2025-03-13 18:07:02,449 [INFO]: 	>>> Finished "Creating the index" in 61.5017 secs
2025-03-13 18:07:02,449 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5267 secs
2025-03-13 18:07:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 84317 [episode count 18/20]
[retrieval_preprocessing] for episode 52070 [episode count 19/20], we have num_retrieval=np.int64(3061) num_query=np.int64(148)
2025-03-13 18:07:05,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:06,241 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:06
2025-03-13 18:07:06,241 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2006.84it/s]
2025-03-13 18:07:06,266 [INFO]: There are 3061 embeddings of dim 49152
2025-03-13 18:07:06,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:07:06,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:06
2025-03-13 18:07:06,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:06,267 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:07:06,267 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:06,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:06,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:06
2025-03-13 18:07:06,267 [INFO]: 631.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:06,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:06,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:06
2025-03-13 18:07:06,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:06,267 [INFO]: 	Creating the index 03/13/2025, 18:07:06
2025-03-13 18:07:06,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:06
2025-03-13 18:07:06,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:06,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:06
2025-03-13 18:07:06,268 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:07:06,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.31it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.12it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.98it/s] 31%|███       | 4/13 [00:00<00:01,  8.62it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.49it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.33it/s]100%|██████████| 13/13 [00:03<00:00,  1.50it/s]100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
2025-03-13 18:07:09,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:09
2025-03-13 18:07:47,840 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8932 secs
2025-03-13 18:07:47,841 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 18:07:47,841 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:08:14,022 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1811 secs
2025-03-13 18:08:14,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7560 secs
2025-03-13 18:08:14,024 [INFO]: {
2025-03-13 18:08:14,024 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:14,024 [INFO]: 	index_param: efSearch=257
2025-03-13 18:08:14,024 [INFO]: 	index_path: knn.index
2025-03-13 18:08:14,024 [INFO]: 	size in bytes: 602232730
2025-03-13 18:08:14,024 [INFO]: 	avg_search_speed_ms: 10.224561003924315
2025-03-13 18:08:14,024 [INFO]: 	99p_search_speed_ms: 16.244878747966144
2025-03-13 18:08:14,024 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:14,024 [INFO]: 	nb vectors: 3061
2025-03-13 18:08:14,024 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:14,024 [INFO]: 	compression ratio: 0.9993098315994882
2025-03-13 18:08:14,024 [INFO]: }
2025-03-13 18:08:14,025 [INFO]: 	>>> Finished "Creating the index" in 67.7574 secs
2025-03-13 18:08:14,025 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7835 secs
2025-03-13 18:08:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 52070 [episode count 19/20]
2025-03-13 18:08:15: [retrieval_preprocessing] finished for 4465064685_remove_marker_from_pot_put_on_table [chosen_id count 5/196]
2025-03-13 18:08:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4465064685_put_carrot_plushie_on_pan [chosen_id count 6/196]
2025-03-13 18:08:18: [retrieval_preprocessing] we have num_total=2792 embedding_dim=49152
[retrieval_preprocessing] for episode 87558 [episode count 0/20], we have num_retrieval=np.int64(2671) num_query=np.int64(121)
2025-03-13 18:08:19,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:19,661 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:19
2025-03-13 18:08:19,661 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.47it/s]
2025-03-13 18:08:19,688 [INFO]: There are 2671 embeddings of dim 49152
2025-03-13 18:08:19,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:08:19,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:19
2025-03-13 18:08:19,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:19,688 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:08:19,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:19,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:19,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:19
2025-03-13 18:08:19,689 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:19,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:19,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:19
2025-03-13 18:08:19,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:19,689 [INFO]: 	Creating the index 03/13/2025, 18:08:19
2025-03-13 18:08:19,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:19
2025-03-13 18:08:19,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:08:19,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:19
2025-03-13 18:08:19,690 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:08:19,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.60it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.05it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.09it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.14it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.19it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.13it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.14it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.21it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.25it/s]100%|██████████| 11/11 [00:03<00:00,  1.46it/s]100%|██████████| 11/11 [00:03<00:00,  3.41it/s]
2025-03-13 18:08:22,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:22
2025-03-13 18:09:03,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1462 secs
2025-03-13 18:09:03,066 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 18:09:03,066 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 18:09:26,936 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8698 secs
2025-03-13 18:09:26,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2477 secs
2025-03-13 18:09:26,938 [INFO]: {
2025-03-13 18:09:26,938 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:26,938 [INFO]: 	index_param: efSearch=273
2025-03-13 18:09:26,938 [INFO]: 	index_path: knn.index
2025-03-13 18:09:26,938 [INFO]: 	size in bytes: 525502750
2025-03-13 18:09:26,938 [INFO]: 	avg_search_speed_ms: 9.65435430677212
2025-03-13 18:09:26,938 [INFO]: 	99p_search_speed_ms: 16.08390094479553
2025-03-13 18:09:26,938 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:26,938 [INFO]: 	nb vectors: 2671
2025-03-13 18:09:26,938 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:26,938 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-13 18:09:26,938 [INFO]: }
2025-03-13 18:09:26,938 [INFO]: 	>>> Finished "Creating the index" in 67.2493 secs
2025-03-13 18:09:26,938 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2773 secs
2025-03-13 18:09:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 87558 [episode count 0/20]
[retrieval_preprocessing] for episode 49172 [episode count 1/20], we have num_retrieval=np.int64(2644) num_query=np.int64(148)
2025-03-13 18:09:28,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:29,450 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:29
2025-03-13 18:09:29,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1124.18it/s]
2025-03-13 18:09:29,477 [INFO]: There are 2644 embeddings of dim 49152
2025-03-13 18:09:29,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:09:29,477 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:29,477 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:09:29,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:29,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:29,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,477 [INFO]: 545.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:29,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:29,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:29
2025-03-13 18:09:29,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:29,478 [INFO]: 	Creating the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:29
2025-03-13 18:09:29,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:09:29,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:29
2025-03-13 18:09:29,479 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:09:29,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.48it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.30it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.51it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.35it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.88it/s]100%|██████████| 11/11 [00:02<00:00,  2.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]
2025-03-13 18:09:32,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:32
2025-03-13 18:10:00,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7291 secs
2025-03-13 18:10:00,747 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 18:10:00,747 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 18:10:19,361 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6143 secs
2025-03-13 18:10:19,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8849 secs
2025-03-13 18:10:19,364 [INFO]: {
2025-03-13 18:10:19,364 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:19,364 [INFO]: 	index_param: efSearch=302
2025-03-13 18:10:19,364 [INFO]: 	index_path: knn.index
2025-03-13 18:10:19,364 [INFO]: 	size in bytes: 520190770
2025-03-13 18:10:19,364 [INFO]: 	avg_search_speed_ms: 10.791308152616956
2025-03-13 18:10:19,364 [INFO]: 	99p_search_speed_ms: 14.635899644345045
2025-03-13 18:10:19,364 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:19,364 [INFO]: 	nb vectors: 2644
2025-03-13 18:10:19,364 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:19,364 [INFO]: 	compression ratio: 0.9993094494929236
2025-03-13 18:10:19,364 [INFO]: }
2025-03-13 18:10:19,364 [INFO]: 	>>> Finished "Creating the index" in 49.8863 secs
2025-03-13 18:10:19,364 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9140 secs
2025-03-13 18:10:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 49172 [episode count 1/20]
[retrieval_preprocessing] for episode 46613 [episode count 2/20], we have num_retrieval=np.int64(2657) num_query=np.int64(135)
2025-03-13 18:10:21,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:22,187 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:22
2025-03-13 18:10:22,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2225.09it/s]
2025-03-13 18:10:22,217 [INFO]: There are 2657 embeddings of dim 49152
2025-03-13 18:10:22,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 18:10:22,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:22
2025-03-13 18:10:22,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:22,218 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:10:22,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:22,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:22,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:22
2025-03-13 18:10:22,218 [INFO]: 548.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:22,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:10:22,218 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:22
2025-03-13 18:10:22,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:22,218 [INFO]: 	Creating the index 03/13/2025, 18:10:22
2025-03-13 18:10:22,218 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:22
2025-03-13 18:10:22,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:10:22,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:22
2025-03-13 18:10:22,220 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:10:22,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.57it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.99it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.55it/s]
2025-03-13 18:10:24,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:24
2025-03-13 18:11:10,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1347 secs
2025-03-13 18:11:10,778 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:11:10,778 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.90it/s] 50%|█████     | 2/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 18:11:42,031 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2522 secs
2025-03-13 18:11:42,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8149 secs
2025-03-13 18:11:42,035 [INFO]: {
2025-03-13 18:11:42,035 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:42,035 [INFO]: 	index_param: efSearch=216
2025-03-13 18:11:42,035 [INFO]: 	index_path: knn.index
2025-03-13 18:11:42,035 [INFO]: 	size in bytes: 522748390
2025-03-13 18:11:42,035 [INFO]: 	avg_search_speed_ms: 9.10690476849017
2025-03-13 18:11:42,035 [INFO]: 	99p_search_speed_ms: 12.644738364033401
2025-03-13 18:11:42,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:42,035 [INFO]: 	nb vectors: 2657
2025-03-13 18:11:42,035 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:42,035 [INFO]: 	compression ratio: 0.9993095454583801
2025-03-13 18:11:42,035 [INFO]: }
2025-03-13 18:11:42,035 [INFO]: 	>>> Finished "Creating the index" in 79.8171 secs
2025-03-13 18:11:42,036 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8479 secs
2025-03-13 18:11:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 46613 [episode count 2/20]
[retrieval_preprocessing] for episode 73754 [episode count 3/20], we have num_retrieval=np.int64(2641) num_query=np.int64(151)
2025-03-13 18:11:43,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:43,847 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:43
2025-03-13 18:11:43,847 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.44it/s]
2025-03-13 18:11:43,879 [INFO]: There are 2641 embeddings of dim 49152
2025-03-13 18:11:43,880 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 18:11:43,880 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:43
2025-03-13 18:11:43,880 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:43,880 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:11:43,880 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:43,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:11:43,880 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:43
2025-03-13 18:11:43,880 [INFO]: 545.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:43,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:43,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:43
2025-03-13 18:11:43,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:43,880 [INFO]: 	Creating the index 03/13/2025, 18:11:43
2025-03-13 18:11:43,881 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:43
2025-03-13 18:11:43,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:11:43,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:43
2025-03-13 18:11:43,882 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:11:43,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.11it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.06it/s]100%|██████████| 11/11 [00:02<00:00,  4.16it/s]100%|██████████| 11/11 [00:02<00:00,  4.88it/s]
2025-03-13 18:11:46,142 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:46
2025-03-13 18:12:18,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1070 secs
2025-03-13 18:12:18,249 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 18:12:18,249 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 18:12:36,747 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4979 secs
2025-03-13 18:12:36,750 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8681 secs
2025-03-13 18:12:36,750 [INFO]: {
2025-03-13 18:12:36,750 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:36,750 [INFO]: 	index_param: efSearch=154
2025-03-13 18:12:36,750 [INFO]: 	index_path: knn.index
2025-03-13 18:12:36,750 [INFO]: 	size in bytes: 519600550
2025-03-13 18:12:36,750 [INFO]: 	avg_search_speed_ms: 8.672325351297312
2025-03-13 18:12:36,750 [INFO]: 	99p_search_speed_ms: 12.642885223031044
2025-03-13 18:12:36,751 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:36,751 [INFO]: 	nb vectors: 2641
2025-03-13 18:12:36,751 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:36,751 [INFO]: 	compression ratio: 0.999309427212885
2025-03-13 18:12:36,751 [INFO]: }
2025-03-13 18:12:36,751 [INFO]: 	>>> Finished "Creating the index" in 52.8701 secs
2025-03-13 18:12:36,751 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9032 secs
2025-03-13 18:12:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 73754 [episode count 3/20]
[retrieval_preprocessing] for episode 55843 [episode count 4/20], we have num_retrieval=np.int64(2641) num_query=np.int64(151)
2025-03-13 18:12:38,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:39,086 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:39
2025-03-13 18:12:39,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.80it/s]
2025-03-13 18:12:39,114 [INFO]: There are 2641 embeddings of dim 49152
2025-03-13 18:12:39,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 18:12:39,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:39
2025-03-13 18:12:39,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:39,115 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:12:39,115 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:39,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:12:39,115 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:39
2025-03-13 18:12:39,115 [INFO]: 545.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:39,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:39,116 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:39
2025-03-13 18:12:39,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:39,116 [INFO]: 	Creating the index 03/13/2025, 18:12:39
2025-03-13 18:12:39,116 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:39
2025-03-13 18:12:39,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:12:39,117 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:39
2025-03-13 18:12:39,118 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:12:39,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.01it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.84it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.29it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.73it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.17it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.83it/s]100%|██████████| 11/11 [00:03<00:00,  1.90it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 18:12:42,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:42
2025-03-13 18:13:18,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7816 secs
2025-03-13 18:13:18,109 [INFO]: The best hyperparameters are: efSearch=342
2025-03-13 18:13:18,109 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 18:13:41,721 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6112 secs
2025-03-13 18:13:42,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2028 secs
2025-03-13 18:13:42,321 [INFO]: {
2025-03-13 18:13:42,321 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:42,321 [INFO]: 	index_param: efSearch=342
2025-03-13 18:13:42,321 [INFO]: 	index_path: knn.index
2025-03-13 18:13:42,321 [INFO]: 	size in bytes: 519600550
2025-03-13 18:13:42,321 [INFO]: 	avg_search_speed_ms: 9.70451461526484
2025-03-13 18:13:42,321 [INFO]: 	99p_search_speed_ms: 16.842407281510532
2025-03-13 18:13:42,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:42,321 [INFO]: 	nb vectors: 2641
2025-03-13 18:13:42,321 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:42,321 [INFO]: 	compression ratio: 0.999309427212885
2025-03-13 18:13:42,321 [INFO]: }
2025-03-13 18:13:42,322 [INFO]: 	>>> Finished "Creating the index" in 63.2058 secs
2025-03-13 18:13:42,322 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2357 secs
2025-03-13 18:13:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 55843 [episode count 4/20]
[retrieval_preprocessing] for episode 37942 [episode count 5/20], we have num_retrieval=np.int64(2644) num_query=np.int64(148)
2025-03-13 18:13:48,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:48,989 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:48
2025-03-13 18:13:48,989 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.98it/s]
2025-03-13 18:13:49,020 [INFO]: There are 2644 embeddings of dim 49152
2025-03-13 18:13:49,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 18:13:49,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:49
2025-03-13 18:13:49,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:49,021 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:13:49,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:49,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:13:49,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:49
2025-03-13 18:13:49,022 [INFO]: 545.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:49,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:13:49,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:49
2025-03-13 18:13:49,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:49,023 [INFO]: 	Creating the index 03/13/2025, 18:13:49
2025-03-13 18:13:49,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:49
2025-03-13 18:13:49,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:13:49,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:49
2025-03-13 18:13:49,026 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:13:49,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.01it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.89it/s]100%|██████████| 11/11 [00:01<00:00,  4.47it/s]100%|██████████| 11/11 [00:01<00:00,  5.55it/s]
2025-03-13 18:13:51,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:51
2025-03-13 18:14:28,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4408 secs
2025-03-13 18:14:28,456 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 18:14:28,456 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.11it/s]
2025-03-13 18:14:44,899 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4431 secs
2025-03-13 18:14:44,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8762 secs
2025-03-13 18:14:44,902 [INFO]: {
2025-03-13 18:14:44,902 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:44,902 [INFO]: 	index_param: efSearch=171
2025-03-13 18:14:44,902 [INFO]: 	index_path: knn.index
2025-03-13 18:14:44,902 [INFO]: 	size in bytes: 520190770
2025-03-13 18:14:44,903 [INFO]: 	avg_search_speed_ms: 11.512641788281337
2025-03-13 18:14:44,903 [INFO]: 	99p_search_speed_ms: 18.25160881504416
2025-03-13 18:14:44,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:44,903 [INFO]: 	nb vectors: 2644
2025-03-13 18:14:44,903 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:44,903 [INFO]: 	compression ratio: 0.9993094494929236
2025-03-13 18:14:44,903 [INFO]: }
2025-03-13 18:14:44,903 [INFO]: 	>>> Finished "Creating the index" in 55.8800 secs
2025-03-13 18:14:44,903 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9141 secs
2025-03-13 18:14:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 37942 [episode count 5/20]
[retrieval_preprocessing] for episode 4668 [episode count 6/20], we have num_retrieval=np.int64(2654) num_query=np.int64(138)
2025-03-13 18:14:46,688 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:47,204 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:47
2025-03-13 18:14:47,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.13it/s]
2025-03-13 18:14:47,238 [INFO]: There are 2654 embeddings of dim 49152
2025-03-13 18:14:47,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 18:14:47,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:47
2025-03-13 18:14:47,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:47,238 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:14:47,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:47,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:47,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:47
2025-03-13 18:14:47,238 [INFO]: 547.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:47,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:47,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:47
2025-03-13 18:14:47,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:47,239 [INFO]: 	Creating the index 03/13/2025, 18:14:47
2025-03-13 18:14:47,239 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:47
2025-03-13 18:14:47,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:14:47,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:47
2025-03-13 18:14:47,240 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:14:47,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.23it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.40it/s]100%|██████████| 11/11 [00:02<00:00,  3.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.26it/s]
2025-03-13 18:14:49,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:49
2025-03-13 18:15:26,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2661 secs
2025-03-13 18:15:26,091 [INFO]: The best hyperparameters are: efSearch=322
2025-03-13 18:15:26,091 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-13 18:15:45,243 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1518 secs
2025-03-13 18:15:45,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3920 secs
2025-03-13 18:15:45,632 [INFO]: {
2025-03-13 18:15:45,632 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:45,632 [INFO]: 	index_param: efSearch=322
2025-03-13 18:15:45,633 [INFO]: 	index_path: knn.index
2025-03-13 18:15:45,633 [INFO]: 	size in bytes: 522158170
2025-03-13 18:15:45,633 [INFO]: 	avg_search_speed_ms: 11.509845154927946
2025-03-13 18:15:45,633 [INFO]: 	99p_search_speed_ms: 17.243547597900022
2025-03-13 18:15:45,633 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:45,633 [INFO]: 	nb vectors: 2654
2025-03-13 18:15:45,633 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:45,633 [INFO]: 	compression ratio: 0.9993095233959473
2025-03-13 18:15:45,633 [INFO]: }
2025-03-13 18:15:45,633 [INFO]: 	>>> Finished "Creating the index" in 58.3944 secs
2025-03-13 18:15:45,633 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4287 secs
2025-03-13 18:15:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 4668 [episode count 6/20]
[retrieval_preprocessing] for episode 69186 [episode count 7/20], we have num_retrieval=np.int64(2645) num_query=np.int64(147)
2025-03-13 18:15:47,351 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:47,753 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:47
2025-03-13 18:15:47,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 18:15:47,778 [INFO]: There are 2645 embeddings of dim 49152
2025-03-13 18:15:47,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:15:47,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:47
2025-03-13 18:15:47,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:47,779 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:15:47,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:47,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:47,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:47
2025-03-13 18:15:47,779 [INFO]: 545.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:47,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:47,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:47
2025-03-13 18:15:47,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:47,779 [INFO]: 	Creating the index 03/13/2025, 18:15:47
2025-03-13 18:15:47,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:47
2025-03-13 18:15:47,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:15:47,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:47
2025-03-13 18:15:47,781 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:15:47,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.83it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.93it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.72it/s]
2025-03-13 18:15:50,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:50
2025-03-13 18:16:22,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6260 secs
2025-03-13 18:16:22,742 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 18:16:22,742 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.76it/s]
2025-03-13 18:16:44,151 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4093 secs
2025-03-13 18:16:44,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3721 secs
2025-03-13 18:16:44,153 [INFO]: {
2025-03-13 18:16:44,153 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:44,153 [INFO]: 	index_param: efSearch=272
2025-03-13 18:16:44,153 [INFO]: 	index_path: knn.index
2025-03-13 18:16:44,153 [INFO]: 	size in bytes: 520387510
2025-03-13 18:16:44,153 [INFO]: 	avg_search_speed_ms: 8.417495096969397
2025-03-13 18:16:44,153 [INFO]: 	99p_search_speed_ms: 12.563182238955045
2025-03-13 18:16:44,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:44,153 [INFO]: 	nb vectors: 2645
2025-03-13 18:16:44,153 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:44,153 [INFO]: 	compression ratio: 0.999309456908372
2025-03-13 18:16:44,153 [INFO]: }
2025-03-13 18:16:44,153 [INFO]: 	>>> Finished "Creating the index" in 56.3735 secs
2025-03-13 18:16:44,153 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3994 secs
2025-03-13 18:16:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 69186 [episode count 7/20]
[retrieval_preprocessing] for episode 8780 [episode count 8/20], we have num_retrieval=np.int64(2676) num_query=np.int64(116)
2025-03-13 18:16:45,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:46,930 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:46
2025-03-13 18:16:46,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1758.62it/s]
2025-03-13 18:16:46,956 [INFO]: There are 2676 embeddings of dim 49152
2025-03-13 18:16:46,956 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:16:46,956 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:46
2025-03-13 18:16:46,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:46,956 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:16:46,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:46,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:46,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:46
2025-03-13 18:16:46,957 [INFO]: 552.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:46,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:46,957 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:46
2025-03-13 18:16:46,957 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:46,957 [INFO]: 	Creating the index 03/13/2025, 18:16:46
2025-03-13 18:16:46,957 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:46
2025-03-13 18:16:46,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:16:46,958 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:46
2025-03-13 18:16:46,958 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:16:46,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.72it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.84it/s] 82%|████████▏ | 9/11 [00:00<00:00, 28.81it/s]100%|██████████| 11/11 [00:01<00:00,  5.77it/s]
2025-03-13 18:16:48,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:48
2025-03-13 18:17:26,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2412 secs
2025-03-13 18:17:26,110 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:17:26,110 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 18:17:42,088 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9782 secs
2025-03-13 18:17:42,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2027 secs
2025-03-13 18:17:42,161 [INFO]: {
2025-03-13 18:17:42,161 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:42,161 [INFO]: 	index_param: efSearch=203
2025-03-13 18:17:42,161 [INFO]: 	index_path: knn.index
2025-03-13 18:17:42,161 [INFO]: 	size in bytes: 526486450
2025-03-13 18:17:42,161 [INFO]: 	avg_search_speed_ms: 9.413699498233472
2025-03-13 18:17:42,161 [INFO]: 	99p_search_speed_ms: 17.04836682649331
2025-03-13 18:17:42,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:42,161 [INFO]: 	nb vectors: 2676
2025-03-13 18:17:42,161 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:42,161 [INFO]: 	compression ratio: 0.9993096840384021
2025-03-13 18:17:42,161 [INFO]: }
2025-03-13 18:17:42,162 [INFO]: 	>>> Finished "Creating the index" in 55.2048 secs
2025-03-13 18:17:42,162 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2310 secs
2025-03-13 18:17:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 8780 [episode count 8/20]
[retrieval_preprocessing] for episode 88659 [episode count 9/20], we have num_retrieval=np.int64(2644) num_query=np.int64(148)
2025-03-13 18:17:43,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:44,068 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:44
2025-03-13 18:17:44,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-13 18:17:44,097 [INFO]: There are 2644 embeddings of dim 49152
2025-03-13 18:17:44,097 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:17:44,098 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:44
2025-03-13 18:17:44,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:44,098 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:17:44,098 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:44,098 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:44,098 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:44
2025-03-13 18:17:44,098 [INFO]: 545.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:44,098 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:44,098 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:44
2025-03-13 18:17:44,098 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:44,098 [INFO]: 	Creating the index 03/13/2025, 18:17:44
2025-03-13 18:17:44,098 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:44
2025-03-13 18:17:44,099 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:17:44,100 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:44
2025-03-13 18:17:44,100 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:17:44,100 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.52it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.34it/s] 91%|█████████ | 10/11 [00:00<00:00, 31.96it/s]100%|██████████| 11/11 [00:02<00:00,  4.05it/s]
2025-03-13 18:17:46,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:46
2025-03-13 18:18:23,995 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1773 secs
2025-03-13 18:18:23,995 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 18:18:23,995 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 18:18:52,543 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5474 secs
2025-03-13 18:18:52,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4679 secs
2025-03-13 18:18:52,568 [INFO]: {
2025-03-13 18:18:52,568 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:52,568 [INFO]: 	index_param: efSearch=319
2025-03-13 18:18:52,568 [INFO]: 	index_path: knn.index
2025-03-13 18:18:52,568 [INFO]: 	size in bytes: 520190770
2025-03-13 18:18:52,568 [INFO]: 	avg_search_speed_ms: 10.704764817608021
2025-03-13 18:18:52,568 [INFO]: 	99p_search_speed_ms: 15.637473440729057
2025-03-13 18:18:52,568 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:52,568 [INFO]: 	nb vectors: 2644
2025-03-13 18:18:52,568 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:52,568 [INFO]: 	compression ratio: 0.9993094494929236
2025-03-13 18:18:52,568 [INFO]: }
2025-03-13 18:18:52,568 [INFO]: 	>>> Finished "Creating the index" in 68.4700 secs
2025-03-13 18:18:52,568 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5001 secs
2025-03-13 18:18:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 88659 [episode count 9/20]
[retrieval_preprocessing] for episode 16478 [episode count 10/20], we have num_retrieval=np.int64(2629) num_query=np.int64(163)
2025-03-13 18:18:54,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:55,688 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:55
2025-03-13 18:18:55,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 18:18:55,717 [INFO]: There are 2629 embeddings of dim 49152
2025-03-13 18:18:55,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:18:55,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:55
2025-03-13 18:18:55,717 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:55,717 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:18:55,717 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:55,717 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:55,717 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:55
2025-03-13 18:18:55,717 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:55,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:18:55,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:55
2025-03-13 18:18:55,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:55,717 [INFO]: 	Creating the index 03/13/2025, 18:18:55
2025-03-13 18:18:55,717 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:55
2025-03-13 18:18:55,718 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:18:55,719 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:55
2025-03-13 18:18:55,719 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:18:55,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.57it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.60it/s]100%|██████████| 11/11 [00:01<00:00,  4.71it/s]100%|██████████| 11/11 [00:01<00:00,  5.51it/s]
2025-03-13 18:18:57,717 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:57
2025-03-13 18:19:26,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9349 secs
2025-03-13 18:19:26,653 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 18:19:26,653 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.63it/s]
2025-03-13 18:19:50,921 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2686 secs
2025-03-13 18:19:50,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2046 secs
2025-03-13 18:19:50,923 [INFO]: {
2025-03-13 18:19:50,923 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:50,923 [INFO]: 	index_param: efSearch=317
2025-03-13 18:19:50,923 [INFO]: 	index_path: knn.index
2025-03-13 18:19:50,923 [INFO]: 	size in bytes: 517239670
2025-03-13 18:19:50,923 [INFO]: 	avg_search_speed_ms: 11.169722820398029
2025-03-13 18:19:50,923 [INFO]: 	99p_search_speed_ms: 16.623294837772843
2025-03-13 18:19:50,923 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:50,923 [INFO]: 	nb vectors: 2629
2025-03-13 18:19:50,923 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:50,923 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-13 18:19:50,923 [INFO]: }
2025-03-13 18:19:50,923 [INFO]: 	>>> Finished "Creating the index" in 55.2060 secs
2025-03-13 18:19:50,923 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2351 secs
2025-03-13 18:19:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 16478 [episode count 10/20]
[retrieval_preprocessing] for episode 91267 [episode count 11/20], we have num_retrieval=np.int64(2637) num_query=np.int64(155)
2025-03-13 18:19:52,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:52,860 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:52
2025-03-13 18:19:52,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1414.61it/s]
2025-03-13 18:19:52,889 [INFO]: There are 2637 embeddings of dim 49152
2025-03-13 18:19:52,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:19:52,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:52
2025-03-13 18:19:52,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:52,890 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:19:52,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:52,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:19:52,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:52
2025-03-13 18:19:52,891 [INFO]: 544.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:52,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:19:52,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:52
2025-03-13 18:19:52,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:52,891 [INFO]: 	Creating the index 03/13/2025, 18:19:52
2025-03-13 18:19:52,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:52
2025-03-13 18:19:52,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:19:52,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:52
2025-03-13 18:19:52,895 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:19:52,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.77it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.56it/s]100%|██████████| 11/11 [00:01<00:00,  6.35it/s]
2025-03-13 18:19:54,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:54
2025-03-13 18:20:29,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5335 secs
2025-03-13 18:20:29,167 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 18:20:29,167 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.86it/s]
2025-03-13 18:20:44,509 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3411 secs
2025-03-13 18:20:44,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6157 secs
2025-03-13 18:20:44,510 [INFO]: {
2025-03-13 18:20:44,510 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:44,510 [INFO]: 	index_param: efSearch=247
2025-03-13 18:20:44,510 [INFO]: 	index_path: knn.index
2025-03-13 18:20:44,510 [INFO]: 	size in bytes: 518813590
2025-03-13 18:20:44,510 [INFO]: 	avg_search_speed_ms: 8.848731652874731
2025-03-13 18:20:44,511 [INFO]: 	99p_search_speed_ms: 12.44088788283989
2025-03-13 18:20:44,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:44,511 [INFO]: 	nb vectors: 2637
2025-03-13 18:20:44,511 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:44,511 [INFO]: 	compression ratio: 0.9993093974273111
2025-03-13 18:20:44,511 [INFO]: }
2025-03-13 18:20:44,511 [INFO]: 	>>> Finished "Creating the index" in 51.6191 secs
2025-03-13 18:20:44,511 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6504 secs
2025-03-13 18:20:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 91267 [episode count 11/20]
[retrieval_preprocessing] for episode 69254 [episode count 12/20], we have num_retrieval=np.int64(2655) num_query=np.int64(137)
2025-03-13 18:20:46,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:46,423 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:46
2025-03-13 18:20:46,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2175.47it/s]
2025-03-13 18:20:46,450 [INFO]: There are 2655 embeddings of dim 49152
2025-03-13 18:20:46,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:20:46,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:46
2025-03-13 18:20:46,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:46,450 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:20:46,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:46,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:46,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:46
2025-03-13 18:20:46,451 [INFO]: 547.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:46,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:20:46,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:46
2025-03-13 18:20:46,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:46,451 [INFO]: 	Creating the index 03/13/2025, 18:20:46
2025-03-13 18:20:46,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:46
2025-03-13 18:20:46,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:20:46,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:46
2025-03-13 18:20:46,452 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:20:46,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.30it/s]100%|██████████| 11/11 [00:01<00:00,  4.56it/s]100%|██████████| 11/11 [00:01<00:00,  5.62it/s]
2025-03-13 18:20:48,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:48
2025-03-13 18:21:18,857 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4434 secs
2025-03-13 18:21:18,857 [INFO]: The best hyperparameters are: efSearch=354
2025-03-13 18:21:18,857 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.85it/s]
2025-03-13 18:21:43,032 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1748 secs
2025-03-13 18:21:43,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5817 secs
2025-03-13 18:21:43,034 [INFO]: {
2025-03-13 18:21:43,034 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:43,034 [INFO]: 	index_param: efSearch=354
2025-03-13 18:21:43,034 [INFO]: 	index_path: knn.index
2025-03-13 18:21:43,034 [INFO]: 	size in bytes: 522354910
2025-03-13 18:21:43,034 [INFO]: 	avg_search_speed_ms: 10.90445720175263
2025-03-13 18:21:43,034 [INFO]: 	99p_search_speed_ms: 14.420417873188853
2025-03-13 18:21:43,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:43,034 [INFO]: 	nb vectors: 2655
2025-03-13 18:21:43,034 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:43,034 [INFO]: 	compression ratio: 0.9993095307556312
2025-03-13 18:21:43,034 [INFO]: }
2025-03-13 18:21:43,034 [INFO]: 	>>> Finished "Creating the index" in 56.5830 secs
2025-03-13 18:21:43,034 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6107 secs
2025-03-13 18:21:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 69254 [episode count 12/20]
[retrieval_preprocessing] for episode 62132 [episode count 13/20], we have num_retrieval=np.int64(2639) num_query=np.int64(153)
2025-03-13 18:21:45,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:45,732 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:45
2025-03-13 18:21:45,733 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2359.00it/s]
2025-03-13 18:21:45,760 [INFO]: There are 2639 embeddings of dim 49152
2025-03-13 18:21:45,760 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:21:45,761 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:45
2025-03-13 18:21:45,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:45,761 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:21:45,761 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:45,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:21:45,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:45
2025-03-13 18:21:45,762 [INFO]: 544.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:45,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:21:45,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:45
2025-03-13 18:21:45,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:45,762 [INFO]: 	Creating the index 03/13/2025, 18:21:45
2025-03-13 18:21:45,762 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:45
2025-03-13 18:21:45,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:21:45,766 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:45
2025-03-13 18:21:45,766 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:21:45,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.68it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.39it/s]100%|██████████| 11/11 [00:02<00:00,  4.35it/s]100%|██████████| 11/11 [00:02<00:00,  5.38it/s]
2025-03-13 18:21:47,814 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:47
2025-03-13 18:22:21,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3016 secs
2025-03-13 18:22:21,116 [INFO]: The best hyperparameters are: efSearch=330
2025-03-13 18:22:21,116 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 18:22:44,481 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3647 secs
2025-03-13 18:22:44,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7168 secs
2025-03-13 18:22:44,483 [INFO]: {
2025-03-13 18:22:44,483 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:44,483 [INFO]: 	index_param: efSearch=330
2025-03-13 18:22:44,483 [INFO]: 	index_path: knn.index
2025-03-13 18:22:44,483 [INFO]: 	size in bytes: 519207070
2025-03-13 18:22:44,483 [INFO]: 	avg_search_speed_ms: 11.152117234605926
2025-03-13 18:22:44,483 [INFO]: 	99p_search_speed_ms: 15.054414961487053
2025-03-13 18:22:44,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:44,483 [INFO]: 	nb vectors: 2639
2025-03-13 18:22:44,483 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:44,483 [INFO]: 	compression ratio: 0.9993094123313845
2025-03-13 18:22:44,483 [INFO]: }
2025-03-13 18:22:44,483 [INFO]: 	>>> Finished "Creating the index" in 58.7207 secs
2025-03-13 18:22:44,483 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7506 secs
2025-03-13 18:22:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 62132 [episode count 13/20]
[retrieval_preprocessing] for episode 39695 [episode count 14/20], we have num_retrieval=np.int64(2689) num_query=np.int64(103)
2025-03-13 18:22:46,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:46,626 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:46
2025-03-13 18:22:46,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1801.68it/s]
2025-03-13 18:22:46,670 [INFO]: There are 2689 embeddings of dim 49152
2025-03-13 18:22:46,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-13 18:22:46,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:46
2025-03-13 18:22:46,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:46,671 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:22:46,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:46,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:22:46,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:46
2025-03-13 18:22:46,672 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:46,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:22:46,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:46
2025-03-13 18:22:46,673 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:46,673 [INFO]: 	Creating the index 03/13/2025, 18:22:46
2025-03-13 18:22:46,673 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:46
2025-03-13 18:22:46,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:22:46,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:46
2025-03-13 18:22:46,678 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:22:46,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.97it/s] 45%|████▌     | 5/11 [00:00<00:00, 26.45it/s] 91%|█████████ | 10/11 [00:00<00:00, 34.71it/s]100%|██████████| 11/11 [00:02<00:00,  5.19it/s]
2025-03-13 18:22:48,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:48
2025-03-13 18:23:41,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9086 secs
2025-03-13 18:23:41,713 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 18:23:41,713 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-13 18:24:03,469 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7559 secs
2025-03-13 18:24:03,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7940 secs
2025-03-13 18:24:03,472 [INFO]: {
2025-03-13 18:24:03,472 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:03,472 [INFO]: 	index_param: efSearch=198
2025-03-13 18:24:03,472 [INFO]: 	index_path: knn.index
2025-03-13 18:24:03,472 [INFO]: 	size in bytes: 529044070
2025-03-13 18:24:03,472 [INFO]: 	avg_search_speed_ms: 8.338131526099819
2025-03-13 18:24:03,472 [INFO]: 	99p_search_speed_ms: 11.440939716994762
2025-03-13 18:24:03,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:03,472 [INFO]: 	nb vectors: 2689
2025-03-13 18:24:03,472 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:03,472 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-13 18:24:03,472 [INFO]: }
2025-03-13 18:24:03,472 [INFO]: 	>>> Finished "Creating the index" in 76.7986 secs
2025-03-13 18:24:03,472 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8460 secs
2025-03-13 18:24:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 39695 [episode count 14/20]
[retrieval_preprocessing] for episode 65301 [episode count 15/20], we have num_retrieval=np.int64(2651) num_query=np.int64(141)
2025-03-13 18:24:04,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:04,955 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:04
2025-03-13 18:24:04,955 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.20it/s]
2025-03-13 18:24:04,982 [INFO]: There are 2651 embeddings of dim 49152
2025-03-13 18:24:04,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:24:04,983 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:04
2025-03-13 18:24:04,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:04,983 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:24:04,983 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:04,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:24:04,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:04
2025-03-13 18:24:04,983 [INFO]: 547.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:04,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:24:04,984 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:04
2025-03-13 18:24:04,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:04,984 [INFO]: 	Creating the index 03/13/2025, 18:24:04
2025-03-13 18:24:04,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:04
2025-03-13 18:24:04,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 18:24:04,986 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:04
2025-03-13 18:24:04,986 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:24:04,986 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.47it/s]100%|██████████| 11/11 [00:02<00:00,  4.12it/s]100%|██████████| 11/11 [00:02<00:00,  5.13it/s]
2025-03-13 18:24:07,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:07
2025-03-13 18:24:40,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6131 secs
2025-03-13 18:24:40,748 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 18:24:40,748 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.80it/s]
2025-03-13 18:25:00,255 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5068 secs
2025-03-13 18:25:00,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2703 secs
2025-03-13 18:25:00,257 [INFO]: {
2025-03-13 18:25:00,257 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:00,257 [INFO]: 	index_param: efSearch=263
2025-03-13 18:25:00,257 [INFO]: 	index_path: knn.index
2025-03-13 18:25:00,257 [INFO]: 	size in bytes: 521567950
2025-03-13 18:25:00,257 [INFO]: 	avg_search_speed_ms: 9.769573276116716
2025-03-13 18:25:00,257 [INFO]: 	99p_search_speed_ms: 14.092994334641839
2025-03-13 18:25:00,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:00,257 [INFO]: 	nb vectors: 2651
2025-03-13 18:25:00,257 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:00,257 [INFO]: 	compression ratio: 0.9993095012835815
2025-03-13 18:25:00,257 [INFO]: }
2025-03-13 18:25:00,257 [INFO]: 	>>> Finished "Creating the index" in 55.2732 secs
2025-03-13 18:25:00,257 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3017 secs
2025-03-13 18:25:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 65301 [episode count 15/20]
[retrieval_preprocessing] for episode 25366 [episode count 16/20], we have num_retrieval=np.int64(2655) num_query=np.int64(137)
2025-03-13 18:25:01,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:02,476 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:02
2025-03-13 18:25:02,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.80it/s]
2025-03-13 18:25:02,509 [INFO]: There are 2655 embeddings of dim 49152
2025-03-13 18:25:02,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 18:25:02,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:02
2025-03-13 18:25:02,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:02,510 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:25:02,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:02,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:25:02,511 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:02
2025-03-13 18:25:02,511 [INFO]: 547.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:02,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:25:02,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:02
2025-03-13 18:25:02,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:02,512 [INFO]: 	Creating the index 03/13/2025, 18:25:02
2025-03-13 18:25:02,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:02
2025-03-13 18:25:02,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:25:02,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:02
2025-03-13 18:25:02,516 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:25:02,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.68it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.93it/s]100%|██████████| 11/11 [00:01<00:00,  4.58it/s]100%|██████████| 11/11 [00:01<00:00,  5.66it/s]
2025-03-13 18:25:04,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:04
2025-03-13 18:25:38,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2738 secs
2025-03-13 18:25:38,150 [INFO]: The best hyperparameters are: efSearch=369
2025-03-13 18:25:38,150 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 18:26:02,961 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8110 secs
2025-03-13 18:26:02,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4469 secs
2025-03-13 18:26:02,963 [INFO]: {
2025-03-13 18:26:02,963 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:02,963 [INFO]: 	index_param: efSearch=369
2025-03-13 18:26:02,963 [INFO]: 	index_path: knn.index
2025-03-13 18:26:02,963 [INFO]: 	size in bytes: 522354910
2025-03-13 18:26:02,963 [INFO]: 	avg_search_speed_ms: 10.777165260214101
2025-03-13 18:26:02,963 [INFO]: 	99p_search_speed_ms: 19.292418132536113
2025-03-13 18:26:02,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:02,963 [INFO]: 	nb vectors: 2655
2025-03-13 18:26:02,963 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:02,963 [INFO]: 	compression ratio: 0.9993095307556312
2025-03-13 18:26:02,963 [INFO]: }
2025-03-13 18:26:02,963 [INFO]: 	>>> Finished "Creating the index" in 60.4513 secs
2025-03-13 18:26:02,963 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4869 secs
2025-03-13 18:26:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 25366 [episode count 16/20]
[retrieval_preprocessing] for episode 49957 [episode count 17/20], we have num_retrieval=np.int64(2674) num_query=np.int64(118)
2025-03-13 18:26:05,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:05,516 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:05
2025-03-13 18:26:05,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1945.41it/s]
2025-03-13 18:26:05,544 [INFO]: There are 2674 embeddings of dim 49152
2025-03-13 18:26:05,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:26:05,545 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:05
2025-03-13 18:26:05,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:05,545 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:26:05,545 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:05,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:26:05,546 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:05
2025-03-13 18:26:05,546 [INFO]: 551.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:05,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:26:05,546 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:05
2025-03-13 18:26:05,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:05,547 [INFO]: 	Creating the index 03/13/2025, 18:26:05
2025-03-13 18:26:05,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:05
2025-03-13 18:26:05,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:26:05,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:05
2025-03-13 18:26:05,550 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:26:05,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.30it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]100%|██████████| 11/11 [00:02<00:00,  5.41it/s]
2025-03-13 18:26:07,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:07
2025-03-13 18:26:39,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0200 secs
2025-03-13 18:26:39,613 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:26:39,613 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.03it/s]
2025-03-13 18:26:55,750 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1367 secs
2025-03-13 18:26:55,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2026 secs
2025-03-13 18:26:55,753 [INFO]: {
2025-03-13 18:26:55,753 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:55,753 [INFO]: 	index_param: efSearch=227
2025-03-13 18:26:55,753 [INFO]: 	index_path: knn.index
2025-03-13 18:26:55,753 [INFO]: 	size in bytes: 526092970
2025-03-13 18:26:55,753 [INFO]: 	avg_search_speed_ms: 11.074098754274027
2025-03-13 18:26:55,753 [INFO]: 	99p_search_speed_ms: 18.19915099069476
2025-03-13 18:26:55,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:55,753 [INFO]: 	nb vectors: 2674
2025-03-13 18:26:55,753 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:55,753 [INFO]: 	compression ratio: 0.9993096695437691
2025-03-13 18:26:55,753 [INFO]: }
2025-03-13 18:26:55,753 [INFO]: 	>>> Finished "Creating the index" in 50.2063 secs
2025-03-13 18:26:55,753 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2366 secs
2025-03-13 18:26:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 49957 [episode count 17/20]
[retrieval_preprocessing] for episode 53039 [episode count 18/20], we have num_retrieval=np.int64(2641) num_query=np.int64(151)
2025-03-13 18:26:58,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:59,165 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:59
2025-03-13 18:26:59,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-13 18:26:59,194 [INFO]: There are 2641 embeddings of dim 49152
2025-03-13 18:26:59,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:26:59,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:59
2025-03-13 18:26:59,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:59,195 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:26:59,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:59,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:26:59,195 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:59
2025-03-13 18:26:59,195 [INFO]: 545.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:59,195 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:59,195 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:59
2025-03-13 18:26:59,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:59,195 [INFO]: 	Creating the index 03/13/2025, 18:26:59
2025-03-13 18:26:59,195 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:59
2025-03-13 18:26:59,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:26:59,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:59
2025-03-13 18:26:59,196 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:26:59,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.63it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.77it/s]100%|██████████| 11/11 [00:02<00:00,  5.41it/s]
2025-03-13 18:27:01,233 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:01
2025-03-13 18:27:37,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0273 secs
2025-03-13 18:27:37,261 [INFO]: The best hyperparameters are: efSearch=337
2025-03-13 18:27:37,261 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 18:27:54,399 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1378 secs
2025-03-13 18:27:54,401 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2050 secs
2025-03-13 18:27:54,402 [INFO]: {
2025-03-13 18:27:54,402 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:54,402 [INFO]: 	index_param: efSearch=337
2025-03-13 18:27:54,402 [INFO]: 	index_path: knn.index
2025-03-13 18:27:54,402 [INFO]: 	size in bytes: 519600550
2025-03-13 18:27:54,402 [INFO]: 	avg_search_speed_ms: 10.491211423191075
2025-03-13 18:27:54,402 [INFO]: 	99p_search_speed_ms: 14.055472081527114
2025-03-13 18:27:54,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:54,402 [INFO]: 	nb vectors: 2641
2025-03-13 18:27:54,402 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:54,402 [INFO]: 	compression ratio: 0.999309427212885
2025-03-13 18:27:54,402 [INFO]: }
2025-03-13 18:27:54,402 [INFO]: 	>>> Finished "Creating the index" in 55.2066 secs
2025-03-13 18:27:54,402 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2366 secs
2025-03-13 18:27:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 53039 [episode count 18/20]
[retrieval_preprocessing] for episode 90440 [episode count 19/20], we have num_retrieval=np.int64(2661) num_query=np.int64(131)
2025-03-13 18:27:56,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:56,863 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:56
2025-03-13 18:27:56,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1750.54it/s]
2025-03-13 18:27:56,890 [INFO]: There are 2661 embeddings of dim 49152
2025-03-13 18:27:56,891 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:27:56,891 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:56
2025-03-13 18:27:56,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:56,891 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:27:56,891 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:56,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:56,891 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:56
2025-03-13 18:27:56,891 [INFO]: 549.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:56,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:27:56,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:56
2025-03-13 18:27:56,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:56,891 [INFO]: 	Creating the index 03/13/2025, 18:27:56
2025-03-13 18:27:56,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:56
2025-03-13 18:27:56,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:27:56,893 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:56
2025-03-13 18:27:56,893 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:27:56,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.42it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.50it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]100%|██████████| 11/11 [00:02<00:00,  4.97it/s]
2025-03-13 18:27:59,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:59
2025-03-13 18:28:28,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7253 secs
2025-03-13 18:28:28,837 [INFO]: The best hyperparameters are: efSearch=410
2025-03-13 18:28:28,837 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.28it/s]
2025-03-13 18:28:54,277 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4399 secs
2025-03-13 18:28:54,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3865 secs
2025-03-13 18:28:54,279 [INFO]: {
2025-03-13 18:28:54,279 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:54,279 [INFO]: 	index_param: efSearch=410
2025-03-13 18:28:54,280 [INFO]: 	index_path: knn.index
2025-03-13 18:28:54,280 [INFO]: 	size in bytes: 523535350
2025-03-13 18:28:54,280 [INFO]: 	avg_search_speed_ms: 13.439485272492773
2025-03-13 18:28:54,280 [INFO]: 	99p_search_speed_ms: 18.648758847266436
2025-03-13 18:28:54,280 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:54,280 [INFO]: 	nb vectors: 2661
2025-03-13 18:28:54,280 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:54,280 [INFO]: 	compression ratio: 0.9993095747975758
2025-03-13 18:28:54,280 [INFO]: }
2025-03-13 18:28:54,280 [INFO]: 	>>> Finished "Creating the index" in 57.3882 secs
2025-03-13 18:28:54,280 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4161 secs
2025-03-13 18:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 90440 [episode count 19/20]
2025-03-13 18:28:56: [retrieval_preprocessing] finished for 4465064685_put_carrot_plushie_on_pan [chosen_id count 6/196]
2025-03-13 18:28:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4465064685_put_marker_in_silver_pot [chosen_id count 7/196]
2025-03-13 18:28:57: [retrieval_preprocessing] we have num_total=3382 embedding_dim=49152
[retrieval_preprocessing] for episode 32772 [episode count 0/20], we have num_retrieval=np.int64(3203) num_query=np.int64(179)
2025-03-13 18:28:57,759 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:58,286 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:58
2025-03-13 18:28:58,287 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 18:28:58,322 [INFO]: There are 3203 embeddings of dim 49152
2025-03-13 18:28:58,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 18:28:58,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:58
2025-03-13 18:28:58,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:58,323 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:28:58,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:58,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:58,323 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:58
2025-03-13 18:28:58,323 [INFO]: 661.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:58,323 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:28:58,323 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:58
2025-03-13 18:28:58,323 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:58,323 [INFO]: 	Creating the index 03/13/2025, 18:28:58
2025-03-13 18:28:58,323 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:58
2025-03-13 18:28:58,324 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:28:58,324 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:58
2025-03-13 18:28:58,324 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:28:58,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.16it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.97it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.72it/s]100%|██████████| 13/13 [00:02<00:00,  5.09it/s]
2025-03-13 18:29:00,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:00
2025-03-13 18:29:41,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1086 secs
2025-03-13 18:29:41,992 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 18:29:41,992 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 18:29:58,982 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9902 secs
2025-03-13 18:29:58,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6604 secs
2025-03-13 18:29:58,985 [INFO]: {
2025-03-13 18:29:58,985 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:58,985 [INFO]: 	index_param: efSearch=217
2025-03-13 18:29:58,985 [INFO]: 	index_path: knn.index
2025-03-13 18:29:58,985 [INFO]: 	size in bytes: 630170350
2025-03-13 18:29:58,985 [INFO]: 	avg_search_speed_ms: 9.823905782314833
2025-03-13 18:29:58,985 [INFO]: 	99p_search_speed_ms: 17.764182295650244
2025-03-13 18:29:58,985 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:58,985 [INFO]: 	nb vectors: 3203
2025-03-13 18:29:58,985 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:58,985 [INFO]: 	compression ratio: 0.9993098278901887
2025-03-13 18:29:58,985 [INFO]: }
2025-03-13 18:29:58,985 [INFO]: 	>>> Finished "Creating the index" in 60.6618 secs
2025-03-13 18:29:58,985 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6984 secs
2025-03-13 18:29:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 32772 [episode count 0/20]
[retrieval_preprocessing] for episode 93738 [episode count 1/20], we have num_retrieval=np.int64(3184) num_query=np.int64(198)
2025-03-13 18:30:00,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:01,545 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:01
2025-03-13 18:30:01,545 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 3609.56it/s]
2025-03-13 18:30:01,572 [INFO]: There are 3184 embeddings of dim 49152
2025-03-13 18:30:01,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:30:01,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,573 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:01,573 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:30:01,573 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:01,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:30:01,573 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,573 [INFO]: 657.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:01,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:30:01,573 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:01
2025-03-13 18:30:01,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:01,573 [INFO]: 	Creating the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:01
2025-03-13 18:30:01,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:30:01,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,576 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:30:01,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 25.50it/s] 62%|██████▏   | 8/13 [00:00<00:00, 38.47it/s]100%|██████████| 13/13 [00:03<00:00,  3.08it/s]100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
2025-03-13 18:30:04,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:04
2025-03-13 18:30:45,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9910 secs
2025-03-13 18:30:45,908 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:30:45,908 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 18:31:13,717 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8096 secs
2025-03-13 18:31:14,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6496 secs
2025-03-13 18:31:14,226 [INFO]: {
2025-03-13 18:31:14,226 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:14,226 [INFO]: 	index_param: efSearch=226
2025-03-13 18:31:14,226 [INFO]: 	index_path: knn.index
2025-03-13 18:31:14,226 [INFO]: 	size in bytes: 626432290
2025-03-13 18:31:14,226 [INFO]: 	avg_search_speed_ms: 11.035493609472846
2025-03-13 18:31:14,226 [INFO]: 	99p_search_speed_ms: 15.3599510085769
2025-03-13 18:31:14,226 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:14,226 [INFO]: 	nb vectors: 3184
2025-03-13 18:31:14,226 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:14,226 [INFO]: 	compression ratio: 0.9993097131056256
2025-03-13 18:31:14,226 [INFO]: }
2025-03-13 18:31:14,226 [INFO]: 	>>> Finished "Creating the index" in 72.6529 secs
2025-03-13 18:31:14,227 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6814 secs
2025-03-13 18:31:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 93738 [episode count 1/20]
[retrieval_preprocessing] for episode 90154 [episode count 2/20], we have num_retrieval=np.int64(3249) num_query=np.int64(133)
2025-03-13 18:31:17,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:17,470 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:17
2025-03-13 18:31:17,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.15it/s]
2025-03-13 18:31:17,499 [INFO]: There are 3249 embeddings of dim 49152
2025-03-13 18:31:17,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 18:31:17,499 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:17
2025-03-13 18:31:17,499 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:17,499 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:31:17,499 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:17,499 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:17,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:17
2025-03-13 18:31:17,500 [INFO]: 670.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:17,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:31:17,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:17
2025-03-13 18:31:17,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:17,500 [INFO]: 	Creating the index 03/13/2025, 18:31:17
2025-03-13 18:31:17,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:17
2025-03-13 18:31:17,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:31:17,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:17
2025-03-13 18:31:17,501 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:31:17,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.98it/s] 23%|██▎       | 3/13 [00:00<00:00, 14.09it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.94it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.33it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.56it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.93it/s]100%|██████████| 13/13 [00:03<00:00,  1.92it/s]100%|██████████| 13/13 [00:03<00:00,  3.50it/s]
2025-03-13 18:31:21,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:21
2025-03-13 18:32:02,487 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2590 secs
2025-03-13 18:32:02,487 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:32:02,487 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.80it/s]
2025-03-13 18:32:23,424 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9365 secs
2025-03-13 18:32:23,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9264 secs
2025-03-13 18:32:23,428 [INFO]: {
2025-03-13 18:32:23,428 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:23,428 [INFO]: 	index_param: efSearch=207
2025-03-13 18:32:23,428 [INFO]: 	index_path: knn.index
2025-03-13 18:32:23,428 [INFO]: 	size in bytes: 639220990
2025-03-13 18:32:23,428 [INFO]: 	avg_search_speed_ms: 10.592477690868506
2025-03-13 18:32:23,428 [INFO]: 	99p_search_speed_ms: 19.529135271441163
2025-03-13 18:32:23,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:23,428 [INFO]: 	nb vectors: 3249
2025-03-13 18:32:23,428 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:23,428 [INFO]: 	compression ratio: 0.9993091622351137
2025-03-13 18:32:23,428 [INFO]: }
2025-03-13 18:32:23,428 [INFO]: 	>>> Finished "Creating the index" in 65.9282 secs
2025-03-13 18:32:23,428 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9577 secs
2025-03-13 18:32:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 90154 [episode count 2/20]
[retrieval_preprocessing] for episode 9808 [episode count 3/20], we have num_retrieval=np.int64(3182) num_query=np.int64(200)
2025-03-13 18:32:25,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:26,554 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:26
2025-03-13 18:32:26,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-13 18:32:26,585 [INFO]: There are 3182 embeddings of dim 49152
2025-03-13 18:32:26,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 18:32:26,585 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:26
2025-03-13 18:32:26,585 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:26,585 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:32:26,585 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:26,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:32:26,585 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:26
2025-03-13 18:32:26,586 [INFO]: 656.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:26,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:32:26,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:26
2025-03-13 18:32:26,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:26,586 [INFO]: 	Creating the index 03/13/2025, 18:32:26
2025-03-13 18:32:26,586 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:26
2025-03-13 18:32:26,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:32:26,587 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:26
2025-03-13 18:32:26,587 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:32:26,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.90it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.87it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.76it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.17it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.90it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.81it/s]100%|██████████| 13/13 [00:03<00:00,  2.17it/s]100%|██████████| 13/13 [00:03<00:00,  3.76it/s]
2025-03-13 18:32:30,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:30
2025-03-13 18:33:06,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6139 secs
2025-03-13 18:33:06,668 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 18:33:06,668 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-13 18:33:31,898 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2300 secs
2025-03-13 18:33:31,900 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3130 secs
2025-03-13 18:33:31,900 [INFO]: {
2025-03-13 18:33:31,900 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:31,900 [INFO]: 	index_param: efSearch=189
2025-03-13 18:33:31,900 [INFO]: 	index_path: knn.index
2025-03-13 18:33:31,900 [INFO]: 	size in bytes: 626038810
2025-03-13 18:33:31,900 [INFO]: 	avg_search_speed_ms: 7.828393516939545
2025-03-13 18:33:31,900 [INFO]: 	99p_search_speed_ms: 10.240076566115022
2025-03-13 18:33:31,900 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:31,900 [INFO]: 	nb vectors: 3182
2025-03-13 18:33:31,900 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:31,900 [INFO]: 	compression ratio: 0.999309700943301
2025-03-13 18:33:31,900 [INFO]: }
2025-03-13 18:33:31,900 [INFO]: 	>>> Finished "Creating the index" in 65.3145 secs
2025-03-13 18:33:31,900 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3461 secs
2025-03-13 18:33:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 9808 [episode count 3/20]
[retrieval_preprocessing] for episode 6798 [episode count 4/20], we have num_retrieval=np.int64(3250) num_query=np.int64(132)
2025-03-13 18:33:34,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:34,572 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:34
2025-03-13 18:33:34,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-13 18:33:34,598 [INFO]: There are 3250 embeddings of dim 49152
2025-03-13 18:33:34,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:33:34,598 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:34
2025-03-13 18:33:34,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:34,599 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:33:34,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:34,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:33:34,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:34
2025-03-13 18:33:34,599 [INFO]: 670.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:34,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:33:34,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:34
2025-03-13 18:33:34,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:34,600 [INFO]: 	Creating the index 03/13/2025, 18:33:34
2025-03-13 18:33:34,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:34
2025-03-13 18:33:34,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:33:34,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:34
2025-03-13 18:33:34,604 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:33:34,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.00it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.82it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.11it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.84it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.12it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.34it/s]100%|██████████| 13/13 [00:03<00:00,  2.18it/s]100%|██████████| 13/13 [00:03<00:00,  3.84it/s]
2025-03-13 18:33:37,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:37
2025-03-13 18:34:21,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2852 secs
2025-03-13 18:34:21,285 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:34:21,285 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.83it/s] 50%|█████     | 2/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 18:34:42,986 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7016 secs
2025-03-13 18:34:42,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3859 secs
2025-03-13 18:34:42,989 [INFO]: {
2025-03-13 18:34:42,990 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:42,990 [INFO]: 	index_param: efSearch=174
2025-03-13 18:34:42,990 [INFO]: 	index_path: knn.index
2025-03-13 18:34:42,990 [INFO]: 	size in bytes: 639417730
2025-03-13 18:34:42,990 [INFO]: 	avg_search_speed_ms: 9.211732803152934
2025-03-13 18:34:42,990 [INFO]: 	99p_search_speed_ms: 16.710241381078966
2025-03-13 18:34:42,990 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:42,990 [INFO]: 	nb vectors: 3250
2025-03-13 18:34:42,990 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:42,990 [INFO]: 	compression ratio: 0.9993091683585315
2025-03-13 18:34:42,990 [INFO]: }
2025-03-13 18:34:42,990 [INFO]: 	>>> Finished "Creating the index" in 68.3897 secs
2025-03-13 18:34:42,990 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4175 secs
2025-03-13 18:34:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 6798 [episode count 4/20]
[retrieval_preprocessing] for episode 95378 [episode count 5/20], we have num_retrieval=np.int64(3213) num_query=np.int64(169)
2025-03-13 18:34:45,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:45,813 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:45
2025-03-13 18:34:45,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.66it/s]
2025-03-13 18:34:45,841 [INFO]: There are 3213 embeddings of dim 49152
2025-03-13 18:34:45,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:34:45,842 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:45
2025-03-13 18:34:45,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:45,842 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:34:45,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:45,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:45,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:45
2025-03-13 18:34:45,842 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:45,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:45,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:45
2025-03-13 18:34:45,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:45,842 [INFO]: 	Creating the index 03/13/2025, 18:34:45
2025-03-13 18:34:45,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:45
2025-03-13 18:34:45,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:34:45,844 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:45
2025-03-13 18:34:45,844 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:34:45,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.20it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.33it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.88it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.64it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.51it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.63it/s]100%|██████████| 13/13 [00:04<00:00,  1.79it/s]100%|██████████| 13/13 [00:04<00:00,  3.23it/s]
2025-03-13 18:34:49,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:49
2025-03-13 18:35:30,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7388 secs
2025-03-13 18:35:30,611 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:35:30,612 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-13 18:35:55,629 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0175 secs
2025-03-13 18:35:55,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7880 secs
2025-03-13 18:35:55,632 [INFO]: {
2025-03-13 18:35:55,632 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:55,632 [INFO]: 	index_param: efSearch=228
2025-03-13 18:35:55,632 [INFO]: 	index_path: knn.index
2025-03-13 18:35:55,632 [INFO]: 	size in bytes: 632137810
2025-03-13 18:35:55,632 [INFO]: 	avg_search_speed_ms: 9.193187319076113
2025-03-13 18:35:55,632 [INFO]: 	99p_search_speed_ms: 13.221941357478489
2025-03-13 18:35:55,632 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:55,632 [INFO]: 	nb vectors: 3213
2025-03-13 18:35:55,632 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:55,632 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-13 18:35:55,632 [INFO]: }
2025-03-13 18:35:55,632 [INFO]: 	>>> Finished "Creating the index" in 69.7897 secs
2025-03-13 18:35:55,632 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8185 secs
2025-03-13 18:35:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 95378 [episode count 5/20]
[retrieval_preprocessing] for episode 85160 [episode count 6/20], we have num_retrieval=np.int64(3163) num_query=np.int64(219)
2025-03-13 18:35:58,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:59,206 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:59
2025-03-13 18:35:59,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 18:35:59,994 [INFO]: There are 3163 embeddings of dim 49152
2025-03-13 18:35:59,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7881 secs
2025-03-13 18:35:59,995 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:59
2025-03-13 18:35:59,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:59,995 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:35:59,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:59,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:35:59,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:59
2025-03-13 18:35:59,996 [INFO]: 652.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:59,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:35:59,996 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:59
2025-03-13 18:35:59,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:59,997 [INFO]: 	Creating the index 03/13/2025, 18:35:59
2025-03-13 18:35:59,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:59
2025-03-13 18:36:00,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:36:00,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:00
2025-03-13 18:36:00,000 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:36:00,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.89it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.97it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.01it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.55it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.95it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.21it/s]100%|██████████| 13/13 [00:03<00:00,  2.40it/s]100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
2025-03-13 18:36:03,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:03
2025-03-13 18:36:42,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6842 secs
2025-03-13 18:36:42,880 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 18:36:42,880 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 18:37:07,272 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3921 secs
2025-03-13 18:37:07,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2745 secs
2025-03-13 18:37:07,275 [INFO]: {
2025-03-13 18:37:07,275 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:07,275 [INFO]: 	index_param: efSearch=215
2025-03-13 18:37:07,275 [INFO]: 	index_path: knn.index
2025-03-13 18:37:07,275 [INFO]: 	size in bytes: 622300690
2025-03-13 18:37:07,275 [INFO]: 	avg_search_speed_ms: 9.467561258740412
2025-03-13 18:37:07,275 [INFO]: 	99p_search_speed_ms: 13.874991436023265
2025-03-13 18:37:07,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:07,275 [INFO]: 	nb vectors: 3163
2025-03-13 18:37:07,275 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:07,275 [INFO]: 	compression ratio: 0.9993096809839629
2025-03-13 18:37:07,275 [INFO]: }
2025-03-13 18:37:07,275 [INFO]: 	>>> Finished "Creating the index" in 67.2782 secs
2025-03-13 18:37:07,275 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0683 secs
2025-03-13 18:37:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 85160 [episode count 6/20]
[retrieval_preprocessing] for episode 43699 [episode count 7/20], we have num_retrieval=np.int64(3222) num_query=np.int64(160)
2025-03-13 18:37:09,894 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:10,971 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:10
2025-03-13 18:37:10,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.14it/s]
2025-03-13 18:37:10,995 [INFO]: There are 3222 embeddings of dim 49152
2025-03-13 18:37:10,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:37:10,995 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:10
2025-03-13 18:37:10,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:10,995 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:37:10,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:10,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:10,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:10
2025-03-13 18:37:10,996 [INFO]: 664.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:10,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:37:10,996 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:10
2025-03-13 18:37:10,996 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:10,996 [INFO]: 	Creating the index 03/13/2025, 18:37:10
2025-03-13 18:37:10,996 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:10
2025-03-13 18:37:10,997 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:37:10,997 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:10
2025-03-13 18:37:10,997 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:37:10,997 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.41it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.38it/s] 31%|███       | 4/13 [00:00<00:01,  8.67it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.91it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.10it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.29it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.24it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.29it/s]100%|██████████| 13/13 [00:03<00:00,  2.15it/s]100%|██████████| 13/13 [00:03<00:00,  3.82it/s]
2025-03-13 18:37:14,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:14
2025-03-13 18:37:56,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0606 secs
2025-03-13 18:37:56,465 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:37:56,465 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 18:38:24,491 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0251 secs
2025-03-13 18:38:24,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4954 secs
2025-03-13 18:38:24,493 [INFO]: {
2025-03-13 18:38:24,493 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:24,493 [INFO]: 	index_param: efSearch=226
2025-03-13 18:38:24,493 [INFO]: 	index_path: knn.index
2025-03-13 18:38:24,493 [INFO]: 	size in bytes: 633908590
2025-03-13 18:38:24,493 [INFO]: 	avg_search_speed_ms: 8.29083493282898
2025-03-13 18:38:24,493 [INFO]: 	99p_search_speed_ms: 11.660033639054747
2025-03-13 18:38:24,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:24,493 [INFO]: 	nb vectors: 3222
2025-03-13 18:38:24,493 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:24,493 [INFO]: 	compression ratio: 0.9993096575643501
2025-03-13 18:38:24,493 [INFO]: }
2025-03-13 18:38:24,493 [INFO]: 	>>> Finished "Creating the index" in 73.4969 secs
2025-03-13 18:38:24,493 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5221 secs
2025-03-13 18:38:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 43699 [episode count 7/20]
[retrieval_preprocessing] for episode 94396 [episode count 8/20], we have num_retrieval=np.int64(3203) num_query=np.int64(179)
2025-03-13 18:38:27,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:28,236 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:28
2025-03-13 18:38:28,236 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 18:38:28,261 [INFO]: There are 3203 embeddings of dim 49152
2025-03-13 18:38:28,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 18:38:28,261 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:28
2025-03-13 18:38:28,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:28,261 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:38:28,261 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:28,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:38:28,261 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:28
2025-03-13 18:38:28,261 [INFO]: 661.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:28,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:38:28,261 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:28
2025-03-13 18:38:28,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:28,261 [INFO]: 	Creating the index 03/13/2025, 18:38:28
2025-03-13 18:38:28,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:28
2025-03-13 18:38:28,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:38:28,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:28
2025-03-13 18:38:28,263 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:38:28,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.71it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.44it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.35it/s] 31%|███       | 4/13 [00:00<00:01,  8.84it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.86it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.91it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.94it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.90it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.90it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.05it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.94it/s]100%|██████████| 13/13 [00:03<00:00,  1.51it/s]100%|██████████| 13/13 [00:03<00:00,  3.55it/s]
2025-03-13 18:38:31,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:31
2025-03-13 18:39:08,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1732 secs
2025-03-13 18:39:08,106 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:39:08,106 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 18:39:29,374 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2674 secs
2025-03-13 18:39:29,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1137 secs
2025-03-13 18:39:29,376 [INFO]: {
2025-03-13 18:39:29,376 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:29,376 [INFO]: 	index_param: efSearch=227
2025-03-13 18:39:29,376 [INFO]: 	index_path: knn.index
2025-03-13 18:39:29,376 [INFO]: 	size in bytes: 630170350
2025-03-13 18:39:29,376 [INFO]: 	avg_search_speed_ms: 11.422361394222486
2025-03-13 18:39:29,376 [INFO]: 	99p_search_speed_ms: 16.00282418075949
2025-03-13 18:39:29,377 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:29,377 [INFO]: 	nb vectors: 3203
2025-03-13 18:39:29,377 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:29,377 [INFO]: 	compression ratio: 0.9993098278901887
2025-03-13 18:39:29,377 [INFO]: }
2025-03-13 18:39:29,377 [INFO]: 	>>> Finished "Creating the index" in 61.1152 secs
2025-03-13 18:39:29,377 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1404 secs
2025-03-13 18:39:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 94396 [episode count 8/20]
[retrieval_preprocessing] for episode 79038 [episode count 9/20], we have num_retrieval=np.int64(3242) num_query=np.int64(140)
2025-03-13 18:39:32,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:32,629 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:32
2025-03-13 18:39:32,629 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2086.72it/s]
2025-03-13 18:39:32,655 [INFO]: There are 3242 embeddings of dim 49152
2025-03-13 18:39:32,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:39:32,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:32
2025-03-13 18:39:32,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:32,656 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:39:32,656 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:32,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:39:32,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:32
2025-03-13 18:39:32,657 [INFO]: 669.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:32,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:39:32,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:32
2025-03-13 18:39:32,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:32,657 [INFO]: 	Creating the index 03/13/2025, 18:39:32
2025-03-13 18:39:32,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:32
2025-03-13 18:39:32,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:39:32,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:32
2025-03-13 18:39:32,661 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:39:32,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.36it/s] 31%|███       | 4/13 [00:00<00:01,  8.82it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.28it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.70it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.56it/s]100%|██████████| 13/13 [00:03<00:00,  1.47it/s]100%|██████████| 13/13 [00:03<00:00,  3.63it/s]
2025-03-13 18:39:36,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:36
2025-03-13 18:40:17,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7387 secs
2025-03-13 18:40:17,990 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 18:40:17,990 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 18:40:35,402 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4119 secs
2025-03-13 18:40:35,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7448 secs
2025-03-13 18:40:35,406 [INFO]: {
2025-03-13 18:40:35,406 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:35,406 [INFO]: 	index_param: efSearch=246
2025-03-13 18:40:35,406 [INFO]: 	index_path: knn.index
2025-03-13 18:40:35,406 [INFO]: 	size in bytes: 637843750
2025-03-13 18:40:35,406 [INFO]: 	avg_search_speed_ms: 10.235212822163529
2025-03-13 18:40:35,406 [INFO]: 	99p_search_speed_ms: 14.277241090312602
2025-03-13 18:40:35,406 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:35,406 [INFO]: 	nb vectors: 3242
2025-03-13 18:40:35,406 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:35,406 [INFO]: 	compression ratio: 0.9993092132673559
2025-03-13 18:40:35,406 [INFO]: }
2025-03-13 18:40:35,406 [INFO]: 	>>> Finished "Creating the index" in 62.7483 secs
2025-03-13 18:40:35,406 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7763 secs
2025-03-13 18:40:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 79038 [episode count 9/20]
[retrieval_preprocessing] for episode 22771 [episode count 10/20], we have num_retrieval=np.int64(3236) num_query=np.int64(146)
2025-03-13 18:40:37,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:39,162 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:39
2025-03-13 18:40:39,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1111.07it/s]
2025-03-13 18:40:39,188 [INFO]: There are 3236 embeddings of dim 49152
2025-03-13 18:40:39,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:40:39,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:39
2025-03-13 18:40:39,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:39,188 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:40:39,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:39,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:40:39,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:39
2025-03-13 18:40:39,188 [INFO]: 667.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:39,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:40:39,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:39
2025-03-13 18:40:39,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:39,188 [INFO]: 	Creating the index 03/13/2025, 18:40:39
2025-03-13 18:40:39,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:39
2025-03-13 18:40:39,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:40:39,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:39
2025-03-13 18:40:39,189 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:40:39,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.94it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.60it/s] 31%|███       | 4/13 [00:00<00:00, 10.60it/s] 46%|████▌     | 6/13 [00:00<00:00, 12.62it/s] 62%|██████▏   | 8/13 [00:00<00:00, 13.40it/s] 77%|███████▋  | 10/13 [00:00<00:00, 13.90it/s] 92%|█████████▏| 12/13 [00:00<00:00, 13.98it/s]100%|██████████| 13/13 [00:03<00:00,  4.30it/s]
2025-03-13 18:40:42,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:42
2025-03-13 18:41:14,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2070 secs
2025-03-13 18:41:14,431 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 18:41:14,431 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.28it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 18:41:42,673 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2420 secs
2025-03-13 18:41:42,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4865 secs
2025-03-13 18:41:42,676 [INFO]: {
2025-03-13 18:41:42,676 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:42,676 [INFO]: 	index_param: efSearch=258
2025-03-13 18:41:42,676 [INFO]: 	index_path: knn.index
2025-03-13 18:41:42,676 [INFO]: 	size in bytes: 636663310
2025-03-13 18:41:42,676 [INFO]: 	avg_search_speed_ms: 11.065632010350598
2025-03-13 18:41:42,676 [INFO]: 	99p_search_speed_ms: 15.181470979005104
2025-03-13 18:41:42,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:42,676 [INFO]: 	nb vectors: 3236
2025-03-13 18:41:42,676 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:42,676 [INFO]: 	compression ratio: 0.9993091764625167
2025-03-13 18:41:42,676 [INFO]: }
2025-03-13 18:41:42,676 [INFO]: 	>>> Finished "Creating the index" in 63.4880 secs
2025-03-13 18:41:42,676 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5140 secs
2025-03-13 18:41:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 22771 [episode count 10/20]
[retrieval_preprocessing] for episode 14645 [episode count 11/20], we have num_retrieval=np.int64(3138) num_query=np.int64(244)
2025-03-13 18:41:45,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:46,333 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:46
2025-03-13 18:41:46,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2298.25it/s]
2025-03-13 18:41:46,357 [INFO]: There are 3138 embeddings of dim 49152
2025-03-13 18:41:46,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:41:46,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:46
2025-03-13 18:41:46,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:46,358 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:41:46,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:46,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:46,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:46
2025-03-13 18:41:46,358 [INFO]: 647.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:46,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:46,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:46
2025-03-13 18:41:46,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:46,358 [INFO]: 	Creating the index 03/13/2025, 18:41:46
2025-03-13 18:41:46,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:46
2025-03-13 18:41:46,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:41:46,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:46
2025-03-13 18:41:46,359 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:41:46,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.79it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.23it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s] 31%|███       | 4/13 [00:00<00:01,  7.77it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.02it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.07it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.16it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.22it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.28it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.00it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.04it/s]100%|██████████| 13/13 [00:03<00:00,  1.40it/s]100%|██████████| 13/13 [00:03<00:00,  3.36it/s]
2025-03-13 18:41:50,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:50
2025-03-13 18:42:29,963 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7259 secs
2025-03-13 18:42:29,963 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 18:42:29,963 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 18:42:49,234 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2705 secs
2025-03-13 18:42:49,236 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8765 secs
2025-03-13 18:42:49,236 [INFO]: {
2025-03-13 18:42:49,236 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:49,236 [INFO]: 	index_param: efSearch=223
2025-03-13 18:42:49,236 [INFO]: 	index_path: knn.index
2025-03-13 18:42:49,236 [INFO]: 	size in bytes: 617382130
2025-03-13 18:42:49,236 [INFO]: 	avg_search_speed_ms: 10.502938298066342
2025-03-13 18:42:49,236 [INFO]: 	99p_search_speed_ms: 14.864268582314253
2025-03-13 18:42:49,236 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:49,236 [INFO]: 	nb vectors: 3138
2025-03-13 18:42:49,236 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:49,236 [INFO]: 	compression ratio: 0.9993096236847672
2025-03-13 18:42:49,236 [INFO]: }
2025-03-13 18:42:49,236 [INFO]: 	>>> Finished "Creating the index" in 62.8781 secs
2025-03-13 18:42:49,236 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9029 secs
2025-03-13 18:42:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 14645 [episode count 11/20]
[retrieval_preprocessing] for episode 28503 [episode count 12/20], we have num_retrieval=np.int64(3238) num_query=np.int64(144)
2025-03-13 18:42:52,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:52,576 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:52
2025-03-13 18:42:52,576 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-13 18:42:52,600 [INFO]: There are 3238 embeddings of dim 49152
2025-03-13 18:42:52,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 18:42:52,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:52
2025-03-13 18:42:52,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:52,600 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:42:52,600 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:52,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:52,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:52
2025-03-13 18:42:52,600 [INFO]: 668.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:52,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:42:52,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:52
2025-03-13 18:42:52,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:52,601 [INFO]: 	Creating the index 03/13/2025, 18:42:52
2025-03-13 18:42:52,601 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:52
2025-03-13 18:42:52,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:42:52,602 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:52
2025-03-13 18:42:52,602 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:42:52,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.06it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.29it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.66it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.28it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.59it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.57it/s]100%|██████████| 13/13 [00:03<00:00,  2.41it/s]100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
2025-03-13 18:42:55,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:55
2025-03-13 18:43:27,264 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5590 secs
2025-03-13 18:43:27,265 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 18:43:27,265 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 18:43:50,406 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1414 secs
2025-03-13 18:43:50,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8072 secs
2025-03-13 18:43:50,409 [INFO]: {
2025-03-13 18:43:50,409 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:50,409 [INFO]: 	index_param: efSearch=194
2025-03-13 18:43:50,409 [INFO]: 	index_path: knn.index
2025-03-13 18:43:50,409 [INFO]: 	size in bytes: 637056790
2025-03-13 18:43:50,409 [INFO]: 	avg_search_speed_ms: 10.468974706585183
2025-03-13 18:43:50,409 [INFO]: 	99p_search_speed_ms: 20.989494444802414
2025-03-13 18:43:50,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:50,409 [INFO]: 	nb vectors: 3238
2025-03-13 18:43:50,409 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:50,409 [INFO]: 	compression ratio: 0.9993091887459515
2025-03-13 18:43:50,409 [INFO]: }
2025-03-13 18:43:50,409 [INFO]: 	>>> Finished "Creating the index" in 57.8089 secs
2025-03-13 18:43:50,409 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8338 secs
2025-03-13 18:43:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 28503 [episode count 12/20]
[retrieval_preprocessing] for episode 93521 [episode count 13/20], we have num_retrieval=np.int64(3225) num_query=np.int64(157)
2025-03-13 18:43:52,574 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:53,523 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:53
2025-03-13 18:43:53,523 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.14it/s]
2025-03-13 18:43:53,548 [INFO]: There are 3225 embeddings of dim 49152
2025-03-13 18:43:53,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:43:53,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:53,549 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:43:53,549 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:53,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:53,549 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,549 [INFO]: 665.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:53,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:43:53,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:53
2025-03-13 18:43:53,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:53,549 [INFO]: 	Creating the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:53
2025-03-13 18:43:53,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:43:53,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,551 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:43:53,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.03it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.43it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.05it/s] 31%|███       | 4/13 [00:00<00:01,  7.51it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.64it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.73it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.78it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.77it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.18it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.99it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.83it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.66it/s]100%|██████████| 13/13 [00:04<00:00,  1.21it/s]100%|██████████| 13/13 [00:04<00:00,  3.23it/s]
2025-03-13 18:43:57,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:57
2025-03-13 18:44:33,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3400 secs
2025-03-13 18:44:33,925 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 18:44:33,925 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 18:45:02,940 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0140 secs
2025-03-13 18:45:03,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1272 secs
2025-03-13 18:45:03,679 [INFO]: {
2025-03-13 18:45:03,679 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:03,679 [INFO]: 	index_param: efSearch=251
2025-03-13 18:45:03,679 [INFO]: 	index_path: knn.index
2025-03-13 18:45:03,679 [INFO]: 	size in bytes: 634498930
2025-03-13 18:45:03,679 [INFO]: 	avg_search_speed_ms: 10.956067076515966
2025-03-13 18:45:03,679 [INFO]: 	99p_search_speed_ms: 23.270095642656084
2025-03-13 18:45:03,679 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:03,679 [INFO]: 	nb vectors: 3225
2025-03-13 18:45:03,679 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:03,679 [INFO]: 	compression ratio: 0.9993094866211989
2025-03-13 18:45:03,679 [INFO]: }
2025-03-13 18:45:03,679 [INFO]: 	>>> Finished "Creating the index" in 70.1299 secs
2025-03-13 18:45:03,679 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1567 secs
2025-03-13 18:45:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 93521 [episode count 13/20]
[retrieval_preprocessing] for episode 63845 [episode count 14/20], we have num_retrieval=np.int64(3212) num_query=np.int64(170)
2025-03-13 18:45:06,336 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:06,799 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:06
2025-03-13 18:45:06,800 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.21it/s]
2025-03-13 18:45:06,826 [INFO]: There are 3212 embeddings of dim 49152
2025-03-13 18:45:06,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:45:06,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:06
2025-03-13 18:45:06,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:06,826 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:45:06,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:06,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:45:06,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:06
2025-03-13 18:45:06,826 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:06,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:45:06,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:06
2025-03-13 18:45:06,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:06,826 [INFO]: 	Creating the index 03/13/2025, 18:45:06
2025-03-13 18:45:06,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:06
2025-03-13 18:45:06,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:45:06,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:06
2025-03-13 18:45:06,828 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:45:06,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.81it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.58it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.83it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.54it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.98it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.17it/s]100%|██████████| 13/13 [00:02<00:00,  2.57it/s]100%|██████████| 13/13 [00:02<00:00,  4.36it/s]
2025-03-13 18:45:09,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:09
2025-03-13 18:45:40,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9915 secs
2025-03-13 18:45:40,805 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:45:40,805 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 18:46:02,067 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2617 secs
2025-03-13 18:46:02,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2412 secs
2025-03-13 18:46:02,069 [INFO]: {
2025-03-13 18:46:02,069 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:02,069 [INFO]: 	index_param: efSearch=227
2025-03-13 18:46:02,069 [INFO]: 	index_path: knn.index
2025-03-13 18:46:02,069 [INFO]: 	size in bytes: 631941070
2025-03-13 18:46:02,069 [INFO]: 	avg_search_speed_ms: 10.720609839744107
2025-03-13 18:46:02,069 [INFO]: 	99p_search_speed_ms: 15.170646328479052
2025-03-13 18:46:02,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:02,069 [INFO]: 	nb vectors: 3212
2025-03-13 18:46:02,069 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:02,069 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-13 18:46:02,069 [INFO]: }
2025-03-13 18:46:02,069 [INFO]: 	>>> Finished "Creating the index" in 55.2429 secs
2025-03-13 18:46:02,069 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2699 secs
2025-03-13 18:46:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 63845 [episode count 14/20]
[retrieval_preprocessing] for episode 54118 [episode count 15/20], we have num_retrieval=np.int64(3192) num_query=np.int64(190)
2025-03-13 18:46:05,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:06,222 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:06
2025-03-13 18:46:06,222 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.52it/s]
2025-03-13 18:46:06,246 [INFO]: There are 3192 embeddings of dim 49152
2025-03-13 18:46:06,246 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 18:46:06,246 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:06
2025-03-13 18:46:06,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:06,246 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:46:06,246 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:06,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:06,246 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:06
2025-03-13 18:46:06,246 [INFO]: 658.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:06,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:06,246 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:06
2025-03-13 18:46:06,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:06,247 [INFO]: 	Creating the index 03/13/2025, 18:46:06
2025-03-13 18:46:06,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:06
2025-03-13 18:46:06,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:46:06,248 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:06
2025-03-13 18:46:06,248 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:46:06,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.54it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.01it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.53it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.87it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.11it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.38it/s]100%|██████████| 13/13 [00:03<00:00,  2.19it/s]100%|██████████| 13/13 [00:03<00:00,  3.80it/s]
2025-03-13 18:46:09,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:09
2025-03-13 18:46:42,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0206 secs
2025-03-13 18:46:42,692 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 18:46:42,693 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:47:07,778 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0854 secs
2025-03-13 18:47:07,781 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5330 secs
2025-03-13 18:47:07,781 [INFO]: {
2025-03-13 18:47:07,781 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:07,781 [INFO]: 	index_param: efSearch=269
2025-03-13 18:47:07,781 [INFO]: 	index_path: knn.index
2025-03-13 18:47:07,781 [INFO]: 	size in bytes: 628006210
2025-03-13 18:47:07,781 [INFO]: 	avg_search_speed_ms: 10.231887825412967
2025-03-13 18:47:07,781 [INFO]: 	99p_search_speed_ms: 17.723558098077774
2025-03-13 18:47:07,781 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:07,781 [INFO]: 	nb vectors: 3192
2025-03-13 18:47:07,781 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:07,781 [INFO]: 	compression ratio: 0.9993097616025166
2025-03-13 18:47:07,781 [INFO]: }
2025-03-13 18:47:07,781 [INFO]: 	>>> Finished "Creating the index" in 61.5345 secs
2025-03-13 18:47:07,781 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5592 secs
2025-03-13 18:47:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 54118 [episode count 15/20]
[retrieval_preprocessing] for episode 55659 [episode count 16/20], we have num_retrieval=np.int64(3231) num_query=np.int64(151)
2025-03-13 18:47:11,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:11,573 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:11
2025-03-13 18:47:11,573 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1735.33it/s]
2025-03-13 18:47:11,597 [INFO]: There are 3231 embeddings of dim 49152
2025-03-13 18:47:11,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 18:47:11,597 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:11
2025-03-13 18:47:11,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:11,597 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:47:11,597 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:11,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:11,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:11
2025-03-13 18:47:11,597 [INFO]: 666.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:11,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:47:11,597 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:11
2025-03-13 18:47:11,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:11,597 [INFO]: 	Creating the index 03/13/2025, 18:47:11
2025-03-13 18:47:11,597 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:11
2025-03-13 18:47:11,598 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:47:11,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:11
2025-03-13 18:47:11,598 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:47:11,598 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.07it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.63it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.64it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.91it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.52it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.62it/s]100%|██████████| 13/13 [00:03<00:00,  1.95it/s]100%|██████████| 13/13 [00:03<00:00,  3.48it/s]
2025-03-13 18:47:15,343 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:15
2025-03-13 18:47:48,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8192 secs
2025-03-13 18:47:48,163 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 18:47:48,164 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
2025-03-13 18:48:05,752 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5880 secs
2025-03-13 18:48:05,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1563 secs
2025-03-13 18:48:05,755 [INFO]: {
2025-03-13 18:48:05,755 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:05,755 [INFO]: 	index_param: efSearch=200
2025-03-13 18:48:05,755 [INFO]: 	index_path: knn.index
2025-03-13 18:48:05,755 [INFO]: 	size in bytes: 635679490
2025-03-13 18:48:05,755 [INFO]: 	avg_search_speed_ms: 10.17692695454233
2025-03-13 18:48:05,755 [INFO]: 	99p_search_speed_ms: 18.501653857529078
2025-03-13 18:48:05,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:05,755 [INFO]: 	nb vectors: 3231
2025-03-13 18:48:05,755 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:05,755 [INFO]: 	compression ratio: 0.9993093343313625
2025-03-13 18:48:05,755 [INFO]: }
2025-03-13 18:48:05,755 [INFO]: 	>>> Finished "Creating the index" in 54.1577 secs
2025-03-13 18:48:05,755 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1821 secs
2025-03-13 18:48:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 55659 [episode count 16/20]
[retrieval_preprocessing] for episode 80236 [episode count 17/20], we have num_retrieval=np.int64(3232) num_query=np.int64(150)
2025-03-13 18:48:08,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:09,226 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:09
2025-03-13 18:48:09,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.83it/s]
2025-03-13 18:48:09,252 [INFO]: There are 3232 embeddings of dim 49152
2025-03-13 18:48:09,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:48:09,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:09
2025-03-13 18:48:09,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:09,252 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:48:09,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:09,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:48:09,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:09
2025-03-13 18:48:09,253 [INFO]: 667.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:09,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:48:09,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:09
2025-03-13 18:48:09,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:09,253 [INFO]: 	Creating the index 03/13/2025, 18:48:09
2025-03-13 18:48:09,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:09
2025-03-13 18:48:09,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:48:09,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:09
2025-03-13 18:48:09,254 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:48:09,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.57it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.14it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.39it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.00it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.33it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.55it/s]100%|██████████| 13/13 [00:03<00:00,  2.06it/s]100%|██████████| 13/13 [00:03<00:00,  3.62it/s]
2025-03-13 18:48:12,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:12
2025-03-13 18:48:51,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7423 secs
2025-03-13 18:48:51,596 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:48:51,596 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 18:49:12,425 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8283 secs
2025-03-13 18:49:12,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1732 secs
2025-03-13 18:49:12,428 [INFO]: {
2025-03-13 18:49:12,428 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:12,428 [INFO]: 	index_param: efSearch=236
2025-03-13 18:49:12,428 [INFO]: 	index_path: knn.index
2025-03-13 18:49:12,428 [INFO]: 	size in bytes: 635876230
2025-03-13 18:49:12,428 [INFO]: 	avg_search_speed_ms: 9.897097983019481
2025-03-13 18:49:12,428 [INFO]: 	99p_search_speed_ms: 18.095058021135614
2025-03-13 18:49:12,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:12,428 [INFO]: 	nb vectors: 3232
2025-03-13 18:49:12,428 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:12,428 [INFO]: 	compression ratio: 0.9993093404356379
2025-03-13 18:49:12,428 [INFO]: }
2025-03-13 18:49:12,428 [INFO]: 	>>> Finished "Creating the index" in 63.1749 secs
2025-03-13 18:49:12,428 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2016 secs
2025-03-13 18:49:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 80236 [episode count 17/20]
[retrieval_preprocessing] for episode 55427 [episode count 18/20], we have num_retrieval=np.int64(3230) num_query=np.int64(152)
2025-03-13 18:49:14,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:15,306 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:15
2025-03-13 18:49:15,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.92it/s]
2025-03-13 18:49:15,333 [INFO]: There are 3230 embeddings of dim 49152
2025-03-13 18:49:15,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:49:15,334 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:15
2025-03-13 18:49:15,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:15,334 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:49:15,334 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:15,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:49:15,334 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:15
2025-03-13 18:49:15,335 [INFO]: 666.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:15,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:49:15,335 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:15
2025-03-13 18:49:15,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:15,336 [INFO]: 	Creating the index 03/13/2025, 18:49:15
2025-03-13 18:49:15,336 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:15
2025-03-13 18:49:15,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:49:15,339 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:15
2025-03-13 18:49:15,340 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:49:15,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.71it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.11it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.15it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.62it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.96it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.41it/s]100%|██████████| 13/13 [00:03<00:00,  2.42it/s]100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
2025-03-13 18:49:18,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:18
2025-03-13 18:49:57,713 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2555 secs
2025-03-13 18:49:57,714 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:49:57,714 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 18:50:18,250 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5359 secs
2025-03-13 18:50:19,113 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7735 secs
2025-03-13 18:50:19,113 [INFO]: {
2025-03-13 18:50:19,114 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:19,114 [INFO]: 	index_param: efSearch=222
2025-03-13 18:50:19,114 [INFO]: 	index_path: knn.index
2025-03-13 18:50:19,114 [INFO]: 	size in bytes: 635482750
2025-03-13 18:50:19,114 [INFO]: 	avg_search_speed_ms: 10.364304004246707
2025-03-13 18:50:19,114 [INFO]: 	99p_search_speed_ms: 21.64953802712263
2025-03-13 18:50:19,114 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:19,114 [INFO]: 	nb vectors: 3230
2025-03-13 18:50:19,114 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:19,114 [INFO]: 	compression ratio: 0.9993093282233074
2025-03-13 18:50:19,114 [INFO]: }
2025-03-13 18:50:19,114 [INFO]: 	>>> Finished "Creating the index" in 63.7785 secs
2025-03-13 18:50:19,114 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8083 secs
2025-03-13 18:50:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 55427 [episode count 18/20]
[retrieval_preprocessing] for episode 81361 [episode count 19/20], we have num_retrieval=np.int64(3213) num_query=np.int64(169)
2025-03-13 18:50:21,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:22,208 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:22
2025-03-13 18:50:22,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.03it/s]
2025-03-13 18:50:22,245 [INFO]: There are 3213 embeddings of dim 49152
2025-03-13 18:50:22,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 18:50:22,245 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:22
2025-03-13 18:50:22,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:22,246 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 18:50:22,246 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:22,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:50:22,246 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:22
2025-03-13 18:50:22,246 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:22,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:50:22,247 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:22
2025-03-13 18:50:22,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:22,247 [INFO]: 	Creating the index 03/13/2025, 18:50:22
2025-03-13 18:50:22,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:22
2025-03-13 18:50:22,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 18:50:22,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:22
2025-03-13 18:50:22,250 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:50:22,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.57it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.40it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.34it/s] 31%|███       | 4/13 [00:00<00:01,  8.82it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.50it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.45it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.16it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.29it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.42it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.16it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.98it/s]100%|██████████| 13/13 [00:03<00:00,  1.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.56it/s]
2025-03-13 18:50:26,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:26
2025-03-13 18:51:04,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3944 secs
2025-03-13 18:51:04,835 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 18:51:04,835 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.05it/s]
2025-03-13 18:51:27,398 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5627 secs
2025-03-13 18:51:27,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1502 secs
2025-03-13 18:51:27,400 [INFO]: {
2025-03-13 18:51:27,400 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:27,400 [INFO]: 	index_param: efSearch=242
2025-03-13 18:51:27,400 [INFO]: 	index_path: knn.index
2025-03-13 18:51:27,400 [INFO]: 	size in bytes: 632137810
2025-03-13 18:51:27,400 [INFO]: 	avg_search_speed_ms: 9.559923173266732
2025-03-13 18:51:27,400 [INFO]: 	99p_search_speed_ms: 13.857864041347046
2025-03-13 18:51:27,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:27,400 [INFO]: 	nb vectors: 3213
2025-03-13 18:51:27,400 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:27,400 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-13 18:51:27,400 [INFO]: }
2025-03-13 18:51:27,400 [INFO]: 	>>> Finished "Creating the index" in 65.1533 secs
2025-03-13 18:51:27,400 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1919 secs
2025-03-13 18:51:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 81361 [episode count 19/20]
2025-03-13 18:51:29: [retrieval_preprocessing] finished for 4465064685_put_marker_in_silver_pot [chosen_id count 7/196]
2025-03-13 18:51:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 446878712_put_marker_in_cup [chosen_id count 8/196]
2025-03-13 18:51:32: [retrieval_preprocessing] we have num_total=4685 embedding_dim=49152
[retrieval_preprocessing] for episode 45604 [episode count 0/20], we have num_retrieval=np.int64(4344) num_query=np.int64(341)
2025-03-13 18:51:33,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:34,560 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:34
2025-03-13 18:51:34,560 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1980.31it/s]
2025-03-13 18:51:34,996 [INFO]: There are 4344 embeddings of dim 49152
2025-03-13 18:51:34,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4363 secs
2025-03-13 18:51:34,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:34
2025-03-13 18:51:34,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:34,997 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 18:51:34,997 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:34,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:51:34,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:34
2025-03-13 18:51:34,997 [INFO]: 896.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:34,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:51:34,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:34
2025-03-13 18:51:34,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:34,998 [INFO]: 	Creating the index 03/13/2025, 18:51:34
2025-03-13 18:51:34,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:34
2025-03-13 18:51:35,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 18:51:35,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:35
2025-03-13 18:51:35,000 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:51:35,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.02it/s] 11%|█         | 2/18 [00:00<00:02,  6.62it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.39it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.72it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.51it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.95it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.05it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.16it/s] 50%|█████     | 9/18 [00:01<00:01,  8.39it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.75it/s] 61%|██████    | 11/18 [00:01<00:00,  8.91it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.89it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.93it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.14it/s] 89%|████████▉ | 16/18 [00:01<00:00, 10.66it/s]100%|██████████| 18/18 [00:05<00:00,  1.39it/s]100%|██████████| 18/18 [00:05<00:00,  3.47it/s]
2025-03-13 18:51:40,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:40
2025-03-13 18:52:18,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1603 secs
2025-03-13 18:52:18,356 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 18:52:18,356 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 18:52:47,646 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2907 secs
2025-03-13 18:52:47,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6501 secs
2025-03-13 18:52:47,651 [INFO]: {
2025-03-13 18:52:47,651 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:47,651 [INFO]: 	index_param: efSearch=193
2025-03-13 18:52:47,651 [INFO]: 	index_path: knn.index
2025-03-13 18:52:47,651 [INFO]: 	size in bytes: 854656090
2025-03-13 18:52:47,651 [INFO]: 	avg_search_speed_ms: 9.548194587912052
2025-03-13 18:52:47,651 [INFO]: 	99p_search_speed_ms: 14.56241718493402
2025-03-13 18:52:47,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:47,651 [INFO]: 	nb vectors: 4344
2025-03-13 18:52:47,651 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:47,651 [INFO]: 	compression ratio: 0.9993085663263688
2025-03-13 18:52:47,651 [INFO]: }
2025-03-13 18:52:47,651 [INFO]: 	>>> Finished "Creating the index" in 72.6532 secs
2025-03-13 18:52:47,651 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0908 secs
2025-03-13 18:52:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 45604 [episode count 0/20]
[retrieval_preprocessing] for episode 9769 [episode count 1/20], we have num_retrieval=np.int64(4455) num_query=np.int64(230)
2025-03-13 18:52:51,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:52,721 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:52
2025-03-13 18:52:52,721 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 18:52:52,748 [INFO]: There are 4455 embeddings of dim 49152
2025-03-13 18:52:52,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:52:52,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:52,749 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 18:52:52,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:52,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:52,749 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,749 [INFO]: 919.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:52,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:52:52,749 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:52
2025-03-13 18:52:52,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:52,749 [INFO]: 	Creating the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:52
2025-03-13 18:52:52,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:52:52,750 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:52
2025-03-13 18:52:52,751 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:52:52,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.67it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.45it/s] 28%|██▊       | 5/18 [00:00<00:01, 12.50it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.43it/s] 50%|█████     | 9/18 [00:00<00:00, 14.10it/s] 61%|██████    | 11/18 [00:00<00:00, 14.49it/s] 72%|███████▏  | 13/18 [00:00<00:00, 14.75it/s] 83%|████████▎ | 15/18 [00:01<00:00, 15.14it/s] 94%|█████████▍| 17/18 [00:01<00:00, 14.15it/s]100%|██████████| 18/18 [00:05<00:00,  3.52it/s]
2025-03-13 18:52:57,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:57
2025-03-13 18:53:50,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1416 secs
2025-03-13 18:53:50,010 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:53:50,010 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 18:54:17,446 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4357 secs
2025-03-13 18:54:17,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.6990 secs
2025-03-13 18:54:17,450 [INFO]: {
2025-03-13 18:54:17,450 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:17,450 [INFO]: 	index_param: efSearch=205
2025-03-13 18:54:17,450 [INFO]: 	index_path: knn.index
2025-03-13 18:54:17,450 [INFO]: 	size in bytes: 876494650
2025-03-13 18:54:17,450 [INFO]: 	avg_search_speed_ms: 9.257156025031927
2025-03-13 18:54:17,450 [INFO]: 	99p_search_speed_ms: 17.24650969030337
2025-03-13 18:54:17,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:17,450 [INFO]: 	nb vectors: 4455
2025-03-13 18:54:17,450 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:17,450 [INFO]: 	compression ratio: 0.9993085981756991
2025-03-13 18:54:17,450 [INFO]: }
2025-03-13 18:54:17,450 [INFO]: 	>>> Finished "Creating the index" in 84.7006 secs
2025-03-13 18:54:17,450 [INFO]: >>> Finished "Launching the whole pipeline" in 84.7292 secs
2025-03-13 18:54:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 9769 [episode count 1/20]
[retrieval_preprocessing] for episode 67631 [episode count 2/20], we have num_retrieval=np.int64(4513) num_query=np.int64(172)
2025-03-13 18:54:21,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:22,111 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:22
2025-03-13 18:54:22,111 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2085.68it/s]
2025-03-13 18:54:22,137 [INFO]: There are 4513 embeddings of dim 49152
2025-03-13 18:54:22,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:54:22,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:22
2025-03-13 18:54:22,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:22,138 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:54:22,139 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:22,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:54:22,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:22
2025-03-13 18:54:22,139 [INFO]: 931.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:22,139 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:54:22,140 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:22
2025-03-13 18:54:22,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:22,140 [INFO]: 	Creating the index 03/13/2025, 18:54:22
2025-03-13 18:54:22,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:22
2025-03-13 18:54:22,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:54:22,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:22
2025-03-13 18:54:22,144 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:54:22,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.81it/s] 11%|█         | 2/18 [00:00<00:02,  6.75it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.75it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.30it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.80it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.96it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.07it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.09it/s] 50%|█████     | 9/18 [00:01<00:00,  9.23it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.30it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.19it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.87it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.67it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.53it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.47it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.34it/s]100%|██████████| 18/18 [00:05<00:00,  1.01s/it]100%|██████████| 18/18 [00:05<00:00,  3.48it/s]
2025-03-13 18:54:27,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:27
2025-03-13 18:55:10,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0928 secs
2025-03-13 18:55:10,423 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 18:55:10,424 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 18:55:31,802 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3780 secs
2025-03-13 18:55:31,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6617 secs
2025-03-13 18:55:31,805 [INFO]: {
2025-03-13 18:55:31,805 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:31,805 [INFO]: 	index_param: efSearch=234
2025-03-13 18:55:31,805 [INFO]: 	index_path: knn.index
2025-03-13 18:55:31,805 [INFO]: 	size in bytes: 887905690
2025-03-13 18:55:31,806 [INFO]: 	avg_search_speed_ms: 11.475609906282957
2025-03-13 18:55:31,806 [INFO]: 	99p_search_speed_ms: 22.227975283749398
2025-03-13 18:55:31,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:31,806 [INFO]: 	nb vectors: 4513
2025-03-13 18:55:31,806 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:31,806 [INFO]: 	compression ratio: 0.9993087261328396
2025-03-13 18:55:31,806 [INFO]: }
2025-03-13 18:55:31,806 [INFO]: 	>>> Finished "Creating the index" in 69.6657 secs
2025-03-13 18:55:31,806 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6947 secs
2025-03-13 18:55:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 67631 [episode count 2/20]
[retrieval_preprocessing] for episode 23612 [episode count 3/20], we have num_retrieval=np.int64(4308) num_query=np.int64(377)
2025-03-13 18:55:35,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:36,734 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:36
2025-03-13 18:55:36,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1610.10it/s]
2025-03-13 18:55:36,759 [INFO]: There are 4308 embeddings of dim 49152
2025-03-13 18:55:36,759 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:55:36,759 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:36
2025-03-13 18:55:36,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:36,759 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 18:55:36,759 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:36,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:36,759 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:36
2025-03-13 18:55:36,759 [INFO]: 889.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:36,759 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:55:36,760 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:36
2025-03-13 18:55:36,760 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:36,760 [INFO]: 	Creating the index 03/13/2025, 18:55:36
2025-03-13 18:55:36,760 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:36
2025-03-13 18:55:36,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:55:36,761 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:36
2025-03-13 18:55:36,761 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:55:36,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.35it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.10it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.76it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.08it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.29it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.44it/s] 41%|████      | 7/17 [00:00<00:01,  8.64it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.65it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.63it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.70it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.71it/s] 71%|███████   | 12/17 [00:01<00:00,  8.82it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.82it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.80it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.79it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.79it/s]100%|██████████| 17/17 [00:04<00:00,  1.00s/it]100%|██████████| 17/17 [00:04<00:00,  3.42it/s]
2025-03-13 18:55:41,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:41
2025-03-13 18:56:27,555 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8268 secs
2025-03-13 18:56:27,556 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 18:56:27,556 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:56:50,998 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4423 secs
2025-03-13 18:56:51,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2401 secs
2025-03-13 18:56:51,001 [INFO]: {
2025-03-13 18:56:51,001 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:51,001 [INFO]: 	index_param: efSearch=244
2025-03-13 18:56:51,001 [INFO]: 	index_path: knn.index
2025-03-13 18:56:51,001 [INFO]: 	size in bytes: 847573270
2025-03-13 18:56:51,001 [INFO]: 	avg_search_speed_ms: 9.666251227403608
2025-03-13 18:56:51,001 [INFO]: 	99p_search_speed_ms: 13.509570080786938
2025-03-13 18:56:51,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:51,001 [INFO]: 	nb vectors: 4308
2025-03-13 18:56:51,001 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:51,001 [INFO]: 	compression ratio: 0.9993086072664845
2025-03-13 18:56:51,001 [INFO]: }
2025-03-13 18:56:51,001 [INFO]: 	>>> Finished "Creating the index" in 74.2417 secs
2025-03-13 18:56:51,001 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2675 secs
2025-03-13 18:56:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 23612 [episode count 3/20]
[retrieval_preprocessing] for episode 9800 [episode count 4/20], we have num_retrieval=np.int64(4481) num_query=np.int64(204)
2025-03-13 18:56:57,689 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:58,450 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:58
2025-03-13 18:56:58,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.82it/s]
2025-03-13 18:56:58,475 [INFO]: There are 4481 embeddings of dim 49152
2025-03-13 18:56:58,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:56:58,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:58
2025-03-13 18:56:58,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:58,475 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:56:58,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:58,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:58,475 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:58
2025-03-13 18:56:58,475 [INFO]: 924.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:58,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:56:58,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:58
2025-03-13 18:56:58,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:58,476 [INFO]: 	Creating the index 03/13/2025, 18:56:58
2025-03-13 18:56:58,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:58
2025-03-13 18:56:58,477 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:56:58,477 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:58
2025-03-13 18:56:58,477 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:56:58,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.45it/s] 11%|█         | 2/18 [00:00<00:02,  6.91it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.61it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.98it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.35it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.55it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.70it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.72it/s] 50%|█████     | 9/18 [00:01<00:01,  8.81it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.82it/s] 61%|██████    | 11/18 [00:01<00:00,  8.88it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.10it/s] 78%|███████▊  | 14/18 [00:01<00:00, 10.44it/s] 89%|████████▉ | 16/18 [00:01<00:00, 11.16it/s]100%|██████████| 18/18 [00:04<00:00,  1.60it/s]100%|██████████| 18/18 [00:04<00:00,  3.70it/s]
2025-03-13 18:57:03,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:03
2025-03-13 18:57:54,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6793 secs
2025-03-13 18:57:54,026 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:57:54,026 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 18:58:18,277 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2504 secs
2025-03-13 18:58:18,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8029 secs
2025-03-13 18:58:18,280 [INFO]: {
2025-03-13 18:58:18,280 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:18,280 [INFO]: 	index_param: efSearch=205
2025-03-13 18:58:18,280 [INFO]: 	index_path: knn.index
2025-03-13 18:58:18,280 [INFO]: 	size in bytes: 881609950
2025-03-13 18:58:18,280 [INFO]: 	avg_search_speed_ms: 9.596920715003218
2025-03-13 18:58:18,280 [INFO]: 	99p_search_speed_ms: 16.768227273132645
2025-03-13 18:58:18,280 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:18,280 [INFO]: 	nb vectors: 4481
2025-03-13 18:58:18,280 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:18,280 [INFO]: 	compression ratio: 0.9993086489098723
2025-03-13 18:58:18,280 [INFO]: }
2025-03-13 18:58:18,280 [INFO]: 	>>> Finished "Creating the index" in 79.8045 secs
2025-03-13 18:58:18,280 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8305 secs
2025-03-13 18:58:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 9800 [episode count 4/20]
[retrieval_preprocessing] for episode 73319 [episode count 5/20], we have num_retrieval=np.int64(4491) num_query=np.int64(194)
2025-03-13 18:58:21,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:22,245 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:22
2025-03-13 18:58:22,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.08it/s]
2025-03-13 18:58:22,274 [INFO]: There are 4491 embeddings of dim 49152
2025-03-13 18:58:22,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:58:22,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:22
2025-03-13 18:58:22,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:22,275 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:58:22,275 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:22,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:58:22,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:22
2025-03-13 18:58:22,275 [INFO]: 926.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:22,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:58:22,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:22
2025-03-13 18:58:22,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:22,276 [INFO]: 	Creating the index 03/13/2025, 18:58:22
2025-03-13 18:58:22,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:22
2025-03-13 18:58:22,279 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:58:22,279 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:22
2025-03-13 18:58:22,279 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:58:22,279 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.92it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.39it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.63it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.13it/s] 50%|█████     | 9/18 [00:00<00:00, 11.38it/s] 61%|██████    | 11/18 [00:01<00:00, 11.62it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.70it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.00it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.10it/s]100%|██████████| 18/18 [00:04<00:00,  3.97it/s]
2025-03-13 18:58:26,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:26
2025-03-13 18:59:12,757 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9283 secs
2025-03-13 18:59:12,757 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:59:12,757 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 18:59:32,182 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4245 secs
2025-03-13 18:59:32,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9058 secs
2025-03-13 18:59:32,185 [INFO]: {
2025-03-13 18:59:32,185 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:32,185 [INFO]: 	index_param: efSearch=220
2025-03-13 18:59:32,185 [INFO]: 	index_path: knn.index
2025-03-13 18:59:32,185 [INFO]: 	size in bytes: 883577350
2025-03-13 18:59:32,185 [INFO]: 	avg_search_speed_ms: 8.807193190228636
2025-03-13 18:59:32,185 [INFO]: 	99p_search_speed_ms: 12.206399035640061
2025-03-13 18:59:32,185 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:32,185 [INFO]: 	nb vectors: 4491
2025-03-13 18:59:32,185 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:32,185 [INFO]: 	compression ratio: 0.9993086943661469
2025-03-13 18:59:32,185 [INFO]: }
2025-03-13 18:59:32,185 [INFO]: 	>>> Finished "Creating the index" in 69.9093 secs
2025-03-13 18:59:32,185 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9401 secs
2025-03-13 18:59:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 73319 [episode count 5/20]
[retrieval_preprocessing] for episode 43688 [episode count 6/20], we have num_retrieval=np.int64(4360) num_query=np.int64(325)
2025-03-13 18:59:35,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:35,619 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:35
2025-03-13 18:59:35,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-13 18:59:35,645 [INFO]: There are 4360 embeddings of dim 49152
2025-03-13 18:59:35,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:59:35,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:35
2025-03-13 18:59:35,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:35,646 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 18:59:35,646 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:35,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:59:35,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:35
2025-03-13 18:59:35,649 [INFO]: 899.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:35,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0032 secs
2025-03-13 18:59:35,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:35
2025-03-13 18:59:35,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:35,650 [INFO]: 	Creating the index 03/13/2025, 18:59:35
2025-03-13 18:59:35,651 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:35
2025-03-13 18:59:35,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:59:35,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:35
2025-03-13 18:59:35,654 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:59:35,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.30it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.81it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.61it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.08it/s] 50%|█████     | 9/18 [00:00<00:00, 11.41it/s] 61%|██████    | 11/18 [00:01<00:00, 11.50it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.06it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.34it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.45it/s]100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
2025-03-13 18:59:39,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:39
2025-03-13 19:00:24,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7900 secs
2025-03-13 19:00:24,588 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 19:00:24,588 [INFO]: 	Compute fast metrics 03/13/2025, 19:00:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 19:00:45,158 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5702 secs
2025-03-13 19:00:45,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5080 secs
2025-03-13 19:00:45,162 [INFO]: {
2025-03-13 19:00:45,162 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:45,162 [INFO]: 	index_param: efSearch=230
2025-03-13 19:00:45,162 [INFO]: 	index_path: knn.index
2025-03-13 19:00:45,162 [INFO]: 	size in bytes: 857803990
2025-03-13 19:00:45,162 [INFO]: 	avg_search_speed_ms: 9.179762268269604
2025-03-13 19:00:45,162 [INFO]: 	99p_search_speed_ms: 13.420613296329975
2025-03-13 19:00:45,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:45,162 [INFO]: 	nb vectors: 4360
2025-03-13 19:00:45,162 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:45,162 [INFO]: 	compression ratio: 0.9993085716470029
2025-03-13 19:00:45,162 [INFO]: }
2025-03-13 19:00:45,162 [INFO]: 	>>> Finished "Creating the index" in 69.5118 secs
2025-03-13 19:00:45,162 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5426 secs
2025-03-13 19:00:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 43688 [episode count 6/20]
[retrieval_preprocessing] for episode 38076 [episode count 7/20], we have num_retrieval=np.int64(4501) num_query=np.int64(184)
2025-03-13 19:00:50,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:51,413 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:51
2025-03-13 19:00:51,413 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-13 19:00:51,438 [INFO]: There are 4501 embeddings of dim 49152
2025-03-13 19:00:51,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 19:00:51,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:51
2025-03-13 19:00:51,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:51,438 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:00:51,439 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:51,439 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:51,439 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:51
2025-03-13 19:00:51,439 [INFO]: 928.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:51,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:51,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:51
2025-03-13 19:00:51,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:51,439 [INFO]: 	Creating the index 03/13/2025, 19:00:51
2025-03-13 19:00:51,439 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:51
2025-03-13 19:00:51,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:00:51,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:51
2025-03-13 19:00:51,440 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:00:51,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.74it/s] 11%|█         | 2/18 [00:00<00:02,  6.42it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.15it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.56it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.78it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.23it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.35it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.52it/s] 50%|█████     | 9/18 [00:01<00:01,  8.53it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.65it/s] 61%|██████    | 11/18 [00:01<00:00,  8.92it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.11it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.12it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.26it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.40it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.94it/s]100%|██████████| 18/18 [00:05<00:00,  1.06it/s]100%|██████████| 18/18 [00:05<00:00,  3.29it/s]
2025-03-13 19:00:56,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:56
2025-03-13 19:01:46,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9643 secs
2025-03-13 19:01:46,882 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 19:01:46,882 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 19:02:17,406 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5244 secs
2025-03-13 19:02:17,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.9692 secs
2025-03-13 19:02:17,409 [INFO]: {
2025-03-13 19:02:17,409 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:17,409 [INFO]: 	index_param: efSearch=229
2025-03-13 19:02:17,409 [INFO]: 	index_path: knn.index
2025-03-13 19:02:17,409 [INFO]: 	size in bytes: 885544810
2025-03-13 19:02:17,409 [INFO]: 	avg_search_speed_ms: 8.430972267578326
2025-03-13 19:02:17,409 [INFO]: 	99p_search_speed_ms: 12.776787346228966
2025-03-13 19:02:17,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:17,409 [INFO]: 	nb vectors: 4501
2025-03-13 19:02:17,410 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:17,410 [INFO]: 	compression ratio: 0.999308671912379
2025-03-13 19:02:17,410 [INFO]: }
2025-03-13 19:02:17,410 [INFO]: 	>>> Finished "Creating the index" in 85.9706 secs
2025-03-13 19:02:17,410 [INFO]: >>> Finished "Launching the whole pipeline" in 85.9967 secs
2025-03-13 19:02:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 38076 [episode count 7/20]
[retrieval_preprocessing] for episode 2315 [episode count 8/20], we have num_retrieval=np.int64(4453) num_query=np.int64(232)
2025-03-13 19:02:20,387 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:20,972 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:20
2025-03-13 19:02:20,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 995.33it/s]
2025-03-13 19:02:20,998 [INFO]: There are 4453 embeddings of dim 49152
2025-03-13 19:02:20,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 19:02:20,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:20
2025-03-13 19:02:20,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:20,998 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:02:20,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:20,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:02:20,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:20
2025-03-13 19:02:20,998 [INFO]: 919.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:20,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:02:20,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:20
2025-03-13 19:02:20,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:20,998 [INFO]: 	Creating the index 03/13/2025, 19:02:20
2025-03-13 19:02:20,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:20
2025-03-13 19:02:20,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:02:20,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:20
2025-03-13 19:02:21,000 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:02:21,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.89it/s] 11%|█         | 2/18 [00:00<00:02,  6.59it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.79it/s] 22%|██▏       | 4/18 [00:00<00:02,  6.17it/s] 28%|██▊       | 5/18 [00:00<00:01,  6.67it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.38it/s] 39%|███▉      | 7/18 [00:00<00:01,  7.81it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.05it/s] 50%|█████     | 9/18 [00:01<00:01,  8.20it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.35it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.92it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.87it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.81it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.74it/s]100%|██████████| 18/18 [00:05<00:00,  1.46it/s]100%|██████████| 18/18 [00:05<00:00,  3.44it/s]
2025-03-13 19:02:26,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:26
2025-03-13 19:03:16,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1869 secs
2025-03-13 19:03:16,658 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 19:03:16,658 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 19:03:48,421 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7629 secs
2025-03-13 19:03:48,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4252 secs
2025-03-13 19:03:48,425 [INFO]: {
2025-03-13 19:03:48,425 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:48,425 [INFO]: 	index_param: efSearch=212
2025-03-13 19:03:48,425 [INFO]: 	index_path: knn.index
2025-03-13 19:03:48,425 [INFO]: 	size in bytes: 876101170
2025-03-13 19:03:48,425 [INFO]: 	avg_search_speed_ms: 8.07589009781827
2025-03-13 19:03:48,425 [INFO]: 	99p_search_speed_ms: 11.909820567816494
2025-03-13 19:03:48,425 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:48,425 [INFO]: 	nb vectors: 4453
2025-03-13 19:03:48,425 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:48,425 [INFO]: 	compression ratio: 0.9993085889840781
2025-03-13 19:03:48,425 [INFO]: }
2025-03-13 19:03:48,425 [INFO]: 	>>> Finished "Creating the index" in 87.4266 secs
2025-03-13 19:03:48,425 [INFO]: >>> Finished "Launching the whole pipeline" in 87.4526 secs
2025-03-13 19:03:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 2315 [episode count 8/20]
[retrieval_preprocessing] for episode 37192 [episode count 9/20], we have num_retrieval=np.int64(4438) num_query=np.int64(247)
2025-03-13 19:03:51,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:52,290 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:52
2025-03-13 19:03:52,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-13 19:03:52,314 [INFO]: There are 4438 embeddings of dim 49152
2025-03-13 19:03:52,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 19:03:52,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:52
2025-03-13 19:03:52,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:52,315 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:03:52,315 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:03:52,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:03:52,315 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:52
2025-03-13 19:03:52,315 [INFO]: 915.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:52,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:03:52,315 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:52
2025-03-13 19:03:52,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:52,315 [INFO]: 	Creating the index 03/13/2025, 19:03:52
2025-03-13 19:03:52,315 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:03:52
2025-03-13 19:03:52,316 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:03:52,316 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:52
2025-03-13 19:03:52,317 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:03:52,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.33it/s] 11%|█         | 2/18 [00:00<00:02,  7.02it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.72it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.16it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.49it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.49it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.46it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.41it/s] 50%|█████     | 9/18 [00:01<00:01,  8.38it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.43it/s] 61%|██████    | 11/18 [00:01<00:00,  8.56it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.56it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.58it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.62it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.70it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.81it/s]100%|██████████| 18/18 [00:05<00:00,  1.26it/s]100%|██████████| 18/18 [00:05<00:00,  3.54it/s]
2025-03-13 19:03:57,402 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:57
2025-03-13 19:04:34,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9257 secs
2025-03-13 19:04:34,328 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 19:04:34,328 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 19:04:59,953 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6245 secs
2025-03-13 19:04:59,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6394 secs
2025-03-13 19:04:59,956 [INFO]: {
2025-03-13 19:04:59,956 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:59,956 [INFO]: 	index_param: efSearch=245
2025-03-13 19:04:59,956 [INFO]: 	index_path: knn.index
2025-03-13 19:04:59,956 [INFO]: 	size in bytes: 873149950
2025-03-13 19:04:59,956 [INFO]: 	avg_search_speed_ms: 9.719547072327737
2025-03-13 19:04:59,956 [INFO]: 	99p_search_speed_ms: 16.13660015165806
2025-03-13 19:04:59,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:59,956 [INFO]: 	nb vectors: 4438
2025-03-13 19:04:59,956 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:59,956 [INFO]: 	compression ratio: 0.9993086571212654
2025-03-13 19:04:59,956 [INFO]: }
2025-03-13 19:04:59,956 [INFO]: 	>>> Finished "Creating the index" in 67.6410 secs
2025-03-13 19:04:59,956 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6665 secs
2025-03-13 19:05:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 37192 [episode count 9/20]
[retrieval_preprocessing] for episode 61275 [episode count 10/20], we have num_retrieval=np.int64(4422) num_query=np.int64(263)
2025-03-13 19:05:03,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:04,372 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:04
2025-03-13 19:05:04,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.34it/s]
2025-03-13 19:05:04,398 [INFO]: There are 4422 embeddings of dim 49152
2025-03-13 19:05:04,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 19:05:04,399 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:04
2025-03-13 19:05:04,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:04,399 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:05:04,399 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:05:04,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:05:04,399 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:04
2025-03-13 19:05:04,399 [INFO]: 912.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:04,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:05:04,399 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:04
2025-03-13 19:05:04,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:05:04,399 [INFO]: 	Creating the index 03/13/2025, 19:05:04
2025-03-13 19:05:04,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:05:04
2025-03-13 19:05:04,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:05:04,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:04
2025-03-13 19:05:04,400 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:05:04,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.17it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.86it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.15it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.64it/s] 50%|█████     | 9/18 [00:00<00:00, 11.93it/s] 61%|██████    | 11/18 [00:00<00:00, 12.24it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.48it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.62it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.77it/s]100%|██████████| 18/18 [00:04<00:00,  3.76it/s]
2025-03-13 19:05:09,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:09
2025-03-13 19:05:50,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2969 secs
2025-03-13 19:05:50,488 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 19:05:50,488 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 19:06:27,567 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0792 secs
2025-03-13 19:06:27,571 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1705 secs
2025-03-13 19:06:27,571 [INFO]: {
2025-03-13 19:06:27,571 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:27,571 [INFO]: 	index_param: efSearch=245
2025-03-13 19:06:27,571 [INFO]: 	index_path: knn.index
2025-03-13 19:06:27,571 [INFO]: 	size in bytes: 870002110
2025-03-13 19:06:27,571 [INFO]: 	avg_search_speed_ms: 9.38091559447418
2025-03-13 19:06:27,571 [INFO]: 	99p_search_speed_ms: 13.573341583833093
2025-03-13 19:06:27,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:27,571 [INFO]: 	nb vectors: 4422
2025-03-13 19:06:27,571 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:27,571 [INFO]: 	compression ratio: 0.9993085832860796
2025-03-13 19:06:27,571 [INFO]: }
2025-03-13 19:06:27,571 [INFO]: 	>>> Finished "Creating the index" in 83.1718 secs
2025-03-13 19:06:27,571 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1986 secs
2025-03-13 19:06:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 61275 [episode count 10/20]
[retrieval_preprocessing] for episode 37217 [episode count 11/20], we have num_retrieval=np.int64(4494) num_query=np.int64(191)
2025-03-13 19:06:31,890 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:32,486 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:32
2025-03-13 19:06:32,486 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-13 19:06:32,510 [INFO]: There are 4494 embeddings of dim 49152
2025-03-13 19:06:32,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 19:06:32,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:32
2025-03-13 19:06:32,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:32,510 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:06:32,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:32,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:32,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:32
2025-03-13 19:06:32,510 [INFO]: 927.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:32,510 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:06:32,510 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:32
2025-03-13 19:06:32,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:32,510 [INFO]: 	Creating the index 03/13/2025, 19:06:32
2025-03-13 19:06:32,510 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:32
2025-03-13 19:06:32,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:06:32,511 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:32
2025-03-13 19:06:32,511 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:06:32,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.92it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.77it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.10it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.50it/s] 50%|█████     | 9/18 [00:00<00:00, 11.81it/s] 61%|██████    | 11/18 [00:00<00:00, 11.75it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.90it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.97it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.73it/s]100%|██████████| 18/18 [00:04<00:00,  4.09it/s]
2025-03-13 19:06:36,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:36
2025-03-13 19:07:18,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6465 secs
2025-03-13 19:07:18,569 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 19:07:18,569 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-13 19:07:47,815 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2460 secs
2025-03-13 19:07:47,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3065 secs
2025-03-13 19:07:47,818 [INFO]: {
2025-03-13 19:07:47,818 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:47,818 [INFO]: 	index_param: efSearch=258
2025-03-13 19:07:47,818 [INFO]: 	index_path: knn.index
2025-03-13 19:07:47,818 [INFO]: 	size in bytes: 884167630
2025-03-13 19:07:47,818 [INFO]: 	avg_search_speed_ms: 9.360493648443562
2025-03-13 19:07:47,818 [INFO]: 	99p_search_speed_ms: 12.432723036035894
2025-03-13 19:07:47,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:47,818 [INFO]: 	nb vectors: 4494
2025-03-13 19:07:47,818 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:47,818 [INFO]: 	compression ratio: 0.9993086401500584
2025-03-13 19:07:47,818 [INFO]: }
2025-03-13 19:07:47,818 [INFO]: 	>>> Finished "Creating the index" in 75.3078 secs
2025-03-13 19:07:47,818 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3322 secs
2025-03-13 19:07:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 37217 [episode count 11/20]
[retrieval_preprocessing] for episode 35180 [episode count 12/20], we have num_retrieval=np.int64(4475) num_query=np.int64(210)
2025-03-13 19:07:50,592 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:51,311 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:51
2025-03-13 19:07:51,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2753.98it/s]
2025-03-13 19:07:51,330 [INFO]: There are 4475 embeddings of dim 49152
2025-03-13 19:07:51,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0194 secs
2025-03-13 19:07:51,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:51,330 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:07:51,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:51,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:07:51,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,330 [INFO]: 923.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:51,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:07:51,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:51
2025-03-13 19:07:51,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:51,331 [INFO]: 	Creating the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,331 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:51
2025-03-13 19:07:51,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:07:51,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:51
2025-03-13 19:07:51,332 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:07:51,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.40it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.36it/s] 28%|██▊       | 5/18 [00:00<00:01, 12.96it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.64it/s] 50%|█████     | 9/18 [00:00<00:00, 14.07it/s] 61%|██████    | 11/18 [00:00<00:00, 14.42it/s] 72%|███████▏  | 13/18 [00:00<00:00, 14.32it/s] 83%|████████▎ | 15/18 [00:01<00:00, 14.01it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.84it/s]100%|██████████| 18/18 [00:04<00:00,  3.90it/s]
2025-03-13 19:07:55,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:55
2025-03-13 19:08:33,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2749 secs
2025-03-13 19:08:33,220 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 19:08:33,220 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.81it/s] 50%|█████     | 2/4 [00:00<00:00,  4.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.71it/s]
2025-03-13 19:08:51,749 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5282 secs
2025-03-13 19:08:51,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4194 secs
2025-03-13 19:08:51,751 [INFO]: {
2025-03-13 19:08:51,752 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:51,752 [INFO]: 	index_param: efSearch=223
2025-03-13 19:08:51,752 [INFO]: 	index_path: knn.index
2025-03-13 19:08:51,752 [INFO]: 	size in bytes: 880429450
2025-03-13 19:08:51,752 [INFO]: 	avg_search_speed_ms: 9.288181548422772
2025-03-13 19:08:51,752 [INFO]: 	99p_search_speed_ms: 14.763187104836106
2025-03-13 19:08:51,752 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:51,752 [INFO]: 	nb vectors: 4475
2025-03-13 19:08:51,752 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:51,752 [INFO]: 	compression ratio: 0.9993086896400387
2025-03-13 19:08:51,752 [INFO]: }
2025-03-13 19:08:51,752 [INFO]: 	>>> Finished "Creating the index" in 60.4211 secs
2025-03-13 19:08:51,752 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4410 secs
2025-03-13 19:08:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 35180 [episode count 12/20]
[retrieval_preprocessing] for episode 60793 [episode count 13/20], we have num_retrieval=np.int64(4417) num_query=np.int64(268)
2025-03-13 19:08:54,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:55,535 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:55
2025-03-13 19:08:55,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.05it/s]
2025-03-13 19:08:55,559 [INFO]: There are 4417 embeddings of dim 49152
2025-03-13 19:08:55,559 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 19:08:55,559 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:55
2025-03-13 19:08:55,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:55,560 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:08:55,560 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:55,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:08:55,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:55
2025-03-13 19:08:55,560 [INFO]: 911.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:55,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:08:55,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:55
2025-03-13 19:08:55,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:55,561 [INFO]: 	Creating the index 03/13/2025, 19:08:55
2025-03-13 19:08:55,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:55
2025-03-13 19:08:55,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:08:55,564 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:55
2025-03-13 19:08:55,564 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:08:55,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.12it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.57it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.73it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.33it/s] 50%|█████     | 9/18 [00:00<00:00, 11.67it/s] 61%|██████    | 11/18 [00:00<00:00, 11.99it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.08it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.13it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.30it/s]100%|██████████| 18/18 [00:04<00:00,  4.01it/s]
2025-03-13 19:09:00,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:00
2025-03-13 19:09:42,246 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1814 secs
2025-03-13 19:09:42,246 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 19:09:42,246 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 19:10:03,820 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5743 secs
2025-03-13 19:10:03,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2588 secs
2025-03-13 19:10:03,823 [INFO]: {
2025-03-13 19:10:03,823 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:03,823 [INFO]: 	index_param: efSearch=269
2025-03-13 19:10:03,823 [INFO]: 	index_path: knn.index
2025-03-13 19:10:03,823 [INFO]: 	size in bytes: 869018410
2025-03-13 19:10:03,823 [INFO]: 	avg_search_speed_ms: 9.77735467576481
2025-03-13 19:10:03,823 [INFO]: 	99p_search_speed_ms: 17.504387544468038
2025-03-13 19:10:03,823 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:03,823 [INFO]: 	nb vectors: 4417
2025-03-13 19:10:03,824 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:03,824 [INFO]: 	compression ratio: 0.9993085601028867
2025-03-13 19:10:03,824 [INFO]: }
2025-03-13 19:10:03,824 [INFO]: 	>>> Finished "Creating the index" in 68.2623 secs
2025-03-13 19:10:03,824 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2890 secs
2025-03-13 19:10:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 60793 [episode count 13/20]
[retrieval_preprocessing] for episode 58757 [episode count 14/20], we have num_retrieval=np.int64(4511) num_query=np.int64(174)
2025-03-13 19:10:07,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:08,874 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:08
2025-03-13 19:10:08,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.08it/s]
2025-03-13 19:10:08,903 [INFO]: There are 4511 embeddings of dim 49152
2025-03-13 19:10:08,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 19:10:08,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:08
2025-03-13 19:10:08,903 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:08,903 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:10:08,903 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:08,903 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:08,903 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:08
2025-03-13 19:10:08,903 [INFO]: 931.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:08,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:10:08,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:08
2025-03-13 19:10:08,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:08,904 [INFO]: 	Creating the index 03/13/2025, 19:10:08
2025-03-13 19:10:08,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:08
2025-03-13 19:10:08,905 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 19:10:08,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:08
2025-03-13 19:10:08,906 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:10:08,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.79it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.08it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.97it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.38it/s] 50%|█████     | 9/18 [00:00<00:00, 12.49it/s] 61%|██████    | 11/18 [00:00<00:00, 12.51it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.59it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.52it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.58it/s]100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
2025-03-13 19:10:13,109 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:13
2025-03-13 19:10:57,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2809 secs
2025-03-13 19:10:57,391 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 19:10:57,391 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 19:11:16,011 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6201 secs
2025-03-13 19:11:16,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1092 secs
2025-03-13 19:11:16,015 [INFO]: {
2025-03-13 19:11:16,015 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:16,015 [INFO]: 	index_param: efSearch=202
2025-03-13 19:11:16,015 [INFO]: 	index_path: knn.index
2025-03-13 19:11:16,015 [INFO]: 	size in bytes: 887512210
2025-03-13 19:11:16,015 [INFO]: 	avg_search_speed_ms: 7.664867395755087
2025-03-13 19:11:16,015 [INFO]: 	99p_search_speed_ms: 11.542245228774846
2025-03-13 19:11:16,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:16,015 [INFO]: 	nb vectors: 4511
2025-03-13 19:11:16,015 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:16,015 [INFO]: 	compression ratio: 0.9993087171161285
2025-03-13 19:11:16,015 [INFO]: }
2025-03-13 19:11:16,015 [INFO]: 	>>> Finished "Creating the index" in 67.1113 secs
2025-03-13 19:11:16,015 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1409 secs
2025-03-13 19:11:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 58757 [episode count 14/20]
[retrieval_preprocessing] for episode 66476 [episode count 15/20], we have num_retrieval=np.int64(4399) num_query=np.int64(286)
2025-03-13 19:11:18,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:19,108 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:19
2025-03-13 19:11:19,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.83it/s]
2025-03-13 19:11:19,137 [INFO]: There are 4399 embeddings of dim 49152
2025-03-13 19:11:19,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 19:11:19,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:19
2025-03-13 19:11:19,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:19,138 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:11:19,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:19,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:11:19,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:19
2025-03-13 19:11:19,138 [INFO]: 907.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:19,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:11:19,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:19
2025-03-13 19:11:19,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:19,138 [INFO]: 	Creating the index 03/13/2025, 19:11:19
2025-03-13 19:11:19,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:19
2025-03-13 19:11:19,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:11:19,139 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:19
2025-03-13 19:11:19,139 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:11:19,139 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.74it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.75it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.14it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.98it/s] 50%|█████     | 9/18 [00:00<00:00, 14.34it/s] 61%|██████    | 11/18 [00:00<00:00, 14.87it/s] 72%|███████▏  | 13/18 [00:00<00:00, 15.14it/s] 83%|████████▎ | 15/18 [00:01<00:00, 15.42it/s] 94%|█████████▍| 17/18 [00:01<00:00, 15.87it/s]100%|██████████| 18/18 [00:03<00:00,  4.65it/s]
2025-03-13 19:11:23,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:23
2025-03-13 19:12:05,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8438 secs
2025-03-13 19:12:05,858 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 19:12:05,858 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 19:12:27,306 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4477 secs
2025-03-13 19:12:27,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1694 secs
2025-03-13 19:12:27,309 [INFO]: {
2025-03-13 19:12:27,309 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:27,309 [INFO]: 	index_param: efSearch=246
2025-03-13 19:12:27,309 [INFO]: 	index_path: knn.index
2025-03-13 19:12:27,309 [INFO]: 	size in bytes: 865476970
2025-03-13 19:12:27,309 [INFO]: 	avg_search_speed_ms: 9.21229704675088
2025-03-13 19:12:27,309 [INFO]: 	99p_search_speed_ms: 12.682329141534877
2025-03-13 19:12:27,309 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:27,309 [INFO]: 	nb vectors: 4399
2025-03-13 19:12:27,309 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:27,309 [INFO]: 	compression ratio: 0.9993086147630248
2025-03-13 19:12:27,309 [INFO]: }
2025-03-13 19:12:27,309 [INFO]: 	>>> Finished "Creating the index" in 68.1709 secs
2025-03-13 19:12:27,309 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2007 secs
2025-03-13 19:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 66476 [episode count 15/20]
[retrieval_preprocessing] for episode 74187 [episode count 16/20], we have num_retrieval=np.int64(4514) num_query=np.int64(171)
2025-03-13 19:12:31,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:32,304 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:32
2025-03-13 19:12:32,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2242.94it/s]
2025-03-13 19:12:32,330 [INFO]: There are 4514 embeddings of dim 49152
2025-03-13 19:12:32,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 19:12:32,331 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:32
2025-03-13 19:12:32,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:32,331 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:12:32,331 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:32,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:12:32,331 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:32
2025-03-13 19:12:32,332 [INFO]: 931.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:32,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:12:32,332 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:32
2025-03-13 19:12:32,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:32,332 [INFO]: 	Creating the index 03/13/2025, 19:12:32
2025-03-13 19:12:32,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:32
2025-03-13 19:12:32,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:12:32,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:32
2025-03-13 19:12:32,336 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:12:32,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.48it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.81it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.28it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.94it/s] 50%|█████     | 9/18 [00:00<00:00, 12.51it/s] 61%|██████    | 11/18 [00:00<00:00, 13.22it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.86it/s] 83%|████████▎ | 15/18 [00:01<00:00, 14.49it/s] 94%|█████████▍| 17/18 [00:01<00:00, 14.92it/s]100%|██████████| 18/18 [00:04<00:00,  4.39it/s]
2025-03-13 19:12:36,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:36
2025-03-13 19:13:23,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3648 secs
2025-03-13 19:13:23,815 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 19:13:23,815 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 19:13:49,157 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3418 secs
2025-03-13 19:13:49,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8238 secs
2025-03-13 19:13:49,160 [INFO]: {
2025-03-13 19:13:49,160 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:49,160 [INFO]: 	index_param: efSearch=220
2025-03-13 19:13:49,160 [INFO]: 	index_path: knn.index
2025-03-13 19:13:49,160 [INFO]: 	size in bytes: 888102430
2025-03-13 19:13:49,160 [INFO]: 	avg_search_speed_ms: 9.388567747749354
2025-03-13 19:13:49,160 [INFO]: 	99p_search_speed_ms: 13.202425101771949
2025-03-13 19:13:49,160 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:49,160 [INFO]: 	nb vectors: 4514
2025-03-13 19:13:49,160 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:49,160 [INFO]: 	compression ratio: 0.999308730638199
2025-03-13 19:13:49,160 [INFO]: }
2025-03-13 19:13:49,160 [INFO]: 	>>> Finished "Creating the index" in 76.8275 secs
2025-03-13 19:13:49,160 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8560 secs
2025-03-13 19:13:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 74187 [episode count 16/20]
[retrieval_preprocessing] for episode 86476 [episode count 17/20], we have num_retrieval=np.int64(4489) num_query=np.int64(196)
2025-03-13 19:13:51,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:52,555 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:52
2025-03-13 19:13:52,555 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-13 19:13:52,582 [INFO]: There are 4489 embeddings of dim 49152
2025-03-13 19:13:52,582 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 19:13:52,582 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:52,582 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:13:52,582 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:52,582 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:52,582 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,582 [INFO]: 926.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:52,582 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:52,582 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:52
2025-03-13 19:13:52,582 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:52,582 [INFO]: 	Creating the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,582 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:52
2025-03-13 19:13:52,583 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:13:52,583 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,583 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:13:52,583 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.76it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.27it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.98it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.62it/s] 50%|█████     | 9/18 [00:00<00:00, 10.89it/s] 61%|██████    | 11/18 [00:01<00:00, 11.22it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.64it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.99it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.36it/s]100%|██████████| 18/18 [00:04<00:00,  3.97it/s]
2025-03-13 19:13:57,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:57
2025-03-13 19:14:43,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6944 secs
2025-03-13 19:14:43,823 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 19:14:43,823 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 19:15:11,499 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6754 secs
2025-03-13 19:15:11,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9179 secs
2025-03-13 19:15:11,501 [INFO]: {
2025-03-13 19:15:11,501 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:11,501 [INFO]: 	index_param: efSearch=247
2025-03-13 19:15:11,501 [INFO]: 	index_path: knn.index
2025-03-13 19:15:11,501 [INFO]: 	size in bytes: 883183870
2025-03-13 19:15:11,501 [INFO]: 	avg_search_speed_ms: 9.04749513085409
2025-03-13 19:15:11,501 [INFO]: 	99p_search_speed_ms: 13.131803059950471
2025-03-13 19:15:11,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:11,502 [INFO]: 	nb vectors: 4489
2025-03-13 19:15:11,502 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:11,502 [INFO]: 	compression ratio: 0.9993086852910935
2025-03-13 19:15:11,502 [INFO]: }
2025-03-13 19:15:11,502 [INFO]: 	>>> Finished "Creating the index" in 78.9193 secs
2025-03-13 19:15:11,502 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9464 secs
2025-03-13 19:15:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 86476 [episode count 17/20]
[retrieval_preprocessing] for episode 84429 [episode count 18/20], we have num_retrieval=np.int64(4486) num_query=np.int64(199)
2025-03-13 19:15:14,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:15,277 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:15
2025-03-13 19:15:15,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.76it/s]
2025-03-13 19:15:15,302 [INFO]: There are 4486 embeddings of dim 49152
2025-03-13 19:15:15,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 19:15:15,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:15
2025-03-13 19:15:15,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:15,302 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:15:15,302 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:15,302 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:15,302 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:15
2025-03-13 19:15:15,302 [INFO]: 925.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:15,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:15:15,302 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:15
2025-03-13 19:15:15,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:15,302 [INFO]: 	Creating the index 03/13/2025, 19:15:15
2025-03-13 19:15:15,303 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:15
2025-03-13 19:15:15,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:15:15,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:15
2025-03-13 19:15:15,304 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:15:15,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.08it/s] 11%|█         | 2/18 [00:00<00:02,  6.90it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.31it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.49it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.60it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.67it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.85it/s] 50%|█████     | 9/18 [00:01<00:01,  8.85it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.84it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.20it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.37it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.42it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.26it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.13it/s]100%|██████████| 18/18 [00:05<00:00,  1.02it/s]100%|██████████| 18/18 [00:05<00:00,  3.33it/s]
2025-03-13 19:15:20,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:20
2025-03-13 19:16:07,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3568 secs
2025-03-13 19:16:07,072 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 19:16:07,072 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 19:16:34,437 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3647 secs
2025-03-13 19:16:34,562 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2588 secs
2025-03-13 19:16:34,563 [INFO]: {
2025-03-13 19:16:34,563 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:34,563 [INFO]: 	index_param: efSearch=233
2025-03-13 19:16:34,563 [INFO]: 	index_path: knn.index
2025-03-13 19:16:34,563 [INFO]: 	size in bytes: 882593650
2025-03-13 19:16:34,563 [INFO]: 	avg_search_speed_ms: 9.330226218982933
2025-03-13 19:16:34,563 [INFO]: 	99p_search_speed_ms: 13.325370126403868
2025-03-13 19:16:34,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:34,563 [INFO]: 	nb vectors: 4486
2025-03-13 19:16:34,563 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:34,563 [INFO]: 	compression ratio: 0.9993086716633414
2025-03-13 19:16:34,563 [INFO]: }
2025-03-13 19:16:34,563 [INFO]: 	>>> Finished "Creating the index" in 79.2609 secs
2025-03-13 19:16:34,564 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2861 secs
2025-03-13 19:16:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 84429 [episode count 18/20]
[retrieval_preprocessing] for episode 33246 [episode count 19/20], we have num_retrieval=np.int64(4464) num_query=np.int64(221)
2025-03-13 19:16:37,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:38,357 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:38
2025-03-13 19:16:38,357 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2303.30it/s]
2025-03-13 19:16:38,381 [INFO]: There are 4464 embeddings of dim 49152
2025-03-13 19:16:38,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 19:16:38,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:38
2025-03-13 19:16:38,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:38,382 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 19:16:38,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:38,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:16:38,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:38
2025-03-13 19:16:38,382 [INFO]: 921.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:38,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:16:38,382 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:38
2025-03-13 19:16:38,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:38,382 [INFO]: 	Creating the index 03/13/2025, 19:16:38
2025-03-13 19:16:38,382 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:38
2025-03-13 19:16:38,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:16:38,383 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:38
2025-03-13 19:16:38,383 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:16:38,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.95it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.00it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.79it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.19it/s] 50%|█████     | 9/18 [00:00<00:00,  9.99it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.63it/s] 61%|██████    | 11/18 [00:01<00:00,  9.39it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.14it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.97it/s] 78%|███████▊  | 14/18 [00:01<00:00,  7.57it/s] 83%|████████▎ | 15/18 [00:01<00:00,  6.90it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.45it/s]100%|██████████| 18/18 [00:05<00:00,  1.19it/s]100%|██████████| 18/18 [00:05<00:00,  3.57it/s]
2025-03-13 19:16:43,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:43
2025-03-13 19:17:27,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4356 secs
2025-03-13 19:17:27,867 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 19:17:27,867 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 19:17:49,362 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4944 secs
2025-03-13 19:17:49,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9815 secs
2025-03-13 19:17:49,365 [INFO]: {
2025-03-13 19:17:49,365 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:49,365 [INFO]: 	index_param: efSearch=259
2025-03-13 19:17:49,365 [INFO]: 	index_path: knn.index
2025-03-13 19:17:49,365 [INFO]: 	size in bytes: 878265310
2025-03-13 19:17:49,365 [INFO]: 	avg_search_speed_ms: 9.820422952883092
2025-03-13 19:17:49,365 [INFO]: 	99p_search_speed_ms: 13.78708803560585
2025-03-13 19:17:49,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:49,365 [INFO]: 	nb vectors: 4464
2025-03-13 19:17:49,365 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:49,365 [INFO]: 	compression ratio: 0.999308639436072
2025-03-13 19:17:49,365 [INFO]: }
2025-03-13 19:17:49,365 [INFO]: 	>>> Finished "Creating the index" in 70.9831 secs
2025-03-13 19:17:49,365 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0077 secs
2025-03-13 19:17:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 33246 [episode count 19/20]
2025-03-13 19:17:51: [retrieval_preprocessing] finished for 446878712_put_marker_in_cup [chosen_id count 8/196]
2025-03-13 19:17:54: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 446878712_put_pen_in_cup [chosen_id count 9/196]
2025-03-13 19:17:54: [retrieval_preprocessing] we have num_total=4476 embedding_dim=49152
[retrieval_preprocessing] for episode 1028 [episode count 0/20], we have num_retrieval=np.int64(4211) num_query=np.int64(265)
2025-03-13 19:17:55,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:56,362 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:56
2025-03-13 19:17:56,362 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-13 19:17:56,386 [INFO]: There are 4211 embeddings of dim 49152
2025-03-13 19:17:56,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 19:17:56,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:56
2025-03-13 19:17:56,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:56,387 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:17:56,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:56,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:17:56,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:56
2025-03-13 19:17:56,387 [INFO]: 869.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:56,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:17:56,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:56
2025-03-13 19:17:56,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:56,387 [INFO]: 	Creating the index 03/13/2025, 19:17:56
2025-03-13 19:17:56,387 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:56
2025-03-13 19:17:56,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:17:56,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:56
2025-03-13 19:17:56,388 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:17:56,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:04,  3.75it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.54it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.19it/s] 41%|████      | 7/17 [00:00<00:00, 10.11it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.50it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.78it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.01it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.98it/s]100%|██████████| 17/17 [00:04<00:00,  1.90it/s]100%|██████████| 17/17 [00:04<00:00,  3.84it/s]
2025-03-13 19:18:00,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:00
2025-03-13 19:18:38,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9515 secs
2025-03-13 19:18:38,775 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:18:38,775 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 19:19:01,439 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6635 secs
2025-03-13 19:19:01,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0534 secs
2025-03-13 19:19:01,442 [INFO]: {
2025-03-13 19:19:01,442 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:01,442 [INFO]: 	index_param: efSearch=244
2025-03-13 19:19:01,442 [INFO]: 	index_path: knn.index
2025-03-13 19:19:01,442 [INFO]: 	size in bytes: 828488950
2025-03-13 19:19:01,442 [INFO]: 	avg_search_speed_ms: 9.038503708523153
2025-03-13 19:19:01,442 [INFO]: 	99p_search_speed_ms: 12.198726246133448
2025-03-13 19:19:01,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:01,442 [INFO]: 	nb vectors: 4211
2025-03-13 19:19:01,442 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:01,442 [INFO]: 	compression ratio: 0.9993087874014493
2025-03-13 19:19:01,442 [INFO]: }
2025-03-13 19:19:01,442 [INFO]: 	>>> Finished "Creating the index" in 65.0548 secs
2025-03-13 19:19:01,442 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0804 secs
2025-03-13 19:19:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 1028 [episode count 0/20]
[retrieval_preprocessing] for episode 20517 [episode count 1/20], we have num_retrieval=np.int64(4107) num_query=np.int64(369)
2025-03-13 19:19:06,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:07,406 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:07
2025-03-13 19:19:07,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2125.85it/s]
2025-03-13 19:19:07,432 [INFO]: There are 4107 embeddings of dim 49152
2025-03-13 19:19:07,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 19:19:07,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:07
2025-03-13 19:19:07,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:07,432 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:19:07,432 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:07,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:19:07,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:07
2025-03-13 19:19:07,433 [INFO]: 847.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:07,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:19:07,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:07
2025-03-13 19:19:07,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:07,433 [INFO]: 	Creating the index 03/13/2025, 19:19:07
2025-03-13 19:19:07,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:07
2025-03-13 19:19:07,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:19:07,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:07
2025-03-13 19:19:07,434 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:19:07,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.75it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.45it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.99it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.95it/s] 47%|████▋     | 8/17 [00:00<00:00, 11.24it/s] 59%|█████▉    | 10/17 [00:00<00:00, 12.11it/s] 71%|███████   | 12/17 [00:01<00:00, 13.01it/s] 82%|████████▏ | 14/17 [00:01<00:00, 13.83it/s] 94%|█████████▍| 16/17 [00:01<00:00, 14.47it/s]100%|██████████| 17/17 [00:04<00:00,  3.91it/s]
2025-03-13 19:19:11,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:11
2025-03-13 19:19:58,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1958 secs
2025-03-13 19:19:58,985 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 19:19:58,985 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 19:20:19,670 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6852 secs
2025-03-13 19:20:19,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2389 secs
2025-03-13 19:20:19,673 [INFO]: {
2025-03-13 19:20:19,673 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:19,673 [INFO]: 	index_param: efSearch=207
2025-03-13 19:20:19,673 [INFO]: 	index_path: knn.index
2025-03-13 19:20:19,673 [INFO]: 	size in bytes: 808027690
2025-03-13 19:20:19,673 [INFO]: 	avg_search_speed_ms: 9.14644053348997
2025-03-13 19:20:19,673 [INFO]: 	99p_search_speed_ms: 14.532585218548764
2025-03-13 19:20:19,674 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:19,674 [INFO]: 	nb vectors: 4107
2025-03-13 19:20:19,674 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:19,674 [INFO]: 	compression ratio: 0.9993086449797284
2025-03-13 19:20:19,674 [INFO]: }
2025-03-13 19:20:19,674 [INFO]: 	>>> Finished "Creating the index" in 72.2407 secs
2025-03-13 19:20:19,674 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2672 secs
2025-03-13 19:20:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 20517 [episode count 1/20]
[retrieval_preprocessing] for episode 91688 [episode count 2/20], we have num_retrieval=np.int64(4294) num_query=np.int64(182)
2025-03-13 19:20:23,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:23,946 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:23
2025-03-13 19:20:23,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-13 19:20:23,974 [INFO]: There are 4294 embeddings of dim 49152
2025-03-13 19:20:23,974 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 19:20:23,974 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:23
2025-03-13 19:20:23,974 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:23,975 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:20:23,975 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:23,975 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:20:23,975 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:23
2025-03-13 19:20:23,975 [INFO]: 886.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:23,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:20:23,976 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:23
2025-03-13 19:20:23,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:23,976 [INFO]: 	Creating the index 03/13/2025, 19:20:23
2025-03-13 19:20:23,976 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:23
2025-03-13 19:20:23,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:20:23,979 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:23
2025-03-13 19:20:23,980 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:20:23,980 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.24it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.96it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.04it/s] 41%|████      | 7/17 [00:00<00:00, 11.67it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.03it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.13it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.31it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.21it/s]100%|██████████| 17/17 [00:04<00:00,  1.71it/s]100%|██████████| 17/17 [00:04<00:00,  3.67it/s]
2025-03-13 19:20:28,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:28
2025-03-13 19:21:10,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7569 secs
2025-03-13 19:21:10,383 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 19:21:10,383 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 50%|█████     | 2/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 19:21:35,388 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0047 secs
2025-03-13 19:21:36,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0942 secs
2025-03-13 19:21:36,074 [INFO]: {
2025-03-13 19:21:36,074 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:36,074 [INFO]: 	index_param: efSearch=224
2025-03-13 19:21:36,074 [INFO]: 	index_path: knn.index
2025-03-13 19:21:36,074 [INFO]: 	size in bytes: 844818850
2025-03-13 19:21:36,074 [INFO]: 	avg_search_speed_ms: 8.496149066050704
2025-03-13 19:21:36,074 [INFO]: 	99p_search_speed_ms: 12.997551541775469
2025-03-13 19:21:36,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:36,075 [INFO]: 	nb vectors: 4294
2025-03-13 19:21:36,075 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:36,075 [INFO]: 	compression ratio: 0.9993086115443566
2025-03-13 19:21:36,075 [INFO]: }
2025-03-13 19:21:36,075 [INFO]: 	>>> Finished "Creating the index" in 72.0985 secs
2025-03-13 19:21:36,075 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1290 secs
2025-03-13 19:21:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 91688 [episode count 2/20]
[retrieval_preprocessing] for episode 57921 [episode count 3/20], we have num_retrieval=np.int64(4164) num_query=np.int64(312)
2025-03-13 19:21:39,141 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:39,664 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:39
2025-03-13 19:21:39,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2288.22it/s]
2025-03-13 19:21:39,689 [INFO]: There are 4164 embeddings of dim 49152
2025-03-13 19:21:39,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 19:21:39,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:39
2025-03-13 19:21:39,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:39,689 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:21:39,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:39,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:39,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:39
2025-03-13 19:21:39,689 [INFO]: 859.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:39,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:39,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:39
2025-03-13 19:21:39,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:39,689 [INFO]: 	Creating the index 03/13/2025, 19:21:39
2025-03-13 19:21:39,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:39
2025-03-13 19:21:39,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:21:39,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:39
2025-03-13 19:21:39,690 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:21:39,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.17it/s] 18%|█▊        | 3/17 [00:00<00:01, 11.08it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.90it/s] 41%|████      | 7/17 [00:00<00:00, 12.28it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.45it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.53it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.68it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.81it/s]100%|██████████| 17/17 [00:04<00:00,  2.01it/s]100%|██████████| 17/17 [00:04<00:00,  4.22it/s]
2025-03-13 19:21:43,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:43
2025-03-13 19:22:25,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9618 secs
2025-03-13 19:22:25,687 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 19:22:25,687 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 19:22:48,120 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4329 secs
2025-03-13 19:22:48,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4332 secs
2025-03-13 19:22:48,124 [INFO]: {
2025-03-13 19:22:48,124 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:48,124 [INFO]: 	index_param: efSearch=242
2025-03-13 19:22:48,124 [INFO]: 	index_path: knn.index
2025-03-13 19:22:48,124 [INFO]: 	size in bytes: 819242110
2025-03-13 19:22:48,124 [INFO]: 	avg_search_speed_ms: 9.7069628791889
2025-03-13 19:22:48,124 [INFO]: 	99p_search_speed_ms: 13.334533874876799
2025-03-13 19:22:48,124 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:48,124 [INFO]: 	nb vectors: 4164
2025-03-13 19:22:48,124 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:48,124 [INFO]: 	compression ratio: 0.9993086317303684
2025-03-13 19:22:48,124 [INFO]: }
2025-03-13 19:22:48,124 [INFO]: 	>>> Finished "Creating the index" in 68.4346 secs
2025-03-13 19:22:48,124 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4594 secs
2025-03-13 19:22:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 57921 [episode count 3/20]
[retrieval_preprocessing] for episode 68166 [episode count 4/20], we have num_retrieval=np.int64(4235) num_query=np.int64(241)
2025-03-13 19:22:52,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:53,083 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:53
2025-03-13 19:22:53,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.04it/s]
2025-03-13 19:22:53,109 [INFO]: There are 4235 embeddings of dim 49152
2025-03-13 19:22:53,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 19:22:53,109 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:53
2025-03-13 19:22:53,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:53,109 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:22:53,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:53,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:22:53,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:53
2025-03-13 19:22:53,110 [INFO]: 874.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:53,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:22:53,111 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:53
2025-03-13 19:22:53,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:53,111 [INFO]: 	Creating the index 03/13/2025, 19:22:53
2025-03-13 19:22:53,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:53
2025-03-13 19:22:53,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:22:53,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:53
2025-03-13 19:22:53,114 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:22:53,115 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.52it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.19it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.32it/s] 41%|████      | 7/17 [00:00<00:00, 11.92it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.85it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.86it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.06it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.05it/s]100%|██████████| 17/17 [00:04<00:00,  1.93it/s]100%|██████████| 17/17 [00:04<00:00,  4.03it/s]
2025-03-13 19:22:57,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:57
2025-03-13 19:23:35,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5749 secs
2025-03-13 19:23:35,920 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 19:23:35,921 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 19:23:58,169 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2484 secs
2025-03-13 19:23:58,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0576 secs
2025-03-13 19:23:58,172 [INFO]: {
2025-03-13 19:23:58,172 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:58,172 [INFO]: 	index_param: efSearch=231
2025-03-13 19:23:58,172 [INFO]: 	index_path: knn.index
2025-03-13 19:23:58,172 [INFO]: 	size in bytes: 833210830
2025-03-13 19:23:58,172 [INFO]: 	avg_search_speed_ms: 9.246395840593605
2025-03-13 19:23:58,172 [INFO]: 	99p_search_speed_ms: 12.013813238590958
2025-03-13 19:23:58,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:58,172 [INFO]: 	nb vectors: 4235
2025-03-13 19:23:58,172 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:58,172 [INFO]: 	compression ratio: 0.9993087583847176
2025-03-13 19:23:58,172 [INFO]: }
2025-03-13 19:23:58,172 [INFO]: 	>>> Finished "Creating the index" in 65.0613 secs
2025-03-13 19:23:58,172 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0893 secs
2025-03-13 19:23:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 68166 [episode count 4/20]
[retrieval_preprocessing] for episode 33503 [episode count 5/20], we have num_retrieval=np.int64(4249) num_query=np.int64(227)
2025-03-13 19:24:01,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:01,811 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:01
2025-03-13 19:24:01,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-13 19:24:01,836 [INFO]: There are 4249 embeddings of dim 49152
2025-03-13 19:24:01,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 19:24:01,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:01
2025-03-13 19:24:01,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:01,837 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:24:01,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:01,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:24:01,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:01
2025-03-13 19:24:01,838 [INFO]: 876.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:01,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:24:01,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:01
2025-03-13 19:24:01,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:01,838 [INFO]: 	Creating the index 03/13/2025, 19:24:01
2025-03-13 19:24:01,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:01
2025-03-13 19:24:01,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:24:01,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:01
2025-03-13 19:24:01,842 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:24:01,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.97it/s] 18%|█▊        | 3/17 [00:00<00:01, 11.05it/s] 29%|██▉       | 5/17 [00:00<00:00, 12.18it/s] 41%|████      | 7/17 [00:00<00:00, 12.97it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.40it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.90it/s] 76%|███████▋  | 13/17 [00:00<00:00, 14.25it/s] 88%|████████▊ | 15/17 [00:01<00:00, 14.29it/s]100%|██████████| 17/17 [00:03<00:00,  2.02it/s]100%|██████████| 17/17 [00:03<00:00,  4.29it/s]
2025-03-13 19:24:05,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:05
2025-03-13 19:24:50,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6108 secs
2025-03-13 19:24:50,429 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 19:24:50,429 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-13 19:25:16,968 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5389 secs
2025-03-13 19:25:16,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.1293 secs
2025-03-13 19:25:16,971 [INFO]: {
2025-03-13 19:25:16,971 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:16,971 [INFO]: 	index_param: efSearch=225
2025-03-13 19:25:16,971 [INFO]: 	index_path: knn.index
2025-03-13 19:25:16,971 [INFO]: 	size in bytes: 835965310
2025-03-13 19:25:16,971 [INFO]: 	avg_search_speed_ms: 9.705307049528631
2025-03-13 19:25:16,971 [INFO]: 	99p_search_speed_ms: 13.047905964776877
2025-03-13 19:25:16,971 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:16,971 [INFO]: 	nb vectors: 4249
2025-03-13 19:25:16,971 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:16,972 [INFO]: 	compression ratio: 0.9993086818399199
2025-03-13 19:25:16,972 [INFO]: }
2025-03-13 19:25:16,972 [INFO]: 	>>> Finished "Creating the index" in 75.1332 secs
2025-03-13 19:25:16,972 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1601 secs
2025-03-13 19:25:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 33503 [episode count 5/20]
[retrieval_preprocessing] for episode 30974 [episode count 6/20], we have num_retrieval=np.int64(4335) num_query=np.int64(141)
2025-03-13 19:25:19,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:20,561 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:20
2025-03-13 19:25:20,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1721.09it/s]
2025-03-13 19:25:20,586 [INFO]: There are 4335 embeddings of dim 49152
2025-03-13 19:25:20,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 19:25:20,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:20
2025-03-13 19:25:20,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:20,587 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:25:20,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:20,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:20,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:20
2025-03-13 19:25:20,587 [INFO]: 894.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:20,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:25:20,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:20
2025-03-13 19:25:20,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:20,587 [INFO]: 	Creating the index 03/13/2025, 19:25:20
2025-03-13 19:25:20,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:20
2025-03-13 19:25:20,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:25:20,588 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:20
2025-03-13 19:25:20,588 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:25:20,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.48it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.47it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.88it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.11it/s] 50%|█████     | 9/18 [00:00<00:00, 12.33it/s] 61%|██████    | 11/18 [00:00<00:00, 12.42it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.32it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.92it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.60it/s]100%|██████████| 18/18 [00:05<00:00,  3.45it/s]
2025-03-13 19:25:25,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:25
2025-03-13 19:26:08,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8581 secs
2025-03-13 19:26:08,670 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 19:26:08,670 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 19:26:40,921 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2513 secs
2025-03-13 19:26:40,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3360 secs
2025-03-13 19:26:40,925 [INFO]: {
2025-03-13 19:26:40,925 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:40,925 [INFO]: 	index_param: efSearch=216
2025-03-13 19:26:40,925 [INFO]: 	index_path: knn.index
2025-03-13 19:26:40,925 [INFO]: 	size in bytes: 852885370
2025-03-13 19:26:40,925 [INFO]: 	avg_search_speed_ms: 9.926570901488136
2025-03-13 19:26:40,925 [INFO]: 	99p_search_speed_ms: 16.357011175714433
2025-03-13 19:26:40,925 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:40,925 [INFO]: 	nb vectors: 4335
2025-03-13 19:26:40,925 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:40,925 [INFO]: 	compression ratio: 0.9993085940728471
2025-03-13 19:26:40,925 [INFO]: }
2025-03-13 19:26:40,925 [INFO]: 	>>> Finished "Creating the index" in 80.3378 secs
2025-03-13 19:26:40,925 [INFO]: >>> Finished "Launching the whole pipeline" in 80.3633 secs
2025-03-13 19:26:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 30974 [episode count 6/20]
[retrieval_preprocessing] for episode 92423 [episode count 7/20], we have num_retrieval=np.int64(4240) num_query=np.int64(236)
2025-03-13 19:26:43,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:44,176 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:44
2025-03-13 19:26:44,176 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1480.52it/s]
2025-03-13 19:26:44,205 [INFO]: There are 4240 embeddings of dim 49152
2025-03-13 19:26:44,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 19:26:44,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:44,206 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:26:44,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:44,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:26:44,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,206 [INFO]: 875.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:44,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:26:44,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:44
2025-03-13 19:26:44,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:44,206 [INFO]: 	Creating the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:44
2025-03-13 19:26:44,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:26:44,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,207 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:26:44,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.41it/s] 24%|██▎       | 4/17 [00:00<00:00, 14.31it/s] 41%|████      | 7/17 [00:00<00:00, 18.25it/s] 53%|█████▎    | 9/17 [00:00<00:00, 17.56it/s] 65%|██████▍   | 11/17 [00:00<00:00, 16.13it/s] 76%|███████▋  | 13/17 [00:00<00:00, 14.64it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.80it/s]100%|██████████| 17/17 [00:03<00:00,  1.99it/s]100%|██████████| 17/17 [00:03<00:00,  4.28it/s]
2025-03-13 19:26:48,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:48
2025-03-13 19:27:29,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5699 secs
2025-03-13 19:27:29,754 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 19:27:29,754 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 19:27:50,586 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8311 secs
2025-03-13 19:27:51,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8173 secs
2025-03-13 19:27:51,025 [INFO]: {
2025-03-13 19:27:51,025 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:51,025 [INFO]: 	index_param: efSearch=241
2025-03-13 19:27:51,025 [INFO]: 	index_path: knn.index
2025-03-13 19:27:51,025 [INFO]: 	size in bytes: 834194650
2025-03-13 19:27:51,025 [INFO]: 	avg_search_speed_ms: 10.0706636756546
2025-03-13 19:27:51,025 [INFO]: 	99p_search_speed_ms: 14.744468769058592
2025-03-13 19:27:51,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:51,025 [INFO]: 	nb vectors: 4240
2025-03-13 19:27:51,025 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:51,025 [INFO]: 	compression ratio: 0.9993086385773392
2025-03-13 19:27:51,025 [INFO]: }
2025-03-13 19:27:51,026 [INFO]: 	>>> Finished "Creating the index" in 66.8195 secs
2025-03-13 19:27:51,026 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8500 secs
2025-03-13 19:27:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 92423 [episode count 7/20]
[retrieval_preprocessing] for episode 16851 [episode count 8/20], we have num_retrieval=np.int64(4276) num_query=np.int64(200)
2025-03-13 19:27:54,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:55,181 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:55
2025-03-13 19:27:55,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1700.85it/s]
2025-03-13 19:27:55,206 [INFO]: There are 4276 embeddings of dim 49152
2025-03-13 19:27:55,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 19:27:55,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:55,206 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:27:55,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:55,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:55,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,207 [INFO]: 882.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:55,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:55,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:55
2025-03-13 19:27:55,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:55,207 [INFO]: 	Creating the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:55
2025-03-13 19:27:55,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:27:55,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,208 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:27:55,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.45it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.36it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.45it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.62it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.81it/s] 41%|████      | 7/17 [00:00<00:01,  8.94it/s] 47%|████▋     | 8/17 [00:00<00:01,  9.00it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.91it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.40it/s] 71%|███████   | 12/17 [00:01<00:00,  9.42it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.37it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.32it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.93it/s]100%|██████████| 17/17 [00:05<00:00,  1.12it/s]100%|██████████| 17/17 [00:05<00:00,  3.29it/s]
2025-03-13 19:28:00,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:00
2025-03-13 19:28:45,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0838 secs
2025-03-13 19:28:45,462 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 19:28:45,462 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 19:29:07,133 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6711 secs
2025-03-13 19:29:07,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9282 secs
2025-03-13 19:29:07,136 [INFO]: {
2025-03-13 19:29:07,136 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:07,136 [INFO]: 	index_param: efSearch=228
2025-03-13 19:29:07,136 [INFO]: 	index_path: knn.index
2025-03-13 19:29:07,136 [INFO]: 	size in bytes: 841277350
2025-03-13 19:29:07,136 [INFO]: 	avg_search_speed_ms: 10.015989762482668
2025-03-13 19:29:07,136 [INFO]: 	99p_search_speed_ms: 14.817253730725497
2025-03-13 19:29:07,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:07,136 [INFO]: 	nb vectors: 4276
2025-03-13 19:29:07,136 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:07,136 [INFO]: 	compression ratio: 0.9993087392641677
2025-03-13 19:29:07,136 [INFO]: }
2025-03-13 19:29:07,136 [INFO]: 	>>> Finished "Creating the index" in 71.9296 secs
2025-03-13 19:29:07,137 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9552 secs
2025-03-13 19:29:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 16851 [episode count 8/20]
[retrieval_preprocessing] for episode 53716 [episode count 9/20], we have num_retrieval=np.int64(4219) num_query=np.int64(257)
2025-03-13 19:29:11,003 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:11,797 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:11
2025-03-13 19:29:11,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2037.06it/s]
2025-03-13 19:29:11,821 [INFO]: There are 4219 embeddings of dim 49152
2025-03-13 19:29:11,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:29:11,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:11
2025-03-13 19:29:11,822 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:11,822 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:29:11,822 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:11,822 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:11,822 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:11
2025-03-13 19:29:11,822 [INFO]: 870.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:11,822 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:29:11,822 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:11
2025-03-13 19:29:11,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:11,822 [INFO]: 	Creating the index 03/13/2025, 19:29:11
2025-03-13 19:29:11,822 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:11
2025-03-13 19:29:11,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:29:11,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:11
2025-03-13 19:29:11,823 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:29:11,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.69it/s] 18%|█▊        | 3/17 [00:00<00:01, 11.63it/s] 41%|████      | 7/17 [00:00<00:00, 20.57it/s] 65%|██████▍   | 11/17 [00:00<00:00, 26.11it/s] 88%|████████▊ | 15/17 [00:00<00:00, 30.25it/s]100%|██████████| 17/17 [00:03<00:00,  4.67it/s]
2025-03-13 19:29:15,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:15
2025-03-13 19:30:01,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7715 secs
2025-03-13 19:30:01,239 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 19:30:01,239 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 19:30:29,468 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2295 secs
2025-03-13 19:30:29,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.6479 secs
2025-03-13 19:30:29,471 [INFO]: {
2025-03-13 19:30:29,471 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:29,471 [INFO]: 	index_param: efSearch=212
2025-03-13 19:30:29,471 [INFO]: 	index_path: knn.index
2025-03-13 19:30:29,471 [INFO]: 	size in bytes: 830062930
2025-03-13 19:30:29,471 [INFO]: 	avg_search_speed_ms: 9.138617461966096
2025-03-13 19:30:29,471 [INFO]: 	99p_search_speed_ms: 12.656930442899464
2025-03-13 19:30:29,471 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:29,471 [INFO]: 	nb vectors: 4219
2025-03-13 19:30:29,471 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:29,471 [INFO]: 	compression ratio: 0.9993087536146206
2025-03-13 19:30:29,471 [INFO]: }
2025-03-13 19:30:29,471 [INFO]: 	>>> Finished "Creating the index" in 77.6493 secs
2025-03-13 19:30:29,471 [INFO]: >>> Finished "Launching the whole pipeline" in 77.6740 secs
2025-03-13 19:30:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 53716 [episode count 9/20]
[retrieval_preprocessing] for episode 32121 [episode count 10/20], we have num_retrieval=np.int64(4313) num_query=np.int64(163)
2025-03-13 19:30:32,520 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:33,596 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:33
2025-03-13 19:30:33,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.69it/s]
2025-03-13 19:30:33,620 [INFO]: There are 4313 embeddings of dim 49152
2025-03-13 19:30:33,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 19:30:33,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:33
2025-03-13 19:30:33,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:33,621 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:30:33,621 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:33,621 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:33,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:33
2025-03-13 19:30:33,621 [INFO]: 890.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:33,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:30:33,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:33
2025-03-13 19:30:33,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:33,621 [INFO]: 	Creating the index 03/13/2025, 19:30:33
2025-03-13 19:30:33,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:33
2025-03-13 19:30:33,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:30:33,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:33
2025-03-13 19:30:33,622 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:30:33,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.29it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.04it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.58it/s] 41%|████      | 7/17 [00:00<00:00, 11.29it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.80it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.02it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.22it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.07it/s]100%|██████████| 17/17 [00:04<00:00,  1.86it/s]100%|██████████| 17/17 [00:04<00:00,  3.88it/s]
2025-03-13 19:30:38,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:38
2025-03-13 19:31:24,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3492 secs
2025-03-13 19:31:24,360 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 19:31:24,360 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 19:31:43,267 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9066 secs
2025-03-13 19:31:43,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6476 secs
2025-03-13 19:31:43,270 [INFO]: {
2025-03-13 19:31:43,270 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:43,270 [INFO]: 	index_param: efSearch=214
2025-03-13 19:31:43,270 [INFO]: 	index_path: knn.index
2025-03-13 19:31:43,270 [INFO]: 	size in bytes: 848556970
2025-03-13 19:31:43,270 [INFO]: 	avg_search_speed_ms: 8.81506330982455
2025-03-13 19:31:43,270 [INFO]: 	99p_search_speed_ms: 14.219180403742962
2025-03-13 19:31:43,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:43,270 [INFO]: 	nb vectors: 4313
2025-03-13 19:31:43,270 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:43,270 [INFO]: 	compression ratio: 0.9993086309808993
2025-03-13 19:31:43,270 [INFO]: }
2025-03-13 19:31:43,270 [INFO]: 	>>> Finished "Creating the index" in 69.6491 secs
2025-03-13 19:31:43,270 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6746 secs
2025-03-13 19:31:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 32121 [episode count 10/20]
[retrieval_preprocessing] for episode 36417 [episode count 11/20], we have num_retrieval=np.int64(4193) num_query=np.int64(283)
2025-03-13 19:31:45,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:46,046 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:46
2025-03-13 19:31:46,046 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-13 19:31:46,072 [INFO]: There are 4193 embeddings of dim 49152
2025-03-13 19:31:46,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 19:31:46,073 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:46
2025-03-13 19:31:46,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:46,073 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:31:46,073 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:46,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:31:46,073 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:46
2025-03-13 19:31:46,073 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:46,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:31:46,073 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:46
2025-03-13 19:31:46,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:46,073 [INFO]: 	Creating the index 03/13/2025, 19:31:46
2025-03-13 19:31:46,073 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:46
2025-03-13 19:31:46,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:31:46,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:46
2025-03-13 19:31:46,075 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:31:46,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.57it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.30it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.81it/s] 41%|████      | 7/17 [00:00<00:00, 11.70it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.38it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.51it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.39it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.83it/s]100%|██████████| 17/17 [00:04<00:00,  2.06it/s]100%|██████████| 17/17 [00:04<00:00,  4.24it/s]
2025-03-13 19:31:50,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:50
2025-03-13 19:32:25,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2790 secs
2025-03-13 19:32:25,367 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 19:32:25,367 [INFO]: 	Compute fast metrics 03/13/2025, 19:32:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 19:32:43,983 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6159 secs
2025-03-13 19:32:43,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9117 secs
2025-03-13 19:32:43,986 [INFO]: {
2025-03-13 19:32:43,986 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:43,986 [INFO]: 	index_param: efSearch=250
2025-03-13 19:32:43,986 [INFO]: 	index_path: knn.index
2025-03-13 19:32:43,986 [INFO]: 	size in bytes: 824947570
2025-03-13 19:32:43,986 [INFO]: 	avg_search_speed_ms: 9.700222654497589
2025-03-13 19:32:43,986 [INFO]: 	99p_search_speed_ms: 13.956107920967048
2025-03-13 19:32:43,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:43,986 [INFO]: 	nb vectors: 4193
2025-03-13 19:32:43,986 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:43,986 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-13 19:32:43,986 [INFO]: }
2025-03-13 19:32:43,986 [INFO]: 	>>> Finished "Creating the index" in 57.9133 secs
2025-03-13 19:32:43,986 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9403 secs
2025-03-13 19:32:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 36417 [episode count 11/20]
[retrieval_preprocessing] for episode 65254 [episode count 12/20], we have num_retrieval=np.int64(4304) num_query=np.int64(172)
2025-03-13 19:32:48,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:49,984 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:49
2025-03-13 19:32:49,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2366.99it/s]
2025-03-13 19:32:50,006 [INFO]: There are 4304 embeddings of dim 49152
2025-03-13 19:32:50,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 19:32:50,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:50,007 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:32:50,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:50,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:32:50,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,007 [INFO]: 888.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:50,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:32:50,007 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:50
2025-03-13 19:32:50,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:50,007 [INFO]: 	Creating the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:50
2025-03-13 19:32:50,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:32:50,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,008 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:32:50,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.87it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.64it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.09it/s] 41%|████      | 7/17 [00:00<00:00, 11.82it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.33it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.57it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.90it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.53it/s]100%|██████████| 17/17 [00:04<00:00,  1.99it/s]100%|██████████| 17/17 [00:04<00:00,  4.16it/s]
2025-03-13 19:32:54,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:54
2025-03-13 19:33:36,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4335 secs
2025-03-13 19:33:36,535 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:33:36,535 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-13 19:34:00,289 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7541 secs
2025-03-13 19:34:00,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2833 secs
2025-03-13 19:34:00,292 [INFO]: {
2025-03-13 19:34:00,292 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:00,292 [INFO]: 	index_param: efSearch=257
2025-03-13 19:34:00,292 [INFO]: 	index_path: knn.index
2025-03-13 19:34:00,292 [INFO]: 	size in bytes: 846786310
2025-03-13 19:34:00,292 [INFO]: 	avg_search_speed_ms: 11.01901285254934
2025-03-13 19:34:00,292 [INFO]: 	99p_search_speed_ms: 19.63335699168964
2025-03-13 19:34:00,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:00,292 [INFO]: 	nb vectors: 4304
2025-03-13 19:34:00,292 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:00,292 [INFO]: 	compression ratio: 0.9993085882552825
2025-03-13 19:34:00,292 [INFO]: }
2025-03-13 19:34:00,292 [INFO]: 	>>> Finished "Creating the index" in 70.2847 secs
2025-03-13 19:34:00,292 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3075 secs
2025-03-13 19:34:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 65254 [episode count 12/20]
[retrieval_preprocessing] for episode 81646 [episode count 13/20], we have num_retrieval=np.int64(4328) num_query=np.int64(148)
2025-03-13 19:34:03,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:03,603 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:03
2025-03-13 19:34:03,603 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1558.06it/s]
2025-03-13 19:34:03,627 [INFO]: There are 4328 embeddings of dim 49152
2025-03-13 19:34:03,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 19:34:03,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:03
2025-03-13 19:34:03,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:03,628 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:34:03,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:03,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:34:03,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:03
2025-03-13 19:34:03,628 [INFO]: 893.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:03,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:34:03,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:03
2025-03-13 19:34:03,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:03,628 [INFO]: 	Creating the index 03/13/2025, 19:34:03
2025-03-13 19:34:03,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:03
2025-03-13 19:34:03,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:34:03,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:03
2025-03-13 19:34:03,629 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:34:03,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.45it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.68it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.69it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.71it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.75it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.78it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.89it/s] 50%|█████     | 9/18 [00:01<00:01,  8.88it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.80it/s] 61%|██████    | 11/18 [00:01<00:00,  8.72it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.69it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.66it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.75it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.72it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.69it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.63it/s]100%|██████████| 18/18 [00:04<00:00,  1.09it/s]100%|██████████| 18/18 [00:04<00:00,  3.78it/s]
2025-03-13 19:34:08,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:08
2025-03-13 19:34:56,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6286 secs
2025-03-13 19:34:56,020 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 19:34:56,020 [INFO]: 	Compute fast metrics 03/13/2025, 19:34:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 19:35:15,264 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2442 secs
2025-03-13 19:35:15,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6375 secs
2025-03-13 19:35:15,267 [INFO]: {
2025-03-13 19:35:15,267 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:15,267 [INFO]: 	index_param: efSearch=219
2025-03-13 19:35:15,267 [INFO]: 	index_path: knn.index
2025-03-13 19:35:15,267 [INFO]: 	size in bytes: 851508130
2025-03-13 19:35:15,267 [INFO]: 	avg_search_speed_ms: 8.51872208999435
2025-03-13 19:35:15,267 [INFO]: 	99p_search_speed_ms: 12.239815387874842
2025-03-13 19:35:15,267 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:15,267 [INFO]: 	nb vectors: 4328
2025-03-13 19:35:15,267 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:15,267 [INFO]: 	compression ratio: 0.9993086313808889
2025-03-13 19:35:15,267 [INFO]: }
2025-03-13 19:35:15,267 [INFO]: 	>>> Finished "Creating the index" in 71.6389 secs
2025-03-13 19:35:15,267 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6637 secs
2025-03-13 19:35:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 81646 [episode count 13/20]
[retrieval_preprocessing] for episode 59757 [episode count 14/20], we have num_retrieval=np.int64(4304) num_query=np.int64(172)
2025-03-13 19:35:17,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:35:18,782 [INFO]: Launching the whole pipeline 03/13/2025, 19:35:18
2025-03-13 19:35:18,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:35:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1545.43it/s]
2025-03-13 19:35:18,807 [INFO]: There are 4304 embeddings of dim 49152
2025-03-13 19:35:18,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 19:35:18,807 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:35:18
2025-03-13 19:35:18,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:35:18,807 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:35:18,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:35:18,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:35:18,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:35:18
2025-03-13 19:35:18,807 [INFO]: 888.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:35:18,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:35:18,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:35:18
2025-03-13 19:35:18,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:35:18,807 [INFO]: 	Creating the index 03/13/2025, 19:35:18
2025-03-13 19:35:18,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:35:18
2025-03-13 19:35:18,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:35:18,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:35:18
2025-03-13 19:35:18,809 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:35:18,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.32it/s] 18%|█▊        | 3/17 [00:00<00:01, 12.25it/s] 29%|██▉       | 5/17 [00:00<00:00, 13.01it/s] 41%|████      | 7/17 [00:00<00:00, 13.36it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.96it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.93it/s] 76%|███████▋  | 13/17 [00:00<00:00, 13.90it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.76it/s]100%|██████████| 17/17 [00:04<00:00,  1.79it/s]100%|██████████| 17/17 [00:04<00:00,  3.91it/s]
2025-03-13 19:35:23,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:35:23
2025-03-13 19:36:09,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0858 secs
2025-03-13 19:36:09,255 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 19:36:09,255 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-13 19:36:30,127 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8723 secs
2025-03-13 19:36:30,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3217 secs
2025-03-13 19:36:30,130 [INFO]: {
2025-03-13 19:36:30,130 [INFO]: 	index_key: HNSW15
2025-03-13 19:36:30,130 [INFO]: 	index_param: efSearch=220
2025-03-13 19:36:30,130 [INFO]: 	index_path: knn.index
2025-03-13 19:36:30,130 [INFO]: 	size in bytes: 846786310
2025-03-13 19:36:30,130 [INFO]: 	avg_search_speed_ms: 8.884804803658058
2025-03-13 19:36:30,130 [INFO]: 	99p_search_speed_ms: 12.995209137443453
2025-03-13 19:36:30,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:30,131 [INFO]: 	nb vectors: 4304
2025-03-13 19:36:30,131 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:30,131 [INFO]: 	compression ratio: 0.9993085882552825
2025-03-13 19:36:30,131 [INFO]: }
2025-03-13 19:36:30,131 [INFO]: 	>>> Finished "Creating the index" in 71.3231 secs
2025-03-13 19:36:30,131 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3488 secs
2025-03-13 19:36:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 59757 [episode count 14/20]
[retrieval_preprocessing] for episode 46462 [episode count 15/20], we have num_retrieval=np.int64(4259) num_query=np.int64(217)
2025-03-13 19:36:32,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:33,108 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:33
2025-03-13 19:36:33,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.90it/s]
2025-03-13 19:36:33,134 [INFO]: There are 4259 embeddings of dim 49152
2025-03-13 19:36:33,134 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 19:36:33,134 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:33
2025-03-13 19:36:33,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:33,134 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:36:33,134 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:33,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:36:33,134 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:33
2025-03-13 19:36:33,134 [INFO]: 879.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:33,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:36:33,134 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:33
2025-03-13 19:36:33,134 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:33,134 [INFO]: 	Creating the index 03/13/2025, 19:36:33
2025-03-13 19:36:33,134 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:33
2025-03-13 19:36:33,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:36:33,135 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:33
2025-03-13 19:36:33,136 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:36:33,136 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.58it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.40it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.32it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.80it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.15it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.29it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.73it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.99it/s] 71%|███████   | 12/17 [00:01<00:00, 10.45it/s] 82%|████████▏ | 14/17 [00:01<00:00, 10.85it/s] 94%|█████████▍| 16/17 [00:01<00:00, 11.04it/s]100%|██████████| 17/17 [00:04<00:00,  3.98it/s]
2025-03-13 19:36:37,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:37
2025-03-13 19:37:18,691 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2771 secs
2025-03-13 19:37:18,691 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 19:37:18,691 [INFO]: 	Compute fast metrics 03/13/2025, 19:37:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 19:37:37,830 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1390 secs
2025-03-13 19:37:37,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6976 secs
2025-03-13 19:37:37,833 [INFO]: {
2025-03-13 19:37:37,833 [INFO]: 	index_key: HNSW15
2025-03-13 19:37:37,833 [INFO]: 	index_param: efSearch=242
2025-03-13 19:37:37,833 [INFO]: 	index_path: knn.index
2025-03-13 19:37:37,833 [INFO]: 	size in bytes: 837932710
2025-03-13 19:37:37,833 [INFO]: 	avg_search_speed_ms: 9.212140604711273
2025-03-13 19:37:37,833 [INFO]: 	99p_search_speed_ms: 13.475692656356863
2025-03-13 19:37:37,833 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:37:37,833 [INFO]: 	nb vectors: 4259
2025-03-13 19:37:37,833 [INFO]: 	vectors dimension: 49152
2025-03-13 19:37:37,833 [INFO]: 	compression ratio: 0.9993087296950134
2025-03-13 19:37:37,833 [INFO]: }
2025-03-13 19:37:37,833 [INFO]: 	>>> Finished "Creating the index" in 64.6991 secs
2025-03-13 19:37:37,833 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7253 secs
2025-03-13 19:37:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:37:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 46462 [episode count 15/20]
[retrieval_preprocessing] for episode 47059 [episode count 16/20], we have num_retrieval=np.int64(4255) num_query=np.int64(221)
2025-03-13 19:37:40,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:37:41,412 [INFO]: Launching the whole pipeline 03/13/2025, 19:37:41
2025-03-13 19:37:41,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:37:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-13 19:37:41,435 [INFO]: There are 4255 embeddings of dim 49152
2025-03-13 19:37:41,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 19:37:41,435 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:37:41
2025-03-13 19:37:41,435 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:37:41,435 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:37:41,435 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:37:41,435 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:37:41,435 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:37:41
2025-03-13 19:37:41,435 [INFO]: 878.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:37:41,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:37:41,435 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:37:41
2025-03-13 19:37:41,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:37:41,435 [INFO]: 	Creating the index 03/13/2025, 19:37:41
2025-03-13 19:37:41,435 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:37:41
2025-03-13 19:37:41,436 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:37:41,436 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:37:41
2025-03-13 19:37:41,436 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:37:41,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.75it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.45it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.42it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.41it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.51it/s] 41%|████      | 7/17 [00:00<00:01,  8.55it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.63it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.69it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.76it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.87it/s] 71%|███████   | 12/17 [00:01<00:00,  9.04it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.07it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.09it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.31it/s]100%|██████████| 17/17 [00:04<00:00,  1.45it/s]100%|██████████| 17/17 [00:04<00:00,  3.82it/s]
2025-03-13 19:37:45,900 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:37:45
2025-03-13 19:38:28,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5993 secs
2025-03-13 19:38:28,500 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 19:38:28,500 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 50%|█████     | 2/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 19:38:48,674 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1735 secs
2025-03-13 19:38:48,677 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2403 secs
2025-03-13 19:38:48,677 [INFO]: {
2025-03-13 19:38:48,677 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:48,677 [INFO]: 	index_param: efSearch=251
2025-03-13 19:38:48,677 [INFO]: 	index_path: knn.index
2025-03-13 19:38:48,677 [INFO]: 	size in bytes: 837145750
2025-03-13 19:38:48,677 [INFO]: 	avg_search_speed_ms: 9.985395268975319
2025-03-13 19:38:48,677 [INFO]: 	99p_search_speed_ms: 13.148640980944037
2025-03-13 19:38:48,677 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:48,677 [INFO]: 	nb vectors: 4255
2025-03-13 19:38:48,677 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:48,677 [INFO]: 	compression ratio: 0.9993087105799677
2025-03-13 19:38:48,677 [INFO]: }
2025-03-13 19:38:48,677 [INFO]: 	>>> Finished "Creating the index" in 67.2418 secs
2025-03-13 19:38:48,677 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2651 secs
2025-03-13 19:38:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 47059 [episode count 16/20]
[retrieval_preprocessing] for episode 49784 [episode count 17/20], we have num_retrieval=np.int64(4273) num_query=np.int64(203)
2025-03-13 19:38:51,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:52,471 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:52
2025-03-13 19:38:52,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.09it/s]
2025-03-13 19:38:52,496 [INFO]: There are 4273 embeddings of dim 49152
2025-03-13 19:38:52,496 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 19:38:52,496 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:52
2025-03-13 19:38:52,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:52,496 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:38:52,496 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:38:52,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:38:52,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:52
2025-03-13 19:38:52,496 [INFO]: 881.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:52,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:38:52,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:52
2025-03-13 19:38:52,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:52,497 [INFO]: 	Creating the index 03/13/2025, 19:38:52
2025-03-13 19:38:52,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:52
2025-03-13 19:38:52,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:38:52,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:52
2025-03-13 19:38:52,498 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:38:52,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.47it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.57it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.91it/s] 41%|████      | 7/17 [00:00<00:00, 12.56it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.02it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.08it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.14it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.11it/s]100%|██████████| 17/17 [00:04<00:00,  1.94it/s]100%|██████████| 17/17 [00:04<00:00,  4.10it/s]
2025-03-13 19:38:56,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:56
2025-03-13 19:39:41,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6441 secs
2025-03-13 19:39:41,295 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 19:39:41,295 [INFO]: 	Compute fast metrics 03/13/2025, 19:39:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s]
2025-03-13 19:40:01,314 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0192 secs
2025-03-13 19:40:01,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8188 secs
2025-03-13 19:40:01,317 [INFO]: {
2025-03-13 19:40:01,317 [INFO]: 	index_key: HNSW15
2025-03-13 19:40:01,317 [INFO]: 	index_param: efSearch=238
2025-03-13 19:40:01,317 [INFO]: 	index_path: knn.index
2025-03-13 19:40:01,317 [INFO]: 	size in bytes: 840687130
2025-03-13 19:40:01,317 [INFO]: 	avg_search_speed_ms: 9.51764881690622
2025-03-13 19:40:01,317 [INFO]: 	99p_search_speed_ms: 13.875341974198818
2025-03-13 19:40:01,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:40:01,317 [INFO]: 	nb vectors: 4273
2025-03-13 19:40:01,317 [INFO]: 	vectors dimension: 49152
2025-03-13 19:40:01,317 [INFO]: 	compression ratio: 0.9993087249949931
2025-03-13 19:40:01,317 [INFO]: }
2025-03-13 19:40:01,317 [INFO]: 	>>> Finished "Creating the index" in 68.8201 secs
2025-03-13 19:40:01,317 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8456 secs
2025-03-13 19:40:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:40:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 49784 [episode count 17/20]
[retrieval_preprocessing] for episode 68404 [episode count 18/20], we have num_retrieval=np.int64(4221) num_query=np.int64(255)
2025-03-13 19:40:04,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:40:05,348 [INFO]: Launching the whole pipeline 03/13/2025, 19:40:05
2025-03-13 19:40:05,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:40:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.82it/s]
2025-03-13 19:40:05,372 [INFO]: There are 4221 embeddings of dim 49152
2025-03-13 19:40:05,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:40:05,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:40:05
2025-03-13 19:40:05,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:40:05,372 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:40:05,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:40:05,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:40:05,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:40:05
2025-03-13 19:40:05,372 [INFO]: 871.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:40:05,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:40:05,372 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:40:05
2025-03-13 19:40:05,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:40:05,372 [INFO]: 	Creating the index 03/13/2025, 19:40:05
2025-03-13 19:40:05,372 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:40:05
2025-03-13 19:40:05,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:40:05,373 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:40:05
2025-03-13 19:40:05,373 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:40:05,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.53it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.20it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.98it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.44it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.73it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.00it/s] 41%|████      | 7/17 [00:00<00:01,  9.00it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.99it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.05it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.10it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.17it/s] 71%|███████   | 12/17 [00:01<00:00,  9.32it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.39it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.54it/s] 94%|█████████▍| 16/17 [00:01<00:00, 11.29it/s]100%|██████████| 17/17 [00:04<00:00,  3.94it/s]
2025-03-13 19:40:09,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:40:09
2025-03-13 19:40:48,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1483 secs
2025-03-13 19:40:48,841 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 19:40:48,841 [INFO]: 	Compute fast metrics 03/13/2025, 19:40:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s]
2025-03-13 19:41:04,901 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0596 secs
2025-03-13 19:41:04,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5303 secs
2025-03-13 19:41:04,904 [INFO]: {
2025-03-13 19:41:04,904 [INFO]: 	index_key: HNSW15
2025-03-13 19:41:04,904 [INFO]: 	index_param: efSearch=270
2025-03-13 19:41:04,904 [INFO]: 	index_path: knn.index
2025-03-13 19:41:04,904 [INFO]: 	size in bytes: 830456410
2025-03-13 19:41:04,904 [INFO]: 	avg_search_speed_ms: 9.517295480786435
2025-03-13 19:41:04,904 [INFO]: 	99p_search_speed_ms: 13.258741470053792
2025-03-13 19:41:04,904 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:41:04,904 [INFO]: 	nb vectors: 4221
2025-03-13 19:41:04,904 [INFO]: 	vectors dimension: 49152
2025-03-13 19:41:04,904 [INFO]: 	compression ratio: 0.9993087632377959
2025-03-13 19:41:04,904 [INFO]: }
2025-03-13 19:41:04,904 [INFO]: 	>>> Finished "Creating the index" in 59.5317 secs
2025-03-13 19:41:04,904 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5563 secs
2025-03-13 19:41:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:41:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 68404 [episode count 18/20]
[retrieval_preprocessing] for episode 6067 [episode count 19/20], we have num_retrieval=np.int64(4264) num_query=np.int64(212)
2025-03-13 19:41:08,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:41:08,933 [INFO]: Launching the whole pipeline 03/13/2025, 19:41:08
2025-03-13 19:41:08,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:41:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2253.79it/s]
2025-03-13 19:41:08,958 [INFO]: There are 4264 embeddings of dim 49152
2025-03-13 19:41:08,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 19:41:08,959 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:41:08
2025-03-13 19:41:08,959 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:41:08,959 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:41:08,959 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:41:08,959 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:41:08,959 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:41:08
2025-03-13 19:41:08,959 [INFO]: 880.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:41:08,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:41:08,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:41:08
2025-03-13 19:41:08,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:41:08,959 [INFO]: 	Creating the index 03/13/2025, 19:41:08
2025-03-13 19:41:08,959 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:41:08
2025-03-13 19:41:08,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:41:08,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:41:08
2025-03-13 19:41:08,960 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:41:08,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.44it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.51it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.47it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.60it/s] 41%|████      | 7/17 [00:00<00:01,  9.53it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.46it/s] 53%|█████▎    | 9/17 [00:00<00:00,  9.40it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.47it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.33it/s] 71%|███████   | 12/17 [00:01<00:00,  9.31it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.26it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.99it/s]100%|██████████| 17/17 [00:04<00:00,  1.57it/s]100%|██████████| 17/17 [00:04<00:00,  3.77it/s]
2025-03-13 19:41:13,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:41:13
2025-03-13 19:41:55,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7283 secs
2025-03-13 19:41:55,208 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 19:41:55,208 [INFO]: 	Compute fast metrics 03/13/2025, 19:41:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-13 19:42:14,431 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2235 secs
2025-03-13 19:42:14,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4740 secs
2025-03-13 19:42:14,434 [INFO]: {
2025-03-13 19:42:14,434 [INFO]: 	index_key: HNSW15
2025-03-13 19:42:14,434 [INFO]: 	index_param: efSearch=254
2025-03-13 19:42:14,434 [INFO]: 	index_path: knn.index
2025-03-13 19:42:14,434 [INFO]: 	size in bytes: 838916410
2025-03-13 19:42:14,434 [INFO]: 	avg_search_speed_ms: 9.365287363051335
2025-03-13 19:42:14,434 [INFO]: 	99p_search_speed_ms: 13.437365239951733
2025-03-13 19:42:14,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:42:14,434 [INFO]: 	nb vectors: 4264
2025-03-13 19:42:14,434 [INFO]: 	vectors dimension: 49152
2025-03-13 19:42:14,434 [INFO]: 	compression ratio: 0.9993087535383889
2025-03-13 19:42:14,434 [INFO]: }
2025-03-13 19:42:14,434 [INFO]: 	>>> Finished "Creating the index" in 65.4753 secs
2025-03-13 19:42:14,434 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5016 secs
2025-03-13 19:42:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 6067 [episode count 19/20]
2025-03-13 19:42:16: [retrieval_preprocessing] finished for 446878712_put_pen_in_cup [chosen_id count 9/196]
2025-03-13 19:42:16: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
