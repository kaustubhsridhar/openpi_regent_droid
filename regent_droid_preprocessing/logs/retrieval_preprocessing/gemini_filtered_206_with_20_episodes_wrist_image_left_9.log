2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 452818143_lid_on_pot [chosen_id count 0/196]
2025-03-13 14:35:02: [retrieval_preprocessing] we have num_total=5476 embedding_dim=49152
[retrieval_preprocessing] for episode 24582 [episode count 0/20], we have num_retrieval=np.int64(5148) num_query=np.int64(328)
2025-03-13 14:35:02,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:03,488 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:03
2025-03-13 14:35:03,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2514.57it/s]
2025-03-13 14:35:03,553 [INFO]: There are 5148 embeddings of dim 49152
2025-03-13 14:35:03,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0659 secs
2025-03-13 14:35:03,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:03,554 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 14:35:03,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:03,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 14:35:03,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,556 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:03,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0017 secs
2025-03-13 14:35:03,557 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:03
2025-03-13 14:35:03,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:03,558 [INFO]: 	Creating the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:03
2025-03-13 14:35:03,561 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:35:03,561 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,562 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 14:35:03,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.02it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.82it/s] 50%|█████     | 11/22 [00:00<00:00, 34.77it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.17it/s] 91%|█████████ | 20/22 [00:00<00:00, 36.73it/s]100%|██████████| 22/22 [00:09<00:00,  2.40it/s]
2025-03-13 14:35:12,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:12
2025-03-13 14:36:09,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9414 secs
2025-03-13 14:36:09,667 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 14:36:09,667 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 14:36:34,805 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1378 secs
2025-03-13 14:36:34,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2449 secs
2025-03-13 14:36:34,806 [INFO]: {
2025-03-13 14:36:34,806 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:34,806 [INFO]: 	index_param: efSearch=140
2025-03-13 14:36:34,807 [INFO]: 	index_path: knn.index
2025-03-13 14:36:34,807 [INFO]: 	size in bytes: 1012838410
2025-03-13 14:36:34,807 [INFO]: 	avg_search_speed_ms: 8.751440311522138
2025-03-13 14:36:34,807 [INFO]: 	99p_search_speed_ms: 13.205864406190807
2025-03-13 14:36:34,807 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:34,807 [INFO]: 	nb vectors: 5148
2025-03-13 14:36:34,807 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:34,807 [INFO]: 	compression ratio: 0.999308452371983
2025-03-13 14:36:34,807 [INFO]: }
2025-03-13 14:36:34,807 [INFO]: 	>>> Finished "Creating the index" in 91.2491 secs
2025-03-13 14:36:34,807 [INFO]: >>> Finished "Launching the whole pipeline" in 91.3191 secs
2025-03-13 14:36:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 24582 [episode count 0/20]
[retrieval_preprocessing] for episode 25607 [episode count 1/20], we have num_retrieval=np.int64(5256) num_query=np.int64(220)
2025-03-13 14:36:38,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:40,049 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:40
2025-03-13 14:36:40,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.74it/s]
2025-03-13 14:36:40,078 [INFO]: There are 5256 embeddings of dim 49152
2025-03-13 14:36:40,079 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 14:36:40,079 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:40
2025-03-13 14:36:40,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:40,079 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:36:40,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:40,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:36:40,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:40
2025-03-13 14:36:40,079 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:40,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:40,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:40
2025-03-13 14:36:40,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:40,079 [INFO]: 	Creating the index 03/13/2025, 14:36:40
2025-03-13 14:36:40,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:40
2025-03-13 14:36:40,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:36:40,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:40
2025-03-13 14:36:40,080 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:36:40,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.46it/s] 23%|██▎       | 5/22 [00:00<00:00, 21.44it/s] 41%|████      | 9/22 [00:00<00:00, 27.86it/s] 55%|█████▍    | 12/22 [00:00<00:00, 21.60it/s] 68%|██████▊   | 15/22 [00:00<00:00, 23.60it/s] 86%|████████▋ | 19/22 [00:00<00:00, 27.31it/s]100%|██████████| 22/22 [00:06<00:00,  1.81it/s]100%|██████████| 22/22 [00:06<00:00,  3.61it/s]
2025-03-13 14:36:46,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:46
2025-03-13 14:37:48,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.5741 secs
2025-03-13 14:37:48,753 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 14:37:48,753 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.02it/s]
2025-03-13 14:38:11,111 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3581 secs
2025-03-13 14:38:11,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.0317 secs
2025-03-13 14:38:11,112 [INFO]: {
2025-03-13 14:38:11,112 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:11,112 [INFO]: 	index_param: efSearch=148
2025-03-13 14:38:11,112 [INFO]: 	index_path: knn.index
2025-03-13 14:38:11,112 [INFO]: 	size in bytes: 1034086990
2025-03-13 14:38:11,112 [INFO]: 	avg_search_speed_ms: 8.796087274919268
2025-03-13 14:38:11,112 [INFO]: 	99p_search_speed_ms: 12.443315517157318
2025-03-13 14:38:11,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:11,112 [INFO]: 	nb vectors: 5256
2025-03-13 14:38:11,112 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:11,112 [INFO]: 	compression ratio: 0.9993082380815951
2025-03-13 14:38:11,112 [INFO]: }
2025-03-13 14:38:11,112 [INFO]: 	>>> Finished "Creating the index" in 91.0332 secs
2025-03-13 14:38:11,112 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0638 secs
2025-03-13 14:38:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 25607 [episode count 1/20]
[retrieval_preprocessing] for episode 36876 [episode count 2/20], we have num_retrieval=np.int64(5294) num_query=np.int64(182)
2025-03-13 14:38:13,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:14,191 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:14
2025-03-13 14:38:14,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 960.23it/s]
2025-03-13 14:38:14,223 [INFO]: There are 5294 embeddings of dim 49152
2025-03-13 14:38:14,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 14:38:14,224 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:14
2025-03-13 14:38:14,224 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:14,224 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:38:14,224 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:14,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:14,224 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:14
2025-03-13 14:38:14,224 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:14,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:14,224 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:14
2025-03-13 14:38:14,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:14,224 [INFO]: 	Creating the index 03/13/2025, 14:38:14
2025-03-13 14:38:14,224 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:14
2025-03-13 14:38:14,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:38:14,225 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:14
2025-03-13 14:38:14,225 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:38:14,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.00it/s] 18%|█▊        | 4/22 [00:00<00:01, 17.94it/s] 36%|███▋      | 8/22 [00:00<00:00, 25.65it/s] 59%|█████▉    | 13/22 [00:00<00:00, 32.28it/s] 82%|████████▏ | 18/22 [00:00<00:00, 35.76it/s]100%|██████████| 22/22 [00:06<00:00,  2.00it/s]100%|██████████| 22/22 [00:06<00:00,  3.39it/s]
2025-03-13 14:38:20,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:20
2025-03-13 14:39:24,771 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.0526 secs
2025-03-13 14:39:24,772 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 14:39:24,772 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 14:39:51,595 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8232 secs
2025-03-13 14:39:51,596 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.3706 secs
2025-03-13 14:39:51,596 [INFO]: {
2025-03-13 14:39:51,596 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:51,596 [INFO]: 	index_param: efSearch=169
2025-03-13 14:39:51,596 [INFO]: 	index_path: knn.index
2025-03-13 14:39:51,596 [INFO]: 	size in bytes: 1041563230
2025-03-13 14:39:51,596 [INFO]: 	avg_search_speed_ms: 10.05931949955964
2025-03-13 14:39:51,596 [INFO]: 	99p_search_speed_ms: 16.13056675996625
2025-03-13 14:39:51,596 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:51,596 [INFO]: 	nb vectors: 5294
2025-03-13 14:39:51,596 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:51,596 [INFO]: 	compression ratio: 0.9993082724320059
2025-03-13 14:39:51,596 [INFO]: }
2025-03-13 14:39:51,596 [INFO]: 	>>> Finished "Creating the index" in 97.3722 secs
2025-03-13 14:39:51,596 [INFO]: >>> Finished "Launching the whole pipeline" in 97.4053 secs
2025-03-13 14:39:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 36876 [episode count 2/20]
[retrieval_preprocessing] for episode 46612 [episode count 3/20], we have num_retrieval=np.int64(5192) num_query=np.int64(284)
2025-03-13 14:39:53,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:54,987 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:54
2025-03-13 14:39:54,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 920.01it/s]
2025-03-13 14:39:55,017 [INFO]: There are 5192 embeddings of dim 49152
2025-03-13 14:39:55,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 14:39:55,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:55,018 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:39:55,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:55,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:55,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,018 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:55,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:39:55,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:55
2025-03-13 14:39:55,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:55,018 [INFO]: 	Creating the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:55
2025-03-13 14:39:55,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:39:55,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:55
2025-03-13 14:39:55,020 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:39:55,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.67it/s] 18%|█▊        | 4/22 [00:00<00:00, 19.34it/s] 41%|████      | 9/22 [00:00<00:00, 30.20it/s] 64%|██████▎   | 14/22 [00:00<00:00, 35.32it/s] 86%|████████▋ | 19/22 [00:00<00:00, 38.14it/s]100%|██████████| 22/22 [00:07<00:00,  3.08it/s]
2025-03-13 14:40:02,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:02
2025-03-13 14:41:06,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1034 secs
2025-03-13 14:41:06,282 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 14:41:06,282 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:06<00:06,  3.17s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.86s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.08s/it]
2025-03-13 14:41:48,404 [INFO]: 	>>> Finished "Compute fast metrics" in 42.1216 secs
2025-03-13 14:41:48,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.3852 secs
2025-03-13 14:41:48,405 [INFO]: {
2025-03-13 14:41:48,405 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:48,405 [INFO]: 	index_param: efSearch=190
2025-03-13 14:41:48,405 [INFO]: 	index_path: knn.index
2025-03-13 14:41:48,405 [INFO]: 	size in bytes: 1021495270
2025-03-13 14:41:48,405 [INFO]: 	avg_search_speed_ms: 10.34487953824651
2025-03-13 14:41:48,405 [INFO]: 	99p_search_speed_ms: 14.562295898795128
2025-03-13 14:41:48,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:48,405 [INFO]: 	nb vectors: 5192
2025-03-13 14:41:48,405 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:48,405 [INFO]: 	compression ratio: 0.9993083335569435
2025-03-13 14:41:48,405 [INFO]: }
2025-03-13 14:41:48,405 [INFO]: 	>>> Finished "Creating the index" in 113.3871 secs
2025-03-13 14:41:48,405 [INFO]: >>> Finished "Launching the whole pipeline" in 113.4180 secs
2025-03-13 14:41:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 46612 [episode count 3/20]
[retrieval_preprocessing] for episode 51233 [episode count 4/20], we have num_retrieval=np.int64(5227) num_query=np.int64(249)
2025-03-13 14:41:51,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:52,838 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:52
2025-03-13 14:41:52,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1107.55it/s]
2025-03-13 14:41:52,867 [INFO]: There are 5227 embeddings of dim 49152
2025-03-13 14:41:52,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 14:41:52,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:52
2025-03-13 14:41:52,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:52,867 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:41:52,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:52,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:52,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:52
2025-03-13 14:41:52,867 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:52,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:41:52,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:52
2025-03-13 14:41:52,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:52,868 [INFO]: 	Creating the index 03/13/2025, 14:41:52
2025-03-13 14:41:52,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:52
2025-03-13 14:41:52,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:41:52,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:52
2025-03-13 14:41:52,869 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:41:52,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.18it/s] 23%|██▎       | 5/22 [00:00<00:00, 24.34it/s] 45%|████▌     | 10/22 [00:00<00:00, 32.36it/s] 64%|██████▎   | 14/22 [00:00<00:00, 34.89it/s] 82%|████████▏ | 18/22 [00:00<00:00, 34.84it/s]100%|██████████| 22/22 [00:06<00:00,  1.78it/s]100%|██████████| 22/22 [00:06<00:00,  3.21it/s]
2025-03-13 14:41:59,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:59
2025-03-13 14:42:55,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2570 secs
2025-03-13 14:42:55,982 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 14:42:55,982 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 14:43:16,232 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2499 secs
2025-03-13 14:43:16,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3640 secs
2025-03-13 14:43:16,233 [INFO]: {
2025-03-13 14:43:16,233 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:16,233 [INFO]: 	index_param: efSearch=183
2025-03-13 14:43:16,233 [INFO]: 	index_path: knn.index
2025-03-13 14:43:16,233 [INFO]: 	size in bytes: 1028381350
2025-03-13 14:43:16,233 [INFO]: 	avg_search_speed_ms: 10.998162138019945
2025-03-13 14:43:16,233 [INFO]: 	99p_search_speed_ms: 15.847531282342969
2025-03-13 14:43:16,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:16,233 [INFO]: 	nb vectors: 5227
2025-03-13 14:43:16,233 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:16,233 [INFO]: 	compression ratio: 0.9993082974521076
2025-03-13 14:43:16,233 [INFO]: }
2025-03-13 14:43:16,233 [INFO]: 	>>> Finished "Creating the index" in 83.3655 secs
2025-03-13 14:43:16,233 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3953 secs
2025-03-13 14:43:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 51233 [episode count 4/20]
[retrieval_preprocessing] for episode 58922 [episode count 5/20], we have num_retrieval=np.int64(5272) num_query=np.int64(204)
2025-03-13 14:43:21,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:21,947 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:21
2025-03-13 14:43:21,947 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.96it/s]
2025-03-13 14:43:21,972 [INFO]: There are 5272 embeddings of dim 49152
2025-03-13 14:43:21,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 14:43:21,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:21
2025-03-13 14:43:21,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:21,973 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:43:21,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:21,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:21,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:21
2025-03-13 14:43:21,973 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:21,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:21,973 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:21
2025-03-13 14:43:21,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:21,973 [INFO]: 	Creating the index 03/13/2025, 14:43:21
2025-03-13 14:43:21,973 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:21
2025-03-13 14:43:21,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:43:21,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:21
2025-03-13 14:43:21,975 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:43:21,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.85it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.28it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.44it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.88it/s] 41%|████      | 9/22 [00:00<00:01, 10.08it/s] 50%|█████     | 11/22 [00:01<00:01, 10.49it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.77it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.81it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.67it/s] 86%|████████▋ | 19/22 [00:01<00:00, 10.87it/s] 95%|█████████▌| 21/22 [00:07<00:00,  1.17it/s]100%|██████████| 22/22 [00:07<00:00,  1.16it/s]100%|██████████| 22/22 [00:07<00:00,  2.78it/s]
2025-03-13 14:43:29,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:29
2025-03-13 14:44:25,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.2461 secs
2025-03-13 14:44:25,133 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 14:44:25,133 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.93it/s] 50%|█████     | 2/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 14:44:51,355 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2220 secs
2025-03-13 14:44:51,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.3814 secs
2025-03-13 14:44:51,356 [INFO]: {
2025-03-13 14:44:51,356 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:51,356 [INFO]: 	index_param: efSearch=210
2025-03-13 14:44:51,356 [INFO]: 	index_path: knn.index
2025-03-13 14:44:51,356 [INFO]: 	size in bytes: 1037234890
2025-03-13 14:44:51,356 [INFO]: 	avg_search_speed_ms: 12.259436406334405
2025-03-13 14:44:51,356 [INFO]: 	99p_search_speed_ms: 17.508448311127726
2025-03-13 14:44:51,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:51,356 [INFO]: 	nb vectors: 5272
2025-03-13 14:44:51,356 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:51,356 [INFO]: 	compression ratio: 0.9993082434780033
2025-03-13 14:44:51,356 [INFO]: }
2025-03-13 14:44:51,356 [INFO]: 	>>> Finished "Creating the index" in 89.3832 secs
2025-03-13 14:44:51,356 [INFO]: >>> Finished "Launching the whole pipeline" in 89.4097 secs
2025-03-13 14:44:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 58922 [episode count 5/20]
[retrieval_preprocessing] for episode 80943 [episode count 6/20], we have num_retrieval=np.int64(5112) num_query=np.int64(364)
2025-03-13 14:44:54,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:55,784 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:55
2025-03-13 14:44:55,784 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 862.49it/s]
2025-03-13 14:44:55,819 [INFO]: There are 5112 embeddings of dim 49152
2025-03-13 14:44:55,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 14:44:55,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:55
2025-03-13 14:44:55,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:55,821 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 14:44:55,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:55,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:44:55,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:55
2025-03-13 14:44:55,822 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:55,822 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:55,822 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:55
2025-03-13 14:44:55,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:44:55,823 [INFO]: 	Creating the index 03/13/2025, 14:44:55
2025-03-13 14:44:55,823 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:55
2025-03-13 14:44:55,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:44:55,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:55
2025-03-13 14:44:55,827 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 14:44:55,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.81it/s] 23%|██▎       | 5/22 [00:00<00:00, 26.96it/s] 45%|████▌     | 10/22 [00:00<00:00, 34.93it/s] 68%|██████▊   | 15/22 [00:00<00:00, 38.38it/s] 91%|█████████ | 20/22 [00:00<00:00, 40.41it/s]100%|██████████| 22/22 [00:06<00:00,  3.64it/s]
2025-03-13 14:45:01,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:01
2025-03-13 14:45:55,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5903 secs
2025-03-13 14:45:55,474 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 14:45:55,474 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.30it/s]
2025-03-13 14:46:23,855 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3803 secs
2025-03-13 14:46:24,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.3274 secs
2025-03-13 14:46:24,154 [INFO]: {
2025-03-13 14:46:24,155 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:24,155 [INFO]: 	index_param: efSearch=224
2025-03-13 14:46:24,155 [INFO]: 	index_path: knn.index
2025-03-13 14:46:24,155 [INFO]: 	size in bytes: 1005755650
2025-03-13 14:46:24,155 [INFO]: 	avg_search_speed_ms: 12.179161854192541
2025-03-13 14:46:24,155 [INFO]: 	99p_search_speed_ms: 20.328017864376303
2025-03-13 14:46:24,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:24,155 [INFO]: 	nb vectors: 5112
2025-03-13 14:46:24,155 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:24,155 [INFO]: 	compression ratio: 0.9993084264552727
2025-03-13 14:46:24,155 [INFO]: }
2025-03-13 14:46:24,155 [INFO]: 	>>> Finished "Creating the index" in 88.3323 secs
2025-03-13 14:46:24,155 [INFO]: >>> Finished "Launching the whole pipeline" in 88.3709 secs
2025-03-13 14:46:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 80943 [episode count 6/20]
[retrieval_preprocessing] for episode 21051 [episode count 7/20], we have num_retrieval=np.int64(5255) num_query=np.int64(221)
2025-03-13 14:46:29,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:30,729 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:30
2025-03-13 14:46:30,730 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1105.51it/s]
2025-03-13 14:46:30,760 [INFO]: There are 5255 embeddings of dim 49152
2025-03-13 14:46:30,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:46:30,761 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:30,761 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:46:30,761 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:30,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:46:30,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,761 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:30,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:46:30,761 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:30
2025-03-13 14:46:30,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:30,761 [INFO]: 	Creating the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,761 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:30
2025-03-13 14:46:30,763 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:46:30,763 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:30
2025-03-13 14:46:30,763 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:46:30,763 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.53it/s] 27%|██▋       | 6/22 [00:00<00:00, 23.57it/s] 50%|█████     | 11/22 [00:00<00:00, 31.55it/s] 73%|███████▎  | 16/22 [00:00<00:00, 36.09it/s] 91%|█████████ | 20/22 [00:00<00:00, 37.25it/s]100%|██████████| 22/22 [00:07<00:00,  2.83it/s]
2025-03-13 14:46:38,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:38
2025-03-13 14:47:42,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.8029 secs
2025-03-13 14:47:42,349 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 14:47:42,350 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-13 14:48:12,005 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6548 secs
2025-03-13 14:48:12,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.2422 secs
2025-03-13 14:48:12,005 [INFO]: {
2025-03-13 14:48:12,005 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:12,005 [INFO]: 	index_param: efSearch=172
2025-03-13 14:48:12,005 [INFO]: 	index_path: knn.index
2025-03-13 14:48:12,005 [INFO]: 	size in bytes: 1033890250
2025-03-13 14:48:12,005 [INFO]: 	avg_search_speed_ms: 9.19210804717937
2025-03-13 14:48:12,005 [INFO]: 	99p_search_speed_ms: 13.294278867542742
2025-03-13 14:48:12,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:12,005 [INFO]: 	nb vectors: 5255
2025-03-13 14:48:12,005 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:12,005 [INFO]: 	compression ratio: 0.9993082341186601
2025-03-13 14:48:12,005 [INFO]: }
2025-03-13 14:48:12,005 [INFO]: 	>>> Finished "Creating the index" in 101.2440 secs
2025-03-13 14:48:12,005 [INFO]: >>> Finished "Launching the whole pipeline" in 101.2758 secs
2025-03-13 14:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 21051 [episode count 7/20]
[retrieval_preprocessing] for episode 67648 [episode count 8/20], we have num_retrieval=np.int64(5256) num_query=np.int64(220)
2025-03-13 14:48:15,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:16,090 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:16
2025-03-13 14:48:16,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.31it/s]
2025-03-13 14:48:16,274 [INFO]: There are 5256 embeddings of dim 49152
2025-03-13 14:48:16,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1850 secs
2025-03-13 14:48:16,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:16,276 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:48:16,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:16,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:48:16,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,276 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:16,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:48:16,277 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:16
2025-03-13 14:48:16,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:16,277 [INFO]: 	Creating the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,277 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:16
2025-03-13 14:48:16,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 14:48:16,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:16
2025-03-13 14:48:16,281 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:48:16,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.59it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.91it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.82it/s] 77%|███████▋  | 17/22 [00:00<00:00, 43.71it/s]100%|██████████| 22/22 [00:07<00:00,  1.86it/s]100%|██████████| 22/22 [00:07<00:00,  3.01it/s]
2025-03-13 14:48:23,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:23
2025-03-13 14:49:10,234 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6405 secs
2025-03-13 14:49:10,235 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 14:49:10,235 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-13 14:49:47,628 [INFO]: 	>>> Finished "Compute fast metrics" in 37.3934 secs
2025-03-13 14:49:48,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.2007 secs
2025-03-13 14:49:48,482 [INFO]: {
2025-03-13 14:49:48,482 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:48,482 [INFO]: 	index_param: efSearch=259
2025-03-13 14:49:48,482 [INFO]: 	index_path: knn.index
2025-03-13 14:49:48,482 [INFO]: 	size in bytes: 1034086990
2025-03-13 14:49:48,482 [INFO]: 	avg_search_speed_ms: 12.04440220136971
2025-03-13 14:49:48,482 [INFO]: 	99p_search_speed_ms: 20.418098405934884
2025-03-13 14:49:48,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:48,482 [INFO]: 	nb vectors: 5256
2025-03-13 14:49:48,482 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:48,482 [INFO]: 	compression ratio: 0.9993082380815951
2025-03-13 14:49:48,482 [INFO]: }
2025-03-13 14:49:48,482 [INFO]: 	>>> Finished "Creating the index" in 92.2054 secs
2025-03-13 14:49:48,482 [INFO]: >>> Finished "Launching the whole pipeline" in 92.3927 secs
2025-03-13 14:49:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 67648 [episode count 8/20]
[retrieval_preprocessing] for episode 90181 [episode count 9/20], we have num_retrieval=np.int64(5202) num_query=np.int64(274)
2025-03-13 14:49:53,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:54,463 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:54
2025-03-13 14:49:54,463 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1248.68it/s]
2025-03-13 14:49:54,494 [INFO]: There are 5202 embeddings of dim 49152
2025-03-13 14:49:54,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 14:49:54,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:54
2025-03-13 14:49:54,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:54,494 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:49:54,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:54,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:54,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:54
2025-03-13 14:49:54,494 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:54,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:49:54,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:54
2025-03-13 14:49:54,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:54,495 [INFO]: 	Creating the index 03/13/2025, 14:49:54
2025-03-13 14:49:54,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:54
2025-03-13 14:49:54,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:49:54,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:54
2025-03-13 14:49:54,496 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:49:54,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.44it/s] 27%|██▋       | 6/22 [00:00<00:00, 25.91it/s] 50%|█████     | 11/22 [00:00<00:00, 34.10it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.48it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.81it/s]100%|██████████| 22/22 [00:05<00:00,  3.97it/s]
2025-03-13 14:50:00,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:00
2025-03-13 14:51:01,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.5504 secs
2025-03-13 14:51:01,587 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 14:51:01,587 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.22it/s]
2025-03-13 14:51:22,765 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1774 secs
2025-03-13 14:51:22,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.2687 secs
2025-03-13 14:51:22,765 [INFO]: {
2025-03-13 14:51:22,765 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:22,765 [INFO]: 	index_param: efSearch=204
2025-03-13 14:51:22,765 [INFO]: 	index_path: knn.index
2025-03-13 14:51:22,765 [INFO]: 	size in bytes: 1023462730
2025-03-13 14:51:22,765 [INFO]: 	avg_search_speed_ms: 10.636503618174924
2025-03-13 14:51:22,765 [INFO]: 	99p_search_speed_ms: 16.885663103312258
2025-03-13 14:51:22,765 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:22,765 [INFO]: 	nb vectors: 5202
2025-03-13 14:51:22,765 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:22,765 [INFO]: 	compression ratio: 0.9993083148225632
2025-03-13 14:51:22,765 [INFO]: }
2025-03-13 14:51:22,765 [INFO]: 	>>> Finished "Creating the index" in 88.2707 secs
2025-03-13 14:51:22,765 [INFO]: >>> Finished "Launching the whole pipeline" in 88.3026 secs
2025-03-13 14:51:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 90181 [episode count 9/20]
[retrieval_preprocessing] for episode 63054 [episode count 10/20], we have num_retrieval=np.int64(5230) num_query=np.int64(246)
2025-03-13 14:51:25,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:26,426 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:26
2025-03-13 14:51:26,426 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2051.00it/s]
2025-03-13 14:51:26,453 [INFO]: There are 5230 embeddings of dim 49152
2025-03-13 14:51:26,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 14:51:26,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:26
2025-03-13 14:51:26,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:26,453 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:51:26,453 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:26,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:26,453 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:26
2025-03-13 14:51:26,453 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:26,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:51:26,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:26
2025-03-13 14:51:26,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:26,454 [INFO]: 	Creating the index 03/13/2025, 14:51:26
2025-03-13 14:51:26,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:26
2025-03-13 14:51:26,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:51:26,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:26
2025-03-13 14:51:26,455 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:51:26,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.38it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.79it/s] 50%|█████     | 11/22 [00:00<00:00, 38.32it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.90it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.03it/s]100%|██████████| 22/22 [00:05<00:00,  4.24it/s]
2025-03-13 14:51:31,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:31
2025-03-13 14:52:27,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.5165 secs
2025-03-13 14:52:27,165 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 14:52:27,165 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 14:52:47,089 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9239 secs
2025-03-13 14:52:47,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.6343 secs
2025-03-13 14:52:47,089 [INFO]: {
2025-03-13 14:52:47,089 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:47,089 [INFO]: 	index_param: efSearch=213
2025-03-13 14:52:47,089 [INFO]: 	index_path: knn.index
2025-03-13 14:52:47,089 [INFO]: 	size in bytes: 1028971570
2025-03-13 14:52:47,089 [INFO]: 	avg_search_speed_ms: 12.22884831244176
2025-03-13 14:52:47,090 [INFO]: 	99p_search_speed_ms: 22.85868455655876
2025-03-13 14:52:47,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:47,090 [INFO]: 	nb vectors: 5230
2025-03-13 14:52:47,090 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:47,090 [INFO]: 	compression ratio: 0.9993083093636882
2025-03-13 14:52:47,090 [INFO]: }
2025-03-13 14:52:47,090 [INFO]: 	>>> Finished "Creating the index" in 80.6359 secs
2025-03-13 14:52:47,090 [INFO]: >>> Finished "Launching the whole pipeline" in 80.6634 secs
2025-03-13 14:52:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 63054 [episode count 10/20]
[retrieval_preprocessing] for episode 11347 [episode count 11/20], we have num_retrieval=np.int64(5233) num_query=np.int64(243)
2025-03-13 14:52:52,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:53,290 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:53
2025-03-13 14:52:53,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1289.76it/s]
2025-03-13 14:52:53,320 [INFO]: There are 5233 embeddings of dim 49152
2025-03-13 14:52:53,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 14:52:53,321 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:53
2025-03-13 14:52:53,321 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:53,321 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:52:53,321 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:53,321 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:52:53,321 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:53
2025-03-13 14:52:53,321 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:53,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:52:53,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:53
2025-03-13 14:52:53,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:53,321 [INFO]: 	Creating the index 03/13/2025, 14:52:53
2025-03-13 14:52:53,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:53
2025-03-13 14:52:53,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:52:53,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:53
2025-03-13 14:52:53,323 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:52:53,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.51it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.28it/s] 50%|█████     | 11/22 [00:00<00:00, 36.39it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.58it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.52it/s]100%|██████████| 22/22 [00:06<00:00,  3.25it/s]
2025-03-13 14:53:00,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:00
2025-03-13 14:54:03,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6224 secs
2025-03-13 14:54:03,720 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 14:54:03,720 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.37it/s]
2025-03-13 14:54:34,607 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8868 secs
2025-03-13 14:54:34,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.2850 secs
2025-03-13 14:54:34,608 [INFO]: {
2025-03-13 14:54:34,608 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:34,608 [INFO]: 	index_param: efSearch=150
2025-03-13 14:54:34,608 [INFO]: 	index_path: knn.index
2025-03-13 14:54:34,608 [INFO]: 	size in bytes: 1029561850
2025-03-13 14:54:34,608 [INFO]: 	avg_search_speed_ms: 11.013387287515606
2025-03-13 14:54:34,608 [INFO]: 	99p_search_speed_ms: 17.26850717561319
2025-03-13 14:54:34,608 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:34,608 [INFO]: 	nb vectors: 5233
2025-03-13 14:54:34,608 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:34,608 [INFO]: 	compression ratio: 0.9993082630247032
2025-03-13 14:54:34,608 [INFO]: }
2025-03-13 14:54:34,608 [INFO]: 	>>> Finished "Creating the index" in 101.2869 secs
2025-03-13 14:54:34,608 [INFO]: >>> Finished "Launching the whole pipeline" in 101.3180 secs
2025-03-13 14:54:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 11347 [episode count 11/20]
[retrieval_preprocessing] for episode 604 [episode count 12/20], we have num_retrieval=np.int64(5180) num_query=np.int64(296)
2025-03-13 14:54:38,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:39,521 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:39
2025-03-13 14:54:39,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.77it/s]
2025-03-13 14:54:39,549 [INFO]: There are 5180 embeddings of dim 49152
2025-03-13 14:54:39,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 14:54:39,550 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:39,550 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 14:54:39,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:39,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:54:39,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,551 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:39,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:54:39,551 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:39
2025-03-13 14:54:39,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:39,552 [INFO]: 	Creating the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,552 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:39
2025-03-13 14:54:39,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 14:54:39,554 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,554 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 14:54:39,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.17it/s] 23%|██▎       | 5/22 [00:00<00:00, 23.08it/s] 41%|████      | 9/22 [00:00<00:00, 29.31it/s] 59%|█████▉    | 13/22 [00:00<00:00, 32.72it/s] 77%|███████▋  | 17/22 [00:00<00:00, 34.78it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.90it/s]100%|██████████| 22/22 [00:07<00:00,  3.11it/s]
2025-03-13 14:54:46,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:46
2025-03-13 14:55:35,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2980 secs
2025-03-13 14:55:35,921 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 14:55:35,922 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.35s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.59s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.40s/it]
2025-03-13 14:56:14,637 [INFO]: 	>>> Finished "Compute fast metrics" in 38.7155 secs
2025-03-13 14:56:14,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0839 secs
2025-03-13 14:56:14,638 [INFO]: {
2025-03-13 14:56:14,638 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:14,638 [INFO]: 	index_param: efSearch=165
2025-03-13 14:56:14,638 [INFO]: 	index_path: knn.index
2025-03-13 14:56:14,638 [INFO]: 	size in bytes: 1019134210
2025-03-13 14:56:14,638 [INFO]: 	avg_search_speed_ms: 8.65389382934752
2025-03-13 14:56:14,638 [INFO]: 	99p_search_speed_ms: 12.521340197417889
2025-03-13 14:56:14,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:14,638 [INFO]: 	nb vectors: 5180
2025-03-13 14:56:14,638 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:14,638 [INFO]: 	compression ratio: 0.9993084620326895
2025-03-13 14:56:14,638 [INFO]: }
2025-03-13 14:56:14,638 [INFO]: 	>>> Finished "Creating the index" in 95.0864 secs
2025-03-13 14:56:14,638 [INFO]: >>> Finished "Launching the whole pipeline" in 95.1169 secs
2025-03-13 14:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 604 [episode count 12/20]
[retrieval_preprocessing] for episode 25200 [episode count 13/20], we have num_retrieval=np.int64(4921) num_query=np.int64(555)
2025-03-13 14:56:19,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:20,567 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:20
2025-03-13 14:56:20,567 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-13 14:56:20,599 [INFO]: There are 4921 embeddings of dim 49152
2025-03-13 14:56:20,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 14:56:20,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:20,599 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 14:56:20,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:20,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:56:20,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,600 [INFO]: 1015.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:20,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:56:20,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:20
2025-03-13 14:56:20,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:20,600 [INFO]: 	Creating the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:20
2025-03-13 14:56:20,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:56:20,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,602 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 14:56:20,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:04<01:22,  4.36s/it] 25%|██▌       | 5/20 [00:04<00:10,  1.49it/s] 40%|████      | 8/20 [00:05<00:05,  2.24it/s] 60%|██████    | 12/20 [00:05<00:01,  4.02it/s] 75%|███████▌  | 15/20 [00:05<00:00,  5.65it/s] 90%|█████████ | 18/20 [00:05<00:00,  7.52it/s]100%|██████████| 20/20 [00:13<00:00,  1.53it/s]
2025-03-13 14:56:33,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:33
2025-03-13 14:57:28,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.2140 secs
2025-03-13 14:57:28,867 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 14:57:28,868 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.91it/s]
2025-03-13 14:58:08,081 [INFO]: 	>>> Finished "Compute fast metrics" in 39.2131 secs
2025-03-13 14:58:08,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.4900 secs
2025-03-13 14:58:08,092 [INFO]: {
2025-03-13 14:58:08,092 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:08,092 [INFO]: 	index_param: efSearch=276
2025-03-13 14:58:08,092 [INFO]: 	index_path: knn.index
2025-03-13 14:58:08,092 [INFO]: 	size in bytes: 968177230
2025-03-13 14:58:08,092 [INFO]: 	avg_search_speed_ms: 17.461236478942876
2025-03-13 14:58:08,092 [INFO]: 	99p_search_speed_ms: 31.388445533812025
2025-03-13 14:58:08,092 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:08,092 [INFO]: 	nb vectors: 4921
2025-03-13 14:58:08,092 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:08,092 [INFO]: 	compression ratio: 0.9993087401983209
2025-03-13 14:58:08,092 [INFO]: }
2025-03-13 14:58:08,092 [INFO]: 	>>> Finished "Creating the index" in 107.4922 secs
2025-03-13 14:58:08,092 [INFO]: >>> Finished "Launching the whole pipeline" in 107.5248 secs
2025-03-13 14:58:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 25200 [episode count 13/20]
[retrieval_preprocessing] for episode 81026 [episode count 14/20], we have num_retrieval=np.int64(5192) num_query=np.int64(284)
2025-03-13 14:58:16,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:17,593 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:17
2025-03-13 14:58:17,593 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 871.63it/s]
2025-03-13 14:58:17,627 [INFO]: There are 5192 embeddings of dim 49152
2025-03-13 14:58:17,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 14:58:17,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:17,628 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:58:17,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:17,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:17,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,628 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:17,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:17,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:17
2025-03-13 14:58:17,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:17,628 [INFO]: 	Creating the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:17
2025-03-13 14:58:17,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:58:17,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,630 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:58:17,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.20it/s] 18%|█▊        | 4/22 [00:00<00:01, 14.67it/s] 27%|██▋       | 6/22 [00:00<00:01, 15.80it/s] 41%|████      | 9/22 [00:00<00:00, 18.21it/s] 55%|█████▍    | 12/22 [00:00<00:00, 20.27it/s] 68%|██████▊   | 15/22 [00:00<00:00, 22.53it/s] 82%|████████▏ | 18/22 [00:00<00:00, 24.12it/s] 95%|█████████▌| 21/22 [00:08<00:00,  1.12it/s]100%|██████████| 22/22 [00:10<00:00,  2.20it/s]
2025-03-13 14:58:27,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:27
2025-03-13 14:59:27,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3313 secs
2025-03-13 14:59:27,974 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 14:59:27,974 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 14:59:54,272 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2972 secs
2025-03-13 14:59:54,272 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.6426 secs
2025-03-13 14:59:54,273 [INFO]: {
2025-03-13 14:59:54,273 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:54,273 [INFO]: 	index_param: efSearch=222
2025-03-13 14:59:54,273 [INFO]: 	index_path: knn.index
2025-03-13 14:59:54,273 [INFO]: 	size in bytes: 1021495270
2025-03-13 14:59:54,273 [INFO]: 	avg_search_speed_ms: 16.60683615462141
2025-03-13 14:59:54,273 [INFO]: 	99p_search_speed_ms: 30.416693710722033
2025-03-13 14:59:54,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:54,273 [INFO]: 	nb vectors: 5192
2025-03-13 14:59:54,273 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:54,273 [INFO]: 	compression ratio: 0.9993083335569435
2025-03-13 14:59:54,273 [INFO]: }
2025-03-13 14:59:54,273 [INFO]: 	>>> Finished "Creating the index" in 96.6445 secs
2025-03-13 14:59:54,273 [INFO]: >>> Finished "Launching the whole pipeline" in 96.6798 secs
2025-03-13 14:59:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 81026 [episode count 14/20]
[retrieval_preprocessing] for episode 25227 [episode count 15/20], we have num_retrieval=np.int64(5306) num_query=np.int64(170)
2025-03-13 14:59:58,150 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:58,989 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:58
2025-03-13 14:59:58,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-13 14:59:59,016 [INFO]: There are 5306 embeddings of dim 49152
2025-03-13 14:59:59,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 14:59:59,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:59
2025-03-13 14:59:59,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:59,017 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 14:59:59,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:59,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:59,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:59
2025-03-13 14:59:59,017 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:59,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:59,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:59
2025-03-13 14:59:59,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:59,017 [INFO]: 	Creating the index 03/13/2025, 14:59:59
2025-03-13 14:59:59,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:59
2025-03-13 14:59:59,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:59:59,018 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:59
2025-03-13 14:59:59,019 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 14:59:59,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:06,  3.41it/s] 23%|██▎       | 5/22 [00:00<00:01, 15.36it/s] 41%|████      | 9/22 [00:00<00:00, 22.87it/s] 59%|█████▉    | 13/22 [00:00<00:00, 27.61it/s] 77%|███████▋  | 17/22 [00:00<00:00, 30.80it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.21it/s]100%|██████████| 22/22 [00:06<00:00,  3.47it/s]
2025-03-13 15:00:05,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:05
2025-03-13 15:01:15,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.9961 secs
2025-03-13 15:01:15,368 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:01:15,368 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.86it/s]
2025-03-13 15:01:54,520 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1521 secs
2025-03-13 15:01:54,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.5026 secs
2025-03-13 15:01:54,521 [INFO]: {
2025-03-13 15:01:54,521 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:54,521 [INFO]: 	index_param: efSearch=160
2025-03-13 15:01:54,521 [INFO]: 	index_path: knn.index
2025-03-13 15:01:54,521 [INFO]: 	size in bytes: 1043924170
2025-03-13 15:01:54,521 [INFO]: 	avg_search_speed_ms: 8.970940168612875
2025-03-13 15:01:54,521 [INFO]: 	99p_search_speed_ms: 12.575570680201047
2025-03-13 15:01:54,521 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:54,521 [INFO]: 	nb vectors: 5306
2025-03-13 15:01:54,521 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:54,521 [INFO]: 	compression ratio: 0.9993082620167708
2025-03-13 15:01:54,521 [INFO]: }
2025-03-13 15:01:54,521 [INFO]: 	>>> Finished "Creating the index" in 115.5040 secs
2025-03-13 15:01:54,521 [INFO]: >>> Finished "Launching the whole pipeline" in 115.5319 secs
2025-03-13 15:01:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 25227 [episode count 15/20]
[retrieval_preprocessing] for episode 52895 [episode count 16/20], we have num_retrieval=np.int64(5120) num_query=np.int64(356)
2025-03-13 15:01:56,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:57,092 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:57
2025-03-13 15:01:57,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.97it/s]
2025-03-13 15:01:57,122 [INFO]: There are 5120 embeddings of dim 49152
2025-03-13 15:01:57,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:01:57,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:57
2025-03-13 15:01:57,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:57,123 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 15:01:57,124 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:57,124 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:01:57,124 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:57
2025-03-13 15:01:57,124 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:57,124 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:01:57,125 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:57
2025-03-13 15:01:57,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:57,125 [INFO]: 	Creating the index 03/13/2025, 15:01:57
2025-03-13 15:01:57,125 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:57
2025-03-13 15:01:57,128 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:01:57,128 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:57
2025-03-13 15:01:57,129 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:01:57,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.46it/s] 36%|███▋      | 8/22 [00:00<00:00, 38.71it/s] 64%|██████▎   | 14/22 [00:00<00:00, 44.50it/s] 91%|█████████ | 20/22 [00:00<00:00, 47.00it/s]100%|██████████| 22/22 [00:04<00:00,  4.58it/s]
2025-03-13 15:02:01,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:01
2025-03-13 15:03:06,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1154 secs
2025-03-13 15:03:06,048 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:03:06,048 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.67it/s] 50%|█████     | 2/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 15:03:39,858 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8095 secs
2025-03-13 15:03:39,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.7301 secs
2025-03-13 15:03:39,859 [INFO]: {
2025-03-13 15:03:39,859 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:39,859 [INFO]: 	index_param: efSearch=182
2025-03-13 15:03:39,859 [INFO]: 	index_path: knn.index
2025-03-13 15:03:39,859 [INFO]: 	size in bytes: 1007329570
2025-03-13 15:03:39,859 [INFO]: 	avg_search_speed_ms: 11.958314104199303
2025-03-13 15:03:39,859 [INFO]: 	99p_search_speed_ms: 18.782721552997824
2025-03-13 15:03:39,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:39,859 [INFO]: 	nb vectors: 5120
2025-03-13 15:03:39,859 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:39,859 [INFO]: 	compression ratio: 0.9993084587003636
2025-03-13 15:03:39,859 [INFO]: }
2025-03-13 15:03:39,859 [INFO]: 	>>> Finished "Creating the index" in 102.7340 secs
2025-03-13 15:03:39,859 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7667 secs
2025-03-13 15:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 52895 [episode count 16/20]
[retrieval_preprocessing] for episode 1186 [episode count 17/20], we have num_retrieval=np.int64(5219) num_query=np.int64(257)
2025-03-13 15:03:43,691 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:44,566 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:44
2025-03-13 15:03:44,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.26it/s]
2025-03-13 15:03:44,593 [INFO]: There are 5219 embeddings of dim 49152
2025-03-13 15:03:44,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:03:44,594 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:44
2025-03-13 15:03:44,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:44,594 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 15:03:44,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:44,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:44,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:44
2025-03-13 15:03:44,594 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:44,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:03:44,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:44
2025-03-13 15:03:44,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:44,594 [INFO]: 	Creating the index 03/13/2025, 15:03:44
2025-03-13 15:03:44,594 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:44
2025-03-13 15:03:44,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:03:44,595 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:44
2025-03-13 15:03:44,595 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:03:44,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.20it/s] 27%|██▋       | 6/22 [00:00<00:00, 26.68it/s] 50%|█████     | 11/22 [00:00<00:00, 33.71it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.12it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.72it/s]100%|██████████| 22/22 [00:05<00:00,  3.71it/s]
2025-03-13 15:03:50,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:50
2025-03-13 15:04:56,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.7571 secs
2025-03-13 15:04:56,283 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:04:56,283 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.76it/s]
2025-03-13 15:05:19,020 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7363 secs
2025-03-13 15:05:19,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.4251 secs
2025-03-13 15:05:19,021 [INFO]: {
2025-03-13 15:05:19,021 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:19,021 [INFO]: 	index_param: efSearch=170
2025-03-13 15:05:19,021 [INFO]: 	index_path: knn.index
2025-03-13 15:05:19,021 [INFO]: 	size in bytes: 1026807310
2025-03-13 15:05:19,021 [INFO]: 	avg_search_speed_ms: 10.328236487713326
2025-03-13 15:05:19,021 [INFO]: 	99p_search_speed_ms: 18.776792411226786
2025-03-13 15:05:19,021 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:19,021 [INFO]: 	nb vectors: 5219
2025-03-13 15:05:19,021 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:19,021 [INFO]: 	compression ratio: 0.9993083824072113
2025-03-13 15:05:19,021 [INFO]: }
2025-03-13 15:05:19,021 [INFO]: 	>>> Finished "Creating the index" in 94.4266 secs
2025-03-13 15:05:19,021 [INFO]: >>> Finished "Launching the whole pipeline" in 94.4544 secs
2025-03-13 15:05:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 1186 [episode count 17/20]
[retrieval_preprocessing] for episode 3336 [episode count 18/20], we have num_retrieval=np.int64(5235) num_query=np.int64(241)
2025-03-13 15:05:21,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:22,593 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:22
2025-03-13 15:05:22,594 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.06it/s]
2025-03-13 15:05:22,621 [INFO]: There are 5235 embeddings of dim 49152
2025-03-13 15:05:22,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:05:22,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:22
2025-03-13 15:05:22,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:22,622 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 15:05:22,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:22,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:05:22,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:22
2025-03-13 15:05:22,622 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:22,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:05:22,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:22
2025-03-13 15:05:22,622 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:22,622 [INFO]: 	Creating the index 03/13/2025, 15:05:22
2025-03-13 15:05:22,622 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:22
2025-03-13 15:05:22,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:05:22,623 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:22
2025-03-13 15:05:22,623 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:05:22,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.43it/s] 23%|██▎       | 5/22 [00:00<00:00, 22.43it/s] 41%|████      | 9/22 [00:00<00:00, 29.54it/s] 59%|█████▉    | 13/22 [00:00<00:00, 33.36it/s] 77%|███████▋  | 17/22 [00:00<00:00, 35.50it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.11it/s]100%|██████████| 22/22 [00:07<00:00,  3.01it/s]
2025-03-13 15:05:29,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:29
2025-03-13 15:06:35,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.2832 secs
2025-03-13 15:06:35,228 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:06:35,229 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 15:07:17,729 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5000 secs
2025-03-13 15:07:17,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.1059 secs
2025-03-13 15:07:17,729 [INFO]: {
2025-03-13 15:07:17,729 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:17,729 [INFO]: 	index_param: efSearch=189
2025-03-13 15:07:17,730 [INFO]: 	index_path: knn.index
2025-03-13 15:07:17,730 [INFO]: 	size in bytes: 1029955330
2025-03-13 15:07:17,730 [INFO]: 	avg_search_speed_ms: 12.829007051634388
2025-03-13 15:07:17,730 [INFO]: 	99p_search_speed_ms: 25.43281782884152
2025-03-13 15:07:17,730 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:17,730 [INFO]: 	nb vectors: 5235
2025-03-13 15:07:17,730 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:17,730 [INFO]: 	compression ratio: 0.9993082709713246
2025-03-13 15:07:17,730 [INFO]: }
2025-03-13 15:07:17,730 [INFO]: 	>>> Finished "Creating the index" in 115.1073 secs
2025-03-13 15:07:17,730 [INFO]: >>> Finished "Launching the whole pipeline" in 115.1361 secs
2025-03-13 15:07:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 3336 [episode count 18/20]
[retrieval_preprocessing] for episode 95506 [episode count 19/20], we have num_retrieval=np.int64(5194) num_query=np.int64(282)
2025-03-13 15:07:20,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:21,758 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:21
2025-03-13 15:07:21,758 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 693.27it/s]
2025-03-13 15:07:21,788 [INFO]: There are 5194 embeddings of dim 49152
2025-03-13 15:07:21,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:07:21,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:21
2025-03-13 15:07:21,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:21,789 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 15:07:21,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:21,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:07:21,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:21
2025-03-13 15:07:21,790 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:21,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:07:21,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:21
2025-03-13 15:07:21,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:21,791 [INFO]: 	Creating the index 03/13/2025, 15:07:21
2025-03-13 15:07:21,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:21
2025-03-13 15:07:21,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:07:21,794 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:21
2025-03-13 15:07:21,795 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:07:21,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.56it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.08it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.02it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.55it/s]100%|██████████| 22/22 [00:06<00:00,  2.04it/s]100%|██████████| 22/22 [00:06<00:00,  3.29it/s]
2025-03-13 15:07:28,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:28
2025-03-13 15:08:36,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.2607 secs
2025-03-13 15:08:36,750 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:08:36,750 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 15:09:06,078 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3278 secs
2025-03-13 15:09:06,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.2839 secs
2025-03-13 15:09:06,079 [INFO]: {
2025-03-13 15:09:06,079 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:06,079 [INFO]: 	index_param: efSearch=184
2025-03-13 15:09:06,079 [INFO]: 	index_path: knn.index
2025-03-13 15:09:06,079 [INFO]: 	size in bytes: 1021888750
2025-03-13 15:09:06,079 [INFO]: 	avg_search_speed_ms: 11.075723285870348
2025-03-13 15:09:06,079 [INFO]: 	99p_search_speed_ms: 20.23351477924735
2025-03-13 15:09:06,079 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:06,079 [INFO]: 	nb vectors: 5194
2025-03-13 15:09:06,079 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:06,079 [INFO]: 	compression ratio: 0.9993083415391353
2025-03-13 15:09:06,079 [INFO]: }
2025-03-13 15:09:06,079 [INFO]: 	>>> Finished "Creating the index" in 104.2878 secs
2025-03-13 15:09:06,079 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3205 secs
2025-03-13 15:09:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 95506 [episode count 19/20]
2025-03-13 15:09:08: [retrieval_preprocessing] finished for 452818143_lid_on_pot [chosen_id count 0/196]
2025-03-13 15:09:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 452818143_lid_off_pot_on_table [chosen_id count 1/196]
2025-03-13 15:09:10: [retrieval_preprocessing] we have num_total=4296 embedding_dim=49152
[retrieval_preprocessing] for episode 5637 [episode count 0/20], we have num_retrieval=np.int64(4125) num_query=np.int64(171)
2025-03-13 15:09:10,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:11,770 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:11
2025-03-13 15:09:11,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.70it/s]
2025-03-13 15:09:11,797 [INFO]: There are 4125 embeddings of dim 49152
2025-03-13 15:09:11,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:09:11,797 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,797 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:11,797 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:09:11,797 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:11,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:11,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,798 [INFO]: 851.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:11,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:11,798 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:11
2025-03-13 15:09:11,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:11,798 [INFO]: 	Creating the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,798 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:11
2025-03-13 15:09:11,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:09:11,799 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,799 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:09:11,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.39it/s] 29%|██▉       | 5/17 [00:00<00:00, 20.71it/s] 53%|█████▎    | 9/17 [00:00<00:00, 27.78it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.75it/s]100%|██████████| 17/17 [00:05<00:00,  2.08it/s]100%|██████████| 17/17 [00:05<00:00,  3.23it/s]
2025-03-13 15:09:17,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:17
2025-03-13 15:10:08,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2062 secs
2025-03-13 15:10:08,278 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:10:08,278 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 15:10:31,508 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2293 secs
2025-03-13 15:10:31,511 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.7116 secs
2025-03-13 15:10:31,511 [INFO]: {
2025-03-13 15:10:31,511 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:31,511 [INFO]: 	index_param: efSearch=212
2025-03-13 15:10:31,511 [INFO]: 	index_path: knn.index
2025-03-13 15:10:31,511 [INFO]: 	size in bytes: 811569130
2025-03-13 15:10:31,511 [INFO]: 	avg_search_speed_ms: 11.825940505398908
2025-03-13 15:10:31,511 [INFO]: 	99p_search_speed_ms: 17.896037606988088
2025-03-13 15:10:31,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:31,511 [INFO]: 	nb vectors: 4125
2025-03-13 15:10:31,511 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:31,511 [INFO]: 	compression ratio: 0.999308586318457
2025-03-13 15:10:31,511 [INFO]: }
2025-03-13 15:10:31,511 [INFO]: 	>>> Finished "Creating the index" in 79.7134 secs
2025-03-13 15:10:31,511 [INFO]: >>> Finished "Launching the whole pipeline" in 79.7417 secs
2025-03-13 15:10:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 5637 [episode count 0/20]
[retrieval_preprocessing] for episode 58897 [episode count 1/20], we have num_retrieval=np.int64(4062) num_query=np.int64(234)
2025-03-13 15:10:33,677 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:34,418 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:34
2025-03-13 15:10:34,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.61it/s]
2025-03-13 15:10:34,453 [INFO]: There are 4062 embeddings of dim 49152
2025-03-13 15:10:34,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 15:10:34,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:34
2025-03-13 15:10:34,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:34,454 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:10:34,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:34,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:34,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:34
2025-03-13 15:10:34,454 [INFO]: 838.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:34,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:10:34,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:34
2025-03-13 15:10:34,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:34,454 [INFO]: 	Creating the index 03/13/2025, 15:10:34
2025-03-13 15:10:34,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:34
2025-03-13 15:10:34,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:10:34,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:34
2025-03-13 15:10:34,455 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:10:34,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.22it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.14it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.63it/s]100%|██████████| 16/16 [00:03<00:00,  3.07it/s]100%|██████████| 16/16 [00:03<00:00,  4.16it/s]
2025-03-13 15:10:38,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:38
2025-03-13 15:11:22,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5618 secs
2025-03-13 15:11:22,867 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 15:11:22,867 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 15:11:42,498 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6311 secs
2025-03-13 15:11:42,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0471 secs
2025-03-13 15:11:42,503 [INFO]: {
2025-03-13 15:11:42,503 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:42,503 [INFO]: 	index_param: efSearch=138
2025-03-13 15:11:42,503 [INFO]: 	index_path: knn.index
2025-03-13 15:11:42,503 [INFO]: 	size in bytes: 799174210
2025-03-13 15:11:42,503 [INFO]: 	avg_search_speed_ms: 12.05696817796049
2025-03-13 15:11:42,503 [INFO]: 	99p_search_speed_ms: 23.31996444147081
2025-03-13 15:11:42,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:42,503 [INFO]: 	nb vectors: 4062
2025-03-13 15:11:42,503 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:42,503 [INFO]: 	compression ratio: 0.9993086438562626
2025-03-13 15:11:42,503 [INFO]: }
2025-03-13 15:11:42,503 [INFO]: 	>>> Finished "Creating the index" in 68.0489 secs
2025-03-13 15:11:42,503 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0844 secs
2025-03-13 15:11:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 58897 [episode count 1/20]
[retrieval_preprocessing] for episode 66584 [episode count 2/20], we have num_retrieval=np.int64(4111) num_query=np.int64(185)
2025-03-13 15:11:45,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:45,733 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:45
2025-03-13 15:11:45,733 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.18it/s]
2025-03-13 15:11:45,765 [INFO]: There are 4111 embeddings of dim 49152
2025-03-13 15:11:45,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 15:11:45,766 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:45
2025-03-13 15:11:45,766 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:45,766 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:11:45,766 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:45,766 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:45,766 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:45
2025-03-13 15:11:45,766 [INFO]: 848.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:45,766 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:45,766 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:45
2025-03-13 15:11:45,766 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:45,766 [INFO]: 	Creating the index 03/13/2025, 15:11:45
2025-03-13 15:11:45,766 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:45
2025-03-13 15:11:45,767 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:11:45,767 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:45
2025-03-13 15:11:45,767 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:11:45,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.75it/s] 29%|██▉       | 5/17 [00:00<00:00, 20.52it/s] 53%|█████▎    | 9/17 [00:00<00:00, 27.28it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.29it/s]100%|██████████| 17/17 [00:03<00:00,  2.84it/s]100%|██████████| 17/17 [00:03<00:00,  4.31it/s]
2025-03-13 15:11:49,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:49
2025-03-13 15:12:47,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5985 secs
2025-03-13 15:12:47,320 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:12:47,320 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.03it/s]
2025-03-13 15:13:10,180 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8596 secs
2025-03-13 15:13:10,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.4153 secs
2025-03-13 15:13:10,183 [INFO]: {
2025-03-13 15:13:10,183 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:10,183 [INFO]: 	index_param: efSearch=159
2025-03-13 15:13:10,183 [INFO]: 	index_path: knn.index
2025-03-13 15:13:10,183 [INFO]: 	size in bytes: 808814710
2025-03-13 15:13:10,183 [INFO]: 	avg_search_speed_ms: 8.693719951299988
2025-03-13 15:13:10,183 [INFO]: 	99p_search_speed_ms: 14.33185557834804
2025-03-13 15:13:10,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:10,183 [INFO]: 	nb vectors: 4111
2025-03-13 15:13:10,183 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:10,183 [INFO]: 	compression ratio: 0.9993085907154187
2025-03-13 15:13:10,183 [INFO]: }
2025-03-13 15:13:10,183 [INFO]: 	>>> Finished "Creating the index" in 84.4170 secs
2025-03-13 15:13:10,183 [INFO]: >>> Finished "Launching the whole pipeline" in 84.4503 secs
2025-03-13 15:13:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 66584 [episode count 2/20]
[retrieval_preprocessing] for episode 67617 [episode count 3/20], we have num_retrieval=np.int64(4118) num_query=np.int64(178)
2025-03-13 15:13:11,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:12,506 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:12
2025-03-13 15:13:12,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2088.80it/s]
2025-03-13 15:13:12,536 [INFO]: There are 4118 embeddings of dim 49152
2025-03-13 15:13:12,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 15:13:12,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:12
2025-03-13 15:13:12,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:12,536 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:13:12,536 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:12,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:12,536 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:12
2025-03-13 15:13:12,536 [INFO]: 849.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:12,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:12,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:12
2025-03-13 15:13:12,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:12,536 [INFO]: 	Creating the index 03/13/2025, 15:13:12
2025-03-13 15:13:12,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:12
2025-03-13 15:13:12,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:13:12,537 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:12
2025-03-13 15:13:12,538 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:13:12,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.27it/s] 29%|██▉       | 5/17 [00:00<00:00, 25.40it/s] 53%|█████▎    | 9/17 [00:00<00:00, 31.01it/s] 82%|████████▏ | 14/17 [00:00<00:00, 35.26it/s]100%|██████████| 17/17 [00:03<00:00,  4.59it/s]
2025-03-13 15:13:16,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:16
2025-03-13 15:14:04,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7109 secs
2025-03-13 15:14:04,957 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:14:04,957 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 15:14:36,254 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2970 secs
2025-03-13 15:14:36,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.7214 secs
2025-03-13 15:14:36,259 [INFO]: {
2025-03-13 15:14:36,259 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:36,259 [INFO]: 	index_param: efSearch=206
2025-03-13 15:14:36,259 [INFO]: 	index_path: knn.index
2025-03-13 15:14:36,259 [INFO]: 	size in bytes: 810191890
2025-03-13 15:14:36,259 [INFO]: 	avg_search_speed_ms: 11.144250544215364
2025-03-13 15:14:36,259 [INFO]: 	99p_search_speed_ms: 18.401299908291538
2025-03-13 15:14:36,259 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:36,259 [INFO]: 	nb vectors: 4118
2025-03-13 15:14:36,259 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:36,259 [INFO]: 	compression ratio: 0.9993086255158639
2025-03-13 15:14:36,259 [INFO]: }
2025-03-13 15:14:36,259 [INFO]: 	>>> Finished "Creating the index" in 83.7231 secs
2025-03-13 15:14:36,259 [INFO]: >>> Finished "Launching the whole pipeline" in 83.7535 secs
2025-03-13 15:14:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 67617 [episode count 3/20]
[retrieval_preprocessing] for episode 35378 [episode count 4/20], we have num_retrieval=np.int64(4093) num_query=np.int64(203)
2025-03-13 15:14:39,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:40,741 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:40
2025-03-13 15:14:40,742 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 983.19it/s]
2025-03-13 15:14:40,773 [INFO]: There are 4093 embeddings of dim 49152
2025-03-13 15:14:40,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 15:14:40,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:40
2025-03-13 15:14:40,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:40,775 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:14:40,775 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:40,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:14:40,775 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:40
2025-03-13 15:14:40,775 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:40,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:14:40,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:40
2025-03-13 15:14:40,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:40,776 [INFO]: 	Creating the index 03/13/2025, 15:14:40
2025-03-13 15:14:40,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:40
2025-03-13 15:14:40,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:14:40,778 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:40
2025-03-13 15:14:40,779 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:14:40,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.15it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.66it/s] 53%|█████▎    | 9/17 [00:00<00:00, 29.17it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.48it/s]100%|██████████| 17/17 [00:04<00:00,  2.64it/s]100%|██████████| 17/17 [00:04<00:00,  4.07it/s]
2025-03-13 15:14:44,961 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:44
2025-03-13 15:15:32,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0476 secs
2025-03-13 15:15:32,009 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 15:15:32,010 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 15:15:56,331 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3212 secs
2025-03-13 15:15:56,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5573 secs
2025-03-13 15:15:56,336 [INFO]: {
2025-03-13 15:15:56,336 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:56,336 [INFO]: 	index_param: efSearch=120
2025-03-13 15:15:56,336 [INFO]: 	index_path: knn.index
2025-03-13 15:15:56,336 [INFO]: 	size in bytes: 805273270
2025-03-13 15:15:56,336 [INFO]: 	avg_search_speed_ms: 9.187062198460389
2025-03-13 15:15:56,336 [INFO]: 	99p_search_speed_ms: 15.71352675557135
2025-03-13 15:15:56,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:56,336 [INFO]: 	nb vectors: 4093
2025-03-13 15:15:56,336 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:56,336 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-13 15:15:56,336 [INFO]: }
2025-03-13 15:15:56,336 [INFO]: 	>>> Finished "Creating the index" in 75.5606 secs
2025-03-13 15:15:56,336 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5949 secs
2025-03-13 15:15:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 35378 [episode count 4/20]
[retrieval_preprocessing] for episode 75316 [episode count 5/20], we have num_retrieval=np.int64(4100) num_query=np.int64(196)
2025-03-13 15:15:59,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:00,291 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:00
2025-03-13 15:16:00,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1436.90it/s]
2025-03-13 15:16:00,321 [INFO]: There are 4100 embeddings of dim 49152
2025-03-13 15:16:00,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 15:16:00,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:00
2025-03-13 15:16:00,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:00,322 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:16:00,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:00,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:00,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:00
2025-03-13 15:16:00,322 [INFO]: 846.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:00,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:16:00,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:00
2025-03-13 15:16:00,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:00,322 [INFO]: 	Creating the index 03/13/2025, 15:16:00
2025-03-13 15:16:00,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:00
2025-03-13 15:16:00,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:16:00,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:00
2025-03-13 15:16:00,323 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:16:00,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.27it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.22it/s] 65%|██████▍   | 11/17 [00:00<00:00, 32.92it/s] 94%|█████████▍| 16/17 [00:00<00:00, 35.96it/s]100%|██████████| 17/17 [00:04<00:00,  3.47it/s]
2025-03-13 15:16:05,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:05
2025-03-13 15:16:55,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9212 secs
2025-03-13 15:16:55,149 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:16:55,149 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 15:17:27,761 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6122 secs
2025-03-13 15:17:27,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4415 secs
2025-03-13 15:17:27,765 [INFO]: {
2025-03-13 15:17:27,765 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:27,765 [INFO]: 	index_param: efSearch=192
2025-03-13 15:17:27,765 [INFO]: 	index_path: knn.index
2025-03-13 15:17:27,765 [INFO]: 	size in bytes: 806650450
2025-03-13 15:17:27,765 [INFO]: 	avg_search_speed_ms: 11.45923476589402
2025-03-13 15:17:27,765 [INFO]: 	99p_search_speed_ms: 17.47627186588943
2025-03-13 15:17:27,765 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:27,765 [INFO]: 	nb vectors: 4100
2025-03-13 15:17:27,765 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:27,765 [INFO]: 	compression ratio: 0.9993086844493795
2025-03-13 15:17:27,765 [INFO]: }
2025-03-13 15:17:27,765 [INFO]: 	>>> Finished "Creating the index" in 87.4431 secs
2025-03-13 15:17:27,765 [INFO]: >>> Finished "Launching the whole pipeline" in 87.4744 secs
2025-03-13 15:17:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 75316 [episode count 5/20]
[retrieval_preprocessing] for episode 62033 [episode count 6/20], we have num_retrieval=np.int64(4123) num_query=np.int64(173)
2025-03-13 15:17:30,026 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:31,048 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:31
2025-03-13 15:17:31,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.89it/s]
2025-03-13 15:17:31,076 [INFO]: There are 4123 embeddings of dim 49152
2025-03-13 15:17:31,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:17:31,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:31,077 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:17:31,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:31,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:17:31,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,078 [INFO]: 850.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:31,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:31,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:31
2025-03-13 15:17:31,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:31,078 [INFO]: 	Creating the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:31
2025-03-13 15:17:31,081 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:17:31,082 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,082 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:17:31,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.75it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.66it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.68it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.72it/s]100%|██████████| 17/17 [00:04<00:00,  3.56it/s]
2025-03-13 15:17:35,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:35
2025-03-13 15:18:30,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8939 secs
2025-03-13 15:18:30,756 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:18:30,756 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.27it/s]
2025-03-13 15:18:54,635 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8794 secs
2025-03-13 15:18:54,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5575 secs
2025-03-13 15:18:54,640 [INFO]: {
2025-03-13 15:18:54,640 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:54,640 [INFO]: 	index_param: efSearch=177
2025-03-13 15:18:54,640 [INFO]: 	index_path: knn.index
2025-03-13 15:18:54,640 [INFO]: 	size in bytes: 811175650
2025-03-13 15:18:54,640 [INFO]: 	avg_search_speed_ms: 10.572519230392484
2025-03-13 15:18:54,640 [INFO]: 	99p_search_speed_ms: 16.13201017025858
2025-03-13 15:18:54,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:54,640 [INFO]: 	nb vectors: 4123
2025-03-13 15:18:54,640 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:54,640 [INFO]: 	compression ratio: 0.9993085763853982
2025-03-13 15:18:54,640 [INFO]: }
2025-03-13 15:18:54,640 [INFO]: 	>>> Finished "Creating the index" in 83.5614 secs
2025-03-13 15:18:54,640 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5922 secs
2025-03-13 15:18:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 62033 [episode count 6/20]
[retrieval_preprocessing] for episode 89687 [episode count 7/20], we have num_retrieval=np.int64(4122) num_query=np.int64(174)
2025-03-13 15:18:56,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:58,174 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:58
2025-03-13 15:18:58,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.46it/s]
2025-03-13 15:18:58,207 [INFO]: There are 4122 embeddings of dim 49152
2025-03-13 15:18:58,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 15:18:58,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:58
2025-03-13 15:18:58,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:58,208 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:18:58,208 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:58,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:18:58,208 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:58
2025-03-13 15:18:58,208 [INFO]: 850.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:58,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:18:58,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:58
2025-03-13 15:18:58,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:58,209 [INFO]: 	Creating the index 03/13/2025, 15:18:58
2025-03-13 15:18:58,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:58
2025-03-13 15:18:58,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:18:58,211 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:58
2025-03-13 15:18:58,211 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:18:58,211 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.70it/s] 29%|██▉       | 5/17 [00:00<00:00, 21.14it/s] 53%|█████▎    | 9/17 [00:00<00:00, 25.30it/s] 76%|███████▋  | 13/17 [00:00<00:00, 28.37it/s]100%|██████████| 17/17 [00:04<00:00,  2.64it/s]100%|██████████| 17/17 [00:04<00:00,  4.03it/s]
2025-03-13 15:19:02,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:02
2025-03-13 15:19:58,631 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.1947 secs
2025-03-13 15:19:58,631 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 15:19:58,631 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 15:20:21,742 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1109 secs
2025-03-13 15:20:21,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5345 secs
2025-03-13 15:20:21,746 [INFO]: {
2025-03-13 15:20:21,746 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:21,746 [INFO]: 	index_param: efSearch=163
2025-03-13 15:20:21,746 [INFO]: 	index_path: knn.index
2025-03-13 15:20:21,746 [INFO]: 	size in bytes: 810978910
2025-03-13 15:20:21,746 [INFO]: 	avg_search_speed_ms: 11.699131043213937
2025-03-13 15:20:21,746 [INFO]: 	99p_search_speed_ms: 19.624543511308737
2025-03-13 15:20:21,746 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:21,746 [INFO]: 	nb vectors: 4122
2025-03-13 15:20:21,746 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:21,746 [INFO]: 	compression ratio: 0.9993085714152542
2025-03-13 15:20:21,746 [INFO]: }
2025-03-13 15:20:21,746 [INFO]: 	>>> Finished "Creating the index" in 83.5372 secs
2025-03-13 15:20:21,746 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5722 secs
2025-03-13 15:20:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 89687 [episode count 7/20]
[retrieval_preprocessing] for episode 53347 [episode count 8/20], we have num_retrieval=np.int64(4136) num_query=np.int64(160)
2025-03-13 15:20:24,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:25,015 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:25
2025-03-13 15:20:25,015 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 813.80it/s]
2025-03-13 15:20:25,050 [INFO]: There are 4136 embeddings of dim 49152
2025-03-13 15:20:25,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 15:20:25,051 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:25
2025-03-13 15:20:25,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:25,051 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:20:25,051 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:25,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:20:25,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:25
2025-03-13 15:20:25,052 [INFO]: 853.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:25,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:20:25,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:25
2025-03-13 15:20:25,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:25,053 [INFO]: 	Creating the index 03/13/2025, 15:20:25
2025-03-13 15:20:25,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:25
2025-03-13 15:20:25,056 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:20:25,057 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:25
2025-03-13 15:20:25,057 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:20:25,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.07it/s] 24%|██▎       | 4/17 [00:00<00:00, 18.35it/s] 41%|████      | 7/17 [00:00<00:00, 22.96it/s] 59%|█████▉    | 10/17 [00:00<00:00, 24.74it/s] 76%|███████▋  | 13/17 [00:00<00:00, 26.15it/s] 94%|█████████▍| 16/17 [00:00<00:00, 27.06it/s]100%|██████████| 17/17 [00:04<00:00,  3.56it/s]
2025-03-13 15:20:29,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:29
2025-03-13 15:21:20,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2234 secs
2025-03-13 15:21:20,063 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:21:20,063 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.24it/s]
2025-03-13 15:21:43,254 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1901 secs
2025-03-13 15:21:43,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1996 secs
2025-03-13 15:21:43,257 [INFO]: {
2025-03-13 15:21:43,257 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:43,257 [INFO]: 	index_param: efSearch=193
2025-03-13 15:21:43,257 [INFO]: 	index_path: knn.index
2025-03-13 15:21:43,257 [INFO]: 	size in bytes: 813733270
2025-03-13 15:21:43,257 [INFO]: 	avg_search_speed_ms: 12.351837986792772
2025-03-13 15:21:43,257 [INFO]: 	99p_search_speed_ms: 22.5711749237962
2025-03-13 15:21:43,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:43,257 [INFO]: 	nb vectors: 4136
2025-03-13 15:21:43,257 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:43,257 [INFO]: 	compression ratio: 0.9993086407785686
2025-03-13 15:21:43,257 [INFO]: }
2025-03-13 15:21:43,257 [INFO]: 	>>> Finished "Creating the index" in 78.2037 secs
2025-03-13 15:21:43,257 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2420 secs
2025-03-13 15:21:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 53347 [episode count 8/20]
[retrieval_preprocessing] for episode 58471 [episode count 9/20], we have num_retrieval=np.int64(3730) num_query=np.int64(566)
2025-03-13 15:21:45,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:45,942 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:45
2025-03-13 15:21:45,942 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.38it/s]
2025-03-13 15:21:45,975 [INFO]: There are 3730 embeddings of dim 49152
2025-03-13 15:21:45,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 15:21:45,976 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:45
2025-03-13 15:21:45,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:45,976 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 15:21:45,976 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:45,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:45,976 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:45
2025-03-13 15:21:45,976 [INFO]: 769.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:45,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:21:45,976 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:45
2025-03-13 15:21:45,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:45,976 [INFO]: 	Creating the index 03/13/2025, 15:21:45
2025-03-13 15:21:45,976 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:45
2025-03-13 15:21:45,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:21:45,977 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:45
2025-03-13 15:21:45,977 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:21:45,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.03it/s] 40%|████      | 6/15 [00:00<00:00, 26.87it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.81it/s]100%|██████████| 15/15 [00:03<00:00,  3.61it/s]100%|██████████| 15/15 [00:03<00:00,  4.94it/s]
2025-03-13 15:21:49,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:49
2025-03-13 15:22:29,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3836 secs
2025-03-13 15:22:29,401 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:22:29,401 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.53it/s]
2025-03-13 15:23:00,434 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0331 secs
2025-03-13 15:23:00,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4597 secs
2025-03-13 15:23:00,437 [INFO]: {
2025-03-13 15:23:00,437 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:00,437 [INFO]: 	index_param: efSearch=177
2025-03-13 15:23:00,437 [INFO]: 	index_path: knn.index
2025-03-13 15:23:00,437 [INFO]: 	size in bytes: 733854730
2025-03-13 15:23:00,437 [INFO]: 	avg_search_speed_ms: 10.538544853240472
2025-03-13 15:23:00,437 [INFO]: 	99p_search_speed_ms: 15.031737145036459
2025-03-13 15:23:00,437 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:00,437 [INFO]: 	nb vectors: 3730
2025-03-13 15:23:00,437 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:00,437 [INFO]: 	compression ratio: 0.9993092774642196
2025-03-13 15:23:00,437 [INFO]: }
2025-03-13 15:23:00,437 [INFO]: 	>>> Finished "Creating the index" in 74.4613 secs
2025-03-13 15:23:00,437 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4951 secs
2025-03-13 15:23:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 58471 [episode count 9/20]
[retrieval_preprocessing] for episode 12937 [episode count 10/20], we have num_retrieval=np.int64(4120) num_query=np.int64(176)
2025-03-13 15:23:05,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:06,446 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:06
2025-03-13 15:23:06,446 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 14.99it/s]
2025-03-13 15:23:06,543 [INFO]: There are 4120 embeddings of dim 49152
2025-03-13 15:23:06,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0975 secs
2025-03-13 15:23:06,544 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:06
2025-03-13 15:23:06,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:06,544 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:23:06,544 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:06,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:23:06,545 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:06
2025-03-13 15:23:06,545 [INFO]: 850.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:06,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:23:06,546 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:06
2025-03-13 15:23:06,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:06,546 [INFO]: 	Creating the index 03/13/2025, 15:23:06
2025-03-13 15:23:06,546 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:06
2025-03-13 15:23:06,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 15:23:06,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:06
2025-03-13 15:23:06,550 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:23:06,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.33it/s] 24%|██▎       | 4/17 [00:00<00:00, 19.06it/s] 41%|████      | 7/17 [00:00<00:00, 22.91it/s] 59%|█████▉    | 10/17 [00:00<00:00, 24.43it/s] 76%|███████▋  | 13/17 [00:00<00:00, 26.21it/s]100%|██████████| 17/17 [00:04<00:00,  2.18it/s]100%|██████████| 17/17 [00:04<00:00,  3.62it/s]
2025-03-13 15:23:11,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:11
2025-03-13 15:24:06,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8540 secs
2025-03-13 15:24:06,706 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:24:06,707 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.77it/s]
2025-03-13 15:24:32,539 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8323 secs
2025-03-13 15:24:32,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.9921 secs
2025-03-13 15:24:32,542 [INFO]: {
2025-03-13 15:24:32,542 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:32,542 [INFO]: 	index_param: efSearch=168
2025-03-13 15:24:32,542 [INFO]: 	index_path: knn.index
2025-03-13 15:24:32,542 [INFO]: 	size in bytes: 810585430
2025-03-13 15:24:32,542 [INFO]: 	avg_search_speed_ms: 9.554477516159686
2025-03-13 15:24:32,542 [INFO]: 	99p_search_speed_ms: 15.158943054266269
2025-03-13 15:24:32,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:32,542 [INFO]: 	nb vectors: 4120
2025-03-13 15:24:32,542 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:32,542 [INFO]: 	compression ratio: 0.9993085614677283
2025-03-13 15:24:32,542 [INFO]: }
2025-03-13 15:24:32,542 [INFO]: 	>>> Finished "Creating the index" in 85.9958 secs
2025-03-13 15:24:32,542 [INFO]: >>> Finished "Launching the whole pipeline" in 86.0964 secs
2025-03-13 15:24:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 12937 [episode count 10/20]
[retrieval_preprocessing] for episode 56437 [episode count 11/20], we have num_retrieval=np.int64(4157) num_query=np.int64(139)
2025-03-13 15:24:34,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:34,924 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:34
2025-03-13 15:24:34,925 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.05it/s]
2025-03-13 15:24:34,954 [INFO]: There are 4157 embeddings of dim 49152
2025-03-13 15:24:34,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:24:34,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:34
2025-03-13 15:24:34,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:34,954 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:24:34,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:34,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:34,954 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:34
2025-03-13 15:24:34,954 [INFO]: 857.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:34,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:34,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:34
2025-03-13 15:24:34,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:34,954 [INFO]: 	Creating the index 03/13/2025, 15:24:34
2025-03-13 15:24:34,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:34
2025-03-13 15:24:34,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:24:34,956 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:34
2025-03-13 15:24:34,956 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:24:34,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.15it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.77it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.20it/s] 94%|█████████▍| 16/17 [00:00<00:00, 37.84it/s]100%|██████████| 17/17 [00:04<00:00,  4.24it/s]
2025-03-13 15:24:38,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:38
2025-03-13 15:25:24,466 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4972 secs
2025-03-13 15:25:24,466 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 15:25:24,466 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.74it/s]
2025-03-13 15:25:47,316 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8504 secs
2025-03-13 15:25:47,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3644 secs
2025-03-13 15:25:47,320 [INFO]: {
2025-03-13 15:25:47,320 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:47,320 [INFO]: 	index_param: efSearch=155
2025-03-13 15:25:47,320 [INFO]: 	index_path: knn.index
2025-03-13 15:25:47,320 [INFO]: 	size in bytes: 817864870
2025-03-13 15:25:47,320 [INFO]: 	avg_search_speed_ms: 10.426241611941437
2025-03-13 15:25:47,320 [INFO]: 	99p_search_speed_ms: 17.253181384876367
2025-03-13 15:25:47,320 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:47,320 [INFO]: 	nb vectors: 4157
2025-03-13 15:25:47,320 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:47,320 [INFO]: 	compression ratio: 0.9993086706365075
2025-03-13 15:25:47,320 [INFO]: }
2025-03-13 15:25:47,320 [INFO]: 	>>> Finished "Creating the index" in 72.3661 secs
2025-03-13 15:25:47,320 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3959 secs
2025-03-13 15:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 56437 [episode count 11/20]
[retrieval_preprocessing] for episode 47238 [episode count 12/20], we have num_retrieval=np.int64(4140) num_query=np.int64(156)
2025-03-13 15:25:48,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:50,052 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:50
2025-03-13 15:25:50,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1841.22it/s]
2025-03-13 15:25:50,078 [INFO]: There are 4140 embeddings of dim 49152
2025-03-13 15:25:50,079 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:25:50,079 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:50
2025-03-13 15:25:50,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:50,079 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:25:50,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:50,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:25:50,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:50
2025-03-13 15:25:50,079 [INFO]: 854.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:50,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:25:50,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:50
2025-03-13 15:25:50,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:50,079 [INFO]: 	Creating the index 03/13/2025, 15:25:50
2025-03-13 15:25:50,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:50
2025-03-13 15:25:50,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:50,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:50
2025-03-13 15:25:50,081 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:25:50,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.93it/s] 29%|██▉       | 5/17 [00:00<00:00, 20.80it/s] 53%|█████▎    | 9/17 [00:00<00:00, 27.86it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.32it/s]100%|██████████| 17/17 [00:04<00:00,  2.75it/s]100%|██████████| 17/17 [00:04<00:00,  4.19it/s]
2025-03-13 15:25:54,145 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:54
2025-03-13 15:26:48,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7772 secs
2025-03-13 15:26:48,923 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 15:26:48,923 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.55it/s]
2025-03-13 15:27:14,896 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9729 secs
2025-03-13 15:27:14,899 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.8184 secs
2025-03-13 15:27:14,899 [INFO]: {
2025-03-13 15:27:14,899 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:14,899 [INFO]: 	index_param: efSearch=155
2025-03-13 15:27:14,899 [INFO]: 	index_path: knn.index
2025-03-13 15:27:14,899 [INFO]: 	size in bytes: 814520230
2025-03-13 15:27:14,899 [INFO]: 	avg_search_speed_ms: 9.027728384750683
2025-03-13 15:27:14,899 [INFO]: 	99p_search_speed_ms: 15.531935258768529
2025-03-13 15:27:14,899 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:14,899 [INFO]: 	nb vectors: 4140
2025-03-13 15:27:14,899 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:14,899 [INFO]: 	compression ratio: 0.9993086605104946
2025-03-13 15:27:14,899 [INFO]: }
2025-03-13 15:27:14,899 [INFO]: 	>>> Finished "Creating the index" in 84.8200 secs
2025-03-13 15:27:14,899 [INFO]: >>> Finished "Launching the whole pipeline" in 84.8468 secs
2025-03-13 15:27:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 47238 [episode count 12/20]
[retrieval_preprocessing] for episode 60510 [episode count 13/20], we have num_retrieval=np.int64(3947) num_query=np.int64(349)
2025-03-13 15:27:17,483 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:18,007 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:18
2025-03-13 15:27:18,008 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1704.31it/s]
2025-03-13 15:27:18,037 [INFO]: There are 3947 embeddings of dim 49152
2025-03-13 15:27:18,037 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:27:18,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:18
2025-03-13 15:27:18,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:18,037 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:27:18,037 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:18,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:18,037 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:18
2025-03-13 15:27:18,038 [INFO]: 814.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:18,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:27:18,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:18
2025-03-13 15:27:18,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:18,038 [INFO]: 	Creating the index 03/13/2025, 15:27:18
2025-03-13 15:27:18,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:18
2025-03-13 15:27:18,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:27:18,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:18
2025-03-13 15:27:18,039 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:27:18,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.32it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.96it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.75it/s]100%|██████████| 16/16 [00:03<00:00,  3.40it/s]100%|██████████| 16/16 [00:03<00:00,  4.58it/s]
2025-03-13 15:27:21,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:21
2025-03-13 15:28:03,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2003 secs
2025-03-13 15:28:03,735 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 15:28:03,735 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 15:28:25,497 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7610 secs
2025-03-13 15:28:25,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4612 secs
2025-03-13 15:28:25,500 [INFO]: {
2025-03-13 15:28:25,500 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:25,500 [INFO]: 	index_param: efSearch=144
2025-03-13 15:28:25,500 [INFO]: 	index_path: knn.index
2025-03-13 15:28:25,500 [INFO]: 	size in bytes: 776548750
2025-03-13 15:28:25,501 [INFO]: 	avg_search_speed_ms: 11.107896555784261
2025-03-13 15:28:25,501 [INFO]: 	99p_search_speed_ms: 25.255053462460634
2025-03-13 15:28:25,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:25,501 [INFO]: 	nb vectors: 3947
2025-03-13 15:28:25,501 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:25,501 [INFO]: 	compression ratio: 0.999308512182912
2025-03-13 15:28:25,501 [INFO]: }
2025-03-13 15:28:25,501 [INFO]: 	>>> Finished "Creating the index" in 67.4629 secs
2025-03-13 15:28:25,501 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4931 secs
2025-03-13 15:28:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 60510 [episode count 13/20]
[retrieval_preprocessing] for episode 54953 [episode count 14/20], we have num_retrieval=np.int64(4076) num_query=np.int64(220)
2025-03-13 15:28:28,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:29,101 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:29
2025-03-13 15:28:29,101 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 15:28:29,132 [INFO]: There are 4076 embeddings of dim 49152
2025-03-13 15:28:29,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 15:28:29,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:29
2025-03-13 15:28:29,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:29,134 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:28:29,134 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:29,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:28:29,134 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:29
2025-03-13 15:28:29,134 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:29,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:28:29,135 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:29
2025-03-13 15:28:29,135 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:28:29,135 [INFO]: 	Creating the index 03/13/2025, 15:28:29
2025-03-13 15:28:29,135 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:29
2025-03-13 15:28:29,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:28:29,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:29
2025-03-13 15:28:29,138 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:28:29,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.77it/s] 41%|████      | 7/17 [00:00<00:00, 34.55it/s] 71%|███████   | 12/17 [00:00<00:00, 40.88it/s]100%|██████████| 17/17 [00:03<00:00,  3.55it/s]100%|██████████| 17/17 [00:03<00:00,  4.94it/s]
2025-03-13 15:28:32,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:32
2025-03-13 15:29:17,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0254 secs
2025-03-13 15:29:17,613 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 15:29:17,613 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 15:29:47,483 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8694 secs
2025-03-13 15:29:47,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3482 secs
2025-03-13 15:29:47,487 [INFO]: {
2025-03-13 15:29:47,487 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:47,487 [INFO]: 	index_param: efSearch=136
2025-03-13 15:29:47,487 [INFO]: 	index_path: knn.index
2025-03-13 15:29:47,487 [INFO]: 	size in bytes: 801928630
2025-03-13 15:29:47,487 [INFO]: 	avg_search_speed_ms: 6.989381052840014
2025-03-13 15:29:47,487 [INFO]: 	99p_search_speed_ms: 10.800698562525213
2025-03-13 15:29:47,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:47,487 [INFO]: 	nb vectors: 4076
2025-03-13 15:29:47,487 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:47,487 [INFO]: 	compression ratio: 0.999308639223917
2025-03-13 15:29:47,487 [INFO]: }
2025-03-13 15:29:47,487 [INFO]: 	>>> Finished "Creating the index" in 78.3518 secs
2025-03-13 15:29:47,487 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3862 secs
2025-03-13 15:29:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 54953 [episode count 14/20]
[retrieval_preprocessing] for episode 24245 [episode count 15/20], we have num_retrieval=np.int64(4118) num_query=np.int64(178)
2025-03-13 15:29:49,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:50,239 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:50
2025-03-13 15:29:50,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1820.44it/s]
2025-03-13 15:29:50,271 [INFO]: There are 4118 embeddings of dim 49152
2025-03-13 15:29:50,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 15:29:50,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:50
2025-03-13 15:29:50,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:50,272 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:29:50,272 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:50,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:29:50,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:50
2025-03-13 15:29:50,272 [INFO]: 849.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:50,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:29:50,272 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:50
2025-03-13 15:29:50,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:50,272 [INFO]: 	Creating the index 03/13/2025, 15:29:50
2025-03-13 15:29:50,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:50
2025-03-13 15:29:50,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:29:50,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:50
2025-03-13 15:29:50,273 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:29:50,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.85it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.75it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.75it/s] 94%|█████████▍| 16/17 [00:00<00:00, 37.19it/s]100%|██████████| 17/17 [00:04<00:00,  4.16it/s]
2025-03-13 15:29:54,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:54
2025-03-13 15:30:41,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9829 secs
2025-03-13 15:30:41,346 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:30:41,347 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.08it/s]
2025-03-13 15:31:06,271 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9241 secs
2025-03-13 15:31:06,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0003 secs
2025-03-13 15:31:06,274 [INFO]: {
2025-03-13 15:31:06,274 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:06,274 [INFO]: 	index_param: efSearch=168
2025-03-13 15:31:06,274 [INFO]: 	index_path: knn.index
2025-03-13 15:31:06,274 [INFO]: 	size in bytes: 810191890
2025-03-13 15:31:06,274 [INFO]: 	avg_search_speed_ms: 9.800306719718684
2025-03-13 15:31:06,274 [INFO]: 	99p_search_speed_ms: 14.484142647124807
2025-03-13 15:31:06,274 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:06,274 [INFO]: 	nb vectors: 4118
2025-03-13 15:31:06,274 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:06,274 [INFO]: 	compression ratio: 0.9993086255158639
2025-03-13 15:31:06,274 [INFO]: }
2025-03-13 15:31:06,274 [INFO]: 	>>> Finished "Creating the index" in 76.0025 secs
2025-03-13 15:31:06,275 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0354 secs
2025-03-13 15:31:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 24245 [episode count 15/20]
[retrieval_preprocessing] for episode 39105 [episode count 16/20], we have num_retrieval=np.int64(4073) num_query=np.int64(223)
2025-03-13 15:31:11,010 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:11,723 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:11
2025-03-13 15:31:11,723 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.49it/s]
2025-03-13 15:31:11,756 [INFO]: There are 4073 embeddings of dim 49152
2025-03-13 15:31:11,757 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 15:31:11,757 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:11
2025-03-13 15:31:11,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:11,757 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:31:11,757 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:11,757 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:31:11,757 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:11
2025-03-13 15:31:11,758 [INFO]: 840.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:11,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:31:11,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:11
2025-03-13 15:31:11,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:11,758 [INFO]: 	Creating the index 03/13/2025, 15:31:11
2025-03-13 15:31:11,758 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:11
2025-03-13 15:31:11,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:31:11,761 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:11
2025-03-13 15:31:11,761 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:31:11,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.77it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.02it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.43it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.29it/s]100%|██████████| 17/17 [00:03<00:00,  4.87it/s]
2025-03-13 15:31:15,258 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:15
2025-03-13 15:31:58,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4275 secs
2025-03-13 15:31:58,686 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 15:31:58,686 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 15:32:22,796 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1098 secs
2025-03-13 15:32:22,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0385 secs
2025-03-13 15:32:22,800 [INFO]: {
2025-03-13 15:32:22,800 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:22,800 [INFO]: 	index_param: efSearch=161
2025-03-13 15:32:22,800 [INFO]: 	index_path: knn.index
2025-03-13 15:32:22,800 [INFO]: 	size in bytes: 801338410
2025-03-13 15:32:22,800 [INFO]: 	avg_search_speed_ms: 9.7554839375179
2025-03-13 15:32:22,800 [INFO]: 	99p_search_speed_ms: 13.773330990225077
2025-03-13 15:32:22,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:22,800 [INFO]: 	nb vectors: 4073
2025-03-13 15:32:22,800 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:22,800 [INFO]: 	compression ratio: 0.9993086241803885
2025-03-13 15:32:22,800 [INFO]: }
2025-03-13 15:32:22,800 [INFO]: 	>>> Finished "Creating the index" in 71.0419 secs
2025-03-13 15:32:22,800 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0773 secs
2025-03-13 15:32:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 39105 [episode count 16/20]
[retrieval_preprocessing] for episode 25803 [episode count 17/20], we have num_retrieval=np.int64(4074) num_query=np.int64(222)
2025-03-13 15:32:25,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:26,458 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:26
2025-03-13 15:32:26,458 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.64it/s]
2025-03-13 15:32:26,494 [INFO]: There are 4074 embeddings of dim 49152
2025-03-13 15:32:26,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 15:32:26,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:26
2025-03-13 15:32:26,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:26,494 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:32:26,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:26,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:26,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:26
2025-03-13 15:32:26,494 [INFO]: 840.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:26,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:26,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:26
2025-03-13 15:32:26,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:26,495 [INFO]: 	Creating the index 03/13/2025, 15:32:26
2025-03-13 15:32:26,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:26
2025-03-13 15:32:26,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:32:26,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:26
2025-03-13 15:32:26,496 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:32:26,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:04,  3.63it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.23it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.05it/s] 24%|██▎       | 4/17 [00:00<00:02,  6.47it/s] 29%|██▉       | 5/17 [00:00<00:01,  6.74it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.03it/s] 41%|████      | 7/17 [00:01<00:01,  7.13it/s] 47%|████▋     | 8/17 [00:01<00:01,  6.99it/s] 53%|█████▎    | 9/17 [00:01<00:01,  7.07it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.29it/s] 65%|██████▍   | 11/17 [00:01<00:00,  7.64it/s] 71%|███████   | 12/17 [00:01<00:00,  7.77it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.88it/s] 82%|████████▏ | 14/17 [00:01<00:00,  7.86it/s] 88%|████████▊ | 15/17 [00:02<00:00,  7.65it/s] 94%|█████████▍| 16/17 [00:02<00:00,  7.80it/s]100%|██████████| 17/17 [00:06<00:00,  1.25s/it]100%|██████████| 17/17 [00:06<00:00,  2.78it/s]
2025-03-13 15:32:32,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:32
2025-03-13 15:33:19,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8918 secs
2025-03-13 15:33:19,501 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:33:19,501 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 15:33:59,637 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1358 secs
2025-03-13 15:33:59,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.1438 secs
2025-03-13 15:33:59,640 [INFO]: {
2025-03-13 15:33:59,640 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:59,640 [INFO]: 	index_param: efSearch=173
2025-03-13 15:33:59,640 [INFO]: 	index_path: knn.index
2025-03-13 15:33:59,640 [INFO]: 	size in bytes: 801535150
2025-03-13 15:33:59,640 [INFO]: 	avg_search_speed_ms: 9.579222627480112
2025-03-13 15:33:59,640 [INFO]: 	99p_search_speed_ms: 16.52569924946874
2025-03-13 15:33:59,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:59,640 [INFO]: 	nb vectors: 4074
2025-03-13 15:33:59,640 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:59,640 [INFO]: 	compression ratio: 0.9993086291973596
2025-03-13 15:33:59,640 [INFO]: }
2025-03-13 15:33:59,640 [INFO]: 	>>> Finished "Creating the index" in 93.1454 secs
2025-03-13 15:33:59,640 [INFO]: >>> Finished "Launching the whole pipeline" in 93.1820 secs
2025-03-13 15:34:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 25803 [episode count 17/20]
[retrieval_preprocessing] for episode 78077 [episode count 18/20], we have num_retrieval=np.int64(4107) num_query=np.int64(189)
2025-03-13 15:34:01,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:03,365 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:03
2025-03-13 15:34:03,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.77it/s]
2025-03-13 15:34:03,393 [INFO]: There are 4107 embeddings of dim 49152
2025-03-13 15:34:03,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:34:03,394 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:03
2025-03-13 15:34:03,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:03,394 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:34:03,394 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:03,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:34:03,394 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:03
2025-03-13 15:34:03,395 [INFO]: 847.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:03,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:34:03,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:03
2025-03-13 15:34:03,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:03,395 [INFO]: 	Creating the index 03/13/2025, 15:34:03
2025-03-13 15:34:03,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:03
2025-03-13 15:34:03,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:34:03,398 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:03
2025-03-13 15:34:03,398 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:34:03,398 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.89it/s] 41%|████      | 7/17 [00:00<00:00, 32.38it/s] 71%|███████   | 12/17 [00:00<00:00, 37.34it/s]100%|██████████| 17/17 [00:03<00:00,  3.05it/s]100%|██████████| 17/17 [00:03<00:00,  4.26it/s]
2025-03-13 15:34:07,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:07
2025-03-13 15:34:57,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.5379 secs
2025-03-13 15:34:57,938 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 15:34:57,938 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-13 15:35:22,839 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9001 secs
2025-03-13 15:35:22,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4439 secs
2025-03-13 15:35:22,842 [INFO]: {
2025-03-13 15:35:22,842 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:22,842 [INFO]: 	index_param: efSearch=110
2025-03-13 15:35:22,842 [INFO]: 	index_path: knn.index
2025-03-13 15:35:22,842 [INFO]: 	size in bytes: 808027690
2025-03-13 15:35:22,842 [INFO]: 	avg_search_speed_ms: 6.873680287940088
2025-03-13 15:35:22,842 [INFO]: 	99p_search_speed_ms: 9.638196425512435
2025-03-13 15:35:22,842 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:22,842 [INFO]: 	nb vectors: 4107
2025-03-13 15:35:22,842 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:22,842 [INFO]: 	compression ratio: 0.9993086449797284
2025-03-13 15:35:22,842 [INFO]: }
2025-03-13 15:35:22,842 [INFO]: 	>>> Finished "Creating the index" in 79.4468 secs
2025-03-13 15:35:22,842 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4770 secs
2025-03-13 15:35:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 78077 [episode count 18/20]
[retrieval_preprocessing] for episode 70398 [episode count 19/20], we have num_retrieval=np.int64(4092) num_query=np.int64(204)
2025-03-13 15:35:24,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:25,792 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:25
2025-03-13 15:35:25,792 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1578.59it/s]
2025-03-13 15:35:25,826 [INFO]: There are 4092 embeddings of dim 49152
2025-03-13 15:35:25,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 15:35:25,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:25,827 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:35:25,827 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:25,827 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:35:25,827 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,827 [INFO]: 844.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:25,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:35:25,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:25
2025-03-13 15:35:25,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:25,827 [INFO]: 	Creating the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:25
2025-03-13 15:35:25,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:35:25,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,828 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:35:25,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.98it/s] 29%|██▉       | 5/17 [00:00<00:00, 26.34it/s] 53%|█████▎    | 9/17 [00:00<00:00, 32.29it/s] 82%|████████▏ | 14/17 [00:00<00:00, 36.83it/s]100%|██████████| 17/17 [00:03<00:00,  4.63it/s]
2025-03-13 15:35:29,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:29
2025-03-13 15:36:12,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9256 secs
2025-03-13 15:36:12,427 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 15:36:12,427 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 15:36:42,043 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6164 secs
2025-03-13 15:36:42,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2177 secs
2025-03-13 15:36:42,046 [INFO]: {
2025-03-13 15:36:42,046 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:42,046 [INFO]: 	index_param: efSearch=164
2025-03-13 15:36:42,046 [INFO]: 	index_path: knn.index
2025-03-13 15:36:42,046 [INFO]: 	size in bytes: 805076530
2025-03-13 15:36:42,046 [INFO]: 	avg_search_speed_ms: 9.03452190195312
2025-03-13 15:36:42,046 [INFO]: 	99p_search_speed_ms: 12.802663994953038
2025-03-13 15:36:42,046 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:42,046 [INFO]: 	nb vectors: 4092
2025-03-13 15:36:42,046 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:42,046 [INFO]: 	compression ratio: 0.9993086446079853
2025-03-13 15:36:42,046 [INFO]: }
2025-03-13 15:36:42,046 [INFO]: 	>>> Finished "Creating the index" in 76.2193 secs
2025-03-13 15:36:42,046 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2547 secs
2025-03-13 15:36:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 70398 [episode count 19/20]
2025-03-13 15:36:43: [retrieval_preprocessing] finished for 452818143_lid_off_pot_on_table [chosen_id count 1/196]
2025-03-13 15:36:46: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 452818143_lid_on_container [chosen_id count 2/196]
2025-03-13 15:36:46: [retrieval_preprocessing] we have num_total=8209 embedding_dim=49152
[retrieval_preprocessing] for episode 85526 [episode count 0/20], we have num_retrieval=np.int64(7695) num_query=np.int64(514)
2025-03-13 15:36:47,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:48,404 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:48
2025-03-13 15:36:48,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.73it/s]
2025-03-13 15:36:48,434 [INFO]: There are 7695 embeddings of dim 49152
2025-03-13 15:36:48,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:36:48,435 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:48
2025-03-13 15:36:48,435 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:48,435 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 15:36:48,435 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:48,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:36:48,436 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:48
2025-03-13 15:36:48,436 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:48,436 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:36:48,436 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:48
2025-03-13 15:36:48,437 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:48,437 [INFO]: 	Creating the index 03/13/2025, 15:36:48
2025-03-13 15:36:48,437 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:48
2025-03-13 15:36:48,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:36:48,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:48
2025-03-13 15:36:48,440 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:36:48,441 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.00it/s] 16%|█▌        | 5/32 [00:00<00:01, 22.83it/s] 28%|██▊       | 9/32 [00:00<00:00, 29.61it/s] 41%|████      | 13/32 [00:00<00:00, 32.68it/s] 53%|█████▎    | 17/32 [00:00<00:00, 34.70it/s] 66%|██████▌   | 21/32 [00:05<00:04,  2.29it/s] 78%|███████▊  | 25/32 [00:05<00:02,  3.36it/s] 88%|████████▊ | 28/32 [00:06<00:01,  3.42it/s]100%|██████████| 32/32 [00:10<00:00,  1.81it/s]100%|██████████| 32/32 [00:10<00:00,  3.06it/s]
2025-03-13 15:36:58,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:58
2025-03-13 15:38:19,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.0609 secs
2025-03-13 15:38:19,973 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:38:19,973 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 15:39:23,272 [INFO]: 	>>> Finished "Compute fast metrics" in 63.2994 secs
2025-03-13 15:39:23,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.8342 secs
2025-03-13 15:39:23,275 [INFO]: {
2025-03-13 15:39:23,275 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:23,275 [INFO]: 	index_param: efSearch=160
2025-03-13 15:39:23,275 [INFO]: 	index_path: knn.index
2025-03-13 15:39:23,275 [INFO]: 	size in bytes: 1513946110
2025-03-13 15:39:23,275 [INFO]: 	avg_search_speed_ms: 9.686852412753154
2025-03-13 15:39:23,275 [INFO]: 	99p_search_speed_ms: 19.344411788042628
2025-03-13 15:39:23,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:23,275 [INFO]: 	nb vectors: 7695
2025-03-13 15:39:23,275 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:23,275 [INFO]: 	compression ratio: 0.9993080665202806
2025-03-13 15:39:23,275 [INFO]: }
2025-03-13 15:39:23,275 [INFO]: 	>>> Finished "Creating the index" in 154.8381 secs
2025-03-13 15:39:23,275 [INFO]: >>> Finished "Launching the whole pipeline" in 154.8707 secs
2025-03-13 15:39:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 85526 [episode count 0/20]
[retrieval_preprocessing] for episode 65082 [episode count 1/20], we have num_retrieval=np.int64(7958) num_query=np.int64(251)
2025-03-13 15:39:28,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:30,169 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:30
2025-03-13 15:39:30,169 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.43it/s]
2025-03-13 15:39:30,203 [INFO]: There are 7958 embeddings of dim 49152
2025-03-13 15:39:30,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 15:39:30,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:30
2025-03-13 15:39:30,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:30,204 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 15:39:30,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:30,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:39:30,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:30
2025-03-13 15:39:30,204 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:30,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:39:30,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:30
2025-03-13 15:39:30,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:30,204 [INFO]: 	Creating the index 03/13/2025, 15:39:30
2025-03-13 15:39:30,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:30
2025-03-13 15:39:30,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:39:30,206 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:30
2025-03-13 15:39:30,206 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:39:30,206 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  4.96it/s] 12%|█▏        | 4/33 [00:00<00:01, 15.10it/s] 24%|██▍       | 8/33 [00:00<00:01, 21.86it/s] 36%|███▋      | 12/33 [00:00<00:00, 25.70it/s] 48%|████▊     | 16/33 [00:00<00:00, 28.87it/s] 64%|██████▎   | 21/33 [00:06<00:05,  2.10it/s] 76%|███████▌  | 25/33 [00:06<00:02,  3.02it/s] 91%|█████████ | 30/33 [00:06<00:00,  4.58it/s]100%|██████████| 33/33 [00:09<00:00,  3.54it/s]
2025-03-13 15:39:39,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:39
2025-03-13 15:40:46,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.5757 secs
2025-03-13 15:40:46,118 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:40:46,118 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.81it/s]
2025-03-13 15:41:26,224 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1061 secs
2025-03-13 15:41:26,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.0206 secs
2025-03-13 15:41:26,227 [INFO]: {
2025-03-13 15:41:26,227 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:26,227 [INFO]: 	index_param: efSearch=187
2025-03-13 15:41:26,227 [INFO]: 	index_path: knn.index
2025-03-13 15:41:26,227 [INFO]: 	size in bytes: 1565689690
2025-03-13 15:41:26,227 [INFO]: 	avg_search_speed_ms: 12.188002070691097
2025-03-13 15:41:26,227 [INFO]: 	99p_search_speed_ms: 18.10525651089847
2025-03-13 15:41:26,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:26,227 [INFO]: 	nb vectors: 7958
2025-03-13 15:41:26,227 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:26,227 [INFO]: 	compression ratio: 0.9993081477083751
2025-03-13 15:41:26,227 [INFO]: }
2025-03-13 15:41:26,227 [INFO]: 	>>> Finished "Creating the index" in 116.0229 secs
2025-03-13 15:41:26,227 [INFO]: >>> Finished "Launching the whole pipeline" in 116.0581 secs
2025-03-13 15:41:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 65082 [episode count 1/20]
[retrieval_preprocessing] for episode 56382 [episode count 2/20], we have num_retrieval=np.int64(7677) num_query=np.int64(532)
2025-03-13 15:41:29,592 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:30,855 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:30
2025-03-13 15:41:30,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 909.24it/s]
2025-03-13 15:41:30,885 [INFO]: There are 7677 embeddings of dim 49152
2025-03-13 15:41:30,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 15:41:30,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:30
2025-03-13 15:41:30,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:30,887 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 15:41:30,887 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:30,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:41:30,887 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:30
2025-03-13 15:41:30,887 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:30,888 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:41:30,888 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:30
2025-03-13 15:41:30,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:41:30,888 [INFO]: 	Creating the index 03/13/2025, 15:41:30
2025-03-13 15:41:30,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:30
2025-03-13 15:41:30,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:41:30,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:30
2025-03-13 15:41:30,893 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:41:30,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.11it/s] 16%|█▌        | 5/32 [00:00<00:01, 26.14it/s] 31%|███▏      | 10/32 [00:00<00:00, 33.28it/s] 47%|████▋     | 15/32 [00:00<00:00, 36.34it/s] 62%|██████▎   | 20/32 [00:00<00:00, 38.02it/s] 75%|███████▌  | 24/32 [00:04<00:02,  2.96it/s] 91%|█████████ | 29/32 [00:04<00:00,  4.45it/s]100%|██████████| 32/32 [00:07<00:00,  4.35it/s]
2025-03-13 15:41:38,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:38
2025-03-13 15:42:48,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.9696 secs
2025-03-13 15:42:48,225 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:42:48,225 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-13 15:43:20,654 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4289 secs
2025-03-13 15:43:21,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.3974 secs
2025-03-13 15:43:21,290 [INFO]: {
2025-03-13 15:43:21,290 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:21,290 [INFO]: 	index_param: efSearch=209
2025-03-13 15:43:21,290 [INFO]: 	index_path: knn.index
2025-03-13 15:43:21,291 [INFO]: 	size in bytes: 1510404730
2025-03-13 15:43:21,291 [INFO]: 	avg_search_speed_ms: 11.843519233519862
2025-03-13 15:43:21,291 [INFO]: 	99p_search_speed_ms: 19.69987011514604
2025-03-13 15:43:21,291 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:21,291 [INFO]: 	nb vectors: 7677
2025-03-13 15:43:21,291 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:21,291 [INFO]: 	compression ratio: 0.9993080569868183
2025-03-13 15:43:21,291 [INFO]: }
2025-03-13 15:43:21,291 [INFO]: 	>>> Finished "Creating the index" in 110.4024 secs
2025-03-13 15:43:21,291 [INFO]: >>> Finished "Launching the whole pipeline" in 110.4358 secs
2025-03-13 15:43:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 56382 [episode count 2/20]
[retrieval_preprocessing] for episode 26810 [episode count 3/20], we have num_retrieval=np.int64(7612) num_query=np.int64(597)
2025-03-13 15:43:27,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:28,663 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:28
2025-03-13 15:43:28,663 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-13 15:43:28,691 [INFO]: There are 7612 embeddings of dim 49152
2025-03-13 15:43:28,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:43:28,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:28
2025-03-13 15:43:28,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:28,692 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 15:43:28,692 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:28,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:43:28,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:28
2025-03-13 15:43:28,693 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:28,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:43:28,693 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:28
2025-03-13 15:43:28,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:28,693 [INFO]: 	Creating the index 03/13/2025, 15:43:28
2025-03-13 15:43:28,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:28
2025-03-13 15:43:28,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:43:28,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:28
2025-03-13 15:43:28,697 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:43:28,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.49it/s] 19%|█▉        | 6/31 [00:00<00:00, 31.03it/s] 35%|███▌      | 11/31 [00:00<00:00, 37.40it/s] 52%|█████▏    | 16/31 [00:00<00:00, 40.35it/s] 68%|██████▊   | 21/31 [00:04<00:03,  3.31it/s] 84%|████████▍ | 26/31 [00:04<00:01,  4.93it/s]100%|██████████| 31/31 [00:06<00:00,  3.13it/s]100%|██████████| 31/31 [00:07<00:00,  4.43it/s]
2025-03-13 15:43:35,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:35
2025-03-13 15:44:43,440 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.7351 secs
2025-03-13 15:44:43,441 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 15:44:43,441 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 15:45:31,203 [INFO]: 	>>> Finished "Compute fast metrics" in 47.7626 secs
2025-03-13 15:45:31,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.5083 secs
2025-03-13 15:45:31,205 [INFO]: {
2025-03-13 15:45:31,205 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:31,205 [INFO]: 	index_param: efSearch=208
2025-03-13 15:45:31,205 [INFO]: 	index_path: knn.index
2025-03-13 15:45:31,205 [INFO]: 	size in bytes: 1497616270
2025-03-13 15:45:31,206 [INFO]: 	avg_search_speed_ms: 11.868390598260353
2025-03-13 15:45:31,206 [INFO]: 	99p_search_speed_ms: 16.13464114256203
2025-03-13 15:45:31,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:31,206 [INFO]: 	nb vectors: 7612
2025-03-13 15:45:31,206 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:31,206 [INFO]: 	compression ratio: 0.999308117826471
2025-03-13 15:45:31,206 [INFO]: }
2025-03-13 15:45:31,206 [INFO]: 	>>> Finished "Creating the index" in 122.5121 secs
2025-03-13 15:45:31,206 [INFO]: >>> Finished "Launching the whole pipeline" in 122.5430 secs
2025-03-13 15:45:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 26810 [episode count 3/20]
[retrieval_preprocessing] for episode 51937 [episode count 4/20], we have num_retrieval=np.int64(7917) num_query=np.int64(292)
2025-03-13 15:45:37,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:38,972 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:38
2025-03-13 15:45:38,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.38it/s]
2025-03-13 15:45:38,999 [INFO]: There are 7917 embeddings of dim 49152
2025-03-13 15:45:38,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:45:38,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:38
2025-03-13 15:45:39,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:39,000 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 15:45:39,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:39,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:39,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,000 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:39,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:45:39,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:39
2025-03-13 15:45:39,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:39,000 [INFO]: 	Creating the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:39
2025-03-13 15:45:39,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:45:39,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,001 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 15:45:39,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.48it/s] 15%|█▌        | 5/33 [00:00<00:01, 23.09it/s] 30%|███       | 10/33 [00:00<00:00, 33.69it/s] 45%|████▌     | 15/33 [00:00<00:00, 39.45it/s] 61%|██████    | 20/33 [00:00<00:00, 42.32it/s] 76%|███████▌  | 25/33 [00:05<00:02,  2.79it/s] 88%|████████▊ | 29/33 [00:05<00:01,  3.83it/s]100%|██████████| 33/33 [00:09<00:00,  2.00it/s]100%|██████████| 33/33 [00:09<00:00,  3.41it/s]
2025-03-13 15:45:48,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:48
2025-03-13 15:47:04,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.7831 secs
2025-03-13 15:47:04,474 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:47:04,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.72it/s]
2025-03-13 15:47:35,673 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1987 secs
2025-03-13 15:47:35,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.6737 secs
2025-03-13 15:47:35,675 [INFO]: {
2025-03-13 15:47:35,675 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:35,675 [INFO]: 	index_param: efSearch=190
2025-03-13 15:47:35,675 [INFO]: 	index_path: knn.index
2025-03-13 15:47:35,675 [INFO]: 	size in bytes: 1557623170
2025-03-13 15:47:35,675 [INFO]: 	avg_search_speed_ms: 11.693860207853174
2025-03-13 15:47:35,675 [INFO]: 	99p_search_speed_ms: 17.980261696502566
2025-03-13 15:47:35,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:35,675 [INFO]: 	nb vectors: 7917
2025-03-13 15:47:35,675 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:35,675 [INFO]: 	compression ratio: 0.9993081548729145
2025-03-13 15:47:35,675 [INFO]: }
2025-03-13 15:47:35,676 [INFO]: 	>>> Finished "Creating the index" in 116.6755 secs
2025-03-13 15:47:35,676 [INFO]: >>> Finished "Launching the whole pipeline" in 116.7030 secs
2025-03-13 15:47:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 51937 [episode count 4/20]
[retrieval_preprocessing] for episode 34066 [episode count 5/20], we have num_retrieval=np.int64(7790) num_query=np.int64(419)
2025-03-13 15:47:39,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:40,586 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:40
2025-03-13 15:47:40,586 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 15:47:40,610 [INFO]: There are 7790 embeddings of dim 49152
2025-03-13 15:47:40,611 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 15:47:40,611 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:40
2025-03-13 15:47:40,611 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:40,611 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 15:47:40,611 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:40,611 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:40,611 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:40
2025-03-13 15:47:40,611 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:40,611 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:47:40,611 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:40
2025-03-13 15:47:40,611 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:40,611 [INFO]: 	Creating the index 03/13/2025, 15:47:40
2025-03-13 15:47:40,611 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:40
2025-03-13 15:47:40,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:47:40,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:40
2025-03-13 15:47:40,612 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:47:40,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.51it/s] 12%|█▎        | 4/32 [00:00<00:01, 19.19it/s] 28%|██▊       | 9/32 [00:00<00:00, 30.03it/s] 44%|████▍     | 14/32 [00:00<00:00, 34.74it/s] 59%|█████▉    | 19/32 [00:00<00:00, 37.21it/s] 72%|███████▏  | 23/32 [00:09<00:06,  1.33it/s] 81%|████████▏ | 26/32 [00:13<00:05,  1.13it/s] 88%|████████▊ | 28/32 [00:14<00:03,  1.29it/s]100%|██████████| 32/32 [00:17<00:00,  1.23it/s]100%|██████████| 32/32 [00:17<00:00,  1.80it/s]
2025-03-13 15:47:58,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:58
2025-03-13 15:49:08,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.3821 secs
2025-03-13 15:49:08,797 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:49:08,797 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 15:50:14,935 [INFO]: 	>>> Finished "Compute fast metrics" in 66.1374 secs
2025-03-13 15:50:14,947 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.3348 secs
2025-03-13 15:50:14,947 [INFO]: {
2025-03-13 15:50:14,947 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:14,947 [INFO]: 	index_param: efSearch=177
2025-03-13 15:50:14,948 [INFO]: 	index_path: knn.index
2025-03-13 15:50:14,948 [INFO]: 	size in bytes: 1532636890
2025-03-13 15:50:14,948 [INFO]: 	avg_search_speed_ms: 9.61727550960719
2025-03-13 15:50:14,948 [INFO]: 	99p_search_speed_ms: 14.17303577763958
2025-03-13 15:50:14,948 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:14,948 [INFO]: 	nb vectors: 7790
2025-03-13 15:50:14,948 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:14,948 [INFO]: 	compression ratio: 0.9993080096095038
2025-03-13 15:50:14,948 [INFO]: }
2025-03-13 15:50:14,948 [INFO]: 	>>> Finished "Creating the index" in 154.3364 secs
2025-03-13 15:50:14,948 [INFO]: >>> Finished "Launching the whole pipeline" in 154.3613 secs
2025-03-13 15:50:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 34066 [episode count 5/20]
[retrieval_preprocessing] for episode 76773 [episode count 6/20], we have num_retrieval=np.int64(7725) num_query=np.int64(484)
2025-03-13 15:50:19,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:21,217 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:21
2025-03-13 15:50:21,217 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 933.52it/s]
2025-03-13 15:50:21,243 [INFO]: There are 7725 embeddings of dim 49152
2025-03-13 15:50:21,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:50:21,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:21
2025-03-13 15:50:21,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:21,243 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 15:50:21,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:21,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:50:21,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:21
2025-03-13 15:50:21,244 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:21,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:50:21,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:21
2025-03-13 15:50:21,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:21,244 [INFO]: 	Creating the index 03/13/2025, 15:50:21
2025-03-13 15:50:21,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:21
2025-03-13 15:50:21,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:50:21,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:21
2025-03-13 15:50:21,245 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:50:21,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.16it/s] 16%|█▌        | 5/32 [00:00<00:01, 23.56it/s] 28%|██▊       | 9/32 [00:00<00:00, 29.13it/s] 41%|████      | 13/32 [00:00<00:00, 32.00it/s] 53%|█████▎    | 17/32 [00:00<00:00, 32.84it/s] 66%|██████▌   | 21/32 [00:05<00:05,  2.12it/s] 78%|███████▊  | 25/32 [00:05<00:02,  3.11it/s] 94%|█████████▍| 30/32 [00:05<00:00,  4.77it/s]100%|██████████| 32/32 [00:09<00:00,  3.47it/s]
2025-03-13 15:50:30,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:30
2025-03-13 15:51:40,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.8279 secs
2025-03-13 15:51:40,309 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:51:40,309 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-13 15:52:20,379 [INFO]: 	>>> Finished "Compute fast metrics" in 40.0692 secs
2025-03-13 15:52:20,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.1353 secs
2025-03-13 15:52:20,381 [INFO]: {
2025-03-13 15:52:20,381 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:20,381 [INFO]: 	index_param: efSearch=200
2025-03-13 15:52:20,381 [INFO]: 	index_path: knn.index
2025-03-13 15:52:20,381 [INFO]: 	size in bytes: 1519848490
2025-03-13 15:52:20,381 [INFO]: 	avg_search_speed_ms: 11.736115058140715
2025-03-13 15:52:20,381 [INFO]: 	99p_search_speed_ms: 18.0183205800131
2025-03-13 15:52:20,381 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:20,381 [INFO]: 	nb vectors: 7725
2025-03-13 15:52:20,381 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:20,381 [INFO]: 	compression ratio: 0.9993080297102509
2025-03-13 15:52:20,381 [INFO]: }
2025-03-13 15:52:20,381 [INFO]: 	>>> Finished "Creating the index" in 119.1370 secs
2025-03-13 15:52:20,381 [INFO]: >>> Finished "Launching the whole pipeline" in 119.1641 secs
2025-03-13 15:52:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 76773 [episode count 6/20]
[retrieval_preprocessing] for episode 17394 [episode count 7/20], we have num_retrieval=np.int64(7835) num_query=np.int64(374)
2025-03-13 15:52:26,261 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:28,117 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:28
2025-03-13 15:52:28,117 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.08it/s]
2025-03-13 15:52:28,143 [INFO]: There are 7835 embeddings of dim 49152
2025-03-13 15:52:28,143 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:52:28,143 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:28
2025-03-13 15:52:28,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:28,144 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 15:52:28,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:28,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:28,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:28
2025-03-13 15:52:28,144 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:28,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:52:28,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:28
2025-03-13 15:52:28,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:28,144 [INFO]: 	Creating the index 03/13/2025, 15:52:28
2025-03-13 15:52:28,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:28
2025-03-13 15:52:28,145 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:52:28,145 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:28
2025-03-13 15:52:28,145 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:52:28,145 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  7.93it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.62it/s] 34%|███▍      | 11/32 [00:00<00:00, 36.30it/s] 50%|█████     | 16/32 [00:00<00:00, 40.01it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.27it/s] 81%|████████▏ | 26/32 [00:04<00:01,  4.87it/s] 97%|█████████▋| 31/32 [00:04<00:00,  6.98it/s]100%|██████████| 32/32 [00:07<00:00,  4.44it/s]
2025-03-13 15:52:35,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:35
2025-03-13 15:53:51,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.8446 secs
2025-03-13 15:53:51,197 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:53:51,197 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.53it/s]
2025-03-13 15:54:48,393 [INFO]: 	>>> Finished "Compute fast metrics" in 57.1963 secs
2025-03-13 15:54:48,396 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.2509 secs
2025-03-13 15:54:48,396 [INFO]: {
2025-03-13 15:54:48,396 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:48,396 [INFO]: 	index_param: efSearch=173
2025-03-13 15:54:48,396 [INFO]: 	index_path: knn.index
2025-03-13 15:54:48,396 [INFO]: 	size in bytes: 1541490310
2025-03-13 15:54:48,396 [INFO]: 	avg_search_speed_ms: 9.488508230308513
2025-03-13 15:54:48,396 [INFO]: 	99p_search_speed_ms: 13.592669460922481
2025-03-13 15:54:48,396 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:48,396 [INFO]: 	nb vectors: 7835
2025-03-13 15:54:48,396 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:48,396 [INFO]: 	compression ratio: 0.9993080527376134
2025-03-13 15:54:48,396 [INFO]: }
2025-03-13 15:54:48,396 [INFO]: 	>>> Finished "Creating the index" in 140.2524 secs
2025-03-13 15:54:48,396 [INFO]: >>> Finished "Launching the whole pipeline" in 140.2797 secs
2025-03-13 15:54:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 17394 [episode count 7/20]
[retrieval_preprocessing] for episode 57842 [episode count 8/20], we have num_retrieval=np.int64(7698) num_query=np.int64(511)
2025-03-13 15:54:53,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:55,268 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:55
2025-03-13 15:54:55,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.80it/s]
2025-03-13 15:54:55,295 [INFO]: There are 7698 embeddings of dim 49152
2025-03-13 15:54:55,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:54:55,295 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:55
2025-03-13 15:54:55,296 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:55,296 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 15:54:55,296 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:55,296 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:54:55,296 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:55
2025-03-13 15:54:55,296 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:55,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:55,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:55
2025-03-13 15:54:55,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:55,296 [INFO]: 	Creating the index 03/13/2025, 15:54:55
2025-03-13 15:54:55,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:55
2025-03-13 15:54:55,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:54:55,298 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:55
2025-03-13 15:54:55,298 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:54:55,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.11it/s] 12%|█▎        | 4/32 [00:00<00:01, 18.14it/s] 22%|██▏       | 7/32 [00:00<00:01, 21.57it/s] 31%|███▏      | 10/32 [00:00<00:00, 23.64it/s] 44%|████▍     | 14/32 [00:00<00:00, 28.05it/s] 56%|█████▋    | 18/32 [00:00<00:00, 30.74it/s] 69%|██████▉   | 22/32 [00:05<00:04,  2.23it/s] 81%|████████▏ | 26/32 [00:05<00:01,  3.28it/s] 94%|█████████▍| 30/32 [00:05<00:00,  4.66it/s]100%|██████████| 32/32 [00:08<00:00,  3.63it/s]
2025-03-13 15:55:04,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:04
2025-03-13 15:56:14,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.0932 secs
2025-03-13 15:56:14,254 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 15:56:14,254 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.32it/s]
2025-03-13 15:56:45,713 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4593 secs
2025-03-13 15:56:45,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.4176 secs
2025-03-13 15:56:45,716 [INFO]: {
2025-03-13 15:56:45,716 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:45,716 [INFO]: 	index_param: efSearch=118
2025-03-13 15:56:45,716 [INFO]: 	index_path: knn.index
2025-03-13 15:56:45,716 [INFO]: 	size in bytes: 1514536330
2025-03-13 15:56:45,716 [INFO]: 	avg_search_speed_ms: 8.327143825125336
2025-03-13 15:56:45,716 [INFO]: 	99p_search_speed_ms: 15.72411204688251
2025-03-13 15:56:45,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:45,716 [INFO]: 	nb vectors: 7698
2025-03-13 15:56:45,716 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:45,716 [INFO]: 	compression ratio: 0.9993080747029687
2025-03-13 15:56:45,716 [INFO]: }
2025-03-13 15:56:45,716 [INFO]: 	>>> Finished "Creating the index" in 110.4195 secs
2025-03-13 15:56:45,716 [INFO]: >>> Finished "Launching the whole pipeline" in 110.4476 secs
2025-03-13 15:56:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 57842 [episode count 8/20]
[retrieval_preprocessing] for episode 89880 [episode count 9/20], we have num_retrieval=np.int64(7811) num_query=np.int64(398)
2025-03-13 15:56:49,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:50,788 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:50
2025-03-13 15:56:50,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.38it/s]
2025-03-13 15:56:50,817 [INFO]: There are 7811 embeddings of dim 49152
2025-03-13 15:56:50,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:56:50,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:50
2025-03-13 15:56:50,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:50,818 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 15:56:50,818 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:50,819 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:56:50,819 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:50
2025-03-13 15:56:50,819 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:50,819 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:56:50,819 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:50
2025-03-13 15:56:50,819 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:50,820 [INFO]: 	Creating the index 03/13/2025, 15:56:50
2025-03-13 15:56:50,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:50
2025-03-13 15:56:50,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:56:50,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:50
2025-03-13 15:56:50,823 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:56:50,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.00it/s] 19%|█▉        | 6/32 [00:00<00:00, 27.99it/s] 34%|███▍      | 11/32 [00:00<00:00, 34.75it/s] 50%|█████     | 16/32 [00:00<00:00, 38.07it/s] 66%|██████▌   | 21/32 [00:04<00:04,  2.74it/s] 81%|████████▏ | 26/32 [00:05<00:01,  4.11it/s] 97%|█████████▋| 31/32 [00:05<00:00,  5.94it/s]100%|██████████| 32/32 [00:07<00:00,  4.02it/s]
2025-03-13 15:56:58,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:58
2025-03-13 15:58:10,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.7437 secs
2025-03-13 15:58:10,541 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:58:10,541 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 15:59:10,500 [INFO]: 	>>> Finished "Compute fast metrics" in 59.9595 secs
2025-03-13 15:59:10,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.6798 secs
2025-03-13 15:59:10,503 [INFO]: {
2025-03-13 15:59:10,503 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:10,503 [INFO]: 	index_param: efSearch=212
2025-03-13 15:59:10,503 [INFO]: 	index_path: knn.index
2025-03-13 15:59:10,503 [INFO]: 	size in bytes: 1536768430
2025-03-13 15:59:10,503 [INFO]: 	avg_search_speed_ms: 13.685852562799724
2025-03-13 15:59:10,503 [INFO]: 	99p_search_speed_ms: 20.678232004866008
2025-03-13 15:59:10,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:10,503 [INFO]: 	nb vectors: 7811
2025-03-13 15:59:10,503 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:10,503 [INFO]: 	compression ratio: 0.9993080662126824
2025-03-13 15:59:10,503 [INFO]: }
2025-03-13 15:59:10,503 [INFO]: 	>>> Finished "Creating the index" in 139.6836 secs
2025-03-13 15:59:10,503 [INFO]: >>> Finished "Launching the whole pipeline" in 139.7152 secs
2025-03-13 15:59:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 89880 [episode count 9/20]
[retrieval_preprocessing] for episode 94491 [episode count 10/20], we have num_retrieval=np.int64(7887) num_query=np.int64(322)
2025-03-13 15:59:15,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:16,797 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:16
2025-03-13 15:59:16,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 36.11it/s]
2025-03-13 15:59:16,852 [INFO]: There are 7887 embeddings of dim 49152
2025-03-13 15:59:16,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0554 secs
2025-03-13 15:59:16,853 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:16
2025-03-13 15:59:16,853 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:16,853 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 15:59:16,853 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:16,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:59:16,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:16
2025-03-13 15:59:16,853 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:16,853 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:59:16,854 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:16
2025-03-13 15:59:16,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:16,854 [INFO]: 	Creating the index 03/13/2025, 15:59:16
2025-03-13 15:59:16,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:16
2025-03-13 15:59:16,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:59:16,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:16
2025-03-13 15:59:16,857 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:59:16,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.92it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.10it/s] 33%|███▎      | 11/33 [00:00<00:00, 36.06it/s] 48%|████▊     | 16/33 [00:00<00:00, 40.10it/s] 64%|██████▎   | 21/33 [00:06<00:05,  2.15it/s] 79%|███████▉  | 26/33 [00:06<00:02,  3.26it/s] 97%|█████████▋| 32/33 [00:06<00:00,  5.05it/s]100%|██████████| 33/33 [00:09<00:00,  3.63it/s]
2025-03-13 15:59:26,607 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:26
2025-03-13 16:00:38,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.7323 secs
2025-03-13 16:00:38,341 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 16:00:38,341 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-13 16:01:33,550 [INFO]: 	>>> Finished "Compute fast metrics" in 55.2086 secs
2025-03-13 16:01:33,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.6952 secs
2025-03-13 16:01:33,552 [INFO]: {
2025-03-13 16:01:33,552 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:33,552 [INFO]: 	index_param: efSearch=209
2025-03-13 16:01:33,552 [INFO]: 	index_path: knn.index
2025-03-13 16:01:33,552 [INFO]: 	size in bytes: 1551720910
2025-03-13 16:01:33,552 [INFO]: 	avg_search_speed_ms: 12.155616842380036
2025-03-13 16:01:33,552 [INFO]: 	99p_search_speed_ms: 20.12816471047699
2025-03-13 16:01:33,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:33,552 [INFO]: 	nb vectors: 7887
2025-03-13 16:01:33,552 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:33,552 [INFO]: 	compression ratio: 0.9993081139829455
2025-03-13 16:01:33,552 [INFO]: }
2025-03-13 16:01:33,552 [INFO]: 	>>> Finished "Creating the index" in 136.6983 secs
2025-03-13 16:01:33,552 [INFO]: >>> Finished "Launching the whole pipeline" in 136.7547 secs
2025-03-13 16:01:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 94491 [episode count 10/20]
[retrieval_preprocessing] for episode 54591 [episode count 11/20], we have num_retrieval=np.int64(7620) num_query=np.int64(589)
2025-03-13 16:01:37,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:38,839 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:38
2025-03-13 16:01:38,839 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 939.16it/s]
2025-03-13 16:01:38,867 [INFO]: There are 7620 embeddings of dim 49152
2025-03-13 16:01:38,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 16:01:38,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:38
2025-03-13 16:01:38,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:38,867 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 16:01:38,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:38,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:38,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:38
2025-03-13 16:01:38,868 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:38,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:01:38,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:38
2025-03-13 16:01:38,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:38,868 [INFO]: 	Creating the index 03/13/2025, 16:01:38
2025-03-13 16:01:38,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:38
2025-03-13 16:01:38,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:01:38,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:38
2025-03-13 16:01:38,869 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:01:38,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.59it/s] 16%|█▌        | 5/31 [00:00<00:01, 21.76it/s] 32%|███▏      | 10/31 [00:00<00:00, 30.62it/s] 48%|████▊     | 15/31 [00:00<00:00, 35.73it/s] 65%|██████▍   | 20/31 [00:00<00:00, 38.60it/s] 77%|███████▋  | 24/31 [00:05<00:02,  2.74it/s] 87%|████████▋ | 27/31 [00:05<00:01,  3.48it/s] 97%|█████████▋| 30/31 [00:05<00:00,  4.39it/s]100%|██████████| 31/31 [00:08<00:00,  3.54it/s]
2025-03-13 16:01:47,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:47
2025-03-13 16:03:02,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.4357 secs
2025-03-13 16:03:02,062 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 16:03:02,062 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 16:04:18,991 [INFO]: 	>>> Finished "Compute fast metrics" in 76.9294 secs
2025-03-13 16:04:18,994 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.1251 secs
2025-03-13 16:04:18,994 [INFO]: {
2025-03-13 16:04:18,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:18,995 [INFO]: 	index_param: efSearch=228
2025-03-13 16:04:18,995 [INFO]: 	index_path: knn.index
2025-03-13 16:04:18,995 [INFO]: 	size in bytes: 1499190310
2025-03-13 16:04:18,995 [INFO]: 	avg_search_speed_ms: 12.440525528173245
2025-03-13 16:04:18,995 [INFO]: 	99p_search_speed_ms: 20.583787662908446
2025-03-13 16:04:18,995 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:18,995 [INFO]: 	nb vectors: 7620
2025-03-13 16:04:18,995 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:18,995 [INFO]: 	compression ratio: 0.9993080598286418
2025-03-13 16:04:18,995 [INFO]: }
2025-03-13 16:04:18,995 [INFO]: 	>>> Finished "Creating the index" in 160.1268 secs
2025-03-13 16:04:18,995 [INFO]: >>> Finished "Launching the whole pipeline" in 160.1559 secs
2025-03-13 16:04:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 54591 [episode count 11/20]
[retrieval_preprocessing] for episode 50487 [episode count 12/20], we have num_retrieval=np.int64(7791) num_query=np.int64(418)
2025-03-13 16:04:32,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:33,702 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:33
2025-03-13 16:04:33,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.27it/s]
2025-03-13 16:04:33,734 [INFO]: There are 7791 embeddings of dim 49152
2025-03-13 16:04:33,735 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 16:04:33,735 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:33
2025-03-13 16:04:33,735 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:33,735 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:04:33,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:33,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:04:33,735 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:33
2025-03-13 16:04:33,735 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:33,735 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:04:33,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:33
2025-03-13 16:04:33,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:33,736 [INFO]: 	Creating the index 03/13/2025, 16:04:33
2025-03-13 16:04:33,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:33
2025-03-13 16:04:33,737 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:04:33,737 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:33
2025-03-13 16:04:33,737 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:04:33,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:08,  3.85it/s]  6%|▋         | 2/32 [00:00<00:05,  5.23it/s]  9%|▉         | 3/32 [00:00<00:04,  6.65it/s] 12%|█▎        | 4/32 [00:00<00:03,  7.60it/s] 16%|█▌        | 5/32 [00:00<00:03,  8.29it/s] 19%|█▉        | 6/32 [00:00<00:02,  8.75it/s] 25%|██▌       | 8/32 [00:00<00:02, 11.14it/s] 31%|███▏      | 10/32 [00:01<00:02, 10.39it/s] 38%|███▊      | 12/32 [00:01<00:01, 10.48it/s] 44%|████▍     | 14/32 [00:01<00:01, 10.47it/s] 50%|█████     | 16/32 [00:01<00:01, 10.49it/s] 56%|█████▋    | 18/32 [00:01<00:01, 10.46it/s] 62%|██████▎   | 20/32 [00:02<00:01, 10.22it/s] 69%|██████▉   | 22/32 [00:07<00:08,  1.21it/s] 75%|███████▌  | 24/32 [00:07<00:04,  1.66it/s] 78%|███████▊  | 25/32 [00:07<00:03,  1.95it/s] 81%|████████▏ | 26/32 [00:07<00:02,  2.33it/s] 91%|█████████ | 29/32 [00:07<00:00,  4.09it/s]100%|██████████| 32/32 [00:11<00:00,  1.41it/s]100%|██████████| 32/32 [00:11<00:00,  2.72it/s]
2025-03-13 16:04:45,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:45
2025-03-13 16:06:11,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.5297 secs
2025-03-13 16:06:11,030 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 16:06:11,030 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-13 16:07:05,431 [INFO]: 	>>> Finished "Compute fast metrics" in 54.4009 secs
2025-03-13 16:07:05,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.6965 secs
2025-03-13 16:07:05,434 [INFO]: {
2025-03-13 16:07:05,434 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:05,434 [INFO]: 	index_param: efSearch=167
2025-03-13 16:07:05,434 [INFO]: 	index_path: knn.index
2025-03-13 16:07:05,434 [INFO]: 	size in bytes: 1532833630
2025-03-13 16:07:05,434 [INFO]: 	avg_search_speed_ms: 10.62666060652133
2025-03-13 16:07:05,434 [INFO]: 	99p_search_speed_ms: 21.708810303825885
2025-03-13 16:07:05,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:05,434 [INFO]: 	nb vectors: 7791
2025-03-13 16:07:05,434 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:05,434 [INFO]: 	compression ratio: 0.9993080123118123
2025-03-13 16:07:05,434 [INFO]: }
2025-03-13 16:07:05,434 [INFO]: 	>>> Finished "Creating the index" in 151.6987 secs
2025-03-13 16:07:05,434 [INFO]: >>> Finished "Launching the whole pipeline" in 151.7326 secs
2025-03-13 16:07:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 50487 [episode count 12/20]
[retrieval_preprocessing] for episode 18745 [episode count 13/20], we have num_retrieval=np.int64(7896) num_query=np.int64(313)
2025-03-13 16:07:10,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:12,171 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:12
2025-03-13 16:07:12,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 795.58it/s]
2025-03-13 16:07:12,205 [INFO]: There are 7896 embeddings of dim 49152
2025-03-13 16:07:12,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 16:07:12,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:12
2025-03-13 16:07:12,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:12,206 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:07:12,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:12,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:12,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:12
2025-03-13 16:07:12,206 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:12,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:07:12,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:12
2025-03-13 16:07:12,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:12,206 [INFO]: 	Creating the index 03/13/2025, 16:07:12
2025-03-13 16:07:12,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:12
2025-03-13 16:07:12,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:07:12,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:12
2025-03-13 16:07:12,208 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:07:12,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.34it/s]  6%|▌         | 2/33 [00:00<00:04,  6.24it/s]  9%|▉         | 3/33 [00:00<00:04,  7.18it/s] 12%|█▏        | 4/33 [00:00<00:03,  7.83it/s] 15%|█▌        | 5/33 [00:00<00:03,  8.34it/s] 18%|█▊        | 6/33 [00:00<00:03,  8.72it/s] 24%|██▍       | 8/33 [00:00<00:02,  9.45it/s] 30%|███       | 10/33 [00:01<00:02,  9.87it/s] 36%|███▋      | 12/33 [00:01<00:02, 10.07it/s] 39%|███▉      | 13/33 [00:01<00:02,  9.96it/s] 42%|████▏     | 14/33 [00:01<00:01,  9.93it/s] 48%|████▊     | 16/33 [00:01<00:01,  9.62it/s] 52%|█████▏    | 17/33 [00:01<00:01,  8.97it/s] 55%|█████▍    | 18/33 [00:02<00:01,  8.60it/s] 58%|█████▊    | 19/33 [00:02<00:01,  8.36it/s] 61%|██████    | 20/33 [00:02<00:01,  8.23it/s] 64%|██████▎   | 21/33 [00:07<00:17,  1.49s/it] 70%|██████▉   | 23/33 [00:07<00:08,  1.16it/s] 79%|███████▉  | 26/33 [00:07<00:03,  2.16it/s] 88%|████████▊ | 29/33 [00:07<00:01,  3.43it/s] 97%|█████████▋| 32/33 [00:07<00:00,  4.97it/s]100%|██████████| 33/33 [00:12<00:00,  2.73it/s]
2025-03-13 16:07:24,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:24
2025-03-13 16:08:40,464 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.1750 secs
2025-03-13 16:08:40,465 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:08:40,465 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 16:09:55,753 [INFO]: 	>>> Finished "Compute fast metrics" in 75.2880 secs
2025-03-13 16:09:55,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 163.5754 secs
2025-03-13 16:09:55,783 [INFO]: {
2025-03-13 16:09:55,783 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:55,783 [INFO]: 	index_param: efSearch=192
2025-03-13 16:09:55,784 [INFO]: 	index_path: knn.index
2025-03-13 16:09:55,784 [INFO]: 	size in bytes: 1553491630
2025-03-13 16:09:55,784 [INFO]: 	avg_search_speed_ms: 9.105690120285095
2025-03-13 16:09:55,784 [INFO]: 	99p_search_speed_ms: 13.044363560620694
2025-03-13 16:09:55,784 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:55,784 [INFO]: 	nb vectors: 7896
2025-03-13 16:09:55,784 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:55,784 [INFO]: 	compression ratio: 0.9993080992653948
2025-03-13 16:09:55,784 [INFO]: }
2025-03-13 16:09:55,784 [INFO]: 	>>> Finished "Creating the index" in 163.5776 secs
2025-03-13 16:09:55,784 [INFO]: >>> Finished "Launching the whole pipeline" in 163.6123 secs
2025-03-13 16:09:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18745 [episode count 13/20]
[retrieval_preprocessing] for episode 34959 [episode count 14/20], we have num_retrieval=np.int64(7789) num_query=np.int64(420)
2025-03-13 16:09:58,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:59,992 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:59
2025-03-13 16:09:59,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1541.46it/s]
2025-03-13 16:10:00,024 [INFO]: There are 7789 embeddings of dim 49152
2025-03-13 16:10:00,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 16:10:00,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:00
2025-03-13 16:10:00,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:00,025 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:10:00,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:00,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:10:00,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:00
2025-03-13 16:10:00,026 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:00,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:10:00,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:00
2025-03-13 16:10:00,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:00,027 [INFO]: 	Creating the index 03/13/2025, 16:10:00
2025-03-13 16:10:00,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:00
2025-03-13 16:10:00,031 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:10:00,031 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:00
2025-03-13 16:10:00,031 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:10:00,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.34it/s] 16%|█▌        | 5/32 [00:00<00:01, 25.05it/s] 28%|██▊       | 9/32 [00:00<00:00, 30.98it/s] 41%|████      | 13/32 [00:00<00:00, 33.97it/s] 53%|█████▎    | 17/32 [00:00<00:00, 35.44it/s] 66%|██████▌   | 21/32 [00:04<00:04,  2.49it/s] 81%|████████▏ | 26/32 [00:04<00:01,  3.94it/s]100%|██████████| 32/32 [00:07<00:00,  2.91it/s]100%|██████████| 32/32 [00:07<00:00,  4.08it/s]
2025-03-13 16:10:07,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:07
2025-03-13 16:11:33,303 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4018 secs
2025-03-13 16:11:33,303 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 16:11:33,304 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-13 16:12:16,067 [INFO]: 	>>> Finished "Compute fast metrics" in 42.7633 secs
2025-03-13 16:12:16,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.0380 secs
2025-03-13 16:12:16,069 [INFO]: {
2025-03-13 16:12:16,069 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:16,069 [INFO]: 	index_param: efSearch=135
2025-03-13 16:12:16,069 [INFO]: 	index_path: knn.index
2025-03-13 16:12:16,069 [INFO]: 	size in bytes: 1532440150
2025-03-13 16:12:16,069 [INFO]: 	avg_search_speed_ms: 7.63798851521246
2025-03-13 16:12:16,069 [INFO]: 	99p_search_speed_ms: 11.198151968419552
2025-03-13 16:12:16,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:16,069 [INFO]: 	nb vectors: 7789
2025-03-13 16:12:16,069 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:16,069 [INFO]: 	compression ratio: 0.9993080069065013
2025-03-13 16:12:16,069 [INFO]: }
2025-03-13 16:12:16,069 [INFO]: 	>>> Finished "Creating the index" in 136.0423 secs
2025-03-13 16:12:16,070 [INFO]: >>> Finished "Launching the whole pipeline" in 136.0773 secs
2025-03-13 16:12:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 34959 [episode count 14/20]
[retrieval_preprocessing] for episode 60654 [episode count 15/20], we have num_retrieval=np.int64(7860) num_query=np.int64(349)
2025-03-13 16:12:19,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:21,194 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:21
2025-03-13 16:12:21,194 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-13 16:12:21,219 [INFO]: There are 7860 embeddings of dim 49152
2025-03-13 16:12:21,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 16:12:21,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:21,219 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:12:21,219 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:21,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:21,220 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,220 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:21,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:21,220 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:21
2025-03-13 16:12:21,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:21,220 [INFO]: 	Creating the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,220 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:21
2025-03-13 16:12:21,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 16:12:21,222 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,222 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:12:21,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.85it/s] 16%|█▌        | 5/32 [00:00<00:01, 20.79it/s] 31%|███▏      | 10/32 [00:00<00:00, 30.71it/s] 47%|████▋     | 15/32 [00:00<00:00, 36.44it/s] 62%|██████▎   | 20/32 [00:00<00:00, 40.04it/s] 78%|███████▊  | 25/32 [00:04<00:02,  2.99it/s] 97%|█████████▋| 31/32 [00:05<00:00,  4.69it/s]100%|██████████| 32/32 [00:07<00:00,  4.11it/s]
2025-03-13 16:12:29,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:29
2025-03-13 16:14:02,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.9877 secs
2025-03-13 16:14:02,000 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:14:02,000 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 16:14:53,294 [INFO]: 	>>> Finished "Compute fast metrics" in 51.2933 secs
2025-03-13 16:14:53,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.0738 secs
2025-03-13 16:14:53,296 [INFO]: {
2025-03-13 16:14:53,296 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:53,296 [INFO]: 	index_param: efSearch=226
2025-03-13 16:14:53,296 [INFO]: 	index_path: knn.index
2025-03-13 16:14:53,296 [INFO]: 	size in bytes: 1546408870
2025-03-13 16:14:53,296 [INFO]: 	avg_search_speed_ms: 12.428684482027007
2025-03-13 16:14:53,296 [INFO]: 	99p_search_speed_ms: 17.63789862394333
2025-03-13 16:14:53,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:53,296 [INFO]: 	nb vectors: 7860
2025-03-13 16:14:53,296 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:53,296 [INFO]: 	compression ratio: 0.9993080807923715
2025-03-13 16:14:53,296 [INFO]: }
2025-03-13 16:14:53,296 [INFO]: 	>>> Finished "Creating the index" in 152.0761 secs
2025-03-13 16:14:53,296 [INFO]: >>> Finished "Launching the whole pipeline" in 152.1018 secs
2025-03-13 16:14:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 60654 [episode count 15/20]
[retrieval_preprocessing] for episode 32377 [episode count 16/20], we have num_retrieval=np.int64(7864) num_query=np.int64(345)
2025-03-13 16:15:00,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:01,680 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:01
2025-03-13 16:15:01,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1033.33it/s]
2025-03-13 16:15:01,709 [INFO]: There are 7864 embeddings of dim 49152
2025-03-13 16:15:01,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:15:01,709 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,709 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:01,709 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:15:01,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:01,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:01,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,710 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:01,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:15:01,710 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:01
2025-03-13 16:15:01,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:01,710 [INFO]: 	Creating the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,710 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:01
2025-03-13 16:15:01,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:15:01,711 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,711 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:15:01,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:06,  4.91it/s]  9%|▉         | 3/32 [00:00<00:03,  8.36it/s] 16%|█▌        | 5/32 [00:00<00:02,  9.43it/s] 19%|█▉        | 6/32 [00:00<00:02,  9.51it/s] 25%|██▌       | 8/32 [00:00<00:02, 10.15it/s] 31%|███▏      | 10/32 [00:01<00:02, 10.53it/s] 38%|███▊      | 12/32 [00:01<00:01, 10.76it/s] 44%|████▍     | 14/32 [00:01<00:01, 10.62it/s] 50%|█████     | 16/32 [00:01<00:01, 10.54it/s] 56%|█████▋    | 18/32 [00:01<00:01, 10.52it/s] 62%|██████▎   | 20/32 [00:01<00:01, 10.44it/s] 69%|██████▉   | 22/32 [00:07<00:09,  1.04it/s] 78%|███████▊  | 25/32 [00:07<00:04,  1.68it/s] 88%|████████▊ | 28/32 [00:08<00:01,  2.53it/s] 97%|█████████▋| 31/32 [00:08<00:00,  3.65it/s]100%|██████████| 32/32 [00:12<00:00,  2.57it/s]
2025-03-13 16:15:14,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:14
2025-03-13 16:16:26,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.5505 secs
2025-03-13 16:16:26,709 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:16:26,709 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.33it/s]
2025-03-13 16:17:23,662 [INFO]: 	>>> Finished "Compute fast metrics" in 56.9534 secs
2025-03-13 16:17:23,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.9541 secs
2025-03-13 16:17:23,666 [INFO]: {
2025-03-13 16:17:23,666 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:23,666 [INFO]: 	index_param: efSearch=220
2025-03-13 16:17:23,666 [INFO]: 	index_path: knn.index
2025-03-13 16:17:23,666 [INFO]: 	size in bytes: 1547195830
2025-03-13 16:17:23,666 [INFO]: 	avg_search_speed_ms: 13.04622573020347
2025-03-13 16:17:23,666 [INFO]: 	99p_search_speed_ms: 20.925945593044165
2025-03-13 16:17:23,666 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:23,666 [INFO]: 	nb vectors: 7864
2025-03-13 16:17:23,666 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:23,666 [INFO]: 	compression ratio: 0.9993080914650604
2025-03-13 16:17:23,666 [INFO]: }
2025-03-13 16:17:23,666 [INFO]: 	>>> Finished "Creating the index" in 141.9560 secs
2025-03-13 16:17:23,666 [INFO]: >>> Finished "Launching the whole pipeline" in 141.9856 secs
2025-03-13 16:17:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 32377 [episode count 16/20]
[retrieval_preprocessing] for episode 2650 [episode count 17/20], we have num_retrieval=np.int64(7852) num_query=np.int64(357)
2025-03-13 16:17:29,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:32,032 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:32
2025-03-13 16:17:32,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1183.16it/s]
2025-03-13 16:17:32,063 [INFO]: There are 7852 embeddings of dim 49152
2025-03-13 16:17:32,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 16:17:32,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:32
2025-03-13 16:17:32,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:32,064 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:17:32,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:32,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:32,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:32
2025-03-13 16:17:32,064 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:32,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:32,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:32
2025-03-13 16:17:32,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:32,064 [INFO]: 	Creating the index 03/13/2025, 16:17:32
2025-03-13 16:17:32,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:32
2025-03-13 16:17:32,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:17:32,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:32
2025-03-13 16:17:32,066 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:17:32,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.27it/s] 12%|█▎        | 4/32 [00:00<00:01, 16.34it/s] 25%|██▌       | 8/32 [00:00<00:01, 23.77it/s] 38%|███▊      | 12/32 [00:00<00:00, 27.62it/s] 50%|█████     | 16/32 [00:00<00:00, 29.86it/s] 62%|██████▎   | 20/32 [00:00<00:00, 31.21it/s] 75%|███████▌  | 24/32 [00:05<00:03,  2.18it/s] 88%|████████▊ | 28/32 [00:05<00:01,  3.15it/s]100%|██████████| 32/32 [00:09<00:00,  1.93it/s]100%|██████████| 32/32 [00:09<00:00,  3.28it/s]
2025-03-13 16:17:41,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:41
2025-03-13 16:18:57,141 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.3122 secs
2025-03-13 16:18:57,141 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 16:18:57,141 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.97it/s] 50%|█████     | 2/4 [00:00<00:00,  4.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.42it/s]
2025-03-13 16:19:41,978 [INFO]: 	>>> Finished "Compute fast metrics" in 44.8368 secs
2025-03-13 16:19:41,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.9155 secs
2025-03-13 16:19:41,982 [INFO]: {
2025-03-13 16:19:41,982 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:41,982 [INFO]: 	index_param: efSearch=196
2025-03-13 16:19:41,982 [INFO]: 	index_path: knn.index
2025-03-13 16:19:41,982 [INFO]: 	size in bytes: 1544834890
2025-03-13 16:19:41,982 [INFO]: 	avg_search_speed_ms: 15.04106208528007
2025-03-13 16:19:41,982 [INFO]: 	99p_search_speed_ms: 32.533266274258494
2025-03-13 16:19:41,982 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:41,982 [INFO]: 	nb vectors: 7852
2025-03-13 16:19:41,982 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:41,982 [INFO]: 	compression ratio: 0.9993080982266008
2025-03-13 16:19:41,982 [INFO]: }
2025-03-13 16:19:41,982 [INFO]: 	>>> Finished "Creating the index" in 129.9174 secs
2025-03-13 16:19:41,982 [INFO]: >>> Finished "Launching the whole pipeline" in 129.9497 secs
2025-03-13 16:19:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 2650 [episode count 17/20]
[retrieval_preprocessing] for episode 82811 [episode count 18/20], we have num_retrieval=np.int64(7834) num_query=np.int64(375)
2025-03-13 16:19:47,825 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:48,975 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:48
2025-03-13 16:19:48,975 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1364.00it/s]
2025-03-13 16:19:49,002 [INFO]: There are 7834 embeddings of dim 49152
2025-03-13 16:19:49,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 16:19:49,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:49
2025-03-13 16:19:49,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:49,003 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:19:49,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:49,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:19:49,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:49
2025-03-13 16:19:49,003 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:49,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:19:49,003 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:49
2025-03-13 16:19:49,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:49,003 [INFO]: 	Creating the index 03/13/2025, 16:19:49
2025-03-13 16:19:49,003 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:49
2025-03-13 16:19:49,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:19:49,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:49
2025-03-13 16:19:49,005 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:19:49,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.72it/s] 16%|█▌        | 5/32 [00:00<00:01, 21.61it/s] 31%|███▏      | 10/32 [00:00<00:00, 31.27it/s] 47%|████▋     | 15/32 [00:00<00:00, 36.26it/s] 62%|██████▎   | 20/32 [00:00<00:00, 39.22it/s] 78%|███████▊  | 25/32 [00:04<00:02,  3.22it/s] 94%|█████████▍| 30/32 [00:04<00:00,  4.72it/s]100%|██████████| 32/32 [00:07<00:00,  4.03it/s]
2025-03-13 16:19:56,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:56
2025-03-13 16:21:05,024 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.0695 secs
2025-03-13 16:21:05,024 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:21:05,024 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.87it/s]
2025-03-13 16:21:44,647 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6221 secs
2025-03-13 16:21:44,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.6438 secs
2025-03-13 16:21:44,649 [INFO]: {
2025-03-13 16:21:44,649 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:44,649 [INFO]: 	index_param: efSearch=216
2025-03-13 16:21:44,649 [INFO]: 	index_path: knn.index
2025-03-13 16:21:44,649 [INFO]: 	size in bytes: 1541293570
2025-03-13 16:21:44,649 [INFO]: 	avg_search_speed_ms: 13.80042869244413
2025-03-13 16:21:44,649 [INFO]: 	99p_search_speed_ms: 25.970402564853412
2025-03-13 16:21:44,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:44,649 [INFO]: 	nb vectors: 7834
2025-03-13 16:21:44,649 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:44,649 [INFO]: 	compression ratio: 0.9993080500556425
2025-03-13 16:21:44,649 [INFO]: }
2025-03-13 16:21:44,649 [INFO]: 	>>> Finished "Creating the index" in 115.6454 secs
2025-03-13 16:21:44,649 [INFO]: >>> Finished "Launching the whole pipeline" in 115.6738 secs
2025-03-13 16:21:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 82811 [episode count 18/20]
[retrieval_preprocessing] for episode 12403 [episode count 19/20], we have num_retrieval=np.int64(7860) num_query=np.int64(349)
2025-03-13 16:21:48,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:50,192 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:50
2025-03-13 16:21:50,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.76it/s]
2025-03-13 16:21:50,217 [INFO]: There are 7860 embeddings of dim 49152
2025-03-13 16:21:50,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:21:50,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:50
2025-03-13 16:21:50,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:50,218 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 16:21:50,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:50,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:50,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:50
2025-03-13 16:21:50,218 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:50,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:50,218 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:50
2025-03-13 16:21:50,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:50,218 [INFO]: 	Creating the index 03/13/2025, 16:21:50
2025-03-13 16:21:50,218 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:50
2025-03-13 16:21:50,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:21:50,219 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:50
2025-03-13 16:21:50,220 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 16:21:50,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.16it/s] 19%|█▉        | 6/32 [00:00<00:00, 26.87it/s] 34%|███▍      | 11/32 [00:00<00:00, 35.10it/s] 50%|█████     | 16/32 [00:00<00:00, 39.47it/s] 66%|██████▌   | 21/32 [00:04<00:03,  2.86it/s] 81%|████████▏ | 26/32 [00:04<00:01,  4.29it/s] 97%|█████████▋| 31/32 [00:05<00:00,  6.17it/s]100%|██████████| 32/32 [00:07<00:00,  4.11it/s]
2025-03-13 16:21:58,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:58
2025-03-13 16:23:01,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.9487 secs
2025-03-13 16:23:01,967 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:23:01,967 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-13 16:24:08,398 [INFO]: 	>>> Finished "Compute fast metrics" in 66.4308 secs
2025-03-13 16:24:08,413 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.1939 secs
2025-03-13 16:24:08,414 [INFO]: {
2025-03-13 16:24:08,414 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:08,414 [INFO]: 	index_param: efSearch=238
2025-03-13 16:24:08,414 [INFO]: 	index_path: knn.index
2025-03-13 16:24:08,414 [INFO]: 	size in bytes: 1546408870
2025-03-13 16:24:08,414 [INFO]: 	avg_search_speed_ms: 13.64375385017443
2025-03-13 16:24:08,414 [INFO]: 	99p_search_speed_ms: 19.67568770982325
2025-03-13 16:24:08,414 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:08,414 [INFO]: 	nb vectors: 7860
2025-03-13 16:24:08,414 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:08,414 [INFO]: 	compression ratio: 0.9993080807923715
2025-03-13 16:24:08,414 [INFO]: }
2025-03-13 16:24:08,414 [INFO]: 	>>> Finished "Creating the index" in 138.1956 secs
2025-03-13 16:24:08,414 [INFO]: >>> Finished "Launching the whole pipeline" in 138.2221 secs
2025-03-13 16:24:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 12403 [episode count 19/20]
2025-03-13 16:24:13: [retrieval_preprocessing] finished for 452818143_lid_on_container [chosen_id count 2/196]
2025-03-13 16:24:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4569686640_wipe_plate_with_blue_towel [chosen_id count 3/196]
2025-03-13 16:24:16: [retrieval_preprocessing] we have num_total=7569 embedding_dim=49152
[retrieval_preprocessing] for episode 13834 [episode count 0/20], we have num_retrieval=np.int64(7188) num_query=np.int64(381)
2025-03-13 16:24:17,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:19,465 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:19
2025-03-13 16:24:19,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.91it/s]
2025-03-13 16:24:19,495 [INFO]: There are 7188 embeddings of dim 49152
2025-03-13 16:24:19,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 16:24:19,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:19
2025-03-13 16:24:19,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:19,495 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:24:19,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:19,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:19,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:19
2025-03-13 16:24:19,496 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:19,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:24:19,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:19
2025-03-13 16:24:19,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:19,496 [INFO]: 	Creating the index 03/13/2025, 16:24:19
2025-03-13 16:24:19,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:19
2025-03-13 16:24:19,497 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:24:19,497 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:19
2025-03-13 16:24:19,497 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:24:19,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.80it/s] 17%|█▋        | 5/30 [00:00<00:01, 21.24it/s] 30%|███       | 9/30 [00:00<00:00, 27.89it/s] 43%|████▎     | 13/30 [00:00<00:00, 31.33it/s] 57%|█████▋    | 17/30 [00:00<00:00, 32.89it/s] 70%|███████   | 21/30 [00:05<00:04,  2.08it/s] 83%|████████▎ | 25/30 [00:05<00:01,  3.05it/s]100%|██████████| 30/30 [00:08<00:00,  2.61it/s]100%|██████████| 30/30 [00:08<00:00,  3.62it/s]
2025-03-13 16:24:27,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:27
2025-03-13 16:25:36,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.8266 secs
2025-03-13 16:25:36,605 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 16:25:36,605 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-13 16:26:30,825 [INFO]: 	>>> Finished "Compute fast metrics" in 54.2194 secs
2025-03-13 16:26:30,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.3290 secs
2025-03-13 16:26:30,826 [INFO]: {
2025-03-13 16:26:30,826 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:30,826 [INFO]: 	index_param: efSearch=249
2025-03-13 16:26:30,827 [INFO]: 	index_path: knn.index
2025-03-13 16:26:30,827 [INFO]: 	size in bytes: 1414196590
2025-03-13 16:26:30,827 [INFO]: 	avg_search_speed_ms: 11.066045312044022
2025-03-13 16:26:30,827 [INFO]: 	99p_search_speed_ms: 14.899258045479655
2025-03-13 16:26:30,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:30,827 [INFO]: 	nb vectors: 7188
2025-03-13 16:26:30,827 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:30,827 [INFO]: 	compression ratio: 0.999308239033443
2025-03-13 16:26:30,827 [INFO]: }
2025-03-13 16:26:30,827 [INFO]: 	>>> Finished "Creating the index" in 131.3307 secs
2025-03-13 16:26:30,827 [INFO]: >>> Finished "Launching the whole pipeline" in 131.3617 secs
2025-03-13 16:26:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 13834 [episode count 0/20]
[retrieval_preprocessing] for episode 25614 [episode count 1/20], we have num_retrieval=np.int64(7096) num_query=np.int64(473)
2025-03-13 16:26:35,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:37,198 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:37
2025-03-13 16:26:37,198 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.35it/s]
2025-03-13 16:26:37,227 [INFO]: There are 7096 embeddings of dim 49152
2025-03-13 16:26:37,227 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:26:37,227 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:37
2025-03-13 16:26:37,227 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:37,227 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:26:37,227 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:37,227 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:37,227 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:37
2025-03-13 16:26:37,228 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:37,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:26:37,228 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:37
2025-03-13 16:26:37,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:37,228 [INFO]: 	Creating the index 03/13/2025, 16:26:37
2025-03-13 16:26:37,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:37
2025-03-13 16:26:37,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:26:37,229 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:37
2025-03-13 16:26:37,229 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:26:37,229 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.73it/s] 21%|██        | 6/29 [00:00<00:00, 29.02it/s] 38%|███▊      | 11/29 [00:00<00:00, 36.68it/s] 55%|█████▌    | 16/29 [00:00<00:00, 40.46it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.02it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.53it/s]100%|██████████| 29/29 [00:07<00:00,  3.99it/s]
2025-03-13 16:26:44,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:44
2025-03-13 16:27:46,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2593 secs
2025-03-13 16:27:46,768 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:27:46,768 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-13 16:28:55,754 [INFO]: 	>>> Finished "Compute fast metrics" in 68.9860 secs
2025-03-13 16:28:55,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.5260 secs
2025-03-13 16:28:55,755 [INFO]: {
2025-03-13 16:28:55,755 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:55,755 [INFO]: 	index_param: efSearch=145
2025-03-13 16:28:55,755 [INFO]: 	index_path: knn.index
2025-03-13 16:28:55,755 [INFO]: 	size in bytes: 1396095970
2025-03-13 16:28:55,755 [INFO]: 	avg_search_speed_ms: 8.726628457828316
2025-03-13 16:28:55,755 [INFO]: 	99p_search_speed_ms: 12.39845139207318
2025-03-13 16:28:55,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:55,755 [INFO]: 	nb vectors: 7096
2025-03-13 16:28:55,755 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:55,755 [INFO]: 	compression ratio: 0.9993083555709998
2025-03-13 16:28:55,755 [INFO]: }
2025-03-13 16:28:55,756 [INFO]: 	>>> Finished "Creating the index" in 138.5278 secs
2025-03-13 16:28:55,756 [INFO]: >>> Finished "Launching the whole pipeline" in 138.5575 secs
2025-03-13 16:28:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 25614 [episode count 1/20]
[retrieval_preprocessing] for episode 18977 [episode count 2/20], we have num_retrieval=np.int64(7184) num_query=np.int64(385)
2025-03-13 16:28:59,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:01,003 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:01
2025-03-13 16:29:01,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.21it/s]
2025-03-13 16:29:01,032 [INFO]: There are 7184 embeddings of dim 49152
2025-03-13 16:29:01,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 16:29:01,032 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:01
2025-03-13 16:29:01,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:01,033 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:29:01,033 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:01,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:01,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:01
2025-03-13 16:29:01,033 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:01,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:29:01,033 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:01
2025-03-13 16:29:01,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:01,033 [INFO]: 	Creating the index 03/13/2025, 16:29:01
2025-03-13 16:29:01,033 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:01
2025-03-13 16:29:01,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:29:01,034 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:01
2025-03-13 16:29:01,034 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:29:01,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.15it/s] 17%|█▋        | 5/30 [00:00<00:01, 20.21it/s] 30%|███       | 9/30 [00:00<00:00, 26.20it/s] 43%|████▎     | 13/30 [00:00<00:00, 29.19it/s] 57%|█████▋    | 17/30 [00:00<00:00, 30.77it/s] 70%|███████   | 21/30 [00:05<00:03,  2.32it/s] 83%|████████▎ | 25/30 [00:05<00:01,  3.39it/s] 97%|█████████▋| 29/30 [00:05<00:00,  4.82it/s]100%|██████████| 30/30 [00:07<00:00,  3.89it/s]
2025-03-13 16:29:08,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:08
2025-03-13 16:30:17,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.7570 secs
2025-03-13 16:30:17,509 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 16:30:17,509 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.33it/s]
2025-03-13 16:30:54,655 [INFO]: 	>>> Finished "Compute fast metrics" in 37.1454 secs
2025-03-13 16:30:54,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.6226 secs
2025-03-13 16:30:54,657 [INFO]: {
2025-03-13 16:30:54,657 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:54,657 [INFO]: 	index_param: efSearch=152
2025-03-13 16:30:54,657 [INFO]: 	index_path: knn.index
2025-03-13 16:30:54,657 [INFO]: 	size in bytes: 1413409630
2025-03-13 16:30:54,657 [INFO]: 	avg_search_speed_ms: 8.945583343782424
2025-03-13 16:30:54,657 [INFO]: 	99p_search_speed_ms: 12.481256420724087
2025-03-13 16:30:54,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:54,657 [INFO]: 	nb vectors: 7184
2025-03-13 16:30:54,657 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:54,657 [INFO]: 	compression ratio: 0.9993082274386371
2025-03-13 16:30:54,657 [INFO]: }
2025-03-13 16:30:54,657 [INFO]: 	>>> Finished "Creating the index" in 113.6241 secs
2025-03-13 16:30:54,657 [INFO]: >>> Finished "Launching the whole pipeline" in 113.6534 secs
2025-03-13 16:30:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18977 [episode count 2/20]
[retrieval_preprocessing] for episode 21041 [episode count 3/20], we have num_retrieval=np.int64(7258) num_query=np.int64(311)
2025-03-13 16:30:58,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:00,621 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:00
2025-03-13 16:31:00,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.97it/s]
2025-03-13 16:31:00,651 [INFO]: There are 7258 embeddings of dim 49152
2025-03-13 16:31:00,651 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 16:31:00,651 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:00
2025-03-13 16:31:00,651 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:00,651 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:31:00,651 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:00,651 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:00,651 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:00
2025-03-13 16:31:00,652 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:00,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:31:00,652 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:00
2025-03-13 16:31:00,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:00,652 [INFO]: 	Creating the index 03/13/2025, 16:31:00
2025-03-13 16:31:00,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:00
2025-03-13 16:31:00,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:31:00,653 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:00
2025-03-13 16:31:00,653 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:31:00,653 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.27it/s] 20%|██        | 6/30 [00:00<00:00, 26.20it/s] 37%|███▋      | 11/30 [00:00<00:00, 33.20it/s] 53%|█████▎    | 16/30 [00:00<00:00, 35.79it/s] 67%|██████▋   | 20/30 [00:00<00:00, 36.63it/s] 80%|████████  | 24/30 [00:05<00:02,  2.54it/s] 97%|█████████▋| 29/30 [00:05<00:00,  3.88it/s]100%|██████████| 30/30 [00:07<00:00,  3.85it/s]
2025-03-13 16:31:08,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:08
2025-03-13 16:32:05,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5910 secs
2025-03-13 16:32:05,042 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 16:32:05,042 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-13 16:32:57,991 [INFO]: 	>>> Finished "Compute fast metrics" in 52.9487 secs
2025-03-13 16:32:57,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.3402 secs
2025-03-13 16:32:57,994 [INFO]: {
2025-03-13 16:32:57,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:57,994 [INFO]: 	index_param: efSearch=122
2025-03-13 16:32:57,994 [INFO]: 	index_path: knn.index
2025-03-13 16:32:57,994 [INFO]: 	size in bytes: 1427968690
2025-03-13 16:32:57,994 [INFO]: 	avg_search_speed_ms: 9.299701422149706
2025-03-13 16:32:57,994 [INFO]: 	99p_search_speed_ms: 16.02927048690617
2025-03-13 16:32:57,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:57,994 [INFO]: 	nb vectors: 7258
2025-03-13 16:32:57,994 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:57,994 [INFO]: 	compression ratio: 0.9993082299304475
2025-03-13 16:32:57,994 [INFO]: }
2025-03-13 16:32:57,994 [INFO]: 	>>> Finished "Creating the index" in 117.3420 secs
2025-03-13 16:32:57,994 [INFO]: >>> Finished "Launching the whole pipeline" in 117.3727 secs
2025-03-13 16:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 21041 [episode count 3/20]
[retrieval_preprocessing] for episode 15938 [episode count 4/20], we have num_retrieval=np.int64(7202) num_query=np.int64(367)
2025-03-13 16:33:00,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:02,380 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:02
2025-03-13 16:33:02,380 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1074.64it/s]
2025-03-13 16:33:02,881 [INFO]: There are 7202 embeddings of dim 49152
2025-03-13 16:33:02,881 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5007 secs
2025-03-13 16:33:02,881 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:02
2025-03-13 16:33:02,881 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:02,881 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:33:02,882 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:02,882 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:33:02,882 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:02
2025-03-13 16:33:02,882 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:02,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:33:02,882 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:02
2025-03-13 16:33:02,882 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:02,882 [INFO]: 	Creating the index 03/13/2025, 16:33:02
2025-03-13 16:33:02,883 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:02
2025-03-13 16:33:02,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:33:02,885 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:02
2025-03-13 16:33:02,885 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:33:02,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 16.52it/s] 23%|██▎       | 7/30 [00:00<00:00, 33.60it/s] 40%|████      | 12/30 [00:00<00:00, 39.54it/s] 57%|█████▋    | 17/30 [00:00<00:00, 42.65it/s] 73%|███████▎  | 22/30 [00:04<00:02,  3.10it/s] 90%|█████████ | 27/30 [00:04<00:00,  4.63it/s]100%|██████████| 30/30 [00:06<00:00,  4.47it/s]
2025-03-13 16:33:09,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:09
2025-03-13 16:34:08,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4077 secs
2025-03-13 16:34:08,015 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 16:34:08,015 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.65it/s]
2025-03-13 16:34:37,173 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1583 secs
2025-03-13 16:34:37,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.2901 secs
2025-03-13 16:34:37,175 [INFO]: {
2025-03-13 16:34:37,175 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:37,175 [INFO]: 	index_param: efSearch=92
2025-03-13 16:34:37,175 [INFO]: 	index_path: knn.index
2025-03-13 16:34:37,175 [INFO]: 	size in bytes: 1416951010
2025-03-13 16:34:37,175 [INFO]: 	avg_search_speed_ms: 6.133214057354611
2025-03-13 16:34:37,175 [INFO]: 	99p_search_speed_ms: 10.2230444829911
2025-03-13 16:34:37,175 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:37,175 [INFO]: 	nb vectors: 7202
2025-03-13 16:34:37,175 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:37,175 [INFO]: 	compression ratio: 0.9993082371986877
2025-03-13 16:34:37,175 [INFO]: }
2025-03-13 16:34:37,176 [INFO]: 	>>> Finished "Creating the index" in 94.2930 secs
2025-03-13 16:34:37,176 [INFO]: >>> Finished "Launching the whole pipeline" in 94.7951 secs
2025-03-13 16:34:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 15938 [episode count 4/20]
[retrieval_preprocessing] for episode 8267 [episode count 5/20], we have num_retrieval=np.int64(7215) num_query=np.int64(354)
2025-03-13 16:34:39,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:41,049 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:41
2025-03-13 16:34:41,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1624.44it/s]
2025-03-13 16:34:41,076 [INFO]: There are 7215 embeddings of dim 49152
2025-03-13 16:34:41,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 16:34:41,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:41
2025-03-13 16:34:41,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:41,077 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:34:41,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:41,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:34:41,078 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:41
2025-03-13 16:34:41,078 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:41,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:34:41,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:41
2025-03-13 16:34:41,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:41,079 [INFO]: 	Creating the index 03/13/2025, 16:34:41
2025-03-13 16:34:41,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:41
2025-03-13 16:34:41,082 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:34:41,082 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:41
2025-03-13 16:34:41,083 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:34:41,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 16.50it/s] 23%|██▎       | 7/30 [00:00<00:00, 33.40it/s] 40%|████      | 12/30 [00:00<00:00, 39.55it/s] 57%|█████▋    | 17/30 [00:00<00:00, 42.07it/s] 73%|███████▎  | 22/30 [00:05<00:02,  2.75it/s] 87%|████████▋ | 26/30 [00:05<00:01,  3.83it/s]100%|██████████| 30/30 [00:07<00:00,  2.60it/s]100%|██████████| 30/30 [00:07<00:00,  3.84it/s]
2025-03-13 16:34:48,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:48
2025-03-13 16:35:47,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7051 secs
2025-03-13 16:35:47,600 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:35:47,601 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.08it/s]
2025-03-13 16:36:38,836 [INFO]: 	>>> Finished "Compute fast metrics" in 51.2348 secs
2025-03-13 16:36:38,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.7562 secs
2025-03-13 16:36:38,839 [INFO]: {
2025-03-13 16:36:38,839 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:38,839 [INFO]: 	index_param: efSearch=145
2025-03-13 16:36:38,839 [INFO]: 	index_path: knn.index
2025-03-13 16:36:38,839 [INFO]: 	size in bytes: 1419508690
2025-03-13 16:36:38,839 [INFO]: 	avg_search_speed_ms: 8.893796567908591
2025-03-13 16:36:38,839 [INFO]: 	99p_search_speed_ms: 13.919546622782944
2025-03-13 16:36:38,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:38,839 [INFO]: 	nb vectors: 7215
2025-03-13 16:36:38,839 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:38,839 [INFO]: 	compression ratio: 0.9993082324842971
2025-03-13 16:36:38,839 [INFO]: }
2025-03-13 16:36:38,839 [INFO]: 	>>> Finished "Creating the index" in 117.7602 secs
2025-03-13 16:36:38,839 [INFO]: >>> Finished "Launching the whole pipeline" in 117.7904 secs
2025-03-13 16:36:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 8267 [episode count 5/20]
[retrieval_preprocessing] for episode 61013 [episode count 6/20], we have num_retrieval=np.int64(7140) num_query=np.int64(429)
2025-03-13 16:36:42,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:43,827 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:43
2025-03-13 16:36:43,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-13 16:36:43,857 [INFO]: There are 7140 embeddings of dim 49152
2025-03-13 16:36:43,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 16:36:43,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:43
2025-03-13 16:36:43,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:43,858 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:36:43,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:43,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:36:43,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:43
2025-03-13 16:36:43,859 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:43,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:36:43,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:43
2025-03-13 16:36:43,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:43,860 [INFO]: 	Creating the index 03/13/2025, 16:36:43
2025-03-13 16:36:43,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:43
2025-03-13 16:36:43,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:36:43,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:43
2025-03-13 16:36:43,864 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:36:43,865 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  9.50it/s] 20%|██        | 6/30 [00:00<00:00, 30.10it/s] 37%|███▋      | 11/30 [00:00<00:00, 36.22it/s] 53%|█████▎    | 16/30 [00:00<00:00, 39.10it/s] 70%|███████   | 21/30 [00:05<00:03,  2.70it/s] 83%|████████▎ | 25/30 [00:05<00:01,  3.77it/s] 97%|█████████▋| 29/30 [00:05<00:00,  5.17it/s]100%|██████████| 30/30 [00:08<00:00,  3.50it/s]
2025-03-13 16:36:52,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:52
2025-03-13 16:37:49,901 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4511 secs
2025-03-13 16:37:49,902 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:37:49,902 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s]
2025-03-13 16:38:40,827 [INFO]: 	>>> Finished "Compute fast metrics" in 50.9249 secs
2025-03-13 16:38:40,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.9663 secs
2025-03-13 16:38:40,831 [INFO]: {
2025-03-13 16:38:40,831 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:40,831 [INFO]: 	index_param: efSearch=185
2025-03-13 16:38:40,831 [INFO]: 	index_path: knn.index
2025-03-13 16:38:40,831 [INFO]: 	size in bytes: 1404752830
2025-03-13 16:38:40,831 [INFO]: 	avg_search_speed_ms: 26.288239600068433
2025-03-13 16:38:40,831 [INFO]: 	99p_search_speed_ms: 63.15148724243044
2025-03-13 16:38:40,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:40,831 [INFO]: 	nb vectors: 7140
2025-03-13 16:38:40,831 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:40,831 [INFO]: 	compression ratio: 0.9993082697687108
2025-03-13 16:38:40,831 [INFO]: }
2025-03-13 16:38:40,831 [INFO]: 	>>> Finished "Creating the index" in 116.9708 secs
2025-03-13 16:38:40,831 [INFO]: >>> Finished "Launching the whole pipeline" in 117.0037 secs
2025-03-13 16:38:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 61013 [episode count 6/20]
[retrieval_preprocessing] for episode 9859 [episode count 7/20], we have num_retrieval=np.int64(7202) num_query=np.int64(367)
2025-03-13 16:38:46,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:47,530 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:47
2025-03-13 16:38:47,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1045.96it/s]
2025-03-13 16:38:47,558 [INFO]: There are 7202 embeddings of dim 49152
2025-03-13 16:38:47,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 16:38:47,558 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:47
2025-03-13 16:38:47,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:47,558 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:38:47,558 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:47,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:47,558 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:47
2025-03-13 16:38:47,558 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:47,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:38:47,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:47
2025-03-13 16:38:47,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:47,559 [INFO]: 	Creating the index 03/13/2025, 16:38:47
2025-03-13 16:38:47,559 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:47
2025-03-13 16:38:47,559 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:38:47,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:47
2025-03-13 16:38:47,560 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:38:47,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.75it/s] 17%|█▋        | 5/30 [00:00<00:01, 20.25it/s] 30%|███       | 9/30 [00:00<00:00, 27.04it/s] 43%|████▎     | 13/30 [00:00<00:00, 30.07it/s] 57%|█████▋    | 17/30 [00:00<00:00, 31.81it/s] 70%|███████   | 21/30 [00:06<00:04,  1.89it/s] 80%|████████  | 24/30 [00:06<00:02,  2.52it/s] 93%|█████████▎| 28/30 [00:06<00:00,  3.68it/s]100%|██████████| 30/30 [00:09<00:00,  3.14it/s]
2025-03-13 16:38:57,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:57
2025-03-13 16:39:59,246 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.1164 secs
2025-03-13 16:39:59,247 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 16:39:59,247 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 16:41:13,590 [INFO]: 	>>> Finished "Compute fast metrics" in 74.3434 secs
2025-03-13 16:41:13,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.0328 secs
2025-03-13 16:41:13,593 [INFO]: {
2025-03-13 16:41:13,593 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:13,593 [INFO]: 	index_param: efSearch=191
2025-03-13 16:41:13,593 [INFO]: 	index_path: knn.index
2025-03-13 16:41:13,593 [INFO]: 	size in bytes: 1416951010
2025-03-13 16:41:13,593 [INFO]: 	avg_search_speed_ms: 10.759423326410513
2025-03-13 16:41:13,593 [INFO]: 	99p_search_speed_ms: 15.914298216812313
2025-03-13 16:41:13,593 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:13,593 [INFO]: 	nb vectors: 7202
2025-03-13 16:41:13,593 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:13,593 [INFO]: 	compression ratio: 0.9993082371986877
2025-03-13 16:41:13,593 [INFO]: }
2025-03-13 16:41:13,593 [INFO]: 	>>> Finished "Creating the index" in 146.0343 secs
2025-03-13 16:41:13,593 [INFO]: >>> Finished "Launching the whole pipeline" in 146.0627 secs
2025-03-13 16:41:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 9859 [episode count 7/20]
[retrieval_preprocessing] for episode 39116 [episode count 8/20], we have num_retrieval=np.int64(7154) num_query=np.int64(415)
2025-03-13 16:41:19,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:21,155 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:21
2025-03-13 16:41:21,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.26it/s]
2025-03-13 16:41:21,179 [INFO]: There are 7154 embeddings of dim 49152
2025-03-13 16:41:21,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 16:41:21,180 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:21
2025-03-13 16:41:21,180 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:21,180 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:41:21,180 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:21,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:41:21,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:21
2025-03-13 16:41:21,180 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:21,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:41:21,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:21
2025-03-13 16:41:21,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:21,180 [INFO]: 	Creating the index 03/13/2025, 16:41:21
2025-03-13 16:41:21,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:21
2025-03-13 16:41:21,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:41:21,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:21
2025-03-13 16:41:21,182 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:41:21,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.11it/s] 17%|█▋        | 5/30 [00:00<00:01, 17.51it/s] 30%|███       | 9/30 [00:00<00:00, 22.72it/s] 40%|████      | 12/30 [00:00<00:00, 24.94it/s] 50%|█████     | 15/30 [00:00<00:00, 26.40it/s] 60%|██████    | 18/30 [00:00<00:00, 27.37it/s] 70%|███████   | 21/30 [00:05<00:05,  1.74it/s] 83%|████████▎ | 25/30 [00:06<00:01,  2.72it/s] 97%|█████████▋| 29/30 [00:06<00:00,  4.03it/s]100%|██████████| 30/30 [00:09<00:00,  3.26it/s]
2025-03-13 16:41:30,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:30
2025-03-13 16:42:31,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1561 secs
2025-03-13 16:42:31,549 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:42:31,549 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 16:43:22,001 [INFO]: 	>>> Finished "Compute fast metrics" in 50.4520 secs
2025-03-13 16:43:22,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.8216 secs
2025-03-13 16:43:22,003 [INFO]: {
2025-03-13 16:43:22,003 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:22,003 [INFO]: 	index_param: efSearch=157
2025-03-13 16:43:22,003 [INFO]: 	index_path: knn.index
2025-03-13 16:43:22,003 [INFO]: 	size in bytes: 1407507250
2025-03-13 16:43:22,003 [INFO]: 	avg_search_speed_ms: 9.293301398848568
2025-03-13 16:43:22,003 [INFO]: 	99p_search_speed_ms: 13.000178092624992
2025-03-13 16:43:22,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:22,003 [INFO]: 	nb vectors: 7154
2025-03-13 16:43:22,003 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:22,003 [INFO]: 	compression ratio: 0.9993082678614977
2025-03-13 16:43:22,003 [INFO]: }
2025-03-13 16:43:22,003 [INFO]: 	>>> Finished "Creating the index" in 120.8231 secs
2025-03-13 16:43:22,003 [INFO]: >>> Finished "Launching the whole pipeline" in 120.8479 secs
2025-03-13 16:43:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 39116 [episode count 8/20]
[retrieval_preprocessing] for episode 76009 [episode count 9/20], we have num_retrieval=np.int64(7182) num_query=np.int64(387)
2025-03-13 16:43:26,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:28,518 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:28
2025-03-13 16:43:28,518 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 687.70it/s]
2025-03-13 16:43:28,548 [INFO]: There are 7182 embeddings of dim 49152
2025-03-13 16:43:28,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 16:43:28,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:28
2025-03-13 16:43:28,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:28,550 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:43:28,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:28,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:43:28,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:28
2025-03-13 16:43:28,550 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:28,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:43:28,551 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:28
2025-03-13 16:43:28,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:28,551 [INFO]: 	Creating the index 03/13/2025, 16:43:28
2025-03-13 16:43:28,551 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:28
2025-03-13 16:43:28,553 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:43:28,554 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:28
2025-03-13 16:43:28,554 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:43:28,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.46it/s] 17%|█▋        | 5/30 [00:00<00:01, 23.67it/s] 30%|███       | 9/30 [00:00<00:00, 30.42it/s] 43%|████▎     | 13/30 [00:00<00:00, 33.58it/s] 57%|█████▋    | 17/30 [00:00<00:00, 35.10it/s] 70%|███████   | 21/30 [00:04<00:03,  2.52it/s] 83%|████████▎ | 25/30 [00:04<00:01,  3.66it/s] 97%|█████████▋| 29/30 [00:05<00:00,  5.17it/s]100%|██████████| 30/30 [00:08<00:00,  3.61it/s]
2025-03-13 16:43:36,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:36
2025-03-13 16:44:48,170 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.2919 secs
2025-03-13 16:44:48,170 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 16:44:48,170 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 16:45:41,619 [INFO]: 	>>> Finished "Compute fast metrics" in 53.4488 secs
2025-03-13 16:45:41,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.0668 secs
2025-03-13 16:45:41,621 [INFO]: {
2025-03-13 16:45:41,621 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:41,621 [INFO]: 	index_param: efSearch=115
2025-03-13 16:45:41,621 [INFO]: 	index_path: knn.index
2025-03-13 16:45:41,621 [INFO]: 	size in bytes: 1413016150
2025-03-13 16:45:41,621 [INFO]: 	avg_search_speed_ms: 6.9959103654447015
2025-03-13 16:45:41,621 [INFO]: 	99p_search_speed_ms: 10.731707969680429
2025-03-13 16:45:41,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:41,621 [INFO]: 	nb vectors: 7182
2025-03-13 16:45:41,621 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:41,621 [INFO]: 	compression ratio: 0.9993082216363911
2025-03-13 16:45:41,621 [INFO]: }
2025-03-13 16:45:41,621 [INFO]: 	>>> Finished "Creating the index" in 133.0698 secs
2025-03-13 16:45:41,621 [INFO]: >>> Finished "Launching the whole pipeline" in 133.1027 secs
2025-03-13 16:45:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 76009 [episode count 9/20]
[retrieval_preprocessing] for episode 47336 [episode count 10/20], we have num_retrieval=np.int64(7288) num_query=np.int64(281)
2025-03-13 16:45:49,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:50,842 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:50
2025-03-13 16:45:50,843 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 994.62it/s]
2025-03-13 16:45:50,876 [INFO]: There are 7288 embeddings of dim 49152
2025-03-13 16:45:50,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 16:45:50,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:50
2025-03-13 16:45:50,877 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:50,877 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:45:50,877 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:50,877 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:45:50,877 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:50
2025-03-13 16:45:50,877 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:50,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:45:50,878 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:50
2025-03-13 16:45:50,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:50,878 [INFO]: 	Creating the index 03/13/2025, 16:45:50
2025-03-13 16:45:50,878 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:50
2025-03-13 16:45:50,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:45:50,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:50
2025-03-13 16:45:50,882 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:45:50,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.13it/s] 20%|██        | 6/30 [00:00<00:00, 28.19it/s] 37%|███▋      | 11/30 [00:00<00:00, 34.29it/s] 53%|█████▎    | 16/30 [00:00<00:00, 36.88it/s] 67%|██████▋   | 20/30 [00:00<00:00, 37.87it/s] 80%|████████  | 24/30 [00:05<00:02,  2.22it/s] 90%|█████████ | 27/30 [00:06<00:01,  2.79it/s]100%|██████████| 30/30 [00:09<00:00,  1.80it/s]100%|██████████| 30/30 [00:09<00:00,  3.16it/s]
2025-03-13 16:46:00,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:00
2025-03-13 16:47:05,491 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1175 secs
2025-03-13 16:47:05,492 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 16:47:05,492 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.47it/s]
2025-03-13 16:48:04,586 [INFO]: 	>>> Finished "Compute fast metrics" in 59.0939 secs
2025-03-13 16:48:04,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.7087 secs
2025-03-13 16:48:04,591 [INFO]: {
2025-03-13 16:48:04,591 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:04,591 [INFO]: 	index_param: efSearch=121
2025-03-13 16:48:04,591 [INFO]: 	index_path: knn.index
2025-03-13 16:48:04,591 [INFO]: 	size in bytes: 1433870950
2025-03-13 16:48:04,591 [INFO]: 	avg_search_speed_ms: 9.387954612406837
2025-03-13 16:48:04,591 [INFO]: 	99p_search_speed_ms: 19.161975271999825
2025-03-13 16:48:04,591 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:04,591 [INFO]: 	nb vectors: 7288
2025-03-13 16:48:04,591 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:04,591 [INFO]: 	compression ratio: 0.9993082738722059
2025-03-13 16:48:04,591 [INFO]: }
2025-03-13 16:48:04,591 [INFO]: 	>>> Finished "Creating the index" in 133.7130 secs
2025-03-13 16:48:04,591 [INFO]: >>> Finished "Launching the whole pipeline" in 133.7487 secs
2025-03-13 16:48:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 47336 [episode count 10/20]
[retrieval_preprocessing] for episode 20201 [episode count 11/20], we have num_retrieval=np.int64(7257) num_query=np.int64(312)
2025-03-13 16:48:08,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:10,979 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:10
2025-03-13 16:48:10,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 843.92it/s]
2025-03-13 16:48:11,013 [INFO]: There are 7257 embeddings of dim 49152
2025-03-13 16:48:11,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 16:48:11,013 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:11
2025-03-13 16:48:11,013 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:11,013 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:48:11,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:11,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:11,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:11
2025-03-13 16:48:11,014 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:11,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:11,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:11
2025-03-13 16:48:11,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:11,014 [INFO]: 	Creating the index 03/13/2025, 16:48:11
2025-03-13 16:48:11,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:11
2025-03-13 16:48:11,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:11,015 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:11
2025-03-13 16:48:11,015 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:48:11,015 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  3.99it/s] 13%|█▎        | 4/30 [00:00<00:02, 12.25it/s] 23%|██▎       | 7/30 [00:00<00:01, 17.82it/s] 37%|███▋      | 11/30 [00:00<00:00, 23.02it/s] 47%|████▋     | 14/30 [00:00<00:00, 24.95it/s] 57%|█████▋    | 17/30 [00:00<00:00, 25.60it/s] 67%|██████▋   | 20/30 [00:00<00:00, 24.96it/s] 77%|███████▋  | 23/30 [00:06<00:04,  1.68it/s] 90%|█████████ | 27/30 [00:06<00:01,  2.62it/s]100%|██████████| 30/30 [00:09<00:00,  1.65it/s]100%|██████████| 30/30 [00:09<00:00,  3.02it/s]
2025-03-13 16:48:20,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:20
2025-03-13 16:49:23,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.5487 secs
2025-03-13 16:49:23,517 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:49:23,517 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 16:50:24,215 [INFO]: 	>>> Finished "Compute fast metrics" in 60.6977 secs
2025-03-13 16:50:24,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2012 secs
2025-03-13 16:50:24,217 [INFO]: {
2025-03-13 16:50:24,217 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:24,217 [INFO]: 	index_param: efSearch=145
2025-03-13 16:50:24,217 [INFO]: 	index_path: knn.index
2025-03-13 16:50:24,217 [INFO]: 	size in bytes: 1427771950
2025-03-13 16:50:24,217 [INFO]: 	avg_search_speed_ms: 7.903181743443212
2025-03-13 16:50:24,217 [INFO]: 	99p_search_speed_ms: 13.052352040540427
2025-03-13 16:50:24,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:24,217 [INFO]: 	nb vectors: 7257
2025-03-13 16:50:24,217 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:24,217 [INFO]: 	compression ratio: 0.9993082270596505
2025-03-13 16:50:24,217 [INFO]: }
2025-03-13 16:50:24,217 [INFO]: 	>>> Finished "Creating the index" in 133.2028 secs
2025-03-13 16:50:24,217 [INFO]: >>> Finished "Launching the whole pipeline" in 133.2372 secs
2025-03-13 16:50:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 20201 [episode count 11/20]
[retrieval_preprocessing] for episode 56044 [episode count 12/20], we have num_retrieval=np.int64(7156) num_query=np.int64(413)
2025-03-13 16:50:27,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:28,221 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:28
2025-03-13 16:50:28,221 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1902.18it/s]
2025-03-13 16:50:29,143 [INFO]: There are 7156 embeddings of dim 49152
2025-03-13 16:50:29,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.9224 secs
2025-03-13 16:50:29,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:29
2025-03-13 16:50:29,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:29,144 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:50:29,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:29,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:29,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:29
2025-03-13 16:50:29,144 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:29,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:50:29,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:29
2025-03-13 16:50:29,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:29,144 [INFO]: 	Creating the index 03/13/2025, 16:50:29
2025-03-13 16:50:29,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:29
2025-03-13 16:50:29,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:50:29,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:29
2025-03-13 16:50:29,146 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:50:29,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.30it/s] 20%|██        | 6/30 [00:00<00:00, 26.90it/s] 40%|████      | 12/30 [00:00<00:00, 37.39it/s] 60%|██████    | 18/30 [00:00<00:00, 42.63it/s] 77%|███████▋  | 23/30 [00:04<00:02,  3.49it/s] 97%|█████████▋| 29/30 [00:04<00:00,  5.39it/s]100%|██████████| 30/30 [00:06<00:00,  4.53it/s]
2025-03-13 16:50:35,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:35
2025-03-13 16:51:37,487 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7220 secs
2025-03-13 16:51:37,487 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 16:51:37,487 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.83it/s]
2025-03-13 16:52:04,524 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0363 secs
2025-03-13 16:52:04,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.4548 secs
2025-03-13 16:52:04,601 [INFO]: {
2025-03-13 16:52:04,601 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:04,601 [INFO]: 	index_param: efSearch=104
2025-03-13 16:52:04,601 [INFO]: 	index_path: knn.index
2025-03-13 16:52:04,601 [INFO]: 	size in bytes: 1407900730
2025-03-13 16:52:04,601 [INFO]: 	avg_search_speed_ms: 8.222997003031196
2025-03-13 16:52:04,601 [INFO]: 	99p_search_speed_ms: 12.251136661507177
2025-03-13 16:52:04,602 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:04,602 [INFO]: 	nb vectors: 7156
2025-03-13 16:52:04,602 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:04,602 [INFO]: 	compression ratio: 0.9993082736735281
2025-03-13 16:52:04,602 [INFO]: }
2025-03-13 16:52:04,602 [INFO]: 	>>> Finished "Creating the index" in 95.4573 secs
2025-03-13 16:52:04,602 [INFO]: >>> Finished "Launching the whole pipeline" in 96.3805 secs
2025-03-13 16:52:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 56044 [episode count 12/20]
[retrieval_preprocessing] for episode 28440 [episode count 13/20], we have num_retrieval=np.int64(7158) num_query=np.int64(411)
2025-03-13 16:52:08,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:10,060 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:10
2025-03-13 16:52:10,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.14it/s]
2025-03-13 16:52:10,086 [INFO]: There are 7158 embeddings of dim 49152
2025-03-13 16:52:10,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:52:10,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:10
2025-03-13 16:52:10,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:10,087 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:52:10,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:10,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:52:10,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:10
2025-03-13 16:52:10,087 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:10,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:52:10,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:10
2025-03-13 16:52:10,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:10,087 [INFO]: 	Creating the index 03/13/2025, 16:52:10
2025-03-13 16:52:10,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:10
2025-03-13 16:52:10,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:52:10,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:10
2025-03-13 16:52:10,088 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:52:10,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.30it/s] 13%|█▎        | 4/30 [00:00<00:01, 16.09it/s] 27%|██▋       | 8/30 [00:00<00:00, 25.16it/s] 43%|████▎     | 13/30 [00:00<00:00, 31.29it/s] 57%|█████▋    | 17/30 [00:00<00:00, 33.95it/s] 70%|███████   | 21/30 [00:06<00:04,  2.03it/s] 83%|████████▎ | 25/30 [00:06<00:01,  2.95it/s] 97%|█████████▋| 29/30 [00:06<00:00,  4.17it/s]100%|██████████| 30/30 [00:09<00:00,  3.11it/s]
2025-03-13 16:52:19,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:19
2025-03-13 16:53:17,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5365 secs
2025-03-13 16:53:17,275 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 16:53:17,275 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.13it/s]
2025-03-13 16:54:14,280 [INFO]: 	>>> Finished "Compute fast metrics" in 57.0042 secs
2025-03-13 16:54:14,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.6211 secs
2025-03-13 16:54:14,710 [INFO]: {
2025-03-13 16:54:14,710 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:14,710 [INFO]: 	index_param: efSearch=120
2025-03-13 16:54:14,710 [INFO]: 	index_path: knn.index
2025-03-13 16:54:14,710 [INFO]: 	size in bytes: 1408294210
2025-03-13 16:54:14,710 [INFO]: 	avg_search_speed_ms: 10.266800394790435
2025-03-13 16:54:14,710 [INFO]: 	99p_search_speed_ms: 17.8949644532986
2025-03-13 16:54:14,710 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:14,710 [INFO]: 	nb vectors: 7158
2025-03-13 16:54:14,710 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:14,710 [INFO]: 	compression ratio: 0.9993082794823107
2025-03-13 16:54:14,710 [INFO]: }
2025-03-13 16:54:14,711 [INFO]: 	>>> Finished "Creating the index" in 124.6234 secs
2025-03-13 16:54:14,711 [INFO]: >>> Finished "Launching the whole pipeline" in 124.6501 secs
2025-03-13 16:54:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 28440 [episode count 13/20]
[retrieval_preprocessing] for episode 89375 [episode count 14/20], we have num_retrieval=np.int64(7178) num_query=np.int64(391)
2025-03-13 16:54:18,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:19,827 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:19
2025-03-13 16:54:19,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1054.11it/s]
2025-03-13 16:54:19,854 [INFO]: There are 7178 embeddings of dim 49152
2025-03-13 16:54:19,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 16:54:19,855 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:19
2025-03-13 16:54:19,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:19,855 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:54:19,855 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:19,855 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:19,855 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:19
2025-03-13 16:54:19,855 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:19,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:54:19,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:19
2025-03-13 16:54:19,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:19,855 [INFO]: 	Creating the index 03/13/2025, 16:54:19
2025-03-13 16:54:19,855 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:19
2025-03-13 16:54:19,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:54:19,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:19
2025-03-13 16:54:19,857 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:54:19,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.54it/s] 17%|█▋        | 5/30 [00:00<00:01, 19.69it/s] 33%|███▎      | 10/30 [00:00<00:00, 29.10it/s] 50%|█████     | 15/30 [00:00<00:00, 34.68it/s] 67%|██████▋   | 20/30 [00:00<00:00, 38.26it/s] 80%|████████  | 24/30 [00:05<00:02,  2.32it/s] 97%|█████████▋| 29/30 [00:06<00:00,  3.50it/s]100%|██████████| 30/30 [00:08<00:00,  3.46it/s]
2025-03-13 16:54:28,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:28
2025-03-13 16:55:27,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0032 secs
2025-03-13 16:55:27,538 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 16:55:27,538 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.30it/s]
2025-03-13 16:56:43,088 [INFO]: 	>>> Finished "Compute fast metrics" in 75.5493 secs
2025-03-13 16:56:43,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.2327 secs
2025-03-13 16:56:43,089 [INFO]: {
2025-03-13 16:56:43,089 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:43,089 [INFO]: 	index_param: efSearch=138
2025-03-13 16:56:43,089 [INFO]: 	index_path: knn.index
2025-03-13 16:56:43,089 [INFO]: 	size in bytes: 1412229190
2025-03-13 16:56:43,089 [INFO]: 	avg_search_speed_ms: 6.741624434942672
2025-03-13 16:56:43,089 [INFO]: 	99p_search_speed_ms: 9.383448911830785
2025-03-13 16:56:43,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:43,089 [INFO]: 	nb vectors: 7178
2025-03-13 16:56:43,089 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:43,090 [INFO]: 	compression ratio: 0.999308210022199
2025-03-13 16:56:43,090 [INFO]: }
2025-03-13 16:56:43,090 [INFO]: 	>>> Finished "Creating the index" in 143.2341 secs
2025-03-13 16:56:43,090 [INFO]: >>> Finished "Launching the whole pipeline" in 143.2620 secs
2025-03-13 16:56:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 89375 [episode count 14/20]
[retrieval_preprocessing] for episode 43830 [episode count 15/20], we have num_retrieval=np.int64(7231) num_query=np.int64(338)
2025-03-13 16:56:45,887 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:47,296 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:47
2025-03-13 16:56:47,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.71it/s]
2025-03-13 16:56:47,326 [INFO]: There are 7231 embeddings of dim 49152
2025-03-13 16:56:47,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 16:56:47,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:47
2025-03-13 16:56:47,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:47,326 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:56:47,326 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:47,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:56:47,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:47
2025-03-13 16:56:47,327 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:47,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:56:47,327 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:47
2025-03-13 16:56:47,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:47,327 [INFO]: 	Creating the index 03/13/2025, 16:56:47
2025-03-13 16:56:47,327 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:47
2025-03-13 16:56:47,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:56:47,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:47
2025-03-13 16:56:47,329 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:56:47,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  7.20it/s] 20%|██        | 6/30 [00:00<00:00, 28.06it/s] 37%|███▋      | 11/30 [00:00<00:00, 36.78it/s] 53%|█████▎    | 16/30 [00:00<00:00, 40.53it/s] 70%|███████   | 21/30 [00:04<00:03,  2.98it/s] 83%|████████▎ | 25/30 [00:04<00:01,  4.16it/s]100%|██████████| 30/30 [00:07<00:00,  3.13it/s]100%|██████████| 30/30 [00:07<00:00,  4.28it/s]
2025-03-13 16:56:54,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:54
2025-03-13 16:58:06,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.6159 secs
2025-03-13 16:58:06,966 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 16:58:06,966 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.97it/s]
2025-03-13 16:58:34,578 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6114 secs
2025-03-13 16:58:34,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.2508 secs
2025-03-13 16:58:34,580 [INFO]: {
2025-03-13 16:58:34,580 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:34,580 [INFO]: 	index_param: efSearch=144
2025-03-13 16:58:34,580 [INFO]: 	index_path: knn.index
2025-03-13 16:58:34,580 [INFO]: 	size in bytes: 1422656650
2025-03-13 16:58:34,580 [INFO]: 	avg_search_speed_ms: 9.224970300288396
2025-03-13 16:58:34,580 [INFO]: 	99p_search_speed_ms: 16.27046115696431
2025-03-13 16:58:34,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:34,580 [INFO]: 	nb vectors: 7231
2025-03-13 16:58:34,580 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:34,580 [INFO]: 	compression ratio: 0.9993081942856697
2025-03-13 16:58:34,580 [INFO]: }
2025-03-13 16:58:34,580 [INFO]: 	>>> Finished "Creating the index" in 107.2527 secs
2025-03-13 16:58:34,580 [INFO]: >>> Finished "Launching the whole pipeline" in 107.2835 secs
2025-03-13 16:58:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 43830 [episode count 15/20]
[retrieval_preprocessing] for episode 20302 [episode count 16/20], we have num_retrieval=np.int64(7177) num_query=np.int64(392)
2025-03-13 16:58:37,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:39,602 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:39
2025-03-13 16:58:39,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 16:58:39,625 [INFO]: There are 7177 embeddings of dim 49152
2025-03-13 16:58:39,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 16:58:39,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:39,625 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:58:39,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:39,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:39,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,625 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:39,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:58:39,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:39
2025-03-13 16:58:39,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:39,626 [INFO]: 	Creating the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:39
2025-03-13 16:58:39,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:58:39,627 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,627 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:58:39,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.89it/s] 20%|██        | 6/30 [00:00<00:00, 28.19it/s] 37%|███▋      | 11/30 [00:00<00:00, 35.46it/s] 53%|█████▎    | 16/30 [00:00<00:00, 38.77it/s] 70%|███████   | 21/30 [00:05<00:03,  2.66it/s] 87%|████████▋ | 26/30 [00:05<00:00,  4.00it/s]100%|██████████| 30/30 [00:07<00:00,  2.99it/s]100%|██████████| 30/30 [00:07<00:00,  4.06it/s]
2025-03-13 16:58:47,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:47
2025-03-13 16:59:44,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2818 secs
2025-03-13 16:59:44,306 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:59:44,306 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-13 17:00:16,963 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6565 secs
2025-03-13 17:00:16,965 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.3385 secs
2025-03-13 17:00:16,965 [INFO]: {
2025-03-13 17:00:16,965 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:16,965 [INFO]: 	index_param: efSearch=143
2025-03-13 17:00:16,965 [INFO]: 	index_path: knn.index
2025-03-13 17:00:16,965 [INFO]: 	size in bytes: 1412032450
2025-03-13 17:00:16,965 [INFO]: 	avg_search_speed_ms: 9.243490104047089
2025-03-13 17:00:16,965 [INFO]: 	99p_search_speed_ms: 12.918579645920547
2025-03-13 17:00:16,965 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:16,965 [INFO]: 	nb vectors: 7177
2025-03-13 17:00:16,965 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:16,965 [INFO]: 	compression ratio: 0.9993082071166283
2025-03-13 17:00:16,966 [INFO]: }
2025-03-13 17:00:16,966 [INFO]: 	>>> Finished "Creating the index" in 97.3400 secs
2025-03-13 17:00:16,966 [INFO]: >>> Finished "Launching the whole pipeline" in 97.3633 secs
2025-03-13 17:00:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 20302 [episode count 16/20]
[retrieval_preprocessing] for episode 82850 [episode count 17/20], we have num_retrieval=np.int64(7186) num_query=np.int64(383)
2025-03-13 17:00:20,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:21,880 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:21
2025-03-13 17:00:21,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1618.80it/s]
2025-03-13 17:00:21,905 [INFO]: There are 7186 embeddings of dim 49152
2025-03-13 17:00:21,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:00:21,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:21
2025-03-13 17:00:21,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:21,906 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:00:21,906 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:21,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:21,906 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:21
2025-03-13 17:00:21,906 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:21,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:00:21,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:21
2025-03-13 17:00:21,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:21,906 [INFO]: 	Creating the index 03/13/2025, 17:00:21
2025-03-13 17:00:21,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:21
2025-03-13 17:00:21,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:00:21,907 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:21
2025-03-13 17:00:21,907 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:00:21,907 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.67it/s] 17%|█▋        | 5/30 [00:00<00:01, 22.18it/s] 30%|███       | 9/30 [00:00<00:00, 28.85it/s] 43%|████▎     | 13/30 [00:00<00:00, 31.48it/s] 57%|█████▋    | 17/30 [00:00<00:00, 33.10it/s] 70%|███████   | 21/30 [00:06<00:04,  1.92it/s] 83%|████████▎ | 25/30 [00:06<00:01,  2.81it/s] 97%|█████████▋| 29/30 [00:06<00:00,  4.02it/s]100%|██████████| 30/30 [00:08<00:00,  3.35it/s]
2025-03-13 17:00:30,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:30
2025-03-13 17:01:27,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7964 secs
2025-03-13 17:01:27,677 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 17:01:27,677 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.55it/s]
2025-03-13 17:02:20,773 [INFO]: 	>>> Finished "Compute fast metrics" in 53.0965 secs
2025-03-13 17:02:20,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.8680 secs
2025-03-13 17:02:20,775 [INFO]: {
2025-03-13 17:02:20,775 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:20,775 [INFO]: 	index_param: efSearch=133
2025-03-13 17:02:20,775 [INFO]: 	index_path: knn.index
2025-03-13 17:02:20,775 [INFO]: 	size in bytes: 1413803110
2025-03-13 17:02:20,775 [INFO]: 	avg_search_speed_ms: 11.09666042169401
2025-03-13 17:02:20,776 [INFO]: 	99p_search_speed_ms: 20.373420091345906
2025-03-13 17:02:20,776 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:20,776 [INFO]: 	nb vectors: 7186
2025-03-13 17:02:20,776 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:20,776 [INFO]: 	compression ratio: 0.9993082332376536
2025-03-13 17:02:20,776 [INFO]: }
2025-03-13 17:02:20,776 [INFO]: 	>>> Finished "Creating the index" in 118.8696 secs
2025-03-13 17:02:20,776 [INFO]: >>> Finished "Launching the whole pipeline" in 118.8951 secs
2025-03-13 17:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 82850 [episode count 17/20]
[retrieval_preprocessing] for episode 75708 [episode count 18/20], we have num_retrieval=np.int64(7240) num_query=np.int64(329)
2025-03-13 17:02:24,151 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:25,517 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:25
2025-03-13 17:02:25,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.42it/s]
2025-03-13 17:02:25,548 [INFO]: There are 7240 embeddings of dim 49152
2025-03-13 17:02:25,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 17:02:25,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:25
2025-03-13 17:02:25,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:25,550 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 17:02:25,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:25,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:02:25,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:25
2025-03-13 17:02:25,550 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:25,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:02:25,551 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:25
2025-03-13 17:02:25,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:25,551 [INFO]: 	Creating the index 03/13/2025, 17:02:25
2025-03-13 17:02:25,552 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:25
2025-03-13 17:02:25,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:02:25,555 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:25
2025-03-13 17:02:25,555 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:02:25,555 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.67it/s] 13%|█▎        | 4/30 [00:00<00:01, 17.10it/s] 27%|██▋       | 8/30 [00:00<00:00, 23.93it/s] 40%|████      | 12/30 [00:00<00:00, 27.78it/s] 53%|█████▎    | 16/30 [00:00<00:00, 28.74it/s] 63%|██████▎   | 19/30 [00:00<00:00, 28.37it/s] 73%|███████▎  | 22/30 [00:06<00:05,  1.57it/s] 87%|████████▋ | 26/30 [00:06<00:01,  2.41it/s]100%|██████████| 30/30 [00:09<00:00,  1.92it/s]100%|██████████| 30/30 [00:09<00:00,  3.04it/s]
2025-03-13 17:02:35,577 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:35
2025-03-13 17:03:36,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6836 secs
2025-03-13 17:03:36,261 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 17:03:36,261 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 17:04:14,953 [INFO]: 	>>> Finished "Compute fast metrics" in 38.6912 secs
2025-03-13 17:04:14,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.3996 secs
2025-03-13 17:04:14,955 [INFO]: {
2025-03-13 17:04:14,955 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:14,955 [INFO]: 	index_param: efSearch=182
2025-03-13 17:04:14,955 [INFO]: 	index_path: knn.index
2025-03-13 17:04:14,955 [INFO]: 	size in bytes: 1424427310
2025-03-13 17:04:14,955 [INFO]: 	avg_search_speed_ms: 10.76500323165982
2025-03-13 17:04:14,955 [INFO]: 	99p_search_speed_ms: 17.22154134884477
2025-03-13 17:04:14,955 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:14,955 [INFO]: 	nb vectors: 7240
2025-03-13 17:04:14,955 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:14,955 [INFO]: 	compression ratio: 0.9993082202278192
2025-03-13 17:04:14,955 [INFO]: }
2025-03-13 17:04:14,955 [INFO]: 	>>> Finished "Creating the index" in 109.4033 secs
2025-03-13 17:04:14,955 [INFO]: >>> Finished "Launching the whole pipeline" in 109.4375 secs
2025-03-13 17:04:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 75708 [episode count 18/20]
[retrieval_preprocessing] for episode 38340 [episode count 19/20], we have num_retrieval=np.int64(7119) num_query=np.int64(450)
2025-03-13 17:04:18,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:19,673 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:19
2025-03-13 17:04:19,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-13 17:04:19,709 [INFO]: There are 7119 embeddings of dim 49152
2025-03-13 17:04:19,710 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 17:04:19,710 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:19,710 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:04:19,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:19,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:19,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,710 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:19,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:19,710 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:19
2025-03-13 17:04:19,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:19,710 [INFO]: 	Creating the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,710 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:19
2025-03-13 17:04:19,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:04:19,711 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:19
2025-03-13 17:04:19,711 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:04:19,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.32it/s] 17%|█▋        | 5/30 [00:00<00:01, 21.91it/s] 33%|███▎      | 10/30 [00:00<00:00, 30.41it/s] 50%|█████     | 15/30 [00:00<00:00, 35.31it/s] 67%|██████▋   | 20/30 [00:00<00:00, 38.08it/s] 80%|████████  | 24/30 [00:04<00:01,  3.02it/s] 97%|█████████▋| 29/30 [00:04<00:00,  4.55it/s]100%|██████████| 30/30 [00:07<00:00,  4.27it/s]
2025-03-13 17:04:26,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:26
2025-03-13 17:05:15,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1228 secs
2025-03-13 17:05:15,867 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 17:05:15,867 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 17:06:07,334 [INFO]: 	>>> Finished "Compute fast metrics" in 51.4663 secs
2025-03-13 17:06:07,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.6246 secs
2025-03-13 17:06:07,336 [INFO]: {
2025-03-13 17:06:07,336 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:07,336 [INFO]: 	index_param: efSearch=225
2025-03-13 17:06:07,336 [INFO]: 	index_path: knn.index
2025-03-13 17:06:07,336 [INFO]: 	size in bytes: 1400621110
2025-03-13 17:06:07,336 [INFO]: 	avg_search_speed_ms: 13.384525256463323
2025-03-13 17:06:07,336 [INFO]: 	99p_search_speed_ms: 19.753243541345
2025-03-13 17:06:07,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:07,336 [INFO]: 	nb vectors: 7119
2025-03-13 17:06:07,336 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:07,336 [INFO]: 	compression ratio: 0.9993083368563537
2025-03-13 17:06:07,336 [INFO]: }
2025-03-13 17:06:07,336 [INFO]: 	>>> Finished "Creating the index" in 107.6263 secs
2025-03-13 17:06:07,336 [INFO]: >>> Finished "Launching the whole pipeline" in 107.6635 secs
2025-03-13 17:06:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 38340 [episode count 19/20]
2025-03-13 17:06:11: [retrieval_preprocessing] finished for 4569686640_wipe_plate_with_blue_towel [chosen_id count 3/196]
2025-03-13 17:06:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4569686640_put_fork_on_plate [chosen_id count 4/196]
2025-03-13 17:06:14: [retrieval_preprocessing] we have num_total=5165 embedding_dim=49152
[retrieval_preprocessing] for episode 90122 [episode count 0/20], we have num_retrieval=np.int64(4948) num_query=np.int64(217)
2025-03-13 17:06:14,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:15,645 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:15
2025-03-13 17:06:15,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1773.49it/s]
2025-03-13 17:06:15,675 [INFO]: There are 4948 embeddings of dim 49152
2025-03-13 17:06:15,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:06:15,675 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:15
2025-03-13 17:06:15,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:15,676 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:06:15,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:15,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:06:15,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:15
2025-03-13 17:06:15,676 [INFO]: 1021.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:15,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:06:15,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:15
2025-03-13 17:06:15,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:15,676 [INFO]: 	Creating the index 03/13/2025, 17:06:15
2025-03-13 17:06:15,676 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:15
2025-03-13 17:06:15,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:06:15,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:15
2025-03-13 17:06:15,677 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:06:15,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.30it/s] 25%|██▌       | 5/20 [00:00<00:00, 24.40it/s] 45%|████▌     | 9/20 [00:00<00:00, 29.84it/s] 65%|██████▌   | 13/20 [00:00<00:00, 32.37it/s] 85%|████████▌ | 17/20 [00:00<00:00, 33.71it/s]100%|██████████| 20/20 [00:05<00:00,  3.79it/s]
2025-03-13 17:06:21,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:21
2025-03-13 17:07:17,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.3197 secs
2025-03-13 17:07:17,606 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 17:07:17,606 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.96it/s]
2025-03-13 17:08:04,589 [INFO]: 	>>> Finished "Compute fast metrics" in 46.9831 secs
2025-03-13 17:08:04,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.9145 secs
2025-03-13 17:08:04,592 [INFO]: {
2025-03-13 17:08:04,592 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:04,592 [INFO]: 	index_param: efSearch=145
2025-03-13 17:08:04,592 [INFO]: 	index_path: knn.index
2025-03-13 17:08:04,592 [INFO]: 	size in bytes: 973489450
2025-03-13 17:08:04,592 [INFO]: 	avg_search_speed_ms: 6.813318034394022
2025-03-13 17:08:04,592 [INFO]: 	99p_search_speed_ms: 9.922212776727969
2025-03-13 17:08:04,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:04,592 [INFO]: 	nb vectors: 4948
2025-03-13 17:08:04,592 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:04,592 [INFO]: 	compression ratio: 0.9993086047311556
2025-03-13 17:08:04,592 [INFO]: }
2025-03-13 17:08:04,592 [INFO]: 	>>> Finished "Creating the index" in 108.9162 secs
2025-03-13 17:08:04,592 [INFO]: >>> Finished "Launching the whole pipeline" in 108.9472 secs
2025-03-13 17:08:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 90122 [episode count 0/20]
[retrieval_preprocessing] for episode 7706 [episode count 1/20], we have num_retrieval=np.int64(4952) num_query=np.int64(213)
2025-03-13 17:08:06,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:06,967 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:06
2025-03-13 17:08:06,968 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1718.98it/s]
2025-03-13 17:08:06,999 [INFO]: There are 4952 embeddings of dim 49152
2025-03-13 17:08:06,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:08:07,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:07
2025-03-13 17:08:07,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:07,000 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:08:07,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:07,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:08:07,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:07
2025-03-13 17:08:07,001 [INFO]: 1022.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:07,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:08:07,001 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:07
2025-03-13 17:08:07,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:07,001 [INFO]: 	Creating the index 03/13/2025, 17:08:07
2025-03-13 17:08:07,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:07
2025-03-13 17:08:07,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:08:07,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:07
2025-03-13 17:08:07,005 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:08:07,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.69it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.90it/s] 60%|██████    | 12/20 [00:00<00:00, 39.25it/s] 85%|████████▌ | 17/20 [00:00<00:00, 41.80it/s]100%|██████████| 20/20 [00:04<00:00,  4.67it/s]
2025-03-13 17:08:11,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:11
2025-03-13 17:09:03,914 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6152 secs
2025-03-13 17:09:03,914 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:09:03,915 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.61it/s]
2025-03-13 17:09:27,257 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3429 secs
2025-03-13 17:09:27,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.2550 secs
2025-03-13 17:09:27,261 [INFO]: {
2025-03-13 17:09:27,261 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:27,261 [INFO]: 	index_param: efSearch=207
2025-03-13 17:09:27,261 [INFO]: 	index_path: knn.index
2025-03-13 17:09:27,261 [INFO]: 	size in bytes: 974276410
2025-03-13 17:09:27,261 [INFO]: 	avg_search_speed_ms: 9.630608240176526
2025-03-13 17:09:27,261 [INFO]: 	99p_search_speed_ms: 13.506241310387834
2025-03-13 17:09:27,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:27,261 [INFO]: 	nb vectors: 4952
2025-03-13 17:09:27,261 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:27,261 [INFO]: 	compression ratio: 0.9993086212566719
2025-03-13 17:09:27,261 [INFO]: }
2025-03-13 17:09:27,261 [INFO]: 	>>> Finished "Creating the index" in 80.2593 secs
2025-03-13 17:09:27,261 [INFO]: >>> Finished "Launching the whole pipeline" in 80.2932 secs
2025-03-13 17:09:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 7706 [episode count 1/20]
[retrieval_preprocessing] for episode 77344 [episode count 2/20], we have num_retrieval=np.int64(4808) num_query=np.int64(357)
2025-03-13 17:09:29,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:29,706 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:29
2025-03-13 17:09:29,707 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2213.35it/s]
2025-03-13 17:09:29,730 [INFO]: There are 4808 embeddings of dim 49152
2025-03-13 17:09:29,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 17:09:29,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:29
2025-03-13 17:09:29,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:29,731 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:09:29,731 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:29,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:29,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:29
2025-03-13 17:09:29,731 [INFO]: 992.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:29,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:09:29,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:29
2025-03-13 17:09:29,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:29,731 [INFO]: 	Creating the index 03/13/2025, 17:09:29
2025-03-13 17:09:29,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:29
2025-03-13 17:09:29,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:09:29,732 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:29
2025-03-13 17:09:29,732 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:09:29,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.15it/s] 32%|███▏      | 6/19 [00:00<00:00, 32.23it/s] 58%|█████▊    | 11/19 [00:00<00:00, 40.13it/s] 84%|████████▍ | 16/19 [00:00<00:00, 43.66it/s]100%|██████████| 19/19 [00:03<00:00,  5.12it/s]
2025-03-13 17:09:33,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:33
2025-03-13 17:10:15,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5465 secs
2025-03-13 17:10:15,991 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:10:15,991 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.75it/s]
2025-03-13 17:11:13,685 [INFO]: 	>>> Finished "Compute fast metrics" in 57.6939 secs
2025-03-13 17:11:13,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.9561 secs
2025-03-13 17:11:13,688 [INFO]: {
2025-03-13 17:11:13,689 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:13,689 [INFO]: 	index_param: efSearch=223
2025-03-13 17:11:13,689 [INFO]: 	index_path: knn.index
2025-03-13 17:11:13,689 [INFO]: 	size in bytes: 945945250
2025-03-13 17:11:13,689 [INFO]: 	avg_search_speed_ms: 9.389190049842
2025-03-13 17:11:13,689 [INFO]: 	99p_search_speed_ms: 12.520442409440872
2025-03-13 17:11:13,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:13,689 [INFO]: 	nb vectors: 4808
2025-03-13 17:11:13,689 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:13,689 [INFO]: 	compression ratio: 0.9993086428627872
2025-03-13 17:11:13,689 [INFO]: }
2025-03-13 17:11:13,689 [INFO]: 	>>> Finished "Creating the index" in 103.9577 secs
2025-03-13 17:11:13,689 [INFO]: >>> Finished "Launching the whole pipeline" in 103.9822 secs
2025-03-13 17:11:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 77344 [episode count 2/20]
[retrieval_preprocessing] for episode 52298 [episode count 3/20], we have num_retrieval=np.int64(4870) num_query=np.int64(295)
2025-03-13 17:11:16,840 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:17,628 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:17
2025-03-13 17:11:17,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 802.89it/s]
2025-03-13 17:11:17,658 [INFO]: There are 4870 embeddings of dim 49152
2025-03-13 17:11:17,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 17:11:17,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:17
2025-03-13 17:11:17,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:17,659 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:11:17,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:17,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:11:17,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:17
2025-03-13 17:11:17,660 [INFO]: 1005.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:17,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:11:17,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:17
2025-03-13 17:11:17,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:17,661 [INFO]: 	Creating the index 03/13/2025, 17:11:17
2025-03-13 17:11:17,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:17
2025-03-13 17:11:17,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:11:17,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:17
2025-03-13 17:11:17,665 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:11:17,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.36it/s] 25%|██▌       | 5/20 [00:00<00:00, 25.30it/s] 45%|████▌     | 9/20 [00:00<00:00, 30.55it/s] 65%|██████▌   | 13/20 [00:00<00:00, 33.11it/s] 85%|████████▌ | 17/20 [00:00<00:00, 35.37it/s]100%|██████████| 20/20 [00:04<00:00,  4.59it/s]
2025-03-13 17:11:22,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:22
2025-03-13 17:12:19,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4418 secs
2025-03-13 17:12:19,468 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 17:12:19,468 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 17:12:40,113 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6444 secs
2025-03-13 17:12:40,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4505 secs
2025-03-13 17:12:40,115 [INFO]: {
2025-03-13 17:12:40,116 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:40,116 [INFO]: 	index_param: efSearch=121
2025-03-13 17:12:40,116 [INFO]: 	index_path: knn.index
2025-03-13 17:12:40,116 [INFO]: 	size in bytes: 958143310
2025-03-13 17:12:40,116 [INFO]: 	avg_search_speed_ms: 6.2799507374149846
2025-03-13 17:12:40,116 [INFO]: 	99p_search_speed_ms: 9.567130671348423
2025-03-13 17:12:40,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:40,116 [INFO]: 	nb vectors: 4870
2025-03-13 17:12:40,116 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:40,116 [INFO]: 	compression ratio: 0.9993087151023369
2025-03-13 17:12:40,116 [INFO]: }
2025-03-13 17:12:40,116 [INFO]: 	>>> Finished "Creating the index" in 82.4548 secs
2025-03-13 17:12:40,116 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4880 secs
2025-03-13 17:12:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 52298 [episode count 3/20]
[retrieval_preprocessing] for episode 71774 [episode count 4/20], we have num_retrieval=np.int64(4904) num_query=np.int64(261)
2025-03-13 17:12:42,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:43,013 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:43
2025-03-13 17:12:43,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.18it/s]
2025-03-13 17:12:43,042 [INFO]: There are 4904 embeddings of dim 49152
2025-03-13 17:12:43,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:12:43,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:43
2025-03-13 17:12:43,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:43,043 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:12:43,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:43,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:12:43,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:43
2025-03-13 17:12:43,044 [INFO]: 1012.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:43,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:12:43,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:43
2025-03-13 17:12:43,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:43,044 [INFO]: 	Creating the index 03/13/2025, 17:12:43
2025-03-13 17:12:43,044 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:43
2025-03-13 17:12:43,047 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:12:43,048 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:43
2025-03-13 17:12:43,048 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:12:43,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.27it/s] 35%|███▌      | 7/20 [00:00<00:00, 37.05it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.48it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.47it/s]100%|██████████| 20/20 [00:03<00:00,  5.38it/s]
2025-03-13 17:12:46,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:46
2025-03-13 17:13:34,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0687 secs
2025-03-13 17:13:34,842 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:13:34,842 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.29it/s]
2025-03-13 17:14:07,014 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1715 secs
2025-03-13 17:14:07,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9700 secs
2025-03-13 17:14:07,018 [INFO]: {
2025-03-13 17:14:07,018 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:07,018 [INFO]: 	index_param: efSearch=213
2025-03-13 17:14:07,018 [INFO]: 	index_path: knn.index
2025-03-13 17:14:07,018 [INFO]: 	size in bytes: 964832530
2025-03-13 17:14:07,018 [INFO]: 	avg_search_speed_ms: 9.931536817501458
2025-03-13 17:14:07,018 [INFO]: 	99p_search_speed_ms: 17.256543533876535
2025-03-13 17:14:07,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:07,018 [INFO]: 	nb vectors: 4904
2025-03-13 17:14:07,018 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:07,018 [INFO]: 	compression ratio: 0.9993087940349606
2025-03-13 17:14:07,018 [INFO]: }
2025-03-13 17:14:07,018 [INFO]: 	>>> Finished "Creating the index" in 83.9739 secs
2025-03-13 17:14:07,018 [INFO]: >>> Finished "Launching the whole pipeline" in 84.0048 secs
2025-03-13 17:14:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 71774 [episode count 4/20]
[retrieval_preprocessing] for episode 31348 [episode count 5/20], we have num_retrieval=np.int64(4926) num_query=np.int64(239)
2025-03-13 17:14:09,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:10,633 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:10
2025-03-13 17:14:10,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-13 17:14:10,662 [INFO]: There are 4926 embeddings of dim 49152
2025-03-13 17:14:10,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:14:10,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:10
2025-03-13 17:14:10,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:10,662 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:14:10,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:10,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:10,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:10
2025-03-13 17:14:10,663 [INFO]: 1016.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:10,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:10,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:10
2025-03-13 17:14:10,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:10,663 [INFO]: 	Creating the index 03/13/2025, 17:14:10
2025-03-13 17:14:10,663 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:10
2025-03-13 17:14:10,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:14:10,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:10
2025-03-13 17:14:10,664 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:14:10,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 16.92it/s] 35%|███▌      | 7/20 [00:00<00:00, 32.76it/s] 60%|██████    | 12/20 [00:00<00:00, 38.09it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.50it/s]100%|██████████| 20/20 [00:03<00:00,  5.12it/s]
2025-03-13 17:14:14,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:14
2025-03-13 17:15:07,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4803 secs
2025-03-13 17:15:07,052 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:15:07,052 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 17:15:55,016 [INFO]: 	>>> Finished "Compute fast metrics" in 47.9636 secs
2025-03-13 17:15:55,019 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.3548 secs
2025-03-13 17:15:55,019 [INFO]: {
2025-03-13 17:15:55,019 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:55,019 [INFO]: 	index_param: efSearch=164
2025-03-13 17:15:55,019 [INFO]: 	index_path: knn.index
2025-03-13 17:15:55,019 [INFO]: 	size in bytes: 969160990
2025-03-13 17:15:55,019 [INFO]: 	avg_search_speed_ms: 8.279541812857168
2025-03-13 17:15:55,019 [INFO]: 	99p_search_speed_ms: 12.242195899598302
2025-03-13 17:15:55,019 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:55,019 [INFO]: 	nb vectors: 4926
2025-03-13 17:15:55,019 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:55,019 [INFO]: 	compression ratio: 0.9993086989603245
2025-03-13 17:15:55,019 [INFO]: }
2025-03-13 17:15:55,020 [INFO]: 	>>> Finished "Creating the index" in 104.3565 secs
2025-03-13 17:15:55,020 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3868 secs
2025-03-13 17:15:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 31348 [episode count 5/20]
[retrieval_preprocessing] for episode 25725 [episode count 6/20], we have num_retrieval=np.int64(4932) num_query=np.int64(233)
2025-03-13 17:15:56,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:57,802 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:57
2025-03-13 17:15:57,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.57it/s]
2025-03-13 17:15:57,831 [INFO]: There are 4932 embeddings of dim 49152
2025-03-13 17:15:57,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:15:57,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:57
2025-03-13 17:15:57,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:57,832 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:15:57,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:57,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:15:57,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:57
2025-03-13 17:15:57,832 [INFO]: 1017.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:57,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:15:57,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:57
2025-03-13 17:15:57,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:57,832 [INFO]: 	Creating the index 03/13/2025, 17:15:57
2025-03-13 17:15:57,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:57
2025-03-13 17:15:57,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:15:57,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:57
2025-03-13 17:15:57,833 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:15:57,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.58it/s] 25%|██▌       | 5/20 [00:00<00:00, 22.63it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.74it/s] 65%|██████▌   | 13/20 [00:00<00:00, 32.80it/s] 85%|████████▌ | 17/20 [00:00<00:00, 34.98it/s]100%|██████████| 20/20 [00:04<00:00,  4.18it/s]
2025-03-13 17:16:02,624 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:02
2025-03-13 17:16:56,317 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6925 secs
2025-03-13 17:16:56,317 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 17:16:56,318 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.46it/s]
2025-03-13 17:17:30,364 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0464 secs
2025-03-13 17:17:30,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.5338 secs
2025-03-13 17:17:30,367 [INFO]: {
2025-03-13 17:17:30,367 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:30,367 [INFO]: 	index_param: efSearch=158
2025-03-13 17:17:30,367 [INFO]: 	index_path: knn.index
2025-03-13 17:17:30,367 [INFO]: 	size in bytes: 970341430
2025-03-13 17:17:30,367 [INFO]: 	avg_search_speed_ms: 9.558217267658968
2025-03-13 17:17:30,367 [INFO]: 	99p_search_speed_ms: 15.631658211350427
2025-03-13 17:17:30,367 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:30,367 [INFO]: 	nb vectors: 4932
2025-03-13 17:17:30,367 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:30,367 [INFO]: 	compression ratio: 0.99930872373449
2025-03-13 17:17:30,367 [INFO]: }
2025-03-13 17:17:30,367 [INFO]: 	>>> Finished "Creating the index" in 92.5356 secs
2025-03-13 17:17:30,368 [INFO]: >>> Finished "Launching the whole pipeline" in 92.5659 secs
2025-03-13 17:17:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 25725 [episode count 6/20]
[retrieval_preprocessing] for episode 33466 [episode count 7/20], we have num_retrieval=np.int64(4985) num_query=np.int64(180)
2025-03-13 17:17:34,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:35,237 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:35
2025-03-13 17:17:35,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.91it/s]
2025-03-13 17:17:35,263 [INFO]: There are 4985 embeddings of dim 49152
2025-03-13 17:17:35,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:17:35,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:35
2025-03-13 17:17:35,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:35,264 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:17:35,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:35,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:35,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:35
2025-03-13 17:17:35,264 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:35,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:17:35,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:35
2025-03-13 17:17:35,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:35,264 [INFO]: 	Creating the index 03/13/2025, 17:17:35
2025-03-13 17:17:35,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:35
2025-03-13 17:17:35,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:17:35,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:35
2025-03-13 17:17:35,265 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:17:35,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.06it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.00it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.83it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.92it/s]100%|██████████| 20/20 [00:03<00:00,  5.19it/s]
2025-03-13 17:17:39,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:39
2025-03-13 17:18:25,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7259 secs
2025-03-13 17:18:25,852 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 17:18:25,852 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 17:18:54,187 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3345 secs
2025-03-13 17:18:54,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9246 secs
2025-03-13 17:18:54,190 [INFO]: {
2025-03-13 17:18:54,190 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:54,190 [INFO]: 	index_param: efSearch=189
2025-03-13 17:18:54,190 [INFO]: 	index_path: knn.index
2025-03-13 17:18:54,190 [INFO]: 	size in bytes: 980768950
2025-03-13 17:18:54,190 [INFO]: 	avg_search_speed_ms: 9.336956996248077
2025-03-13 17:18:54,190 [INFO]: 	99p_search_speed_ms: 12.610610225237904
2025-03-13 17:18:54,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:54,190 [INFO]: 	nb vectors: 4985
2025-03-13 17:18:54,190 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:54,190 [INFO]: 	compression ratio: 0.9993086343118835
2025-03-13 17:18:54,190 [INFO]: }
2025-03-13 17:18:54,190 [INFO]: 	>>> Finished "Creating the index" in 78.9264 secs
2025-03-13 17:18:54,191 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9535 secs
2025-03-13 17:18:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 33466 [episode count 7/20]
[retrieval_preprocessing] for episode 7486 [episode count 8/20], we have num_retrieval=np.int64(4889) num_query=np.int64(276)
2025-03-13 17:18:56,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:57,457 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:57
2025-03-13 17:18:57,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-13 17:18:57,494 [INFO]: There are 4889 embeddings of dim 49152
2025-03-13 17:18:57,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 17:18:57,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:57
2025-03-13 17:18:57,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:57,495 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:18:57,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:57,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:18:57,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:57
2025-03-13 17:18:57,495 [INFO]: 1009.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:57,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:18:57,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:57
2025-03-13 17:18:57,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:57,496 [INFO]: 	Creating the index 03/13/2025, 17:18:57
2025-03-13 17:18:57,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:57
2025-03-13 17:18:57,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:18:57,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:57
2025-03-13 17:18:57,498 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:18:57,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.13it/s] 25%|██▌       | 5/20 [00:00<00:00, 23.53it/s] 50%|█████     | 10/20 [00:00<00:00, 33.42it/s] 75%|███████▌  | 15/20 [00:00<00:00, 38.57it/s]100%|██████████| 20/20 [00:03<00:00,  3.52it/s]100%|██████████| 20/20 [00:03<00:00,  5.24it/s]
2025-03-13 17:19:01,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:01
2025-03-13 17:19:51,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0997 secs
2025-03-13 17:19:51,424 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:19:51,424 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-13 17:20:23,942 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5179 secs
2025-03-13 17:20:23,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4469 secs
2025-03-13 17:20:23,945 [INFO]: {
2025-03-13 17:20:23,945 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:23,945 [INFO]: 	index_param: efSearch=187
2025-03-13 17:20:23,945 [INFO]: 	index_path: knn.index
2025-03-13 17:20:23,945 [INFO]: 	size in bytes: 961881430
2025-03-13 17:20:23,945 [INFO]: 	avg_search_speed_ms: 8.163827891100427
2025-03-13 17:20:23,945 [INFO]: 	99p_search_speed_ms: 13.16629228182137
2025-03-13 17:20:23,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:23,945 [INFO]: 	nb vectors: 4889
2025-03-13 17:20:23,945 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:23,945 [INFO]: 	compression ratio: 0.9993087318465022
2025-03-13 17:20:23,945 [INFO]: }
2025-03-13 17:20:23,945 [INFO]: 	>>> Finished "Creating the index" in 86.4497 secs
2025-03-13 17:20:23,945 [INFO]: >>> Finished "Launching the whole pipeline" in 86.4885 secs
2025-03-13 17:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 7486 [episode count 8/20]
[retrieval_preprocessing] for episode 84311 [episode count 9/20], we have num_retrieval=np.int64(4855) num_query=np.int64(310)
2025-03-13 17:20:26,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:27,205 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:27
2025-03-13 17:20:27,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.62it/s]
2025-03-13 17:20:27,230 [INFO]: There are 4855 embeddings of dim 49152
2025-03-13 17:20:27,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:20:27,231 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:27
2025-03-13 17:20:27,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:27,231 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:20:27,231 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:27,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:27,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:27
2025-03-13 17:20:27,231 [INFO]: 1002.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:27,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:20:27,231 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:27
2025-03-13 17:20:27,231 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:27,231 [INFO]: 	Creating the index 03/13/2025, 17:20:27
2025-03-13 17:20:27,231 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:27
2025-03-13 17:20:27,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:20:27,233 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:27
2025-03-13 17:20:27,233 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:20:27,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.57it/s] 30%|███       | 6/20 [00:00<00:00, 25.62it/s] 55%|█████▌    | 11/20 [00:00<00:00, 33.60it/s] 80%|████████  | 16/20 [00:00<00:00, 37.36it/s]100%|██████████| 20/20 [00:04<00:00,  2.79it/s]100%|██████████| 20/20 [00:04<00:00,  4.40it/s]
2025-03-13 17:20:31,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:31
2025-03-13 17:21:23,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7983 secs
2025-03-13 17:21:23,580 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 17:21:23,580 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 17:21:54,416 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8359 secs
2025-03-13 17:21:55,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.9382 secs
2025-03-13 17:21:55,171 [INFO]: {
2025-03-13 17:21:55,171 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:55,171 [INFO]: 	index_param: efSearch=148
2025-03-13 17:21:55,171 [INFO]: 	index_path: knn.index
2025-03-13 17:21:55,171 [INFO]: 	size in bytes: 955192210
2025-03-13 17:21:55,172 [INFO]: 	avg_search_speed_ms: 9.065152090828079
2025-03-13 17:21:55,172 [INFO]: 	99p_search_speed_ms: 15.677308593876662
2025-03-13 17:21:55,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:55,172 [INFO]: 	nb vectors: 4855
2025-03-13 17:21:55,172 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:55,172 [INFO]: 	compression ratio: 0.9993086522345068
2025-03-13 17:21:55,172 [INFO]: }
2025-03-13 17:21:55,172 [INFO]: 	>>> Finished "Creating the index" in 87.9405 secs
2025-03-13 17:21:55,172 [INFO]: >>> Finished "Launching the whole pipeline" in 87.9669 secs
2025-03-13 17:21:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 84311 [episode count 9/20]
[retrieval_preprocessing] for episode 14195 [episode count 10/20], we have num_retrieval=np.int64(4954) num_query=np.int64(211)
2025-03-13 17:21:57,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:58,540 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:58
2025-03-13 17:21:58,540 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1648.70it/s]
2025-03-13 17:21:58,566 [INFO]: There are 4954 embeddings of dim 49152
2025-03-13 17:21:58,566 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:21:58,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:58
2025-03-13 17:21:58,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:58,566 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:21:58,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:58,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:21:58,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:58
2025-03-13 17:21:58,566 [INFO]: 1022.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:58,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:21:58,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:58
2025-03-13 17:21:58,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:58,567 [INFO]: 	Creating the index 03/13/2025, 17:21:58
2025-03-13 17:21:58,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:58
2025-03-13 17:21:58,568 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:21:58,568 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:58
2025-03-13 17:21:58,568 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:21:58,568 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.85it/s] 30%|███       | 6/20 [00:00<00:00, 29.38it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.92it/s] 80%|████████  | 16/20 [00:00<00:00, 38.83it/s]100%|██████████| 20/20 [00:04<00:00,  2.70it/s]100%|██████████| 20/20 [00:04<00:00,  4.28it/s]
2025-03-13 17:22:03,241 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:03
2025-03-13 17:22:54,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2239 secs
2025-03-13 17:22:54,465 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:22:54,465 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 17:23:24,114 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6489 secs
2025-03-13 17:23:24,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5497 secs
2025-03-13 17:23:24,118 [INFO]: {
2025-03-13 17:23:24,118 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:24,118 [INFO]: 	index_param: efSearch=175
2025-03-13 17:23:24,118 [INFO]: 	index_path: knn.index
2025-03-13 17:23:24,118 [INFO]: 	size in bytes: 974669890
2025-03-13 17:23:24,118 [INFO]: 	avg_search_speed_ms: 9.837107395436414
2025-03-13 17:23:24,118 [INFO]: 	99p_search_speed_ms: 14.237886546179652
2025-03-13 17:23:24,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:24,118 [INFO]: 	nb vectors: 4954
2025-03-13 17:23:24,118 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:24,118 [INFO]: 	compression ratio: 0.9993086295094229
2025-03-13 17:23:24,118 [INFO]: }
2025-03-13 17:23:24,118 [INFO]: 	>>> Finished "Creating the index" in 85.5515 secs
2025-03-13 17:23:24,118 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5778 secs
2025-03-13 17:23:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 14195 [episode count 10/20]
[retrieval_preprocessing] for episode 59264 [episode count 11/20], we have num_retrieval=np.int64(4857) num_query=np.int64(308)
2025-03-13 17:23:27,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:27,909 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:27
2025-03-13 17:23:27,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.05it/s]
2025-03-13 17:23:27,935 [INFO]: There are 4857 embeddings of dim 49152
2025-03-13 17:23:27,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:23:27,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:27,935 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:23:27,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:27,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:23:27,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,936 [INFO]: 1002.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:27,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:23:27,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:27
2025-03-13 17:23:27,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:27,936 [INFO]: 	Creating the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:27
2025-03-13 17:23:27,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:23:27,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,937 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:23:27,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.91it/s] 25%|██▌       | 5/20 [00:00<00:00, 20.53it/s] 45%|████▌     | 9/20 [00:00<00:00, 26.72it/s] 65%|██████▌   | 13/20 [00:00<00:00, 30.03it/s] 85%|████████▌ | 17/20 [00:00<00:00, 31.87it/s]100%|██████████| 20/20 [00:05<00:00,  3.33it/s]
2025-03-13 17:23:33,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:33
2025-03-13 17:24:23,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9120 secs
2025-03-13 17:24:23,853 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:24:23,854 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.46it/s]
2025-03-13 17:24:58,059 [INFO]: 	>>> Finished "Compute fast metrics" in 34.2057 secs
2025-03-13 17:24:58,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9729 secs
2025-03-13 17:24:58,910 [INFO]: {
2025-03-13 17:24:58,910 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:58,910 [INFO]: 	index_param: efSearch=169
2025-03-13 17:24:58,910 [INFO]: 	index_path: knn.index
2025-03-13 17:24:58,910 [INFO]: 	size in bytes: 955585690
2025-03-13 17:24:58,911 [INFO]: 	avg_search_speed_ms: 7.312107002546423
2025-03-13 17:24:58,911 [INFO]: 	99p_search_speed_ms: 10.015418131370094
2025-03-13 17:24:58,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:58,911 [INFO]: 	nb vectors: 4857
2025-03-13 17:24:58,911 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:58,911 [INFO]: 	compression ratio: 0.9993086606393196
2025-03-13 17:24:58,911 [INFO]: }
2025-03-13 17:24:58,911 [INFO]: 	>>> Finished "Creating the index" in 90.9752 secs
2025-03-13 17:24:58,911 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0019 secs
2025-03-13 17:24:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 59264 [episode count 11/20]
[retrieval_preprocessing] for episode 8626 [episode count 12/20], we have num_retrieval=np.int64(4970) num_query=np.int64(195)
2025-03-13 17:25:01,183 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:01,928 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:01
2025-03-13 17:25:01,928 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.98it/s]
2025-03-13 17:25:01,953 [INFO]: There are 4970 embeddings of dim 49152
2025-03-13 17:25:01,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:25:01,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:01
2025-03-13 17:25:01,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:01,954 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:25:01,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:01,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:01,954 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:01
2025-03-13 17:25:01,954 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:01,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:25:01,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:01
2025-03-13 17:25:01,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:01,954 [INFO]: 	Creating the index 03/13/2025, 17:25:01
2025-03-13 17:25:01,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:01
2025-03-13 17:25:01,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:25:01,955 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:01
2025-03-13 17:25:01,955 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:25:01,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.44it/s] 30%|███       | 6/20 [00:00<00:00, 30.38it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.53it/s] 80%|████████  | 16/20 [00:00<00:00, 39.32it/s]100%|██████████| 20/20 [00:04<00:00,  2.89it/s]100%|██████████| 20/20 [00:04<00:00,  4.58it/s]
2025-03-13 17:25:06,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:06
2025-03-13 17:26:06,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.4441 secs
2025-03-13 17:26:06,773 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 17:26:06,773 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.54it/s]
2025-03-13 17:26:26,167 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3932 secs
2025-03-13 17:26:26,686 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.7303 secs
2025-03-13 17:26:26,686 [INFO]: {
2025-03-13 17:26:26,686 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:26,686 [INFO]: 	index_param: efSearch=143
2025-03-13 17:26:26,687 [INFO]: 	index_path: knn.index
2025-03-13 17:26:26,687 [INFO]: 	size in bytes: 977817730
2025-03-13 17:26:26,687 [INFO]: 	avg_search_speed_ms: 10.1624093121637
2025-03-13 17:26:26,687 [INFO]: 	99p_search_speed_ms: 16.753737141843885
2025-03-13 17:26:26,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:26,687 [INFO]: 	nb vectors: 4970
2025-03-13 17:26:26,687 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:26,687 [INFO]: 	compression ratio: 0.999308695292322
2025-03-13 17:26:26,687 [INFO]: }
2025-03-13 17:26:26,687 [INFO]: 	>>> Finished "Creating the index" in 84.7333 secs
2025-03-13 17:26:26,688 [INFO]: >>> Finished "Launching the whole pipeline" in 84.7599 secs
2025-03-13 17:26:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 8626 [episode count 12/20]
[retrieval_preprocessing] for episode 50621 [episode count 13/20], we have num_retrieval=np.int64(4950) num_query=np.int64(215)
2025-03-13 17:26:30,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:31,239 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:31
2025-03-13 17:26:31,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 896.99it/s]
2025-03-13 17:26:31,266 [INFO]: There are 4950 embeddings of dim 49152
2025-03-13 17:26:31,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:26:31,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:31
2025-03-13 17:26:31,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:31,266 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:26:31,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:31,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:31,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:31
2025-03-13 17:26:31,267 [INFO]: 1021.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:31,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:31,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:31
2025-03-13 17:26:31,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:31,267 [INFO]: 	Creating the index 03/13/2025, 17:26:31
2025-03-13 17:26:31,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:31
2025-03-13 17:26:31,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:26:31,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:31
2025-03-13 17:26:31,268 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:26:31,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.70it/s] 25%|██▌       | 5/20 [00:00<00:00, 21.73it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.15it/s] 65%|██████▌   | 13/20 [00:00<00:00, 30.76it/s] 85%|████████▌ | 17/20 [00:00<00:00, 32.68it/s]100%|██████████| 20/20 [00:05<00:00,  3.69it/s]
2025-03-13 17:26:36,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:36
2025-03-13 17:27:26,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5887 secs
2025-03-13 17:27:26,276 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 17:27:26,276 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-13 17:27:46,580 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3041 secs
2025-03-13 17:27:46,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3152 secs
2025-03-13 17:27:46,584 [INFO]: {
2025-03-13 17:27:46,584 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:46,584 [INFO]: 	index_param: efSearch=186
2025-03-13 17:27:46,584 [INFO]: 	index_path: knn.index
2025-03-13 17:27:46,584 [INFO]: 	size in bytes: 973882930
2025-03-13 17:27:46,584 [INFO]: 	avg_search_speed_ms: 10.567396548163169
2025-03-13 17:27:46,584 [INFO]: 	99p_search_speed_ms: 20.453781052492555
2025-03-13 17:27:46,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:46,584 [INFO]: 	nb vectors: 4950
2025-03-13 17:27:46,584 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:46,584 [INFO]: 	compression ratio: 0.9993086129972522
2025-03-13 17:27:46,584 [INFO]: }
2025-03-13 17:27:46,584 [INFO]: 	>>> Finished "Creating the index" in 75.3170 secs
2025-03-13 17:27:46,584 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3453 secs
2025-03-13 17:27:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 50621 [episode count 13/20]
[retrieval_preprocessing] for episode 65985 [episode count 14/20], we have num_retrieval=np.int64(4912) num_query=np.int64(253)
2025-03-13 17:27:48,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:49,513 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:49
2025-03-13 17:27:49,513 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.00it/s]
2025-03-13 17:27:49,538 [INFO]: There are 4912 embeddings of dim 49152
2025-03-13 17:27:49,539 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:27:49,539 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:49
2025-03-13 17:27:49,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:49,539 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:27:49,539 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:49,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:27:49,539 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:49
2025-03-13 17:27:49,539 [INFO]: 1013.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:49,539 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:27:49,539 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:49
2025-03-13 17:27:49,539 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:49,539 [INFO]: 	Creating the index 03/13/2025, 17:27:49
2025-03-13 17:27:49,539 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:49
2025-03-13 17:27:49,540 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:27:49,540 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:49
2025-03-13 17:27:49,540 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:27:49,540 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.10it/s] 30%|███       | 6/20 [00:00<00:00, 28.47it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.74it/s] 80%|████████  | 16/20 [00:00<00:00, 39.27it/s]100%|██████████| 20/20 [00:04<00:00,  2.79it/s]100%|██████████| 20/20 [00:04<00:00,  4.41it/s]
2025-03-13 17:27:54,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:54
2025-03-13 17:28:41,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0269 secs
2025-03-13 17:28:41,103 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 17:28:41,103 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.96it/s]
2025-03-13 17:29:25,132 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0290 secs
2025-03-13 17:29:25,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.5950 secs
2025-03-13 17:29:25,136 [INFO]: {
2025-03-13 17:29:25,136 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:25,136 [INFO]: 	index_param: efSearch=231
2025-03-13 17:29:25,136 [INFO]: 	index_path: knn.index
2025-03-13 17:29:25,136 [INFO]: 	size in bytes: 966406510
2025-03-13 17:29:25,136 [INFO]: 	avg_search_speed_ms: 11.148980366265445
2025-03-13 17:29:25,136 [INFO]: 	99p_search_speed_ms: 18.326371200382688
2025-03-13 17:29:25,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:25,136 [INFO]: 	nb vectors: 4912
2025-03-13 17:29:25,136 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:25,136 [INFO]: 	compression ratio: 0.9993087650040768
2025-03-13 17:29:25,136 [INFO]: }
2025-03-13 17:29:25,136 [INFO]: 	>>> Finished "Creating the index" in 95.5966 secs
2025-03-13 17:29:25,136 [INFO]: >>> Finished "Launching the whole pipeline" in 95.6231 secs
2025-03-13 17:29:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 65985 [episode count 14/20]
[retrieval_preprocessing] for episode 35794 [episode count 15/20], we have num_retrieval=np.int64(4898) num_query=np.int64(267)
2025-03-13 17:29:28,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:28,758 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:28
2025-03-13 17:29:28,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 936.02it/s]
2025-03-13 17:29:28,788 [INFO]: There are 4898 embeddings of dim 49152
2025-03-13 17:29:28,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:29:28,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:28
2025-03-13 17:29:28,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:28,789 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:29:28,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:28,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:29:28,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:28
2025-03-13 17:29:28,790 [INFO]: 1010.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:28,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:29:28,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:28
2025-03-13 17:29:28,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:28,790 [INFO]: 	Creating the index 03/13/2025, 17:29:28
2025-03-13 17:29:28,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:28
2025-03-13 17:29:28,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:29:28,794 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:28
2025-03-13 17:29:28,794 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:29:28,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.59it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.61it/s] 60%|██████    | 12/20 [00:00<00:00, 38.90it/s] 85%|████████▌ | 17/20 [00:00<00:00, 41.40it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-13 17:29:34,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:34
2025-03-13 17:30:31,100 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0687 secs
2025-03-13 17:30:31,100 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 17:30:31,100 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.64it/s]
2025-03-13 17:31:00,802 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7020 secs
2025-03-13 17:31:00,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.0115 secs
2025-03-13 17:31:00,806 [INFO]: {
2025-03-13 17:31:00,806 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:00,806 [INFO]: 	index_param: efSearch=189
2025-03-13 17:31:00,806 [INFO]: 	index_path: knn.index
2025-03-13 17:31:00,806 [INFO]: 	size in bytes: 963652090
2025-03-13 17:31:00,806 [INFO]: 	avg_search_speed_ms: 10.517901719668263
2025-03-13 17:31:00,806 [INFO]: 	99p_search_speed_ms: 16.458643949590623
2025-03-13 17:31:00,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:00,806 [INFO]: 	nb vectors: 4898
2025-03-13 17:31:00,806 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:00,806 [INFO]: 	compression ratio: 0.9993087692052844
2025-03-13 17:31:00,806 [INFO]: }
2025-03-13 17:31:00,806 [INFO]: 	>>> Finished "Creating the index" in 92.0155 secs
2025-03-13 17:31:00,806 [INFO]: >>> Finished "Launching the whole pipeline" in 92.0476 secs
2025-03-13 17:31:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 35794 [episode count 15/20]
[retrieval_preprocessing] for episode 64981 [episode count 16/20], we have num_retrieval=np.int64(4894) num_query=np.int64(271)
2025-03-13 17:31:03,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:04,292 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:04
2025-03-13 17:31:04,292 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1074.09it/s]
2025-03-13 17:31:04,321 [INFO]: There are 4894 embeddings of dim 49152
2025-03-13 17:31:04,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:31:04,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:04
2025-03-13 17:31:04,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:04,322 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:31:04,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:04,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:04,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:04
2025-03-13 17:31:04,322 [INFO]: 1010.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:04,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:04,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:04
2025-03-13 17:31:04,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:04,322 [INFO]: 	Creating the index 03/13/2025, 17:31:04
2025-03-13 17:31:04,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:04
2025-03-13 17:31:04,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:31:04,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:04
2025-03-13 17:31:04,323 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:31:04,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.07it/s] 25%|██▌       | 5/20 [00:00<00:00, 23.57it/s] 50%|█████     | 10/20 [00:00<00:00, 31.41it/s] 75%|███████▌  | 15/20 [00:00<00:00, 35.05it/s] 95%|█████████▌| 19/20 [00:00<00:00, 36.60it/s]100%|██████████| 20/20 [00:04<00:00,  4.67it/s]
2025-03-13 17:31:08,609 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:08
2025-03-13 17:31:55,961 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3515 secs
2025-03-13 17:31:55,961 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:31:55,961 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-13 17:32:31,847 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8852 secs
2025-03-13 17:32:31,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5271 secs
2025-03-13 17:32:31,851 [INFO]: {
2025-03-13 17:32:31,851 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:31,851 [INFO]: 	index_param: efSearch=201
2025-03-13 17:32:31,851 [INFO]: 	index_path: knn.index
2025-03-13 17:32:31,851 [INFO]: 	size in bytes: 962865130
2025-03-13 17:32:31,851 [INFO]: 	avg_search_speed_ms: 10.057832622222257
2025-03-13 17:32:31,851 [INFO]: 	99p_search_speed_ms: 13.000388122163713
2025-03-13 17:32:31,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:31,851 [INFO]: 	nb vectors: 4894
2025-03-13 17:32:31,851 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:31,851 [INFO]: 	compression ratio: 0.9993087526183444
2025-03-13 17:32:31,851 [INFO]: }
2025-03-13 17:32:31,851 [INFO]: 	>>> Finished "Creating the index" in 87.5288 secs
2025-03-13 17:32:31,851 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5585 secs
2025-03-13 17:32:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 64981 [episode count 16/20]
[retrieval_preprocessing] for episode 71144 [episode count 17/20], we have num_retrieval=np.int64(4876) num_query=np.int64(289)
2025-03-13 17:32:34,949 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:35,840 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:35
2025-03-13 17:32:35,840 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.37it/s]100%|██████████| 1/1 [00:00<00:00,  2.36it/s]
2025-03-13 17:32:36,293 [INFO]: There are 4876 embeddings of dim 49152
2025-03-13 17:32:36,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4540 secs
2025-03-13 17:32:36,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:36
2025-03-13 17:32:36,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:36,295 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:32:36,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:36,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:32:36,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:36
2025-03-13 17:32:36,296 [INFO]: 1006.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:36,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:32:36,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:36
2025-03-13 17:32:36,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:36,296 [INFO]: 	Creating the index 03/13/2025, 17:32:36
2025-03-13 17:32:36,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:36
2025-03-13 17:32:36,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:32:36,300 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:36
2025-03-13 17:32:36,300 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:32:36,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.73it/s] 25%|██▌       | 5/20 [00:00<00:00, 27.09it/s] 45%|████▌     | 9/20 [00:00<00:00, 32.46it/s] 65%|██████▌   | 13/20 [00:00<00:00, 35.09it/s] 85%|████████▌ | 17/20 [00:00<00:00, 36.31it/s]100%|██████████| 20/20 [00:04<00:00,  4.61it/s]
2025-03-13 17:32:40,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:40
2025-03-13 17:33:27,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1230 secs
2025-03-13 17:33:27,765 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:33:27,765 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 17:33:59,475 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7101 secs
2025-03-13 17:33:59,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1783 secs
2025-03-13 17:33:59,478 [INFO]: {
2025-03-13 17:33:59,478 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:59,478 [INFO]: 	index_param: efSearch=212
2025-03-13 17:33:59,478 [INFO]: 	index_path: knn.index
2025-03-13 17:33:59,478 [INFO]: 	size in bytes: 959323810
2025-03-13 17:33:59,478 [INFO]: 	avg_search_speed_ms: 10.299932533188365
2025-03-13 17:33:59,478 [INFO]: 	99p_search_speed_ms: 15.469211339950562
2025-03-13 17:33:59,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:59,478 [INFO]: 	nb vectors: 4876
2025-03-13 17:33:59,478 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:59,478 [INFO]: 	compression ratio: 0.9993086776403475
2025-03-13 17:33:59,478 [INFO]: }
2025-03-13 17:33:59,478 [INFO]: 	>>> Finished "Creating the index" in 83.1821 secs
2025-03-13 17:33:59,478 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6386 secs
2025-03-13 17:34:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 71144 [episode count 17/20]
[retrieval_preprocessing] for episode 35829 [episode count 18/20], we have num_retrieval=np.int64(4890) num_query=np.int64(275)
2025-03-13 17:34:01,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:02,366 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:02
2025-03-13 17:34:02,366 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]
2025-03-13 17:34:02,391 [INFO]: There are 4890 embeddings of dim 49152
2025-03-13 17:34:02,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 17:34:02,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:02
2025-03-13 17:34:02,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:02,391 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:34:02,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:02,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:34:02,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:02
2025-03-13 17:34:02,392 [INFO]: 1009.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:02,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:02,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:02
2025-03-13 17:34:02,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:02,392 [INFO]: 	Creating the index 03/13/2025, 17:34:02
2025-03-13 17:34:02,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:02
2025-03-13 17:34:02,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:34:02,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:02
2025-03-13 17:34:02,393 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:34:02,394 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.79it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.91it/s] 65%|██████▌   | 13/20 [00:00<00:00, 44.62it/s] 95%|█████████▌| 19/20 [00:00<00:00, 48.73it/s]100%|██████████| 20/20 [00:03<00:00,  5.82it/s]
2025-03-13 17:34:05,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:05
2025-03-13 17:34:52,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1244 secs
2025-03-13 17:34:52,957 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:34:52,958 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.46it/s]
2025-03-13 17:35:18,475 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5174 secs
2025-03-13 17:35:18,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0848 secs
2025-03-13 17:35:18,478 [INFO]: {
2025-03-13 17:35:18,478 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:18,478 [INFO]: 	index_param: efSearch=153
2025-03-13 17:35:18,478 [INFO]: 	index_path: knn.index
2025-03-13 17:35:18,479 [INFO]: 	size in bytes: 962078170
2025-03-13 17:35:18,479 [INFO]: 	avg_search_speed_ms: 8.864350203492394
2025-03-13 17:35:18,479 [INFO]: 	99p_search_speed_ms: 17.53299246309325
2025-03-13 17:35:18,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:18,479 [INFO]: 	nb vectors: 4890
2025-03-13 17:35:18,479 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:18,479 [INFO]: 	compression ratio: 0.9993087360042687
2025-03-13 17:35:18,479 [INFO]: }
2025-03-13 17:35:18,479 [INFO]: 	>>> Finished "Creating the index" in 76.0867 secs
2025-03-13 17:35:18,479 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1122 secs
2025-03-13 17:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 35829 [episode count 18/20]
[retrieval_preprocessing] for episode 30429 [episode count 19/20], we have num_retrieval=np.int64(4865) num_query=np.int64(300)
2025-03-13 17:35:20,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:21,252 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:21
2025-03-13 17:35:21,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1275.64it/s]
2025-03-13 17:35:21,281 [INFO]: There are 4865 embeddings of dim 49152
2025-03-13 17:35:21,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 17:35:21,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:21
2025-03-13 17:35:21,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:21,283 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:35:21,283 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:21,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:35:21,283 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:21
2025-03-13 17:35:21,283 [INFO]: 1004.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:21,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:35:21,284 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:21
2025-03-13 17:35:21,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:21,284 [INFO]: 	Creating the index 03/13/2025, 17:35:21
2025-03-13 17:35:21,285 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:21
2025-03-13 17:35:21,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:35:21,287 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:21
2025-03-13 17:35:21,287 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:35:21,287 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.27it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.51it/s] 60%|██████    | 12/20 [00:00<00:00, 39.92it/s] 85%|████████▌ | 17/20 [00:00<00:00, 42.45it/s]100%|██████████| 20/20 [00:04<00:00,  4.65it/s]
2025-03-13 17:35:25,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:25
2025-03-13 17:36:15,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2842 secs
2025-03-13 17:36:15,879 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 17:36:15,879 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.85it/s]
2025-03-13 17:36:49,485 [INFO]: 	>>> Finished "Compute fast metrics" in 33.6062 secs
2025-03-13 17:36:50,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.7812 secs
2025-03-13 17:36:50,069 [INFO]: {
2025-03-13 17:36:50,069 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:50,069 [INFO]: 	index_param: efSearch=216
2025-03-13 17:36:50,069 [INFO]: 	index_path: knn.index
2025-03-13 17:36:50,069 [INFO]: 	size in bytes: 957159610
2025-03-13 17:36:50,069 [INFO]: 	avg_search_speed_ms: 10.726431616265547
2025-03-13 17:36:50,069 [INFO]: 	99p_search_speed_ms: 17.27870243601498
2025-03-13 17:36:50,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:50,070 [INFO]: 	nb vectors: 4865
2025-03-13 17:36:50,070 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:50,070 [INFO]: 	compression ratio: 0.9993086941894676
2025-03-13 17:36:50,070 [INFO]: }
2025-03-13 17:36:50,070 [INFO]: 	>>> Finished "Creating the index" in 88.7853 secs
2025-03-13 17:36:50,070 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8179 secs
2025-03-13 17:36:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 30429 [episode count 19/20]
2025-03-13 17:36:53: [retrieval_preprocessing] finished for 4569686640_put_fork_on_plate [chosen_id count 4/196]
2025-03-13 17:36:54: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4570623316_orange_object_in_bowl [chosen_id count 5/196]
2025-03-13 17:36:54: [retrieval_preprocessing] we have num_total=2013 embedding_dim=49152
[retrieval_preprocessing] for episode 36869 [episode count 0/20], we have num_retrieval=np.int64(1923) num_query=np.int64(90)
2025-03-13 17:36:54,963 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:55,683 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:55
2025-03-13 17:36:55,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1265.25it/s]
2025-03-13 17:36:55,714 [INFO]: There are 1923 embeddings of dim 49152
2025-03-13 17:36:55,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 17:36:55,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:55
2025-03-13 17:36:55,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:55,715 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:36:55,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:55,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:55,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:55
2025-03-13 17:36:55,715 [INFO]: 396.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:55,715 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:55,715 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:55
2025-03-13 17:36:55,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:55,715 [INFO]: 	Creating the index 03/13/2025, 17:36:55
2025-03-13 17:36:55,715 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:55
2025-03-13 17:36:55,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:36:55,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:55
2025-03-13 17:36:55,717 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:36:55,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.99it/s] 62%|██████▎   | 5/8 [00:00<00:00, 26.29it/s]100%|██████████| 8/8 [00:01<00:00,  3.39it/s]100%|██████████| 8/8 [00:01<00:00,  4.11it/s]
2025-03-13 17:36:57,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:57
2025-03-13 17:37:33,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6465 secs
2025-03-13 17:37:33,314 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 17:37:33,314 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.82it/s] 50%|█████     | 2/4 [00:00<00:00,  3.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.92it/s]
2025-03-13 17:37:50,117 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8028 secs
2025-03-13 17:37:50,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4020 secs
2025-03-13 17:37:50,119 [INFO]: {
2025-03-13 17:37:50,119 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:50,119 [INFO]: 	index_param: efSearch=120
2025-03-13 17:37:50,119 [INFO]: 	index_path: knn.index
2025-03-13 17:37:50,119 [INFO]: 	size in bytes: 378338770
2025-03-13 17:37:50,119 [INFO]: 	avg_search_speed_ms: 7.2866526602715815
2025-03-13 17:37:50,119 [INFO]: 	99p_search_speed_ms: 10.927808764390646
2025-03-13 17:37:50,119 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:50,119 [INFO]: 	nb vectors: 1923
2025-03-13 17:37:50,119 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:50,119 [INFO]: 	compression ratio: 0.9993085931954582
2025-03-13 17:37:50,119 [INFO]: }
2025-03-13 17:37:50,119 [INFO]: 	>>> Finished "Creating the index" in 54.4038 secs
2025-03-13 17:37:50,119 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4354 secs
2025-03-13 17:37:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 36869 [episode count 0/20]
[retrieval_preprocessing] for episode 86545 [episode count 1/20], we have num_retrieval=np.int64(1883) num_query=np.int64(130)
2025-03-13 17:37:50,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:51,858 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:51
2025-03-13 17:37:51,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-13 17:37:51,892 [INFO]: There are 1883 embeddings of dim 49152
2025-03-13 17:37:51,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 17:37:51,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:51
2025-03-13 17:37:51,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:51,893 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:37:51,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:51,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:37:51,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:51
2025-03-13 17:37:51,894 [INFO]: 388.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:51,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:37:51,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:51
2025-03-13 17:37:51,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:51,894 [INFO]: 	Creating the index 03/13/2025, 17:37:51
2025-03-13 17:37:51,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:51
2025-03-13 17:37:51,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:37:51,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:51
2025-03-13 17:37:51,899 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:37:51,899 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.32it/s]100%|██████████| 8/8 [00:01<00:00,  4.73it/s]100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
2025-03-13 17:37:53,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:53
2025-03-13 17:38:19,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6516 secs
2025-03-13 17:38:19,096 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 17:38:19,096 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-13 17:38:38,089 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9924 secs
2025-03-13 17:38:38,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1918 secs
2025-03-13 17:38:38,091 [INFO]: {
2025-03-13 17:38:38,091 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:38,091 [INFO]: 	index_param: efSearch=158
2025-03-13 17:38:38,091 [INFO]: 	index_path: knn.index
2025-03-13 17:38:38,091 [INFO]: 	size in bytes: 370468990
2025-03-13 17:38:38,091 [INFO]: 	avg_search_speed_ms: 8.604997298327593
2025-03-13 17:38:38,091 [INFO]: 	99p_search_speed_ms: 10.994395429734142
2025-03-13 17:38:38,091 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:38,091 [INFO]: 	nb vectors: 1883
2025-03-13 17:38:38,091 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:38,091 [INFO]: 	compression ratio: 0.9993086438894656
2025-03-13 17:38:38,091 [INFO]: }
2025-03-13 17:38:38,091 [INFO]: 	>>> Finished "Creating the index" in 46.1963 secs
2025-03-13 17:38:38,091 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2328 secs
2025-03-13 17:38:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 86545 [episode count 1/20]
[retrieval_preprocessing] for episode 78363 [episode count 2/20], we have num_retrieval=np.int64(1890) num_query=np.int64(123)
2025-03-13 17:38:39,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:39,515 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:39
2025-03-13 17:38:39,515 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.84it/s]
2025-03-13 17:38:39,545 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 17:38:39,545 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:38:39,546 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:39,546 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:38:39,546 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:39,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:38:39,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,547 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:39,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:38:39,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:39
2025-03-13 17:38:39,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:39,548 [INFO]: 	Creating the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:39
2025-03-13 17:38:39,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:38:39,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,551 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:38:39,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.71it/s]100%|██████████| 8/8 [00:01<00:00,  4.81it/s]100%|██████████| 8/8 [00:01<00:00,  5.28it/s]
2025-03-13 17:38:41,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:41
2025-03-13 17:39:08,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4524 secs
2025-03-13 17:39:08,525 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:39:08,525 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 17:39:24,885 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3596 secs
2025-03-13 17:39:24,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3352 secs
2025-03-13 17:39:24,887 [INFO]: {
2025-03-13 17:39:24,887 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:24,887 [INFO]: 	index_param: efSearch=153
2025-03-13 17:39:24,887 [INFO]: 	index_path: knn.index
2025-03-13 17:39:24,887 [INFO]: 	size in bytes: 371846230
2025-03-13 17:39:24,887 [INFO]: 	avg_search_speed_ms: 10.235250704448019
2025-03-13 17:39:24,887 [INFO]: 	99p_search_speed_ms: 16.730848355218768
2025-03-13 17:39:24,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:24,887 [INFO]: 	nb vectors: 1890
2025-03-13 17:39:24,887 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:24,887 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 17:39:24,887 [INFO]: }
2025-03-13 17:39:24,887 [INFO]: 	>>> Finished "Creating the index" in 45.3392 secs
2025-03-13 17:39:24,887 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3719 secs
2025-03-13 17:39:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 78363 [episode count 2/20]
[retrieval_preprocessing] for episode 78877 [episode count 3/20], we have num_retrieval=np.int64(1902) num_query=np.int64(111)
2025-03-13 17:39:26,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:26,820 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:26
2025-03-13 17:39:26,820 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.49it/s]
2025-03-13 17:39:26,857 [INFO]: There are 1902 embeddings of dim 49152
2025-03-13 17:39:26,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 17:39:26,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:26
2025-03-13 17:39:26,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:26,858 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:39:26,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:26,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:39:26,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:26
2025-03-13 17:39:26,858 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:26,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:26,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:26
2025-03-13 17:39:26,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:26,859 [INFO]: 	Creating the index 03/13/2025, 17:39:26
2025-03-13 17:39:26,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:26
2025-03-13 17:39:26,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:39:26,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:26
2025-03-13 17:39:26,861 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:39:26,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.84it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.01it/s]100%|██████████| 8/8 [00:01<00:00,  4.78it/s]
2025-03-13 17:39:28,538 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:28
2025-03-13 17:39:55,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7409 secs
2025-03-13 17:39:55,280 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:39:55,280 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.96it/s]
2025-03-13 17:40:18,928 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6482 secs
2025-03-13 17:40:18,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0689 secs
2025-03-13 17:40:18,930 [INFO]: {
2025-03-13 17:40:18,930 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:18,930 [INFO]: 	index_param: efSearch=201
2025-03-13 17:40:18,930 [INFO]: 	index_path: knn.index
2025-03-13 17:40:18,930 [INFO]: 	size in bytes: 374207170
2025-03-13 17:40:18,930 [INFO]: 	avg_search_speed_ms: 10.140215578719475
2025-03-13 17:40:18,930 [INFO]: 	99p_search_speed_ms: 12.878066406119613
2025-03-13 17:40:18,930 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:18,930 [INFO]: 	nb vectors: 1902
2025-03-13 17:40:18,930 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:18,931 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-13 17:40:18,931 [INFO]: }
2025-03-13 17:40:18,931 [INFO]: 	>>> Finished "Creating the index" in 52.0721 secs
2025-03-13 17:40:18,931 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1108 secs
2025-03-13 17:40:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 78877 [episode count 3/20]
[retrieval_preprocessing] for episode 73250 [episode count 4/20], we have num_retrieval=np.int64(1932) num_query=np.int64(81)
2025-03-13 17:40:19,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:20,265 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:20
2025-03-13 17:40:20,265 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1596.01it/s]
2025-03-13 17:40:20,289 [INFO]: There are 1932 embeddings of dim 49152
2025-03-13 17:40:20,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 17:40:20,289 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:20
2025-03-13 17:40:20,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:20,289 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:40:20,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:20,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:20,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:20
2025-03-13 17:40:20,289 [INFO]: 398.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:20,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:20,289 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:20
2025-03-13 17:40:20,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:20,289 [INFO]: 	Creating the index 03/13/2025, 17:40:20
2025-03-13 17:40:20,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:20
2025-03-13 17:40:20,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:40:20,290 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:20
2025-03-13 17:40:20,290 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:40:20,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.73it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.84it/s]100%|██████████| 8/8 [00:01<00:00,  4.23it/s]
2025-03-13 17:40:22,183 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:22
2025-03-13 17:40:53,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0411 secs
2025-03-13 17:40:53,225 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 17:40:53,225 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.46it/s]
2025-03-13 17:41:12,191 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9658 secs
2025-03-13 17:41:12,192 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9020 secs
2025-03-13 17:41:12,193 [INFO]: {
2025-03-13 17:41:12,193 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:12,193 [INFO]: 	index_param: efSearch=140
2025-03-13 17:41:12,193 [INFO]: 	index_path: knn.index
2025-03-13 17:41:12,193 [INFO]: 	size in bytes: 380109490
2025-03-13 17:41:12,193 [INFO]: 	avg_search_speed_ms: 11.125722513881174
2025-03-13 17:41:12,193 [INFO]: 	99p_search_speed_ms: 16.605337765067816
2025-03-13 17:41:12,193 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:12,193 [INFO]: 	nb vectors: 1932
2025-03-13 17:41:12,193 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:12,193 [INFO]: 	compression ratio: 0.999308530813056
2025-03-13 17:41:12,193 [INFO]: }
2025-03-13 17:41:12,193 [INFO]: 	>>> Finished "Creating the index" in 51.9034 secs
2025-03-13 17:41:12,193 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9280 secs
2025-03-13 17:41:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 73250 [episode count 4/20]
[retrieval_preprocessing] for episode 8232 [episode count 5/20], we have num_retrieval=np.int64(1913) num_query=np.int64(100)
2025-03-13 17:41:13,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:13,473 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:13
2025-03-13 17:41:13,473 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2138.86it/s]
2025-03-13 17:41:13,496 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 17:41:13,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:41:13,497 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:13
2025-03-13 17:41:13,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:13,497 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:41:13,497 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:13,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:13,497 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:13
2025-03-13 17:41:13,497 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:13,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:13,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:13
2025-03-13 17:41:13,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:13,497 [INFO]: 	Creating the index 03/13/2025, 17:41:13
2025-03-13 17:41:13,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:13
2025-03-13 17:41:13,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:41:13,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:13
2025-03-13 17:41:13,498 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:41:13,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.28it/s] 62%|██████▎   | 5/8 [00:00<00:00, 22.52it/s]100%|██████████| 8/8 [00:02<00:00,  2.83it/s]100%|██████████| 8/8 [00:02<00:00,  3.44it/s]
2025-03-13 17:41:15,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:15
2025-03-13 17:41:43,952 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1237 secs
2025-03-13 17:41:43,952 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:41:43,952 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 17:42:00,021 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0689 secs
2025-03-13 17:42:00,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5245 secs
2025-03-13 17:42:00,023 [INFO]: {
2025-03-13 17:42:00,023 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:00,023 [INFO]: 	index_param: efSearch=156
2025-03-13 17:42:00,023 [INFO]: 	index_path: knn.index
2025-03-13 17:42:00,023 [INFO]: 	size in bytes: 376371370
2025-03-13 17:42:00,023 [INFO]: 	avg_search_speed_ms: 9.363573839171172
2025-03-13 17:42:00,023 [INFO]: 	99p_search_speed_ms: 12.748910258524113
2025-03-13 17:42:00,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:00,023 [INFO]: 	nb vectors: 1913
2025-03-13 17:42:00,023 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:00,023 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 17:42:00,023 [INFO]: }
2025-03-13 17:42:00,023 [INFO]: 	>>> Finished "Creating the index" in 46.5260 secs
2025-03-13 17:42:00,023 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5501 secs
2025-03-13 17:42:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 8232 [episode count 5/20]
[retrieval_preprocessing] for episode 58413 [episode count 6/20], we have num_retrieval=np.int64(1935) num_query=np.int64(78)
2025-03-13 17:42:00,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:01,454 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:01
2025-03-13 17:42:01,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-13 17:42:01,477 [INFO]: There are 1935 embeddings of dim 49152
2025-03-13 17:42:01,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 17:42:01,477 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:01
2025-03-13 17:42:01,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:01,477 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:42:01,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:01,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:42:01,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:01
2025-03-13 17:42:01,477 [INFO]: 399.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:01,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:42:01,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:01
2025-03-13 17:42:01,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:01,477 [INFO]: 	Creating the index 03/13/2025, 17:42:01
2025-03-13 17:42:01,477 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:01
2025-03-13 17:42:01,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:42:01,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:01
2025-03-13 17:42:01,478 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:42:01,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.03it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.90it/s]100%|██████████| 8/8 [00:01<00:00,  4.73it/s]
2025-03-13 17:42:03,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:03
2025-03-13 17:42:29,039 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8639 secs
2025-03-13 17:42:29,039 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:42:29,039 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-13 17:42:49,760 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7204 secs
2025-03-13 17:42:49,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2829 secs
2025-03-13 17:42:49,762 [INFO]: {
2025-03-13 17:42:49,762 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:49,762 [INFO]: 	index_param: efSearch=177
2025-03-13 17:42:49,762 [INFO]: 	index_path: knn.index
2025-03-13 17:42:49,762 [INFO]: 	size in bytes: 380699770
2025-03-13 17:42:49,762 [INFO]: 	avg_search_speed_ms: 9.427081509585458
2025-03-13 17:42:49,762 [INFO]: 	99p_search_speed_ms: 15.627690032124526
2025-03-13 17:42:49,762 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:49,762 [INFO]: 	nb vectors: 1935
2025-03-13 17:42:49,762 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:49,762 [INFO]: 	compression ratio: 0.9993084051508621
2025-03-13 17:42:49,762 [INFO]: }
2025-03-13 17:42:49,762 [INFO]: 	>>> Finished "Creating the index" in 48.2847 secs
2025-03-13 17:42:49,762 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3080 secs
2025-03-13 17:42:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 58413 [episode count 6/20]
[retrieval_preprocessing] for episode 17468 [episode count 7/20], we have num_retrieval=np.int64(1911) num_query=np.int64(102)
2025-03-13 17:42:50,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:50,789 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:50
2025-03-13 17:42:50,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.88it/s]
2025-03-13 17:42:50,818 [INFO]: There are 1911 embeddings of dim 49152
2025-03-13 17:42:50,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:42:50,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:50
2025-03-13 17:42:50,819 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:50,819 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:42:50,819 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:50,819 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:42:50,819 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:50
2025-03-13 17:42:50,819 [INFO]: 394.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:50,819 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:42:50,819 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:50
2025-03-13 17:42:50,819 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:50,819 [INFO]: 	Creating the index 03/13/2025, 17:42:50
2025-03-13 17:42:50,819 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:50
2025-03-13 17:42:50,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:42:50,820 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:50
2025-03-13 17:42:50,820 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:42:50,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.57it/s]100%|██████████| 8/8 [00:01<00:00,  5.11it/s]100%|██████████| 8/8 [00:01<00:00,  5.39it/s]
2025-03-13 17:42:52,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:52
2025-03-13 17:43:21,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3459 secs
2025-03-13 17:43:21,654 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:43:21,654 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 17:43:41,901 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2465 secs
2025-03-13 17:43:41,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0820 secs
2025-03-13 17:43:41,902 [INFO]: {
2025-03-13 17:43:41,902 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:41,902 [INFO]: 	index_param: efSearch=164
2025-03-13 17:43:41,903 [INFO]: 	index_path: knn.index
2025-03-13 17:43:41,903 [INFO]: 	size in bytes: 375977890
2025-03-13 17:43:41,903 [INFO]: 	avg_search_speed_ms: 9.859496127139902
2025-03-13 17:43:41,903 [INFO]: 	99p_search_speed_ms: 13.809519070200622
2025-03-13 17:43:41,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:41,903 [INFO]: 	nb vectors: 1911
2025-03-13 17:43:41,903 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:41,903 [INFO]: 	compression ratio: 0.9993084646546636
2025-03-13 17:43:41,903 [INFO]: }
2025-03-13 17:43:41,903 [INFO]: 	>>> Finished "Creating the index" in 51.0835 secs
2025-03-13 17:43:41,903 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1137 secs
2025-03-13 17:43:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 17468 [episode count 7/20]
[retrieval_preprocessing] for episode 74312 [episode count 8/20], we have num_retrieval=np.int64(1938) num_query=np.int64(75)
2025-03-13 17:43:42,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:43,218 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:43
2025-03-13 17:43:43,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1705.69it/s]
2025-03-13 17:43:43,244 [INFO]: There are 1938 embeddings of dim 49152
2025-03-13 17:43:43,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:43:43,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:43
2025-03-13 17:43:43,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:43,245 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:43:43,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:43,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:43:43,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:43
2025-03-13 17:43:43,246 [INFO]: 400.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:43,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:43:43,246 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:43
2025-03-13 17:43:43,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:43,246 [INFO]: 	Creating the index 03/13/2025, 17:43:43
2025-03-13 17:43:43,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:43
2025-03-13 17:43:43,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:43:43,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:43
2025-03-13 17:43:43,250 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:43:43,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.72it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.06it/s]100%|██████████| 8/8 [00:02<00:00,  3.89it/s]
2025-03-13 17:43:45,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:45
2025-03-13 17:44:11,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9450 secs
2025-03-13 17:44:11,258 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:44:11,258 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 17:44:36,693 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4345 secs
2025-03-13 17:44:36,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4444 secs
2025-03-13 17:44:36,695 [INFO]: {
2025-03-13 17:44:36,695 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:36,695 [INFO]: 	index_param: efSearch=201
2025-03-13 17:44:36,695 [INFO]: 	index_path: knn.index
2025-03-13 17:44:36,695 [INFO]: 	size in bytes: 381289990
2025-03-13 17:44:36,695 [INFO]: 	avg_search_speed_ms: 11.390681689602996
2025-03-13 17:44:36,695 [INFO]: 	99p_search_speed_ms: 14.366840368602425
2025-03-13 17:44:36,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:36,695 [INFO]: 	nb vectors: 1938
2025-03-13 17:44:36,695 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:36,695 [INFO]: 	compression ratio: 0.9993084371294405
2025-03-13 17:44:36,695 [INFO]: }
2025-03-13 17:44:36,695 [INFO]: 	>>> Finished "Creating the index" in 53.4485 secs
2025-03-13 17:44:36,695 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4768 secs
2025-03-13 17:44:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 74312 [episode count 8/20]
[retrieval_preprocessing] for episode 84583 [episode count 9/20], we have num_retrieval=np.int64(1932) num_query=np.int64(81)
2025-03-13 17:44:37,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:38,053 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:38
2025-03-13 17:44:38,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.65it/s]
2025-03-13 17:44:38,080 [INFO]: There are 1932 embeddings of dim 49152
2025-03-13 17:44:38,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:44:38,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:38
2025-03-13 17:44:38,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:38,081 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:44:38,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:38,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:38,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:38
2025-03-13 17:44:38,081 [INFO]: 398.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:38,081 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:38,081 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:38
2025-03-13 17:44:38,081 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:38,081 [INFO]: 	Creating the index 03/13/2025, 17:44:38
2025-03-13 17:44:38,081 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:38
2025-03-13 17:44:38,082 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:44:38,082 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:38
2025-03-13 17:44:38,082 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:38,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.56it/s] 62%|██████▎   | 5/8 [00:00<00:00, 26.10it/s]100%|██████████| 8/8 [00:02<00:00,  2.93it/s]100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
2025-03-13 17:44:40,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:40
2025-03-13 17:45:10,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2110 secs
2025-03-13 17:45:10,529 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:45:10,530 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.97it/s]
2025-03-13 17:45:29,260 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7299 secs
2025-03-13 17:45:29,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1794 secs
2025-03-13 17:45:29,262 [INFO]: {
2025-03-13 17:45:29,262 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:29,262 [INFO]: 	index_param: efSearch=153
2025-03-13 17:45:29,262 [INFO]: 	index_path: knn.index
2025-03-13 17:45:29,262 [INFO]: 	size in bytes: 380109490
2025-03-13 17:45:29,262 [INFO]: 	avg_search_speed_ms: 10.50270617007231
2025-03-13 17:45:29,262 [INFO]: 	99p_search_speed_ms: 14.958650355692953
2025-03-13 17:45:29,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:29,262 [INFO]: 	nb vectors: 1932
2025-03-13 17:45:29,262 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:29,262 [INFO]: 	compression ratio: 0.999308530813056
2025-03-13 17:45:29,262 [INFO]: }
2025-03-13 17:45:29,262 [INFO]: 	>>> Finished "Creating the index" in 51.1809 secs
2025-03-13 17:45:29,262 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2092 secs
2025-03-13 17:45:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 84583 [episode count 9/20]
[retrieval_preprocessing] for episode 25192 [episode count 10/20], we have num_retrieval=np.int64(1924) num_query=np.int64(89)
2025-03-13 17:45:30,110 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:30,430 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:30
2025-03-13 17:45:30,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1674.37it/s]
2025-03-13 17:45:30,454 [INFO]: There are 1924 embeddings of dim 49152
2025-03-13 17:45:30,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 17:45:30,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:30
2025-03-13 17:45:30,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:30,454 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:45:30,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:30,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:30,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:30
2025-03-13 17:45:30,454 [INFO]: 397.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:30,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:45:30,455 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:30
2025-03-13 17:45:30,455 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:30,455 [INFO]: 	Creating the index 03/13/2025, 17:45:30
2025-03-13 17:45:30,455 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:30
2025-03-13 17:45:30,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:45:30,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:30
2025-03-13 17:45:30,456 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:45:30,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.98it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.85it/s]100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
2025-03-13 17:45:32,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:32
2025-03-13 17:45:59,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5405 secs
2025-03-13 17:45:59,718 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 17:45:59,718 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.22it/s]
2025-03-13 17:46:17,337 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6185 secs
2025-03-13 17:46:17,338 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8827 secs
2025-03-13 17:46:17,339 [INFO]: {
2025-03-13 17:46:17,339 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:17,339 [INFO]: 	index_param: efSearch=117
2025-03-13 17:46:17,339 [INFO]: 	index_path: knn.index
2025-03-13 17:46:17,339 [INFO]: 	size in bytes: 378535510
2025-03-13 17:46:17,339 [INFO]: 	avg_search_speed_ms: 8.47401606960822
2025-03-13 17:46:17,339 [INFO]: 	99p_search_speed_ms: 11.375280311331153
2025-03-13 17:46:17,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:17,339 [INFO]: 	nb vectors: 1924
2025-03-13 17:46:17,339 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:17,339 [INFO]: 	compression ratio: 0.9993086038348159
2025-03-13 17:46:17,339 [INFO]: }
2025-03-13 17:46:17,339 [INFO]: 	>>> Finished "Creating the index" in 46.8842 secs
2025-03-13 17:46:17,339 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9084 secs
2025-03-13 17:46:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 25192 [episode count 10/20]
[retrieval_preprocessing] for episode 35467 [episode count 11/20], we have num_retrieval=np.int64(1919) num_query=np.int64(94)
2025-03-13 17:46:18,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:18,749 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:18
2025-03-13 17:46:18,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.18it/s]
2025-03-13 17:46:18,775 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 17:46:18,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:46:18,776 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:18
2025-03-13 17:46:18,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:18,776 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:46:18,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:18,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:18,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:18
2025-03-13 17:46:18,776 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:18,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:18,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:18
2025-03-13 17:46:18,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:18,776 [INFO]: 	Creating the index 03/13/2025, 17:46:18
2025-03-13 17:46:18,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:18
2025-03-13 17:46:18,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:46:18,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:18
2025-03-13 17:46:18,777 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:18,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.83it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.28it/s]100%|██████████| 8/8 [00:01<00:00,  4.52it/s]
2025-03-13 17:46:20,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:20
2025-03-13 17:46:47,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8364 secs
2025-03-13 17:46:47,387 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 17:46:47,387 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 17:47:08,315 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9278 secs
2025-03-13 17:47:08,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5400 secs
2025-03-13 17:47:08,317 [INFO]: {
2025-03-13 17:47:08,317 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:08,317 [INFO]: 	index_param: efSearch=149
2025-03-13 17:47:08,317 [INFO]: 	index_path: knn.index
2025-03-13 17:47:08,317 [INFO]: 	size in bytes: 377551810
2025-03-13 17:47:08,318 [INFO]: 	avg_search_speed_ms: 9.95223277308677
2025-03-13 17:47:08,318 [INFO]: 	99p_search_speed_ms: 14.945451514795424
2025-03-13 17:47:08,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:08,318 [INFO]: 	nb vectors: 1919
2025-03-13 17:47:08,318 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:08,318 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 17:47:08,318 [INFO]: }
2025-03-13 17:47:08,318 [INFO]: 	>>> Finished "Creating the index" in 49.5415 secs
2025-03-13 17:47:08,318 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5681 secs
2025-03-13 17:47:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 35467 [episode count 11/20]
[retrieval_preprocessing] for episode 39077 [episode count 12/20], we have num_retrieval=np.int64(1889) num_query=np.int64(124)
2025-03-13 17:47:09,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:10,020 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:10
2025-03-13 17:47:10,020 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 836.85it/s]
2025-03-13 17:47:10,050 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 17:47:10,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:47:10,051 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:10,051 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:47:10,051 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:10,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:47:10,051 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,051 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:10,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:47:10,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:10
2025-03-13 17:47:10,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:10,051 [INFO]: 	Creating the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,051 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:10
2025-03-13 17:47:10,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:47:10,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,053 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:47:10,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.02it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.46it/s]100%|██████████| 8/8 [00:01<00:00,  4.74it/s]
2025-03-13 17:47:11,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:11
2025-03-13 17:47:42,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1563 secs
2025-03-13 17:47:42,902 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:47:42,902 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 17:48:13,392 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4896 secs
2025-03-13 17:48:13,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3409 secs
2025-03-13 17:48:13,394 [INFO]: {
2025-03-13 17:48:13,394 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:13,394 [INFO]: 	index_param: efSearch=168
2025-03-13 17:48:13,394 [INFO]: 	index_path: knn.index
2025-03-13 17:48:13,394 [INFO]: 	size in bytes: 371649490
2025-03-13 17:48:13,394 [INFO]: 	avg_search_speed_ms: 8.957854466676364
2025-03-13 17:48:13,394 [INFO]: 	99p_search_speed_ms: 12.014603975694627
2025-03-13 17:48:13,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:13,394 [INFO]: 	nb vectors: 1889
2025-03-13 17:48:13,394 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:13,394 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 17:48:13,394 [INFO]: }
2025-03-13 17:48:13,394 [INFO]: 	>>> Finished "Creating the index" in 63.3425 secs
2025-03-13 17:48:13,394 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3737 secs
2025-03-13 17:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 39077 [episode count 12/20]
[retrieval_preprocessing] for episode 7861 [episode count 13/20], we have num_retrieval=np.int64(1914) num_query=np.int64(99)
2025-03-13 17:48:14,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:14,759 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:14
2025-03-13 17:48:14,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.36it/s]
2025-03-13 17:48:14,791 [INFO]: There are 1914 embeddings of dim 49152
2025-03-13 17:48:14,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:48:14,791 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:14
2025-03-13 17:48:14,792 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:14,792 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:48:14,792 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:14,792 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:48:14,792 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:14
2025-03-13 17:48:14,792 [INFO]: 395.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:14,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:48:14,793 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:14
2025-03-13 17:48:14,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:14,793 [INFO]: 	Creating the index 03/13/2025, 17:48:14
2025-03-13 17:48:14,793 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:14
2025-03-13 17:48:14,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:48:14,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:14
2025-03-13 17:48:14,797 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:48:14,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.46it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.23it/s]100%|██████████| 8/8 [00:01<00:00,  4.53it/s]
2025-03-13 17:48:16,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:16
2025-03-13 17:48:42,557 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9875 secs
2025-03-13 17:48:42,557 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 17:48:42,557 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s]
2025-03-13 17:49:01,886 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3287 secs
2025-03-13 17:49:01,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0907 secs
2025-03-13 17:49:01,888 [INFO]: {
2025-03-13 17:49:01,888 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:01,888 [INFO]: 	index_param: efSearch=103
2025-03-13 17:49:01,888 [INFO]: 	index_path: knn.index
2025-03-13 17:49:01,888 [INFO]: 	size in bytes: 376568110
2025-03-13 17:49:01,888 [INFO]: 	avg_search_speed_ms: 8.953654092854103
2025-03-13 17:49:01,888 [INFO]: 	99p_search_speed_ms: 14.790070932358503
2025-03-13 17:49:01,888 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:01,888 [INFO]: 	nb vectors: 1914
2025-03-13 17:49:01,888 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:01,888 [INFO]: 	compression ratio: 0.9993084969409651
2025-03-13 17:49:01,888 [INFO]: }
2025-03-13 17:49:01,888 [INFO]: 	>>> Finished "Creating the index" in 47.0949 secs
2025-03-13 17:49:01,888 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1290 secs
2025-03-13 17:49:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 7861 [episode count 13/20]
[retrieval_preprocessing] for episode 16055 [episode count 14/20], we have num_retrieval=np.int64(1919) num_query=np.int64(94)
2025-03-13 17:49:02,735 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:03,133 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:03
2025-03-13 17:49:03,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-13 17:49:03,161 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 17:49:03,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:49:03,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:03
2025-03-13 17:49:03,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:03,162 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:49:03,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:03,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:03,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:03
2025-03-13 17:49:03,162 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:03,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:03,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:03
2025-03-13 17:49:03,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:03,162 [INFO]: 	Creating the index 03/13/2025, 17:49:03
2025-03-13 17:49:03,162 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:03
2025-03-13 17:49:03,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:49:03,163 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:03
2025-03-13 17:49:03,164 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:49:03,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.29it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.89it/s]100%|██████████| 8/8 [00:01<00:00,  4.06it/s]
2025-03-13 17:49:05,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:05
2025-03-13 17:49:35,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8714 secs
2025-03-13 17:49:35,012 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 17:49:35,012 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 17:49:54,526 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5135 secs
2025-03-13 17:49:54,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3647 secs
2025-03-13 17:49:54,528 [INFO]: {
2025-03-13 17:49:54,529 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:54,529 [INFO]: 	index_param: efSearch=132
2025-03-13 17:49:54,529 [INFO]: 	index_path: knn.index
2025-03-13 17:49:54,529 [INFO]: 	size in bytes: 377551810
2025-03-13 17:49:54,529 [INFO]: 	avg_search_speed_ms: 7.437891157717898
2025-03-13 17:49:54,529 [INFO]: 	99p_search_speed_ms: 9.857683517038822
2025-03-13 17:49:54,529 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:54,529 [INFO]: 	nb vectors: 1919
2025-03-13 17:49:54,529 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:54,529 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 17:49:54,529 [INFO]: }
2025-03-13 17:49:54,529 [INFO]: 	>>> Finished "Creating the index" in 51.3665 secs
2025-03-13 17:49:54,529 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3954 secs
2025-03-13 17:49:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 16055 [episode count 14/20]
[retrieval_preprocessing] for episode 93833 [episode count 15/20], we have num_retrieval=np.int64(1881) num_query=np.int64(132)
2025-03-13 17:49:55,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:56,343 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:56
2025-03-13 17:49:56,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 903.36it/s]
2025-03-13 17:49:56,375 [INFO]: There are 1881 embeddings of dim 49152
2025-03-13 17:49:56,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 17:49:56,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:56
2025-03-13 17:49:56,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:56,376 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:49:56,376 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:56,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:56,376 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:56
2025-03-13 17:49:56,376 [INFO]: 388.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:56,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:56,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:56
2025-03-13 17:49:56,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:56,376 [INFO]: 	Creating the index 03/13/2025, 17:49:56
2025-03-13 17:49:56,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:56
2025-03-13 17:49:56,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:49:56,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:56
2025-03-13 17:49:56,378 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:49:56,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.81it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.26it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.66it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.57it/s]100%|██████████| 8/8 [00:02<00:00,  3.37it/s]
2025-03-13 17:49:58,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:58
2025-03-13 17:50:24,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8506 secs
2025-03-13 17:50:24,605 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 17:50:24,605 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.06it/s]
2025-03-13 17:50:45,300 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6952 secs
2025-03-13 17:50:45,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9242 secs
2025-03-13 17:50:45,303 [INFO]: {
2025-03-13 17:50:45,303 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:45,303 [INFO]: 	index_param: efSearch=117
2025-03-13 17:50:45,303 [INFO]: 	index_path: knn.index
2025-03-13 17:50:45,303 [INFO]: 	size in bytes: 370075510
2025-03-13 17:50:45,303 [INFO]: 	avg_search_speed_ms: 8.230197620520622
2025-03-13 17:50:45,303 [INFO]: 	99p_search_speed_ms: 13.975992565974583
2025-03-13 17:50:45,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:45,303 [INFO]: 	nb vectors: 1881
2025-03-13 17:50:45,303 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:45,303 [INFO]: 	compression ratio: 0.9993086221782144
2025-03-13 17:50:45,303 [INFO]: }
2025-03-13 17:50:45,303 [INFO]: 	>>> Finished "Creating the index" in 48.9264 secs
2025-03-13 17:50:45,303 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9601 secs
2025-03-13 17:50:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 93833 [episode count 15/20]
[retrieval_preprocessing] for episode 27850 [episode count 16/20], we have num_retrieval=np.int64(1913) num_query=np.int64(100)
2025-03-13 17:50:46,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:46,979 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:46
2025-03-13 17:50:46,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.09it/s]
2025-03-13 17:50:47,011 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 17:50:47,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:50:47,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:47
2025-03-13 17:50:47,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:47,012 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:50:47,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:47,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:47,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:47
2025-03-13 17:50:47,012 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:47,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:47,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:47
2025-03-13 17:50:47,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:47,012 [INFO]: 	Creating the index 03/13/2025, 17:50:47
2025-03-13 17:50:47,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:47
2025-03-13 17:50:47,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:50:47,013 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:47
2025-03-13 17:50:47,014 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:50:47,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.51it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.31it/s]100%|██████████| 8/8 [00:02<00:00,  3.90it/s]
2025-03-13 17:50:49,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:49
2025-03-13 17:51:24,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0940 secs
2025-03-13 17:51:24,168 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 17:51:24,168 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 17:51:42,716 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5476 secs
2025-03-13 17:51:42,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7041 secs
2025-03-13 17:51:42,718 [INFO]: {
2025-03-13 17:51:42,718 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:42,718 [INFO]: 	index_param: efSearch=146
2025-03-13 17:51:42,718 [INFO]: 	index_path: knn.index
2025-03-13 17:51:42,718 [INFO]: 	size in bytes: 376371370
2025-03-13 17:51:42,718 [INFO]: 	avg_search_speed_ms: 10.712898175064595
2025-03-13 17:51:42,718 [INFO]: 	99p_search_speed_ms: 18.493586750701066
2025-03-13 17:51:42,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:42,718 [INFO]: 	nb vectors: 1913
2025-03-13 17:51:42,718 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:42,718 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 17:51:42,718 [INFO]: }
2025-03-13 17:51:42,718 [INFO]: 	>>> Finished "Creating the index" in 55.7057 secs
2025-03-13 17:51:42,718 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7387 secs
2025-03-13 17:51:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 27850 [episode count 16/20]
[retrieval_preprocessing] for episode 68304 [episode count 17/20], we have num_retrieval=np.int64(1898) num_query=np.int64(115)
2025-03-13 17:51:44,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:45,290 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:45
2025-03-13 17:51:45,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.28it/s]
2025-03-13 17:51:45,322 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 17:51:45,323 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 17:51:45,323 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:45
2025-03-13 17:51:45,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:45,323 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:51:45,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:45,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:45,323 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:45
2025-03-13 17:51:45,323 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:45,323 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:51:45,323 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:45
2025-03-13 17:51:45,323 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:45,324 [INFO]: 	Creating the index 03/13/2025, 17:51:45
2025-03-13 17:51:45,324 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:45
2025-03-13 17:51:45,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:51:45,325 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:45
2025-03-13 17:51:45,325 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:51:45,325 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.73it/s] 62%|██████▎   | 5/8 [00:00<00:00, 22.50it/s]100%|██████████| 8/8 [00:02<00:00,  2.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
2025-03-13 17:51:47,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:47
2025-03-13 17:52:17,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4766 secs
2025-03-13 17:52:17,063 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:52:17,063 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.44it/s] 50%|█████     | 2/4 [00:00<00:00,  4.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.24it/s]
2025-03-13 17:52:37,387 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3238 secs
2025-03-13 17:52:37,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0642 secs
2025-03-13 17:52:37,390 [INFO]: {
2025-03-13 17:52:37,390 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:37,390 [INFO]: 	index_param: efSearch=138
2025-03-13 17:52:37,390 [INFO]: 	index_path: knn.index
2025-03-13 17:52:37,390 [INFO]: 	size in bytes: 373420150
2025-03-13 17:52:37,390 [INFO]: 	avg_search_speed_ms: 10.76799177286988
2025-03-13 17:52:37,390 [INFO]: 	99p_search_speed_ms: 17.1924321167171
2025-03-13 17:52:37,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:37,390 [INFO]: 	nb vectors: 1898
2025-03-13 17:52:37,390 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:37,390 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 17:52:37,390 [INFO]: }
2025-03-13 17:52:37,390 [INFO]: 	>>> Finished "Creating the index" in 52.0663 secs
2025-03-13 17:52:37,390 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0993 secs
2025-03-13 17:52:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 68304 [episode count 17/20]
[retrieval_preprocessing] for episode 93919 [episode count 18/20], we have num_retrieval=np.int64(1922) num_query=np.int64(91)
2025-03-13 17:52:39,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:39,602 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:39
2025-03-13 17:52:39,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.83it/s]
2025-03-13 17:52:39,635 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 17:52:39,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 17:52:39,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:39
2025-03-13 17:52:39,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:39,635 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:52:39,635 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:39,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:39,635 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:39
2025-03-13 17:52:39,636 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:39,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:39,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:39
2025-03-13 17:52:39,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:39,636 [INFO]: 	Creating the index 03/13/2025, 17:52:39
2025-03-13 17:52:39,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:39
2025-03-13 17:52:39,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:52:39,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:39
2025-03-13 17:52:39,637 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:39,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.82it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.22it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.86it/s] 50%|█████     | 4/8 [00:00<00:00,  8.04it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.17it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.41it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.44it/s]100%|██████████| 8/8 [00:02<00:00,  1.74it/s]100%|██████████| 8/8 [00:02<00:00,  3.31it/s]
2025-03-13 17:52:42,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:42
2025-03-13 17:53:14,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7651 secs
2025-03-13 17:53:14,823 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 17:53:14,823 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 17:53:31,192 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3689 secs
2025-03-13 17:53:31,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1613 secs
2025-03-13 17:53:31,799 [INFO]: {
2025-03-13 17:53:31,799 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:31,799 [INFO]: 	index_param: efSearch=125
2025-03-13 17:53:31,799 [INFO]: 	index_path: knn.index
2025-03-13 17:53:31,799 [INFO]: 	size in bytes: 378142030
2025-03-13 17:53:31,799 [INFO]: 	avg_search_speed_ms: 8.414923742778837
2025-03-13 17:53:31,799 [INFO]: 	99p_search_speed_ms: 14.807049429509725
2025-03-13 17:53:31,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:31,800 [INFO]: 	nb vectors: 1922
2025-03-13 17:53:31,800 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:31,800 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 17:53:31,800 [INFO]: }
2025-03-13 17:53:31,800 [INFO]: 	>>> Finished "Creating the index" in 52.1639 secs
2025-03-13 17:53:31,800 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1976 secs
2025-03-13 17:53:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 93919 [episode count 18/20]
[retrieval_preprocessing] for episode 63204 [episode count 19/20], we have num_retrieval=np.int64(1909) num_query=np.int64(104)
2025-03-13 17:53:35,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:35,761 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:35
2025-03-13 17:53:35,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1098.27it/s]
2025-03-13 17:53:35,791 [INFO]: There are 1909 embeddings of dim 49152
2025-03-13 17:53:35,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:53:35,791 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:35
2025-03-13 17:53:35,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:35,791 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:53:35,791 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:35,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:35,791 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:35
2025-03-13 17:53:35,791 [INFO]: 394.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:35,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:35,791 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:35
2025-03-13 17:53:35,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:35,791 [INFO]: 	Creating the index 03/13/2025, 17:53:35
2025-03-13 17:53:35,792 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:35
2025-03-13 17:53:35,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:53:35,793 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:35
2025-03-13 17:53:35,793 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:53:35,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.87it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.11it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.66it/s] 50%|█████     | 4/8 [00:00<00:00,  7.93it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.38it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.32it/s]100%|██████████| 8/8 [00:02<00:00,  2.18it/s]100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
2025-03-13 17:53:38,050 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:38
2025-03-13 17:54:02,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6250 secs
2025-03-13 17:54:02,675 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:54:02,675 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 17:54:19,489 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8140 secs
2025-03-13 17:54:19,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6985 secs
2025-03-13 17:54:19,492 [INFO]: {
2025-03-13 17:54:19,492 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:19,492 [INFO]: 	index_param: efSearch=135
2025-03-13 17:54:19,492 [INFO]: 	index_path: knn.index
2025-03-13 17:54:19,492 [INFO]: 	size in bytes: 375584410
2025-03-13 17:54:19,492 [INFO]: 	avg_search_speed_ms: 9.127010418459365
2025-03-13 17:54:19,492 [INFO]: 	99p_search_speed_ms: 15.275195282883917
2025-03-13 17:54:19,492 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:19,492 [INFO]: 	nb vectors: 1909
2025-03-13 17:54:19,492 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:19,492 [INFO]: 	compression ratio: 0.9993084430740882
2025-03-13 17:54:19,492 [INFO]: }
2025-03-13 17:54:19,492 [INFO]: 	>>> Finished "Creating the index" in 43.7003 secs
2025-03-13 17:54:19,492 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7312 secs
2025-03-13 17:54:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 63204 [episode count 19/20]
2025-03-13 17:54:20: [retrieval_preprocessing] finished for 4570623316_orange_object_in_bowl [chosen_id count 5/196]
2025-03-13 17:54:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4570623316_wrench_in_black_bowl [chosen_id count 6/196]
2025-03-13 17:54:21: [retrieval_preprocessing] we have num_total=2068 embedding_dim=49152
[retrieval_preprocessing] for episode 17433 [episode count 0/20], we have num_retrieval=np.int64(1972) num_query=np.int64(96)
2025-03-13 17:54:22,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:22,772 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:22
2025-03-13 17:54:22,773 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 17:54:22,802 [INFO]: There are 1972 embeddings of dim 49152
2025-03-13 17:54:22,803 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 17:54:22,803 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,803 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:22,803 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:54:22,803 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:22,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:54:22,804 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,804 [INFO]: 407.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:22,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:54:22,804 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:22
2025-03-13 17:54:22,804 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:22,805 [INFO]: 	Creating the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,805 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:22
2025-03-13 17:54:22,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:54:22,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,808 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:54:22,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.80it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.75it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.57it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.09it/s]100%|██████████| 8/8 [00:02<00:00,  3.98it/s]
2025-03-13 17:54:24,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:24
2025-03-13 17:54:48,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8921 secs
2025-03-13 17:54:48,721 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:54:48,721 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 17:55:12,986 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2652 secs
2025-03-13 17:55:12,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1801 secs
2025-03-13 17:55:12,988 [INFO]: {
2025-03-13 17:55:12,988 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:12,988 [INFO]: 	index_param: efSearch=254
2025-03-13 17:55:12,988 [INFO]: 	index_path: knn.index
2025-03-13 17:55:12,988 [INFO]: 	size in bytes: 387979150
2025-03-13 17:55:12,988 [INFO]: 	avg_search_speed_ms: 11.943156630960221
2025-03-13 17:55:12,988 [INFO]: 	99p_search_speed_ms: 18.493072194978595
2025-03-13 17:55:12,988 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:12,988 [INFO]: 	nb vectors: 1972
2025-03-13 17:55:12,988 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:12,988 [INFO]: 	compression ratio: 0.999308792753425
2025-03-13 17:55:12,988 [INFO]: }
2025-03-13 17:55:12,988 [INFO]: 	>>> Finished "Creating the index" in 50.1836 secs
2025-03-13 17:55:12,988 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2157 secs
2025-03-13 17:55:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 17433 [episode count 0/20]
[retrieval_preprocessing] for episode 74267 [episode count 1/20], we have num_retrieval=np.int64(1966) num_query=np.int64(102)
2025-03-13 17:55:15,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:15,382 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:15
2025-03-13 17:55:15,382 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1627.59it/s]
2025-03-13 17:55:15,409 [INFO]: There are 1966 embeddings of dim 49152
2025-03-13 17:55:15,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:55:15,409 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:15
2025-03-13 17:55:15,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:15,409 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:55:15,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:15,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:15,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:15
2025-03-13 17:55:15,410 [INFO]: 405.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:15,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:15,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:15
2025-03-13 17:55:15,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:15,410 [INFO]: 	Creating the index 03/13/2025, 17:55:15
2025-03-13 17:55:15,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:15
2025-03-13 17:55:15,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:55:15,411 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:15
2025-03-13 17:55:15,411 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:55:15,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.70it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.67it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.39it/s] 50%|█████     | 4/8 [00:00<00:00,  6.84it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.16it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.43it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.64it/s]100%|██████████| 8/8 [00:02<00:00,  1.61it/s]100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
2025-03-13 17:55:18,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:18
2025-03-13 17:55:46,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5233 secs
2025-03-13 17:55:46,626 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:55:46,626 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 17:56:06,434 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8083 secs
2025-03-13 17:56:06,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0248 secs
2025-03-13 17:56:06,436 [INFO]: {
2025-03-13 17:56:06,436 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:06,436 [INFO]: 	index_param: efSearch=213
2025-03-13 17:56:06,436 [INFO]: 	index_path: knn.index
2025-03-13 17:56:06,436 [INFO]: 	size in bytes: 386798710
2025-03-13 17:56:06,436 [INFO]: 	avg_search_speed_ms: 11.818364651182371
2025-03-13 17:56:06,436 [INFO]: 	99p_search_speed_ms: 25.049045786727216
2025-03-13 17:56:06,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:06,436 [INFO]: 	nb vectors: 1966
2025-03-13 17:56:06,436 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:06,436 [INFO]: 	compression ratio: 0.999308730890028
2025-03-13 17:56:06,436 [INFO]: }
2025-03-13 17:56:06,436 [INFO]: 	>>> Finished "Creating the index" in 51.0266 secs
2025-03-13 17:56:06,436 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0541 secs
2025-03-13 17:56:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 74267 [episode count 1/20]
[retrieval_preprocessing] for episode 20563 [episode count 2/20], we have num_retrieval=np.int64(1986) num_query=np.int64(82)
2025-03-13 17:56:07,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:08,315 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:08
2025-03-13 17:56:08,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1007.28it/s]
2025-03-13 17:56:08,342 [INFO]: There are 1986 embeddings of dim 49152
2025-03-13 17:56:08,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:56:08,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:08
2025-03-13 17:56:08,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:08,342 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:56:08,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:08,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:56:08,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:08
2025-03-13 17:56:08,342 [INFO]: 409.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:08,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:56:08,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:08
2025-03-13 17:56:08,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:08,342 [INFO]: 	Creating the index 03/13/2025, 17:56:08
2025-03-13 17:56:08,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:08
2025-03-13 17:56:08,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:56:08,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:08
2025-03-13 17:56:08,344 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:56:08,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.29it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.35it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.46it/s] 50%|█████     | 4/8 [00:00<00:00,  8.16it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.55it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.00it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.24it/s]100%|██████████| 8/8 [00:02<00:00,  1.60it/s]100%|██████████| 8/8 [00:02<00:00,  3.09it/s]
2025-03-13 17:56:10,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:10
2025-03-13 17:56:40,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1334 secs
2025-03-13 17:56:40,072 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:56:40,073 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 17:57:00,535 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4618 secs
2025-03-13 17:57:00,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1928 secs
2025-03-13 17:57:00,536 [INFO]: {
2025-03-13 17:57:00,536 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:00,536 [INFO]: 	index_param: efSearch=206
2025-03-13 17:57:00,536 [INFO]: 	index_path: knn.index
2025-03-13 17:57:00,536 [INFO]: 	size in bytes: 390733510
2025-03-13 17:57:00,537 [INFO]: 	avg_search_speed_ms: 8.950809351582958
2025-03-13 17:57:00,537 [INFO]: 	99p_search_speed_ms: 12.222668612375848
2025-03-13 17:57:00,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:00,537 [INFO]: 	nb vectors: 1986
2025-03-13 17:57:00,537 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:00,537 [INFO]: 	compression ratio: 0.9993089356477257
2025-03-13 17:57:00,537 [INFO]: }
2025-03-13 17:57:00,537 [INFO]: 	>>> Finished "Creating the index" in 52.1943 secs
2025-03-13 17:57:00,537 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2212 secs
2025-03-13 17:57:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 20563 [episode count 2/20]
[retrieval_preprocessing] for episode 41557 [episode count 3/20], we have num_retrieval=np.int64(1982) num_query=np.int64(86)
2025-03-13 17:57:02,195 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:02,967 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:02
2025-03-13 17:57:02,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1707.08it/s]
2025-03-13 17:57:02,993 [INFO]: There are 1982 embeddings of dim 49152
2025-03-13 17:57:02,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:57:02,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:02
2025-03-13 17:57:02,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:02,993 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:57:02,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:02,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:02,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:02
2025-03-13 17:57:02,993 [INFO]: 409.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:02,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:02,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:02
2025-03-13 17:57:02,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:02,994 [INFO]: 	Creating the index 03/13/2025, 17:57:02
2025-03-13 17:57:02,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:02
2025-03-13 17:57:02,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:57:02,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:02
2025-03-13 17:57:02,995 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:57:02,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.26it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.33it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.28it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.66it/s]100%|██████████| 8/8 [00:01<00:00,  4.09it/s]
2025-03-13 17:57:04,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:04
2025-03-13 17:57:27,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0673 secs
2025-03-13 17:57:27,026 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 17:57:27,026 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.21it/s]
2025-03-13 17:57:48,798 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7722 secs
2025-03-13 17:57:48,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8058 secs
2025-03-13 17:57:48,801 [INFO]: {
2025-03-13 17:57:48,801 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:48,801 [INFO]: 	index_param: efSearch=247
2025-03-13 17:57:48,801 [INFO]: 	index_path: knn.index
2025-03-13 17:57:48,801 [INFO]: 	size in bytes: 389946550
2025-03-13 17:57:48,801 [INFO]: 	avg_search_speed_ms: 13.825712606045489
2025-03-13 17:57:48,801 [INFO]: 	99p_search_speed_ms: 32.65658429358153
2025-03-13 17:57:48,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:48,801 [INFO]: 	nb vectors: 1982
2025-03-13 17:57:48,801 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:48,801 [INFO]: 	compression ratio: 0.9993088950267671
2025-03-13 17:57:48,801 [INFO]: }
2025-03-13 17:57:48,801 [INFO]: 	>>> Finished "Creating the index" in 45.8076 secs
2025-03-13 17:57:48,801 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8344 secs
2025-03-13 17:57:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 41557 [episode count 3/20]
[retrieval_preprocessing] for episode 19064 [episode count 4/20], we have num_retrieval=np.int64(1987) num_query=np.int64(81)
2025-03-13 17:57:50,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:51,082 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:51
2025-03-13 17:57:51,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.92it/s]
2025-03-13 17:57:51,110 [INFO]: There are 1987 embeddings of dim 49152
2025-03-13 17:57:51,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:57:51,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:51
2025-03-13 17:57:51,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:51,110 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:57:51,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:51,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:51,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:51
2025-03-13 17:57:51,110 [INFO]: 410.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:51,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:51,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:51
2025-03-13 17:57:51,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:51,110 [INFO]: 	Creating the index 03/13/2025, 17:57:51
2025-03-13 17:57:51,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:51
2025-03-13 17:57:51,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:57:51,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:51
2025-03-13 17:57:51,112 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:57:51,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.48it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.32it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.11it/s] 50%|█████     | 4/8 [00:00<00:00,  8.44it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.85it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.91it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.95it/s]100%|██████████| 8/8 [00:02<00:00,  1.51it/s]100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
2025-03-13 17:57:53,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:53
2025-03-13 17:58:23,231 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4343 secs
2025-03-13 17:58:23,232 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:58:23,232 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 17:58:47,392 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1603 secs
2025-03-13 17:58:47,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2821 secs
2025-03-13 17:58:47,394 [INFO]: {
2025-03-13 17:58:47,394 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:47,394 [INFO]: 	index_param: efSearch=206
2025-03-13 17:58:47,394 [INFO]: 	index_path: knn.index
2025-03-13 17:58:47,394 [INFO]: 	size in bytes: 390930250
2025-03-13 17:58:47,394 [INFO]: 	avg_search_speed_ms: 8.82234517032805
2025-03-13 17:58:47,394 [INFO]: 	99p_search_speed_ms: 12.7517353463918
2025-03-13 17:58:47,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:47,394 [INFO]: 	nb vectors: 1987
2025-03-13 17:58:47,394 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:47,394 [INFO]: 	compression ratio: 0.9993089457774117
2025-03-13 17:58:47,394 [INFO]: }
2025-03-13 17:58:47,394 [INFO]: 	>>> Finished "Creating the index" in 56.2839 secs
2025-03-13 17:58:47,394 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3127 secs
2025-03-13 17:58:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 19064 [episode count 4/20]
[retrieval_preprocessing] for episode 87684 [episode count 5/20], we have num_retrieval=np.int64(1961) num_query=np.int64(107)
2025-03-13 17:58:48,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:49,961 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:49
2025-03-13 17:58:49,961 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-13 17:58:49,989 [INFO]: There are 1961 embeddings of dim 49152
2025-03-13 17:58:49,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:58:49,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:49
2025-03-13 17:58:49,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:49,991 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:58:49,991 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:49,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:58:49,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:49
2025-03-13 17:58:49,992 [INFO]: 404.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:49,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:58:49,993 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:49
2025-03-13 17:58:49,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:49,993 [INFO]: 	Creating the index 03/13/2025, 17:58:49
2025-03-13 17:58:49,993 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:49
2025-03-13 17:58:49,997 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:58:49,997 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:49
2025-03-13 17:58:49,998 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:58:49,998 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.38it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.14it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.23it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.68it/s]100%|██████████| 8/8 [00:02<00:00,  4.00it/s]
2025-03-13 17:58:52,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:52
2025-03-13 17:59:16,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7059 secs
2025-03-13 17:59:16,715 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:59:16,715 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 17:59:37,097 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3816 secs
2025-03-13 17:59:37,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1016 secs
2025-03-13 17:59:37,099 [INFO]: {
2025-03-13 17:59:37,099 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:37,099 [INFO]: 	index_param: efSearch=197
2025-03-13 17:59:37,099 [INFO]: 	index_path: knn.index
2025-03-13 17:59:37,099 [INFO]: 	size in bytes: 385815010
2025-03-13 17:59:37,099 [INFO]: 	avg_search_speed_ms: 11.214541174490172
2025-03-13 17:59:37,099 [INFO]: 	99p_search_speed_ms: 21.277548917569224
2025-03-13 17:59:37,099 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:37,099 [INFO]: 	nb vectors: 1961
2025-03-13 17:59:37,100 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:37,100 [INFO]: 	compression ratio: 0.9993086790480236
2025-03-13 17:59:37,100 [INFO]: }
2025-03-13 17:59:37,100 [INFO]: 	>>> Finished "Creating the index" in 47.1062 secs
2025-03-13 17:59:37,100 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1384 secs
2025-03-13 17:59:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 87684 [episode count 5/20]
[retrieval_preprocessing] for episode 8342 [episode count 6/20], we have num_retrieval=np.int64(1984) num_query=np.int64(84)
2025-03-13 17:59:38,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:39,061 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:39
2025-03-13 17:59:39,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-13 17:59:39,092 [INFO]: There are 1984 embeddings of dim 49152
2025-03-13 17:59:39,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:59:39,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:39
2025-03-13 17:59:39,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:39,093 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:59:39,093 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:39,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:59:39,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:39
2025-03-13 17:59:39,094 [INFO]: 409.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:39,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:59:39,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:39
2025-03-13 17:59:39,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:39,095 [INFO]: 	Creating the index 03/13/2025, 17:59:39
2025-03-13 17:59:39,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:39
2025-03-13 17:59:39,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:59:39,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:39
2025-03-13 17:59:39,098 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:59:39,098 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.93it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.90it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.47it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.82it/s]100%|██████████| 8/8 [00:02<00:00,  2.26it/s]100%|██████████| 8/8 [00:02<00:00,  3.45it/s]
2025-03-13 17:59:41,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:41
2025-03-13 18:00:09,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4187 secs
2025-03-13 18:00:09,844 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 18:00:09,844 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 18:00:29,926 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0817 secs
2025-03-13 18:00:29,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8298 secs
2025-03-13 18:00:29,928 [INFO]: {
2025-03-13 18:00:29,928 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:29,928 [INFO]: 	index_param: efSearch=219
2025-03-13 18:00:29,928 [INFO]: 	index_path: knn.index
2025-03-13 18:00:29,928 [INFO]: 	size in bytes: 390340030
2025-03-13 18:00:29,928 [INFO]: 	avg_search_speed_ms: 10.734524766468871
2025-03-13 18:00:29,928 [INFO]: 	99p_search_speed_ms: 15.098454023245722
2025-03-13 18:00:29,928 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:29,928 [INFO]: 	nb vectors: 1984
2025-03-13 18:00:29,928 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:29,928 [INFO]: 	compression ratio: 0.9993089153577203
2025-03-13 18:00:29,928 [INFO]: }
2025-03-13 18:00:29,928 [INFO]: 	>>> Finished "Creating the index" in 50.8336 secs
2025-03-13 18:00:29,928 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8667 secs
2025-03-13 18:00:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 8342 [episode count 6/20]
[retrieval_preprocessing] for episode 75437 [episode count 7/20], we have num_retrieval=np.int64(1827) num_query=np.int64(241)
2025-03-13 18:00:31,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:31,864 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:31
2025-03-13 18:00:31,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1600.27it/s]
2025-03-13 18:00:31,890 [INFO]: There are 1827 embeddings of dim 49152
2025-03-13 18:00:31,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:00:31,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:31
2025-03-13 18:00:31,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:31,890 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:00:31,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:31,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:31,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:31
2025-03-13 18:00:31,890 [INFO]: 377.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:31,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:31,890 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:31
2025-03-13 18:00:31,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:31,890 [INFO]: 	Creating the index 03/13/2025, 18:00:31
2025-03-13 18:00:31,890 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:31
2025-03-13 18:00:31,891 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:00:31,891 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:31
2025-03-13 18:00:31,891 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:00:31,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.33it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.33it/s] 50%|█████     | 4/8 [00:00<00:00,  9.22it/s] 75%|███████▌  | 6/8 [00:00<00:00, 10.19it/s]100%|██████████| 8/8 [00:02<00:00,  2.62it/s]100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
2025-03-13 18:00:34,144 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:34
2025-03-13 18:01:00,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0372 secs
2025-03-13 18:01:00,182 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 18:01:00,182 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 18:01:21,299 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1173 secs
2025-03-13 18:01:21,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4098 secs
2025-03-13 18:01:21,301 [INFO]: {
2025-03-13 18:01:21,301 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:21,301 [INFO]: 	index_param: efSearch=135
2025-03-13 18:01:21,301 [INFO]: 	index_path: knn.index
2025-03-13 18:01:21,301 [INFO]: 	size in bytes: 359451190
2025-03-13 18:01:21,301 [INFO]: 	avg_search_speed_ms: 8.082035964350355
2025-03-13 18:01:21,301 [INFO]: 	99p_search_speed_ms: 13.378067472949642
2025-03-13 18:01:21,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:21,301 [INFO]: 	nb vectors: 1827
2025-03-13 18:01:21,301 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:21,301 [INFO]: 	compression ratio: 0.9993090188406387
2025-03-13 18:01:21,302 [INFO]: }
2025-03-13 18:01:21,302 [INFO]: 	>>> Finished "Creating the index" in 49.4112 secs
2025-03-13 18:01:21,302 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4374 secs
2025-03-13 18:01:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 75437 [episode count 7/20]
[retrieval_preprocessing] for episode 14511 [episode count 8/20], we have num_retrieval=np.int64(1915) num_query=np.int64(153)
2025-03-13 18:01:23,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:23,648 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:23
2025-03-13 18:01:23,648 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.20it/s]
2025-03-13 18:01:23,675 [INFO]: There are 1915 embeddings of dim 49152
2025-03-13 18:01:23,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:01:23,675 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:23
2025-03-13 18:01:23,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:23,676 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:01:23,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:23,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:01:23,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:23
2025-03-13 18:01:23,677 [INFO]: 395.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:23,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:01:23,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:23
2025-03-13 18:01:23,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:23,677 [INFO]: 	Creating the index 03/13/2025, 18:01:23
2025-03-13 18:01:23,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:23
2025-03-13 18:01:23,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:01:23,681 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:23
2025-03-13 18:01:23,681 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:01:23,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.07it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.36it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.89it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.49it/s]100%|██████████| 8/8 [00:02<00:00,  3.97it/s]
2025-03-13 18:01:25,702 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:25
2025-03-13 18:01:49,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0896 secs
2025-03-13 18:01:49,792 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:01:49,793 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 18:02:11,511 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7179 secs
2025-03-13 18:02:11,513 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8321 secs
2025-03-13 18:02:11,513 [INFO]: {
2025-03-13 18:02:11,513 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:11,513 [INFO]: 	index_param: efSearch=240
2025-03-13 18:02:11,513 [INFO]: 	index_path: knn.index
2025-03-13 18:02:11,513 [INFO]: 	size in bytes: 376764850
2025-03-13 18:02:11,513 [INFO]: 	avg_search_speed_ms: 10.963565642381774
2025-03-13 18:02:11,513 [INFO]: 	99p_search_speed_ms: 16.67373560834676
2025-03-13 18:02:11,513 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:11,513 [INFO]: 	nb vectors: 1915
2025-03-13 18:02:11,513 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:11,513 [INFO]: 	compression ratio: 0.9993085076805864
2025-03-13 18:02:11,513 [INFO]: }
2025-03-13 18:02:11,513 [INFO]: 	>>> Finished "Creating the index" in 47.8360 secs
2025-03-13 18:02:11,513 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8657 secs
2025-03-13 18:02:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 14511 [episode count 8/20]
[retrieval_preprocessing] for episode 48305 [episode count 9/20], we have num_retrieval=np.int64(1960) num_query=np.int64(108)
2025-03-13 18:02:14,149 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:14,432 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:14
2025-03-13 18:02:14,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.25it/s]
2025-03-13 18:02:14,459 [INFO]: There are 1960 embeddings of dim 49152
2025-03-13 18:02:14,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:02:14,459 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:14
2025-03-13 18:02:14,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:14,459 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:02:14,459 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:14,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:14,459 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:14
2025-03-13 18:02:14,459 [INFO]: 404.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:14,459 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:14,459 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:14
2025-03-13 18:02:14,459 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:14,459 [INFO]: 	Creating the index 03/13/2025, 18:02:14
2025-03-13 18:02:14,459 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:14
2025-03-13 18:02:14,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:02:14,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:14
2025-03-13 18:02:14,461 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:02:14,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.38it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.57it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.56it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.05it/s]100%|██████████| 8/8 [00:02<00:00,  3.96it/s]
2025-03-13 18:02:16,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:16
2025-03-13 18:02:41,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7292 secs
2025-03-13 18:02:41,221 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 18:02:41,221 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 18:02:59,461 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2394 secs
2025-03-13 18:02:59,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0099 secs
2025-03-13 18:02:59,471 [INFO]: {
2025-03-13 18:02:59,471 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:59,471 [INFO]: 	index_param: efSearch=237
2025-03-13 18:02:59,471 [INFO]: 	index_path: knn.index
2025-03-13 18:02:59,471 [INFO]: 	size in bytes: 385618270
2025-03-13 18:02:59,471 [INFO]: 	avg_search_speed_ms: 10.758454551763904
2025-03-13 18:02:59,471 [INFO]: 	99p_search_speed_ms: 14.931674096733332
2025-03-13 18:02:59,471 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:59,471 [INFO]: 	nb vectors: 1960
2025-03-13 18:02:59,471 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:59,471 [INFO]: 	compression ratio: 0.9993086686478833
2025-03-13 18:02:59,471 [INFO]: }
2025-03-13 18:02:59,471 [INFO]: 	>>> Finished "Creating the index" in 45.0116 secs
2025-03-13 18:02:59,471 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0388 secs
2025-03-13 18:03:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 48305 [episode count 9/20]
[retrieval_preprocessing] for episode 20659 [episode count 10/20], we have num_retrieval=np.int64(1970) num_query=np.int64(98)
2025-03-13 18:03:01,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:01,928 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:01
2025-03-13 18:03:01,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1286.99it/s]
2025-03-13 18:03:01,960 [INFO]: There are 1970 embeddings of dim 49152
2025-03-13 18:03:01,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 18:03:01,960 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:01
2025-03-13 18:03:01,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:01,961 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:03:01,961 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:01,961 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:03:01,961 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:01
2025-03-13 18:03:01,961 [INFO]: 406.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:01,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:03:01,962 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:01
2025-03-13 18:03:01,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:01,962 [INFO]: 	Creating the index 03/13/2025, 18:03:01
2025-03-13 18:03:01,962 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:01
2025-03-13 18:03:01,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 18:03:01,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:01
2025-03-13 18:03:01,967 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:03:01,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.65it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.89it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.45it/s] 50%|█████     | 4/8 [00:00<00:00,  6.71it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.89it/s] 75%|███████▌  | 6/8 [00:00<00:00,  6.97it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.08it/s]100%|██████████| 8/8 [00:03<00:00,  1.25it/s]100%|██████████| 8/8 [00:03<00:00,  2.45it/s]
2025-03-13 18:03:05,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:05
2025-03-13 18:03:34,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8998 secs
2025-03-13 18:03:34,141 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 18:03:34,141 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.80it/s]
2025-03-13 18:03:49,982 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8407 secs
2025-03-13 18:03:50,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8965 secs
2025-03-13 18:03:50,864 [INFO]: {
2025-03-13 18:03:50,864 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:50,864 [INFO]: 	index_param: efSearch=214
2025-03-13 18:03:50,864 [INFO]: 	index_path: knn.index
2025-03-13 18:03:50,864 [INFO]: 	size in bytes: 387585670
2025-03-13 18:03:50,864 [INFO]: 	avg_search_speed_ms: 10.581716588604703
2025-03-13 18:03:50,864 [INFO]: 	99p_search_speed_ms: 21.559801110997793
2025-03-13 18:03:50,864 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:50,864 [INFO]: 	nb vectors: 1970
2025-03-13 18:03:50,864 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:50,864 [INFO]: 	compression ratio: 0.9993087721741621
2025-03-13 18:03:50,864 [INFO]: }
2025-03-13 18:03:50,864 [INFO]: 	>>> Finished "Creating the index" in 48.9019 secs
2025-03-13 18:03:50,864 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9356 secs
2025-03-13 18:03:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 20659 [episode count 10/20]
[retrieval_preprocessing] for episode 24766 [episode count 11/20], we have num_retrieval=np.int64(1980) num_query=np.int64(88)
2025-03-13 18:03:52,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:52,644 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:52
2025-03-13 18:03:52,644 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.69it/s]
2025-03-13 18:03:52,669 [INFO]: There are 1980 embeddings of dim 49152
2025-03-13 18:03:52,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:03:52,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:52
2025-03-13 18:03:52,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:52,670 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:03:52,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:52,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:52,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:52
2025-03-13 18:03:52,670 [INFO]: 408.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:52,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:03:52,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:52
2025-03-13 18:03:52,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:52,670 [INFO]: 	Creating the index 03/13/2025, 18:03:52
2025-03-13 18:03:52,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:52
2025-03-13 18:03:52,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:03:52,671 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:52
2025-03-13 18:03:52,671 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:03:52,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.49it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.06it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.14it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.46it/s]100%|██████████| 8/8 [00:02<00:00,  3.62it/s]
2025-03-13 18:03:54,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:54
2025-03-13 18:04:22,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9614 secs
2025-03-13 18:04:22,852 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 18:04:22,852 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 18:04:43,151 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2994 secs
2025-03-13 18:04:43,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4821 secs
2025-03-13 18:04:43,153 [INFO]: {
2025-03-13 18:04:43,153 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:43,153 [INFO]: 	index_param: efSearch=214
2025-03-13 18:04:43,153 [INFO]: 	index_path: knn.index
2025-03-13 18:04:43,153 [INFO]: 	size in bytes: 389553070
2025-03-13 18:04:43,153 [INFO]: 	avg_search_speed_ms: 10.357866290512789
2025-03-13 18:04:43,153 [INFO]: 	99p_search_speed_ms: 15.880732340738179
2025-03-13 18:04:43,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:43,153 [INFO]: 	nb vectors: 1980
2025-03-13 18:04:43,153 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:43,153 [INFO]: 	compression ratio: 0.9993088746547422
2025-03-13 18:04:43,153 [INFO]: }
2025-03-13 18:04:43,153 [INFO]: 	>>> Finished "Creating the index" in 50.4835 secs
2025-03-13 18:04:43,153 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5092 secs
2025-03-13 18:04:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 24766 [episode count 11/20]
[retrieval_preprocessing] for episode 41708 [episode count 12/20], we have num_retrieval=np.int64(1973) num_query=np.int64(95)
2025-03-13 18:04:44,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:45,339 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:45
2025-03-13 18:04:45,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-13 18:04:45,364 [INFO]: There are 1973 embeddings of dim 49152
2025-03-13 18:04:45,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:04:45,364 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:45
2025-03-13 18:04:45,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:45,364 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:04:45,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:45,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:45,364 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:45
2025-03-13 18:04:45,364 [INFO]: 407.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:45,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:45,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:45
2025-03-13 18:04:45,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:45,364 [INFO]: 	Creating the index 03/13/2025, 18:04:45
2025-03-13 18:04:45,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:45
2025-03-13 18:04:45,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:04:45,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:45
2025-03-13 18:04:45,365 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:04:45,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.96it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.83it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.25it/s] 50%|█████     | 4/8 [00:00<00:00,  6.80it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.23it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.65it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.85it/s]100%|██████████| 8/8 [00:02<00:00,  1.56it/s]100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
2025-03-13 18:04:48,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:48
2025-03-13 18:05:15,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5797 secs
2025-03-13 18:05:15,680 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:05:15,681 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 18:05:33,732 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0509 secs
2025-03-13 18:05:33,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3686 secs
2025-03-13 18:05:33,734 [INFO]: {
2025-03-13 18:05:33,734 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:33,734 [INFO]: 	index_param: efSearch=236
2025-03-13 18:05:33,734 [INFO]: 	index_path: knn.index
2025-03-13 18:05:33,734 [INFO]: 	size in bytes: 388175890
2025-03-13 18:05:33,734 [INFO]: 	avg_search_speed_ms: 11.073672457867335
2025-03-13 18:05:33,734 [INFO]: 	99p_search_speed_ms: 18.203414082527164
2025-03-13 18:05:33,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:33,734 [INFO]: 	nb vectors: 1973
2025-03-13 18:05:33,734 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:33,734 [INFO]: 	compression ratio: 0.9993088030274111
2025-03-13 18:05:33,734 [INFO]: }
2025-03-13 18:05:33,734 [INFO]: 	>>> Finished "Creating the index" in 48.3700 secs
2025-03-13 18:05:33,734 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3956 secs
2025-03-13 18:05:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 41708 [episode count 12/20]
[retrieval_preprocessing] for episode 65438 [episode count 13/20], we have num_retrieval=np.int64(1980) num_query=np.int64(88)
2025-03-13 18:05:35,403 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:35,683 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:35
2025-03-13 18:05:35,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-13 18:05:35,709 [INFO]: There are 1980 embeddings of dim 49152
2025-03-13 18:05:35,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:05:35,709 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:35
2025-03-13 18:05:35,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:35,710 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:05:35,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:35,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:35,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:35
2025-03-13 18:05:35,710 [INFO]: 408.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:35,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:05:35,710 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:35
2025-03-13 18:05:35,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:35,710 [INFO]: 	Creating the index 03/13/2025, 18:05:35
2025-03-13 18:05:35,710 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:35
2025-03-13 18:05:35,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:05:35,711 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:35
2025-03-13 18:05:35,711 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:05:35,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.20it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.86it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.53it/s] 50%|█████     | 4/8 [00:00<00:00,  7.91it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.13it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.26it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.33it/s]100%|██████████| 8/8 [00:02<00:00,  1.94it/s]100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
2025-03-13 18:05:37,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:37
2025-03-13 18:06:02,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0714 secs
2025-03-13 18:06:02,049 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:06:02,049 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 18:06:29,842 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7929 secs
2025-03-13 18:06:29,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2805 secs
2025-03-13 18:06:29,992 [INFO]: {
2025-03-13 18:06:29,992 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:29,992 [INFO]: 	index_param: efSearch=253
2025-03-13 18:06:29,992 [INFO]: 	index_path: knn.index
2025-03-13 18:06:29,992 [INFO]: 	size in bytes: 389553070
2025-03-13 18:06:29,992 [INFO]: 	avg_search_speed_ms: 10.988558573228726
2025-03-13 18:06:29,992 [INFO]: 	99p_search_speed_ms: 15.483254471328106
2025-03-13 18:06:29,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:29,992 [INFO]: 	nb vectors: 1980
2025-03-13 18:06:29,993 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:29,993 [INFO]: 	compression ratio: 0.9993088746547422
2025-03-13 18:06:29,993 [INFO]: }
2025-03-13 18:06:29,993 [INFO]: 	>>> Finished "Creating the index" in 54.2827 secs
2025-03-13 18:06:29,993 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3095 secs
2025-03-13 18:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 65438 [episode count 13/20]
[retrieval_preprocessing] for episode 5377 [episode count 14/20], we have num_retrieval=np.int64(1949) num_query=np.int64(119)
2025-03-13 18:06:31,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:32,005 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:32
2025-03-13 18:06:32,005 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1591.77it/s]
2025-03-13 18:06:32,032 [INFO]: There are 1949 embeddings of dim 49152
2025-03-13 18:06:32,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:06:32,032 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:32
2025-03-13 18:06:32,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:32,033 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:06:32,033 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:32,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:06:32,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:32
2025-03-13 18:06:32,033 [INFO]: 402.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:32,034 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:06:32,034 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:32
2025-03-13 18:06:32,034 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:32,034 [INFO]: 	Creating the index 03/13/2025, 18:06:32
2025-03-13 18:06:32,035 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:32
2025-03-13 18:06:32,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:06:32,038 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:32
2025-03-13 18:06:32,038 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:06:32,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.67it/s] 38%|███▊      | 3/8 [00:00<00:00, 11.75it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.59it/s] 88%|████████▊ | 7/8 [00:00<00:00, 14.23it/s]100%|██████████| 8/8 [00:02<00:00,  3.92it/s]
2025-03-13 18:06:34,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:34
2025-03-13 18:07:00,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7846 secs
2025-03-13 18:07:00,873 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:07:00,873 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 18:07:15,995 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1217 secs
2025-03-13 18:07:15,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9592 secs
2025-03-13 18:07:15,997 [INFO]: {
2025-03-13 18:07:15,997 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:15,997 [INFO]: 	index_param: efSearch=203
2025-03-13 18:07:15,997 [INFO]: 	index_path: knn.index
2025-03-13 18:07:15,997 [INFO]: 	size in bytes: 383454130
2025-03-13 18:07:15,997 [INFO]: 	avg_search_speed_ms: 10.519706524152516
2025-03-13 18:07:15,997 [INFO]: 	99p_search_speed_ms: 16.14330499432981
2025-03-13 18:07:15,997 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:15,997 [INFO]: 	nb vectors: 1949
2025-03-13 18:07:15,997 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:15,997 [INFO]: 	compression ratio: 0.9993085535419842
2025-03-13 18:07:15,997 [INFO]: }
2025-03-13 18:07:15,997 [INFO]: 	>>> Finished "Creating the index" in 43.9630 secs
2025-03-13 18:07:15,997 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9919 secs
2025-03-13 18:07:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 5377 [episode count 14/20]
[retrieval_preprocessing] for episode 72124 [episode count 15/20], we have num_retrieval=np.int64(1984) num_query=np.int64(84)
2025-03-13 18:07:18,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:18,342 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:18
2025-03-13 18:07:18,342 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2172.09it/s]
2025-03-13 18:07:18,365 [INFO]: There are 1984 embeddings of dim 49152
2025-03-13 18:07:18,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 18:07:18,365 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:18
2025-03-13 18:07:18,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:18,365 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:07:18,365 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:18,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:18,365 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:18
2025-03-13 18:07:18,365 [INFO]: 409.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:18,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:07:18,366 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:18
2025-03-13 18:07:18,366 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:18,366 [INFO]: 	Creating the index 03/13/2025, 18:07:18
2025-03-13 18:07:18,366 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:18
2025-03-13 18:07:18,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:18,367 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:18
2025-03-13 18:07:18,367 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:07:18,367 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.50it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.84it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.39it/s] 50%|█████     | 4/8 [00:00<00:00,  7.80it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.90it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.96it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.08it/s]100%|██████████| 8/8 [00:02<00:00,  1.87it/s]100%|██████████| 8/8 [00:02<00:00,  3.43it/s]
2025-03-13 18:07:20,702 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:20
2025-03-13 18:07:48,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8080 secs
2025-03-13 18:07:48,511 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:07:48,511 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 18:08:08,258 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7468 secs
2025-03-13 18:08:08,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8927 secs
2025-03-13 18:08:08,260 [INFO]: {
2025-03-13 18:08:08,260 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:08,260 [INFO]: 	index_param: efSearch=196
2025-03-13 18:08:08,260 [INFO]: 	index_path: knn.index
2025-03-13 18:08:08,260 [INFO]: 	size in bytes: 390340030
2025-03-13 18:08:08,260 [INFO]: 	avg_search_speed_ms: 8.635668620661814
2025-03-13 18:08:08,260 [INFO]: 	99p_search_speed_ms: 12.361486249137673
2025-03-13 18:08:08,260 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:08,260 [INFO]: 	nb vectors: 1984
2025-03-13 18:08:08,260 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:08,260 [INFO]: 	compression ratio: 0.9993089153577203
2025-03-13 18:08:08,260 [INFO]: }
2025-03-13 18:08:08,260 [INFO]: 	>>> Finished "Creating the index" in 49.8947 secs
2025-03-13 18:08:08,260 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9184 secs
2025-03-13 18:08:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 72124 [episode count 15/20]
[retrieval_preprocessing] for episode 31167 [episode count 16/20], we have num_retrieval=np.int64(1986) num_query=np.int64(82)
2025-03-13 18:08:09,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:09,986 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:09
2025-03-13 18:08:09,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1017.79it/s]
2025-03-13 18:08:10,012 [INFO]: There are 1986 embeddings of dim 49152
2025-03-13 18:08:10,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:08:10,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:10
2025-03-13 18:08:10,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:10,012 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:08:10,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:10,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:10,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:10
2025-03-13 18:08:10,012 [INFO]: 409.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:10,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:10,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:10
2025-03-13 18:08:10,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:10,012 [INFO]: 	Creating the index 03/13/2025, 18:08:10
2025-03-13 18:08:10,013 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:10
2025-03-13 18:08:10,014 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:08:10,014 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:10
2025-03-13 18:08:10,014 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:08:10,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.57it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.90it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.39it/s] 50%|█████     | 4/8 [00:00<00:00,  7.71it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.88it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.06it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.07it/s]100%|██████████| 8/8 [00:02<00:00,  1.44it/s]100%|██████████| 8/8 [00:02<00:00,  2.83it/s]
2025-03-13 18:08:12,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:12
2025-03-13 18:08:40,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3468 secs
2025-03-13 18:08:40,193 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:08:40,193 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 18:09:06,084 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8900 secs
2025-03-13 18:09:06,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0727 secs
2025-03-13 18:09:06,087 [INFO]: {
2025-03-13 18:09:06,087 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:06,087 [INFO]: 	index_param: efSearch=228
2025-03-13 18:09:06,087 [INFO]: 	index_path: knn.index
2025-03-13 18:09:06,087 [INFO]: 	size in bytes: 390733510
2025-03-13 18:09:06,087 [INFO]: 	avg_search_speed_ms: 10.536398965074387
2025-03-13 18:09:06,087 [INFO]: 	99p_search_speed_ms: 15.76545919291675
2025-03-13 18:09:06,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:06,087 [INFO]: 	nb vectors: 1986
2025-03-13 18:09:06,087 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:06,087 [INFO]: 	compression ratio: 0.9993089356477257
2025-03-13 18:09:06,087 [INFO]: }
2025-03-13 18:09:06,087 [INFO]: 	>>> Finished "Creating the index" in 56.0744 secs
2025-03-13 18:09:06,087 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1012 secs
2025-03-13 18:09:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 31167 [episode count 16/20]
[retrieval_preprocessing] for episode 18389 [episode count 17/20], we have num_retrieval=np.int64(1967) num_query=np.int64(101)
2025-03-13 18:09:07,656 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:08,035 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:08
2025-03-13 18:09:08,035 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.96it/s]
2025-03-13 18:09:08,535 [INFO]: There are 1967 embeddings of dim 49152
2025-03-13 18:09:08,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5004 secs
2025-03-13 18:09:08,535 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:08
2025-03-13 18:09:08,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:08,536 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:09:08,536 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:08,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:09:08,536 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:08
2025-03-13 18:09:08,536 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:08,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:08,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:08
2025-03-13 18:09:08,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:08,536 [INFO]: 	Creating the index 03/13/2025, 18:09:08
2025-03-13 18:09:08,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:08
2025-03-13 18:09:08,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 18:09:08,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:08
2025-03-13 18:09:08,538 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:09:08,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.66it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.82it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.22it/s]100%|██████████| 8/8 [00:02<00:00,  3.76it/s]
2025-03-13 18:09:10,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:10
2025-03-13 18:09:35,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0186 secs
2025-03-13 18:09:35,694 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 18:09:35,694 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-13 18:09:57,339 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6449 secs
2025-03-13 18:09:57,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8029 secs
2025-03-13 18:09:57,341 [INFO]: {
2025-03-13 18:09:57,341 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:57,341 [INFO]: 	index_param: efSearch=246
2025-03-13 18:09:57,341 [INFO]: 	index_path: knn.index
2025-03-13 18:09:57,341 [INFO]: 	size in bytes: 386995450
2025-03-13 18:09:57,342 [INFO]: 	avg_search_speed_ms: 11.386797178678792
2025-03-13 18:09:57,342 [INFO]: 	99p_search_speed_ms: 17.374558167066425
2025-03-13 18:09:57,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:57,342 [INFO]: 	nb vectors: 1967
2025-03-13 18:09:57,342 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:57,342 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-13 18:09:57,342 [INFO]: }
2025-03-13 18:09:57,342 [INFO]: 	>>> Finished "Creating the index" in 48.8055 secs
2025-03-13 18:09:57,342 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3067 secs
2025-03-13 18:09:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18389 [episode count 17/20]
[retrieval_preprocessing] for episode 80870 [episode count 18/20], we have num_retrieval=np.int64(1974) num_query=np.int64(94)
2025-03-13 18:09:59,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:59,862 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:59
2025-03-13 18:09:59,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-13 18:09:59,887 [INFO]: There are 1974 embeddings of dim 49152
2025-03-13 18:09:59,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:09:59,887 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:59
2025-03-13 18:09:59,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:59,888 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:09:59,888 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:59,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:09:59,888 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:59
2025-03-13 18:09:59,888 [INFO]: 407.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:59,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:09:59,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:59
2025-03-13 18:09:59,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:59,889 [INFO]: 	Creating the index 03/13/2025, 18:09:59
2025-03-13 18:09:59,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:59
2025-03-13 18:09:59,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:09:59,893 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:59
2025-03-13 18:09:59,893 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:09:59,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.07it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.54it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.15it/s] 50%|█████     | 4/8 [00:00<00:00,  7.44it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.60it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.77it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.34it/s]100%|██████████| 8/8 [00:02<00:00,  1.64it/s]100%|██████████| 8/8 [00:02<00:00,  3.09it/s]
2025-03-13 18:10:02,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:02
2025-03-13 18:10:32,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7672 secs
2025-03-13 18:10:32,256 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 18:10:32,256 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 18:10:51,359 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1034 secs
2025-03-13 18:10:51,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4686 secs
2025-03-13 18:10:51,361 [INFO]: {
2025-03-13 18:10:51,361 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:51,361 [INFO]: 	index_param: efSearch=185
2025-03-13 18:10:51,361 [INFO]: 	index_path: knn.index
2025-03-13 18:10:51,361 [INFO]: 	size in bytes: 388372630
2025-03-13 18:10:51,361 [INFO]: 	avg_search_speed_ms: 9.164004638922545
2025-03-13 18:10:51,361 [INFO]: 	99p_search_speed_ms: 14.565267576836046
2025-03-13 18:10:51,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:51,361 [INFO]: 	nb vectors: 1974
2025-03-13 18:10:51,361 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:51,362 [INFO]: 	compression ratio: 0.9993088132909881
2025-03-13 18:10:51,362 [INFO]: }
2025-03-13 18:10:51,362 [INFO]: 	>>> Finished "Creating the index" in 51.4724 secs
2025-03-13 18:10:51,362 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4997 secs
2025-03-13 18:10:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 80870 [episode count 18/20]
[retrieval_preprocessing] for episode 73610 [episode count 19/20], we have num_retrieval=np.int64(1989) num_query=np.int64(79)
2025-03-13 18:10:52,834 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:54,313 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:54
2025-03-13 18:10:54,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1287.78it/s]
2025-03-13 18:10:54,337 [INFO]: There are 1989 embeddings of dim 49152
2025-03-13 18:10:54,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:10:54,338 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:54
2025-03-13 18:10:54,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:54,338 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:10:54,338 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:54,338 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:10:54,338 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:54
2025-03-13 18:10:54,338 [INFO]: 410.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:54,338 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:10:54,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:54
2025-03-13 18:10:54,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:54,339 [INFO]: 	Creating the index 03/13/2025, 18:10:54
2025-03-13 18:10:54,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:54
2025-03-13 18:10:54,340 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:10:54,340 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:54
2025-03-13 18:10:54,341 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:10:54,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.31it/s] 38%|███▊      | 3/8 [00:00<00:00, 12.96it/s] 62%|██████▎   | 5/8 [00:00<00:00, 12.72it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.41it/s]100%|██████████| 8/8 [00:01<00:00,  4.15it/s]
2025-03-13 18:10:56,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:56
2025-03-13 18:11:18,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3300 secs
2025-03-13 18:11:18,608 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 18:11:18,608 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-13 18:11:45,303 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6951 secs
2025-03-13 18:11:45,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9647 secs
2025-03-13 18:11:45,305 [INFO]: {
2025-03-13 18:11:45,305 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:45,305 [INFO]: 	index_param: efSearch=245
2025-03-13 18:11:45,305 [INFO]: 	index_path: knn.index
2025-03-13 18:11:45,305 [INFO]: 	size in bytes: 391323790
2025-03-13 18:11:45,305 [INFO]: 	avg_search_speed_ms: 9.730452630652572
2025-03-13 18:11:45,305 [INFO]: 	99p_search_speed_ms: 12.462722789496187
2025-03-13 18:11:45,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:45,305 [INFO]: 	nb vectors: 1989
2025-03-13 18:11:45,305 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:45,305 [INFO]: 	compression ratio: 0.9993088127864651
2025-03-13 18:11:45,305 [INFO]: }
2025-03-13 18:11:45,305 [INFO]: 	>>> Finished "Creating the index" in 50.9666 secs
2025-03-13 18:11:45,305 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9929 secs
2025-03-13 18:11:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 73610 [episode count 19/20]
2025-03-13 18:11:46: [retrieval_preprocessing] finished for 4570623316_wrench_in_black_bowl [chosen_id count 6/196]
2025-03-13 18:11:48: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4706041793_place_cloth_on_table [chosen_id count 7/196]
2025-03-13 18:11:48: [retrieval_preprocessing] we have num_total=2274 embedding_dim=49152
[retrieval_preprocessing] for episode 20480 [episode count 0/20], we have num_retrieval=np.int64(2157) num_query=np.int64(117)
2025-03-13 18:11:48,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:49,294 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:49
2025-03-13 18:11:49,294 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2174.34it/s]
2025-03-13 18:11:49,317 [INFO]: There are 2157 embeddings of dim 49152
2025-03-13 18:11:49,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 18:11:49,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:49
2025-03-13 18:11:49,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:49,317 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:11:49,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:49,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:49,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:49
2025-03-13 18:11:49,317 [INFO]: 445.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:49,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:11:49,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:49
2025-03-13 18:11:49,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:49,317 [INFO]: 	Creating the index 03/13/2025, 18:11:49
2025-03-13 18:11:49,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:49
2025-03-13 18:11:49,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:11:49,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:49
2025-03-13 18:11:49,318 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:11:49,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.82it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.35it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.77it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.34it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.07it/s]
2025-03-13 18:11:51,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:51
2025-03-13 18:12:27,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4954 secs
2025-03-13 18:12:27,029 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:12:27,029 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 18:12:43,632 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6024 secs
2025-03-13 18:12:43,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3154 secs
2025-03-13 18:12:43,634 [INFO]: {
2025-03-13 18:12:43,634 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:43,634 [INFO]: 	index_param: efSearch=205
2025-03-13 18:12:43,634 [INFO]: 	index_path: knn.index
2025-03-13 18:12:43,634 [INFO]: 	size in bytes: 424376650
2025-03-13 18:12:43,634 [INFO]: 	avg_search_speed_ms: 10.435277348460088
2025-03-13 18:12:43,634 [INFO]: 	99p_search_speed_ms: 13.409178198780864
2025-03-13 18:12:43,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:43,634 [INFO]: 	nb vectors: 2157
2025-03-13 18:12:43,634 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:43,634 [INFO]: 	compression ratio: 0.9993091184446646
2025-03-13 18:12:43,634 [INFO]: }
2025-03-13 18:12:43,634 [INFO]: 	>>> Finished "Creating the index" in 54.3168 secs
2025-03-13 18:12:43,634 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3403 secs
2025-03-13 18:12:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20480 [episode count 0/20]
[retrieval_preprocessing] for episode 51732 [episode count 1/20], we have num_retrieval=np.int64(2173) num_query=np.int64(101)
2025-03-13 18:12:45,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:46,969 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:46
2025-03-13 18:12:46,969 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.78it/s]
2025-03-13 18:12:46,996 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 18:12:46,996 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:12:46,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:46
2025-03-13 18:12:46,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:46,997 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:12:46,997 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:46,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:12:46,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:46
2025-03-13 18:12:46,997 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:46,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:12:46,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:46
2025-03-13 18:12:46,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:46,998 [INFO]: 	Creating the index 03/13/2025, 18:12:46
2025-03-13 18:12:46,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:46
2025-03-13 18:12:47,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:12:47,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:47
2025-03-13 18:12:47,001 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:12:47,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.55it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.00it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.78it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.15it/s]100%|██████████| 9/9 [00:02<00:00,  2.36it/s]100%|██████████| 9/9 [00:02<00:00,  3.41it/s]
2025-03-13 18:12:49,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:49
2025-03-13 18:13:20,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5000 secs
2025-03-13 18:13:20,150 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:13:20,150 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 18:13:41,892 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7418 secs
2025-03-13 18:13:42,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3189 secs
2025-03-13 18:13:42,321 [INFO]: {
2025-03-13 18:13:42,321 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:42,321 [INFO]: 	index_param: efSearch=197
2025-03-13 18:13:42,321 [INFO]: 	index_path: knn.index
2025-03-13 18:13:42,321 [INFO]: 	size in bytes: 427524550
2025-03-13 18:13:42,321 [INFO]: 	avg_search_speed_ms: 9.721391897221377
2025-03-13 18:13:42,321 [INFO]: 	99p_search_speed_ms: 14.304920742288235
2025-03-13 18:13:42,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:42,321 [INFO]: 	nb vectors: 2173
2025-03-13 18:13:42,321 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:42,321 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 18:13:42,321 [INFO]: }
2025-03-13 18:13:42,322 [INFO]: 	>>> Finished "Creating the index" in 55.3233 secs
2025-03-13 18:13:42,322 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3522 secs
2025-03-13 18:13:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 51732 [episode count 1/20]
[retrieval_preprocessing] for episode 13356 [episode count 2/20], we have num_retrieval=np.int64(2160) num_query=np.int64(114)
2025-03-13 18:13:44,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:44,843 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:44
2025-03-13 18:13:44,843 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-13 18:13:44,871 [INFO]: There are 2160 embeddings of dim 49152
2025-03-13 18:13:44,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:13:44,871 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:44
2025-03-13 18:13:44,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:44,871 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:13:44,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:44,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:44,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:44
2025-03-13 18:13:44,871 [INFO]: 445.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:44,871 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:13:44,871 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:44
2025-03-13 18:13:44,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:44,872 [INFO]: 	Creating the index 03/13/2025, 18:13:44
2025-03-13 18:13:44,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:44
2025-03-13 18:13:44,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:13:44,873 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:44
2025-03-13 18:13:44,873 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:13:44,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.46it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.13it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.93it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.48it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.65it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.82it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.92it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.00it/s]100%|██████████| 9/9 [00:02<00:00,  1.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.70it/s]
2025-03-13 18:13:47,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:47
2025-03-13 18:14:15,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2261 secs
2025-03-13 18:14:15,537 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 18:14:15,538 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 18:14:31,719 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1813 secs
2025-03-13 18:14:31,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8482 secs
2025-03-13 18:14:31,721 [INFO]: {
2025-03-13 18:14:31,722 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:31,722 [INFO]: 	index_param: efSearch=178
2025-03-13 18:14:31,722 [INFO]: 	index_path: knn.index
2025-03-13 18:14:31,722 [INFO]: 	size in bytes: 424966870
2025-03-13 18:14:31,722 [INFO]: 	avg_search_speed_ms: 10.660548038881963
2025-03-13 18:14:31,722 [INFO]: 	99p_search_speed_ms: 15.898693318013102
2025-03-13 18:14:31,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:31,722 [INFO]: 	nb vectors: 2160
2025-03-13 18:14:31,722 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:31,722 [INFO]: 	compression ratio: 0.9993091461459102
2025-03-13 18:14:31,722 [INFO]: }
2025-03-13 18:14:31,722 [INFO]: 	>>> Finished "Creating the index" in 46.8500 secs
2025-03-13 18:14:31,722 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8784 secs
2025-03-13 18:14:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 13356 [episode count 2/20]
[retrieval_preprocessing] for episode 24137 [episode count 3/20], we have num_retrieval=np.int64(2175) num_query=np.int64(99)
2025-03-13 18:14:34,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:34,631 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:34
2025-03-13 18:14:34,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.92it/s]
2025-03-13 18:14:34,659 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 18:14:34,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 18:14:34,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:34
2025-03-13 18:14:34,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:34,660 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:14:34,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:34,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:14:34,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:34
2025-03-13 18:14:34,661 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:34,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:14:34,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:34
2025-03-13 18:14:34,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:34,661 [INFO]: 	Creating the index 03/13/2025, 18:14:34
2025-03-13 18:14:34,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:34
2025-03-13 18:14:34,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:14:34,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:34
2025-03-13 18:14:34,666 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:14:34,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.16it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.57it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.35it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.92it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.37it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.60it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.80it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.59it/s]100%|██████████| 9/9 [00:02<00:00,  3.27it/s]
2025-03-13 18:14:37,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:37
2025-03-13 18:15:10,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7568 secs
2025-03-13 18:15:10,179 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:15:10,179 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 18:15:34,263 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0839 secs
2025-03-13 18:15:34,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6006 secs
2025-03-13 18:15:34,266 [INFO]: {
2025-03-13 18:15:34,266 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:34,266 [INFO]: 	index_param: efSearch=197
2025-03-13 18:15:34,266 [INFO]: 	index_path: knn.index
2025-03-13 18:15:34,266 [INFO]: 	size in bytes: 427918090
2025-03-13 18:15:34,266 [INFO]: 	avg_search_speed_ms: 10.245172153503756
2025-03-13 18:15:34,266 [INFO]: 	99p_search_speed_ms: 13.395629765000194
2025-03-13 18:15:34,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:34,266 [INFO]: 	nb vectors: 2175
2025-03-13 18:15:34,266 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:34,266 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 18:15:34,266 [INFO]: }
2025-03-13 18:15:34,266 [INFO]: 	>>> Finished "Creating the index" in 59.6049 secs
2025-03-13 18:15:34,266 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6357 secs
2025-03-13 18:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 24137 [episode count 3/20]
[retrieval_preprocessing] for episode 17499 [episode count 4/20], we have num_retrieval=np.int64(2190) num_query=np.int64(84)
2025-03-13 18:15:36,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:36,553 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:36
2025-03-13 18:15:36,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2047.00it/s]
2025-03-13 18:15:36,580 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 18:15:36,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:15:36,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:36
2025-03-13 18:15:36,581 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:36,581 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:15:36,581 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:36,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:15:36,582 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:36
2025-03-13 18:15:36,582 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:36,582 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:15:36,582 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:36
2025-03-13 18:15:36,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:36,583 [INFO]: 	Creating the index 03/13/2025, 18:15:36
2025-03-13 18:15:36,583 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:36
2025-03-13 18:15:36,584 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:15:36,584 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:36
2025-03-13 18:15:36,584 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:15:36,584 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.56it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.92it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.84it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.60it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.51it/s]100%|██████████| 9/9 [00:02<00:00,  1.92it/s]100%|██████████| 9/9 [00:02<00:00,  3.31it/s]
2025-03-13 18:15:39,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:39
2025-03-13 18:16:10,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8963 secs
2025-03-13 18:16:10,205 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 18:16:10,205 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 18:16:30,310 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1052 secs
2025-03-13 18:16:30,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0281 secs
2025-03-13 18:16:30,613 [INFO]: {
2025-03-13 18:16:30,613 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:30,613 [INFO]: 	index_param: efSearch=172
2025-03-13 18:16:30,613 [INFO]: 	index_path: knn.index
2025-03-13 18:16:30,613 [INFO]: 	size in bytes: 430869310
2025-03-13 18:16:30,613 [INFO]: 	avg_search_speed_ms: 10.638672586758323
2025-03-13 18:16:30,613 [INFO]: 	99p_search_speed_ms: 14.745587769430132
2025-03-13 18:16:30,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:30,613 [INFO]: 	nb vectors: 2190
2025-03-13 18:16:30,613 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:30,613 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 18:16:30,613 [INFO]: }
2025-03-13 18:16:30,614 [INFO]: 	>>> Finished "Creating the index" in 54.0307 secs
2025-03-13 18:16:30,614 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0609 secs
2025-03-13 18:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 17499 [episode count 4/20]
[retrieval_preprocessing] for episode 63613 [episode count 5/20], we have num_retrieval=np.int64(2154) num_query=np.int64(120)
2025-03-13 18:16:31,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:32,279 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:32
2025-03-13 18:16:32,279 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.76it/s]
2025-03-13 18:16:32,302 [INFO]: There are 2154 embeddings of dim 49152
2025-03-13 18:16:32,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 18:16:32,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:32
2025-03-13 18:16:32,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:32,302 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:16:32,303 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:32,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:32,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:32
2025-03-13 18:16:32,303 [INFO]: 444.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:32,303 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:32,303 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:32
2025-03-13 18:16:32,303 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:32,303 [INFO]: 	Creating the index 03/13/2025, 18:16:32
2025-03-13 18:16:32,303 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:32
2025-03-13 18:16:32,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:16:32,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:32
2025-03-13 18:16:32,304 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:16:32,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.29it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.92it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.95it/s]100%|██████████| 9/9 [00:02<00:00,  2.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.81it/s]
2025-03-13 18:16:34,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:34
2025-03-13 18:17:03,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7076 secs
2025-03-13 18:17:03,375 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 18:17:03,376 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.58it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 18:17:25,442 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0667 secs
2025-03-13 18:17:25,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1402 secs
2025-03-13 18:17:25,444 [INFO]: {
2025-03-13 18:17:25,445 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:25,445 [INFO]: 	index_param: efSearch=210
2025-03-13 18:17:25,445 [INFO]: 	index_path: knn.index
2025-03-13 18:17:25,445 [INFO]: 	size in bytes: 423786370
2025-03-13 18:17:25,445 [INFO]: 	avg_search_speed_ms: 10.952833423550116
2025-03-13 18:17:25,445 [INFO]: 	99p_search_speed_ms: 14.8803258407861
2025-03-13 18:17:25,445 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:25,445 [INFO]: 	nb vectors: 2154
2025-03-13 18:17:25,445 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:25,445 [INFO]: 	compression ratio: 0.9993092321492076
2025-03-13 18:17:25,445 [INFO]: }
2025-03-13 18:17:25,445 [INFO]: 	>>> Finished "Creating the index" in 53.1417 secs
2025-03-13 18:17:25,445 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1657 secs
2025-03-13 18:17:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 63613 [episode count 5/20]
[retrieval_preprocessing] for episode 7809 [episode count 6/20], we have num_retrieval=np.int64(2173) num_query=np.int64(101)
2025-03-13 18:17:27,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:27,856 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:27
2025-03-13 18:17:27,856 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.99it/s]
2025-03-13 18:17:27,879 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 18:17:27,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:17:27,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:27,879 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:17:27,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:27,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:27,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,880 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:27,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:17:27,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:27
2025-03-13 18:17:27,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:27,880 [INFO]: 	Creating the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:27
2025-03-13 18:17:27,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:17:27,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,881 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:17:27,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.97it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.42it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.77it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.66it/s]100%|██████████| 9/9 [00:02<00:00,  2.04it/s]100%|██████████| 9/9 [00:02<00:00,  3.02it/s]
2025-03-13 18:17:30,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:30
2025-03-13 18:18:01,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5514 secs
2025-03-13 18:18:01,414 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 18:18:01,414 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 50%|█████     | 2/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 18:18:18,835 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4205 secs
2025-03-13 18:18:18,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9558 secs
2025-03-13 18:18:18,837 [INFO]: {
2025-03-13 18:18:18,837 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:18,837 [INFO]: 	index_param: efSearch=188
2025-03-13 18:18:18,837 [INFO]: 	index_path: knn.index
2025-03-13 18:18:18,837 [INFO]: 	size in bytes: 427524550
2025-03-13 18:18:18,837 [INFO]: 	avg_search_speed_ms: 11.75044944671833
2025-03-13 18:18:18,837 [INFO]: 	99p_search_speed_ms: 19.689920940436423
2025-03-13 18:18:18,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:18,837 [INFO]: 	nb vectors: 2173
2025-03-13 18:18:18,837 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:18,837 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 18:18:18,837 [INFO]: }
2025-03-13 18:18:18,837 [INFO]: 	>>> Finished "Creating the index" in 50.9573 secs
2025-03-13 18:18:18,837 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9815 secs
2025-03-13 18:18:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 7809 [episode count 6/20]
[retrieval_preprocessing] for episode 29836 [episode count 7/20], we have num_retrieval=np.int64(2159) num_query=np.int64(115)
2025-03-13 18:18:20,303 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:20,671 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:20
2025-03-13 18:18:20,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.33it/s]
2025-03-13 18:18:20,699 [INFO]: There are 2159 embeddings of dim 49152
2025-03-13 18:18:20,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:18:20,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:20
2025-03-13 18:18:20,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:20,699 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:18:20,699 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:20,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:20,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:20
2025-03-13 18:18:20,699 [INFO]: 445.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:20,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:18:20,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:20
2025-03-13 18:18:20,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:20,700 [INFO]: 	Creating the index 03/13/2025, 18:18:20
2025-03-13 18:18:20,700 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:20
2025-03-13 18:18:20,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:18:20,701 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:20
2025-03-13 18:18:20,701 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:18:20,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.00it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.59it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.67it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.20it/s]100%|██████████| 9/9 [00:02<00:00,  2.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.66it/s]
2025-03-13 18:18:23,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:23
2025-03-13 18:18:52,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1686 secs
2025-03-13 18:18:52,331 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:18:52,331 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 18:19:17,084 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7528 secs
2025-03-13 18:19:17,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3848 secs
2025-03-13 18:19:17,086 [INFO]: {
2025-03-13 18:19:17,086 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:17,086 [INFO]: 	index_param: efSearch=207
2025-03-13 18:19:17,086 [INFO]: 	index_path: knn.index
2025-03-13 18:19:17,086 [INFO]: 	size in bytes: 424770130
2025-03-13 18:19:17,086 [INFO]: 	avg_search_speed_ms: 10.888676481698853
2025-03-13 18:19:17,086 [INFO]: 	99p_search_speed_ms: 15.013750281650575
2025-03-13 18:19:17,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:17,086 [INFO]: 	nb vectors: 2159
2025-03-13 18:19:17,086 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:17,086 [INFO]: 	compression ratio: 0.9993091369207152
2025-03-13 18:19:17,086 [INFO]: }
2025-03-13 18:19:17,086 [INFO]: 	>>> Finished "Creating the index" in 56.3863 secs
2025-03-13 18:19:17,086 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4144 secs
2025-03-13 18:19:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 29836 [episode count 7/20]
[retrieval_preprocessing] for episode 37029 [episode count 8/20], we have num_retrieval=np.int64(2152) num_query=np.int64(122)
2025-03-13 18:19:18,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:19,134 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:19
2025-03-13 18:19:19,134 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.11it/s]
2025-03-13 18:19:19,158 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 18:19:19,158 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:19:19,158 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:19
2025-03-13 18:19:19,158 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:19,159 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:19:19,159 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:19,159 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:19:19,159 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:19
2025-03-13 18:19:19,159 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:19,159 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:19:19,159 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:19
2025-03-13 18:19:19,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:19,159 [INFO]: 	Creating the index 03/13/2025, 18:19:19
2025-03-13 18:19:19,159 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:19
2025-03-13 18:19:19,160 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:19:19,160 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:19
2025-03-13 18:19:19,160 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:19:19,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.16it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.73it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.18it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.92it/s]100%|██████████| 9/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.78it/s]
2025-03-13 18:19:21,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:21
2025-03-13 18:19:46,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5283 secs
2025-03-13 18:19:46,072 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 18:19:46,072 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-13 18:20:08,987 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9153 secs
2025-03-13 18:20:08,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8292 secs
2025-03-13 18:20:08,989 [INFO]: {
2025-03-13 18:20:08,989 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:08,989 [INFO]: 	index_param: efSearch=175
2025-03-13 18:20:08,989 [INFO]: 	index_path: knn.index
2025-03-13 18:20:08,989 [INFO]: 	size in bytes: 423392890
2025-03-13 18:20:08,989 [INFO]: 	avg_search_speed_ms: 8.746036377671066
2025-03-13 18:20:08,989 [INFO]: 	99p_search_speed_ms: 13.748749145306618
2025-03-13 18:20:08,990 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:08,990 [INFO]: 	nb vectors: 2152
2025-03-13 18:20:08,990 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:08,990 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 18:20:08,990 [INFO]: }
2025-03-13 18:20:08,990 [INFO]: 	>>> Finished "Creating the index" in 49.8306 secs
2025-03-13 18:20:08,990 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8552 secs
2025-03-13 18:20:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 37029 [episode count 8/20]
[retrieval_preprocessing] for episode 60589 [episode count 9/20], we have num_retrieval=np.int64(2148) num_query=np.int64(126)
2025-03-13 18:20:10,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:11,103 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:11
2025-03-13 18:20:11,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.96it/s]
2025-03-13 18:20:11,129 [INFO]: There are 2148 embeddings of dim 49152
2025-03-13 18:20:11,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:20:11,130 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:11
2025-03-13 18:20:11,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:11,130 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:20:11,130 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:11,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:11,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:11
2025-03-13 18:20:11,130 [INFO]: 443.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:11,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:20:11,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:11
2025-03-13 18:20:11,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:11,130 [INFO]: 	Creating the index 03/13/2025, 18:20:11
2025-03-13 18:20:11,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:11
2025-03-13 18:20:11,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:20:11,131 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:11
2025-03-13 18:20:11,131 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:20:11,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.78it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.53it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.88it/s]100%|██████████| 9/9 [00:02<00:00,  2.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.61it/s]
2025-03-13 18:20:13,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:13
2025-03-13 18:20:51,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3674 secs
2025-03-13 18:20:51,997 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:20:51,997 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 18:21:09,341 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3440 secs
2025-03-13 18:21:09,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2123 secs
2025-03-13 18:21:09,344 [INFO]: {
2025-03-13 18:21:09,344 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:09,344 [INFO]: 	index_param: efSearch=161
2025-03-13 18:21:09,344 [INFO]: 	index_path: knn.index
2025-03-13 18:21:09,344 [INFO]: 	size in bytes: 422605930
2025-03-13 18:21:09,344 [INFO]: 	avg_search_speed_ms: 8.205879018190876
2025-03-13 18:21:09,344 [INFO]: 	99p_search_speed_ms: 11.877419468946753
2025-03-13 18:21:09,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:09,344 [INFO]: 	nb vectors: 2148
2025-03-13 18:21:09,344 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:09,344 [INFO]: 	compression ratio: 0.999309176754808
2025-03-13 18:21:09,344 [INFO]: }
2025-03-13 18:21:09,344 [INFO]: 	>>> Finished "Creating the index" in 58.2139 secs
2025-03-13 18:21:09,344 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2406 secs
2025-03-13 18:21:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 60589 [episode count 9/20]
[retrieval_preprocessing] for episode 26308 [episode count 10/20], we have num_retrieval=np.int64(2137) num_query=np.int64(137)
2025-03-13 18:21:10,979 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:11,284 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:11
2025-03-13 18:21:11,284 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1740.38it/s]
2025-03-13 18:21:11,310 [INFO]: There are 2137 embeddings of dim 49152
2025-03-13 18:21:11,310 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:21:11,310 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:11
2025-03-13 18:21:11,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:11,311 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:21:11,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:11,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:21:11,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:11
2025-03-13 18:21:11,311 [INFO]: 441.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:11,312 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:21:11,312 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:11
2025-03-13 18:21:11,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:11,312 [INFO]: 	Creating the index 03/13/2025, 18:21:11
2025-03-13 18:21:11,312 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:11
2025-03-13 18:21:11,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:21:11,316 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:11
2025-03-13 18:21:11,316 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:21:11,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.17it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.83it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.06it/s]100%|██████████| 9/9 [00:02<00:00,  2.96it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 18:21:13,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:13
2025-03-13 18:21:39,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7983 secs
2025-03-13 18:21:39,274 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 18:21:39,274 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 18:22:01,338 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0639 secs
2025-03-13 18:22:01,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0236 secs
2025-03-13 18:22:01,339 [INFO]: {
2025-03-13 18:22:01,339 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:01,339 [INFO]: 	index_param: efSearch=185
2025-03-13 18:22:01,339 [INFO]: 	index_path: knn.index
2025-03-13 18:22:01,339 [INFO]: 	size in bytes: 420441790
2025-03-13 18:22:01,339 [INFO]: 	avg_search_speed_ms: 9.533843953780353
2025-03-13 18:22:01,339 [INFO]: 	99p_search_speed_ms: 14.218724714592094
2025-03-13 18:22:01,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:01,339 [INFO]: 	nb vectors: 2137
2025-03-13 18:22:01,340 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:01,340 [INFO]: 	compression ratio: 0.9993090743905357
2025-03-13 18:22:01,340 [INFO]: }
2025-03-13 18:22:01,340 [INFO]: 	>>> Finished "Creating the index" in 50.0275 secs
2025-03-13 18:22:01,340 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0552 secs
2025-03-13 18:22:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 26308 [episode count 10/20]
[retrieval_preprocessing] for episode 20681 [episode count 11/20], we have num_retrieval=np.int64(2172) num_query=np.int64(102)
2025-03-13 18:22:02,894 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:03,369 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:03
2025-03-13 18:22:03,369 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2398.12it/s]
2025-03-13 18:22:03,394 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 18:22:03,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:22:03,394 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:03
2025-03-13 18:22:03,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:03,395 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:22:03,395 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:03,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:03,395 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:03
2025-03-13 18:22:03,395 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:03,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:22:03,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:03
2025-03-13 18:22:03,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:03,395 [INFO]: 	Creating the index 03/13/2025, 18:22:03
2025-03-13 18:22:03,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:03
2025-03-13 18:22:03,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:22:03,397 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:03
2025-03-13 18:22:03,397 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:22:03,397 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.79it/s] 89%|████████▉ | 8/9 [00:00<00:00, 40.90it/s]100%|██████████| 9/9 [00:01<00:00,  5.07it/s]
2025-03-13 18:22:05,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:05
2025-03-13 18:22:39,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4589 secs
2025-03-13 18:22:39,637 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:22:39,637 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.41it/s]
2025-03-13 18:22:59,568 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9308 secs
2025-03-13 18:22:59,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1736 secs
2025-03-13 18:22:59,570 [INFO]: {
2025-03-13 18:22:59,570 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:59,570 [INFO]: 	index_param: efSearch=160
2025-03-13 18:22:59,570 [INFO]: 	index_path: knn.index
2025-03-13 18:22:59,571 [INFO]: 	size in bytes: 427327810
2025-03-13 18:22:59,571 [INFO]: 	avg_search_speed_ms: 12.939105189271647
2025-03-13 18:22:59,571 [INFO]: 	99p_search_speed_ms: 20.180803677067157
2025-03-13 18:22:59,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:59,571 [INFO]: 	nb vectors: 2172
2025-03-13 18:22:59,571 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:59,571 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 18:22:59,571 [INFO]: }
2025-03-13 18:22:59,571 [INFO]: 	>>> Finished "Creating the index" in 56.1754 secs
2025-03-13 18:22:59,571 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2013 secs
2025-03-13 18:23:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 20681 [episode count 11/20]
[retrieval_preprocessing] for episode 8947 [episode count 12/20], we have num_retrieval=np.int64(2164) num_query=np.int64(110)
2025-03-13 18:23:02,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:02,801 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:02
2025-03-13 18:23:02,801 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.18it/s]
2025-03-13 18:23:02,831 [INFO]: There are 2164 embeddings of dim 49152
2025-03-13 18:23:02,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:23:02,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:02
2025-03-13 18:23:02,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:02,831 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:23:02,831 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:02,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:23:02,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:02
2025-03-13 18:23:02,832 [INFO]: 446.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:02,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:02,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:02
2025-03-13 18:23:02,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:02,832 [INFO]: 	Creating the index 03/13/2025, 18:23:02
2025-03-13 18:23:02,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:02
2025-03-13 18:23:02,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:23:02,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:02
2025-03-13 18:23:02,833 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:23:02,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.59it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.32it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.09it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.33it/s]100%|██████████| 9/9 [00:02<00:00,  2.08it/s]100%|██████████| 9/9 [00:02<00:00,  3.09it/s]
2025-03-13 18:23:05,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:05
2025-03-13 18:23:36,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2487 secs
2025-03-13 18:23:36,999 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 18:23:37,000 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 18:23:53,763 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7630 secs
2025-03-13 18:23:53,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9316 secs
2025-03-13 18:23:53,765 [INFO]: {
2025-03-13 18:23:53,765 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:53,765 [INFO]: 	index_param: efSearch=175
2025-03-13 18:23:53,765 [INFO]: 	index_path: knn.index
2025-03-13 18:23:53,765 [INFO]: 	size in bytes: 425753830
2025-03-13 18:23:53,765 [INFO]: 	avg_search_speed_ms: 9.540362923427393
2025-03-13 18:23:53,765 [INFO]: 	99p_search_speed_ms: 15.281307902187088
2025-03-13 18:23:53,765 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:53,765 [INFO]: 	nb vectors: 2164
2025-03-13 18:23:53,765 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:53,765 [INFO]: 	compression ratio: 0.999309182961431
2025-03-13 18:23:53,765 [INFO]: }
2025-03-13 18:23:53,765 [INFO]: 	>>> Finished "Creating the index" in 50.9331 secs
2025-03-13 18:23:53,765 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9644 secs
2025-03-13 18:23:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 8947 [episode count 12/20]
[retrieval_preprocessing] for episode 66878 [episode count 13/20], we have num_retrieval=np.int64(2185) num_query=np.int64(89)
2025-03-13 18:23:55,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:56,096 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:56
2025-03-13 18:23:56,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-13 18:23:56,122 [INFO]: There are 2185 embeddings of dim 49152
2025-03-13 18:23:56,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:23:56,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:56
2025-03-13 18:23:56,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:56,123 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:23:56,123 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:56,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:23:56,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:56
2025-03-13 18:23:56,123 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:56,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:56,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:56
2025-03-13 18:23:56,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:56,123 [INFO]: 	Creating the index 03/13/2025, 18:23:56
2025-03-13 18:23:56,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:56
2025-03-13 18:23:56,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:23:56,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:56
2025-03-13 18:23:56,125 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:23:56,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.80it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.28it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.70it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.20it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.14it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.39it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.97it/s]100%|██████████| 9/9 [00:02<00:00,  2.21it/s]100%|██████████| 9/9 [00:02<00:00,  3.46it/s]
2025-03-13 18:23:58,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:58
2025-03-13 18:24:35,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4315 secs
2025-03-13 18:24:35,161 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 18:24:35,161 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 18:24:54,278 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1171 secs
2025-03-13 18:24:54,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4789 secs
2025-03-13 18:24:54,604 [INFO]: {
2025-03-13 18:24:54,604 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:54,604 [INFO]: 	index_param: efSearch=141
2025-03-13 18:24:54,604 [INFO]: 	index_path: knn.index
2025-03-13 18:24:54,604 [INFO]: 	size in bytes: 429885490
2025-03-13 18:24:54,604 [INFO]: 	avg_search_speed_ms: 7.820296081960644
2025-03-13 18:24:54,604 [INFO]: 	99p_search_speed_ms: 12.266801353543997
2025-03-13 18:24:54,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:54,604 [INFO]: 	nb vectors: 2185
2025-03-13 18:24:54,605 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:54,605 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-13 18:24:54,605 [INFO]: }
2025-03-13 18:24:54,605 [INFO]: 	>>> Finished "Creating the index" in 58.4812 secs
2025-03-13 18:24:54,605 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5090 secs
2025-03-13 18:24:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 66878 [episode count 13/20]
[retrieval_preprocessing] for episode 59218 [episode count 14/20], we have num_retrieval=np.int64(2174) num_query=np.int64(100)
2025-03-13 18:24:55,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:56,186 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:56
2025-03-13 18:24:56,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2123.70it/s]
2025-03-13 18:24:56,211 [INFO]: There are 2174 embeddings of dim 49152
2025-03-13 18:24:56,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:24:56,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:56
2025-03-13 18:24:56,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:56,212 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:24:56,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:56,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:24:56,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:56
2025-03-13 18:24:56,213 [INFO]: 448.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:56,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:24:56,213 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:56
2025-03-13 18:24:56,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:56,213 [INFO]: 	Creating the index 03/13/2025, 18:24:56
2025-03-13 18:24:56,213 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:56
2025-03-13 18:24:56,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:24:56,217 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:56
2025-03-13 18:24:56,217 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:24:56,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.35it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.60it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.13it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.05it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.16it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.22it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.26it/s]100%|██████████| 9/9 [00:02<00:00,  1.44it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]
2025-03-13 18:24:59,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:59
2025-03-13 18:25:24,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2883 secs
2025-03-13 18:25:24,475 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 18:25:24,475 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 18:25:50,653 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1770 secs
2025-03-13 18:25:50,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4372 secs
2025-03-13 18:25:50,654 [INFO]: {
2025-03-13 18:25:50,654 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:50,654 [INFO]: 	index_param: efSearch=158
2025-03-13 18:25:50,654 [INFO]: 	index_path: knn.index
2025-03-13 18:25:50,654 [INFO]: 	size in bytes: 427721350
2025-03-13 18:25:50,654 [INFO]: 	avg_search_speed_ms: 8.142518952180986
2025-03-13 18:25:50,654 [INFO]: 	99p_search_speed_ms: 11.325685959309341
2025-03-13 18:25:50,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:50,654 [INFO]: 	nb vectors: 2174
2025-03-13 18:25:50,654 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:50,654 [INFO]: 	compression ratio: 0.9993089940448379
2025-03-13 18:25:50,654 [INFO]: }
2025-03-13 18:25:50,654 [INFO]: 	>>> Finished "Creating the index" in 54.4411 secs
2025-03-13 18:25:50,654 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4687 secs
2025-03-13 18:25:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 59218 [episode count 14/20]
[retrieval_preprocessing] for episode 83798 [episode count 15/20], we have num_retrieval=np.int64(2124) num_query=np.int64(150)
2025-03-13 18:25:52,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:52,368 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:52
2025-03-13 18:25:52,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.89it/s]
2025-03-13 18:25:52,391 [INFO]: There are 2124 embeddings of dim 49152
2025-03-13 18:25:52,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:25:52,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:52,392 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:25:52,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:52,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:52,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,392 [INFO]: 438.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:52,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:25:52,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:52
2025-03-13 18:25:52,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:52,392 [INFO]: 	Creating the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:52
2025-03-13 18:25:52,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:25:52,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,393 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:25:52,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.06it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.67it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.12it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.78it/s]100%|██████████| 9/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.88it/s]
2025-03-13 18:25:54,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:54
2025-03-13 18:26:24,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9914 secs
2025-03-13 18:26:24,708 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:26:24,708 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 18:26:47,396 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6879 secs
2025-03-13 18:26:47,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0050 secs
2025-03-13 18:26:47,398 [INFO]: {
2025-03-13 18:26:47,398 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:47,398 [INFO]: 	index_param: efSearch=211
2025-03-13 18:26:47,398 [INFO]: 	index_path: knn.index
2025-03-13 18:26:47,398 [INFO]: 	size in bytes: 417884050
2025-03-13 18:26:47,398 [INFO]: 	avg_search_speed_ms: 13.781973714978735
2025-03-13 18:26:47,398 [INFO]: 	99p_search_speed_ms: 18.443350039888173
2025-03-13 18:26:47,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:47,398 [INFO]: 	nb vectors: 2124
2025-03-13 18:26:47,398 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:47,398 [INFO]: 	compression ratio: 0.9993092390101991
2025-03-13 18:26:47,398 [INFO]: }
2025-03-13 18:26:47,398 [INFO]: 	>>> Finished "Creating the index" in 55.0065 secs
2025-03-13 18:26:47,398 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0308 secs
2025-03-13 18:26:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 83798 [episode count 15/20]
[retrieval_preprocessing] for episode 90458 [episode count 16/20], we have num_retrieval=np.int64(2175) num_query=np.int64(99)
2025-03-13 18:26:49,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:50,360 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:50
2025-03-13 18:26:50,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-13 18:26:50,389 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 18:26:50,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 18:26:50,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:50
2025-03-13 18:26:50,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:50,389 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:26:50,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:50,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:50,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:50
2025-03-13 18:26:50,389 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:50,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:50,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:50
2025-03-13 18:26:50,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:50,390 [INFO]: 	Creating the index 03/13/2025, 18:26:50
2025-03-13 18:26:50,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:50
2025-03-13 18:26:50,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:26:50,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:50
2025-03-13 18:26:50,391 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:26:50,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.35it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.97it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.75it/s] 44%|████▍     | 4/9 [00:00<00:00,  5.20it/s] 56%|█████▌    | 5/9 [00:00<00:00,  5.72it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.31it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.82it/s]100%|██████████| 9/9 [00:03<00:00,  1.20it/s]100%|██████████| 9/9 [00:03<00:00,  2.31it/s]
2025-03-13 18:26:54,295 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:54
2025-03-13 18:27:28,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1391 secs
2025-03-13 18:27:28,435 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 18:27:28,435 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 18:27:44,221 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7860 secs
2025-03-13 18:27:44,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8328 secs
2025-03-13 18:27:44,224 [INFO]: {
2025-03-13 18:27:44,224 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:44,224 [INFO]: 	index_param: efSearch=172
2025-03-13 18:27:44,224 [INFO]: 	index_path: knn.index
2025-03-13 18:27:44,224 [INFO]: 	size in bytes: 427918090
2025-03-13 18:27:44,224 [INFO]: 	avg_search_speed_ms: 9.940931978070772
2025-03-13 18:27:44,224 [INFO]: 	99p_search_speed_ms: 13.861845002975318
2025-03-13 18:27:44,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:44,224 [INFO]: 	nb vectors: 2175
2025-03-13 18:27:44,224 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:44,224 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 18:27:44,224 [INFO]: }
2025-03-13 18:27:44,224 [INFO]: 	>>> Finished "Creating the index" in 53.8343 secs
2025-03-13 18:27:44,224 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8633 secs
2025-03-13 18:27:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 90458 [episode count 16/20]
[retrieval_preprocessing] for episode 58214 [episode count 17/20], we have num_retrieval=np.int64(2135) num_query=np.int64(139)
2025-03-13 18:27:46,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:46,907 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:46
2025-03-13 18:27:46,907 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1778.75it/s]
2025-03-13 18:27:46,930 [INFO]: There are 2135 embeddings of dim 49152
2025-03-13 18:27:46,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:27:46,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:46
2025-03-13 18:27:46,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:46,930 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:27:46,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:46,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:46,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:46
2025-03-13 18:27:46,931 [INFO]: 440.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:46,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:27:46,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:46
2025-03-13 18:27:46,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:46,931 [INFO]: 	Creating the index 03/13/2025, 18:27:46
2025-03-13 18:27:46,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:46
2025-03-13 18:27:46,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:27:46,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:46
2025-03-13 18:27:46,932 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:27:46,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.21it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.64it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.38it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.70it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.04it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.11it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.28it/s]100%|██████████| 9/9 [00:02<00:00,  1.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]
2025-03-13 18:27:49,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:49
2025-03-13 18:28:19,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2515 secs
2025-03-13 18:28:19,880 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 18:28:19,880 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 18:28:34,174 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2937 secs
2025-03-13 18:28:34,176 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2438 secs
2025-03-13 18:28:34,176 [INFO]: {
2025-03-13 18:28:34,176 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:34,176 [INFO]: 	index_param: efSearch=184
2025-03-13 18:28:34,176 [INFO]: 	index_path: knn.index
2025-03-13 18:28:34,176 [INFO]: 	size in bytes: 420048250
2025-03-13 18:28:34,176 [INFO]: 	avg_search_speed_ms: 10.221043498072476
2025-03-13 18:28:34,176 [INFO]: 	99p_search_speed_ms: 20.379805886186663
2025-03-13 18:28:34,176 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:34,176 [INFO]: 	nb vectors: 2135
2025-03-13 18:28:34,176 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:34,176 [INFO]: 	compression ratio: 0.9993091984075639
2025-03-13 18:28:34,176 [INFO]: }
2025-03-13 18:28:34,176 [INFO]: 	>>> Finished "Creating the index" in 47.2454 secs
2025-03-13 18:28:34,176 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2696 secs
2025-03-13 18:28:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 58214 [episode count 17/20]
[retrieval_preprocessing] for episode 1409 [episode count 18/20], we have num_retrieval=np.int64(2183) num_query=np.int64(91)
2025-03-13 18:28:36,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:37,158 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:37
2025-03-13 18:28:37,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2353.71it/s]
2025-03-13 18:28:37,441 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 18:28:37,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2835 secs
2025-03-13 18:28:37,442 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:37
2025-03-13 18:28:37,442 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:37,442 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:28:37,442 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:37,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:28:37,442 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:37
2025-03-13 18:28:37,442 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:37,443 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:28:37,443 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:37
2025-03-13 18:28:37,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:37,443 [INFO]: 	Creating the index 03/13/2025, 18:28:37
2025-03-13 18:28:37,443 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:37
2025-03-13 18:28:37,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:28:37,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:37
2025-03-13 18:28:37,446 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:28:37,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.73it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.34it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.17it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.12it/s] 67%|██████▋   | 6/9 [00:00<00:00, 10.57it/s] 89%|████████▉ | 8/9 [00:00<00:00, 13.10it/s]100%|██████████| 9/9 [00:02<00:00,  3.46it/s]
2025-03-13 18:28:40,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:40
2025-03-13 18:29:07,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5606 secs
2025-03-13 18:29:07,612 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:29:07,612 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 18:29:31,061 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4490 secs
2025-03-13 18:29:31,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6167 secs
2025-03-13 18:29:31,063 [INFO]: {
2025-03-13 18:29:31,063 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:31,063 [INFO]: 	index_param: efSearch=224
2025-03-13 18:29:31,063 [INFO]: 	index_path: knn.index
2025-03-13 18:29:31,063 [INFO]: 	size in bytes: 429492010
2025-03-13 18:29:31,063 [INFO]: 	avg_search_speed_ms: 11.83838556746583
2025-03-13 18:29:31,063 [INFO]: 	99p_search_speed_ms: 18.74168907292187
2025-03-13 18:29:31,063 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:31,063 [INFO]: 	nb vectors: 2183
2025-03-13 18:29:31,063 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:31,063 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 18:29:31,063 [INFO]: }
2025-03-13 18:29:31,063 [INFO]: 	>>> Finished "Creating the index" in 53.6203 secs
2025-03-13 18:29:31,063 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9055 secs
2025-03-13 18:29:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 1409 [episode count 18/20]
[retrieval_preprocessing] for episode 32174 [episode count 19/20], we have num_retrieval=np.int64(2116) num_query=np.int64(158)
2025-03-13 18:29:32,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:33,622 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:33
2025-03-13 18:29:33,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1821.23it/s]
2025-03-13 18:29:33,644 [INFO]: There are 2116 embeddings of dim 49152
2025-03-13 18:29:33,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 18:29:33,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:33
2025-03-13 18:29:33,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:33,645 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:29:33,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:33,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:33,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:33
2025-03-13 18:29:33,645 [INFO]: 436.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:33,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:29:33,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:33
2025-03-13 18:29:33,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:33,645 [INFO]: 	Creating the index 03/13/2025, 18:29:33
2025-03-13 18:29:33,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:33
2025-03-13 18:29:33,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:29:33,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:33
2025-03-13 18:29:33,646 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:29:33,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.08it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.10it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.54it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.62it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.91it/s]100%|██████████| 9/9 [00:02<00:00,  2.24it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 18:29:36,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:36
2025-03-13 18:30:11,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7248 secs
2025-03-13 18:30:11,762 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 18:30:11,762 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s]
2025-03-13 18:30:27,102 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3399 secs
2025-03-13 18:30:27,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4576 secs
2025-03-13 18:30:27,104 [INFO]: {
2025-03-13 18:30:27,104 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:27,104 [INFO]: 	index_param: efSearch=155
2025-03-13 18:30:27,104 [INFO]: 	index_path: knn.index
2025-03-13 18:30:27,104 [INFO]: 	size in bytes: 416310130
2025-03-13 18:30:27,104 [INFO]: 	avg_search_speed_ms: 8.460517130223263
2025-03-13 18:30:27,104 [INFO]: 	99p_search_speed_ms: 11.490112130995849
2025-03-13 18:30:27,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:27,104 [INFO]: 	nb vectors: 2116
2025-03-13 18:30:27,104 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:27,104 [INFO]: 	compression ratio: 0.9993091640599762
2025-03-13 18:30:27,104 [INFO]: }
2025-03-13 18:30:27,104 [INFO]: 	>>> Finished "Creating the index" in 53.4590 secs
2025-03-13 18:30:27,104 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4820 secs
2025-03-13 18:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 32174 [episode count 19/20]
2025-03-13 18:30:28: [retrieval_preprocessing] finished for 4706041793_place_cloth_on_table [chosen_id count 7/196]
2025-03-13 18:30:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4706041793_hang_cloth_on_stand [chosen_id count 8/196]
2025-03-13 18:30:32: [retrieval_preprocessing] we have num_total=5322 embedding_dim=49152
[retrieval_preprocessing] for episode 39950 [episode count 0/20], we have num_retrieval=np.int64(5167) num_query=np.int64(155)
2025-03-13 18:30:33,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:34,523 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:34
2025-03-13 18:30:34,523 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-13 18:30:34,548 [INFO]: There are 5167 embeddings of dim 49152
2025-03-13 18:30:34,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:30:34,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:34
2025-03-13 18:30:34,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:34,548 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:30:34,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:34,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:30:34,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:34
2025-03-13 18:30:34,549 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:34,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:30:34,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:34
2025-03-13 18:30:34,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:34,549 [INFO]: 	Creating the index 03/13/2025, 18:30:34
2025-03-13 18:30:34,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:34
2025-03-13 18:30:34,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:30:34,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:34
2025-03-13 18:30:34,550 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:30:34,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.21it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.51it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.75it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.15it/s] 41%|████      | 9/22 [00:00<00:01, 10.49it/s] 50%|█████     | 11/22 [00:01<00:01, 10.85it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.92it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.97it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.04it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.03it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.38it/s]100%|██████████| 22/22 [00:07<00:00,  1.22it/s]100%|██████████| 22/22 [00:07<00:00,  2.98it/s]
2025-03-13 18:30:41,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:41
2025-03-13 18:31:25,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5123 secs
2025-03-13 18:31:25,453 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:31:25,453 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 18:31:49,199 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7459 secs
2025-03-13 18:31:49,346 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7956 secs
2025-03-13 18:31:49,346 [INFO]: {
2025-03-13 18:31:49,346 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:49,346 [INFO]: 	index_param: efSearch=147
2025-03-13 18:31:49,346 [INFO]: 	index_path: knn.index
2025-03-13 18:31:49,346 [INFO]: 	size in bytes: 1016576530
2025-03-13 18:31:49,346 [INFO]: 	avg_search_speed_ms: 10.18771294612521
2025-03-13 18:31:49,347 [INFO]: 	99p_search_speed_ms: 14.668292347341774
2025-03-13 18:31:49,347 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:49,347 [INFO]: 	nb vectors: 5167
2025-03-13 18:31:49,347 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:49,347 [INFO]: 	compression ratio: 0.9993084691813611
2025-03-13 18:31:49,347 [INFO]: }
2025-03-13 18:31:49,347 [INFO]: 	>>> Finished "Creating the index" in 74.7981 secs
2025-03-13 18:31:49,347 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8243 secs
2025-03-13 18:31:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 39950 [episode count 0/20]
[retrieval_preprocessing] for episode 75280 [episode count 1/20], we have num_retrieval=np.int64(5159) num_query=np.int64(163)
2025-03-13 18:31:53,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:54,335 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:54
2025-03-13 18:31:54,335 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1709.17it/s]
2025-03-13 18:31:54,602 [INFO]: There are 5159 embeddings of dim 49152
2025-03-13 18:31:54,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2674 secs
2025-03-13 18:31:54,603 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:54
2025-03-13 18:31:54,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:54,603 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:31:54,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:54,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:31:54,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:54
2025-03-13 18:31:54,603 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:54,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:31:54,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:54
2025-03-13 18:31:54,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:54,604 [INFO]: 	Creating the index 03/13/2025, 18:31:54
2025-03-13 18:31:54,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:54
2025-03-13 18:31:54,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:31:54,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:54
2025-03-13 18:31:54,606 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:31:54,607 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.77it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.09it/s] 18%|█▊        | 4/22 [00:00<00:01,  9.35it/s] 27%|██▋       | 6/22 [00:00<00:01, 10.09it/s] 36%|███▋      | 8/22 [00:00<00:01, 10.54it/s] 45%|████▌     | 10/22 [00:00<00:01, 10.87it/s] 55%|█████▍    | 12/22 [00:01<00:00, 10.80it/s] 64%|██████▎   | 14/22 [00:01<00:00, 10.43it/s] 73%|███████▎  | 16/22 [00:01<00:00, 10.26it/s] 82%|████████▏ | 18/22 [00:01<00:00,  9.94it/s] 86%|████████▋ | 19/22 [00:01<00:00,  9.82it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.49it/s] 95%|█████████▌| 21/22 [00:07<00:01,  1.29s/it]100%|██████████| 22/22 [00:08<00:00,  1.17s/it]100%|██████████| 22/22 [00:08<00:00,  2.71it/s]
2025-03-13 18:32:02,733 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:02
2025-03-13 18:33:08,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.8643 secs
2025-03-13 18:33:08,599 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 18:33:08,599 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 18:33:38,853 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2535 secs
2025-03-13 18:33:38,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.2480 secs
2025-03-13 18:33:38,855 [INFO]: {
2025-03-13 18:33:38,855 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:38,855 [INFO]: 	index_param: efSearch=106
2025-03-13 18:33:38,855 [INFO]: 	index_path: knn.index
2025-03-13 18:33:38,855 [INFO]: 	size in bytes: 1015002550
2025-03-13 18:33:38,855 [INFO]: 	avg_search_speed_ms: 7.614944369219363
2025-03-13 18:33:38,855 [INFO]: 	99p_search_speed_ms: 12.948035113513463
2025-03-13 18:33:38,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:38,855 [INFO]: 	nb vectors: 5159
2025-03-13 18:33:38,855 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:38,855 [INFO]: 	compression ratio: 0.999308496318556
2025-03-13 18:33:38,855 [INFO]: }
2025-03-13 18:33:38,855 [INFO]: 	>>> Finished "Creating the index" in 104.2510 secs
2025-03-13 18:33:38,855 [INFO]: >>> Finished "Launching the whole pipeline" in 104.5199 secs
2025-03-13 18:33:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 75280 [episode count 1/20]
[retrieval_preprocessing] for episode 50720 [episode count 2/20], we have num_retrieval=np.int64(5149) num_query=np.int64(173)
2025-03-13 18:33:40,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:41,601 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:41
2025-03-13 18:33:41,601 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.84it/s]
2025-03-13 18:33:41,941 [INFO]: There are 5149 embeddings of dim 49152
2025-03-13 18:33:41,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3400 secs
2025-03-13 18:33:41,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:41
2025-03-13 18:33:41,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:41,941 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:33:41,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:41,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:33:41,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:41
2025-03-13 18:33:41,942 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:41,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:33:41,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:41
2025-03-13 18:33:41,942 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:41,942 [INFO]: 	Creating the index 03/13/2025, 18:33:41
2025-03-13 18:33:41,942 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:41
2025-03-13 18:33:41,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:33:41,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:41
2025-03-13 18:33:41,945 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:33:41,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.25it/s]  9%|▉         | 2/22 [00:00<00:02,  6.88it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.63it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.06it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.30it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.45it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.66it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.73it/s] 41%|████      | 9/22 [00:01<00:01,  8.73it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.79it/s] 50%|█████     | 11/22 [00:01<00:01,  8.81it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.94it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.92it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.89it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.74it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.74it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.82it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.80it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.75it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.50it/s] 95%|█████████▌| 21/22 [00:07<00:01,  1.49s/it]100%|██████████| 22/22 [00:07<00:00,  1.33s/it]100%|██████████| 22/22 [00:08<00:00,  2.75it/s]
2025-03-13 18:33:49,951 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:49
2025-03-13 18:34:50,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8536 secs
2025-03-13 18:34:50,807 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 18:34:50,807 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 18:35:18,455 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6484 secs
2025-03-13 18:35:18,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.5109 secs
2025-03-13 18:35:18,456 [INFO]: {
2025-03-13 18:35:18,456 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:18,456 [INFO]: 	index_param: efSearch=123
2025-03-13 18:35:18,456 [INFO]: 	index_path: knn.index
2025-03-13 18:35:18,456 [INFO]: 	size in bytes: 1013035150
2025-03-13 18:35:18,456 [INFO]: 	avg_search_speed_ms: 8.273044833913445
2025-03-13 18:35:18,456 [INFO]: 	99p_search_speed_ms: 12.53752286545934
2025-03-13 18:35:18,456 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:18,456 [INFO]: 	nb vectors: 5149
2025-03-13 18:35:18,456 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:18,456 [INFO]: 	compression ratio: 0.999308456374885
2025-03-13 18:35:18,456 [INFO]: }
2025-03-13 18:35:18,456 [INFO]: 	>>> Finished "Creating the index" in 96.5137 secs
2025-03-13 18:35:18,456 [INFO]: >>> Finished "Launching the whole pipeline" in 96.8550 secs
2025-03-13 18:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 50720 [episode count 2/20]
[retrieval_preprocessing] for episode 35384 [episode count 3/20], we have num_retrieval=np.int64(4911) num_query=np.int64(411)
2025-03-13 18:35:21,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:22,276 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:22
2025-03-13 18:35:22,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 18:35:22,307 [INFO]: There are 4911 embeddings of dim 49152
2025-03-13 18:35:22,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 18:35:22,308 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:22
2025-03-13 18:35:22,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:22,308 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:35:22,308 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:22,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:35:22,308 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:22
2025-03-13 18:35:22,309 [INFO]: 1013.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:22,309 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:35:22,309 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:22
2025-03-13 18:35:22,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:22,309 [INFO]: 	Creating the index 03/13/2025, 18:35:22
2025-03-13 18:35:22,309 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:22
2025-03-13 18:35:22,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:35:22,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:22
2025-03-13 18:35:22,313 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:35:22,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.88it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.04it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.01it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.54it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.84it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.62it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.09it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.38it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.09it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.66it/s]100%|██████████| 20/20 [00:06<00:00,  3.02it/s]
2025-03-13 18:35:28,934 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:28
2025-03-13 18:36:21,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4146 secs
2025-03-13 18:36:21,349 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:36:21,349 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 18:36:46,801 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4522 secs
2025-03-13 18:36:46,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.4917 secs
2025-03-13 18:36:46,805 [INFO]: {
2025-03-13 18:36:46,805 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:46,805 [INFO]: 	index_param: efSearch=147
2025-03-13 18:36:46,805 [INFO]: 	index_path: knn.index
2025-03-13 18:36:46,805 [INFO]: 	size in bytes: 966209770
2025-03-13 18:36:46,805 [INFO]: 	avg_search_speed_ms: 11.171716692540066
2025-03-13 18:36:46,805 [INFO]: 	99p_search_speed_ms: 15.643731104210003
2025-03-13 18:36:46,805 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:46,805 [INFO]: 	nb vectors: 4911
2025-03-13 18:36:46,805 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:46,805 [INFO]: 	compression ratio: 0.9993087608708408
2025-03-13 18:36:46,805 [INFO]: }
2025-03-13 18:36:46,805 [INFO]: 	>>> Finished "Creating the index" in 84.4960 secs
2025-03-13 18:36:46,805 [INFO]: >>> Finished "Launching the whole pipeline" in 84.5288 secs
2025-03-13 18:36:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 35384 [episode count 3/20]
[retrieval_preprocessing] for episode 46667 [episode count 4/20], we have num_retrieval=np.int64(4947) num_query=np.int64(375)
2025-03-13 18:36:51,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:51,903 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:51
2025-03-13 18:36:51,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.80it/s]
2025-03-13 18:36:51,929 [INFO]: There are 4947 embeddings of dim 49152
2025-03-13 18:36:51,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:36:51,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:51
2025-03-13 18:36:51,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:51,930 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:36:51,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:51,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:36:51,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:51
2025-03-13 18:36:51,931 [INFO]: 1020.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:51,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:36:51,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:51
2025-03-13 18:36:51,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:51,932 [INFO]: 	Creating the index 03/13/2025, 18:36:51
2025-03-13 18:36:51,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:51
2025-03-13 18:36:51,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:36:51,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:51
2025-03-13 18:36:51,935 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:36:51,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.28it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.81it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.81it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.43it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.58it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.83it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.81it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.76it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.95it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.76it/s]100%|██████████| 20/20 [00:06<00:00,  2.95it/s]
2025-03-13 18:36:58,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:58
2025-03-13 18:37:55,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1717 secs
2025-03-13 18:37:55,894 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 18:37:55,894 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 18:38:40,101 [INFO]: 	>>> Finished "Compute fast metrics" in 44.2066 secs
2025-03-13 18:38:40,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.1691 secs
2025-03-13 18:38:40,104 [INFO]: {
2025-03-13 18:38:40,104 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:40,105 [INFO]: 	index_param: efSearch=131
2025-03-13 18:38:40,105 [INFO]: 	index_path: knn.index
2025-03-13 18:38:40,105 [INFO]: 	size in bytes: 973292710
2025-03-13 18:38:40,105 [INFO]: 	avg_search_speed_ms: 9.58862023165562
2025-03-13 18:38:40,105 [INFO]: 	99p_search_speed_ms: 16.699702483601847
2025-03-13 18:38:40,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:40,105 [INFO]: 	nb vectors: 4947
2025-03-13 18:38:40,105 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:40,105 [INFO]: 	compression ratio: 0.9993086005956009
2025-03-13 18:38:40,105 [INFO]: }
2025-03-13 18:38:40,105 [INFO]: 	>>> Finished "Creating the index" in 108.1726 secs
2025-03-13 18:38:40,105 [INFO]: >>> Finished "Launching the whole pipeline" in 108.2013 secs
2025-03-13 18:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 46667 [episode count 4/20]
[retrieval_preprocessing] for episode 65640 [episode count 5/20], we have num_retrieval=np.int64(5043) num_query=np.int64(279)
2025-03-13 18:38:43,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:44,485 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:44
2025-03-13 18:38:44,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.95it/s]
2025-03-13 18:38:44,517 [INFO]: There are 5043 embeddings of dim 49152
2025-03-13 18:38:44,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 18:38:44,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:44
2025-03-13 18:38:44,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:44,517 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:38:44,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:44,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:38:44,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:44
2025-03-13 18:38:44,518 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:44,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:38:44,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:44
2025-03-13 18:38:44,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:44,518 [INFO]: 	Creating the index 03/13/2025, 18:38:44
2025-03-13 18:38:44,518 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:44
2025-03-13 18:38:44,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:38:44,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:44
2025-03-13 18:38:44,519 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:38:44,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.42it/s] 30%|███       | 6/20 [00:00<00:00, 29.10it/s] 60%|██████    | 12/20 [00:00<00:00, 38.94it/s] 90%|█████████ | 18/20 [00:00<00:00, 43.83it/s]100%|██████████| 20/20 [00:04<00:00,  4.34it/s]
2025-03-13 18:38:49,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:49
2025-03-13 18:40:01,297 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.1689 secs
2025-03-13 18:40:01,297 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 18:40:01,297 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 18:40:28,499 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2016 secs
2025-03-13 18:40:28,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1007 secs
2025-03-13 18:40:28,620 [INFO]: {
2025-03-13 18:40:28,621 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:28,621 [INFO]: 	index_param: efSearch=129
2025-03-13 18:40:28,621 [INFO]: 	index_path: knn.index
2025-03-13 18:40:28,621 [INFO]: 	size in bytes: 992180290
2025-03-13 18:40:28,621 [INFO]: 	avg_search_speed_ms: 9.191835661006147
2025-03-13 18:40:28,621 [INFO]: 	99p_search_speed_ms: 13.760502936784107
2025-03-13 18:40:28,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:28,621 [INFO]: 	nb vectors: 5043
2025-03-13 18:40:28,621 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:28,621 [INFO]: 	compression ratio: 0.9993084462502274
2025-03-13 18:40:28,621 [INFO]: }
2025-03-13 18:40:28,621 [INFO]: 	>>> Finished "Creating the index" in 104.1033 secs
2025-03-13 18:40:28,621 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1361 secs
2025-03-13 18:40:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 65640 [episode count 5/20]
[retrieval_preprocessing] for episode 66664 [episode count 6/20], we have num_retrieval=np.int64(5144) num_query=np.int64(178)
2025-03-13 18:40:31,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:31,866 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:31
2025-03-13 18:40:31,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.82it/s]
2025-03-13 18:40:31,893 [INFO]: There are 5144 embeddings of dim 49152
2025-03-13 18:40:31,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:40:31,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:31,893 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:40:31,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:31,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:40:31,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,894 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:31,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:40:31,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:31
2025-03-13 18:40:31,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:31,894 [INFO]: 	Creating the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:31
2025-03-13 18:40:31,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:40:31,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,895 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:40:31,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.92it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.87it/s] 50%|█████     | 11/22 [00:00<00:00, 38.37it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.56it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.57it/s]100%|██████████| 22/22 [00:05<00:00,  3.67it/s]
2025-03-13 18:40:37,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:37
2025-03-13 18:41:33,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.4965 secs
2025-03-13 18:41:33,392 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 18:41:33,392 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 18:42:04,223 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8312 secs
2025-03-13 18:42:04,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.3288 secs
2025-03-13 18:42:04,224 [INFO]: {
2025-03-13 18:42:04,224 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:04,224 [INFO]: 	index_param: efSearch=138
2025-03-13 18:42:04,224 [INFO]: 	index_path: knn.index
2025-03-13 18:42:04,224 [INFO]: 	size in bytes: 1012051390
2025-03-13 18:42:04,224 [INFO]: 	avg_search_speed_ms: 9.283654899150479
2025-03-13 18:42:04,224 [INFO]: 	99p_search_speed_ms: 13.840414974838497
2025-03-13 18:42:04,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:04,224 [INFO]: 	nb vectors: 5144
2025-03-13 18:42:04,224 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:04,224 [INFO]: 	compression ratio: 0.9993084955893395
2025-03-13 18:42:04,224 [INFO]: }
2025-03-13 18:42:04,224 [INFO]: 	>>> Finished "Creating the index" in 92.3301 secs
2025-03-13 18:42:04,224 [INFO]: >>> Finished "Launching the whole pipeline" in 92.3581 secs
2025-03-13 18:42:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 66664 [episode count 6/20]
[retrieval_preprocessing] for episode 19072 [episode count 7/20], we have num_retrieval=np.int64(5173) num_query=np.int64(149)
2025-03-13 18:42:05,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:06,734 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:06
2025-03-13 18:42:06,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2116.20it/s]
2025-03-13 18:42:06,760 [INFO]: There are 5173 embeddings of dim 49152
2025-03-13 18:42:06,760 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:42:06,761 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:06
2025-03-13 18:42:06,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:06,761 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:42:06,761 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:06,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:42:06,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:06
2025-03-13 18:42:06,762 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:06,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:42:06,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:06
2025-03-13 18:42:06,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:06,762 [INFO]: 	Creating the index 03/13/2025, 18:42:06
2025-03-13 18:42:06,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:06
2025-03-13 18:42:06,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:42:06,766 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:06
2025-03-13 18:42:06,766 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:42:06,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 16.84it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.39it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.66it/s] 77%|███████▋  | 17/22 [00:00<00:00, 43.61it/s]100%|██████████| 22/22 [00:05<00:00,  2.43it/s]100%|██████████| 22/22 [00:05<00:00,  3.89it/s]
2025-03-13 18:42:12,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:12
2025-03-13 18:43:11,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9232 secs
2025-03-13 18:43:11,348 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 18:43:11,348 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-13 18:43:39,982 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6341 secs
2025-03-13 18:43:39,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.2168 secs
2025-03-13 18:43:39,983 [INFO]: {
2025-03-13 18:43:39,983 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:39,983 [INFO]: 	index_param: efSearch=141
2025-03-13 18:43:39,983 [INFO]: 	index_path: knn.index
2025-03-13 18:43:39,983 [INFO]: 	size in bytes: 1017757030
2025-03-13 18:43:39,983 [INFO]: 	avg_search_speed_ms: 8.998329812387537
2025-03-13 18:43:39,983 [INFO]: 	99p_search_speed_ms: 12.405539769679311
2025-03-13 18:43:39,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:39,983 [INFO]: 	nb vectors: 5173
2025-03-13 18:43:39,983 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:39,983 [INFO]: 	compression ratio: 0.9993084341554487
2025-03-13 18:43:39,983 [INFO]: }
2025-03-13 18:43:39,983 [INFO]: 	>>> Finished "Creating the index" in 93.2208 secs
2025-03-13 18:43:39,983 [INFO]: >>> Finished "Launching the whole pipeline" in 93.2499 secs
2025-03-13 18:43:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 19072 [episode count 7/20]
[retrieval_preprocessing] for episode 26815 [episode count 8/20], we have num_retrieval=np.int64(5190) num_query=np.int64(132)
2025-03-13 18:43:41,600 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:43,598 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:43
2025-03-13 18:43:43,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.18it/s]
2025-03-13 18:43:43,626 [INFO]: There are 5190 embeddings of dim 49152
2025-03-13 18:43:43,627 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:43:43,627 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:43
2025-03-13 18:43:43,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:43,627 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 18:43:43,627 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:43,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:43:43,627 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:43
2025-03-13 18:43:43,627 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:43,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:43:43,627 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:43
2025-03-13 18:43:43,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:43,627 [INFO]: 	Creating the index 03/13/2025, 18:43:43
2025-03-13 18:43:43,627 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:43
2025-03-13 18:43:43,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:43:43,628 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:43
2025-03-13 18:43:43,628 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 18:43:43,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.81it/s] 27%|██▋       | 6/22 [00:00<00:00, 26.62it/s] 50%|█████     | 11/22 [00:00<00:00, 34.33it/s] 73%|███████▎  | 16/22 [00:00<00:00, 38.06it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.45it/s]100%|██████████| 22/22 [00:06<00:00,  3.38it/s]
2025-03-13 18:43:50,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:50
2025-03-13 18:44:44,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6821 secs
2025-03-13 18:44:44,820 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 18:44:44,820 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 18:45:15,573 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7524 secs
2025-03-13 18:45:15,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.9448 secs
2025-03-13 18:45:15,573 [INFO]: {
2025-03-13 18:45:15,573 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:15,573 [INFO]: 	index_param: efSearch=163
2025-03-13 18:45:15,573 [INFO]: 	index_path: knn.index
2025-03-13 18:45:15,573 [INFO]: 	size in bytes: 1021101790
2025-03-13 18:45:15,573 [INFO]: 	avg_search_speed_ms: 10.098780368718158
2025-03-13 18:45:15,573 [INFO]: 	99p_search_speed_ms: 15.169230783358216
2025-03-13 18:45:15,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:15,574 [INFO]: 	nb vectors: 5190
2025-03-13 18:45:15,574 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:15,574 [INFO]: 	compression ratio: 0.9993083255685998
2025-03-13 18:45:15,574 [INFO]: }
2025-03-13 18:45:15,574 [INFO]: 	>>> Finished "Creating the index" in 91.9462 secs
2025-03-13 18:45:15,574 [INFO]: >>> Finished "Launching the whole pipeline" in 91.9750 secs
2025-03-13 18:45:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 26815 [episode count 8/20]
[retrieval_preprocessing] for episode 52940 [episode count 9/20], we have num_retrieval=np.int64(4982) num_query=np.int64(340)
2025-03-13 18:45:17,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:17,775 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:17
2025-03-13 18:45:17,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.03it/s]
2025-03-13 18:45:17,799 [INFO]: There are 4982 embeddings of dim 49152
2025-03-13 18:45:17,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 18:45:17,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:17,799 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:45:17,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:17,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:17,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,799 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:17,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:45:17,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:17
2025-03-13 18:45:17,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:17,800 [INFO]: 	Creating the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,800 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:17
2025-03-13 18:45:17,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:45:17,801 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,801 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:45:17,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.49it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.53it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.30it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.48it/s]100%|██████████| 20/20 [00:05<00:00,  3.54it/s]
2025-03-13 18:45:23,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:23
2025-03-13 18:46:19,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2458 secs
2025-03-13 18:46:19,692 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 18:46:19,693 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 18:46:59,122 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4294 secs
2025-03-13 18:46:59,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.3249 secs
2025-03-13 18:46:59,126 [INFO]: {
2025-03-13 18:46:59,126 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:59,126 [INFO]: 	index_param: efSearch=149
2025-03-13 18:46:59,126 [INFO]: 	index_path: knn.index
2025-03-13 18:46:59,126 [INFO]: 	size in bytes: 980178670
2025-03-13 18:46:59,126 [INFO]: 	avg_search_speed_ms: 10.217633837523877
2025-03-13 18:46:59,126 [INFO]: 	99p_search_speed_ms: 14.20351441949606
2025-03-13 18:46:59,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:59,126 [INFO]: 	nb vectors: 4982
2025-03-13 18:46:59,126 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:59,126 [INFO]: 	compression ratio: 0.9993086831812
2025-03-13 18:46:59,126 [INFO]: }
2025-03-13 18:46:59,126 [INFO]: 	>>> Finished "Creating the index" in 101.3265 secs
2025-03-13 18:46:59,126 [INFO]: >>> Finished "Launching the whole pipeline" in 101.3513 secs
2025-03-13 18:47:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 52940 [episode count 9/20]
[retrieval_preprocessing] for episode 46297 [episode count 10/20], we have num_retrieval=np.int64(5183) num_query=np.int64(139)
2025-03-13 18:47:03,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:04,257 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:04
2025-03-13 18:47:04,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-13 18:47:04,287 [INFO]: There are 5183 embeddings of dim 49152
2025-03-13 18:47:04,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 18:47:04,287 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:04,288 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:47:04,288 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:04,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:04,288 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,288 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:04,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:47:04,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:04
2025-03-13 18:47:04,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:04,288 [INFO]: 	Creating the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:04
2025-03-13 18:47:04,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 18:47:04,290 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,290 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:47:04,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.70it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.46it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.74it/s] 82%|████████▏ | 18/22 [00:00<00:00, 44.72it/s]100%|██████████| 22/22 [00:05<00:00,  3.78it/s]
2025-03-13 18:47:10,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:10
2025-03-13 18:48:04,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1242 secs
2025-03-13 18:48:04,233 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 18:48:04,233 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 18:48:27,555 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3225 secs
2025-03-13 18:48:27,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.2657 secs
2025-03-13 18:48:27,556 [INFO]: {
2025-03-13 18:48:27,556 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:27,556 [INFO]: 	index_param: efSearch=125
2025-03-13 18:48:27,556 [INFO]: 	index_path: knn.index
2025-03-13 18:48:27,556 [INFO]: 	size in bytes: 1019724490
2025-03-13 18:48:27,556 [INFO]: 	avg_search_speed_ms: 9.352932343916345
2025-03-13 18:48:27,556 [INFO]: 	99p_search_speed_ms: 13.111013071611524
2025-03-13 18:48:27,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:27,556 [INFO]: 	nb vectors: 5183
2025-03-13 18:48:27,556 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:27,556 [INFO]: 	compression ratio: 0.9993084151582944
2025-03-13 18:48:27,556 [INFO]: }
2025-03-13 18:48:27,556 [INFO]: 	>>> Finished "Creating the index" in 83.2679 secs
2025-03-13 18:48:27,556 [INFO]: >>> Finished "Launching the whole pipeline" in 83.2991 secs
2025-03-13 18:48:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 46297 [episode count 10/20]
[retrieval_preprocessing] for episode 29409 [episode count 11/20], we have num_retrieval=np.int64(5097) num_query=np.int64(225)
2025-03-13 18:48:29,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:29,767 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:29
2025-03-13 18:48:29,767 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 18:48:29,800 [INFO]: There are 5097 embeddings of dim 49152
2025-03-13 18:48:29,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 18:48:29,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:29
2025-03-13 18:48:29,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:29,801 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:48:29,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:29,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:48:29,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:29
2025-03-13 18:48:29,802 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:29,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:48:29,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:29
2025-03-13 18:48:29,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:29,802 [INFO]: 	Creating the index 03/13/2025, 18:48:29
2025-03-13 18:48:29,803 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:29
2025-03-13 18:48:29,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:48:29,806 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:29
2025-03-13 18:48:29,806 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:48:29,806 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.02it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.05it/s] 59%|█████▉    | 13/22 [00:00<00:00, 43.96it/s] 86%|████████▋ | 19/22 [00:00<00:00, 48.86it/s]100%|██████████| 22/22 [00:05<00:00,  3.87it/s]
2025-03-13 18:48:35,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:35
2025-03-13 18:49:24,707 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2130 secs
2025-03-13 18:49:24,708 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 18:49:24,708 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 18:50:01,067 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3592 secs
2025-03-13 18:50:01,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2616 secs
2025-03-13 18:50:01,069 [INFO]: {
2025-03-13 18:50:01,069 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:01,069 [INFO]: 	index_param: efSearch=155
2025-03-13 18:50:01,069 [INFO]: 	index_path: knn.index
2025-03-13 18:50:01,069 [INFO]: 	size in bytes: 1002804370
2025-03-13 18:50:01,069 [INFO]: 	avg_search_speed_ms: 11.846516412678417
2025-03-13 18:50:01,069 [INFO]: 	99p_search_speed_ms: 17.25349241634831
2025-03-13 18:50:01,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:01,069 [INFO]: 	nb vectors: 5097
2025-03-13 18:50:01,069 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:01,069 [INFO]: 	compression ratio: 0.9993085450953908
2025-03-13 18:50:01,069 [INFO]: }
2025-03-13 18:50:01,069 [INFO]: 	>>> Finished "Creating the index" in 91.2663 secs
2025-03-13 18:50:01,069 [INFO]: >>> Finished "Launching the whole pipeline" in 91.3022 secs
2025-03-13 18:50:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 29409 [episode count 11/20]
[retrieval_preprocessing] for episode 77574 [episode count 12/20], we have num_retrieval=np.int64(5158) num_query=np.int64(164)
2025-03-13 18:50:03,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:04,416 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:04
2025-03-13 18:50:04,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2049.00it/s]
2025-03-13 18:50:04,445 [INFO]: There are 5158 embeddings of dim 49152
2025-03-13 18:50:04,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:50:04,446 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:04
2025-03-13 18:50:04,446 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:04,446 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:50:04,446 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:04,446 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:04,446 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:04
2025-03-13 18:50:04,446 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:04,446 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:04,446 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:04
2025-03-13 18:50:04,446 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:04,446 [INFO]: 	Creating the index 03/13/2025, 18:50:04
2025-03-13 18:50:04,446 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:04
2025-03-13 18:50:04,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:50:04,447 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:04
2025-03-13 18:50:04,448 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:50:04,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.99it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.09it/s] 50%|█████     | 11/22 [00:00<00:00, 35.03it/s] 73%|███████▎  | 16/22 [00:00<00:00, 38.18it/s] 95%|█████████▌| 21/22 [00:06<00:00,  2.22it/s]100%|██████████| 22/22 [00:06<00:00,  3.21it/s]
2025-03-13 18:50:11,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:11
2025-03-13 18:51:03,901 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5925 secs
2025-03-13 18:51:03,902 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 18:51:03,902 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 18:51:31,208 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3060 secs
2025-03-13 18:51:31,208 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7608 secs
2025-03-13 18:51:31,208 [INFO]: {
2025-03-13 18:51:31,208 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:31,208 [INFO]: 	index_param: efSearch=143
2025-03-13 18:51:31,208 [INFO]: 	index_path: knn.index
2025-03-13 18:51:31,208 [INFO]: 	size in bytes: 1014805810
2025-03-13 18:51:31,208 [INFO]: 	avg_search_speed_ms: 9.358537609456326
2025-03-13 18:51:31,208 [INFO]: 	99p_search_speed_ms: 12.886330066248775
2025-03-13 18:51:31,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:31,208 [INFO]: 	nb vectors: 5158
2025-03-13 18:51:31,208 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:31,208 [INFO]: 	compression ratio: 0.9993084923311584
2025-03-13 18:51:31,209 [INFO]: }
2025-03-13 18:51:31,209 [INFO]: 	>>> Finished "Creating the index" in 86.7623 secs
2025-03-13 18:51:31,209 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7921 secs
2025-03-13 18:51:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 77574 [episode count 12/20]
[retrieval_preprocessing] for episode 53561 [episode count 13/20], we have num_retrieval=np.int64(4768) num_query=np.int64(554)
2025-03-13 18:51:32,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:33,543 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:33
2025-03-13 18:51:33,543 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.31it/s]
2025-03-13 18:51:33,573 [INFO]: There are 4768 embeddings of dim 49152
2025-03-13 18:51:33,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 18:51:33,573 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:33
2025-03-13 18:51:33,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:33,574 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:51:33,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:33,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:51:33,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:33
2025-03-13 18:51:33,575 [INFO]: 984.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:33,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:51:33,575 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:33
2025-03-13 18:51:33,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:33,576 [INFO]: 	Creating the index 03/13/2025, 18:51:33
2025-03-13 18:51:33,576 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:33
2025-03-13 18:51:33,579 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 18:51:33,579 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:33
2025-03-13 18:51:33,579 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:51:33,579 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.13it/s] 42%|████▏     | 8/19 [00:00<00:00, 37.04it/s] 74%|███████▎  | 14/19 [00:00<00:00, 43.33it/s]100%|██████████| 19/19 [00:04<00:00,  3.07it/s]100%|██████████| 19/19 [00:04<00:00,  4.36it/s]
2025-03-13 18:51:37,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:37
2025-03-13 18:52:23,267 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3236 secs
2025-03-13 18:52:23,267 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 18:52:23,267 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.49it/s]
2025-03-13 18:52:51,891 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6240 secs
2025-03-13 18:52:51,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3152 secs
2025-03-13 18:52:51,894 [INFO]: {
2025-03-13 18:52:51,894 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:51,894 [INFO]: 	index_param: efSearch=163
2025-03-13 18:52:51,894 [INFO]: 	index_path: knn.index
2025-03-13 18:52:51,894 [INFO]: 	size in bytes: 938075530
2025-03-13 18:52:51,894 [INFO]: 	avg_search_speed_ms: 10.292544815336726
2025-03-13 18:52:51,894 [INFO]: 	99p_search_speed_ms: 14.641930365469305
2025-03-13 18:52:51,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:51,894 [INFO]: 	nb vectors: 4768
2025-03-13 18:52:51,894 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:51,895 [INFO]: 	compression ratio: 0.9993085993832501
2025-03-13 18:52:51,895 [INFO]: }
2025-03-13 18:52:51,895 [INFO]: 	>>> Finished "Creating the index" in 78.3187 secs
2025-03-13 18:52:51,895 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3518 secs
2025-03-13 18:52:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 53561 [episode count 13/20]
[retrieval_preprocessing] for episode 6973 [episode count 14/20], we have num_retrieval=np.int64(5159) num_query=np.int64(163)
2025-03-13 18:52:56,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:57,448 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:57
2025-03-13 18:52:57,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1027.51it/s]
2025-03-13 18:52:57,477 [INFO]: There are 5159 embeddings of dim 49152
2025-03-13 18:52:57,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:52:57,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:57
2025-03-13 18:52:57,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:57,478 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:52:57,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:57,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:57,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:57
2025-03-13 18:52:57,478 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:57,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:52:57,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:57
2025-03-13 18:52:57,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:57,478 [INFO]: 	Creating the index 03/13/2025, 18:52:57
2025-03-13 18:52:57,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:57
2025-03-13 18:52:57,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:52:57,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:57
2025-03-13 18:52:57,480 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:52:57,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.61it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.86it/s] 50%|█████     | 11/22 [00:00<00:00, 35.43it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.01it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.79it/s]100%|██████████| 22/22 [00:05<00:00,  3.72it/s]
2025-03-13 18:53:03,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:03
2025-03-13 18:54:06,269 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.8706 secs
2025-03-13 18:54:06,269 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 18:54:06,269 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.50it/s]
2025-03-13 18:54:34,525 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2558 secs
2025-03-13 18:54:34,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.0463 secs
2025-03-13 18:54:34,526 [INFO]: {
2025-03-13 18:54:34,526 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:34,526 [INFO]: 	index_param: efSearch=126
2025-03-13 18:54:34,526 [INFO]: 	index_path: knn.index
2025-03-13 18:54:34,526 [INFO]: 	size in bytes: 1015002550
2025-03-13 18:54:34,526 [INFO]: 	avg_search_speed_ms: 10.083762902556167
2025-03-13 18:54:34,526 [INFO]: 	99p_search_speed_ms: 23.89861636795104
2025-03-13 18:54:34,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:34,526 [INFO]: 	nb vectors: 5159
2025-03-13 18:54:34,526 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:34,526 [INFO]: 	compression ratio: 0.999308496318556
2025-03-13 18:54:34,526 [INFO]: }
2025-03-13 18:54:34,526 [INFO]: 	>>> Finished "Creating the index" in 97.0481 secs
2025-03-13 18:54:34,526 [INFO]: >>> Finished "Launching the whole pipeline" in 97.0778 secs
2025-03-13 18:54:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 6973 [episode count 14/20]
[retrieval_preprocessing] for episode 94033 [episode count 15/20], we have num_retrieval=np.int64(4998) num_query=np.int64(324)
2025-03-13 18:54:36,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:36,656 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:36
2025-03-13 18:54:36,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.62it/s]
2025-03-13 18:54:36,682 [INFO]: There are 4998 embeddings of dim 49152
2025-03-13 18:54:36,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:54:36,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:36
2025-03-13 18:54:36,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:36,682 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:54:36,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:36,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:36,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:36
2025-03-13 18:54:36,682 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:36,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:54:36,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:36
2025-03-13 18:54:36,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:36,683 [INFO]: 	Creating the index 03/13/2025, 18:54:36
2025-03-13 18:54:36,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:36
2025-03-13 18:54:36,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:54:36,685 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:36
2025-03-13 18:54:36,685 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:54:36,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.12it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.95it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.05it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.56it/s]100%|██████████| 20/20 [00:04<00:00,  4.25it/s]
2025-03-13 18:54:41,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:41
2025-03-13 18:55:35,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1345 secs
2025-03-13 18:55:35,536 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 18:55:35,536 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 18:55:59,534 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9974 secs
2025-03-13 18:55:59,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8520 secs
2025-03-13 18:55:59,537 [INFO]: {
2025-03-13 18:55:59,537 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:59,537 [INFO]: 	index_param: efSearch=151
2025-03-13 18:55:59,537 [INFO]: 	index_path: knn.index
2025-03-13 18:55:59,537 [INFO]: 	size in bytes: 983326750
2025-03-13 18:55:59,537 [INFO]: 	avg_search_speed_ms: 10.18627610957618
2025-03-13 18:55:59,537 [INFO]: 	99p_search_speed_ms: 14.753964517731182
2025-03-13 18:55:59,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:59,537 [INFO]: 	nb vectors: 4998
2025-03-13 18:55:59,537 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:59,537 [INFO]: 	compression ratio: 0.9993085045230388
2025-03-13 18:55:59,537 [INFO]: }
2025-03-13 18:55:59,537 [INFO]: 	>>> Finished "Creating the index" in 82.8543 secs
2025-03-13 18:55:59,537 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8812 secs
2025-03-13 18:56:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 94033 [episode count 15/20]
[retrieval_preprocessing] for episode 46928 [episode count 16/20], we have num_retrieval=np.int64(4568) num_query=np.int64(754)
2025-03-13 18:56:02,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:02,710 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:02
2025-03-13 18:56:02,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.80it/s]
2025-03-13 18:56:02,736 [INFO]: There are 4568 embeddings of dim 49152
2025-03-13 18:56:02,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:56:02,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:02
2025-03-13 18:56:02,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:02,736 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:56:02,736 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:02,736 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:02,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:02
2025-03-13 18:56:02,736 [INFO]: 942.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:02,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:56:02,737 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:02
2025-03-13 18:56:02,737 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:02,737 [INFO]: 	Creating the index 03/13/2025, 18:56:02
2025-03-13 18:56:02,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:02
2025-03-13 18:56:02,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:56:02,738 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:02
2025-03-13 18:56:02,738 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:56:02,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.78it/s] 39%|███▉      | 7/18 [00:00<00:00, 36.08it/s] 72%|███████▏  | 13/18 [00:00<00:00, 45.57it/s]100%|██████████| 18/18 [00:03<00:00,  3.44it/s]100%|██████████| 18/18 [00:03<00:00,  4.75it/s]
2025-03-13 18:56:06,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:06
2025-03-13 18:56:53,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8579 secs
2025-03-13 18:56:53,392 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 18:56:53,393 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-13 18:57:18,964 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5711 secs
2025-03-13 18:57:18,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2282 secs
2025-03-13 18:57:18,966 [INFO]: {
2025-03-13 18:57:18,966 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:18,966 [INFO]: 	index_param: efSearch=145
2025-03-13 18:57:18,966 [INFO]: 	index_path: knn.index
2025-03-13 18:57:18,966 [INFO]: 	size in bytes: 898726630
2025-03-13 18:57:18,966 [INFO]: 	avg_search_speed_ms: 8.994581574187178
2025-03-13 18:57:18,966 [INFO]: 	99p_search_speed_ms: 14.081787916366025
2025-03-13 18:57:18,967 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:18,967 [INFO]: 	nb vectors: 4568
2025-03-13 18:57:18,967 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:18,967 [INFO]: 	compression ratio: 0.999308704138432
2025-03-13 18:57:18,967 [INFO]: }
2025-03-13 18:57:18,967 [INFO]: 	>>> Finished "Creating the index" in 76.2298 secs
2025-03-13 18:57:18,967 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2565 secs
2025-03-13 18:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 46928 [episode count 16/20]
[retrieval_preprocessing] for episode 87029 [episode count 17/20], we have num_retrieval=np.int64(5180) num_query=np.int64(142)
2025-03-13 18:57:24,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:25,595 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:25
2025-03-13 18:57:25,595 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.83it/s]
2025-03-13 18:57:25,619 [INFO]: There are 5180 embeddings of dim 49152
2025-03-13 18:57:25,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:57:25,619 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:25
2025-03-13 18:57:25,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:25,619 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:57:25,619 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:25,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:57:25,619 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:25
2025-03-13 18:57:25,620 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:25,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:57:25,620 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:25
2025-03-13 18:57:25,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:25,620 [INFO]: 	Creating the index 03/13/2025, 18:57:25
2025-03-13 18:57:25,620 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:25
2025-03-13 18:57:25,621 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:57:25,621 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:25
2025-03-13 18:57:25,621 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:57:25,621 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.64it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.55it/s] 50%|█████     | 11/22 [00:00<00:00, 37.96it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.49it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.69it/s]100%|██████████| 22/22 [00:05<00:00,  3.74it/s]
2025-03-13 18:57:31,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:31
2025-03-13 18:58:30,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8084 secs
2025-03-13 18:58:30,322 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 18:58:30,322 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 18:59:03,620 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2981 secs
2025-03-13 18:59:03,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.9992 secs
2025-03-13 18:59:03,621 [INFO]: {
2025-03-13 18:59:03,621 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:03,621 [INFO]: 	index_param: efSearch=146
2025-03-13 18:59:03,621 [INFO]: 	index_path: knn.index
2025-03-13 18:59:03,621 [INFO]: 	size in bytes: 1019134210
2025-03-13 18:59:03,621 [INFO]: 	avg_search_speed_ms: 10.02757437760711
2025-03-13 18:59:03,621 [INFO]: 	99p_search_speed_ms: 13.85795732028782
2025-03-13 18:59:03,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:03,621 [INFO]: 	nb vectors: 5180
2025-03-13 18:59:03,621 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:03,621 [INFO]: 	compression ratio: 0.9993084620326895
2025-03-13 18:59:03,621 [INFO]: }
2025-03-13 18:59:03,621 [INFO]: 	>>> Finished "Creating the index" in 98.0010 secs
2025-03-13 18:59:03,621 [INFO]: >>> Finished "Launching the whole pipeline" in 98.0259 secs
2025-03-13 18:59:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 87029 [episode count 17/20]
[retrieval_preprocessing] for episode 10231 [episode count 18/20], we have num_retrieval=np.int64(5184) num_query=np.int64(138)
2025-03-13 18:59:05,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:06,082 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:06
2025-03-13 18:59:06,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-13 18:59:06,107 [INFO]: There are 5184 embeddings of dim 49152
2025-03-13 18:59:06,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:59:06,108 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:06,108 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 18:59:06,108 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:06,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:06,108 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,108 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:06,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:59:06,108 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:06
2025-03-13 18:59:06,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:06,108 [INFO]: 	Creating the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,108 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:06
2025-03-13 18:59:06,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:59:06,110 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,110 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:59:06,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.96it/s] 27%|██▋       | 6/22 [00:00<00:00, 32.98it/s] 55%|█████▍    | 12/22 [00:00<00:00, 41.83it/s] 77%|███████▋  | 17/22 [00:00<00:00, 42.76it/s]100%|██████████| 22/22 [00:06<00:00,  2.20it/s]100%|██████████| 22/22 [00:06<00:00,  3.48it/s]
2025-03-13 18:59:12,548 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:12
2025-03-13 19:00:06,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1312 secs
2025-03-13 19:00:06,679 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 19:00:06,679 [INFO]: 	Compute fast metrics 03/13/2025, 19:00:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 19:00:38,661 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9815 secs
2025-03-13 19:00:38,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.5520 secs
2025-03-13 19:00:38,662 [INFO]: {
2025-03-13 19:00:38,662 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:38,662 [INFO]: 	index_param: efSearch=162
2025-03-13 19:00:38,662 [INFO]: 	index_path: knn.index
2025-03-13 19:00:38,662 [INFO]: 	size in bytes: 1019921290
2025-03-13 19:00:38,662 [INFO]: 	avg_search_speed_ms: 11.771668773418401
2025-03-13 19:00:38,662 [INFO]: 	99p_search_speed_ms: 15.851323097012937
2025-03-13 19:00:38,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:38,662 [INFO]: 	nb vectors: 5184
2025-03-13 19:00:38,662 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:38,662 [INFO]: 	compression ratio: 0.9993083603539642
2025-03-13 19:00:38,662 [INFO]: }
2025-03-13 19:00:38,662 [INFO]: 	>>> Finished "Creating the index" in 92.5536 secs
2025-03-13 19:00:38,662 [INFO]: >>> Finished "Launching the whole pipeline" in 92.5803 secs
2025-03-13 19:00:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 10231 [episode count 18/20]
[retrieval_preprocessing] for episode 35313 [episode count 19/20], we have num_retrieval=np.int64(4958) num_query=np.int64(364)
2025-03-13 19:00:40,333 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:41,075 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:41
2025-03-13 19:00:41,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.76it/s]
2025-03-13 19:00:41,102 [INFO]: There are 4958 embeddings of dim 49152
2025-03-13 19:00:41,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:00:41,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:41
2025-03-13 19:00:41,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:41,102 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 19:00:41,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:41,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:41,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:41
2025-03-13 19:00:41,102 [INFO]: 1023.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:41,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:41,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:41
2025-03-13 19:00:41,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:41,102 [INFO]: 	Creating the index 03/13/2025, 19:00:41
2025-03-13 19:00:41,102 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:41
2025-03-13 19:00:41,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:00:41,103 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:41
2025-03-13 19:00:41,103 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:00:41,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.55it/s] 30%|███       | 6/20 [00:00<00:00, 27.49it/s] 55%|█████▌    | 11/20 [00:00<00:00, 34.88it/s] 80%|████████  | 16/20 [00:00<00:00, 38.36it/s]100%|██████████| 20/20 [00:04<00:00,  2.68it/s]100%|██████████| 20/20 [00:04<00:00,  4.25it/s]
2025-03-13 19:00:45,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:45
2025-03-13 19:01:39,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1113 secs
2025-03-13 19:01:39,930 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 19:01:39,930 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.60it/s]
2025-03-13 19:02:14,733 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8021 secs
2025-03-13 19:02:14,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.6319 secs
2025-03-13 19:02:14,736 [INFO]: {
2025-03-13 19:02:14,736 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:14,736 [INFO]: 	index_param: efSearch=142
2025-03-13 19:02:14,736 [INFO]: 	index_path: knn.index
2025-03-13 19:02:14,736 [INFO]: 	size in bytes: 975456850
2025-03-13 19:02:14,736 [INFO]: 	avg_search_speed_ms: 9.154377738652922
2025-03-13 19:02:14,736 [INFO]: 	99p_search_speed_ms: 12.818867452442646
2025-03-13 19:02:14,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:14,736 [INFO]: 	nb vectors: 4958
2025-03-13 19:02:14,736 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:14,736 [INFO]: 	compression ratio: 0.999308645994951
2025-03-13 19:02:14,736 [INFO]: }
2025-03-13 19:02:14,736 [INFO]: 	>>> Finished "Creating the index" in 93.6334 secs
2025-03-13 19:02:14,736 [INFO]: >>> Finished "Launching the whole pipeline" in 93.6606 secs
2025-03-13 19:02:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 35313 [episode count 19/20]
2025-03-13 19:02:17: [retrieval_preprocessing] finished for 4706041793_hang_cloth_on_stand [chosen_id count 8/196]
2025-03-13 19:02:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4743066113_push_table_items_left_with_towel [chosen_id count 9/196]
2025-03-13 19:02:21: [retrieval_preprocessing] we have num_total=10446 embedding_dim=49152
[retrieval_preprocessing] for episode 79416 [episode count 0/20], we have num_retrieval=np.int64(10045) num_query=np.int64(401)
2025-03-13 19:02:21,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:23,710 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:23
2025-03-13 19:02:23,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1015.57it/s]
2025-03-13 19:02:23,739 [INFO]: There are 10045 embeddings of dim 49152
2025-03-13 19:02:23,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 19:02:23,739 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:23
2025-03-13 19:02:23,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:23,739 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:02:23,739 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:02:23,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:02:23,739 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:23
2025-03-13 19:02:23,739 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:23,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:02:23,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:23
2025-03-13 19:02:23,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:23,740 [INFO]: 	Creating the index 03/13/2025, 19:02:23
2025-03-13 19:02:23,740 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:02:23
2025-03-13 19:02:23,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 19:02:23,741 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:23
2025-03-13 19:02:23,741 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:02:23,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.05it/s] 10%|▉         | 4/41 [00:00<00:02, 15.94it/s] 20%|█▉        | 8/41 [00:00<00:01, 24.00it/s] 29%|██▉       | 12/41 [00:00<00:01, 28.46it/s] 39%|███▉      | 16/41 [00:00<00:00, 31.06it/s] 49%|████▉     | 20/41 [00:00<00:00, 32.85it/s] 59%|█████▊    | 24/41 [00:08<00:12,  1.39it/s] 73%|███████▎  | 30/41 [00:09<00:04,  2.35it/s] 88%|████████▊ | 36/41 [00:09<00:01,  3.68it/s]100%|██████████| 41/41 [00:19<00:00,  1.25it/s]100%|██████████| 41/41 [00:19<00:00,  2.15it/s]
2025-03-13 19:02:42,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:42
2025-03-13 19:04:27,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 104.4569 secs
2025-03-13 19:04:27,284 [INFO]: The best hyperparameters are: efSearch=67
2025-03-13 19:04:27,285 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-13 19:05:04,082 [INFO]: 	>>> Finished "Compute fast metrics" in 36.7975 secs
2025-03-13 19:05:04,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.3440 secs
2025-03-13 19:05:04,085 [INFO]: {
2025-03-13 19:05:04,086 [INFO]: 	index_key: HNSW32
2025-03-13 19:05:04,086 [INFO]: 	index_param: efSearch=67
2025-03-13 19:05:04,086 [INFO]: 	index_path: knn.index
2025-03-13 19:05:04,086 [INFO]: 	size in bytes: 1977657406
2025-03-13 19:05:04,086 [INFO]: 	avg_search_speed_ms: 11.578451656397966
2025-03-13 19:05:04,086 [INFO]: 	99p_search_speed_ms: 19.520539841614667
2025-03-13 19:05:04,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:05:04,086 [INFO]: 	nb vectors: 10045
2025-03-13 19:05:04,086 [INFO]: 	vectors dimension: 49152
2025-03-13 19:05:04,086 [INFO]: 	compression ratio: 0.9986195556461309
2025-03-13 19:05:04,086 [INFO]: }
2025-03-13 19:05:04,086 [INFO]: 	>>> Finished "Creating the index" in 160.3460 secs
2025-03-13 19:05:04,086 [INFO]: >>> Finished "Launching the whole pipeline" in 160.3758 secs
2025-03-13 19:05:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 79416 [episode count 0/20]
[retrieval_preprocessing] for episode 94245 [episode count 1/20], we have num_retrieval=np.int64(10002) num_query=np.int64(444)
2025-03-13 19:05:09,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:10,603 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:10
2025-03-13 19:05:10,603 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.75it/s]
2025-03-13 19:05:10,630 [INFO]: There are 10002 embeddings of dim 49152
2025-03-13 19:05:10,630 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 19:05:10,630 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:10
2025-03-13 19:05:10,630 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:10,631 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:05:10,631 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:05:10,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:05:10,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:10
2025-03-13 19:05:10,631 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:10,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:05:10,632 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:10
2025-03-13 19:05:10,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 19:05:10,632 [INFO]: 	Creating the index 03/13/2025, 19:05:10
2025-03-13 19:05:10,632 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:05:10
2025-03-13 19:05:10,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 19:05:10,635 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:10
2025-03-13 19:05:10,635 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:05:10,636 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.16it/s] 12%|█▏        | 5/41 [00:00<00:01, 23.74it/s] 24%|██▍       | 10/41 [00:00<00:00, 31.49it/s] 34%|███▍      | 14/41 [00:00<00:00, 34.44it/s] 44%|████▍     | 18/41 [00:00<00:00, 36.17it/s] 54%|█████▎    | 22/41 [00:08<00:13,  1.44it/s] 61%|██████    | 25/41 [00:08<00:08,  1.88it/s] 66%|██████▌   | 27/41 [00:08<00:06,  2.26it/s] 71%|███████   | 29/41 [00:09<00:04,  2.75it/s] 76%|███████▌  | 31/41 [00:09<00:02,  3.35it/s] 80%|████████  | 33/41 [00:09<00:01,  4.06it/s] 85%|████████▌ | 35/41 [00:09<00:01,  4.88it/s] 90%|█████████ | 37/41 [00:09<00:00,  5.72it/s] 95%|█████████▌| 39/41 [00:09<00:00,  6.75it/s]100%|██████████| 41/41 [00:20<00:00,  1.58s/it]100%|██████████| 41/41 [00:20<00:00,  2.03it/s]
2025-03-13 19:05:30,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:30
2025-03-13 19:07:13,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.9575 secs
2025-03-13 19:07:13,785 [INFO]: The best hyperparameters are: efSearch=71
2025-03-13 19:07:13,785 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 19:08:15,391 [INFO]: 	>>> Finished "Compute fast metrics" in 61.6056 secs
2025-03-13 19:08:16,360 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 185.7243 secs
2025-03-13 19:08:16,360 [INFO]: {
2025-03-13 19:08:16,360 [INFO]: 	index_key: HNSW32
2025-03-13 19:08:16,360 [INFO]: 	index_param: efSearch=71
2025-03-13 19:08:16,360 [INFO]: 	index_path: knn.index
2025-03-13 19:08:16,360 [INFO]: 	size in bytes: 1969191610
2025-03-13 19:08:16,360 [INFO]: 	avg_search_speed_ms: 10.77843724939659
2025-03-13 19:08:16,360 [INFO]: 	99p_search_speed_ms: 18.747767661698163
2025-03-13 19:08:16,360 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:16,361 [INFO]: 	nb vectors: 10002
2025-03-13 19:08:16,361 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:16,361 [INFO]: 	compression ratio: 0.9986195380956351
2025-03-13 19:08:16,361 [INFO]: }
2025-03-13 19:08:16,361 [INFO]: 	>>> Finished "Creating the index" in 185.7286 secs
2025-03-13 19:08:16,361 [INFO]: >>> Finished "Launching the whole pipeline" in 185.7578 secs
2025-03-13 19:08:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 94245 [episode count 1/20]
[retrieval_preprocessing] for episode 91706 [episode count 2/20], we have num_retrieval=np.int64(10114) num_query=np.int64(332)
2025-03-13 19:08:22,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:24,191 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:24
2025-03-13 19:08:24,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.07it/s]
2025-03-13 19:08:24,219 [INFO]: There are 10114 embeddings of dim 49152
2025-03-13 19:08:24,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 19:08:24,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:24
2025-03-13 19:08:24,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:24,219 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 19:08:24,219 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:08:24,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:24,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:24
2025-03-13 19:08:24,220 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:24,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:24,220 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:24
2025-03-13 19:08:24,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:24,220 [INFO]: 	Creating the index 03/13/2025, 19:08:24
2025-03-13 19:08:24,220 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:08:24
2025-03-13 19:08:24,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 19:08:24,221 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:24
2025-03-13 19:08:24,221 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 19:08:24,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.06it/s]  7%|▋         | 3/41 [00:00<00:04,  8.55it/s] 12%|█▏        | 5/41 [00:00<00:03, 10.22it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.77it/s] 22%|██▏       | 9/41 [00:00<00:02, 10.99it/s] 27%|██▋       | 11/41 [00:01<00:02, 11.11it/s] 32%|███▏      | 13/41 [00:01<00:02, 11.24it/s] 37%|███▋      | 15/41 [00:01<00:02, 11.40it/s] 41%|████▏     | 17/41 [00:01<00:02, 11.53it/s] 46%|████▋     | 19/41 [00:01<00:01, 12.37it/s] 51%|█████     | 21/41 [00:08<00:22,  1.13s/it] 56%|█████▌    | 23/41 [00:08<00:14,  1.24it/s] 61%|██████    | 25/41 [00:09<00:09,  1.70it/s] 66%|██████▌   | 27/41 [00:09<00:06,  2.30it/s] 71%|███████   | 29/41 [00:09<00:03,  3.02it/s] 76%|███████▌  | 31/41 [00:09<00:02,  3.89it/s] 80%|████████  | 33/41 [00:09<00:01,  4.90it/s] 85%|████████▌ | 35/41 [00:09<00:00,  6.03it/s] 90%|█████████ | 37/41 [00:09<00:00,  7.27it/s] 95%|█████████▌| 39/41 [00:10<00:00,  8.48it/s]100%|██████████| 41/41 [00:17<00:00,  1.26s/it]100%|██████████| 41/41 [00:17<00:00,  2.28it/s]
2025-03-13 19:08:42,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:42
2025-03-13 19:09:52,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.1784 secs
2025-03-13 19:09:52,381 [INFO]: The best hyperparameters are: efSearch=76
2025-03-13 19:09:52,381 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 19:10:36,931 [INFO]: 	>>> Finished "Compute fast metrics" in 44.5499 secs
2025-03-13 19:10:36,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.7126 secs
2025-03-13 19:10:36,934 [INFO]: {
2025-03-13 19:10:36,934 [INFO]: 	index_key: HNSW32
2025-03-13 19:10:36,934 [INFO]: 	index_param: efSearch=76
2025-03-13 19:10:36,934 [INFO]: 	index_path: knn.index
2025-03-13 19:10:36,934 [INFO]: 	size in bytes: 1991242234
2025-03-13 19:10:36,934 [INFO]: 	avg_search_speed_ms: 11.39866536856972
2025-03-13 19:10:36,934 [INFO]: 	99p_search_speed_ms: 19.33515198528767
2025-03-13 19:10:36,934 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:36,934 [INFO]: 	nb vectors: 10114
2025-03-13 19:10:36,934 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:36,934 [INFO]: 	compression ratio: 0.9986194939254186
2025-03-13 19:10:36,934 [INFO]: }
2025-03-13 19:10:36,934 [INFO]: 	>>> Finished "Creating the index" in 132.7145 secs
2025-03-13 19:10:36,934 [INFO]: >>> Finished "Launching the whole pipeline" in 132.7436 secs
2025-03-13 19:10:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 91706 [episode count 2/20]
[retrieval_preprocessing] for episode 39494 [episode count 3/20], we have num_retrieval=np.int64(9982) num_query=np.int64(464)
2025-03-13 19:10:42,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:43,784 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:43
2025-03-13 19:10:43,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2396.75it/s]
2025-03-13 19:10:43,807 [INFO]: There are 9982 embeddings of dim 49152
2025-03-13 19:10:43,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 19:10:43,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:43
2025-03-13 19:10:43,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:43,808 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:10:43,808 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:10:43,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:43,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:43
2025-03-13 19:10:43,808 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:43,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:10:43,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:43
2025-03-13 19:10:43,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:43,808 [INFO]: 	Creating the index 03/13/2025, 19:10:43
2025-03-13 19:10:43,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:43
2025-03-13 19:10:43,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:10:43,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:43
2025-03-13 19:10:43,809 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:10:43,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.01it/s]  7%|▋         | 3/41 [00:00<00:03, 10.15it/s] 12%|█▏        | 5/41 [00:00<00:02, 12.98it/s] 17%|█▋        | 7/41 [00:00<00:02, 14.28it/s] 22%|██▏       | 9/41 [00:00<00:02, 14.29it/s] 27%|██▋       | 11/41 [00:00<00:02, 13.60it/s] 32%|███▏      | 13/41 [00:01<00:02, 13.21it/s] 37%|███▋      | 15/41 [00:01<00:01, 13.46it/s] 41%|████▏     | 17/41 [00:01<00:01, 13.38it/s] 46%|████▋     | 19/41 [00:01<00:01, 13.06it/s] 51%|█████     | 21/41 [00:06<00:17,  1.15it/s] 59%|█████▊    | 24/41 [00:06<00:09,  1.84it/s] 66%|██████▌   | 27/41 [00:07<00:05,  2.77it/s] 73%|███████▎  | 30/41 [00:07<00:02,  3.97it/s] 80%|████████  | 33/41 [00:07<00:01,  5.47it/s] 88%|████████▊ | 36/41 [00:07<00:00,  7.28it/s] 95%|█████████▌| 39/41 [00:07<00:00,  9.38it/s]100%|██████████| 41/41 [00:14<00:00,  2.91it/s]
2025-03-13 19:10:57,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:57
2025-03-13 19:12:34,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.5632 secs
2025-03-13 19:12:34,469 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 19:12:34,469 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-13 19:13:07,047 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5786 secs
2025-03-13 19:13:07,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.2791 secs
2025-03-13 19:13:07,089 [INFO]: {
2025-03-13 19:13:07,089 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:07,089 [INFO]: 	index_param: efSearch=110
2025-03-13 19:13:07,089 [INFO]: 	index_path: knn.index
2025-03-13 19:13:07,089 [INFO]: 	size in bytes: 1963899610
2025-03-13 19:13:07,089 [INFO]: 	avg_search_speed_ms: 9.148315096245048
2025-03-13 19:13:07,089 [INFO]: 	99p_search_speed_ms: 15.689240628853435
2025-03-13 19:13:07,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:07,089 [INFO]: 	nb vectors: 9982
2025-03-13 19:13:07,089 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:07,089 [INFO]: 	compression ratio: 0.9993082365345548
2025-03-13 19:13:07,089 [INFO]: }
2025-03-13 19:13:07,089 [INFO]: 	>>> Finished "Creating the index" in 143.2812 secs
2025-03-13 19:13:07,089 [INFO]: >>> Finished "Launching the whole pipeline" in 143.3048 secs
2025-03-13 19:13:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 39494 [episode count 3/20]
[retrieval_preprocessing] for episode 12367 [episode count 4/20], we have num_retrieval=np.int64(9907) num_query=np.int64(539)
2025-03-13 19:13:10,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:12,591 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:12
2025-03-13 19:13:12,591 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1107.26it/s]
2025-03-13 19:13:12,619 [INFO]: There are 9907 embeddings of dim 49152
2025-03-13 19:13:12,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 19:13:12,619 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:12
2025-03-13 19:13:12,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:12,619 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:13:12,620 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:13:12,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:12,620 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:12
2025-03-13 19:13:12,620 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:12,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:13:12,620 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:12
2025-03-13 19:13:12,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:12,620 [INFO]: 	Creating the index 03/13/2025, 19:13:12
2025-03-13 19:13:12,620 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:12
2025-03-13 19:13:12,621 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:13:12,621 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:12
2025-03-13 19:13:12,621 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:13:12,621 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.33it/s] 15%|█▌        | 6/40 [00:00<00:01, 30.92it/s] 30%|███       | 12/40 [00:00<00:00, 41.00it/s] 45%|████▌     | 18/40 [00:00<00:00, 45.01it/s] 57%|█████▊    | 23/40 [00:05<00:05,  2.95it/s] 72%|███████▎  | 29/40 [00:05<00:02,  4.60it/s] 88%|████████▊ | 35/40 [00:05<00:00,  6.79it/s]100%|██████████| 40/40 [00:10<00:00,  2.39it/s]100%|██████████| 40/40 [00:10<00:00,  3.79it/s]
2025-03-13 19:13:23,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:23
2025-03-13 19:14:34,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.2634 secs
2025-03-13 19:14:34,458 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 19:14:34,458 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 19:15:20,801 [INFO]: 	>>> Finished "Compute fast metrics" in 46.3421 secs
2025-03-13 19:15:20,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.1822 secs
2025-03-13 19:15:20,804 [INFO]: {
2025-03-13 19:15:20,804 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:20,804 [INFO]: 	index_param: efSearch=119
2025-03-13 19:15:20,804 [INFO]: 	index_path: knn.index
2025-03-13 19:15:20,804 [INFO]: 	size in bytes: 1949143810
2025-03-13 19:15:20,804 [INFO]: 	avg_search_speed_ms: 10.171475773108773
2025-03-13 19:15:20,804 [INFO]: 	99p_search_speed_ms: 15.094354590401053
2025-03-13 19:15:20,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:20,804 [INFO]: 	nb vectors: 9907
2025-03-13 19:15:20,804 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:20,804 [INFO]: 	compression ratio: 0.9993082326747352
2025-03-13 19:15:20,804 [INFO]: }
2025-03-13 19:15:20,804 [INFO]: 	>>> Finished "Creating the index" in 128.1839 secs
2025-03-13 19:15:20,804 [INFO]: >>> Finished "Launching the whole pipeline" in 128.2124 secs
2025-03-13 19:15:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 12367 [episode count 4/20]
[retrieval_preprocessing] for episode 25203 [episode count 5/20], we have num_retrieval=np.int64(10020) num_query=np.int64(426)
2025-03-13 19:15:24,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:26,317 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:26
2025-03-13 19:15:26,317 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.35it/s]
2025-03-13 19:15:26,341 [INFO]: There are 10020 embeddings of dim 49152
2025-03-13 19:15:26,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:15:26,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:26
2025-03-13 19:15:26,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:26,341 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:15:26,342 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:15:26,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:26,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:26
2025-03-13 19:15:26,342 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:26,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:15:26,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:26
2025-03-13 19:15:26,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:26,342 [INFO]: 	Creating the index 03/13/2025, 19:15:26
2025-03-13 19:15:26,342 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:15:26
2025-03-13 19:15:26,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 19:15:26,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:26
2025-03-13 19:15:26,343 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:15:26,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  6.92it/s] 12%|█▏        | 5/41 [00:00<00:01, 21.49it/s] 24%|██▍       | 10/41 [00:00<00:00, 31.92it/s] 39%|███▉      | 16/41 [00:00<00:00, 39.74it/s] 51%|█████     | 21/41 [00:08<00:12,  1.54it/s] 63%|██████▎   | 26/41 [00:08<00:06,  2.33it/s] 78%|███████▊  | 32/41 [00:09<00:02,  3.63it/s] 93%|█████████▎| 38/41 [00:09<00:00,  5.38it/s]100%|██████████| 41/41 [00:18<00:00,  2.21it/s]
2025-03-13 19:15:44,910 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:44
2025-03-13 19:17:09,144 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.2335 secs
2025-03-13 19:17:09,144 [INFO]: The best hyperparameters are: efSearch=72
2025-03-13 19:17:09,144 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 19:17:46,989 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8451 secs
2025-03-13 19:17:46,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.6487 secs
2025-03-13 19:17:46,992 [INFO]: {
2025-03-13 19:17:46,992 [INFO]: 	index_key: HNSW32
2025-03-13 19:17:46,992 [INFO]: 	index_param: efSearch=72
2025-03-13 19:17:46,992 [INFO]: 	index_path: knn.index
2025-03-13 19:17:46,992 [INFO]: 	size in bytes: 1972735378
2025-03-13 19:17:46,992 [INFO]: 	avg_search_speed_ms: 11.470510089532857
2025-03-13 19:17:46,992 [INFO]: 	99p_search_speed_ms: 22.432242438662794
2025-03-13 19:17:46,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:46,992 [INFO]: 	nb vectors: 10020
2025-03-13 19:17:46,992 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:46,992 [INFO]: 	compression ratio: 0.9986195725841542
2025-03-13 19:17:46,992 [INFO]: }
2025-03-13 19:17:46,992 [INFO]: 	>>> Finished "Creating the index" in 140.6501 secs
2025-03-13 19:17:46,992 [INFO]: >>> Finished "Launching the whole pipeline" in 140.6752 secs
2025-03-13 19:17:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 25203 [episode count 5/20]
[retrieval_preprocessing] for episode 65652 [episode count 6/20], we have num_retrieval=np.int64(9980) num_query=np.int64(466)
2025-03-13 19:17:50,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:51,958 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:51
2025-03-13 19:17:51,958 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1322.29it/s]
2025-03-13 19:17:51,986 [INFO]: There are 9980 embeddings of dim 49152
2025-03-13 19:17:51,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 19:17:51,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:51
2025-03-13 19:17:51,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:51,987 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:17:51,987 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:17:51,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:51,987 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:51
2025-03-13 19:17:51,987 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:51,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:17:51,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:51
2025-03-13 19:17:51,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:51,987 [INFO]: 	Creating the index 03/13/2025, 19:17:51
2025-03-13 19:17:51,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:51
2025-03-13 19:17:51,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 19:17:51,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:51
2025-03-13 19:17:51,989 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:17:51,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.76it/s] 10%|▉         | 4/41 [00:00<00:02, 16.44it/s] 15%|█▍        | 6/41 [00:00<00:02, 13.33it/s] 20%|█▉        | 8/41 [00:00<00:02, 12.43it/s] 24%|██▍       | 10/41 [00:00<00:02, 12.00it/s] 29%|██▉       | 12/41 [00:00<00:02, 12.22it/s] 34%|███▍      | 14/41 [00:01<00:02, 12.38it/s] 39%|███▉      | 16/41 [00:01<00:02, 12.45it/s] 44%|████▍     | 18/41 [00:01<00:01, 12.18it/s] 49%|████▉     | 20/41 [00:01<00:01, 11.83it/s] 54%|█████▎    | 22/41 [00:06<00:14,  1.31it/s] 68%|██████▊   | 28/41 [00:06<00:04,  2.93it/s] 83%|████████▎ | 34/41 [00:06<00:01,  5.07it/s] 98%|█████████▊| 40/41 [00:06<00:00,  7.83it/s]100%|██████████| 41/41 [00:11<00:00,  3.43it/s]
2025-03-13 19:18:03,937 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:03
2025-03-13 19:19:16,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.2634 secs
2025-03-13 19:19:16,201 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 19:19:16,201 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 19:19:46,610 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4092 secs
2025-03-13 19:19:46,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.6238 secs
2025-03-13 19:19:46,613 [INFO]: {
2025-03-13 19:19:46,613 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:46,613 [INFO]: 	index_param: efSearch=137
2025-03-13 19:19:46,613 [INFO]: 	index_path: knn.index
2025-03-13 19:19:46,613 [INFO]: 	size in bytes: 1963506130
2025-03-13 19:19:46,613 [INFO]: 	avg_search_speed_ms: 10.460368298904028
2025-03-13 19:19:46,613 [INFO]: 	99p_search_speed_ms: 15.450005617458373
2025-03-13 19:19:46,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:46,613 [INFO]: 	nb vectors: 9980
2025-03-13 19:19:46,613 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:46,613 [INFO]: 	compression ratio: 0.9993082323608534
2025-03-13 19:19:46,613 [INFO]: }
2025-03-13 19:19:46,613 [INFO]: 	>>> Finished "Creating the index" in 114.6257 secs
2025-03-13 19:19:46,613 [INFO]: >>> Finished "Launching the whole pipeline" in 114.6548 secs
2025-03-13 19:19:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 65652 [episode count 6/20]
[retrieval_preprocessing] for episode 83065 [episode count 7/20], we have num_retrieval=np.int64(9960) num_query=np.int64(486)
2025-03-13 19:19:50,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:51,801 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:51
2025-03-13 19:19:51,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-13 19:19:51,826 [INFO]: There are 9960 embeddings of dim 49152
2025-03-13 19:19:51,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 19:19:51,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:51
2025-03-13 19:19:51,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:51,826 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:19:51,826 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:19:51,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:19:51,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:51
2025-03-13 19:19:51,826 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:51,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:19:51,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:51
2025-03-13 19:19:51,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:51,826 [INFO]: 	Creating the index 03/13/2025, 19:19:51
2025-03-13 19:19:51,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:51
2025-03-13 19:19:51,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:19:51,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:51
2025-03-13 19:19:51,828 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:19:51,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.42it/s] 12%|█▏        | 5/41 [00:00<00:01, 24.83it/s] 24%|██▍       | 10/41 [00:00<00:00, 35.17it/s] 37%|███▋      | 15/41 [00:00<00:00, 39.58it/s] 49%|████▉     | 20/41 [00:00<00:00, 41.96it/s] 61%|██████    | 25/41 [00:05<00:05,  2.75it/s] 76%|███████▌  | 31/41 [00:05<00:02,  4.32it/s] 90%|█████████ | 37/41 [00:05<00:00,  6.40it/s]100%|██████████| 41/41 [00:10<00:00,  4.02it/s]
2025-03-13 19:20:02,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:02
2025-03-13 19:21:14,961 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.9394 secs
2025-03-13 19:21:14,961 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 19:21:14,961 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 19:21:59,567 [INFO]: 	>>> Finished "Compute fast metrics" in 44.6052 secs
2025-03-13 19:21:59,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.7414 secs
2025-03-13 19:21:59,569 [INFO]: {
2025-03-13 19:21:59,569 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:59,569 [INFO]: 	index_param: efSearch=147
2025-03-13 19:21:59,569 [INFO]: 	index_path: knn.index
2025-03-13 19:21:59,569 [INFO]: 	size in bytes: 1959571270
2025-03-13 19:21:59,569 [INFO]: 	avg_search_speed_ms: 10.976298168326117
2025-03-13 19:21:59,569 [INFO]: 	99p_search_speed_ms: 16.256258403882384
2025-03-13 19:21:59,569 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:59,569 [INFO]: 	nb vectors: 9960
2025-03-13 19:21:59,569 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:59,569 [INFO]: 	compression ratio: 0.9993082211294106
2025-03-13 19:21:59,569 [INFO]: }
2025-03-13 19:21:59,569 [INFO]: 	>>> Finished "Creating the index" in 127.7430 secs
2025-03-13 19:21:59,569 [INFO]: >>> Finished "Launching the whole pipeline" in 127.7677 secs
2025-03-13 19:22:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 83065 [episode count 7/20]
[retrieval_preprocessing] for episode 32893 [episode count 8/20], we have num_retrieval=np.int64(10013) num_query=np.int64(433)
2025-03-13 19:22:04,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:05,840 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:05
2025-03-13 19:22:05,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.09it/s]
2025-03-13 19:22:05,867 [INFO]: There are 10013 embeddings of dim 49152
2025-03-13 19:22:05,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 19:22:05,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:05
2025-03-13 19:22:05,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:05,868 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:22:05,868 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:22:05,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:22:05,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:05
2025-03-13 19:22:05,868 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:05,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:22:05,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:05
2025-03-13 19:22:05,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:05,868 [INFO]: 	Creating the index 03/13/2025, 19:22:05
2025-03-13 19:22:05,868 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:22:05
2025-03-13 19:22:05,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 19:22:05,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:05
2025-03-13 19:22:05,869 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:22:05,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.43it/s] 15%|█▍        | 6/41 [00:00<00:01, 28.79it/s] 32%|███▏      | 13/41 [00:00<00:00, 43.72it/s] 49%|████▉     | 20/41 [00:00<00:00, 50.84it/s] 63%|██████▎   | 26/41 [00:07<00:06,  2.34it/s] 78%|███████▊  | 32/41 [00:07<00:02,  3.49it/s] 93%|█████████▎| 38/41 [00:07<00:00,  5.04it/s]100%|██████████| 41/41 [00:15<00:00,  2.57it/s]
2025-03-13 19:22:21,835 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:21
2025-03-13 19:23:48,286 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.4505 secs
2025-03-13 19:23:48,286 [INFO]: The best hyperparameters are: efSearch=83
2025-03-13 19:23:48,286 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 19:24:22,611 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3252 secs
2025-03-13 19:24:22,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.7452 secs
2025-03-13 19:24:22,615 [INFO]: {
2025-03-13 19:24:22,615 [INFO]: 	index_key: HNSW32
2025-03-13 19:24:22,615 [INFO]: 	index_param: efSearch=83
2025-03-13 19:24:22,615 [INFO]: 	index_path: knn.index
2025-03-13 19:24:22,615 [INFO]: 	size in bytes: 1971357246
2025-03-13 19:24:22,615 [INFO]: 	avg_search_speed_ms: 12.936689955378759
2025-03-13 19:24:22,615 [INFO]: 	99p_search_speed_ms: 21.49416946806013
2025-03-13 19:24:22,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:22,615 [INFO]: 	nb vectors: 10013
2025-03-13 19:24:22,615 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:22,615 [INFO]: 	compression ratio: 0.9986195591866863
2025-03-13 19:24:22,615 [INFO]: }
2025-03-13 19:24:22,615 [INFO]: 	>>> Finished "Creating the index" in 136.7466 secs
2025-03-13 19:24:22,615 [INFO]: >>> Finished "Launching the whole pipeline" in 136.7742 secs
2025-03-13 19:24:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 32893 [episode count 8/20]
[retrieval_preprocessing] for episode 62593 [episode count 9/20], we have num_retrieval=np.int64(9797) num_query=np.int64(649)
2025-03-13 19:24:26,925 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:28,243 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:28
2025-03-13 19:24:28,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.50it/s]
2025-03-13 19:24:28,270 [INFO]: There are 9797 embeddings of dim 49152
2025-03-13 19:24:28,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 19:24:28,270 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:28
2025-03-13 19:24:28,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:28,270 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:24:28,270 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:24:28,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:24:28,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:28
2025-03-13 19:24:28,271 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:28,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:24:28,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:28
2025-03-13 19:24:28,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:28,271 [INFO]: 	Creating the index 03/13/2025, 19:24:28
2025-03-13 19:24:28,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:28
2025-03-13 19:24:28,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:24:28,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:28
2025-03-13 19:24:28,272 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:24:28,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.59it/s] 15%|█▌        | 6/40 [00:00<00:01, 28.32it/s] 28%|██▊       | 11/40 [00:00<00:00, 37.20it/s] 40%|████      | 16/40 [00:00<00:00, 41.83it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.68it/s] 65%|██████▌   | 26/40 [00:05<00:03,  4.04it/s] 80%|████████  | 32/40 [00:05<00:01,  6.22it/s] 95%|█████████▌| 38/40 [00:05<00:00,  9.03it/s]100%|██████████| 40/40 [00:10<00:00,  3.75it/s]
2025-03-13 19:24:38,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:38
2025-03-13 19:25:53,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.8432 secs
2025-03-13 19:25:53,777 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 19:25:53,777 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-13 19:26:40,260 [INFO]: 	>>> Finished "Compute fast metrics" in 46.4833 secs
2025-03-13 19:26:40,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.9920 secs
2025-03-13 19:26:40,264 [INFO]: {
2025-03-13 19:26:40,264 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:40,264 [INFO]: 	index_param: efSearch=141
2025-03-13 19:26:40,264 [INFO]: 	index_path: knn.index
2025-03-13 19:26:40,264 [INFO]: 	size in bytes: 1927501750
2025-03-13 19:26:40,264 [INFO]: 	avg_search_speed_ms: 11.631408117733203
2025-03-13 19:26:40,264 [INFO]: 	99p_search_speed_ms: 17.488322004210204
2025-03-13 19:26:40,264 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:40,264 [INFO]: 	nb vectors: 9797
2025-03-13 19:26:40,264 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:40,264 [INFO]: 	compression ratio: 0.9993083409651898
2025-03-13 19:26:40,264 [INFO]: }
2025-03-13 19:26:40,264 [INFO]: 	>>> Finished "Creating the index" in 131.9936 secs
2025-03-13 19:26:40,264 [INFO]: >>> Finished "Launching the whole pipeline" in 132.0215 secs
2025-03-13 19:26:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 62593 [episode count 9/20]
[retrieval_preprocessing] for episode 12948 [episode count 10/20], we have num_retrieval=np.int64(9340) num_query=np.int64(1106)
2025-03-13 19:26:47,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:48,484 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:48
2025-03-13 19:26:48,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1961.79it/s]
2025-03-13 19:26:48,511 [INFO]: There are 9340 embeddings of dim 49152
2025-03-13 19:26:48,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 19:26:48,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:48
2025-03-13 19:26:48,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:48,512 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 19:26:48,512 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:26:48,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:26:48,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:48
2025-03-13 19:26:48,512 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:48,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:26:48,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:48
2025-03-13 19:26:48,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:48,512 [INFO]: 	Creating the index 03/13/2025, 19:26:48
2025-03-13 19:26:48,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:48
2025-03-13 19:26:48,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:26:48,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:48
2025-03-13 19:26:48,513 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:26:48,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.46it/s] 16%|█▌        | 6/38 [00:00<00:01, 26.66it/s] 32%|███▏      | 12/38 [00:00<00:00, 38.47it/s] 47%|████▋     | 18/38 [00:00<00:00, 45.86it/s] 61%|██████    | 23/38 [00:04<00:04,  3.33it/s] 76%|███████▋  | 29/38 [00:04<00:01,  5.17it/s] 92%|█████████▏| 35/38 [00:04<00:00,  7.59it/s]100%|██████████| 38/38 [00:09<00:00,  4.00it/s]
2025-03-13 19:26:58,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:58
2025-03-13 19:28:09,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.7407 secs
2025-03-13 19:28:09,753 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 19:28:09,753 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 19:28:34,940 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1865 secs
2025-03-13 19:28:34,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.4298 secs
2025-03-13 19:28:34,943 [INFO]: {
2025-03-13 19:28:34,943 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:34,943 [INFO]: 	index_param: efSearch=139
2025-03-13 19:28:34,943 [INFO]: 	index_path: knn.index
2025-03-13 19:28:34,943 [INFO]: 	size in bytes: 1837590010
2025-03-13 19:28:34,943 [INFO]: 	avg_search_speed_ms: 10.744180719375162
2025-03-13 19:28:34,943 [INFO]: 	99p_search_speed_ms: 15.848888130858548
2025-03-13 19:28:34,943 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:34,943 [INFO]: 	nb vectors: 9340
2025-03-13 19:28:34,943 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:34,943 [INFO]: 	compression ratio: 0.9993081753856509
2025-03-13 19:28:34,943 [INFO]: }
2025-03-13 19:28:34,943 [INFO]: 	>>> Finished "Creating the index" in 106.4312 secs
2025-03-13 19:28:34,943 [INFO]: >>> Finished "Launching the whole pipeline" in 106.4587 secs
2025-03-13 19:28:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 12948 [episode count 10/20]
[retrieval_preprocessing] for episode 92829 [episode count 11/20], we have num_retrieval=np.int64(9828) num_query=np.int64(618)
2025-03-13 19:28:43,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:44,654 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:44
2025-03-13 19:28:44,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-13 19:28:44,686 [INFO]: There are 9828 embeddings of dim 49152
2025-03-13 19:28:44,686 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 19:28:44,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:44
2025-03-13 19:28:44,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:44,687 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:28:44,687 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:28:44,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 19:28:44,687 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:44
2025-03-13 19:28:44,688 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:44,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:28:44,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:44
2025-03-13 19:28:44,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:44,688 [INFO]: 	Creating the index 03/13/2025, 19:28:44
2025-03-13 19:28:44,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:44
2025-03-13 19:28:44,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:28:44,692 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:44
2025-03-13 19:28:44,692 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:28:44,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.32it/s] 15%|█▌        | 6/40 [00:00<00:01, 30.43it/s] 30%|███       | 12/40 [00:00<00:00, 40.32it/s] 45%|████▌     | 18/40 [00:00<00:00, 44.67it/s] 57%|█████▊    | 23/40 [00:04<00:05,  3.13it/s] 75%|███████▌  | 30/40 [00:04<00:01,  5.16it/s] 92%|█████████▎| 37/40 [00:04<00:00,  7.84it/s]100%|██████████| 40/40 [00:10<00:00,  3.88it/s]
2025-03-13 19:28:55,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:55
2025-03-13 19:30:04,617 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.6001 secs
2025-03-13 19:30:04,617 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 19:30:04,617 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-13 19:30:42,556 [INFO]: 	>>> Finished "Compute fast metrics" in 37.9387 secs
2025-03-13 19:30:43,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.5414 secs
2025-03-13 19:30:43,234 [INFO]: {
2025-03-13 19:30:43,234 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:43,234 [INFO]: 	index_param: efSearch=126
2025-03-13 19:30:43,234 [INFO]: 	index_path: knn.index
2025-03-13 19:30:43,234 [INFO]: 	size in bytes: 1933600930
2025-03-13 19:30:43,234 [INFO]: 	avg_search_speed_ms: 10.552390430167804
2025-03-13 19:30:43,234 [INFO]: 	99p_search_speed_ms: 15.55128760403022
2025-03-13 19:30:43,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:43,234 [INFO]: 	nb vectors: 9828
2025-03-13 19:30:43,234 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:43,234 [INFO]: 	compression ratio: 0.999308282293803
2025-03-13 19:30:43,234 [INFO]: }
2025-03-13 19:30:43,234 [INFO]: 	>>> Finished "Creating the index" in 118.5460 secs
2025-03-13 19:30:43,235 [INFO]: >>> Finished "Launching the whole pipeline" in 118.5806 secs
2025-03-13 19:30:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 92829 [episode count 11/20]
[retrieval_preprocessing] for episode 83104 [episode count 12/20], we have num_retrieval=np.int64(9672) num_query=np.int64(774)
2025-03-13 19:30:48,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:50,742 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:50
2025-03-13 19:30:50,742 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.21it/s]
2025-03-13 19:30:50,772 [INFO]: There are 9672 embeddings of dim 49152
2025-03-13 19:30:50,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 19:30:50,773 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:50
2025-03-13 19:30:50,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:50,773 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 19:30:50,773 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:30:50,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:30:50,773 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:50
2025-03-13 19:30:50,774 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:50,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:30:50,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:50
2025-03-13 19:30:50,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:50,774 [INFO]: 	Creating the index 03/13/2025, 19:30:50
2025-03-13 19:30:50,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:50
2025-03-13 19:30:50,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:30:50,778 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:50
2025-03-13 19:30:50,778 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:30:50,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  9.37it/s] 18%|█▊        | 7/40 [00:00<00:00, 35.25it/s] 32%|███▎      | 13/40 [00:00<00:00, 43.45it/s] 48%|████▊     | 19/40 [00:00<00:00, 47.39it/s] 60%|██████    | 24/40 [00:05<00:05,  3.03it/s] 75%|███████▌  | 30/40 [00:05<00:02,  4.67it/s] 90%|█████████ | 36/40 [00:05<00:00,  6.84it/s]100%|██████████| 40/40 [00:10<00:00,  3.93it/s]
2025-03-13 19:31:00,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:00
2025-03-13 19:32:18,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1473 secs
2025-03-13 19:32:18,121 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 19:32:18,121 [INFO]: 	Compute fast metrics 03/13/2025, 19:32:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 19:32:43,510 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3889 secs
2025-03-13 19:32:43,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.7346 secs
2025-03-13 19:32:43,512 [INFO]: {
2025-03-13 19:32:43,512 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:43,512 [INFO]: 	index_param: efSearch=134
2025-03-13 19:32:43,512 [INFO]: 	index_path: knn.index
2025-03-13 19:32:43,512 [INFO]: 	size in bytes: 1902908530
2025-03-13 19:32:43,513 [INFO]: 	avg_search_speed_ms: 10.547236735168216
2025-03-13 19:32:43,513 [INFO]: 	99p_search_speed_ms: 17.037970507517457
2025-03-13 19:32:43,513 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:43,513 [INFO]: 	nb vectors: 9672
2025-03-13 19:32:43,513 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:43,513 [INFO]: 	compression ratio: 0.9993084512580329
2025-03-13 19:32:43,513 [INFO]: }
2025-03-13 19:32:43,513 [INFO]: 	>>> Finished "Creating the index" in 112.7383 secs
2025-03-13 19:32:43,513 [INFO]: >>> Finished "Launching the whole pipeline" in 112.7709 secs
2025-03-13 19:32:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 83104 [episode count 12/20]
[retrieval_preprocessing] for episode 61090 [episode count 13/20], we have num_retrieval=np.int64(9997) num_query=np.int64(449)
2025-03-13 19:32:48,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:50,197 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:50
2025-03-13 19:32:50,197 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1830.77it/s]
2025-03-13 19:32:50,225 [INFO]: There are 9997 embeddings of dim 49152
2025-03-13 19:32:50,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:32:50,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,226 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:50,226 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:32:50,226 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:32:50,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:32:50,226 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,227 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:50,227 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:32:50,227 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:50
2025-03-13 19:32:50,227 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:50,227 [INFO]: 	Creating the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,227 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:50
2025-03-13 19:32:50,228 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:32:50,229 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:50
2025-03-13 19:32:50,229 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:32:50,229 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.55it/s] 17%|█▋        | 7/41 [00:00<00:00, 35.28it/s] 34%|███▍      | 14/41 [00:00<00:00, 46.98it/s] 51%|█████     | 21/41 [00:04<00:05,  3.83it/s] 66%|██████▌   | 27/41 [00:04<00:02,  5.76it/s] 83%|████████▎ | 34/41 [00:04<00:00,  8.73it/s]100%|██████████| 41/41 [00:08<00:00,  3.37it/s]100%|██████████| 41/41 [00:08<00:00,  4.65it/s]
2025-03-13 19:32:59,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:59
2025-03-13 19:34:09,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.2277 secs
2025-03-13 19:34:09,271 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 19:34:09,271 [INFO]: 	Compute fast metrics 03/13/2025, 19:34:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.75it/s]
2025-03-13 19:34:30,583 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3116 secs
2025-03-13 19:34:30,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.3570 secs
2025-03-13 19:34:30,586 [INFO]: {
2025-03-13 19:34:30,586 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:30,586 [INFO]: 	index_param: efSearch=143
2025-03-13 19:34:30,586 [INFO]: 	index_path: knn.index
2025-03-13 19:34:30,586 [INFO]: 	size in bytes: 1966850830
2025-03-13 19:34:30,586 [INFO]: 	avg_search_speed_ms: 10.5530021541245
2025-03-13 19:34:30,586 [INFO]: 	99p_search_speed_ms: 16.02109942352399
2025-03-13 19:34:30,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:30,586 [INFO]: 	nb vectors: 9997
2025-03-13 19:34:30,586 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:30,586 [INFO]: 	compression ratio: 0.9993082068150537
2025-03-13 19:34:30,586 [INFO]: }
2025-03-13 19:34:30,586 [INFO]: 	>>> Finished "Creating the index" in 100.3587 secs
2025-03-13 19:34:30,586 [INFO]: >>> Finished "Launching the whole pipeline" in 100.3889 secs
2025-03-13 19:34:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 61090 [episode count 13/20]
[retrieval_preprocessing] for episode 50345 [episode count 14/20], we have num_retrieval=np.int64(10082) num_query=np.int64(364)
2025-03-13 19:34:34,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:35,869 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:35
2025-03-13 19:34:35,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2182.26it/s]
2025-03-13 19:34:35,895 [INFO]: There are 10082 embeddings of dim 49152
2025-03-13 19:34:35,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 19:34:35,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:35
2025-03-13 19:34:35,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:35,896 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:34:35,896 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:34:35,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:34:35,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:35
2025-03-13 19:34:35,897 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:35,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:34:35,897 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:35
2025-03-13 19:34:35,897 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 19:34:35,898 [INFO]: 	Creating the index 03/13/2025, 19:34:35
2025-03-13 19:34:35,898 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:34:35
2025-03-13 19:34:35,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 19:34:35,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:35
2025-03-13 19:34:35,901 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:34:35,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.63it/s] 17%|█▋        | 7/41 [00:00<00:00, 34.34it/s] 32%|███▏      | 13/41 [00:00<00:00, 43.61it/s] 46%|████▋     | 19/41 [00:00<00:00, 48.05it/s] 59%|█████▊    | 24/41 [00:07<00:08,  2.04it/s] 76%|███████▌  | 31/41 [00:07<00:02,  3.38it/s] 93%|█████████▎| 38/41 [00:07<00:00,  5.19it/s]100%|██████████| 41/41 [00:16<00:00,  2.55it/s]
2025-03-13 19:34:51,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:51
2025-03-13 19:36:14,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.2464 secs
2025-03-13 19:36:14,202 [INFO]: The best hyperparameters are: efSearch=80
2025-03-13 19:36:14,202 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.81it/s]
2025-03-13 19:36:36,010 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8074 secs
2025-03-13 19:36:36,013 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.1121 secs
2025-03-13 19:36:36,013 [INFO]: {
2025-03-13 19:36:36,013 [INFO]: 	index_key: HNSW32
2025-03-13 19:36:36,013 [INFO]: 	index_param: efSearch=80
2025-03-13 19:36:36,013 [INFO]: 	index_path: knn.index
2025-03-13 19:36:36,013 [INFO]: 	size in bytes: 1984942202
2025-03-13 19:36:36,013 [INFO]: 	avg_search_speed_ms: 11.864906899997807
2025-03-13 19:36:36,013 [INFO]: 	99p_search_speed_ms: 18.308135182596747
2025-03-13 19:36:36,013 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:36,013 [INFO]: 	nb vectors: 10082
2025-03-13 19:36:36,013 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:36,013 [INFO]: 	compression ratio: 0.9986194328493602
2025-03-13 19:36:36,013 [INFO]: }
2025-03-13 19:36:36,013 [INFO]: 	>>> Finished "Creating the index" in 120.1156 secs
2025-03-13 19:36:36,013 [INFO]: >>> Finished "Launching the whole pipeline" in 120.1444 secs
2025-03-13 19:36:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 50345 [episode count 14/20]
[retrieval_preprocessing] for episode 30922 [episode count 15/20], we have num_retrieval=np.int64(9937) num_query=np.int64(509)
2025-03-13 19:36:39,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:40,770 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:40
2025-03-13 19:36:40,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-13 19:36:40,794 [INFO]: There are 9937 embeddings of dim 49152
2025-03-13 19:36:40,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 19:36:40,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:40
2025-03-13 19:36:40,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:40,795 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:36:40,795 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:36:40,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:36:40,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:40
2025-03-13 19:36:40,795 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:40,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:36:40,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:40
2025-03-13 19:36:40,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:40,795 [INFO]: 	Creating the index 03/13/2025, 19:36:40
2025-03-13 19:36:40,795 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:40
2025-03-13 19:36:40,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:36:40,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:40
2025-03-13 19:36:40,797 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:36:40,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  9.84it/s] 17%|█▋        | 7/41 [00:00<00:00, 36.09it/s] 34%|███▍      | 14/41 [00:00<00:00, 49.95it/s] 51%|█████     | 21/41 [00:04<00:05,  3.77it/s] 66%|██████▌   | 27/41 [00:04<00:02,  5.68it/s] 83%|████████▎ | 34/41 [00:04<00:00,  8.63it/s]100%|██████████| 41/41 [00:08<00:00,  3.48it/s]100%|██████████| 41/41 [00:08<00:00,  4.74it/s]
2025-03-13 19:36:49,454 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:49
2025-03-13 19:38:03,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.3743 secs
2025-03-13 19:38:03,829 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 19:38:03,829 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.46it/s]
2025-03-13 19:38:36,389 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5601 secs
2025-03-13 19:38:36,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.5958 secs
2025-03-13 19:38:36,393 [INFO]: {
2025-03-13 19:38:36,393 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:36,393 [INFO]: 	index_param: efSearch=135
2025-03-13 19:38:36,393 [INFO]: 	index_path: knn.index
2025-03-13 19:38:36,393 [INFO]: 	size in bytes: 1955046190
2025-03-13 19:38:36,393 [INFO]: 	avg_search_speed_ms: 10.532522211096397
2025-03-13 19:38:36,393 [INFO]: 	99p_search_speed_ms: 15.801072721369565
2025-03-13 19:38:36,393 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:36,393 [INFO]: 	nb vectors: 9937
2025-03-13 19:38:36,393 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:36,393 [INFO]: 	compression ratio: 0.999308203557073
2025-03-13 19:38:36,393 [INFO]: }
2025-03-13 19:38:36,393 [INFO]: 	>>> Finished "Creating the index" in 115.5974 secs
2025-03-13 19:38:36,393 [INFO]: >>> Finished "Launching the whole pipeline" in 115.6229 secs
2025-03-13 19:38:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 30922 [episode count 15/20]
[retrieval_preprocessing] for episode 41714 [episode count 16/20], we have num_retrieval=np.int64(9998) num_query=np.int64(448)
2025-03-13 19:38:40,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:42,017 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:42
2025-03-13 19:38:42,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.34it/s]
2025-03-13 19:38:42,042 [INFO]: There are 9998 embeddings of dim 49152
2025-03-13 19:38:42,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 19:38:42,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:42
2025-03-13 19:38:42,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:42,043 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:38:42,043 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:38:42,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:38:42,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:42
2025-03-13 19:38:42,043 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:42,043 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:38:42,043 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:42
2025-03-13 19:38:42,043 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:42,043 [INFO]: 	Creating the index 03/13/2025, 19:38:42
2025-03-13 19:38:42,043 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:42
2025-03-13 19:38:42,044 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:38:42,045 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:42
2025-03-13 19:38:42,045 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:38:42,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  8.24it/s] 17%|█▋        | 7/41 [00:00<00:01, 33.66it/s] 32%|███▏      | 13/41 [00:00<00:00, 43.23it/s] 46%|████▋     | 19/41 [00:00<00:00, 47.44it/s] 59%|█████▊    | 24/41 [00:05<00:05,  2.84it/s] 73%|███████▎  | 30/41 [00:05<00:02,  4.40it/s] 88%|████████▊ | 36/41 [00:05<00:00,  6.48it/s]100%|██████████| 41/41 [00:10<00:00,  2.58it/s]100%|██████████| 41/41 [00:10<00:00,  3.98it/s]
2025-03-13 19:38:52,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:52
2025-03-13 19:40:01,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1366 secs
2025-03-13 19:40:01,489 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 19:40:01,489 [INFO]: 	Compute fast metrics 03/13/2025, 19:40:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.13it/s]
2025-03-13 19:40:21,683 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1937 secs
2025-03-13 19:40:21,686 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.6412 secs
2025-03-13 19:40:21,686 [INFO]: {
2025-03-13 19:40:21,686 [INFO]: 	index_key: HNSW15
2025-03-13 19:40:21,686 [INFO]: 	index_param: efSearch=164
2025-03-13 19:40:21,686 [INFO]: 	index_path: knn.index
2025-03-13 19:40:21,686 [INFO]: 	size in bytes: 1967047570
2025-03-13 19:40:21,686 [INFO]: 	avg_search_speed_ms: 11.61342739202212
2025-03-13 19:40:21,686 [INFO]: 	99p_search_speed_ms: 16.543658869341016
2025-03-13 19:40:21,686 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:40:21,686 [INFO]: 	nb vectors: 9998
2025-03-13 19:40:21,686 [INFO]: 	vectors dimension: 49152
2025-03-13 19:40:21,686 [INFO]: 	compression ratio: 0.9993082089011197
2025-03-13 19:40:21,686 [INFO]: }
2025-03-13 19:40:21,686 [INFO]: 	>>> Finished "Creating the index" in 99.6430 secs
2025-03-13 19:40:21,686 [INFO]: >>> Finished "Launching the whole pipeline" in 99.6694 secs
2025-03-13 19:40:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:40:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 41714 [episode count 16/20]
[retrieval_preprocessing] for episode 4359 [episode count 17/20], we have num_retrieval=np.int64(9908) num_query=np.int64(538)
2025-03-13 19:40:25,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:40:26,437 [INFO]: Launching the whole pipeline 03/13/2025, 19:40:26
2025-03-13 19:40:26,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:40:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.59it/s]
2025-03-13 19:40:26,464 [INFO]: There are 9908 embeddings of dim 49152
2025-03-13 19:40:26,465 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:40:26,465 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:40:26
2025-03-13 19:40:26,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:40:26,465 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:40:26,465 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:40:26,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:40:26,465 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:40:26
2025-03-13 19:40:26,466 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:40:26,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:40:26,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:40:26
2025-03-13 19:40:26,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:40:26,467 [INFO]: 	Creating the index 03/13/2025, 19:40:26
2025-03-13 19:40:26,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:40:26
2025-03-13 19:40:26,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:40:26,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:40:26
2025-03-13 19:40:26,470 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:40:26,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  5%|▌         | 2/40 [00:00<00:02, 16.94it/s] 22%|██▎       | 9/40 [00:00<00:00, 42.66it/s] 40%|████      | 16/40 [00:00<00:00, 51.02it/s] 55%|█████▌    | 22/40 [00:04<00:04,  3.88it/s] 72%|███████▎  | 29/40 [00:04<00:01,  6.22it/s] 90%|█████████ | 36/40 [00:04<00:00,  9.30it/s]100%|██████████| 40/40 [00:08<00:00,  4.63it/s]
2025-03-13 19:40:35,105 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:40:35
2025-03-13 19:41:38,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.1748 secs
2025-03-13 19:41:38,281 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 19:41:38,281 [INFO]: 	Compute fast metrics 03/13/2025, 19:41:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.51it/s]
2025-03-13 19:42:01,458 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1777 secs
2025-03-13 19:42:01,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.9906 secs
2025-03-13 19:42:01,461 [INFO]: {
2025-03-13 19:42:01,461 [INFO]: 	index_key: HNSW15
2025-03-13 19:42:01,461 [INFO]: 	index_param: efSearch=158
2025-03-13 19:42:01,461 [INFO]: 	index_path: knn.index
2025-03-13 19:42:01,461 [INFO]: 	size in bytes: 1949340550
2025-03-13 19:42:01,461 [INFO]: 	avg_search_speed_ms: 10.728009706892697
2025-03-13 19:42:01,461 [INFO]: 	99p_search_speed_ms: 15.72134716901928
2025-03-13 19:42:01,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:42:01,461 [INFO]: 	nb vectors: 9908
2025-03-13 19:42:01,461 [INFO]: 	vectors dimension: 49152
2025-03-13 19:42:01,461 [INFO]: 	compression ratio: 0.9993082347771404
2025-03-13 19:42:01,461 [INFO]: }
2025-03-13 19:42:01,461 [INFO]: 	>>> Finished "Creating the index" in 94.9944 secs
2025-03-13 19:42:01,461 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0240 secs
2025-03-13 19:42:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:42:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 4359 [episode count 17/20]
[retrieval_preprocessing] for episode 64281 [episode count 18/20], we have num_retrieval=np.int64(9898) num_query=np.int64(548)
2025-03-13 19:42:05,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:42:06,736 [INFO]: Launching the whole pipeline 03/13/2025, 19:42:06
2025-03-13 19:42:06,736 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:42:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.06it/s]
2025-03-13 19:42:06,762 [INFO]: There are 9898 embeddings of dim 49152
2025-03-13 19:42:06,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 19:42:06,762 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:42:06
2025-03-13 19:42:06,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:42:06,762 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:42:06,762 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:42:06,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:42:06,762 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:42:06
2025-03-13 19:42:06,763 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:42:06,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:42:06,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:42:06
2025-03-13 19:42:06,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:42:06,763 [INFO]: 	Creating the index 03/13/2025, 19:42:06
2025-03-13 19:42:06,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:42:06
2025-03-13 19:42:06,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:42:06,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:42:06
2025-03-13 19:42:06,764 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:42:06,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  9.56it/s] 15%|█▌        | 6/40 [00:00<00:01, 31.13it/s] 30%|███       | 12/40 [00:00<00:00, 43.37it/s] 45%|████▌     | 18/40 [00:00<00:00, 49.23it/s] 57%|█████▊    | 23/40 [00:04<00:05,  3.33it/s] 68%|██████▊   | 27/40 [00:04<00:03,  4.26it/s] 75%|███████▌  | 30/40 [00:04<00:01,  5.07it/s] 82%|████████▎ | 33/40 [00:05<00:01,  6.01it/s] 88%|████████▊ | 35/40 [00:05<00:00,  6.73it/s] 92%|█████████▎| 37/40 [00:05<00:00,  7.57it/s] 98%|█████████▊| 39/40 [00:05<00:00,  8.44it/s]100%|██████████| 40/40 [00:10<00:00,  3.68it/s]
2025-03-13 19:42:17,638 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:42:17
2025-03-13 19:43:33,840 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2016 secs
2025-03-13 19:43:33,840 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 19:43:33,841 [INFO]: 	Compute fast metrics 03/13/2025, 19:43:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.70it/s]
2025-03-13 19:43:58,393 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5520 secs
2025-03-13 19:43:58,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.6310 secs
2025-03-13 19:43:58,395 [INFO]: {
2025-03-13 19:43:58,395 [INFO]: 	index_key: HNSW15
2025-03-13 19:43:58,395 [INFO]: 	index_param: efSearch=157
2025-03-13 19:43:58,395 [INFO]: 	index_path: knn.index
2025-03-13 19:43:58,395 [INFO]: 	size in bytes: 1947373150
2025-03-13 19:43:58,395 [INFO]: 	avg_search_speed_ms: 11.187084179613281
2025-03-13 19:43:58,395 [INFO]: 	99p_search_speed_ms: 18.848917311988725
2025-03-13 19:43:58,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:43:58,395 [INFO]: 	nb vectors: 9898
2025-03-13 19:43:58,395 [INFO]: 	vectors dimension: 49152
2025-03-13 19:43:58,395 [INFO]: 	compression ratio: 0.9993082137339728
2025-03-13 19:43:58,395 [INFO]: }
2025-03-13 19:43:58,395 [INFO]: 	>>> Finished "Creating the index" in 111.6327 secs
2025-03-13 19:43:58,395 [INFO]: >>> Finished "Launching the whole pipeline" in 111.6590 secs
2025-03-13 19:44:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:44:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 64281 [episode count 18/20]
[retrieval_preprocessing] for episode 21275 [episode count 19/20], we have num_retrieval=np.int64(9994) num_query=np.int64(452)
2025-03-13 19:44:02,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:44:04,121 [INFO]: Launching the whole pipeline 03/13/2025, 19:44:04
2025-03-13 19:44:04,121 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:44:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 19:44:04,150 [INFO]: There are 9994 embeddings of dim 49152
2025-03-13 19:44:04,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 19:44:04,150 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:44:04
2025-03-13 19:44:04,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:44:04,151 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 19:44:04,151 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:44:04,151 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:44:04,151 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:44:04
2025-03-13 19:44:04,151 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:44:04,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:44:04,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:44:04
2025-03-13 19:44:04,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:44:04,152 [INFO]: 	Creating the index 03/13/2025, 19:44:04
2025-03-13 19:44:04,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:44:04
2025-03-13 19:44:04,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 19:44:04,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:44:04
2025-03-13 19:44:04,156 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:44:04,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  9.22it/s] 20%|█▉        | 8/41 [00:00<00:00, 41.05it/s] 37%|███▋      | 15/41 [00:00<00:00, 52.25it/s] 51%|█████     | 21/41 [00:04<00:05,  3.38it/s] 61%|██████    | 25/41 [00:04<00:03,  4.20it/s] 68%|██████▊   | 28/41 [00:05<00:02,  5.10it/s] 83%|████████▎ | 34/41 [00:05<00:00,  7.93it/s] 98%|█████████▊| 40/41 [00:05<00:00, 11.52it/s]100%|██████████| 41/41 [00:09<00:00,  4.28it/s]
2025-03-13 19:44:13,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:44:13
2025-03-13 19:45:24,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.4653 secs
2025-03-13 19:45:24,211 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 19:45:24,211 [INFO]: 	Compute fast metrics 03/13/2025, 19:45:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.02it/s]
2025-03-13 19:45:48,595 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3840 secs
2025-03-13 19:45:48,597 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.4413 secs
2025-03-13 19:45:48,597 [INFO]: {
2025-03-13 19:45:48,597 [INFO]: 	index_key: HNSW15
2025-03-13 19:45:48,597 [INFO]: 	index_param: efSearch=157
2025-03-13 19:45:48,597 [INFO]: 	index_path: knn.index
2025-03-13 19:45:48,597 [INFO]: 	size in bytes: 1966260610
2025-03-13 19:45:48,597 [INFO]: 	avg_search_speed_ms: 10.307517406751508
2025-03-13 19:45:48,597 [INFO]: 	99p_search_speed_ms: 15.496904677711422
2025-03-13 19:45:48,597 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:45:48,597 [INFO]: 	nb vectors: 9994
2025-03-13 19:45:48,597 [INFO]: 	vectors dimension: 49152
2025-03-13 19:45:48,597 [INFO]: 	compression ratio: 0.9993082005543508
2025-03-13 19:45:48,597 [INFO]: }
2025-03-13 19:45:48,597 [INFO]: 	>>> Finished "Creating the index" in 104.4455 secs
2025-03-13 19:45:48,597 [INFO]: >>> Finished "Launching the whole pipeline" in 104.4764 secs
2025-03-13 19:45:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:45:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 21275 [episode count 19/20]
2025-03-13 19:45:51: [retrieval_preprocessing] finished for 4743066113_push_table_items_left_with_towel [chosen_id count 9/196]
2025-03-13 19:45:51: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
