nohup: ignoring input
2025-03-13 10:51:38: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:51:50: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6489841764_put_in_upper_cabinet [chosen_id count 0/260]
2025-03-13 10:51:50: [retrieval_preprocessing] we have num_total=5794 embedding_dim=49152
[retrieval_preprocessing] for episode 72712 [episode count 0/20], we have num_retrieval=np.int64(5424) num_query=np.int64(370)
2025-03-13 10:51:54,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:55,853 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:55
2025-03-13 10:51:55,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 435.64it/s]
2025-03-13 10:51:55,900 [INFO]: There are 5424 embeddings of dim 49152
2025-03-13 10:51:55,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0469 secs
2025-03-13 10:51:55,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:55
2025-03-13 10:51:55,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:55,901 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:51:55,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:55,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:51:55,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:55
2025-03-13 10:51:55,902 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:55,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0011 secs
2025-03-13 10:51:55,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:55
2025-03-13 10:51:55,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:55,902 [INFO]: 	Creating the index 03/13/2025, 10:51:55
2025-03-13 10:51:55,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:55
2025-03-13 10:51:55,905 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 10:51:55,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:55
2025-03-13 10:51:55,905 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:51:55,905 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:06,  3.30it/s]  9%|▊         | 2/23 [00:00<00:04,  4.39it/s] 17%|█▋        | 4/23 [00:00<00:02,  6.84it/s] 22%|██▏       | 5/23 [00:00<00:02,  6.60it/s] 26%|██▌       | 6/23 [00:00<00:02,  6.46it/s] 30%|███       | 7/23 [00:01<00:02,  6.50it/s] 35%|███▍      | 8/23 [00:01<00:02,  5.96it/s] 39%|███▉      | 9/23 [00:01<00:02,  5.77it/s] 43%|████▎     | 10/23 [00:01<00:02,  5.90it/s] 48%|████▊     | 11/23 [00:01<00:01,  6.01it/s] 52%|█████▏    | 12/23 [00:01<00:01,  6.43it/s] 57%|█████▋    | 13/23 [00:02<00:01,  7.13it/s] 61%|██████    | 14/23 [00:02<00:01,  7.75it/s] 70%|██████▉   | 16/23 [00:02<00:00,  9.26it/s] 78%|███████▊  | 18/23 [00:02<00:00, 10.51it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.23it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.34it/s]100%|██████████| 23/23 [00:07<00:00,  1.26it/s]100%|██████████| 23/23 [00:07<00:00,  2.98it/s]
2025-03-13 10:52:03,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:03
2025-03-13 10:52:45,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1720 secs
2025-03-13 10:52:45,813 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 10:52:45,813 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.25s/it] 50%|█████     | 2/4 [00:02<00:01,  1.02it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.20it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.11s/it]
2025-03-13 10:53:05,831 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0178 secs
2025-03-13 10:53:05,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9267 secs
2025-03-13 10:53:05,832 [INFO]: {
2025-03-13 10:53:05,832 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:05,832 [INFO]: 	index_param: efSearch=183
2025-03-13 10:53:05,832 [INFO]: 	index_path: knn.index
2025-03-13 10:53:05,832 [INFO]: 	size in bytes: 1067140210
2025-03-13 10:53:05,832 [INFO]: 	avg_search_speed_ms: 8.476123887201044
2025-03-13 10:53:05,832 [INFO]: 	99p_search_speed_ms: 12.904292959719902
2025-03-13 10:53:05,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:05,832 [INFO]: 	nb vectors: 5424
2025-03-13 10:53:05,832 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:05,832 [INFO]: 	compression ratio: 0.9993080403183383
2025-03-13 10:53:05,832 [INFO]: }
2025-03-13 10:53:05,832 [INFO]: 	>>> Finished "Creating the index" in 69.9296 secs
2025-03-13 10:53:05,832 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9788 secs
2025-03-13 10:53:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 72712 [episode count 0/20]
[retrieval_preprocessing] for episode 89095 [episode count 1/20], we have num_retrieval=np.int64(5470) num_query=np.int64(324)
2025-03-13 10:53:11,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:12,470 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:12
2025-03-13 10:53:12,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.18it/s]
2025-03-13 10:53:12,499 [INFO]: There are 5470 embeddings of dim 49152
2025-03-13 10:53:12,500 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 10:53:12,500 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:12
2025-03-13 10:53:12,500 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:12,500 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:53:12,500 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:12,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:53:12,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:12
2025-03-13 10:53:12,500 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:12,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:12,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:12
2025-03-13 10:53:12,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:12,500 [INFO]: 	Creating the index 03/13/2025, 10:53:12
2025-03-13 10:53:12,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:12
2025-03-13 10:53:12,502 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 10:53:12,502 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:12
2025-03-13 10:53:12,502 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:53:12,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.38it/s] 13%|█▎        | 3/23 [00:00<00:01, 11.43it/s] 22%|██▏       | 5/23 [00:00<00:01, 13.36it/s] 30%|███       | 7/23 [00:00<00:01, 14.23it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.45it/s] 48%|████▊     | 11/23 [00:00<00:01, 11.67it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.30it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.02it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.89it/s] 83%|████████▎ | 19/23 [00:01<00:00,  9.23it/s] 87%|████████▋ | 20/23 [00:01<00:00,  8.82it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.01it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.26it/s]100%|██████████| 23/23 [00:07<00:00,  1.16it/s]100%|██████████| 23/23 [00:07<00:00,  3.07it/s]
2025-03-13 10:53:20,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:20
2025-03-13 10:54:03,621 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6113 secs
2025-03-13 10:54:03,621 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 10:54:03,621 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 10:54:18,931 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3100 secs
2025-03-13 10:54:18,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4302 secs
2025-03-13 10:54:18,932 [INFO]: {
2025-03-13 10:54:18,932 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:18,932 [INFO]: 	index_param: efSearch=257
2025-03-13 10:54:18,932 [INFO]: 	index_path: knn.index
2025-03-13 10:54:18,932 [INFO]: 	size in bytes: 1076190490
2025-03-13 10:54:18,932 [INFO]: 	avg_search_speed_ms: 11.027415933255867
2025-03-13 10:54:18,932 [INFO]: 	99p_search_speed_ms: 18.751039816997935
2025-03-13 10:54:18,932 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:18,932 [INFO]: 	nb vectors: 5470
2025-03-13 10:54:18,933 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:18,933 [INFO]: 	compression ratio: 0.9993079942566673
2025-03-13 10:54:18,933 [INFO]: }
2025-03-13 10:54:18,933 [INFO]: 	>>> Finished "Creating the index" in 66.4322 secs
2025-03-13 10:54:18,933 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4624 secs
2025-03-13 10:54:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 89095 [episode count 1/20]
[retrieval_preprocessing] for episode 1043 [episode count 2/20], we have num_retrieval=np.int64(5552) num_query=np.int64(242)
2025-03-13 10:54:25,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:26,001 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:26
2025-03-13 10:54:26,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 841.22it/s]
2025-03-13 10:54:26,026 [INFO]: There are 5552 embeddings of dim 49152
2025-03-13 10:54:26,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 10:54:26,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:26,026 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:54:26,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:26,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:26,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,026 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:26,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:26,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:26
2025-03-13 10:54:26,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:26,027 [INFO]: 	Creating the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:26
2025-03-13 10:54:26,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:54:26,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,028 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:54:26,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.29it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.48it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.61it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.41it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.88it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.90it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.23it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.45it/s] 61%|██████    | 14/23 [00:01<00:00,  9.26it/s] 70%|██████▉   | 16/23 [00:01<00:00, 10.33it/s] 78%|███████▊  | 18/23 [00:01<00:00, 10.53it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.38it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.55it/s]100%|██████████| 23/23 [00:07<00:00,  1.27it/s]100%|██████████| 23/23 [00:07<00:00,  3.22it/s]
2025-03-13 10:54:33,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:33
2025-03-13 10:55:15,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6734 secs
2025-03-13 10:55:15,844 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 10:55:15,844 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 10:55:30,670 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8263 secs
2025-03-13 10:55:30,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6431 secs
2025-03-13 10:55:30,671 [INFO]: {
2025-03-13 10:55:30,671 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:30,671 [INFO]: 	index_param: efSearch=254
2025-03-13 10:55:30,671 [INFO]: 	index_path: knn.index
2025-03-13 10:55:30,671 [INFO]: 	size in bytes: 1092323470
2025-03-13 10:55:30,671 [INFO]: 	avg_search_speed_ms: 9.279153082763399
2025-03-13 10:55:30,671 [INFO]: 	99p_search_speed_ms: 13.154650325886907
2025-03-13 10:55:30,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:30,671 [INFO]: 	nb vectors: 5552
2025-03-13 10:55:30,671 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:30,671 [INFO]: 	compression ratio: 0.9993080309809694
2025-03-13 10:55:30,671 [INFO]: }
2025-03-13 10:55:30,671 [INFO]: 	>>> Finished "Creating the index" in 64.6446 secs
2025-03-13 10:55:30,671 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6705 secs
2025-03-13 10:55:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 1043 [episode count 2/20]
[retrieval_preprocessing] for episode 68634 [episode count 3/20], we have num_retrieval=np.int64(5525) num_query=np.int64(269)
2025-03-13 10:55:35,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:35,832 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:35
2025-03-13 10:55:35,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-13 10:55:35,856 [INFO]: There are 5525 embeddings of dim 49152
2025-03-13 10:55:35,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 10:55:35,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:35
2025-03-13 10:55:35,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:35,856 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:55:35,856 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:35,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:35,856 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:35
2025-03-13 10:55:35,856 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:35,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:55:35,857 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:35
2025-03-13 10:55:35,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:35,857 [INFO]: 	Creating the index 03/13/2025, 10:55:35
2025-03-13 10:55:35,857 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:35
2025-03-13 10:55:35,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:55:35,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:35
2025-03-13 10:55:35,858 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:55:35,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.94it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.97it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.47it/s] 30%|███       | 7/23 [00:00<00:01, 12.56it/s] 39%|███▉      | 9/23 [00:00<00:01, 13.33it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.88it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.09it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.28it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.88it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.70it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.63it/s]100%|██████████| 23/23 [00:06<00:00,  1.64it/s]100%|██████████| 23/23 [00:06<00:00,  3.59it/s]
2025-03-13 10:55:42,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:42
2025-03-13 10:56:23,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9793 secs
2025-03-13 10:56:23,245 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 10:56:23,245 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-13 10:56:37,381 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1365 secs
2025-03-13 10:56:37,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5247 secs
2025-03-13 10:56:37,383 [INFO]: {
2025-03-13 10:56:37,383 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:37,383 [INFO]: 	index_param: efSearch=224
2025-03-13 10:56:37,383 [INFO]: 	index_path: knn.index
2025-03-13 10:56:37,383 [INFO]: 	size in bytes: 1087011370
2025-03-13 10:56:37,383 [INFO]: 	avg_search_speed_ms: 10.394983720653952
2025-03-13 10:56:37,383 [INFO]: 	99p_search_speed_ms: 18.976475233212113
2025-03-13 10:56:37,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:37,383 [INFO]: 	nb vectors: 5525
2025-03-13 10:56:37,383 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:37,383 [INFO]: 	compression ratio: 0.9993080385166533
2025-03-13 10:56:37,383 [INFO]: }
2025-03-13 10:56:37,383 [INFO]: 	>>> Finished "Creating the index" in 61.5262 secs
2025-03-13 10:56:37,383 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5508 secs
2025-03-13 10:56:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 68634 [episode count 3/20]
[retrieval_preprocessing] for episode 78381 [episode count 4/20], we have num_retrieval=np.int64(5527) num_query=np.int64(267)
2025-03-13 10:56:43,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:44,081 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:44
2025-03-13 10:56:44,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 935.81it/s]
2025-03-13 10:56:44,111 [INFO]: There are 5527 embeddings of dim 49152
2025-03-13 10:56:44,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 10:56:44,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:44
2025-03-13 10:56:44,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:44,112 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:56:44,112 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:44,112 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:56:44,112 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:44
2025-03-13 10:56:44,112 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:44,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:56:44,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:44
2025-03-13 10:56:44,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:44,113 [INFO]: 	Creating the index 03/13/2025, 10:56:44
2025-03-13 10:56:44,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:44
2025-03-13 10:56:44,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:56:44,117 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:44
2025-03-13 10:56:44,117 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:56:44,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.84it/s]  9%|▊         | 2/23 [00:00<00:03,  6.56it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.43it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.93it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.23it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.37it/s] 30%|███       | 7/23 [00:00<00:01,  8.59it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.64it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.68it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.71it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.72it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.86it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.84it/s] 61%|██████    | 14/23 [00:01<00:01,  8.90it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.93it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.99it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.09it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.97it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.89it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.08it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.39it/s]100%|██████████| 23/23 [00:07<00:00,  1.21it/s]100%|██████████| 23/23 [00:07<00:00,  3.19it/s]
2025-03-13 10:56:51,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:51
2025-03-13 10:57:34,078 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7469 secs
2025-03-13 10:57:34,078 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 10:57:34,078 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 10:57:48,511 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4329 secs
2025-03-13 10:57:48,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3949 secs
2025-03-13 10:57:48,512 [INFO]: {
2025-03-13 10:57:48,512 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:48,512 [INFO]: 	index_param: efSearch=224
2025-03-13 10:57:48,512 [INFO]: 	index_path: knn.index
2025-03-13 10:57:48,512 [INFO]: 	size in bytes: 1087404850
2025-03-13 10:57:48,512 [INFO]: 	avg_search_speed_ms: 9.355445278954837
2025-03-13 10:57:48,512 [INFO]: 	99p_search_speed_ms: 12.791981892660255
2025-03-13 10:57:48,512 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:48,512 [INFO]: 	nb vectors: 5527
2025-03-13 10:57:48,512 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:48,512 [INFO]: 	compression ratio: 0.9993080461246793
2025-03-13 10:57:48,512 [INFO]: }
2025-03-13 10:57:48,512 [INFO]: 	>>> Finished "Creating the index" in 64.3990 secs
2025-03-13 10:57:48,512 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4308 secs
2025-03-13 10:57:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 78381 [episode count 4/20]
[retrieval_preprocessing] for episode 52281 [episode count 5/20], we have num_retrieval=np.int64(5487) num_query=np.int64(307)
2025-03-13 10:57:52,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:53,258 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:53
2025-03-13 10:57:53,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.19it/s]
2025-03-13 10:57:53,279 [INFO]: There are 5487 embeddings of dim 49152
2025-03-13 10:57:53,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0209 secs
2025-03-13 10:57:53,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:53
2025-03-13 10:57:53,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:53,279 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:57:53,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:53,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:53,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:53
2025-03-13 10:57:53,279 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:53,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:53,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:53
2025-03-13 10:57:53,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:53,279 [INFO]: 	Creating the index 03/13/2025, 10:57:53
2025-03-13 10:57:53,279 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:53
2025-03-13 10:57:53,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:57:53,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:53
2025-03-13 10:57:53,280 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:57:53,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.92it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.13it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.98it/s] 30%|███       | 7/23 [00:00<00:01, 11.16it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.28it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.37it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.36it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.32it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.24it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.11it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.67it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.96it/s]100%|██████████| 23/23 [00:06<00:00,  1.60it/s]100%|██████████| 23/23 [00:06<00:00,  3.59it/s]
2025-03-13 10:57:59,689 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:59
2025-03-13 10:58:43,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0862 secs
2025-03-13 10:58:43,776 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 10:58:43,776 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 10:58:57,602 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8258 secs
2025-03-13 10:58:57,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3220 secs
2025-03-13 10:58:57,603 [INFO]: {
2025-03-13 10:58:57,603 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:57,603 [INFO]: 	index_param: efSearch=261
2025-03-13 10:58:57,603 [INFO]: 	index_path: knn.index
2025-03-13 10:58:57,603 [INFO]: 	size in bytes: 1079535190
2025-03-13 10:58:57,603 [INFO]: 	avg_search_speed_ms: 9.573181067330486
2025-03-13 10:58:57,603 [INFO]: 	99p_search_speed_ms: 11.958048390224574
2025-03-13 10:58:57,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:57,603 [INFO]: 	nb vectors: 5487
2025-03-13 10:58:57,603 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:57,603 [INFO]: 	compression ratio: 0.9993079484514071
2025-03-13 10:58:57,603 [INFO]: }
2025-03-13 10:58:57,603 [INFO]: 	>>> Finished "Creating the index" in 64.3233 secs
2025-03-13 10:58:57,603 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3449 secs
2025-03-13 10:58:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 52281 [episode count 5/20]
[retrieval_preprocessing] for episode 77886 [episode count 6/20], we have num_retrieval=np.int64(5520) num_query=np.int64(274)
2025-03-13 10:59:03,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:03,938 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:03
2025-03-13 10:59:03,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-13 10:59:03,963 [INFO]: There are 5520 embeddings of dim 49152
2025-03-13 10:59:03,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 10:59:03,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:03
2025-03-13 10:59:03,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:03,963 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 10:59:03,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:03,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:03,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:03
2025-03-13 10:59:03,963 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:03,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:03,963 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:03
2025-03-13 10:59:03,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:03,964 [INFO]: 	Creating the index 03/13/2025, 10:59:03
2025-03-13 10:59:03,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:03
2025-03-13 10:59:03,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:59:03,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:03
2025-03-13 10:59:03,965 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 10:59:03,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.40it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.77it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.21it/s] 30%|███       | 7/23 [00:00<00:01, 11.15it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.54it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.90it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.18it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.33it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.43it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.28it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.62it/s]100%|██████████| 23/23 [00:06<00:00,  1.63it/s]100%|██████████| 23/23 [00:06<00:00,  3.53it/s]
2025-03-13 10:59:10,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:10
2025-03-13 10:59:53,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0678 secs
2025-03-13 10:59:53,551 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 10:59:53,551 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 11:00:07,428 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8775 secs
2025-03-13 11:00:07,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4642 secs
2025-03-13 11:00:07,430 [INFO]: {
2025-03-13 11:00:07,430 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:07,430 [INFO]: 	index_param: efSearch=177
2025-03-13 11:00:07,430 [INFO]: 	index_path: knn.index
2025-03-13 11:00:07,430 [INFO]: 	size in bytes: 1086027670
2025-03-13 11:00:07,430 [INFO]: 	avg_search_speed_ms: 8.309805482596543
2025-03-13 11:00:07,430 [INFO]: 	99p_search_speed_ms: 12.078110571019351
2025-03-13 11:00:07,430 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:07,430 [INFO]: 	nb vectors: 5520
2025-03-13 11:00:07,430 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:07,430 [INFO]: 	compression ratio: 0.9993080194724688
2025-03-13 11:00:07,430 [INFO]: }
2025-03-13 11:00:07,430 [INFO]: 	>>> Finished "Creating the index" in 63.4662 secs
2025-03-13 11:00:07,430 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4920 secs
2025-03-13 11:00:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 77886 [episode count 6/20]
[retrieval_preprocessing] for episode 93763 [episode count 7/20], we have num_retrieval=np.int64(5522) num_query=np.int64(272)
2025-03-13 11:00:11,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:12,288 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:12
2025-03-13 11:00:12,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.01it/s]
2025-03-13 11:00:12,312 [INFO]: There are 5522 embeddings of dim 49152
2025-03-13 11:00:12,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:00:12,312 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:12
2025-03-13 11:00:12,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:12,313 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:00:12,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:12,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:12,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:12
2025-03-13 11:00:12,313 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:12,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:00:12,313 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:12
2025-03-13 11:00:12,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:12,313 [INFO]: 	Creating the index 03/13/2025, 11:00:12
2025-03-13 11:00:12,313 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:12
2025-03-13 11:00:12,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:00:12,314 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:12
2025-03-13 11:00:12,314 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:00:12,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.55it/s]  9%|▊         | 2/23 [00:00<00:02,  7.12it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.79it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.23it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.47it/s] 26%|██▌       | 6/23 [00:00<00:01,  8.80it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.26it/s] 39%|███▉      | 9/23 [00:01<00:01,  9.14it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.10it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.04it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.12it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.09it/s] 61%|██████    | 14/23 [00:01<00:00,  9.07it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.97it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.91it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.95it/s] 83%|████████▎ | 19/23 [00:02<00:00,  9.92it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.36it/s]100%|██████████| 23/23 [00:06<00:00,  1.44it/s]100%|██████████| 23/23 [00:06<00:00,  3.39it/s]
2025-03-13 11:00:19,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:19
2025-03-13 11:01:01,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5834 secs
2025-03-13 11:01:01,681 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 11:01:01,681 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-13 11:01:16,938 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2570 secs
2025-03-13 11:01:16,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6244 secs
2025-03-13 11:01:16,939 [INFO]: {
2025-03-13 11:01:16,939 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:16,939 [INFO]: 	index_param: efSearch=218
2025-03-13 11:01:16,939 [INFO]: 	index_path: knn.index
2025-03-13 11:01:16,939 [INFO]: 	size in bytes: 1086421150
2025-03-13 11:01:16,939 [INFO]: 	avg_search_speed_ms: 9.754813614687542
2025-03-13 11:01:16,939 [INFO]: 	99p_search_speed_ms: 15.121865989640355
2025-03-13 11:01:16,939 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:16,939 [INFO]: 	nb vectors: 5522
2025-03-13 11:01:16,940 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:16,940 [INFO]: 	compression ratio: 0.9993080270942811
2025-03-13 11:01:16,940 [INFO]: }
2025-03-13 11:01:16,940 [INFO]: 	>>> Finished "Creating the index" in 64.6265 secs
2025-03-13 11:01:16,940 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6512 secs
2025-03-13 11:01:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 93763 [episode count 7/20]
[retrieval_preprocessing] for episode 81479 [episode count 8/20], we have num_retrieval=np.int64(5486) num_query=np.int64(308)
2025-03-13 11:01:20,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:21,599 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:21
2025-03-13 11:01:21,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.96it/s]
2025-03-13 11:01:21,623 [INFO]: There are 5486 embeddings of dim 49152
2025-03-13 11:01:21,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:01:21,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:21
2025-03-13 11:01:21,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:21,624 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:01:21,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:21,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:21,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:21
2025-03-13 11:01:21,624 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:21,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:01:21,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:21
2025-03-13 11:01:21,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:21,624 [INFO]: 	Creating the index 03/13/2025, 11:01:21
2025-03-13 11:01:21,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:21
2025-03-13 11:01:21,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:01:21,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:21
2025-03-13 11:01:21,625 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:01:21,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.18it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.98it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.23it/s] 30%|███       | 7/23 [00:00<00:01, 10.66it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.07it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.27it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.71it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.95it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.35it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.94it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.59it/s]100%|██████████| 23/23 [00:06<00:00,  1.58it/s]100%|██████████| 23/23 [00:06<00:00,  3.44it/s]
2025-03-13 11:01:28,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:28
2025-03-13 11:02:10,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4475 secs
2025-03-13 11:02:10,766 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 11:02:10,766 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.74it/s]
2025-03-13 11:02:27,321 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5545 secs
2025-03-13 11:02:27,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6968 secs
2025-03-13 11:02:27,322 [INFO]: {
2025-03-13 11:02:27,322 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:27,322 [INFO]: 	index_param: efSearch=161
2025-03-13 11:02:27,322 [INFO]: 	index_path: knn.index
2025-03-13 11:02:27,322 [INFO]: 	size in bytes: 1079338450
2025-03-13 11:02:27,322 [INFO]: 	avg_search_speed_ms: 8.631549396396121
2025-03-13 11:02:27,322 [INFO]: 	99p_search_speed_ms: 14.702610485255729
2025-03-13 11:02:27,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:27,322 [INFO]: 	nb vectors: 5486
2025-03-13 11:02:27,322 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:27,322 [INFO]: 	compression ratio: 0.999307944602548
2025-03-13 11:02:27,322 [INFO]: }
2025-03-13 11:02:27,322 [INFO]: 	>>> Finished "Creating the index" in 65.6982 secs
2025-03-13 11:02:27,322 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7228 secs
2025-03-13 11:02:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 81479 [episode count 8/20]
[retrieval_preprocessing] for episode 1115 [episode count 9/20], we have num_retrieval=np.int64(5549) num_query=np.int64(245)
2025-03-13 11:02:31,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:32,575 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:32
2025-03-13 11:02:32,576 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.15it/s]
2025-03-13 11:02:32,599 [INFO]: There are 5549 embeddings of dim 49152
2025-03-13 11:02:32,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 11:02:32,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:32,599 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:02:32,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:32,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:32,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,599 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:32,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:32,599 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:32
2025-03-13 11:02:32,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:32,600 [INFO]: 	Creating the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:32
2025-03-13 11:02:32,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:02:32,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:32
2025-03-13 11:02:32,601 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:02:32,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.56it/s]  9%|▊         | 2/23 [00:00<00:03,  6.01it/s] 13%|█▎        | 3/23 [00:00<00:03,  6.66it/s] 17%|█▋        | 4/23 [00:00<00:02,  6.97it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.17it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.30it/s] 30%|███       | 7/23 [00:01<00:02,  7.48it/s] 35%|███▍      | 8/23 [00:01<00:01,  7.53it/s] 39%|███▉      | 9/23 [00:01<00:01,  7.61it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.87it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.27it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.32it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.19it/s] 61%|██████    | 14/23 [00:01<00:01,  8.61it/s] 70%|██████▉   | 16/23 [00:02<00:00,  9.48it/s] 78%|███████▊  | 18/23 [00:02<00:00, 10.01it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.34it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.42it/s]100%|██████████| 23/23 [00:07<00:00,  1.23it/s]100%|██████████| 23/23 [00:07<00:00,  3.11it/s]
2025-03-13 11:02:39,995 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:39
2025-03-13 11:03:30,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8709 secs
2025-03-13 11:03:30,867 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 11:03:30,867 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 11:03:45,343 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4751 secs
2025-03-13 11:03:45,345 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7440 secs
2025-03-13 11:03:45,345 [INFO]: {
2025-03-13 11:03:45,345 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:45,345 [INFO]: 	index_param: efSearch=179
2025-03-13 11:03:45,345 [INFO]: 	index_path: knn.index
2025-03-13 11:03:45,345 [INFO]: 	size in bytes: 1091733250
2025-03-13 11:03:45,345 [INFO]: 	avg_search_speed_ms: 9.189955786817283
2025-03-13 11:03:45,345 [INFO]: 	99p_search_speed_ms: 14.861498691607247
2025-03-13 11:03:45,345 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:45,345 [INFO]: 	nb vectors: 5549
2025-03-13 11:03:45,345 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:45,345 [INFO]: 	compression ratio: 0.9993080196101016
2025-03-13 11:03:45,345 [INFO]: }
2025-03-13 11:03:45,345 [INFO]: 	>>> Finished "Creating the index" in 72.7454 secs
2025-03-13 11:03:45,345 [INFO]: >>> Finished "Launching the whole pipeline" in 72.7695 secs
2025-03-13 11:03:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 1115 [episode count 9/20]
[retrieval_preprocessing] for episode 36444 [episode count 10/20], we have num_retrieval=np.int64(5524) num_query=np.int64(270)
2025-03-13 11:03:49,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:50,376 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:50
2025-03-13 11:03:50,376 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.25it/s]
2025-03-13 11:03:50,403 [INFO]: There are 5524 embeddings of dim 49152
2025-03-13 11:03:50,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:03:50,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:50,403 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:03:50,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:50,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:50,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,403 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:50,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:50,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:50
2025-03-13 11:03:50,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:50,404 [INFO]: 	Creating the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:50
2025-03-13 11:03:50,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:03:50,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,405 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:03:50,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.63it/s]  9%|▊         | 2/23 [00:00<00:03,  6.15it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.31it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.15it/s] 35%|███▍      | 8/23 [00:00<00:01, 10.12it/s] 52%|█████▏    | 12/23 [00:01<00:00, 16.49it/s] 70%|██████▉   | 16/23 [00:01<00:00, 22.03it/s] 87%|████████▋ | 20/23 [00:01<00:00, 25.57it/s]100%|██████████| 23/23 [00:07<00:00,  1.65it/s]100%|██████████| 23/23 [00:07<00:00,  3.20it/s]
2025-03-13 11:03:57,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:57
2025-03-13 11:04:45,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1552 secs
2025-03-13 11:04:45,747 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 11:04:45,747 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s]
2025-03-13 11:05:03,268 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5206 secs
2025-03-13 11:05:03,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8640 secs
2025-03-13 11:05:03,269 [INFO]: {
2025-03-13 11:05:03,269 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:03,269 [INFO]: 	index_param: efSearch=152
2025-03-13 11:05:03,269 [INFO]: 	index_path: knn.index
2025-03-13 11:05:03,269 [INFO]: 	size in bytes: 1086814630
2025-03-13 11:05:03,269 [INFO]: 	avg_search_speed_ms: 8.96176017360181
2025-03-13 11:05:03,269 [INFO]: 	99p_search_speed_ms: 11.582230450585485
2025-03-13 11:05:03,269 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:03,269 [INFO]: 	nb vectors: 5524
2025-03-13 11:05:03,269 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:03,269 [INFO]: 	compression ratio: 0.9993080347105743
2025-03-13 11:05:03,269 [INFO]: }
2025-03-13 11:05:03,269 [INFO]: 	>>> Finished "Creating the index" in 72.8655 secs
2025-03-13 11:05:03,269 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8926 secs
2025-03-13 11:05:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 36444 [episode count 10/20]
[retrieval_preprocessing] for episode 21598 [episode count 11/20], we have num_retrieval=np.int64(5471) num_query=np.int64(323)
2025-03-13 11:05:14,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:15,802 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:15
2025-03-13 11:05:15,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1738.21it/s]
2025-03-13 11:05:15,828 [INFO]: There are 5471 embeddings of dim 49152
2025-03-13 11:05:15,829 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 11:05:15,829 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:15
2025-03-13 11:05:15,829 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:15,829 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:05:15,829 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:15,829 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:05:15,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:15
2025-03-13 11:05:15,830 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:15,830 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:05:15,830 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:15
2025-03-13 11:05:15,830 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:15,830 [INFO]: 	Creating the index 03/13/2025, 11:05:15
2025-03-13 11:05:15,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:15
2025-03-13 11:05:15,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:05:15,834 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:15
2025-03-13 11:05:15,834 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:05:15,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.10it/s] 17%|█▋        | 4/23 [00:00<00:01, 12.19it/s] 26%|██▌       | 6/23 [00:01<00:03,  4.64it/s] 30%|███       | 7/23 [00:01<00:03,  4.67it/s] 35%|███▍      | 8/23 [00:01<00:03,  4.25it/s] 39%|███▉      | 9/23 [00:01<00:03,  3.98it/s] 43%|████▎     | 10/23 [00:02<00:03,  4.01it/s] 52%|█████▏    | 12/23 [00:02<00:01,  5.74it/s] 61%|██████    | 14/23 [00:02<00:01,  7.13it/s] 70%|██████▉   | 16/23 [00:02<00:00,  8.60it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.80it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.89it/s] 87%|████████▋ | 20/23 [00:03<00:00,  8.86it/s] 91%|█████████▏| 21/23 [00:07<00:02,  1.07s/it]100%|██████████| 23/23 [00:08<00:00,  1.15it/s]100%|██████████| 23/23 [00:08<00:00,  2.74it/s]
2025-03-13 11:05:24,368 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:24
2025-03-13 11:06:15,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3777 secs
2025-03-13 11:06:15,747 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 11:06:15,747 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 11:06:29,381 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6331 secs
2025-03-13 11:06:29,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.5478 secs
2025-03-13 11:06:29,382 [INFO]: {
2025-03-13 11:06:29,382 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:29,382 [INFO]: 	index_param: efSearch=141
2025-03-13 11:06:29,383 [INFO]: 	index_path: knn.index
2025-03-13 11:06:29,383 [INFO]: 	size in bytes: 1076387230
2025-03-13 11:06:29,383 [INFO]: 	avg_search_speed_ms: 9.471581590222547
2025-03-13 11:06:29,383 [INFO]: 	99p_search_speed_ms: 12.880769523326311
2025-03-13 11:06:29,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:29,383 [INFO]: 	nb vectors: 5471
2025-03-13 11:06:29,383 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:29,383 [INFO]: 	compression ratio: 0.999307998107707
2025-03-13 11:06:29,383 [INFO]: }
2025-03-13 11:06:29,383 [INFO]: 	>>> Finished "Creating the index" in 73.5525 secs
2025-03-13 11:06:29,383 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5806 secs
2025-03-13 11:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 21598 [episode count 11/20]
[retrieval_preprocessing] for episode 88687 [episode count 12/20], we have num_retrieval=np.int64(5493) num_query=np.int64(301)
2025-03-13 11:06:33,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:34,249 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:34
2025-03-13 11:06:34,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1825.99it/s]
2025-03-13 11:06:34,273 [INFO]: There are 5493 embeddings of dim 49152
2025-03-13 11:06:34,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:06:34,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:34,273 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:06:34,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:34,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:34,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,273 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:34,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:34,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:34
2025-03-13 11:06:34,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:34,273 [INFO]: 	Creating the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:34
2025-03-13 11:06:34,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:06:34,274 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:34
2025-03-13 11:06:34,274 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:06:34,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.78it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.18it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.30it/s] 30%|███       | 7/23 [00:00<00:01, 10.51it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.34it/s] 48%|████▊     | 11/23 [00:01<00:01, 10.04it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.79it/s] 61%|██████    | 14/23 [00:01<00:00,  9.04it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.17it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.32it/s] 78%|███████▊  | 18/23 [00:01<00:00,  9.65it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.77it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.02it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.25it/s]100%|██████████| 23/23 [00:08<00:00,  1.03it/s]100%|██████████| 23/23 [00:08<00:00,  2.84it/s]
2025-03-13 11:06:42,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:42
2025-03-13 11:07:28,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6166 secs
2025-03-13 11:07:28,008 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 11:07:28,008 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
2025-03-13 11:07:41,691 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6833 secs
2025-03-13 11:07:41,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4175 secs
2025-03-13 11:07:41,692 [INFO]: {
2025-03-13 11:07:41,692 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:41,692 [INFO]: 	index_param: efSearch=206
2025-03-13 11:07:41,692 [INFO]: 	index_path: knn.index
2025-03-13 11:07:41,692 [INFO]: 	size in bytes: 1080715630
2025-03-13 11:07:41,692 [INFO]: 	avg_search_speed_ms: 9.375560815309042
2025-03-13 11:07:41,692 [INFO]: 	99p_search_speed_ms: 12.84270611591636
2025-03-13 11:07:41,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:41,692 [INFO]: 	nb vectors: 5493
2025-03-13 11:07:41,692 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:41,692 [INFO]: 	compression ratio: 0.999307971515134
2025-03-13 11:07:41,692 [INFO]: }
2025-03-13 11:07:41,692 [INFO]: 	>>> Finished "Creating the index" in 67.4188 secs
2025-03-13 11:07:41,692 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4434 secs
2025-03-13 11:07:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 88687 [episode count 12/20]
[retrieval_preprocessing] for episode 7289 [episode count 13/20], we have num_retrieval=np.int64(5535) num_query=np.int64(259)
2025-03-13 11:07:45,664 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:46,486 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:46
2025-03-13 11:07:46,486 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.84it/s]
2025-03-13 11:07:46,511 [INFO]: There are 5535 embeddings of dim 49152
2025-03-13 11:07:46,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:07:46,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:46
2025-03-13 11:07:46,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:46,512 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:07:46,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:46,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:46,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:46
2025-03-13 11:07:46,512 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:46,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:07:46,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:46
2025-03-13 11:07:46,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:46,512 [INFO]: 	Creating the index 03/13/2025, 11:07:46
2025-03-13 11:07:46,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:46
2025-03-13 11:07:46,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:07:46,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:46
2025-03-13 11:07:46,513 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:07:46,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.98it/s]  9%|▊         | 2/23 [00:00<00:03,  6.40it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.07it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.43it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.66it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.83it/s] 30%|███       | 7/23 [00:00<00:01,  8.05it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.14it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.23it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.44it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.80it/s] 57%|█████▋    | 13/23 [00:01<00:00, 10.05it/s] 61%|██████    | 14/23 [00:01<00:00,  9.68it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.43it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.22it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.16it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.99it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.85it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.90it/s] 91%|█████████▏| 21/23 [00:05<00:02,  1.10s/it] 96%|█████████▌| 22/23 [00:05<00:00,  1.24it/s]100%|██████████| 23/23 [00:07<00:00,  1.09it/s]100%|██████████| 23/23 [00:07<00:00,  3.24it/s]
2025-03-13 11:07:53,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:53
2025-03-13 11:08:38,736 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1093 secs
2025-03-13 11:08:38,737 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:08:38,737 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 11:08:52,998 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2614 secs
2025-03-13 11:08:52,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4858 secs
2025-03-13 11:08:52,999 [INFO]: {
2025-03-13 11:08:52,999 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:52,999 [INFO]: 	index_param: efSearch=198
2025-03-13 11:08:52,999 [INFO]: 	index_path: knn.index
2025-03-13 11:08:52,999 [INFO]: 	size in bytes: 1088978890
2025-03-13 11:08:52,999 [INFO]: 	avg_search_speed_ms: 9.057715037867993
2025-03-13 11:08:52,999 [INFO]: 	99p_search_speed_ms: 13.737553551327442
2025-03-13 11:08:52,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:52,999 [INFO]: 	nb vectors: 5535
2025-03-13 11:08:52,999 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:52,999 [INFO]: 	compression ratio: 0.9993079663830765
2025-03-13 11:08:52,999 [INFO]: }
2025-03-13 11:08:52,999 [INFO]: 	>>> Finished "Creating the index" in 66.4873 secs
2025-03-13 11:08:52,999 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5134 secs
2025-03-13 11:08:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 7289 [episode count 13/20]
[retrieval_preprocessing] for episode 19582 [episode count 14/20], we have num_retrieval=np.int64(5490) num_query=np.int64(304)
2025-03-13 11:08:56,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:57,454 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:57
2025-03-13 11:08:57,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.76it/s]
2025-03-13 11:08:57,479 [INFO]: There are 5490 embeddings of dim 49152
2025-03-13 11:08:57,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:08:57,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:57
2025-03-13 11:08:57,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:57,480 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:08:57,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:57,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:57,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:57
2025-03-13 11:08:57,480 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:57,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:08:57,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:57
2025-03-13 11:08:57,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:57,480 [INFO]: 	Creating the index 03/13/2025, 11:08:57
2025-03-13 11:08:57,480 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:57
2025-03-13 11:08:57,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:08:57,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:57
2025-03-13 11:08:57,482 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:08:57,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.64it/s]  9%|▊         | 2/23 [00:00<00:03,  5.99it/s] 13%|█▎        | 3/23 [00:00<00:02,  6.98it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.58it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.97it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.22it/s] 30%|███       | 7/23 [00:00<00:01,  8.49it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.56it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.59it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.62it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.61it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.72it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.83it/s] 61%|██████    | 14/23 [00:01<00:01,  8.72it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.66it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.86it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.99it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.67it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.45it/s]100%|██████████| 23/23 [00:06<00:00,  1.28it/s]100%|██████████| 23/23 [00:06<00:00,  3.34it/s]
2025-03-13 11:09:04,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:04
2025-03-13 11:09:49,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6494 secs
2025-03-13 11:09:49,016 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 11:09:49,016 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 11:10:03,381 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3651 secs
2025-03-13 11:10:03,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9002 secs
2025-03-13 11:10:03,382 [INFO]: {
2025-03-13 11:10:03,382 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:03,382 [INFO]: 	index_param: efSearch=195
2025-03-13 11:10:03,382 [INFO]: 	index_path: knn.index
2025-03-13 11:10:03,382 [INFO]: 	size in bytes: 1080125410
2025-03-13 11:10:03,382 [INFO]: 	avg_search_speed_ms: 8.14704224732936
2025-03-13 11:10:03,382 [INFO]: 	99p_search_speed_ms: 11.013182858005166
2025-03-13 11:10:03,382 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:03,382 [INFO]: 	nb vectors: 5490
2025-03-13 11:10:03,382 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:03,382 [INFO]: 	compression ratio: 0.999307959989572
2025-03-13 11:10:03,382 [INFO]: }
2025-03-13 11:10:03,382 [INFO]: 	>>> Finished "Creating the index" in 65.9020 secs
2025-03-13 11:10:03,382 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9278 secs
2025-03-13 11:10:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 19582 [episode count 14/20]
[retrieval_preprocessing] for episode 56359 [episode count 15/20], we have num_retrieval=np.int64(5550) num_query=np.int64(244)
2025-03-13 11:10:07,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:08,303 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:08
2025-03-13 11:10:08,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.24it/s]
2025-03-13 11:10:08,329 [INFO]: There are 5550 embeddings of dim 49152
2025-03-13 11:10:08,329 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:10:08,329 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:08
2025-03-13 11:10:08,329 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:08,330 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:10:08,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:08,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:10:08,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:08
2025-03-13 11:10:08,330 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:08,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:10:08,331 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:08
2025-03-13 11:10:08,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:08,331 [INFO]: 	Creating the index 03/13/2025, 11:10:08
2025-03-13 11:10:08,331 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:08
2025-03-13 11:10:08,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:10:08,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:08
2025-03-13 11:10:08,334 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:10:08,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.36it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.90it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.74it/s] 30%|███       | 7/23 [00:00<00:01, 10.02it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.78it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.37it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.85it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.08it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.30it/s] 83%|████████▎ | 19/23 [00:01<00:00,  9.78it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.45it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.55it/s]100%|██████████| 23/23 [00:07<00:00,  1.22it/s]100%|██████████| 23/23 [00:07<00:00,  2.95it/s]
2025-03-13 11:10:16,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:16
2025-03-13 11:10:57,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7861 secs
2025-03-13 11:10:57,926 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 11:10:57,926 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s]
2025-03-13 11:11:11,362 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4358 secs
2025-03-13 11:11:11,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0280 secs
2025-03-13 11:11:11,362 [INFO]: {
2025-03-13 11:11:11,362 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:11,362 [INFO]: 	index_param: efSearch=250
2025-03-13 11:11:11,362 [INFO]: 	index_path: knn.index
2025-03-13 11:11:11,362 [INFO]: 	size in bytes: 1091929990
2025-03-13 11:11:11,362 [INFO]: 	avg_search_speed_ms: 9.30417199640773
2025-03-13 11:11:11,362 [INFO]: 	99p_search_speed_ms: 11.198085602372885
2025-03-13 11:11:11,362 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:11,362 [INFO]: 	nb vectors: 5550
2025-03-13 11:11:11,363 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:11,363 [INFO]: 	compression ratio: 0.9993080234017567
2025-03-13 11:11:11,363 [INFO]: }
2025-03-13 11:11:11,363 [INFO]: 	>>> Finished "Creating the index" in 63.0318 secs
2025-03-13 11:11:11,363 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0595 secs
2025-03-13 11:11:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 56359 [episode count 15/20]
[retrieval_preprocessing] for episode 75398 [episode count 16/20], we have num_retrieval=np.int64(5480) num_query=np.int64(314)
2025-03-13 11:11:15,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:16,465 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:16
2025-03-13 11:11:16,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.13it/s]
2025-03-13 11:11:16,488 [INFO]: There are 5480 embeddings of dim 49152
2025-03-13 11:11:16,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 11:11:16,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:16,488 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:11:16,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:16,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:16,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,489 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:16,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:16,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:16
2025-03-13 11:11:16,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:16,489 [INFO]: 	Creating the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:16
2025-03-13 11:11:16,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:11:16,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,490 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:11:16,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.86it/s] 13%|█▎        | 3/23 [00:00<00:01, 12.42it/s] 22%|██▏       | 5/23 [00:00<00:01, 14.24it/s] 30%|███       | 7/23 [00:00<00:01, 15.56it/s] 39%|███▉      | 9/23 [00:00<00:00, 14.60it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.15it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.38it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.78it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.30it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.96it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.67it/s]100%|██████████| 23/23 [00:06<00:00,  1.70it/s]100%|██████████| 23/23 [00:06<00:00,  3.72it/s]
2025-03-13 11:11:22,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:22
2025-03-13 11:12:03,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1656 secs
2025-03-13 11:12:03,842 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:12:03,843 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-13 11:12:18,145 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3022 secs
2025-03-13 11:12:18,146 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6557 secs
2025-03-13 11:12:18,146 [INFO]: {
2025-03-13 11:12:18,146 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:18,146 [INFO]: 	index_param: efSearch=202
2025-03-13 11:12:18,146 [INFO]: 	index_path: knn.index
2025-03-13 11:12:18,146 [INFO]: 	size in bytes: 1078157950
2025-03-13 11:12:18,146 [INFO]: 	avg_search_speed_ms: 8.856940750557305
2025-03-13 11:12:18,146 [INFO]: 	99p_search_speed_ms: 12.816141657531263
2025-03-13 11:12:18,146 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:18,146 [INFO]: 	nb vectors: 5480
2025-03-13 11:12:18,146 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:18,146 [INFO]: 	compression ratio: 0.9993079770918537
2025-03-13 11:12:18,146 [INFO]: }
2025-03-13 11:12:18,146 [INFO]: 	>>> Finished "Creating the index" in 61.6571 secs
2025-03-13 11:12:18,146 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6811 secs
2025-03-13 11:12:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 75398 [episode count 16/20]
[retrieval_preprocessing] for episode 77451 [episode count 17/20], we have num_retrieval=np.int64(5471) num_query=np.int64(323)
2025-03-13 11:12:22,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:23,471 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:23
2025-03-13 11:12:23,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1550.00it/s]
2025-03-13 11:12:23,497 [INFO]: There are 5471 embeddings of dim 49152
2025-03-13 11:12:23,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:12:23,497 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:23,497 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:12:23,497 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:23,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:23,497 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,497 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:23,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:23,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:23
2025-03-13 11:12:23,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:23,497 [INFO]: 	Creating the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:23
2025-03-13 11:12:23,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:12:23,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,498 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:12:23,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.71it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.45it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.72it/s] 30%|███       | 7/23 [00:00<00:01, 11.30it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.50it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.54it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.61it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.54it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.59it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.60it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.46it/s]100%|██████████| 23/23 [00:06<00:00,  1.54it/s]100%|██████████| 23/23 [00:06<00:00,  3.34it/s]
2025-03-13 11:12:30,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:30
2025-03-13 11:13:23,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9423 secs
2025-03-13 11:13:23,341 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 11:13:23,341 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 11:13:37,188 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8467 secs
2025-03-13 11:13:37,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9079 secs
2025-03-13 11:13:37,407 [INFO]: {
2025-03-13 11:13:37,407 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:37,407 [INFO]: 	index_param: efSearch=121
2025-03-13 11:13:37,407 [INFO]: 	index_path: knn.index
2025-03-13 11:13:37,407 [INFO]: 	size in bytes: 1076387230
2025-03-13 11:13:37,407 [INFO]: 	avg_search_speed_ms: 7.114923995976492
2025-03-13 11:13:37,407 [INFO]: 	99p_search_speed_ms: 11.358882952481514
2025-03-13 11:13:37,407 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:37,407 [INFO]: 	nb vectors: 5471
2025-03-13 11:13:37,407 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:37,407 [INFO]: 	compression ratio: 0.999307998107707
2025-03-13 11:13:37,407 [INFO]: }
2025-03-13 11:13:37,407 [INFO]: 	>>> Finished "Creating the index" in 73.9101 secs
2025-03-13 11:13:37,407 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9363 secs
2025-03-13 11:13:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 77451 [episode count 17/20]
[retrieval_preprocessing] for episode 2201 [episode count 18/20], we have num_retrieval=np.int64(5518) num_query=np.int64(276)
2025-03-13 11:13:39,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:40,627 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:40
2025-03-13 11:13:40,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1049.36it/s]
2025-03-13 11:13:40,658 [INFO]: There are 5518 embeddings of dim 49152
2025-03-13 11:13:40,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:13:40,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:40
2025-03-13 11:13:40,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:40,659 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:13:40,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:40,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:13:40,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:40
2025-03-13 11:13:40,659 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:40,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:13:40,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:40
2025-03-13 11:13:40,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:40,660 [INFO]: 	Creating the index 03/13/2025, 11:13:40
2025-03-13 11:13:40,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:40
2025-03-13 11:13:40,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:13:40,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:40
2025-03-13 11:13:40,664 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:13:40,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.26it/s]  9%|▊         | 2/23 [00:00<00:03,  6.82it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.54it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.93it/s] 30%|███       | 7/23 [00:00<00:01,  9.59it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.66it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.81it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.00it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.91it/s] 61%|██████    | 14/23 [00:01<00:00,  9.49it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.48it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.43it/s] 87%|████████▋ | 20/23 [00:01<00:00, 14.36it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.49it/s]100%|██████████| 23/23 [00:06<00:00,  3.31it/s]
2025-03-13 11:13:47,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:47
2025-03-13 11:14:38,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2040 secs
2025-03-13 11:14:38,833 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 11:14:38,833 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s]
2025-03-13 11:14:52,128 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2940 secs
2025-03-13 11:14:52,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4650 secs
2025-03-13 11:14:52,129 [INFO]: {
2025-03-13 11:14:52,129 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:52,129 [INFO]: 	index_param: efSearch=97
2025-03-13 11:14:52,129 [INFO]: 	index_path: knn.index
2025-03-13 11:14:52,129 [INFO]: 	size in bytes: 1085634190
2025-03-13 11:14:52,129 [INFO]: 	avg_search_speed_ms: 6.276472023970635
2025-03-13 11:14:52,129 [INFO]: 	99p_search_speed_ms: 9.445672025904052
2025-03-13 11:14:52,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:52,129 [INFO]: 	nb vectors: 5518
2025-03-13 11:14:52,129 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:52,129 [INFO]: 	compression ratio: 0.9993080118451317
2025-03-13 11:14:52,129 [INFO]: }
2025-03-13 11:14:52,129 [INFO]: 	>>> Finished "Creating the index" in 71.4688 secs
2025-03-13 11:14:52,129 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5014 secs
2025-03-13 11:14:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 2201 [episode count 18/20]
[retrieval_preprocessing] for episode 64665 [episode count 19/20], we have num_retrieval=np.int64(5492) num_query=np.int64(302)
2025-03-13 11:14:55,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:56,358 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:56
2025-03-13 11:14:56,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 11:14:56,385 [INFO]: There are 5492 embeddings of dim 49152
2025-03-13 11:14:56,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:14:56,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:56
2025-03-13 11:14:56,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:56,386 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:14:56,386 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:56,386 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:56,386 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:56
2025-03-13 11:14:56,386 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:56,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:56,386 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:56
2025-03-13 11:14:56,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:56,386 [INFO]: 	Creating the index 03/13/2025, 11:14:56
2025-03-13 11:14:56,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:56
2025-03-13 11:14:56,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:14:56,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:56
2025-03-13 11:14:56,388 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:14:56,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.28it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.99it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.28it/s] 30%|███       | 7/23 [00:00<00:01, 10.99it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.28it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.10it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.16it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.48it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.38it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.51it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.38it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.63it/s]100%|██████████| 23/23 [00:07<00:00,  1.31it/s]100%|██████████| 23/23 [00:07<00:00,  3.06it/s]
2025-03-13 11:15:03,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:03
2025-03-13 11:15:49,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4975 secs
2025-03-13 11:15:49,400 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:15:49,400 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 11:16:03,303 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9031 secs
2025-03-13 11:16:03,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9158 secs
2025-03-13 11:16:03,304 [INFO]: {
2025-03-13 11:16:03,304 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:03,304 [INFO]: 	index_param: efSearch=223
2025-03-13 11:16:03,304 [INFO]: 	index_path: knn.index
2025-03-13 11:16:03,304 [INFO]: 	size in bytes: 1080518890
2025-03-13 11:16:03,304 [INFO]: 	avg_search_speed_ms: 9.349469999808854
2025-03-13 11:16:03,304 [INFO]: 	99p_search_speed_ms: 12.847757274284952
2025-03-13 11:16:03,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:03,304 [INFO]: 	nb vectors: 5492
2025-03-13 11:16:03,304 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:03,304 [INFO]: 	compression ratio: 0.999307967674679
2025-03-13 11:16:03,304 [INFO]: }
2025-03-13 11:16:03,304 [INFO]: 	>>> Finished "Creating the index" in 66.9175 secs
2025-03-13 11:16:03,304 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9458 secs
2025-03-13 11:16:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 64665 [episode count 19/20]
2025-03-13 11:16:05: [retrieval_preprocessing] finished for 6489841764_put_in_upper_cabinet [chosen_id count 0/260]
2025-03-13 11:16:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6489841764_remove_from_sink [chosen_id count 1/260]
2025-03-13 11:16:09: [retrieval_preprocessing] we have num_total=5224 embedding_dim=49152
[retrieval_preprocessing] for episode 53339 [episode count 0/20], we have num_retrieval=np.int64(5008) num_query=np.int64(216)
2025-03-13 11:16:10,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:11,023 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:11
2025-03-13 11:16:11,024 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-13 11:16:11,047 [INFO]: There are 5008 embeddings of dim 49152
2025-03-13 11:16:11,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:16:11,048 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:11,048 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:16:11,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:11,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:11,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,048 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:11,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:11,048 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:11
2025-03-13 11:16:11,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:11,048 [INFO]: 	Creating the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:11
2025-03-13 11:16:11,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:16:11,049 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,049 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:16:11,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.77it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.32it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.67it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.75it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.79it/s] 55%|█████▌    | 11/20 [00:00<00:00, 13.19it/s] 65%|██████▌   | 13/20 [00:01<00:00, 14.16it/s] 75%|███████▌  | 15/20 [00:01<00:00, 14.87it/s] 85%|████████▌ | 17/20 [00:01<00:00, 14.98it/s] 95%|█████████▌| 19/20 [00:01<00:00, 15.74it/s]100%|██████████| 20/20 [00:05<00:00,  3.96it/s]
2025-03-13 11:16:16,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:16
2025-03-13 11:16:53,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7523 secs
2025-03-13 11:16:53,860 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 11:16:53,860 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 11:17:07,835 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9757 secs
2025-03-13 11:17:07,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7899 secs
2025-03-13 11:17:07,839 [INFO]: {
2025-03-13 11:17:07,839 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:07,839 [INFO]: 	index_param: efSearch=199
2025-03-13 11:17:07,839 [INFO]: 	index_path: knn.index
2025-03-13 11:17:07,839 [INFO]: 	size in bytes: 985294150
2025-03-13 11:17:07,839 [INFO]: 	avg_search_speed_ms: 8.197848356451045
2025-03-13 11:17:07,839 [INFO]: 	99p_search_speed_ms: 10.52833563880995
2025-03-13 11:17:07,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:07,839 [INFO]: 	nb vectors: 5008
2025-03-13 11:17:07,839 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:07,839 [INFO]: 	compression ratio: 0.9993085455749433
2025-03-13 11:17:07,839 [INFO]: }
2025-03-13 11:17:07,839 [INFO]: 	>>> Finished "Creating the index" in 56.7914 secs
2025-03-13 11:17:07,839 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8158 secs
2025-03-13 11:17:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 53339 [episode count 0/20]
[retrieval_preprocessing] for episode 86632 [episode count 1/20], we have num_retrieval=np.int64(4955) num_query=np.int64(269)
2025-03-13 11:17:11,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:12,323 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:12
2025-03-13 11:17:12,323 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-13 11:17:12,347 [INFO]: There are 4955 embeddings of dim 49152
2025-03-13 11:17:12,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:17:12,347 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:12
2025-03-13 11:17:12,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:12,347 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:17:12,347 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:12,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:12,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:12
2025-03-13 11:17:12,347 [INFO]: 1022.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:12,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:12,347 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:12
2025-03-13 11:17:12,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:12,347 [INFO]: 	Creating the index 03/13/2025, 11:17:12
2025-03-13 11:17:12,347 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:12
2025-03-13 11:17:12,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:17:12,348 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:12
2025-03-13 11:17:12,348 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:17:12,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.98it/s] 15%|█▌        | 3/20 [00:00<00:01, 11.10it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.76it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.20it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.51it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.58it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.83it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.17it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.43it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.80it/s]100%|██████████| 20/20 [00:05<00:00,  3.59it/s]
2025-03-13 11:17:17,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:17
2025-03-13 11:18:02,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3914 secs
2025-03-13 11:18:02,313 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:18:02,313 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 11:18:17,082 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7688 secs
2025-03-13 11:18:17,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7373 secs
2025-03-13 11:18:17,086 [INFO]: {
2025-03-13 11:18:17,086 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:17,086 [INFO]: 	index_param: efSearch=295
2025-03-13 11:18:17,086 [INFO]: 	index_path: knn.index
2025-03-13 11:18:17,086 [INFO]: 	size in bytes: 974866630
2025-03-13 11:18:17,086 [INFO]: 	avg_search_speed_ms: 11.321541411555646
2025-03-13 11:18:17,086 [INFO]: 	99p_search_speed_ms: 19.462392115965482
2025-03-13 11:18:17,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:17,086 [INFO]: 	nb vectors: 4955
2025-03-13 11:18:17,086 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:17,086 [INFO]: 	compression ratio: 0.9993086336333001
2025-03-13 11:18:17,086 [INFO]: }
2025-03-13 11:18:17,086 [INFO]: 	>>> Finished "Creating the index" in 64.7387 secs
2025-03-13 11:18:17,086 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7634 secs
2025-03-13 11:18:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 86632 [episode count 1/20]
[retrieval_preprocessing] for episode 17536 [episode count 2/20], we have num_retrieval=np.int64(4976) num_query=np.int64(248)
2025-03-13 11:18:21,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:22,593 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:22
2025-03-13 11:18:22,593 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.14it/s]
2025-03-13 11:18:22,616 [INFO]: There are 4976 embeddings of dim 49152
2025-03-13 11:18:22,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 11:18:22,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:22
2025-03-13 11:18:22,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:22,616 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:18:22,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:22,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:22,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:22
2025-03-13 11:18:22,616 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:22,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:18:22,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:22
2025-03-13 11:18:22,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:22,616 [INFO]: 	Creating the index 03/13/2025, 11:18:22
2025-03-13 11:18:22,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:22
2025-03-13 11:18:22,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:18:22,617 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:22
2025-03-13 11:18:22,617 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:18:22,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.53it/s] 10%|█         | 2/20 [00:00<00:03,  5.25it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.52it/s] 20%|██        | 4/20 [00:00<00:02,  7.19it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.58it/s] 30%|███       | 6/20 [00:00<00:01,  8.03it/s] 40%|████      | 8/20 [00:01<00:01,  9.76it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.60it/s] 50%|█████     | 10/20 [00:01<00:01,  9.48it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.52it/s] 60%|██████    | 12/20 [00:01<00:00,  9.37it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.14it/s] 70%|███████   | 14/20 [00:01<00:00,  9.05it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.01it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.42it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.11it/s]100%|██████████| 20/20 [00:05<00:00,  1.09it/s]100%|██████████| 20/20 [00:05<00:00,  3.36it/s]
2025-03-13 11:18:28,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:28
2025-03-13 11:19:12,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8609 secs
2025-03-13 11:19:12,432 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 11:19:12,432 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 11:19:29,535 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1026 secs
2025-03-13 11:19:29,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9206 secs
2025-03-13 11:19:29,538 [INFO]: {
2025-03-13 11:19:29,538 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:29,538 [INFO]: 	index_param: efSearch=276
2025-03-13 11:19:29,538 [INFO]: 	index_path: knn.index
2025-03-13 11:19:29,538 [INFO]: 	size in bytes: 978998170
2025-03-13 11:19:29,538 [INFO]: 	avg_search_speed_ms: 10.138160927719394
2025-03-13 11:19:29,538 [INFO]: 	99p_search_speed_ms: 14.781490131281315
2025-03-13 11:19:29,538 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:29,538 [INFO]: 	nb vectors: 4976
2025-03-13 11:19:29,538 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:29,538 [INFO]: 	compression ratio: 0.9993087198518461
2025-03-13 11:19:29,538 [INFO]: }
2025-03-13 11:19:29,538 [INFO]: 	>>> Finished "Creating the index" in 66.9220 secs
2025-03-13 11:19:29,538 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9452 secs
2025-03-13 11:19:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 17536 [episode count 2/20]
[retrieval_preprocessing] for episode 65765 [episode count 3/20], we have num_retrieval=np.int64(4963) num_query=np.int64(261)
2025-03-13 11:19:33,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:34,703 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:34
2025-03-13 11:19:34,703 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-13 11:19:34,727 [INFO]: There are 4963 embeddings of dim 49152
2025-03-13 11:19:34,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:19:34,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:34
2025-03-13 11:19:34,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:34,727 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:19:34,728 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:34,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:34,728 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:34
2025-03-13 11:19:34,728 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:34,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:34,728 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:34
2025-03-13 11:19:34,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:34,728 [INFO]: 	Creating the index 03/13/2025, 11:19:34
2025-03-13 11:19:34,728 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:34
2025-03-13 11:19:34,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:34,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:34
2025-03-13 11:19:34,729 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:19:34,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.21it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.83it/s] 20%|██        | 4/20 [00:00<00:02,  7.97it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.93it/s] 30%|███       | 6/20 [00:00<00:01,  7.78it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.54it/s] 40%|████      | 8/20 [00:01<00:01,  7.33it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.26it/s] 50%|█████     | 10/20 [00:01<00:01,  7.31it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.25it/s] 60%|██████    | 12/20 [00:01<00:01,  7.23it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.84it/s] 70%|███████   | 14/20 [00:01<00:00,  8.20it/s] 80%|████████  | 16/20 [00:02<00:00,  9.06it/s] 85%|████████▌ | 17/20 [00:02<00:00,  9.10it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.09it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.03it/s]100%|██████████| 20/20 [00:06<00:00,  1.22s/it]100%|██████████| 20/20 [00:06<00:00,  3.11it/s]
2025-03-13 11:19:41,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:41
2025-03-13 11:20:24,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2768 secs
2025-03-13 11:20:24,439 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 11:20:24,439 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.78it/s]
2025-03-13 11:20:38,415 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9759 secs
2025-03-13 11:20:38,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6893 secs
2025-03-13 11:20:38,418 [INFO]: {
2025-03-13 11:20:38,418 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:38,418 [INFO]: 	index_param: efSearch=297
2025-03-13 11:20:38,418 [INFO]: 	index_path: knn.index
2025-03-13 11:20:38,419 [INFO]: 	size in bytes: 976440550
2025-03-13 11:20:38,419 [INFO]: 	avg_search_speed_ms: 11.023345013182968
2025-03-13 11:20:38,419 [INFO]: 	99p_search_speed_ms: 14.680773937143375
2025-03-13 11:20:38,419 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:38,419 [INFO]: 	nb vectors: 4963
2025-03-13 11:20:38,419 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:38,419 [INFO]: 	compression ratio: 0.9993086665644928
2025-03-13 11:20:38,419 [INFO]: }
2025-03-13 11:20:38,419 [INFO]: 	>>> Finished "Creating the index" in 63.6907 secs
2025-03-13 11:20:38,419 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7152 secs
2025-03-13 11:20:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 65765 [episode count 3/20]
[retrieval_preprocessing] for episode 33356 [episode count 4/20], we have num_retrieval=np.int64(4959) num_query=np.int64(265)
2025-03-13 11:20:43,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:43,761 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:43
2025-03-13 11:20:43,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2231.01it/s]
2025-03-13 11:20:43,783 [INFO]: There are 4959 embeddings of dim 49152
2025-03-13 11:20:43,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 11:20:43,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:43
2025-03-13 11:20:43,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:43,783 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:20:43,783 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:43,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:43,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:43
2025-03-13 11:20:43,784 [INFO]: 1023.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:43,784 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:43,784 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:43
2025-03-13 11:20:43,784 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:43,784 [INFO]: 	Creating the index 03/13/2025, 11:20:43
2025-03-13 11:20:43,784 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:43
2025-03-13 11:20:43,785 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:20:43,785 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:43
2025-03-13 11:20:43,785 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:20:43,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.42it/s] 15%|█▌        | 3/20 [00:00<00:01, 12.62it/s] 25%|██▌       | 5/20 [00:00<00:01, 14.59it/s] 35%|███▌      | 7/20 [00:00<00:00, 15.68it/s] 45%|████▌     | 9/20 [00:00<00:00, 16.11it/s] 55%|█████▌    | 11/20 [00:00<00:00, 16.41it/s] 65%|██████▌   | 13/20 [00:00<00:00, 16.51it/s] 75%|███████▌  | 15/20 [00:00<00:00, 16.66it/s] 85%|████████▌ | 17/20 [00:01<00:00, 16.80it/s] 95%|█████████▌| 19/20 [00:01<00:00, 16.88it/s]100%|██████████| 20/20 [00:04<00:00,  4.40it/s]
2025-03-13 11:20:48,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:48
2025-03-13 11:21:39,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2798 secs
2025-03-13 11:21:39,619 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 11:21:39,619 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 11:21:52,904 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2854 secs
2025-03-13 11:21:52,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1227 secs
2025-03-13 11:21:52,908 [INFO]: {
2025-03-13 11:21:52,908 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:52,908 [INFO]: 	index_param: efSearch=277
2025-03-13 11:21:52,908 [INFO]: 	index_path: knn.index
2025-03-13 11:21:52,908 [INFO]: 	size in bytes: 975653590
2025-03-13 11:21:52,908 [INFO]: 	avg_search_speed_ms: 9.750736200388658
2025-03-13 11:21:52,908 [INFO]: 	99p_search_speed_ms: 15.40456764632836
2025-03-13 11:21:52,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:52,908 [INFO]: 	nb vectors: 4959
2025-03-13 11:21:52,908 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:52,908 [INFO]: 	compression ratio: 0.9993086501121776
2025-03-13 11:21:52,908 [INFO]: }
2025-03-13 11:21:52,908 [INFO]: 	>>> Finished "Creating the index" in 69.1241 secs
2025-03-13 11:21:52,908 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1472 secs
2025-03-13 11:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 33356 [episode count 4/20]
[retrieval_preprocessing] for episode 79741 [episode count 5/20], we have num_retrieval=np.int64(4992) num_query=np.int64(232)
2025-03-13 11:21:57,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:58,114 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:58
2025-03-13 11:21:58,114 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1716.87it/s]
2025-03-13 11:21:58,139 [INFO]: There are 4992 embeddings of dim 49152
2025-03-13 11:21:58,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:21:58,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:58
2025-03-13 11:21:58,140 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:58,140 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:21:58,140 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:58,140 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:21:58,140 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:58
2025-03-13 11:21:58,140 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:58,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:21:58,141 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:58
2025-03-13 11:21:58,141 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:58,141 [INFO]: 	Creating the index 03/13/2025, 11:21:58
2025-03-13 11:21:58,141 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:58
2025-03-13 11:21:58,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 11:21:58,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:58
2025-03-13 11:21:58,144 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:21:58,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.98it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.09it/s] 20%|██        | 4/20 [00:00<00:01,  8.60it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.26it/s] 30%|███       | 6/20 [00:00<00:01,  8.15it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.95it/s] 40%|████      | 8/20 [00:01<00:01,  7.85it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.77it/s] 50%|█████     | 10/20 [00:01<00:01,  7.70it/s] 60%|██████    | 12/20 [00:01<00:00, 10.16it/s] 70%|███████   | 14/20 [00:01<00:00, 11.41it/s] 80%|████████  | 16/20 [00:01<00:00, 10.81it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.26it/s]100%|██████████| 20/20 [00:05<00:00,  1.64it/s]100%|██████████| 20/20 [00:05<00:00,  3.78it/s]
2025-03-13 11:22:03,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:03
2025-03-13 11:22:51,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.5302 secs
2025-03-13 11:22:51,970 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 11:22:51,970 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 11:23:06,387 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4165 secs
2025-03-13 11:23:06,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2472 secs
2025-03-13 11:23:06,391 [INFO]: {
2025-03-13 11:23:06,391 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:06,391 [INFO]: 	index_param: efSearch=246
2025-03-13 11:23:06,391 [INFO]: 	index_path: knn.index
2025-03-13 11:23:06,391 [INFO]: 	size in bytes: 982146250
2025-03-13 11:23:06,391 [INFO]: 	avg_search_speed_ms: 9.710411450970303
2025-03-13 11:23:06,391 [INFO]: 	99p_search_speed_ms: 16.445834040641795
2025-03-13 11:23:06,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:06,391 [INFO]: 	nb vectors: 4992
2025-03-13 11:23:06,391 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:06,391 [INFO]: 	compression ratio: 0.9993085408614043
2025-03-13 11:23:06,391 [INFO]: }
2025-03-13 11:23:06,391 [INFO]: 	>>> Finished "Creating the index" in 68.2504 secs
2025-03-13 11:23:06,391 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2771 secs
2025-03-13 11:23:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 79741 [episode count 5/20]
[retrieval_preprocessing] for episode 31102 [episode count 6/20], we have num_retrieval=np.int64(4849) num_query=np.int64(375)
2025-03-13 11:23:10,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:11,638 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:11
2025-03-13 11:23:11,638 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1827.58it/s]
2025-03-13 11:23:11,661 [INFO]: There are 4849 embeddings of dim 49152
2025-03-13 11:23:11,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 11:23:11,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:11
2025-03-13 11:23:11,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:11,661 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:23:11,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:11,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:11,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:11
2025-03-13 11:23:11,661 [INFO]: 1000.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:11,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:23:11,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:11
2025-03-13 11:23:11,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:11,661 [INFO]: 	Creating the index 03/13/2025, 11:23:11
2025-03-13 11:23:11,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:11
2025-03-13 11:23:11,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:23:11,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:11
2025-03-13 11:23:11,662 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:23:11,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.81it/s] 10%|█         | 2/20 [00:00<00:02,  6.36it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.09it/s] 20%|██        | 4/20 [00:00<00:02,  7.41it/s] 25%|██▌       | 5/20 [00:00<00:02,  7.49it/s] 30%|███       | 6/20 [00:00<00:01,  7.85it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.87it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.80it/s] 50%|█████     | 10/20 [00:01<00:01,  8.58it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.21it/s] 60%|██████    | 12/20 [00:01<00:00,  8.01it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.90it/s] 70%|███████   | 14/20 [00:01<00:00,  7.80it/s] 75%|███████▌  | 15/20 [00:01<00:00,  7.74it/s] 80%|████████  | 16/20 [00:02<00:00,  8.22it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.17it/s]100%|██████████| 20/20 [00:05<00:00,  1.28it/s]100%|██████████| 20/20 [00:05<00:00,  3.42it/s]
2025-03-13 11:23:17,511 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:17
2025-03-13 11:24:00,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6972 secs
2025-03-13 11:24:00,208 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 11:24:00,209 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s]
2025-03-13 11:24:14,100 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8914 secs
2025-03-13 11:24:14,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4412 secs
2025-03-13 11:24:14,104 [INFO]: {
2025-03-13 11:24:14,104 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:14,104 [INFO]: 	index_param: efSearch=287
2025-03-13 11:24:14,104 [INFO]: 	index_path: knn.index
2025-03-13 11:24:14,104 [INFO]: 	size in bytes: 954011770
2025-03-13 11:24:14,104 [INFO]: 	avg_search_speed_ms: 10.483067078306973
2025-03-13 11:24:14,104 [INFO]: 	99p_search_speed_ms: 14.425199604593217
2025-03-13 11:24:14,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:14,104 [INFO]: 	nb vectors: 4849
2025-03-13 11:24:14,104 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:14,104 [INFO]: 	compression ratio: 0.9993086269784701
2025-03-13 11:24:14,104 [INFO]: }
2025-03-13 11:24:14,104 [INFO]: 	>>> Finished "Creating the index" in 62.4426 secs
2025-03-13 11:24:14,104 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4662 secs
2025-03-13 11:24:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 31102 [episode count 6/20]
[retrieval_preprocessing] for episode 69515 [episode count 7/20], we have num_retrieval=np.int64(4989) num_query=np.int64(235)
2025-03-13 11:24:20,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:21,670 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:21
2025-03-13 11:24:21,671 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-13 11:24:21,695 [INFO]: There are 4989 embeddings of dim 49152
2025-03-13 11:24:21,695 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 11:24:21,695 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:21
2025-03-13 11:24:21,695 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:21,695 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:24:21,695 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:21,695 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:21,695 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:21
2025-03-13 11:24:21,695 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:21,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:21,696 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:21
2025-03-13 11:24:21,696 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:21,696 [INFO]: 	Creating the index 03/13/2025, 11:24:21
2025-03-13 11:24:21,696 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:21
2025-03-13 11:24:21,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:24:21,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:21
2025-03-13 11:24:21,697 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:24:21,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.25it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.73it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.88it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.57it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.97it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.18it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.46it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.52it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.64it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.58it/s]100%|██████████| 20/20 [00:05<00:00,  3.46it/s]
2025-03-13 11:24:27,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:27
2025-03-13 11:25:10,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9451 secs
2025-03-13 11:25:10,420 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 11:25:10,420 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
2025-03-13 11:25:26,074 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6535 secs
2025-03-13 11:25:26,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3815 secs
2025-03-13 11:25:26,079 [INFO]: {
2025-03-13 11:25:26,079 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:26,079 [INFO]: 	index_param: efSearch=297
2025-03-13 11:25:26,079 [INFO]: 	index_path: knn.index
2025-03-13 11:25:26,079 [INFO]: 	size in bytes: 981555910
2025-03-13 11:25:26,079 [INFO]: 	avg_search_speed_ms: 10.671878219388322
2025-03-13 11:25:26,079 [INFO]: 	99p_search_speed_ms: 14.567843629047275
2025-03-13 11:25:26,079 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:26,079 [INFO]: 	nb vectors: 4989
2025-03-13 11:25:26,079 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:26,079 [INFO]: 	compression ratio: 0.9993086506911257
2025-03-13 11:25:26,079 [INFO]: }
2025-03-13 11:25:26,079 [INFO]: 	>>> Finished "Creating the index" in 64.3832 secs
2025-03-13 11:25:26,079 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4085 secs
2025-03-13 11:25:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 69515 [episode count 7/20]
[retrieval_preprocessing] for episode 24280 [episode count 8/20], we have num_retrieval=np.int64(4996) num_query=np.int64(228)
2025-03-13 11:25:30,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:30,986 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:30
2025-03-13 11:25:30,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-13 11:25:31,013 [INFO]: There are 4996 embeddings of dim 49152
2025-03-13 11:25:31,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:25:31,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:31
2025-03-13 11:25:31,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:31,014 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:25:31,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:31,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:25:31,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:31
2025-03-13 11:25:31,016 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:31,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:25:31,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:31
2025-03-13 11:25:31,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:31,017 [INFO]: 	Creating the index 03/13/2025, 11:25:31
2025-03-13 11:25:31,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:31
2025-03-13 11:25:31,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:25:31,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:31
2025-03-13 11:25:31,020 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:25:31,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.79it/s] 15%|█▌        | 3/20 [00:00<00:01, 11.93it/s] 25%|██▌       | 5/20 [00:00<00:01, 13.32it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.40it/s] 45%|████▌     | 9/20 [00:00<00:00, 13.41it/s] 55%|█████▌    | 11/20 [00:00<00:00, 13.79it/s] 65%|██████▌   | 13/20 [00:00<00:00, 13.50it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.08it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.64it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.19it/s]100%|██████████| 20/20 [00:05<00:00,  3.89it/s]
2025-03-13 11:25:36,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:36
2025-03-13 11:26:18,682 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5072 secs
2025-03-13 11:26:18,682 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 11:26:18,682 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 11:26:33,352 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6692 secs
2025-03-13 11:26:33,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3350 secs
2025-03-13 11:26:33,355 [INFO]: {
2025-03-13 11:26:33,355 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:33,355 [INFO]: 	index_param: efSearch=275
2025-03-13 11:26:33,355 [INFO]: 	index_path: knn.index
2025-03-13 11:26:33,355 [INFO]: 	size in bytes: 982933270
2025-03-13 11:26:33,355 [INFO]: 	avg_search_speed_ms: 10.672983512920482
2025-03-13 11:26:33,355 [INFO]: 	99p_search_speed_ms: 17.348921122029417
2025-03-13 11:26:33,355 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:33,355 [INFO]: 	nb vectors: 4996
2025-03-13 11:26:33,355 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:33,355 [INFO]: 	compression ratio: 0.9993084962929376
2025-03-13 11:26:33,355 [INFO]: }
2025-03-13 11:26:33,355 [INFO]: 	>>> Finished "Creating the index" in 62.3388 secs
2025-03-13 11:26:33,355 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3692 secs
2025-03-13 11:26:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 24280 [episode count 8/20]
[retrieval_preprocessing] for episode 83317 [episode count 9/20], we have num_retrieval=np.int64(5010) num_query=np.int64(214)
2025-03-13 11:26:37,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:38,172 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:38
2025-03-13 11:26:38,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.75it/s]
2025-03-13 11:26:38,200 [INFO]: There are 5010 embeddings of dim 49152
2025-03-13 11:26:38,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:26:38,200 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:38,201 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:26:38,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:38,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:26:38,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,201 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:38,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:26:38,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:38
2025-03-13 11:26:38,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:38,202 [INFO]: 	Creating the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,202 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:38
2025-03-13 11:26:38,205 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:26:38,205 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:38
2025-03-13 11:26:38,205 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:26:38,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.21it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.91it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.10it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.02it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.45it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.71it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.40it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.91it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.12it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.69it/s]100%|██████████| 20/20 [00:05<00:00,  3.44it/s]
2025-03-13 11:26:44,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:44
2025-03-13 11:27:25,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0892 secs
2025-03-13 11:27:25,129 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:27:25,130 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
2025-03-13 11:27:39,429 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2990 secs
2025-03-13 11:27:39,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2273 secs
2025-03-13 11:27:39,433 [INFO]: {
2025-03-13 11:27:39,433 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:39,433 [INFO]: 	index_param: efSearch=279
2025-03-13 11:27:39,433 [INFO]: 	index_path: knn.index
2025-03-13 11:27:39,433 [INFO]: 	size in bytes: 985687630
2025-03-13 11:27:39,433 [INFO]: 	avg_search_speed_ms: 10.322367874578687
2025-03-13 11:27:39,433 [INFO]: 	99p_search_speed_ms: 16.3374554272741
2025-03-13 11:27:39,433 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:39,433 [INFO]: 	nb vectors: 5010
2025-03-13 11:27:39,433 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:39,433 [INFO]: 	compression ratio: 0.999308553765659
2025-03-13 11:27:39,433 [INFO]: }
2025-03-13 11:27:39,433 [INFO]: 	>>> Finished "Creating the index" in 61.2311 secs
2025-03-13 11:27:39,433 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2603 secs
2025-03-13 11:27:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 83317 [episode count 9/20]
[retrieval_preprocessing] for episode 81626 [episode count 10/20], we have num_retrieval=np.int64(5007) num_query=np.int64(217)
2025-03-13 11:27:43,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:44,295 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:44
2025-03-13 11:27:44,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.68it/s]
2025-03-13 11:27:44,319 [INFO]: There are 5007 embeddings of dim 49152
2025-03-13 11:27:44,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:27:44,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:44
2025-03-13 11:27:44,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:44,320 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:27:44,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:44,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:44,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:44
2025-03-13 11:27:44,320 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:44,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:44,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:44
2025-03-13 11:27:44,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:44,320 [INFO]: 	Creating the index 03/13/2025, 11:27:44
2025-03-13 11:27:44,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:44
2025-03-13 11:27:44,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:27:44,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:44
2025-03-13 11:27:44,321 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:27:44,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.58it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.85it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.99it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.56it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.93it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.16it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.29it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.46it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.52it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.48it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-13 11:27:49,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:49
2025-03-13 11:28:31,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3525 secs
2025-03-13 11:28:31,925 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 11:28:31,925 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 11:28:45,987 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0614 secs
2025-03-13 11:28:45,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6693 secs
2025-03-13 11:28:45,990 [INFO]: {
2025-03-13 11:28:45,990 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:45,990 [INFO]: 	index_param: efSearch=301
2025-03-13 11:28:45,990 [INFO]: 	index_path: knn.index
2025-03-13 11:28:45,990 [INFO]: 	size in bytes: 985097410
2025-03-13 11:28:45,990 [INFO]: 	avg_search_speed_ms: 11.138535938267172
2025-03-13 11:28:45,990 [INFO]: 	99p_search_speed_ms: 14.978452541399745
2025-03-13 11:28:45,990 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:45,990 [INFO]: 	nb vectors: 5007
2025-03-13 11:28:45,990 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:45,990 [INFO]: 	compression ratio: 0.9993085414771317
2025-03-13 11:28:45,990 [INFO]: }
2025-03-13 11:28:45,990 [INFO]: 	>>> Finished "Creating the index" in 61.6706 secs
2025-03-13 11:28:45,990 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6951 secs
2025-03-13 11:28:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 81626 [episode count 10/20]
[retrieval_preprocessing] for episode 41685 [episode count 11/20], we have num_retrieval=np.int64(4987) num_query=np.int64(237)
2025-03-13 11:28:49,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:49,910 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:49
2025-03-13 11:28:49,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.93it/s]
2025-03-13 11:28:49,936 [INFO]: There are 4987 embeddings of dim 49152
2025-03-13 11:28:49,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:28:49,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:49
2025-03-13 11:28:49,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:49,937 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:28:49,937 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:49,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:49,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:49
2025-03-13 11:28:49,937 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:49,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:28:49,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:49
2025-03-13 11:28:49,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:49,937 [INFO]: 	Creating the index 03/13/2025, 11:28:49
2025-03-13 11:28:49,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:49
2025-03-13 11:28:49,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:28:49,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:49
2025-03-13 11:28:49,938 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:28:49,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.05it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.61it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.74it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.03it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.30it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.47it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.48it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.67it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.79it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.95it/s]100%|██████████| 20/20 [00:05<00:00,  3.86it/s]
2025-03-13 11:28:55,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:55
2025-03-13 11:29:39,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9657 secs
2025-03-13 11:29:39,093 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 11:29:39,093 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.98it/s]
2025-03-13 11:29:56,745 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6519 secs
2025-03-13 11:29:56,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8103 secs
2025-03-13 11:29:56,749 [INFO]: {
2025-03-13 11:29:56,749 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:56,749 [INFO]: 	index_param: efSearch=247
2025-03-13 11:29:56,749 [INFO]: 	index_path: knn.index
2025-03-13 11:29:56,749 [INFO]: 	size in bytes: 981162430
2025-03-13 11:29:56,749 [INFO]: 	avg_search_speed_ms: 10.12209500704594
2025-03-13 11:29:56,749 [INFO]: 	99p_search_speed_ms: 15.709025396499783
2025-03-13 11:29:56,749 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:56,749 [INFO]: 	nb vectors: 4987
2025-03-13 11:29:56,749 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:56,749 [INFO]: 	compression ratio: 0.9993086425047889
2025-03-13 11:29:56,749 [INFO]: }
2025-03-13 11:29:56,749 [INFO]: 	>>> Finished "Creating the index" in 66.8118 secs
2025-03-13 11:29:56,749 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8389 secs
2025-03-13 11:29:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 41685 [episode count 11/20]
[retrieval_preprocessing] for episode 21263 [episode count 12/20], we have num_retrieval=np.int64(5009) num_query=np.int64(215)
2025-03-13 11:30:00,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:01,391 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:01
2025-03-13 11:30:01,391 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.43it/s]
2025-03-13 11:30:01,416 [INFO]: There are 5009 embeddings of dim 49152
2025-03-13 11:30:01,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:30:01,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:01
2025-03-13 11:30:01,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:01,416 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:30:01,416 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:01,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:01,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:01
2025-03-13 11:30:01,416 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:01,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:30:01,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:01
2025-03-13 11:30:01,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:01,416 [INFO]: 	Creating the index 03/13/2025, 11:30:01
2025-03-13 11:30:01,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:01
2025-03-13 11:30:01,417 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:01,417 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:01
2025-03-13 11:30:01,418 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:30:01,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.94it/s] 10%|█         | 2/20 [00:00<00:02,  6.50it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.67it/s] 20%|██        | 4/20 [00:00<00:01,  8.24it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.56it/s] 30%|███       | 6/20 [00:00<00:01,  8.65it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.68it/s] 40%|████      | 8/20 [00:00<00:01,  8.65it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.68it/s] 50%|█████     | 10/20 [00:01<00:01,  8.81it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.80it/s] 60%|██████    | 12/20 [00:01<00:00,  8.79it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.80it/s] 70%|███████   | 14/20 [00:01<00:00,  9.13it/s] 80%|████████  | 16/20 [00:01<00:00, 10.26it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.83it/s]100%|██████████| 20/20 [00:05<00:00,  1.43it/s]100%|██████████| 20/20 [00:05<00:00,  3.61it/s]
2025-03-13 11:30:06,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:06
2025-03-13 11:30:52,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1629 secs
2025-03-13 11:30:52,123 [INFO]: The best hyperparameters are: efSearch=324
2025-03-13 11:30:52,123 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 11:31:09,538 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4140 secs
2025-03-13 11:31:09,541 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1232 secs
2025-03-13 11:31:09,541 [INFO]: {
2025-03-13 11:31:09,541 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:09,541 [INFO]: 	index_param: efSearch=324
2025-03-13 11:31:09,541 [INFO]: 	index_path: knn.index
2025-03-13 11:31:09,541 [INFO]: 	size in bytes: 985490890
2025-03-13 11:31:09,541 [INFO]: 	avg_search_speed_ms: 11.982757711649208
2025-03-13 11:31:09,541 [INFO]: 	99p_search_speed_ms: 17.914416957646605
2025-03-13 11:31:09,541 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:09,541 [INFO]: 	nb vectors: 5009
2025-03-13 11:31:09,541 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:09,541 [INFO]: 	compression ratio: 0.9993085496711187
2025-03-13 11:31:09,541 [INFO]: }
2025-03-13 11:31:09,541 [INFO]: 	>>> Finished "Creating the index" in 68.1246 secs
2025-03-13 11:31:09,541 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1502 secs
2025-03-13 11:31:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 21263 [episode count 12/20]
[retrieval_preprocessing] for episode 79648 [episode count 13/20], we have num_retrieval=np.int64(4915) num_query=np.int64(309)
2025-03-13 11:31:13,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:14,237 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:14
2025-03-13 11:31:14,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1796.28it/s]
2025-03-13 11:31:14,260 [INFO]: There are 4915 embeddings of dim 49152
2025-03-13 11:31:14,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:31:14,261 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:14
2025-03-13 11:31:14,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:14,261 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:31:14,261 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:14,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:14,261 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:14
2025-03-13 11:31:14,261 [INFO]: 1014.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:14,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:31:14,261 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:14
2025-03-13 11:31:14,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:14,261 [INFO]: 	Creating the index 03/13/2025, 11:31:14
2025-03-13 11:31:14,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:14
2025-03-13 11:31:14,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:14,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:14
2025-03-13 11:31:14,262 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:31:14,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.31it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.29it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.64it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.23it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.61it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.05it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.38it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.31it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.21it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.23it/s]100%|██████████| 20/20 [00:05<00:00,  3.96it/s]
2025-03-13 11:31:19,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:19
2025-03-13 11:32:04,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1386 secs
2025-03-13 11:32:04,453 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 11:32:04,453 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 11:32:20,828 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3747 secs
2025-03-13 11:32:20,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5688 secs
2025-03-13 11:32:20,831 [INFO]: {
2025-03-13 11:32:20,831 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:20,831 [INFO]: 	index_param: efSearch=254
2025-03-13 11:32:20,831 [INFO]: 	index_path: knn.index
2025-03-13 11:32:20,831 [INFO]: 	size in bytes: 966996730
2025-03-13 11:32:20,831 [INFO]: 	avg_search_speed_ms: 9.397515848312262
2025-03-13 11:32:20,831 [INFO]: 	99p_search_speed_ms: 14.298877259716381
2025-03-13 11:32:20,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:20,831 [INFO]: 	nb vectors: 4915
2025-03-13 11:32:20,831 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:20,831 [INFO]: 	compression ratio: 0.999308777393694
2025-03-13 11:32:20,831 [INFO]: }
2025-03-13 11:32:20,831 [INFO]: 	>>> Finished "Creating the index" in 66.5702 secs
2025-03-13 11:32:20,831 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5941 secs
2025-03-13 11:32:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 79648 [episode count 13/20]
[retrieval_preprocessing] for episode 59806 [episode count 14/20], we have num_retrieval=np.int64(4890) num_query=np.int64(334)
2025-03-13 11:32:26,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:27,689 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:27
2025-03-13 11:32:27,689 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1551.15it/s]
2025-03-13 11:32:27,717 [INFO]: There are 4890 embeddings of dim 49152
2025-03-13 11:32:27,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:32:27,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:27
2025-03-13 11:32:27,718 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:27,718 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:32:27,718 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:27,718 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:32:27,718 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:27
2025-03-13 11:32:27,719 [INFO]: 1009.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:27,719 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:32:27,719 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:27
2025-03-13 11:32:27,719 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:27,719 [INFO]: 	Creating the index 03/13/2025, 11:32:27
2025-03-13 11:32:27,719 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:27
2025-03-13 11:32:27,722 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:32:27,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:27
2025-03-13 11:32:27,723 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:32:27,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.68it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.33it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.20it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.32it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.38it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.55it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.04it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.60it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.48it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.41it/s]100%|██████████| 20/20 [00:05<00:00,  3.93it/s]
2025-03-13 11:32:32,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:32
2025-03-13 11:33:17,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7547 secs
2025-03-13 11:33:17,567 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 11:33:17,567 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 11:33:34,582 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0142 secs
2025-03-13 11:33:34,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8623 secs
2025-03-13 11:33:34,585 [INFO]: {
2025-03-13 11:33:34,585 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:34,585 [INFO]: 	index_param: efSearch=292
2025-03-13 11:33:34,585 [INFO]: 	index_path: knn.index
2025-03-13 11:33:34,585 [INFO]: 	size in bytes: 962078170
2025-03-13 11:33:34,585 [INFO]: 	avg_search_speed_ms: 12.108518389396405
2025-03-13 11:33:34,585 [INFO]: 	99p_search_speed_ms: 17.625595268327743
2025-03-13 11:33:34,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:34,585 [INFO]: 	nb vectors: 4890
2025-03-13 11:33:34,585 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:34,585 [INFO]: 	compression ratio: 0.9993087360042687
2025-03-13 11:33:34,586 [INFO]: }
2025-03-13 11:33:34,586 [INFO]: 	>>> Finished "Creating the index" in 66.8662 secs
2025-03-13 11:33:34,586 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8967 secs
2025-03-13 11:33:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 59806 [episode count 14/20]
[retrieval_preprocessing] for episode 88991 [episode count 15/20], we have num_retrieval=np.int64(4921) num_query=np.int64(303)
2025-03-13 11:33:41,090 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:41,989 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:41
2025-03-13 11:33:41,989 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1772.74it/s]
2025-03-13 11:33:42,014 [INFO]: There are 4921 embeddings of dim 49152
2025-03-13 11:33:42,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:33:42,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:42
2025-03-13 11:33:42,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:42,015 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:33:42,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:42,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:33:42,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:42
2025-03-13 11:33:42,016 [INFO]: 1015.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:42,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:33:42,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:42
2025-03-13 11:33:42,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:42,016 [INFO]: 	Creating the index 03/13/2025, 11:33:42
2025-03-13 11:33:42,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:42
2025-03-13 11:33:42,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:33:42,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:42
2025-03-13 11:33:42,020 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:33:42,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.57it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.37it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.24it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.53it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.81it/s] 50%|█████     | 10/20 [00:01<00:01,  9.83it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.86it/s] 60%|██████    | 12/20 [00:01<00:00,  9.80it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.73it/s] 70%|███████   | 14/20 [00:01<00:00,  9.78it/s] 80%|████████  | 16/20 [00:01<00:00, 11.58it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.95it/s]100%|██████████| 20/20 [00:05<00:00,  1.46it/s]100%|██████████| 20/20 [00:05<00:00,  3.74it/s]
2025-03-13 11:33:47,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:47
2025-03-13 11:34:35,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4820 secs
2025-03-13 11:34:35,860 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 11:34:35,860 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.84it/s] 50%|█████     | 2/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-13 11:34:52,251 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3911 secs
2025-03-13 11:34:52,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2349 secs
2025-03-13 11:34:52,255 [INFO]: {
2025-03-13 11:34:52,255 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:52,255 [INFO]: 	index_param: efSearch=273
2025-03-13 11:34:52,255 [INFO]: 	index_path: knn.index
2025-03-13 11:34:52,255 [INFO]: 	size in bytes: 968177230
2025-03-13 11:34:52,255 [INFO]: 	avg_search_speed_ms: 9.929195262608234
2025-03-13 11:34:52,255 [INFO]: 	99p_search_speed_ms: 13.688291762955481
2025-03-13 11:34:52,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:52,255 [INFO]: 	nb vectors: 4921
2025-03-13 11:34:52,255 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:52,255 [INFO]: 	compression ratio: 0.9993087401983209
2025-03-13 11:34:52,255 [INFO]: }
2025-03-13 11:34:52,255 [INFO]: 	>>> Finished "Creating the index" in 70.2387 secs
2025-03-13 11:34:52,255 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2663 secs
2025-03-13 11:34:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 88991 [episode count 15/20]
[retrieval_preprocessing] for episode 83286 [episode count 16/20], we have num_retrieval=np.int64(4859) num_query=np.int64(365)
2025-03-13 11:34:57,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:57,999 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:57
2025-03-13 11:34:57,999 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.87it/s]
2025-03-13 11:34:58,023 [INFO]: There are 4859 embeddings of dim 49152
2025-03-13 11:34:58,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:34:58,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:58
2025-03-13 11:34:58,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:58,024 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:34:58,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:58,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:58,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:58
2025-03-13 11:34:58,024 [INFO]: 1002.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:58,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:58,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:58
2025-03-13 11:34:58,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:58,024 [INFO]: 	Creating the index 03/13/2025, 11:34:58
2025-03-13 11:34:58,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:58
2025-03-13 11:34:58,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:34:58,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:58
2025-03-13 11:34:58,025 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:34:58,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.10it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.79it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.05it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.64it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.02it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.10it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.18it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.25it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.31it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.37it/s]100%|██████████| 20/20 [00:05<00:00,  3.93it/s]
2025-03-13 11:35:03,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:03
2025-03-13 11:35:47,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0677 secs
2025-03-13 11:35:47,179 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 11:35:47,179 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.18it/s] 50%|█████     | 2/4 [00:00<00:00,  2.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.06it/s]
2025-03-13 11:36:07,152 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9734 secs
2025-03-13 11:36:07,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1312 secs
2025-03-13 11:36:07,157 [INFO]: {
2025-03-13 11:36:07,157 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:07,157 [INFO]: 	index_param: efSearch=275
2025-03-13 11:36:07,157 [INFO]: 	index_path: knn.index
2025-03-13 11:36:07,157 [INFO]: 	size in bytes: 955979170
2025-03-13 11:36:07,157 [INFO]: 	avg_search_speed_ms: 10.878876997796379
2025-03-13 11:36:07,157 [INFO]: 	99p_search_speed_ms: 16.97539781685915
2025-03-13 11:36:07,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:07,157 [INFO]: 	nb vectors: 4859
2025-03-13 11:36:07,157 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:07,157 [INFO]: 	compression ratio: 0.9993086690372134
2025-03-13 11:36:07,157 [INFO]: }
2025-03-13 11:36:07,157 [INFO]: 	>>> Finished "Creating the index" in 69.1326 secs
2025-03-13 11:36:07,157 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1573 secs
2025-03-13 11:36:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 83286 [episode count 16/20]
[retrieval_preprocessing] for episode 94541 [episode count 17/20], we have num_retrieval=np.int64(5000) num_query=np.int64(224)
2025-03-13 11:36:13,519 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:14,472 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:14
2025-03-13 11:36:14,472 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.45it/s]
2025-03-13 11:36:14,499 [INFO]: There are 5000 embeddings of dim 49152
2025-03-13 11:36:14,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:36:14,500 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:14
2025-03-13 11:36:14,500 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:14,500 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:36:14,500 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:14,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:14,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:14
2025-03-13 11:36:14,500 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:14,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:36:14,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:14
2025-03-13 11:36:14,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:14,500 [INFO]: 	Creating the index 03/13/2025, 11:36:14
2025-03-13 11:36:14,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:14
2025-03-13 11:36:14,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:36:14,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:14
2025-03-13 11:36:14,501 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:36:14,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.80it/s] 10%|█         | 2/20 [00:00<00:02,  6.40it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.06it/s] 20%|██        | 4/20 [00:00<00:02,  7.33it/s] 25%|██▌       | 5/20 [00:00<00:02,  7.33it/s] 30%|███       | 6/20 [00:00<00:01,  7.28it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.32it/s] 40%|████      | 8/20 [00:01<00:01,  7.27it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.30it/s] 50%|█████     | 10/20 [00:01<00:01,  7.28it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.28it/s] 60%|██████    | 12/20 [00:01<00:01,  7.36it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.33it/s] 70%|███████   | 14/20 [00:01<00:00,  7.17it/s] 75%|███████▌  | 15/20 [00:02<00:00,  6.76it/s] 80%|████████  | 16/20 [00:02<00:00,  7.34it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.59it/s]100%|██████████| 20/20 [00:05<00:00,  1.28it/s]100%|██████████| 20/20 [00:05<00:00,  3.34it/s]
2025-03-13 11:36:20,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:20
2025-03-13 11:37:09,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.5134 secs
2025-03-13 11:37:09,018 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 11:37:09,018 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.89it/s]
2025-03-13 11:37:31,314 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2961 secs
2025-03-13 11:37:31,318 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8163 secs
2025-03-13 11:37:31,318 [INFO]: {
2025-03-13 11:37:31,318 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:31,318 [INFO]: 	index_param: efSearch=303
2025-03-13 11:37:31,318 [INFO]: 	index_path: knn.index
2025-03-13 11:37:31,318 [INFO]: 	size in bytes: 983720230
2025-03-13 11:37:31,318 [INFO]: 	avg_search_speed_ms: 10.93167304163137
2025-03-13 11:37:31,318 [INFO]: 	99p_search_speed_ms: 15.02477637957782
2025-03-13 11:37:31,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:31,318 [INFO]: 	nb vectors: 5000
2025-03-13 11:37:31,318 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:31,318 [INFO]: 	compression ratio: 0.999308512746556
2025-03-13 11:37:31,318 [INFO]: }
2025-03-13 11:37:31,318 [INFO]: 	>>> Finished "Creating the index" in 76.8179 secs
2025-03-13 11:37:31,318 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8460 secs
2025-03-13 11:37:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 94541 [episode count 17/20]
[retrieval_preprocessing] for episode 32934 [episode count 18/20], we have num_retrieval=np.int64(4993) num_query=np.int64(231)
2025-03-13 11:37:35,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:36,281 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:36
2025-03-13 11:37:36,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2168.72it/s]
2025-03-13 11:37:36,304 [INFO]: There are 4993 embeddings of dim 49152
2025-03-13 11:37:36,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 11:37:36,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:36,304 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:37:36,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:36,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:36,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,305 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:36,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:37:36,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:36
2025-03-13 11:37:36,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:36,305 [INFO]: 	Creating the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:36
2025-03-13 11:37:36,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:36,306 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:36
2025-03-13 11:37:36,306 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:37:36,306 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.34it/s] 15%|█▌        | 3/20 [00:00<00:01, 13.50it/s] 25%|██▌       | 5/20 [00:00<00:00, 15.53it/s] 35%|███▌      | 7/20 [00:00<00:00, 16.45it/s] 45%|████▌     | 9/20 [00:00<00:00, 15.52it/s] 55%|█████▌    | 11/20 [00:00<00:00, 15.64it/s] 65%|██████▌   | 13/20 [00:00<00:00, 15.40it/s] 75%|███████▌  | 15/20 [00:00<00:00, 15.44it/s] 85%|████████▌ | 17/20 [00:01<00:00, 15.50it/s] 95%|█████████▌| 19/20 [00:01<00:00, 14.47it/s]100%|██████████| 20/20 [00:05<00:00,  3.66it/s]
2025-03-13 11:37:41,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:41
2025-03-13 11:38:26,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8330 secs
2025-03-13 11:38:26,612 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 11:38:26,612 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 50%|█████     | 2/4 [00:00<00:00,  4.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.22it/s]
2025-03-13 11:38:46,907 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2955 secs
2025-03-13 11:38:46,911 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6055 secs
2025-03-13 11:38:46,912 [INFO]: {
2025-03-13 11:38:46,912 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:46,912 [INFO]: 	index_param: efSearch=297
2025-03-13 11:38:46,912 [INFO]: 	index_path: knn.index
2025-03-13 11:38:46,912 [INFO]: 	size in bytes: 982342990
2025-03-13 11:38:46,912 [INFO]: 	avg_search_speed_ms: 11.668985632390584
2025-03-13 11:38:46,912 [INFO]: 	99p_search_speed_ms: 19.94005016051229
2025-03-13 11:38:46,912 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:46,912 [INFO]: 	nb vectors: 4993
2025-03-13 11:38:46,912 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:46,912 [INFO]: 	compression ratio: 0.9993085449716499
2025-03-13 11:38:46,912 [INFO]: }
2025-03-13 11:38:46,912 [INFO]: 	>>> Finished "Creating the index" in 70.6070 secs
2025-03-13 11:38:46,912 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6304 secs
2025-03-13 11:38:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 32934 [episode count 18/20]
[retrieval_preprocessing] for episode 18121 [episode count 19/20], we have num_retrieval=np.int64(4978) num_query=np.int64(246)
2025-03-13 11:38:50,819 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:51,845 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:51
2025-03-13 11:38:51,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1566.79it/s]
2025-03-13 11:38:51,869 [INFO]: There are 4978 embeddings of dim 49152
2025-03-13 11:38:51,869 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:38:51,869 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:51
2025-03-13 11:38:51,869 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:51,869 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:38:51,869 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:51,869 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:51,869 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:51
2025-03-13 11:38:51,869 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:51,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:38:51,869 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:51
2025-03-13 11:38:51,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:51,869 [INFO]: 	Creating the index 03/13/2025, 11:38:51
2025-03-13 11:38:51,869 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:51
2025-03-13 11:38:51,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:38:51,870 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:51
2025-03-13 11:38:51,870 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:38:51,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.80it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.70it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.29it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.51it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.52it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.36it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.27it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.13it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.09it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.14it/s]100%|██████████| 20/20 [00:05<00:00,  3.49it/s]
2025-03-13 11:38:57,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:57
2025-03-13 11:39:41,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0470 secs
2025-03-13 11:39:41,663 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:39:41,664 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 11:39:58,744 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0802 secs
2025-03-13 11:39:58,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8772 secs
2025-03-13 11:39:58,748 [INFO]: {
2025-03-13 11:39:58,748 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:58,748 [INFO]: 	index_param: efSearch=295
2025-03-13 11:39:58,748 [INFO]: 	index_path: knn.index
2025-03-13 11:39:58,748 [INFO]: 	size in bytes: 979391710
2025-03-13 11:39:58,748 [INFO]: 	avg_search_speed_ms: 11.580354943429551
2025-03-13 11:39:58,748 [INFO]: 	99p_search_speed_ms: 15.620745713822544
2025-03-13 11:39:58,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:58,748 [INFO]: 	nb vectors: 4978
2025-03-13 11:39:58,748 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:58,748 [INFO]: 	compression ratio: 0.9993086668050315
2025-03-13 11:39:58,748 [INFO]: }
2025-03-13 11:39:58,748 [INFO]: 	>>> Finished "Creating the index" in 66.8787 secs
2025-03-13 11:39:58,748 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9031 secs
2025-03-13 11:40:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 18121 [episode count 19/20]
2025-03-13 11:40:01: [retrieval_preprocessing] finished for 6489841764_remove_from_sink [chosen_id count 1/260]
2025-03-13 11:40:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6498288010_turn_off_extension_cord [chosen_id count 2/260]
2025-03-13 11:40:05: [retrieval_preprocessing] we have num_total=2916 embedding_dim=49152
[retrieval_preprocessing] for episode 75918 [episode count 0/20], we have num_retrieval=np.int64(2725) num_query=np.int64(191)
2025-03-13 11:40:06,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:07,017 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:07
2025-03-13 11:40:07,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1436.41it/s]
2025-03-13 11:40:07,044 [INFO]: There are 2725 embeddings of dim 49152
2025-03-13 11:40:07,044 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:40:07,044 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:07
2025-03-13 11:40:07,044 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:07,044 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:40:07,044 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:07,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:07,045 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:07
2025-03-13 11:40:07,045 [INFO]: 562.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:07,045 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:40:07,045 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:07
2025-03-13 11:40:07,045 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:07,045 [INFO]: 	Creating the index 03/13/2025, 11:40:07
2025-03-13 11:40:07,045 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:07
2025-03-13 11:40:07,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:40:07,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:07
2025-03-13 11:40:07,046 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:40:07,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.74it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.17it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.74it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.08it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.25it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.51it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.55it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.58it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.98it/s]100%|██████████| 11/11 [00:02<00:00,  1.87it/s]100%|██████████| 11/11 [00:02<00:00,  3.70it/s]
2025-03-13 11:40:10,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:10
2025-03-13 11:40:36,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4977 secs
2025-03-13 11:40:36,526 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 11:40:36,527 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 11:40:57,678 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1516 secs
2025-03-13 11:40:57,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7868 secs
2025-03-13 11:40:57,833 [INFO]: {
2025-03-13 11:40:57,833 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:57,833 [INFO]: 	index_param: efSearch=276
2025-03-13 11:40:57,833 [INFO]: 	index_path: knn.index
2025-03-13 11:40:57,834 [INFO]: 	size in bytes: 536126830
2025-03-13 11:40:57,834 [INFO]: 	avg_search_speed_ms: 9.646568965551191
2025-03-13 11:40:57,834 [INFO]: 	99p_search_speed_ms: 13.150744168087845
2025-03-13 11:40:57,834 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:57,834 [INFO]: 	nb vectors: 2725
2025-03-13 11:40:57,834 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:57,834 [INFO]: 	compression ratio: 0.9993098088375842
2025-03-13 11:40:57,834 [INFO]: }
2025-03-13 11:40:57,834 [INFO]: 	>>> Finished "Creating the index" in 50.7891 secs
2025-03-13 11:40:57,834 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8171 secs
2025-03-13 11:40:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 75918 [episode count 0/20]
[retrieval_preprocessing] for episode 8366 [episode count 1/20], we have num_retrieval=np.int64(2801) num_query=np.int64(115)
2025-03-13 11:41:00,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:01,373 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:01
2025-03-13 11:41:01,373 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2820.65it/s]
2025-03-13 11:41:01,396 [INFO]: There are 2801 embeddings of dim 49152
2025-03-13 11:41:01,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:41:01,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:01
2025-03-13 11:41:01,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:01,396 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:41:01,396 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:01,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:01,396 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:01
2025-03-13 11:41:01,397 [INFO]: 578.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:01,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:01,397 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:01
2025-03-13 11:41:01,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:01,397 [INFO]: 	Creating the index 03/13/2025, 11:41:01
2025-03-13 11:41:01,397 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:01
2025-03-13 11:41:01,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:41:01,398 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:01
2025-03-13 11:41:01,398 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:41:01,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.39it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.31it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.32it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.77it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.07it/s] 50%|█████     | 6/12 [00:00<00:00,  9.34it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.54it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.00it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.21it/s]100%|██████████| 12/12 [00:03<00:00,  3.98it/s]
2025-03-13 11:41:04,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:04
2025-03-13 11:41:34,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1454 secs
2025-03-13 11:41:34,561 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 11:41:34,561 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.14it/s] 50%|█████     | 2/4 [00:00<00:00,  5.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 11:41:52,628 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0674 secs
2025-03-13 11:41:52,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2322 secs
2025-03-13 11:41:52,631 [INFO]: {
2025-03-13 11:41:52,631 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:52,631 [INFO]: 	index_param: efSearch=270
2025-03-13 11:41:52,631 [INFO]: 	index_path: knn.index
2025-03-13 11:41:52,631 [INFO]: 	size in bytes: 551079430
2025-03-13 11:41:52,631 [INFO]: 	avg_search_speed_ms: 9.959136116396325
2025-03-13 11:41:52,631 [INFO]: 	99p_search_speed_ms: 17.92061257874593
2025-03-13 11:41:52,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:52,631 [INFO]: 	nb vectors: 2801
2025-03-13 11:41:52,631 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:52,631 [INFO]: 	compression ratio: 0.9993096784614153
2025-03-13 11:41:52,631 [INFO]: }
2025-03-13 11:41:52,631 [INFO]: 	>>> Finished "Creating the index" in 51.2341 secs
2025-03-13 11:41:52,631 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2581 secs
2025-03-13 11:41:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 8366 [episode count 1/20]
[retrieval_preprocessing] for episode 18608 [episode count 2/20], we have num_retrieval=np.int64(2770) num_query=np.int64(146)
2025-03-13 11:41:54,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:54,926 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:54
2025-03-13 11:41:54,926 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.84it/s]
2025-03-13 11:41:54,953 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 11:41:54,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:41:54,953 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:54,954 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:41:54,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:54,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:41:54,954 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,954 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:54,955 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:41:54,955 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:54
2025-03-13 11:41:54,955 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:54,955 [INFO]: 	Creating the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,955 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:54
2025-03-13 11:41:54,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:41:54,958 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:54
2025-03-13 11:41:54,958 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:41:54,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.65it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.96it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.15it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.86it/s]100%|██████████| 11/11 [00:02<00:00,  2.40it/s]100%|██████████| 11/11 [00:02<00:00,  3.85it/s]
2025-03-13 11:41:57,825 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:57
2025-03-13 11:42:25,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6538 secs
2025-03-13 11:42:25,479 [INFO]: The best hyperparameters are: efSearch=332
2025-03-13 11:42:25,479 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.09it/s] 50%|█████     | 2/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 11:42:41,996 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5167 secs
2025-03-13 11:42:41,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0402 secs
2025-03-13 11:42:41,999 [INFO]: {
2025-03-13 11:42:41,999 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:41,999 [INFO]: 	index_param: efSearch=332
2025-03-13 11:42:41,999 [INFO]: 	index_path: knn.index
2025-03-13 11:42:41,999 [INFO]: 	size in bytes: 544980310
2025-03-13 11:42:41,999 [INFO]: 	avg_search_speed_ms: 10.741197335294714
2025-03-13 11:42:41,999 [INFO]: 	99p_search_speed_ms: 15.26195830665529
2025-03-13 11:42:41,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:41,999 [INFO]: 	nb vectors: 2770
2025-03-13 11:42:41,999 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:41,999 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 11:42:41,999 [INFO]: }
2025-03-13 11:42:41,999 [INFO]: 	>>> Finished "Creating the index" in 47.0437 secs
2025-03-13 11:42:41,999 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0730 secs
2025-03-13 11:42:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 18608 [episode count 2/20]
[retrieval_preprocessing] for episode 57572 [episode count 3/20], we have num_retrieval=np.int64(2766) num_query=np.int64(150)
2025-03-13 11:42:44,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:44,856 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:44
2025-03-13 11:42:44,856 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1962.71it/s]
2025-03-13 11:42:44,880 [INFO]: There are 2766 embeddings of dim 49152
2025-03-13 11:42:44,881 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:42:44,881 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:44
2025-03-13 11:42:44,881 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:44,881 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:42:44,881 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:44,882 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:42:44,882 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:44
2025-03-13 11:42:44,882 [INFO]: 570.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:44,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:42:44,882 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:44
2025-03-13 11:42:44,882 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:44,883 [INFO]: 	Creating the index 03/13/2025, 11:42:44
2025-03-13 11:42:44,883 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:44
2025-03-13 11:42:44,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:42:44,886 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:44
2025-03-13 11:42:44,886 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:42:44,886 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.33it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.73it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.71it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.26it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.55it/s]100%|██████████| 11/11 [00:02<00:00,  2.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.12it/s]
2025-03-13 11:42:47,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:47
2025-03-13 11:43:18,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4210 secs
2025-03-13 11:43:18,989 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 11:43:18,989 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 11:43:32,745 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7556 secs
2025-03-13 11:43:32,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8618 secs
2025-03-13 11:43:32,748 [INFO]: {
2025-03-13 11:43:32,748 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:32,748 [INFO]: 	index_param: efSearch=285
2025-03-13 11:43:32,748 [INFO]: 	index_path: knn.index
2025-03-13 11:43:32,748 [INFO]: 	size in bytes: 544193350
2025-03-13 11:43:32,748 [INFO]: 	avg_search_speed_ms: 10.211670096531753
2025-03-13 11:43:32,748 [INFO]: 	99p_search_speed_ms: 18.945115227252256
2025-03-13 11:43:32,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:32,748 [INFO]: 	nb vectors: 2766
2025-03-13 11:43:32,748 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:32,748 [INFO]: 	compression ratio: 0.9993097637080645
2025-03-13 11:43:32,748 [INFO]: }
2025-03-13 11:43:32,748 [INFO]: 	>>> Finished "Creating the index" in 47.8653 secs
2025-03-13 11:43:32,748 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8916 secs
2025-03-13 11:43:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 57572 [episode count 3/20]
[retrieval_preprocessing] for episode 26846 [episode count 4/20], we have num_retrieval=np.int64(2766) num_query=np.int64(150)
2025-03-13 11:43:35,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:36,061 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:36
2025-03-13 11:43:36,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.73it/s]
2025-03-13 11:43:36,089 [INFO]: There are 2766 embeddings of dim 49152
2025-03-13 11:43:36,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:43:36,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:36
2025-03-13 11:43:36,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:36,090 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:43:36,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:36,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:43:36,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:36
2025-03-13 11:43:36,091 [INFO]: 570.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:36,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:43:36,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:36
2025-03-13 11:43:36,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:36,092 [INFO]: 	Creating the index 03/13/2025, 11:43:36
2025-03-13 11:43:36,092 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:36
2025-03-13 11:43:36,095 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:43:36,095 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:36
2025-03-13 11:43:36,095 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:43:36,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.24it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.67it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.27it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.57it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.91it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.26it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.22it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.04it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.82it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.89it/s]100%|██████████| 11/11 [00:03<00:00,  1.20it/s]100%|██████████| 11/11 [00:03<00:00,  2.94it/s]
2025-03-13 11:43:39,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:39
2025-03-13 11:44:08,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9234 secs
2025-03-13 11:44:08,768 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 11:44:08,768 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 11:44:29,632 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8632 secs
2025-03-13 11:44:29,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5392 secs
2025-03-13 11:44:29,635 [INFO]: {
2025-03-13 11:44:29,635 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:29,635 [INFO]: 	index_param: efSearch=291
2025-03-13 11:44:29,635 [INFO]: 	index_path: knn.index
2025-03-13 11:44:29,635 [INFO]: 	size in bytes: 544193350
2025-03-13 11:44:29,635 [INFO]: 	avg_search_speed_ms: 10.444340577041867
2025-03-13 11:44:29,635 [INFO]: 	99p_search_speed_ms: 13.579327201005059
2025-03-13 11:44:29,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:29,635 [INFO]: 	nb vectors: 2766
2025-03-13 11:44:29,635 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:29,635 [INFO]: 	compression ratio: 0.9993097637080645
2025-03-13 11:44:29,635 [INFO]: }
2025-03-13 11:44:29,635 [INFO]: 	>>> Finished "Creating the index" in 53.5433 secs
2025-03-13 11:44:29,635 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5741 secs
2025-03-13 11:44:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 26846 [episode count 4/20]
[retrieval_preprocessing] for episode 33104 [episode count 5/20], we have num_retrieval=np.int64(2787) num_query=np.int64(129)
2025-03-13 11:44:32,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:32,865 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:32
2025-03-13 11:44:32,865 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.40it/s]
2025-03-13 11:44:32,890 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 11:44:32,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:44:32,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:32
2025-03-13 11:44:32,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:32,890 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:44:32,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:32,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:32,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:32
2025-03-13 11:44:32,890 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:32,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:32,890 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:32
2025-03-13 11:44:32,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:32,890 [INFO]: 	Creating the index 03/13/2025, 11:44:32
2025-03-13 11:44:32,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:32
2025-03-13 11:44:32,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:44:32,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:32
2025-03-13 11:44:32,892 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:44:32,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.05it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.40it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.63it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.98it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.42it/s]100%|██████████| 11/11 [00:02<00:00,  2.50it/s]100%|██████████| 11/11 [00:02<00:00,  3.93it/s]
2025-03-13 11:44:35,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:35
2025-03-13 11:45:03,983 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2813 secs
2025-03-13 11:45:03,983 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 11:45:03,983 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-13 11:45:18,774 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7902 secs
2025-03-13 11:45:18,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8847 secs
2025-03-13 11:45:18,777 [INFO]: {
2025-03-13 11:45:18,777 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:18,777 [INFO]: 	index_param: efSearch=308
2025-03-13 11:45:18,777 [INFO]: 	index_path: knn.index
2025-03-13 11:45:18,777 [INFO]: 	size in bytes: 548324890
2025-03-13 11:45:18,777 [INFO]: 	avg_search_speed_ms: 10.41611547091937
2025-03-13 11:45:18,777 [INFO]: 	99p_search_speed_ms: 14.884540520142764
2025-03-13 11:45:18,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:18,777 [INFO]: 	nb vectors: 2787
2025-03-13 11:45:18,777 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:18,777 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 11:45:18,777 [INFO]: }
2025-03-13 11:45:18,777 [INFO]: 	>>> Finished "Creating the index" in 45.8863 secs
2025-03-13 11:45:18,777 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9120 secs
2025-03-13 11:45:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 33104 [episode count 5/20]
[retrieval_preprocessing] for episode 27028 [episode count 6/20], we have num_retrieval=np.int64(2770) num_query=np.int64(146)
2025-03-13 11:45:21,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:21,791 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:21
2025-03-13 11:45:21,791 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.73it/s]
2025-03-13 11:45:21,817 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 11:45:21,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:45:21,817 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:21
2025-03-13 11:45:21,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:21,817 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:45:21,817 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:21,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:21,817 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:21
2025-03-13 11:45:21,817 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:21,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:45:21,817 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:21
2025-03-13 11:45:21,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:21,817 [INFO]: 	Creating the index 03/13/2025, 11:45:21
2025-03-13 11:45:21,817 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:21
2025-03-13 11:45:21,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:45:21,819 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:21
2025-03-13 11:45:21,819 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:45:21,819 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.33it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.98it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.40it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.40it/s] 45%|████▌     | 5/11 [00:00<00:00,  6.54it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.58it/s] 64%|██████▎   | 7/11 [00:01<00:00,  6.57it/s] 73%|███████▎  | 8/11 [00:01<00:00,  6.62it/s] 82%|████████▏ | 9/11 [00:01<00:00,  6.74it/s] 91%|█████████ | 10/11 [00:01<00:00,  6.92it/s]100%|██████████| 11/11 [00:03<00:00,  1.29it/s]100%|██████████| 11/11 [00:03<00:00,  2.95it/s]
2025-03-13 11:45:25,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:25
2025-03-13 11:45:53,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4863 secs
2025-03-13 11:45:53,048 [INFO]: The best hyperparameters are: efSearch=341
2025-03-13 11:45:53,048 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.66s/it] 50%|█████     | 2/4 [00:06<00:06,  3.40s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.16s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.63s/it]
2025-03-13 11:46:16,846 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7979 secs
2025-03-13 11:46:16,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0295 secs
2025-03-13 11:46:16,848 [INFO]: {
2025-03-13 11:46:16,848 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:16,848 [INFO]: 	index_param: efSearch=341
2025-03-13 11:46:16,848 [INFO]: 	index_path: knn.index
2025-03-13 11:46:16,848 [INFO]: 	size in bytes: 544980310
2025-03-13 11:46:16,848 [INFO]: 	avg_search_speed_ms: 12.71145833446733
2025-03-13 11:46:16,848 [INFO]: 	99p_search_speed_ms: 20.636905017308887
2025-03-13 11:46:16,848 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:16,848 [INFO]: 	nb vectors: 2770
2025-03-13 11:46:16,848 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:16,848 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 11:46:16,848 [INFO]: }
2025-03-13 11:46:16,848 [INFO]: 	>>> Finished "Creating the index" in 55.0311 secs
2025-03-13 11:46:16,848 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0573 secs
2025-03-13 11:46:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 27028 [episode count 6/20]
[retrieval_preprocessing] for episode 16944 [episode count 7/20], we have num_retrieval=np.int64(2803) num_query=np.int64(113)
2025-03-13 11:46:19,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:20,476 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:20
2025-03-13 11:46:20,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.71it/s]
2025-03-13 11:46:20,505 [INFO]: There are 2803 embeddings of dim 49152
2025-03-13 11:46:20,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:46:20,506 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:20
2025-03-13 11:46:20,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:20,506 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:46:20,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:20,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:46:20,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:20
2025-03-13 11:46:20,506 [INFO]: 578.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:20,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:46:20,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:20
2025-03-13 11:46:20,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:20,506 [INFO]: 	Creating the index 03/13/2025, 11:46:20
2025-03-13 11:46:20,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:20
2025-03-13 11:46:20,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:46:20,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:20
2025-03-13 11:46:20,508 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:46:20,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.85it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.90it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.12it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.36it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.71it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.50it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]
2025-03-13 11:46:23,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:23
2025-03-13 11:46:51,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1667 secs
2025-03-13 11:46:51,619 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 11:46:51,619 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 11:47:09,252 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6336 secs
2025-03-13 11:47:09,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7468 secs
2025-03-13 11:47:09,255 [INFO]: {
2025-03-13 11:47:09,255 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:09,255 [INFO]: 	index_param: efSearch=292
2025-03-13 11:47:09,255 [INFO]: 	index_path: knn.index
2025-03-13 11:47:09,255 [INFO]: 	size in bytes: 551472910
2025-03-13 11:47:09,255 [INFO]: 	avg_search_speed_ms: 11.016732687694697
2025-03-13 11:47:09,255 [INFO]: 	99p_search_speed_ms: 19.85012424876907
2025-03-13 11:47:09,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:09,255 [INFO]: 	nb vectors: 2803
2025-03-13 11:47:09,255 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:09,255 [INFO]: 	compression ratio: 0.9993096922929542
2025-03-13 11:47:09,255 [INFO]: }
2025-03-13 11:47:09,255 [INFO]: 	>>> Finished "Creating the index" in 48.7487 secs
2025-03-13 11:47:09,255 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7793 secs
2025-03-13 11:47:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 16944 [episode count 7/20]
[retrieval_preprocessing] for episode 47677 [episode count 8/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 11:47:11,263 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:11,760 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:11
2025-03-13 11:47:11,760 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.30it/s]
2025-03-13 11:47:11,786 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 11:47:11,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:47:11,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:11,786 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:47:11,786 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:11,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:11,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,786 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:11,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:11,786 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:11
2025-03-13 11:47:11,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:11,786 [INFO]: 	Creating the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,787 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:11
2025-03-13 11:47:11,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:47:11,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,788 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:47:11,788 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.85it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.77it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.57it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.82it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.99it/s]100%|██████████| 11/11 [00:02<00:00,  2.32it/s]100%|██████████| 11/11 [00:02<00:00,  3.75it/s]
2025-03-13 11:47:14,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:14
2025-03-13 11:47:41,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6421 secs
2025-03-13 11:47:41,372 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 11:47:41,372 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 11:47:58,329 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9567 secs
2025-03-13 11:47:58,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5436 secs
2025-03-13 11:47:58,331 [INFO]: {
2025-03-13 11:47:58,331 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:58,331 [INFO]: 	index_param: efSearch=291
2025-03-13 11:47:58,331 [INFO]: 	index_path: knn.index
2025-03-13 11:47:58,331 [INFO]: 	size in bytes: 543996610
2025-03-13 11:47:58,331 [INFO]: 	avg_search_speed_ms: 10.169386026559291
2025-03-13 11:47:58,331 [INFO]: 	99p_search_speed_ms: 18.429196788929403
2025-03-13 11:47:58,331 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:58,331 [INFO]: 	nb vectors: 2765
2025-03-13 11:47:58,331 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:58,331 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 11:47:58,331 [INFO]: }
2025-03-13 11:47:58,331 [INFO]: 	>>> Finished "Creating the index" in 46.5450 secs
2025-03-13 11:47:58,331 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5717 secs
2025-03-13 11:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 47677 [episode count 8/20]
[retrieval_preprocessing] for episode 62114 [episode count 9/20], we have num_retrieval=np.int64(2757) num_query=np.int64(159)
2025-03-13 11:48:00,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:01,208 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:01
2025-03-13 11:48:01,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.71it/s]
2025-03-13 11:48:01,233 [INFO]: There are 2757 embeddings of dim 49152
2025-03-13 11:48:01,234 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:48:01,234 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:01
2025-03-13 11:48:01,234 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:01,234 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:48:01,234 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:01,234 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:01,234 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:01
2025-03-13 11:48:01,234 [INFO]: 569.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:01,234 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:48:01,234 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:01
2025-03-13 11:48:01,234 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:01,234 [INFO]: 	Creating the index 03/13/2025, 11:48:01
2025-03-13 11:48:01,234 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:01
2025-03-13 11:48:01,235 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:48:01,235 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:01
2025-03-13 11:48:01,235 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:48:01,235 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.75it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.32it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.40it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.22it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.39it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.37it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.37it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.23it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.20it/s]100%|██████████| 11/11 [00:03<00:00,  1.17it/s]100%|██████████| 11/11 [00:03<00:00,  2.90it/s]
2025-03-13 11:48:05,038 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:05
2025-03-13 11:48:33,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8356 secs
2025-03-13 11:48:33,875 [INFO]: The best hyperparameters are: efSearch=311
2025-03-13 11:48:33,875 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 11:48:52,002 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1275 secs
2025-03-13 11:48:52,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7696 secs
2025-03-13 11:48:52,005 [INFO]: {
2025-03-13 11:48:52,005 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:52,005 [INFO]: 	index_param: efSearch=311
2025-03-13 11:48:52,005 [INFO]: 	index_path: knn.index
2025-03-13 11:48:52,005 [INFO]: 	size in bytes: 542422510
2025-03-13 11:48:52,005 [INFO]: 	avg_search_speed_ms: 10.057567641976659
2025-03-13 11:48:52,005 [INFO]: 	99p_search_speed_ms: 15.864436016418022
2025-03-13 11:48:52,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:52,005 [INFO]: 	nb vectors: 2757
2025-03-13 11:48:52,005 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:52,005 [INFO]: 	compression ratio: 0.9993100323214831
2025-03-13 11:48:52,005 [INFO]: }
2025-03-13 11:48:52,005 [INFO]: 	>>> Finished "Creating the index" in 50.7710 secs
2025-03-13 11:48:52,005 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7968 secs
2025-03-13 11:48:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 62114 [episode count 9/20]
[retrieval_preprocessing] for episode 68331 [episode count 10/20], we have num_retrieval=np.int64(2741) num_query=np.int64(175)
2025-03-13 11:48:54,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:54,772 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:54
2025-03-13 11:48:54,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.97it/s]
2025-03-13 11:48:54,796 [INFO]: There are 2741 embeddings of dim 49152
2025-03-13 11:48:54,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 11:48:54,797 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:54
2025-03-13 11:48:54,797 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:54,797 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:48:54,797 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:54,797 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:54,797 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:54
2025-03-13 11:48:54,797 [INFO]: 565.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:54,797 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:48:54,797 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:54
2025-03-13 11:48:54,797 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:54,797 [INFO]: 	Creating the index 03/13/2025, 11:48:54
2025-03-13 11:48:54,797 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:54
2025-03-13 11:48:54,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:48:54,798 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:54
2025-03-13 11:48:54,799 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:48:54,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.28it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.12it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.10it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.56it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.11it/s]
2025-03-13 11:48:57,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:57
2025-03-13 11:49:30,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3410 secs
2025-03-13 11:49:30,266 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 11:49:30,266 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-13 11:49:47,228 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9617 secs
2025-03-13 11:49:47,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4318 secs
2025-03-13 11:49:47,230 [INFO]: {
2025-03-13 11:49:47,231 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:47,231 [INFO]: 	index_param: efSearch=309
2025-03-13 11:49:47,231 [INFO]: 	index_path: knn.index
2025-03-13 11:49:47,231 [INFO]: 	size in bytes: 539274670
2025-03-13 11:49:47,231 [INFO]: 	avg_search_speed_ms: 11.249762555925832
2025-03-13 11:49:47,231 [INFO]: 	99p_search_speed_ms: 17.026664232835174
2025-03-13 11:49:47,231 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:47,231 [INFO]: 	nb vectors: 2741
2025-03-13 11:49:47,231 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:47,231 [INFO]: 	compression ratio: 0.9993099212317909
2025-03-13 11:49:47,231 [INFO]: }
2025-03-13 11:49:47,231 [INFO]: 	>>> Finished "Creating the index" in 52.4335 secs
2025-03-13 11:49:47,231 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4591 secs
2025-03-13 11:49:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 68331 [episode count 10/20]
[retrieval_preprocessing] for episode 54037 [episode count 11/20], we have num_retrieval=np.int64(2762) num_query=np.int64(154)
2025-03-13 11:49:49,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:50,086 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:50
2025-03-13 11:49:50,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.64it/s]
2025-03-13 11:49:50,111 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 11:49:50,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:49:50,111 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:50
2025-03-13 11:49:50,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:50,111 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:49:50,111 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:50,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:50,111 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:50
2025-03-13 11:49:50,111 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:50,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:49:50,112 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:50
2025-03-13 11:49:50,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:50,112 [INFO]: 	Creating the index 03/13/2025, 11:49:50
2025-03-13 11:49:50,112 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:50
2025-03-13 11:49:50,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:49:50,113 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:50
2025-03-13 11:49:50,113 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:49:50,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.75it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.15it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.82it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.26it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.41it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.51it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.47it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.31it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.15it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.99it/s]100%|██████████| 11/11 [00:03<00:00,  1.46it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 11:49:53,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:53
2025-03-13 11:50:28,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5273 secs
2025-03-13 11:50:28,856 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 11:50:28,856 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 11:50:52,549 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6930 secs
2025-03-13 11:50:52,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4394 secs
2025-03-13 11:50:52,552 [INFO]: {
2025-03-13 11:50:52,552 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:52,552 [INFO]: 	index_param: efSearch=321
2025-03-13 11:50:52,552 [INFO]: 	index_path: knn.index
2025-03-13 11:50:52,552 [INFO]: 	size in bytes: 543406270
2025-03-13 11:50:52,552 [INFO]: 	avg_search_speed_ms: 13.28191095233399
2025-03-13 11:50:52,552 [INFO]: 	99p_search_speed_ms: 23.94123489968479
2025-03-13 11:50:52,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:52,552 [INFO]: 	nb vectors: 2762
2025-03-13 11:50:52,552 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:52,552 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 11:50:52,552 [INFO]: }
2025-03-13 11:50:52,552 [INFO]: 	>>> Finished "Creating the index" in 62.4409 secs
2025-03-13 11:50:52,552 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4665 secs
2025-03-13 11:50:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 54037 [episode count 11/20]
[retrieval_preprocessing] for episode 4898 [episode count 12/20], we have num_retrieval=np.int64(2763) num_query=np.int64(153)
2025-03-13 11:50:55,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:55,750 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:55
2025-03-13 11:50:55,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.86it/s]
2025-03-13 11:50:55,778 [INFO]: There are 2763 embeddings of dim 49152
2025-03-13 11:50:55,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:50:55,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:55
2025-03-13 11:50:55,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:55,779 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:50:55,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:55,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:50:55,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:55
2025-03-13 11:50:55,779 [INFO]: 570.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:55,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:50:55,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:55
2025-03-13 11:50:55,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:55,780 [INFO]: 	Creating the index 03/13/2025, 11:50:55
2025-03-13 11:50:55,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:55
2025-03-13 11:50:55,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:50:55,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:55
2025-03-13 11:50:55,784 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:50:55,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.09it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.73it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.43it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.54it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.13it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.34it/s]100%|██████████| 11/11 [00:02<00:00,  3.79it/s]
2025-03-13 11:50:58,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:58
2025-03-13 11:51:27,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0009 secs
2025-03-13 11:51:27,703 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 11:51:27,703 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 11:51:44,800 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0975 secs
2025-03-13 11:51:44,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0187 secs
2025-03-13 11:51:44,803 [INFO]: {
2025-03-13 11:51:44,803 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:44,803 [INFO]: 	index_param: efSearch=326
2025-03-13 11:51:44,803 [INFO]: 	index_path: knn.index
2025-03-13 11:51:44,803 [INFO]: 	size in bytes: 543603010
2025-03-13 11:51:44,803 [INFO]: 	avg_search_speed_ms: 10.178980694435696
2025-03-13 11:51:44,803 [INFO]: 	99p_search_speed_ms: 13.755857818759974
2025-03-13 11:51:44,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:44,803 [INFO]: 	nb vectors: 2763
2025-03-13 11:51:44,804 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:44,804 [INFO]: 	compression ratio: 0.9993099633499086
2025-03-13 11:51:44,804 [INFO]: }
2025-03-13 11:51:44,804 [INFO]: 	>>> Finished "Creating the index" in 49.0234 secs
2025-03-13 11:51:44,804 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0533 secs
2025-03-13 11:51:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 4898 [episode count 12/20]
[retrieval_preprocessing] for episode 60267 [episode count 13/20], we have num_retrieval=np.int64(2775) num_query=np.int64(141)
2025-03-13 11:51:47,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:48,267 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:48
2025-03-13 11:51:48,267 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-13 11:51:48,291 [INFO]: There are 2775 embeddings of dim 49152
2025-03-13 11:51:48,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:51:48,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:48
2025-03-13 11:51:48,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:48,292 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:51:48,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:51:48,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:51:48,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:48
2025-03-13 11:51:48,292 [INFO]: 572.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:48,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:51:48,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:48
2025-03-13 11:51:48,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:48,292 [INFO]: 	Creating the index 03/13/2025, 11:51:48
2025-03-13 11:51:48,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:48
2025-03-13 11:51:48,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:51:48,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:48
2025-03-13 11:51:48,293 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:51:48,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.95it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.78it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.05it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.24it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.39it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.57it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.71it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.77it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.81it/s]100%|██████████| 11/11 [00:02<00:00,  1.62it/s]100%|██████████| 11/11 [00:02<00:00,  3.71it/s]
2025-03-13 11:51:51,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:51
2025-03-13 11:52:21,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2811 secs
2025-03-13 11:52:21,547 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 11:52:21,547 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 11:52:35,578 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0318 secs
2025-03-13 11:52:35,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2876 secs
2025-03-13 11:52:35,581 [INFO]: {
2025-03-13 11:52:35,581 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:35,581 [INFO]: 	index_param: efSearch=224
2025-03-13 11:52:35,581 [INFO]: 	index_path: knn.index
2025-03-13 11:52:35,581 [INFO]: 	size in bytes: 545964010
2025-03-13 11:52:35,581 [INFO]: 	avg_search_speed_ms: 8.714682232578786
2025-03-13 11:52:35,581 [INFO]: 	99p_search_speed_ms: 15.488429539836922
2025-03-13 11:52:35,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:35,581 [INFO]: 	nb vectors: 2775
2025-03-13 11:52:35,581 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:35,581 [INFO]: 	compression ratio: 0.9993098263015542
2025-03-13 11:52:35,581 [INFO]: }
2025-03-13 11:52:35,581 [INFO]: 	>>> Finished "Creating the index" in 47.2891 secs
2025-03-13 11:52:35,581 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3137 secs
2025-03-13 11:52:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 60267 [episode count 13/20]
[retrieval_preprocessing] for episode 39789 [episode count 14/20], we have num_retrieval=np.int64(2783) num_query=np.int64(133)
2025-03-13 11:52:37,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:38,261 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:38
2025-03-13 11:52:38,262 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 11:52:38,286 [INFO]: There are 2783 embeddings of dim 49152
2025-03-13 11:52:38,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:52:38,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:38
2025-03-13 11:52:38,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:38,287 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:52:38,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:38,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:38,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:38
2025-03-13 11:52:38,287 [INFO]: 574.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:38,287 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:52:38,287 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:38
2025-03-13 11:52:38,287 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:38,287 [INFO]: 	Creating the index 03/13/2025, 11:52:38
2025-03-13 11:52:38,287 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:38
2025-03-13 11:52:38,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:52:38,288 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:38
2025-03-13 11:52:38,288 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:52:38,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.05it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.36it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.93it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.24it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.40it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.49it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.70it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.85it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.96it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.01it/s]100%|██████████| 11/11 [00:03<00:00,  1.46it/s]100%|██████████| 11/11 [00:03<00:00,  3.34it/s]
2025-03-13 11:52:41,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:41
2025-03-13 11:53:06,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3652 secs
2025-03-13 11:53:06,954 [INFO]: The best hyperparameters are: efSearch=346
2025-03-13 11:53:06,954 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 11:53:24,800 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8456 secs
2025-03-13 11:53:24,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5143 secs
2025-03-13 11:53:24,802 [INFO]: {
2025-03-13 11:53:24,802 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:24,802 [INFO]: 	index_param: efSearch=346
2025-03-13 11:53:24,802 [INFO]: 	index_path: knn.index
2025-03-13 11:53:24,802 [INFO]: 	size in bytes: 547537930
2025-03-13 11:53:24,802 [INFO]: 	avg_search_speed_ms: 12.007805807817848
2025-03-13 11:53:24,803 [INFO]: 	99p_search_speed_ms: 17.43684699758887
2025-03-13 11:53:24,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:24,803 [INFO]: 	nb vectors: 2783
2025-03-13 11:53:24,803 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:24,803 [INFO]: 	compression ratio: 0.9993098816003487
2025-03-13 11:53:24,803 [INFO]: }
2025-03-13 11:53:24,803 [INFO]: 	>>> Finished "Creating the index" in 46.5156 secs
2025-03-13 11:53:24,803 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5411 secs
2025-03-13 11:53:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 39789 [episode count 14/20]
[retrieval_preprocessing] for episode 17520 [episode count 15/20], we have num_retrieval=np.int64(2773) num_query=np.int64(143)
2025-03-13 11:53:27,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:28,208 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:28
2025-03-13 11:53:28,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1869.95it/s]
2025-03-13 11:53:28,232 [INFO]: There are 2773 embeddings of dim 49152
2025-03-13 11:53:28,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 11:53:28,232 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:28
2025-03-13 11:53:28,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:28,232 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:53:28,232 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:28,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:28,232 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:28
2025-03-13 11:53:28,232 [INFO]: 572.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:28,232 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:53:28,232 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:28
2025-03-13 11:53:28,232 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:28,232 [INFO]: 	Creating the index 03/13/2025, 11:53:28
2025-03-13 11:53:28,232 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:28
2025-03-13 11:53:28,233 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 11:53:28,233 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:28
2025-03-13 11:53:28,233 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:53:28,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.73it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.98it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.87it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.44it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.80it/s]100%|██████████| 11/11 [00:02<00:00,  2.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.31it/s]
2025-03-13 11:53:30,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:30
2025-03-13 11:53:59,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8471 secs
2025-03-13 11:53:59,642 [INFO]: The best hyperparameters are: efSearch=324
2025-03-13 11:53:59,643 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 11:54:18,142 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4998 secs
2025-03-13 11:54:18,145 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9115 secs
2025-03-13 11:54:18,145 [INFO]: {
2025-03-13 11:54:18,145 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:18,145 [INFO]: 	index_param: efSearch=324
2025-03-13 11:54:18,145 [INFO]: 	index_path: knn.index
2025-03-13 11:54:18,145 [INFO]: 	size in bytes: 545570530
2025-03-13 11:54:18,145 [INFO]: 	avg_search_speed_ms: 10.917142233109777
2025-03-13 11:54:18,145 [INFO]: 	99p_search_speed_ms: 14.614301919937134
2025-03-13 11:54:18,145 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:18,145 [INFO]: 	nb vectors: 2773
2025-03-13 11:54:18,145 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:18,145 [INFO]: 	compression ratio: 0.9993098124270019
2025-03-13 11:54:18,145 [INFO]: }
2025-03-13 11:54:18,145 [INFO]: 	>>> Finished "Creating the index" in 49.9127 secs
2025-03-13 11:54:18,145 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9367 secs
2025-03-13 11:54:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 17520 [episode count 15/20]
[retrieval_preprocessing] for episode 9679 [episode count 16/20], we have num_retrieval=np.int64(2754) num_query=np.int64(162)
2025-03-13 11:54:20,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:21,399 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:21
2025-03-13 11:54:21,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2000.14it/s]
2025-03-13 11:54:21,421 [INFO]: There are 2754 embeddings of dim 49152
2025-03-13 11:54:21,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 11:54:21,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:21
2025-03-13 11:54:21,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:21,421 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:54:21,421 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:21,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:21,421 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:21
2025-03-13 11:54:21,421 [INFO]: 568.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:21,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:54:21,422 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:21
2025-03-13 11:54:21,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:21,422 [INFO]: 	Creating the index 03/13/2025, 11:54:21
2025-03-13 11:54:21,422 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:21
2025-03-13 11:54:21,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:54:21,423 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:21
2025-03-13 11:54:21,423 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:54:21,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.98it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.14it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.64it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.97it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.20it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.30it/s] 82%|████████▏ | 9/11 [00:01<00:00, 10.42it/s]100%|██████████| 11/11 [00:03<00:00,  2.34it/s]100%|██████████| 11/11 [00:03<00:00,  3.65it/s]
2025-03-13 11:54:24,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:24
2025-03-13 11:54:57,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6065 secs
2025-03-13 11:54:57,046 [INFO]: The best hyperparameters are: efSearch=316
2025-03-13 11:54:57,046 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 11:55:12,707 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6609 secs
2025-03-13 11:55:12,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2866 secs
2025-03-13 11:55:12,710 [INFO]: {
2025-03-13 11:55:12,710 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:12,710 [INFO]: 	index_param: efSearch=316
2025-03-13 11:55:12,710 [INFO]: 	index_path: knn.index
2025-03-13 11:55:12,710 [INFO]: 	size in bytes: 541832290
2025-03-13 11:55:12,710 [INFO]: 	avg_search_speed_ms: 10.583790308652969
2025-03-13 11:55:12,710 [INFO]: 	99p_search_speed_ms: 14.24291306175291
2025-03-13 11:55:12,710 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:12,710 [INFO]: 	nb vectors: 2754
2025-03-13 11:55:12,710 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:12,710 [INFO]: 	compression ratio: 0.9993100115904868
2025-03-13 11:55:12,710 [INFO]: }
2025-03-13 11:55:12,710 [INFO]: 	>>> Finished "Creating the index" in 51.2884 secs
2025-03-13 11:55:12,710 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3105 secs
2025-03-13 11:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 9679 [episode count 16/20]
[retrieval_preprocessing] for episode 62937 [episode count 17/20], we have num_retrieval=np.int64(2788) num_query=np.int64(128)
2025-03-13 11:55:15,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:16,302 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:16
2025-03-13 11:55:16,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-13 11:55:16,324 [INFO]: There are 2788 embeddings of dim 49152
2025-03-13 11:55:16,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 11:55:16,325 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:16
2025-03-13 11:55:16,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:16,325 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:55:16,325 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:16,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:55:16,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:16
2025-03-13 11:55:16,325 [INFO]: 575.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:16,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:55:16,325 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:16
2025-03-13 11:55:16,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:16,325 [INFO]: 	Creating the index 03/13/2025, 11:55:16
2025-03-13 11:55:16,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:16
2025-03-13 11:55:16,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:55:16,326 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:16
2025-03-13 11:55:16,326 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:55:16,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.72it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.25it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.63it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.75it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.85it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.91it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.82it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.91it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.06it/s]100%|██████████| 11/11 [00:03<00:00,  1.28it/s]100%|██████████| 11/11 [00:03<00:00,  3.08it/s]
2025-03-13 11:55:19,910 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:19
2025-03-13 11:55:46,397 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4872 secs
2025-03-13 11:55:46,398 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 11:55:46,398 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 11:56:02,395 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9975 secs
2025-03-13 11:56:02,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0718 secs
2025-03-13 11:56:02,398 [INFO]: {
2025-03-13 11:56:02,398 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:02,398 [INFO]: 	index_param: efSearch=315
2025-03-13 11:56:02,399 [INFO]: 	index_path: knn.index
2025-03-13 11:56:02,399 [INFO]: 	size in bytes: 548521630
2025-03-13 11:56:02,399 [INFO]: 	avg_search_speed_ms: 12.824165512425585
2025-03-13 11:56:02,399 [INFO]: 	99p_search_speed_ms: 23.368928304407785
2025-03-13 11:56:02,399 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:02,399 [INFO]: 	nb vectors: 2788
2025-03-13 11:56:02,399 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:02,399 [INFO]: 	compression ratio: 0.9993099160009424
2025-03-13 11:56:02,399 [INFO]: }
2025-03-13 11:56:02,399 [INFO]: 	>>> Finished "Creating the index" in 46.0734 secs
2025-03-13 11:56:02,399 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0963 secs
2025-03-13 11:56:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 62937 [episode count 17/20]
[retrieval_preprocessing] for episode 60470 [episode count 18/20], we have num_retrieval=np.int64(2802) num_query=np.int64(114)
2025-03-13 11:56:05,311 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:06,093 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:06
2025-03-13 11:56:06,093 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.54it/s]
2025-03-13 11:56:06,120 [INFO]: There are 2802 embeddings of dim 49152
2025-03-13 11:56:06,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:56:06,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:06
2025-03-13 11:56:06,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:06,121 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:56:06,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:06,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:06,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:06
2025-03-13 11:56:06,121 [INFO]: 578.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:06,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:56:06,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:06
2025-03-13 11:56:06,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:06,121 [INFO]: 	Creating the index 03/13/2025, 11:56:06
2025-03-13 11:56:06,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:06
2025-03-13 11:56:06,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:56:06,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:06
2025-03-13 11:56:06,123 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:56:06,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.05it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.76it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.40it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.58it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.41it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.93it/s]100%|██████████| 12/12 [00:02<00:00,  4.23it/s]
2025-03-13 11:56:08,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:08
2025-03-13 11:56:37,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1175 secs
2025-03-13 11:56:37,084 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 11:56:37,084 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 11:56:53,787 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7030 secs
2025-03-13 11:56:53,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6665 secs
2025-03-13 11:56:53,790 [INFO]: {
2025-03-13 11:56:53,790 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:53,790 [INFO]: 	index_param: efSearch=163
2025-03-13 11:56:53,790 [INFO]: 	index_path: knn.index
2025-03-13 11:56:53,790 [INFO]: 	size in bytes: 551276170
2025-03-13 11:56:53,790 [INFO]: 	avg_search_speed_ms: 7.023014820159904
2025-03-13 11:56:53,790 [INFO]: 	99p_search_speed_ms: 14.525541868060825
2025-03-13 11:56:53,790 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:53,790 [INFO]: 	nb vectors: 2802
2025-03-13 11:56:53,790 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:53,790 [INFO]: 	compression ratio: 0.9993096853796528
2025-03-13 11:56:53,790 [INFO]: }
2025-03-13 11:56:53,790 [INFO]: 	>>> Finished "Creating the index" in 47.6683 secs
2025-03-13 11:56:53,790 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6969 secs
2025-03-13 11:56:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 60470 [episode count 18/20]
[retrieval_preprocessing] for episode 63362 [episode count 19/20], we have num_retrieval=np.int64(2753) num_query=np.int64(163)
2025-03-13 11:56:55,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:55,884 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:55
2025-03-13 11:56:55,884 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.56it/s]
2025-03-13 11:56:55,908 [INFO]: There are 2753 embeddings of dim 49152
2025-03-13 11:56:55,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:56:55,909 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:55
2025-03-13 11:56:55,909 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:55,909 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:56:55,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:55,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:55,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:55
2025-03-13 11:56:55,909 [INFO]: 568.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:55,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:56:55,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:55
2025-03-13 11:56:55,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:55,909 [INFO]: 	Creating the index 03/13/2025, 11:56:55
2025-03-13 11:56:55,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:55
2025-03-13 11:56:55,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:56:55,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:55
2025-03-13 11:56:55,910 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:56:55,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.26it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.29it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.07it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.89it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.28it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.90it/s]100%|██████████| 11/11 [00:02<00:00,  3.91it/s]
2025-03-13 11:56:58,733 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:58
2025-03-13 11:57:27,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6379 secs
2025-03-13 11:57:27,371 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 11:57:27,371 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 11:57:45,047 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6755 secs
2025-03-13 11:57:45,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1390 secs
2025-03-13 11:57:45,049 [INFO]: {
2025-03-13 11:57:45,049 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:45,049 [INFO]: 	index_param: efSearch=288
2025-03-13 11:57:45,049 [INFO]: 	index_path: knn.index
2025-03-13 11:57:45,049 [INFO]: 	size in bytes: 541635550
2025-03-13 11:57:45,049 [INFO]: 	avg_search_speed_ms: 10.604115815592232
2025-03-13 11:57:45,049 [INFO]: 	99p_search_speed_ms: 16.20666761882605
2025-03-13 11:57:45,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:45,049 [INFO]: 	nb vectors: 2753
2025-03-13 11:57:45,049 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:45,049 [INFO]: 	compression ratio: 0.9993100046701144
2025-03-13 11:57:45,049 [INFO]: }
2025-03-13 11:57:45,049 [INFO]: 	>>> Finished "Creating the index" in 49.1404 secs
2025-03-13 11:57:45,049 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1657 secs
2025-03-13 11:57:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 63362 [episode count 19/20]
2025-03-13 11:57:46: [retrieval_preprocessing] finished for 6498288010_turn_off_extension_cord [chosen_id count 2/260]
2025-03-13 11:57:48: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 65137982_put_yellow_block_in_cup [chosen_id count 3/260]
2025-03-13 11:57:48: [retrieval_preprocessing] we have num_total=2402 embedding_dim=49152
[retrieval_preprocessing] for episode 29698 [episode count 0/20], we have num_retrieval=np.int64(2275) num_query=np.int64(127)
2025-03-13 11:57:49,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:49,328 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:49
2025-03-13 11:57:49,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2402.24it/s]
2025-03-13 11:57:49,350 [INFO]: There are 2275 embeddings of dim 49152
2025-03-13 11:57:49,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-13 11:57:49,350 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:49
2025-03-13 11:57:49,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:49,350 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:57:49,350 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:49,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:49,350 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:49
2025-03-13 11:57:49,350 [INFO]: 469.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:49,350 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:57:49,350 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:49
2025-03-13 11:57:49,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:49,350 [INFO]: 	Creating the index 03/13/2025, 11:57:49
2025-03-13 11:57:49,350 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:49
2025-03-13 11:57:49,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:57:49,351 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:49
2025-03-13 11:57:49,351 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:57:49,351 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.55it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.35it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.83it/s]100%|██████████| 9/9 [00:02<00:00,  2.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]
2025-03-13 11:57:51,878 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:51
2025-03-13 11:58:22,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6455 secs
2025-03-13 11:58:22,524 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:58:22,524 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 11:58:38,093 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5688 secs
2025-03-13 11:58:38,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1175 secs
2025-03-13 11:58:38,469 [INFO]: {
2025-03-13 11:58:38,469 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:38,469 [INFO]: 	index_param: efSearch=204
2025-03-13 11:58:38,469 [INFO]: 	index_path: knn.index
2025-03-13 11:58:38,470 [INFO]: 	size in bytes: 447592270
2025-03-13 11:58:38,470 [INFO]: 	avg_search_speed_ms: 11.445467602472233
2025-03-13 11:58:38,470 [INFO]: 	99p_search_speed_ms: 15.780174697283655
2025-03-13 11:58:38,470 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:38,470 [INFO]: 	nb vectors: 2275
2025-03-13 11:58:38,470 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:38,470 [INFO]: 	compression ratio: 0.9993094831597517
2025-03-13 11:58:38,470 [INFO]: }
2025-03-13 11:58:38,470 [INFO]: 	>>> Finished "Creating the index" in 49.1198 secs
2025-03-13 11:58:38,470 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1419 secs
2025-03-13 11:58:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 29698 [episode count 0/20]
[retrieval_preprocessing] for episode 61959 [episode count 1/20], we have num_retrieval=np.int64(2292) num_query=np.int64(110)
2025-03-13 11:58:40,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:40,584 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:40
2025-03-13 11:58:40,584 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.01it/s]
2025-03-13 11:58:40,613 [INFO]: There are 2292 embeddings of dim 49152
2025-03-13 11:58:40,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:58:40,613 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:40
2025-03-13 11:58:40,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:40,614 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:58:40,614 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:40,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:58:40,614 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:40
2025-03-13 11:58:40,614 [INFO]: 473.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:40,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:58:40,615 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:40
2025-03-13 11:58:40,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:40,615 [INFO]: 	Creating the index 03/13/2025, 11:58:40
2025-03-13 11:58:40,615 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:40
2025-03-13 11:58:40,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:58:40,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:40
2025-03-13 11:58:40,618 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:58:40,619 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.70it/s] 30%|███       | 3/10 [00:00<00:00,  9.65it/s] 50%|█████     | 5/10 [00:00<00:00, 10.41it/s] 70%|███████   | 7/10 [00:00<00:00, 10.55it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.55it/s]100%|██████████| 10/10 [00:02<00:00,  3.70it/s]
2025-03-13 11:58:43,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:43
2025-03-13 11:59:09,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4449 secs
2025-03-13 11:59:09,775 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 11:59:09,775 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 11:59:27,018 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2435 secs
2025-03-13 11:59:27,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4026 secs
2025-03-13 11:59:27,021 [INFO]: {
2025-03-13 11:59:27,021 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:27,021 [INFO]: 	index_param: efSearch=231
2025-03-13 11:59:27,021 [INFO]: 	index_path: knn.index
2025-03-13 11:59:27,021 [INFO]: 	size in bytes: 450936970
2025-03-13 11:59:27,021 [INFO]: 	avg_search_speed_ms: 11.016776783203108
2025-03-13 11:59:27,021 [INFO]: 	99p_search_speed_ms: 16.76995974965393
2025-03-13 11:59:27,021 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:27,021 [INFO]: 	nb vectors: 2292
2025-03-13 11:59:27,021 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:27,021 [INFO]: 	compression ratio: 0.9993093624592368
2025-03-13 11:59:27,021 [INFO]: }
2025-03-13 11:59:27,021 [INFO]: 	>>> Finished "Creating the index" in 46.4060 secs
2025-03-13 11:59:27,021 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4371 secs
2025-03-13 11:59:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 61959 [episode count 1/20]
[retrieval_preprocessing] for episode 16905 [episode count 2/20], we have num_retrieval=np.int64(2282) num_query=np.int64(120)
2025-03-13 11:59:29,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:29,913 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:29
2025-03-13 11:59:29,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1231.81it/s]
2025-03-13 11:59:29,941 [INFO]: There are 2282 embeddings of dim 49152
2025-03-13 11:59:29,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:59:29,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:29
2025-03-13 11:59:29,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:29,941 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:59:29,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:29,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:29,941 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:29
2025-03-13 11:59:29,941 [INFO]: 470.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:29,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:59:29,941 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:29
2025-03-13 11:59:29,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:29,942 [INFO]: 	Creating the index 03/13/2025, 11:59:29
2025-03-13 11:59:29,942 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:29
2025-03-13 11:59:29,943 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:59:29,943 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:29
2025-03-13 11:59:29,943 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:59:29,943 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.16it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.55it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.72it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.69it/s]100%|██████████| 9/9 [00:02<00:00,  2.44it/s]100%|██████████| 9/9 [00:02<00:00,  3.56it/s]
2025-03-13 11:59:32,480 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:32
2025-03-13 12:00:06,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0920 secs
2025-03-13 12:00:06,572 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 12:00:06,573 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 12:00:26,273 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7000 secs
2025-03-13 12:00:26,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3318 secs
2025-03-13 12:00:26,275 [INFO]: {
2025-03-13 12:00:26,275 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:26,275 [INFO]: 	index_param: efSearch=216
2025-03-13 12:00:26,275 [INFO]: 	index_path: knn.index
2025-03-13 12:00:26,275 [INFO]: 	size in bytes: 448969450
2025-03-13 12:00:26,275 [INFO]: 	avg_search_speed_ms: 10.792404180141457
2025-03-13 12:00:26,275 [INFO]: 	99p_search_speed_ms: 15.66979646217078
2025-03-13 12:00:26,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:26,275 [INFO]: 	nb vectors: 2282
2025-03-13 12:00:26,275 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:26,275 [INFO]: 	compression ratio: 0.9993095432217047
2025-03-13 12:00:26,275 [INFO]: }
2025-03-13 12:00:26,275 [INFO]: 	>>> Finished "Creating the index" in 56.3337 secs
2025-03-13 12:00:26,275 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3618 secs
2025-03-13 12:00:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 16905 [episode count 2/20]
[retrieval_preprocessing] for episode 95241 [episode count 3/20], we have num_retrieval=np.int64(2311) num_query=np.int64(91)
2025-03-13 12:00:28,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:28,365 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:28
2025-03-13 12:00:28,366 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.09it/s]
2025-03-13 12:00:28,391 [INFO]: There are 2311 embeddings of dim 49152
2025-03-13 12:00:28,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 12:00:28,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:28
2025-03-13 12:00:28,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:28,392 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:00:28,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:28,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:00:28,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:28
2025-03-13 12:00:28,392 [INFO]: 476.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:28,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:00:28,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:28
2025-03-13 12:00:28,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:28,392 [INFO]: 	Creating the index 03/13/2025, 12:00:28
2025-03-13 12:00:28,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:28
2025-03-13 12:00:28,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:00:28,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:28
2025-03-13 12:00:28,393 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:00:28,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.27it/s] 30%|███       | 3/10 [00:00<00:00, 10.90it/s] 50%|█████     | 5/10 [00:00<00:00, 11.61it/s] 70%|███████   | 7/10 [00:00<00:00, 11.63it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.30it/s]100%|██████████| 10/10 [00:02<00:00,  3.86it/s]
2025-03-13 12:00:30,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:30
2025-03-13 12:00:58,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9526 secs
2025-03-13 12:00:58,937 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 12:00:58,937 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 12:01:19,583 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6460 secs
2025-03-13 12:01:19,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1930 secs
2025-03-13 12:01:19,586 [INFO]: {
2025-03-13 12:01:19,586 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:19,586 [INFO]: 	index_param: efSearch=195
2025-03-13 12:01:19,586 [INFO]: 	index_path: knn.index
2025-03-13 12:01:19,586 [INFO]: 	size in bytes: 454675090
2025-03-13 12:01:19,587 [INFO]: 	avg_search_speed_ms: 9.336072886771376
2025-03-13 12:01:19,587 [INFO]: 	99p_search_speed_ms: 13.089063577353954
2025-03-13 12:01:19,587 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:19,587 [INFO]: 	nb vectors: 2311
2025-03-13 12:01:19,587 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:19,587 [INFO]: 	compression ratio: 0.9993093925598607
2025-03-13 12:01:19,587 [INFO]: }
2025-03-13 12:01:19,587 [INFO]: 	>>> Finished "Creating the index" in 51.1946 secs
2025-03-13 12:01:19,587 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2211 secs
2025-03-13 12:01:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 95241 [episode count 3/20]
[retrieval_preprocessing] for episode 15891 [episode count 4/20], we have num_retrieval=np.int64(2267) num_query=np.int64(135)
2025-03-13 12:01:21,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:21,691 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:21
2025-03-13 12:01:21,692 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-13 12:01:21,716 [INFO]: There are 2267 embeddings of dim 49152
2025-03-13 12:01:21,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 12:01:21,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:21,716 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:01:21,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:21,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:21,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,716 [INFO]: 467.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:21,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:01:21,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:21
2025-03-13 12:01:21,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:21,716 [INFO]: 	Creating the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:21
2025-03-13 12:01:21,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:01:21,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,718 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:01:21,718 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.12it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.15it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.28it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.16it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.96it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.86it/s]100%|██████████| 9/9 [00:02<00:00,  1.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-13 12:01:24,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:24
2025-03-13 12:01:51,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4818 secs
2025-03-13 12:01:51,898 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 12:01:51,898 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 12:02:14,350 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4515 secs
2025-03-13 12:02:14,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6343 secs
2025-03-13 12:02:14,352 [INFO]: {
2025-03-13 12:02:14,352 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:14,352 [INFO]: 	index_param: efSearch=237
2025-03-13 12:02:14,352 [INFO]: 	index_path: knn.index
2025-03-13 12:02:14,352 [INFO]: 	size in bytes: 446018350
2025-03-13 12:02:14,352 [INFO]: 	avg_search_speed_ms: 10.547731571019341
2025-03-13 12:02:14,352 [INFO]: 	99p_search_speed_ms: 18.546975469216694
2025-03-13 12:02:14,352 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:14,352 [INFO]: 	nb vectors: 2267
2025-03-13 12:02:14,352 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:14,352 [INFO]: 	compression ratio: 0.9993094140633452
2025-03-13 12:02:14,352 [INFO]: }
2025-03-13 12:02:14,352 [INFO]: 	>>> Finished "Creating the index" in 52.6359 secs
2025-03-13 12:02:14,352 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6606 secs
2025-03-13 12:02:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 15891 [episode count 4/20]
[retrieval_preprocessing] for episode 45075 [episode count 5/20], we have num_retrieval=np.int64(2243) num_query=np.int64(159)
2025-03-13 12:02:16,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:16,962 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:16
2025-03-13 12:02:16,962 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.50it/s]
2025-03-13 12:02:16,990 [INFO]: There are 2243 embeddings of dim 49152
2025-03-13 12:02:16,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:02:16,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:16,991 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:02:16,991 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:16,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:02:16,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,991 [INFO]: 462.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:16,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:02:16,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:16
2025-03-13 12:02:16,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:16,991 [INFO]: 	Creating the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,991 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:16
2025-03-13 12:02:16,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:02:16,992 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:16
2025-03-13 12:02:16,993 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:02:16,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.21it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.17it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.15it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.77it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.57it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.41it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.21it/s]100%|██████████| 9/9 [00:02<00:00,  1.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.23it/s]
2025-03-13 12:02:19,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:19
2025-03-13 12:02:50,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2756 secs
2025-03-13 12:02:50,058 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 12:02:50,058 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 12:03:05,259 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2011 secs
2025-03-13 12:03:05,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2682 secs
2025-03-13 12:03:05,261 [INFO]: {
2025-03-13 12:03:05,261 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:05,261 [INFO]: 	index_param: efSearch=224
2025-03-13 12:03:05,261 [INFO]: 	index_path: knn.index
2025-03-13 12:03:05,261 [INFO]: 	size in bytes: 441296530
2025-03-13 12:03:05,261 [INFO]: 	avg_search_speed_ms: 11.2058528915907
2025-03-13 12:03:05,261 [INFO]: 	99p_search_speed_ms: 15.622316608205443
2025-03-13 12:03:05,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:05,261 [INFO]: 	nb vectors: 2243
2025-03-13 12:03:05,261 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:05,261 [INFO]: 	compression ratio: 0.9993093396859477
2025-03-13 12:03:05,261 [INFO]: }
2025-03-13 12:03:05,261 [INFO]: 	>>> Finished "Creating the index" in 48.2699 secs
2025-03-13 12:03:05,261 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2990 secs
2025-03-13 12:03:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 45075 [episode count 5/20]
[retrieval_preprocessing] for episode 43038 [episode count 6/20], we have num_retrieval=np.int64(2283) num_query=np.int64(119)
2025-03-13 12:03:07,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:07,471 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:07
2025-03-13 12:03:07,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-13 12:03:07,494 [INFO]: There are 2283 embeddings of dim 49152
2025-03-13 12:03:07,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 12:03:07,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:07
2025-03-13 12:03:07,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:07,495 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:03:07,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:07,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:07,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:07
2025-03-13 12:03:07,495 [INFO]: 471.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:07,495 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:03:07,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:07
2025-03-13 12:03:07,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:07,495 [INFO]: 	Creating the index 03/13/2025, 12:03:07
2025-03-13 12:03:07,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:07
2025-03-13 12:03:07,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:03:07,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:07
2025-03-13 12:03:07,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:03:07,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.30it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.96it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.82it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.18it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.33it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.46it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.49it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.58it/s]100%|██████████| 9/9 [00:02<00:00,  1.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.33it/s]
2025-03-13 12:03:10,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:10
2025-03-13 12:03:40,082 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8787 secs
2025-03-13 12:03:40,082 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 12:03:40,082 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 12:04:00,689 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6071 secs
2025-03-13 12:04:00,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1953 secs
2025-03-13 12:04:00,692 [INFO]: {
2025-03-13 12:04:00,692 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:00,692 [INFO]: 	index_param: efSearch=233
2025-03-13 12:04:00,692 [INFO]: 	index_path: knn.index
2025-03-13 12:04:00,692 [INFO]: 	size in bytes: 449166190
2025-03-13 12:04:00,692 [INFO]: 	avg_search_speed_ms: 11.129047435701093
2025-03-13 12:04:00,692 [INFO]: 	99p_search_speed_ms: 15.24843686260283
2025-03-13 12:04:00,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:00,692 [INFO]: 	nb vectors: 2283
2025-03-13 12:04:00,692 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:00,692 [INFO]: 	compression ratio: 0.9993095517719176
2025-03-13 12:04:00,692 [INFO]: }
2025-03-13 12:04:00,692 [INFO]: 	>>> Finished "Creating the index" in 53.1968 secs
2025-03-13 12:04:00,692 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2212 secs
2025-03-13 12:04:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 43038 [episode count 6/20]
[retrieval_preprocessing] for episode 26660 [episode count 7/20], we have num_retrieval=np.int64(2283) num_query=np.int64(119)
2025-03-13 12:04:02,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:02,976 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:02
2025-03-13 12:04:02,976 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2407.75it/s]
2025-03-13 12:04:02,997 [INFO]: There are 2283 embeddings of dim 49152
2025-03-13 12:04:02,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 12:04:02,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:02,998 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:04:02,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:02,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:02,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,998 [INFO]: 471.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:02,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:02,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:02
2025-03-13 12:04:02,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:02,998 [INFO]: 	Creating the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:02
2025-03-13 12:04:02,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 12:04:02,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,999 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:04:02,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.29it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.70it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.49it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.82it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.08it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.19it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.20it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.25it/s]100%|██████████| 9/9 [00:02<00:00,  1.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.38it/s]
2025-03-13 12:04:05,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:05
2025-03-13 12:04:32,006 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3364 secs
2025-03-13 12:04:32,007 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 12:04:32,007 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.54s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.12s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.47s/it]
2025-03-13 12:04:52,244 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2371 secs
2025-03-13 12:04:52,246 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2467 secs
2025-03-13 12:04:52,246 [INFO]: {
2025-03-13 12:04:52,246 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:52,246 [INFO]: 	index_param: efSearch=251
2025-03-13 12:04:52,246 [INFO]: 	index_path: knn.index
2025-03-13 12:04:52,246 [INFO]: 	size in bytes: 449166190
2025-03-13 12:04:52,246 [INFO]: 	avg_search_speed_ms: 9.52962878182353
2025-03-13 12:04:52,246 [INFO]: 	99p_search_speed_ms: 11.72948963008821
2025-03-13 12:04:52,246 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:52,246 [INFO]: 	nb vectors: 2283
2025-03-13 12:04:52,246 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:52,246 [INFO]: 	compression ratio: 0.9993095517719176
2025-03-13 12:04:52,246 [INFO]: }
2025-03-13 12:04:52,246 [INFO]: 	>>> Finished "Creating the index" in 49.2479 secs
2025-03-13 12:04:52,246 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2702 secs
2025-03-13 12:04:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 26660 [episode count 7/20]
[retrieval_preprocessing] for episode 567 [episode count 8/20], we have num_retrieval=np.int64(2302) num_query=np.int64(100)
2025-03-13 12:04:54,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:54,493 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:54
2025-03-13 12:04:54,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.09it/s]
2025-03-13 12:04:54,515 [INFO]: There are 2302 embeddings of dim 49152
2025-03-13 12:04:54,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 12:04:54,515 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:54
2025-03-13 12:04:54,515 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:54,515 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:04:54,515 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:54,515 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:54,515 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:54
2025-03-13 12:04:54,515 [INFO]: 475.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:54,515 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:54,515 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:54
2025-03-13 12:04:54,515 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:54,516 [INFO]: 	Creating the index 03/13/2025, 12:04:54
2025-03-13 12:04:54,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:54
2025-03-13 12:04:54,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:04:54,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:54
2025-03-13 12:04:54,517 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:04:54,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.96it/s] 20%|██        | 2/10 [00:00<00:01,  6.27it/s] 30%|███       | 3/10 [00:00<00:01,  6.73it/s] 40%|████      | 4/10 [00:00<00:00,  7.01it/s] 50%|█████     | 5/10 [00:00<00:00,  7.18it/s] 60%|██████    | 6/10 [00:00<00:00,  7.28it/s] 70%|███████   | 7/10 [00:00<00:00,  7.38it/s] 80%|████████  | 8/10 [00:01<00:00,  7.48it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.53it/s]100%|██████████| 10/10 [00:02<00:00,  1.63it/s]100%|██████████| 10/10 [00:02<00:00,  3.39it/s]
2025-03-13 12:04:57,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:57
2025-03-13 12:05:30,467 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0009 secs
2025-03-13 12:05:30,467 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:05:30,467 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 12:05:51,008 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5405 secs
2025-03-13 12:05:51,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4936 secs
2025-03-13 12:05:51,010 [INFO]: {
2025-03-13 12:05:51,010 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:51,010 [INFO]: 	index_param: efSearch=221
2025-03-13 12:05:51,010 [INFO]: 	index_path: knn.index
2025-03-13 12:05:51,010 [INFO]: 	size in bytes: 452904370
2025-03-13 12:05:51,010 [INFO]: 	avg_search_speed_ms: 9.880386180430282
2025-03-13 12:05:51,010 [INFO]: 	99p_search_speed_ms: 12.950455045793204
2025-03-13 12:05:51,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:51,010 [INFO]: 	nb vectors: 2302
2025-03-13 12:05:51,010 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:51,010 [INFO]: 	compression ratio: 0.9993094480408745
2025-03-13 12:05:51,010 [INFO]: }
2025-03-13 12:05:51,011 [INFO]: 	>>> Finished "Creating the index" in 56.4950 secs
2025-03-13 12:05:51,011 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5173 secs
2025-03-13 12:05:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 567 [episode count 8/20]
[retrieval_preprocessing] for episode 90712 [episode count 9/20], we have num_retrieval=np.int64(2277) num_query=np.int64(125)
2025-03-13 12:05:52,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:53,063 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:53
2025-03-13 12:05:53,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.65it/s]
2025-03-13 12:05:53,086 [INFO]: There are 2277 embeddings of dim 49152
2025-03-13 12:05:53,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 12:05:53,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:53
2025-03-13 12:05:53,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:53,087 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:05:53,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:53,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:53,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:53
2025-03-13 12:05:53,087 [INFO]: 469.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:53,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:05:53,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:53
2025-03-13 12:05:53,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:53,087 [INFO]: 	Creating the index 03/13/2025, 12:05:53
2025-03-13 12:05:53,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:53
2025-03-13 12:05:53,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:05:53,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:53
2025-03-13 12:05:53,088 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:05:53,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.98it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.67it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.98it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.80it/s]100%|██████████| 9/9 [00:02<00:00,  2.39it/s]100%|██████████| 9/9 [00:02<00:00,  3.49it/s]
2025-03-13 12:05:55,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:55
2025-03-13 12:06:28,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3310 secs
2025-03-13 12:06:28,010 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:06:28,010 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 12:06:47,504 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4937 secs
2025-03-13 12:06:47,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4538 secs
2025-03-13 12:06:47,542 [INFO]: {
2025-03-13 12:06:47,542 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:47,542 [INFO]: 	index_param: efSearch=239
2025-03-13 12:06:47,542 [INFO]: 	index_path: knn.index
2025-03-13 12:06:47,542 [INFO]: 	size in bytes: 447985750
2025-03-13 12:06:47,542 [INFO]: 	avg_search_speed_ms: 11.897313795866408
2025-03-13 12:06:47,542 [INFO]: 	99p_search_speed_ms: 19.019242469221368
2025-03-13 12:06:47,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:47,542 [INFO]: 	nb vectors: 2277
2025-03-13 12:06:47,542 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:47,543 [INFO]: 	compression ratio: 0.9993095003579913
2025-03-13 12:06:47,543 [INFO]: }
2025-03-13 12:06:47,543 [INFO]: 	>>> Finished "Creating the index" in 54.4556 secs
2025-03-13 12:06:47,543 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4793 secs
2025-03-13 12:06:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 90712 [episode count 9/20]
[retrieval_preprocessing] for episode 49771 [episode count 10/20], we have num_retrieval=np.int64(2302) num_query=np.int64(100)
2025-03-13 12:06:49,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:50,012 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:50
2025-03-13 12:06:50,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.57it/s]
2025-03-13 12:06:50,040 [INFO]: There are 2302 embeddings of dim 49152
2025-03-13 12:06:50,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:06:50,041 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:50
2025-03-13 12:06:50,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:50,041 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:06:50,041 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:50,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:06:50,041 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:50
2025-03-13 12:06:50,042 [INFO]: 475.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:50,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:06:50,042 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:50
2025-03-13 12:06:50,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:50,042 [INFO]: 	Creating the index 03/13/2025, 12:06:50
2025-03-13 12:06:50,043 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:50
2025-03-13 12:06:50,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:06:50,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:50
2025-03-13 12:06:50,046 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:06:50,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.22it/s] 30%|███       | 3/10 [00:00<00:00,  9.18it/s] 50%|█████     | 5/10 [00:00<00:00, 10.18it/s] 70%|███████   | 7/10 [00:00<00:00, 10.84it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.16it/s]100%|██████████| 10/10 [00:02<00:00,  3.73it/s]
2025-03-13 12:06:52,736 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:52
2025-03-13 12:07:18,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8466 secs
2025-03-13 12:07:18,583 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 12:07:18,583 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 12:07:34,696 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1132 secs
2025-03-13 12:07:34,698 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6523 secs
2025-03-13 12:07:34,698 [INFO]: {
2025-03-13 12:07:34,698 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:34,699 [INFO]: 	index_param: efSearch=259
2025-03-13 12:07:34,699 [INFO]: 	index_path: knn.index
2025-03-13 12:07:34,699 [INFO]: 	size in bytes: 452904370
2025-03-13 12:07:34,699 [INFO]: 	avg_search_speed_ms: 11.195930078978185
2025-03-13 12:07:34,699 [INFO]: 	99p_search_speed_ms: 15.284633068367846
2025-03-13 12:07:34,699 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:34,699 [INFO]: 	nb vectors: 2302
2025-03-13 12:07:34,699 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:34,699 [INFO]: 	compression ratio: 0.9993094480408745
2025-03-13 12:07:34,699 [INFO]: }
2025-03-13 12:07:34,699 [INFO]: 	>>> Finished "Creating the index" in 44.6562 secs
2025-03-13 12:07:34,699 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6865 secs
2025-03-13 12:07:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 49771 [episode count 10/20]
[retrieval_preprocessing] for episode 20123 [episode count 11/20], we have num_retrieval=np.int64(2297) num_query=np.int64(105)
2025-03-13 12:07:36,702 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:37,014 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:37
2025-03-13 12:07:37,014 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.13it/s]
2025-03-13 12:07:37,040 [INFO]: There are 2297 embeddings of dim 49152
2025-03-13 12:07:37,041 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 12:07:37,041 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:37,041 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:07:37,041 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:37,042 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:07:37,042 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,042 [INFO]: 474.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:37,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:07:37,042 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:37
2025-03-13 12:07:37,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:37,043 [INFO]: 	Creating the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,043 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:37
2025-03-13 12:07:37,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:07:37,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,046 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:07:37,047 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.21it/s] 30%|███       | 3/10 [00:00<00:00, 10.37it/s] 50%|█████     | 5/10 [00:00<00:00, 11.12it/s] 70%|███████   | 7/10 [00:00<00:00, 12.21it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.22it/s]100%|██████████| 10/10 [00:02<00:00,  4.29it/s]
2025-03-13 12:07:39,382 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:39
2025-03-13 12:08:07,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9387 secs
2025-03-13 12:08:07,322 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:08:07,322 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 12:08:23,106 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7844 secs
2025-03-13 12:08:23,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0624 secs
2025-03-13 12:08:23,109 [INFO]: {
2025-03-13 12:08:23,109 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:23,109 [INFO]: 	index_param: efSearch=258
2025-03-13 12:08:23,109 [INFO]: 	index_path: knn.index
2025-03-13 12:08:23,109 [INFO]: 	size in bytes: 451920670
2025-03-13 12:08:23,109 [INFO]: 	avg_search_speed_ms: 11.533123139730272
2025-03-13 12:08:23,109 [INFO]: 	99p_search_speed_ms: 15.566124375909572
2025-03-13 12:08:23,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:23,109 [INFO]: 	nb vectors: 2297
2025-03-13 12:08:23,109 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:23,109 [INFO]: 	compression ratio: 0.9993094053431988
2025-03-13 12:08:23,109 [INFO]: }
2025-03-13 12:08:23,109 [INFO]: 	>>> Finished "Creating the index" in 46.0661 secs
2025-03-13 12:08:23,109 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0947 secs
2025-03-13 12:08:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 20123 [episode count 11/20]
[retrieval_preprocessing] for episode 8861 [episode count 12/20], we have num_retrieval=np.int64(2274) num_query=np.int64(128)
2025-03-13 12:08:24,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:25,296 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:25
2025-03-13 12:08:25,297 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2331.46it/s]
2025-03-13 12:08:25,319 [INFO]: There are 2274 embeddings of dim 49152
2025-03-13 12:08:25,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 12:08:25,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:25,320 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:08:25,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:25,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:25,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,320 [INFO]: 469.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:25,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:08:25,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:25
2025-03-13 12:08:25,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:25,320 [INFO]: 	Creating the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:25
2025-03-13 12:08:25,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:08:25,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,321 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:08:25,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.79it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.86it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.54it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.32it/s]100%|██████████| 9/9 [00:02<00:00,  2.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.86it/s]
2025-03-13 12:08:27,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:27
2025-03-13 12:08:55,541 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8787 secs
2025-03-13 12:08:55,541 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 12:08:55,541 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.12it/s] 50%|█████     | 2/4 [00:01<00:00,  2.28it/s] 75%|███████▌  | 3/4 [00:01<00:00,  3.40it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.40it/s]
2025-03-13 12:09:13,066 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5255 secs
2025-03-13 12:09:13,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7472 secs
2025-03-13 12:09:13,068 [INFO]: {
2025-03-13 12:09:13,068 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:13,068 [INFO]: 	index_param: efSearch=227
2025-03-13 12:09:13,068 [INFO]: 	index_path: knn.index
2025-03-13 12:09:13,068 [INFO]: 	size in bytes: 447395530
2025-03-13 12:09:13,068 [INFO]: 	avg_search_speed_ms: 10.35807496462187
2025-03-13 12:09:13,068 [INFO]: 	99p_search_speed_ms: 14.426756405737253
2025-03-13 12:09:13,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:13,068 [INFO]: 	nb vectors: 2274
2025-03-13 12:09:13,068 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:13,069 [INFO]: 	compression ratio: 0.9993094745492875
2025-03-13 12:09:13,069 [INFO]: }
2025-03-13 12:09:13,069 [INFO]: 	>>> Finished "Creating the index" in 47.7486 secs
2025-03-13 12:09:13,069 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7720 secs
2025-03-13 12:09:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 8861 [episode count 12/20]
[retrieval_preprocessing] for episode 43687 [episode count 13/20], we have num_retrieval=np.int64(2270) num_query=np.int64(132)
2025-03-13 12:09:15,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:15,541 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:15
2025-03-13 12:09:15,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.33it/s]
2025-03-13 12:09:15,568 [INFO]: There are 2270 embeddings of dim 49152
2025-03-13 12:09:15,568 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 12:09:15,568 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:15
2025-03-13 12:09:15,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:15,568 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:09:15,568 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:15,568 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:15,568 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:15
2025-03-13 12:09:15,568 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:15,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:09:15,569 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:15
2025-03-13 12:09:15,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:15,569 [INFO]: 	Creating the index 03/13/2025, 12:09:15
2025-03-13 12:09:15,569 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:15
2025-03-13 12:09:15,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:09:15,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:15
2025-03-13 12:09:15,570 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:09:15,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.22it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.92it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.00it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.24it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.18it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.07it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.20it/s]
2025-03-13 12:09:18,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:18
2025-03-13 12:09:46,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6235 secs
2025-03-13 12:09:46,017 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:09:46,017 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 50%|█████     | 2/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 12:10:02,485 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4671 secs
2025-03-13 12:10:02,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9167 secs
2025-03-13 12:10:02,487 [INFO]: {
2025-03-13 12:10:02,487 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:02,487 [INFO]: 	index_param: efSearch=258
2025-03-13 12:10:02,487 [INFO]: 	index_path: knn.index
2025-03-13 12:10:02,487 [INFO]: 	size in bytes: 446608570
2025-03-13 12:10:02,487 [INFO]: 	avg_search_speed_ms: 10.678797035916384
2025-03-13 12:10:02,487 [INFO]: 	99p_search_speed_ms: 17.528885900974274
2025-03-13 12:10:02,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:02,487 [INFO]: 	nb vectors: 2270
2025-03-13 12:10:02,487 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:02,487 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-13 12:10:02,487 [INFO]: }
2025-03-13 12:10:02,487 [INFO]: 	>>> Finished "Creating the index" in 46.9184 secs
2025-03-13 12:10:02,487 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9461 secs
2025-03-13 12:10:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 43687 [episode count 13/20]
[retrieval_preprocessing] for episode 42665 [episode count 14/20], we have num_retrieval=np.int64(2308) num_query=np.int64(94)
2025-03-13 12:10:04,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:05,040 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:05
2025-03-13 12:10:05,040 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1570.90it/s]
2025-03-13 12:10:05,067 [INFO]: There are 2308 embeddings of dim 49152
2025-03-13 12:10:05,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 12:10:05,068 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:05
2025-03-13 12:10:05,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:05,068 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:10:05,068 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:05,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:10:05,068 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:05
2025-03-13 12:10:05,068 [INFO]: 476.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:05,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:10:05,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:05
2025-03-13 12:10:05,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:05,069 [INFO]: 	Creating the index 03/13/2025, 12:10:05
2025-03-13 12:10:05,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:05
2025-03-13 12:10:05,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:10:05,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:05
2025-03-13 12:10:05,072 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:10:05,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.61it/s] 20%|██        | 2/10 [00:00<00:01,  7.22it/s] 30%|███       | 3/10 [00:00<00:00,  7.89it/s] 40%|████      | 4/10 [00:00<00:00,  8.20it/s] 50%|█████     | 5/10 [00:00<00:00,  8.33it/s] 60%|██████    | 6/10 [00:00<00:00,  8.41it/s] 70%|███████   | 7/10 [00:00<00:00,  8.45it/s] 80%|████████  | 8/10 [00:00<00:00,  8.61it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.59it/s]100%|██████████| 10/10 [00:02<00:00,  1.74it/s]100%|██████████| 10/10 [00:02<00:00,  3.70it/s]
2025-03-13 12:10:07,779 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:07
2025-03-13 12:10:43,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5141 secs
2025-03-13 12:10:43,293 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 12:10:43,293 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-13 12:10:58,910 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6168 secs
2025-03-13 12:10:59,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4342 secs
2025-03-13 12:10:59,507 [INFO]: {
2025-03-13 12:10:59,507 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:59,507 [INFO]: 	index_param: efSearch=192
2025-03-13 12:10:59,507 [INFO]: 	index_path: knn.index
2025-03-13 12:10:59,507 [INFO]: 	size in bytes: 454084870
2025-03-13 12:10:59,507 [INFO]: 	avg_search_speed_ms: 9.71044915190274
2025-03-13 12:10:59,507 [INFO]: 	99p_search_speed_ms: 12.977634607814258
2025-03-13 12:10:59,507 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:59,507 [INFO]: 	nb vectors: 2308
2025-03-13 12:10:59,507 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:59,507 [INFO]: 	compression ratio: 0.9993093669912411
2025-03-13 12:10:59,507 [INFO]: }
2025-03-13 12:10:59,507 [INFO]: 	>>> Finished "Creating the index" in 54.4384 secs
2025-03-13 12:10:59,508 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4671 secs
2025-03-13 12:10:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 42665 [episode count 14/20]
[retrieval_preprocessing] for episode 28360 [episode count 15/20], we have num_retrieval=np.int64(2233) num_query=np.int64(169)
2025-03-13 12:11:01,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:01,372 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:01
2025-03-13 12:11:01,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-13 12:11:01,397 [INFO]: There are 2233 embeddings of dim 49152
2025-03-13 12:11:01,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:11:01,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:01
2025-03-13 12:11:01,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:01,397 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:11:01,397 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:01,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:01,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:01
2025-03-13 12:11:01,397 [INFO]: 460.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:01,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:01,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:01
2025-03-13 12:11:01,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:01,398 [INFO]: 	Creating the index 03/13/2025, 12:11:01
2025-03-13 12:11:01,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:01
2025-03-13 12:11:01,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:01,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:01
2025-03-13 12:11:01,399 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:11:01,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.30it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.02it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.23it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.30it/s]100%|██████████| 9/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.90it/s]
2025-03-13 12:11:03,717 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:03
2025-03-13 12:11:32,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3783 secs
2025-03-13 12:11:32,095 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:11:32,096 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.83it/s]
2025-03-13 12:11:49,185 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0897 secs
2025-03-13 12:11:49,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7888 secs
2025-03-13 12:11:49,188 [INFO]: {
2025-03-13 12:11:49,188 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:49,188 [INFO]: 	index_param: efSearch=239
2025-03-13 12:11:49,188 [INFO]: 	index_path: knn.index
2025-03-13 12:11:49,188 [INFO]: 	size in bytes: 439329130
2025-03-13 12:11:49,188 [INFO]: 	avg_search_speed_ms: 11.035649787180258
2025-03-13 12:11:49,188 [INFO]: 	99p_search_speed_ms: 19.344417483080182
2025-03-13 12:11:49,188 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:49,188 [INFO]: 	nb vectors: 2233
2025-03-13 12:11:49,188 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:49,188 [INFO]: 	compression ratio: 0.9993092513578601
2025-03-13 12:11:49,188 [INFO]: }
2025-03-13 12:11:49,188 [INFO]: 	>>> Finished "Creating the index" in 47.7901 secs
2025-03-13 12:11:49,188 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8156 secs
2025-03-13 12:11:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 28360 [episode count 15/20]
[retrieval_preprocessing] for episode 58065 [episode count 16/20], we have num_retrieval=np.int64(2295) num_query=np.int64(107)
2025-03-13 12:11:51,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:51,635 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:51
2025-03-13 12:11:51,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.73it/s]
2025-03-13 12:11:51,662 [INFO]: There are 2295 embeddings of dim 49152
2025-03-13 12:11:51,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:11:51,663 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:51
2025-03-13 12:11:51,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:51,663 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:11:51,663 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:51,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:11:51,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:51
2025-03-13 12:11:51,664 [INFO]: 473.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:51,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:11:51,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:51
2025-03-13 12:11:51,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:51,664 [INFO]: 	Creating the index 03/13/2025, 12:11:51
2025-03-13 12:11:51,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:51
2025-03-13 12:11:51,667 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:11:51,667 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:51
2025-03-13 12:11:51,668 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:11:51,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.77it/s] 30%|███       | 3/10 [00:00<00:00, 11.60it/s] 50%|█████     | 5/10 [00:00<00:00, 12.88it/s] 70%|███████   | 7/10 [00:00<00:00, 13.31it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.22it/s]100%|██████████| 10/10 [00:02<00:00,  4.07it/s]
2025-03-13 12:11:54,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:54
2025-03-13 12:12:19,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8172 secs
2025-03-13 12:12:19,949 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 12:12:19,949 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s]
2025-03-13 12:12:34,176 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2272 secs
2025-03-13 12:12:34,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5105 secs
2025-03-13 12:12:34,178 [INFO]: {
2025-03-13 12:12:34,178 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:34,178 [INFO]: 	index_param: efSearch=212
2025-03-13 12:12:34,178 [INFO]: 	index_path: knn.index
2025-03-13 12:12:34,178 [INFO]: 	size in bytes: 451527190
2025-03-13 12:12:34,178 [INFO]: 	avg_search_speed_ms: 10.516577582908196
2025-03-13 12:12:34,178 [INFO]: 	99p_search_speed_ms: 15.617882017977536
2025-03-13 12:12:34,178 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:34,178 [INFO]: 	nb vectors: 2295
2025-03-13 12:12:34,178 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:34,178 [INFO]: 	compression ratio: 0.9993093882120366
2025-03-13 12:12:34,178 [INFO]: }
2025-03-13 12:12:34,178 [INFO]: 	>>> Finished "Creating the index" in 42.5141 secs
2025-03-13 12:12:34,178 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5436 secs
2025-03-13 12:12:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 58065 [episode count 16/20]
[retrieval_preprocessing] for episode 32990 [episode count 17/20], we have num_retrieval=np.int64(2279) num_query=np.int64(123)
2025-03-13 12:12:35,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:36,212 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:36
2025-03-13 12:12:36,212 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 12:12:36,239 [INFO]: There are 2279 embeddings of dim 49152
2025-03-13 12:12:36,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:12:36,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:36
2025-03-13 12:12:36,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:36,240 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:12:36,241 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:36,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:12:36,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:36
2025-03-13 12:12:36,241 [INFO]: 470.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:36,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:12:36,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:36
2025-03-13 12:12:36,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:36,241 [INFO]: 	Creating the index 03/13/2025, 12:12:36
2025-03-13 12:12:36,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:36
2025-03-13 12:12:36,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:12:36,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:36
2025-03-13 12:12:36,245 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:12:36,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.58it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.20it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.93it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.31it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.52it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.70it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.99it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.03it/s]100%|██████████| 9/9 [00:02<00:00,  1.56it/s]100%|██████████| 9/9 [00:02<00:00,  3.27it/s]
2025-03-13 12:12:39,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:39
2025-03-13 12:13:10,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0667 secs
2025-03-13 12:13:10,079 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 12:13:10,079 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 12:13:25,942 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8629 secs
2025-03-13 12:13:25,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6996 secs
2025-03-13 12:13:25,945 [INFO]: {
2025-03-13 12:13:25,945 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:25,945 [INFO]: 	index_param: efSearch=210
2025-03-13 12:13:25,945 [INFO]: 	index_path: knn.index
2025-03-13 12:13:25,945 [INFO]: 	size in bytes: 448379230
2025-03-13 12:13:25,945 [INFO]: 	avg_search_speed_ms: 10.60585948798612
2025-03-13 12:13:25,945 [INFO]: 	99p_search_speed_ms: 16.97989705018699
2025-03-13 12:13:25,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:25,945 [INFO]: 	nb vectors: 2279
2025-03-13 12:13:25,945 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:25,945 [INFO]: 	compression ratio: 0.999309517526046
2025-03-13 12:13:25,945 [INFO]: }
2025-03-13 12:13:25,945 [INFO]: 	>>> Finished "Creating the index" in 49.7036 secs
2025-03-13 12:13:25,945 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7334 secs
2025-03-13 12:13:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 32990 [episode count 17/20]
[retrieval_preprocessing] for episode 55523 [episode count 18/20], we have num_retrieval=np.int64(2297) num_query=np.int64(105)
2025-03-13 12:13:27,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:28,063 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:28
2025-03-13 12:13:28,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1652.60it/s]
2025-03-13 12:13:28,087 [INFO]: There are 2297 embeddings of dim 49152
2025-03-13 12:13:28,087 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 12:13:28,087 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:28
2025-03-13 12:13:28,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:28,087 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:13:28,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:28,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:28,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:28
2025-03-13 12:13:28,087 [INFO]: 474.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:28,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:28,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:28
2025-03-13 12:13:28,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:28,087 [INFO]: 	Creating the index 03/13/2025, 12:13:28
2025-03-13 12:13:28,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:28
2025-03-13 12:13:28,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:13:28,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:28
2025-03-13 12:13:28,088 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:13:28,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.38it/s] 30%|███       | 3/10 [00:00<00:00, 10.03it/s] 50%|█████     | 5/10 [00:00<00:00, 11.29it/s] 70%|███████   | 7/10 [00:00<00:00, 11.73it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.95it/s]100%|██████████| 10/10 [00:02<00:00,  3.84it/s]
2025-03-13 12:13:30,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:30
2025-03-13 12:13:58,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6269 secs
2025-03-13 12:13:58,325 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 12:13:58,325 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 12:14:15,315 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9895 secs
2025-03-13 12:14:15,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2288 secs
2025-03-13 12:14:15,317 [INFO]: {
2025-03-13 12:14:15,317 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:15,317 [INFO]: 	index_param: efSearch=240
2025-03-13 12:14:15,317 [INFO]: 	index_path: knn.index
2025-03-13 12:14:15,317 [INFO]: 	size in bytes: 451920670
2025-03-13 12:14:15,317 [INFO]: 	avg_search_speed_ms: 11.854909870208582
2025-03-13 12:14:15,317 [INFO]: 	99p_search_speed_ms: 19.47496128035707
2025-03-13 12:14:15,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:15,317 [INFO]: 	nb vectors: 2297
2025-03-13 12:14:15,317 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:15,317 [INFO]: 	compression ratio: 0.9993094053431988
2025-03-13 12:14:15,317 [INFO]: }
2025-03-13 12:14:15,317 [INFO]: 	>>> Finished "Creating the index" in 47.2301 secs
2025-03-13 12:14:15,317 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2548 secs
2025-03-13 12:14:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 55523 [episode count 18/20]
[retrieval_preprocessing] for episode 17641 [episode count 19/20], we have num_retrieval=np.int64(2268) num_query=np.int64(134)
2025-03-13 12:14:17,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:17,864 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:17
2025-03-13 12:14:17,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-13 12:14:17,893 [INFO]: There are 2268 embeddings of dim 49152
2025-03-13 12:14:17,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:14:17,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:17,894 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:14:17,895 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:17,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:14:17,895 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,895 [INFO]: 468.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:17,895 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:14:17,895 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:17
2025-03-13 12:14:17,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:17,896 [INFO]: 	Creating the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,896 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:17
2025-03-13 12:14:17,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:14:17,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:17
2025-03-13 12:14:17,899 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:14:17,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.42it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.17it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.44it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.01it/s]100%|██████████| 9/9 [00:02<00:00,  2.09it/s]100%|██████████| 9/9 [00:02<00:00,  3.15it/s]
2025-03-13 12:14:20,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:20
2025-03-13 12:14:51,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3279 secs
2025-03-13 12:14:51,099 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:14:51,099 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 12:15:12,404 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3052 secs
2025-03-13 12:15:12,407 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5078 secs
2025-03-13 12:15:12,407 [INFO]: {
2025-03-13 12:15:12,407 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:12,407 [INFO]: 	index_param: efSearch=252
2025-03-13 12:15:12,407 [INFO]: 	index_path: knn.index
2025-03-13 12:15:12,407 [INFO]: 	size in bytes: 446215090
2025-03-13 12:15:12,407 [INFO]: 	avg_search_speed_ms: 11.182703548923584
2025-03-13 12:15:12,407 [INFO]: 	99p_search_speed_ms: 17.40767502458765
2025-03-13 12:15:12,407 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:12,407 [INFO]: 	nb vectors: 2268
2025-03-13 12:15:12,407 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:12,407 [INFO]: 	compression ratio: 0.999309422727053
2025-03-13 12:15:12,407 [INFO]: }
2025-03-13 12:15:12,407 [INFO]: 	>>> Finished "Creating the index" in 54.5117 secs
2025-03-13 12:15:12,407 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5431 secs
2025-03-13 12:15:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17641 [episode count 19/20]
2025-03-13 12:15:15: [retrieval_preprocessing] finished for 65137982_put_yellow_block_in_cup [chosen_id count 3/260]
2025-03-13 12:15:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 65137982_put_yellow_block_in_blue_cup [chosen_id count 4/260]
2025-03-13 12:15:17: [retrieval_preprocessing] we have num_total=2349 embedding_dim=49152
[retrieval_preprocessing] for episode 34380 [episode count 0/20], we have num_retrieval=np.int64(2196) num_query=np.int64(153)
2025-03-13 12:15:17,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:18,324 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:18
2025-03-13 12:15:18,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.87it/s]
2025-03-13 12:15:18,349 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 12:15:18,349 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:15:18,349 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:18
2025-03-13 12:15:18,349 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:18,349 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:15:18,349 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:18,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:18,349 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:18
2025-03-13 12:15:18,349 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:18,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:15:18,349 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:18
2025-03-13 12:15:18,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:18,349 [INFO]: 	Creating the index 03/13/2025, 12:15:18
2025-03-13 12:15:18,349 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:18
2025-03-13 12:15:18,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:15:18,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:18
2025-03-13 12:15:18,350 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:15:18,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.99it/s] 44%|████▍     | 4/9 [00:00<00:00, 18.12it/s] 67%|██████▋   | 6/9 [00:00<00:00, 17.88it/s] 89%|████████▉ | 8/9 [00:00<00:00, 14.84it/s]100%|██████████| 9/9 [00:02<00:00,  4.23it/s]
2025-03-13 12:15:20,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:20
2025-03-13 12:15:44,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5020 secs
2025-03-13 12:15:44,486 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 12:15:44,486 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 12:16:00,820 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3330 secs
2025-03-13 12:16:00,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4710 secs
2025-03-13 12:16:00,821 [INFO]: {
2025-03-13 12:16:00,821 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:00,821 [INFO]: 	index_param: efSearch=284
2025-03-13 12:16:00,821 [INFO]: 	index_path: knn.index
2025-03-13 12:16:00,821 [INFO]: 	size in bytes: 432049750
2025-03-13 12:16:00,821 [INFO]: 	avg_search_speed_ms: 11.238457001170165
2025-03-13 12:16:00,821 [INFO]: 	99p_search_speed_ms: 14.402437505777927
2025-03-13 12:16:00,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:00,821 [INFO]: 	nb vectors: 2196
2025-03-13 12:16:00,822 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:00,822 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 12:16:00,822 [INFO]: }
2025-03-13 12:16:00,822 [INFO]: 	>>> Finished "Creating the index" in 42.4722 secs
2025-03-13 12:16:00,822 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4970 secs
2025-03-13 12:16:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 34380 [episode count 0/20]
[retrieval_preprocessing] for episode 14934 [episode count 1/20], we have num_retrieval=np.int64(2237) num_query=np.int64(112)
2025-03-13 12:16:03,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:03,772 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:03
2025-03-13 12:16:03,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2009.73it/s]
2025-03-13 12:16:03,962 [INFO]: There are 2237 embeddings of dim 49152
2025-03-13 12:16:03,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1903 secs
2025-03-13 12:16:03,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:03
2025-03-13 12:16:03,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:03,963 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:16:03,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:03,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:16:03,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:03
2025-03-13 12:16:03,963 [INFO]: 461.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:03,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:16:03,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:03
2025-03-13 12:16:03,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:03,964 [INFO]: 	Creating the index 03/13/2025, 12:16:03
2025-03-13 12:16:03,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:03
2025-03-13 12:16:03,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 12:16:03,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:03
2025-03-13 12:16:03,966 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:16:03,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.82it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.94it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.96it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.25it/s]100%|██████████| 9/9 [00:02<00:00,  2.85it/s]100%|██████████| 9/9 [00:02<00:00,  4.06it/s]
2025-03-13 12:16:06,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:06
2025-03-13 12:16:35,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7071 secs
2025-03-13 12:16:35,897 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 12:16:35,898 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s]
2025-03-13 12:16:55,971 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0732 secs
2025-03-13 12:16:55,973 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0067 secs
2025-03-13 12:16:55,973 [INFO]: {
2025-03-13 12:16:55,973 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:55,973 [INFO]: 	index_param: efSearch=259
2025-03-13 12:16:55,973 [INFO]: 	index_path: knn.index
2025-03-13 12:16:55,973 [INFO]: 	size in bytes: 440116090
2025-03-13 12:16:55,973 [INFO]: 	avg_search_speed_ms: 11.160373534081106
2025-03-13 12:16:55,973 [INFO]: 	99p_search_speed_ms: 17.766444412991387
2025-03-13 12:16:55,973 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:55,973 [INFO]: 	nb vectors: 2237
2025-03-13 12:16:55,973 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:55,973 [INFO]: 	compression ratio: 0.9993092867838574
2025-03-13 12:16:55,973 [INFO]: }
2025-03-13 12:16:55,973 [INFO]: 	>>> Finished "Creating the index" in 52.0092 secs
2025-03-13 12:16:55,973 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2008 secs
2025-03-13 12:16:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 14934 [episode count 1/20]
[retrieval_preprocessing] for episode 18009 [episode count 2/20], we have num_retrieval=np.int64(2236) num_query=np.int64(113)
2025-03-13 12:16:57,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:58,243 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:58
2025-03-13 12:16:58,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1585.15it/s]
2025-03-13 12:16:58,268 [INFO]: There are 2236 embeddings of dim 49152
2025-03-13 12:16:58,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:16:58,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:58
2025-03-13 12:16:58,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:58,268 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:16:58,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:58,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:16:58,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:58
2025-03-13 12:16:58,268 [INFO]: 461.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:58,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:16:58,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:58
2025-03-13 12:16:58,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:58,269 [INFO]: 	Creating the index 03/13/2025, 12:16:58
2025-03-13 12:16:58,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:58
2025-03-13 12:16:58,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:16:58,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:58
2025-03-13 12:16:58,270 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:16:58,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.75it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.14it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.43it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.58it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.72it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.88it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.83it/s]100%|██████████| 9/9 [00:02<00:00,  1.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.46it/s]
2025-03-13 12:17:00,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:00
2025-03-13 12:17:33,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5003 secs
2025-03-13 12:17:33,380 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:17:33,380 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 12:17:48,288 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9076 secs
2025-03-13 12:17:48,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0198 secs
2025-03-13 12:17:48,290 [INFO]: {
2025-03-13 12:17:48,290 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:48,290 [INFO]: 	index_param: efSearch=231
2025-03-13 12:17:48,290 [INFO]: 	index_path: knn.index
2025-03-13 12:17:48,290 [INFO]: 	size in bytes: 439919350
2025-03-13 12:17:48,290 [INFO]: 	avg_search_speed_ms: 10.2268002007408
2025-03-13 12:17:48,290 [INFO]: 	99p_search_speed_ms: 14.662588618230075
2025-03-13 12:17:48,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:48,290 [INFO]: 	nb vectors: 2236
2025-03-13 12:17:48,290 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:48,290 [INFO]: 	compression ratio: 0.9993092779392404
2025-03-13 12:17:48,290 [INFO]: }
2025-03-13 12:17:48,290 [INFO]: 	>>> Finished "Creating the index" in 50.0214 secs
2025-03-13 12:17:48,290 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0470 secs
2025-03-13 12:17:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 18009 [episode count 2/20]
[retrieval_preprocessing] for episode 37487 [episode count 3/20], we have num_retrieval=np.int64(2228) num_query=np.int64(121)
2025-03-13 12:17:50,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:50,543 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:50
2025-03-13 12:17:50,543 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.93it/s]
2025-03-13 12:17:50,567 [INFO]: There are 2228 embeddings of dim 49152
2025-03-13 12:17:50,567 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 12:17:50,567 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:50
2025-03-13 12:17:50,567 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:50,567 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:17:50,568 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:50,568 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:50,568 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:50
2025-03-13 12:17:50,568 [INFO]: 459.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:50,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:50,568 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:50
2025-03-13 12:17:50,568 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:50,568 [INFO]: 	Creating the index 03/13/2025, 12:17:50
2025-03-13 12:17:50,568 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:50
2025-03-13 12:17:50,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:17:50,569 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:50
2025-03-13 12:17:50,569 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:17:50,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.22it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.49it/s]100%|██████████| 9/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.84it/s]
2025-03-13 12:17:52,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:52
2025-03-13 12:18:29,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7659 secs
2025-03-13 12:18:29,689 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 12:18:29,689 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-13 12:18:43,467 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7781 secs
2025-03-13 12:18:43,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9002 secs
2025-03-13 12:18:43,469 [INFO]: {
2025-03-13 12:18:43,469 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:43,469 [INFO]: 	index_param: efSearch=213
2025-03-13 12:18:43,470 [INFO]: 	index_path: knn.index
2025-03-13 12:18:43,470 [INFO]: 	size in bytes: 438345430
2025-03-13 12:18:43,470 [INFO]: 	avg_search_speed_ms: 11.018481398142859
2025-03-13 12:18:43,470 [INFO]: 	99p_search_speed_ms: 14.531112816184756
2025-03-13 12:18:43,470 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:43,470 [INFO]: 	nb vectors: 2228
2025-03-13 12:18:43,470 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:43,470 [INFO]: 	compression ratio: 0.9993092068964881
2025-03-13 12:18:43,470 [INFO]: }
2025-03-13 12:18:43,470 [INFO]: 	>>> Finished "Creating the index" in 52.9018 secs
2025-03-13 12:18:43,470 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9271 secs
2025-03-13 12:18:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 37487 [episode count 3/20]
[retrieval_preprocessing] for episode 113 [episode count 4/20], we have num_retrieval=np.int64(2253) num_query=np.int64(96)
2025-03-13 12:18:45,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:45,613 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:45
2025-03-13 12:18:45,613 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1640.32it/s]
2025-03-13 12:18:45,646 [INFO]: There are 2253 embeddings of dim 49152
2025-03-13 12:18:45,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 12:18:45,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:45
2025-03-13 12:18:45,647 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:45,647 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:18:45,647 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:45,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:18:45,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:45
2025-03-13 12:18:45,647 [INFO]: 465.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:45,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:18:45,647 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:45
2025-03-13 12:18:45,647 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:45,647 [INFO]: 	Creating the index 03/13/2025, 12:18:45
2025-03-13 12:18:45,647 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:45
2025-03-13 12:18:45,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:18:45,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:45
2025-03-13 12:18:45,649 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:18:45,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.60it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.39it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.72it/s]100%|██████████| 9/9 [00:02<00:00,  2.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.82it/s]
2025-03-13 12:18:48,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:48
2025-03-13 12:19:17,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9160 secs
2025-03-13 12:19:17,932 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 12:19:17,932 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-13 12:19:33,676 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7440 secs
2025-03-13 12:19:33,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0291 secs
2025-03-13 12:19:33,678 [INFO]: {
2025-03-13 12:19:33,678 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:33,678 [INFO]: 	index_param: efSearch=259
2025-03-13 12:19:33,678 [INFO]: 	index_path: knn.index
2025-03-13 12:19:33,678 [INFO]: 	size in bytes: 443263930
2025-03-13 12:19:33,678 [INFO]: 	avg_search_speed_ms: 10.614180513024884
2025-03-13 12:19:33,678 [INFO]: 	99p_search_speed_ms: 18.12714689178393
2025-03-13 12:19:33,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:33,679 [INFO]: 	nb vectors: 2253
2025-03-13 12:19:33,679 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:33,679 [INFO]: 	compression ratio: 0.9993094272299575
2025-03-13 12:19:33,679 [INFO]: }
2025-03-13 12:19:33,679 [INFO]: 	>>> Finished "Creating the index" in 48.0312 secs
2025-03-13 12:19:33,679 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0658 secs
2025-03-13 12:19:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 113 [episode count 4/20]
[retrieval_preprocessing] for episode 51340 [episode count 5/20], we have num_retrieval=np.int64(2257) num_query=np.int64(92)
2025-03-13 12:19:35,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:36,053 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:36
2025-03-13 12:19:36,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.26it/s]
2025-03-13 12:19:36,077 [INFO]: There are 2257 embeddings of dim 49152
2025-03-13 12:19:36,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 12:19:36,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:36
2025-03-13 12:19:36,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:36,077 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:19:36,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:36,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:36,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:36
2025-03-13 12:19:36,078 [INFO]: 465.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:36,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:36,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:36
2025-03-13 12:19:36,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:36,078 [INFO]: 	Creating the index 03/13/2025, 12:19:36
2025-03-13 12:19:36,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:36
2025-03-13 12:19:36,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:19:36,079 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:36
2025-03-13 12:19:36,079 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:19:36,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.91it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.52it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.65it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.19it/s]100%|██████████| 9/9 [00:02<00:00,  2.72it/s]100%|██████████| 9/9 [00:02<00:00,  3.87it/s]
2025-03-13 12:19:38,411 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:38
2025-03-13 12:20:08,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3589 secs
2025-03-13 12:20:08,770 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:20:08,770 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s]
2025-03-13 12:20:22,129 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3583 secs
2025-03-13 12:20:22,145 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0667 secs
2025-03-13 12:20:22,146 [INFO]: {
2025-03-13 12:20:22,146 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:22,146 [INFO]: 	index_param: efSearch=253
2025-03-13 12:20:22,146 [INFO]: 	index_path: knn.index
2025-03-13 12:20:22,146 [INFO]: 	size in bytes: 444050890
2025-03-13 12:20:22,146 [INFO]: 	avg_search_speed_ms: 10.585773179169607
2025-03-13 12:20:22,146 [INFO]: 	99p_search_speed_ms: 13.30011793412268
2025-03-13 12:20:22,146 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:22,146 [INFO]: 	nb vectors: 2257
2025-03-13 12:20:22,146 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:22,146 [INFO]: 	compression ratio: 0.9993094620303542
2025-03-13 12:20:22,146 [INFO]: }
2025-03-13 12:20:22,146 [INFO]: 	>>> Finished "Creating the index" in 46.0681 secs
2025-03-13 12:20:22,146 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0922 secs
2025-03-13 12:20:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 51340 [episode count 5/20]
[retrieval_preprocessing] for episode 59541 [episode count 6/20], we have num_retrieval=np.int64(2217) num_query=np.int64(132)
2025-03-13 12:20:23,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:24,077 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:24
2025-03-13 12:20:24,077 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2441.39it/s]
2025-03-13 12:20:24,099 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 12:20:24,099 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 12:20:24,099 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:24
2025-03-13 12:20:24,099 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:24,099 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:20:24,099 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:24,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:24,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:24
2025-03-13 12:20:24,099 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:24,099 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:20:24,099 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:24
2025-03-13 12:20:24,099 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:24,099 [INFO]: 	Creating the index 03/13/2025, 12:20:24
2025-03-13 12:20:24,099 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:24
2025-03-13 12:20:24,100 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:20:24,100 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:24
2025-03-13 12:20:24,100 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:20:24,100 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.23it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.84it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.60it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.08it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 12:20:26,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:26
2025-03-13 12:20:57,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5565 secs
2025-03-13 12:20:57,302 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 12:20:57,302 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 12:21:13,195 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8924 secs
2025-03-13 12:21:13,196 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0960 secs
2025-03-13 12:21:13,197 [INFO]: {
2025-03-13 12:21:13,197 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:13,197 [INFO]: 	index_param: efSearch=257
2025-03-13 12:21:13,197 [INFO]: 	index_path: knn.index
2025-03-13 12:21:13,197 [INFO]: 	size in bytes: 436181290
2025-03-13 12:21:13,197 [INFO]: 	avg_search_speed_ms: 11.425561426207423
2025-03-13 12:21:13,197 [INFO]: 	99p_search_speed_ms: 14.24580521415919
2025-03-13 12:21:13,197 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:13,197 [INFO]: 	nb vectors: 2217
2025-03-13 12:21:13,197 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:13,197 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 12:21:13,197 [INFO]: }
2025-03-13 12:21:13,197 [INFO]: 	>>> Finished "Creating the index" in 49.0973 secs
2025-03-13 12:21:13,197 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1195 secs
2025-03-13 12:21:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 59541 [episode count 6/20]
[retrieval_preprocessing] for episode 23200 [episode count 7/20], we have num_retrieval=np.int64(2258) num_query=np.int64(91)
2025-03-13 12:21:15,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:15,764 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:15
2025-03-13 12:21:15,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1585.75it/s]
2025-03-13 12:21:15,787 [INFO]: There are 2258 embeddings of dim 49152
2025-03-13 12:21:15,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 12:21:15,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:15
2025-03-13 12:21:15,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:15,788 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:21:15,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:15,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:15,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:15
2025-03-13 12:21:15,788 [INFO]: 466.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:15,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:15,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:15
2025-03-13 12:21:15,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:15,788 [INFO]: 	Creating the index 03/13/2025, 12:21:15
2025-03-13 12:21:15,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:15
2025-03-13 12:21:15,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:21:15,789 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:15
2025-03-13 12:21:15,789 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:21:15,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.20it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.26it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.84it/s]100%|██████████| 9/9 [00:02<00:00,  2.39it/s]100%|██████████| 9/9 [00:02<00:00,  3.52it/s]
2025-03-13 12:21:18,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:18
2025-03-13 12:21:45,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5404 secs
2025-03-13 12:21:45,899 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 12:21:45,899 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 12:22:01,313 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4138 secs
2025-03-13 12:22:01,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5266 secs
2025-03-13 12:22:01,316 [INFO]: {
2025-03-13 12:22:01,316 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:01,316 [INFO]: 	index_param: efSearch=238
2025-03-13 12:22:01,316 [INFO]: 	index_path: knn.index
2025-03-13 12:22:01,316 [INFO]: 	size in bytes: 444247630
2025-03-13 12:22:01,316 [INFO]: 	avg_search_speed_ms: 12.603068222251887
2025-03-13 12:22:01,316 [INFO]: 	99p_search_speed_ms: 17.887007934041307
2025-03-13 12:22:01,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:01,316 [INFO]: 	nb vectors: 2258
2025-03-13 12:22:01,316 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:01,316 [INFO]: 	compression ratio: 0.9993094707111887
2025-03-13 12:22:01,316 [INFO]: }
2025-03-13 12:22:01,316 [INFO]: 	>>> Finished "Creating the index" in 45.5280 secs
2025-03-13 12:22:01,316 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5515 secs
2025-03-13 12:22:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 23200 [episode count 7/20]
[retrieval_preprocessing] for episode 58054 [episode count 8/20], we have num_retrieval=np.int64(2218) num_query=np.int64(131)
2025-03-13 12:22:03,355 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:03,757 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:03
2025-03-13 12:22:03,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.82it/s]
2025-03-13 12:22:03,782 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 12:22:03,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:22:03,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:03,782 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:22:03,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:03,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:03,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,782 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:03,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:22:03,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:03
2025-03-13 12:22:03,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:03,783 [INFO]: 	Creating the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,783 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:03
2025-03-13 12:22:03,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:22:03,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,784 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:22:03,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.37it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.41it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.27it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.09it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.98it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.43it/s]100%|██████████| 9/9 [00:02<00:00,  1.74it/s]100%|██████████| 9/9 [00:02<00:00,  3.37it/s]
2025-03-13 12:22:06,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:06
2025-03-13 12:22:36,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0730 secs
2025-03-13 12:22:36,535 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 12:22:36,535 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 12:22:58,908 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3726 secs
2025-03-13 12:22:58,909 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1253 secs
2025-03-13 12:22:58,909 [INFO]: {
2025-03-13 12:22:58,909 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:58,909 [INFO]: 	index_param: efSearch=272
2025-03-13 12:22:58,909 [INFO]: 	index_path: knn.index
2025-03-13 12:22:58,910 [INFO]: 	size in bytes: 436378030
2025-03-13 12:22:58,910 [INFO]: 	avg_search_speed_ms: 10.535158325394947
2025-03-13 12:22:58,910 [INFO]: 	99p_search_speed_ms: 13.163654711097477
2025-03-13 12:22:58,910 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:58,910 [INFO]: 	nb vectors: 2218
2025-03-13 12:22:58,910 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:58,910 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 12:22:58,910 [INFO]: }
2025-03-13 12:22:58,910 [INFO]: 	>>> Finished "Creating the index" in 55.1270 secs
2025-03-13 12:22:58,910 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1524 secs
2025-03-13 12:22:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 58054 [episode count 8/20]
[retrieval_preprocessing] for episode 51003 [episode count 9/20], we have num_retrieval=np.int64(2250) num_query=np.int64(99)
2025-03-13 12:23:00,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:01,142 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:01
2025-03-13 12:23:01,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.83it/s]
2025-03-13 12:23:01,164 [INFO]: There are 2250 embeddings of dim 49152
2025-03-13 12:23:01,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 12:23:01,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:01
2025-03-13 12:23:01,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:01,165 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:23:01,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:01,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:01,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:01
2025-03-13 12:23:01,165 [INFO]: 464.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:01,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:23:01,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:01
2025-03-13 12:23:01,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:01,165 [INFO]: 	Creating the index 03/13/2025, 12:23:01
2025-03-13 12:23:01,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:01
2025-03-13 12:23:01,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:23:01,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:01
2025-03-13 12:23:01,166 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:23:01,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.06it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.32it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.67it/s]100%|██████████| 9/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.92it/s]
2025-03-13 12:23:03,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:03
2025-03-13 12:23:35,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8321 secs
2025-03-13 12:23:35,306 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 12:23:35,306 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 12:23:50,931 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6252 secs
2025-03-13 12:23:50,933 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7669 secs
2025-03-13 12:23:50,933 [INFO]: {
2025-03-13 12:23:50,933 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:50,933 [INFO]: 	index_param: efSearch=247
2025-03-13 12:23:50,933 [INFO]: 	index_path: knn.index
2025-03-13 12:23:50,933 [INFO]: 	size in bytes: 442673710
2025-03-13 12:23:50,933 [INFO]: 	avg_search_speed_ms: 10.742101428188008
2025-03-13 12:23:50,933 [INFO]: 	99p_search_speed_ms: 14.311257284134632
2025-03-13 12:23:50,933 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:50,933 [INFO]: 	nb vectors: 2250
2025-03-13 12:23:50,933 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:50,933 [INFO]: 	compression ratio: 0.9993094010484608
2025-03-13 12:23:50,933 [INFO]: }
2025-03-13 12:23:50,933 [INFO]: 	>>> Finished "Creating the index" in 49.7682 secs
2025-03-13 12:23:50,933 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7910 secs
2025-03-13 12:23:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 51003 [episode count 9/20]
[retrieval_preprocessing] for episode 52550 [episode count 10/20], we have num_retrieval=np.int64(2184) num_query=np.int64(165)
2025-03-13 12:23:52,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:52,768 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:52
2025-03-13 12:23:52,768 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.33it/s]
2025-03-13 12:23:52,792 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 12:23:52,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 12:23:52,792 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:52
2025-03-13 12:23:52,792 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:52,792 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:23:52,792 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:52,792 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:52,792 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:52
2025-03-13 12:23:52,792 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:52,792 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:23:52,792 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:52
2025-03-13 12:23:52,792 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:52,792 [INFO]: 	Creating the index 03/13/2025, 12:23:52
2025-03-13 12:23:52,792 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:52
2025-03-13 12:23:52,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:23:52,793 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:52
2025-03-13 12:23:52,793 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:23:52,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.10it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.34it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.94it/s]100%|██████████| 9/9 [00:02<00:00,  3.10it/s]100%|██████████| 9/9 [00:02<00:00,  4.36it/s]
2025-03-13 12:23:54,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:54
2025-03-13 12:24:29,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1983 secs
2025-03-13 12:24:29,061 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 12:24:29,061 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s]
2025-03-13 12:24:48,888 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8268 secs
2025-03-13 12:24:48,889 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0960 secs
2025-03-13 12:24:48,890 [INFO]: {
2025-03-13 12:24:48,890 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:48,890 [INFO]: 	index_param: efSearch=220
2025-03-13 12:24:48,890 [INFO]: 	index_path: knn.index
2025-03-13 12:24:48,890 [INFO]: 	size in bytes: 429688750
2025-03-13 12:24:48,890 [INFO]: 	avg_search_speed_ms: 9.747309051544839
2025-03-13 12:24:48,890 [INFO]: 	99p_search_speed_ms: 14.74254805361852
2025-03-13 12:24:48,890 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:48,890 [INFO]: 	nb vectors: 2184
2025-03-13 12:24:48,890 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:48,890 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 12:24:48,890 [INFO]: }
2025-03-13 12:24:48,890 [INFO]: 	>>> Finished "Creating the index" in 56.0974 secs
2025-03-13 12:24:48,890 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1218 secs
2025-03-13 12:24:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 52550 [episode count 10/20]
[retrieval_preprocessing] for episode 92488 [episode count 11/20], we have num_retrieval=np.int64(2222) num_query=np.int64(127)
2025-03-13 12:24:50,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:51,258 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:51
2025-03-13 12:24:51,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.38it/s]
2025-03-13 12:24:51,283 [INFO]: There are 2222 embeddings of dim 49152
2025-03-13 12:24:51,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 12:24:51,284 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:51
2025-03-13 12:24:51,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:51,284 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:24:51,284 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:51,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:51,284 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:51
2025-03-13 12:24:51,284 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:51,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:51,284 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:51
2025-03-13 12:24:51,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:51,284 [INFO]: 	Creating the index 03/13/2025, 12:24:51
2025-03-13 12:24:51,284 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:51
2025-03-13 12:24:51,285 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:24:51,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:51
2025-03-13 12:24:51,285 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:24:51,285 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.79it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.04it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.65it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.89it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.01it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.51it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.96it/s]100%|██████████| 9/9 [00:02<00:00,  3.44it/s]
2025-03-13 12:24:53,903 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:53
2025-03-13 12:25:28,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2338 secs
2025-03-13 12:25:28,137 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:25:28,137 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s]
2025-03-13 12:25:46,803 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6652 secs
2025-03-13 12:25:46,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5197 secs
2025-03-13 12:25:46,805 [INFO]: {
2025-03-13 12:25:46,805 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:46,805 [INFO]: 	index_param: efSearch=190
2025-03-13 12:25:46,805 [INFO]: 	index_path: knn.index
2025-03-13 12:25:46,805 [INFO]: 	size in bytes: 437164990
2025-03-13 12:25:46,805 [INFO]: 	avg_search_speed_ms: 10.150306543978262
2025-03-13 12:25:46,805 [INFO]: 	99p_search_speed_ms: 16.263763615861535
2025-03-13 12:25:46,805 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:46,805 [INFO]: 	nb vectors: 2222
2025-03-13 12:25:46,805 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:46,805 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-13 12:25:46,805 [INFO]: }
2025-03-13 12:25:46,805 [INFO]: 	>>> Finished "Creating the index" in 55.5211 secs
2025-03-13 12:25:46,805 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5468 secs
2025-03-13 12:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 92488 [episode count 11/20]
[retrieval_preprocessing] for episode 58698 [episode count 12/20], we have num_retrieval=np.int64(2254) num_query=np.int64(95)
2025-03-13 12:25:48,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:49,032 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:49
2025-03-13 12:25:49,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1072.71it/s]
2025-03-13 12:25:49,562 [INFO]: There are 2254 embeddings of dim 49152
2025-03-13 12:25:49,563 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5304 secs
2025-03-13 12:25:49,563 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,563 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:49,563 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:25:49,563 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:49,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:25:49,563 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,564 [INFO]: 465.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:49,564 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:25:49,564 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:49
2025-03-13 12:25:49,564 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:49,564 [INFO]: 	Creating the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,564 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:49
2025-03-13 12:25:49,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 12:25:49,567 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,567 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:25:49,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.59it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.97it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.13it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.36it/s]100%|██████████| 9/9 [00:02<00:00,  2.12it/s]100%|██████████| 9/9 [00:02<00:00,  3.10it/s]
2025-03-13 12:25:52,480 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:52
2025-03-13 12:26:27,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2113 secs
2025-03-13 12:26:27,693 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:26:27,693 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 12:26:45,055 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3622 secs
2025-03-13 12:26:45,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8782 secs
2025-03-13 12:26:45,445 [INFO]: {
2025-03-13 12:26:45,445 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:45,445 [INFO]: 	index_param: efSearch=235
2025-03-13 12:26:45,445 [INFO]: 	index_path: knn.index
2025-03-13 12:26:45,445 [INFO]: 	size in bytes: 443460670
2025-03-13 12:26:45,446 [INFO]: 	avg_search_speed_ms: 10.594349243516355
2025-03-13 12:26:45,446 [INFO]: 	99p_search_speed_ms: 16.790238101966608
2025-03-13 12:26:45,446 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:45,446 [INFO]: 	nb vectors: 2254
2025-03-13 12:26:45,446 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:45,446 [INFO]: 	compression ratio: 0.999309435941636
2025-03-13 12:26:45,446 [INFO]: }
2025-03-13 12:26:45,446 [INFO]: 	>>> Finished "Creating the index" in 55.8818 secs
2025-03-13 12:26:45,446 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4136 secs
2025-03-13 12:26:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 58698 [episode count 12/20]
[retrieval_preprocessing] for episode 18251 [episode count 13/20], we have num_retrieval=np.int64(2216) num_query=np.int64(133)
2025-03-13 12:26:47,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:47,569 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:47
2025-03-13 12:26:47,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.57it/s]
2025-03-13 12:26:47,597 [INFO]: There are 2216 embeddings of dim 49152
2025-03-13 12:26:47,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:26:47,598 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:47
2025-03-13 12:26:47,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:47,598 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:26:47,598 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:47,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:26:47,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:47
2025-03-13 12:26:47,599 [INFO]: 457.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:47,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:26:47,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:47
2025-03-13 12:26:47,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:47,600 [INFO]: 	Creating the index 03/13/2025, 12:26:47
2025-03-13 12:26:47,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:47
2025-03-13 12:26:47,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:26:47,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:47
2025-03-13 12:26:47,603 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:26:47,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.66it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.81it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.52it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.44it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.55it/s]100%|██████████| 9/9 [00:02<00:00,  2.37it/s]100%|██████████| 9/9 [00:02<00:00,  3.67it/s]
2025-03-13 12:26:50,061 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:50
2025-03-13 12:27:18,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0759 secs
2025-03-13 12:27:18,138 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:27:18,138 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 12:27:40,059 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9211 secs
2025-03-13 12:27:40,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4575 secs
2025-03-13 12:27:40,061 [INFO]: {
2025-03-13 12:27:40,061 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:40,061 [INFO]: 	index_param: efSearch=252
2025-03-13 12:27:40,061 [INFO]: 	index_path: knn.index
2025-03-13 12:27:40,061 [INFO]: 	size in bytes: 435984550
2025-03-13 12:27:40,061 [INFO]: 	avg_search_speed_ms: 9.82341396348818
2025-03-13 12:27:40,061 [INFO]: 	99p_search_speed_ms: 12.598725969437512
2025-03-13 12:27:40,061 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:40,061 [INFO]: 	nb vectors: 2216
2025-03-13 12:27:40,061 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:40,061 [INFO]: 	compression ratio: 0.9993090993706084
2025-03-13 12:27:40,061 [INFO]: }
2025-03-13 12:27:40,061 [INFO]: 	>>> Finished "Creating the index" in 52.4614 secs
2025-03-13 12:27:40,061 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4917 secs
2025-03-13 12:27:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 18251 [episode count 13/20]
[retrieval_preprocessing] for episode 77133 [episode count 14/20], we have num_retrieval=np.int64(2207) num_query=np.int64(142)
2025-03-13 12:27:42,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:42,346 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:42
2025-03-13 12:27:42,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2286.97it/s]
2025-03-13 12:27:42,370 [INFO]: There are 2207 embeddings of dim 49152
2025-03-13 12:27:42,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 12:27:42,371 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:42
2025-03-13 12:27:42,371 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:42,371 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:27:42,371 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:42,371 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:27:42,371 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:42
2025-03-13 12:27:42,371 [INFO]: 455.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:42,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:27:42,372 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:42
2025-03-13 12:27:42,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:42,372 [INFO]: 	Creating the index 03/13/2025, 12:27:42
2025-03-13 12:27:42,372 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:42
2025-03-13 12:27:42,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:27:42,376 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:42
2025-03-13 12:27:42,376 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:27:42,376 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.03it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.67it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.44it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.74it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.52it/s]100%|██████████| 9/9 [00:02<00:00,  2.01it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]
2025-03-13 12:27:44,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:44
2025-03-13 12:28:11,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8431 secs
2025-03-13 12:28:11,777 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:28:11,777 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-13 12:28:26,504 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7272 secs
2025-03-13 12:28:26,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1299 secs
2025-03-13 12:28:26,506 [INFO]: {
2025-03-13 12:28:26,506 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:26,506 [INFO]: 	index_param: efSearch=266
2025-03-13 12:28:26,506 [INFO]: 	index_path: knn.index
2025-03-13 12:28:26,506 [INFO]: 	size in bytes: 434213890
2025-03-13 12:28:26,506 [INFO]: 	avg_search_speed_ms: 11.484364193332746
2025-03-13 12:28:26,506 [INFO]: 	99p_search_speed_ms: 16.26470165792852
2025-03-13 12:28:26,506 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:26,506 [INFO]: 	nb vectors: 2207
2025-03-13 12:28:26,506 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:26,506 [INFO]: 	compression ratio: 0.9993090179588682
2025-03-13 12:28:26,506 [INFO]: }
2025-03-13 12:28:26,506 [INFO]: 	>>> Finished "Creating the index" in 44.1338 secs
2025-03-13 12:28:26,506 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1606 secs
2025-03-13 12:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 77133 [episode count 14/20]
[retrieval_preprocessing] for episode 52047 [episode count 15/20], we have num_retrieval=np.int64(2230) num_query=np.int64(119)
2025-03-13 12:28:28,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:29,595 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:29
2025-03-13 12:28:29,595 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2310.91it/s]
2025-03-13 12:28:29,618 [INFO]: There are 2230 embeddings of dim 49152
2025-03-13 12:28:29,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 12:28:29,618 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:29
2025-03-13 12:28:29,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:29,618 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:28:29,618 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:29,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:29,618 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:29
2025-03-13 12:28:29,618 [INFO]: 460.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:29,618 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:28:29,618 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:29
2025-03-13 12:28:29,618 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:29,618 [INFO]: 	Creating the index 03/13/2025, 12:28:29
2025-03-13 12:28:29,618 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:29
2025-03-13 12:28:29,619 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:28:29,619 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:29
2025-03-13 12:28:29,619 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:28:29,619 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.38it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.88it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.89it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]100%|██████████| 9/9 [00:02<00:00,  4.33it/s]
2025-03-13 12:28:31,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:31
2025-03-13 12:29:00,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6735 secs
2025-03-13 12:29:00,380 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:29:00,380 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-13 12:29:21,647 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2670 secs
2025-03-13 12:29:21,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0301 secs
2025-03-13 12:29:21,650 [INFO]: {
2025-03-13 12:29:21,650 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:21,650 [INFO]: 	index_param: efSearch=239
2025-03-13 12:29:21,650 [INFO]: 	index_path: knn.index
2025-03-13 12:29:21,650 [INFO]: 	size in bytes: 438738910
2025-03-13 12:29:21,650 [INFO]: 	avg_search_speed_ms: 9.890693682038643
2025-03-13 12:29:21,650 [INFO]: 	99p_search_speed_ms: 12.473033927381039
2025-03-13 12:29:21,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:21,650 [INFO]: 	nb vectors: 2230
2025-03-13 12:29:21,650 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:21,650 [INFO]: 	compression ratio: 0.9993092247049618
2025-03-13 12:29:21,650 [INFO]: }
2025-03-13 12:29:21,650 [INFO]: 	>>> Finished "Creating the index" in 52.0316 secs
2025-03-13 12:29:21,650 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0543 secs
2025-03-13 12:29:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 52047 [episode count 15/20]
[retrieval_preprocessing] for episode 82787 [episode count 16/20], we have num_retrieval=np.int64(2233) num_query=np.int64(116)
2025-03-13 12:29:23,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:23,853 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:23
2025-03-13 12:29:23,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.06it/s]
2025-03-13 12:29:23,877 [INFO]: There are 2233 embeddings of dim 49152
2025-03-13 12:29:23,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:29:23,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:23
2025-03-13 12:29:23,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:23,878 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:29:23,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:23,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:29:23,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:23
2025-03-13 12:29:23,879 [INFO]: 460.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:23,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:29:23,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:23
2025-03-13 12:29:23,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:23,879 [INFO]: 	Creating the index 03/13/2025, 12:29:23
2025-03-13 12:29:23,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:23
2025-03-13 12:29:23,883 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:29:23,883 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:23
2025-03-13 12:29:23,883 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:29:23,883 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.96it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.08it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.52it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.72it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.80it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.86it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.86it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.16it/s]100%|██████████| 9/9 [00:02<00:00,  1.46it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]
2025-03-13 12:29:26,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:26
2025-03-13 12:29:53,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7418 secs
2025-03-13 12:29:53,581 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 12:29:53,581 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 12:30:08,093 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5117 secs
2025-03-13 12:30:08,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2120 secs
2025-03-13 12:30:08,095 [INFO]: {
2025-03-13 12:30:08,095 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:08,095 [INFO]: 	index_param: efSearch=185
2025-03-13 12:30:08,095 [INFO]: 	index_path: knn.index
2025-03-13 12:30:08,095 [INFO]: 	size in bytes: 439329130
2025-03-13 12:30:08,095 [INFO]: 	avg_search_speed_ms: 10.274063166707586
2025-03-13 12:30:08,095 [INFO]: 	99p_search_speed_ms: 15.883768890053016
2025-03-13 12:30:08,095 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:08,095 [INFO]: 	nb vectors: 2233
2025-03-13 12:30:08,095 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:08,095 [INFO]: 	compression ratio: 0.9993092513578601
2025-03-13 12:30:08,095 [INFO]: }
2025-03-13 12:30:08,095 [INFO]: 	>>> Finished "Creating the index" in 44.2157 secs
2025-03-13 12:30:08,095 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2424 secs
2025-03-13 12:30:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 82787 [episode count 16/20]
[retrieval_preprocessing] for episode 88560 [episode count 17/20], we have num_retrieval=np.int64(2256) num_query=np.int64(93)
2025-03-13 12:30:09,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:10,042 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:10
2025-03-13 12:30:10,042 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.05it/s]
2025-03-13 12:30:10,069 [INFO]: There are 2256 embeddings of dim 49152
2025-03-13 12:30:10,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:30:10,070 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:10
2025-03-13 12:30:10,070 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:10,070 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:30:10,071 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:10,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:30:10,071 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:10
2025-03-13 12:30:10,071 [INFO]: 465.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:10,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:30:10,072 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:10
2025-03-13 12:30:10,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:10,072 [INFO]: 	Creating the index 03/13/2025, 12:30:10
2025-03-13 12:30:10,072 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:10
2025-03-13 12:30:10,075 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:30:10,075 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:10
2025-03-13 12:30:10,075 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:30:10,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.99it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.98it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.39it/s]100%|██████████| 9/9 [00:02<00:00,  2.73it/s]100%|██████████| 9/9 [00:02<00:00,  3.96it/s]
2025-03-13 12:30:12,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:12
2025-03-13 12:30:42,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5289 secs
2025-03-13 12:30:42,888 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:30:42,888 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 12:31:00,037 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1490 secs
2025-03-13 12:31:00,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9636 secs
2025-03-13 12:31:00,039 [INFO]: {
2025-03-13 12:31:00,039 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:00,039 [INFO]: 	index_param: efSearch=248
2025-03-13 12:31:00,039 [INFO]: 	index_path: knn.index
2025-03-13 12:31:00,039 [INFO]: 	size in bytes: 443854150
2025-03-13 12:31:00,039 [INFO]: 	avg_search_speed_ms: 10.46309556405812
2025-03-13 12:31:00,039 [INFO]: 	99p_search_speed_ms: 14.774637809023265
2025-03-13 12:31:00,039 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:00,039 [INFO]: 	nb vectors: 2256
2025-03-13 12:31:00,039 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:00,039 [INFO]: 	compression ratio: 0.9993094533418241
2025-03-13 12:31:00,039 [INFO]: }
2025-03-13 12:31:00,039 [INFO]: 	>>> Finished "Creating the index" in 49.9673 secs
2025-03-13 12:31:00,039 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9973 secs
2025-03-13 12:31:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 88560 [episode count 17/20]
[retrieval_preprocessing] for episode 76711 [episode count 18/20], we have num_retrieval=np.int64(2251) num_query=np.int64(98)
2025-03-13 12:31:01,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:01,938 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:01
2025-03-13 12:31:01,939 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1667.05it/s]
2025-03-13 12:31:01,962 [INFO]: There are 2251 embeddings of dim 49152
2025-03-13 12:31:01,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 12:31:01,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:01
2025-03-13 12:31:01,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:01,963 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:31:01,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:01,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:31:01,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:01
2025-03-13 12:31:01,963 [INFO]: 464.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:01,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:31:01,963 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:01
2025-03-13 12:31:01,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:01,963 [INFO]: 	Creating the index 03/13/2025, 12:31:01
2025-03-13 12:31:01,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:01
2025-03-13 12:31:01,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:31:01,964 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:01
2025-03-13 12:31:01,964 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:31:01,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.71it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.46it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.46it/s] 67%|██████▋   | 6/9 [00:00<00:00, 10.68it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.32it/s]100%|██████████| 9/9 [00:02<00:00,  3.42it/s]
2025-03-13 12:31:04,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:04
2025-03-13 12:31:32,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7005 secs
2025-03-13 12:31:32,309 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 12:31:32,309 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s]
2025-03-13 12:31:47,810 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5003 secs
2025-03-13 12:31:47,811 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8468 secs
2025-03-13 12:31:47,811 [INFO]: {
2025-03-13 12:31:47,811 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:47,811 [INFO]: 	index_param: efSearch=237
2025-03-13 12:31:47,811 [INFO]: 	index_path: knn.index
2025-03-13 12:31:47,811 [INFO]: 	size in bytes: 442870450
2025-03-13 12:31:47,811 [INFO]: 	avg_search_speed_ms: 10.077500660225914
2025-03-13 12:31:47,811 [INFO]: 	99p_search_speed_ms: 13.338419243227692
2025-03-13 12:31:47,811 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:47,811 [INFO]: 	nb vectors: 2251
2025-03-13 12:31:47,811 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:47,811 [INFO]: 	compression ratio: 0.9993094097833802
2025-03-13 12:31:47,811 [INFO]: }
2025-03-13 12:31:47,811 [INFO]: 	>>> Finished "Creating the index" in 45.8481 secs
2025-03-13 12:31:47,811 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8729 secs
2025-03-13 12:31:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 76711 [episode count 18/20]
[retrieval_preprocessing] for episode 31667 [episode count 19/20], we have num_retrieval=np.int64(2228) num_query=np.int64(121)
2025-03-13 12:31:49,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:49,999 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:49
2025-03-13 12:31:49,999 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2325.00it/s]
2025-03-13 12:31:50,022 [INFO]: There are 2228 embeddings of dim 49152
2025-03-13 12:31:50,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 12:31:50,022 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:50
2025-03-13 12:31:50,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:50,023 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:31:50,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:50,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:31:50,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:50
2025-03-13 12:31:50,023 [INFO]: 459.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:50,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:31:50,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:50
2025-03-13 12:31:50,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:50,024 [INFO]: 	Creating the index 03/13/2025, 12:31:50
2025-03-13 12:31:50,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:50
2025-03-13 12:31:50,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 12:31:50,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:50
2025-03-13 12:31:50,026 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:31:50,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.21it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.66it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.52it/s] 67%|██████▋   | 6/9 [00:00<00:00, 10.03it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.72it/s]
2025-03-13 12:31:52,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:52
2025-03-13 12:32:24,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4433 secs
2025-03-13 12:32:24,332 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 12:32:24,332 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-13 12:32:39,465 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1328 secs
2025-03-13 12:32:39,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4409 secs
2025-03-13 12:32:39,467 [INFO]: {
2025-03-13 12:32:39,467 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:39,467 [INFO]: 	index_param: efSearch=217
2025-03-13 12:32:39,467 [INFO]: 	index_path: knn.index
2025-03-13 12:32:39,467 [INFO]: 	size in bytes: 438345430
2025-03-13 12:32:39,467 [INFO]: 	avg_search_speed_ms: 9.614694381105856
2025-03-13 12:32:39,467 [INFO]: 	99p_search_speed_ms: 12.252943294588471
2025-03-13 12:32:39,467 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:39,467 [INFO]: 	nb vectors: 2228
2025-03-13 12:32:39,467 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:39,467 [INFO]: 	compression ratio: 0.9993092068964881
2025-03-13 12:32:39,467 [INFO]: }
2025-03-13 12:32:39,467 [INFO]: 	>>> Finished "Creating the index" in 49.4436 secs
2025-03-13 12:32:39,467 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4687 secs
2025-03-13 12:32:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 31667 [episode count 19/20]
2025-03-13 12:32:40: [retrieval_preprocessing] finished for 65137982_put_yellow_block_in_blue_cup [chosen_id count 4/260]
2025-03-13 12:32:45: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6518509549_put_item_in_box [chosen_id count 5/260]
2025-03-13 12:32:45: [retrieval_preprocessing] we have num_total=8803 embedding_dim=49152
[retrieval_preprocessing] for episode 36362 [episode count 0/20], we have num_retrieval=np.int64(8461) num_query=np.int64(342)
2025-03-13 12:32:47,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:49,392 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:49
2025-03-13 12:32:49,392 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1951.75it/s]
2025-03-13 12:32:49,414 [INFO]: There are 8461 embeddings of dim 49152
2025-03-13 12:32:49,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 12:32:49,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:49
2025-03-13 12:32:49,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:49,415 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 12:32:49,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:49,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:49,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:49
2025-03-13 12:32:49,415 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:49,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:49,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:49
2025-03-13 12:32:49,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:49,415 [INFO]: 	Creating the index 03/13/2025, 12:32:49
2025-03-13 12:32:49,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:49
2025-03-13 12:32:49,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:32:49,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:49
2025-03-13 12:32:49,416 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:32:49,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.67it/s]  6%|▌         | 2/35 [00:00<00:05,  6.29it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.61it/s] 17%|█▋        | 6/35 [00:00<00:02,  9.67it/s] 23%|██▎       | 8/35 [00:00<00:02, 10.56it/s] 29%|██▊       | 10/35 [00:00<00:02, 11.88it/s] 34%|███▍      | 12/35 [00:01<00:01, 12.81it/s] 40%|████      | 14/35 [00:01<00:01, 12.36it/s] 46%|████▌     | 16/35 [00:01<00:01, 12.13it/s] 51%|█████▏    | 18/35 [00:01<00:01, 11.95it/s] 57%|█████▋    | 20/35 [00:01<00:01, 11.88it/s] 63%|██████▎   | 22/35 [00:05<00:09,  1.43it/s] 66%|██████▌   | 23/35 [00:06<00:07,  1.67it/s] 69%|██████▊   | 24/35 [00:06<00:05,  1.99it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.39it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.86it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.38it/s] 80%|████████  | 28/35 [00:06<00:01,  3.96it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.54it/s] 86%|████████▌ | 30/35 [00:07<00:00,  5.11it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.59it/s] 91%|█████████▏| 32/35 [00:07<00:00,  6.27it/s] 94%|█████████▍| 33/35 [00:07<00:00,  7.01it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.61it/s]100%|██████████| 35/35 [00:11<00:00,  1.35s/it]100%|██████████| 35/35 [00:11<00:00,  2.98it/s]
2025-03-13 12:33:01,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:01
2025-03-13 12:34:11,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.0654 secs
2025-03-13 12:34:11,223 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 12:34:11,223 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 12:34:34,098 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8750 secs
2025-03-13 12:34:34,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.6848 secs
2025-03-13 12:34:34,101 [INFO]: {
2025-03-13 12:34:34,101 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:34,101 [INFO]: 	index_param: efSearch=128
2025-03-13 12:34:34,101 [INFO]: 	index_path: knn.index
2025-03-13 12:34:34,101 [INFO]: 	size in bytes: 1664651590
2025-03-13 12:34:34,101 [INFO]: 	avg_search_speed_ms: 8.017830532746212
2025-03-13 12:34:34,101 [INFO]: 	99p_search_speed_ms: 15.804367205128065
2025-03-13 12:34:34,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:34,101 [INFO]: 	nb vectors: 8461
2025-03-13 12:34:34,101 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:34,101 [INFO]: 	compression ratio: 0.9993083826027523
2025-03-13 12:34:34,101 [INFO]: }
2025-03-13 12:34:34,101 [INFO]: 	>>> Finished "Creating the index" in 104.6862 secs
2025-03-13 12:34:34,101 [INFO]: >>> Finished "Launching the whole pipeline" in 104.7092 secs
2025-03-13 12:34:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 36362 [episode count 0/20]
[retrieval_preprocessing] for episode 4119 [episode count 1/20], we have num_retrieval=np.int64(7996) num_query=np.int64(807)
2025-03-13 12:34:39,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:40,974 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:40
2025-03-13 12:34:40,974 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.76it/s]
2025-03-13 12:34:40,999 [INFO]: There are 7996 embeddings of dim 49152
2025-03-13 12:34:40,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:34:40,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:40
2025-03-13 12:34:40,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:40,999 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 12:34:40,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:40,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:40,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:40
2025-03-13 12:34:40,999 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:41,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:34:41,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:41
2025-03-13 12:34:41,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:41,000 [INFO]: 	Creating the index 03/13/2025, 12:34:41
2025-03-13 12:34:41,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:41
2025-03-13 12:34:41,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:34:41,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:41
2025-03-13 12:34:41,001 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:34:41,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:07,  4.55it/s]  9%|▉         | 3/33 [00:00<00:03,  9.58it/s] 15%|█▌        | 5/33 [00:00<00:02, 12.22it/s] 21%|██        | 7/33 [00:00<00:01, 13.56it/s] 27%|██▋       | 9/33 [00:00<00:01, 13.89it/s] 33%|███▎      | 11/33 [00:00<00:01, 15.43it/s] 42%|████▏     | 14/33 [00:00<00:01, 18.17it/s] 52%|█████▏    | 17/33 [00:01<00:00, 20.21it/s] 61%|██████    | 20/33 [00:01<00:00, 21.50it/s] 70%|██████▉   | 23/33 [00:05<00:05,  1.78it/s] 76%|███████▌  | 25/33 [00:06<00:03,  2.22it/s] 82%|████████▏ | 27/33 [00:06<00:02,  2.77it/s] 88%|████████▊ | 29/33 [00:06<00:01,  3.51it/s] 94%|█████████▍| 31/33 [00:06<00:00,  4.37it/s]100%|██████████| 33/33 [00:10<00:00,  1.36it/s]100%|██████████| 33/33 [00:10<00:00,  3.08it/s]
2025-03-13 12:34:51,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:51
2025-03-13 12:35:55,327 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6122 secs
2025-03-13 12:35:55,327 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 12:35:55,327 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.03it/s] 50%|█████     | 2/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 12:36:20,417 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0899 secs
2025-03-13 12:36:20,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.4191 secs
2025-03-13 12:36:20,420 [INFO]: {
2025-03-13 12:36:20,420 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:20,420 [INFO]: 	index_param: efSearch=188
2025-03-13 12:36:20,420 [INFO]: 	index_path: knn.index
2025-03-13 12:36:20,420 [INFO]: 	size in bytes: 1573165930
2025-03-13 12:36:20,420 [INFO]: 	avg_search_speed_ms: 10.739699262419414
2025-03-13 12:36:20,420 [INFO]: 	99p_search_speed_ms: 20.34718589857221
2025-03-13 12:36:20,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:20,420 [INFO]: 	nb vectors: 7996
2025-03-13 12:36:20,420 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:20,420 [INFO]: 	compression ratio: 0.999308170880614
2025-03-13 12:36:20,420 [INFO]: }
2025-03-13 12:36:20,420 [INFO]: 	>>> Finished "Creating the index" in 99.4207 secs
2025-03-13 12:36:20,420 [INFO]: >>> Finished "Launching the whole pipeline" in 99.4463 secs
2025-03-13 12:36:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 4119 [episode count 1/20]
[retrieval_preprocessing] for episode 42518 [episode count 2/20], we have num_retrieval=np.int64(8331) num_query=np.int64(472)
2025-03-13 12:36:31,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:33,355 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:33
2025-03-13 12:36:33,355 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.55it/s]
2025-03-13 12:36:33,468 [INFO]: There are 8331 embeddings of dim 49152
2025-03-13 12:36:33,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1137 secs
2025-03-13 12:36:33,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:33
2025-03-13 12:36:33,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:33,469 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 12:36:33,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:33,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:36:33,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:33
2025-03-13 12:36:33,470 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:33,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:36:33,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:33
2025-03-13 12:36:33,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:33,470 [INFO]: 	Creating the index 03/13/2025, 12:36:33
2025-03-13 12:36:33,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:33
2025-03-13 12:36:33,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:36:33,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:33
2025-03-13 12:36:33,474 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:36:33,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.65it/s]  9%|▉         | 3/34 [00:00<00:03,  7.90it/s] 15%|█▍        | 5/34 [00:00<00:03,  9.05it/s] 21%|██        | 7/34 [00:00<00:02,  9.56it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.54it/s] 29%|██▉       | 10/34 [00:01<00:02, 10.00it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.70it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.53it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.40it/s] 41%|████      | 14/34 [00:01<00:02,  9.22it/s] 44%|████▍     | 15/34 [00:01<00:02,  9.37it/s] 50%|█████     | 17/34 [00:01<00:01, 10.28it/s] 56%|█████▌    | 19/34 [00:01<00:01, 11.21it/s] 62%|██████▏   | 21/34 [00:05<00:09,  1.31it/s] 65%|██████▍   | 22/34 [00:08<00:12,  1.06s/it] 71%|███████   | 24/34 [00:08<00:06,  1.44it/s] 74%|███████▎  | 25/34 [00:08<00:05,  1.74it/s] 76%|███████▋  | 26/34 [00:08<00:03,  2.11it/s] 82%|████████▏ | 28/34 [00:08<00:01,  3.08it/s] 88%|████████▊ | 30/34 [00:08<00:00,  4.29it/s] 94%|█████████▍| 32/34 [00:09<00:00,  5.42it/s]100%|██████████| 34/34 [00:13<00:00,  1.19it/s]100%|██████████| 34/34 [00:13<00:00,  2.53it/s]
2025-03-13 12:36:46,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:46
2025-03-13 12:38:01,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.6846 secs
2025-03-13 12:38:01,611 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 12:38:01,611 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 12:38:30,373 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7618 secs
2025-03-13 12:38:31,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.5356 secs
2025-03-13 12:38:31,010 [INFO]: {
2025-03-13 12:38:31,010 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:31,010 [INFO]: 	index_param: efSearch=174
2025-03-13 12:38:31,010 [INFO]: 	index_path: knn.index
2025-03-13 12:38:31,010 [INFO]: 	size in bytes: 1639074970
2025-03-13 12:38:31,010 [INFO]: 	avg_search_speed_ms: 9.056882113867871
2025-03-13 12:38:31,010 [INFO]: 	99p_search_speed_ms: 15.409392018336806
2025-03-13 12:38:31,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:31,010 [INFO]: 	nb vectors: 8331
2025-03-13 12:38:31,010 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:31,010 [INFO]: 	compression ratio: 0.9993083159582383
2025-03-13 12:38:31,011 [INFO]: }
2025-03-13 12:38:31,011 [INFO]: 	>>> Finished "Creating the index" in 117.5403 secs
2025-03-13 12:38:31,011 [INFO]: >>> Finished "Launching the whole pipeline" in 117.6558 secs
2025-03-13 12:38:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 42518 [episode count 2/20]
[retrieval_preprocessing] for episode 25133 [episode count 3/20], we have num_retrieval=np.int64(8554) num_query=np.int64(249)
2025-03-13 12:38:37,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:38,454 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:38
2025-03-13 12:38:38,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 12:38:38,478 [INFO]: There are 8554 embeddings of dim 49152
2025-03-13 12:38:38,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:38:38,479 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:38
2025-03-13 12:38:38,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:38,479 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 12:38:38,479 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:38,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:38:38,479 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:38
2025-03-13 12:38:38,479 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:38,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:38:38,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:38
2025-03-13 12:38:38,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:38,479 [INFO]: 	Creating the index 03/13/2025, 12:38:38
2025-03-13 12:38:38,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:38
2025-03-13 12:38:38,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:38:38,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:38
2025-03-13 12:38:38,480 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:38:38,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.27it/s]  9%|▊         | 3/35 [00:00<00:04,  7.71it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.64it/s] 20%|██        | 7/35 [00:00<00:02, 11.66it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.60it/s] 31%|███▏      | 11/35 [00:00<00:01, 13.10it/s] 37%|███▋      | 13/35 [00:01<00:01, 13.59it/s] 43%|████▎     | 15/35 [00:01<00:01, 14.16it/s] 49%|████▊     | 17/35 [00:01<00:01, 15.00it/s] 54%|█████▍    | 19/35 [00:01<00:01, 15.60it/s] 60%|██████    | 21/35 [00:04<00:07,  1.78it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.39it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.16it/s] 77%|███████▋  | 27/35 [00:05<00:01,  4.04it/s] 83%|████████▎ | 29/35 [00:05<00:01,  5.05it/s] 89%|████████▊ | 31/35 [00:05<00:00,  6.11it/s] 94%|█████████▍| 33/35 [00:05<00:00,  7.17it/s]100%|██████████| 35/35 [00:09<00:00,  1.65it/s]100%|██████████| 35/35 [00:09<00:00,  3.79it/s]
2025-03-13 12:38:47,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:47
2025-03-13 12:39:54,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.2853 secs
2025-03-13 12:39:54,014 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 12:39:54,014 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.96it/s]
2025-03-13 12:40:33,784 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7699 secs
2025-03-13 12:40:33,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.3074 secs
2025-03-13 12:40:33,788 [INFO]: {
2025-03-13 12:40:33,788 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:33,788 [INFO]: 	index_param: efSearch=214
2025-03-13 12:40:33,788 [INFO]: 	index_path: knn.index
2025-03-13 12:40:33,788 [INFO]: 	size in bytes: 1682948830
2025-03-13 12:40:33,788 [INFO]: 	avg_search_speed_ms: 11.748713982551678
2025-03-13 12:40:33,788 [INFO]: 	99p_search_speed_ms: 23.310478287748992
2025-03-13 12:40:33,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:33,788 [INFO]: 	nb vectors: 8554
2025-03-13 12:40:33,788 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:33,788 [INFO]: 	compression ratio: 0.9993083580562577
2025-03-13 12:40:33,788 [INFO]: }
2025-03-13 12:40:33,788 [INFO]: 	>>> Finished "Creating the index" in 115.3089 secs
2025-03-13 12:40:33,788 [INFO]: >>> Finished "Launching the whole pipeline" in 115.3344 secs
2025-03-13 12:40:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25133 [episode count 3/20]
[retrieval_preprocessing] for episode 8239 [episode count 4/20], we have num_retrieval=np.int64(7958) num_query=np.int64(845)
2025-03-13 12:40:44,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:45,665 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:45
2025-03-13 12:40:45,665 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2721.81it/s]
2025-03-13 12:40:45,700 [INFO]: There are 7958 embeddings of dim 49152
2025-03-13 12:40:45,700 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 12:40:45,700 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:45
2025-03-13 12:40:45,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:45,701 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 12:40:45,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:45,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:40:45,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:45
2025-03-13 12:40:45,701 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:45,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:40:45,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:45
2025-03-13 12:40:45,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:45,701 [INFO]: 	Creating the index 03/13/2025, 12:40:45
2025-03-13 12:40:45,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:45
2025-03-13 12:40:45,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:40:45,703 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:45
2025-03-13 12:40:45,703 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:40:45,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  4.92it/s]  6%|▌         | 2/33 [00:00<00:05,  6.08it/s]  9%|▉         | 3/33 [00:00<00:04,  6.46it/s] 12%|█▏        | 4/33 [00:00<00:04,  6.49it/s] 15%|█▌        | 5/33 [00:00<00:04,  6.84it/s] 18%|█▊        | 6/33 [00:00<00:03,  6.91it/s] 21%|██        | 7/33 [00:01<00:03,  6.96it/s] 24%|██▍       | 8/33 [00:01<00:03,  7.22it/s] 27%|██▋       | 9/33 [00:01<00:03,  7.09it/s] 30%|███       | 10/33 [00:01<00:03,  7.15it/s] 33%|███▎      | 11/33 [00:01<00:02,  7.41it/s] 39%|███▉      | 13/33 [00:01<00:02,  9.71it/s] 45%|████▌     | 15/33 [00:01<00:01, 11.94it/s] 52%|█████▏    | 17/33 [00:01<00:01, 13.79it/s] 58%|█████▊    | 19/33 [00:02<00:00, 15.06it/s] 64%|██████▎   | 21/33 [00:08<00:12,  1.03s/it] 76%|███████▌  | 25/33 [00:08<00:04,  1.84it/s] 88%|████████▊ | 29/33 [00:08<00:01,  3.01it/s]100%|██████████| 33/33 [00:11<00:00,  1.81it/s]100%|██████████| 33/33 [00:11<00:00,  2.76it/s]
2025-03-13 12:40:57,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:57
2025-03-13 12:42:42,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 104.7412 secs
2025-03-13 12:42:42,413 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 12:42:42,413 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.01it/s]
2025-03-13 12:43:04,960 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5465 secs
2025-03-13 12:43:04,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.2597 secs
2025-03-13 12:43:04,963 [INFO]: {
2025-03-13 12:43:04,963 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:04,963 [INFO]: 	index_param: efSearch=114
2025-03-13 12:43:04,963 [INFO]: 	index_path: knn.index
2025-03-13 12:43:04,963 [INFO]: 	size in bytes: 1565689690
2025-03-13 12:43:04,963 [INFO]: 	avg_search_speed_ms: 9.98861212041471
2025-03-13 12:43:04,963 [INFO]: 	99p_search_speed_ms: 16.603979049250484
2025-03-13 12:43:04,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:04,963 [INFO]: 	nb vectors: 7958
2025-03-13 12:43:04,963 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:04,963 [INFO]: 	compression ratio: 0.9993081477083751
2025-03-13 12:43:04,963 [INFO]: }
2025-03-13 12:43:04,963 [INFO]: 	>>> Finished "Creating the index" in 139.2617 secs
2025-03-13 12:43:04,963 [INFO]: >>> Finished "Launching the whole pipeline" in 139.2983 secs
2025-03-13 12:43:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 8239 [episode count 4/20]
[retrieval_preprocessing] for episode 50735 [episode count 5/20], we have num_retrieval=np.int64(8483) num_query=np.int64(320)
2025-03-13 12:43:13,548 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:14,781 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:14
2025-03-13 12:43:14,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-13 12:43:14,818 [INFO]: There are 8483 embeddings of dim 49152
2025-03-13 12:43:14,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 12:43:14,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:14
2025-03-13 12:43:14,819 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:14,819 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 12:43:14,819 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:14,819 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:43:14,819 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:14
2025-03-13 12:43:14,820 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:14,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:43:14,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:14
2025-03-13 12:43:14,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:14,820 [INFO]: 	Creating the index 03/13/2025, 12:43:14
2025-03-13 12:43:14,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:14
2025-03-13 12:43:14,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 12:43:14,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:14
2025-03-13 12:43:14,824 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:43:14,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.15it/s] 14%|█▍        | 5/35 [00:00<00:01, 26.29it/s] 29%|██▊       | 10/35 [00:00<00:00, 33.30it/s] 40%|████      | 14/35 [00:00<00:00, 35.00it/s] 51%|█████▏    | 18/35 [00:00<00:01, 16.67it/s] 60%|██████    | 21/35 [00:06<00:07,  1.81it/s] 66%|██████▌   | 23/35 [00:10<00:10,  1.14it/s] 71%|███████▏  | 25/35 [00:12<00:08,  1.13it/s] 80%|████████  | 28/35 [00:12<00:04,  1.65it/s] 89%|████████▊ | 31/35 [00:12<00:01,  2.36it/s] 97%|█████████▋| 34/35 [00:12<00:00,  3.30it/s]100%|██████████| 35/35 [00:17<00:00,  1.96it/s]
2025-03-13 12:43:32,704 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:32
2025-03-13 12:44:36,075 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3704 secs
2025-03-13 12:44:36,075 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 12:44:36,075 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-13 12:45:03,837 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7612 secs
2025-03-13 12:45:03,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.0232 secs
2025-03-13 12:45:03,847 [INFO]: {
2025-03-13 12:45:03,847 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:03,847 [INFO]: 	index_param: efSearch=197
2025-03-13 12:45:03,847 [INFO]: 	index_path: knn.index
2025-03-13 12:45:03,847 [INFO]: 	size in bytes: 1668980110
2025-03-13 12:45:03,847 [INFO]: 	avg_search_speed_ms: 11.309934113642445
2025-03-13 12:45:03,847 [INFO]: 	99p_search_speed_ms: 20.544429174624383
2025-03-13 12:45:03,847 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:03,847 [INFO]: 	nb vectors: 8483
2025-03-13 12:45:03,847 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:03,847 [INFO]: 	compression ratio: 0.9993082925356133
2025-03-13 12:45:03,847 [INFO]: }
2025-03-13 12:45:03,847 [INFO]: 	>>> Finished "Creating the index" in 109.0266 secs
2025-03-13 12:45:03,847 [INFO]: >>> Finished "Launching the whole pipeline" in 109.0660 secs
2025-03-13 12:45:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 50735 [episode count 5/20]
[retrieval_preprocessing] for episode 85573 [episode count 6/20], we have num_retrieval=np.int64(7868) num_query=np.int64(935)
2025-03-13 12:45:11,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:12,477 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:12
2025-03-13 12:45:12,477 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.62it/s]
2025-03-13 12:45:12,511 [INFO]: There are 7868 embeddings of dim 49152
2025-03-13 12:45:12,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 12:45:12,511 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:12,512 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:45:12,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:12,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:45:12,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,512 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:12,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:45:12,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:12
2025-03-13 12:45:12,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:12,513 [INFO]: 	Creating the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:12
2025-03-13 12:45:12,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:45:12,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,517 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:45:12,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:05,  5.29it/s]  9%|▉         | 3/32 [00:00<00:03,  9.35it/s] 16%|█▌        | 5/32 [00:00<00:02, 10.61it/s] 22%|██▏       | 7/32 [00:00<00:02, 11.25it/s] 28%|██▊       | 9/32 [00:00<00:02, 11.50it/s] 34%|███▍      | 11/32 [00:01<00:01, 11.67it/s] 41%|████      | 13/32 [00:01<00:01, 12.00it/s] 47%|████▋     | 15/32 [00:01<00:01, 12.27it/s] 53%|█████▎    | 17/32 [00:01<00:01, 12.43it/s] 59%|█████▉    | 19/32 [00:01<00:01, 12.42it/s] 66%|██████▌   | 21/32 [00:05<00:06,  1.60it/s] 72%|███████▏  | 23/32 [00:05<00:04,  2.17it/s] 78%|███████▊  | 25/32 [00:05<00:02,  2.90it/s] 84%|████████▍ | 27/32 [00:05<00:01,  3.79it/s] 91%|█████████ | 29/32 [00:05<00:00,  4.82it/s] 97%|█████████▋| 31/32 [00:06<00:00,  5.93it/s]100%|██████████| 32/32 [00:08<00:00,  3.60it/s]
2025-03-13 12:45:21,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:21
2025-03-13 12:46:21,745 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3367 secs
2025-03-13 12:46:21,745 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:46:21,745 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 12:46:43,548 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8025 secs
2025-03-13 12:46:43,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.0488 secs
2025-03-13 12:46:43,566 [INFO]: {
2025-03-13 12:46:43,566 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:43,566 [INFO]: 	index_param: efSearch=222
2025-03-13 12:46:43,566 [INFO]: 	index_path: knn.index
2025-03-13 12:46:43,566 [INFO]: 	size in bytes: 1547982790
2025-03-13 12:46:43,566 [INFO]: 	avg_search_speed_ms: 13.000386037412056
2025-03-13 12:46:43,566 [INFO]: 	99p_search_speed_ms: 19.847774216905233
2025-03-13 12:46:43,566 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:43,566 [INFO]: 	nb vectors: 7868
2025-03-13 12:46:43,566 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:43,566 [INFO]: 	compression ratio: 0.9993081021268977
2025-03-13 12:46:43,566 [INFO]: }
2025-03-13 12:46:43,566 [INFO]: 	>>> Finished "Creating the index" in 91.0528 secs
2025-03-13 12:46:43,566 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0887 secs
2025-03-13 12:46:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 85573 [episode count 6/20]
[retrieval_preprocessing] for episode 23111 [episode count 7/20], we have num_retrieval=np.int64(8306) num_query=np.int64(497)
2025-03-13 12:46:57,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:58,973 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:58
2025-03-13 12:46:58,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.96it/s]
2025-03-13 12:46:59,001 [INFO]: There are 8306 embeddings of dim 49152
2025-03-13 12:46:59,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 12:46:59,002 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:59
2025-03-13 12:46:59,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:59,002 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 12:46:59,002 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:59,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:46:59,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:59
2025-03-13 12:46:59,003 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:59,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:46:59,003 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:59
2025-03-13 12:46:59,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:59,003 [INFO]: 	Creating the index 03/13/2025, 12:46:59
2025-03-13 12:46:59,003 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:59
2025-03-13 12:46:59,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:46:59,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:59
2025-03-13 12:46:59,007 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:46:59,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.80it/s]  9%|▉         | 3/34 [00:00<00:03,  8.65it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.04it/s] 21%|██        | 7/34 [00:00<00:02, 10.87it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.49it/s] 32%|███▏      | 11/34 [00:00<00:01, 12.54it/s] 38%|███▊      | 13/34 [00:01<00:01, 12.77it/s] 44%|████▍     | 15/34 [00:01<00:01, 12.81it/s] 50%|█████     | 17/34 [00:01<00:01, 12.51it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.23it/s] 62%|██████▏   | 21/34 [00:05<00:08,  1.56it/s] 68%|██████▊   | 23/34 [00:05<00:05,  2.13it/s] 74%|███████▎  | 25/34 [00:05<00:03,  2.86it/s] 79%|███████▉  | 27/34 [00:05<00:01,  3.80it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.83it/s] 91%|█████████ | 31/34 [00:06<00:00,  5.92it/s] 97%|█████████▋| 33/34 [00:06<00:00,  7.04it/s]100%|██████████| 34/34 [00:09<00:00,  3.53it/s]
2025-03-13 12:47:09,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:09
2025-03-13 12:48:28,067 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.1242 secs
2025-03-13 12:48:28,067 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:48:28,067 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.74it/s]
2025-03-13 12:48:46,412 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3443 secs
2025-03-13 12:48:46,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.4083 secs
2025-03-13 12:48:46,415 [INFO]: {
2025-03-13 12:48:46,415 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:46,415 [INFO]: 	index_param: efSearch=203
2025-03-13 12:48:46,415 [INFO]: 	index_path: knn.index
2025-03-13 12:48:46,415 [INFO]: 	size in bytes: 1634156410
2025-03-13 12:48:46,415 [INFO]: 	avg_search_speed_ms: 11.1658894410149
2025-03-13 12:48:46,415 [INFO]: 	99p_search_speed_ms: 18.913730070926228
2025-03-13 12:48:46,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:46,415 [INFO]: 	nb vectors: 8306
2025-03-13 12:48:46,415 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:46,415 [INFO]: 	compression ratio: 0.99930829020216
2025-03-13 12:48:46,415 [INFO]: }
2025-03-13 12:48:46,415 [INFO]: 	>>> Finished "Creating the index" in 107.4119 secs
2025-03-13 12:48:46,415 [INFO]: >>> Finished "Launching the whole pipeline" in 107.4424 secs
2025-03-13 12:48:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 23111 [episode count 7/20]
[retrieval_preprocessing] for episode 14411 [episode count 8/20], we have num_retrieval=np.int64(8276) num_query=np.int64(527)
2025-03-13 12:48:55,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:57,654 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:57
2025-03-13 12:48:57,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-13 12:48:57,681 [INFO]: There are 8276 embeddings of dim 49152
2025-03-13 12:48:57,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 12:48:57,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:57
2025-03-13 12:48:57,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:57,682 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 12:48:57,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:57,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:48:57,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:57
2025-03-13 12:48:57,682 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:57,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:48:57,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:57
2025-03-13 12:48:57,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:57,682 [INFO]: 	Creating the index 03/13/2025, 12:48:57
2025-03-13 12:48:57,682 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:57
2025-03-13 12:48:57,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:48:57,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:57
2025-03-13 12:48:57,684 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:48:57,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.15it/s]  6%|▌         | 2/34 [00:00<00:05,  5.79it/s]  9%|▉         | 3/34 [00:00<00:04,  6.61it/s] 12%|█▏        | 4/34 [00:00<00:04,  7.11it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.48it/s] 18%|█▊        | 6/34 [00:00<00:03,  7.64it/s] 21%|██        | 7/34 [00:00<00:03,  7.73it/s] 24%|██▎       | 8/34 [00:01<00:03,  7.79it/s] 26%|██▋       | 9/34 [00:01<00:03,  7.83it/s] 29%|██▉       | 10/34 [00:01<00:03,  7.84it/s] 32%|███▏      | 11/34 [00:01<00:02,  7.93it/s] 35%|███▌      | 12/34 [00:01<00:02,  7.89it/s] 38%|███▊      | 13/34 [00:01<00:02,  7.91it/s] 41%|████      | 14/34 [00:01<00:02,  7.76it/s] 44%|████▍     | 15/34 [00:02<00:02,  7.60it/s] 47%|████▋     | 16/34 [00:02<00:02,  7.63it/s] 50%|█████     | 17/34 [00:02<00:02,  7.64it/s] 53%|█████▎    | 18/34 [00:02<00:01,  8.21it/s] 59%|█████▉    | 20/34 [00:02<00:01,  9.01it/s] 62%|██████▏   | 21/34 [00:06<00:13,  1.00s/it] 65%|██████▍   | 22/34 [00:09<00:18,  1.58s/it] 68%|██████▊   | 23/34 [00:09<00:13,  1.25s/it] 71%|███████   | 24/34 [00:15<00:24,  2.49s/it] 74%|███████▎  | 25/34 [00:17<00:22,  2.45s/it] 76%|███████▋  | 26/34 [00:22<00:24,  3.10s/it] 79%|███████▉  | 27/34 [00:25<00:20,  2.95s/it] 82%|████████▏ | 28/34 [00:25<00:12,  2.17s/it] 88%|████████▊ | 30/34 [00:25<00:04,  1.21s/it] 94%|█████████▍| 32/34 [00:25<00:01,  1.33it/s]100%|██████████| 34/34 [00:29<00:00,  1.12s/it]100%|██████████| 34/34 [00:29<00:00,  1.16it/s]
2025-03-13 12:49:26,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:49:26
2025-03-13 12:50:25,416 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4559 secs
2025-03-13 12:50:25,417 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 12:50:25,417 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 12:50:46,044 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6268 secs
2025-03-13 12:50:46,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.3754 secs
2025-03-13 12:50:46,059 [INFO]: {
2025-03-13 12:50:46,059 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:46,059 [INFO]: 	index_param: efSearch=181
2025-03-13 12:50:46,059 [INFO]: 	index_path: knn.index
2025-03-13 12:50:46,059 [INFO]: 	size in bytes: 1628254090
2025-03-13 12:50:46,059 [INFO]: 	avg_search_speed_ms: 11.826127377860512
2025-03-13 12:50:46,059 [INFO]: 	99p_search_speed_ms: 19.341394980438047
2025-03-13 12:50:46,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:46,059 [INFO]: 	nb vectors: 8276
2025-03-13 12:50:46,059 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:46,059 [INFO]: 	compression ratio: 0.9993082885485028
2025-03-13 12:50:46,059 [INFO]: }
2025-03-13 12:50:46,059 [INFO]: 	>>> Finished "Creating the index" in 108.3772 secs
2025-03-13 12:50:46,059 [INFO]: >>> Finished "Launching the whole pipeline" in 108.4052 secs
2025-03-13 12:50:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 14411 [episode count 8/20]
[retrieval_preprocessing] for episode 58445 [episode count 9/20], we have num_retrieval=np.int64(8384) num_query=np.int64(419)
2025-03-13 12:50:55,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:58,057 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:58
2025-03-13 12:50:58,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.71it/s]
2025-03-13 12:50:58,088 [INFO]: There are 8384 embeddings of dim 49152
2025-03-13 12:50:58,089 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 12:50:58,089 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:58
2025-03-13 12:50:58,089 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:58,089 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 12:50:58,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:58,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:50:58,090 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:58
2025-03-13 12:50:58,090 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:58,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:50:58,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:58
2025-03-13 12:50:58,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:58,091 [INFO]: 	Creating the index 03/13/2025, 12:50:58
2025-03-13 12:50:58,092 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:58
2025-03-13 12:50:58,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 12:50:58,094 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:58
2025-03-13 12:50:58,095 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:50:58,095 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.40it/s]  9%|▉         | 3/34 [00:00<00:03,  9.06it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.24it/s] 21%|██        | 7/34 [00:00<00:02, 10.95it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.49it/s] 32%|███▏      | 11/34 [00:01<00:02, 10.24it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.33it/s] 41%|████      | 14/34 [00:01<00:02,  8.93it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.62it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.39it/s] 50%|█████     | 17/34 [00:01<00:02,  8.27it/s] 53%|█████▎    | 18/34 [00:01<00:01,  8.11it/s] 56%|█████▌    | 19/34 [00:02<00:01,  7.93it/s] 59%|█████▉    | 20/34 [00:02<00:01,  7.83it/s] 62%|██████▏   | 21/34 [00:06<00:15,  1.21s/it] 65%|██████▍   | 22/34 [00:06<00:10,  1.12it/s] 71%|███████   | 24/34 [00:06<00:05,  1.88it/s] 76%|███████▋  | 26/34 [00:06<00:02,  2.79it/s] 82%|████████▏ | 28/34 [00:06<00:01,  3.79it/s] 88%|████████▊ | 30/34 [00:07<00:00,  4.87it/s] 94%|█████████▍| 32/34 [00:07<00:00,  5.93it/s]100%|██████████| 34/34 [00:12<00:00,  1.13it/s]100%|██████████| 34/34 [00:12<00:00,  2.82it/s]
2025-03-13 12:51:10,147 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:10
2025-03-13 12:52:25,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.4194 secs
2025-03-13 12:52:25,567 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 12:52:25,567 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 12:53:22,267 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6998 secs
2025-03-13 12:53:22,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.1758 secs
2025-03-13 12:53:22,270 [INFO]: {
2025-03-13 12:53:22,270 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:22,271 [INFO]: 	index_param: efSearch=133
2025-03-13 12:53:22,271 [INFO]: 	index_path: knn.index
2025-03-13 12:53:22,271 [INFO]: 	size in bytes: 1649502310
2025-03-13 12:53:22,271 [INFO]: 	avg_search_speed_ms: 7.825214457690879
2025-03-13 12:53:22,271 [INFO]: 	99p_search_speed_ms: 14.951635219622407
2025-03-13 12:53:22,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:22,271 [INFO]: 	nb vectors: 8384
2025-03-13 12:53:22,271 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:22,271 [INFO]: 	compression ratio: 0.9993083744150683
2025-03-13 12:53:22,271 [INFO]: }
2025-03-13 12:53:22,271 [INFO]: 	>>> Finished "Creating the index" in 144.1791 secs
2025-03-13 12:53:22,271 [INFO]: >>> Finished "Launching the whole pipeline" in 144.2137 secs
2025-03-13 12:53:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 58445 [episode count 9/20]
[retrieval_preprocessing] for episode 4207 [episode count 10/20], we have num_retrieval=np.int64(8513) num_query=np.int64(290)
2025-03-13 12:53:28,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:29,698 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:29
2025-03-13 12:53:29,699 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.83it/s]
2025-03-13 12:53:29,728 [INFO]: There are 8513 embeddings of dim 49152
2025-03-13 12:53:29,729 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 12:53:29,729 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,729 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:29,729 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 12:53:29,729 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:53:29,729 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:53:29,730 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,730 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:29,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:53:29,730 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:29
2025-03-13 12:53:29,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:29,730 [INFO]: 	Creating the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,730 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:29
2025-03-13 12:53:29,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:53:29,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:29
2025-03-13 12:53:29,734 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:53:29,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.10it/s]  9%|▊         | 3/35 [00:00<00:03, 10.60it/s] 14%|█▍        | 5/35 [00:00<00:02, 13.12it/s] 20%|██        | 7/35 [00:00<00:01, 14.48it/s] 26%|██▌       | 9/35 [00:00<00:01, 15.15it/s] 31%|███▏      | 11/35 [00:00<00:01, 15.71it/s] 37%|███▋      | 13/35 [00:00<00:01, 16.16it/s] 43%|████▎     | 15/35 [00:01<00:01, 16.38it/s] 49%|████▊     | 17/35 [00:01<00:01, 16.69it/s] 54%|█████▍    | 19/35 [00:01<00:00, 16.95it/s] 60%|██████    | 21/35 [00:05<00:10,  1.32it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.41it/s] 83%|████████▎ | 29/35 [00:06<00:01,  3.86it/s] 94%|█████████▍| 33/35 [00:06<00:00,  5.72it/s]100%|██████████| 35/35 [00:10<00:00,  3.38it/s]
2025-03-13 12:53:40,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:53:40
2025-03-13 12:55:03,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.1082 secs
2025-03-13 12:55:03,193 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 12:55:03,193 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-13 12:55:31,066 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8735 secs
2025-03-13 12:55:31,070 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.3356 secs
2025-03-13 12:55:31,070 [INFO]: {
2025-03-13 12:55:31,070 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:31,070 [INFO]: 	index_param: efSearch=148
2025-03-13 12:55:31,070 [INFO]: 	index_path: knn.index
2025-03-13 12:55:31,070 [INFO]: 	size in bytes: 1674882370
2025-03-13 12:55:31,070 [INFO]: 	avg_search_speed_ms: 10.381277175030876
2025-03-13 12:55:31,070 [INFO]: 	99p_search_speed_ms: 16.60495314048603
2025-03-13 12:55:31,070 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:31,070 [INFO]: 	nb vectors: 8513
2025-03-13 12:55:31,070 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:31,070 [INFO]: 	compression ratio: 0.9993083299336418
2025-03-13 12:55:31,070 [INFO]: }
2025-03-13 12:55:31,070 [INFO]: 	>>> Finished "Creating the index" in 121.3396 secs
2025-03-13 12:55:31,070 [INFO]: >>> Finished "Launching the whole pipeline" in 121.3715 secs
2025-03-13 12:55:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 4207 [episode count 10/20]
[retrieval_preprocessing] for episode 82049 [episode count 11/20], we have num_retrieval=np.int64(8628) num_query=np.int64(175)
2025-03-13 12:55:36,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:37,953 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:37
2025-03-13 12:55:37,953 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.61it/s]
2025-03-13 12:55:37,980 [INFO]: There are 8628 embeddings of dim 49152
2025-03-13 12:55:37,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:55:37,980 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:37
2025-03-13 12:55:37,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:37,980 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 12:55:37,980 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:37,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:55:37,980 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:37
2025-03-13 12:55:37,980 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:37,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:55:37,980 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:37
2025-03-13 12:55:37,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:37,980 [INFO]: 	Creating the index 03/13/2025, 12:55:37
2025-03-13 12:55:37,980 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:37
2025-03-13 12:55:37,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:55:37,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:37
2025-03-13 12:55:37,982 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:55:37,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.79it/s]  9%|▊         | 3/35 [00:00<00:03,  8.33it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.84it/s] 20%|██        | 7/35 [00:00<00:02, 10.65it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.05it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.16it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.15it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.07it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.07it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.46it/s] 60%|██████    | 21/35 [00:05<00:09,  1.40it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.92it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.59it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.42it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.34it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.38it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.44it/s]100%|██████████| 35/35 [00:11<00:00,  1.27it/s]100%|██████████| 35/35 [00:11<00:00,  3.04it/s]
2025-03-13 12:55:49,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:49
2025-03-13 12:57:02,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.7997 secs
2025-03-13 12:57:02,300 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 12:57:02,300 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.99it/s] 50%|█████     | 2/4 [00:03<00:03,  1.81s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.76s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.73s/it]
2025-03-13 12:57:34,519 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2193 secs
2025-03-13 12:57:34,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.5407 secs
2025-03-13 12:57:34,523 [INFO]: {
2025-03-13 12:57:34,523 [INFO]: 	index_key: HNSW15
2025-03-13 12:57:34,523 [INFO]: 	index_param: efSearch=192
2025-03-13 12:57:34,523 [INFO]: 	index_path: knn.index
2025-03-13 12:57:34,523 [INFO]: 	size in bytes: 1697507830
2025-03-13 12:57:34,523 [INFO]: 	avg_search_speed_ms: 9.662341717900574
2025-03-13 12:57:34,523 [INFO]: 	99p_search_speed_ms: 13.61210219096392
2025-03-13 12:57:34,523 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:57:34,523 [INFO]: 	nb vectors: 8628
2025-03-13 12:57:34,523 [INFO]: 	vectors dimension: 49152
2025-03-13 12:57:34,523 [INFO]: 	compression ratio: 0.9993083943536213
2025-03-13 12:57:34,523 [INFO]: }
2025-03-13 12:57:34,523 [INFO]: 	>>> Finished "Creating the index" in 116.5423 secs
2025-03-13 12:57:34,523 [INFO]: >>> Finished "Launching the whole pipeline" in 116.5693 secs
2025-03-13 12:57:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:57:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 82049 [episode count 11/20]
[retrieval_preprocessing] for episode 38553 [episode count 12/20], we have num_retrieval=np.int64(8470) num_query=np.int64(333)
2025-03-13 12:57:39,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:57:41,425 [INFO]: Launching the whole pipeline 03/13/2025, 12:57:41
2025-03-13 12:57:41,425 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1503.87it/s]
2025-03-13 12:57:41,452 [INFO]: There are 8470 embeddings of dim 49152
2025-03-13 12:57:41,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:57:41,452 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:57:41
2025-03-13 12:57:41,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:57:41,452 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 12:57:41,452 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:57:41,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:57:41,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:57:41
2025-03-13 12:57:41,452 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:57:41,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:57:41,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:57:41
2025-03-13 12:57:41,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:57:41,453 [INFO]: 	Creating the index 03/13/2025, 12:57:41
2025-03-13 12:57:41,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:57:41
2025-03-13 12:57:41,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:57:41,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:57:41
2025-03-13 12:57:41,454 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 12:57:41,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.17it/s] 11%|█▏        | 4/35 [00:00<00:01, 18.20it/s] 17%|█▋        | 6/35 [00:00<00:01, 18.78it/s] 26%|██▌       | 9/35 [00:00<00:01, 20.75it/s] 34%|███▍      | 12/35 [00:00<00:01, 19.29it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.92it/s] 49%|████▊     | 17/35 [00:02<00:05,  3.31it/s] 54%|█████▍    | 19/35 [00:05<00:08,  1.88it/s] 60%|██████    | 21/35 [00:08<00:12,  1.14it/s] 66%|██████▌   | 23/35 [00:09<00:08,  1.48it/s] 69%|██████▊   | 24/35 [00:13<00:13,  1.23s/it] 71%|███████▏  | 25/35 [00:13<00:10,  1.01s/it] 74%|███████▍  | 26/35 [00:13<00:07,  1.23it/s] 77%|███████▋  | 27/35 [00:13<00:05,  1.53it/s] 80%|████████  | 28/35 [00:13<00:03,  1.88it/s] 83%|████████▎ | 29/35 [00:13<00:02,  2.31it/s] 86%|████████▌ | 30/35 [00:13<00:01,  2.81it/s] 89%|████████▊ | 31/35 [00:14<00:01,  3.35it/s] 91%|█████████▏| 32/35 [00:14<00:00,  3.87it/s] 97%|█████████▋| 34/35 [00:14<00:00,  5.30it/s]100%|██████████| 35/35 [00:18<00:00,  1.09s/it]100%|██████████| 35/35 [00:18<00:00,  1.91it/s]
2025-03-13 12:57:59,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:57:59
2025-03-13 12:59:07,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.6163 secs
2025-03-13 12:59:07,436 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 12:59:07,436 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-13 12:59:30,054 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6172 secs
2025-03-13 12:59:30,056 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.6021 secs
2025-03-13 12:59:30,056 [INFO]: {
2025-03-13 12:59:30,056 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:30,056 [INFO]: 	index_param: efSearch=164
2025-03-13 12:59:30,056 [INFO]: 	index_path: knn.index
2025-03-13 12:59:30,056 [INFO]: 	size in bytes: 1666422370
2025-03-13 12:59:30,056 [INFO]: 	avg_search_speed_ms: 9.857359604698978
2025-03-13 12:59:30,056 [INFO]: 	99p_search_speed_ms: 14.732080353423953
2025-03-13 12:59:30,056 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:30,056 [INFO]: 	nb vectors: 8470
2025-03-13 12:59:30,056 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:30,056 [INFO]: 	compression ratio: 0.9993083326167783
2025-03-13 12:59:30,056 [INFO]: }
2025-03-13 12:59:30,056 [INFO]: 	>>> Finished "Creating the index" in 108.6037 secs
2025-03-13 12:59:30,056 [INFO]: >>> Finished "Launching the whole pipeline" in 108.6315 secs
2025-03-13 12:59:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 38553 [episode count 12/20]
[retrieval_preprocessing] for episode 33443 [episode count 13/20], we have num_retrieval=np.int64(7913) num_query=np.int64(890)
2025-03-13 12:59:34,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:35,981 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:35
2025-03-13 12:59:35,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.57it/s]
2025-03-13 12:59:36,004 [INFO]: There are 7913 embeddings of dim 49152
2025-03-13 12:59:36,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 12:59:36,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:36
2025-03-13 12:59:36,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:36,004 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:59:36,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:36,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:59:36,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:36
2025-03-13 12:59:36,005 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:36,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:59:36,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:36
2025-03-13 12:59:36,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:36,005 [INFO]: 	Creating the index 03/13/2025, 12:59:36
2025-03-13 12:59:36,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:36
2025-03-13 12:59:36,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:59:36,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:36
2025-03-13 12:59:36,006 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:59:36,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  5.04it/s]  9%|▉         | 3/33 [00:00<00:03,  9.07it/s] 15%|█▌        | 5/33 [00:00<00:02, 10.74it/s] 21%|██        | 7/33 [00:00<00:02, 11.49it/s] 27%|██▋       | 9/33 [00:00<00:02, 11.93it/s] 33%|███▎      | 11/33 [00:00<00:01, 12.27it/s] 39%|███▉      | 13/33 [00:01<00:01, 12.12it/s] 45%|████▌     | 15/33 [00:01<00:01, 12.47it/s] 52%|█████▏    | 17/33 [00:01<00:01, 12.86it/s] 58%|█████▊    | 19/33 [00:01<00:01, 12.60it/s] 64%|██████▎   | 21/33 [00:05<00:07,  1.54it/s] 70%|██████▉   | 23/33 [00:05<00:04,  2.09it/s] 76%|███████▌  | 25/33 [00:05<00:02,  2.80it/s] 82%|████████▏ | 27/33 [00:05<00:01,  3.66it/s] 88%|████████▊ | 29/33 [00:06<00:00,  4.66it/s] 94%|█████████▍| 31/33 [00:06<00:00,  5.74it/s]100%|██████████| 33/33 [00:09<00:00,  1.69it/s]100%|██████████| 33/33 [00:09<00:00,  3.50it/s]
2025-03-13 12:59:45,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:45
2025-03-13 13:00:40,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8768 secs
2025-03-13 13:00:40,310 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 13:00:40,311 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
2025-03-13 13:01:07,361 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0499 secs
2025-03-13 13:01:07,363 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.3565 secs
2025-03-13 13:01:07,363 [INFO]: {
2025-03-13 13:01:07,363 [INFO]: 	index_key: HNSW15
2025-03-13 13:01:07,363 [INFO]: 	index_param: efSearch=191
2025-03-13 13:01:07,363 [INFO]: 	index_path: knn.index
2025-03-13 13:01:07,363 [INFO]: 	size in bytes: 1556836210
2025-03-13 13:01:07,363 [INFO]: 	avg_search_speed_ms: 10.931146607220255
2025-03-13 13:01:07,363 [INFO]: 	99p_search_speed_ms: 19.4500237191096
2025-03-13 13:01:07,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:01:07,363 [INFO]: 	nb vectors: 7913
2025-03-13 13:01:07,363 [INFO]: 	vectors dimension: 49152
2025-03-13 13:01:07,363 [INFO]: 	compression ratio: 0.9993081443037608
2025-03-13 13:01:07,363 [INFO]: }
2025-03-13 13:01:07,363 [INFO]: 	>>> Finished "Creating the index" in 91.3581 secs
2025-03-13 13:01:07,363 [INFO]: >>> Finished "Launching the whole pipeline" in 91.3818 secs
2025-03-13 13:01:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:01:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 33443 [episode count 13/20]
[retrieval_preprocessing] for episode 53416 [episode count 14/20], we have num_retrieval=np.int64(8326) num_query=np.int64(477)
2025-03-13 13:01:18,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:01:19,149 [INFO]: Launching the whole pipeline 03/13/2025, 13:01:19
2025-03-13 13:01:19,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:01:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.09it/s]
2025-03-13 13:01:19,177 [INFO]: There are 8326 embeddings of dim 49152
2025-03-13 13:01:19,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 13:01:19,177 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:01:19
2025-03-13 13:01:19,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:01:19,178 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 13:01:19,178 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:01:19,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:01:19,178 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:01:19
2025-03-13 13:01:19,178 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:01:19,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:01:19,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:01:19
2025-03-13 13:01:19,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:01:19,179 [INFO]: 	Creating the index 03/13/2025, 13:01:19
2025-03-13 13:01:19,179 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:01:19
2025-03-13 13:01:19,183 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0037 secs
2025-03-13 13:01:19,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:01:19
2025-03-13 13:01:19,184 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 13:01:19,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.96it/s]  9%|▉         | 3/34 [00:00<00:03,  7.92it/s] 12%|█▏        | 4/34 [00:00<00:03,  8.32it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.48it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.60it/s] 21%|██        | 7/34 [00:00<00:03,  8.77it/s] 24%|██▎       | 8/34 [00:00<00:02,  8.82it/s] 26%|██▋       | 9/34 [00:01<00:02,  8.85it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.95it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.94it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.01it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.00it/s] 41%|████      | 14/34 [00:01<00:02,  8.97it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.95it/s] 47%|████▋     | 16/34 [00:01<00:02,  8.92it/s] 50%|█████     | 17/34 [00:01<00:01,  8.99it/s] 53%|█████▎    | 18/34 [00:02<00:01,  8.97it/s] 56%|█████▌    | 19/34 [00:02<00:01,  8.94it/s] 59%|█████▉    | 20/34 [00:02<00:01,  9.09it/s] 62%|██████▏   | 21/34 [00:05<00:15,  1.16s/it] 65%|██████▍   | 22/34 [00:05<00:10,  1.19it/s] 71%|███████   | 24/34 [00:06<00:04,  2.04it/s] 76%|███████▋  | 26/34 [00:06<00:02,  3.06it/s] 82%|████████▏ | 28/34 [00:06<00:01,  4.19it/s] 88%|████████▊ | 30/34 [00:06<00:00,  5.40it/s] 94%|█████████▍| 32/34 [00:06<00:00,  6.61it/s]100%|██████████| 34/34 [00:10<00:00,  1.56it/s]100%|██████████| 34/34 [00:10<00:00,  3.34it/s]
2025-03-13 13:01:29,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:01:29
2025-03-13 13:02:29,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.5784 secs
2025-03-13 13:02:29,942 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 13:02:29,942 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 13:02:49,816 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8737 secs
2025-03-13 13:02:49,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.6349 secs
2025-03-13 13:02:49,819 [INFO]: {
2025-03-13 13:02:49,819 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:49,819 [INFO]: 	index_param: efSearch=204
2025-03-13 13:02:49,819 [INFO]: 	index_path: knn.index
2025-03-13 13:02:49,819 [INFO]: 	size in bytes: 1638091270
2025-03-13 13:02:49,819 [INFO]: 	avg_search_speed_ms: 11.291393092791413
2025-03-13 13:02:49,819 [INFO]: 	99p_search_speed_ms: 19.049877894576635
2025-03-13 13:02:49,819 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:49,819 [INFO]: 	nb vectors: 8326
2025-03-13 13:02:49,819 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:49,819 [INFO]: 	compression ratio: 0.9993083034988642
2025-03-13 13:02:49,819 [INFO]: }
2025-03-13 13:02:49,819 [INFO]: 	>>> Finished "Creating the index" in 90.6395 secs
2025-03-13 13:02:49,819 [INFO]: >>> Finished "Launching the whole pipeline" in 90.6697 secs
2025-03-13 13:02:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 53416 [episode count 14/20]
[retrieval_preprocessing] for episode 81074 [episode count 15/20], we have num_retrieval=np.int64(8559) num_query=np.int64(244)
2025-03-13 13:02:59,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:03:00,904 [INFO]: Launching the whole pipeline 03/13/2025, 13:03:00
2025-03-13 13:03:00,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:03:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.29it/s]
2025-03-13 13:03:00,934 [INFO]: There are 8559 embeddings of dim 49152
2025-03-13 13:03:00,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 13:03:00,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:03:00
2025-03-13 13:03:00,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:03:00,936 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:03:00,936 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:03:00,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:03:00,936 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:03:00
2025-03-13 13:03:00,936 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:03:00,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:03:00,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:03:00
2025-03-13 13:03:00,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:03:00,937 [INFO]: 	Creating the index 03/13/2025, 13:03:00
2025-03-13 13:03:00,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:03:00
2025-03-13 13:03:00,940 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 13:03:00,940 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:03:00
2025-03-13 13:03:00,941 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:03:00,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.66it/s]  6%|▌         | 2/35 [00:00<00:04,  6.67it/s]  9%|▊         | 3/35 [00:00<00:04,  7.82it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.51it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.93it/s] 20%|██        | 7/35 [00:00<00:02,  9.52it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.64it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.65it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.79it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.24it/s] 43%|████▎     | 15/35 [00:01<00:01, 10.66it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.19it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.29it/s] 60%|██████    | 21/35 [00:06<00:11,  1.27it/s] 69%|██████▊   | 24/35 [00:06<00:05,  2.07it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.13it/s] 86%|████████▌ | 30/35 [00:07<00:01,  2.86it/s] 94%|█████████▍| 33/35 [00:08<00:00,  4.07it/s]100%|██████████| 35/35 [00:13<00:00,  1.22it/s]100%|██████████| 35/35 [00:13<00:00,  2.62it/s]
2025-03-13 13:03:14,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:14
2025-03-13 13:04:35,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.8201 secs
2025-03-13 13:04:35,126 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 13:04:35,126 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.00it/s]
2025-03-13 13:04:59,031 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9044 secs
2025-03-13 13:04:59,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.0951 secs
2025-03-13 13:04:59,036 [INFO]: {
2025-03-13 13:04:59,036 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:59,036 [INFO]: 	index_param: efSearch=189
2025-03-13 13:04:59,036 [INFO]: 	index_path: knn.index
2025-03-13 13:04:59,036 [INFO]: 	size in bytes: 1683932530
2025-03-13 13:04:59,036 [INFO]: 	avg_search_speed_ms: 15.362789155200078
2025-03-13 13:04:59,036 [INFO]: 	99p_search_speed_ms: 34.22742441762239
2025-03-13 13:04:59,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:59,036 [INFO]: 	nb vectors: 8559
2025-03-13 13:04:59,036 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:59,036 [INFO]: 	compression ratio: 0.9993083701518611
2025-03-13 13:04:59,036 [INFO]: }
2025-03-13 13:04:59,036 [INFO]: 	>>> Finished "Creating the index" in 118.0987 secs
2025-03-13 13:04:59,036 [INFO]: >>> Finished "Launching the whole pipeline" in 118.1322 secs
2025-03-13 13:05:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:05:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 81074 [episode count 15/20]
[retrieval_preprocessing] for episode 88763 [episode count 16/20], we have num_retrieval=np.int64(8504) num_query=np.int64(299)
2025-03-13 13:05:05,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:05:06,519 [INFO]: Launching the whole pipeline 03/13/2025, 13:05:06
2025-03-13 13:05:06,519 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:05:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 904.33it/s]
2025-03-13 13:05:06,551 [INFO]: There are 8504 embeddings of dim 49152
2025-03-13 13:05:06,551 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 13:05:06,551 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:05:06
2025-03-13 13:05:06,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:05:06,552 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:05:06,552 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:05:06,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:05:06,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:05:06
2025-03-13 13:05:06,553 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:05:06,553 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:05:06,553 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:05:06
2025-03-13 13:05:06,553 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:05:06,553 [INFO]: 	Creating the index 03/13/2025, 13:05:06
2025-03-13 13:05:06,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:05:06
2025-03-13 13:05:06,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:05:06,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:05:06
2025-03-13 13:05:06,557 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:05:06,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  4.96it/s]  6%|▌         | 2/35 [00:00<00:04,  6.87it/s]  9%|▊         | 3/35 [00:00<00:04,  7.82it/s] 11%|█▏        | 4/35 [00:00<00:03,  8.47it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.86it/s] 17%|█▋        | 6/35 [00:00<00:03,  9.15it/s] 20%|██        | 7/35 [00:00<00:02,  9.39it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.47it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.52it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.53it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.55it/s] 34%|███▍      | 12/35 [00:01<00:02,  9.61it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.58it/s] 40%|████      | 14/35 [00:01<00:02,  9.60it/s] 43%|████▎     | 15/35 [00:01<00:02,  9.61it/s] 46%|████▌     | 16/35 [00:01<00:01,  9.60it/s] 49%|████▊     | 17/35 [00:01<00:02,  8.90it/s] 51%|█████▏    | 18/35 [00:02<00:01,  8.67it/s] 57%|█████▋    | 20/35 [00:02<00:01,  9.80it/s] 60%|██████    | 21/35 [00:07<00:18,  1.31s/it] 69%|██████▊   | 24/35 [00:07<00:07,  1.52it/s] 77%|███████▋  | 27/35 [00:07<00:03,  2.51it/s] 86%|████████▌ | 30/35 [00:07<00:01,  3.79it/s] 94%|█████████▍| 33/35 [00:07<00:00,  5.35it/s]100%|██████████| 35/35 [00:12<00:00,  1.34it/s]100%|██████████| 35/35 [00:12<00:00,  2.79it/s]
2025-03-13 13:05:19,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:05:19
2025-03-13 13:06:23,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7824 secs
2025-03-13 13:06:23,394 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 13:06:23,394 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 13:06:46,016 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6225 secs
2025-03-13 13:06:46,019 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.4619 secs
2025-03-13 13:06:46,019 [INFO]: {
2025-03-13 13:06:46,019 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:46,019 [INFO]: 	index_param: efSearch=168
2025-03-13 13:06:46,019 [INFO]: 	index_path: knn.index
2025-03-13 13:06:46,019 [INFO]: 	size in bytes: 1673111710
2025-03-13 13:06:46,019 [INFO]: 	avg_search_speed_ms: 10.73410136044593
2025-03-13 13:06:46,019 [INFO]: 	99p_search_speed_ms: 17.186060203239318
2025-03-13 13:06:46,019 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:46,019 [INFO]: 	nb vectors: 8504
2025-03-13 13:06:46,019 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:46,019 [INFO]: 	compression ratio: 0.9993083079909829
2025-03-13 13:06:46,019 [INFO]: }
2025-03-13 13:06:46,019 [INFO]: 	>>> Finished "Creating the index" in 99.4659 secs
2025-03-13 13:06:46,019 [INFO]: >>> Finished "Launching the whole pipeline" in 99.5001 secs
2025-03-13 13:06:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 88763 [episode count 16/20]
[retrieval_preprocessing] for episode 16082 [episode count 17/20], we have num_retrieval=np.int64(8593) num_query=np.int64(210)
2025-03-13 13:06:49,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:50,271 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:50
2025-03-13 13:06:50,271 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.44it/s]
2025-03-13 13:06:50,310 [INFO]: There are 8593 embeddings of dim 49152
2025-03-13 13:06:50,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-13 13:06:50,311 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:50
2025-03-13 13:06:50,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:50,312 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:06:50,312 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:50,312 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:06:50,312 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:50
2025-03-13 13:06:50,313 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:50,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:06:50,313 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:50
2025-03-13 13:06:50,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:06:50,314 [INFO]: 	Creating the index 03/13/2025, 13:06:50
2025-03-13 13:06:50,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:50
2025-03-13 13:06:50,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 13:06:50,317 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:50
2025-03-13 13:06:50,317 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:06:50,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.03it/s] 17%|█▋        | 6/35 [00:00<00:00, 32.01it/s] 31%|███▏      | 11/35 [00:00<00:00, 39.59it/s] 46%|████▌     | 16/35 [00:00<00:00, 42.34it/s] 60%|██████    | 21/35 [00:04<00:04,  3.29it/s] 77%|███████▋  | 27/35 [00:04<00:01,  5.27it/s] 94%|█████████▍| 33/35 [00:04<00:00,  7.84it/s]100%|██████████| 35/35 [00:08<00:00,  4.29it/s]
2025-03-13 13:06:58,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:58
2025-03-13 13:08:09,638 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.0499 secs
2025-03-13 13:08:09,638 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 13:08:09,638 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.27it/s]
2025-03-13 13:08:36,181 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5421 secs
2025-03-13 13:08:36,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.8655 secs
2025-03-13 13:08:36,183 [INFO]: {
2025-03-13 13:08:36,183 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:36,183 [INFO]: 	index_param: efSearch=145
2025-03-13 13:08:36,183 [INFO]: 	index_path: knn.index
2025-03-13 13:08:36,183 [INFO]: 	size in bytes: 1690621810
2025-03-13 13:08:36,183 [INFO]: 	avg_search_speed_ms: 9.100892103308501
2025-03-13 13:08:36,183 [INFO]: 	99p_search_speed_ms: 14.551192549988626
2025-03-13 13:08:36,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:36,183 [INFO]: 	nb vectors: 8593
2025-03-13 13:08:36,183 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:36,183 [INFO]: 	compression ratio: 0.9993083810979583
2025-03-13 13:08:36,183 [INFO]: }
2025-03-13 13:08:36,183 [INFO]: 	>>> Finished "Creating the index" in 105.8696 secs
2025-03-13 13:08:36,183 [INFO]: >>> Finished "Launching the whole pipeline" in 105.9120 secs
2025-03-13 13:08:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 16082 [episode count 17/20]
[retrieval_preprocessing] for episode 44246 [episode count 18/20], we have num_retrieval=np.int64(8562) num_query=np.int64(241)
2025-03-13 13:08:38,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:39,790 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:39
2025-03-13 13:08:39,790 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1590.56it/s]
2025-03-13 13:08:39,822 [INFO]: There are 8562 embeddings of dim 49152
2025-03-13 13:08:39,822 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 13:08:39,822 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:39
2025-03-13 13:08:39,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:39,823 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:08:39,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:39,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 13:08:39,823 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:39
2025-03-13 13:08:39,824 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:39,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:08:39,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:39
2025-03-13 13:08:39,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:39,825 [INFO]: 	Creating the index 03/13/2025, 13:08:39
2025-03-13 13:08:39,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:39
2025-03-13 13:08:39,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 13:08:39,829 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:39
2025-03-13 13:08:39,829 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:08:39,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  8.78it/s] 17%|█▋        | 6/35 [00:00<00:01, 28.85it/s] 31%|███▏      | 11/35 [00:00<00:00, 35.45it/s] 46%|████▌     | 16/35 [00:00<00:00, 38.56it/s] 60%|██████    | 21/35 [00:05<00:05,  2.60it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.91it/s] 91%|█████████▏| 32/35 [00:05<00:00,  6.02it/s]100%|██████████| 35/35 [00:08<00:00,  3.92it/s]
2025-03-13 13:08:48,758 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:48
2025-03-13 13:10:01,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.1914 secs
2025-03-13 13:10:01,950 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 13:10:01,950 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.86it/s]
2025-03-13 13:10:34,401 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4509 secs
2025-03-13 13:10:34,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.5752 secs
2025-03-13 13:10:34,404 [INFO]: {
2025-03-13 13:10:34,404 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:34,404 [INFO]: 	index_param: efSearch=193
2025-03-13 13:10:34,404 [INFO]: 	index_path: knn.index
2025-03-13 13:10:34,404 [INFO]: 	size in bytes: 1684522810
2025-03-13 13:10:34,404 [INFO]: 	avg_search_speed_ms: 13.988118028020734
2025-03-13 13:10:34,404 [INFO]: 	99p_search_speed_ms: 24.9753827881068
2025-03-13 13:10:34,404 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:34,404 [INFO]: 	nb vectors: 8562
2025-03-13 13:10:34,404 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:34,404 [INFO]: 	compression ratio: 0.9993083418086811
2025-03-13 13:10:34,404 [INFO]: }
2025-03-13 13:10:34,404 [INFO]: 	>>> Finished "Creating the index" in 114.5795 secs
2025-03-13 13:10:34,404 [INFO]: >>> Finished "Launching the whole pipeline" in 114.6144 secs
2025-03-13 13:10:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 44246 [episode count 18/20]
[retrieval_preprocessing] for episode 9943 [episode count 19/20], we have num_retrieval=np.int64(8572) num_query=np.int64(231)
2025-03-13 13:10:38,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:39,949 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:39
2025-03-13 13:10:39,949 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.37it/s]
2025-03-13 13:10:39,981 [INFO]: There are 8572 embeddings of dim 49152
2025-03-13 13:10:39,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 13:10:39,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:39
2025-03-13 13:10:39,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:39,982 [INFO]: 		-> Add: 4.7 seconds
2025-03-13 13:10:39,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:39,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:10:39,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:39
2025-03-13 13:10:39,983 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:39,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:10:39,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:39
2025-03-13 13:10:39,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:39,984 [INFO]: 	Creating the index 03/13/2025, 13:10:39
2025-03-13 13:10:39,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:39
2025-03-13 13:10:39,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:10:39,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:39
2025-03-13 13:10:39,987 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:10:39,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  6.88it/s] 14%|█▍        | 5/35 [00:00<00:01, 22.79it/s] 26%|██▌       | 9/35 [00:00<00:00, 29.03it/s] 37%|███▋      | 13/35 [00:00<00:00, 32.38it/s] 49%|████▊     | 17/35 [00:00<00:00, 33.96it/s] 60%|██████    | 21/35 [00:05<00:06,  2.05it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.00it/s] 86%|████████▌ | 30/35 [00:06<00:01,  4.60it/s]100%|██████████| 35/35 [00:10<00:00,  2.10it/s]100%|██████████| 35/35 [00:10<00:00,  3.21it/s]
2025-03-13 13:10:50,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:50
2025-03-13 13:12:08,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.2617 secs
2025-03-13 13:12:08,155 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 13:12:08,155 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.60s/it] 50%|█████     | 2/4 [00:04<00:04,  2.07s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.46s/it]
2025-03-13 13:12:38,818 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6633 secs
2025-03-13 13:12:38,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.8333 secs
2025-03-13 13:12:38,821 [INFO]: {
2025-03-13 13:12:38,821 [INFO]: 	index_key: HNSW15
2025-03-13 13:12:38,821 [INFO]: 	index_param: efSearch=151
2025-03-13 13:12:38,821 [INFO]: 	index_path: knn.index
2025-03-13 13:12:38,821 [INFO]: 	size in bytes: 1686490210
2025-03-13 13:12:38,821 [INFO]: 	avg_search_speed_ms: 8.854436348563274
2025-03-13 13:12:38,821 [INFO]: 	99p_search_speed_ms: 14.774163323454584
2025-03-13 13:12:38,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:38,821 [INFO]: 	nb vectors: 8572
2025-03-13 13:12:38,821 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:38,821 [INFO]: 	compression ratio: 0.9993083659821541
2025-03-13 13:12:38,821 [INFO]: }
2025-03-13 13:12:38,821 [INFO]: 	>>> Finished "Creating the index" in 118.8372 secs
2025-03-13 13:12:38,821 [INFO]: >>> Finished "Launching the whole pipeline" in 118.8717 secs
2025-03-13 13:12:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:12:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 9943 [episode count 19/20]
2025-03-13 13:12:41: [retrieval_preprocessing] finished for 6518509549_put_item_in_box [chosen_id count 5/260]
2025-03-13 13:12:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6518509549_remove_item_from_box_put_on_couch [chosen_id count 6/260]
2025-03-13 13:12:43: [retrieval_preprocessing] we have num_total=4988 embedding_dim=49152
[retrieval_preprocessing] for episode 7691 [episode count 0/20], we have num_retrieval=np.int64(4799) num_query=np.int64(189)
2025-03-13 13:12:43,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:12:44,196 [INFO]: Launching the whole pipeline 03/13/2025, 13:12:44
2025-03-13 13:12:44,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:12:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.14it/s]
2025-03-13 13:12:44,223 [INFO]: There are 4799 embeddings of dim 49152
2025-03-13 13:12:44,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 13:12:44,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:12:44
2025-03-13 13:12:44,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:12:44,223 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:12:44,224 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:12:44,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:12:44,224 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:12:44
2025-03-13 13:12:44,224 [INFO]: 990.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:12:44,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:12:44,224 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:12:44
2025-03-13 13:12:44,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:12:44,224 [INFO]: 	Creating the index 03/13/2025, 13:12:44
2025-03-13 13:12:44,224 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:12:44
2025-03-13 13:12:44,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:12:44,225 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:12:44
2025-03-13 13:12:44,225 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:12:44,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.60it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.97it/s] 47%|████▋     | 9/19 [00:00<00:00, 29.63it/s] 74%|███████▎  | 14/19 [00:00<00:00, 35.17it/s]100%|██████████| 19/19 [00:04<00:00,  2.82it/s]100%|██████████| 19/19 [00:04<00:00,  4.19it/s]
2025-03-13 13:12:49,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:49
2025-03-13 13:13:34,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8052 secs
2025-03-13 13:13:34,834 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 13:13:34,834 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 13:13:52,120 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2868 secs
2025-03-13 13:13:52,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8982 secs
2025-03-13 13:13:52,123 [INFO]: {
2025-03-13 13:13:52,123 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:52,123 [INFO]: 	index_param: efSearch=105
2025-03-13 13:13:52,123 [INFO]: 	index_path: knn.index
2025-03-13 13:13:52,123 [INFO]: 	size in bytes: 944174470
2025-03-13 13:13:52,123 [INFO]: 	avg_search_speed_ms: 7.057040299163394
2025-03-13 13:13:52,123 [INFO]: 	99p_search_speed_ms: 12.685279799625276
2025-03-13 13:13:52,123 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:52,124 [INFO]: 	nb vectors: 4799
2025-03-13 13:13:52,124 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:52,124 [INFO]: 	compression ratio: 0.9993087315737312
2025-03-13 13:13:52,124 [INFO]: }
2025-03-13 13:13:52,124 [INFO]: 	>>> Finished "Creating the index" in 67.8996 secs
2025-03-13 13:13:52,124 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9273 secs
2025-03-13 13:13:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 7691 [episode count 0/20]
[retrieval_preprocessing] for episode 83476 [episode count 1/20], we have num_retrieval=np.int64(4647) num_query=np.int64(341)
2025-03-13 13:13:53,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:54,571 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:54
2025-03-13 13:13:54,571 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-13 13:13:54,603 [INFO]: There are 4647 embeddings of dim 49152
2025-03-13 13:13:54,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 13:13:54,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:54
2025-03-13 13:13:54,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:54,604 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:13:54,604 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:54,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:54,604 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:54
2025-03-13 13:13:54,604 [INFO]: 959.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:54,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:13:54,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:54
2025-03-13 13:13:54,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:54,604 [INFO]: 	Creating the index 03/13/2025, 13:13:54
2025-03-13 13:13:54,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:54
2025-03-13 13:13:54,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:13:54,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:54
2025-03-13 13:13:54,606 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:13:54,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.96it/s] 32%|███▏      | 6/19 [00:00<00:00, 33.12it/s] 63%|██████▎   | 12/19 [00:00<00:00, 41.85it/s] 95%|█████████▍| 18/19 [00:00<00:00, 45.45it/s]100%|██████████| 19/19 [00:04<00:00,  4.49it/s]
2025-03-13 13:13:58,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:58
2025-03-13 13:14:40,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7390 secs
2025-03-13 13:14:40,583 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 13:14:40,583 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-13 13:15:07,657 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0736 secs
2025-03-13 13:15:07,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.0545 secs
2025-03-13 13:15:07,661 [INFO]: {
2025-03-13 13:15:07,661 [INFO]: 	index_key: HNSW15
2025-03-13 13:15:07,661 [INFO]: 	index_param: efSearch=168
2025-03-13 13:15:07,661 [INFO]: 	index_path: knn.index
2025-03-13 13:15:07,661 [INFO]: 	size in bytes: 914269270
2025-03-13 13:15:07,661 [INFO]: 	avg_search_speed_ms: 12.01949454648342
2025-03-13 13:15:07,661 [INFO]: 	99p_search_speed_ms: 21.723698154091835
2025-03-13 13:15:07,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:07,661 [INFO]: 	nb vectors: 4647
2025-03-13 13:15:07,661 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:07,661 [INFO]: 	compression ratio: 0.9993088535065824
2025-03-13 13:15:07,661 [INFO]: }
2025-03-13 13:15:07,661 [INFO]: 	>>> Finished "Creating the index" in 73.0563 secs
2025-03-13 13:15:07,661 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0893 secs
2025-03-13 13:15:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 83476 [episode count 1/20]
[retrieval_preprocessing] for episode 1558 [episode count 2/20], we have num_retrieval=np.int64(4734) num_query=np.int64(254)
2025-03-13 13:15:10,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:11,565 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:11
2025-03-13 13:15:11,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.65it/s]
2025-03-13 13:15:11,591 [INFO]: There are 4734 embeddings of dim 49152
2025-03-13 13:15:11,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 13:15:11,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:11,591 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:15:11,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:11,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:11,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,592 [INFO]: 977.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:11,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:15:11,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:11
2025-03-13 13:15:11,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:11,592 [INFO]: 	Creating the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,592 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:11
2025-03-13 13:15:11,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:15:11,593 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,593 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:15:11,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.73it/s] 32%|███▏      | 6/19 [00:00<00:00, 26.85it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.08it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.11it/s]100%|██████████| 19/19 [00:05<00:00,  3.57it/s]
2025-03-13 13:15:16,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:16
2025-03-13 13:16:06,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9279 secs
2025-03-13 13:16:06,852 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 13:16:06,852 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 13:16:30,838 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9863 secs
2025-03-13 13:16:30,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2480 secs
2025-03-13 13:16:30,841 [INFO]: {
2025-03-13 13:16:30,841 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:30,841 [INFO]: 	index_param: efSearch=129
2025-03-13 13:16:30,841 [INFO]: 	index_path: knn.index
2025-03-13 13:16:30,841 [INFO]: 	size in bytes: 931386130
2025-03-13 13:16:30,841 [INFO]: 	avg_search_speed_ms: 8.50667450759167
2025-03-13 13:16:30,841 [INFO]: 	99p_search_speed_ms: 13.049654953647405
2025-03-13 13:16:30,841 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:30,841 [INFO]: 	nb vectors: 4734
2025-03-13 13:16:30,841 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:30,841 [INFO]: 	compression ratio: 0.9993087099117527
2025-03-13 13:16:30,841 [INFO]: }
2025-03-13 13:16:30,841 [INFO]: 	>>> Finished "Creating the index" in 79.2496 secs
2025-03-13 13:16:30,841 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2761 secs
2025-03-13 13:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 1558 [episode count 2/20]
[retrieval_preprocessing] for episode 49232 [episode count 3/20], we have num_retrieval=np.int64(4734) num_query=np.int64(254)
2025-03-13 13:16:32,870 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:34,040 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:34
2025-03-13 13:16:34,040 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.58it/s]
2025-03-13 13:16:34,074 [INFO]: There are 4734 embeddings of dim 49152
2025-03-13 13:16:34,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 13:16:34,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:34
2025-03-13 13:16:34,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:34,075 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:16:34,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:34,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 13:16:34,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:34
2025-03-13 13:16:34,076 [INFO]: 977.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:34,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:16:34,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:34
2025-03-13 13:16:34,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:34,077 [INFO]: 	Creating the index 03/13/2025, 13:16:34
2025-03-13 13:16:34,077 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:34
2025-03-13 13:16:34,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:16:34,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:34
2025-03-13 13:16:34,081 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:16:34,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.34it/s] 42%|████▏     | 8/19 [00:00<00:00, 38.17it/s] 74%|███████▎  | 14/19 [00:00<00:00, 43.93it/s]100%|██████████| 19/19 [00:04<00:00,  2.90it/s]100%|██████████| 19/19 [00:04<00:00,  4.13it/s]
2025-03-13 13:16:38,684 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:38
2025-03-13 13:17:22,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2650 secs
2025-03-13 13:17:22,949 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 13:17:22,950 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 13:17:42,533 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5834 secs
2025-03-13 13:17:42,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4551 secs
2025-03-13 13:17:42,536 [INFO]: {
2025-03-13 13:17:42,536 [INFO]: 	index_key: HNSW15
2025-03-13 13:17:42,536 [INFO]: 	index_param: efSearch=160
2025-03-13 13:17:42,536 [INFO]: 	index_path: knn.index
2025-03-13 13:17:42,536 [INFO]: 	size in bytes: 931386130
2025-03-13 13:17:42,536 [INFO]: 	avg_search_speed_ms: 10.751103073264503
2025-03-13 13:17:42,536 [INFO]: 	99p_search_speed_ms: 19.502696022391323
2025-03-13 13:17:42,536 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:17:42,536 [INFO]: 	nb vectors: 4734
2025-03-13 13:17:42,536 [INFO]: 	vectors dimension: 49152
2025-03-13 13:17:42,536 [INFO]: 	compression ratio: 0.9993087099117527
2025-03-13 13:17:42,536 [INFO]: }
2025-03-13 13:17:42,536 [INFO]: 	>>> Finished "Creating the index" in 68.4590 secs
2025-03-13 13:17:42,536 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4959 secs
2025-03-13 13:17:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:17:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 49232 [episode count 3/20]
[retrieval_preprocessing] for episode 19028 [episode count 4/20], we have num_retrieval=np.int64(4688) num_query=np.int64(300)
2025-03-13 13:17:49,540 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:50,364 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:50
2025-03-13 13:17:50,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1951.75it/s]
2025-03-13 13:17:50,392 [INFO]: There are 4688 embeddings of dim 49152
2025-03-13 13:17:50,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 13:17:50,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:50,393 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:17:50,393 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:17:50,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:17:50,393 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,393 [INFO]: 967.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:50,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:17:50,394 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:50
2025-03-13 13:17:50,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:50,394 [INFO]: 	Creating the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,394 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:17:50
2025-03-13 13:17:50,397 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 13:17:50,398 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,398 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:17:50,398 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.99it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.46it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.72it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.26it/s]100%|██████████| 19/19 [00:04<00:00,  4.37it/s]
2025-03-13 13:17:54,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:54
2025-03-13 13:18:38,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7426 secs
2025-03-13 13:18:38,496 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 13:18:38,496 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 13:19:02,839 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3430 secs
2025-03-13 13:19:02,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4447 secs
2025-03-13 13:19:02,843 [INFO]: {
2025-03-13 13:19:02,843 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:02,843 [INFO]: 	index_param: efSearch=153
2025-03-13 13:19:02,843 [INFO]: 	index_path: knn.index
2025-03-13 13:19:02,843 [INFO]: 	size in bytes: 922335910
2025-03-13 13:19:02,843 [INFO]: 	avg_search_speed_ms: 14.350300594393088
2025-03-13 13:19:02,843 [INFO]: 	99p_search_speed_ms: 23.206955746281892
2025-03-13 13:19:02,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:02,843 [INFO]: 	nb vectors: 4688
2025-03-13 13:19:02,843 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:02,843 [INFO]: 	compression ratio: 0.9993087052199887
2025-03-13 13:19:02,843 [INFO]: }
2025-03-13 13:19:02,843 [INFO]: 	>>> Finished "Creating the index" in 72.4490 secs
2025-03-13 13:19:02,843 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4791 secs
2025-03-13 13:19:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 19028 [episode count 4/20]
[retrieval_preprocessing] for episode 89180 [episode count 5/20], we have num_retrieval=np.int64(4723) num_query=np.int64(265)
2025-03-13 13:19:06,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:07,102 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:07
2025-03-13 13:19:07,102 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.08it/s]
2025-03-13 13:19:07,131 [INFO]: There are 4723 embeddings of dim 49152
2025-03-13 13:19:07,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 13:19:07,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:07
2025-03-13 13:19:07,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:07,132 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:19:07,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:07,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:07,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:07
2025-03-13 13:19:07,132 [INFO]: 974.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:07,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:19:07,132 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:07
2025-03-13 13:19:07,132 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:07,132 [INFO]: 	Creating the index 03/13/2025, 13:19:07
2025-03-13 13:19:07,132 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:07
2025-03-13 13:19:07,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:19:07,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:07
2025-03-13 13:19:07,133 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:19:07,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.90it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.69it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.28it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.96it/s]100%|██████████| 19/19 [00:05<00:00,  3.67it/s]
2025-03-13 13:19:12,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:12
2025-03-13 13:20:03,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2565 secs
2025-03-13 13:20:03,579 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 13:20:03,579 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-13 13:20:22,931 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3517 secs
2025-03-13 13:20:22,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8003 secs
2025-03-13 13:20:22,934 [INFO]: {
2025-03-13 13:20:22,934 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:22,934 [INFO]: 	index_param: efSearch=156
2025-03-13 13:20:22,934 [INFO]: 	index_path: knn.index
2025-03-13 13:20:22,934 [INFO]: 	size in bytes: 929221990
2025-03-13 13:20:22,934 [INFO]: 	avg_search_speed_ms: 9.233909351871601
2025-03-13 13:20:22,934 [INFO]: 	99p_search_speed_ms: 13.394981254823506
2025-03-13 13:20:22,934 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:22,934 [INFO]: 	nb vectors: 4723
2025-03-13 13:20:22,934 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:22,934 [INFO]: 	compression ratio: 0.9993086625080838
2025-03-13 13:20:22,934 [INFO]: }
2025-03-13 13:20:22,934 [INFO]: 	>>> Finished "Creating the index" in 75.8018 secs
2025-03-13 13:20:22,934 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8321 secs
2025-03-13 13:20:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 89180 [episode count 5/20]
[retrieval_preprocessing] for episode 72838 [episode count 6/20], we have num_retrieval=np.int64(4786) num_query=np.int64(202)
2025-03-13 13:20:25,185 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:25,793 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:25
2025-03-13 13:20:25,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1523.54it/s]
2025-03-13 13:20:25,823 [INFO]: There are 4786 embeddings of dim 49152
2025-03-13 13:20:25,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 13:20:25,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:25
2025-03-13 13:20:25,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:25,823 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:20:25,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:25,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:20:25,823 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:25
2025-03-13 13:20:25,824 [INFO]: 987.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:25,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:20:25,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:25
2025-03-13 13:20:25,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:25,824 [INFO]: 	Creating the index 03/13/2025, 13:20:25
2025-03-13 13:20:25,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:25
2025-03-13 13:20:25,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:20:25,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:25
2025-03-13 13:20:25,825 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:20:25,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.29it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.27it/s] 68%|██████▊   | 13/19 [00:00<00:00, 43.02it/s]100%|██████████| 19/19 [00:04<00:00,  3.36it/s]100%|██████████| 19/19 [00:04<00:00,  4.53it/s]
2025-03-13 13:20:30,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:30
2025-03-13 13:21:16,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6847 secs
2025-03-13 13:21:16,705 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 13:21:16,705 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 13:21:34,730 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0249 secs
2025-03-13 13:21:34,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9090 secs
2025-03-13 13:21:34,734 [INFO]: {
2025-03-13 13:21:34,734 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:34,734 [INFO]: 	index_param: efSearch=151
2025-03-13 13:21:34,734 [INFO]: 	index_path: knn.index
2025-03-13 13:21:34,734 [INFO]: 	size in bytes: 941616850
2025-03-13 13:21:34,734 [INFO]: 	avg_search_speed_ms: 9.419385541542635
2025-03-13 13:21:34,734 [INFO]: 	99p_search_speed_ms: 14.629085701890341
2025-03-13 13:21:34,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:34,734 [INFO]: 	nb vectors: 4786
2025-03-13 13:21:34,734 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:34,734 [INFO]: 	compression ratio: 0.9993086763474974
2025-03-13 13:21:34,734 [INFO]: }
2025-03-13 13:21:34,734 [INFO]: 	>>> Finished "Creating the index" in 68.9105 secs
2025-03-13 13:21:34,734 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9410 secs
2025-03-13 13:21:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 72838 [episode count 6/20]
[retrieval_preprocessing] for episode 64648 [episode count 7/20], we have num_retrieval=np.int64(4796) num_query=np.int64(192)
2025-03-13 13:21:36,897 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:37,558 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:37
2025-03-13 13:21:37,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.48it/s]
2025-03-13 13:21:37,583 [INFO]: There are 4796 embeddings of dim 49152
2025-03-13 13:21:37,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 13:21:37,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:37
2025-03-13 13:21:37,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:37,583 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:21:37,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:37,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:21:37,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:37
2025-03-13 13:21:37,584 [INFO]: 989.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:37,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:21:37,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:37
2025-03-13 13:21:37,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:37,584 [INFO]: 	Creating the index 03/13/2025, 13:21:37
2025-03-13 13:21:37,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:37
2025-03-13 13:21:37,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:21:37,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:37
2025-03-13 13:21:37,585 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:21:37,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.92it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.70it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.60it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.59it/s]100%|██████████| 19/19 [00:05<00:00,  3.66it/s]
2025-03-13 13:21:42,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:42
2025-03-13 13:22:30,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4311 secs
2025-03-13 13:22:30,205 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 13:22:30,205 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.45it/s]
2025-03-13 13:22:51,301 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0962 secs
2025-03-13 13:22:51,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7188 secs
2025-03-13 13:22:51,304 [INFO]: {
2025-03-13 13:22:51,304 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:51,304 [INFO]: 	index_param: efSearch=161
2025-03-13 13:22:51,304 [INFO]: 	index_path: knn.index
2025-03-13 13:22:51,304 [INFO]: 	size in bytes: 943584250
2025-03-13 13:22:51,304 [INFO]: 	avg_search_speed_ms: 9.374563569585325
2025-03-13 13:22:51,304 [INFO]: 	99p_search_speed_ms: 14.820469021797177
2025-03-13 13:22:51,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:51,304 [INFO]: 	nb vectors: 4796
2025-03-13 13:22:51,304 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:51,304 [INFO]: 	compression ratio: 0.9993087188557884
2025-03-13 13:22:51,304 [INFO]: }
2025-03-13 13:22:51,304 [INFO]: 	>>> Finished "Creating the index" in 73.7203 secs
2025-03-13 13:22:51,304 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7458 secs
2025-03-13 13:22:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 64648 [episode count 7/20]
[retrieval_preprocessing] for episode 35524 [episode count 8/20], we have num_retrieval=np.int64(4756) num_query=np.int64(232)
2025-03-13 13:22:53,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:54,280 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:54
2025-03-13 13:22:54,280 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.14it/s]
2025-03-13 13:22:54,312 [INFO]: There are 4756 embeddings of dim 49152
2025-03-13 13:22:54,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 13:22:54,312 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:54,312 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:22:54,312 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:22:54,312 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:22:54,312 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,312 [INFO]: 981.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:54,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:22:54,313 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:54
2025-03-13 13:22:54,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:54,313 [INFO]: 	Creating the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,313 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:22:54
2025-03-13 13:22:54,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:22:54,314 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,314 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:22:54,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.72it/s] 26%|██▋       | 5/19 [00:00<00:00, 22.96it/s] 53%|█████▎    | 10/19 [00:00<00:00, 32.36it/s] 79%|███████▉  | 15/19 [00:00<00:00, 37.36it/s]100%|██████████| 19/19 [00:04<00:00,  2.86it/s]100%|██████████| 19/19 [00:04<00:00,  4.41it/s]
2025-03-13 13:22:58,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:22:58
2025-03-13 13:23:44,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6745 secs
2025-03-13 13:23:44,300 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 13:23:44,300 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-13 13:24:05,957 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6567 secs
2025-03-13 13:24:06,067 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7528 secs
2025-03-13 13:24:06,067 [INFO]: {
2025-03-13 13:24:06,067 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:06,067 [INFO]: 	index_param: efSearch=170
2025-03-13 13:24:06,067 [INFO]: 	index_path: knn.index
2025-03-13 13:24:06,067 [INFO]: 	size in bytes: 935714530
2025-03-13 13:24:06,067 [INFO]: 	avg_search_speed_ms: 10.419393882815106
2025-03-13 13:24:06,067 [INFO]: 	99p_search_speed_ms: 16.2536921724677
2025-03-13 13:24:06,067 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:06,068 [INFO]: 	nb vectors: 4756
2025-03-13 13:24:06,068 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:06,068 [INFO]: 	compression ratio: 0.999308675905674
2025-03-13 13:24:06,068 [INFO]: }
2025-03-13 13:24:06,068 [INFO]: 	>>> Finished "Creating the index" in 71.7550 secs
2025-03-13 13:24:06,068 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7873 secs
2025-03-13 13:24:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 35524 [episode count 8/20]
[retrieval_preprocessing] for episode 36046 [episode count 9/20], we have num_retrieval=np.int64(4737) num_query=np.int64(251)
2025-03-13 13:24:08,385 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:09,098 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:09
2025-03-13 13:24:09,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.92it/s]
2025-03-13 13:24:09,134 [INFO]: There are 4737 embeddings of dim 49152
2025-03-13 13:24:09,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 13:24:09,135 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,135 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:09,135 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:24:09,135 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:09,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:24:09,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,136 [INFO]: 977.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:09,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:24:09,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:09
2025-03-13 13:24:09,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:09,137 [INFO]: 	Creating the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:09
2025-03-13 13:24:09,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:24:09,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,140 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:24:09,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.76it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.20it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.03it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.81it/s]100%|██████████| 19/19 [00:05<00:00,  3.36it/s]
2025-03-13 13:24:14,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:14
2025-03-13 13:25:03,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2274 secs
2025-03-13 13:25:03,037 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 13:25:03,037 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.44it/s]
2025-03-13 13:25:21,361 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3236 secs
2025-03-13 13:25:21,363 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2229 secs
2025-03-13 13:25:21,363 [INFO]: {
2025-03-13 13:25:21,363 [INFO]: 	index_key: HNSW15
2025-03-13 13:25:21,363 [INFO]: 	index_param: efSearch=159
2025-03-13 13:25:21,363 [INFO]: 	index_path: knn.index
2025-03-13 13:25:21,363 [INFO]: 	size in bytes: 931976350
2025-03-13 13:25:21,363 [INFO]: 	avg_search_speed_ms: 9.853060527250465
2025-03-13 13:25:21,363 [INFO]: 	99p_search_speed_ms: 15.38962645456195
2025-03-13 13:25:21,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:21,363 [INFO]: 	nb vectors: 4737
2025-03-13 13:25:21,363 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:21,364 [INFO]: 	compression ratio: 0.9993087228018179
2025-03-13 13:25:21,364 [INFO]: }
2025-03-13 13:25:21,364 [INFO]: 	>>> Finished "Creating the index" in 72.2268 secs
2025-03-13 13:25:21,364 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2651 secs
2025-03-13 13:25:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 36046 [episode count 9/20]
[retrieval_preprocessing] for episode 58582 [episode count 10/20], we have num_retrieval=np.int64(4704) num_query=np.int64(284)
2025-03-13 13:25:23,479 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:24,169 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:24
2025-03-13 13:25:24,169 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.90it/s]
2025-03-13 13:25:24,193 [INFO]: There are 4704 embeddings of dim 49152
2025-03-13 13:25:24,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 13:25:24,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:24
2025-03-13 13:25:24,193 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:24,193 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:25:24,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:25:24,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:24,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:24
2025-03-13 13:25:24,193 [INFO]: 970.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:24,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:25:24,193 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:24
2025-03-13 13:25:24,193 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:24,193 [INFO]: 	Creating the index 03/13/2025, 13:25:24
2025-03-13 13:25:24,193 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:25:24
2025-03-13 13:25:24,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:25:24,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:24
2025-03-13 13:25:24,194 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:25:24,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.55it/s] 42%|████▏     | 8/19 [00:00<00:00, 37.04it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.10it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.61it/s]100%|██████████| 19/19 [00:04<00:00,  4.63it/s]
2025-03-13 13:25:28,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:28
2025-03-13 13:26:10,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6493 secs
2025-03-13 13:26:10,948 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 13:26:10,948 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 13:26:28,235 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2866 secs
2025-03-13 13:26:28,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0425 secs
2025-03-13 13:26:28,237 [INFO]: {
2025-03-13 13:26:28,237 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:28,237 [INFO]: 	index_param: efSearch=138
2025-03-13 13:26:28,237 [INFO]: 	index_path: knn.index
2025-03-13 13:26:28,237 [INFO]: 	size in bytes: 925483810
2025-03-13 13:26:28,237 [INFO]: 	avg_search_speed_ms: 8.084737819603665
2025-03-13 13:26:28,237 [INFO]: 	99p_search_speed_ms: 14.25816076807679
2025-03-13 13:26:28,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:28,237 [INFO]: 	nb vectors: 4704
2025-03-13 13:26:28,237 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:28,237 [INFO]: 	compression ratio: 0.9993087096791029
2025-03-13 13:26:28,237 [INFO]: }
2025-03-13 13:26:28,237 [INFO]: 	>>> Finished "Creating the index" in 64.0438 secs
2025-03-13 13:26:28,237 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0678 secs
2025-03-13 13:26:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 58582 [episode count 10/20]
[retrieval_preprocessing] for episode 38107 [episode count 11/20], we have num_retrieval=np.int64(4392) num_query=np.int64(596)
2025-03-13 13:26:30,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:30,680 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:30
2025-03-13 13:26:30,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1763.79it/s]
2025-03-13 13:26:30,709 [INFO]: There are 4392 embeddings of dim 49152
2025-03-13 13:26:30,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 13:26:30,709 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:30
2025-03-13 13:26:30,709 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:30,709 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 13:26:30,709 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:30,709 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:26:30,709 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:30
2025-03-13 13:26:30,709 [INFO]: 906.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:30,709 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:26:30,709 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:30
2025-03-13 13:26:30,709 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:30,709 [INFO]: 	Creating the index 03/13/2025, 13:26:30
2025-03-13 13:26:30,709 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:30
2025-03-13 13:26:30,710 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:26:30,711 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:30
2025-03-13 13:26:30,711 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:26:30,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.20it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.50it/s] 61%|██████    | 11/18 [00:00<00:00, 37.75it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.75it/s]100%|██████████| 18/18 [00:04<00:00,  4.43it/s]
2025-03-13 13:26:34,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:34
2025-03-13 13:27:19,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3988 secs
2025-03-13 13:27:19,176 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 13:27:19,176 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.33it/s]
2025-03-13 13:27:37,310 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1339 secs
2025-03-13 13:27:37,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6015 secs
2025-03-13 13:27:37,312 [INFO]: {
2025-03-13 13:27:37,312 [INFO]: 	index_key: HNSW15
2025-03-13 13:27:37,312 [INFO]: 	index_param: efSearch=106
2025-03-13 13:27:37,312 [INFO]: 	index_path: knn.index
2025-03-13 13:27:37,312 [INFO]: 	size in bytes: 864099730
2025-03-13 13:27:37,312 [INFO]: 	avg_search_speed_ms: 6.36158091636403
2025-03-13 13:27:37,312 [INFO]: 	99p_search_speed_ms: 9.699453127104787
2025-03-13 13:27:37,312 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:27:37,312 [INFO]: 	nb vectors: 4392
2025-03-13 13:27:37,312 [INFO]: 	vectors dimension: 49152
2025-03-13 13:27:37,312 [INFO]: 	compression ratio: 0.9993086515603934
2025-03-13 13:27:37,312 [INFO]: }
2025-03-13 13:27:37,312 [INFO]: 	>>> Finished "Creating the index" in 66.6029 secs
2025-03-13 13:27:37,312 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6327 secs
2025-03-13 13:27:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 38107 [episode count 11/20]
[retrieval_preprocessing] for episode 13567 [episode count 12/20], we have num_retrieval=np.int64(4790) num_query=np.int64(198)
2025-03-13 13:27:40,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:41,378 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:41
2025-03-13 13:27:41,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 13:27:41,404 [INFO]: There are 4790 embeddings of dim 49152
2025-03-13 13:27:41,405 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 13:27:41,405 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:41
2025-03-13 13:27:41,405 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:41,405 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:27:41,405 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:27:41,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:27:41,405 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:41
2025-03-13 13:27:41,405 [INFO]: 988.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:41,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:27:41,405 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:41
2025-03-13 13:27:41,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:41,405 [INFO]: 	Creating the index 03/13/2025, 13:27:41
2025-03-13 13:27:41,405 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:27:41
2025-03-13 13:27:41,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:27:41,406 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:41
2025-03-13 13:27:41,406 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:27:41,406 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.46it/s] 37%|███▋      | 7/19 [00:00<00:00, 34.63it/s] 68%|██████▊   | 13/19 [00:00<00:00, 43.71it/s]100%|██████████| 19/19 [00:04<00:00,  3.43it/s]100%|██████████| 19/19 [00:04<00:00,  4.63it/s]
2025-03-13 13:27:45,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:45
