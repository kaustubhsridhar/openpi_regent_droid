nohup: ignoring input
2025-03-09 06:46:58: got the info dicts: there are 36687 groupings

2025-03-09 06:46:58: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:46:59: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1297764552, 'bottle') [chosen_id count 0/10]
2025-03-09 06:47:00: [retrieval_preprocessing] we have num_total=4607 embedding_dim=49152
[retrieval_preprocessing] for episode 45057 [episode count 0/20], we have num_retrieval=np.int64(4407) num_query=np.int64(200)
2025-03-09 06:47:00,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:00,745 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:00
2025-03-09 06:47:00,745 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 5178.15it/s]
2025-03-09 06:47:00,792 [INFO]: There are 4407 embeddings of dim 49152
2025-03-09 06:47:00,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0470 secs
2025-03-09 06:47:00,792 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:00
2025-03-09 06:47:00,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:00,793 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:47:00,793 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:00,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:47:00,793 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:00
2025-03-09 06:47:00,794 [INFO]: 909.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:00,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0015 secs
2025-03-09 06:47:00,795 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:00
2025-03-09 06:47:00,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:00,795 [INFO]: 	Creating the index 03/09/2025, 06:47:00
2025-03-09 06:47:00,795 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:00
2025-03-09 06:47:00,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:47:00,798 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:00
2025-03-09 06:47:00,798 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:47:00,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.23it/s] 50%|█████     | 9/18 [00:00<00:00, 48.67it/s] 94%|█████████▍| 17/18 [00:00<00:00, 61.90it/s]100%|██████████| 18/18 [00:02<00:00,  6.20it/s]
2025-03-09 06:47:03,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:03
2025-03-09 06:47:46,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3366 secs
2025-03-09 06:47:46,044 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 06:47:46,044 [INFO]: 	Compute fast metrics 03/09/2025, 06:47:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.69it/s]
2025-03-09 06:47:58,258 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2133 secs
2025-03-09 06:47:58,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4622 secs
2025-03-09 06:47:58,261 [INFO]: {
2025-03-09 06:47:58,261 [INFO]: 	index_key: HNSW15
2025-03-09 06:47:58,261 [INFO]: 	index_param: efSearch=208
2025-03-09 06:47:58,261 [INFO]: 	index_path: knn.index
2025-03-09 06:47:58,261 [INFO]: 	size in bytes: 867050890
2025-03-09 06:47:58,261 [INFO]: 	avg_search_speed_ms: 9.156650639499022
2025-03-09 06:47:58,261 [INFO]: 	99p_search_speed_ms: 12.974580854643133
2025-03-09 06:47:58,261 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:47:58,261 [INFO]: 	nb vectors: 4407
2025-03-09 06:47:58,261 [INFO]: 	vectors dimension: 49152
2025-03-09 06:47:58,261 [INFO]: 	compression ratio: 0.9993086518831669
2025-03-09 06:47:58,261 [INFO]: }
2025-03-09 06:47:58,261 [INFO]: 	>>> Finished "Creating the index" in 57.4661 secs
2025-03-09 06:47:58,261 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5158 secs
2025-03-09 06:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 45057 [episode count 0/20]
[retrieval_preprocessing] for episode 82562 [episode count 1/20], we have num_retrieval=np.int64(4403) num_query=np.int64(204)
2025-03-09 06:48:00,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:00,985 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:00
2025-03-09 06:48:00,985 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-09 06:48:01,015 [INFO]: There are 4403 embeddings of dim 49152
2025-03-09 06:48:01,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 06:48:01,016 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:01,016 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:48:01,016 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:01,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:01,016 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,016 [INFO]: 908.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:01,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:48:01,016 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:01
2025-03-09 06:48:01,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:01,016 [INFO]: 	Creating the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,016 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:01
2025-03-09 06:48:01,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:48:01,017 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,017 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:48:01,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.72it/s] 33%|███▎      | 6/18 [00:00<00:00, 25.49it/s] 67%|██████▋   | 12/18 [00:00<00:00, 37.16it/s]100%|██████████| 18/18 [00:03<00:00,  3.61it/s]100%|██████████| 18/18 [00:03<00:00,  4.73it/s]
2025-03-09 06:48:04,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:04
2025-03-09 06:48:44,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2283 secs
2025-03-09 06:48:44,052 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 06:48:44,052 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.86it/s]
2025-03-09 06:48:56,787 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7347 secs
2025-03-09 06:48:56,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7727 secs
2025-03-09 06:48:56,790 [INFO]: {
2025-03-09 06:48:56,790 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:56,790 [INFO]: 	index_param: efSearch=188
2025-03-09 06:48:56,790 [INFO]: 	index_path: knn.index
2025-03-09 06:48:56,790 [INFO]: 	size in bytes: 866263930
2025-03-09 06:48:56,790 [INFO]: 	avg_search_speed_ms: 9.372898425702651
2025-03-09 06:48:56,790 [INFO]: 	99p_search_speed_ms: 18.444919888861467
2025-03-09 06:48:56,790 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:56,790 [INFO]: 	nb vectors: 4403
2025-03-09 06:48:56,790 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:56,790 [INFO]: 	compression ratio: 0.9993086333399568
2025-03-09 06:48:56,790 [INFO]: }
2025-03-09 06:48:56,790 [INFO]: 	>>> Finished "Creating the index" in 55.7743 secs
2025-03-09 06:48:56,790 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8058 secs
2025-03-09 06:48:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 82562 [episode count 1/20]
[retrieval_preprocessing] for episode 3 [episode count 2/20], we have num_retrieval=np.int64(4368) num_query=np.int64(239)
2025-03-09 06:48:58,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:59,301 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:59
2025-03-09 06:48:59,301 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.02it/s]
2025-03-09 06:48:59,328 [INFO]: There are 4368 embeddings of dim 49152
2025-03-09 06:48:59,329 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 06:48:59,329 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:59
2025-03-09 06:48:59,329 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:59,329 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:48:59,329 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:59,329 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:59,329 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:59
2025-03-09 06:48:59,329 [INFO]: 901.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:59,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:48:59,329 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:59
2025-03-09 06:48:59,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:59,329 [INFO]: 	Creating the index 03/09/2025, 06:48:59
2025-03-09 06:48:59,329 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:59
2025-03-09 06:48:59,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:48:59,330 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:59
2025-03-09 06:48:59,330 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:48:59,330 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.78it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.58it/s] 67%|██████▋   | 12/18 [00:00<00:00, 38.35it/s] 94%|█████████▍| 17/18 [00:00<00:00, 41.46it/s]100%|██████████| 18/18 [00:03<00:00,  5.08it/s]
2025-03-09 06:49:02,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:02
2025-03-09 06:49:43,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1094 secs
2025-03-09 06:49:43,985 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 06:49:43,985 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.88it/s]
2025-03-09 06:49:56,557 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5719 secs
2025-03-09 06:49:56,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2296 secs
2025-03-09 06:49:56,560 [INFO]: {
2025-03-09 06:49:56,560 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:56,560 [INFO]: 	index_param: efSearch=218
2025-03-09 06:49:56,560 [INFO]: 	index_path: knn.index
2025-03-09 06:49:56,560 [INFO]: 	size in bytes: 859377910
2025-03-09 06:49:56,560 [INFO]: 	avg_search_speed_ms: 11.331985995441354
2025-03-09 06:49:56,560 [INFO]: 	99p_search_speed_ms: 27.996588624082502
2025-03-09 06:49:56,560 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:56,560 [INFO]: 	nb vectors: 4368
2025-03-09 06:49:56,560 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:56,560 [INFO]: 	compression ratio: 0.9993086091775387
2025-03-09 06:49:56,560 [INFO]: }
2025-03-09 06:49:56,560 [INFO]: 	>>> Finished "Creating the index" in 57.2311 secs
2025-03-09 06:49:56,560 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2592 secs
2025-03-09 06:49:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 3 [episode count 2/20]
[retrieval_preprocessing] for episode 2187 [episode count 3/20], we have num_retrieval=np.int64(4461) num_query=np.int64(146)
2025-03-09 06:49:59,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:59,904 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:59
2025-03-09 06:49:59,905 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1694.67it/s]
2025-03-09 06:49:59,932 [INFO]: There are 4461 embeddings of dim 49152
2025-03-09 06:49:59,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 06:49:59,932 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:59,932 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 06:49:59,932 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:59,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:59,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,932 [INFO]: 920.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:59,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:49:59,932 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:59
2025-03-09 06:49:59,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:59,932 [INFO]: 	Creating the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,932 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:59
2025-03-09 06:49:59,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:49:59,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,934 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:49:59,934 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.19it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.23it/s] 72%|███████▏  | 13/18 [00:00<00:00, 43.64it/s]100%|██████████| 18/18 [00:04<00:00,  3.11it/s]100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
2025-03-09 06:50:04,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:04
2025-03-09 06:50:50,115 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9992 secs
2025-03-09 06:50:50,115 [INFO]: The best hyperparameters are: efSearch=108
2025-03-09 06:50:50,115 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.55it/s]
2025-03-09 06:51:02,582 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4673 secs
2025-03-09 06:51:02,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6516 secs
2025-03-09 06:51:02,585 [INFO]: {
2025-03-09 06:51:02,585 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:02,585 [INFO]: 	index_param: efSearch=108
2025-03-09 06:51:02,585 [INFO]: 	index_path: knn.index
2025-03-09 06:51:02,585 [INFO]: 	size in bytes: 877675090
2025-03-09 06:51:02,585 [INFO]: 	avg_search_speed_ms: 7.1462851544952635
2025-03-09 06:51:02,585 [INFO]: 	99p_search_speed_ms: 17.193525410257276
2025-03-09 06:51:02,585 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:02,585 [INFO]: 	nb vectors: 4461
2025-03-09 06:51:02,585 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:02,585 [INFO]: 	compression ratio: 0.9993086257011122
2025-03-09 06:51:02,585 [INFO]: }
2025-03-09 06:51:02,585 [INFO]: 	>>> Finished "Creating the index" in 62.6530 secs
2025-03-09 06:51:02,585 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6809 secs
2025-03-09 06:51:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 2187 [episode count 3/20]
[retrieval_preprocessing] for episode 85134 [episode count 4/20], we have num_retrieval=np.int64(4357) num_query=np.int64(250)
2025-03-09 06:51:03,700 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:04,389 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:04
2025-03-09 06:51:04,389 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.25it/s]
2025-03-09 06:51:04,415 [INFO]: There are 4357 embeddings of dim 49152
2025-03-09 06:51:04,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 06:51:04,415 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:04
2025-03-09 06:51:04,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:04,415 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:51:04,415 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:04,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:04,415 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:04
2025-03-09 06:51:04,415 [INFO]: 899.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:04,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:04,415 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:04
2025-03-09 06:51:04,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:04,415 [INFO]: 	Creating the index 03/09/2025, 06:51:04
2025-03-09 06:51:04,415 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:04
2025-03-09 06:51:04,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:51:04,416 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:04
2025-03-09 06:51:04,416 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:51:04,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.95it/s] 33%|███▎      | 6/18 [00:00<00:00, 25.19it/s] 61%|██████    | 11/18 [00:00<00:00, 33.54it/s] 89%|████████▉ | 16/18 [00:00<00:00, 37.78it/s]100%|██████████| 18/18 [00:03<00:00,  4.67it/s]
2025-03-09 06:51:08,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:08
2025-03-09 06:51:50,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8360 secs
2025-03-09 06:51:50,113 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 06:51:50,113 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-09 06:52:02,269 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1556 secs
2025-03-09 06:52:02,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8546 secs
2025-03-09 06:52:02,271 [INFO]: {
2025-03-09 06:52:02,271 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:02,271 [INFO]: 	index_param: efSearch=214
2025-03-09 06:52:02,271 [INFO]: 	index_path: knn.index
2025-03-09 06:52:02,271 [INFO]: 	size in bytes: 857213770
2025-03-09 06:52:02,271 [INFO]: 	avg_search_speed_ms: 10.391785467753374
2025-03-09 06:52:02,271 [INFO]: 	99p_search_speed_ms: 15.426775603555143
2025-03-09 06:52:02,271 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:02,271 [INFO]: 	nb vectors: 4357
2025-03-09 06:52:02,272 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:02,272 [INFO]: 	compression ratio: 0.9993085575375207
2025-03-09 06:52:02,272 [INFO]: }
2025-03-09 06:52:02,272 [INFO]: 	>>> Finished "Creating the index" in 57.8562 secs
2025-03-09 06:52:02,272 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8825 secs
2025-03-09 06:52:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 85134 [episode count 4/20]
[retrieval_preprocessing] for episode 79763 [episode count 5/20], we have num_retrieval=np.int64(4446) num_query=np.int64(161)
2025-03-09 06:52:04,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:05,102 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:05
2025-03-09 06:52:05,102 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1583.95it/s]
2025-03-09 06:52:05,129 [INFO]: There are 4446 embeddings of dim 49152
2025-03-09 06:52:05,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 06:52:05,129 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:05
2025-03-09 06:52:05,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:05,129 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:52:05,129 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:05,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:05,129 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:05
2025-03-09 06:52:05,129 [INFO]: 917.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:05,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:52:05,129 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:05
2025-03-09 06:52:05,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:05,129 [INFO]: 	Creating the index 03/09/2025, 06:52:05
2025-03-09 06:52:05,129 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:05
2025-03-09 06:52:05,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:52:05,130 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:05
2025-03-09 06:52:05,130 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:52:05,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.56it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.51it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.43it/s]100%|██████████| 18/18 [00:04<00:00,  2.90it/s]100%|██████████| 18/18 [00:04<00:00,  4.01it/s]
2025-03-09 06:52:09,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:09
2025-03-09 06:52:53,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1374 secs
2025-03-09 06:52:53,756 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 06:52:53,756 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-09 06:53:06,379 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6231 secs
2025-03-09 06:53:06,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2519 secs
2025-03-09 06:53:06,382 [INFO]: {
2025-03-09 06:53:06,382 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:06,382 [INFO]: 	index_param: efSearch=159
2025-03-09 06:53:06,382 [INFO]: 	index_path: knn.index
2025-03-09 06:53:06,383 [INFO]: 	size in bytes: 874723990
2025-03-09 06:53:06,383 [INFO]: 	avg_search_speed_ms: 8.399857754727606
2025-03-09 06:53:06,383 [INFO]: 	99p_search_speed_ms: 23.779087560251334
2025-03-09 06:53:06,383 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:06,383 [INFO]: 	nb vectors: 4446
2025-03-09 06:53:06,383 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:06,383 [INFO]: 	compression ratio: 0.9993085567482836
2025-03-09 06:53:06,383 [INFO]: }
2025-03-09 06:53:06,383 [INFO]: 	>>> Finished "Creating the index" in 61.2533 secs
2025-03-09 06:53:06,383 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2809 secs
2025-03-09 06:53:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 79763 [episode count 5/20]
[retrieval_preprocessing] for episode 40212 [episode count 6/20], we have num_retrieval=np.int64(4284) num_query=np.int64(323)
2025-03-09 06:53:07,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:08,368 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:08
2025-03-09 06:53:08,368 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.23it/s]
2025-03-09 06:53:08,396 [INFO]: There are 4284 embeddings of dim 49152
2025-03-09 06:53:08,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 06:53:08,396 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:08
2025-03-09 06:53:08,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:08,397 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:53:08,397 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:08,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:53:08,397 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:08
2025-03-09 06:53:08,397 [INFO]: 884.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:08,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:53:08,398 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:08
2025-03-09 06:53:08,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:08,398 [INFO]: 	Creating the index 03/09/2025, 06:53:08
2025-03-09 06:53:08,398 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:08
2025-03-09 06:53:08,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:53:08,401 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:08
2025-03-09 06:53:08,401 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:53:08,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.52it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.61it/s] 82%|████████▏ | 14/17 [00:00<00:00, 45.61it/s]100%|██████████| 17/17 [00:03<00:00,  4.50it/s]
2025-03-09 06:53:12,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:12
2025-03-09 06:53:53,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7129 secs
2025-03-09 06:53:53,898 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 06:53:53,898 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.84it/s]
2025-03-09 06:54:06,108 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2103 secs
2025-03-09 06:54:06,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7098 secs
2025-03-09 06:54:06,111 [INFO]: {
2025-03-09 06:54:06,111 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:06,111 [INFO]: 	index_param: efSearch=178
2025-03-09 06:54:06,111 [INFO]: 	index_path: knn.index
2025-03-09 06:54:06,111 [INFO]: 	size in bytes: 842851330
2025-03-09 06:54:06,111 [INFO]: 	avg_search_speed_ms: 9.052812029729804
2025-03-09 06:54:06,111 [INFO]: 	99p_search_speed_ms: 14.93032017722726
2025-03-09 06:54:06,111 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:06,111 [INFO]: 	nb vectors: 4284
2025-03-09 06:54:06,111 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:06,111 [INFO]: 	compression ratio: 0.999308706079873
2025-03-09 06:54:06,111 [INFO]: }
2025-03-09 06:54:06,111 [INFO]: 	>>> Finished "Creating the index" in 57.7135 secs
2025-03-09 06:54:06,111 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7431 secs
2025-03-09 06:54:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 40212 [episode count 6/20]
[retrieval_preprocessing] for episode 95382 [episode count 7/20], we have num_retrieval=np.int64(4382) num_query=np.int64(225)
2025-03-09 06:54:08,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:09,508 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:09
2025-03-09 06:54:09,508 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.56it/s]
2025-03-09 06:54:09,539 [INFO]: There are 4382 embeddings of dim 49152
2025-03-09 06:54:09,539 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 06:54:09,539 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:09
2025-03-09 06:54:09,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:09,540 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:54:09,540 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:09,540 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:09,540 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:09
2025-03-09 06:54:09,540 [INFO]: 904.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:09,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:54:09,540 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:09
2025-03-09 06:54:09,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:09,540 [INFO]: 	Creating the index 03/09/2025, 06:54:09
2025-03-09 06:54:09,540 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:09
2025-03-09 06:54:09,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:54:09,541 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:09
2025-03-09 06:54:09,541 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:54:09,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.75it/s] 33%|███▎      | 6/18 [00:00<00:00, 25.16it/s] 61%|██████    | 11/18 [00:00<00:00, 34.21it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.14it/s]100%|██████████| 18/18 [00:03<00:00,  4.80it/s]
2025-03-09 06:54:13,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:13
2025-03-09 06:54:55,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8734 secs
2025-03-09 06:54:55,168 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 06:54:55,169 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-09 06:55:08,122 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9534 secs
2025-03-09 06:55:08,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5836 secs
2025-03-09 06:55:08,125 [INFO]: {
2025-03-09 06:55:08,125 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:08,125 [INFO]: 	index_param: efSearch=182
2025-03-09 06:55:08,125 [INFO]: 	index_path: knn.index
2025-03-09 06:55:08,125 [INFO]: 	size in bytes: 862132330
2025-03-09 06:55:08,125 [INFO]: 	avg_search_speed_ms: 8.629858558290382
2025-03-09 06:55:08,125 [INFO]: 	99p_search_speed_ms: 11.903234361670913
2025-03-09 06:55:08,125 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:08,125 [INFO]: 	nb vectors: 4382
2025-03-09 06:55:08,125 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:08,125 [INFO]: 	compression ratio: 0.9993086049794699
2025-03-09 06:55:08,125 [INFO]: }
2025-03-09 06:55:08,125 [INFO]: 	>>> Finished "Creating the index" in 58.5850 secs
2025-03-09 06:55:08,125 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6166 secs
2025-03-09 06:55:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 95382 [episode count 7/20]
[retrieval_preprocessing] for episode 10007 [episode count 8/20], we have num_retrieval=np.int64(4227) num_query=np.int64(380)
2025-03-09 06:55:10,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:10,796 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:10
2025-03-09 06:55:10,797 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.62it/s]
2025-03-09 06:55:10,825 [INFO]: There are 4227 embeddings of dim 49152
2025-03-09 06:55:10,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 06:55:10,826 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:10
2025-03-09 06:55:10,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:10,826 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:55:10,826 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:10,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:10,826 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:10
2025-03-09 06:55:10,826 [INFO]: 872.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:10,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:10,826 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:10
2025-03-09 06:55:10,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:10,826 [INFO]: 	Creating the index 03/09/2025, 06:55:10
2025-03-09 06:55:10,826 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:10
2025-03-09 06:55:10,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 06:55:10,827 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:10
2025-03-09 06:55:10,827 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:55:10,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.64it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.54it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.80it/s] 94%|█████████▍| 16/17 [00:00<00:00, 42.07it/s]100%|██████████| 17/17 [00:03<00:00,  4.30it/s]
2025-03-09 06:55:14,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:14
2025-03-09 06:55:57,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4134 secs
2025-03-09 06:55:57,202 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 06:55:57,202 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 06:56:09,691 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4887 secs
2025-03-09 06:56:09,693 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8659 secs
2025-03-09 06:56:09,693 [INFO]: {
2025-03-09 06:56:09,693 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:09,693 [INFO]: 	index_param: efSearch=158
2025-03-09 06:56:09,693 [INFO]: 	index_path: knn.index
2025-03-09 06:56:09,694 [INFO]: 	size in bytes: 831636850
2025-03-09 06:56:09,694 [INFO]: 	avg_search_speed_ms: 8.252414983655742
2025-03-09 06:56:09,694 [INFO]: 	99p_search_speed_ms: 21.522100633010286
2025-03-09 06:56:09,694 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:09,694 [INFO]: 	nb vectors: 4227
2025-03-09 06:56:09,694 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:09,694 [INFO]: 	compression ratio: 0.999308792052685
2025-03-09 06:56:09,694 [INFO]: }
2025-03-09 06:56:09,694 [INFO]: 	>>> Finished "Creating the index" in 58.8676 secs
2025-03-09 06:56:09,694 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8971 secs
2025-03-09 06:56:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 10007 [episode count 8/20]
[retrieval_preprocessing] for episode 40858 [episode count 9/20], we have num_retrieval=np.int64(4366) num_query=np.int64(241)
2025-03-09 06:56:12,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:13,259 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:13
2025-03-09 06:56:13,259 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1695.35it/s]
2025-03-09 06:56:13,286 [INFO]: There are 4366 embeddings of dim 49152
2025-03-09 06:56:13,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 06:56:13,287 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:13
2025-03-09 06:56:13,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:13,287 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:56:13,287 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:13,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:13,287 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:13
2025-03-09 06:56:13,287 [INFO]: 901.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:13,287 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:13,287 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:13
2025-03-09 06:56:13,287 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:13,287 [INFO]: 	Creating the index 03/09/2025, 06:56:13
2025-03-09 06:56:13,287 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:13
2025-03-09 06:56:13,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:56:13,288 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:13
2025-03-09 06:56:13,288 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:56:13,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.02it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.90it/s] 61%|██████    | 11/18 [00:00<00:00, 37.93it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.81it/s]100%|██████████| 18/18 [00:03<00:00,  4.59it/s]
2025-03-09 06:56:17,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:17
2025-03-09 06:56:59,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4614 secs
2025-03-09 06:56:59,673 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 06:56:59,673 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-09 06:57:12,383 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7094 secs
2025-03-09 06:57:12,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0975 secs
2025-03-09 06:57:12,386 [INFO]: {
2025-03-09 06:57:12,386 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:12,386 [INFO]: 	index_param: efSearch=207
2025-03-09 06:57:12,386 [INFO]: 	index_path: knn.index
2025-03-09 06:57:12,386 [INFO]: 	size in bytes: 858984430
2025-03-09 06:57:12,386 [INFO]: 	avg_search_speed_ms: 11.226408704111874
2025-03-09 06:57:12,386 [INFO]: 	99p_search_speed_ms: 29.6455908799544
2025-03-09 06:57:12,386 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:12,386 [INFO]: 	nb vectors: 4366
2025-03-09 06:57:12,386 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:12,386 [INFO]: 	compression ratio: 0.9993085998077986
2025-03-09 06:57:12,386 [INFO]: }
2025-03-09 06:57:12,386 [INFO]: 	>>> Finished "Creating the index" in 59.0989 secs
2025-03-09 06:57:12,386 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1268 secs
2025-03-09 06:57:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 40858 [episode count 9/20]
[retrieval_preprocessing] for episode 81306 [episode count 10/20], we have num_retrieval=np.int64(4400) num_query=np.int64(207)
2025-03-09 06:57:14,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:15,301 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:15
2025-03-09 06:57:15,301 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2106.63it/s]
2025-03-09 06:57:15,326 [INFO]: There are 4400 embeddings of dim 49152
2025-03-09 06:57:15,327 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 06:57:15,327 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:15
2025-03-09 06:57:15,327 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:15,327 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:57:15,327 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:15,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:57:15,327 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:15
2025-03-09 06:57:15,327 [INFO]: 908.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:15,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:15,327 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:15
2025-03-09 06:57:15,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:15,327 [INFO]: 	Creating the index 03/09/2025, 06:57:15
2025-03-09 06:57:15,327 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:15
2025-03-09 06:57:15,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:57:15,328 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:15
2025-03-09 06:57:15,328 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:57:15,328 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.83it/s] 33%|███▎      | 6/18 [00:00<00:00, 31.51it/s] 61%|██████    | 11/18 [00:00<00:00, 39.45it/s] 94%|█████████▍| 17/18 [00:00<00:00, 43.91it/s]100%|██████████| 18/18 [00:03<00:00,  4.65it/s]
2025-03-09 06:57:19,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:19
2025-03-09 06:57:57,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0438 secs
2025-03-09 06:57:57,252 [INFO]: The best hyperparameters are: efSearch=151
2025-03-09 06:57:57,252 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-09 06:58:10,017 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7647 secs
2025-03-09 06:58:10,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6912 secs
2025-03-09 06:58:10,020 [INFO]: {
2025-03-09 06:58:10,020 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:10,020 [INFO]: 	index_param: efSearch=151
2025-03-09 06:58:10,020 [INFO]: 	index_path: knn.index
2025-03-09 06:58:10,020 [INFO]: 	size in bytes: 865673710
2025-03-09 06:58:10,020 [INFO]: 	avg_search_speed_ms: 8.340875408243235
2025-03-09 06:58:10,020 [INFO]: 	99p_search_speed_ms: 13.155952137894927
2025-03-09 06:58:10,020 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:10,020 [INFO]: 	nb vectors: 4400
2025-03-09 06:58:10,020 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:10,020 [INFO]: 	compression ratio: 0.9993086194104243
2025-03-09 06:58:10,020 [INFO]: }
2025-03-09 06:58:10,020 [INFO]: 	>>> Finished "Creating the index" in 54.6925 secs
2025-03-09 06:58:10,020 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7191 secs
2025-03-09 06:58:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81306 [episode count 10/20]
[retrieval_preprocessing] for episode 7580 [episode count 11/20], we have num_retrieval=np.int64(4415) num_query=np.int64(192)
2025-03-09 06:58:11,631 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:12,211 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:12
2025-03-09 06:58:12,212 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.87it/s]
2025-03-09 06:58:12,240 [INFO]: There are 4415 embeddings of dim 49152
2025-03-09 06:58:12,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 06:58:12,240 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:12,240 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:58:12,240 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:12,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:12,240 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,240 [INFO]: 911.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:12,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:58:12,240 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:12
2025-03-09 06:58:12,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:12,241 [INFO]: 	Creating the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,241 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:12
2025-03-09 06:58:12,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:58:12,242 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,242 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:58:12,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.81it/s] 44%|████▍     | 8/18 [00:00<00:00, 38.12it/s] 78%|███████▊  | 14/18 [00:00<00:00, 45.49it/s]100%|██████████| 18/18 [00:03<00:00,  5.32it/s]
2025-03-09 06:58:15,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:15
2025-03-09 06:58:53,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8265 secs
2025-03-09 06:58:53,458 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 06:58:53,458 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.00it/s]
2025-03-09 06:59:07,687 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2288 secs
2025-03-09 06:59:07,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4480 secs
2025-03-09 06:59:07,690 [INFO]: {
2025-03-09 06:59:07,690 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:07,690 [INFO]: 	index_param: efSearch=183
2025-03-09 06:59:07,690 [INFO]: 	index_path: knn.index
2025-03-09 06:59:07,690 [INFO]: 	size in bytes: 868624930
2025-03-09 06:59:07,690 [INFO]: 	avg_search_speed_ms: 8.809553648217987
2025-03-09 06:59:07,690 [INFO]: 	99p_search_speed_ms: 13.36225284263493
2025-03-09 06:59:07,690 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:07,690 [INFO]: 	nb vectors: 4415
2025-03-09 06:59:07,690 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:07,690 [INFO]: 	compression ratio: 0.999308550814907
2025-03-09 06:59:07,690 [INFO]: }
2025-03-09 06:59:07,690 [INFO]: 	>>> Finished "Creating the index" in 55.4495 secs
2025-03-09 06:59:07,690 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4785 secs
2025-03-09 06:59:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 7580 [episode count 11/20]
[retrieval_preprocessing] for episode 75933 [episode count 12/20], we have num_retrieval=np.int64(4425) num_query=np.int64(182)
2025-03-09 06:59:09,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:09,917 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:09
2025-03-09 06:59:09,917 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1123.57it/s]
2025-03-09 06:59:09,947 [INFO]: There are 4425 embeddings of dim 49152
2025-03-09 06:59:09,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 06:59:09,948 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:09,948 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 06:59:09,948 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:09,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:59:09,949 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,949 [INFO]: 913.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:09,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:59:09,949 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:09
2025-03-09 06:59:09,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:09,950 [INFO]: 	Creating the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,950 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:09
2025-03-09 06:59:09,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 06:59:09,953 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,953 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:59:09,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.27it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.54it/s] 72%|███████▏  | 13/18 [00:00<00:00, 43.38it/s]100%|██████████| 18/18 [00:04<00:00,  2.97it/s]100%|██████████| 18/18 [00:04<00:00,  4.17it/s]
2025-03-09 06:59:14,271 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:14
2025-03-09 06:59:53,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0996 secs
2025-03-09 06:59:53,371 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 06:59:53,371 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.99it/s]
2025-03-09 07:00:05,635 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2638 secs
2025-03-09 07:00:05,637 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6842 secs
2025-03-09 07:00:05,638 [INFO]: {
2025-03-09 07:00:05,638 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:05,638 [INFO]: 	index_param: efSearch=203
2025-03-09 07:00:05,638 [INFO]: 	index_path: knn.index
2025-03-09 07:00:05,638 [INFO]: 	size in bytes: 870592330
2025-03-09 07:00:05,638 [INFO]: 	avg_search_speed_ms: 8.987621333314523
2025-03-09 07:00:05,638 [INFO]: 	99p_search_speed_ms: 11.543316058814524
2025-03-09 07:00:05,638 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:05,638 [INFO]: 	nb vectors: 4425
2025-03-09 07:00:05,638 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:05,638 [INFO]: 	compression ratio: 0.9993085971708481
2025-03-09 07:00:05,638 [INFO]: }
2025-03-09 07:00:05,638 [INFO]: 	>>> Finished "Creating the index" in 55.6881 secs
2025-03-09 07:00:05,638 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7205 secs
2025-03-09 07:00:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 75933 [episode count 12/20]
[retrieval_preprocessing] for episode 67616 [episode count 13/20], we have num_retrieval=np.int64(4410) num_query=np.int64(197)
2025-03-09 07:00:07,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:07,811 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:07
2025-03-09 07:00:07,812 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-09 07:00:07,838 [INFO]: There are 4410 embeddings of dim 49152
2025-03-09 07:00:07,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:00:07,839 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:07
2025-03-09 07:00:07,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:07,839 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:00:07,839 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:07,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:07,839 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:07
2025-03-09 07:00:07,839 [INFO]: 910.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:07,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:00:07,839 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:07
2025-03-09 07:00:07,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:07,839 [INFO]: 	Creating the index 03/09/2025, 07:00:07
2025-03-09 07:00:07,839 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:07
2025-03-09 07:00:07,840 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:00:07,840 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:07
2025-03-09 07:00:07,840 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:00:07,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.60it/s] 44%|████▍     | 8/18 [00:00<00:00, 39.25it/s] 78%|███████▊  | 14/18 [00:00<00:00, 46.34it/s]100%|██████████| 18/18 [00:03<00:00,  4.99it/s]
2025-03-09 07:00:11,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:11
2025-03-09 07:00:50,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3990 secs
2025-03-09 07:00:50,847 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 07:00:50,847 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 07:01:04,966 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1184 secs
2025-03-09 07:01:04,968 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1277 secs
2025-03-09 07:01:04,968 [INFO]: {
2025-03-09 07:01:04,968 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:04,968 [INFO]: 	index_param: efSearch=165
2025-03-09 07:01:04,968 [INFO]: 	index_path: knn.index
2025-03-09 07:01:04,968 [INFO]: 	size in bytes: 867641110
2025-03-09 07:01:04,968 [INFO]: 	avg_search_speed_ms: 7.8197779338530164
2025-03-09 07:01:04,968 [INFO]: 	99p_search_speed_ms: 11.022915975190699
2025-03-09 07:01:04,968 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:04,968 [INFO]: 	nb vectors: 4410
2025-03-09 07:01:04,968 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:04,968 [INFO]: 	compression ratio: 0.9993086657684996
2025-03-09 07:01:04,968 [INFO]: }
2025-03-09 07:01:04,968 [INFO]: 	>>> Finished "Creating the index" in 57.1291 secs
2025-03-09 07:01:04,968 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1569 secs
2025-03-09 07:01:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 67616 [episode count 13/20]
[retrieval_preprocessing] for episode 39586 [episode count 14/20], we have num_retrieval=np.int64(4311) num_query=np.int64(296)
2025-03-09 07:01:06,622 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:07,241 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:07
2025-03-09 07:01:07,241 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1999.19it/s]
2025-03-09 07:01:07,268 [INFO]: There are 4311 embeddings of dim 49152
2025-03-09 07:01:07,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:01:07,268 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:07
2025-03-09 07:01:07,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:07,268 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:01:07,268 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:07,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:07,268 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:07
2025-03-09 07:01:07,268 [INFO]: 889.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:07,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:01:07,269 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:07
2025-03-09 07:01:07,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:07,269 [INFO]: 	Creating the index 03/09/2025, 07:01:07
2025-03-09 07:01:07,269 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:07
2025-03-09 07:01:07,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:01:07,270 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:07
2025-03-09 07:01:07,270 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:01:07,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.30it/s] 47%|████▋     | 8/17 [00:00<00:00, 38.31it/s] 82%|████████▏ | 14/17 [00:00<00:00, 44.83it/s]100%|██████████| 17/17 [00:03<00:00,  4.57it/s]
2025-03-09 07:01:10,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:10
2025-03-09 07:01:48,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8972 secs
2025-03-09 07:01:48,891 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:01:48,891 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.60it/s]
2025-03-09 07:02:01,664 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7721 secs
2025-03-09 07:02:01,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3959 secs
2025-03-09 07:02:01,666 [INFO]: {
2025-03-09 07:02:01,666 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:01,666 [INFO]: 	index_param: efSearch=199
2025-03-09 07:02:01,666 [INFO]: 	index_path: knn.index
2025-03-09 07:02:01,666 [INFO]: 	size in bytes: 848163490
2025-03-09 07:02:01,666 [INFO]: 	avg_search_speed_ms: 9.220485535583325
2025-03-09 07:02:01,666 [INFO]: 	99p_search_speed_ms: 14.396690558642163
2025-03-09 07:02:01,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:01,666 [INFO]: 	nb vectors: 4311
2025-03-09 07:02:01,666 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:01,666 [INFO]: 	compression ratio: 0.9993086215017343
2025-03-09 07:02:01,666 [INFO]: }
2025-03-09 07:02:01,666 [INFO]: 	>>> Finished "Creating the index" in 54.3975 secs
2025-03-09 07:02:01,666 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4253 secs
2025-03-09 07:02:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 39586 [episode count 14/20]
[retrieval_preprocessing] for episode 83234 [episode count 15/20], we have num_retrieval=np.int64(4419) num_query=np.int64(188)
2025-03-09 07:02:04,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:04,886 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:04
2025-03-09 07:02:04,887 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.84it/s]
2025-03-09 07:02:04,917 [INFO]: There are 4419 embeddings of dim 49152
2025-03-09 07:02:04,917 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:02:04,917 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:04
2025-03-09 07:02:04,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:04,918 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:02:04,918 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:04,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:04,918 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:04
2025-03-09 07:02:04,918 [INFO]: 912.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:04,918 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:02:04,918 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:04
2025-03-09 07:02:04,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:04,918 [INFO]: 	Creating the index 03/09/2025, 07:02:04
2025-03-09 07:02:04,918 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:04
2025-03-09 07:02:04,919 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:02:04,919 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:04
2025-03-09 07:02:04,919 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:02:04,919 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.77it/s] 28%|██▊       | 5/18 [00:00<00:00, 22.81it/s] 50%|█████     | 9/18 [00:00<00:00, 29.04it/s] 72%|███████▏  | 13/18 [00:00<00:00, 32.41it/s] 94%|█████████▍| 17/18 [00:00<00:00, 34.34it/s]100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
2025-03-09 07:02:09,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:09
2025-03-09 07:02:47,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5533 secs
2025-03-09 07:02:47,705 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:02:47,705 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]
2025-03-09 07:03:01,979 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2743 secs
2025-03-09 07:03:01,982 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0625 secs
2025-03-09 07:03:01,982 [INFO]: {
2025-03-09 07:03:01,982 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:01,982 [INFO]: 	index_param: efSearch=199
2025-03-09 07:03:01,982 [INFO]: 	index_path: knn.index
2025-03-09 07:03:01,982 [INFO]: 	size in bytes: 869411890
2025-03-09 07:03:01,982 [INFO]: 	avg_search_speed_ms: 9.34058972343065
2025-03-09 07:03:01,982 [INFO]: 	99p_search_speed_ms: 13.995364285074173
2025-03-09 07:03:01,982 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:01,982 [INFO]: 	nb vectors: 4419
2025-03-09 07:03:01,982 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:01,982 [INFO]: 	compression ratio: 0.9993085693824593
2025-03-09 07:03:01,982 [INFO]: }
2025-03-09 07:03:01,982 [INFO]: 	>>> Finished "Creating the index" in 57.0639 secs
2025-03-09 07:03:01,982 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0954 secs
2025-03-09 07:03:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 83234 [episode count 15/20]
[retrieval_preprocessing] for episode 23462 [episode count 16/20], we have num_retrieval=np.int64(4340) num_query=np.int64(267)
2025-03-09 07:03:03,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:04,472 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:04
2025-03-09 07:03:04,472 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2034.10it/s]
2025-03-09 07:03:04,502 [INFO]: There are 4340 embeddings of dim 49152
2025-03-09 07:03:04,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 07:03:04,503 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:04
2025-03-09 07:03:04,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:04,503 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:03:04,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:04,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:03:04,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:04
2025-03-09 07:03:04,503 [INFO]: 895.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:04,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:03:04,503 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:04
2025-03-09 07:03:04,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:04,503 [INFO]: 	Creating the index 03/09/2025, 07:03:04
2025-03-09 07:03:04,503 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:04
2025-03-09 07:03:04,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:03:04,504 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:04
2025-03-09 07:03:04,504 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:03:04,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.80it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.50it/s] 61%|██████    | 11/18 [00:00<00:00, 37.91it/s] 89%|████████▉ | 16/18 [00:00<00:00, 42.27it/s]100%|██████████| 18/18 [00:04<00:00,  4.48it/s]
2025-03-09 07:03:08,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:08
2025-03-09 07:03:49,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4491 secs
2025-03-09 07:03:49,979 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 07:03:49,979 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.02it/s]
2025-03-09 07:04:02,136 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1570 secs
2025-03-09 07:04:02,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6346 secs
2025-03-09 07:04:02,139 [INFO]: {
2025-03-09 07:04:02,139 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:02,139 [INFO]: 	index_param: efSearch=196
2025-03-09 07:04:02,139 [INFO]: 	index_path: knn.index
2025-03-09 07:04:02,139 [INFO]: 	size in bytes: 853869070
2025-03-09 07:04:02,139 [INFO]: 	avg_search_speed_ms: 8.745356412581637
2025-03-09 07:04:02,139 [INFO]: 	99p_search_speed_ms: 13.11450074892491
2025-03-09 07:04:02,139 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:02,139 [INFO]: 	nb vectors: 4340
2025-03-09 07:04:02,139 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:02,139 [INFO]: 	compression ratio: 0.9993086176549292
2025-03-09 07:04:02,139 [INFO]: }
2025-03-09 07:04:02,139 [INFO]: 	>>> Finished "Creating the index" in 57.6362 secs
2025-03-09 07:04:02,139 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6676 secs
2025-03-09 07:04:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 23462 [episode count 16/20]
[retrieval_preprocessing] for episode 90923 [episode count 17/20], we have num_retrieval=np.int64(4342) num_query=np.int64(265)
2025-03-09 07:04:04,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:05,012 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:05
2025-03-09 07:04:05,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-09 07:04:05,041 [INFO]: There are 4342 embeddings of dim 49152
2025-03-09 07:04:05,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 07:04:05,042 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:05
2025-03-09 07:04:05,042 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:05,042 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:04:05,042 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:05,042 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:05,042 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:05
2025-03-09 07:04:05,042 [INFO]: 896.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:05,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:05,042 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:05
2025-03-09 07:04:05,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:05,042 [INFO]: 	Creating the index 03/09/2025, 07:04:05
2025-03-09 07:04:05,042 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:05
2025-03-09 07:04:05,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:05,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:05
2025-03-09 07:04:05,043 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:04:05,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.88it/s] 33%|███▎      | 6/18 [00:00<00:00, 31.32it/s] 61%|██████    | 11/18 [00:00<00:00, 39.11it/s] 89%|████████▉ | 16/18 [00:00<00:00, 42.85it/s]100%|██████████| 18/18 [00:03<00:00,  5.08it/s]
2025-03-09 07:04:08,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:08
2025-03-09 07:04:46,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9246 secs
2025-03-09 07:04:46,518 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:04:46,518 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-09 07:04:58,759 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2410 secs
2025-03-09 07:04:58,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7181 secs
2025-03-09 07:04:58,761 [INFO]: {
2025-03-09 07:04:58,761 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:58,761 [INFO]: 	index_param: efSearch=177
2025-03-09 07:04:58,762 [INFO]: 	index_path: knn.index
2025-03-09 07:04:58,762 [INFO]: 	size in bytes: 854262550
2025-03-09 07:04:58,762 [INFO]: 	avg_search_speed_ms: 8.992503665173226
2025-03-09 07:04:58,762 [INFO]: 	99p_search_speed_ms: 13.052595381159337
2025-03-09 07:04:58,762 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:58,762 [INFO]: 	nb vectors: 4342
2025-03-09 07:04:58,762 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:58,762 [INFO]: 	compression ratio: 0.9993086270725552
2025-03-09 07:04:58,762 [INFO]: }
2025-03-09 07:04:58,762 [INFO]: 	>>> Finished "Creating the index" in 53.7195 secs
2025-03-09 07:04:58,762 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7493 secs
2025-03-09 07:04:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 90923 [episode count 17/20]
[retrieval_preprocessing] for episode 28973 [episode count 18/20], we have num_retrieval=np.int64(4426) num_query=np.int64(181)
2025-03-09 07:05:00,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:01,491 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:01
2025-03-09 07:05:01,491 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1474.79it/s]
2025-03-09 07:05:01,519 [INFO]: There are 4426 embeddings of dim 49152
2025-03-09 07:05:01,519 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:05:01,519 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:01
2025-03-09 07:05:01,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:01,519 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:05:01,519 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:01,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:01,519 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:01
2025-03-09 07:05:01,519 [INFO]: 913.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:01,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:01,520 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:01
2025-03-09 07:05:01,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:01,520 [INFO]: 	Creating the index 03/09/2025, 07:05:01
2025-03-09 07:05:01,520 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:01
2025-03-09 07:05:01,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:01,521 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:01
2025-03-09 07:05:01,521 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:05:01,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.35it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.10it/s] 72%|███████▏  | 13/18 [00:00<00:00, 43.06it/s]100%|██████████| 18/18 [00:03<00:00,  3.68it/s]100%|██████████| 18/18 [00:03<00:00,  5.05it/s]
2025-03-09 07:05:05,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:05
2025-03-09 07:05:44,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5909 secs
2025-03-09 07:05:44,682 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 07:05:44,682 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-09 07:05:57,274 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5925 secs
2025-03-09 07:05:57,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7561 secs
2025-03-09 07:05:57,277 [INFO]: {
2025-03-09 07:05:57,277 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:57,277 [INFO]: 	index_param: efSearch=172
2025-03-09 07:05:57,277 [INFO]: 	index_path: knn.index
2025-03-09 07:05:57,277 [INFO]: 	size in bytes: 870789070
2025-03-09 07:05:57,277 [INFO]: 	avg_search_speed_ms: 8.533088127413365
2025-03-09 07:05:57,277 [INFO]: 	99p_search_speed_ms: 12.127261324785646
2025-03-09 07:05:57,277 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:57,277 [INFO]: 	nb vectors: 4426
2025-03-09 07:05:57,277 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:57,277 [INFO]: 	compression ratio: 0.9993086017949214
2025-03-09 07:05:57,277 [INFO]: }
2025-03-09 07:05:57,277 [INFO]: 	>>> Finished "Creating the index" in 55.7576 secs
2025-03-09 07:05:57,277 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7864 secs
2025-03-09 07:05:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 28973 [episode count 18/20]
[retrieval_preprocessing] for episode 32941 [episode count 19/20], we have num_retrieval=np.int64(4344) num_query=np.int64(263)
2025-03-09 07:05:58,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:59,598 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:59
2025-03-09 07:05:59,598 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.91it/s]
2025-03-09 07:05:59,626 [INFO]: There are 4344 embeddings of dim 49152
2025-03-09 07:05:59,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 07:05:59,627 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:59,627 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:05:59,627 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:59,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:59,627 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,627 [INFO]: 896.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:59,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:05:59,627 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:59
2025-03-09 07:05:59,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:59,627 [INFO]: 	Creating the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,627 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:59
2025-03-09 07:05:59,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:59,628 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,628 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:05:59,628 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.97it/s] 44%|████▍     | 8/18 [00:00<00:00, 36.69it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.85it/s]100%|██████████| 18/18 [00:04<00:00,  2.66it/s]100%|██████████| 18/18 [00:04<00:00,  3.80it/s]
2025-03-09 07:06:04,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:04
2025-03-09 07:06:42,883 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5183 secs
2025-03-09 07:06:42,884 [INFO]: The best hyperparameters are: efSearch=153
2025-03-09 07:06:42,884 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.16it/s]
2025-03-09 07:06:55,398 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5140 secs
2025-03-09 07:06:55,401 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7725 secs
2025-03-09 07:06:55,401 [INFO]: {
2025-03-09 07:06:55,401 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:55,401 [INFO]: 	index_param: efSearch=153
2025-03-09 07:06:55,401 [INFO]: 	index_path: knn.index
2025-03-09 07:06:55,401 [INFO]: 	size in bytes: 854656090
2025-03-09 07:06:55,401 [INFO]: 	avg_search_speed_ms: 8.021980761748281
2025-03-09 07:06:55,401 [INFO]: 	99p_search_speed_ms: 11.19163236580789
2025-03-09 07:06:55,401 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:55,401 [INFO]: 	nb vectors: 4344
2025-03-09 07:06:55,401 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:55,401 [INFO]: 	compression ratio: 0.9993085663263688
2025-03-09 07:06:55,401 [INFO]: }
2025-03-09 07:06:55,401 [INFO]: 	>>> Finished "Creating the index" in 55.7739 secs
2025-03-09 07:06:55,401 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8030 secs
2025-03-09 07:06:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 32941 [episode count 19/20]
2025-03-09 07:06:56: [retrieval_preprocessing] finished for (1297764552, 'bottle') [chosen_id count 0/10]
2025-03-09 07:07:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2515873443, 'cloth') [chosen_id count 1/10]
2025-03-09 07:07:02: [retrieval_preprocessing] we have num_total=8008 embedding_dim=49152
[retrieval_preprocessing] for episode 64773 [episode count 0/20], we have num_retrieval=np.int64(7695) num_query=np.int64(313)
2025-03-09 07:07:03,365 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:04,401 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:04
2025-03-09 07:07:04,401 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.95it/s]
2025-03-09 07:07:04,429 [INFO]: There are 7695 embeddings of dim 49152
2025-03-09 07:07:04,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:07:04,430 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:04
2025-03-09 07:07:04,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:04,430 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:07:04,430 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:04,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:04,430 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:04
2025-03-09 07:07:04,430 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:04,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:07:04,430 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:04
2025-03-09 07:07:04,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:04,430 [INFO]: 	Creating the index 03/09/2025, 07:07:04
2025-03-09 07:07:04,430 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:04
2025-03-09 07:07:04,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:07:04,432 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:04
2025-03-09 07:07:04,432 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:07:04,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 16.09it/s] 25%|██▌       | 8/32 [00:00<00:00, 36.94it/s] 44%|████▍     | 14/32 [00:00<00:00, 44.59it/s] 62%|██████▎   | 20/32 [00:00<00:00, 48.32it/s] 78%|███████▊  | 25/32 [00:04<00:01,  3.60it/s] 97%|█████████▋| 31/32 [00:04<00:00,  5.49it/s]100%|██████████| 32/32 [00:06<00:00,  4.75it/s]
2025-03-09 07:07:11,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:11
2025-03-09 07:08:08,591 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4251 secs
2025-03-09 07:08:08,605 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 07:08:08,606 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.23it/s]
2025-03-09 07:08:22,607 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0014 secs
2025-03-09 07:08:22,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1788 secs
2025-03-09 07:08:22,611 [INFO]: {
2025-03-09 07:08:22,611 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:22,611 [INFO]: 	index_param: efSearch=283
2025-03-09 07:08:22,611 [INFO]: 	index_path: knn.index
2025-03-09 07:08:22,611 [INFO]: 	size in bytes: 1513946110
2025-03-09 07:08:22,611 [INFO]: 	avg_search_speed_ms: 12.136970496921828
2025-03-09 07:08:22,611 [INFO]: 	99p_search_speed_ms: 27.42929953616112
2025-03-09 07:08:22,611 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:22,611 [INFO]: 	nb vectors: 7695
2025-03-09 07:08:22,611 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:22,611 [INFO]: 	compression ratio: 0.9993080665202806
2025-03-09 07:08:22,611 [INFO]: }
2025-03-09 07:08:22,611 [INFO]: 	>>> Finished "Creating the index" in 78.1805 secs
2025-03-09 07:08:22,611 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2094 secs
2025-03-09 07:08:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 64773 [episode count 0/20]
[retrieval_preprocessing] for episode 59783 [episode count 1/20], we have num_retrieval=np.int64(7633) num_query=np.int64(375)
2025-03-09 07:08:27,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:28,210 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:28
2025-03-09 07:08:28,210 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.02it/s]
2025-03-09 07:08:28,235 [INFO]: There are 7633 embeddings of dim 49152
2025-03-09 07:08:28,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:08:28,236 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:28
2025-03-09 07:08:28,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:28,236 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:08:28,236 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:28,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:28,236 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:28
2025-03-09 07:08:28,236 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:28,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:08:28,236 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:28
2025-03-09 07:08:28,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:28,236 [INFO]: 	Creating the index 03/09/2025, 07:08:28
2025-03-09 07:08:28,236 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:28
2025-03-09 07:08:28,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:08:28,237 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:28
2025-03-09 07:08:28,237 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:08:28,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.55it/s] 19%|█▉        | 6/32 [00:00<00:00, 26.57it/s] 38%|███▊      | 12/32 [00:00<00:00, 37.03it/s] 56%|█████▋    | 18/32 [00:00<00:00, 42.14it/s] 72%|███████▏  | 23/32 [00:03<00:02,  3.96it/s] 91%|█████████ | 29/32 [00:03<00:00,  6.06it/s]100%|██████████| 32/32 [00:06<00:00,  4.96it/s]
2025-03-09 07:08:34,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:34
2025-03-09 07:09:40,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9047 secs
2025-03-09 07:09:40,629 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 07:09:40,629 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-09 07:09:54,734 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1050 secs
2025-03-09 07:09:54,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4984 secs
2025-03-09 07:09:54,736 [INFO]: {
2025-03-09 07:09:54,736 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:54,736 [INFO]: 	index_param: efSearch=275
2025-03-09 07:09:54,736 [INFO]: 	index_path: knn.index
2025-03-09 07:09:54,736 [INFO]: 	size in bytes: 1501747990
2025-03-09 07:09:54,736 [INFO]: 	avg_search_speed_ms: 10.967282336583084
2025-03-09 07:09:54,736 [INFO]: 	99p_search_speed_ms: 22.97371211694553
2025-03-09 07:09:54,736 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:54,736 [INFO]: 	nb vectors: 7633
2025-03-09 07:09:54,736 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:54,736 [INFO]: 	compression ratio: 0.9993080556745076
2025-03-09 07:09:54,736 [INFO]: }
2025-03-09 07:09:54,736 [INFO]: 	>>> Finished "Creating the index" in 86.5004 secs
2025-03-09 07:09:54,737 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5266 secs
2025-03-09 07:09:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 59783 [episode count 1/20]
[retrieval_preprocessing] for episode 62856 [episode count 2/20], we have num_retrieval=np.int64(7645) num_query=np.int64(363)
2025-03-09 07:09:59,082 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:00,085 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:00
2025-03-09 07:10:00,085 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.65it/s]
2025-03-09 07:10:00,114 [INFO]: There are 7645 embeddings of dim 49152
2025-03-09 07:10:00,114 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 07:10:00,114 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:00,115 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:10:00,115 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:00,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:10:00,115 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,115 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:00,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:10:00,116 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:00
2025-03-09 07:10:00,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:00,116 [INFO]: 	Creating the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,116 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:00
2025-03-09 07:10:00,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:10:00,119 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,119 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:10:00,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 17.16it/s] 25%|██▌       | 8/32 [00:00<00:00, 38.74it/s] 44%|████▍     | 14/32 [00:00<00:00, 46.12it/s] 62%|██████▎   | 20/32 [00:00<00:00, 49.71it/s] 81%|████████▏ | 26/32 [00:04<00:01,  3.81it/s] 97%|█████████▋| 31/32 [00:04<00:00,  5.31it/s]100%|██████████| 32/32 [00:07<00:00,  4.51it/s]
2025-03-09 07:10:07,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:07
2025-03-09 07:11:03,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7196 secs
2025-03-09 07:11:03,944 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:11:03,944 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-09 07:11:17,848 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9041 secs
2025-03-09 07:11:17,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.7315 secs
2025-03-09 07:11:17,851 [INFO]: {
2025-03-09 07:11:17,851 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:17,851 [INFO]: 	index_param: efSearch=188
2025-03-09 07:11:17,851 [INFO]: 	index_path: knn.index
2025-03-09 07:11:17,851 [INFO]: 	size in bytes: 1504108870
2025-03-09 07:11:17,851 [INFO]: 	avg_search_speed_ms: 9.24066716729495
2025-03-09 07:11:17,851 [INFO]: 	99p_search_speed_ms: 24.61316404398535
2025-03-09 07:11:17,851 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:17,851 [INFO]: 	nb vectors: 7645
2025-03-09 07:11:17,851 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:17,851 [INFO]: 	compression ratio: 0.9993080886491946
2025-03-09 07:11:17,851 [INFO]: }
2025-03-09 07:11:17,851 [INFO]: 	>>> Finished "Creating the index" in 77.7351 secs
2025-03-09 07:11:17,851 [INFO]: >>> Finished "Launching the whole pipeline" in 77.7664 secs
2025-03-09 07:11:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 62856 [episode count 2/20]
[retrieval_preprocessing] for episode 69384 [episode count 3/20], we have num_retrieval=np.int64(7526) num_query=np.int64(482)
2025-03-09 07:11:21,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:23,146 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:23
2025-03-09 07:11:23,146 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1621.93it/s]
2025-03-09 07:11:23,178 [INFO]: There are 7526 embeddings of dim 49152
2025-03-09 07:11:23,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 07:11:23,178 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:23
2025-03-09 07:11:23,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:23,178 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:11:23,178 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:23,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:11:23,178 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:23
2025-03-09 07:11:23,178 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:23,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:11:23,179 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:23
2025-03-09 07:11:23,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:23,179 [INFO]: 	Creating the index 03/09/2025, 07:11:23
2025-03-09 07:11:23,179 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:23
2025-03-09 07:11:23,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:11:23,180 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:23
2025-03-09 07:11:23,180 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:11:23,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:06,  4.42it/s] 16%|█▌        | 5/31 [00:00<00:01, 17.99it/s] 32%|███▏      | 10/31 [00:00<00:00, 28.85it/s] 48%|████▊     | 15/31 [00:00<00:00, 35.34it/s] 65%|██████▍   | 20/31 [00:00<00:00, 39.31it/s] 81%|████████  | 25/31 [00:04<00:01,  3.67it/s]100%|██████████| 31/31 [00:06<00:00,  3.14it/s]100%|██████████| 31/31 [00:06<00:00,  4.74it/s]
2025-03-09 07:11:29,723 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:29
2025-03-09 07:12:25,361 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6377 secs
2025-03-09 07:12:25,362 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:12:25,362 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-09 07:12:39,127 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7650 secs
2025-03-09 07:12:39,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9487 secs
2025-03-09 07:12:39,129 [INFO]: {
2025-03-09 07:12:39,129 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:39,129 [INFO]: 	index_param: efSearch=188
2025-03-09 07:12:39,129 [INFO]: 	index_path: knn.index
2025-03-09 07:12:39,129 [INFO]: 	size in bytes: 1480696210
2025-03-09 07:12:39,129 [INFO]: 	avg_search_speed_ms: 7.67986782427345
2025-03-09 07:12:39,129 [INFO]: 	99p_search_speed_ms: 13.400659740436828
2025-03-09 07:12:39,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:39,129 [INFO]: 	nb vectors: 7526
2025-03-09 07:12:39,129 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:39,129 [INFO]: 	compression ratio: 0.9993081619355263
2025-03-09 07:12:39,129 [INFO]: }
2025-03-09 07:12:39,129 [INFO]: 	>>> Finished "Creating the index" in 75.9505 secs
2025-03-09 07:12:39,129 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9827 secs
2025-03-09 07:12:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 69384 [episode count 3/20]
[retrieval_preprocessing] for episode 90889 [episode count 4/20], we have num_retrieval=np.int64(7620) num_query=np.int64(388)
2025-03-09 07:12:42,908 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:43,901 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:43
2025-03-09 07:12:43,901 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1773.49it/s]
2025-03-09 07:12:43,936 [INFO]: There are 7620 embeddings of dim 49152
2025-03-09 07:12:43,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 07:12:43,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:43
2025-03-09 07:12:43,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:43,937 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:12:43,937 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:43,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:12:43,937 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:43
2025-03-09 07:12:43,937 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:43,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:12:43,937 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:43
2025-03-09 07:12:43,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:43,937 [INFO]: 	Creating the index 03/09/2025, 07:12:43
2025-03-09 07:12:43,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:43
2025-03-09 07:12:43,940 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 07:12:43,940 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:43
2025-03-09 07:12:43,940 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:12:43,940 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.72it/s] 19%|█▉        | 6/31 [00:00<00:00, 27.57it/s] 35%|███▌      | 11/31 [00:00<00:00, 36.59it/s] 52%|█████▏    | 16/31 [00:00<00:00, 41.42it/s] 68%|██████▊   | 21/31 [00:04<00:02,  3.38it/s] 84%|████████▍ | 26/31 [00:04<00:00,  5.05it/s]100%|██████████| 31/31 [00:06<00:00,  3.48it/s]100%|██████████| 31/31 [00:06<00:00,  4.77it/s]
2025-03-09 07:12:50,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:50
2025-03-09 07:13:51,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1636 secs
2025-03-09 07:13:51,611 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 07:13:51,611 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-09 07:14:07,804 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1931 secs
2025-03-09 07:14:07,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.8656 secs
2025-03-09 07:14:07,806 [INFO]: {
2025-03-09 07:14:07,806 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:07,806 [INFO]: 	index_param: efSearch=325
2025-03-09 07:14:07,806 [INFO]: 	index_path: knn.index
2025-03-09 07:14:07,806 [INFO]: 	size in bytes: 1499190310
2025-03-09 07:14:07,806 [INFO]: 	avg_search_speed_ms: 12.745668197786257
2025-03-09 07:14:07,806 [INFO]: 	99p_search_speed_ms: 24.367271661758416
2025-03-09 07:14:07,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:07,806 [INFO]: 	nb vectors: 7620
2025-03-09 07:14:07,806 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:07,806 [INFO]: 	compression ratio: 0.9993080598286418
2025-03-09 07:14:07,806 [INFO]: }
2025-03-09 07:14:07,806 [INFO]: 	>>> Finished "Creating the index" in 83.8686 secs
2025-03-09 07:14:07,806 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9046 secs
2025-03-09 07:14:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 90889 [episode count 4/20]
[retrieval_preprocessing] for episode 93066 [episode count 5/20], we have num_retrieval=np.int64(7550) num_query=np.int64(458)
2025-03-09 07:14:12,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:13,837 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:13
2025-03-09 07:14:13,838 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1700.85it/s]
2025-03-09 07:14:13,865 [INFO]: There are 7550 embeddings of dim 49152
2025-03-09 07:14:13,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:14:13,866 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:13
2025-03-09 07:14:13,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:13,866 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:14:13,866 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:13,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:13,866 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:13
2025-03-09 07:14:13,866 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:13,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:13,866 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:13
2025-03-09 07:14:13,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:13,866 [INFO]: 	Creating the index 03/09/2025, 07:14:13
2025-03-09 07:14:13,866 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:13
2025-03-09 07:14:13,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:14:13,867 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:13
2025-03-09 07:14:13,867 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:14:13,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.52it/s] 19%|█▉        | 6/31 [00:00<00:00, 29.17it/s] 35%|███▌      | 11/31 [00:00<00:00, 36.62it/s] 52%|█████▏    | 16/31 [00:00<00:00, 37.50it/s] 65%|██████▍   | 20/31 [00:00<00:00, 32.24it/s] 77%|███████▋  | 24/31 [00:04<00:02,  3.25it/s] 97%|█████████▋| 30/31 [00:04<00:00,  5.30it/s]100%|██████████| 31/31 [00:06<00:00,  4.69it/s]
2025-03-09 07:14:20,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:20
2025-03-09 07:15:14,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1458 secs
2025-03-09 07:15:14,627 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 07:15:14,627 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.30it/s]
2025-03-09 07:15:28,282 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6543 secs
2025-03-09 07:15:28,283 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4160 secs
2025-03-09 07:15:28,283 [INFO]: {
2025-03-09 07:15:28,283 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:28,283 [INFO]: 	index_param: efSearch=288
2025-03-09 07:15:28,283 [INFO]: 	index_path: knn.index
2025-03-09 07:15:28,283 [INFO]: 	size in bytes: 1485418210
2025-03-09 07:15:28,284 [INFO]: 	avg_search_speed_ms: 11.977631110184921
2025-03-09 07:15:28,284 [INFO]: 	99p_search_speed_ms: 26.190303522162125
2025-03-09 07:15:28,284 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:28,284 [INFO]: 	nb vectors: 7550
2025-03-09 07:15:28,284 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:28,284 [INFO]: 	compression ratio: 0.9993080669180702
2025-03-09 07:15:28,284 [INFO]: }
2025-03-09 07:15:28,284 [INFO]: 	>>> Finished "Creating the index" in 74.4175 secs
2025-03-09 07:15:28,284 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4461 secs
2025-03-09 07:15:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 93066 [episode count 5/20]
[retrieval_preprocessing] for episode 13 [episode count 6/20], we have num_retrieval=np.int64(7579) num_query=np.int64(429)
2025-03-09 07:15:33,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:34,924 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:34
2025-03-09 07:15:34,925 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-09 07:15:34,950 [INFO]: There are 7579 embeddings of dim 49152
2025-03-09 07:15:34,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:15:34,951 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:34
2025-03-09 07:15:34,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:34,951 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:15:34,951 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:34,951 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:15:34,951 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:34
2025-03-09 07:15:34,952 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:34,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:15:34,952 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:34
2025-03-09 07:15:34,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:34,952 [INFO]: 	Creating the index 03/09/2025, 07:15:34
2025-03-09 07:15:34,952 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:34
2025-03-09 07:15:34,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:15:34,953 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:34
2025-03-09 07:15:34,953 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:15:34,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.44it/s] 16%|█▌        | 5/31 [00:00<00:01, 23.10it/s] 32%|███▏      | 10/31 [00:00<00:00, 34.06it/s] 48%|████▊     | 15/31 [00:00<00:00, 38.58it/s] 65%|██████▍   | 20/31 [00:00<00:00, 41.91it/s] 81%|████████  | 25/31 [00:04<00:01,  3.28it/s] 97%|█████████▋| 30/31 [00:04<00:00,  4.79it/s]100%|██████████| 31/31 [00:07<00:00,  4.18it/s]
2025-03-09 07:15:42,367 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:42
2025-03-09 07:16:38,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6486 secs
2025-03-09 07:16:38,016 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 07:16:38,016 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-09 07:16:52,152 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1358 secs
2025-03-09 07:16:52,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.2012 secs
2025-03-09 07:16:52,154 [INFO]: {
2025-03-09 07:16:52,154 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:52,154 [INFO]: 	index_param: efSearch=301
2025-03-09 07:16:52,154 [INFO]: 	index_path: knn.index
2025-03-09 07:16:52,154 [INFO]: 	size in bytes: 1491123730
2025-03-09 07:16:52,154 [INFO]: 	avg_search_speed_ms: 11.742975363319854
2025-03-09 07:16:52,154 [INFO]: 	99p_search_speed_ms: 24.788114624097958
2025-03-09 07:16:52,154 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:52,154 [INFO]: 	nb vectors: 7579
2025-03-09 07:16:52,154 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:52,154 [INFO]: 	compression ratio: 0.999308107047562
2025-03-09 07:16:52,154 [INFO]: }
2025-03-09 07:16:52,154 [INFO]: 	>>> Finished "Creating the index" in 77.2025 secs
2025-03-09 07:16:52,154 [INFO]: >>> Finished "Launching the whole pipeline" in 77.2298 secs
2025-03-09 07:16:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 13 [episode count 6/20]
[retrieval_preprocessing] for episode 21525 [episode count 7/20], we have num_retrieval=np.int64(7512) num_query=np.int64(496)
2025-03-09 07:16:58,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:59,862 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:59
2025-03-09 07:16:59,862 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-09 07:16:59,890 [INFO]: There are 7512 embeddings of dim 49152
2025-03-09 07:16:59,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:16:59,890 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:59
2025-03-09 07:16:59,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:59,890 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:16:59,890 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:59,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:59,890 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:59
2025-03-09 07:16:59,891 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:59,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:16:59,891 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:59
2025-03-09 07:16:59,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:59,891 [INFO]: 	Creating the index 03/09/2025, 07:16:59
2025-03-09 07:16:59,891 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:59
2025-03-09 07:16:59,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:59,892 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:59
2025-03-09 07:16:59,892 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:16:59,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.41it/s] 16%|█▌        | 5/31 [00:00<00:01, 25.14it/s] 35%|███▌      | 11/31 [00:00<00:00, 37.72it/s] 55%|█████▍    | 17/31 [00:00<00:00, 43.53it/s] 71%|███████   | 22/31 [00:04<00:02,  3.59it/s] 90%|█████████ | 28/31 [00:04<00:00,  5.60it/s]100%|██████████| 31/31 [00:06<00:00,  4.72it/s]
2025-03-09 07:17:06,460 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:06
2025-03-09 07:18:01,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0419 secs
2025-03-09 07:18:01,503 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:18:01,503 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.12it/s]
2025-03-09 07:18:19,609 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1059 secs
2025-03-09 07:18:19,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.7185 secs
2025-03-09 07:18:19,611 [INFO]: {
2025-03-09 07:18:19,611 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:19,611 [INFO]: 	index_param: efSearch=232
2025-03-09 07:18:19,611 [INFO]: 	index_path: knn.index
2025-03-09 07:18:19,611 [INFO]: 	size in bytes: 1477941850
2025-03-09 07:18:19,611 [INFO]: 	avg_search_speed_ms: 10.06846734292595
2025-03-09 07:18:19,611 [INFO]: 	99p_search_speed_ms: 25.38046849891546
2025-03-09 07:18:19,611 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:19,611 [INFO]: 	nb vectors: 7512
2025-03-09 07:18:19,611 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:19,611 [INFO]: 	compression ratio: 0.9993081229819698
2025-03-09 07:18:19,611 [INFO]: }
2025-03-09 07:18:19,611 [INFO]: 	>>> Finished "Creating the index" in 79.7199 secs
2025-03-09 07:18:19,611 [INFO]: >>> Finished "Launching the whole pipeline" in 79.7490 secs
2025-03-09 07:18:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 21525 [episode count 7/20]
[retrieval_preprocessing] for episode 62747 [episode count 8/20], we have num_retrieval=np.int64(7559) num_query=np.int64(449)
2025-03-09 07:18:27,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:28,041 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:28
2025-03-09 07:18:28,041 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1308.27it/s]
2025-03-09 07:18:28,068 [INFO]: There are 7559 embeddings of dim 49152
2025-03-09 07:18:28,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 07:18:28,069 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:28
2025-03-09 07:18:28,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:28,069 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:18:28,069 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:28,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:28,069 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:28
2025-03-09 07:18:28,069 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:28,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:18:28,069 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:28
2025-03-09 07:18:28,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:28,069 [INFO]: 	Creating the index 03/09/2025, 07:18:28
2025-03-09 07:18:28,069 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:28
2025-03-09 07:18:28,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:28,070 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:28
2025-03-09 07:18:28,070 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:18:28,071 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.22it/s] 19%|█▉        | 6/31 [00:00<00:00, 29.28it/s] 35%|███▌      | 11/31 [00:00<00:00, 36.98it/s] 52%|█████▏    | 16/31 [00:00<00:00, 39.66it/s] 68%|██████▊   | 21/31 [00:04<00:02,  3.38it/s] 84%|████████▍ | 26/31 [00:04<00:00,  5.05it/s]100%|██████████| 31/31 [00:06<00:00,  3.54it/s]100%|██████████| 31/31 [00:06<00:00,  4.82it/s]
2025-03-09 07:18:34,502 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:34
2025-03-09 07:19:35,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3629 secs
2025-03-09 07:19:35,866 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 07:19:35,866 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.42it/s]
2025-03-09 07:19:50,209 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3427 secs
2025-03-09 07:19:50,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.1398 secs
2025-03-09 07:19:50,210 [INFO]: {
2025-03-09 07:19:50,210 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:50,210 [INFO]: 	index_param: efSearch=275
2025-03-09 07:19:50,210 [INFO]: 	index_path: knn.index
2025-03-09 07:19:50,210 [INFO]: 	size in bytes: 1487188870
2025-03-09 07:19:50,210 [INFO]: 	avg_search_speed_ms: 11.5847023878989
2025-03-09 07:19:50,210 [INFO]: 	99p_search_speed_ms: 25.67641426809132
2025-03-09 07:19:50,211 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:50,211 [INFO]: 	nb vectors: 7559
2025-03-09 07:19:50,211 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:50,211 [INFO]: 	compression ratio: 0.9993080919170677
2025-03-09 07:19:50,211 [INFO]: }
2025-03-09 07:19:50,211 [INFO]: 	>>> Finished "Creating the index" in 82.1412 secs
2025-03-09 07:19:50,211 [INFO]: >>> Finished "Launching the whole pipeline" in 82.1696 secs
2025-03-09 07:19:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 62747 [episode count 8/20]
[retrieval_preprocessing] for episode 11933 [episode count 9/20], we have num_retrieval=np.int64(7660) num_query=np.int64(348)
2025-03-09 07:19:55,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:56,722 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:56
2025-03-09 07:19:56,723 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.35it/s]
2025-03-09 07:19:56,748 [INFO]: There are 7660 embeddings of dim 49152
2025-03-09 07:19:56,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:19:56,749 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:56
2025-03-09 07:19:56,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:56,749 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:19:56,749 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:56,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:56,749 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:56
2025-03-09 07:19:56,749 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:56,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:19:56,749 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:56
2025-03-09 07:19:56,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:56,749 [INFO]: 	Creating the index 03/09/2025, 07:19:56
2025-03-09 07:19:56,749 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:56
2025-03-09 07:19:56,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:19:56,751 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:56
2025-03-09 07:19:56,751 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:19:56,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.56it/s] 19%|█▉        | 6/32 [00:00<00:00, 29.25it/s] 28%|██▊       | 9/32 [00:00<00:00, 29.48it/s] 44%|████▍     | 14/32 [00:00<00:00, 36.73it/s] 59%|█████▉    | 19/32 [00:00<00:00, 41.01it/s] 75%|███████▌  | 24/32 [00:04<00:02,  3.42it/s] 88%|████████▊ | 28/32 [00:04<00:00,  4.68it/s]100%|██████████| 32/32 [00:07<00:00,  2.85it/s]100%|██████████| 32/32 [00:07<00:00,  4.54it/s]
2025-03-09 07:20:03,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:03
2025-03-09 07:21:01,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8987 secs
2025-03-09 07:21:01,698 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 07:21:01,698 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-09 07:21:17,947 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2489 secs
2025-03-09 07:21:17,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.1983 secs
2025-03-09 07:21:17,949 [INFO]: {
2025-03-09 07:21:17,949 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:17,949 [INFO]: 	index_param: efSearch=296
2025-03-09 07:21:17,949 [INFO]: 	index_path: knn.index
2025-03-09 07:21:17,949 [INFO]: 	size in bytes: 1507060030
2025-03-09 07:21:17,949 [INFO]: 	avg_search_speed_ms: 11.828180411874579
2025-03-09 07:21:17,949 [INFO]: 	99p_search_speed_ms: 29.092329554259774
2025-03-09 07:21:17,949 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:17,949 [INFO]: 	nb vectors: 7660
2025-03-09 07:21:17,949 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:17,949 [INFO]: 	compression ratio: 0.9993080899372004
2025-03-09 07:21:17,949 [INFO]: }
2025-03-09 07:21:17,949 [INFO]: 	>>> Finished "Creating the index" in 81.1998 secs
2025-03-09 07:21:17,949 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2265 secs
2025-03-09 07:21:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 11933 [episode count 9/20]
[retrieval_preprocessing] for episode 17054 [episode count 10/20], we have num_retrieval=np.int64(7680) num_query=np.int64(328)
2025-03-09 07:21:23,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:24,396 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:24
2025-03-09 07:21:24,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-09 07:21:24,422 [INFO]: There are 7680 embeddings of dim 49152
2025-03-09 07:21:24,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:21:24,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:24
2025-03-09 07:21:24,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:24,422 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:21:24,422 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:24,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:24,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:24
2025-03-09 07:21:24,422 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:24,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:21:24,422 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:24
2025-03-09 07:21:24,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:24,422 [INFO]: 	Creating the index 03/09/2025, 07:21:24
2025-03-09 07:21:24,422 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:24
2025-03-09 07:21:24,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:21:24,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:24
2025-03-09 07:21:24,424 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:21:24,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.23it/s] 19%|█▉        | 6/32 [00:00<00:01, 24.87it/s] 34%|███▍      | 11/32 [00:00<00:00, 32.90it/s] 50%|█████     | 16/32 [00:00<00:00, 37.92it/s] 66%|██████▌   | 21/32 [00:03<00:03,  3.58it/s] 84%|████████▍ | 27/32 [00:04<00:00,  5.69it/s]100%|██████████| 32/32 [00:06<00:00,  3.46it/s]100%|██████████| 32/32 [00:06<00:00,  4.81it/s]
2025-03-09 07:21:31,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:31
2025-03-09 07:22:27,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.1259 secs
2025-03-09 07:22:27,211 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 07:22:27,211 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-09 07:22:42,544 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3328 secs
2025-03-09 07:22:42,546 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1221 secs
2025-03-09 07:22:42,546 [INFO]: {
2025-03-09 07:22:42,546 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:42,546 [INFO]: 	index_param: efSearch=325
2025-03-09 07:22:42,546 [INFO]: 	index_path: knn.index
2025-03-09 07:22:42,546 [INFO]: 	size in bytes: 1510994950
2025-03-09 07:22:42,546 [INFO]: 	avg_search_speed_ms: 12.84563699551883
2025-03-09 07:22:42,546 [INFO]: 	99p_search_speed_ms: 26.040419461205612
2025-03-09 07:22:42,546 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:42,546 [INFO]: 	nb vectors: 7680
2025-03-09 07:22:42,546 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:42,546 [INFO]: 	compression ratio: 0.9993080651924084
2025-03-09 07:22:42,546 [INFO]: }
2025-03-09 07:22:42,546 [INFO]: 	>>> Finished "Creating the index" in 78.1239 secs
2025-03-09 07:22:42,546 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1498 secs
2025-03-09 07:22:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 17054 [episode count 10/20]
[retrieval_preprocessing] for episode 57373 [episode count 11/20], we have num_retrieval=np.int64(7704) num_query=np.int64(304)
2025-03-09 07:22:47,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:49,383 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:49
2025-03-09 07:22:49,383 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-09 07:22:49,412 [INFO]: There are 7704 embeddings of dim 49152
2025-03-09 07:22:49,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 07:22:49,412 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:49,413 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:22:49,413 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:49,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:22:49,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,413 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:49,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:22:49,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:49
2025-03-09 07:22:49,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:49,413 [INFO]: 	Creating the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:49
2025-03-09 07:22:49,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:22:49,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,414 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:22:49,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:05,  6.03it/s] 12%|█▎        | 4/32 [00:00<00:01, 17.07it/s] 28%|██▊       | 9/32 [00:00<00:00, 27.67it/s] 44%|████▍     | 14/32 [00:00<00:00, 32.43it/s] 56%|█████▋    | 18/32 [00:00<00:00, 31.68it/s] 69%|██████▉   | 22/32 [00:04<00:03,  2.59it/s] 84%|████████▍ | 27/32 [00:05<00:01,  4.03it/s]100%|██████████| 32/32 [00:07<00:00,  3.01it/s]100%|██████████| 32/32 [00:07<00:00,  4.26it/s]
2025-03-09 07:22:56,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:56
2025-03-09 07:23:58,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.5359 secs
2025-03-09 07:23:58,468 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:23:58,468 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.13s/it] 50%|█████     | 2/4 [00:02<00:01,  1.04it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.29it/s]
2025-03-09 07:24:17,616 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1477 secs
2025-03-09 07:24:17,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.2033 secs
2025-03-09 07:24:17,618 [INFO]: {
2025-03-09 07:24:17,618 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:17,618 [INFO]: 	index_param: efSearch=243
2025-03-09 07:24:17,618 [INFO]: 	index_path: knn.index
2025-03-09 07:24:17,618 [INFO]: 	size in bytes: 1515716830
2025-03-09 07:24:17,618 [INFO]: 	avg_search_speed_ms: 10.053562313018732
2025-03-09 07:24:17,618 [INFO]: 	99p_search_speed_ms: 27.12820228654891
2025-03-09 07:24:17,618 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:17,618 [INFO]: 	nb vectors: 7704
2025-03-09 07:24:17,618 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:17,618 [INFO]: 	compression ratio: 0.9993080514913858
2025-03-09 07:24:17,618 [INFO]: }
2025-03-09 07:24:17,618 [INFO]: 	>>> Finished "Creating the index" in 88.2048 secs
2025-03-09 07:24:17,618 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2352 secs
2025-03-09 07:24:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 57373 [episode count 11/20]
[retrieval_preprocessing] for episode 7712 [episode count 12/20], we have num_retrieval=np.int64(7654) num_query=np.int64(354)
2025-03-09 07:24:21,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:23,028 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:23
2025-03-09 07:24:23,028 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1724.63it/s]
2025-03-09 07:24:23,056 [INFO]: There are 7654 embeddings of dim 49152
2025-03-09 07:24:23,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:24:23,056 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:23
2025-03-09 07:24:23,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:23,057 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:24:23,057 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:23,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:24:23,057 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:23
2025-03-09 07:24:23,057 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:23,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:24:23,058 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:23
2025-03-09 07:24:23,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:23,058 [INFO]: 	Creating the index 03/09/2025, 07:24:23
2025-03-09 07:24:23,058 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:23
2025-03-09 07:24:23,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:24:23,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:23
2025-03-09 07:24:23,061 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:24:23,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 17.32it/s] 25%|██▌       | 8/32 [00:00<00:00, 37.85it/s] 44%|████▍     | 14/32 [00:00<00:00, 43.93it/s] 59%|█████▉    | 19/32 [00:00<00:00, 45.13it/s] 75%|███████▌  | 24/32 [00:07<00:04,  2.00it/s] 94%|█████████▍| 30/32 [00:07<00:00,  3.14it/s]100%|██████████| 32/32 [00:09<00:00,  3.30it/s]
2025-03-09 07:24:32,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:32
2025-03-09 07:25:29,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8925 secs
2025-03-09 07:25:29,667 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 07:25:29,667 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.11it/s]
2025-03-09 07:25:48,634 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9665 secs
2025-03-09 07:25:48,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5829 secs
2025-03-09 07:25:48,644 [INFO]: {
2025-03-09 07:25:48,644 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:48,644 [INFO]: 	index_param: efSearch=249
2025-03-09 07:25:48,644 [INFO]: 	index_path: knn.index
2025-03-09 07:25:48,644 [INFO]: 	size in bytes: 1505879590
2025-03-09 07:25:48,644 [INFO]: 	avg_search_speed_ms: 11.226557094058153
2025-03-09 07:25:48,644 [INFO]: 	99p_search_speed_ms: 24.29911922663451
2025-03-09 07:25:48,644 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:48,644 [INFO]: 	nb vectors: 7654
2025-03-09 07:25:48,644 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:48,644 [INFO]: 	compression ratio: 0.9993080734961021
2025-03-09 07:25:48,644 [INFO]: }
2025-03-09 07:25:48,644 [INFO]: 	>>> Finished "Creating the index" in 85.5862 secs
2025-03-09 07:25:48,644 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6163 secs
2025-03-09 07:25:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 7712 [episode count 12/20]
[retrieval_preprocessing] for episode 33315 [episode count 13/20], we have num_retrieval=np.int64(7741) num_query=np.int64(267)
2025-03-09 07:25:53,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:55,131 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:55
2025-03-09 07:25:55,131 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.94it/s]
2025-03-09 07:25:55,167 [INFO]: There are 7741 embeddings of dim 49152
2025-03-09 07:25:55,167 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 07:25:55,168 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:55
2025-03-09 07:25:55,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:55,168 [INFO]: 		-> Add: 4.3 seconds
2025-03-09 07:25:55,168 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:55,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:25:55,168 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:55
2025-03-09 07:25:55,168 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:55,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:25:55,168 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:55
2025-03-09 07:25:55,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:55,169 [INFO]: 	Creating the index 03/09/2025, 07:25:55
2025-03-09 07:25:55,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:55
2025-03-09 07:25:55,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 07:25:55,171 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:55
2025-03-09 07:25:55,171 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:25:55,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.07it/s] 19%|█▉        | 6/32 [00:00<00:00, 31.03it/s] 34%|███▍      | 11/32 [00:00<00:00, 38.29it/s] 50%|█████     | 16/32 [00:00<00:00, 41.28it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.09it/s] 81%|████████▏ | 26/32 [00:04<00:01,  4.63it/s]100%|██████████| 32/32 [00:07<00:00,  3.36it/s]100%|██████████| 32/32 [00:07<00:00,  4.50it/s]
2025-03-09 07:26:02,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:02
2025-03-09 07:27:02,544 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.2523 secs
2025-03-09 07:27:02,545 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 07:27:02,545 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.07it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-09 07:27:24,324 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7783 secs
2025-03-09 07:27:24,326 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.1546 secs
2025-03-09 07:27:24,326 [INFO]: {
2025-03-09 07:27:24,326 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:24,326 [INFO]: 	index_param: efSearch=183
2025-03-09 07:27:24,326 [INFO]: 	index_path: knn.index
2025-03-09 07:27:24,326 [INFO]: 	size in bytes: 1522996450
2025-03-09 07:27:24,326 [INFO]: 	avg_search_speed_ms: 8.419471285470545
2025-03-09 07:27:24,326 [INFO]: 	99p_search_speed_ms: 18.562676494475454
2025-03-09 07:27:24,326 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:24,326 [INFO]: 	nb vectors: 7741
2025-03-09 07:27:24,326 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:24,326 [INFO]: 	compression ratio: 0.9993079944473935
2025-03-09 07:27:24,326 [INFO]: }
2025-03-09 07:27:24,326 [INFO]: 	>>> Finished "Creating the index" in 89.1574 secs
2025-03-09 07:27:24,326 [INFO]: >>> Finished "Launching the whole pipeline" in 89.1952 secs
2025-03-09 07:27:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 33315 [episode count 13/20]
[retrieval_preprocessing] for episode 44963 [episode count 14/20], we have num_retrieval=np.int64(7633) num_query=np.int64(375)
2025-03-09 07:27:27,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:28,549 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:28
2025-03-09 07:27:28,549 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1812.58it/s]
2025-03-09 07:27:28,573 [INFO]: There are 7633 embeddings of dim 49152
2025-03-09 07:27:28,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:27:28,573 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,573 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:28,573 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:27:28,573 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:28,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:28,573 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,573 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:28,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:28,573 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:28
2025-03-09 07:27:28,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:28,574 [INFO]: 	Creating the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,574 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:28
2025-03-09 07:27:28,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:27:28,575 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,575 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:27:28,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.93it/s] 19%|█▉        | 6/32 [00:00<00:00, 26.45it/s] 34%|███▍      | 11/32 [00:00<00:00, 35.02it/s] 47%|████▋     | 15/32 [00:00<00:00, 36.05it/s] 62%|██████▎   | 20/32 [00:00<00:00, 39.61it/s] 78%|███████▊  | 25/32 [00:04<00:02,  2.94it/s] 97%|█████████▋| 31/32 [00:05<00:00,  4.63it/s]100%|██████████| 32/32 [00:07<00:00,  4.24it/s]
2025-03-09 07:27:36,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:36
2025-03-09 07:28:32,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.1096 secs
2025-03-09 07:28:32,239 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 07:28:32,239 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-09 07:28:46,784 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5447 secs
2025-03-09 07:28:46,785 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2106 secs
2025-03-09 07:28:46,785 [INFO]: {
2025-03-09 07:28:46,785 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:46,785 [INFO]: 	index_param: efSearch=204
2025-03-09 07:28:46,785 [INFO]: 	index_path: knn.index
2025-03-09 07:28:46,785 [INFO]: 	size in bytes: 1501747990
2025-03-09 07:28:46,785 [INFO]: 	avg_search_speed_ms: 8.968812983583309
2025-03-09 07:28:46,785 [INFO]: 	99p_search_speed_ms: 24.50882341712713
2025-03-09 07:28:46,785 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:46,786 [INFO]: 	nb vectors: 7633
2025-03-09 07:28:46,786 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:46,786 [INFO]: 	compression ratio: 0.9993080556745076
2025-03-09 07:28:46,786 [INFO]: }
2025-03-09 07:28:46,786 [INFO]: 	>>> Finished "Creating the index" in 78.2119 secs
2025-03-09 07:28:46,786 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2367 secs
2025-03-09 07:28:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 44963 [episode count 14/20]
[retrieval_preprocessing] for episode 18213 [episode count 15/20], we have num_retrieval=np.int64(7715) num_query=np.int64(293)
2025-03-09 07:28:51,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:52,343 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:52
2025-03-09 07:28:52,344 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-09 07:28:52,369 [INFO]: There are 7715 embeddings of dim 49152
2025-03-09 07:28:52,369 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:28:52,369 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:52
2025-03-09 07:28:52,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:52,369 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:28:52,369 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:52,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:52,370 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:52
2025-03-09 07:28:52,370 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:52,370 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:28:52,370 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:52
2025-03-09 07:28:52,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:52,370 [INFO]: 	Creating the index 03/09/2025, 07:28:52
2025-03-09 07:28:52,370 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:52
2025-03-09 07:28:52,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:28:52,371 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:52
2025-03-09 07:28:52,371 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:28:52,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  7.96it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.19it/s] 38%|███▊      | 12/32 [00:00<00:00, 38.56it/s] 56%|█████▋    | 18/32 [00:00<00:00, 43.29it/s] 72%|███████▏  | 23/32 [00:04<00:02,  3.54it/s] 91%|█████████ | 29/32 [00:04<00:00,  5.47it/s]100%|██████████| 32/32 [00:06<00:00,  4.76it/s]
2025-03-09 07:28:59,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:59
2025-03-09 07:29:59,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.1246 secs
2025-03-09 07:29:59,226 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 07:29:59,226 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-09 07:30:15,351 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1252 secs
2025-03-09 07:30:15,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9817 secs
2025-03-09 07:30:15,353 [INFO]: {
2025-03-09 07:30:15,353 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:15,353 [INFO]: 	index_param: efSearch=271
2025-03-09 07:30:15,353 [INFO]: 	index_path: knn.index
2025-03-09 07:30:15,353 [INFO]: 	size in bytes: 1517881030
2025-03-09 07:30:15,353 [INFO]: 	avg_search_speed_ms: 12.223779191980297
2025-03-09 07:30:15,353 [INFO]: 	99p_search_speed_ms: 24.04884313466029
2025-03-09 07:30:15,353 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:15,353 [INFO]: 	nb vectors: 7715
2025-03-09 07:30:15,353 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:15,353 [INFO]: 	compression ratio: 0.9993080419484524
2025-03-09 07:30:15,353 [INFO]: }
2025-03-09 07:30:15,353 [INFO]: 	>>> Finished "Creating the index" in 82.9833 secs
2025-03-09 07:30:15,353 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0097 secs
2025-03-09 07:30:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 18213 [episode count 15/20]
[retrieval_preprocessing] for episode 18469 [episode count 16/20], we have num_retrieval=np.int64(7389) num_query=np.int64(619)
2025-03-09 07:30:19,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:20,707 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:20
2025-03-09 07:30:20,707 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.09it/s]
2025-03-09 07:30:20,736 [INFO]: There are 7389 embeddings of dim 49152
2025-03-09 07:30:20,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:30:20,736 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:20
2025-03-09 07:30:20,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:20,736 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:30:20,736 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:20,736 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:20,736 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:20
2025-03-09 07:30:20,736 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:20,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:20,736 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:20
2025-03-09 07:30:20,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:20,737 [INFO]: 	Creating the index 03/09/2025, 07:30:20
2025-03-09 07:30:20,737 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:20
2025-03-09 07:30:20,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:30:20,738 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:20
2025-03-09 07:30:20,738 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:30:20,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:02<01:11,  2.37s/it]  6%|▋         | 2/31 [00:05<01:14,  2.57s/it] 10%|▉         | 3/31 [00:05<00:42,  1.52s/it] 19%|█▉        | 6/31 [00:05<00:13,  1.84it/s] 35%|███▌      | 11/31 [00:05<00:04,  4.48it/s] 48%|████▊     | 15/31 [00:05<00:02,  7.00it/s] 58%|█████▊    | 18/31 [00:06<00:02,  5.71it/s] 68%|██████▊   | 21/31 [00:11<00:05,  1.68it/s] 74%|███████▍  | 23/31 [00:13<00:05,  1.45it/s] 77%|███████▋  | 24/31 [00:14<00:05,  1.21it/s] 81%|████████  | 25/31 [00:15<00:04,  1.25it/s] 87%|████████▋ | 27/31 [00:15<00:02,  1.73it/s] 97%|█████████▋| 30/31 [00:15<00:00,  2.81it/s]100%|██████████| 31/31 [00:17<00:00,  1.73it/s]
2025-03-09 07:30:38,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:38
2025-03-09 07:31:44,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.5331 secs
2025-03-09 07:31:44,225 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 07:31:44,225 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.40it/s] 50%|█████     | 2/4 [00:01<00:01,  1.10it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.25it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it]
2025-03-09 07:32:06,955 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7301 secs
2025-03-09 07:32:06,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.2327 secs
2025-03-09 07:32:06,971 [INFO]: {
2025-03-09 07:32:06,971 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:06,971 [INFO]: 	index_param: efSearch=294
2025-03-09 07:32:06,971 [INFO]: 	index_path: knn.index
2025-03-09 07:32:06,971 [INFO]: 	size in bytes: 1453742050
2025-03-09 07:32:06,971 [INFO]: 	avg_search_speed_ms: 12.031805638793214
2025-03-09 07:32:06,971 [INFO]: 	99p_search_speed_ms: 23.999918554909538
2025-03-09 07:32:06,971 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:06,971 [INFO]: 	nb vectors: 7389
2025-03-09 07:32:06,971 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:06,971 [INFO]: 	compression ratio: 0.9993083105768317
2025-03-09 07:32:06,971 [INFO]: }
2025-03-09 07:32:06,971 [INFO]: 	>>> Finished "Creating the index" in 106.2344 secs
2025-03-09 07:32:06,971 [INFO]: >>> Finished "Launching the whole pipeline" in 106.2635 secs
2025-03-09 07:32:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 18469 [episode count 16/20]
[retrieval_preprocessing] for episode 34343 [episode count 17/20], we have num_retrieval=np.int64(7664) num_query=np.int64(344)
2025-03-09 07:32:17,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:18,728 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:18
2025-03-09 07:32:18,728 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.89it/s]
2025-03-09 07:32:18,755 [INFO]: There are 7664 embeddings of dim 49152
2025-03-09 07:32:18,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 07:32:18,755 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:18
2025-03-09 07:32:18,755 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:18,755 [INFO]: 		-> Add: 4.2 seconds
2025-03-09 07:32:18,755 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:18,755 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:18,755 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:18
2025-03-09 07:32:18,755 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:18,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:32:18,756 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:18
2025-03-09 07:32:18,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:18,756 [INFO]: 	Creating the index 03/09/2025, 07:32:18
2025-03-09 07:32:18,756 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:18
2025-03-09 07:32:18,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:32:18,757 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:18
2025-03-09 07:32:18,757 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:32:18,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 15.69it/s] 25%|██▌       | 8/32 [00:00<00:00, 37.74it/s] 44%|████▍     | 14/32 [00:00<00:00, 46.45it/s] 62%|██████▎   | 20/32 [00:00<00:00, 51.04it/s] 81%|████████▏ | 26/32 [00:04<00:01,  4.10it/s]100%|██████████| 32/32 [00:06<00:00,  3.12it/s]100%|██████████| 32/32 [00:06<00:00,  4.67it/s]
2025-03-09 07:32:25,609 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:25
2025-03-09 07:33:25,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.1726 secs
2025-03-09 07:33:25,782 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 07:33:25,782 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 07:33:55,166 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3832 secs
2025-03-09 07:33:55,168 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.4110 secs
2025-03-09 07:33:55,168 [INFO]: {
2025-03-09 07:33:55,168 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:55,168 [INFO]: 	index_param: efSearch=269
2025-03-09 07:33:55,168 [INFO]: 	index_path: knn.index
2025-03-09 07:33:55,168 [INFO]: 	size in bytes: 1507846990
2025-03-09 07:33:55,168 [INFO]: 	avg_search_speed_ms: 11.402648175931711
2025-03-09 07:33:55,168 [INFO]: 	99p_search_speed_ms: 21.417927173897624
2025-03-09 07:33:55,168 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:55,168 [INFO]: 	nb vectors: 7664
2025-03-09 07:33:55,168 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:55,168 [INFO]: 	compression ratio: 0.9993081008836314
2025-03-09 07:33:55,168 [INFO]: }
2025-03-09 07:33:55,168 [INFO]: 	>>> Finished "Creating the index" in 96.4127 secs
2025-03-09 07:33:55,168 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4399 secs
2025-03-09 07:33:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 34343 [episode count 17/20]
[retrieval_preprocessing] for episode 49832 [episode count 18/20], we have num_retrieval=np.int64(7517) num_query=np.int64(491)
2025-03-09 07:33:59,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:00,382 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:00
2025-03-09 07:34:00,382 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-09 07:34:00,409 [INFO]: There are 7517 embeddings of dim 49152
2025-03-09 07:34:00,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:34:00,409 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:00,409 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:34:00,409 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:00,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:34:00,410 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,410 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:00,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:34:00,410 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:00
2025-03-09 07:34:00,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:00,410 [INFO]: 	Creating the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,410 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:00
2025-03-09 07:34:00,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 07:34:00,411 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,411 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:34:00,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  7.98it/s] 16%|█▌        | 5/31 [00:00<00:01, 22.38it/s] 32%|███▏      | 10/31 [00:00<00:00, 31.26it/s] 48%|████▊     | 15/31 [00:00<00:00, 35.13it/s] 61%|██████▏   | 19/31 [00:00<00:00, 29.83it/s] 74%|███████▍  | 23/31 [00:05<00:03,  2.48it/s] 94%|█████████▎| 29/31 [00:05<00:00,  4.10it/s]100%|██████████| 31/31 [00:07<00:00,  4.08it/s]
2025-03-09 07:34:08,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:08
2025-03-09 07:35:12,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.0855 secs
2025-03-09 07:35:12,092 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 07:35:12,092 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.37it/s]
2025-03-09 07:35:30,692 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6005 secs
2025-03-09 07:35:30,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.2835 secs
2025-03-09 07:35:30,694 [INFO]: {
2025-03-09 07:35:30,694 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:30,694 [INFO]: 	index_param: efSearch=287
2025-03-09 07:35:30,694 [INFO]: 	index_path: knn.index
2025-03-09 07:35:30,694 [INFO]: 	size in bytes: 1478925550
2025-03-09 07:35:30,694 [INFO]: 	avg_search_speed_ms: 14.219258103614926
2025-03-09 07:35:30,694 [INFO]: 	99p_search_speed_ms: 33.576631362084306
2025-03-09 07:35:30,694 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:30,694 [INFO]: 	nb vectors: 7517
2025-03-09 07:35:30,694 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:30,694 [INFO]: 	compression ratio: 0.9993081369106105
2025-03-09 07:35:30,694 [INFO]: }
2025-03-09 07:35:30,695 [INFO]: 	>>> Finished "Creating the index" in 90.2847 secs
2025-03-09 07:35:30,695 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3124 secs
2025-03-09 07:35:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 49832 [episode count 18/20]
[retrieval_preprocessing] for episode 40490 [episode count 19/20], we have num_retrieval=np.int64(7476) num_query=np.int64(532)
2025-03-09 07:35:39,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:40,845 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:40
2025-03-09 07:35:40,846 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1284.23it/s]
2025-03-09 07:35:40,882 [INFO]: There are 7476 embeddings of dim 49152
2025-03-09 07:35:40,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 07:35:40,882 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:40
2025-03-09 07:35:40,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:40,883 [INFO]: 		-> Add: 4.1 seconds
2025-03-09 07:35:40,883 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:40,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:35:40,883 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:40
2025-03-09 07:35:40,883 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:40,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:35:40,884 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:40
2025-03-09 07:35:40,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:40,884 [INFO]: 	Creating the index 03/09/2025, 07:35:40
2025-03-09 07:35:40,884 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:40
2025-03-09 07:35:40,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:35:40,887 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:40
2025-03-09 07:35:40,887 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-09 07:35:40,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.47it/s] 19%|█▉        | 6/31 [00:00<00:00, 31.34it/s] 35%|███▌      | 11/31 [00:00<00:00, 38.15it/s] 52%|█████▏    | 16/31 [00:00<00:00, 40.05it/s] 65%|██████▍   | 20/31 [00:00<00:00, 30.16it/s] 77%|███████▋  | 24/31 [00:04<00:02,  3.20it/s] 97%|█████████▋| 30/31 [00:04<00:00,  5.22it/s]100%|██████████| 31/31 [00:06<00:00,  4.97it/s]
2025-03-09 07:35:47,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:47
2025-03-09 07:36:47,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.8873 secs
2025-03-09 07:36:47,016 [INFO]: The best hyperparameters are: efSearch=277
2025-03-09 07:36:47,016 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-09 07:37:01,154 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1378 secs
2025-03-09 07:37:01,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.2683 secs
2025-03-09 07:37:01,156 [INFO]: {
2025-03-09 07:37:01,156 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:01,156 [INFO]: 	index_param: efSearch=277
2025-03-09 07:37:01,156 [INFO]: 	index_path: knn.index
2025-03-09 07:37:01,156 [INFO]: 	size in bytes: 1470859030
2025-03-09 07:37:01,156 [INFO]: 	avg_search_speed_ms: 11.233626451249119
2025-03-09 07:37:01,156 [INFO]: 	99p_search_speed_ms: 22.992672782856975
2025-03-09 07:37:01,156 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:01,156 [INFO]: 	nb vectors: 7476
2025-03-09 07:37:01,156 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:01,156 [INFO]: 	compression ratio: 0.9993081444385599
2025-03-09 07:37:01,156 [INFO]: }
2025-03-09 07:37:01,156 [INFO]: 	>>> Finished "Creating the index" in 80.2717 secs
2025-03-09 07:37:01,156 [INFO]: >>> Finished "Launching the whole pipeline" in 80.3102 secs
2025-03-09 07:37:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 40490 [episode count 19/20]
2025-03-09 07:37:06: [retrieval_preprocessing] finished for (2515873443, 'cloth') [chosen_id count 1/10]
2025-03-09 07:37:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5235850418, 'drawer') [chosen_id count 2/10]
2025-03-09 07:37:08: [retrieval_preprocessing] we have num_total=2480 embedding_dim=49152
[retrieval_preprocessing] for episode 57354 [episode count 0/20], we have num_retrieval=np.int64(2379) num_query=np.int64(101)
2025-03-09 07:37:08,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:09,041 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:09
2025-03-09 07:37:09,041 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.99it/s]
2025-03-09 07:37:09,067 [INFO]: There are 2379 embeddings of dim 49152
2025-03-09 07:37:09,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:37:09,067 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:09
2025-03-09 07:37:09,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:09,067 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:37:09,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:09,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:09,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:09
2025-03-09 07:37:09,067 [INFO]: 491.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:09,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:37:09,068 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:09
2025-03-09 07:37:09,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:09,068 [INFO]: 	Creating the index 03/09/2025, 07:37:09
2025-03-09 07:37:09,068 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:09
2025-03-09 07:37:09,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:37:09,069 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:09
2025-03-09 07:37:09,069 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:37:09,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.78it/s] 50%|█████     | 5/10 [00:00<00:00, 24.18it/s] 90%|█████████ | 9/10 [00:00<00:00, 29.94it/s]100%|██████████| 10/10 [00:02<00:00,  4.65it/s]
2025-03-09 07:37:11,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:11
2025-03-09 07:37:50,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2590 secs
2025-03-09 07:37:50,481 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 07:37:50,481 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.62it/s]
2025-03-09 07:38:03,799 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3179 secs
2025-03-09 07:38:03,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7321 secs
2025-03-09 07:38:03,801 [INFO]: {
2025-03-09 07:38:03,801 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:03,801 [INFO]: 	index_param: efSearch=229
2025-03-09 07:38:03,801 [INFO]: 	index_path: knn.index
2025-03-09 07:38:03,801 [INFO]: 	size in bytes: 468053530
2025-03-09 07:38:03,801 [INFO]: 	avg_search_speed_ms: 10.574913329944945
2025-03-09 07:38:03,801 [INFO]: 	99p_search_speed_ms: 25.967989990022033
2025-03-09 07:38:03,801 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:03,801 [INFO]: 	nb vectors: 2379
2025-03-09 07:38:03,801 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:03,801 [INFO]: 	compression ratio: 0.999309698615028
2025-03-09 07:38:03,801 [INFO]: }
2025-03-09 07:38:03,801 [INFO]: 	>>> Finished "Creating the index" in 54.7338 secs
2025-03-09 07:38:03,801 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7608 secs
2025-03-09 07:38:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 57354 [episode count 0/20]
[retrieval_preprocessing] for episode 59403 [episode count 1/20], we have num_retrieval=np.int64(2412) num_query=np.int64(68)
2025-03-09 07:38:05,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:05,920 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:05
2025-03-09 07:38:05,920 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2146.52it/s]
2025-03-09 07:38:05,945 [INFO]: There are 2412 embeddings of dim 49152
2025-03-09 07:38:05,945 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:38:05,945 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:05
2025-03-09 07:38:05,945 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:05,945 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:38:05,945 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:05,945 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:05,945 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:05
2025-03-09 07:38:05,945 [INFO]: 497.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:05,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:05,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:05
2025-03-09 07:38:05,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:05,945 [INFO]: 	Creating the index 03/09/2025, 07:38:05
2025-03-09 07:38:05,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:05
2025-03-09 07:38:05,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:38:05,946 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:05
2025-03-09 07:38:05,947 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:38:05,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.11it/s] 60%|██████    | 6/10 [00:00<00:00, 29.67it/s]100%|██████████| 10/10 [00:02<00:00,  4.16it/s]100%|██████████| 10/10 [00:02<00:00,  4.96it/s]
2025-03-09 07:38:07,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:07
2025-03-09 07:38:39,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8686 secs
2025-03-09 07:38:39,835 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 07:38:39,835 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.14it/s]
2025-03-09 07:38:52,700 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8647 secs
2025-03-09 07:38:52,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7547 secs
2025-03-09 07:38:52,701 [INFO]: {
2025-03-09 07:38:52,701 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:52,701 [INFO]: 	index_param: efSearch=291
2025-03-09 07:38:52,701 [INFO]: 	index_path: knn.index
2025-03-09 07:38:52,701 [INFO]: 	size in bytes: 474546070
2025-03-09 07:38:52,701 [INFO]: 	avg_search_speed_ms: 11.46519241773471
2025-03-09 07:38:52,701 [INFO]: 	99p_search_speed_ms: 24.067360004410137
2025-03-09 07:38:52,701 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:52,702 [INFO]: 	nb vectors: 2412
2025-03-09 07:38:52,702 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:52,702 [INFO]: 	compression ratio: 0.9993097108569459
2025-03-09 07:38:52,702 [INFO]: }
2025-03-09 07:38:52,702 [INFO]: 	>>> Finished "Creating the index" in 46.7561 secs
2025-03-09 07:38:52,702 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7816 secs
2025-03-09 07:38:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 59403 [episode count 1/20]
[retrieval_preprocessing] for episode 73740 [episode count 2/20], we have num_retrieval=np.int64(2272) num_query=np.int64(208)
2025-03-09 07:38:53,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:54,042 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:54
2025-03-09 07:38:54,042 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2182.26it/s]
2025-03-09 07:38:54,070 [INFO]: There are 2272 embeddings of dim 49152
2025-03-09 07:38:54,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 07:38:54,071 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:54,071 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:38:54,071 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:54,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:54,071 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,071 [INFO]: 468.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:54,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:38:54,071 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:54
2025-03-09 07:38:54,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:54,071 [INFO]: 	Creating the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,071 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:54
2025-03-09 07:38:54,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:38:54,072 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,072 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:38:54,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.94it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.41it/s]100%|██████████| 9/9 [00:02<00:00,  4.05it/s]
2025-03-09 07:38:56,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:56
2025-03-09 07:39:29,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8501 secs
2025-03-09 07:39:29,151 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 07:39:29,151 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-09 07:39:40,530 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3787 secs
2025-03-09 07:39:40,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4590 secs
2025-03-09 07:39:40,531 [INFO]: {
2025-03-09 07:39:40,531 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:40,531 [INFO]: 	index_param: efSearch=301
2025-03-09 07:39:40,531 [INFO]: 	index_path: knn.index
2025-03-09 07:39:40,531 [INFO]: 	size in bytes: 447002050
2025-03-09 07:39:40,531 [INFO]: 	avg_search_speed_ms: 11.14244826287363
2025-03-09 07:39:40,531 [INFO]: 	99p_search_speed_ms: 22.98598475521429
2025-03-09 07:39:40,531 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:40,531 [INFO]: 	nb vectors: 2272
2025-03-09 07:39:40,531 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:40,531 [INFO]: 	compression ratio: 0.9993094573056208
2025-03-09 07:39:40,531 [INFO]: }
2025-03-09 07:39:40,531 [INFO]: 	>>> Finished "Creating the index" in 46.4605 secs
2025-03-09 07:39:40,531 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4890 secs
2025-03-09 07:39:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 73740 [episode count 2/20]
[retrieval_preprocessing] for episode 83978 [episode count 3/20], we have num_retrieval=np.int64(2379) num_query=np.int64(101)
2025-03-09 07:39:42,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:43,175 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:43
2025-03-09 07:39:43,175 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1633.30it/s]
2025-03-09 07:39:43,202 [INFO]: There are 2379 embeddings of dim 49152
2025-03-09 07:39:43,202 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:39:43,202 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:43
2025-03-09 07:39:43,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:43,202 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:39:43,202 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:43,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:43,202 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:43
2025-03-09 07:39:43,202 [INFO]: 491.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:43,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:39:43,202 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:43
2025-03-09 07:39:43,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:43,202 [INFO]: 	Creating the index 03/09/2025, 07:39:43
2025-03-09 07:39:43,202 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:43
2025-03-09 07:39:43,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:39:43,204 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:43
2025-03-09 07:39:43,204 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:39:43,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.71it/s] 50%|█████     | 5/10 [00:00<00:00, 24.17it/s]100%|██████████| 10/10 [00:01<00:00,  4.64it/s]100%|██████████| 10/10 [00:01<00:00,  5.31it/s]
2025-03-09 07:39:45,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:45
2025-03-09 07:40:16,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0389 secs
2025-03-09 07:40:16,129 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 07:40:16,129 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:16
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.57it/s]
2025-03-09 07:40:31,985 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8562 secs
2025-03-09 07:40:31,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7827 secs
2025-03-09 07:40:31,986 [INFO]: {
2025-03-09 07:40:31,986 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:31,986 [INFO]: 	index_param: efSearch=253
2025-03-09 07:40:31,986 [INFO]: 	index_path: knn.index
2025-03-09 07:40:31,986 [INFO]: 	size in bytes: 468053530
2025-03-09 07:40:31,987 [INFO]: 	avg_search_speed_ms: 10.033645952744418
2025-03-09 07:40:31,987 [INFO]: 	99p_search_speed_ms: 23.704906161874483
2025-03-09 07:40:31,987 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:31,987 [INFO]: 	nb vectors: 2379
2025-03-09 07:40:31,987 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:31,987 [INFO]: 	compression ratio: 0.999309698615028
2025-03-09 07:40:31,987 [INFO]: }
2025-03-09 07:40:31,987 [INFO]: 	>>> Finished "Creating the index" in 48.7842 secs
2025-03-09 07:40:31,987 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8118 secs
2025-03-09 07:40:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 83978 [episode count 3/20]
[retrieval_preprocessing] for episode 16 [episode count 4/20], we have num_retrieval=np.int64(2354) num_query=np.int64(126)
2025-03-09 07:40:33,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:34,315 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:34
2025-03-09 07:40:34,315 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-09 07:40:34,344 [INFO]: There are 2354 embeddings of dim 49152
2025-03-09 07:40:34,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 07:40:34,344 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:34
2025-03-09 07:40:34,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:34,344 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:40:34,344 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:34,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:34,344 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:34
2025-03-09 07:40:34,344 [INFO]: 485.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:34,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:40:34,345 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:34
2025-03-09 07:40:34,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:34,345 [INFO]: 	Creating the index 03/09/2025, 07:40:34
2025-03-09 07:40:34,345 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:34
2025-03-09 07:40:34,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:40:34,346 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:34
2025-03-09 07:40:34,346 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:40:34,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.89it/s] 30%|███       | 3/10 [00:00<00:00, 13.05it/s] 50%|█████     | 5/10 [00:00<00:00, 14.91it/s] 80%|████████  | 8/10 [00:00<00:00, 18.44it/s]100%|██████████| 10/10 [00:01<00:00,  3.64it/s]100%|██████████| 10/10 [00:01<00:00,  5.20it/s]
2025-03-09 07:40:36,274 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:36
2025-03-09 07:41:12,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4466 secs
2025-03-09 07:41:12,721 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 07:41:12,721 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.45it/s]
2025-03-09 07:41:25,077 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3557 secs
2025-03-09 07:41:25,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7328 secs
2025-03-09 07:41:25,079 [INFO]: {
2025-03-09 07:41:25,079 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:25,079 [INFO]: 	index_param: efSearch=244
2025-03-09 07:41:25,079 [INFO]: 	index_path: knn.index
2025-03-09 07:41:25,079 [INFO]: 	size in bytes: 463134970
2025-03-09 07:41:25,079 [INFO]: 	avg_search_speed_ms: 10.311428499264048
2025-03-09 07:41:25,079 [INFO]: 	99p_search_speed_ms: 21.572001033928228
2025-03-09 07:41:25,079 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:25,079 [INFO]: 	nb vectors: 2354
2025-03-09 07:41:25,079 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:25,079 [INFO]: 	compression ratio: 0.9993096224195724
2025-03-09 07:41:25,079 [INFO]: }
2025-03-09 07:41:25,079 [INFO]: 	>>> Finished "Creating the index" in 50.7343 secs
2025-03-09 07:41:25,079 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7636 secs
2025-03-09 07:41:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 16 [episode count 4/20]
[retrieval_preprocessing] for episode 28689 [episode count 5/20], we have num_retrieval=np.int64(2417) num_query=np.int64(63)
2025-03-09 07:41:26,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:26,847 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:26
2025-03-09 07:41:26,847 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1643.54it/s]
2025-03-09 07:41:26,878 [INFO]: There are 2417 embeddings of dim 49152
2025-03-09 07:41:26,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 07:41:26,879 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:26
2025-03-09 07:41:26,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:26,879 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:41:26,879 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:26,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:26,879 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:26
2025-03-09 07:41:26,879 [INFO]: 498.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:26,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:41:26,879 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:26
2025-03-09 07:41:26,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:26,879 [INFO]: 	Creating the index 03/09/2025, 07:41:26
2025-03-09 07:41:26,879 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:26
2025-03-09 07:41:26,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:41:26,881 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:26
2025-03-09 07:41:26,881 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:41:26,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.34it/s] 70%|███████   | 7/10 [00:00<00:00, 35.36it/s]100%|██████████| 10/10 [00:01<00:00,  5.99it/s]
2025-03-09 07:41:28,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:28
2025-03-09 07:41:59,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8013 secs
2025-03-09 07:41:59,355 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 07:41:59,355 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.28it/s]
2025-03-09 07:42:10,981 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6255 secs
2025-03-09 07:42:10,982 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1016 secs
2025-03-09 07:42:10,982 [INFO]: {
2025-03-09 07:42:10,982 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:10,982 [INFO]: 	index_param: efSearch=231
2025-03-09 07:42:10,982 [INFO]: 	index_path: knn.index
2025-03-09 07:42:10,982 [INFO]: 	size in bytes: 475529770
2025-03-09 07:42:10,982 [INFO]: 	avg_search_speed_ms: 9.169227614150298
2025-03-09 07:42:10,982 [INFO]: 	99p_search_speed_ms: 21.889093122445043
2025-03-09 07:42:10,982 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:10,982 [INFO]: 	nb vectors: 2417
2025-03-09 07:42:10,982 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:10,982 [INFO]: 	compression ratio: 0.9993097508910956
2025-03-09 07:42:10,982 [INFO]: }
2025-03-09 07:42:10,982 [INFO]: 	>>> Finished "Creating the index" in 44.1032 secs
2025-03-09 07:42:10,982 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1350 secs
2025-03-09 07:42:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 28689 [episode count 5/20]
[retrieval_preprocessing] for episode 77842 [episode count 6/20], we have num_retrieval=np.int64(2318) num_query=np.int64(162)
2025-03-09 07:42:11,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:12,133 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:12
2025-03-09 07:42:12,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.05it/s]
2025-03-09 07:42:12,161 [INFO]: There are 2318 embeddings of dim 49152
2025-03-09 07:42:12,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:42:12,161 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:12
2025-03-09 07:42:12,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:12,161 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:42:12,161 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:12,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:12,161 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:12
2025-03-09 07:42:12,161 [INFO]: 478.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:12,161 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:42:12,161 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:12
2025-03-09 07:42:12,161 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:12,161 [INFO]: 	Creating the index 03/09/2025, 07:42:12
2025-03-09 07:42:12,162 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:12
2025-03-09 07:42:12,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:42:12,163 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:12
2025-03-09 07:42:12,163 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:42:12,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.56it/s] 80%|████████  | 8/10 [00:00<00:00, 33.88it/s]100%|██████████| 10/10 [00:01<00:00,  5.99it/s]
2025-03-09 07:42:13,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:13
2025-03-09 07:42:48,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6869 secs
2025-03-09 07:42:48,522 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 07:42:48,522 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-09 07:43:00,323 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8014 secs
2025-03-09 07:43:00,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1626 secs
2025-03-09 07:43:00,325 [INFO]: {
2025-03-09 07:43:00,325 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:00,325 [INFO]: 	index_param: efSearch=255
2025-03-09 07:43:00,325 [INFO]: 	index_path: knn.index
2025-03-09 07:43:00,325 [INFO]: 	size in bytes: 456052270
2025-03-09 07:43:00,325 [INFO]: 	avg_search_speed_ms: 10.666444001824601
2025-03-09 07:43:00,325 [INFO]: 	99p_search_speed_ms: 21.974393189884722
2025-03-09 07:43:00,325 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:00,325 [INFO]: 	nb vectors: 2318
2025-03-09 07:43:00,325 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:00,325 [INFO]: 	compression ratio: 0.9993094519626007
2025-03-09 07:43:00,325 [INFO]: }
2025-03-09 07:43:00,325 [INFO]: 	>>> Finished "Creating the index" in 48.1640 secs
2025-03-09 07:43:00,326 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1920 secs
2025-03-09 07:43:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 77842 [episode count 6/20]
[retrieval_preprocessing] for episode 94234 [episode count 7/20], we have num_retrieval=np.int64(2411) num_query=np.int64(69)
2025-03-09 07:43:02,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:02,563 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:02
2025-03-09 07:43:02,563 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2052.01it/s]
2025-03-09 07:43:02,588 [INFO]: There are 2411 embeddings of dim 49152
2025-03-09 07:43:02,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:43:02,588 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,588 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:02,588 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:43:02,588 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:02,588 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:02,588 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,588 [INFO]: 497.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:02,588 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:43:02,588 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:02
2025-03-09 07:43:02,588 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:02,588 [INFO]: 	Creating the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,588 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:02
2025-03-09 07:43:02,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:43:02,590 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,590 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:43:02,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.41it/s] 70%|███████   | 7/10 [00:00<00:00, 33.25it/s]100%|██████████| 10/10 [00:01<00:00,  5.75it/s]
2025-03-09 07:43:04,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:04
2025-03-09 07:43:32,246 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9130 secs
2025-03-09 07:43:32,246 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 07:43:32,246 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.74it/s]
2025-03-09 07:43:44,623 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3771 secs
2025-03-09 07:43:44,625 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0354 secs
2025-03-09 07:43:44,625 [INFO]: {
2025-03-09 07:43:44,625 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:44,625 [INFO]: 	index_param: efSearch=308
2025-03-09 07:43:44,625 [INFO]: 	index_path: knn.index
2025-03-09 07:43:44,625 [INFO]: 	size in bytes: 474349330
2025-03-09 07:43:44,625 [INFO]: 	avg_search_speed_ms: 11.094021762436268
2025-03-09 07:43:44,625 [INFO]: 	99p_search_speed_ms: 25.83415142027662
2025-03-09 07:43:44,625 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:44,625 [INFO]: 	nb vectors: 2411
2025-03-09 07:43:44,625 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:44,625 [INFO]: 	compression ratio: 0.9993097028301906
2025-03-09 07:43:44,625 [INFO]: }
2025-03-09 07:43:44,625 [INFO]: 	>>> Finished "Creating the index" in 42.0369 secs
2025-03-09 07:43:44,625 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0625 secs
2025-03-09 07:43:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 94234 [episode count 7/20]
[retrieval_preprocessing] for episode 20511 [episode count 8/20], we have num_retrieval=np.int64(2396) num_query=np.int64(84)
2025-03-09 07:43:45,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:45,972 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:45
2025-03-09 07:43:45,972 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2261.08it/s]
2025-03-09 07:43:45,995 [INFO]: There are 2396 embeddings of dim 49152
2025-03-09 07:43:45,996 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 07:43:45,996 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:45
2025-03-09 07:43:45,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:45,996 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:43:45,996 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:45,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:45,996 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:45
2025-03-09 07:43:45,996 [INFO]: 494.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:45,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:43:45,996 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:45
2025-03-09 07:43:45,996 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:45,996 [INFO]: 	Creating the index 03/09/2025, 07:43:45
2025-03-09 07:43:45,996 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:45
2025-03-09 07:43:45,997 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:43:45,997 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:45
2025-03-09 07:43:45,997 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:43:45,997 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.51it/s] 80%|████████  | 8/10 [00:00<00:00, 40.21it/s]100%|██████████| 10/10 [00:01<00:00,  5.53it/s]
2025-03-09 07:43:47,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:47
2025-03-09 07:44:24,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6248 secs
2025-03-09 07:44:24,433 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 07:44:24,433 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 07:44:37,708 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2753 secs
2025-03-09 07:44:37,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7126 secs
2025-03-09 07:44:37,710 [INFO]: {
2025-03-09 07:44:37,710 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:37,710 [INFO]: 	index_param: efSearch=247
2025-03-09 07:44:37,710 [INFO]: 	index_path: knn.index
2025-03-09 07:44:37,710 [INFO]: 	size in bytes: 471398170
2025-03-09 07:44:37,710 [INFO]: 	avg_search_speed_ms: 9.979275625455612
2025-03-09 07:44:37,710 [INFO]: 	99p_search_speed_ms: 25.6028542178683
2025-03-09 07:44:37,710 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:37,710 [INFO]: 	nb vectors: 2396
2025-03-09 07:44:37,710 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:37,710 [INFO]: 	compression ratio: 0.9993097088179193
2025-03-09 07:44:37,710 [INFO]: }
2025-03-09 07:44:37,710 [INFO]: 	>>> Finished "Creating the index" in 51.7140 secs
2025-03-09 07:44:37,710 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7386 secs
2025-03-09 07:44:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 20511 [episode count 8/20]
[retrieval_preprocessing] for episode 55330 [episode count 9/20], we have num_retrieval=np.int64(2379) num_query=np.int64(101)
2025-03-09 07:44:38,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:39,105 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:39
2025-03-09 07:44:39,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.44it/s]
2025-03-09 07:44:39,131 [INFO]: There are 2379 embeddings of dim 49152
2025-03-09 07:44:39,131 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:44:39,131 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:39
2025-03-09 07:44:39,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:39,132 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:44:39,132 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:39,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:39,132 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:39
2025-03-09 07:44:39,132 [INFO]: 491.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:39,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:44:39,132 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:39
2025-03-09 07:44:39,132 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:39,132 [INFO]: 	Creating the index 03/09/2025, 07:44:39
2025-03-09 07:44:39,132 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:39
2025-03-09 07:44:39,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:44:39,133 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:39
2025-03-09 07:44:39,133 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:44:39,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.41it/s] 60%|██████    | 6/10 [00:00<00:00, 31.07it/s]100%|██████████| 10/10 [00:01<00:00,  4.82it/s]100%|██████████| 10/10 [00:01<00:00,  5.72it/s]
2025-03-09 07:44:40,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:40
2025-03-09 07:45:08,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5211 secs
2025-03-09 07:45:08,407 [INFO]: The best hyperparameters are: efSearch=326
2025-03-09 07:45:08,407 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-09 07:45:21,835 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4277 secs
2025-03-09 07:45:21,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7032 secs
2025-03-09 07:45:21,836 [INFO]: {
2025-03-09 07:45:21,837 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:21,837 [INFO]: 	index_param: efSearch=326
2025-03-09 07:45:21,837 [INFO]: 	index_path: knn.index
2025-03-09 07:45:21,837 [INFO]: 	size in bytes: 468053530
2025-03-09 07:45:21,837 [INFO]: 	avg_search_speed_ms: 12.429586793324962
2025-03-09 07:45:21,837 [INFO]: 	99p_search_speed_ms: 29.668584363535054
2025-03-09 07:45:21,837 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:21,837 [INFO]: 	nb vectors: 2379
2025-03-09 07:45:21,837 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:21,837 [INFO]: 	compression ratio: 0.999309698615028
2025-03-09 07:45:21,837 [INFO]: }
2025-03-09 07:45:21,837 [INFO]: 	>>> Finished "Creating the index" in 42.7047 secs
2025-03-09 07:45:21,837 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7311 secs
2025-03-09 07:45:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 55330 [episode count 9/20]
[retrieval_preprocessing] for episode 14371 [episode count 10/20], we have num_retrieval=np.int64(2399) num_query=np.int64(81)
2025-03-09 07:45:23,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:23,924 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:23
2025-03-09 07:45:23,924 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2593.88it/s]
2025-03-09 07:45:23,946 [INFO]: There are 2399 embeddings of dim 49152
2025-03-09 07:45:23,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 07:45:23,946 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:23
2025-03-09 07:45:23,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:23,946 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:45:23,946 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:23,946 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:23,946 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:23
2025-03-09 07:45:23,947 [INFO]: 495.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:23,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:45:23,947 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:23
2025-03-09 07:45:23,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:23,947 [INFO]: 	Creating the index 03/09/2025, 07:45:23
2025-03-09 07:45:23,947 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:23
2025-03-09 07:45:23,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:45:23,948 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:23
2025-03-09 07:45:23,948 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:45:23,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.73it/s] 70%|███████   | 7/10 [00:00<00:00, 32.58it/s]100%|██████████| 10/10 [00:01<00:00,  5.24it/s]
2025-03-09 07:45:25,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:25
2025-03-09 07:46:00,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9785 secs
2025-03-09 07:46:00,837 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 07:46:00,837 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.45it/s]
2025-03-09 07:46:13,920 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0822 secs
2025-03-09 07:46:13,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9734 secs
2025-03-09 07:46:13,921 [INFO]: {
2025-03-09 07:46:13,921 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:13,921 [INFO]: 	index_param: efSearch=240
2025-03-09 07:46:13,921 [INFO]: 	index_path: knn.index
2025-03-09 07:46:13,921 [INFO]: 	size in bytes: 471988390
2025-03-09 07:46:13,922 [INFO]: 	avg_search_speed_ms: 10.130212720334454
2025-03-09 07:46:13,922 [INFO]: 	99p_search_speed_ms: 19.756386461667706
2025-03-09 07:46:13,922 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:13,922 [INFO]: 	nb vectors: 2399
2025-03-09 07:46:13,922 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:13,922 [INFO]: 	compression ratio: 0.9993097330211872
2025-03-09 07:46:13,922 [INFO]: }
2025-03-09 07:46:13,922 [INFO]: 	>>> Finished "Creating the index" in 49.9747 secs
2025-03-09 07:46:13,922 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9976 secs
2025-03-09 07:46:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 14371 [episode count 10/20]
[retrieval_preprocessing] for episode 18467 [episode count 11/20], we have num_retrieval=np.int64(2334) num_query=np.int64(146)
2025-03-09 07:46:15,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:15,378 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:15
2025-03-09 07:46:15,378 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1200.77it/s]
2025-03-09 07:46:15,408 [INFO]: There are 2334 embeddings of dim 49152
2025-03-09 07:46:15,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 07:46:15,408 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:15
2025-03-09 07:46:15,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:15,408 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:46:15,408 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:15,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:15,408 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:15
2025-03-09 07:46:15,408 [INFO]: 481.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:15,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:15,408 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:15
2025-03-09 07:46:15,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:15,409 [INFO]: 	Creating the index 03/09/2025, 07:46:15
2025-03-09 07:46:15,409 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:15
2025-03-09 07:46:15,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:46:15,410 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:15
2025-03-09 07:46:15,410 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:46:15,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.97it/s] 20%|██        | 2/10 [00:00<00:01,  6.24it/s] 30%|███       | 3/10 [00:00<00:01,  6.79it/s] 40%|████      | 4/10 [00:00<00:00,  6.94it/s] 50%|█████     | 5/10 [00:00<00:00,  7.74it/s] 70%|███████   | 7/10 [00:00<00:00,  9.30it/s] 80%|████████  | 8/10 [00:00<00:00,  9.17it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.58it/s]100%|██████████| 10/10 [00:02<00:00,  1.69it/s]100%|██████████| 10/10 [00:02<00:00,  3.41it/s]
2025-03-09 07:46:18,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:18
2025-03-09 07:46:51,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3780 secs
2025-03-09 07:46:51,728 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 07:46:51,728 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-09 07:47:07,206 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4775 secs
2025-03-09 07:47:07,208 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7981 secs
2025-03-09 07:47:07,208 [INFO]: {
2025-03-09 07:47:07,208 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:07,208 [INFO]: 	index_param: efSearch=223
2025-03-09 07:47:07,208 [INFO]: 	index_path: knn.index
2025-03-09 07:47:07,208 [INFO]: 	size in bytes: 459200170
2025-03-09 07:47:07,208 [INFO]: 	avg_search_speed_ms: 10.401464661953508
2025-03-09 07:47:07,208 [INFO]: 	99p_search_speed_ms: 25.71598985232412
2025-03-09 07:47:07,208 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:07,208 [INFO]: 	nb vectors: 2334
2025-03-09 07:47:07,208 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:07,208 [INFO]: 	compression ratio: 0.9993094558305586
2025-03-09 07:47:07,208 [INFO]: }
2025-03-09 07:47:07,208 [INFO]: 	>>> Finished "Creating the index" in 51.7995 secs
2025-03-09 07:47:07,208 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8301 secs
2025-03-09 07:47:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 18467 [episode count 11/20]
[retrieval_preprocessing] for episode 90158 [episode count 12/20], we have num_retrieval=np.int64(2180) num_query=np.int64(300)
2025-03-09 07:47:08,553 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:08,852 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:08
2025-03-09 07:47:08,852 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.74it/s]
2025-03-09 07:47:08,879 [INFO]: There are 2180 embeddings of dim 49152
2025-03-09 07:47:08,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:47:08,879 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:08
2025-03-09 07:47:08,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:08,879 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:47:08,879 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:08,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:47:08,879 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:08
2025-03-09 07:47:08,879 [INFO]: 449.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:08,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:47:08,879 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:08
2025-03-09 07:47:08,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:08,879 [INFO]: 	Creating the index 03/09/2025, 07:47:08
2025-03-09 07:47:08,879 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:08
2025-03-09 07:47:08,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:47:08,880 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:08
2025-03-09 07:47:08,881 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:47:08,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.13it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.46it/s]100%|██████████| 9/9 [00:01<00:00,  5.33it/s]
2025-03-09 07:47:10,573 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:10
2025-03-09 07:47:42,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7461 secs
2025-03-09 07:47:42,319 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 07:47:42,319 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.08it/s]
2025-03-09 07:47:57,456 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1365 secs
2025-03-09 07:47:57,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5772 secs
2025-03-09 07:47:57,458 [INFO]: {
2025-03-09 07:47:57,458 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:57,458 [INFO]: 	index_param: efSearch=270
2025-03-09 07:47:57,458 [INFO]: 	index_path: knn.index
2025-03-09 07:47:57,458 [INFO]: 	size in bytes: 428901790
2025-03-09 07:47:57,458 [INFO]: 	avg_search_speed_ms: 12.434816904516417
2025-03-09 07:47:57,458 [INFO]: 	99p_search_speed_ms: 24.39540898427369
2025-03-09 07:47:57,458 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:57,458 [INFO]: 	nb vectors: 2180
2025-03-09 07:47:57,458 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:57,458 [INFO]: 	compression ratio: 0.9993090492814217
2025-03-09 07:47:57,458 [INFO]: }
2025-03-09 07:47:57,458 [INFO]: 	>>> Finished "Creating the index" in 48.5786 secs
2025-03-09 07:47:57,458 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6059 secs
2025-03-09 07:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 90158 [episode count 12/20]
[retrieval_preprocessing] for episode 94255 [episode count 13/20], we have num_retrieval=np.int64(2303) num_query=np.int64(177)
2025-03-09 07:48:00,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:01,274 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:01
2025-03-09 07:48:01,275 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2305.83it/s]
2025-03-09 07:48:01,298 [INFO]: There are 2303 embeddings of dim 49152
2025-03-09 07:48:01,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:48:01,299 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:01
2025-03-09 07:48:01,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:01,299 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:48:01,299 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:01,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:01,299 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:01
2025-03-09 07:48:01,299 [INFO]: 475.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:01,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:48:01,299 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:01
2025-03-09 07:48:01,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:01,299 [INFO]: 	Creating the index 03/09/2025, 07:48:01
2025-03-09 07:48:01,299 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:01
2025-03-09 07:48:01,300 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:48:01,300 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:01
2025-03-09 07:48:01,300 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:48:01,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.55it/s] 80%|████████  | 8/10 [00:00<00:00, 40.06it/s]100%|██████████| 10/10 [00:01<00:00,  6.28it/s]
2025-03-09 07:48:02,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:02
2025-03-09 07:48:36,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5382 secs
2025-03-09 07:48:36,436 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 07:48:36,436 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-09 07:48:49,073 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6372 secs
2025-03-09 07:48:49,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7746 secs
2025-03-09 07:48:49,075 [INFO]: {
2025-03-09 07:48:49,075 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:49,075 [INFO]: 	index_param: efSearch=299
2025-03-09 07:48:49,075 [INFO]: 	index_path: knn.index
2025-03-09 07:48:49,075 [INFO]: 	size in bytes: 453101110
2025-03-09 07:48:49,075 [INFO]: 	avg_search_speed_ms: 10.682500502826949
2025-03-09 07:48:49,075 [INFO]: 	99p_search_speed_ms: 24.29699517088011
2025-03-09 07:48:49,075 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:49,075 [INFO]: 	nb vectors: 2303
2025-03-09 07:48:49,075 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:49,075 [INFO]: 	compression ratio: 0.9993094565581621
2025-03-09 07:48:49,075 [INFO]: }
2025-03-09 07:48:49,075 [INFO]: 	>>> Finished "Creating the index" in 47.7759 secs
2025-03-09 07:48:49,075 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8005 secs
2025-03-09 07:48:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 94255 [episode count 13/20]
[retrieval_preprocessing] for episode 20529 [episode count 14/20], we have num_retrieval=np.int64(2356) num_query=np.int64(124)
2025-03-09 07:48:51,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:51,539 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:51
2025-03-09 07:48:51,539 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.57it/s]
2025-03-09 07:48:51,563 [INFO]: There are 2356 embeddings of dim 49152
2025-03-09 07:48:51,563 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 07:48:51,563 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:51
2025-03-09 07:48:51,563 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:51,563 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:48:51,563 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:51,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:51,563 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:51
2025-03-09 07:48:51,563 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:51,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:48:51,563 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:51
2025-03-09 07:48:51,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:51,563 [INFO]: 	Creating the index 03/09/2025, 07:48:51
2025-03-09 07:48:51,563 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:51
2025-03-09 07:48:51,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:48:51,564 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:51
2025-03-09 07:48:51,564 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:48:51,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.05it/s] 70%|███████   | 7/10 [00:00<00:00, 34.66it/s]100%|██████████| 10/10 [00:01<00:00,  6.11it/s]
2025-03-09 07:48:53,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:53
2025-03-09 07:49:24,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0075 secs
2025-03-09 07:49:24,212 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 07:49:24,212 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.10it/s]
2025-03-09 07:49:38,610 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3980 secs
2025-03-09 07:49:38,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0472 secs
2025-03-09 07:49:38,612 [INFO]: {
2025-03-09 07:49:38,612 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:38,612 [INFO]: 	index_param: efSearch=273
2025-03-09 07:49:38,612 [INFO]: 	index_path: knn.index
2025-03-09 07:49:38,612 [INFO]: 	size in bytes: 463528450
2025-03-09 07:49:38,612 [INFO]: 	avg_search_speed_ms: 10.306983189561318
2025-03-09 07:49:38,612 [INFO]: 	99p_search_speed_ms: 24.331073611974666
2025-03-09 07:49:38,612 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:38,612 [INFO]: 	nb vectors: 2356
2025-03-09 07:49:38,612 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:38,612 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-09 07:49:38,612 [INFO]: }
2025-03-09 07:49:38,612 [INFO]: 	>>> Finished "Creating the index" in 47.0485 secs
2025-03-09 07:49:38,612 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0730 secs
2025-03-09 07:49:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 20529 [episode count 14/20]
[retrieval_preprocessing] for episode 57393 [episode count 15/20], we have num_retrieval=np.int64(2389) num_query=np.int64(91)
2025-03-09 07:49:40,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:40,748 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:40
2025-03-09 07:49:40,748 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.04it/s]
2025-03-09 07:49:40,783 [INFO]: There are 2389 embeddings of dim 49152
2025-03-09 07:49:40,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-09 07:49:40,784 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:40
2025-03-09 07:49:40,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:40,784 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:49:40,784 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:40,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:49:40,784 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:40
2025-03-09 07:49:40,784 [INFO]: 493.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:40,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:49:40,785 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:40
2025-03-09 07:49:40,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:40,785 [INFO]: 	Creating the index 03/09/2025, 07:49:40
2025-03-09 07:49:40,785 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:40
2025-03-09 07:49:40,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 07:49:40,787 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:40
2025-03-09 07:49:40,787 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:49:40,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.22it/s] 60%|██████    | 6/10 [00:00<00:00, 31.24it/s]100%|██████████| 10/10 [00:01<00:00,  4.84it/s]100%|██████████| 10/10 [00:01<00:00,  5.75it/s]
2025-03-09 07:49:42,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:42
2025-03-09 07:50:18,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2203 secs
2025-03-09 07:50:18,750 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 07:50:18,751 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-09 07:50:32,075 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3248 secs
2025-03-09 07:50:32,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2902 secs
2025-03-09 07:50:32,077 [INFO]: {
2025-03-09 07:50:32,077 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:32,077 [INFO]: 	index_param: efSearch=286
2025-03-09 07:50:32,077 [INFO]: 	index_path: knn.index
2025-03-09 07:50:32,077 [INFO]: 	size in bytes: 470020930
2025-03-09 07:50:32,077 [INFO]: 	avg_search_speed_ms: 12.317705965713309
2025-03-09 07:50:32,077 [INFO]: 	99p_search_speed_ms: 23.911636839620755
2025-03-09 07:50:32,077 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:32,077 [INFO]: 	nb vectors: 2389
2025-03-09 07:50:32,077 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:32,077 [INFO]: 	compression ratio: 0.999309779673003
2025-03-09 07:50:32,077 [INFO]: }
2025-03-09 07:50:32,077 [INFO]: 	>>> Finished "Creating the index" in 51.2927 secs
2025-03-09 07:50:32,078 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3292 secs
2025-03-09 07:50:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 57393 [episode count 15/20]
[retrieval_preprocessing] for episode 4151 [episode count 16/20], we have num_retrieval=np.int64(2422) num_query=np.int64(58)
2025-03-09 07:50:33,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:33,545 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:33
2025-03-09 07:50:33,545 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-09 07:50:33,567 [INFO]: There are 2422 embeddings of dim 49152
2025-03-09 07:50:33,567 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-09 07:50:33,567 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,567 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:33,567 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:50:33,567 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:33,567 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:33,567 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,567 [INFO]: 499.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:33,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:50:33,568 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:33
2025-03-09 07:50:33,568 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:33,568 [INFO]: 	Creating the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,568 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:33
2025-03-09 07:50:33,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:50:33,569 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,569 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:50:33,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.64it/s] 70%|███████   | 7/10 [00:00<00:00, 37.21it/s]100%|██████████| 10/10 [00:01<00:00,  5.28it/s]
2025-03-09 07:50:35,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:35
2025-03-09 07:51:03,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3656 secs
2025-03-09 07:51:03,831 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 07:51:03,831 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.93it/s]
2025-03-09 07:51:18,650 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8188 secs
2025-03-09 07:51:18,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0835 secs
2025-03-09 07:51:18,652 [INFO]: {
2025-03-09 07:51:18,652 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:18,652 [INFO]: 	index_param: efSearch=261
2025-03-09 07:51:18,652 [INFO]: 	index_path: knn.index
2025-03-09 07:51:18,652 [INFO]: 	size in bytes: 476513470
2025-03-09 07:51:18,652 [INFO]: 	avg_search_speed_ms: 8.772669715618944
2025-03-09 07:51:18,652 [INFO]: 	99p_search_speed_ms: 12.80045360559597
2025-03-09 07:51:18,652 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:18,652 [INFO]: 	nb vectors: 2422
2025-03-09 07:51:18,652 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:18,652 [INFO]: 	compression ratio: 0.9993097907599549
2025-03-09 07:51:18,652 [INFO]: }
2025-03-09 07:51:18,652 [INFO]: 	>>> Finished "Creating the index" in 45.0847 secs
2025-03-09 07:51:18,652 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1071 secs
2025-03-09 07:51:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 4151 [episode count 16/20]
[retrieval_preprocessing] for episode 90170 [episode count 17/20], we have num_retrieval=np.int64(2375) num_query=np.int64(105)
2025-03-09 07:51:19,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:19,648 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:19
2025-03-09 07:51:19,648 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-09 07:51:19,676 [INFO]: There are 2375 embeddings of dim 49152
2025-03-09 07:51:19,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:51:19,676 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:19
2025-03-09 07:51:19,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:19,677 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:51:19,677 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:19,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:51:19,677 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:19
2025-03-09 07:51:19,677 [INFO]: 490.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:19,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:51:19,677 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:19
2025-03-09 07:51:19,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:19,677 [INFO]: 	Creating the index 03/09/2025, 07:51:19
2025-03-09 07:51:19,678 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:19
2025-03-09 07:51:19,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 07:51:19,680 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:19
2025-03-09 07:51:19,680 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:51:19,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 26.06it/s]100%|██████████| 10/10 [00:01<00:00,  6.22it/s]100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
2025-03-09 07:51:21,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:21
2025-03-09 07:51:50,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4628 secs
2025-03-09 07:51:50,648 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 07:51:50,648 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.60it/s]
2025-03-09 07:52:03,710 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0620 secs
2025-03-09 07:52:03,712 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0312 secs
2025-03-09 07:52:03,712 [INFO]: {
2025-03-09 07:52:03,712 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:03,712 [INFO]: 	index_param: efSearch=260
2025-03-09 07:52:03,712 [INFO]: 	index_path: knn.index
2025-03-09 07:52:03,712 [INFO]: 	size in bytes: 467266570
2025-03-09 07:52:03,712 [INFO]: 	avg_search_speed_ms: 10.281121785171475
2025-03-09 07:52:03,712 [INFO]: 	99p_search_speed_ms: 22.15709388256072
2025-03-09 07:52:03,712 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:03,712 [INFO]: 	nb vectors: 2375
2025-03-09 07:52:03,712 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:03,712 [INFO]: 	compression ratio: 0.9993096660007156
2025-03-09 07:52:03,712 [INFO]: }
2025-03-09 07:52:03,712 [INFO]: 	>>> Finished "Creating the index" in 44.0344 secs
2025-03-09 07:52:03,712 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0638 secs
2025-03-09 07:52:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 90170 [episode count 17/20]
[retrieval_preprocessing] for episode 4155 [episode count 18/20], we have num_retrieval=np.int64(2254) num_query=np.int64(226)
2025-03-09 07:52:04,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:05,224 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:05
2025-03-09 07:52:05,224 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2279.51it/s]
2025-03-09 07:52:05,248 [INFO]: There are 2254 embeddings of dim 49152
2025-03-09 07:52:05,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:52:05,248 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:05
2025-03-09 07:52:05,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:05,248 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:52:05,248 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:05,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:52:05,248 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:05
2025-03-09 07:52:05,249 [INFO]: 465.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:05,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:52:05,249 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:05
2025-03-09 07:52:05,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:05,249 [INFO]: 	Creating the index 03/09/2025, 07:52:05
2025-03-09 07:52:05,249 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:05
2025-03-09 07:52:05,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:52:05,250 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:05
2025-03-09 07:52:05,250 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:52:05,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.28it/s] 67%|██████▋   | 6/9 [00:00<00:00, 32.06it/s]100%|██████████| 9/9 [00:01<00:00,  5.30it/s]
2025-03-09 07:52:06,950 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:06
2025-03-09 07:52:36,670 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7196 secs
2025-03-09 07:52:36,670 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 07:52:36,670 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-09 07:52:50,300 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6293 secs
2025-03-09 07:52:50,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0514 secs
2025-03-09 07:52:50,301 [INFO]: {
2025-03-09 07:52:50,301 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:50,301 [INFO]: 	index_param: efSearch=301
2025-03-09 07:52:50,301 [INFO]: 	index_path: knn.index
2025-03-09 07:52:50,301 [INFO]: 	size in bytes: 443460670
2025-03-09 07:52:50,301 [INFO]: 	avg_search_speed_ms: 11.978391894769526
2025-03-09 07:52:50,301 [INFO]: 	99p_search_speed_ms: 27.248029033653435
2025-03-09 07:52:50,301 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:50,301 [INFO]: 	nb vectors: 2254
2025-03-09 07:52:50,301 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:50,301 [INFO]: 	compression ratio: 0.999309435941636
2025-03-09 07:52:50,301 [INFO]: }
2025-03-09 07:52:50,301 [INFO]: 	>>> Finished "Creating the index" in 45.0526 secs
2025-03-09 07:52:50,301 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0773 secs
2025-03-09 07:52:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 4155 [episode count 18/20]
[retrieval_preprocessing] for episode 10302 [episode count 19/20], we have num_retrieval=np.int64(2391) num_query=np.int64(89)
2025-03-09 07:52:53,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:53,423 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:53
2025-03-09 07:52:53,423 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.03it/s]
2025-03-09 07:52:53,459 [INFO]: There are 2391 embeddings of dim 49152
2025-03-09 07:52:53,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-09 07:52:53,459 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:53,460 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 07:52:53,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:53,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:52:53,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,460 [INFO]: 493.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:53,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:52:53,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:53
2025-03-09 07:52:53,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:53,460 [INFO]: 	Creating the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,460 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:53
2025-03-09 07:52:53,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:52:53,461 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,462 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:52:53,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.87it/s] 60%|██████    | 6/10 [00:00<00:00, 30.45it/s]100%|██████████| 10/10 [00:01<00:00,  4.45it/s]100%|██████████| 10/10 [00:01<00:00,  5.29it/s]
2025-03-09 07:52:55,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:55
2025-03-09 07:53:27,631 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2764 secs
2025-03-09 07:53:27,631 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 07:53:27,631 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-09 07:53:39,844 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2132 secs
2025-03-09 07:53:39,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3843 secs
2025-03-09 07:53:39,846 [INFO]: {
2025-03-09 07:53:39,846 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:39,846 [INFO]: 	index_param: efSearch=287
2025-03-09 07:53:39,846 [INFO]: 	index_path: knn.index
2025-03-09 07:53:39,846 [INFO]: 	size in bytes: 470414410
2025-03-09 07:53:39,846 [INFO]: 	avg_search_speed_ms: 13.12645788370507
2025-03-09 07:53:39,846 [INFO]: 	99p_search_speed_ms: 23.02945981035009
2025-03-09 07:53:39,846 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:39,846 [INFO]: 	nb vectors: 2391
2025-03-09 07:53:39,846 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:39,846 [INFO]: 	compression ratio: 0.9993097958032365
2025-03-09 07:53:39,846 [INFO]: }
2025-03-09 07:53:39,846 [INFO]: 	>>> Finished "Creating the index" in 46.3860 secs
2025-03-09 07:53:39,846 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4229 secs
2025-03-09 07:53:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 10302 [episode count 19/20]
2025-03-09 07:53:40: [retrieval_preprocessing] finished for (5235850418, 'drawer') [chosen_id count 2/10]
2025-03-09 07:53:41: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5879622450, 'block') [chosen_id count 3/10]
2025-03-09 07:53:41: [retrieval_preprocessing] we have num_total=1947 embedding_dim=49152
[retrieval_preprocessing] for episode 75275 [episode count 0/20], we have num_retrieval=np.int64(1857) num_query=np.int64(90)
2025-03-09 07:53:42,110 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:42,369 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:42
2025-03-09 07:53:42,369 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2169.84it/s]
2025-03-09 07:53:42,402 [INFO]: There are 1857 embeddings of dim 49152
2025-03-09 07:53:42,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-09 07:53:42,403 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:42
2025-03-09 07:53:42,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:42,403 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:53:42,403 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:42,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:53:42,403 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:42
2025-03-09 07:53:42,403 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:42,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:53:42,404 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:42
2025-03-09 07:53:42,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:42,404 [INFO]: 	Creating the index 03/09/2025, 07:53:42
2025-03-09 07:53:42,404 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:42
2025-03-09 07:53:42,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 07:53:42,406 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:42
2025-03-09 07:53:42,407 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:53:42,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.28it/s]100%|██████████| 8/8 [00:01<00:00,  5.57it/s]
2025-03-09 07:53:43,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:43
2025-03-09 07:54:08,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4608 secs
2025-03-09 07:54:08,309 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 07:54:08,309 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-09 07:54:21,827 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5178 secs
2025-03-09 07:54:21,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.4223 secs
2025-03-09 07:54:21,829 [INFO]: {
2025-03-09 07:54:21,829 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:21,829 [INFO]: 	index_param: efSearch=229
2025-03-09 07:54:21,829 [INFO]: 	index_path: knn.index
2025-03-09 07:54:21,829 [INFO]: 	size in bytes: 365353510
2025-03-09 07:54:21,829 [INFO]: 	avg_search_speed_ms: 10.980695995944833
2025-03-09 07:54:21,829 [INFO]: 	99p_search_speed_ms: 25.51147348713129
2025-03-09 07:54:21,829 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:21,829 [INFO]: 	nb vectors: 1857
2025-03-09 07:54:21,829 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:21,829 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-09 07:54:21,829 [INFO]: }
2025-03-09 07:54:21,829 [INFO]: 	>>> Finished "Creating the index" in 39.4253 secs
2025-03-09 07:54:21,829 [INFO]: >>> Finished "Launching the whole pipeline" in 39.4605 secs
2025-03-09 07:54:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 75275 [episode count 0/20]
[retrieval_preprocessing] for episode 23056 [episode count 1/20], we have num_retrieval=np.int64(1867) num_query=np.int64(80)
2025-03-09 07:54:23,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:23,460 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:23
2025-03-09 07:54:23,460 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.85it/s]
2025-03-09 07:54:23,484 [INFO]: There are 1867 embeddings of dim 49152
2025-03-09 07:54:23,484 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:54:23,484 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:23
2025-03-09 07:54:23,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:23,485 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:54:23,485 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:23,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:23,485 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:23
2025-03-09 07:54:23,485 [INFO]: 385.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:23,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:54:23,485 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:23
2025-03-09 07:54:23,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:23,485 [INFO]: 	Creating the index 03/09/2025, 07:54:23
2025-03-09 07:54:23,485 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:23
2025-03-09 07:54:23,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:54:23,486 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:23
2025-03-09 07:54:23,486 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:54:23,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  3.95it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.45it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.28it/s] 50%|█████     | 4/8 [00:00<00:00,  6.88it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.33it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.72it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.91it/s]100%|██████████| 8/8 [00:02<00:00,  1.76it/s]100%|██████████| 8/8 [00:02<00:00,  3.18it/s]
2025-03-09 07:54:26,006 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:26
2025-03-09 07:54:54,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8919 secs
2025-03-09 07:54:54,899 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:54:54,899 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-09 07:55:09,173 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2739 secs
2025-03-09 07:55:09,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6882 secs
2025-03-09 07:55:09,174 [INFO]: {
2025-03-09 07:55:09,174 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:09,174 [INFO]: 	index_param: efSearch=191
2025-03-09 07:55:09,174 [INFO]: 	index_path: knn.index
2025-03-09 07:55:09,174 [INFO]: 	size in bytes: 367320970
2025-03-09 07:55:09,174 [INFO]: 	avg_search_speed_ms: 9.65878066048926
2025-03-09 07:55:09,174 [INFO]: 	99p_search_speed_ms: 21.834208085201677
2025-03-09 07:55:09,174 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:09,174 [INFO]: 	nb vectors: 1867
2025-03-09 07:55:09,174 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:09,174 [INFO]: 	compression ratio: 0.9993089585928078
2025-03-09 07:55:09,174 [INFO]: }
2025-03-09 07:55:09,175 [INFO]: 	>>> Finished "Creating the index" in 45.6896 secs
2025-03-09 07:55:09,175 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7144 secs
2025-03-09 07:55:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 23056 [episode count 1/20]
[retrieval_preprocessing] for episode 64528 [episode count 2/20], we have num_retrieval=np.int64(1860) num_query=np.int64(87)
2025-03-09 07:55:09,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:10,282 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:10
2025-03-09 07:55:10,282 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1270.62it/s]
2025-03-09 07:55:10,308 [INFO]: There are 1860 embeddings of dim 49152
2025-03-09 07:55:10,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:55:10,308 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:10
2025-03-09 07:55:10,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:10,309 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:55:10,309 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:10,309 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:10,309 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:10
2025-03-09 07:55:10,309 [INFO]: 383.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:10,309 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:55:10,309 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:10
2025-03-09 07:55:10,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:10,309 [INFO]: 	Creating the index 03/09/2025, 07:55:10
2025-03-09 07:55:10,309 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:10
2025-03-09 07:55:10,310 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:55:10,310 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:10
2025-03-09 07:55:10,310 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:55:10,310 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.78it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.87it/s]100%|██████████| 8/8 [00:01<00:00,  5.81it/s]
2025-03-09 07:55:11,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:11
2025-03-09 07:55:35,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8350 secs
2025-03-09 07:55:35,526 [INFO]: The best hyperparameters are: efSearch=140
2025-03-09 07:55:35,526 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-09 07:55:49,348 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8218 secs
2025-03-09 07:55:49,349 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0386 secs
2025-03-09 07:55:49,349 [INFO]: {
2025-03-09 07:55:49,349 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:49,349 [INFO]: 	index_param: efSearch=140
2025-03-09 07:55:49,349 [INFO]: 	index_path: knn.index
2025-03-09 07:55:49,349 [INFO]: 	size in bytes: 365943790
2025-03-09 07:55:49,349 [INFO]: 	avg_search_speed_ms: 7.303718588205423
2025-03-09 07:55:49,349 [INFO]: 	99p_search_speed_ms: 14.885189691558475
2025-03-09 07:55:49,349 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:49,349 [INFO]: 	nb vectors: 1860
2025-03-09 07:55:49,349 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:49,349 [INFO]: 	compression ratio: 0.9993088829298074
2025-03-09 07:55:49,349 [INFO]: }
2025-03-09 07:55:49,349 [INFO]: 	>>> Finished "Creating the index" in 39.0401 secs
2025-03-09 07:55:49,349 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0671 secs
2025-03-09 07:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 64528 [episode count 2/20]
[retrieval_preprocessing] for episode 72720 [episode count 3/20], we have num_retrieval=np.int64(1870) num_query=np.int64(77)
2025-03-09 07:55:50,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:50,302 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:50
2025-03-09 07:55:50,302 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 07:55:50,330 [INFO]: There are 1870 embeddings of dim 49152
2025-03-09 07:55:50,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:55:50,330 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:50
2025-03-09 07:55:50,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:50,331 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:55:50,331 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:50,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:55:50,331 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:50
2025-03-09 07:55:50,331 [INFO]: 385.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:50,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:55:50,332 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:50
2025-03-09 07:55:50,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:50,332 [INFO]: 	Creating the index 03/09/2025, 07:55:50
2025-03-09 07:55:50,332 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:50
2025-03-09 07:55:50,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:55:50,335 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:50
2025-03-09 07:55:50,335 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:55:50,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.65it/s]100%|██████████| 8/8 [00:01<00:00,  4.79it/s]100%|██████████| 8/8 [00:01<00:00,  5.07it/s]
2025-03-09 07:55:51,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:51
2025-03-09 07:56:18,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2308 secs
2025-03-09 07:56:18,151 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:56:18,151 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.46it/s]
2025-03-09 07:56:30,018 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8670 secs
2025-03-09 07:56:30,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7439 secs
2025-03-09 07:56:30,079 [INFO]: {
2025-03-09 07:56:30,079 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:30,079 [INFO]: 	index_param: efSearch=232
2025-03-09 07:56:30,079 [INFO]: 	index_path: knn.index
2025-03-09 07:56:30,079 [INFO]: 	size in bytes: 367911190
2025-03-09 07:56:30,080 [INFO]: 	avg_search_speed_ms: 10.06109257119987
2025-03-09 07:56:30,080 [INFO]: 	99p_search_speed_ms: 23.41075232019648
2025-03-09 07:56:30,080 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:30,080 [INFO]: 	nb vectors: 1870
2025-03-09 07:56:30,080 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:30,080 [INFO]: 	compression ratio: 0.9993089908464051
2025-03-09 07:56:30,080 [INFO]: }
2025-03-09 07:56:30,080 [INFO]: 	>>> Finished "Creating the index" in 39.7479 secs
2025-03-09 07:56:30,080 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7776 secs
2025-03-09 07:56:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 72720 [episode count 3/20]
[retrieval_preprocessing] for episode 23 [episode count 4/20], we have num_retrieval=np.int64(1857) num_query=np.int64(90)
2025-03-09 07:56:30,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:31,187 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:31
2025-03-09 07:56:31,187 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1799.36it/s]
2025-03-09 07:56:31,212 [INFO]: There are 1857 embeddings of dim 49152
2025-03-09 07:56:31,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:56:31,212 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:31
2025-03-09 07:56:31,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:31,213 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:56:31,213 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:31,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:56:31,213 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:31
2025-03-09 07:56:31,213 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:31,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:56:31,214 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:31
2025-03-09 07:56:31,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:31,214 [INFO]: 	Creating the index 03/09/2025, 07:56:31
2025-03-09 07:56:31,214 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:31
2025-03-09 07:56:31,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:56:31,217 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:31
2025-03-09 07:56:31,217 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:56:31,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.87it/s]100%|██████████| 8/8 [00:01<00:00,  5.15it/s]100%|██████████| 8/8 [00:01<00:00,  5.66it/s]
2025-03-09 07:56:32,637 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:32
2025-03-09 07:57:01,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0274 secs
2025-03-09 07:57:01,665 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 07:57:01,665 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-09 07:57:14,042 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3769 secs
2025-03-09 07:57:14,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8263 secs
2025-03-09 07:57:14,043 [INFO]: {
2025-03-09 07:57:14,043 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:14,043 [INFO]: 	index_param: efSearch=245
2025-03-09 07:57:14,043 [INFO]: 	index_path: knn.index
2025-03-09 07:57:14,043 [INFO]: 	size in bytes: 365353510
2025-03-09 07:57:14,043 [INFO]: 	avg_search_speed_ms: 10.580243416889399
2025-03-09 07:57:14,043 [INFO]: 	99p_search_speed_ms: 26.230722134932858
2025-03-09 07:57:14,043 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:14,044 [INFO]: 	nb vectors: 1857
2025-03-09 07:57:14,044 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:14,044 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-09 07:57:14,044 [INFO]: }
2025-03-09 07:57:14,044 [INFO]: 	>>> Finished "Creating the index" in 42.8298 secs
2025-03-09 07:57:14,044 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8569 secs
2025-03-09 07:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 23 [episode count 4/20]
[retrieval_preprocessing] for episode 92700 [episode count 5/20], we have num_retrieval=np.int64(1851) num_query=np.int64(96)
2025-03-09 07:57:15,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:15,510 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:15
2025-03-09 07:57:15,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-09 07:57:15,532 [INFO]: There are 1851 embeddings of dim 49152
2025-03-09 07:57:15,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 07:57:15,532 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:15
2025-03-09 07:57:15,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:15,532 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:57:15,532 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:15,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:15,533 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:15
2025-03-09 07:57:15,533 [INFO]: 382.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:15,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:57:15,533 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:15
2025-03-09 07:57:15,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:15,533 [INFO]: 	Creating the index 03/09/2025, 07:57:15
2025-03-09 07:57:15,533 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:15
2025-03-09 07:57:15,534 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:57:15,534 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:15
2025-03-09 07:57:15,534 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:57:15,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.13it/s]100%|██████████| 8/8 [00:01<00:00,  4.40it/s]100%|██████████| 8/8 [00:01<00:00,  4.85it/s]
2025-03-09 07:57:17,185 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:17
2025-03-09 07:57:39,745 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5596 secs
2025-03-09 07:57:39,745 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 07:57:39,745 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-09 07:57:51,716 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9712 secs
2025-03-09 07:57:51,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.1841 secs
2025-03-09 07:57:51,718 [INFO]: {
2025-03-09 07:57:51,718 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:51,718 [INFO]: 	index_param: efSearch=154
2025-03-09 07:57:51,718 [INFO]: 	index_path: knn.index
2025-03-09 07:57:51,718 [INFO]: 	size in bytes: 364172950
2025-03-09 07:57:51,718 [INFO]: 	avg_search_speed_ms: 7.899600662670641
2025-03-09 07:57:51,718 [INFO]: 	99p_search_speed_ms: 17.234604165423654
2025-03-09 07:57:51,718 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:51,718 [INFO]: 	nb vectors: 1851
2025-03-09 07:57:51,718 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:51,718 [INFO]: 	compression ratio: 0.9993092787369298
2025-03-09 07:57:51,718 [INFO]: }
2025-03-09 07:57:51,718 [INFO]: 	>>> Finished "Creating the index" in 36.1854 secs
2025-03-09 07:57:51,718 [INFO]: >>> Finished "Launching the whole pipeline" in 36.2085 secs
2025-03-09 07:57:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 92700 [episode count 5/20]
[retrieval_preprocessing] for episode 57391 [episode count 6/20], we have num_retrieval=np.int64(1847) num_query=np.int64(100)
2025-03-09 07:57:52,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:52,748 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:52
2025-03-09 07:57:52,748 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1836.39it/s]
2025-03-09 07:57:52,772 [INFO]: There are 1847 embeddings of dim 49152
2025-03-09 07:57:52,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 07:57:52,773 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:52
2025-03-09 07:57:52,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:52,773 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:57:52,773 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:52,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:57:52,774 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:52
2025-03-09 07:57:52,774 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:52,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:57:52,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:52
2025-03-09 07:57:52,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:52,774 [INFO]: 	Creating the index 03/09/2025, 07:57:52
2025-03-09 07:57:52,774 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:52
2025-03-09 07:57:52,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:57:52,777 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:52
2025-03-09 07:57:52,778 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:57:52,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 19.28it/s]100%|██████████| 8/8 [00:01<00:00,  4.03it/s]100%|██████████| 8/8 [00:01<00:00,  4.41it/s]
2025-03-09 07:57:54,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:54
2025-03-09 07:58:18,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8122 secs
2025-03-09 07:58:18,408 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 07:58:18,408 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.55it/s]
2025-03-09 07:58:32,621 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2131 secs
2025-03-09 07:58:32,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8453 secs
2025-03-09 07:58:32,623 [INFO]: {
2025-03-09 07:58:32,623 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:32,623 [INFO]: 	index_param: efSearch=246
2025-03-09 07:58:32,623 [INFO]: 	index_path: knn.index
2025-03-09 07:58:32,623 [INFO]: 	size in bytes: 363385990
2025-03-09 07:58:32,623 [INFO]: 	avg_search_speed_ms: 10.8135277113399
2025-03-09 07:58:32,623 [INFO]: 	99p_search_speed_ms: 25.042371023446314
2025-03-09 07:58:32,623 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:32,623 [INFO]: 	nb vectors: 1847
2025-03-09 07:58:32,623 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:32,623 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-09 07:58:32,623 [INFO]: }
2025-03-09 07:58:32,623 [INFO]: 	>>> Finished "Creating the index" in 39.8487 secs
2025-03-09 07:58:32,623 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8747 secs
2025-03-09 07:58:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 57391 [episode count 6/20]
[retrieval_preprocessing] for episode 18992 [episode count 7/20], we have num_retrieval=np.int64(1859) num_query=np.int64(88)
2025-03-09 07:58:34,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:34,306 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:34
2025-03-09 07:58:34,306 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2116.20it/s]
2025-03-09 07:58:34,331 [INFO]: There are 1859 embeddings of dim 49152
2025-03-09 07:58:34,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:58:34,332 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:34
2025-03-09 07:58:34,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:34,332 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:58:34,332 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:34,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:58:34,332 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:34
2025-03-09 07:58:34,333 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:34,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:58:34,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:34
2025-03-09 07:58:34,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:34,333 [INFO]: 	Creating the index 03/09/2025, 07:58:34
2025-03-09 07:58:34,333 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:34
2025-03-09 07:58:34,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:58:34,336 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:34
2025-03-09 07:58:34,336 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:58:34,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.37it/s]100%|██████████| 8/8 [00:01<00:00,  5.26it/s]100%|██████████| 8/8 [00:01<00:00,  5.78it/s]
2025-03-09 07:58:35,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:35
2025-03-09 07:58:56,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0827 secs
2025-03-09 07:58:56,809 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:58:56,809 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.20it/s]
2025-03-09 07:59:09,370 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5616 secs
2025-03-09 07:59:09,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.0355 secs
2025-03-09 07:59:09,372 [INFO]: {
2025-03-09 07:59:09,372 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:09,372 [INFO]: 	index_param: efSearch=188
2025-03-09 07:59:09,372 [INFO]: 	index_path: knn.index
2025-03-09 07:59:09,372 [INFO]: 	size in bytes: 365746990
2025-03-09 07:59:09,372 [INFO]: 	avg_search_speed_ms: 8.88049033872426
2025-03-09 07:59:09,372 [INFO]: 	99p_search_speed_ms: 21.61481324583292
2025-03-09 07:59:09,372 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:09,372 [INFO]: 	nb vectors: 1859
2025-03-09 07:59:09,372 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:09,372 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-09 07:59:09,372 [INFO]: }
2025-03-09 07:59:09,372 [INFO]: 	>>> Finished "Creating the index" in 35.0388 secs
2025-03-09 07:59:09,372 [INFO]: >>> Finished "Launching the whole pipeline" in 35.0656 secs
2025-03-09 07:59:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 18992 [episode count 7/20]
[retrieval_preprocessing] for episode 28212 [episode count 8/20], we have num_retrieval=np.int64(1843) num_query=np.int64(104)
2025-03-09 07:59:10,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:10,479 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:10
2025-03-09 07:59:10,479 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1570.31it/s]
2025-03-09 07:59:10,502 [INFO]: There are 1843 embeddings of dim 49152
2025-03-09 07:59:10,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:59:10,503 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:10
2025-03-09 07:59:10,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:10,503 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 07:59:10,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:10,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:59:10,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:10
2025-03-09 07:59:10,503 [INFO]: 380.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:10,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:59:10,503 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:10
2025-03-09 07:59:10,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:10,503 [INFO]: 	Creating the index 03/09/2025, 07:59:10
2025-03-09 07:59:10,503 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:10
2025-03-09 07:59:10,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:59:10,504 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:10
2025-03-09 07:59:10,504 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 07:59:10,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.63it/s]100%|██████████| 8/8 [00:01<00:00,  5.39it/s]100%|██████████| 8/8 [00:01<00:00,  5.92it/s]
2025-03-09 07:59:11,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:11
2025-03-09 07:59:44,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3910 secs
2025-03-09 07:59:44,249 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 07:59:44,249 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-09 07:59:58,932 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6824 secs
2025-03-09 07:59:58,933 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4288 secs
2025-03-09 07:59:58,933 [INFO]: {
2025-03-09 07:59:58,933 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:58,933 [INFO]: 	index_param: efSearch=209
2025-03-09 07:59:58,933 [INFO]: 	index_path: knn.index
2025-03-09 07:59:58,934 [INFO]: 	size in bytes: 362599030
2025-03-09 07:59:58,934 [INFO]: 	avg_search_speed_ms: 10.280089842190034
2025-03-09 07:59:58,934 [INFO]: 	99p_search_speed_ms: 26.65888180024916
2025-03-09 07:59:58,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:58,934 [INFO]: 	nb vectors: 1843
2025-03-09 07:59:58,934 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:58,934 [INFO]: 	compression ratio: 0.9993091928569141
2025-03-09 07:59:58,934 [INFO]: }
2025-03-09 07:59:58,934 [INFO]: 	>>> Finished "Creating the index" in 48.4304 secs
2025-03-09 07:59:58,934 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4547 secs
2025-03-09 07:59:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 28212 [episode count 8/20]
[retrieval_preprocessing] for episode 64568 [episode count 9/20], we have num_retrieval=np.int64(1843) num_query=np.int64(104)
2025-03-09 07:59:59,839 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:01,408 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:01
2025-03-09 08:00:01,408 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2798.07it/s]
2025-03-09 08:00:01,434 [INFO]: There are 1843 embeddings of dim 49152
2025-03-09 08:00:01,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:00:01,435 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:01
2025-03-09 08:00:01,435 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:01,435 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:00:01,435 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:01,435 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:00:01,435 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:01
2025-03-09 08:00:01,435 [INFO]: 380.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:01,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:00:01,435 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:01
2025-03-09 08:00:01,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:01,435 [INFO]: 	Creating the index 03/09/2025, 08:00:01
2025-03-09 08:00:01,435 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:01
2025-03-09 08:00:01,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 08:00:01,437 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:01
2025-03-09 08:00:01,437 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:00:01,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.17it/s]100%|██████████| 8/8 [00:01<00:00,  5.32it/s]100%|██████████| 8/8 [00:01<00:00,  5.62it/s]
2025-03-09 08:00:02,864 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:02
2025-03-09 08:00:36,691 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8266 secs
2025-03-09 08:00:36,691 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 08:00:36,691 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s]
2025-03-09 08:00:49,645 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9545 secs
2025-03-09 08:00:49,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2096 secs
2025-03-09 08:00:49,647 [INFO]: {
2025-03-09 08:00:49,647 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:49,647 [INFO]: 	index_param: efSearch=224
2025-03-09 08:00:49,647 [INFO]: 	index_path: knn.index
2025-03-09 08:00:49,647 [INFO]: 	size in bytes: 362599030
2025-03-09 08:00:49,647 [INFO]: 	avg_search_speed_ms: 9.791324339094416
2025-03-09 08:00:49,647 [INFO]: 	99p_search_speed_ms: 20.598469416145235
2025-03-09 08:00:49,647 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:49,647 [INFO]: 	nb vectors: 1843
2025-03-09 08:00:49,647 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:49,647 [INFO]: 	compression ratio: 0.9993091928569141
2025-03-09 08:00:49,647 [INFO]: }
2025-03-09 08:00:49,647 [INFO]: 	>>> Finished "Creating the index" in 48.2116 secs
2025-03-09 08:00:49,647 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2393 secs
2025-03-09 08:00:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 64568 [episode count 9/20]
[retrieval_preprocessing] for episode 31289 [episode count 10/20], we have num_retrieval=np.int64(1825) num_query=np.int64(122)
2025-03-09 08:00:50,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:50,883 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:50
2025-03-09 08:00:50,883 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1862.48it/s]
2025-03-09 08:00:50,905 [INFO]: There are 1825 embeddings of dim 49152
2025-03-09 08:00:50,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 08:00:50,905 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:50
2025-03-09 08:00:50,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:50,905 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:00:50,905 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:50,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:50,905 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:50
2025-03-09 08:00:50,906 [INFO]: 376.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:50,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:50,906 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:50
2025-03-09 08:00:50,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:50,906 [INFO]: 	Creating the index 03/09/2025, 08:00:50
2025-03-09 08:00:50,906 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:50
2025-03-09 08:00:50,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:00:50,907 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:50
2025-03-09 08:00:50,907 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:00:50,907 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.24it/s] 75%|███████▌  | 6/8 [00:00<00:00, 26.69it/s]100%|██████████| 8/8 [00:01<00:00,  5.25it/s]
2025-03-09 08:00:52,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:52
2025-03-09 08:01:17,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1373 secs
2025-03-09 08:01:17,570 [INFO]: The best hyperparameters are: efSearch=303
2025-03-09 08:01:17,570 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.52it/s]
2025-03-09 08:01:34,112 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5412 secs
2025-03-09 08:01:34,113 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2061 secs
2025-03-09 08:01:34,113 [INFO]: {
2025-03-09 08:01:34,113 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:34,113 [INFO]: 	index_param: efSearch=303
2025-03-09 08:01:34,113 [INFO]: 	index_path: knn.index
2025-03-09 08:01:34,113 [INFO]: 	size in bytes: 359057710
2025-03-09 08:01:34,113 [INFO]: 	avg_search_speed_ms: 11.302339654721026
2025-03-09 08:01:34,113 [INFO]: 	99p_search_speed_ms: 26.618069857358925
2025-03-09 08:01:34,113 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:34,113 [INFO]: 	nb vectors: 1825
2025-03-09 08:01:34,113 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:34,113 [INFO]: 	compression ratio: 0.9993089968740679
2025-03-09 08:01:34,113 [INFO]: }
2025-03-09 08:01:34,113 [INFO]: 	>>> Finished "Creating the index" in 43.2073 secs
2025-03-09 08:01:34,113 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2300 secs
2025-03-09 08:01:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 31289 [episode count 10/20]
[retrieval_preprocessing] for episode 59962 [episode count 11/20], we have num_retrieval=np.int64(1833) num_query=np.int64(114)
2025-03-09 08:01:35,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:36,460 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:36
2025-03-09 08:01:36,461 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.08it/s]
2025-03-09 08:01:36,484 [INFO]: There are 1833 embeddings of dim 49152
2025-03-09 08:01:36,484 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 08:01:36,484 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:36
2025-03-09 08:01:36,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:36,484 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:01:36,484 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:36,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:36,484 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:36
2025-03-09 08:01:36,485 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:36,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:01:36,485 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:36
2025-03-09 08:01:36,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:36,485 [INFO]: 	Creating the index 03/09/2025, 08:01:36
2025-03-09 08:01:36,485 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:36
2025-03-09 08:01:36,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:01:36,486 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:36
2025-03-09 08:01:36,486 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:01:36,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.94it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.19it/s]100%|██████████| 8/8 [00:01<00:00,  5.44it/s]
2025-03-09 08:01:37,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:37
2025-03-09 08:02:11,992 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0336 secs
2025-03-09 08:02:11,992 [INFO]: The best hyperparameters are: efSearch=180
2025-03-09 08:02:11,992 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.80it/s]
2025-03-09 08:02:24,919 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9269 secs
2025-03-09 08:02:24,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4348 secs
2025-03-09 08:02:24,921 [INFO]: {
2025-03-09 08:02:24,921 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:24,921 [INFO]: 	index_param: efSearch=180
2025-03-09 08:02:24,921 [INFO]: 	index_path: knn.index
2025-03-09 08:02:24,921 [INFO]: 	size in bytes: 360631630
2025-03-09 08:02:24,921 [INFO]: 	avg_search_speed_ms: 8.520527769378315
2025-03-09 08:02:24,921 [INFO]: 	99p_search_speed_ms: 20.812942741904408
2025-03-09 08:02:24,921 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:24,921 [INFO]: 	nb vectors: 1833
2025-03-09 08:02:24,921 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:24,921 [INFO]: 	compression ratio: 0.999309084452742
2025-03-09 08:02:24,921 [INFO]: }
2025-03-09 08:02:24,921 [INFO]: 	>>> Finished "Creating the index" in 48.4361 secs
2025-03-09 08:02:24,921 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4602 secs
2025-03-09 08:02:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 59962 [episode count 11/20]
[retrieval_preprocessing] for episode 39486 [episode count 12/20], we have num_retrieval=np.int64(1868) num_query=np.int64(79)
2025-03-09 08:02:25,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:26,214 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:26
2025-03-09 08:02:26,214 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2259.86it/s]
2025-03-09 08:02:26,238 [INFO]: There are 1868 embeddings of dim 49152
2025-03-09 08:02:26,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:02:26,239 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:26
2025-03-09 08:02:26,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:26,239 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:02:26,239 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:26,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:02:26,240 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:26
2025-03-09 08:02:26,240 [INFO]: 385.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:26,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:02:26,240 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:26
2025-03-09 08:02:26,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:26,240 [INFO]: 	Creating the index 03/09/2025, 08:02:26
2025-03-09 08:02:26,241 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:26
2025-03-09 08:02:26,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:02:26,244 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:26
2025-03-09 08:02:26,244 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:02:26,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 13.06it/s] 62%|██████▎   | 5/8 [00:00<00:00, 17.46it/s]100%|██████████| 8/8 [00:01<00:00,  3.92it/s]100%|██████████| 8/8 [00:01<00:00,  4.78it/s]
2025-03-09 08:02:27,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:27
2025-03-09 08:02:55,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3092 secs
2025-03-09 08:02:55,232 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 08:02:55,232 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-09 08:03:10,285 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0525 secs
2025-03-09 08:03:10,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0421 secs
2025-03-09 08:03:10,286 [INFO]: {
2025-03-09 08:03:10,286 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:10,286 [INFO]: 	index_param: efSearch=231
2025-03-09 08:03:10,286 [INFO]: 	index_path: knn.index
2025-03-09 08:03:10,286 [INFO]: 	size in bytes: 367517710
2025-03-09 08:03:10,286 [INFO]: 	avg_search_speed_ms: 11.33874045075667
2025-03-09 08:03:10,286 [INFO]: 	99p_search_speed_ms: 22.87507390603419
2025-03-09 08:03:10,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:10,286 [INFO]: 	nb vectors: 1868
2025-03-09 08:03:10,286 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:10,286 [INFO]: 	compression ratio: 0.9993089693555176
2025-03-09 08:03:10,286 [INFO]: }
2025-03-09 08:03:10,286 [INFO]: 	>>> Finished "Creating the index" in 44.0458 secs
2025-03-09 08:03:10,286 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0725 secs
2025-03-09 08:03:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 39486 [episode count 12/20]
[retrieval_preprocessing] for episode 27714 [episode count 13/20], we have num_retrieval=np.int64(1857) num_query=np.int64(90)
2025-03-09 08:03:11,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:11,593 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:11
2025-03-09 08:03:11,593 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.99it/s]
2025-03-09 08:03:11,616 [INFO]: There are 1857 embeddings of dim 49152
2025-03-09 08:03:11,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 08:03:11,616 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:11
2025-03-09 08:03:11,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:11,616 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:03:11,616 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:11,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:11,616 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:11
2025-03-09 08:03:11,617 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:11,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:03:11,617 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:11
2025-03-09 08:03:11,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:11,617 [INFO]: 	Creating the index 03/09/2025, 08:03:11
2025-03-09 08:03:11,617 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:11
2025-03-09 08:03:11,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:03:11,618 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:11
2025-03-09 08:03:11,618 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:03:11,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.54it/s] 75%|███████▌  | 6/8 [00:00<00:00, 32.41it/s]100%|██████████| 8/8 [00:01<00:00,  5.06it/s]
2025-03-09 08:03:13,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:13
2025-03-09 08:03:39,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5542 secs
2025-03-09 08:03:39,756 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 08:03:39,756 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.66it/s]
2025-03-09 08:03:52,926 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1696 secs
2025-03-09 08:03:52,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3092 secs
2025-03-09 08:03:52,927 [INFO]: {
2025-03-09 08:03:52,927 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:52,927 [INFO]: 	index_param: efSearch=233
2025-03-09 08:03:52,927 [INFO]: 	index_path: knn.index
2025-03-09 08:03:52,927 [INFO]: 	size in bytes: 365353510
2025-03-09 08:03:52,927 [INFO]: 	avg_search_speed_ms: 9.565455199087513
2025-03-09 08:03:52,927 [INFO]: 	99p_search_speed_ms: 22.24708843277764
2025-03-09 08:03:52,927 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:52,927 [INFO]: 	nb vectors: 1857
2025-03-09 08:03:52,927 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:52,927 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-09 08:03:52,927 [INFO]: }
2025-03-09 08:03:52,927 [INFO]: 	>>> Finished "Creating the index" in 41.3104 secs
2025-03-09 08:03:52,927 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3339 secs
2025-03-09 08:03:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 27714 [episode count 13/20]
[retrieval_preprocessing] for episode 11846 [episode count 14/20], we have num_retrieval=np.int64(1861) num_query=np.int64(86)
2025-03-09 08:03:53,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:54,282 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:54
2025-03-09 08:03:54,282 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2002.05it/s]
2025-03-09 08:03:54,304 [INFO]: There are 1861 embeddings of dim 49152
2025-03-09 08:03:54,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-09 08:03:54,304 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:54
2025-03-09 08:03:54,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:54,304 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:03:54,304 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:54,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:54,304 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:54
2025-03-09 08:03:54,304 [INFO]: 384.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:54,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:03:54,304 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:54
2025-03-09 08:03:54,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:54,304 [INFO]: 	Creating the index 03/09/2025, 08:03:54
2025-03-09 08:03:54,304 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:54
2025-03-09 08:03:54,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:03:54,305 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:54
2025-03-09 08:03:54,305 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:03:54,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.73it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.96it/s]100%|██████████| 8/8 [00:01<00:00,  5.58it/s]
2025-03-09 08:03:55,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:55
2025-03-09 08:04:23,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9302 secs
2025-03-09 08:04:23,673 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 08:04:23,673 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-09 08:04:36,526 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8531 secs
2025-03-09 08:04:36,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2221 secs
2025-03-09 08:04:36,527 [INFO]: {
2025-03-09 08:04:36,527 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:36,527 [INFO]: 	index_param: efSearch=188
2025-03-09 08:04:36,527 [INFO]: 	index_path: knn.index
2025-03-09 08:04:36,527 [INFO]: 	size in bytes: 366140530
2025-03-09 08:04:36,527 [INFO]: 	avg_search_speed_ms: 9.066116615516874
2025-03-09 08:04:36,528 [INFO]: 	99p_search_speed_ms: 21.379265100695193
2025-03-09 08:04:36,528 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:36,528 [INFO]: 	nb vectors: 1861
2025-03-09 08:04:36,528 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:36,528 [INFO]: 	compression ratio: 0.9993088937736557
2025-03-09 08:04:36,528 [INFO]: }
2025-03-09 08:04:36,528 [INFO]: 	>>> Finished "Creating the index" in 42.2233 secs
2025-03-09 08:04:36,528 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2455 secs
2025-03-09 08:04:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 11846 [episode count 14/20]
[retrieval_preprocessing] for episode 81492 [episode count 15/20], we have num_retrieval=np.int64(1838) num_query=np.int64(109)
2025-03-09 08:04:37,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:37,526 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:37
2025-03-09 08:04:37,526 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1981.25it/s]
2025-03-09 08:04:37,548 [INFO]: There are 1838 embeddings of dim 49152
2025-03-09 08:04:37,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-09 08:04:37,548 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:37
2025-03-09 08:04:37,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:37,548 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:04:37,548 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:37,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:37,548 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:37
2025-03-09 08:04:37,548 [INFO]: 379.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:37,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:04:37,548 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:37
2025-03-09 08:04:37,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:37,548 [INFO]: 	Creating the index 03/09/2025, 08:04:37
2025-03-09 08:04:37,548 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:37
2025-03-09 08:04:37,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:04:37,549 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:37
2025-03-09 08:04:37,549 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:04:37,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.50it/s]100%|██████████| 8/8 [00:01<00:00,  6.34it/s]100%|██████████| 8/8 [00:01<00:00,  6.41it/s]
2025-03-09 08:04:38,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:38
2025-03-09 08:05:00,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.8525 secs
2025-03-09 08:05:00,653 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 08:05:00,653 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-09 08:05:16,816 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1630 secs
2025-03-09 08:05:16,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2684 secs
2025-03-09 08:05:16,818 [INFO]: {
2025-03-09 08:05:16,818 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:16,818 [INFO]: 	index_param: efSearch=272
2025-03-09 08:05:16,818 [INFO]: 	index_path: knn.index
2025-03-09 08:05:16,818 [INFO]: 	size in bytes: 361615330
2025-03-09 08:05:16,818 [INFO]: 	avg_search_speed_ms: 11.655313549791234
2025-03-09 08:05:16,818 [INFO]: 	99p_search_speed_ms: 25.263359167147414
2025-03-09 08:05:16,818 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:16,818 [INFO]: 	nb vectors: 1838
2025-03-09 08:05:16,818 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:16,818 [INFO]: 	compression ratio: 0.9993091388022737
2025-03-09 08:05:16,818 [INFO]: }
2025-03-09 08:05:16,818 [INFO]: 	>>> Finished "Creating the index" in 39.2695 secs
2025-03-09 08:05:16,818 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2914 secs
2025-03-09 08:05:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 81492 [episode count 15/20]
[retrieval_preprocessing] for episode 54374 [episode count 16/20], we have num_retrieval=np.int64(1847) num_query=np.int64(100)
2025-03-09 08:05:18,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:18,230 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:18
2025-03-09 08:05:18,231 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2417.47it/s]
2025-03-09 08:05:18,255 [INFO]: There are 1847 embeddings of dim 49152
2025-03-09 08:05:18,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:05:18,256 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:18
2025-03-09 08:05:18,256 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:18,256 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:05:18,256 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:18,256 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:05:18,256 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:18
2025-03-09 08:05:18,256 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:18,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:05:18,257 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:18
2025-03-09 08:05:18,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:18,257 [INFO]: 	Creating the index 03/09/2025, 08:05:18
2025-03-09 08:05:18,257 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:18
2025-03-09 08:05:18,260 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:05:18,260 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:18
2025-03-09 08:05:18,260 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:05:18,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.60it/s]100%|██████████| 8/8 [00:01<00:00,  5.34it/s]100%|██████████| 8/8 [00:01<00:00,  5.85it/s]
2025-03-09 08:05:19,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:19
2025-03-09 08:05:48,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1626 secs
2025-03-09 08:05:48,795 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:05:48,795 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.05it/s]
2025-03-09 08:06:01,464 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6682 secs
2025-03-09 08:06:01,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2049 secs
2025-03-09 08:06:01,465 [INFO]: {
2025-03-09 08:06:01,465 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:01,465 [INFO]: 	index_param: efSearch=246
2025-03-09 08:06:01,465 [INFO]: 	index_path: knn.index
2025-03-09 08:06:01,465 [INFO]: 	size in bytes: 363385990
2025-03-09 08:06:01,465 [INFO]: 	avg_search_speed_ms: 10.753641558951267
2025-03-09 08:06:01,465 [INFO]: 	99p_search_speed_ms: 26.167559020686912
2025-03-09 08:06:01,465 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:01,465 [INFO]: 	nb vectors: 1847
2025-03-09 08:06:01,465 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:01,465 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-09 08:06:01,465 [INFO]: }
2025-03-09 08:06:01,465 [INFO]: 	>>> Finished "Creating the index" in 43.2083 secs
2025-03-09 08:06:01,465 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2346 secs
2025-03-09 08:06:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 54374 [episode count 16/20]
[retrieval_preprocessing] for episode 12396 [episode count 17/20], we have num_retrieval=np.int64(1785) num_query=np.int64(162)
2025-03-09 08:06:02,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:02,940 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:02
2025-03-09 08:06:02,940 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2222.74it/s]
2025-03-09 08:06:02,966 [INFO]: There are 1785 embeddings of dim 49152
2025-03-09 08:06:02,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:06:02,967 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:02
2025-03-09 08:06:02,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:02,967 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:06:02,967 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:02,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:06:02,967 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:02
2025-03-09 08:06:02,968 [INFO]: 368.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:02,968 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:06:02,968 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:02
2025-03-09 08:06:02,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:02,968 [INFO]: 	Creating the index 03/09/2025, 08:06:02
2025-03-09 08:06:02,968 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:02
2025-03-09 08:06:02,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:06:02,971 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:02
2025-03-09 08:06:02,972 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:06:02,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.36it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.16it/s]100%|██████████| 8/8 [00:01<00:00,  4.97it/s]
2025-03-09 08:06:04,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:04
2025-03-09 08:06:33,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3681 secs
2025-03-09 08:06:33,956 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:06:33,956 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-09 08:06:47,996 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0401 secs
2025-03-09 08:06:47,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0258 secs
2025-03-09 08:06:47,997 [INFO]: {
2025-03-09 08:06:47,997 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:47,997 [INFO]: 	index_param: efSearch=236
2025-03-09 08:06:47,997 [INFO]: 	index_path: knn.index
2025-03-09 08:06:47,997 [INFO]: 	size in bytes: 351188050
2025-03-09 08:06:47,998 [INFO]: 	avg_search_speed_ms: 10.482428603233531
2025-03-09 08:06:47,998 [INFO]: 	99p_search_speed_ms: 22.694561001844708
2025-03-09 08:06:47,998 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:47,998 [INFO]: 	nb vectors: 1785
2025-03-09 08:06:47,998 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:47,998 [INFO]: 	compression ratio: 0.9993087179361598
2025-03-09 08:06:47,998 [INFO]: }
2025-03-09 08:06:47,998 [INFO]: 	>>> Finished "Creating the index" in 45.0294 secs
2025-03-09 08:06:47,998 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0572 secs
2025-03-09 08:06:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 12396 [episode count 17/20]
[retrieval_preprocessing] for episode 77934 [episode count 18/20], we have num_retrieval=np.int64(1871) num_query=np.int64(76)
2025-03-09 08:06:50,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:50,417 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:50
2025-03-09 08:06:50,417 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.75it/s]
2025-03-09 08:06:50,441 [INFO]: There are 1871 embeddings of dim 49152
2025-03-09 08:06:50,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:06:50,441 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:50,441 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:06:50,441 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:50,441 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:50,441 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,442 [INFO]: 386.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:50,442 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:06:50,442 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:50
2025-03-09 08:06:50,442 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:50,442 [INFO]: 	Creating the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,442 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:50
2025-03-09 08:06:50,443 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:06:50,443 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,443 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:06:50,443 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.25it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.56it/s]100%|██████████| 8/8 [00:01<00:00,  5.37it/s]
2025-03-09 08:06:51,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:51
2025-03-09 08:07:20,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5273 secs
2025-03-09 08:07:20,464 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:07:20,464 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.30it/s]
2025-03-09 08:07:36,560 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0964 secs
2025-03-09 08:07:36,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1186 secs
2025-03-09 08:07:36,561 [INFO]: {
2025-03-09 08:07:36,561 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:36,561 [INFO]: 	index_param: efSearch=247
2025-03-09 08:07:36,561 [INFO]: 	index_path: knn.index
2025-03-09 08:07:36,561 [INFO]: 	size in bytes: 368107990
2025-03-09 08:07:36,561 [INFO]: 	avg_search_speed_ms: 10.667217861878862
2025-03-09 08:07:36,561 [INFO]: 	99p_search_speed_ms: 25.137686000671234
2025-03-09 08:07:36,562 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:36,562 [INFO]: 	nb vectors: 1871
2025-03-09 08:07:36,562 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:36,562 [INFO]: 	compression ratio: 0.9993088386916025
2025-03-09 08:07:36,562 [INFO]: }
2025-03-09 08:07:36,562 [INFO]: 	>>> Finished "Creating the index" in 46.1199 secs
2025-03-09 08:07:36,562 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1448 secs
2025-03-09 08:07:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 77934 [episode count 18/20]
[retrieval_preprocessing] for episode 39544 [episode count 19/20], we have num_retrieval=np.int64(1854) num_query=np.int64(93)
2025-03-09 08:07:37,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:37,708 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:37
2025-03-09 08:07:37,708 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.90it/s]
2025-03-09 08:07:37,731 [INFO]: There are 1854 embeddings of dim 49152
2025-03-09 08:07:37,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 08:07:37,731 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:37
2025-03-09 08:07:37,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:37,731 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 08:07:37,731 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:37,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:37,731 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:37
2025-03-09 08:07:37,731 [INFO]: 382.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:37,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:07:37,731 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:37
2025-03-09 08:07:37,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:37,731 [INFO]: 	Creating the index 03/09/2025, 08:07:37
2025-03-09 08:07:37,731 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:37
2025-03-09 08:07:37,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:07:37,732 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:37
2025-03-09 08:07:37,732 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:07:37,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.24it/s]100%|██████████| 8/8 [00:01<00:00,  5.01it/s]100%|██████████| 8/8 [00:01<00:00,  5.29it/s]
2025-03-09 08:07:39,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:39
2025-03-09 08:08:01,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3275 secs
2025-03-09 08:08:01,576 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:08:01,576 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.86it/s]
2025-03-09 08:08:16,921 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3445 secs
2025-03-09 08:08:16,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.1898 secs
2025-03-09 08:08:16,922 [INFO]: {
2025-03-09 08:08:16,922 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:16,922 [INFO]: 	index_param: efSearch=238
2025-03-09 08:08:16,922 [INFO]: 	index_path: knn.index
2025-03-09 08:08:16,922 [INFO]: 	size in bytes: 364763230
2025-03-09 08:08:16,922 [INFO]: 	avg_search_speed_ms: 12.076260225908102
2025-03-09 08:08:16,922 [INFO]: 	99p_search_speed_ms: 24.362307398114353
2025-03-09 08:08:16,922 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:16,922 [INFO]: 	nb vectors: 1854
2025-03-09 08:08:16,922 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:16,922 [INFO]: 	compression ratio: 0.999309146374211
2025-03-09 08:08:16,922 [INFO]: }
2025-03-09 08:08:16,922 [INFO]: 	>>> Finished "Creating the index" in 39.1910 secs
2025-03-09 08:08:16,922 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2147 secs
2025-03-09 08:08:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 39544 [episode count 19/20]
2025-03-09 08:08:18: [retrieval_preprocessing] finished for (5879622450, 'block') [chosen_id count 3/10]
2025-03-09 08:08:20: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1431810548, 'lid') [chosen_id count 4/10]
2025-03-09 08:08:20: [retrieval_preprocessing] we have num_total=4372 embedding_dim=49152
[retrieval_preprocessing] for episode 93569 [episode count 0/20], we have num_retrieval=np.int64(4170) num_query=np.int64(202)
2025-03-09 08:08:21,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:22,029 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:22
2025-03-09 08:08:22,029 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1753.47it/s]
2025-03-09 08:08:22,056 [INFO]: There are 4170 embeddings of dim 49152
2025-03-09 08:08:22,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:08:22,057 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:22
2025-03-09 08:08:22,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:22,057 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:08:22,057 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:22,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:08:22,057 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:22
2025-03-09 08:08:22,057 [INFO]: 860.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:22,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:08:22,058 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:22
2025-03-09 08:08:22,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:22,058 [INFO]: 	Creating the index 03/09/2025, 08:08:22
2025-03-09 08:08:22,058 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:22
2025-03-09 08:08:22,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:08:22,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:22
2025-03-09 08:08:22,061 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:08:22,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.06it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.60it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.80it/s]100%|██████████| 17/17 [00:03<00:00,  3.92it/s]100%|██████████| 17/17 [00:03<00:00,  5.15it/s]
2025-03-09 08:08:25,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:25
2025-03-09 08:09:05,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9432 secs
2025-03-09 08:09:05,309 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 08:09:05,310 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 08:09:22,878 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5679 secs
2025-03-09 08:09:22,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8190 secs
2025-03-09 08:09:22,880 [INFO]: {
2025-03-09 08:09:22,880 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:22,880 [INFO]: 	index_param: efSearch=252
2025-03-09 08:09:22,880 [INFO]: 	index_path: knn.index
2025-03-09 08:09:22,880 [INFO]: 	size in bytes: 820422550
2025-03-09 08:09:22,880 [INFO]: 	avg_search_speed_ms: 10.267465470504069
2025-03-09 08:09:22,880 [INFO]: 	99p_search_speed_ms: 23.0752148432657
2025-03-09 08:09:22,880 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:22,880 [INFO]: 	nb vectors: 4170
2025-03-09 08:09:22,880 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:22,880 [INFO]: 	compression ratio: 0.9993086611283417
2025-03-09 08:09:22,880 [INFO]: }
2025-03-09 08:09:22,880 [INFO]: 	>>> Finished "Creating the index" in 60.8224 secs
2025-03-09 08:09:22,880 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8517 secs
2025-03-09 08:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 93569 [episode count 0/20]
[retrieval_preprocessing] for episode 33922 [episode count 1/20], we have num_retrieval=np.int64(4225) num_query=np.int64(147)
2025-03-09 08:09:25,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:26,123 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:26
2025-03-09 08:09:26,123 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1875.81it/s]
2025-03-09 08:09:26,153 [INFO]: There are 4225 embeddings of dim 49152
2025-03-09 08:09:26,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:09:26,154 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:26
2025-03-09 08:09:26,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:26,154 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:09:26,155 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:26,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:09:26,155 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:26
2025-03-09 08:09:26,155 [INFO]: 871.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:26,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:09:26,156 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:26
2025-03-09 08:09:26,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:26,156 [INFO]: 	Creating the index 03/09/2025, 08:09:26
2025-03-09 08:09:26,156 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:26
2025-03-09 08:09:26,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:09:26,159 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:26
2025-03-09 08:09:26,159 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:09:26,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.51it/s] 41%|████      | 7/17 [00:00<00:00, 34.53it/s] 71%|███████   | 12/17 [00:00<00:00, 41.06it/s]100%|██████████| 17/17 [00:03<00:00,  3.60it/s]100%|██████████| 17/17 [00:03<00:00,  5.01it/s]
2025-03-09 08:09:29,558 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:29
2025-03-09 08:10:06,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2790 secs
2025-03-09 08:10:06,837 [INFO]: The best hyperparameters are: efSearch=135
2025-03-09 08:10:06,837 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.70it/s]
2025-03-09 08:10:24,622 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7852 secs
2025-03-09 08:10:25,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1919 secs
2025-03-09 08:10:25,352 [INFO]: {
2025-03-09 08:10:25,352 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:25,352 [INFO]: 	index_param: efSearch=135
2025-03-09 08:10:25,352 [INFO]: 	index_path: knn.index
2025-03-09 08:10:25,352 [INFO]: 	size in bytes: 831243370
2025-03-09 08:10:25,352 [INFO]: 	avg_search_speed_ms: 6.380243884665795
2025-03-09 08:10:25,352 [INFO]: 	99p_search_speed_ms: 13.538691564463079
2025-03-09 08:10:25,352 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:25,352 [INFO]: 	nb vectors: 4225
2025-03-09 08:10:25,352 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:25,352 [INFO]: 	compression ratio: 0.9993087824568153
2025-03-09 08:10:25,352 [INFO]: }
2025-03-09 08:10:25,352 [INFO]: 	>>> Finished "Creating the index" in 59.1964 secs
2025-03-09 08:10:25,352 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2293 secs
2025-03-09 08:10:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 33922 [episode count 1/20]
[retrieval_preprocessing] for episode 66562 [episode count 2/20], we have num_retrieval=np.int64(4179) num_query=np.int64(193)
2025-03-09 08:10:26,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:27,011 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:27
2025-03-09 08:10:27,011 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1684.46it/s]
2025-03-09 08:10:27,038 [INFO]: There are 4179 embeddings of dim 49152
2025-03-09 08:10:27,039 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 08:10:27,039 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:27
2025-03-09 08:10:27,039 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:27,039 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:10:27,039 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:27,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:10:27,039 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:27
2025-03-09 08:10:27,040 [INFO]: 862.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:27,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:10:27,040 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:27
2025-03-09 08:10:27,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:27,040 [INFO]: 	Creating the index 03/09/2025, 08:10:27
2025-03-09 08:10:27,040 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:27
2025-03-09 08:10:27,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:10:27,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:27
2025-03-09 08:10:27,043 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:10:27,044 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.32it/s] 41%|████      | 7/17 [00:00<00:00, 35.73it/s] 71%|███████   | 12/17 [00:00<00:00, 41.44it/s]100%|██████████| 17/17 [00:03<00:00,  3.98it/s]100%|██████████| 17/17 [00:03<00:00,  5.53it/s]
2025-03-09 08:10:30,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:30
2025-03-09 08:11:08,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3729 secs
2025-03-09 08:11:08,499 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 08:11:08,499 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.59it/s]
2025-03-09 08:11:26,962 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4637 secs
2025-03-09 08:11:27,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2855 secs
2025-03-09 08:11:27,329 [INFO]: {
2025-03-09 08:11:27,329 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:27,329 [INFO]: 	index_param: efSearch=195
2025-03-09 08:11:27,329 [INFO]: 	index_path: knn.index
2025-03-09 08:11:27,329 [INFO]: 	size in bytes: 822193210
2025-03-09 08:11:27,329 [INFO]: 	avg_search_speed_ms: 8.630027136917292
2025-03-09 08:11:27,329 [INFO]: 	99p_search_speed_ms: 20.10863943491133
2025-03-09 08:11:27,330 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:27,330 [INFO]: 	nb vectors: 4179
2025-03-09 08:11:27,330 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:27,330 [INFO]: 	compression ratio: 0.9993087050670243
2025-03-09 08:11:27,330 [INFO]: }
2025-03-09 08:11:27,330 [INFO]: 	>>> Finished "Creating the index" in 60.2895 secs
2025-03-09 08:11:27,330 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3184 secs
2025-03-09 08:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 66562 [episode count 2/20]
[retrieval_preprocessing] for episode 90116 [episode count 3/20], we have num_retrieval=np.int64(4177) num_query=np.int64(195)
2025-03-09 08:11:29,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:29,636 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:29
2025-03-09 08:11:29,636 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.57it/s]
2025-03-09 08:11:29,659 [INFO]: There are 4177 embeddings of dim 49152
2025-03-09 08:11:29,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 08:11:29,659 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:29
2025-03-09 08:11:29,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:29,659 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:11:29,659 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:29,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:29,659 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:29
2025-03-09 08:11:29,659 [INFO]: 862.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:29,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:11:29,659 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:29
2025-03-09 08:11:29,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:29,660 [INFO]: 	Creating the index 03/09/2025, 08:11:29
2025-03-09 08:11:29,660 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:29
2025-03-09 08:11:29,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:11:29,661 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:29
2025-03-09 08:11:29,661 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:11:29,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.38it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.16it/s] 65%|██████▍   | 11/17 [00:00<00:00, 37.92it/s] 94%|█████████▍| 16/17 [00:00<00:00, 41.73it/s]100%|██████████| 17/17 [00:03<00:00,  5.18it/s]
2025-03-09 08:11:32,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:32
2025-03-09 08:12:15,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0630 secs
2025-03-09 08:12:15,012 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:12:15,012 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-09 08:12:29,510 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4983 secs
2025-03-09 08:12:29,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8517 secs
2025-03-09 08:12:29,513 [INFO]: {
2025-03-09 08:12:29,513 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:29,513 [INFO]: 	index_param: efSearch=226
2025-03-09 08:12:29,513 [INFO]: 	index_path: knn.index
2025-03-09 08:12:29,513 [INFO]: 	size in bytes: 821799730
2025-03-09 08:12:29,513 [INFO]: 	avg_search_speed_ms: 9.386650379878201
2025-03-09 08:12:29,513 [INFO]: 	99p_search_speed_ms: 18.74602980678901
2025-03-09 08:12:29,513 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:29,513 [INFO]: 	nb vectors: 4177
2025-03-09 08:12:29,513 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:29,513 [INFO]: 	compression ratio: 0.9993086953192355
2025-03-09 08:12:29,513 [INFO]: }
2025-03-09 08:12:29,513 [INFO]: 	>>> Finished "Creating the index" in 59.8531 secs
2025-03-09 08:12:29,513 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8767 secs
2025-03-09 08:12:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 90116 [episode count 3/20]
[retrieval_preprocessing] for episode 60681 [episode count 4/20], we have num_retrieval=np.int64(4132) num_query=np.int64(240)
2025-03-09 08:12:31,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:31,843 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:31
2025-03-09 08:12:31,843 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.68it/s]
2025-03-09 08:12:31,867 [INFO]: There are 4132 embeddings of dim 49152
2025-03-09 08:12:31,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:12:31,868 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:31
2025-03-09 08:12:31,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:31,868 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:12:31,868 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:31,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:31,868 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:31
2025-03-09 08:12:31,868 [INFO]: 852.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:31,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:12:31,868 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:31
2025-03-09 08:12:31,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:31,868 [INFO]: 	Creating the index 03/09/2025, 08:12:31
2025-03-09 08:12:31,868 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:31
2025-03-09 08:12:31,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:12:31,869 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:31
2025-03-09 08:12:31,869 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:12:31,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.64it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.12it/s] 65%|██████▍   | 11/17 [00:00<00:00, 37.55it/s] 94%|█████████▍| 16/17 [00:00<00:00, 41.76it/s]100%|██████████| 17/17 [00:03<00:00,  5.37it/s]
2025-03-09 08:12:35,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:35
2025-03-09 08:13:13,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0091 secs
2025-03-09 08:13:13,046 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:13:13,046 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.63it/s]
2025-03-09 08:13:27,497 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4510 secs
2025-03-09 08:13:27,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6305 secs
2025-03-09 08:13:27,500 [INFO]: {
2025-03-09 08:13:27,500 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:27,500 [INFO]: 	index_param: efSearch=215
2025-03-09 08:13:27,500 [INFO]: 	index_path: knn.index
2025-03-09 08:13:27,500 [INFO]: 	size in bytes: 812946310
2025-03-09 08:13:27,500 [INFO]: 	avg_search_speed_ms: 9.775126395011476
2025-03-09 08:13:27,500 [INFO]: 	99p_search_speed_ms: 18.92352669034153
2025-03-09 08:13:27,500 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:27,500 [INFO]: 	nb vectors: 4132
2025-03-09 08:13:27,500 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:27,500 [INFO]: 	compression ratio: 0.9993086210084403
2025-03-09 08:13:27,500 [INFO]: }
2025-03-09 08:13:27,500 [INFO]: 	>>> Finished "Creating the index" in 55.6320 secs
2025-03-09 08:13:27,500 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6576 secs
2025-03-09 08:13:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 60681 [episode count 4/20]
[retrieval_preprocessing] for episode 65162 [episode count 5/20], we have num_retrieval=np.int64(4057) num_query=np.int64(315)
2025-03-09 08:13:29,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:30,242 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:30
2025-03-09 08:13:30,242 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2183.40it/s]
2025-03-09 08:13:30,271 [INFO]: There are 4057 embeddings of dim 49152
2025-03-09 08:13:30,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:13:30,271 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:30
2025-03-09 08:13:30,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:30,271 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:13:30,271 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:30,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:30,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:30
2025-03-09 08:13:30,272 [INFO]: 837.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:30,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:13:30,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:30
2025-03-09 08:13:30,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:30,272 [INFO]: 	Creating the index 03/09/2025, 08:13:30
2025-03-09 08:13:30,272 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:30
2025-03-09 08:13:30,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:13:30,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:30
2025-03-09 08:13:30,273 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:13:30,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.38it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.52it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.76it/s]100%|██████████| 16/16 [00:03<00:00,  4.52it/s]
2025-03-09 08:13:33,814 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:33
2025-03-09 08:14:17,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9835 secs
2025-03-09 08:14:17,798 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 08:14:17,798 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-09 08:14:33,132 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3340 secs
2025-03-09 08:14:33,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8616 secs
2025-03-09 08:14:33,135 [INFO]: {
2025-03-09 08:14:33,135 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:33,135 [INFO]: 	index_param: efSearch=206
2025-03-09 08:14:33,135 [INFO]: 	index_path: knn.index
2025-03-09 08:14:33,135 [INFO]: 	size in bytes: 798190510
2025-03-09 08:14:33,135 [INFO]: 	avg_search_speed_ms: 9.49657456228529
2025-03-09 08:14:33,135 [INFO]: 	99p_search_speed_ms: 21.862550899386417
2025-03-09 08:14:33,135 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:33,135 [INFO]: 	nb vectors: 4057
2025-03-09 08:14:33,135 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:33,135 [INFO]: 	compression ratio: 0.999308618690543
2025-03-09 08:14:33,135 [INFO]: }
2025-03-09 08:14:33,135 [INFO]: 	>>> Finished "Creating the index" in 62.8633 secs
2025-03-09 08:14:33,135 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8931 secs
2025-03-09 08:14:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 65162 [episode count 5/20]
[retrieval_preprocessing] for episode 71309 [episode count 6/20], we have num_retrieval=np.int64(4220) num_query=np.int64(152)
2025-03-09 08:14:35,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:36,024 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:36
2025-03-09 08:14:36,024 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.96it/s]
2025-03-09 08:14:36,048 [INFO]: There are 4220 embeddings of dim 49152
2025-03-09 08:14:36,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:14:36,049 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,049 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:36,049 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:14:36,049 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:36,049 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:14:36,049 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,049 [INFO]: 870.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:36,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:36,049 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:36
2025-03-09 08:14:36,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:36,049 [INFO]: 	Creating the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,049 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:36
2025-03-09 08:14:36,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:14:36,050 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,050 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:14:36,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.32it/s] 41%|████      | 7/17 [00:00<00:00, 35.09it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.73it/s]100%|██████████| 17/17 [00:03<00:00,  3.92it/s]100%|██████████| 17/17 [00:03<00:00,  5.23it/s]
2025-03-09 08:14:39,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:39
2025-03-09 08:15:17,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8600 secs
2025-03-09 08:15:17,162 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:15:17,162 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.43it/s]
2025-03-09 08:15:36,903 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7404 secs
2025-03-09 08:15:36,905 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8546 secs
2025-03-09 08:15:36,905 [INFO]: {
2025-03-09 08:15:36,905 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:36,905 [INFO]: 	index_param: efSearch=220
2025-03-09 08:15:36,905 [INFO]: 	index_path: knn.index
2025-03-09 08:15:36,905 [INFO]: 	size in bytes: 830259670
2025-03-09 08:15:36,905 [INFO]: 	avg_search_speed_ms: 8.685945101538682
2025-03-09 08:15:36,905 [INFO]: 	99p_search_speed_ms: 12.539821560494602
2025-03-09 08:15:36,905 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:36,905 [INFO]: 	nb vectors: 4220
2025-03-09 08:15:36,905 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:36,905 [INFO]: 	compression ratio: 0.9993087584273485
2025-03-09 08:15:36,905 [INFO]: }
2025-03-09 08:15:36,905 [INFO]: 	>>> Finished "Creating the index" in 60.8559 secs
2025-03-09 08:15:36,905 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8810 secs
2025-03-09 08:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 71309 [episode count 6/20]
[retrieval_preprocessing] for episode 19342 [episode count 7/20], we have num_retrieval=np.int64(4073) num_query=np.int64(299)
2025-03-09 08:15:38,343 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:38,857 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:38
2025-03-09 08:15:38,857 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2372.34it/s]
2025-03-09 08:15:38,880 [INFO]: There are 4073 embeddings of dim 49152
2025-03-09 08:15:38,880 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 08:15:38,881 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:38
2025-03-09 08:15:38,881 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:38,881 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:15:38,881 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:38,881 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:38,881 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:38
2025-03-09 08:15:38,881 [INFO]: 840.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:38,881 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:15:38,881 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:38
2025-03-09 08:15:38,881 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:38,881 [INFO]: 	Creating the index 03/09/2025, 08:15:38
2025-03-09 08:15:38,881 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:38
2025-03-09 08:15:38,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:15:38,882 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:38
2025-03-09 08:15:38,882 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:15:38,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.68it/s] 47%|████▋     | 8/17 [00:00<00:00, 38.85it/s] 82%|████████▏ | 14/17 [00:00<00:00, 45.47it/s]100%|██████████| 17/17 [00:02<00:00,  6.00it/s]
2025-03-09 08:15:41,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:41
2025-03-09 08:16:20,134 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4184 secs
2025-03-09 08:16:20,134 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 08:16:20,134 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.00it/s]
2025-03-09 08:16:36,786 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6512 secs
2025-03-09 08:16:36,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9060 secs
2025-03-09 08:16:36,788 [INFO]: {
2025-03-09 08:16:36,788 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:36,788 [INFO]: 	index_param: efSearch=231
2025-03-09 08:16:36,788 [INFO]: 	index_path: knn.index
2025-03-09 08:16:36,788 [INFO]: 	size in bytes: 801338410
2025-03-09 08:16:36,788 [INFO]: 	avg_search_speed_ms: 10.509127746590515
2025-03-09 08:16:36,788 [INFO]: 	99p_search_speed_ms: 22.61393344728276
2025-03-09 08:16:36,788 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:36,788 [INFO]: 	nb vectors: 4073
2025-03-09 08:16:36,788 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:36,788 [INFO]: 	compression ratio: 0.9993086241803885
2025-03-09 08:16:36,788 [INFO]: }
2025-03-09 08:16:36,788 [INFO]: 	>>> Finished "Creating the index" in 57.9072 secs
2025-03-09 08:16:36,788 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9310 secs
2025-03-09 08:16:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 19342 [episode count 7/20]
[retrieval_preprocessing] for episode 54286 [episode count 8/20], we have num_retrieval=np.int64(4185) num_query=np.int64(187)
2025-03-09 08:16:39,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:40,190 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:40
2025-03-09 08:16:40,190 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2115.13it/s]
2025-03-09 08:16:40,215 [INFO]: There are 4185 embeddings of dim 49152
2025-03-09 08:16:40,216 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:16:40,216 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:40
2025-03-09 08:16:40,216 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:40,216 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:16:40,217 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:40,217 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:16:40,217 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:40
2025-03-09 08:16:40,217 [INFO]: 863.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:40,217 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:16:40,217 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:40
2025-03-09 08:16:40,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:40,217 [INFO]: 	Creating the index 03/09/2025, 08:16:40
2025-03-09 08:16:40,218 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:40
2025-03-09 08:16:40,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:16:40,221 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:40
2025-03-09 08:16:40,221 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:16:40,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.94it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.21it/s] 65%|██████▍   | 11/17 [00:00<00:00, 37.33it/s] 94%|█████████▍| 16/17 [00:00<00:00, 40.00it/s]100%|██████████| 17/17 [00:03<00:00,  4.44it/s]
2025-03-09 08:16:44,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:44
2025-03-09 08:17:27,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0504 secs
2025-03-09 08:17:27,103 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 08:17:27,103 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.25it/s]
2025-03-09 08:17:43,643 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5399 secs
2025-03-09 08:17:43,645 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4246 secs
2025-03-09 08:17:43,646 [INFO]: {
2025-03-09 08:17:43,646 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:43,646 [INFO]: 	index_param: efSearch=196
2025-03-09 08:17:43,646 [INFO]: 	index_path: knn.index
2025-03-09 08:17:43,646 [INFO]: 	size in bytes: 823373650
2025-03-09 08:17:43,646 [INFO]: 	avg_search_speed_ms: 9.087412781717086
2025-03-09 08:17:43,646 [INFO]: 	99p_search_speed_ms: 17.580646213609725
2025-03-09 08:17:43,646 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:43,646 [INFO]: 	nb vectors: 4185
2025-03-09 08:17:43,646 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:43,646 [INFO]: 	compression ratio: 0.9993087342544906
2025-03-09 08:17:43,646 [INFO]: }
2025-03-09 08:17:43,646 [INFO]: 	>>> Finished "Creating the index" in 63.4282 secs
2025-03-09 08:17:43,646 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4554 secs
2025-03-09 08:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 54286 [episode count 8/20]
[retrieval_preprocessing] for episode 19357 [episode count 9/20], we have num_retrieval=np.int64(4162) num_query=np.int64(210)
2025-03-09 08:17:45,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:46,023 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:46
2025-03-09 08:17:46,023 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1777.25it/s]
2025-03-09 08:17:46,352 [INFO]: There are 4162 embeddings of dim 49152
2025-03-09 08:17:46,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3297 secs
2025-03-09 08:17:46,353 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:46
2025-03-09 08:17:46,353 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:46,353 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:17:46,353 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:46,353 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:17:46,353 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:46
2025-03-09 08:17:46,353 [INFO]: 858.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:46,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:17:46,353 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:46
2025-03-09 08:17:46,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:46,354 [INFO]: 	Creating the index 03/09/2025, 08:17:46
2025-03-09 08:17:46,354 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:46
2025-03-09 08:17:46,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 08:17:46,356 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:46
2025-03-09 08:17:46,356 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:17:46,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.23it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.03it/s] 71%|███████   | 12/17 [00:00<00:00, 39.77it/s]100%|██████████| 17/17 [00:03<00:00,  3.95it/s]100%|██████████| 17/17 [00:03<00:00,  5.30it/s]
2025-03-09 08:17:49,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:49
2025-03-09 08:18:32,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7330 secs
2025-03-09 08:18:32,301 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:18:32,302 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-09 08:18:49,215 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9134 secs
2025-03-09 08:18:49,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8612 secs
2025-03-09 08:18:49,217 [INFO]: {
2025-03-09 08:18:49,217 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:49,217 [INFO]: 	index_param: efSearch=209
2025-03-09 08:18:49,217 [INFO]: 	index_path: knn.index
2025-03-09 08:18:49,217 [INFO]: 	size in bytes: 818848630
2025-03-09 08:18:49,217 [INFO]: 	avg_search_speed_ms: 9.98620073563845
2025-03-09 08:18:49,217 [INFO]: 	99p_search_speed_ms: 23.184152925387025
2025-03-09 08:18:49,217 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:49,217 [INFO]: 	nb vectors: 4162
2025-03-09 08:18:49,217 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:49,217 [INFO]: 	compression ratio: 0.9993086219122086
2025-03-09 08:18:49,217 [INFO]: }
2025-03-09 08:18:49,217 [INFO]: 	>>> Finished "Creating the index" in 62.8637 secs
2025-03-09 08:18:49,217 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1943 secs
2025-03-09 08:18:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 19357 [episode count 9/20]
[retrieval_preprocessing] for episode 29 [episode count 10/20], we have num_retrieval=np.int64(4193) num_query=np.int64(179)
2025-03-09 08:18:51,234 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:51,863 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:51
2025-03-09 08:18:51,863 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1732.47it/s]
2025-03-09 08:18:51,887 [INFO]: There are 4193 embeddings of dim 49152
2025-03-09 08:18:51,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:18:51,887 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,887 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:51,887 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:18:51,887 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:51,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:51,887 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,887 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:51,888 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:18:51,888 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:51
2025-03-09 08:18:51,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:51,888 [INFO]: 	Creating the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,888 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:51
2025-03-09 08:18:51,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:18:51,889 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,889 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:18:51,889 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.98it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.88it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.90it/s] 88%|████████▊ | 15/17 [00:00<00:00, 36.07it/s]100%|██████████| 17/17 [00:03<00:00,  4.59it/s]
2025-03-09 08:18:55,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:55
2025-03-09 08:19:40,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5880 secs
2025-03-09 08:19:40,181 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 08:19:40,181 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.53it/s]
2025-03-09 08:19:59,223 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0420 secs
2025-03-09 08:19:59,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3368 secs
2025-03-09 08:19:59,226 [INFO]: {
2025-03-09 08:19:59,226 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:59,226 [INFO]: 	index_param: efSearch=204
2025-03-09 08:19:59,226 [INFO]: 	index_path: knn.index
2025-03-09 08:19:59,226 [INFO]: 	size in bytes: 824947570
2025-03-09 08:19:59,226 [INFO]: 	avg_search_speed_ms: 9.539920785637472
2025-03-09 08:19:59,226 [INFO]: 	99p_search_speed_ms: 19.781679874286056
2025-03-09 08:19:59,226 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:59,226 [INFO]: 	nb vectors: 4193
2025-03-09 08:19:59,226 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:59,226 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-09 08:19:59,226 [INFO]: }
2025-03-09 08:19:59,226 [INFO]: 	>>> Finished "Creating the index" in 67.3381 secs
2025-03-09 08:19:59,226 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3623 secs
2025-03-09 08:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 29 [episode count 10/20]
[retrieval_preprocessing] for episode 43039 [episode count 11/20], we have num_retrieval=np.int64(4191) num_query=np.int64(181)
2025-03-09 08:20:01,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:01,548 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:01
2025-03-09 08:20:01,548 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.21it/s]
2025-03-09 08:20:01,580 [INFO]: There are 4191 embeddings of dim 49152
2025-03-09 08:20:01,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-09 08:20:01,580 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:01
2025-03-09 08:20:01,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:01,580 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:20:01,580 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:01,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:01,580 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:01
2025-03-09 08:20:01,581 [INFO]: 864.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:01,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:01,581 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:01
2025-03-09 08:20:01,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:01,581 [INFO]: 	Creating the index 03/09/2025, 08:20:01
2025-03-09 08:20:01,581 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:01
2025-03-09 08:20:01,582 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:20:01,582 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:01
2025-03-09 08:20:01,582 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:20:01,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.33it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.47it/s] 71%|███████   | 12/17 [00:00<00:00, 39.83it/s]100%|██████████| 17/17 [00:03<00:00,  3.50it/s]100%|██████████| 17/17 [00:03<00:00,  4.73it/s]
2025-03-09 08:20:05,176 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:05
2025-03-09 08:20:42,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4115 secs
2025-03-09 08:20:42,588 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 08:20:42,588 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-09 08:20:55,884 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2960 secs
2025-03-09 08:20:56,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7618 secs
2025-03-09 08:20:56,344 [INFO]: {
2025-03-09 08:20:56,344 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:56,344 [INFO]: 	index_param: efSearch=185
2025-03-09 08:20:56,344 [INFO]: 	index_path: knn.index
2025-03-09 08:20:56,344 [INFO]: 	size in bytes: 824554090
2025-03-09 08:20:56,344 [INFO]: 	avg_search_speed_ms: 8.110412363067196
2025-03-09 08:20:56,344 [INFO]: 	99p_search_speed_ms: 15.21586867049338
2025-03-09 08:20:56,344 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:56,344 [INFO]: 	nb vectors: 4191
2025-03-09 08:20:56,344 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:56,344 [INFO]: 	compression ratio: 0.9993087633583868
2025-03-09 08:20:56,344 [INFO]: }
2025-03-09 08:20:56,344 [INFO]: 	>>> Finished "Creating the index" in 54.7638 secs
2025-03-09 08:20:56,345 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7964 secs
2025-03-09 08:20:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 43039 [episode count 11/20]
[retrieval_preprocessing] for episode 91806 [episode count 12/20], we have num_retrieval=np.int64(4043) num_query=np.int64(329)
2025-03-09 08:20:58,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:58,627 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:58
2025-03-09 08:20:58,627 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2016.49it/s]
2025-03-09 08:20:58,652 [INFO]: There are 4043 embeddings of dim 49152
2025-03-09 08:20:58,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:20:58,653 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:58
2025-03-09 08:20:58,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:58,653 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:20:58,653 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:58,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:58,653 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:58
2025-03-09 08:20:58,653 [INFO]: 834.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:58,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:58,653 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:58
2025-03-09 08:20:58,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:58,653 [INFO]: 	Creating the index 03/09/2025, 08:20:58
2025-03-09 08:20:58,653 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:58
2025-03-09 08:20:58,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:20:58,654 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:58
2025-03-09 08:20:58,654 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:20:58,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.89it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.70it/s] 81%|████████▏ | 13/16 [00:00<00:00, 45.18it/s]100%|██████████| 16/16 [00:02<00:00,  5.75it/s]
2025-03-09 08:21:01,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:01
2025-03-09 08:21:45,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1155 secs
2025-03-09 08:21:45,558 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:21:45,558 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-09 08:21:58,348 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7897 secs
2025-03-09 08:21:58,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6964 secs
2025-03-09 08:21:58,351 [INFO]: {
2025-03-09 08:21:58,351 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:58,351 [INFO]: 	index_param: efSearch=207
2025-03-09 08:21:58,351 [INFO]: 	index_path: knn.index
2025-03-09 08:21:58,351 [INFO]: 	size in bytes: 795436150
2025-03-09 08:21:58,351 [INFO]: 	avg_search_speed_ms: 8.89472918045538
2025-03-09 08:21:58,351 [INFO]: 	99p_search_speed_ms: 19.84173019649461
2025-03-09 08:21:58,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:58,351 [INFO]: 	nb vectors: 4043
2025-03-09 08:21:58,351 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:58,351 [INFO]: 	compression ratio: 0.9993085478953905
2025-03-09 08:21:58,351 [INFO]: }
2025-03-09 08:21:58,351 [INFO]: 	>>> Finished "Creating the index" in 59.6979 secs
2025-03-09 08:21:58,351 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7243 secs
2025-03-09 08:21:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 91806 [episode count 12/20]
[retrieval_preprocessing] for episode 41249 [episode count 13/20], we have num_retrieval=np.int64(4205) num_query=np.int64(167)
2025-03-09 08:22:01,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:01,960 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:01
2025-03-09 08:22:01,960 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1699.47it/s]
2025-03-09 08:22:02,304 [INFO]: There are 4205 embeddings of dim 49152
2025-03-09 08:22:02,305 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3442 secs
2025-03-09 08:22:02,305 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:02
2025-03-09 08:22:02,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:02,305 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:22:02,305 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:02,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:22:02,305 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:02
2025-03-09 08:22:02,305 [INFO]: 867.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:02,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:22:02,305 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:02
2025-03-09 08:22:02,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:02,305 [INFO]: 	Creating the index 03/09/2025, 08:22:02
2025-03-09 08:22:02,306 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:02
2025-03-09 08:22:02,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 08:22:02,308 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:02
2025-03-09 08:22:02,308 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:22:02,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.35it/s] 41%|████      | 7/17 [00:00<00:00, 35.85it/s] 76%|███████▋  | 13/17 [00:00<00:00, 44.04it/s]100%|██████████| 17/17 [00:03<00:00,  5.00it/s]
2025-03-09 08:22:05,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:05
2025-03-09 08:22:51,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7996 secs
2025-03-09 08:22:51,511 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 08:22:51,511 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.73it/s]
2025-03-09 08:23:10,901 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3899 secs
2025-03-09 08:23:10,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5956 secs
2025-03-09 08:23:10,904 [INFO]: {
2025-03-09 08:23:10,904 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:10,904 [INFO]: 	index_param: efSearch=184
2025-03-09 08:23:10,904 [INFO]: 	index_path: knn.index
2025-03-09 08:23:10,904 [INFO]: 	size in bytes: 827308510
2025-03-09 08:23:10,904 [INFO]: 	avg_search_speed_ms: 10.089697951815578
2025-03-09 08:23:10,904 [INFO]: 	99p_search_speed_ms: 23.789208359085023
2025-03-09 08:23:10,904 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:10,904 [INFO]: 	nb vectors: 4205
2025-03-09 08:23:10,904 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:10,904 [INFO]: 	compression ratio: 0.9993087584702833
2025-03-09 08:23:10,904 [INFO]: }
2025-03-09 08:23:10,904 [INFO]: 	>>> Finished "Creating the index" in 68.5983 secs
2025-03-09 08:23:10,904 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9435 secs
2025-03-09 08:23:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 41249 [episode count 13/20]
[retrieval_preprocessing] for episode 5538 [episode count 14/20], we have num_retrieval=np.int64(4004) num_query=np.int64(368)
2025-03-09 08:23:13,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:13,781 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:13
2025-03-09 08:23:13,781 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.98it/s]
2025-03-09 08:23:13,817 [INFO]: There are 4004 embeddings of dim 49152
2025-03-09 08:23:13,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-09 08:23:13,817 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:13
2025-03-09 08:23:13,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:13,817 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:23:13,817 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:13,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:13,818 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:13
2025-03-09 08:23:13,818 [INFO]: 826.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:13,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:23:13,818 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:13
2025-03-09 08:23:13,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:13,818 [INFO]: 	Creating the index 03/09/2025, 08:23:13
2025-03-09 08:23:13,818 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:13
2025-03-09 08:23:13,819 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:23:13,819 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:13
2025-03-09 08:23:13,819 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:23:13,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.78it/s] 31%|███▏      | 5/16 [00:00<00:00, 17.88it/s] 50%|█████     | 8/16 [00:00<00:00, 21.29it/s] 75%|███████▌  | 12/16 [00:00<00:00, 25.36it/s]100%|██████████| 16/16 [00:03<00:00,  2.77it/s]100%|██████████| 16/16 [00:03<00:00,  4.10it/s]
2025-03-09 08:23:17,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:17
2025-03-09 08:24:01,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1281 secs
2025-03-09 08:24:01,856 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 08:24:01,856 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-09 08:24:19,254 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3985 secs
2025-03-09 08:24:19,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4369 secs
2025-03-09 08:24:19,256 [INFO]: {
2025-03-09 08:24:19,256 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:19,256 [INFO]: 	index_param: efSearch=198
2025-03-09 08:24:19,256 [INFO]: 	index_path: knn.index
2025-03-09 08:24:19,256 [INFO]: 	size in bytes: 787763110
2025-03-09 08:24:19,257 [INFO]: 	avg_search_speed_ms: 9.242631350609503
2025-03-09 08:24:19,257 [INFO]: 	99p_search_speed_ms: 21.003564663697066
2025-03-09 08:24:19,257 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:19,257 [INFO]: 	nb vectors: 4004
2025-03-09 08:24:19,257 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:19,257 [INFO]: 	compression ratio: 0.9993085764069354
2025-03-09 08:24:19,257 [INFO]: }
2025-03-09 08:24:19,257 [INFO]: 	>>> Finished "Creating the index" in 65.4387 secs
2025-03-09 08:24:19,257 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4752 secs
2025-03-09 08:24:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 5538 [episode count 14/20]
[retrieval_preprocessing] for episode 16930 [episode count 15/20], we have num_retrieval=np.int64(4094) num_query=np.int64(278)
2025-03-09 08:24:22,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:22,744 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:22
2025-03-09 08:24:22,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-09 08:24:22,768 [INFO]: There are 4094 embeddings of dim 49152
2025-03-09 08:24:22,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:24:22,769 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:22
2025-03-09 08:24:22,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:22,769 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:24:22,769 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:22,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:24:22,769 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:22
2025-03-09 08:24:22,769 [INFO]: 844.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:22,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:24:22,769 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:22
2025-03-09 08:24:22,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:22,769 [INFO]: 	Creating the index 03/09/2025, 08:24:22
2025-03-09 08:24:22,769 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:22
2025-03-09 08:24:22,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:24:22,770 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:22
2025-03-09 08:24:22,770 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:24:22,770 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.06it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.58it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.85it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.74it/s]100%|██████████| 17/17 [00:04<00:00,  4.01it/s]
2025-03-09 08:24:27,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:27
2025-03-09 08:25:09,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7343 secs
2025-03-09 08:25:09,746 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 08:25:09,746 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.94it/s]
2025-03-09 08:25:31,184 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4379 secs
2025-03-09 08:25:31,186 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4163 secs
2025-03-09 08:25:31,186 [INFO]: {
2025-03-09 08:25:31,187 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:31,187 [INFO]: 	index_param: efSearch=248
2025-03-09 08:25:31,187 [INFO]: 	index_path: knn.index
2025-03-09 08:25:31,187 [INFO]: 	size in bytes: 805470010
2025-03-09 08:25:31,187 [INFO]: 	avg_search_speed_ms: 10.885416136363418
2025-03-09 08:25:31,187 [INFO]: 	99p_search_speed_ms: 20.842096982523795
2025-03-09 08:25:31,187 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:31,187 [INFO]: 	nb vectors: 4094
2025-03-09 08:25:31,187 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:31,187 [INFO]: 	compression ratio: 0.999308654582931
2025-03-09 08:25:31,187 [INFO]: }
2025-03-09 08:25:31,187 [INFO]: 	>>> Finished "Creating the index" in 68.4175 secs
2025-03-09 08:25:31,187 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4427 secs
2025-03-09 08:25:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 16930 [episode count 15/20]
[retrieval_preprocessing] for episode 76450 [episode count 16/20], we have num_retrieval=np.int64(4135) num_query=np.int64(237)
2025-03-09 08:25:33,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:34,486 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:34
2025-03-09 08:25:34,486 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-09 08:25:34,512 [INFO]: There are 4135 embeddings of dim 49152
2025-03-09 08:25:34,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:25:34,512 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:34
2025-03-09 08:25:34,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:34,512 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:25:34,512 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:34,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:25:34,512 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:34
2025-03-09 08:25:34,513 [INFO]: 853.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:34,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:34,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:34
2025-03-09 08:25:34,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:34,513 [INFO]: 	Creating the index 03/09/2025, 08:25:34
2025-03-09 08:25:34,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:34
2025-03-09 08:25:34,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:25:34,514 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:34
2025-03-09 08:25:34,514 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:25:34,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.91it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.92it/s] 59%|█████▉    | 10/17 [00:00<00:00, 33.03it/s] 88%|████████▊ | 15/17 [00:00<00:00, 36.54it/s]100%|██████████| 17/17 [00:03<00:00,  4.38it/s]
2025-03-09 08:25:38,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:38
2025-03-09 08:26:21,170 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7724 secs
2025-03-09 08:26:21,171 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 08:26:21,171 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.15it/s]
2025-03-09 08:26:39,216 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0455 secs
2025-03-09 08:26:39,219 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7047 secs
2025-03-09 08:26:39,219 [INFO]: {
2025-03-09 08:26:39,219 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:39,219 [INFO]: 	index_param: efSearch=174
2025-03-09 08:26:39,219 [INFO]: 	index_path: knn.index
2025-03-09 08:26:39,219 [INFO]: 	size in bytes: 813536530
2025-03-09 08:26:39,219 [INFO]: 	avg_search_speed_ms: 8.001530754566193
2025-03-09 08:26:39,219 [INFO]: 	99p_search_speed_ms: 15.467134532518685
2025-03-09 08:26:39,219 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:39,220 [INFO]: 	nb vectors: 4135
2025-03-09 08:26:39,220 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:39,220 [INFO]: 	compression ratio: 0.9993086358396224
2025-03-09 08:26:39,220 [INFO]: }
2025-03-09 08:26:39,220 [INFO]: 	>>> Finished "Creating the index" in 64.7068 secs
2025-03-09 08:26:39,220 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7338 secs
2025-03-09 08:26:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 76450 [episode count 16/20]
[retrieval_preprocessing] for episode 26661 [episode count 17/20], we have num_retrieval=np.int64(4185) num_query=np.int64(187)
2025-03-09 08:26:41,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:41,868 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:41
2025-03-09 08:26:41,868 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-09 08:26:41,895 [INFO]: There are 4185 embeddings of dim 49152
2025-03-09 08:26:41,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:26:41,896 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:41
2025-03-09 08:26:41,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:41,896 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:26:41,896 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:41,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:26:41,896 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:41
2025-03-09 08:26:41,897 [INFO]: 863.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:41,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:26:41,897 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:41
2025-03-09 08:26:41,897 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:41,897 [INFO]: 	Creating the index 03/09/2025, 08:26:41
2025-03-09 08:26:41,897 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:41
2025-03-09 08:26:41,900 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:26:41,900 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:41
2025-03-09 08:26:41,900 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:26:41,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 24.92it/s] 47%|████▋     | 8/17 [00:00<00:00, 32.23it/s] 76%|███████▋  | 13/17 [00:00<00:00, 38.59it/s]100%|██████████| 17/17 [00:03<00:00,  3.05it/s]100%|██████████| 17/17 [00:03<00:00,  4.50it/s]
2025-03-09 08:26:45,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:45
2025-03-09 08:27:26,874 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1888 secs
2025-03-09 08:27:26,874 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 08:27:26,874 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-09 08:27:44,428 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5535 secs
2025-03-09 08:27:44,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5306 secs
2025-03-09 08:27:44,431 [INFO]: {
2025-03-09 08:27:44,431 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:44,431 [INFO]: 	index_param: efSearch=230
2025-03-09 08:27:44,431 [INFO]: 	index_path: knn.index
2025-03-09 08:27:44,431 [INFO]: 	size in bytes: 823373650
2025-03-09 08:27:44,431 [INFO]: 	avg_search_speed_ms: 11.529426614020002
2025-03-09 08:27:44,431 [INFO]: 	99p_search_speed_ms: 23.967123662587255
2025-03-09 08:27:44,431 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:44,431 [INFO]: 	nb vectors: 4185
2025-03-09 08:27:44,431 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:44,431 [INFO]: 	compression ratio: 0.9993087342544906
2025-03-09 08:27:44,431 [INFO]: }
2025-03-09 08:27:44,431 [INFO]: 	>>> Finished "Creating the index" in 62.5342 secs
2025-03-09 08:27:44,431 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5634 secs
2025-03-09 08:27:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 26661 [episode count 17/20]
[retrieval_preprocessing] for episode 92967 [episode count 18/20], we have num_retrieval=np.int64(4200) num_query=np.int64(172)
2025-03-09 08:27:46,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:47,397 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:47
2025-03-09 08:27:47,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1678.39it/s]
2025-03-09 08:27:47,421 [INFO]: There are 4200 embeddings of dim 49152
2025-03-09 08:27:47,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 08:27:47,421 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:47,421 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:27:47,421 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:47,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:27:47,421 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,421 [INFO]: 866.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:47,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:27:47,421 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:47
2025-03-09 08:27:47,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:47,421 [INFO]: 	Creating the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,422 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:47
2025-03-09 08:27:47,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:27:47,423 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,423 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:27:47,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.83it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.06it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.27it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.52it/s]100%|██████████| 17/17 [00:03<00:00,  4.55it/s]
2025-03-09 08:27:51,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:51
2025-03-09 08:28:36,882 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7201 secs
2025-03-09 08:28:36,882 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 08:28:36,882 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.53it/s]
2025-03-09 08:28:53,505 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6233 secs
2025-03-09 08:28:53,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0851 secs
2025-03-09 08:28:53,508 [INFO]: {
2025-03-09 08:28:53,508 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:53,508 [INFO]: 	index_param: efSearch=190
2025-03-09 08:28:53,508 [INFO]: 	index_path: knn.index
2025-03-09 08:28:53,508 [INFO]: 	size in bytes: 826324750
2025-03-09 08:28:53,508 [INFO]: 	avg_search_speed_ms: 9.2094451691578
2025-03-09 08:28:53,508 [INFO]: 	99p_search_speed_ms: 19.675734720658557
2025-03-09 08:28:53,508 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:53,508 [INFO]: 	nb vectors: 4200
2025-03-09 08:28:53,508 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:53,508 [INFO]: 	compression ratio: 0.9993088068583206
2025-03-09 08:28:53,508 [INFO]: }
2025-03-09 08:28:53,508 [INFO]: 	>>> Finished "Creating the index" in 66.0865 secs
2025-03-09 08:28:53,508 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1114 secs
2025-03-09 08:28:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 92967 [episode count 18/20]
[retrieval_preprocessing] for episode 69800 [episode count 19/20], we have num_retrieval=np.int64(4238) num_query=np.int64(134)
2025-03-09 08:28:55,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:55,968 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:55
2025-03-09 08:28:55,968 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-09 08:28:55,989 [INFO]: There are 4238 embeddings of dim 49152
2025-03-09 08:28:55,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-09 08:28:55,989 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:55
2025-03-09 08:28:55,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:55,989 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:28:55,989 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:55,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:55,990 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:55
2025-03-09 08:28:55,990 [INFO]: 874.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:55,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:55,990 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:55
2025-03-09 08:28:55,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:55,990 [INFO]: 	Creating the index 03/09/2025, 08:28:55
2025-03-09 08:28:55,990 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:55
2025-03-09 08:28:55,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:28:55,991 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:55
2025-03-09 08:28:55,991 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:28:55,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.68it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.60it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.28it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.89it/s]100%|██████████| 17/17 [00:03<00:00,  4.39it/s]
2025-03-09 08:28:59,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:59
2025-03-09 08:29:46,814 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9469 secs
2025-03-09 08:29:46,814 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 08:29:46,814 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.00it/s]
2025-03-09 08:30:09,153 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3395 secs
2025-03-09 08:30:09,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1656 secs
2025-03-09 08:30:09,156 [INFO]: {
2025-03-09 08:30:09,156 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:09,156 [INFO]: 	index_param: efSearch=175
2025-03-09 08:30:09,156 [INFO]: 	index_path: knn.index
2025-03-09 08:30:09,157 [INFO]: 	size in bytes: 833801110
2025-03-09 08:30:09,157 [INFO]: 	avg_search_speed_ms: 8.160970968631457
2025-03-09 08:30:09,157 [INFO]: 	99p_search_speed_ms: 19.712369265034795
2025-03-09 08:30:09,157 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:09,157 [INFO]: 	nb vectors: 4238
2025-03-09 08:30:09,157 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:09,157 [INFO]: 	compression ratio: 0.9993087008483355
2025-03-09 08:30:09,157 [INFO]: }
2025-03-09 08:30:09,157 [INFO]: 	>>> Finished "Creating the index" in 73.1668 secs
2025-03-09 08:30:09,157 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1888 secs
2025-03-09 08:30:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 69800 [episode count 19/20]
2025-03-09 08:30:10: [retrieval_preprocessing] finished for (1431810548, 'lid') [chosen_id count 4/10]
2025-03-09 08:30:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3485794757, 'marker') [chosen_id count 5/10]
2025-03-09 08:30:12: [retrieval_preprocessing] we have num_total=5476 embedding_dim=49152
[retrieval_preprocessing] for episode 33280 [episode count 0/20], we have num_retrieval=np.int64(5252) num_query=np.int64(224)
2025-03-09 08:30:13,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:14,314 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:14
2025-03-09 08:30:14,314 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.01it/s]
2025-03-09 08:30:14,352 [INFO]: There are 5252 embeddings of dim 49152
2025-03-09 08:30:14,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-09 08:30:14,352 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:14
2025-03-09 08:30:14,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:14,352 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:30:14,352 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:14,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:14,353 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:14
2025-03-09 08:30:14,353 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:14,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:30:14,353 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:14
2025-03-09 08:30:14,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:14,353 [INFO]: 	Creating the index 03/09/2025, 08:30:14
2025-03-09 08:30:14,353 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:14
2025-03-09 08:30:14,354 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:30:14,354 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:14
2025-03-09 08:30:14,354 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:30:14,354 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.30it/s] 18%|█▊        | 4/22 [00:00<00:01, 15.77it/s] 36%|███▋      | 8/22 [00:00<00:00, 24.56it/s] 55%|█████▍    | 12/22 [00:00<00:00, 29.59it/s] 77%|███████▋  | 17/22 [00:00<00:00, 35.39it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.95it/s]100%|██████████| 22/22 [00:04<00:00,  4.46it/s]
2025-03-09 08:30:19,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:19
2025-03-09 08:31:01,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1729 secs
2025-03-09 08:31:01,461 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 08:31:01,461 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.00it/s]
2025-03-09 08:31:18,330 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8684 secs
2025-03-09 08:31:18,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9761 secs
2025-03-09 08:31:18,330 [INFO]: {
2025-03-09 08:31:18,330 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:18,330 [INFO]: 	index_param: efSearch=227
2025-03-09 08:31:18,331 [INFO]: 	index_path: knn.index
2025-03-09 08:31:18,331 [INFO]: 	size in bytes: 1033300030
2025-03-09 08:31:18,331 [INFO]: 	avg_search_speed_ms: 10.782024412664809
2025-03-09 08:31:18,331 [INFO]: 	99p_search_speed_ms: 22.925135737750683
2025-03-09 08:31:18,331 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:18,331 [INFO]: 	nb vectors: 5252
2025-03-09 08:31:18,331 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:18,331 [INFO]: 	compression ratio: 0.9993082222208006
2025-03-09 08:31:18,331 [INFO]: }
2025-03-09 08:31:18,331 [INFO]: 	>>> Finished "Creating the index" in 63.9776 secs
2025-03-09 08:31:18,331 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0168 secs
2025-03-09 08:31:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 33280 [episode count 0/20]
[retrieval_preprocessing] for episode 2570 [episode count 1/20], we have num_retrieval=np.int64(5272) num_query=np.int64(204)
2025-03-09 08:31:21,574 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:22,384 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:22
2025-03-09 08:31:22,384 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2022.33it/s]
2025-03-09 08:31:22,414 [INFO]: There are 5272 embeddings of dim 49152
2025-03-09 08:31:22,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:31:22,415 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:22
2025-03-09 08:31:22,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:22,415 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:31:22,415 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:22,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:22,415 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:22
2025-03-09 08:31:22,415 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:22,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:31:22,415 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:22
2025-03-09 08:31:22,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:22,415 [INFO]: 	Creating the index 03/09/2025, 08:31:22
2025-03-09 08:31:22,415 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:22
2025-03-09 08:31:22,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:31:22,416 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:22
2025-03-09 08:31:22,416 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:31:22,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.34it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.52it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.12it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.05it/s]100%|██████████| 22/22 [00:04<00:00,  4.68it/s]
2025-03-09 08:31:27,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:27
2025-03-09 08:32:10,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2171 secs
2025-03-09 08:32:10,337 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 08:32:10,337 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-09 08:32:30,362 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0249 secs
2025-03-09 08:32:30,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9462 secs
2025-03-09 08:32:30,362 [INFO]: {
2025-03-09 08:32:30,362 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:30,362 [INFO]: 	index_param: efSearch=164
2025-03-09 08:32:30,362 [INFO]: 	index_path: knn.index
2025-03-09 08:32:30,362 [INFO]: 	size in bytes: 1037234890
2025-03-09 08:32:30,362 [INFO]: 	avg_search_speed_ms: 8.403413378273552
2025-03-09 08:32:30,362 [INFO]: 	99p_search_speed_ms: 20.624821963720017
2025-03-09 08:32:30,362 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:30,362 [INFO]: 	nb vectors: 5272
2025-03-09 08:32:30,362 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:30,362 [INFO]: 	compression ratio: 0.9993082434780033
2025-03-09 08:32:30,362 [INFO]: }
2025-03-09 08:32:30,362 [INFO]: 	>>> Finished "Creating the index" in 67.9475 secs
2025-03-09 08:32:30,362 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9781 secs
2025-03-09 08:32:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 2570 [episode count 1/20]
[retrieval_preprocessing] for episode 12817 [episode count 2/20], we have num_retrieval=np.int64(5197) num_query=np.int64(279)
2025-03-09 08:32:32,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:33,031 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:33
2025-03-09 08:32:33,031 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-09 08:32:33,060 [INFO]: There are 5197 embeddings of dim 49152
2025-03-09 08:32:33,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 08:32:33,061 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:33
2025-03-09 08:32:33,061 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:33,061 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:32:33,061 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:33,061 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:33,061 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:33
2025-03-09 08:32:33,061 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:33,061 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:32:33,061 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:33
2025-03-09 08:32:33,061 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:33,061 [INFO]: 	Creating the index 03/09/2025, 08:32:33
2025-03-09 08:32:33,061 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:33
2025-03-09 08:32:33,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:32:33,062 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:33
2025-03-09 08:32:33,062 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:32:33,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.74it/s] 27%|██▋       | 6/22 [00:00<00:00, 33.11it/s] 55%|█████▍    | 12/22 [00:00<00:00, 42.34it/s] 82%|████████▏ | 18/22 [00:00<00:00, 46.63it/s]100%|██████████| 22/22 [00:05<00:00,  4.32it/s]
2025-03-09 08:32:38,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:38
2025-03-09 08:33:20,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8793 secs
2025-03-09 08:33:20,033 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 08:33:20,033 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-09 08:33:35,592 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5586 secs
2025-03-09 08:33:35,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5303 secs
2025-03-09 08:33:35,592 [INFO]: {
2025-03-09 08:33:35,592 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:35,592 [INFO]: 	index_param: efSearch=239
2025-03-09 08:33:35,592 [INFO]: 	index_path: knn.index
2025-03-09 08:33:35,592 [INFO]: 	size in bytes: 1022478970
2025-03-09 08:33:35,592 [INFO]: 	avg_search_speed_ms: 10.874248495446922
2025-03-09 08:33:35,592 [INFO]: 	99p_search_speed_ms: 24.348412028048156
2025-03-09 08:33:35,592 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:35,592 [INFO]: 	nb vectors: 5197
2025-03-09 08:33:35,592 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:35,592 [INFO]: 	compression ratio: 0.9993083535009037
2025-03-09 08:33:35,592 [INFO]: }
2025-03-09 08:33:35,592 [INFO]: 	>>> Finished "Creating the index" in 62.5315 secs
2025-03-09 08:33:35,592 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5613 secs
2025-03-09 08:33:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 12817 [episode count 2/20]
[retrieval_preprocessing] for episode 14353 [episode count 3/20], we have num_retrieval=np.int64(5215) num_query=np.int64(261)
2025-03-09 08:33:39,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:40,392 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:40
2025-03-09 08:33:40,392 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1667.72it/s]
2025-03-09 08:33:40,425 [INFO]: There are 5215 embeddings of dim 49152
2025-03-09 08:33:40,426 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-09 08:33:40,426 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:40
2025-03-09 08:33:40,426 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:40,426 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:33:40,426 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:40,426 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:33:40,426 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:40
2025-03-09 08:33:40,427 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:40,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:33:40,427 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:40
2025-03-09 08:33:40,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:40,427 [INFO]: 	Creating the index 03/09/2025, 08:33:40
2025-03-09 08:33:40,427 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:40
2025-03-09 08:33:40,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:33:40,430 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:40
2025-03-09 08:33:40,430 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:33:40,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s] 14%|█▎        | 3/22 [00:00<00:00, 25.39it/s] 41%|████      | 9/22 [00:00<00:00, 41.88it/s] 64%|██████▎   | 14/22 [00:00<00:00, 43.06it/s] 91%|█████████ | 20/22 [00:00<00:00, 47.16it/s]100%|██████████| 22/22 [00:04<00:00,  4.55it/s]
2025-03-09 08:33:45,274 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:45
2025-03-09 08:34:29,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7164 secs
2025-03-09 08:34:29,991 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:34:29,991 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.64it/s]
2025-03-09 08:34:51,096 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1054 secs
2025-03-09 08:34:51,096 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6662 secs
2025-03-09 08:34:51,097 [INFO]: {
2025-03-09 08:34:51,097 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:51,097 [INFO]: 	index_param: efSearch=218
2025-03-09 08:34:51,097 [INFO]: 	index_path: knn.index
2025-03-09 08:34:51,097 [INFO]: 	size in bytes: 1026020350
2025-03-09 08:34:51,097 [INFO]: 	avg_search_speed_ms: 10.196245172432226
2025-03-09 08:34:51,097 [INFO]: 	99p_search_speed_ms: 22.079463023692398
2025-03-09 08:34:51,097 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:51,097 [INFO]: 	nb vectors: 5215
2025-03-09 08:34:51,097 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:51,097 [INFO]: 	compression ratio: 0.9993083665445817
2025-03-09 08:34:51,097 [INFO]: }
2025-03-09 08:34:51,097 [INFO]: 	>>> Finished "Creating the index" in 70.6693 secs
2025-03-09 08:34:51,097 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7046 secs
2025-03-09 08:34:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 14353 [episode count 3/20]
[retrieval_preprocessing] for episode 51738 [episode count 4/20], we have num_retrieval=np.int64(5224) num_query=np.int64(252)
2025-03-09 08:34:53,616 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:54,324 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:54
2025-03-09 08:34:54,324 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1688.53it/s]
2025-03-09 08:34:54,353 [INFO]: There are 5224 embeddings of dim 49152
2025-03-09 08:34:54,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:34:54,354 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:54
2025-03-09 08:34:54,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:54,354 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:34:54,354 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:54,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:54,354 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:54
2025-03-09 08:34:54,354 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:54,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:54,354 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:54
2025-03-09 08:34:54,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:54,354 [INFO]: 	Creating the index 03/09/2025, 08:34:54
2025-03-09 08:34:54,354 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:54
2025-03-09 08:34:54,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:34:54,355 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:54
2025-03-09 08:34:54,355 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:34:54,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.01it/s] 23%|██▎       | 5/22 [00:00<00:00, 25.07it/s] 45%|████▌     | 10/22 [00:00<00:00, 34.57it/s] 64%|██████▎   | 14/22 [00:00<00:00, 33.41it/s] 86%|████████▋ | 19/22 [00:00<00:00, 37.62it/s]100%|██████████| 22/22 [00:04<00:00,  4.51it/s]
2025-03-09 08:34:59,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:59
2025-03-09 08:35:41,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6394 secs
2025-03-09 08:35:41,870 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:35:41,870 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.54it/s]
2025-03-09 08:36:04,533 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6629 secs
2025-03-09 08:36:04,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1782 secs
2025-03-09 08:36:04,533 [INFO]: {
2025-03-09 08:36:04,533 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:04,533 [INFO]: 	index_param: efSearch=238
2025-03-09 08:36:04,533 [INFO]: 	index_path: knn.index
2025-03-09 08:36:04,534 [INFO]: 	size in bytes: 1027791130
2025-03-09 08:36:04,534 [INFO]: 	avg_search_speed_ms: 10.268972202460425
2025-03-09 08:36:04,534 [INFO]: 	99p_search_speed_ms: 23.209954078774896
2025-03-09 08:36:04,534 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:04,534 [INFO]: 	nb vectors: 5224
2025-03-09 08:36:04,534 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:04,534 [INFO]: 	compression ratio: 0.9993082855268463
2025-03-09 08:36:04,534 [INFO]: }
2025-03-09 08:36:04,534 [INFO]: 	>>> Finished "Creating the index" in 70.1795 secs
2025-03-09 08:36:04,534 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2094 secs
2025-03-09 08:36:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 51738 [episode count 4/20]
[retrieval_preprocessing] for episode 13851 [episode count 5/20], we have num_retrieval=np.int64(5202) num_query=np.int64(274)
2025-03-09 08:36:07,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:08,592 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:08
2025-03-09 08:36:08,592 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2279.51it/s]
2025-03-09 08:36:08,761 [INFO]: There are 5202 embeddings of dim 49152
2025-03-09 08:36:08,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1701 secs
2025-03-09 08:36:08,762 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:08
2025-03-09 08:36:08,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:08,762 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:36:08,762 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:08,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:36:08,762 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:08
2025-03-09 08:36:08,763 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:08,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:36:08,763 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:08
2025-03-09 08:36:08,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:08,763 [INFO]: 	Creating the index 03/09/2025, 08:36:08
2025-03-09 08:36:08,763 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:08
2025-03-09 08:36:08,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:36:08,766 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:08
2025-03-09 08:36:08,767 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:36:08,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 16.50it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.75it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.57it/s] 77%|███████▋  | 17/22 [00:00<00:00, 42.37it/s]100%|██████████| 22/22 [00:04<00:00,  3.03it/s]100%|██████████| 22/22 [00:04<00:00,  4.79it/s]
2025-03-09 08:36:13,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:13
2025-03-09 08:36:55,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6760 secs
2025-03-09 08:36:55,041 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:36:55,042 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.90it/s]
2025-03-09 08:37:11,238 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1962 secs
2025-03-09 08:37:11,238 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4719 secs
2025-03-09 08:37:11,238 [INFO]: {
2025-03-09 08:37:11,238 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:11,239 [INFO]: 	index_param: efSearch=200
2025-03-09 08:37:11,239 [INFO]: 	index_path: knn.index
2025-03-09 08:37:11,239 [INFO]: 	size in bytes: 1023462730
2025-03-09 08:37:11,239 [INFO]: 	avg_search_speed_ms: 8.89974015017514
2025-03-09 08:37:11,239 [INFO]: 	99p_search_speed_ms: 18.772039085160937
2025-03-09 08:37:11,239 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:11,239 [INFO]: 	nb vectors: 5202
2025-03-09 08:37:11,239 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:11,239 [INFO]: 	compression ratio: 0.9993083148225632
2025-03-09 08:37:11,239 [INFO]: }
2025-03-09 08:37:11,239 [INFO]: 	>>> Finished "Creating the index" in 62.4752 secs
2025-03-09 08:37:11,239 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6469 secs
2025-03-09 08:37:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 13851 [episode count 5/20]
[retrieval_preprocessing] for episode 18461 [episode count 6/20], we have num_retrieval=np.int64(5241) num_query=np.int64(235)
2025-03-09 08:37:13,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:14,397 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:14
2025-03-09 08:37:14,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-09 08:37:14,430 [INFO]: There are 5241 embeddings of dim 49152
2025-03-09 08:37:14,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 08:37:14,430 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:14
2025-03-09 08:37:14,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:14,430 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:37:14,430 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:14,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:14,430 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:14
2025-03-09 08:37:14,430 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:14,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:37:14,430 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:14
2025-03-09 08:37:14,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:14,430 [INFO]: 	Creating the index 03/09/2025, 08:37:14
2025-03-09 08:37:14,430 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:14
2025-03-09 08:37:14,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:37:14,431 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:14
2025-03-09 08:37:14,431 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:37:14,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.79it/s] 27%|██▋       | 6/22 [00:00<00:00, 25.89it/s] 50%|█████     | 11/22 [00:00<00:00, 34.53it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.33it/s]100%|██████████| 22/22 [00:04<00:00,  3.11it/s]100%|██████████| 22/22 [00:04<00:00,  4.72it/s]
2025-03-09 08:37:19,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:19
2025-03-09 08:38:00,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7174 secs
2025-03-09 08:38:00,808 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 08:38:00,808 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.81it/s]
2025-03-09 08:38:20,054 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2459 secs
2025-03-09 08:38:20,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6680 secs
2025-03-09 08:38:20,100 [INFO]: {
2025-03-09 08:38:20,100 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:20,100 [INFO]: 	index_param: efSearch=256
2025-03-09 08:38:20,100 [INFO]: 	index_path: knn.index
2025-03-09 08:38:20,100 [INFO]: 	size in bytes: 1031135770
2025-03-09 08:38:20,100 [INFO]: 	avg_search_speed_ms: 10.265416367929927
2025-03-09 08:38:20,100 [INFO]: 	99p_search_speed_ms: 15.193085235077888
2025-03-09 08:38:20,100 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:20,100 [INFO]: 	nb vectors: 5241
2025-03-09 08:38:20,100 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:20,100 [INFO]: 	compression ratio: 0.9993082947747997
2025-03-09 08:38:20,100 [INFO]: }
2025-03-09 08:38:20,100 [INFO]: 	>>> Finished "Creating the index" in 65.6698 secs
2025-03-09 08:38:20,100 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7027 secs
2025-03-09 08:38:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 18461 [episode count 6/20]
[retrieval_preprocessing] for episode 36 [episode count 7/20], we have num_retrieval=np.int64(5124) num_query=np.int64(352)
2025-03-09 08:38:22,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:23,442 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:23
2025-03-09 08:38:23,442 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1898.73it/s]
2025-03-09 08:38:23,474 [INFO]: There are 5124 embeddings of dim 49152
2025-03-09 08:38:23,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 08:38:23,475 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:23
2025-03-09 08:38:23,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:23,475 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:38:23,475 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:23,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:38:23,475 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:23
2025-03-09 08:38:23,476 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:23,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:38:23,476 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:23
2025-03-09 08:38:23,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:23,476 [INFO]: 	Creating the index 03/09/2025, 08:38:23
2025-03-09 08:38:23,476 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:23
2025-03-09 08:38:23,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:38:23,479 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:23
2025-03-09 08:38:23,480 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:38:23,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.22it/s] 41%|████      | 9/22 [00:00<00:00, 44.51it/s] 73%|███████▎  | 16/22 [00:00<00:00, 52.20it/s]100%|██████████| 22/22 [00:03<00:00,  3.96it/s]100%|██████████| 22/22 [00:03<00:00,  5.56it/s]
2025-03-09 08:38:27,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:27
2025-03-09 08:39:05,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6908 secs
2025-03-09 08:39:05,133 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:39:05,134 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 08:39:24,248 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1142 secs
2025-03-09 08:39:24,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7692 secs
2025-03-09 08:39:24,249 [INFO]: {
2025-03-09 08:39:24,249 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:24,249 [INFO]: 	index_param: efSearch=223
2025-03-09 08:39:24,249 [INFO]: 	index_path: knn.index
2025-03-09 08:39:24,249 [INFO]: 	size in bytes: 1008116590
2025-03-09 08:39:24,249 [INFO]: 	avg_search_speed_ms: 9.0115350413111
2025-03-09 08:39:24,249 [INFO]: 	99p_search_speed_ms: 14.967524891253566
2025-03-09 08:39:24,249 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:24,249 [INFO]: 	nb vectors: 5124
2025-03-09 08:39:24,249 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:24,249 [INFO]: 	compression ratio: 0.999308415309384
2025-03-09 08:39:24,249 [INFO]: }
2025-03-09 08:39:24,249 [INFO]: 	>>> Finished "Creating the index" in 60.7728 secs
2025-03-09 08:39:24,249 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8073 secs
2025-03-09 08:39:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 36 [episode count 7/20]
[retrieval_preprocessing] for episode 28198 [episode count 8/20], we have num_retrieval=np.int64(5271) num_query=np.int64(205)
2025-03-09 08:39:27,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:27,764 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:27
2025-03-09 08:39:27,764 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-09 08:39:27,796 [INFO]: There are 5271 embeddings of dim 49152
2025-03-09 08:39:27,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 08:39:27,796 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:27
2025-03-09 08:39:27,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:27,796 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:39:27,796 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:27,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:27,796 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:27
2025-03-09 08:39:27,796 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:27,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:27,796 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:27
2025-03-09 08:39:27,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:27,796 [INFO]: 	Creating the index 03/09/2025, 08:39:27
2025-03-09 08:39:27,796 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:27
2025-03-09 08:39:27,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:39:27,797 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:27
2025-03-09 08:39:27,797 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:39:27,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.08it/s] 27%|██▋       | 6/22 [00:00<00:00, 25.78it/s] 50%|█████     | 11/22 [00:00<00:00, 35.16it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.67it/s]100%|██████████| 22/22 [00:04<00:00,  3.42it/s]100%|██████████| 22/22 [00:04<00:00,  5.17it/s]
2025-03-09 08:39:32,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:32
2025-03-09 08:40:14,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8238 secs
2025-03-09 08:40:14,879 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:40:14,879 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.20it/s]
2025-03-09 08:40:37,381 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5015 secs
2025-03-09 08:40:37,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5842 secs
2025-03-09 08:40:37,382 [INFO]: {
2025-03-09 08:40:37,382 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:37,382 [INFO]: 	index_param: efSearch=217
2025-03-09 08:40:37,382 [INFO]: 	index_path: knn.index
2025-03-09 08:40:37,382 [INFO]: 	size in bytes: 1037038150
2025-03-09 08:40:37,382 [INFO]: 	avg_search_speed_ms: 8.699935947585365
2025-03-09 08:40:37,382 [INFO]: 	99p_search_speed_ms: 12.24841621471569
2025-03-09 08:40:37,382 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:37,382 [INFO]: 	nb vectors: 5271
2025-03-09 08:40:37,382 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:37,382 [INFO]: 	compression ratio: 0.9993082395281215
2025-03-09 08:40:37,382 [INFO]: }
2025-03-09 08:40:37,382 [INFO]: 	>>> Finished "Creating the index" in 69.5854 secs
2025-03-09 08:40:37,382 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6175 secs
2025-03-09 08:40:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 28198 [episode count 8/20]
[retrieval_preprocessing] for episode 40999 [episode count 9/20], we have num_retrieval=np.int64(5272) num_query=np.int64(204)
2025-03-09 08:40:39,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:40,373 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:40
2025-03-09 08:40:40,373 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-09 08:40:40,408 [INFO]: There are 5272 embeddings of dim 49152
2025-03-09 08:40:40,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-09 08:40:40,408 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:40
2025-03-09 08:40:40,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:40,408 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:40:40,408 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:40,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:40:40,408 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:40
2025-03-09 08:40:40,408 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:40,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:40:40,408 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:40
2025-03-09 08:40:40,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:40,408 [INFO]: 	Creating the index 03/09/2025, 08:40:40
2025-03-09 08:40:40,408 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:40
2025-03-09 08:40:40,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:40:40,409 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:40
2025-03-09 08:40:40,409 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:40:40,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.62it/s] 27%|██▋       | 6/22 [00:00<00:00, 26.33it/s] 55%|█████▍    | 12/22 [00:00<00:00, 37.92it/s] 82%|████████▏ | 18/22 [00:00<00:00, 43.45it/s]100%|██████████| 22/22 [00:04<00:00,  4.67it/s]
2025-03-09 08:40:45,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:45
2025-03-09 08:41:28,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3244 secs
2025-03-09 08:41:28,450 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 08:41:28,450 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-09 08:41:49,260 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8097 secs
2025-03-09 08:41:49,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8507 secs
2025-03-09 08:41:49,261 [INFO]: {
2025-03-09 08:41:49,261 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:49,261 [INFO]: 	index_param: efSearch=188
2025-03-09 08:41:49,261 [INFO]: 	index_path: knn.index
2025-03-09 08:41:49,261 [INFO]: 	size in bytes: 1037234890
2025-03-09 08:41:49,261 [INFO]: 	avg_search_speed_ms: 9.106018213650215
2025-03-09 08:41:49,261 [INFO]: 	99p_search_speed_ms: 21.62656637607141
2025-03-09 08:41:49,261 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:49,261 [INFO]: 	nb vectors: 5272
2025-03-09 08:41:49,261 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:49,261 [INFO]: 	compression ratio: 0.9993082434780033
2025-03-09 08:41:49,261 [INFO]: }
2025-03-09 08:41:49,261 [INFO]: 	>>> Finished "Creating the index" in 68.8524 secs
2025-03-09 08:41:49,261 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8881 secs
2025-03-09 08:41:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 40999 [episode count 9/20]
[retrieval_preprocessing] for episode 60967 [episode count 10/20], we have num_retrieval=np.int64(5206) num_query=np.int64(270)
2025-03-09 08:41:51,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:52,348 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:52
2025-03-09 08:41:52,348 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2312.19it/s]
2025-03-09 08:41:52,379 [INFO]: There are 5206 embeddings of dim 49152
2025-03-09 08:41:52,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 08:41:52,380 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:52
2025-03-09 08:41:52,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:52,380 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:41:52,380 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:52,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:41:52,380 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:52
2025-03-09 08:41:52,380 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:52,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:41:52,381 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:52
2025-03-09 08:41:52,381 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:52,381 [INFO]: 	Creating the index 03/09/2025, 08:41:52
2025-03-09 08:41:52,381 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:52
2025-03-09 08:41:52,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:41:52,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:52
2025-03-09 08:41:52,384 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:41:52,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.88it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.73it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.79it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.38it/s]100%|██████████| 22/22 [00:04<00:00,  4.75it/s]
2025-03-09 08:41:57,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:57
2025-03-09 08:42:39,406 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3828 secs
2025-03-09 08:42:39,407 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 08:42:39,407 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.67it/s]
2025-03-09 08:42:55,296 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8889 secs
2025-03-09 08:42:55,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4460 secs
2025-03-09 08:42:55,831 [INFO]: {
2025-03-09 08:42:55,831 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:55,831 [INFO]: 	index_param: efSearch=165
2025-03-09 08:42:55,831 [INFO]: 	index_path: knn.index
2025-03-09 08:42:55,831 [INFO]: 	size in bytes: 1024249690
2025-03-09 08:42:55,831 [INFO]: 	avg_search_speed_ms: 8.095882211996598
2025-03-09 08:42:55,831 [INFO]: 	99p_search_speed_ms: 17.868907675147067
2025-03-09 08:42:55,831 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:55,831 [INFO]: 	nb vectors: 5206
2025-03-09 08:42:55,831 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:55,831 [INFO]: 	compression ratio: 0.9993083307645424
2025-03-09 08:42:55,831 [INFO]: }
2025-03-09 08:42:55,831 [INFO]: 	>>> Finished "Creating the index" in 63.4503 secs
2025-03-09 08:42:55,831 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4838 secs
2025-03-09 08:42:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 60967 [episode count 10/20]
[retrieval_preprocessing] for episode 77866 [episode count 11/20], we have num_retrieval=np.int64(5162) num_query=np.int64(314)
2025-03-09 08:42:58,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:58,871 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:58
2025-03-09 08:42:58,871 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]
2025-03-09 08:42:58,901 [INFO]: There are 5162 embeddings of dim 49152
2025-03-09 08:42:58,901 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 08:42:58,901 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:58,901 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:42:58,901 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:58,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:58,901 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,901 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:58,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:42:58,901 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:58
2025-03-09 08:42:58,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:58,901 [INFO]: 	Creating the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,901 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:58
2025-03-09 08:42:58,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:42:58,902 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,902 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:42:58,903 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.72it/s] 32%|███▏      | 7/22 [00:00<00:00, 36.13it/s] 59%|█████▉    | 13/22 [00:00<00:00, 45.21it/s] 86%|████████▋ | 19/22 [00:00<00:00, 49.14it/s]100%|██████████| 22/22 [00:04<00:00,  4.47it/s]
2025-03-09 08:43:03,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:03
2025-03-09 08:43:48,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9052 secs
2025-03-09 08:43:48,735 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 08:43:48,735 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.25it/s]
2025-03-09 08:44:07,807 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0722 secs
2025-03-09 08:44:07,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9052 secs
2025-03-09 08:44:07,808 [INFO]: {
2025-03-09 08:44:07,808 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:07,808 [INFO]: 	index_param: efSearch=197
2025-03-09 08:44:07,808 [INFO]: 	index_path: knn.index
2025-03-09 08:44:07,808 [INFO]: 	size in bytes: 1015592770
2025-03-09 08:44:07,808 [INFO]: 	avg_search_speed_ms: 8.832124539061907
2025-03-09 08:44:07,808 [INFO]: 	99p_search_speed_ms: 18.179281132761393
2025-03-09 08:44:07,808 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:07,808 [INFO]: 	nb vectors: 5162
2025-03-09 08:44:07,808 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:07,808 [INFO]: 	compression ratio: 0.9993085082714798
2025-03-09 08:44:07,808 [INFO]: }
2025-03-09 08:44:07,808 [INFO]: 	>>> Finished "Creating the index" in 68.9065 secs
2025-03-09 08:44:07,808 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9370 secs
2025-03-09 08:44:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 77866 [episode count 11/20]
[retrieval_preprocessing] for episode 39980 [episode count 12/20], we have num_retrieval=np.int64(5225) num_query=np.int64(251)
2025-03-09 08:44:10,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:10,724 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:10
2025-03-09 08:44:10,724 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2036.07it/s]
2025-03-09 08:44:10,753 [INFO]: There are 5225 embeddings of dim 49152
2025-03-09 08:44:10,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:44:10,753 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:10
2025-03-09 08:44:10,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:10,753 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:44:10,753 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:10,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:44:10,753 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:10
2025-03-09 08:44:10,753 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:10,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:44:10,754 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:10
2025-03-09 08:44:10,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:10,754 [INFO]: 	Creating the index 03/09/2025, 08:44:10
2025-03-09 08:44:10,754 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:10
2025-03-09 08:44:10,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:44:10,755 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:10
2025-03-09 08:44:10,755 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:44:10,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.38it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.72it/s] 55%|█████▍    | 12/22 [00:00<00:00, 42.13it/s] 82%|████████▏ | 18/22 [00:00<00:00, 47.28it/s]100%|██████████| 22/22 [00:04<00:00,  5.08it/s]
2025-03-09 08:44:15,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:15
2025-03-09 08:44:54,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3892 secs
2025-03-09 08:44:54,481 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 08:44:54,481 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.77it/s]
2025-03-09 08:45:18,089 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6076 secs
2025-03-09 08:45:18,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3346 secs
2025-03-09 08:45:18,089 [INFO]: {
2025-03-09 08:45:18,089 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:18,089 [INFO]: 	index_param: efSearch=227
2025-03-09 08:45:18,089 [INFO]: 	index_path: knn.index
2025-03-09 08:45:18,089 [INFO]: 	size in bytes: 1027987870
2025-03-09 08:45:18,089 [INFO]: 	avg_search_speed_ms: 9.048926806545548
2025-03-09 08:45:18,089 [INFO]: 	99p_search_speed_ms: 17.692635743878782
2025-03-09 08:45:18,089 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:18,089 [INFO]: 	nb vectors: 5225
2025-03-09 08:45:18,089 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:18,089 [INFO]: 	compression ratio: 0.999308289503455
2025-03-09 08:45:18,089 [INFO]: }
2025-03-09 08:45:18,089 [INFO]: 	>>> Finished "Creating the index" in 67.3358 secs
2025-03-09 08:45:18,090 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3658 secs
2025-03-09 08:45:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 39980 [episode count 12/20]
[retrieval_preprocessing] for episode 79918 [episode count 13/20], we have num_retrieval=np.int64(5127) num_query=np.int64(349)
2025-03-09 08:45:21,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:21,958 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:21
2025-03-09 08:45:21,958 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2193.67it/s]
2025-03-09 08:45:21,992 [INFO]: There are 5127 embeddings of dim 49152
2025-03-09 08:45:21,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 08:45:21,992 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:21
2025-03-09 08:45:21,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:21,992 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:45:21,992 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:21,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:45:21,993 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:21
2025-03-09 08:45:21,993 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:21,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:45:21,993 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:21
2025-03-09 08:45:21,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:21,993 [INFO]: 	Creating the index 03/09/2025, 08:45:21
2025-03-09 08:45:21,993 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:21
2025-03-09 08:45:21,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:45:21,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:21
2025-03-09 08:45:21,994 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:45:21,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.86it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.69it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.75it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.55it/s]100%|██████████| 22/22 [00:04<00:00,  4.75it/s]
2025-03-09 08:45:26,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:26
2025-03-09 08:46:05,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3885 secs
2025-03-09 08:46:05,017 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 08:46:05,018 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.56it/s]
2025-03-09 08:46:21,271 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2534 secs
2025-03-09 08:46:21,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2773 secs
2025-03-09 08:46:21,271 [INFO]: {
2025-03-09 08:46:21,272 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:21,272 [INFO]: 	index_param: efSearch=229
2025-03-09 08:46:21,272 [INFO]: 	index_path: knn.index
2025-03-09 08:46:21,272 [INFO]: 	size in bytes: 1008706810
2025-03-09 08:46:21,272 [INFO]: 	avg_search_speed_ms: 11.451860202222772
2025-03-09 08:46:21,272 [INFO]: 	99p_search_speed_ms: 22.099316464737054
2025-03-09 08:46:21,272 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:21,272 [INFO]: 	nb vectors: 5127
2025-03-09 08:46:21,272 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:21,272 [INFO]: 	compression ratio: 0.9993084273913051
2025-03-09 08:46:21,272 [INFO]: }
2025-03-09 08:46:21,272 [INFO]: 	>>> Finished "Creating the index" in 59.2787 secs
2025-03-09 08:46:21,272 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3137 secs
2025-03-09 08:46:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 79918 [episode count 13/20]
[retrieval_preprocessing] for episode 15930 [episode count 14/20], we have num_retrieval=np.int64(5108) num_query=np.int64(368)
2025-03-09 08:46:24,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:25,829 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:25
2025-03-09 08:46:25,829 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2404.99it/s]
2025-03-09 08:46:25,857 [INFO]: There are 5108 embeddings of dim 49152
2025-03-09 08:46:25,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 08:46:25,857 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:25
2025-03-09 08:46:25,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:25,857 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:46:25,857 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:25,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:25,857 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:25
2025-03-09 08:46:25,857 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:25,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:25,857 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:25
2025-03-09 08:46:25,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:25,857 [INFO]: 	Creating the index 03/09/2025, 08:46:25
2025-03-09 08:46:25,857 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:25
2025-03-09 08:46:25,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:46:25,858 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:25
2025-03-09 08:46:25,858 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:46:25,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.51it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.41it/s] 59%|█████▉    | 13/22 [00:00<00:00, 44.39it/s] 82%|████████▏ | 18/22 [00:00<00:00, 42.72it/s]100%|██████████| 22/22 [00:04<00:00,  4.60it/s]
2025-03-09 08:46:30,638 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:30
2025-03-09 08:47:17,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5164 secs
2025-03-09 08:47:17,155 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 08:47:17,155 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.32it/s]
2025-03-09 08:47:39,783 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6272 secs
2025-03-09 08:47:39,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9250 secs
2025-03-09 08:47:39,784 [INFO]: {
2025-03-09 08:47:39,784 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:39,784 [INFO]: 	index_param: efSearch=176
2025-03-09 08:47:39,784 [INFO]: 	index_path: knn.index
2025-03-09 08:47:39,784 [INFO]: 	size in bytes: 1004968630
2025-03-09 08:47:39,784 [INFO]: 	avg_search_speed_ms: 8.779172805817414
2025-03-09 08:47:39,784 [INFO]: 	99p_search_speed_ms: 20.054695210419567
2025-03-09 08:47:39,784 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:39,784 [INFO]: 	nb vectors: 5108
2025-03-09 08:47:39,784 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:39,784 [INFO]: 	compression ratio: 0.9993084699569179
2025-03-09 08:47:39,784 [INFO]: }
2025-03-09 08:47:39,784 [INFO]: 	>>> Finished "Creating the index" in 73.9264 secs
2025-03-09 08:47:39,784 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9550 secs
2025-03-09 08:47:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 15930 [episode count 14/20]
[retrieval_preprocessing] for episode 4674 [episode count 15/20], we have num_retrieval=np.int64(5257) num_query=np.int64(219)
2025-03-09 08:47:43,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:43,798 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:43
2025-03-09 08:47:43,798 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1912.59it/s]
2025-03-09 08:47:43,840 [INFO]: There are 5257 embeddings of dim 49152
2025-03-09 08:47:43,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-09 08:47:43,840 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:43
2025-03-09 08:47:43,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:43,840 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:47:43,840 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:43,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:43,840 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:43
2025-03-09 08:47:43,840 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:43,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:47:43,840 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:43
2025-03-09 08:47:43,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:43,840 [INFO]: 	Creating the index 03/09/2025, 08:47:43
2025-03-09 08:47:43,840 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:43
2025-03-09 08:47:43,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:47:43,841 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:43
2025-03-09 08:47:43,841 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:47:43,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.17it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.61it/s] 50%|█████     | 11/22 [00:00<00:00, 36.50it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.63it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.92it/s]100%|██████████| 22/22 [00:05<00:00,  4.08it/s]
2025-03-09 08:47:49,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:49
2025-03-09 08:48:35,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0514 secs
2025-03-09 08:48:35,295 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:48:35,295 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-09 08:48:58,243 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9474 secs
2025-03-09 08:48:58,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4018 secs
2025-03-09 08:48:58,243 [INFO]: {
2025-03-09 08:48:58,243 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:58,243 [INFO]: 	index_param: efSearch=177
2025-03-09 08:48:58,243 [INFO]: 	index_path: knn.index
2025-03-09 08:48:58,243 [INFO]: 	size in bytes: 1034283730
2025-03-09 08:48:58,243 [INFO]: 	avg_search_speed_ms: 8.944960443506247
2025-03-09 08:48:58,243 [INFO]: 	99p_search_speed_ms: 19.219376263208677
2025-03-09 08:48:58,243 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:58,243 [INFO]: 	nb vectors: 5257
2025-03-09 08:48:58,243 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:58,243 [INFO]: 	compression ratio: 0.9993082420430224
2025-03-09 08:48:58,243 [INFO]: }
2025-03-09 08:48:58,243 [INFO]: 	>>> Finished "Creating the index" in 74.4030 secs
2025-03-09 08:48:58,243 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4456 secs
2025-03-09 08:48:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 4674 [episode count 15/20]
[retrieval_preprocessing] for episode 43077 [episode count 16/20], we have num_retrieval=np.int64(5168) num_query=np.int64(308)
2025-03-09 08:49:00,141 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:01,019 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:01
2025-03-09 08:49:01,020 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1047.79it/s]
2025-03-09 08:49:01,058 [INFO]: There are 5168 embeddings of dim 49152
2025-03-09 08:49:01,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0391 secs
2025-03-09 08:49:01,059 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:01
2025-03-09 08:49:01,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:01,059 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:49:01,059 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:01,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:49:01,060 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:01
2025-03-09 08:49:01,060 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:01,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:49:01,060 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:01
2025-03-09 08:49:01,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:01,060 [INFO]: 	Creating the index 03/09/2025, 08:49:01
2025-03-09 08:49:01,061 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:01
2025-03-09 08:49:01,063 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:49:01,064 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:01
2025-03-09 08:49:01,064 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:49:01,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.35it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.91it/s] 50%|█████     | 11/22 [00:00<00:00, 36.68it/s] 77%|███████▋  | 17/22 [00:00<00:00, 42.53it/s]100%|██████████| 22/22 [00:04<00:00,  2.90it/s]100%|██████████| 22/22 [00:04<00:00,  4.44it/s]
2025-03-09 08:49:06,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:06
2025-03-09 08:49:50,066 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0459 secs
2025-03-09 08:49:50,067 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 08:49:50,067 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.99it/s]
2025-03-09 08:50:11,856 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7891 secs
2025-03-09 08:50:11,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7925 secs
2025-03-09 08:50:11,856 [INFO]: {
2025-03-09 08:50:11,856 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:11,856 [INFO]: 	index_param: efSearch=227
2025-03-09 08:50:11,856 [INFO]: 	index_path: knn.index
2025-03-09 08:50:11,856 [INFO]: 	size in bytes: 1016773330
2025-03-09 08:50:11,856 [INFO]: 	avg_search_speed_ms: 10.539255752771716
2025-03-09 08:50:11,856 [INFO]: 	99p_search_speed_ms: 22.297316580079496
2025-03-09 08:50:11,856 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:11,856 [INFO]: 	nb vectors: 5168
2025-03-09 08:50:11,856 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:11,856 [INFO]: 	compression ratio: 0.9993084141968988
2025-03-09 08:50:11,856 [INFO]: }
2025-03-09 08:50:11,856 [INFO]: 	>>> Finished "Creating the index" in 70.7959 secs
2025-03-09 08:50:11,856 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8367 secs
2025-03-09 08:50:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 43077 [episode count 16/20]
[retrieval_preprocessing] for episode 19014 [episode count 17/20], we have num_retrieval=np.int64(5234) num_query=np.int64(242)
2025-03-09 08:50:15,328 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:16,203 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:16
2025-03-09 08:50:16,203 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]
2025-03-09 08:50:16,235 [INFO]: There are 5234 embeddings of dim 49152
2025-03-09 08:50:16,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-09 08:50:16,235 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:16
2025-03-09 08:50:16,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:16,236 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:50:16,236 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:16,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:16,236 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:16
2025-03-09 08:50:16,236 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:16,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:50:16,236 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:16
2025-03-09 08:50:16,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:16,236 [INFO]: 	Creating the index 03/09/2025, 08:50:16
2025-03-09 08:50:16,236 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:16
2025-03-09 08:50:16,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:50:16,237 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:16
2025-03-09 08:50:16,237 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:50:16,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.41it/s] 27%|██▋       | 6/22 [00:00<00:00, 25.79it/s] 50%|█████     | 11/22 [00:00<00:00, 34.80it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.58it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.16it/s]100%|██████████| 22/22 [00:05<00:00,  4.39it/s]
2025-03-09 08:50:21,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:21
2025-03-09 08:51:06,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3179 secs
2025-03-09 08:51:06,565 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 08:51:06,565 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.28it/s]
2025-03-09 08:51:23,033 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4673 secs
2025-03-09 08:51:23,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7962 secs
2025-03-09 08:51:23,033 [INFO]: {
2025-03-09 08:51:23,033 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:23,033 [INFO]: 	index_param: efSearch=225
2025-03-09 08:51:23,033 [INFO]: 	index_path: knn.index
2025-03-09 08:51:23,033 [INFO]: 	size in bytes: 1029758590
2025-03-09 08:51:23,033 [INFO]: 	avg_search_speed_ms: 10.226628015575843
2025-03-09 08:51:23,033 [INFO]: 	99p_search_speed_ms: 21.355921938084066
2025-03-09 08:51:23,033 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:23,033 [INFO]: 	nb vectors: 5234
2025-03-09 08:51:23,033 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:23,033 [INFO]: 	compression ratio: 0.999308266998773
2025-03-09 08:51:23,033 [INFO]: }
2025-03-09 08:51:23,033 [INFO]: 	>>> Finished "Creating the index" in 66.7972 secs
2025-03-09 08:51:23,033 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8301 secs
2025-03-09 08:51:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 19014 [episode count 17/20]
[retrieval_preprocessing] for episode 54344 [episode count 18/20], we have num_retrieval=np.int64(5108) num_query=np.int64(368)
2025-03-09 08:51:25,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:25,836 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:25
2025-03-09 08:51:25,837 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1739.65it/s]
2025-03-09 08:51:25,864 [INFO]: There are 5108 embeddings of dim 49152
2025-03-09 08:51:25,864 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:51:25,864 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:25
2025-03-09 08:51:25,864 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:25,864 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:51:25,864 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:25,864 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:25,864 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:25
2025-03-09 08:51:25,864 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:25,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:51:25,864 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:25
2025-03-09 08:51:25,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:25,864 [INFO]: 	Creating the index 03/09/2025, 08:51:25
2025-03-09 08:51:25,864 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:25
2025-03-09 08:51:25,865 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:51:25,865 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:25
2025-03-09 08:51:25,865 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:51:25,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.28it/s] 36%|███▋      | 8/22 [00:00<00:00, 42.29it/s] 68%|██████▊   | 15/22 [00:00<00:00, 52.15it/s] 95%|█████████▌| 21/22 [00:03<00:00,  4.15it/s]100%|██████████| 22/22 [00:04<00:00,  5.40it/s]
2025-03-09 08:51:30,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:30
2025-03-09 08:52:12,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9750 secs
2025-03-09 08:52:12,091 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 08:52:12,091 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.13it/s]
2025-03-09 08:52:35,108 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0169 secs
2025-03-09 08:52:35,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2428 secs
2025-03-09 08:52:35,108 [INFO]: {
2025-03-09 08:52:35,108 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:35,108 [INFO]: 	index_param: efSearch=173
2025-03-09 08:52:35,108 [INFO]: 	index_path: knn.index
2025-03-09 08:52:35,108 [INFO]: 	size in bytes: 1004968630
2025-03-09 08:52:35,108 [INFO]: 	avg_search_speed_ms: 8.126636948149006
2025-03-09 08:52:35,108 [INFO]: 	99p_search_speed_ms: 14.64454671368003
2025-03-09 08:52:35,108 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:35,108 [INFO]: 	nb vectors: 5108
2025-03-09 08:52:35,108 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:35,109 [INFO]: 	compression ratio: 0.9993084699569179
2025-03-09 08:52:35,109 [INFO]: }
2025-03-09 08:52:35,109 [INFO]: 	>>> Finished "Creating the index" in 69.2441 secs
2025-03-09 08:52:35,109 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2720 secs
2025-03-09 08:52:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 54344 [episode count 18/20]
[retrieval_preprocessing] for episode 12361 [episode count 19/20], we have num_retrieval=np.int64(5179) num_query=np.int64(297)
2025-03-09 08:52:37,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:38,564 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:38
2025-03-09 08:52:38,564 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1972.86it/s]
2025-03-09 08:52:38,593 [INFO]: There are 5179 embeddings of dim 49152
2025-03-09 08:52:38,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:52:38,594 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:38
2025-03-09 08:52:38,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:38,594 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:52:38,594 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:38,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:38,594 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:38
2025-03-09 08:52:38,594 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:38,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:52:38,594 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:38
2025-03-09 08:52:38,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:38,594 [INFO]: 	Creating the index 03/09/2025, 08:52:38
2025-03-09 08:52:38,594 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:38
2025-03-09 08:52:38,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:52:38,595 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:38
2025-03-09 08:52:38,595 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:52:38,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.97it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.66it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.74it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.01it/s]100%|██████████| 22/22 [00:04<00:00,  4.81it/s]
2025-03-09 08:52:43,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:43
2025-03-09 08:53:28,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5139 secs
2025-03-09 08:53:28,686 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 08:53:28,686 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-09 08:53:47,550 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8637 secs
2025-03-09 08:53:47,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9555 secs
2025-03-09 08:53:47,550 [INFO]: {
2025-03-09 08:53:47,550 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:47,550 [INFO]: 	index_param: efSearch=189
2025-03-09 08:53:47,550 [INFO]: 	index_path: knn.index
2025-03-09 08:53:47,551 [INFO]: 	size in bytes: 1018937470
2025-03-09 08:53:47,551 [INFO]: 	avg_search_speed_ms: 8.710385054622245
2025-03-09 08:53:47,551 [INFO]: 	99p_search_speed_ms: 18.714293874800205
2025-03-09 08:53:47,551 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:47,551 [INFO]: 	nb vectors: 5179
2025-03-09 08:53:47,551 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:47,551 [INFO]: 	compression ratio: 0.9993084580548403
2025-03-09 08:53:47,551 [INFO]: }
2025-03-09 08:53:47,551 [INFO]: 	>>> Finished "Creating the index" in 68.9567 secs
2025-03-09 08:53:47,551 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9869 secs
2025-03-09 08:53:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 12361 [episode count 19/20]
2025-03-09 08:53:49: [retrieval_preprocessing] finished for (3485794757, 'marker') [chosen_id count 5/10]
2025-03-09 08:53:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8756300955, 'block') [chosen_id count 6/10]
2025-03-09 08:53:51: [retrieval_preprocessing] we have num_total=3099 embedding_dim=49152
[retrieval_preprocessing] for episode 7681 [episode count 0/20], we have num_retrieval=np.int64(2974) num_query=np.int64(125)
2025-03-09 08:53:51,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:52,235 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:52
2025-03-09 08:53:52,236 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1993.49it/s]
2025-03-09 08:53:52,264 [INFO]: There are 2974 embeddings of dim 49152
2025-03-09 08:53:52,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 08:53:52,264 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:52
2025-03-09 08:53:52,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:52,264 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:53:52,264 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:52,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:52,264 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:52
2025-03-09 08:53:52,264 [INFO]: 613.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:52,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:53:52,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:52
2025-03-09 08:53:52,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:52,264 [INFO]: 	Creating the index 03/09/2025, 08:53:52
2025-03-09 08:53:52,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:52
2025-03-09 08:53:52,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:53:52,266 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:52
2025-03-09 08:53:52,266 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:53:52,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.09it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.43it/s]100%|██████████| 12/12 [00:02<00:00,  4.12it/s]100%|██████████| 12/12 [00:02<00:00,  5.03it/s]
2025-03-09 08:53:54,657 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:54
2025-03-09 08:54:24,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5100 secs
2025-03-09 08:54:24,167 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:54:24,168 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.90it/s]
2025-03-09 08:54:42,481 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3136 secs
2025-03-09 08:54:42,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2172 secs
2025-03-09 08:54:42,483 [INFO]: {
2025-03-09 08:54:42,483 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:42,483 [INFO]: 	index_param: efSearch=200
2025-03-09 08:54:42,483 [INFO]: 	index_path: knn.index
2025-03-09 08:54:42,483 [INFO]: 	size in bytes: 585116170
2025-03-09 08:54:42,483 [INFO]: 	avg_search_speed_ms: 8.601894753529455
2025-03-09 08:54:42,483 [INFO]: 	99p_search_speed_ms: 17.575377435423416
2025-03-09 08:54:42,483 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:42,483 [INFO]: 	nb vectors: 2974
2025-03-09 08:54:42,483 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:42,483 [INFO]: 	compression ratio: 0.9993095764213797
2025-03-09 08:54:42,483 [INFO]: }
2025-03-09 08:54:42,483 [INFO]: 	>>> Finished "Creating the index" in 50.2189 secs
2025-03-09 08:54:42,483 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2476 secs
2025-03-09 08:54:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 7681 [episode count 0/20]
[retrieval_preprocessing] for episode 55809 [episode count 1/20], we have num_retrieval=np.int64(2953) num_query=np.int64(146)
2025-03-09 08:54:43,508 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:43,874 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:43
2025-03-09 08:54:43,874 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.78it/s]
2025-03-09 08:54:43,899 [INFO]: There are 2953 embeddings of dim 49152
2025-03-09 08:54:43,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:54:43,900 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:43
2025-03-09 08:54:43,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:43,900 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:54:43,900 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:43,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:43,900 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:43
2025-03-09 08:54:43,900 [INFO]: 609.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:43,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:43,900 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:43
2025-03-09 08:54:43,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:43,900 [INFO]: 	Creating the index 03/09/2025, 08:54:43
2025-03-09 08:54:43,900 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:43
2025-03-09 08:54:43,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:54:43,901 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:43
2025-03-09 08:54:43,901 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:54:43,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.76it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.49it/s]
2025-03-09 08:54:46,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:46
2025-03-09 08:55:18,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8324 secs
2025-03-09 08:55:18,411 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 08:55:18,411 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.32it/s]
2025-03-09 08:55:33,912 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5008 secs
2025-03-09 08:55:33,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0129 secs
2025-03-09 08:55:33,914 [INFO]: {
2025-03-09 08:55:33,914 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:33,914 [INFO]: 	index_param: efSearch=154
2025-03-09 08:55:33,915 [INFO]: 	index_path: knn.index
2025-03-09 08:55:33,915 [INFO]: 	size in bytes: 580984510
2025-03-09 08:55:33,915 [INFO]: 	avg_search_speed_ms: 7.148814693012084
2025-03-09 08:55:33,915 [INFO]: 	99p_search_speed_ms: 14.649835773743687
2025-03-09 08:55:33,915 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:33,915 [INFO]: 	nb vectors: 2953
2025-03-09 08:55:33,915 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:33,915 [INFO]: 	compression ratio: 0.9993096442450763
2025-03-09 08:55:33,915 [INFO]: }
2025-03-09 08:55:33,915 [INFO]: 	>>> Finished "Creating the index" in 50.0146 secs
2025-03-09 08:55:33,915 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0405 secs
2025-03-09 08:55:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 55809 [episode count 1/20]
[retrieval_preprocessing] for episode 32260 [episode count 2/20], we have num_retrieval=np.int64(2973) num_query=np.int64(126)
2025-03-09 08:55:35,387 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:35,830 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:35
2025-03-09 08:55:35,830 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1780.26it/s]
2025-03-09 08:55:35,855 [INFO]: There are 2973 embeddings of dim 49152
2025-03-09 08:55:35,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:55:35,855 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:35
2025-03-09 08:55:35,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:35,855 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:55:35,855 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:35,855 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:35,855 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:35
2025-03-09 08:55:35,856 [INFO]: 613.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:35,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:55:35,856 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:35
2025-03-09 08:55:35,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:35,856 [INFO]: 	Creating the index 03/09/2025, 08:55:35
2025-03-09 08:55:35,856 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:35
2025-03-09 08:55:35,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:55:35,857 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:35
2025-03-09 08:55:35,857 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:55:35,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.88it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.32it/s] 83%|████████▎ | 10/12 [00:00<00:00, 35.09it/s]100%|██████████| 12/12 [00:03<00:00,  4.00it/s]
2025-03-09 08:55:38,863 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:38
2025-03-09 08:56:12,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9126 secs
2025-03-09 08:56:12,776 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 08:56:12,776 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.49it/s]
2025-03-09 08:56:26,467 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6910 secs
2025-03-09 08:56:26,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6122 secs
2025-03-09 08:56:26,469 [INFO]: {
2025-03-09 08:56:26,469 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:26,469 [INFO]: 	index_param: efSearch=195
2025-03-09 08:56:26,469 [INFO]: 	index_path: knn.index
2025-03-09 08:56:26,469 [INFO]: 	size in bytes: 584919430
2025-03-09 08:56:26,469 [INFO]: 	avg_search_speed_ms: 9.40239630137129
2025-03-09 08:56:26,469 [INFO]: 	99p_search_speed_ms: 21.800745620857896
2025-03-09 08:56:26,469 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:26,469 [INFO]: 	nb vectors: 2973
2025-03-09 08:56:26,469 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:26,469 [INFO]: 	compression ratio: 0.9993095698667421
2025-03-09 08:56:26,469 [INFO]: }
2025-03-09 08:56:26,469 [INFO]: 	>>> Finished "Creating the index" in 50.6134 secs
2025-03-09 08:56:26,469 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6389 secs
2025-03-09 08:56:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 32260 [episode count 2/20]
[retrieval_preprocessing] for episode 50701 [episode count 3/20], we have num_retrieval=np.int64(2849) num_query=np.int64(250)
2025-03-09 08:56:27,729 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:28,091 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:28
2025-03-09 08:56:28,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2003.01it/s]
2025-03-09 08:56:28,118 [INFO]: There are 2849 embeddings of dim 49152
2025-03-09 08:56:28,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 08:56:28,119 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:28
2025-03-09 08:56:28,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:28,119 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:56:28,119 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:28,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:56:28,119 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:28
2025-03-09 08:56:28,119 [INFO]: 588.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:28,119 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:56:28,119 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:28
2025-03-09 08:56:28,119 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:28,119 [INFO]: 	Creating the index 03/09/2025, 08:56:28
2025-03-09 08:56:28,119 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:28
2025-03-09 08:56:28,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:56:28,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:28
2025-03-09 08:56:28,120 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:56:28,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.98it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.02it/s]100%|██████████| 12/12 [00:02<00:00,  3.98it/s]100%|██████████| 12/12 [00:02<00:00,  5.00it/s]
2025-03-09 08:56:30,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:30
2025-03-09 08:57:01,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7535 secs
2025-03-09 08:57:01,276 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 08:57:01,276 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.04it/s]
2025-03-09 08:57:20,951 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6749 secs
2025-03-09 08:57:20,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8325 secs
2025-03-09 08:57:20,953 [INFO]: {
2025-03-09 08:57:20,953 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:20,953 [INFO]: 	index_param: efSearch=229
2025-03-09 08:57:20,953 [INFO]: 	index_path: knn.index
2025-03-09 08:57:20,953 [INFO]: 	size in bytes: 560523130
2025-03-09 08:57:20,953 [INFO]: 	avg_search_speed_ms: 9.716093346731785
2025-03-09 08:57:20,953 [INFO]: 	99p_search_speed_ms: 17.622794741764668
2025-03-09 08:57:20,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:20,953 [INFO]: 	nb vectors: 2849
2025-03-09 08:57:20,953 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:20,953 [INFO]: 	compression ratio: 0.9993096841516602
2025-03-09 08:57:20,953 [INFO]: }
2025-03-09 08:57:20,953 [INFO]: 	>>> Finished "Creating the index" in 52.8338 secs
2025-03-09 08:57:20,953 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8618 secs
2025-03-09 08:57:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 50701 [episode count 3/20]
[retrieval_preprocessing] for episode 66068 [episode count 4/20], we have num_retrieval=np.int64(2985) num_query=np.int64(114)
2025-03-09 08:57:23,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:23,707 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:23
2025-03-09 08:57:23,708 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1962.71it/s]
2025-03-09 08:57:23,732 [INFO]: There are 2985 embeddings of dim 49152
2025-03-09 08:57:23,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:57:23,733 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:23
2025-03-09 08:57:23,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:23,733 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:57:23,733 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:23,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:23,733 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:23
2025-03-09 08:57:23,733 [INFO]: 616.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:23,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:57:23,733 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:23
2025-03-09 08:57:23,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:23,733 [INFO]: 	Creating the index 03/09/2025, 08:57:23
2025-03-09 08:57:23,733 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:23
2025-03-09 08:57:23,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:57:23,734 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:23
2025-03-09 08:57:23,734 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:57:23,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.97it/s] 75%|███████▌  | 9/12 [00:00<00:00, 43.86it/s]100%|██████████| 12/12 [00:02<00:00,  5.50it/s]
2025-03-09 08:57:25,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:25
2025-03-09 08:57:56,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5382 secs
2025-03-09 08:57:56,458 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:57:56,458 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.13it/s]
2025-03-09 08:58:15,011 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5528 secs
2025-03-09 08:58:15,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2782 secs
2025-03-09 08:58:15,013 [INFO]: {
2025-03-09 08:58:15,013 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:15,013 [INFO]: 	index_param: efSearch=217
2025-03-09 08:58:15,013 [INFO]: 	index_path: knn.index
2025-03-09 08:58:15,013 [INFO]: 	size in bytes: 587280310
2025-03-09 08:58:15,013 [INFO]: 	avg_search_speed_ms: 9.562051906891481
2025-03-09 08:58:15,013 [INFO]: 	99p_search_speed_ms: 18.772414268460114
2025-03-09 08:58:15,013 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:15,013 [INFO]: 	nb vectors: 2985
2025-03-09 08:58:15,013 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:15,013 [INFO]: 	compression ratio: 0.9993096482325451
2025-03-09 08:58:15,013 [INFO]: }
2025-03-09 08:58:15,013 [INFO]: 	>>> Finished "Creating the index" in 51.2796 secs
2025-03-09 08:58:15,013 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3052 secs
2025-03-09 08:58:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 66068 [episode count 4/20]
[retrieval_preprocessing] for episode 64534 [episode count 5/20], we have num_retrieval=np.int64(2910) num_query=np.int64(189)
2025-03-09 08:58:16,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:16,510 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:16
2025-03-09 08:58:16,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.57it/s]
2025-03-09 08:58:16,533 [INFO]: There are 2910 embeddings of dim 49152
2025-03-09 08:58:16,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 08:58:16,534 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:16
2025-03-09 08:58:16,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:16,534 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:58:16,534 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:16,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:16,534 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:16
2025-03-09 08:58:16,534 [INFO]: 600.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:16,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:16,534 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:16
2025-03-09 08:58:16,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:16,534 [INFO]: 	Creating the index 03/09/2025, 08:58:16
2025-03-09 08:58:16,534 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:16
2025-03-09 08:58:16,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:58:16,535 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:16
2025-03-09 08:58:16,535 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:58:16,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.42it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.03it/s]100%|██████████| 12/12 [00:02<00:00,  4.34it/s]100%|██████████| 12/12 [00:02<00:00,  5.14it/s]
2025-03-09 08:58:18,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:18
2025-03-09 08:58:44,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3539 secs
2025-03-09 08:58:44,225 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 08:58:44,225 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]
2025-03-09 08:58:56,951 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7260 secs
2025-03-09 08:58:56,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4180 secs
2025-03-09 08:58:56,953 [INFO]: {
2025-03-09 08:58:56,953 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:56,953 [INFO]: 	index_param: efSearch=249
2025-03-09 08:58:56,953 [INFO]: 	index_path: knn.index
2025-03-09 08:58:56,953 [INFO]: 	size in bytes: 572524390
2025-03-09 08:58:56,953 [INFO]: 	avg_search_speed_ms: 9.527461788883167
2025-03-09 08:58:56,953 [INFO]: 	99p_search_speed_ms: 22.563942405395203
2025-03-09 08:58:56,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:56,953 [INFO]: 	nb vectors: 2910
2025-03-09 08:58:56,953 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:56,953 [INFO]: 	compression ratio: 0.9993098809292649
2025-03-09 08:58:56,953 [INFO]: }
2025-03-09 08:58:56,953 [INFO]: 	>>> Finished "Creating the index" in 40.4193 secs
2025-03-09 08:58:56,953 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4434 secs
2025-03-09 08:58:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 64534 [episode count 5/20]
[retrieval_preprocessing] for episode 34330 [episode count 6/20], we have num_retrieval=np.int64(2967) num_query=np.int64(132)
2025-03-09 08:58:59,112 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:59,500 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:59
2025-03-09 08:58:59,500 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.19it/s]
2025-03-09 08:58:59,525 [INFO]: There are 2967 embeddings of dim 49152
2025-03-09 08:58:59,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:58:59,525 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:59
2025-03-09 08:58:59,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:59,525 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:58:59,525 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:59,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:59,525 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:59
2025-03-09 08:58:59,526 [INFO]: 612.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:59,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:59,526 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:59
2025-03-09 08:58:59,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:59,526 [INFO]: 	Creating the index 03/09/2025, 08:58:59
2025-03-09 08:58:59,526 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:59
2025-03-09 08:58:59,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:58:59,527 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:59
2025-03-09 08:58:59,527 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:58:59,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.04it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.87it/s]100%|██████████| 12/12 [00:02<00:00,  4.34it/s]100%|██████████| 12/12 [00:02<00:00,  5.43it/s]
2025-03-09 08:59:01,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:01
2025-03-09 08:59:30,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0579 secs
2025-03-09 08:59:30,797 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 08:59:30,797 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.65it/s]
2025-03-09 08:59:51,844 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0466 secs
2025-03-09 08:59:51,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3185 secs
2025-03-09 08:59:51,845 [INFO]: {
2025-03-09 08:59:51,845 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:51,845 [INFO]: 	index_param: efSearch=182
2025-03-09 08:59:51,845 [INFO]: 	index_path: knn.index
2025-03-09 08:59:51,845 [INFO]: 	size in bytes: 583738930
2025-03-09 08:59:51,845 [INFO]: 	avg_search_speed_ms: 7.815479949022119
2025-03-09 08:59:51,845 [INFO]: 	99p_search_speed_ms: 11.905605960637335
2025-03-09 08:59:51,845 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:51,845 [INFO]: 	nb vectors: 2967
2025-03-09 08:59:51,845 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:51,845 [INFO]: 	compression ratio: 0.9993096331608379
2025-03-09 08:59:51,845 [INFO]: }
2025-03-09 08:59:51,845 [INFO]: 	>>> Finished "Creating the index" in 52.3198 secs
2025-03-09 08:59:51,845 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3459 secs
2025-03-09 08:59:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 34330 [episode count 6/20]
[retrieval_preprocessing] for episode 53287 [episode count 7/20], we have num_retrieval=np.int64(2981) num_query=np.int64(118)
2025-03-09 08:59:53,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:53,472 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:53
2025-03-09 08:59:53,472 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1845.27it/s]
2025-03-09 08:59:53,496 [INFO]: There are 2981 embeddings of dim 49152
2025-03-09 08:59:53,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:59:53,497 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:53,497 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:59:53,497 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:53,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:59:53,497 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,497 [INFO]: 615.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:53,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:59:53,497 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:53
2025-03-09 08:59:53,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:53,497 [INFO]: 	Creating the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,497 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:53
2025-03-09 08:59:53,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:59:53,498 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,498 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:59:53,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.92it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.71it/s]100%|██████████| 12/12 [00:02<00:00,  3.74it/s]100%|██████████| 12/12 [00:02<00:00,  4.58it/s]
2025-03-09 08:59:56,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:56
2025-03-09 09:00:26,299 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1769 secs
2025-03-09 09:00:26,299 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 09:00:26,299 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-09 09:00:42,049 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7498 secs
2025-03-09 09:00:42,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5527 secs
2025-03-09 09:00:42,051 [INFO]: {
2025-03-09 09:00:42,051 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:42,051 [INFO]: 	index_param: efSearch=197
2025-03-09 09:00:42,051 [INFO]: 	index_path: knn.index
2025-03-09 09:00:42,051 [INFO]: 	size in bytes: 586493350
2025-03-09 09:00:42,051 [INFO]: 	avg_search_speed_ms: 8.91133217301233
2025-03-09 09:00:42,051 [INFO]: 	99p_search_speed_ms: 16.551607192959608
2025-03-09 09:00:42,051 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:42,051 [INFO]: 	nb vectors: 2981
2025-03-09 09:00:42,051 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:42,051 [INFO]: 	compression ratio: 0.9993096221807118
2025-03-09 09:00:42,051 [INFO]: }
2025-03-09 09:00:42,051 [INFO]: 	>>> Finished "Creating the index" in 48.5540 secs
2025-03-09 09:00:42,051 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5792 secs
2025-03-09 09:00:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 53287 [episode count 7/20]
[retrieval_preprocessing] for episode 41 [episode count 8/20], we have num_retrieval=np.int64(2975) num_query=np.int64(124)
2025-03-09 09:00:43,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:43,557 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:43
2025-03-09 09:00:43,557 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-09 09:00:43,581 [INFO]: There are 2975 embeddings of dim 49152
2025-03-09 09:00:43,582 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 09:00:43,582 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:43
2025-03-09 09:00:43,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:43,582 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:00:43,582 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:43,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:00:43,583 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:43
2025-03-09 09:00:43,583 [INFO]: 614.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:43,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:00:43,584 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:43
2025-03-09 09:00:43,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:43,584 [INFO]: 	Creating the index 03/09/2025, 09:00:43
2025-03-09 09:00:43,584 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:43
2025-03-09 09:00:43,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:00:43,587 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:43
2025-03-09 09:00:43,587 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:00:43,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 24.52it/s] 67%|██████▋   | 8/12 [00:00<00:00, 36.94it/s]100%|██████████| 12/12 [00:02<00:00,  4.06it/s]100%|██████████| 12/12 [00:02<00:00,  5.20it/s]
2025-03-09 09:00:45,900 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:45
2025-03-09 09:01:13,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5622 secs
2025-03-09 09:01:13,463 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 09:01:13,463 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-09 09:01:31,135 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6715 secs
2025-03-09 09:01:31,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5490 secs
2025-03-09 09:01:31,136 [INFO]: {
2025-03-09 09:01:31,136 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:31,136 [INFO]: 	index_param: efSearch=218
2025-03-09 09:01:31,136 [INFO]: 	index_path: knn.index
2025-03-09 09:01:31,136 [INFO]: 	size in bytes: 585312910
2025-03-09 09:01:31,136 [INFO]: 	avg_search_speed_ms: 9.125409022621117
2025-03-09 09:01:31,136 [INFO]: 	99p_search_speed_ms: 20.541212183888987
2025-03-09 09:01:31,137 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:31,137 [INFO]: 	nb vectors: 2975
2025-03-09 09:01:31,137 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:31,137 [INFO]: 	compression ratio: 0.9993095829716109
2025-03-09 09:01:31,137 [INFO]: }
2025-03-09 09:01:31,137 [INFO]: 	>>> Finished "Creating the index" in 47.5526 secs
2025-03-09 09:01:31,137 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5791 secs
2025-03-09 09:01:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 41 [episode count 8/20]
[retrieval_preprocessing] for episode 82474 [episode count 9/20], we have num_retrieval=np.int64(2848) num_query=np.int64(251)
2025-03-09 09:01:32,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:32,929 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:32
2025-03-09 09:01:32,929 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1901.32it/s]
2025-03-09 09:01:32,953 [INFO]: There are 2848 embeddings of dim 49152
2025-03-09 09:01:32,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:01:32,953 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:32
2025-03-09 09:01:32,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:32,953 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:01:32,953 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:32,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:32,953 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:32
2025-03-09 09:01:32,953 [INFO]: 587.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:32,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:01:32,953 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:32
2025-03-09 09:01:32,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:32,953 [INFO]: 	Creating the index 03/09/2025, 09:01:32
2025-03-09 09:01:32,953 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:32
2025-03-09 09:01:32,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:01:32,954 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:32
2025-03-09 09:01:32,954 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:01:32,954 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.22it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.23it/s]100%|██████████| 12/12 [00:02<00:00,  5.42it/s]
2025-03-09 09:01:35,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:35
2025-03-09 09:02:02,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8376 secs
2025-03-09 09:02:02,010 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 09:02:02,011 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.97it/s]
2025-03-09 09:02:19,520 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5094 secs
2025-03-09 09:02:19,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5675 secs
2025-03-09 09:02:19,522 [INFO]: {
2025-03-09 09:02:19,522 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:19,522 [INFO]: 	index_param: efSearch=231
2025-03-09 09:02:19,522 [INFO]: 	index_path: knn.index
2025-03-09 09:02:19,522 [INFO]: 	size in bytes: 560326390
2025-03-09 09:02:19,522 [INFO]: 	avg_search_speed_ms: 9.969233654428319
2025-03-09 09:02:19,522 [INFO]: 	99p_search_speed_ms: 19.8680226597935
2025-03-09 09:02:19,522 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:19,522 [INFO]: 	nb vectors: 2848
2025-03-09 09:02:19,522 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:19,522 [INFO]: 	compression ratio: 0.9993096773471619
2025-03-09 09:02:19,522 [INFO]: }
2025-03-09 09:02:19,522 [INFO]: 	>>> Finished "Creating the index" in 46.5688 secs
2025-03-09 09:02:19,522 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5935 secs
2025-03-09 09:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 82474 [episode count 9/20]
[retrieval_preprocessing] for episode 94250 [episode count 10/20], we have num_retrieval=np.int64(2967) num_query=np.int64(132)
2025-03-09 09:02:22,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:23,240 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:23
2025-03-09 09:02:23,240 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.18it/s]
2025-03-09 09:02:23,264 [INFO]: There are 2967 embeddings of dim 49152
2025-03-09 09:02:23,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 09:02:23,264 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:23
2025-03-09 09:02:23,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:23,265 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:02:23,265 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:23,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:02:23,265 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:23
2025-03-09 09:02:23,265 [INFO]: 612.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:23,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:02:23,265 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:23
2025-03-09 09:02:23,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:23,265 [INFO]: 	Creating the index 03/09/2025, 09:02:23
2025-03-09 09:02:23,266 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:23
2025-03-09 09:02:23,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:02:23,267 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:23
2025-03-09 09:02:23,267 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:02:23,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.22it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.47it/s]100%|██████████| 12/12 [00:02<00:00,  3.64it/s]100%|██████████| 12/12 [00:02<00:00,  4.60it/s]
2025-03-09 09:02:25,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:25
2025-03-09 09:02:55,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0166 secs
2025-03-09 09:02:55,898 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:02:55,898 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-09 09:03:13,247 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3484 secs
2025-03-09 09:03:13,248 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9815 secs
2025-03-09 09:03:13,248 [INFO]: {
2025-03-09 09:03:13,248 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:13,248 [INFO]: 	index_param: efSearch=186
2025-03-09 09:03:13,248 [INFO]: 	index_path: knn.index
2025-03-09 09:03:13,248 [INFO]: 	size in bytes: 583738930
2025-03-09 09:03:13,248 [INFO]: 	avg_search_speed_ms: 8.481905289686287
2025-03-09 09:03:13,248 [INFO]: 	99p_search_speed_ms: 18.737146472558386
2025-03-09 09:03:13,248 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:13,248 [INFO]: 	nb vectors: 2967
2025-03-09 09:03:13,248 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:13,248 [INFO]: 	compression ratio: 0.9993096331608379
2025-03-09 09:03:13,248 [INFO]: }
2025-03-09 09:03:13,248 [INFO]: 	>>> Finished "Creating the index" in 49.9830 secs
2025-03-09 09:03:13,248 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0083 secs
2025-03-09 09:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 94250 [episode count 10/20]
[retrieval_preprocessing] for episode 75309 [episode count 11/20], we have num_retrieval=np.int64(2970) num_query=np.int64(129)
2025-03-09 09:03:14,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:14,691 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:14
2025-03-09 09:03:14,691 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1867.46it/s]
2025-03-09 09:03:14,721 [INFO]: There are 2970 embeddings of dim 49152
2025-03-09 09:03:14,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:03:14,722 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:14
2025-03-09 09:03:14,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:14,722 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:03:14,722 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:14,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:03:14,722 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:14
2025-03-09 09:03:14,722 [INFO]: 612.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:14,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:03:14,722 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:14
2025-03-09 09:03:14,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:14,722 [INFO]: 	Creating the index 03/09/2025, 09:03:14
2025-03-09 09:03:14,722 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:14
2025-03-09 09:03:14,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:03:14,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:14
2025-03-09 09:03:14,724 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:03:14,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.40it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.77it/s]100%|██████████| 12/12 [00:02<00:00,  4.47it/s]100%|██████████| 12/12 [00:02<00:00,  5.43it/s]
2025-03-09 09:03:16,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:16
2025-03-09 09:03:46,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1949 secs
2025-03-09 09:03:46,132 [INFO]: The best hyperparameters are: efSearch=122
2025-03-09 09:03:46,132 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.38it/s]
2025-03-09 09:03:59,663 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5309 secs
2025-03-09 09:03:59,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9410 secs
2025-03-09 09:03:59,665 [INFO]: {
2025-03-09 09:03:59,665 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:59,665 [INFO]: 	index_param: efSearch=122
2025-03-09 09:03:59,665 [INFO]: 	index_path: knn.index
2025-03-09 09:03:59,665 [INFO]: 	size in bytes: 584329210
2025-03-09 09:03:59,665 [INFO]: 	avg_search_speed_ms: 6.507309146248493
2025-03-09 09:03:59,665 [INFO]: 	99p_search_speed_ms: 15.528439334593715
2025-03-09 09:03:59,665 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:59,665 [INFO]: 	nb vectors: 2970
2025-03-09 09:03:59,665 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:59,665 [INFO]: 	compression ratio: 0.9993095501763467
2025-03-09 09:03:59,665 [INFO]: }
2025-03-09 09:03:59,665 [INFO]: 	>>> Finished "Creating the index" in 44.9428 secs
2025-03-09 09:03:59,665 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9739 secs
2025-03-09 09:03:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 75309 [episode count 11/20]
[retrieval_preprocessing] for episode 37934 [episode count 12/20], we have num_retrieval=np.int64(2951) num_query=np.int64(148)
2025-03-09 09:04:00,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:01,046 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:01
2025-03-09 09:04:01,046 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1902.18it/s]
2025-03-09 09:04:01,072 [INFO]: There are 2951 embeddings of dim 49152
2025-03-09 09:04:01,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:04:01,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:01
2025-03-09 09:04:01,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:01,073 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:04:01,073 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:01,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:01,073 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:01
2025-03-09 09:04:01,073 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:01,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:04:01,073 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:01
2025-03-09 09:04:01,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:01,073 [INFO]: 	Creating the index 03/09/2025, 09:04:01
2025-03-09 09:04:01,073 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:01
2025-03-09 09:04:01,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:04:01,074 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:01
2025-03-09 09:04:01,074 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:04:01,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.58it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.19it/s]100%|██████████| 12/12 [00:02<00:00,  4.49it/s]100%|██████████| 12/12 [00:02<00:00,  5.30it/s]
2025-03-09 09:04:03,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:03
2025-03-09 09:04:31,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0763 secs
2025-03-09 09:04:31,417 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:04:31,417 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.33it/s]
2025-03-09 09:04:47,442 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0253 secs
2025-03-09 09:04:47,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3699 secs
2025-03-09 09:04:47,444 [INFO]: {
2025-03-09 09:04:47,444 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:47,444 [INFO]: 	index_param: efSearch=252
2025-03-09 09:04:47,444 [INFO]: 	index_path: knn.index
2025-03-09 09:04:47,444 [INFO]: 	size in bytes: 580590910
2025-03-09 09:04:47,444 [INFO]: 	avg_search_speed_ms: 11.474168853014024
2025-03-09 09:04:47,445 [INFO]: 	99p_search_speed_ms: 23.057574983686198
2025-03-09 09:04:47,445 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:47,445 [INFO]: 	nb vectors: 2951
2025-03-09 09:04:47,445 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:47,445 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-09 09:04:47,445 [INFO]: }
2025-03-09 09:04:47,445 [INFO]: 	>>> Finished "Creating the index" in 46.3713 secs
2025-03-09 09:04:47,445 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3987 secs
2025-03-09 09:04:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 37934 [episode count 12/20]
[retrieval_preprocessing] for episode 74290 [episode count 13/20], we have num_retrieval=np.int64(2944) num_query=np.int64(155)
2025-03-09 09:04:49,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:49,733 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:49
2025-03-09 09:04:49,733 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.48it/s]
2025-03-09 09:04:49,763 [INFO]: There are 2944 embeddings of dim 49152
2025-03-09 09:04:49,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:04:49,763 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:49,763 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:04:49,763 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:49,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:49,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,763 [INFO]: 607.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:49,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:04:49,763 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:49
2025-03-09 09:04:49,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:49,763 [INFO]: 	Creating the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,763 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:49
2025-03-09 09:04:49,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:04:49,764 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:04:49,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.79it/s] 50%|█████     | 6/12 [00:00<00:00, 28.02it/s] 83%|████████▎ | 10/12 [00:00<00:00, 32.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.39it/s]
2025-03-09 09:04:52,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:52
2025-03-09 09:05:21,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7292 secs
2025-03-09 09:05:21,231 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 09:05:21,231 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-09 09:05:38,663 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4327 secs
2025-03-09 09:05:38,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9013 secs
2025-03-09 09:05:38,666 [INFO]: {
2025-03-09 09:05:38,666 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:38,666 [INFO]: 	index_param: efSearch=213
2025-03-09 09:05:38,666 [INFO]: 	index_path: knn.index
2025-03-09 09:05:38,666 [INFO]: 	size in bytes: 579213730
2025-03-09 09:05:38,666 [INFO]: 	avg_search_speed_ms: 8.75448675939549
2025-03-09 09:05:38,666 [INFO]: 	99p_search_speed_ms: 13.089275422971689
2025-03-09 09:05:38,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:38,666 [INFO]: 	nb vectors: 2944
2025-03-09 09:05:38,666 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:38,666 [INFO]: 	compression ratio: 0.9993097919139451
2025-03-09 09:05:38,666 [INFO]: }
2025-03-09 09:05:38,666 [INFO]: 	>>> Finished "Creating the index" in 48.9025 secs
2025-03-09 09:05:38,666 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9333 secs
2025-03-09 09:05:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 74290 [episode count 13/20]
[retrieval_preprocessing] for episode 55863 [episode count 14/20], we have num_retrieval=np.int64(2927) num_query=np.int64(172)
2025-03-09 09:05:41,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:41,714 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:41
2025-03-09 09:05:41,714 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.76it/s]
2025-03-09 09:05:41,747 [INFO]: There are 2927 embeddings of dim 49152
2025-03-09 09:05:41,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 09:05:41,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:41
2025-03-09 09:05:41,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:41,747 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:05:41,747 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:41,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:05:41,747 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:41
2025-03-09 09:05:41,748 [INFO]: 604.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:41,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:05:41,748 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:41
2025-03-09 09:05:41,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:41,748 [INFO]: 	Creating the index 03/09/2025, 09:05:41
2025-03-09 09:05:41,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:41
2025-03-09 09:05:41,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:05:41,749 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:41
2025-03-09 09:05:41,749 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:05:41,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.62it/s] 50%|█████     | 6/12 [00:00<00:00, 27.29it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.64it/s]100%|██████████| 12/12 [00:02<00:00,  4.69it/s]
2025-03-09 09:05:44,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:44
2025-03-09 09:06:13,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0400 secs
2025-03-09 09:06:13,353 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 09:06:13,353 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.23it/s]
2025-03-09 09:06:30,951 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5976 secs
2025-03-09 09:06:30,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2038 secs
2025-03-09 09:06:30,953 [INFO]: {
2025-03-09 09:06:30,953 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:30,953 [INFO]: 	index_param: efSearch=234
2025-03-09 09:06:30,953 [INFO]: 	index_path: knn.index
2025-03-09 09:06:30,953 [INFO]: 	size in bytes: 575869030
2025-03-09 09:06:30,953 [INFO]: 	avg_search_speed_ms: 9.980534457326486
2025-03-09 09:06:30,953 [INFO]: 	99p_search_speed_ms: 21.25645044725389
2025-03-09 09:06:30,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:30,953 [INFO]: 	nb vectors: 2927
2025-03-09 09:06:30,953 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:30,953 [INFO]: 	compression ratio: 0.9993098882223272
2025-03-09 09:06:30,953 [INFO]: }
2025-03-09 09:06:30,953 [INFO]: 	>>> Finished "Creating the index" in 49.2051 secs
2025-03-09 09:06:30,953 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2385 secs
2025-03-09 09:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 55863 [episode count 14/20]
[retrieval_preprocessing] for episode 45112 [episode count 15/20], we have num_retrieval=np.int64(2923) num_query=np.int64(176)
2025-03-09 09:06:32,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:33,327 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:33
2025-03-09 09:06:33,328 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2304.56it/s]
2025-03-09 09:06:33,353 [INFO]: There are 2923 embeddings of dim 49152
2025-03-09 09:06:33,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:06:33,353 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,353 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:33,353 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:06:33,353 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:06:33,353 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:06:33,353 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,353 [INFO]: 603.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:33,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:06:33,353 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:33
2025-03-09 09:06:33,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:06:33,353 [INFO]: 	Creating the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,353 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:06:33
2025-03-09 09:06:33,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:06:33,355 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,355 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:06:33,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.43it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.85it/s]100%|██████████| 12/12 [00:02<00:00,  3.66it/s]100%|██████████| 12/12 [00:02<00:00,  4.39it/s]
2025-03-09 09:06:36,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:06:36
2025-03-09 09:07:05,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3073 secs
2025-03-09 09:07:05,402 [INFO]: The best hyperparameters are: efSearch=135
2025-03-09 09:07:05,402 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.48it/s]
2025-03-09 09:07:22,210 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8084 secs
2025-03-09 09:07:22,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8575 secs
2025-03-09 09:07:22,213 [INFO]: {
2025-03-09 09:07:22,213 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:22,213 [INFO]: 	index_param: efSearch=135
2025-03-09 09:07:22,213 [INFO]: 	index_path: knn.index
2025-03-09 09:07:22,213 [INFO]: 	size in bytes: 575082070
2025-03-09 09:07:22,213 [INFO]: 	avg_search_speed_ms: 7.806372647569932
2025-03-09 09:07:22,213 [INFO]: 	99p_search_speed_ms: 17.65536908060314
2025-03-09 09:07:22,213 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:22,213 [INFO]: 	nb vectors: 2923
2025-03-09 09:07:22,213 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:22,213 [INFO]: 	compression ratio: 0.9993098619819603
2025-03-09 09:07:22,213 [INFO]: }
2025-03-09 09:07:22,213 [INFO]: 	>>> Finished "Creating the index" in 48.8595 secs
2025-03-09 09:07:22,213 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8854 secs
2025-03-09 09:07:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 45112 [episode count 15/20]
[retrieval_preprocessing] for episode 13893 [episode count 16/20], we have num_retrieval=np.int64(2948) num_query=np.int64(151)
2025-03-09 09:07:23,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:23,924 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:23
2025-03-09 09:07:23,924 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1828.38it/s]
2025-03-09 09:07:23,950 [INFO]: There are 2948 embeddings of dim 49152
2025-03-09 09:07:23,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:07:23,950 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:23,950 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:07:23,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:23,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:07:23,950 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,950 [INFO]: 608.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:23,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:07:23,950 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:23
2025-03-09 09:07:23,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:23,950 [INFO]: 	Creating the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,951 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:23
2025-03-09 09:07:23,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:07:23,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,952 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:07:23,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.05it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.13it/s]
2025-03-09 09:07:26,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:26
2025-03-09 09:07:56,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4868 secs
2025-03-09 09:07:56,345 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 09:07:56,346 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.70it/s]
2025-03-09 09:08:12,232 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8866 secs
2025-03-09 09:08:12,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2819 secs
2025-03-09 09:08:12,234 [INFO]: {
2025-03-09 09:08:12,234 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:12,234 [INFO]: 	index_param: efSearch=220
2025-03-09 09:08:12,234 [INFO]: 	index_path: knn.index
2025-03-09 09:08:12,234 [INFO]: 	size in bytes: 580000690
2025-03-09 09:08:12,234 [INFO]: 	avg_search_speed_ms: 9.785417101251184
2025-03-09 09:08:12,234 [INFO]: 	99p_search_speed_ms: 16.98452146258201
2025-03-09 09:08:12,234 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:12,234 [INFO]: 	nb vectors: 2948
2025-03-09 09:08:12,234 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:12,234 [INFO]: 	compression ratio: 0.9993098180624578
2025-03-09 09:08:12,234 [INFO]: }
2025-03-09 09:08:12,234 [INFO]: 	>>> Finished "Creating the index" in 48.2835 secs
2025-03-09 09:08:12,234 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3103 secs
2025-03-09 09:08:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 13893 [episode count 16/20]
[retrieval_preprocessing] for episode 80459 [episode count 17/20], we have num_retrieval=np.int64(2977) num_query=np.int64(122)
2025-03-09 09:08:13,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:13,973 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:13
2025-03-09 09:08:13,973 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1797.05it/s]
2025-03-09 09:08:13,997 [INFO]: There are 2977 embeddings of dim 49152
2025-03-09 09:08:13,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:08:13,997 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:13
2025-03-09 09:08:13,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:13,997 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:08:13,997 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:13,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:13,997 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:13
2025-03-09 09:08:13,997 [INFO]: 614.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:13,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:08:13,997 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:13
2025-03-09 09:08:13,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:13,997 [INFO]: 	Creating the index 03/09/2025, 09:08:13
2025-03-09 09:08:13,997 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:13
2025-03-09 09:08:13,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:08:13,998 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:13
2025-03-09 09:08:13,999 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:08:13,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.92it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.48it/s]100%|██████████| 12/12 [00:02<00:00,  3.86it/s]100%|██████████| 12/12 [00:02<00:00,  4.63it/s]
2025-03-09 09:08:16,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:16
2025-03-09 09:08:45,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3944 secs
2025-03-09 09:08:45,990 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 09:08:45,990 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.05it/s]
2025-03-09 09:09:03,802 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8117 secs
2025-03-09 09:09:03,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8053 secs
2025-03-09 09:09:03,804 [INFO]: {
2025-03-09 09:09:03,804 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:03,804 [INFO]: 	index_param: efSearch=247
2025-03-09 09:09:03,804 [INFO]: 	index_path: knn.index
2025-03-09 09:09:03,804 [INFO]: 	size in bytes: 585706390
2025-03-09 09:09:03,804 [INFO]: 	avg_search_speed_ms: 10.502940085873071
2025-03-09 09:09:03,804 [INFO]: 	99p_search_speed_ms: 24.760500134434555
2025-03-09 09:09:03,804 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:03,804 [INFO]: 	nb vectors: 2977
2025-03-09 09:09:03,804 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:03,804 [INFO]: 	compression ratio: 0.9993095960588717
2025-03-09 09:09:03,804 [INFO]: }
2025-03-09 09:09:03,804 [INFO]: 	>>> Finished "Creating the index" in 49.8068 secs
2025-03-09 09:09:03,804 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8314 secs
2025-03-09 09:09:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 80459 [episode count 17/20]
[retrieval_preprocessing] for episode 46684 [episode count 18/20], we have num_retrieval=np.int64(2873) num_query=np.int64(226)
2025-03-09 09:09:05,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:06,231 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:06
2025-03-09 09:09:06,232 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1935.53it/s]
2025-03-09 09:09:06,261 [INFO]: There are 2873 embeddings of dim 49152
2025-03-09 09:09:06,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 09:09:06,261 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:06
2025-03-09 09:09:06,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:06,262 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:09:06,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:06,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:09:06,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:06
2025-03-09 09:09:06,262 [INFO]: 592.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:06,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:06,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:06
2025-03-09 09:09:06,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:06,262 [INFO]: 	Creating the index 03/09/2025, 09:09:06
2025-03-09 09:09:06,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:06
2025-03-09 09:09:06,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:09:06,263 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:06
2025-03-09 09:09:06,264 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:06,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.01it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.11it/s]100%|██████████| 12/12 [00:02<00:00,  4.60it/s]100%|██████████| 12/12 [00:02<00:00,  5.57it/s]
2025-03-09 09:09:08,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:08
2025-03-09 09:09:36,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7874 secs
2025-03-09 09:09:36,209 [INFO]: The best hyperparameters are: efSearch=156
2025-03-09 09:09:36,209 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.58it/s]
2025-03-09 09:09:50,328 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1189 secs
2025-03-09 09:09:50,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0664 secs
2025-03-09 09:09:50,330 [INFO]: {
2025-03-09 09:09:50,330 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:50,330 [INFO]: 	index_param: efSearch=156
2025-03-09 09:09:50,330 [INFO]: 	index_path: knn.index
2025-03-09 09:09:50,330 [INFO]: 	size in bytes: 565244950
2025-03-09 09:09:50,330 [INFO]: 	avg_search_speed_ms: 7.533372546523001
2025-03-09 09:09:50,330 [INFO]: 	99p_search_speed_ms: 18.49438372068107
2025-03-09 09:09:50,330 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:50,330 [INFO]: 	nb vectors: 2873
2025-03-09 09:09:50,330 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:50,330 [INFO]: 	compression ratio: 0.9993097399631788
2025-03-09 09:09:50,330 [INFO]: }
2025-03-09 09:09:50,330 [INFO]: 	>>> Finished "Creating the index" in 44.0682 secs
2025-03-09 09:09:50,330 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0986 secs
2025-03-09 09:09:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 46684 [episode count 18/20]
[retrieval_preprocessing] for episode 26728 [episode count 19/20], we have num_retrieval=np.int64(2986) num_query=np.int64(113)
2025-03-09 09:09:51,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:52,073 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:52
2025-03-09 09:09:52,073 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2009.73it/s]
2025-03-09 09:09:52,100 [INFO]: There are 2986 embeddings of dim 49152
2025-03-09 09:09:52,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:09:52,100 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:52,101 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:09:52,101 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:52,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:09:52,101 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,101 [INFO]: 616.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:52,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:09:52,102 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:52
2025-03-09 09:09:52,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:52,102 [INFO]: 	Creating the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,102 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:52
2025-03-09 09:09:52,105 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:09:52,105 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,105 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:52,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.12it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.83it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-09 09:09:54,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:54
2025-03-09 09:10:22,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0646 secs
2025-03-09 09:10:22,611 [INFO]: The best hyperparameters are: efSearch=109
2025-03-09 09:10:22,611 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-09 09:10:38,840 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2292 secs
2025-03-09 09:10:38,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7369 secs
2025-03-09 09:10:38,842 [INFO]: {
2025-03-09 09:10:38,842 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:38,842 [INFO]: 	index_param: efSearch=109
2025-03-09 09:10:38,842 [INFO]: 	index_path: knn.index
2025-03-09 09:10:38,842 [INFO]: 	size in bytes: 587477050
2025-03-09 09:10:38,842 [INFO]: 	avg_search_speed_ms: 5.712218259328178
2025-03-09 09:10:38,842 [INFO]: 	99p_search_speed_ms: 9.615096172783524
2025-03-09 09:10:38,842 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:38,842 [INFO]: 	nb vectors: 2986
2025-03-09 09:10:38,842 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:38,842 [INFO]: 	compression ratio: 0.9993096547345978
2025-03-09 09:10:38,843 [INFO]: }
2025-03-09 09:10:38,843 [INFO]: 	>>> Finished "Creating the index" in 46.7407 secs
2025-03-09 09:10:38,843 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7699 secs
2025-03-09 09:10:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 26728 [episode count 19/20]
2025-03-09 09:10:39: [retrieval_preprocessing] finished for (8756300955, 'block') [chosen_id count 6/10]
2025-03-09 09:10:41: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1180576306, 'cloth') [chosen_id count 7/10]
2025-03-09 09:10:41: [retrieval_preprocessing] we have num_total=5203 embedding_dim=49152
[retrieval_preprocessing] for episode 52993 [episode count 0/20], we have num_retrieval=np.int64(5029) num_query=np.int64(174)
2025-03-09 09:10:41,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:42,140 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:42
2025-03-09 09:10:42,140 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.38it/s]
2025-03-09 09:10:42,165 [INFO]: There are 5029 embeddings of dim 49152
2025-03-09 09:10:42,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:10:42,165 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:42
2025-03-09 09:10:42,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:42,165 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:10:42,166 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:42,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:42,166 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:42
2025-03-09 09:10:42,166 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:42,166 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:10:42,166 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:42
2025-03-09 09:10:42,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:42,166 [INFO]: 	Creating the index 03/09/2025, 09:10:42
2025-03-09 09:10:42,166 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:42
2025-03-09 09:10:42,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:10:42,167 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:42
2025-03-09 09:10:42,167 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:10:42,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.63it/s] 30%|███       | 6/20 [00:00<00:00, 30.17it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.18it/s] 80%|████████  | 16/20 [00:00<00:00, 41.94it/s]100%|██████████| 20/20 [00:04<00:00,  4.23it/s]
2025-03-09 09:10:46,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:46
2025-03-09 09:11:28,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6775 secs
2025-03-09 09:11:28,577 [INFO]: The best hyperparameters are: efSearch=156
2025-03-09 09:11:28,578 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.05it/s]
2025-03-09 09:11:45,781 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2032 secs
2025-03-09 09:11:45,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6164 secs
2025-03-09 09:11:45,783 [INFO]: {
2025-03-09 09:11:45,783 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:45,783 [INFO]: 	index_param: efSearch=156
2025-03-09 09:11:45,783 [INFO]: 	index_path: knn.index
2025-03-09 09:11:45,783 [INFO]: 	size in bytes: 989425810
2025-03-09 09:11:45,784 [INFO]: 	avg_search_speed_ms: 9.19311161573312
2025-03-09 09:11:45,784 [INFO]: 	99p_search_speed_ms: 13.244150779210031
2025-03-09 09:11:45,784 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:45,784 [INFO]: 	nb vectors: 5029
2025-03-09 09:11:45,784 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:45,784 [INFO]: 	compression ratio: 0.9993085100539272
2025-03-09 09:11:45,784 [INFO]: }
2025-03-09 09:11:45,784 [INFO]: 	>>> Finished "Creating the index" in 63.6178 secs
2025-03-09 09:11:45,784 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6439 secs
2025-03-09 09:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 52993 [episode count 0/20]
[retrieval_preprocessing] for episode 258 [episode count 1/20], we have num_retrieval=np.int64(5051) num_query=np.int64(152)
2025-03-09 09:11:47,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:47,869 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:47
2025-03-09 09:11:47,869 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.00it/s]
2025-03-09 09:11:47,892 [INFO]: There are 5051 embeddings of dim 49152
2025-03-09 09:11:47,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 09:11:47,893 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:47
2025-03-09 09:11:47,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:47,893 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:11:47,893 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:47,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:47,893 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:47
2025-03-09 09:11:47,893 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:47,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:47,893 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:47
2025-03-09 09:11:47,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:47,893 [INFO]: 	Creating the index 03/09/2025, 09:11:47
2025-03-09 09:11:47,893 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:47
2025-03-09 09:11:47,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:11:47,894 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:47
2025-03-09 09:11:47,894 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:11:47,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.18it/s] 40%|████      | 8/20 [00:00<00:00, 40.31it/s] 75%|███████▌  | 15/20 [00:00<00:00, 51.42it/s]100%|██████████| 20/20 [00:04<00:00,  4.76it/s]
2025-03-09 09:11:52,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:52
2025-03-09 09:12:37,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0287 secs
2025-03-09 09:12:37,127 [INFO]: The best hyperparameters are: efSearch=146
2025-03-09 09:12:37,127 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.20it/s]
2025-03-09 09:12:58,226 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0993 secs
2025-03-09 09:12:58,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3349 secs
2025-03-09 09:12:58,229 [INFO]: {
2025-03-09 09:12:58,229 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:58,229 [INFO]: 	index_param: efSearch=146
2025-03-09 09:12:58,229 [INFO]: 	index_path: knn.index
2025-03-09 09:12:58,229 [INFO]: 	size in bytes: 993754270
2025-03-09 09:12:58,229 [INFO]: 	avg_search_speed_ms: 9.735213734341936
2025-03-09 09:12:58,229 [INFO]: 	99p_search_speed_ms: 22.665704246610403
2025-03-09 09:12:58,229 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:58,229 [INFO]: 	nb vectors: 5051
2025-03-09 09:12:58,229 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:58,229 [INFO]: 	compression ratio: 0.9993084185691097
2025-03-09 09:12:58,229 [INFO]: }
2025-03-09 09:12:58,229 [INFO]: 	>>> Finished "Creating the index" in 70.3361 secs
2025-03-09 09:12:58,229 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3600 secs
2025-03-09 09:12:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 258 [episode count 1/20]
[retrieval_preprocessing] for episode 63105 [episode count 2/20], we have num_retrieval=np.int64(4986) num_query=np.int64(217)
2025-03-09 09:12:59,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:00,390 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:00
2025-03-09 09:13:00,390 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1934.64it/s]
2025-03-09 09:13:00,419 [INFO]: There are 4986 embeddings of dim 49152
2025-03-09 09:13:00,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 09:13:00,420 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:00
2025-03-09 09:13:00,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:00,420 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:13:00,420 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:00,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:13:00,420 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:00
2025-03-09 09:13:00,421 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:00,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:13:00,421 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:00
2025-03-09 09:13:00,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:00,421 [INFO]: 	Creating the index 03/09/2025, 09:13:00
2025-03-09 09:13:00,421 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:00
2025-03-09 09:13:00,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:13:00,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:00
2025-03-09 09:13:00,424 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:13:00,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.07it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.70it/s] 60%|██████    | 12/20 [00:00<00:00, 41.67it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.37it/s]100%|██████████| 20/20 [00:04<00:00,  4.09it/s]
2025-03-09 09:13:05,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:05
2025-03-09 09:13:46,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0038 secs
2025-03-09 09:13:46,325 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 09:13:46,326 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.09it/s]
2025-03-09 09:14:02,118 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7927 secs
2025-03-09 09:14:02,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6965 secs
2025-03-09 09:14:02,121 [INFO]: {
2025-03-09 09:14:02,121 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:02,121 [INFO]: 	index_param: efSearch=157
2025-03-09 09:14:02,121 [INFO]: 	index_path: knn.index
2025-03-09 09:14:02,121 [INFO]: 	size in bytes: 980965690
2025-03-09 09:14:02,121 [INFO]: 	avg_search_speed_ms: 10.892081067315049
2025-03-09 09:14:02,121 [INFO]: 	99p_search_speed_ms: 21.94801711011678
2025-03-09 09:14:02,121 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:02,121 [INFO]: 	nb vectors: 4986
2025-03-09 09:14:02,121 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:02,121 [INFO]: 	compression ratio: 0.9993086384091578
2025-03-09 09:14:02,121 [INFO]: }
2025-03-09 09:14:02,121 [INFO]: 	>>> Finished "Creating the index" in 61.6999 secs
2025-03-09 09:14:02,121 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7308 secs
2025-03-09 09:14:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 63105 [episode count 2/20]
[retrieval_preprocessing] for episode 42123 [episode count 3/20], we have num_retrieval=np.int64(4946) num_query=np.int64(257)
2025-03-09 09:14:04,383 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:05,189 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:05
2025-03-09 09:14:05,189 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 266.76it/s]
2025-03-09 09:14:05,220 [INFO]: There are 4946 embeddings of dim 49152
2025-03-09 09:14:05,220 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 09:14:05,220 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,220 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:05,220 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:14:05,220 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:05,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:14:05,220 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,220 [INFO]: 1020.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:05,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:14:05,220 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:05
2025-03-09 09:14:05,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:05,220 [INFO]: 	Creating the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,220 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:05
2025-03-09 09:14:05,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:14:05,222 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,222 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:14:05,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.88it/s] 40%|████      | 8/20 [00:00<00:00, 41.66it/s] 70%|███████   | 14/20 [00:00<00:00, 49.09it/s] 95%|█████████▌| 19/20 [00:00<00:00, 44.17it/s]100%|██████████| 20/20 [00:03<00:00,  5.09it/s]
2025-03-09 09:14:09,196 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:09
2025-03-09 09:14:52,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7922 secs
2025-03-09 09:14:52,989 [INFO]: The best hyperparameters are: efSearch=113
2025-03-09 09:14:52,989 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.13it/s]
2025-03-09 09:15:09,276 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2870 secs
2025-03-09 09:15:09,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0569 secs
2025-03-09 09:15:09,279 [INFO]: {
2025-03-09 09:15:09,279 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:09,279 [INFO]: 	index_param: efSearch=113
2025-03-09 09:15:09,279 [INFO]: 	index_path: knn.index
2025-03-09 09:15:09,279 [INFO]: 	size in bytes: 973095910
2025-03-09 09:15:09,279 [INFO]: 	avg_search_speed_ms: 7.40295115976886
2025-03-09 09:15:09,279 [INFO]: 	99p_search_speed_ms: 15.270353527739644
2025-03-09 09:15:09,279 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:09,279 [INFO]: 	nb vectors: 4946
2025-03-09 09:15:09,279 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:09,279 [INFO]: 	compression ratio: 0.9993086580746188
2025-03-09 09:15:09,279 [INFO]: }
2025-03-09 09:15:09,279 [INFO]: 	>>> Finished "Creating the index" in 64.0585 secs
2025-03-09 09:15:09,279 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0901 secs
2025-03-09 09:15:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 42123 [episode count 3/20]
[retrieval_preprocessing] for episode 12556 [episode count 4/20], we have num_retrieval=np.int64(4897) num_query=np.int64(306)
2025-03-09 09:15:11,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:11,670 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:11
2025-03-09 09:15:11,670 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-09 09:15:11,707 [INFO]: There are 4897 embeddings of dim 49152
2025-03-09 09:15:11,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-09 09:15:11,707 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:11
2025-03-09 09:15:11,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:11,707 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:15:11,708 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:11,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:11,708 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:11
2025-03-09 09:15:11,708 [INFO]: 1010.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:11,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:15:11,708 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:11
2025-03-09 09:15:11,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:11,708 [INFO]: 	Creating the index 03/09/2025, 09:15:11
2025-03-09 09:15:11,708 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:11
2025-03-09 09:15:11,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:15:11,710 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:11
2025-03-09 09:15:11,710 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:15:11,710 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.75it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.19it/s] 60%|██████    | 12/20 [00:00<00:00, 38.81it/s] 90%|█████████ | 18/20 [00:00<00:00, 43.81it/s]100%|██████████| 20/20 [00:03<00:00,  5.04it/s]
2025-03-09 09:15:15,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:15
2025-03-09 09:15:58,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2695 secs
2025-03-09 09:15:58,949 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 09:15:58,949 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-09 09:16:17,972 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0225 secs
2025-03-09 09:16:18,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8083 secs
2025-03-09 09:16:18,518 [INFO]: {
2025-03-09 09:16:18,518 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:18,518 [INFO]: 	index_param: efSearch=160
2025-03-09 09:16:18,518 [INFO]: 	index_path: knn.index
2025-03-09 09:16:18,518 [INFO]: 	size in bytes: 963455350
2025-03-09 09:16:18,519 [INFO]: 	avg_search_speed_ms: 9.65809467959696
2025-03-09 09:16:18,519 [INFO]: 	99p_search_speed_ms: 18.44803270651029
2025-03-09 09:16:18,519 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:18,519 [INFO]: 	nb vectors: 4897
2025-03-09 09:16:18,519 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:18,519 [INFO]: 	compression ratio: 0.9993087650610898
2025-03-09 09:16:18,519 [INFO]: }
2025-03-09 09:16:18,519 [INFO]: 	>>> Finished "Creating the index" in 66.8109 secs
2025-03-09 09:16:18,519 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8486 secs
2025-03-09 09:16:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 12556 [episode count 4/20]
[retrieval_preprocessing] for episode 86797 [episode count 5/20], we have num_retrieval=np.int64(4742) num_query=np.int64(461)
2025-03-09 09:16:21,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:22,016 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:22
2025-03-09 09:16:22,016 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1886.78it/s]
2025-03-09 09:16:22,044 [INFO]: There are 4742 embeddings of dim 49152
2025-03-09 09:16:22,044 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 09:16:22,044 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:22
2025-03-09 09:16:22,044 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:22,044 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:16:22,044 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:22,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:22,044 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:22
2025-03-09 09:16:22,044 [INFO]: 978.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:22,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:22,044 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:22
2025-03-09 09:16:22,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:22,044 [INFO]: 	Creating the index 03/09/2025, 09:16:22
2025-03-09 09:16:22,044 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:22
2025-03-09 09:16:22,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:16:22,046 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:22
2025-03-09 09:16:22,046 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:16:22,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.17it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.54it/s] 63%|██████▎   | 12/19 [00:00<00:00, 39.52it/s] 95%|█████████▍| 18/19 [00:00<00:00, 43.82it/s]100%|██████████| 19/19 [00:04<00:00,  4.63it/s]
2025-03-09 09:16:26,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:26
2025-03-09 09:17:06,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4605 secs
2025-03-09 09:17:06,612 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 09:17:06,613 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.35it/s]
2025-03-09 09:17:32,072 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4597 secs
2025-03-09 09:17:32,076 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0300 secs
2025-03-09 09:17:32,076 [INFO]: {
2025-03-09 09:17:32,076 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:32,076 [INFO]: 	index_param: efSearch=179
2025-03-09 09:17:32,076 [INFO]: 	index_path: knn.index
2025-03-09 09:17:32,076 [INFO]: 	size in bytes: 932960050
2025-03-09 09:17:32,076 [INFO]: 	avg_search_speed_ms: 10.761407214987983
2025-03-09 09:17:32,076 [INFO]: 	99p_search_speed_ms: 19.47115345858038
2025-03-09 09:17:32,076 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:32,076 [INFO]: 	nb vectors: 4742
2025-03-09 09:17:32,076 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:32,076 [INFO]: 	compression ratio: 0.9993087442490168
2025-03-09 09:17:32,076 [INFO]: }
2025-03-09 09:17:32,076 [INFO]: 	>>> Finished "Creating the index" in 70.0317 secs
2025-03-09 09:17:32,076 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0599 secs
2025-03-09 09:17:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 86797 [episode count 5/20]
[retrieval_preprocessing] for episode 18447 [episode count 6/20], we have num_retrieval=np.int64(4985) num_query=np.int64(218)
2025-03-09 09:17:36,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:36,763 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:36
2025-03-09 09:17:36,764 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.89it/s]
2025-03-09 09:17:36,789 [INFO]: There are 4985 embeddings of dim 49152
2025-03-09 09:17:36,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 09:17:36,789 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:36
2025-03-09 09:17:36,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:36,789 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:17:36,789 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:36,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:36,789 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:36
2025-03-09 09:17:36,789 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:36,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:17:36,789 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:36
2025-03-09 09:17:36,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:36,790 [INFO]: 	Creating the index 03/09/2025, 09:17:36
2025-03-09 09:17:36,790 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:36
2025-03-09 09:17:36,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:17:36,791 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:36
2025-03-09 09:17:36,791 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:17:36,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.08it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.30it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.94it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.16it/s]100%|██████████| 20/20 [00:04<00:00,  4.51it/s]
2025-03-09 09:17:41,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:41
2025-03-09 09:18:27,928 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7000 secs
2025-03-09 09:18:27,928 [INFO]: The best hyperparameters are: efSearch=150
2025-03-09 09:18:27,928 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.74it/s]
2025-03-09 09:18:46,331 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4025 secs
2025-03-09 09:18:46,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5427 secs
2025-03-09 09:18:46,334 [INFO]: {
2025-03-09 09:18:46,334 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:46,334 [INFO]: 	index_param: efSearch=150
2025-03-09 09:18:46,334 [INFO]: 	index_path: knn.index
2025-03-09 09:18:46,334 [INFO]: 	size in bytes: 980768950
2025-03-09 09:18:46,334 [INFO]: 	avg_search_speed_ms: 9.560491458332988
2025-03-09 09:18:46,334 [INFO]: 	99p_search_speed_ms: 18.351102469023296
2025-03-09 09:18:46,334 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:46,334 [INFO]: 	nb vectors: 4985
2025-03-09 09:18:46,334 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:46,334 [INFO]: 	compression ratio: 0.9993086343118835
2025-03-09 09:18:46,334 [INFO]: }
2025-03-09 09:18:46,334 [INFO]: 	>>> Finished "Creating the index" in 69.5442 secs
2025-03-09 09:18:46,334 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5702 secs
2025-03-09 09:18:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 18447 [episode count 6/20]
[retrieval_preprocessing] for episode 24208 [episode count 7/20], we have num_retrieval=np.int64(4991) num_query=np.int64(212)
2025-03-09 09:18:48,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:48,857 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:48
2025-03-09 09:18:48,857 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-09 09:18:48,886 [INFO]: There are 4991 embeddings of dim 49152
2025-03-09 09:18:48,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:18:48,886 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:48
2025-03-09 09:18:48,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:48,886 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:18:48,886 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:48,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:18:48,886 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:48
2025-03-09 09:18:48,886 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:48,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:18:48,886 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:48
2025-03-09 09:18:48,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:48,887 [INFO]: 	Creating the index 03/09/2025, 09:18:48
2025-03-09 09:18:48,887 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:48
2025-03-09 09:18:48,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:18:48,888 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:48
2025-03-09 09:18:48,888 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:18:48,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.60it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.32it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.11it/s] 95%|█████████▌| 19/20 [00:00<00:00, 48.03it/s]100%|██████████| 20/20 [00:04<00:00,  4.19it/s]
2025-03-09 09:18:53,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:53
2025-03-09 09:19:38,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1197 secs
2025-03-09 09:19:38,783 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 09:19:38,783 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.03it/s]
2025-03-09 09:19:53,952 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1685 secs
2025-03-09 09:19:53,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0671 secs
2025-03-09 09:19:53,955 [INFO]: {
2025-03-09 09:19:53,955 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:53,955 [INFO]: 	index_param: efSearch=177
2025-03-09 09:19:53,955 [INFO]: 	index_path: knn.index
2025-03-09 09:19:53,955 [INFO]: 	size in bytes: 981949510
2025-03-09 09:19:53,955 [INFO]: 	avg_search_speed_ms: 10.797294461194499
2025-03-09 09:19:53,955 [INFO]: 	99p_search_speed_ms: 20.946349890436977
2025-03-09 09:19:53,955 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:53,955 [INFO]: 	nb vectors: 4991
2025-03-09 09:19:53,955 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:53,955 [INFO]: 	compression ratio: 0.9993085367495117
2025-03-09 09:19:53,955 [INFO]: }
2025-03-09 09:19:53,955 [INFO]: 	>>> Finished "Creating the index" in 65.0685 secs
2025-03-09 09:19:53,955 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0979 secs
2025-03-09 09:19:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 24208 [episode count 7/20]
[retrieval_preprocessing] for episode 38419 [episode count 8/20], we have num_retrieval=np.int64(4974) num_query=np.int64(229)
2025-03-09 09:19:56,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:57,226 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:57
2025-03-09 09:19:57,226 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.75it/s]
2025-03-09 09:19:57,251 [INFO]: There are 4974 embeddings of dim 49152
2025-03-09 09:19:57,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:19:57,251 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:57
2025-03-09 09:19:57,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:57,251 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:19:57,251 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:57,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:19:57,251 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:57
2025-03-09 09:19:57,251 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:57,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:19:57,251 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:57
2025-03-09 09:19:57,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:57,251 [INFO]: 	Creating the index 03/09/2025, 09:19:57
2025-03-09 09:19:57,252 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:57
2025-03-09 09:19:57,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:19:57,252 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:57
2025-03-09 09:19:57,252 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:19:57,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.75it/s] 35%|███▌      | 7/20 [00:00<00:00, 30.05it/s] 60%|██████    | 12/20 [00:00<00:00, 36.85it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.51it/s]100%|██████████| 20/20 [00:05<00:00,  3.98it/s]
2025-03-09 09:20:02,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:02
2025-03-09 09:20:44,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1420 secs
2025-03-09 09:20:44,558 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 09:20:44,559 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.24it/s]
2025-03-09 09:21:00,436 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8778 secs
2025-03-09 09:21:00,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1866 secs
2025-03-09 09:21:00,439 [INFO]: {
2025-03-09 09:21:00,439 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:00,439 [INFO]: 	index_param: efSearch=177
2025-03-09 09:21:00,439 [INFO]: 	index_path: knn.index
2025-03-09 09:21:00,439 [INFO]: 	size in bytes: 978604690
2025-03-09 09:21:00,439 [INFO]: 	avg_search_speed_ms: 10.879752845705852
2025-03-09 09:21:00,439 [INFO]: 	99p_search_speed_ms: 23.492750213481486
2025-03-09 09:21:00,439 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:00,439 [INFO]: 	nb vectors: 4974
2025-03-09 09:21:00,439 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:00,439 [INFO]: 	compression ratio: 0.9993087116719214
2025-03-09 09:21:00,439 [INFO]: }
2025-03-09 09:21:00,439 [INFO]: 	>>> Finished "Creating the index" in 63.1878 secs
2025-03-09 09:21:00,439 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2131 secs
2025-03-09 09:21:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 38419 [episode count 8/20]
[retrieval_preprocessing] for episode 79636 [episode count 9/20], we have num_retrieval=np.int64(5068) num_query=np.int64(135)
2025-03-09 09:21:02,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:03,181 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:03
2025-03-09 09:21:03,181 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2178.86it/s]
2025-03-09 09:21:03,203 [INFO]: There are 5068 embeddings of dim 49152
2025-03-09 09:21:03,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 09:21:03,203 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:03
2025-03-09 09:21:03,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:03,204 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:21:03,204 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:03,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:21:03,204 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:03
2025-03-09 09:21:03,204 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:03,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:21:03,204 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:03
2025-03-09 09:21:03,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:03,204 [INFO]: 	Creating the index 03/09/2025, 09:21:03
2025-03-09 09:21:03,204 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:03
2025-03-09 09:21:03,205 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:21:03,205 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:03
2025-03-09 09:21:03,205 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:21:03,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 16.84it/s] 40%|████      | 8/20 [00:00<00:00, 38.89it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.87it/s] 95%|█████████▌| 19/20 [00:00<00:00, 48.05it/s]100%|██████████| 20/20 [00:04<00:00,  4.32it/s]
2025-03-09 09:21:07,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:07
2025-03-09 09:21:51,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3486 secs
2025-03-09 09:21:51,193 [INFO]: The best hyperparameters are: efSearch=156
2025-03-09 09:21:51,193 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 09:22:14,763 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5706 secs
2025-03-09 09:22:14,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5612 secs
2025-03-09 09:22:14,766 [INFO]: {
2025-03-09 09:22:14,766 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:14,766 [INFO]: 	index_param: efSearch=156
2025-03-09 09:22:14,766 [INFO]: 	index_path: knn.index
2025-03-09 09:22:14,766 [INFO]: 	size in bytes: 997098850
2025-03-09 09:22:14,766 [INFO]: 	avg_search_speed_ms: 9.345829972527294
2025-03-09 09:22:14,766 [INFO]: 	99p_search_speed_ms: 18.658781242556863
2025-03-09 09:22:14,766 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:14,766 [INFO]: 	nb vectors: 5068
2025-03-09 09:22:14,766 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:14,766 [INFO]: 	compression ratio: 0.9993084878194374
2025-03-09 09:22:14,766 [INFO]: }
2025-03-09 09:22:14,766 [INFO]: 	>>> Finished "Creating the index" in 71.5625 secs
2025-03-09 09:22:14,766 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5857 secs
2025-03-09 09:22:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 79636 [episode count 9/20]
[retrieval_preprocessing] for episode 90650 [episode count 10/20], we have num_retrieval=np.int64(4939) num_query=np.int64(264)
2025-03-09 09:22:16,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:17,369 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:17
2025-03-09 09:22:17,369 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-09 09:22:17,401 [INFO]: There are 4939 embeddings of dim 49152
2025-03-09 09:22:17,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 09:22:17,401 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:17
2025-03-09 09:22:17,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:17,402 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:22:17,402 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:17,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:22:17,402 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:17
2025-03-09 09:22:17,402 [INFO]: 1019.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:17,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:22:17,403 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:17
2025-03-09 09:22:17,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:17,403 [INFO]: 	Creating the index 03/09/2025, 09:22:17
2025-03-09 09:22:17,403 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:17
2025-03-09 09:22:17,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:22:17,406 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:17
2025-03-09 09:22:17,406 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:22:17,406 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.85it/s] 40%|████      | 8/20 [00:00<00:00, 39.52it/s] 70%|███████   | 14/20 [00:00<00:00, 47.02it/s] 95%|█████████▌| 19/20 [00:00<00:00, 47.91it/s]100%|██████████| 20/20 [00:04<00:00,  4.65it/s]
2025-03-09 09:22:21,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:21
2025-03-09 09:23:08,248 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5338 secs
2025-03-09 09:23:08,249 [INFO]: The best hyperparameters are: efSearch=156
2025-03-09 09:23:08,249 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-09 09:23:34,026 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7767 secs
2025-03-09 09:23:34,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.6227 secs
2025-03-09 09:23:34,029 [INFO]: {
2025-03-09 09:23:34,029 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:34,029 [INFO]: 	index_param: efSearch=156
2025-03-09 09:23:34,029 [INFO]: 	index_path: knn.index
2025-03-09 09:23:34,029 [INFO]: 	size in bytes: 971718670
2025-03-09 09:23:34,029 [INFO]: 	avg_search_speed_ms: 9.550344379291422
2025-03-09 09:23:34,029 [INFO]: 	99p_search_speed_ms: 22.32704157475382
2025-03-09 09:23:34,029 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:34,029 [INFO]: 	nb vectors: 4939
2025-03-09 09:23:34,029 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:34,029 [INFO]: 	compression ratio: 0.9993086908580238
2025-03-09 09:23:34,029 [INFO]: }
2025-03-09 09:23:34,029 [INFO]: 	>>> Finished "Creating the index" in 76.6265 secs
2025-03-09 09:23:34,029 [INFO]: >>> Finished "Launching the whole pipeline" in 76.6599 secs
2025-03-09 09:23:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 90650 [episode count 10/20]
[retrieval_preprocessing] for episode 44957 [episode count 11/20], we have num_retrieval=np.int64(5023) num_query=np.int64(180)
2025-03-09 09:23:36,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:36,860 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:36
2025-03-09 09:23:36,860 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2258.65it/s]
2025-03-09 09:23:36,886 [INFO]: There are 5023 embeddings of dim 49152
2025-03-09 09:23:36,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:23:36,886 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:36
2025-03-09 09:23:36,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:36,886 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:23:36,886 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:36,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:23:36,886 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:36
2025-03-09 09:23:36,887 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:36,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:36,887 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:36
2025-03-09 09:23:36,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:36,887 [INFO]: 	Creating the index 03/09/2025, 09:23:36
2025-03-09 09:23:36,887 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:36
2025-03-09 09:23:36,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:23:36,888 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:36
2025-03-09 09:23:36,888 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:23:36,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.34it/s] 25%|██▌       | 5/20 [00:00<00:00, 23.54it/s] 50%|█████     | 10/20 [00:00<00:00, 33.16it/s] 75%|███████▌  | 15/20 [00:00<00:00, 35.53it/s]100%|██████████| 20/20 [00:04<00:00,  2.79it/s]100%|██████████| 20/20 [00:04<00:00,  4.19it/s]
2025-03-09 09:23:41,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:41
2025-03-09 09:24:25,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2676 secs
2025-03-09 09:24:25,927 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 09:24:25,927 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.11it/s]
2025-03-09 09:24:45,229 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3016 secs
2025-03-09 09:24:45,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3441 secs
2025-03-09 09:24:45,232 [INFO]: {
2025-03-09 09:24:45,232 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:45,232 [INFO]: 	index_param: efSearch=162
2025-03-09 09:24:45,232 [INFO]: 	index_path: knn.index
2025-03-09 09:24:45,232 [INFO]: 	size in bytes: 988245310
2025-03-09 09:24:45,232 [INFO]: 	avg_search_speed_ms: 9.435914242684069
2025-03-09 09:24:45,232 [INFO]: 	99p_search_speed_ms: 19.033005991950695
2025-03-09 09:24:45,232 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:45,232 [INFO]: 	nb vectors: 5023
2025-03-09 09:24:45,232 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:45,232 [INFO]: 	compression ratio: 0.9993085461746335
2025-03-09 09:24:45,232 [INFO]: }
2025-03-09 09:24:45,232 [INFO]: 	>>> Finished "Creating the index" in 68.3454 secs
2025-03-09 09:24:45,232 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3719 secs
2025-03-09 09:24:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 44957 [episode count 11/20]
[retrieval_preprocessing] for episode 61983 [episode count 12/20], we have num_retrieval=np.int64(4937) num_query=np.int64(266)
2025-03-09 09:24:46,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:47,929 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:47
2025-03-09 09:24:47,929 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.04it/s]
2025-03-09 09:24:47,957 [INFO]: There are 4937 embeddings of dim 49152
2025-03-09 09:24:47,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:24:47,957 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:47
2025-03-09 09:24:47,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:47,957 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:24:47,958 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:47,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:24:47,958 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:47
2025-03-09 09:24:47,958 [INFO]: 1018.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:47,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:24:47,958 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:47
2025-03-09 09:24:47,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:47,959 [INFO]: 	Creating the index 03/09/2025, 09:24:47
2025-03-09 09:24:47,959 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:47
2025-03-09 09:24:47,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:24:47,962 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:47
2025-03-09 09:24:47,962 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:24:47,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.73it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.64it/s] 70%|███████   | 14/20 [00:00<00:00, 47.96it/s]100%|██████████| 20/20 [00:03<00:00,  3.66it/s]100%|██████████| 20/20 [00:03<00:00,  5.01it/s]
2025-03-09 09:24:51,961 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:51
2025-03-09 09:25:34,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4799 secs
2025-03-09 09:25:34,441 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 09:25:34,441 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.82it/s]
2025-03-09 09:25:56,656 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2150 secs
2025-03-09 09:25:56,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6980 secs
2025-03-09 09:25:56,660 [INFO]: {
2025-03-09 09:25:56,660 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:56,660 [INFO]: 	index_param: efSearch=190
2025-03-09 09:25:56,660 [INFO]: 	index_path: knn.index
2025-03-09 09:25:56,660 [INFO]: 	size in bytes: 971325130
2025-03-09 09:25:56,660 [INFO]: 	avg_search_speed_ms: 11.738745470838087
2025-03-09 09:25:56,660 [INFO]: 	99p_search_speed_ms: 23.931967532262217
2025-03-09 09:25:56,660 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:56,660 [INFO]: 	nb vectors: 4937
2025-03-09 09:25:56,660 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:56,660 [INFO]: 	compression ratio: 0.99930874433363
2025-03-09 09:25:56,660 [INFO]: }
2025-03-09 09:25:56,660 [INFO]: 	>>> Finished "Creating the index" in 68.7016 secs
2025-03-09 09:25:56,660 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7308 secs
2025-03-09 09:25:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 61983 [episode count 12/20]
[retrieval_preprocessing] for episode 76447 [episode count 13/20], we have num_retrieval=np.int64(4973) num_query=np.int64(230)
2025-03-09 09:25:59,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:00,060 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:00
2025-03-09 09:26:00,061 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.20it/s]
2025-03-09 09:26:00,090 [INFO]: There are 4973 embeddings of dim 49152
2025-03-09 09:26:00,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 09:26:00,091 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:00,091 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:26:00,091 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:00,092 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:26:00,092 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,092 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:00,092 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:26:00,092 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:00
2025-03-09 09:26:00,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:00,092 [INFO]: 	Creating the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,092 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:00
2025-03-09 09:26:00,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0038 secs
2025-03-09 09:26:00,097 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,097 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:26:00,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.87it/s] 30%|███       | 6/20 [00:00<00:00, 32.71it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.40it/s] 75%|███████▌  | 15/20 [00:00<00:00, 34.58it/s]100%|██████████| 20/20 [00:05<00:00,  2.35it/s]100%|██████████| 20/20 [00:05<00:00,  3.68it/s]
2025-03-09 09:26:05,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:05
2025-03-09 09:26:46,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1328 secs
2025-03-09 09:26:46,679 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 09:26:46,679 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-09 09:27:09,848 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1680 secs
2025-03-09 09:27:09,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7530 secs
2025-03-09 09:27:09,850 [INFO]: {
2025-03-09 09:27:09,850 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:09,850 [INFO]: 	index_param: efSearch=161
2025-03-09 09:27:09,850 [INFO]: 	index_path: knn.index
2025-03-09 09:27:09,850 [INFO]: 	size in bytes: 978407950
2025-03-09 09:27:09,850 [INFO]: 	avg_search_speed_ms: 10.933341653101513
2025-03-09 09:27:09,850 [INFO]: 	99p_search_speed_ms: 24.383479105308655
2025-03-09 09:27:09,850 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:09,850 [INFO]: 	nb vectors: 4973
2025-03-09 09:27:09,850 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:09,850 [INFO]: 	compression ratio: 0.9993087075794918
2025-03-09 09:27:09,850 [INFO]: }
2025-03-09 09:27:09,850 [INFO]: 	>>> Finished "Creating the index" in 69.7578 secs
2025-03-09 09:27:09,850 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7897 secs
2025-03-09 09:27:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 76447 [episode count 13/20]
[retrieval_preprocessing] for episode 25762 [episode count 14/20], we have num_retrieval=np.int64(5044) num_query=np.int64(159)
2025-03-09 09:27:11,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:12,375 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:12
2025-03-09 09:27:12,376 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1875.81it/s]
2025-03-09 09:27:12,400 [INFO]: There are 5044 embeddings of dim 49152
2025-03-09 09:27:12,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 09:27:12,400 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:12
2025-03-09 09:27:12,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:12,400 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:27:12,400 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:12,400 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:12,400 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:12
2025-03-09 09:27:12,400 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:12,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:27:12,400 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:12
2025-03-09 09:27:12,400 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:12,400 [INFO]: 	Creating the index 03/09/2025, 09:27:12
2025-03-09 09:27:12,400 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:12
2025-03-09 09:27:12,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:27:12,401 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:12
2025-03-09 09:27:12,401 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:27:12,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.92it/s] 25%|██▌       | 5/20 [00:00<00:00, 22.25it/s] 45%|████▌     | 9/20 [00:00<00:00, 29.41it/s] 70%|███████   | 14/20 [00:00<00:00, 34.70it/s] 95%|█████████▌| 19/20 [00:00<00:00, 37.50it/s]100%|██████████| 20/20 [00:04<00:00,  4.19it/s]
2025-03-09 09:27:17,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:17
2025-03-09 09:27:59,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0493 secs
2025-03-09 09:27:59,228 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 09:27:59,228 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.20it/s]
2025-03-09 09:28:17,490 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2616 secs
2025-03-09 09:28:17,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0908 secs
2025-03-09 09:28:17,492 [INFO]: {
2025-03-09 09:28:17,492 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:17,492 [INFO]: 	index_param: efSearch=208
2025-03-09 09:28:17,492 [INFO]: 	index_path: knn.index
2025-03-09 09:28:17,492 [INFO]: 	size in bytes: 992377030
2025-03-09 09:28:17,492 [INFO]: 	avg_search_speed_ms: 12.72162903484156
2025-03-09 09:28:17,492 [INFO]: 	99p_search_speed_ms: 24.569984967820343
2025-03-09 09:28:17,493 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:17,493 [INFO]: 	nb vectors: 5044
2025-03-09 09:28:17,493 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:17,493 [INFO]: 	compression ratio: 0.9993084503376706
2025-03-09 09:28:17,493 [INFO]: }
2025-03-09 09:28:17,493 [INFO]: 	>>> Finished "Creating the index" in 65.0922 secs
2025-03-09 09:28:17,493 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1171 secs
2025-03-09 09:28:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 25762 [episode count 14/20]
[retrieval_preprocessing] for episode 69796 [episode count 15/20], we have num_retrieval=np.int64(4974) num_query=np.int64(229)
2025-03-09 09:28:19,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:19,706 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:19
2025-03-09 09:28:19,706 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2000.14it/s]
2025-03-09 09:28:19,730 [INFO]: There are 4974 embeddings of dim 49152
2025-03-09 09:28:19,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 09:28:19,730 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:19
2025-03-09 09:28:19,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:19,730 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:28:19,730 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:19,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:28:19,730 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:19
2025-03-09 09:28:19,730 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:19,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:28:19,730 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:19
2025-03-09 09:28:19,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:19,730 [INFO]: 	Creating the index 03/09/2025, 09:28:19
2025-03-09 09:28:19,730 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:19
2025-03-09 09:28:19,731 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:28:19,731 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:19
2025-03-09 09:28:19,732 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:28:19,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 15.47it/s] 40%|████      | 8/20 [00:00<00:00, 36.97it/s] 75%|███████▌  | 15/20 [00:00<00:00, 47.80it/s]100%|██████████| 20/20 [00:03<00:00,  3.55it/s]100%|██████████| 20/20 [00:03<00:00,  5.01it/s]
2025-03-09 09:28:23,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:23
2025-03-09 09:29:06,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1963 secs
2025-03-09 09:29:06,922 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 09:29:06,923 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.73it/s]
2025-03-09 09:29:29,705 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7825 secs
2025-03-09 09:29:29,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9763 secs
2025-03-09 09:29:29,708 [INFO]: {
2025-03-09 09:29:29,708 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:29,708 [INFO]: 	index_param: efSearch=165
2025-03-09 09:29:29,708 [INFO]: 	index_path: knn.index
2025-03-09 09:29:29,708 [INFO]: 	size in bytes: 978604690
2025-03-09 09:29:29,708 [INFO]: 	avg_search_speed_ms: 9.547586046036631
2025-03-09 09:29:29,708 [INFO]: 	99p_search_speed_ms: 14.167297540698197
2025-03-09 09:29:29,708 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:29,708 [INFO]: 	nb vectors: 4974
2025-03-09 09:29:29,708 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:29,708 [INFO]: 	compression ratio: 0.9993087116719214
2025-03-09 09:29:29,708 [INFO]: }
2025-03-09 09:29:29,708 [INFO]: 	>>> Finished "Creating the index" in 69.9778 secs
2025-03-09 09:29:29,708 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0021 secs
2025-03-09 09:29:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 69796 [episode count 15/20]
[retrieval_preprocessing] for episode 78630 [episode count 16/20], we have num_retrieval=np.int64(4627) num_query=np.int64(576)
2025-03-09 09:29:31,840 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:32,469 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:32
2025-03-09 09:29:32,469 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2048.00it/s]
2025-03-09 09:29:32,496 [INFO]: There are 4627 embeddings of dim 49152
2025-03-09 09:29:32,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:29:32,497 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:32
2025-03-09 09:29:32,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:32,497 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:29:32,497 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:32,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:29:32,498 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:32
2025-03-09 09:29:32,498 [INFO]: 954.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:32,498 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:29:32,498 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:32
2025-03-09 09:29:32,498 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:32,498 [INFO]: 	Creating the index 03/09/2025, 09:29:32
2025-03-09 09:29:32,498 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:32
2025-03-09 09:29:32,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:29:32,501 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:32
2025-03-09 09:29:32,502 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:29:32,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.82it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.91it/s] 68%|██████▊   | 13/19 [00:00<00:00, 38.72it/s] 95%|█████████▍| 18/19 [00:00<00:00, 42.66it/s]100%|██████████| 19/19 [00:04<00:00,  4.46it/s]
2025-03-09 09:29:36,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:36
2025-03-09 09:30:17,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3789 secs
2025-03-09 09:30:17,143 [INFO]: The best hyperparameters are: efSearch=150
2025-03-09 09:30:17,144 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.16it/s]
2025-03-09 09:30:36,157 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0138 secs
2025-03-09 09:30:36,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6581 secs
2025-03-09 09:30:36,160 [INFO]: {
2025-03-09 09:30:36,160 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:36,160 [INFO]: 	index_param: efSearch=150
2025-03-09 09:30:36,160 [INFO]: 	index_path: knn.index
2025-03-09 09:30:36,160 [INFO]: 	size in bytes: 910334350
2025-03-09 09:30:36,160 [INFO]: 	avg_search_speed_ms: 8.92924660999727
2025-03-09 09:30:36,160 [INFO]: 	99p_search_speed_ms: 18.53341315174475
2025-03-09 09:30:36,160 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:36,160 [INFO]: 	nb vectors: 4627
2025-03-09 09:30:36,160 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:36,160 [INFO]: 	compression ratio: 0.9993088978791144
2025-03-09 09:30:36,160 [INFO]: }
2025-03-09 09:30:36,160 [INFO]: 	>>> Finished "Creating the index" in 63.6616 secs
2025-03-09 09:30:36,160 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6912 secs
2025-03-09 09:30:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 78630 [episode count 16/20]
[retrieval_preprocessing] for episode 92457 [episode count 17/20], we have num_retrieval=np.int64(4968) num_query=np.int64(235)
2025-03-09 09:30:39,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:40,434 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:40
2025-03-09 09:30:40,434 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1956.30it/s]
2025-03-09 09:30:40,459 [INFO]: There are 4968 embeddings of dim 49152
2025-03-09 09:30:40,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:30:40,459 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:40
2025-03-09 09:30:40,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:40,459 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:30:40,459 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:40,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:40,459 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:40
2025-03-09 09:30:40,459 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:40,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:30:40,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:40
2025-03-09 09:30:40,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:40,460 [INFO]: 	Creating the index 03/09/2025, 09:30:40
2025-03-09 09:30:40,460 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:40
2025-03-09 09:30:40,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:30:40,461 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:40
2025-03-09 09:30:40,461 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:30:40,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.98it/s] 30%|███       | 6/20 [00:00<00:00, 28.17it/s] 50%|█████     | 10/20 [00:00<00:00, 32.94it/s] 80%|████████  | 16/20 [00:00<00:00, 40.78it/s]100%|██████████| 20/20 [00:04<00:00,  4.59it/s]
2025-03-09 09:30:44,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:44
2025-03-09 09:31:25,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7792 secs
2025-03-09 09:31:25,597 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 09:31:25,597 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.60it/s]
2025-03-09 09:31:41,910 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3133 secs
2025-03-09 09:31:41,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4530 secs
2025-03-09 09:31:41,914 [INFO]: {
2025-03-09 09:31:41,914 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:41,914 [INFO]: 	index_param: efSearch=164
2025-03-09 09:31:41,914 [INFO]: 	index_path: knn.index
2025-03-09 09:31:41,914 [INFO]: 	size in bytes: 977424250
2025-03-09 09:31:41,914 [INFO]: 	avg_search_speed_ms: 10.453013236349294
2025-03-09 09:31:41,914 [INFO]: 	99p_search_speed_ms: 23.768267482519136
2025-03-09 09:31:41,914 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:41,914 [INFO]: 	nb vectors: 4968
2025-03-09 09:31:41,914 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:41,914 [INFO]: 	compression ratio: 0.9993086870926314
2025-03-09 09:31:41,914 [INFO]: }
2025-03-09 09:31:41,914 [INFO]: 	>>> Finished "Creating the index" in 61.4543 secs
2025-03-09 09:31:41,914 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4799 secs
2025-03-09 09:31:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 92457 [episode count 17/20]
[retrieval_preprocessing] for episode 42 [episode count 18/20], we have num_retrieval=np.int64(4909) num_query=np.int64(294)
2025-03-09 09:31:43,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:44,536 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:44
2025-03-09 09:31:44,536 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1617.55it/s]
2025-03-09 09:31:44,562 [INFO]: There are 4909 embeddings of dim 49152
2025-03-09 09:31:44,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:31:44,563 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:44
2025-03-09 09:31:44,563 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:44,563 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:31:44,563 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:44,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:31:44,563 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:44
2025-03-09 09:31:44,563 [INFO]: 1013.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:44,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:31:44,564 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:44
2025-03-09 09:31:44,564 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:44,564 [INFO]: 	Creating the index 03/09/2025, 09:31:44
2025-03-09 09:31:44,564 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:44
2025-03-09 09:31:44,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 09:31:44,567 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:44
2025-03-09 09:31:44,567 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:31:44,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 15%|█▌        | 3/20 [00:00<00:00, 27.07it/s] 50%|█████     | 10/20 [00:00<00:00, 46.91it/s] 75%|███████▌  | 15/20 [00:00<00:00, 48.00it/s]100%|██████████| 20/20 [00:04<00:00,  3.22it/s]100%|██████████| 20/20 [00:04<00:00,  4.77it/s]
2025-03-09 09:31:48,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:48
2025-03-09 09:32:29,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2136 secs
2025-03-09 09:32:29,979 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 09:32:29,979 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-09 09:32:45,289 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3101 secs
2025-03-09 09:32:45,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7254 secs
2025-03-09 09:32:45,292 [INFO]: {
2025-03-09 09:32:45,292 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:45,292 [INFO]: 	index_param: efSearch=167
2025-03-09 09:32:45,292 [INFO]: 	index_path: knn.index
2025-03-09 09:32:45,292 [INFO]: 	size in bytes: 965816290
2025-03-09 09:32:45,292 [INFO]: 	avg_search_speed_ms: 10.734224569326258
2025-03-09 09:32:45,292 [INFO]: 	99p_search_speed_ms: 21.769341898616386
2025-03-09 09:32:45,292 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:45,292 [INFO]: 	nb vectors: 4909
2025-03-09 09:32:45,292 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:45,292 [INFO]: 	compression ratio: 0.9993087525993168
2025-03-09 09:32:45,292 [INFO]: }
2025-03-09 09:32:45,292 [INFO]: 	>>> Finished "Creating the index" in 60.7284 secs
2025-03-09 09:32:45,292 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7560 secs
2025-03-09 09:32:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 42 [episode count 18/20]
[retrieval_preprocessing] for episode 61739 [episode count 19/20], we have num_retrieval=np.int64(4794) num_query=np.int64(409)
2025-03-09 09:32:47,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:48,668 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:48
2025-03-09 09:32:48,668 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2211.02it/s]
2025-03-09 09:32:48,693 [INFO]: There are 4794 embeddings of dim 49152
2025-03-09 09:32:48,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 09:32:48,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:48
2025-03-09 09:32:48,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:48,693 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:32:48,693 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:48,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:48,693 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:48
2025-03-09 09:32:48,694 [INFO]: 989.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:48,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:48,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:48
2025-03-09 09:32:48,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:48,694 [INFO]: 	Creating the index 03/09/2025, 09:32:48
2025-03-09 09:32:48,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:48
2025-03-09 09:32:48,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:32:48,695 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:48
2025-03-09 09:32:48,695 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:32:48,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.12it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.58it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.69it/s]100%|██████████| 19/19 [00:04<00:00,  3.20it/s]100%|██████████| 19/19 [00:04<00:00,  4.33it/s]
2025-03-09 09:32:53,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:53
2025-03-09 09:33:35,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5105 secs
2025-03-09 09:33:35,597 [INFO]: The best hyperparameters are: efSearch=166
2025-03-09 09:33:35,597 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.20it/s]
2025-03-09 09:33:50,694 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0971 secs
2025-03-09 09:33:50,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0731 secs
2025-03-09 09:33:50,768 [INFO]: {
2025-03-09 09:33:50,769 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:50,769 [INFO]: 	index_param: efSearch=166
2025-03-09 09:33:50,769 [INFO]: 	index_path: knn.index
2025-03-09 09:33:50,769 [INFO]: 	size in bytes: 943190770
2025-03-09 09:33:50,769 [INFO]: 	avg_search_speed_ms: 10.29684540171111
2025-03-09 09:33:50,769 [INFO]: 	99p_search_speed_ms: 23.010613978840404
2025-03-09 09:33:50,769 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:50,769 [INFO]: 	nb vectors: 4794
2025-03-09 09:33:50,769 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:50,769 [INFO]: 	compression ratio: 0.9993087103683171
2025-03-09 09:33:50,769 [INFO]: }
2025-03-09 09:33:50,769 [INFO]: 	>>> Finished "Creating the index" in 62.0754 secs
2025-03-09 09:33:50,769 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1013 secs
2025-03-09 09:33:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 61739 [episode count 19/20]
2025-03-09 09:33:53: [retrieval_preprocessing] finished for (1180576306, 'cloth') [chosen_id count 7/10]
2025-03-09 09:33:54: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9154343709, 'drawer') [chosen_id count 8/10]
2025-03-09 09:33:54: [retrieval_preprocessing] we have num_total=1853 embedding_dim=49152
[retrieval_preprocessing] for episode 66055 [episode count 0/20], we have num_retrieval=np.int64(1763) num_query=np.int64(90)
2025-03-09 09:33:54,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:54,865 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:54
2025-03-09 09:33:54,865 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2054.02it/s]
2025-03-09 09:33:54,888 [INFO]: There are 1763 embeddings of dim 49152
2025-03-09 09:33:54,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 09:33:54,889 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:54
2025-03-09 09:33:54,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:54,889 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:33:54,889 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:54,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:33:54,889 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:54
2025-03-09 09:33:54,889 [INFO]: 363.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:54,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:33:54,889 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:54
2025-03-09 09:33:54,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:54,889 [INFO]: 	Creating the index 03/09/2025, 09:33:54
2025-03-09 09:33:54,889 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:54
2025-03-09 09:33:54,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:33:54,890 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:54
2025-03-09 09:33:54,890 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:33:54,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 29.58it/s]100%|██████████| 7/7 [00:01<00:00,  5.97it/s]100%|██████████| 7/7 [00:01<00:00,  6.65it/s]
2025-03-09 09:33:55,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:55
2025-03-09 09:34:15,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3840 secs
2025-03-09 09:34:15,332 [INFO]: The best hyperparameters are: efSearch=394
2025-03-09 09:34:15,332 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.10it/s]
2025-03-09 09:34:31,795 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4637 secs
2025-03-09 09:34:31,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.9066 secs
2025-03-09 09:34:31,797 [INFO]: {
2025-03-09 09:34:31,797 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:31,797 [INFO]: 	index_param: efSearch=394
2025-03-09 09:34:31,797 [INFO]: 	index_path: knn.index
2025-03-09 09:34:31,797 [INFO]: 	size in bytes: 346859650
2025-03-09 09:34:31,797 [INFO]: 	avg_search_speed_ms: 11.676936277515464
2025-03-09 09:34:31,797 [INFO]: 	99p_search_speed_ms: 26.93061157129699
2025-03-09 09:34:31,797 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:31,797 [INFO]: 	nb vectors: 1763
2025-03-09 09:34:31,797 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:31,797 [INFO]: 	compression ratio: 0.9993088097736361
2025-03-09 09:34:31,797 [INFO]: }
2025-03-09 09:34:31,797 [INFO]: 	>>> Finished "Creating the index" in 36.9079 secs
2025-03-09 09:34:31,797 [INFO]: >>> Finished "Launching the whole pipeline" in 36.9320 secs
2025-03-09 09:34:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 66055 [episode count 0/20]
[retrieval_preprocessing] for episode 69649 [episode count 1/20], we have num_retrieval=np.int64(1767) num_query=np.int64(86)
2025-03-09 09:34:33,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:34,045 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:34
2025-03-09 09:34:34,046 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1313.18it/s]
2025-03-09 09:34:34,069 [INFO]: There are 1767 embeddings of dim 49152
2025-03-09 09:34:34,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 09:34:34,069 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:34
2025-03-09 09:34:34,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:34,069 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:34:34,069 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:34,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:34,069 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:34
2025-03-09 09:34:34,069 [INFO]: 364.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:34,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:34:34,069 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:34
2025-03-09 09:34:34,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:34,069 [INFO]: 	Creating the index 03/09/2025, 09:34:34
2025-03-09 09:34:34,070 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:34
2025-03-09 09:34:34,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 09:34:34,070 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:34
2025-03-09 09:34:34,070 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:34:34,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.46it/s] 86%|████████▌ | 6/7 [00:00<00:00, 31.78it/s]100%|██████████| 7/7 [00:01<00:00,  5.30it/s]
2025-03-09 09:34:35,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:35
2025-03-09 09:34:56,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7184 secs
2025-03-09 09:34:56,112 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 09:34:56,112 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.02it/s]
2025-03-09 09:35:07,900 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7879 secs
2025-03-09 09:35:07,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.8312 secs
2025-03-09 09:35:07,902 [INFO]: {
2025-03-09 09:35:07,902 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:07,902 [INFO]: 	index_param: efSearch=292
2025-03-09 09:35:07,902 [INFO]: 	index_path: knn.index
2025-03-09 09:35:07,902 [INFO]: 	size in bytes: 347646610
2025-03-09 09:35:07,902 [INFO]: 	avg_search_speed_ms: 9.790581328212967
2025-03-09 09:35:07,902 [INFO]: 	99p_search_speed_ms: 26.2388816406019
2025-03-09 09:35:07,902 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:07,902 [INFO]: 	nb vectors: 1767
2025-03-09 09:35:07,902 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:07,902 [INFO]: 	compression ratio: 0.9993088556220928
2025-03-09 09:35:07,902 [INFO]: }
2025-03-09 09:35:07,902 [INFO]: 	>>> Finished "Creating the index" in 33.8323 secs
2025-03-09 09:35:07,902 [INFO]: >>> Finished "Launching the whole pipeline" in 33.8562 secs
2025-03-09 09:35:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 69649 [episode count 1/20]
[retrieval_preprocessing] for episode 59411 [episode count 2/20], we have num_retrieval=np.int64(1771) num_query=np.int64(82)
2025-03-09 09:35:08,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:09,168 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:09
2025-03-09 09:35:09,168 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1275.64it/s]
2025-03-09 09:35:09,192 [INFO]: There are 1771 embeddings of dim 49152
2025-03-09 09:35:09,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 09:35:09,192 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:09
2025-03-09 09:35:09,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:09,192 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:35:09,192 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:09,192 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:35:09,192 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:09
2025-03-09 09:35:09,192 [INFO]: 365.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:09,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:35:09,192 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:09
2025-03-09 09:35:09,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:09,192 [INFO]: 	Creating the index 03/09/2025, 09:35:09
2025-03-09 09:35:09,192 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:09
2025-03-09 09:35:09,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:35:09,193 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:09
2025-03-09 09:35:09,193 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:35:09,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 14.21it/s] 71%|███████▏  | 5/7 [00:00<00:00, 18.25it/s]100%|██████████| 7/7 [00:01<00:00,  4.18it/s]100%|██████████| 7/7 [00:01<00:00,  5.26it/s]
2025-03-09 09:35:10,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:10
2025-03-09 09:35:33,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7562 secs
2025-03-09 09:35:33,285 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 09:35:33,285 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.21it/s]
2025-03-09 09:35:47,543 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2581 secs
2025-03-09 09:35:47,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3515 secs
2025-03-09 09:35:47,545 [INFO]: {
2025-03-09 09:35:47,545 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:47,545 [INFO]: 	index_param: efSearch=285
2025-03-09 09:35:47,545 [INFO]: 	index_path: knn.index
2025-03-09 09:35:47,545 [INFO]: 	size in bytes: 348433570
2025-03-09 09:35:47,545 [INFO]: 	avg_search_speed_ms: 9.326992669610181
2025-03-09 09:35:47,545 [INFO]: 	99p_search_speed_ms: 14.936954129952932
2025-03-09 09:35:47,545 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:47,545 [INFO]: 	nb vectors: 1771
2025-03-09 09:35:47,545 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:47,545 [INFO]: 	compression ratio: 0.999308901263446
2025-03-09 09:35:47,545 [INFO]: }
2025-03-09 09:35:47,545 [INFO]: 	>>> Finished "Creating the index" in 38.3526 secs
2025-03-09 09:35:47,545 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3769 secs
2025-03-09 09:35:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 59411 [episode count 2/20]
[retrieval_preprocessing] for episode 92692 [episode count 3/20], we have num_retrieval=np.int64(1768) num_query=np.int64(85)
2025-03-09 09:35:48,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:48,691 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:48
2025-03-09 09:35:48,691 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1949.93it/s]
2025-03-09 09:35:48,715 [INFO]: There are 1768 embeddings of dim 49152
2025-03-09 09:35:48,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 09:35:48,715 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:48
2025-03-09 09:35:48,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:48,716 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:35:48,716 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:48,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:35:48,716 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:48
2025-03-09 09:35:48,716 [INFO]: 364.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:48,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:35:48,716 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:48
2025-03-09 09:35:48,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:48,716 [INFO]: 	Creating the index 03/09/2025, 09:35:48
2025-03-09 09:35:48,716 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:48
2025-03-09 09:35:48,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 09:35:48,717 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:48
2025-03-09 09:35:48,717 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:35:48,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.71it/s]100%|██████████| 7/7 [00:01<00:00,  5.36it/s]100%|██████████| 7/7 [00:01<00:00,  5.70it/s]
2025-03-09 09:35:49,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:49
2025-03-09 09:36:11,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0405 secs
2025-03-09 09:36:11,988 [INFO]: The best hyperparameters are: efSearch=356
2025-03-09 09:36:11,988 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.62it/s]
2025-03-09 09:36:26,480 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4911 secs
2025-03-09 09:36:26,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.7643 secs
2025-03-09 09:36:26,481 [INFO]: {
2025-03-09 09:36:26,481 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:26,481 [INFO]: 	index_param: efSearch=356
2025-03-09 09:36:26,481 [INFO]: 	index_path: knn.index
2025-03-09 09:36:26,481 [INFO]: 	size in bytes: 347843350
2025-03-09 09:36:26,481 [INFO]: 	avg_search_speed_ms: 11.506685233225339
2025-03-09 09:36:26,481 [INFO]: 	99p_search_speed_ms: 29.275096268393092
2025-03-09 09:36:26,481 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:26,481 [INFO]: 	nb vectors: 1768
2025-03-09 09:36:26,481 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:26,481 [INFO]: 	compression ratio: 0.9993088670517921
2025-03-09 09:36:26,481 [INFO]: }
2025-03-09 09:36:26,481 [INFO]: 	>>> Finished "Creating the index" in 37.7654 secs
2025-03-09 09:36:26,481 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7902 secs
2025-03-09 09:36:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 92692 [episode count 3/20]
[retrieval_preprocessing] for episode 37397 [episode count 4/20], we have num_retrieval=np.int64(1749) num_query=np.int64(104)
2025-03-09 09:36:27,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:28,136 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:28
2025-03-09 09:36:28,137 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.32it/s]
2025-03-09 09:36:28,164 [INFO]: There are 1749 embeddings of dim 49152
2025-03-09 09:36:28,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 09:36:28,164 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:28
2025-03-09 09:36:28,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:28,164 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:36:28,164 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:28,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:36:28,164 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:28
2025-03-09 09:36:28,165 [INFO]: 361.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:28,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:36:28,165 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:28
2025-03-09 09:36:28,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:28,165 [INFO]: 	Creating the index 03/09/2025, 09:36:28
2025-03-09 09:36:28,165 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:28
2025-03-09 09:36:28,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:36:28,168 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:28
2025-03-09 09:36:28,168 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:36:28,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 27.49it/s]100%|██████████| 7/7 [00:01<00:00,  5.00it/s]100%|██████████| 7/7 [00:01<00:00,  5.58it/s]
2025-03-09 09:36:29,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:29
2025-03-09 09:36:54,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7136 secs
2025-03-09 09:36:54,143 [INFO]: The best hyperparameters are: efSearch=334
2025-03-09 09:36:54,143 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.71it/s]
2025-03-09 09:37:06,961 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8184 secs
2025-03-09 09:37:06,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7944 secs
2025-03-09 09:37:06,963 [INFO]: {
2025-03-09 09:37:06,963 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:06,963 [INFO]: 	index_param: efSearch=334
2025-03-09 09:37:06,963 [INFO]: 	index_path: knn.index
2025-03-09 09:37:06,963 [INFO]: 	size in bytes: 344105110
2025-03-09 09:37:06,963 [INFO]: 	avg_search_speed_ms: 10.110678014941552
2025-03-09 09:37:06,963 [INFO]: 	99p_search_speed_ms: 18.25987173244357
2025-03-09 09:37:06,963 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:06,963 [INFO]: 	nb vectors: 1749
2025-03-09 09:37:06,963 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:06,963 [INFO]: 	compression ratio: 0.9993091703869205
2025-03-09 09:37:06,963 [INFO]: }
2025-03-09 09:37:06,963 [INFO]: 	>>> Finished "Creating the index" in 38.7976 secs
2025-03-09 09:37:06,963 [INFO]: >>> Finished "Launching the whole pipeline" in 38.8264 secs
2025-03-09 09:37:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 37397 [episode count 4/20]
[retrieval_preprocessing] for episode 59414 [episode count 5/20], we have num_retrieval=np.int64(1746) num_query=np.int64(107)
2025-03-09 09:37:07,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:08,739 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:08
2025-03-09 09:37:08,739 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1580.37it/s]
2025-03-09 09:37:08,767 [INFO]: There are 1746 embeddings of dim 49152
2025-03-09 09:37:08,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 09:37:08,768 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:08
2025-03-09 09:37:08,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:08,769 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:37:08,769 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:08,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:37:08,769 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:08
2025-03-09 09:37:08,769 [INFO]: 360.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:08,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:37:08,770 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:08
2025-03-09 09:37:08,770 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:08,770 [INFO]: 	Creating the index 03/09/2025, 09:37:08
2025-03-09 09:37:08,770 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:08
2025-03-09 09:37:08,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:37:08,773 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:08
2025-03-09 09:37:08,773 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:37:08,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.90it/s]100%|██████████| 7/7 [00:01<00:00,  4.15it/s]100%|██████████| 7/7 [00:01<00:00,  4.43it/s]
2025-03-09 09:37:10,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:10
2025-03-09 09:37:36,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0878 secs
2025-03-09 09:37:36,447 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 09:37:36,447 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.63it/s]
2025-03-09 09:37:48,750 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3033 secs
2025-03-09 09:37:48,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.9786 secs
2025-03-09 09:37:48,752 [INFO]: {
2025-03-09 09:37:48,752 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:48,752 [INFO]: 	index_param: efSearch=284
2025-03-09 09:37:48,752 [INFO]: 	index_path: knn.index
2025-03-09 09:37:48,752 [INFO]: 	size in bytes: 343514890
2025-03-09 09:37:48,752 [INFO]: 	avg_search_speed_ms: 10.019281649036344
2025-03-09 09:37:48,752 [INFO]: 	99p_search_speed_ms: 24.988007647916675
2025-03-09 09:37:48,752 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:48,752 [INFO]: 	nb vectors: 1746
2025-03-09 09:37:48,752 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:48,752 [INFO]: 	compression ratio: 0.9993091362065848
2025-03-09 09:37:48,752 [INFO]: }
2025-03-09 09:37:48,752 [INFO]: 	>>> Finished "Creating the index" in 39.9824 secs
2025-03-09 09:37:48,752 [INFO]: >>> Finished "Launching the whole pipeline" in 40.0127 secs
2025-03-09 09:37:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 59414 [episode count 5/20]
[retrieval_preprocessing] for episode 73767 [episode count 6/20], we have num_retrieval=np.int64(1759) num_query=np.int64(94)
2025-03-09 09:37:49,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:49,969 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:49
2025-03-09 09:37:49,969 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2695.57it/s]
2025-03-09 09:37:49,992 [INFO]: There are 1759 embeddings of dim 49152
2025-03-09 09:37:49,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 09:37:49,992 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:49
2025-03-09 09:37:49,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:49,992 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:37:49,992 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:49,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:49,992 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:49
2025-03-09 09:37:49,993 [INFO]: 363.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:49,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:37:49,993 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:49
2025-03-09 09:37:49,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:49,993 [INFO]: 	Creating the index 03/09/2025, 09:37:49
2025-03-09 09:37:49,993 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:49
2025-03-09 09:37:49,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:37:49,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:49
2025-03-09 09:37:49,994 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:37:49,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.98it/s] 86%|████████▌ | 6/7 [00:00<00:00, 31.44it/s]100%|██████████| 7/7 [00:01<00:00,  4.04it/s]
2025-03-09 09:37:51,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:51
2025-03-09 09:38:14,262 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5337 secs
2025-03-09 09:38:14,263 [INFO]: The best hyperparameters are: efSearch=321
2025-03-09 09:38:14,263 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-09 09:38:28,142 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8794 secs
2025-03-09 09:38:28,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.1497 secs
2025-03-09 09:38:28,144 [INFO]: {
2025-03-09 09:38:28,144 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:28,144 [INFO]: 	index_param: efSearch=321
2025-03-09 09:38:28,144 [INFO]: 	index_path: knn.index
2025-03-09 09:38:28,144 [INFO]: 	size in bytes: 346072690
2025-03-09 09:38:28,144 [INFO]: 	avg_search_speed_ms: 11.080653291682435
2025-03-09 09:38:28,144 [INFO]: 	99p_search_speed_ms: 27.030402342788882
2025-03-09 09:38:28,144 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:28,144 [INFO]: 	nb vectors: 1759
2025-03-09 09:38:28,144 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:28,144 [INFO]: 	compression ratio: 0.9993087637166631
2025-03-09 09:38:28,144 [INFO]: }
2025-03-09 09:38:28,144 [INFO]: 	>>> Finished "Creating the index" in 38.1512 secs
2025-03-09 09:38:28,144 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1749 secs
2025-03-09 09:38:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 73767 [episode count 6/20]
[retrieval_preprocessing] for episode 553 [episode count 7/20], we have num_retrieval=np.int64(1772) num_query=np.int64(81)
2025-03-09 09:38:29,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:30,278 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:30
2025-03-09 09:38:30,278 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2231.01it/s]
2025-03-09 09:38:30,303 [INFO]: There are 1772 embeddings of dim 49152
2025-03-09 09:38:30,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:38:30,303 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:30
2025-03-09 09:38:30,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:30,303 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:38:30,303 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:30,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:38:30,303 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:30
2025-03-09 09:38:30,303 [INFO]: 365.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:30,303 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:38:30,303 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:30
2025-03-09 09:38:30,303 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:30,303 [INFO]: 	Creating the index 03/09/2025, 09:38:30
2025-03-09 09:38:30,303 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:30
2025-03-09 09:38:30,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:38:30,305 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:30
2025-03-09 09:38:30,305 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:38:30,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.88it/s]100%|██████████| 7/7 [00:01<00:00,  5.46it/s]100%|██████████| 7/7 [00:01<00:00,  5.81it/s]
2025-03-09 09:38:31,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:31
2025-03-09 09:38:52,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6832 secs
2025-03-09 09:38:52,197 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 09:38:52,197 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-09 09:39:06,460 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2629 secs
2025-03-09 09:39:06,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.1563 secs
2025-03-09 09:39:06,461 [INFO]: {
2025-03-09 09:39:06,461 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:06,461 [INFO]: 	index_param: efSearch=294
2025-03-09 09:39:06,461 [INFO]: 	index_path: knn.index
2025-03-09 09:39:06,461 [INFO]: 	size in bytes: 348630310
2025-03-09 09:39:06,461 [INFO]: 	avg_search_speed_ms: 9.489286339053605
2025-03-09 09:39:06,461 [INFO]: 	99p_search_speed_ms: 18.7605088716373
2025-03-09 09:39:06,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:06,461 [INFO]: 	nb vectors: 1772
2025-03-09 09:39:06,461 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:06,461 [INFO]: 	compression ratio: 0.9993089126415887
2025-03-09 09:39:06,461 [INFO]: }
2025-03-09 09:39:06,461 [INFO]: 	>>> Finished "Creating the index" in 36.1577 secs
2025-03-09 09:39:06,461 [INFO]: >>> Finished "Launching the whole pipeline" in 36.1829 secs
2025-03-09 09:39:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 553 [episode count 7/20]
[retrieval_preprocessing] for episode 42539 [episode count 8/20], we have num_retrieval=np.int64(1758) num_query=np.int64(95)
2025-03-09 09:39:08,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:08,430 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:08
2025-03-09 09:39:08,431 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2336.66it/s]
2025-03-09 09:39:08,454 [INFO]: There are 1758 embeddings of dim 49152
2025-03-09 09:39:08,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 09:39:08,454 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:08
2025-03-09 09:39:08,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:08,454 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:39:08,454 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:08,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:08,454 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:08
2025-03-09 09:39:08,454 [INFO]: 362.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:08,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:39:08,454 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:08
2025-03-09 09:39:08,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:08,454 [INFO]: 	Creating the index 03/09/2025, 09:39:08
2025-03-09 09:39:08,454 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:08
2025-03-09 09:39:08,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:39:08,455 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:08
2025-03-09 09:39:08,455 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:39:08,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.31it/s]100%|██████████| 7/7 [00:01<00:00,  5.74it/s]100%|██████████| 7/7 [00:01<00:00,  5.83it/s]
2025-03-09 09:39:09,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:09
2025-03-09 09:39:29,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9173 secs
2025-03-09 09:39:29,577 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 09:39:29,577 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.42it/s]
2025-03-09 09:39:42,015 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4380 secs
2025-03-09 09:39:42,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.5609 secs
2025-03-09 09:39:42,016 [INFO]: {
2025-03-09 09:39:42,016 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:42,016 [INFO]: 	index_param: efSearch=292
2025-03-09 09:39:42,016 [INFO]: 	index_path: knn.index
2025-03-09 09:39:42,016 [INFO]: 	size in bytes: 345875950
2025-03-09 09:39:42,016 [INFO]: 	avg_search_speed_ms: 9.589554369181737
2025-03-09 09:39:42,016 [INFO]: 	99p_search_speed_ms: 16.399545087479044
2025-03-09 09:39:42,016 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:42,016 [INFO]: 	nb vectors: 1758
2025-03-09 09:39:42,016 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:42,016 [INFO]: 	compression ratio: 0.9993087521696724
2025-03-09 09:39:42,016 [INFO]: }
2025-03-09 09:39:42,016 [INFO]: 	>>> Finished "Creating the index" in 33.5622 secs
2025-03-09 09:39:42,016 [INFO]: >>> Finished "Launching the whole pipeline" in 33.5858 secs
2025-03-09 09:39:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 42539 [episode count 8/20]
[retrieval_preprocessing] for episode 62507 [episode count 9/20], we have num_retrieval=np.int64(1754) num_query=np.int64(99)
2025-03-09 09:39:42,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:43,203 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:43
2025-03-09 09:39:43,203 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1929.30it/s]
2025-03-09 09:39:43,231 [INFO]: There are 1754 embeddings of dim 49152
2025-03-09 09:39:43,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 09:39:43,231 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:43
2025-03-09 09:39:43,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:43,231 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:39:43,231 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:43,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:39:43,232 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:43
2025-03-09 09:39:43,232 [INFO]: 362.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:43,232 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:39:43,232 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:43
2025-03-09 09:39:43,232 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:43,232 [INFO]: 	Creating the index 03/09/2025, 09:39:43
2025-03-09 09:39:43,232 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:43
2025-03-09 09:39:43,235 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:39:43,235 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:43
2025-03-09 09:39:43,236 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:39:43,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 25.72it/s]100%|██████████| 7/7 [00:01<00:00,  5.66it/s]100%|██████████| 7/7 [00:01<00:00,  6.28it/s]
2025-03-09 09:39:44,355 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:44
2025-03-09 09:40:05,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7075 secs
2025-03-09 09:40:05,063 [INFO]: The best hyperparameters are: efSearch=331
2025-03-09 09:40:05,063 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.16it/s]
2025-03-09 09:40:17,271 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2085 secs
2025-03-09 09:40:17,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.0371 secs
2025-03-09 09:40:17,273 [INFO]: {
2025-03-09 09:40:17,273 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:17,273 [INFO]: 	index_param: efSearch=331
2025-03-09 09:40:17,273 [INFO]: 	index_path: knn.index
2025-03-09 09:40:17,273 [INFO]: 	size in bytes: 345088990
2025-03-09 09:40:17,273 [INFO]: 	avg_search_speed_ms: 10.101830517647393
2025-03-09 09:40:17,273 [INFO]: 	99p_search_speed_ms: 18.428447821643207
2025-03-09 09:40:17,273 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:17,273 [INFO]: 	nb vectors: 1754
2025-03-09 09:40:17,273 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:17,273 [INFO]: 	compression ratio: 0.9993087058500475
2025-03-09 09:40:17,273 [INFO]: }
2025-03-09 09:40:17,273 [INFO]: 	>>> Finished "Creating the index" in 34.0404 secs
2025-03-09 09:40:17,273 [INFO]: >>> Finished "Launching the whole pipeline" in 34.0700 secs
2025-03-09 09:40:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 62507 [episode count 9/20]
[retrieval_preprocessing] for episode 94253 [episode count 10/20], we have num_retrieval=np.int64(1786) num_query=np.int64(67)
2025-03-09 09:40:19,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:19,990 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:19
2025-03-09 09:40:19,990 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2028.19it/s]
2025-03-09 09:40:20,015 [INFO]: There are 1786 embeddings of dim 49152
2025-03-09 09:40:20,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 09:40:20,015 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:20
2025-03-09 09:40:20,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:20,015 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:40:20,015 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:20,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:20,015 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:20
2025-03-09 09:40:20,015 [INFO]: 368.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:20,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:40:20,015 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:20
2025-03-09 09:40:20,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:20,015 [INFO]: 	Creating the index 03/09/2025, 09:40:20
2025-03-09 09:40:20,015 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:20
2025-03-09 09:40:20,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:40:20,016 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:20
2025-03-09 09:40:20,016 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:40:20,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.25it/s]100%|██████████| 8/8 [00:01<00:00,  6.48it/s]100%|██████████| 8/8 [00:01<00:00,  6.79it/s]
2025-03-09 09:40:21,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:21
2025-03-09 09:40:42,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0817 secs
2025-03-09 09:40:42,279 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:40:42,279 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-09 09:40:54,994 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7147 secs
2025-03-09 09:40:54,996 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.9794 secs
2025-03-09 09:40:54,996 [INFO]: {
2025-03-09 09:40:54,996 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:54,996 [INFO]: 	index_param: efSearch=226
2025-03-09 09:40:54,996 [INFO]: 	index_path: knn.index
2025-03-09 09:40:54,996 [INFO]: 	size in bytes: 351384790
2025-03-09 09:40:54,996 [INFO]: 	avg_search_speed_ms: 8.836231340058543
2025-03-09 09:40:54,996 [INFO]: 	99p_search_speed_ms: 14.047332874033602
2025-03-09 09:40:54,996 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:54,996 [INFO]: 	nb vectors: 1786
2025-03-09 09:40:54,996 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:54,996 [INFO]: 	compression ratio: 0.9993087293277549
2025-03-09 09:40:54,996 [INFO]: }
2025-03-09 09:40:54,996 [INFO]: 	>>> Finished "Creating the index" in 34.9811 secs
2025-03-09 09:40:54,996 [INFO]: >>> Finished "Launching the whole pipeline" in 35.0061 secs
2025-03-09 09:40:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 94253 [episode count 10/20]
[retrieval_preprocessing] for episode 53 [episode count 11/20], we have num_retrieval=np.int64(1753) num_query=np.int64(100)
2025-03-09 09:40:55,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:55,898 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:55
2025-03-09 09:40:55,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-09 09:40:55,923 [INFO]: There are 1753 embeddings of dim 49152
2025-03-09 09:40:55,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:40:55,923 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:55
2025-03-09 09:40:55,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:55,923 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:40:55,923 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:55,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:55,923 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:55
2025-03-09 09:40:55,923 [INFO]: 361.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:55,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:40:55,923 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:55
2025-03-09 09:40:55,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:55,923 [INFO]: 	Creating the index 03/09/2025, 09:40:55
2025-03-09 09:40:55,923 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:55
2025-03-09 09:40:55,925 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:40:55,925 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:55
2025-03-09 09:40:55,925 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:40:55,925 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.29it/s]100%|██████████| 7/7 [00:01<00:00,  6.09it/s]100%|██████████| 7/7 [00:01<00:00,  6.17it/s]
2025-03-09 09:40:57,063 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:57
2025-03-09 09:41:23,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4378 secs
2025-03-09 09:41:23,501 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 09:41:23,502 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.69it/s]
2025-03-09 09:41:36,854 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3529 secs
2025-03-09 09:41:36,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9314 secs
2025-03-09 09:41:36,856 [INFO]: {
2025-03-09 09:41:36,856 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:36,856 [INFO]: 	index_param: efSearch=289
2025-03-09 09:41:36,856 [INFO]: 	index_path: knn.index
2025-03-09 09:41:36,856 [INFO]: 	size in bytes: 344892250
2025-03-09 09:41:36,856 [INFO]: 	avg_search_speed_ms: 9.574960457143245
2025-03-09 09:41:36,856 [INFO]: 	99p_search_speed_ms: 18.923653215169907
2025-03-09 09:41:36,856 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:36,857 [INFO]: 	nb vectors: 1753
2025-03-09 09:41:36,857 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:36,857 [INFO]: 	compression ratio: 0.9993086942371132
2025-03-09 09:41:36,857 [INFO]: }
2025-03-09 09:41:36,857 [INFO]: 	>>> Finished "Creating the index" in 40.9334 secs
2025-03-09 09:41:36,857 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9588 secs
2025-03-09 09:41:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 53 [episode count 11/20]
[retrieval_preprocessing] for episode 70204 [episode count 12/20], we have num_retrieval=np.int64(1750) num_query=np.int64(103)
2025-03-09 09:41:37,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:38,099 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:38
2025-03-09 09:41:38,099 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1861.65it/s]
2025-03-09 09:41:38,124 [INFO]: There are 1750 embeddings of dim 49152
2025-03-09 09:41:38,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:41:38,125 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:38
2025-03-09 09:41:38,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:38,125 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:41:38,125 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:38,125 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:41:38,125 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:38
2025-03-09 09:41:38,125 [INFO]: 361.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:38,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:41:38,125 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:38
2025-03-09 09:41:38,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:38,125 [INFO]: 	Creating the index 03/09/2025, 09:41:38
2025-03-09 09:41:38,125 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:38
2025-03-09 09:41:38,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:41:38,126 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:38
2025-03-09 09:41:38,126 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:41:38,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.72it/s]100%|██████████| 7/7 [00:01<00:00,  5.71it/s]100%|██████████| 7/7 [00:01<00:00,  6.07it/s]
2025-03-09 09:41:39,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:39
2025-03-09 09:42:00,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.8252 secs
2025-03-09 09:42:00,109 [INFO]: The best hyperparameters are: efSearch=351
2025-03-09 09:42:00,109 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.48it/s]
2025-03-09 09:42:15,234 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1244 secs
2025-03-09 09:42:15,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1085 secs
2025-03-09 09:42:15,235 [INFO]: {
2025-03-09 09:42:15,235 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:15,235 [INFO]: 	index_param: efSearch=351
2025-03-09 09:42:15,235 [INFO]: 	index_path: knn.index
2025-03-09 09:42:15,235 [INFO]: 	size in bytes: 344301850
2025-03-09 09:42:15,235 [INFO]: 	avg_search_speed_ms: 11.702370246578203
2025-03-09 09:42:15,235 [INFO]: 	99p_search_speed_ms: 22.99497052561492
2025-03-09 09:42:15,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:15,235 [INFO]: 	nb vectors: 1750
2025-03-09 09:42:15,235 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:15,235 [INFO]: 	compression ratio: 0.999309181754324
2025-03-09 09:42:15,235 [INFO]: }
2025-03-09 09:42:15,235 [INFO]: 	>>> Finished "Creating the index" in 37.1100 secs
2025-03-09 09:42:15,235 [INFO]: >>> Finished "Launching the whole pipeline" in 37.1357 secs
2025-03-09 09:42:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 70204 [episode count 12/20]
[retrieval_preprocessing] for episode 65600 [episode count 13/20], we have num_retrieval=np.int64(1749) num_query=np.int64(104)
2025-03-09 09:42:16,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:16,567 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:16
2025-03-09 09:42:16,567 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.13it/s]
2025-03-09 09:42:16,590 [INFO]: There are 1749 embeddings of dim 49152
2025-03-09 09:42:16,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 09:42:16,591 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:16
2025-03-09 09:42:16,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:16,591 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:42:16,591 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:16,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:16,591 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:16
2025-03-09 09:42:16,591 [INFO]: 361.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:16,591 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:42:16,591 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:16
2025-03-09 09:42:16,591 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:16,591 [INFO]: 	Creating the index 03/09/2025, 09:42:16
2025-03-09 09:42:16,591 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:16
2025-03-09 09:42:16,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:42:16,592 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:16
2025-03-09 09:42:16,592 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:42:16,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.10it/s]100%|██████████| 7/7 [00:01<00:00,  5.61it/s]100%|██████████| 7/7 [00:01<00:00,  5.96it/s]
2025-03-09 09:42:17,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:17
2025-03-09 09:42:39,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1149 secs
2025-03-09 09:42:39,886 [INFO]: The best hyperparameters are: efSearch=341
2025-03-09 09:42:39,887 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.30it/s]
2025-03-09 09:42:54,565 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6780 secs
2025-03-09 09:42:55,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.6102 secs
2025-03-09 09:42:55,203 [INFO]: {
2025-03-09 09:42:55,203 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:55,203 [INFO]: 	index_param: efSearch=341
2025-03-09 09:42:55,203 [INFO]: 	index_path: knn.index
2025-03-09 09:42:55,203 [INFO]: 	size in bytes: 344105110
2025-03-09 09:42:55,203 [INFO]: 	avg_search_speed_ms: 10.05326575721291
2025-03-09 09:42:55,203 [INFO]: 	99p_search_speed_ms: 18.356902212835834
2025-03-09 09:42:55,203 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:55,203 [INFO]: 	nb vectors: 1749
2025-03-09 09:42:55,203 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:55,204 [INFO]: 	compression ratio: 0.9993091703869205
2025-03-09 09:42:55,204 [INFO]: }
2025-03-09 09:42:55,204 [INFO]: 	>>> Finished "Creating the index" in 38.6124 secs
2025-03-09 09:42:55,204 [INFO]: >>> Finished "Launching the whole pipeline" in 38.6364 secs
2025-03-09 09:42:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 65600 [episode count 13/20]
[retrieval_preprocessing] for episode 74307 [episode count 14/20], we have num_retrieval=np.int64(1785) num_query=np.int64(68)
2025-03-09 09:42:56,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:56,914 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:56
2025-03-09 09:42:56,914 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2340.57it/s]
2025-03-09 09:42:56,936 [INFO]: There are 1785 embeddings of dim 49152
2025-03-09 09:42:56,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-09 09:42:56,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:56
2025-03-09 09:42:56,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:56,936 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:42:56,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:56,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:56,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:56
2025-03-09 09:42:56,936 [INFO]: 368.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:56,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:42:56,936 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:56
2025-03-09 09:42:56,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:56,937 [INFO]: 	Creating the index 03/09/2025, 09:42:56
2025-03-09 09:42:56,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:56
2025-03-09 09:42:56,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:42:56,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:56
2025-03-09 09:42:56,938 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:42:56,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.70it/s]100%|██████████| 8/8 [00:01<00:00,  5.91it/s]100%|██████████| 8/8 [00:01<00:00,  6.47it/s]
2025-03-09 09:42:58,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:58
2025-03-09 09:43:17,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2377 secs
2025-03-09 09:43:17,416 [INFO]: The best hyperparameters are: efSearch=355
2025-03-09 09:43:17,416 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.87it/s]
2025-03-09 09:43:31,930 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5143 secs
2025-03-09 09:43:32,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5185 secs
2025-03-09 09:43:32,456 [INFO]: {
2025-03-09 09:43:32,457 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:32,457 [INFO]: 	index_param: efSearch=355
2025-03-09 09:43:32,457 [INFO]: 	index_path: knn.index
2025-03-09 09:43:32,457 [INFO]: 	size in bytes: 351188050
2025-03-09 09:43:32,457 [INFO]: 	avg_search_speed_ms: 11.833222261106474
2025-03-09 09:43:32,457 [INFO]: 	99p_search_speed_ms: 26.040545199066273
2025-03-09 09:43:32,457 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:32,457 [INFO]: 	nb vectors: 1785
2025-03-09 09:43:32,457 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:32,457 [INFO]: 	compression ratio: 0.9993087179361598
2025-03-09 09:43:32,457 [INFO]: }
2025-03-09 09:43:32,457 [INFO]: 	>>> Finished "Creating the index" in 35.5206 secs
2025-03-09 09:43:32,457 [INFO]: >>> Finished "Launching the whole pipeline" in 35.5431 secs
2025-03-09 09:43:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 74307 [episode count 14/20]
[retrieval_preprocessing] for episode 75331 [episode count 15/20], we have num_retrieval=np.int64(1739) num_query=np.int64(114)
2025-03-09 09:43:34,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:34,755 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:34
2025-03-09 09:43:34,756 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1890.18it/s]
2025-03-09 09:43:34,779 [INFO]: There are 1739 embeddings of dim 49152
2025-03-09 09:43:34,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 09:43:34,779 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:34
2025-03-09 09:43:34,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:34,780 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:43:34,780 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:34,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:34,780 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:34
2025-03-09 09:43:34,780 [INFO]: 358.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:34,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:34,780 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:34
2025-03-09 09:43:34,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:34,780 [INFO]: 	Creating the index 03/09/2025, 09:43:34
2025-03-09 09:43:34,780 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:34
2025-03-09 09:43:34,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:43:34,781 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:34
2025-03-09 09:43:34,781 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:43:34,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.88it/s]100%|██████████| 7/7 [00:01<00:00,  6.17it/s]100%|██████████| 7/7 [00:01<00:00,  6.54it/s]
2025-03-09 09:43:35,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:35
2025-03-09 09:43:55,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5595 secs
2025-03-09 09:43:55,415 [INFO]: The best hyperparameters are: efSearch=397
2025-03-09 09:43:55,415 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-09 09:44:12,181 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7663 secs
2025-03-09 09:44:12,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.4015 secs
2025-03-09 09:44:12,182 [INFO]: {
2025-03-09 09:44:12,182 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:12,182 [INFO]: 	index_param: efSearch=397
2025-03-09 09:44:12,182 [INFO]: 	index_path: knn.index
2025-03-09 09:44:12,183 [INFO]: 	size in bytes: 342137710
2025-03-09 09:44:12,183 [INFO]: 	avg_search_speed_ms: 11.169494135434174
2025-03-09 09:44:12,183 [INFO]: 	99p_search_speed_ms: 21.74247850198298
2025-03-09 09:44:12,183 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:12,183 [INFO]: 	nb vectors: 1739
2025-03-09 09:44:12,183 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:12,183 [INFO]: 	compression ratio: 0.999309055993857
2025-03-09 09:44:12,183 [INFO]: }
2025-03-09 09:44:12,183 [INFO]: 	>>> Finished "Creating the index" in 37.4027 secs
2025-03-09 09:44:12,183 [INFO]: >>> Finished "Launching the whole pipeline" in 37.4271 secs
2025-03-09 09:44:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 75331 [episode count 15/20]
[retrieval_preprocessing] for episode 8262 [episode count 16/20], we have num_retrieval=np.int64(1722) num_query=np.int64(131)
2025-03-09 09:44:13,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:13,686 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:13
2025-03-09 09:44:13,686 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.84it/s]
2025-03-09 09:44:13,711 [INFO]: There are 1722 embeddings of dim 49152
2025-03-09 09:44:13,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:44:13,711 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:13
2025-03-09 09:44:13,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:13,712 [INFO]: 		-> Add: 0.9 seconds
2025-03-09 09:44:13,712 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:13,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:44:13,712 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:13
2025-03-09 09:44:13,712 [INFO]: 355.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:13,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:44:13,712 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:13
2025-03-09 09:44:13,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:13,713 [INFO]: 	Creating the index 03/09/2025, 09:44:13
2025-03-09 09:44:13,713 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:13
2025-03-09 09:44:13,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 09:44:13,715 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:13
2025-03-09 09:44:13,716 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:44:13,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.92it/s]100%|██████████| 7/7 [00:01<00:00,  3.56it/s]100%|██████████| 7/7 [00:01<00:00,  3.82it/s]
2025-03-09 09:44:15,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:15
2025-03-09 09:44:35,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3659 secs
2025-03-09 09:44:35,919 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 09:44:35,919 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.64it/s]
2025-03-09 09:44:47,619 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7002 secs
2025-03-09 09:44:48,098 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.3823 secs
2025-03-09 09:44:48,098 [INFO]: {
2025-03-09 09:44:48,098 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:48,098 [INFO]: 	index_param: efSearch=290
2025-03-09 09:44:48,098 [INFO]: 	index_path: knn.index
2025-03-09 09:44:48,098 [INFO]: 	size in bytes: 338793010
2025-03-09 09:44:48,098 [INFO]: 	avg_search_speed_ms: 9.727027939436848
2025-03-09 09:44:48,098 [INFO]: 	99p_search_speed_ms: 22.16820519184694
2025-03-09 09:44:48,099 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:48,099 [INFO]: 	nb vectors: 1722
2025-03-09 09:44:48,099 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:48,099 [INFO]: 	compression ratio: 0.9993092124303273
2025-03-09 09:44:48,099 [INFO]: }
2025-03-09 09:44:48,099 [INFO]: 	>>> Finished "Creating the index" in 34.3862 secs
2025-03-09 09:44:48,099 [INFO]: >>> Finished "Launching the whole pipeline" in 34.4128 secs
2025-03-09 09:44:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 8262 [episode count 16/20]
[retrieval_preprocessing] for episode 43081 [episode count 17/20], we have num_retrieval=np.int64(1761) num_query=np.int64(92)
2025-03-09 09:44:49,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:49,427 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:49
2025-03-09 09:44:49,428 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1925.76it/s]
2025-03-09 09:44:49,449 [INFO]: There are 1761 embeddings of dim 49152
2025-03-09 09:44:49,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-09 09:44:49,450 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:49
2025-03-09 09:44:49,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:49,450 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:44:49,450 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:49,450 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:49,450 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:49
2025-03-09 09:44:49,450 [INFO]: 363.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:49,450 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:44:49,450 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:49
2025-03-09 09:44:49,450 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:49,450 [INFO]: 	Creating the index 03/09/2025, 09:44:49
2025-03-09 09:44:49,450 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:49
2025-03-09 09:44:49,451 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:44:49,451 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:49
2025-03-09 09:44:49,451 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:44:49,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.83it/s]100%|██████████| 7/7 [00:01<00:00,  5.03it/s]100%|██████████| 7/7 [00:01<00:00,  5.35it/s]
2025-03-09 09:44:50,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:50
2025-03-09 09:45:14,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2031 secs
2025-03-09 09:45:14,966 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 09:45:14,966 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.03it/s]
2025-03-09 09:45:28,580 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6138 secs
2025-03-09 09:45:28,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.1298 secs
2025-03-09 09:45:28,581 [INFO]: {
2025-03-09 09:45:28,581 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:28,581 [INFO]: 	index_param: efSearch=294
2025-03-09 09:45:28,581 [INFO]: 	index_path: knn.index
2025-03-09 09:45:28,581 [INFO]: 	size in bytes: 346466170
2025-03-09 09:45:28,581 [INFO]: 	avg_search_speed_ms: 9.84321680450702
2025-03-09 09:45:28,581 [INFO]: 	99p_search_speed_ms: 19.462526577990506
2025-03-09 09:45:28,581 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:28,581 [INFO]: 	nb vectors: 1761
2025-03-09 09:45:28,581 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:28,581 [INFO]: 	compression ratio: 0.999308786771303
2025-03-09 09:45:28,581 [INFO]: }
2025-03-09 09:45:28,581 [INFO]: 	>>> Finished "Creating the index" in 39.1310 secs
2025-03-09 09:45:28,581 [INFO]: >>> Finished "Launching the whole pipeline" in 39.1536 secs
2025-03-09 09:45:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 43081 [episode count 17/20]
[retrieval_preprocessing] for episode 44638 [episode count 18/20], we have num_retrieval=np.int64(1790) num_query=np.int64(63)
2025-03-09 09:45:30,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:30,613 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:30
2025-03-09 09:45:30,613 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1672.37it/s]
2025-03-09 09:45:30,638 [INFO]: There are 1790 embeddings of dim 49152
2025-03-09 09:45:30,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:45:30,638 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:30
2025-03-09 09:45:30,639 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:30,639 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:45:30,639 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:30,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:30,639 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:30
2025-03-09 09:45:30,639 [INFO]: 369.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:30,639 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:30,639 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:30
2025-03-09 09:45:30,639 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:30,639 [INFO]: 	Creating the index 03/09/2025, 09:45:30
2025-03-09 09:45:30,639 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:30
2025-03-09 09:45:30,640 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:45:30,640 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:30
2025-03-09 09:45:30,640 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:45:30,640 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.51it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.72it/s]100%|██████████| 8/8 [00:01<00:00,  6.96it/s]
2025-03-09 09:45:31,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:31
2025-03-09 09:45:53,131 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.3385 secs
2025-03-09 09:45:53,131 [INFO]: The best hyperparameters are: efSearch=324
2025-03-09 09:45:53,131 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s]
2025-03-09 09:46:08,963 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8315 secs
2025-03-09 09:46:09,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.4332 secs
2025-03-09 09:46:09,073 [INFO]: {
2025-03-09 09:46:09,074 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:09,074 [INFO]: 	index_param: efSearch=324
2025-03-09 09:46:09,074 [INFO]: 	index_path: knn.index
2025-03-09 09:46:09,074 [INFO]: 	size in bytes: 352171750
2025-03-09 09:46:09,074 [INFO]: 	avg_search_speed_ms: 10.171879538394593
2025-03-09 09:46:09,074 [INFO]: 	99p_search_speed_ms: 17.521323091350485
2025-03-09 09:46:09,074 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:09,074 [INFO]: 	nb vectors: 1790
2025-03-09 09:46:09,074 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:09,074 [INFO]: 	compression ratio: 0.9993087747668573
2025-03-09 09:46:09,074 [INFO]: }
2025-03-09 09:46:09,074 [INFO]: 	>>> Finished "Creating the index" in 38.4351 secs
2025-03-09 09:46:09,074 [INFO]: >>> Finished "Launching the whole pipeline" in 38.4608 secs
2025-03-09 09:46:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 44638 [episode count 18/20]
[retrieval_preprocessing] for episode 616 [episode count 19/20], we have num_retrieval=np.int64(1765) num_query=np.int64(88)
2025-03-09 09:46:09,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:10,148 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:10
2025-03-09 09:46:10,148 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.79it/s]
2025-03-09 09:46:10,175 [INFO]: There are 1765 embeddings of dim 49152
2025-03-09 09:46:10,175 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:46:10,175 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:10
2025-03-09 09:46:10,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:10,175 [INFO]: 		-> Add: 1.0 seconds
2025-03-09 09:46:10,175 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:10,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:10,175 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:10
2025-03-09 09:46:10,175 [INFO]: 364.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:10,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:46:10,175 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:10
2025-03-09 09:46:10,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:10,175 [INFO]: 	Creating the index 03/09/2025, 09:46:10
2025-03-09 09:46:10,176 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:10
2025-03-09 09:46:10,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:46:10,176 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:10
2025-03-09 09:46:10,177 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 09:46:10,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.21it/s]100%|██████████| 7/7 [00:01<00:00,  5.46it/s]100%|██████████| 7/7 [00:01<00:00,  5.79it/s]
2025-03-09 09:46:11,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:11
2025-03-09 09:46:34,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9935 secs
2025-03-09 09:46:34,383 [INFO]: The best hyperparameters are: efSearch=323
2025-03-09 09:46:34,383 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.45it/s]
2025-03-09 09:46:46,873 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4897 secs
2025-03-09 09:46:46,875 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.6988 secs
2025-03-09 09:46:46,875 [INFO]: {
2025-03-09 09:46:46,875 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:46,875 [INFO]: 	index_param: efSearch=323
2025-03-09 09:46:46,875 [INFO]: 	index_path: knn.index
2025-03-09 09:46:46,876 [INFO]: 	size in bytes: 347253130
2025-03-09 09:46:46,876 [INFO]: 	avg_search_speed_ms: 10.746517101858936
2025-03-09 09:46:46,876 [INFO]: 	99p_search_speed_ms: 24.05679810326547
2025-03-09 09:46:46,876 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:46,876 [INFO]: 	nb vectors: 1765
2025-03-09 09:46:46,876 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:46,876 [INFO]: 	compression ratio: 0.9993088327238404
2025-03-09 09:46:46,876 [INFO]: }
2025-03-09 09:46:46,876 [INFO]: 	>>> Finished "Creating the index" in 36.7001 secs
2025-03-09 09:46:46,876 [INFO]: >>> Finished "Launching the whole pipeline" in 36.7279 secs
2025-03-09 09:46:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 616 [episode count 19/20]
2025-03-09 09:46:47: [retrieval_preprocessing] finished for (9154343709, 'drawer') [chosen_id count 8/10]
2025-03-09 09:46:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6498288010, 'bottle') [chosen_id count 9/10]
2025-03-09 09:46:49: [retrieval_preprocessing] we have num_total=3085 embedding_dim=49152
[retrieval_preprocessing] for episode 31745 [episode count 0/20], we have num_retrieval=np.int64(2958) num_query=np.int64(127)
2025-03-09 09:46:49,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:49,837 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:49
2025-03-09 09:46:49,837 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.14it/s]
2025-03-09 09:46:49,861 [INFO]: There are 2958 embeddings of dim 49152
2025-03-09 09:46:49,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:46:49,861 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:49
2025-03-09 09:46:49,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:49,862 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:46:49,862 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:49,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:49,862 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:49
2025-03-09 09:46:49,862 [INFO]: 610.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:49,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:46:49,862 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:49
2025-03-09 09:46:49,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:49,862 [INFO]: 	Creating the index 03/09/2025, 09:46:49
2025-03-09 09:46:49,862 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:49
2025-03-09 09:46:49,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:46:49,863 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:49
2025-03-09 09:46:49,863 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:46:49,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.12it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.65it/s]100%|██████████| 12/12 [00:02<00:00,  4.17it/s]100%|██████████| 12/12 [00:02<00:00,  5.24it/s]
2025-03-09 09:46:52,407 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:52
2025-03-09 09:47:26,591 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1832 secs
2025-03-09 09:47:26,591 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:47:26,591 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.65it/s]
2025-03-09 09:47:44,054 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4634 secs
2025-03-09 09:47:44,056 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1932 secs
2025-03-09 09:47:44,056 [INFO]: {
2025-03-09 09:47:44,056 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:44,056 [INFO]: 	index_param: efSearch=252
2025-03-09 09:47:44,056 [INFO]: 	index_path: knn.index
2025-03-09 09:47:44,056 [INFO]: 	size in bytes: 581968210
2025-03-09 09:47:44,056 [INFO]: 	avg_search_speed_ms: 11.168217568151054
2025-03-09 09:47:44,056 [INFO]: 	99p_search_speed_ms: 24.622522445861243
2025-03-09 09:47:44,056 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:44,056 [INFO]: 	nb vectors: 2958
2025-03-09 09:47:44,056 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:44,056 [INFO]: 	compression ratio: 0.999309677069818
2025-03-09 09:47:44,056 [INFO]: }
2025-03-09 09:47:44,056 [INFO]: 	>>> Finished "Creating the index" in 54.1944 secs
2025-03-09 09:47:44,056 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2197 secs
2025-03-09 09:47:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 31745 [episode count 0/20]
[retrieval_preprocessing] for episode 6660 [episode count 1/20], we have num_retrieval=np.int64(2953) num_query=np.int64(132)
2025-03-09 09:47:45,600 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:47,085 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:47
2025-03-09 09:47:47,085 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-09 09:47:47,115 [INFO]: There are 2953 embeddings of dim 49152
2025-03-09 09:47:47,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 09:47:47,115 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:47
2025-03-09 09:47:47,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:47,115 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:47:47,115 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:47,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:47:47,115 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:47
2025-03-09 09:47:47,116 [INFO]: 609.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:47,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:47:47,116 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:47
2025-03-09 09:47:47,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:47,116 [INFO]: 	Creating the index 03/09/2025, 09:47:47
2025-03-09 09:47:47,116 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:47
2025-03-09 09:47:47,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 09:47:47,118 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:47
2025-03-09 09:47:47,118 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:47:47,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.67it/s] 50%|█████     | 6/12 [00:00<00:00, 31.09it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.50it/s]
2025-03-09 09:47:49,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:49
2025-03-09 09:48:23,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9616 secs
2025-03-09 09:48:23,751 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:48:23,751 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.81it/s]
2025-03-09 09:48:38,821 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0696 secs
2025-03-09 09:48:38,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7051 secs
2025-03-09 09:48:38,823 [INFO]: {
2025-03-09 09:48:38,823 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:38,823 [INFO]: 	index_param: efSearch=229
2025-03-09 09:48:38,823 [INFO]: 	index_path: knn.index
2025-03-09 09:48:38,823 [INFO]: 	size in bytes: 580984510
2025-03-09 09:48:38,823 [INFO]: 	avg_search_speed_ms: 12.513363955949899
2025-03-09 09:48:38,823 [INFO]: 	99p_search_speed_ms: 24.869500228669494
2025-03-09 09:48:38,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:38,823 [INFO]: 	nb vectors: 2953
2025-03-09 09:48:38,823 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:38,823 [INFO]: 	compression ratio: 0.9993096442450763
2025-03-09 09:48:38,823 [INFO]: }
2025-03-09 09:48:38,823 [INFO]: 	>>> Finished "Creating the index" in 51.7071 secs
2025-03-09 09:48:38,823 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7380 secs
2025-03-09 09:48:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 6660 [episode count 1/20]
[retrieval_preprocessing] for episode 53768 [episode count 2/20], we have num_retrieval=np.int64(2952) num_query=np.int64(133)
2025-03-09 09:48:40,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:41,509 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:41
2025-03-09 09:48:41,509 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1895.30it/s]
2025-03-09 09:48:41,531 [INFO]: There are 2952 embeddings of dim 49152
2025-03-09 09:48:41,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-09 09:48:41,531 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:41
2025-03-09 09:48:41,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:41,531 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:48:41,531 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:41,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:48:41,531 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:41
2025-03-09 09:48:41,531 [INFO]: 609.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:41,532 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:48:41,532 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:41
2025-03-09 09:48:41,532 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:41,532 [INFO]: 	Creating the index 03/09/2025, 09:48:41
2025-03-09 09:48:41,532 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:41
2025-03-09 09:48:41,533 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:48:41,533 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:41
2025-03-09 09:48:41,533 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:48:41,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.37it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.86it/s]100%|██████████| 12/12 [00:02<00:00,  5.25it/s]
2025-03-09 09:48:43,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:43
2025-03-09 09:49:11,740 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9136 secs
2025-03-09 09:49:11,741 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 09:49:11,741 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.70it/s]
2025-03-09 09:49:30,954 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2130 secs
2025-03-09 09:49:30,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4230 secs
2025-03-09 09:49:30,956 [INFO]: {
2025-03-09 09:49:30,956 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:30,956 [INFO]: 	index_param: efSearch=218
2025-03-09 09:49:30,956 [INFO]: 	index_path: knn.index
2025-03-09 09:49:30,956 [INFO]: 	size in bytes: 580787770
2025-03-09 09:49:30,956 [INFO]: 	avg_search_speed_ms: 9.487516544953667
2025-03-09 09:49:30,956 [INFO]: 	99p_search_speed_ms: 14.29158164653927
2025-03-09 09:49:30,956 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:30,956 [INFO]: 	nb vectors: 2952
2025-03-09 09:49:30,956 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:30,956 [INFO]: 	compression ratio: 0.9993096376667849
2025-03-09 09:49:30,956 [INFO]: }
2025-03-09 09:49:30,956 [INFO]: 	>>> Finished "Creating the index" in 49.4242 secs
2025-03-09 09:49:30,956 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4472 secs
2025-03-09 09:49:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 53768 [episode count 2/20]
[retrieval_preprocessing] for episode 24585 [episode count 3/20], we have num_retrieval=np.int64(2923) num_query=np.int64(162)
2025-03-09 09:49:32,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:32,519 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:32
2025-03-09 09:49:32,519 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1706.39it/s]
2025-03-09 09:49:32,543 [INFO]: There are 2923 embeddings of dim 49152
2025-03-09 09:49:32,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 09:49:32,543 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:32
2025-03-09 09:49:32,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:32,543 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:49:32,543 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:32,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:32,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:32
2025-03-09 09:49:32,544 [INFO]: 603.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:32,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:49:32,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:32
2025-03-09 09:49:32,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:32,544 [INFO]: 	Creating the index 03/09/2025, 09:49:32
2025-03-09 09:49:32,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:32
2025-03-09 09:49:32,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:49:32,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:32
2025-03-09 09:49:32,545 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:49:32,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.27it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.53it/s]100%|██████████| 12/12 [00:02<00:00,  5.32it/s]
2025-03-09 09:49:34,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:34
2025-03-09 09:50:10,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6845 secs
2025-03-09 09:50:10,488 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:50:10,488 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.19it/s]
2025-03-09 09:50:26,584 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0952 secs
2025-03-09 09:50:26,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0406 secs
2025-03-09 09:50:26,585 [INFO]: {
2025-03-09 09:50:26,585 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:26,585 [INFO]: 	index_param: efSearch=221
2025-03-09 09:50:26,585 [INFO]: 	index_path: knn.index
2025-03-09 09:50:26,586 [INFO]: 	size in bytes: 575082070
2025-03-09 09:50:26,586 [INFO]: 	avg_search_speed_ms: 9.536016545790266
2025-03-09 09:50:26,586 [INFO]: 	99p_search_speed_ms: 15.075022010132669
2025-03-09 09:50:26,586 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:26,586 [INFO]: 	nb vectors: 2923
2025-03-09 09:50:26,586 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:26,586 [INFO]: 	compression ratio: 0.9993098619819603
2025-03-09 09:50:26,586 [INFO]: }
2025-03-09 09:50:26,586 [INFO]: 	>>> Finished "Creating the index" in 54.0419 secs
2025-03-09 09:50:26,586 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0663 secs
2025-03-09 09:50:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 24585 [episode count 3/20]
[retrieval_preprocessing] for episode 75277 [episode count 4/20], we have num_retrieval=np.int64(2920) num_query=np.int64(165)
2025-03-09 09:50:28,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:28,884 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:28
2025-03-09 09:50:28,884 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2531.26it/s]
2025-03-09 09:50:28,907 [INFO]: There are 2920 embeddings of dim 49152
2025-03-09 09:50:28,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 09:50:28,907 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:28
2025-03-09 09:50:28,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:28,907 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:50:28,907 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:28,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:28,908 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:28
2025-03-09 09:50:28,908 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:28,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:50:28,908 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:28
2025-03-09 09:50:28,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:28,908 [INFO]: 	Creating the index 03/09/2025, 09:50:28
2025-03-09 09:50:28,908 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:28
2025-03-09 09:50:28,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:50:28,909 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:28
2025-03-09 09:50:28,909 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:50:28,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.59it/s] 75%|███████▌  | 9/12 [00:00<00:00, 43.20it/s]100%|██████████| 12/12 [00:02<00:00,  5.64it/s]
2025-03-09 09:50:31,041 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:31
2025-03-09 09:51:08,234 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1922 secs
2025-03-09 09:51:08,234 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:51:08,234 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-09 09:51:27,465 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2306 secs
2025-03-09 09:51:27,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5580 secs
2025-03-09 09:51:27,467 [INFO]: {
2025-03-09 09:51:27,467 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:27,467 [INFO]: 	index_param: efSearch=229
2025-03-09 09:51:27,467 [INFO]: 	index_path: knn.index
2025-03-09 09:51:27,467 [INFO]: 	size in bytes: 574491850
2025-03-09 09:51:27,467 [INFO]: 	avg_search_speed_ms: 12.08853768184781
2025-03-09 09:51:27,467 [INFO]: 	99p_search_speed_ms: 23.748244505841292
2025-03-09 09:51:27,467 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:27,467 [INFO]: 	nb vectors: 2920
2025-03-09 09:51:27,467 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:27,467 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-09 09:51:27,467 [INFO]: }
2025-03-09 09:51:27,467 [INFO]: 	>>> Finished "Creating the index" in 58.5594 secs
2025-03-09 09:51:27,467 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5828 secs
2025-03-09 09:51:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 75277 [episode count 4/20]
[retrieval_preprocessing] for episode 34831 [episode count 5/20], we have num_retrieval=np.int64(2937) num_query=np.int64(148)
2025-03-09 09:51:29,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:30,228 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:30
2025-03-09 09:51:30,229 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-09 09:51:30,394 [INFO]: There are 2937 embeddings of dim 49152
2025-03-09 09:51:30,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1655 secs
2025-03-09 09:51:30,394 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:30
2025-03-09 09:51:30,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:30,394 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:51:30,394 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:30,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:51:30,395 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:30
2025-03-09 09:51:30,395 [INFO]: 606.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:30,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:51:30,395 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:30
2025-03-09 09:51:30,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:30,395 [INFO]: 	Creating the index 03/09/2025, 09:51:30
2025-03-09 09:51:30,395 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:30
2025-03-09 09:51:30,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:51:30,396 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:30
2025-03-09 09:51:30,396 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:51:30,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.13it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.54it/s]100%|██████████| 12/12 [00:02<00:00,  5.47it/s]
2025-03-09 09:51:32,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:32
2025-03-09 09:52:08,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4410 secs
2025-03-09 09:52:08,035 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 09:52:08,035 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 09:52:28,264 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2298 secs
2025-03-09 09:52:28,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8699 secs
2025-03-09 09:52:28,266 [INFO]: {
2025-03-09 09:52:28,266 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:28,266 [INFO]: 	index_param: efSearch=232
2025-03-09 09:52:28,266 [INFO]: 	index_path: knn.index
2025-03-09 09:52:28,266 [INFO]: 	size in bytes: 577836550
2025-03-09 09:52:28,266 [INFO]: 	avg_search_speed_ms: 10.108840302681914
2025-03-09 09:52:28,266 [INFO]: 	99p_search_speed_ms: 18.410516250878576
2025-03-09 09:52:28,266 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:28,266 [INFO]: 	nb vectors: 2937
2025-03-09 09:52:28,266 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:28,266 [INFO]: 	compression ratio: 0.9993097459826659
2025-03-09 09:52:28,266 [INFO]: }
2025-03-09 09:52:28,266 [INFO]: 	>>> Finished "Creating the index" in 57.8714 secs
2025-03-09 09:52:28,266 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0378 secs
2025-03-09 09:52:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 34831 [episode count 5/20]
[retrieval_preprocessing] for episode 40469 [episode count 6/20], we have num_retrieval=np.int64(2925) num_query=np.int64(160)
2025-03-09 09:52:29,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:30,211 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:30
2025-03-09 09:52:30,212 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-09 09:52:30,235 [INFO]: There are 2925 embeddings of dim 49152
2025-03-09 09:52:30,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 09:52:30,235 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:30
2025-03-09 09:52:30,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:30,236 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:52:30,236 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:30,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:52:30,236 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:30
2025-03-09 09:52:30,236 [INFO]: 603.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:30,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:52:30,236 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:30
2025-03-09 09:52:30,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:30,236 [INFO]: 	Creating the index 03/09/2025, 09:52:30
2025-03-09 09:52:30,236 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:30
2025-03-09 09:52:30,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:52:30,237 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:30
2025-03-09 09:52:30,237 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:52:30,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 28.86it/s] 83%|████████▎ | 10/12 [00:00<00:00, 51.53it/s]100%|██████████| 12/12 [00:02<00:00,  5.58it/s]
2025-03-09 09:52:32,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:32
2025-03-09 09:53:08,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0890 secs
2025-03-09 09:53:08,480 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 09:53:08,480 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.70it/s]
2025-03-09 09:53:27,079 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5991 secs
2025-03-09 09:53:27,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8437 secs
2025-03-09 09:53:27,081 [INFO]: {
2025-03-09 09:53:27,081 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:27,081 [INFO]: 	index_param: efSearch=236
2025-03-09 09:53:27,081 [INFO]: 	index_path: knn.index
2025-03-09 09:53:27,081 [INFO]: 	size in bytes: 575475550
2025-03-09 09:53:27,081 [INFO]: 	avg_search_speed_ms: 10.088332209315087
2025-03-09 09:53:27,081 [INFO]: 	99p_search_speed_ms: 19.10748332738877
2025-03-09 09:53:27,081 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:27,081 [INFO]: 	nb vectors: 2925
2025-03-09 09:53:27,081 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:27,081 [INFO]: 	compression ratio: 0.9993098751111146
2025-03-09 09:53:27,081 [INFO]: }
2025-03-09 09:53:27,081 [INFO]: 	>>> Finished "Creating the index" in 56.8449 secs
2025-03-09 09:53:27,081 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8694 secs
2025-03-09 09:53:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 40469 [episode count 6/20]
[retrieval_preprocessing] for episode 57878 [episode count 7/20], we have num_retrieval=np.int64(2984) num_query=np.int64(101)
2025-03-09 09:53:28,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:53:29,126 [INFO]: Launching the whole pipeline 03/09/2025, 09:53:29
2025-03-09 09:53:29,126 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:53:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.01it/s]
2025-03-09 09:53:29,149 [INFO]: There are 2984 embeddings of dim 49152
2025-03-09 09:53:29,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 09:53:29,150 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:53:29
2025-03-09 09:53:29,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:53:29,150 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:53:29,150 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:53:29,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:53:29,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:53:29
2025-03-09 09:53:29,150 [INFO]: 615.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:53:29,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:53:29,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:53:29
2025-03-09 09:53:29,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:53:29,150 [INFO]: 	Creating the index 03/09/2025, 09:53:29
2025-03-09 09:53:29,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:53:29
2025-03-09 09:53:29,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:53:29,152 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:53:29
2025-03-09 09:53:29,152 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:53:29,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.26it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.26it/s]100%|██████████| 12/12 [00:02<00:00,  5.17it/s]
2025-03-09 09:53:31,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:53:31
2025-03-09 09:54:06,176 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6991 secs
2025-03-09 09:54:06,176 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 09:54:06,176 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.51it/s]
2025-03-09 09:54:23,158 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9816 secs
2025-03-09 09:54:23,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0080 secs
2025-03-09 09:54:23,160 [INFO]: {
2025-03-09 09:54:23,160 [INFO]: 	index_key: HNSW15
2025-03-09 09:54:23,160 [INFO]: 	index_param: efSearch=211
2025-03-09 09:54:23,160 [INFO]: 	index_path: knn.index
2025-03-09 09:54:23,160 [INFO]: 	size in bytes: 587083570
2025-03-09 09:54:23,160 [INFO]: 	avg_search_speed_ms: 10.848237339199123
2025-03-09 09:54:23,160 [INFO]: 	99p_search_speed_ms: 21.162772700190505
2025-03-09 09:54:23,160 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:54:23,160 [INFO]: 	nb vectors: 2984
2025-03-09 09:54:23,160 [INFO]: 	vectors dimension: 49152
2025-03-09 09:54:23,160 [INFO]: 	compression ratio: 0.9993096417261345
2025-03-09 09:54:23,160 [INFO]: }
2025-03-09 09:54:23,160 [INFO]: 	>>> Finished "Creating the index" in 54.0097 secs
2025-03-09 09:54:23,160 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0340 secs
2025-03-09 09:54:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 57878 [episode count 7/20]
[retrieval_preprocessing] for episode 68629 [episode count 8/20], we have num_retrieval=np.int64(2938) num_query=np.int64(147)
2025-03-09 09:54:24,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:24,440 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:24
2025-03-09 09:54:24,440 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2431.48it/s]
2025-03-09 09:54:24,464 [INFO]: There are 2938 embeddings of dim 49152
2025-03-09 09:54:24,465 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:54:24,465 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:24
2025-03-09 09:54:24,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:24,465 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:54:24,465 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:24,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:54:24,465 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:24
2025-03-09 09:54:24,465 [INFO]: 606.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:24,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:54:24,465 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:24
2025-03-09 09:54:24,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:24,465 [INFO]: 	Creating the index 03/09/2025, 09:54:24
2025-03-09 09:54:24,465 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:24
2025-03-09 09:54:24,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:54:24,466 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:24
2025-03-09 09:54:24,466 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:54:24,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.25it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.89it/s]100%|██████████| 12/12 [00:02<00:00,  5.04it/s]
2025-03-09 09:54:26,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:26
2025-03-09 09:54:55,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7767 secs
2025-03-09 09:54:55,625 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:54:55,625 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-09 09:55:11,446 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8205 secs
2025-03-09 09:55:11,448 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9813 secs
2025-03-09 09:55:11,448 [INFO]: {
2025-03-09 09:55:11,448 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:11,448 [INFO]: 	index_param: efSearch=229
2025-03-09 09:55:11,448 [INFO]: 	index_path: knn.index
2025-03-09 09:55:11,448 [INFO]: 	size in bytes: 578033290
2025-03-09 09:55:11,448 [INFO]: 	avg_search_speed_ms: 10.945343595360868
2025-03-09 09:55:11,448 [INFO]: 	99p_search_speed_ms: 26.211064613889906
2025-03-09 09:55:11,448 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:11,448 [INFO]: 	nb vectors: 2938
2025-03-09 09:55:11,448 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:11,448 [INFO]: 	compression ratio: 0.9993097525576771
2025-03-09 09:55:11,448 [INFO]: }
2025-03-09 09:55:11,448 [INFO]: 	>>> Finished "Creating the index" in 46.9828 secs
2025-03-09 09:55:11,448 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0080 secs
2025-03-09 09:55:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 68629 [episode count 8/20]
[retrieval_preprocessing] for episode 11289 [episode count 9/20], we have num_retrieval=np.int64(2928) num_query=np.int64(157)
2025-03-09 09:55:12,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:13,189 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:13
2025-03-09 09:55:13,189 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1711.26it/s]
2025-03-09 09:55:13,224 [INFO]: There are 2928 embeddings of dim 49152
2025-03-09 09:55:13,224 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-09 09:55:13,224 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:13
2025-03-09 09:55:13,224 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:13,224 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:55:13,224 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:13,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:55:13,224 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:13
2025-03-09 09:55:13,225 [INFO]: 604.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:13,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:55:13,225 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:13
2025-03-09 09:55:13,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:13,225 [INFO]: 	Creating the index 03/09/2025, 09:55:13
2025-03-09 09:55:13,225 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:13
2025-03-09 09:55:13,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:55:13,227 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:13
2025-03-09 09:55:13,227 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:55:13,228 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.56it/s] 83%|████████▎ | 10/12 [00:00<00:00, 48.08it/s]100%|██████████| 12/12 [00:01<00:00,  6.06it/s]
2025-03-09 09:55:15,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:15
2025-03-09 09:55:50,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1989 secs
2025-03-09 09:55:50,410 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 09:55:50,410 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-09 09:56:09,241 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8308 secs
2025-03-09 09:56:09,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0163 secs
2025-03-09 09:56:09,244 [INFO]: {
2025-03-09 09:56:09,244 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:09,244 [INFO]: 	index_param: efSearch=161
2025-03-09 09:56:09,244 [INFO]: 	index_path: knn.index
2025-03-09 09:56:09,244 [INFO]: 	size in bytes: 576065770
2025-03-09 09:56:09,244 [INFO]: 	avg_search_speed_ms: 7.4368213412445385
2025-03-09 09:56:09,244 [INFO]: 	99p_search_speed_ms: 12.025904506444931
2025-03-09 09:56:09,244 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:09,244 [INFO]: 	nb vectors: 2928
2025-03-09 09:56:09,244 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:09,244 [INFO]: 	compression ratio: 0.9993098947712168
2025-03-09 09:56:09,244 [INFO]: }
2025-03-09 09:56:09,244 [INFO]: 	>>> Finished "Creating the index" in 56.0189 secs
2025-03-09 09:56:09,245 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0558 secs
2025-03-09 09:56:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 11289 [episode count 9/20]
[retrieval_preprocessing] for episode 43550 [episode count 10/20], we have num_retrieval=np.int64(2990) num_query=np.int64(95)
2025-03-09 09:56:10,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:10,762 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:10
2025-03-09 09:56:10,762 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1598.44it/s]
2025-03-09 09:56:10,789 [INFO]: There are 2990 embeddings of dim 49152
2025-03-09 09:56:10,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:56:10,790 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:10
2025-03-09 09:56:10,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:10,790 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:56:10,790 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:10,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:56:10,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:10
2025-03-09 09:56:10,791 [INFO]: 617.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:10,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:56:10,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:10
2025-03-09 09:56:10,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:10,792 [INFO]: 	Creating the index 03/09/2025, 09:56:10
2025-03-09 09:56:10,792 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:10
2025-03-09 09:56:10,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0039 secs
2025-03-09 09:56:10,796 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:10
2025-03-09 09:56:10,796 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:56:10,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.35it/s] 75%|███████▌  | 9/12 [00:00<00:00, 43.12it/s]100%|██████████| 12/12 [00:02<00:00,  5.15it/s]
2025-03-09 09:56:13,130 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:13
2025-03-09 09:56:50,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5626 secs
2025-03-09 09:56:50,693 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:56:50,693 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.05it/s]
2025-03-09 09:57:10,077 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3839 secs
2025-03-09 09:57:10,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2828 secs
2025-03-09 09:57:10,079 [INFO]: {
2025-03-09 09:57:10,079 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:10,079 [INFO]: 	index_param: efSearch=200
2025-03-09 09:57:10,079 [INFO]: 	index_path: knn.index
2025-03-09 09:57:10,079 [INFO]: 	size in bytes: 588264010
2025-03-09 09:57:10,079 [INFO]: 	avg_search_speed_ms: 8.360538100216376
2025-03-09 09:57:10,079 [INFO]: 	99p_search_speed_ms: 12.904079828877
2025-03-09 09:57:10,079 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:10,079 [INFO]: 	nb vectors: 2990
2025-03-09 09:57:10,079 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:10,079 [INFO]: 	compression ratio: 0.9993096806993172
2025-03-09 09:57:10,079 [INFO]: }
2025-03-09 09:57:10,079 [INFO]: 	>>> Finished "Creating the index" in 59.2878 secs
2025-03-09 09:57:10,079 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3178 secs
2025-03-09 09:57:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 43550 [episode count 10/20]
[retrieval_preprocessing] for episode 40481 [episode count 11/20], we have num_retrieval=np.int64(2973) num_query=np.int64(112)
2025-03-09 09:57:11,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:11,716 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:11
2025-03-09 09:57:11,716 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2207.53it/s]
2025-03-09 09:57:11,742 [INFO]: There are 2973 embeddings of dim 49152
2025-03-09 09:57:11,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:57:11,742 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:11
2025-03-09 09:57:11,742 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:11,742 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:57:11,742 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:11,742 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:11,742 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:11
2025-03-09 09:57:11,742 [INFO]: 613.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:11,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:57:11,743 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:11
2025-03-09 09:57:11,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:11,743 [INFO]: 	Creating the index 03/09/2025, 09:57:11
2025-03-09 09:57:11,743 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:11
2025-03-09 09:57:11,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:57:11,744 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:11
2025-03-09 09:57:11,744 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:57:11,744 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.65it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.99it/s]
2025-03-09 09:57:14,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:14
2025-03-09 09:57:49,690 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5388 secs
2025-03-09 09:57:49,690 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:57:49,690 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-09 09:58:05,071 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3809 secs
2025-03-09 09:58:05,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3287 secs
2025-03-09 09:58:05,073 [INFO]: {
2025-03-09 09:58:05,073 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:05,073 [INFO]: 	index_param: efSearch=244
2025-03-09 09:58:05,073 [INFO]: 	index_path: knn.index
2025-03-09 09:58:05,073 [INFO]: 	size in bytes: 584919430
2025-03-09 09:58:05,073 [INFO]: 	avg_search_speed_ms: 11.248271290057824
2025-03-09 09:58:05,073 [INFO]: 	99p_search_speed_ms: 24.780143853276968
2025-03-09 09:58:05,073 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:05,073 [INFO]: 	nb vectors: 2973
2025-03-09 09:58:05,073 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:05,073 [INFO]: 	compression ratio: 0.9993095698667421
2025-03-09 09:58:05,073 [INFO]: }
2025-03-09 09:58:05,073 [INFO]: 	>>> Finished "Creating the index" in 53.3303 secs
2025-03-09 09:58:05,073 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3570 secs
2025-03-09 09:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 40481 [episode count 11/20]
[retrieval_preprocessing] for episode 67115 [episode count 12/20], we have num_retrieval=np.int64(2860) num_query=np.int64(225)
2025-03-09 09:58:06,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:06,696 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:06
2025-03-09 09:58:06,696 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1911.72it/s]
2025-03-09 09:58:06,722 [INFO]: There are 2860 embeddings of dim 49152
2025-03-09 09:58:06,723 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 09:58:06,723 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:06
2025-03-09 09:58:06,723 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:06,724 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:58:06,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:06,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:58:06,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:06
2025-03-09 09:58:06,724 [INFO]: 590.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:06,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:58:06,724 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:06
2025-03-09 09:58:06,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:06,725 [INFO]: 	Creating the index 03/09/2025, 09:58:06
2025-03-09 09:58:06,725 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:06
2025-03-09 09:58:06,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:58:06,728 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:06
2025-03-09 09:58:06,728 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:58:06,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.12it/s] 75%|███████▌  | 9/12 [00:00<00:00, 45.10it/s]100%|██████████| 12/12 [00:02<00:00,  5.28it/s]
2025-03-09 09:58:09,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:09
2025-03-09 09:58:37,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1972 secs
2025-03-09 09:58:37,205 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 09:58:37,205 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-09 09:58:54,041 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8361 secs
2025-03-09 09:58:54,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3149 secs
2025-03-09 09:58:54,043 [INFO]: {
2025-03-09 09:58:54,043 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:54,043 [INFO]: 	index_param: efSearch=256
2025-03-09 09:58:54,043 [INFO]: 	index_path: knn.index
2025-03-09 09:58:54,043 [INFO]: 	size in bytes: 562687270
2025-03-09 09:58:54,043 [INFO]: 	avg_search_speed_ms: 10.616085026413202
2025-03-09 09:58:54,043 [INFO]: 	99p_search_speed_ms: 17.296269382350147
2025-03-09 09:58:54,043 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:54,043 [INFO]: 	nb vectors: 2860
2025-03-09 09:58:54,043 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:54,043 [INFO]: 	compression ratio: 0.9993097586870945
2025-03-09 09:58:54,043 [INFO]: }
2025-03-09 09:58:54,043 [INFO]: 	>>> Finished "Creating the index" in 47.3183 secs
2025-03-09 09:58:54,043 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3471 secs
2025-03-09 09:58:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 67115 [episode count 12/20]
[retrieval_preprocessing] for episode 78901 [episode count 13/20], we have num_retrieval=np.int64(2951) num_query=np.int64(134)
2025-03-09 09:58:56,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:56,832 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:56
2025-03-09 09:58:56,832 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 3015.32it/s]
2025-03-09 09:58:56,856 [INFO]: There are 2951 embeddings of dim 49152
2025-03-09 09:58:56,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:58:56,857 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:56
2025-03-09 09:58:56,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:56,857 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:58:56,857 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:56,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:58:56,857 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:56
2025-03-09 09:58:56,857 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:56,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:58:56,857 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:56
2025-03-09 09:58:56,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:56,857 [INFO]: 	Creating the index 03/09/2025, 09:58:56
2025-03-09 09:58:56,857 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:56
2025-03-09 09:58:56,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:58:56,858 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:56
2025-03-09 09:58:56,858 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:58:56,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.65it/s] 50%|█████     | 6/12 [00:00<00:00, 30.48it/s]100%|██████████| 12/12 [00:02<00:00,  4.23it/s]100%|██████████| 12/12 [00:02<00:00,  4.89it/s]
2025-03-09 09:58:59,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:59
2025-03-09 09:59:30,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1892 secs
2025-03-09 09:59:30,505 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 09:59:30,505 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.07it/s]
2025-03-09 09:59:45,480 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9754 secs
2025-03-09 09:59:45,482 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6239 secs
2025-03-09 09:59:45,482 [INFO]: {
2025-03-09 09:59:45,482 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:45,482 [INFO]: 	index_param: efSearch=287
2025-03-09 09:59:45,482 [INFO]: 	index_path: knn.index
2025-03-09 09:59:45,482 [INFO]: 	size in bytes: 580590910
2025-03-09 09:59:45,482 [INFO]: 	avg_search_speed_ms: 13.021231698682337
2025-03-09 09:59:45,482 [INFO]: 	99p_search_speed_ms: 28.399565366562474
2025-03-09 09:59:45,482 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:45,482 [INFO]: 	nb vectors: 2951
2025-03-09 09:59:45,482 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:45,482 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-09 09:59:45,482 [INFO]: }
2025-03-09 09:59:45,482 [INFO]: 	>>> Finished "Creating the index" in 48.6254 secs
2025-03-09 09:59:45,482 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6499 secs
2025-03-09 09:59:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 78901 [episode count 13/20]
[retrieval_preprocessing] for episode 63030 [episode count 14/20], we have num_retrieval=np.int64(2833) num_query=np.int64(252)
2025-03-09 09:59:47,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:47,445 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:47
2025-03-09 09:59:47,445 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1784.81it/s]
2025-03-09 09:59:47,468 [INFO]: There are 2833 embeddings of dim 49152
2025-03-09 09:59:47,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-09 09:59:47,468 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:47,468 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:59:47,468 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:47,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:59:47,468 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,468 [INFO]: 584.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:47,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:59:47,468 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:47
2025-03-09 09:59:47,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:47,468 [INFO]: 	Creating the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,468 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:47
2025-03-09 09:59:47,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:59:47,469 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,469 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:59:47,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.40it/s]100%|██████████| 12/12 [00:02<00:00,  4.54it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-09 09:59:49,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:49
2025-03-09 10:00:20,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5968 secs
2025-03-09 10:00:20,294 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 10:00:20,294 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-09 10:00:37,853 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5591 secs
2025-03-09 10:00:37,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3852 secs
2025-03-09 10:00:37,855 [INFO]: {
2025-03-09 10:00:37,855 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:37,855 [INFO]: 	index_param: efSearch=229
2025-03-09 10:00:37,855 [INFO]: 	index_path: knn.index
2025-03-09 10:00:37,855 [INFO]: 	size in bytes: 557375290
2025-03-09 10:00:37,855 [INFO]: 	avg_search_speed_ms: 10.638936736838932
2025-03-09 10:00:37,855 [INFO]: 	99p_search_speed_ms: 29.243191564455632
2025-03-09 10:00:37,855 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:37,855 [INFO]: 	nb vectors: 2833
2025-03-09 10:00:37,855 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:37,855 [INFO]: 	compression ratio: 0.9993095747032489
2025-03-09 10:00:37,855 [INFO]: }
2025-03-09 10:00:37,855 [INFO]: 	>>> Finished "Creating the index" in 50.3864 secs
2025-03-09 10:00:37,855 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4094 secs
2025-03-09 10:00:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 63030 [episode count 14/20]
[retrieval_preprocessing] for episode 55 [episode count 15/20], we have num_retrieval=np.int64(2966) num_query=np.int64(119)
2025-03-09 10:00:40,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:41,659 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:41
2025-03-09 10:00:41,659 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2280.75it/s]
2025-03-09 10:00:41,680 [INFO]: There are 2966 embeddings of dim 49152
2025-03-09 10:00:41,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-09 10:00:41,681 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:41
2025-03-09 10:00:41,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:41,681 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:00:41,681 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:41,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:00:41,681 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:41
2025-03-09 10:00:41,681 [INFO]: 612.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:41,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:00:41,681 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:41
2025-03-09 10:00:41,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:41,681 [INFO]: 	Creating the index 03/09/2025, 10:00:41
2025-03-09 10:00:41,681 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:41
2025-03-09 10:00:41,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 10:00:41,682 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:41
2025-03-09 10:00:41,682 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:00:41,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.84it/s] 58%|█████▊    | 7/12 [00:00<00:00, 38.90it/s]100%|██████████| 12/12 [00:02<00:00,  4.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.91it/s]
2025-03-09 10:00:44,130 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:44
2025-03-09 10:01:18,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3653 secs
2025-03-09 10:01:18,496 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:01:18,496 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 10:01:34,925 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4291 secs
2025-03-09 10:01:34,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2458 secs
2025-03-09 10:01:34,928 [INFO]: {
2025-03-09 10:01:34,928 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:34,928 [INFO]: 	index_param: efSearch=264
2025-03-09 10:01:34,928 [INFO]: 	index_path: knn.index
2025-03-09 10:01:34,928 [INFO]: 	size in bytes: 583542190
2025-03-09 10:01:34,928 [INFO]: 	avg_search_speed_ms: 11.26899705153076
2025-03-09 10:01:34,928 [INFO]: 	99p_search_speed_ms: 23.224275098182257
2025-03-09 10:01:34,928 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:34,928 [INFO]: 	nb vectors: 2966
2025-03-09 10:01:34,928 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:34,928 [INFO]: 	compression ratio: 0.99930962660986
2025-03-09 10:01:34,928 [INFO]: }
2025-03-09 10:01:34,928 [INFO]: 	>>> Finished "Creating the index" in 53.2470 secs
2025-03-09 10:01:34,928 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2694 secs
2025-03-09 10:01:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 55 [episode count 15/20]
[retrieval_preprocessing] for episode 28728 [episode count 16/20], we have num_retrieval=np.int64(2861) num_query=np.int64(224)
2025-03-09 10:01:36,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:36,709 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:36
2025-03-09 10:01:36,709 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1558.64it/s]
2025-03-09 10:01:36,733 [INFO]: There are 2861 embeddings of dim 49152
2025-03-09 10:01:36,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:01:36,734 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:36
2025-03-09 10:01:36,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:36,734 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:01:36,734 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:36,734 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:36,734 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:36
2025-03-09 10:01:36,734 [INFO]: 590.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:36,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:01:36,734 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:36
2025-03-09 10:01:36,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:36,734 [INFO]: 	Creating the index 03/09/2025, 10:01:36
2025-03-09 10:01:36,734 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:36
2025-03-09 10:01:36,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:01:36,735 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:36
2025-03-09 10:01:36,735 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:01:36,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.54it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.69it/s]100%|██████████| 12/12 [00:02<00:00,  5.05it/s]
2025-03-09 10:01:39,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:39
2025-03-09 10:02:09,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1605 secs
2025-03-09 10:02:09,273 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 10:02:09,274 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.91it/s]
2025-03-09 10:02:22,639 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3653 secs
2025-03-09 10:02:22,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9052 secs
2025-03-09 10:02:22,641 [INFO]: {
2025-03-09 10:02:22,641 [INFO]: 	index_key: HNSW15
2025-03-09 10:02:22,641 [INFO]: 	index_param: efSearch=194
2025-03-09 10:02:22,641 [INFO]: 	index_path: knn.index
2025-03-09 10:02:22,641 [INFO]: 	size in bytes: 562884010
2025-03-09 10:02:22,641 [INFO]: 	avg_search_speed_ms: 8.918486486739885
2025-03-09 10:02:22,641 [INFO]: 	99p_search_speed_ms: 17.146888189017773
2025-03-09 10:02:22,641 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:02:22,641 [INFO]: 	nb vectors: 2861
2025-03-09 10:02:22,641 [INFO]: 	vectors dimension: 49152
2025-03-09 10:02:22,641 [INFO]: 	compression ratio: 0.999309765434623
2025-03-09 10:02:22,641 [INFO]: }
2025-03-09 10:02:22,641 [INFO]: 	>>> Finished "Creating the index" in 45.9067 secs
2025-03-09 10:02:22,641 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9318 secs
2025-03-09 10:02:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:02:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 28728 [episode count 16/20]
[retrieval_preprocessing] for episode 64057 [episode count 17/20], we have num_retrieval=np.int64(2951) num_query=np.int64(134)
2025-03-09 10:02:24,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:02:24,939 [INFO]: Launching the whole pipeline 03/09/2025, 10:02:24
2025-03-09 10:02:24,939 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2091.92it/s]
2025-03-09 10:02:24,964 [INFO]: There are 2951 embeddings of dim 49152
2025-03-09 10:02:24,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:02:24,964 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:02:24
2025-03-09 10:02:24,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:02:24,964 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:02:24,964 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:02:24,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:02:24,964 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:02:24
2025-03-09 10:02:24,965 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:02:24,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:02:24,965 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:02:24
2025-03-09 10:02:24,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:02:24,965 [INFO]: 	Creating the index 03/09/2025, 10:02:24
2025-03-09 10:02:24,965 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:02:24
2025-03-09 10:02:24,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:02:24,966 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:02:24
2025-03-09 10:02:24,966 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:02:24,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.50it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.84it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-09 10:02:27,402 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:27
2025-03-09 10:02:55,742 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3399 secs
2025-03-09 10:02:55,742 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 10:02:55,742 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.75it/s]
2025-03-09 10:03:11,988 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2459 secs
2025-03-09 10:03:11,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0242 secs
2025-03-09 10:03:11,990 [INFO]: {
2025-03-09 10:03:11,990 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:11,990 [INFO]: 	index_param: efSearch=273
2025-03-09 10:03:11,990 [INFO]: 	index_path: knn.index
2025-03-09 10:03:11,990 [INFO]: 	size in bytes: 580590910
2025-03-09 10:03:11,990 [INFO]: 	avg_search_speed_ms: 11.42881894830082
2025-03-09 10:03:11,990 [INFO]: 	99p_search_speed_ms: 20.088560758158565
2025-03-09 10:03:11,990 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:11,990 [INFO]: 	nb vectors: 2951
2025-03-09 10:03:11,990 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:11,990 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-09 10:03:11,990 [INFO]: }
2025-03-09 10:03:11,990 [INFO]: 	>>> Finished "Creating the index" in 47.0255 secs
2025-03-09 10:03:11,990 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0508 secs
2025-03-09 10:03:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 64057 [episode count 17/20]
[retrieval_preprocessing] for episode 10305 [episode count 18/20], we have num_retrieval=np.int64(2956) num_query=np.int64(129)
2025-03-09 10:03:13,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:13,998 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:13
2025-03-09 10:03:13,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1948.12it/s]
2025-03-09 10:03:14,022 [INFO]: There are 2956 embeddings of dim 49152
2025-03-09 10:03:14,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 10:03:14,022 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:14,022 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:03:14,022 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:14,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:03:14,022 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,022 [INFO]: 610.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:14,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:03:14,022 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:14
2025-03-09 10:03:14,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:14,022 [INFO]: 	Creating the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,022 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:14
2025-03-09 10:03:14,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:03:14,023 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,024 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:03:14,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.73it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.72it/s]100%|██████████| 12/12 [00:02<00:00,  4.97it/s]
2025-03-09 10:03:16,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:16
2025-03-09 10:03:46,078 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6376 secs
2025-03-09 10:03:46,078 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 10:03:46,078 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.95it/s]
2025-03-09 10:04:00,799 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7206 secs
2025-03-09 10:04:01,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5494 secs
2025-03-09 10:04:01,573 [INFO]: {
2025-03-09 10:04:01,573 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:01,573 [INFO]: 	index_param: efSearch=253
2025-03-09 10:04:01,573 [INFO]: 	index_path: knn.index
2025-03-09 10:04:01,573 [INFO]: 	size in bytes: 581574730
2025-03-09 10:04:01,574 [INFO]: 	avg_search_speed_ms: 10.872967656620819
2025-03-09 10:04:01,574 [INFO]: 	99p_search_speed_ms: 19.306221646256724
2025-03-09 10:04:01,574 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:01,574 [INFO]: 	nb vectors: 2956
2025-03-09 10:04:01,574 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:01,574 [INFO]: 	compression ratio: 0.9993096639532464
2025-03-09 10:04:01,574 [INFO]: }
2025-03-09 10:04:01,574 [INFO]: 	>>> Finished "Creating the index" in 47.5515 secs
2025-03-09 10:04:01,574 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5761 secs
2025-03-09 10:04:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 10305 [episode count 18/20]
[retrieval_preprocessing] for episode 25155 [episode count 19/20], we have num_retrieval=np.int64(2856) num_query=np.int64(229)
2025-03-09 10:04:02,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:03,310 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:03
2025-03-09 10:04:03,310 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1516.93it/s]
2025-03-09 10:04:03,334 [INFO]: There are 2856 embeddings of dim 49152
2025-03-09 10:04:03,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 10:04:03,334 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:03
2025-03-09 10:04:03,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:03,334 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:04:03,334 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:03,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:04:03,334 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:03
2025-03-09 10:04:03,334 [INFO]: 589.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:03,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:04:03,334 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:03
2025-03-09 10:04:03,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:03,334 [INFO]: 	Creating the index 03/09/2025, 10:04:03
2025-03-09 10:04:03,334 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:03
2025-03-09 10:04:03,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:04:03,335 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:03
2025-03-09 10:04:03,335 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:04:03,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.49it/s] 67%|██████▋   | 8/12 [00:00<00:00, 40.78it/s]100%|██████████| 12/12 [00:02<00:00,  5.27it/s]
2025-03-09 10:04:05,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:05
2025-03-09 10:04:37,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7642 secs
2025-03-09 10:04:37,378 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 10:04:37,378 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.71it/s]
2025-03-09 10:04:53,092 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7139 secs
2025-03-09 10:04:53,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7579 secs
2025-03-09 10:04:53,093 [INFO]: {
2025-03-09 10:04:53,093 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:53,093 [INFO]: 	index_param: efSearch=278
2025-03-09 10:04:53,093 [INFO]: 	index_path: knn.index
2025-03-09 10:04:53,093 [INFO]: 	size in bytes: 561900310
2025-03-09 10:04:53,093 [INFO]: 	avg_search_speed_ms: 10.785976035757535
2025-03-09 10:04:53,094 [INFO]: 	99p_search_speed_ms: 19.6900008013472
2025-03-09 10:04:53,094 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:53,094 [INFO]: 	nb vectors: 2856
2025-03-09 10:04:53,094 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:53,094 [INFO]: 	compression ratio: 0.9993097316497298
2025-03-09 10:04:53,094 [INFO]: }
2025-03-09 10:04:53,094 [INFO]: 	>>> Finished "Creating the index" in 49.7593 secs
2025-03-09 10:04:53,094 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7836 secs
2025-03-09 10:04:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 25155 [episode count 19/20]
2025-03-09 10:04:55: [retrieval_preprocessing] finished for (6498288010, 'bottle') [chosen_id count 9/10]
2025-03-09 10:04:55: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
