nohup: ignoring input
2025-03-09 06:47:05: got the info dicts: there are 36687 groupings

2025-03-09 06:47:05: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:05: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8911427557, 'bottle') [chosen_id count 0/10]
2025-03-09 06:47:05: [retrieval_preprocessing] we have num_total=2822 embedding_dim=49152
[retrieval_preprocessing] for episode 68865 [episode count 0/20], we have num_retrieval=np.int64(2663) num_query=np.int64(159)
2025-03-09 06:47:05,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:06,273 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:06
2025-03-09 06:47:06,273 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 7133.17it/s]
2025-03-09 06:47:06,314 [INFO]: There are 2663 embeddings of dim 49152
2025-03-09 06:47:06,314 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0408 secs
2025-03-09 06:47:06,315 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:06
2025-03-09 06:47:06,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:06,315 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:47:06,315 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:06,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:47:06,315 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:06
2025-03-09 06:47:06,316 [INFO]: 549.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:06,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0013 secs
2025-03-09 06:47:06,317 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:06
2025-03-09 06:47:06,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:06,317 [INFO]: 	Creating the index 03/09/2025, 06:47:06
2025-03-09 06:47:06,317 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:06
2025-03-09 06:47:06,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 06:47:06,320 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:06
2025-03-09 06:47:06,321 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:47:06,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 28.65it/s]100%|██████████| 11/11 [00:01<00:00,  7.03it/s]100%|██████████| 11/11 [00:01<00:00,  7.47it/s]
2025-03-09 06:47:07,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:07
2025-03-09 06:47:33,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3746 secs
2025-03-09 06:47:33,174 [INFO]: The best hyperparameters are: efSearch=376
2025-03-09 06:47:33,174 [INFO]: 	Compute fast metrics 03/09/2025, 06:47:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s]
2025-03-09 06:47:45,364 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1904 secs
2025-03-09 06:47:45,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0453 secs
2025-03-09 06:47:45,366 [INFO]: {
2025-03-09 06:47:45,366 [INFO]: 	index_key: HNSW15
2025-03-09 06:47:45,366 [INFO]: 	index_param: efSearch=376
2025-03-09 06:47:45,366 [INFO]: 	index_path: knn.index
2025-03-09 06:47:45,366 [INFO]: 	size in bytes: 523928830
2025-03-09 06:47:45,366 [INFO]: 	avg_search_speed_ms: 10.327276783602233
2025-03-09 06:47:45,366 [INFO]: 	99p_search_speed_ms: 15.26161017827689
2025-03-09 06:47:45,366 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:47:45,366 [INFO]: 	nb vectors: 2663
2025-03-09 06:47:45,366 [INFO]: 	vectors dimension: 49152
2025-03-09 06:47:45,366 [INFO]: 	compression ratio: 0.9993095894341222
2025-03-09 06:47:45,366 [INFO]: }
2025-03-09 06:47:45,366 [INFO]: 	>>> Finished "Creating the index" in 39.0492 secs
2025-03-09 06:47:45,366 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0927 secs
2025-03-09 06:47:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:47:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 68865 [episode count 0/20]
[retrieval_preprocessing] for episode 8066 [episode count 1/20], we have num_retrieval=np.int64(2689) num_query=np.int64(133)
2025-03-09 06:47:48,518 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:48,866 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:48
2025-03-09 06:47:48,867 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1565.04it/s]
2025-03-09 06:47:48,895 [INFO]: There are 2689 embeddings of dim 49152
2025-03-09 06:47:48,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 06:47:48,896 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:48
2025-03-09 06:47:48,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:48,896 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:47:48,896 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:48,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:47:48,896 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:48
2025-03-09 06:47:48,896 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:48,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:47:48,896 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:48
2025-03-09 06:47:48,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:48,896 [INFO]: 	Creating the index 03/09/2025, 06:47:48
2025-03-09 06:47:48,896 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:48
2025-03-09 06:47:48,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:47:48,897 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:48
2025-03-09 06:47:48,897 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:47:48,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.53it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.17it/s] 45%|████▌     | 5/11 [00:00<00:00, 13.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.59it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.87it/s]100%|██████████| 11/11 [00:02<00:00,  2.57it/s]100%|██████████| 11/11 [00:02<00:00,  4.11it/s]
2025-03-09 06:47:51,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:51
2025-03-09 06:48:21,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0687 secs
2025-03-09 06:48:21,645 [INFO]: The best hyperparameters are: efSearch=322
2025-03-09 06:48:21,645 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-09 06:48:34,271 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6268 secs
2025-03-09 06:48:34,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3763 secs
2025-03-09 06:48:34,273 [INFO]: {
2025-03-09 06:48:34,273 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:34,273 [INFO]: 	index_param: efSearch=322
2025-03-09 06:48:34,273 [INFO]: 	index_path: knn.index
2025-03-09 06:48:34,273 [INFO]: 	size in bytes: 529044070
2025-03-09 06:48:34,274 [INFO]: 	avg_search_speed_ms: 10.946579203386618
2025-03-09 06:48:34,274 [INFO]: 	99p_search_speed_ms: 20.76086205430329
2025-03-09 06:48:34,274 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:34,274 [INFO]: 	nb vectors: 2689
2025-03-09 06:48:34,274 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:34,274 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-09 06:48:34,274 [INFO]: }
2025-03-09 06:48:34,274 [INFO]: 	>>> Finished "Creating the index" in 45.3777 secs
2025-03-09 06:48:34,274 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4071 secs
2025-03-09 06:48:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 8066 [episode count 1/20]
[retrieval_preprocessing] for episode 13059 [episode count 2/20], we have num_retrieval=np.int64(2684) num_query=np.int64(138)
2025-03-09 06:48:35,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:36,038 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:36
2025-03-09 06:48:36,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]
2025-03-09 06:48:36,065 [INFO]: There are 2684 embeddings of dim 49152
2025-03-09 06:48:36,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 06:48:36,066 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:36
2025-03-09 06:48:36,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:36,066 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:48:36,066 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:36,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:36,066 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:36
2025-03-09 06:48:36,066 [INFO]: 553.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:36,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:48:36,066 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:36
2025-03-09 06:48:36,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:36,066 [INFO]: 	Creating the index 03/09/2025, 06:48:36
2025-03-09 06:48:36,066 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:36
2025-03-09 06:48:36,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:48:36,067 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:36
2025-03-09 06:48:36,067 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:48:36,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.49it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.56it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.96it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.80it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.79it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.87it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]
2025-03-09 06:48:38,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:38
2025-03-09 06:49:05,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2787 secs
2025-03-09 06:49:05,187 [INFO]: The best hyperparameters are: efSearch=359
2025-03-09 06:49:05,187 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 06:49:17,648 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4616 secs
2025-03-09 06:49:17,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5832 secs
2025-03-09 06:49:17,651 [INFO]: {
2025-03-09 06:49:17,651 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:17,651 [INFO]: 	index_param: efSearch=359
2025-03-09 06:49:17,651 [INFO]: 	index_path: knn.index
2025-03-09 06:49:17,651 [INFO]: 	size in bytes: 528060370
2025-03-09 06:49:17,651 [INFO]: 	avg_search_speed_ms: 11.685253981289794
2025-03-09 06:49:17,651 [INFO]: 	99p_search_speed_ms: 19.426176231354503
2025-03-09 06:49:17,651 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:17,651 [INFO]: 	nb vectors: 2684
2025-03-09 06:49:17,651 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:17,651 [INFO]: 	compression ratio: 0.9993097418009232
2025-03-09 06:49:17,651 [INFO]: }
2025-03-09 06:49:17,651 [INFO]: 	>>> Finished "Creating the index" in 41.5846 secs
2025-03-09 06:49:17,651 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6131 secs
2025-03-09 06:49:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 13059 [episode count 2/20]
[retrieval_preprocessing] for episode 54916 [episode count 3/20], we have num_retrieval=np.int64(2669) num_query=np.int64(153)
2025-03-09 06:49:20,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:20,763 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:20
2025-03-09 06:49:20,763 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-09 06:49:20,792 [INFO]: There are 2669 embeddings of dim 49152
2025-03-09 06:49:20,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 06:49:20,792 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:20
2025-03-09 06:49:20,792 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:20,792 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:49:20,792 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:20,792 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:20,792 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:20
2025-03-09 06:49:20,792 [INFO]: 550.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:20,792 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:20,793 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:20
2025-03-09 06:49:20,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:20,793 [INFO]: 	Creating the index 03/09/2025, 06:49:20
2025-03-09 06:49:20,793 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:20
2025-03-09 06:49:20,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:49:20,794 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:20
2025-03-09 06:49:20,794 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:49:20,794 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.83it/s] 36%|███▋      | 4/11 [00:00<00:00, 13.82it/s] 55%|█████▍    | 6/11 [00:00<00:00, 15.48it/s] 82%|████████▏ | 9/11 [00:00<00:00, 17.42it/s]100%|██████████| 11/11 [00:02<00:00,  2.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.04it/s]
2025-03-09 06:49:23,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:23
2025-03-09 06:49:50,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7579 secs
2025-03-09 06:49:50,280 [INFO]: The best hyperparameters are: efSearch=329
2025-03-09 06:49:50,280 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 06:50:15,427 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1472 secs
2025-03-09 06:50:15,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6355 secs
2025-03-09 06:50:15,429 [INFO]: {
2025-03-09 06:50:15,429 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:15,429 [INFO]: 	index_param: efSearch=329
2025-03-09 06:50:15,429 [INFO]: 	index_path: knn.index
2025-03-09 06:50:15,429 [INFO]: 	size in bytes: 525109270
2025-03-09 06:50:15,429 [INFO]: 	avg_search_speed_ms: 11.175847249417748
2025-03-09 06:50:15,429 [INFO]: 	99p_search_speed_ms: 16.761397845111784
2025-03-09 06:50:15,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:15,429 [INFO]: 	nb vectors: 2669
2025-03-09 06:50:15,429 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:15,429 [INFO]: 	compression ratio: 0.9993096332121503
2025-03-09 06:50:15,429 [INFO]: }
2025-03-09 06:50:15,429 [INFO]: 	>>> Finished "Creating the index" in 54.6368 secs
2025-03-09 06:50:15,429 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6667 secs
2025-03-09 06:50:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 54916 [episode count 3/20]
[retrieval_preprocessing] for episode 73988 [episode count 4/20], we have num_retrieval=np.int64(2672) num_query=np.int64(150)
2025-03-09 06:50:19,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:19,593 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:19
2025-03-09 06:50:19,594 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.37it/s]
2025-03-09 06:50:19,626 [INFO]: There are 2672 embeddings of dim 49152
2025-03-09 06:50:19,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 06:50:19,627 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:19
2025-03-09 06:50:19,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:19,627 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:50:19,627 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:19,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:50:19,627 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:19
2025-03-09 06:50:19,628 [INFO]: 551.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:19,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:50:19,628 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:19
2025-03-09 06:50:19,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:19,628 [INFO]: 	Creating the index 03/09/2025, 06:50:19
2025-03-09 06:50:19,628 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:19
2025-03-09 06:50:19,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:50:19,631 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:19
2025-03-09 06:50:19,631 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:50:19,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.01it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.11it/s] 45%|████▌     | 5/11 [00:00<00:00, 13.55it/s] 64%|██████▎   | 7/11 [00:00<00:00, 14.37it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.57it/s]100%|██████████| 11/11 [00:02<00:00,  2.42it/s]100%|██████████| 11/11 [00:02<00:00,  3.93it/s]
2025-03-09 06:50:22,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:22
2025-03-09 06:50:56,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7491 secs
2025-03-09 06:50:56,183 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 06:50:56,183 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.02it/s] 50%|█████     | 2/4 [00:01<00:01,  1.23it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.34it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.11it/s]
2025-03-09 06:51:10,882 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6996 secs
2025-03-09 06:51:10,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2536 secs
2025-03-09 06:51:10,885 [INFO]: {
2025-03-09 06:51:10,885 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:10,885 [INFO]: 	index_param: efSearch=307
2025-03-09 06:51:10,885 [INFO]: 	index_path: knn.index
2025-03-09 06:51:10,885 [INFO]: 	size in bytes: 525699490
2025-03-09 06:51:10,885 [INFO]: 	avg_search_speed_ms: 11.281050573152479
2025-03-09 06:51:10,885 [INFO]: 	99p_search_speed_ms: 20.80258519388735
2025-03-09 06:51:10,885 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:10,885 [INFO]: 	nb vectors: 2672
2025-03-09 06:51:10,885 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:10,885 [INFO]: 	compression ratio: 0.9993096550274378
2025-03-09 06:51:10,885 [INFO]: }
2025-03-09 06:51:10,885 [INFO]: 	>>> Finished "Creating the index" in 51.2571 secs
2025-03-09 06:51:10,885 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2916 secs
2025-03-09 06:51:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 73988 [episode count 4/20]
[retrieval_preprocessing] for episode 30470 [episode count 5/20], we have num_retrieval=np.int64(2697) num_query=np.int64(125)
2025-03-09 06:51:14,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:15,123 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:15
2025-03-09 06:51:15,123 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-09 06:51:15,150 [INFO]: There are 2697 embeddings of dim 49152
2025-03-09 06:51:15,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 06:51:15,150 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:15
2025-03-09 06:51:15,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:15,150 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:51:15,150 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:15,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:15,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:15
2025-03-09 06:51:15,150 [INFO]: 556.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:15,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:51:15,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:15
2025-03-09 06:51:15,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:15,150 [INFO]: 	Creating the index 03/09/2025, 06:51:15
2025-03-09 06:51:15,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:15
2025-03-09 06:51:15,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 06:51:15,152 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:15
2025-03-09 06:51:15,152 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:51:15,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.10it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.49it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.17it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.31it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.43it/s]100%|██████████| 11/11 [00:02<00:00,  2.49it/s]100%|██████████| 11/11 [00:02<00:00,  3.95it/s]
2025-03-09 06:51:17,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:17
2025-03-09 06:51:46,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0016 secs
2025-03-09 06:51:46,946 [INFO]: The best hyperparameters are: efSearch=347
2025-03-09 06:51:46,946 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
2025-03-09 06:52:00,979 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0329 secs
2025-03-09 06:52:00,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8295 secs
2025-03-09 06:52:00,982 [INFO]: {
2025-03-09 06:52:00,982 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:00,982 [INFO]: 	index_param: efSearch=347
2025-03-09 06:52:00,982 [INFO]: 	index_path: knn.index
2025-03-09 06:52:00,982 [INFO]: 	size in bytes: 530618050
2025-03-09 06:52:00,982 [INFO]: 	avg_search_speed_ms: 11.306592787873779
2025-03-09 06:52:00,982 [INFO]: 	99p_search_speed_ms: 20.004760557785627
2025-03-09 06:52:00,982 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:00,982 [INFO]: 	nb vectors: 2697
2025-03-09 06:52:00,982 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:00,982 [INFO]: 	compression ratio: 0.9993097219365229
2025-03-09 06:52:00,982 [INFO]: }
2025-03-09 06:52:00,982 [INFO]: 	>>> Finished "Creating the index" in 45.8313 secs
2025-03-09 06:52:00,982 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8589 secs
2025-03-09 06:52:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 30470 [episode count 5/20]
[retrieval_preprocessing] for episode 76037 [episode count 6/20], we have num_retrieval=np.int64(2679) num_query=np.int64(143)
2025-03-09 06:52:03,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:04,098 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:04
2025-03-09 06:52:04,098 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-09 06:52:04,120 [INFO]: There are 2679 embeddings of dim 49152
2025-03-09 06:52:04,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-09 06:52:04,121 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:04,121 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:52:04,121 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:04,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:52:04,121 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,121 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:04,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:52:04,121 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:04
2025-03-09 06:52:04,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:04,121 [INFO]: 	Creating the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,122 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:04
2025-03-09 06:52:04,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 06:52:04,124 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,124 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:04,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.98it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.41it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.04it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.38it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.28it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.10it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.07it/s]100%|██████████| 11/11 [00:03<00:00,  1.42it/s]100%|██████████| 11/11 [00:03<00:00,  3.23it/s]
2025-03-09 06:52:07,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:07
2025-03-09 06:52:35,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5255 secs
2025-03-09 06:52:35,054 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 06:52:35,054 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-09 06:52:48,428 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3740 secs
2025-03-09 06:52:48,430 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3063 secs
2025-03-09 06:52:48,431 [INFO]: {
2025-03-09 06:52:48,431 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:48,431 [INFO]: 	index_param: efSearch=302
2025-03-09 06:52:48,431 [INFO]: 	index_path: knn.index
2025-03-09 06:52:48,431 [INFO]: 	size in bytes: 527076670
2025-03-09 06:52:48,431 [INFO]: 	avg_search_speed_ms: 10.754550196560881
2025-03-09 06:52:48,431 [INFO]: 	99p_search_speed_ms: 20.610301131382585
2025-03-09 06:52:48,431 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:48,431 [INFO]: 	nb vectors: 2679
2025-03-09 06:52:48,431 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:48,431 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-09 06:52:48,431 [INFO]: }
2025-03-09 06:52:48,431 [INFO]: 	>>> Finished "Creating the index" in 44.3092 secs
2025-03-09 06:52:48,431 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3325 secs
2025-03-09 06:52:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 76037 [episode count 6/20]
[retrieval_preprocessing] for episode 5772 [episode count 7/20], we have num_retrieval=np.int64(2689) num_query=np.int64(133)
2025-03-09 06:52:50,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:51,087 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:51
2025-03-09 06:52:51,087 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.72it/s]
2025-03-09 06:52:51,123 [INFO]: There are 2689 embeddings of dim 49152
2025-03-09 06:52:51,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-09 06:52:51,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:51
2025-03-09 06:52:51,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:51,123 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:52:51,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:51,124 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:52:51,124 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:51
2025-03-09 06:52:51,124 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:51,124 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:52:51,124 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:51
2025-03-09 06:52:51,124 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:51,124 [INFO]: 	Creating the index 03/09/2025, 06:52:51
2025-03-09 06:52:51,124 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:51
2025-03-09 06:52:51,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 06:52:51,126 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:51
2025-03-09 06:52:51,126 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:51,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.62it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.04it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.62it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.94it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.21it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.20it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.13it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.16it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.15it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.14it/s]100%|██████████| 11/11 [00:03<00:00,  1.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.31it/s]
2025-03-09 06:52:54,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:54
2025-03-09 06:53:21,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4701 secs
2025-03-09 06:53:21,922 [INFO]: The best hyperparameters are: efSearch=305
2025-03-09 06:53:21,922 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.01s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.38it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it]
2025-03-09 06:53:37,508 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5860 secs
2025-03-09 06:53:37,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3835 secs
2025-03-09 06:53:37,510 [INFO]: {
2025-03-09 06:53:37,510 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:37,510 [INFO]: 	index_param: efSearch=305
2025-03-09 06:53:37,510 [INFO]: 	index_path: knn.index
2025-03-09 06:53:37,510 [INFO]: 	size in bytes: 529044070
2025-03-09 06:53:37,510 [INFO]: 	avg_search_speed_ms: 9.815937127704139
2025-03-09 06:53:37,510 [INFO]: 	99p_search_speed_ms: 14.354649288579814
2025-03-09 06:53:37,510 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:37,510 [INFO]: 	nb vectors: 2689
2025-03-09 06:53:37,510 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:37,510 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-09 06:53:37,510 [INFO]: }
2025-03-09 06:53:37,510 [INFO]: 	>>> Finished "Creating the index" in 46.3859 secs
2025-03-09 06:53:37,510 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4229 secs
2025-03-09 06:53:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 5772 [episode count 7/20]
[retrieval_preprocessing] for episode 79118 [episode count 8/20], we have num_retrieval=np.int64(2690) num_query=np.int64(132)
2025-03-09 06:53:39,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:39,605 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:39
2025-03-09 06:53:39,606 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1291.75it/s]
2025-03-09 06:53:39,633 [INFO]: There are 2690 embeddings of dim 49152
2025-03-09 06:53:39,634 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 06:53:39,634 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:39
2025-03-09 06:53:39,634 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:39,634 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:53:39,634 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:39,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:53:39,635 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:39
2025-03-09 06:53:39,635 [INFO]: 555.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:39,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:53:39,635 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:39
2025-03-09 06:53:39,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:39,636 [INFO]: 	Creating the index 03/09/2025, 06:53:39
2025-03-09 06:53:39,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:39
2025-03-09 06:53:39,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:53:39,639 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:39
2025-03-09 06:53:39,639 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:53:39,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.87it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.35it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.00it/s] 55%|█████▍    | 6/11 [00:00<00:00, 11.93it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.18it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.08it/s]100%|██████████| 11/11 [00:02<00:00,  3.69it/s]
2025-03-09 06:53:42,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:42
2025-03-09 06:54:08,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0272 secs
2025-03-09 06:54:08,650 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 06:54:08,650 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-09 06:54:22,476 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8254 secs
2025-03-09 06:54:22,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8383 secs
2025-03-09 06:54:22,478 [INFO]: {
2025-03-09 06:54:22,478 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:22,478 [INFO]: 	index_param: efSearch=339
2025-03-09 06:54:22,478 [INFO]: 	index_path: knn.index
2025-03-09 06:54:22,478 [INFO]: 	size in bytes: 529240810
2025-03-09 06:54:22,478 [INFO]: 	avg_search_speed_ms: 10.373065853877867
2025-03-09 06:54:22,478 [INFO]: 	99p_search_speed_ms: 15.744396517984569
2025-03-09 06:54:22,478 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:22,478 [INFO]: 	nb vectors: 2690
2025-03-09 06:54:22,478 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:22,478 [INFO]: 	compression ratio: 0.9993097848973513
2025-03-09 06:54:22,478 [INFO]: }
2025-03-09 06:54:22,478 [INFO]: 	>>> Finished "Creating the index" in 42.8420 secs
2025-03-09 06:54:22,478 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8722 secs
2025-03-09 06:54:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 79118 [episode count 8/20]
[retrieval_preprocessing] for episode 87440 [episode count 9/20], we have num_retrieval=np.int64(2690) num_query=np.int64(132)
2025-03-09 06:54:24,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:24,860 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:24
2025-03-09 06:54:24,860 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2246.55it/s]
2025-03-09 06:54:24,883 [INFO]: There are 2690 embeddings of dim 49152
2025-03-09 06:54:24,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 06:54:24,883 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:24
2025-03-09 06:54:24,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:24,883 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:54:24,883 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:24,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:24,883 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:24
2025-03-09 06:54:24,883 [INFO]: 555.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:24,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:54:24,883 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:24
2025-03-09 06:54:24,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:24,883 [INFO]: 	Creating the index 03/09/2025, 06:54:24
2025-03-09 06:54:24,883 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:24
2025-03-09 06:54:24,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:54:24,884 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:24
2025-03-09 06:54:24,884 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:54:24,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.80it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.87it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.46it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.80it/s] 82%|████████▏ | 9/11 [00:00<00:00, 14.33it/s]100%|██████████| 11/11 [00:02<00:00,  2.59it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]
2025-03-09 06:54:27,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:27
2025-03-09 06:54:52,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1119 secs
2025-03-09 06:54:52,648 [INFO]: The best hyperparameters are: efSearch=400
2025-03-09 06:54:52,648 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-09 06:55:05,323 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6744 secs
2025-03-09 06:55:05,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4401 secs
2025-03-09 06:55:05,325 [INFO]: {
2025-03-09 06:55:05,325 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:05,325 [INFO]: 	index_param: efSearch=400
2025-03-09 06:55:05,325 [INFO]: 	index_path: knn.index
2025-03-09 06:55:05,325 [INFO]: 	size in bytes: 529240810
2025-03-09 06:55:05,325 [INFO]: 	avg_search_speed_ms: 11.192781755115245
2025-03-09 06:55:05,325 [INFO]: 	99p_search_speed_ms: 14.700580595526835
2025-03-09 06:55:05,325 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:05,325 [INFO]: 	nb vectors: 2690
2025-03-09 06:55:05,325 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:05,325 [INFO]: 	compression ratio: 0.9993097848973513
2025-03-09 06:55:05,325 [INFO]: }
2025-03-09 06:55:05,325 [INFO]: 	>>> Finished "Creating the index" in 40.4413 secs
2025-03-09 06:55:05,325 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4651 secs
2025-03-09 06:55:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 87440 [episode count 9/20]
[retrieval_preprocessing] for episode 14226 [episode count 10/20], we have num_retrieval=np.int64(2687) num_query=np.int64(135)
2025-03-09 06:55:08,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:08,375 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:08
2025-03-09 06:55:08,375 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-09 06:55:08,400 [INFO]: There are 2687 embeddings of dim 49152
2025-03-09 06:55:08,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 06:55:08,401 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:08,401 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:55:08,401 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:08,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:08,401 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,401 [INFO]: 554.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:08,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:08,401 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:08
2025-03-09 06:55:08,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:08,401 [INFO]: 	Creating the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,401 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:08
2025-03-09 06:55:08,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:55:08,403 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,403 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:08,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.17it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.41it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.92it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.19it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.71it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.10it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.05it/s] 91%|█████████ | 10/11 [00:01<00:00, 11.31it/s]100%|██████████| 11/11 [00:02<00:00,  3.83it/s]
2025-03-09 06:55:11,280 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:11
2025-03-09 06:55:40,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5006 secs
2025-03-09 06:55:40,781 [INFO]: The best hyperparameters are: efSearch=313
2025-03-09 06:55:40,781 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
2025-03-09 06:55:54,687 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9059 secs
2025-03-09 06:55:54,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2868 secs
2025-03-09 06:55:54,690 [INFO]: {
2025-03-09 06:55:54,690 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:54,690 [INFO]: 	index_param: efSearch=313
2025-03-09 06:55:54,690 [INFO]: 	index_path: knn.index
2025-03-09 06:55:54,690 [INFO]: 	size in bytes: 528650590
2025-03-09 06:55:54,690 [INFO]: 	avg_search_speed_ms: 10.170581377995326
2025-03-09 06:55:54,690 [INFO]: 	99p_search_speed_ms: 14.588741087354718
2025-03-09 06:55:54,690 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:54,690 [INFO]: 	nb vectors: 2687
2025-03-09 06:55:54,690 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:54,690 [INFO]: 	compression ratio: 0.9993097633731951
2025-03-09 06:55:54,690 [INFO]: }
2025-03-09 06:55:54,690 [INFO]: 	>>> Finished "Creating the index" in 46.2884 secs
2025-03-09 06:55:54,690 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3149 secs
2025-03-09 06:55:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 14226 [episode count 10/20]
[retrieval_preprocessing] for episode 26644 [episode count 11/20], we have num_retrieval=np.int64(2657) num_query=np.int64(165)
2025-03-09 06:55:56,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:57,378 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:57
2025-03-09 06:55:57,378 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-09 06:55:57,403 [INFO]: There are 2657 embeddings of dim 49152
2025-03-09 06:55:57,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 06:55:57,403 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:57
2025-03-09 06:55:57,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:57,403 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:55:57,403 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:57,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:57,403 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:57
2025-03-09 06:55:57,403 [INFO]: 548.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:57,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:57,403 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:57
2025-03-09 06:55:57,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:57,403 [INFO]: 	Creating the index 03/09/2025, 06:55:57
2025-03-09 06:55:57,403 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:57
2025-03-09 06:55:57,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:55:57,404 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:57
2025-03-09 06:55:57,404 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:57,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.71it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.93it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.25it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.33it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.38it/s]100%|██████████| 11/11 [00:02<00:00,  2.93it/s]100%|██████████| 11/11 [00:02<00:00,  4.52it/s]
2025-03-09 06:55:59,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:59
2025-03-09 06:56:26,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3629 secs
2025-03-09 06:56:26,204 [INFO]: The best hyperparameters are: efSearch=314
2025-03-09 06:56:26,204 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.51it/s]
2025-03-09 06:56:38,532 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3281 secs
2025-03-09 06:56:38,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1296 secs
2025-03-09 06:56:38,534 [INFO]: {
2025-03-09 06:56:38,534 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:38,534 [INFO]: 	index_param: efSearch=314
2025-03-09 06:56:38,534 [INFO]: 	index_path: knn.index
2025-03-09 06:56:38,534 [INFO]: 	size in bytes: 522748390
2025-03-09 06:56:38,534 [INFO]: 	avg_search_speed_ms: 10.008428472320777
2025-03-09 06:56:38,534 [INFO]: 	99p_search_speed_ms: 19.091817894950506
2025-03-09 06:56:38,534 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:38,534 [INFO]: 	nb vectors: 2657
2025-03-09 06:56:38,534 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:38,534 [INFO]: 	compression ratio: 0.9993095454583801
2025-03-09 06:56:38,534 [INFO]: }
2025-03-09 06:56:38,534 [INFO]: 	>>> Finished "Creating the index" in 41.1308 secs
2025-03-09 06:56:38,534 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1565 secs
2025-03-09 06:56:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 26644 [episode count 11/20]
[retrieval_preprocessing] for episode 65172 [episode count 12/20], we have num_retrieval=np.int64(2654) num_query=np.int64(168)
2025-03-09 06:56:41,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:42,011 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:42
2025-03-09 06:56:42,011 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.09it/s]
2025-03-09 06:56:42,035 [INFO]: There are 2654 embeddings of dim 49152
2025-03-09 06:56:42,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 06:56:42,035 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:42
2025-03-09 06:56:42,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:42,035 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:56:42,035 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:42,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:42,035 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:42
2025-03-09 06:56:42,035 [INFO]: 547.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:42,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:42,036 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:42
2025-03-09 06:56:42,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:42,036 [INFO]: 	Creating the index 03/09/2025, 06:56:42
2025-03-09 06:56:42,036 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:42
2025-03-09 06:56:42,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:56:42,037 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:42
2025-03-09 06:56:42,037 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:56:42,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.06it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.46it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.41it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.88it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.36it/s]100%|██████████| 11/11 [00:02<00:00,  2.35it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-09 06:56:44,995 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:44
2025-03-09 06:57:13,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0074 secs
2025-03-09 06:57:13,003 [INFO]: The best hyperparameters are: efSearch=304
2025-03-09 06:57:13,003 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-09 06:57:25,669 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6661 secs
2025-03-09 06:57:25,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6340 secs
2025-03-09 06:57:25,671 [INFO]: {
2025-03-09 06:57:25,671 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:25,671 [INFO]: 	index_param: efSearch=304
2025-03-09 06:57:25,671 [INFO]: 	index_path: knn.index
2025-03-09 06:57:25,671 [INFO]: 	size in bytes: 522158170
2025-03-09 06:57:25,671 [INFO]: 	avg_search_speed_ms: 9.34254604193489
2025-03-09 06:57:25,671 [INFO]: 	99p_search_speed_ms: 13.0110774654895
2025-03-09 06:57:25,671 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:25,671 [INFO]: 	nb vectors: 2654
2025-03-09 06:57:25,671 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:25,671 [INFO]: 	compression ratio: 0.9993095233959473
2025-03-09 06:57:25,671 [INFO]: }
2025-03-09 06:57:25,671 [INFO]: 	>>> Finished "Creating the index" in 43.6355 secs
2025-03-09 06:57:25,671 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6603 secs
2025-03-09 06:57:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 65172 [episode count 12/20]
[retrieval_preprocessing] for episode 76182 [episode count 13/20], we have num_retrieval=np.int64(2703) num_query=np.int64(119)
2025-03-09 06:57:27,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:28,035 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:28
2025-03-09 06:57:28,035 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2187.95it/s]
2025-03-09 06:57:28,059 [INFO]: There are 2703 embeddings of dim 49152
2025-03-09 06:57:28,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 06:57:28,059 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:28
2025-03-09 06:57:28,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:28,059 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:57:28,059 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:28,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:57:28,059 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:28
2025-03-09 06:57:28,060 [INFO]: 557.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:28,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:28,060 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:28
2025-03-09 06:57:28,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:28,060 [INFO]: 	Creating the index 03/09/2025, 06:57:28
2025-03-09 06:57:28,060 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:28
2025-03-09 06:57:28,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:57:28,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:28
2025-03-09 06:57:28,061 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:57:28,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.55it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.10it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.80it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.79it/s] 82%|████████▏ | 9/11 [00:00<00:00, 14.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]
2025-03-09 06:57:30,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:30
2025-03-09 06:57:57,131 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4245 secs
2025-03-09 06:57:57,132 [INFO]: The best hyperparameters are: efSearch=346
2025-03-09 06:57:57,132 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s]
2025-03-09 06:58:09,960 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8279 secs
2025-03-09 06:58:09,962 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9006 secs
2025-03-09 06:58:09,962 [INFO]: {
2025-03-09 06:58:09,962 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:09,962 [INFO]: 	index_param: efSearch=346
2025-03-09 06:58:09,962 [INFO]: 	index_path: knn.index
2025-03-09 06:58:09,962 [INFO]: 	size in bytes: 531798550
2025-03-09 06:58:09,962 [INFO]: 	avg_search_speed_ms: 11.48790082611982
2025-03-09 06:58:09,962 [INFO]: 	99p_search_speed_ms: 15.763355209492145
2025-03-09 06:58:09,962 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:09,962 [INFO]: 	nb vectors: 2703
2025-03-09 06:58:09,962 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:09,962 [INFO]: 	compression ratio: 0.9993096521229703
2025-03-09 06:58:09,962 [INFO]: }
2025-03-09 06:58:09,962 [INFO]: 	>>> Finished "Creating the index" in 41.9020 secs
2025-03-09 06:58:09,962 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9271 secs
2025-03-09 06:58:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 76182 [episode count 13/20]
[retrieval_preprocessing] for episode 56730 [episode count 14/20], we have num_retrieval=np.int64(2704) num_query=np.int64(118)
2025-03-09 06:58:12,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:12,813 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:12
2025-03-09 06:58:12,813 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1825.99it/s]
2025-03-09 06:58:12,843 [INFO]: There are 2704 embeddings of dim 49152
2025-03-09 06:58:12,843 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 06:58:12,843 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,843 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:12,843 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:58:12,843 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:12,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:58:12,844 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,844 [INFO]: 558.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:12,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:58:12,844 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:12
2025-03-09 06:58:12,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:12,844 [INFO]: 	Creating the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,845 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:12
2025-03-09 06:58:12,847 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:58:12,848 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:12
2025-03-09 06:58:12,848 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:12,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.04it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.96it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.17it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.54it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.22it/s]100%|██████████| 11/11 [00:02<00:00,  2.72it/s]100%|██████████| 11/11 [00:02<00:00,  4.29it/s]
2025-03-09 06:58:15,418 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:15
2025-03-09 06:58:43,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7794 secs
2025-03-09 06:58:43,198 [INFO]: The best hyperparameters are: efSearch=336
2025-03-09 06:58:43,199 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s]
2025-03-09 06:58:55,371 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1727 secs
2025-03-09 06:58:55,373 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5255 secs
2025-03-09 06:58:55,373 [INFO]: {
2025-03-09 06:58:55,373 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:55,373 [INFO]: 	index_param: efSearch=336
2025-03-09 06:58:55,373 [INFO]: 	index_path: knn.index
2025-03-09 06:58:55,373 [INFO]: 	size in bytes: 531995290
2025-03-09 06:58:55,373 [INFO]: 	avg_search_speed_ms: 10.413452461943962
2025-03-09 06:58:55,373 [INFO]: 	99p_search_speed_ms: 15.036019121762358
2025-03-09 06:58:55,373 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:55,373 [INFO]: 	nb vectors: 2704
2025-03-09 06:58:55,373 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:55,373 [INFO]: 	compression ratio: 0.9993096593016829
2025-03-09 06:58:55,373 [INFO]: }
2025-03-09 06:58:55,373 [INFO]: 	>>> Finished "Creating the index" in 42.5290 secs
2025-03-09 06:58:55,373 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5600 secs
2025-03-09 06:58:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 56730 [episode count 14/20]
[retrieval_preprocessing] for episode 25499 [episode count 15/20], we have num_retrieval=np.int64(2685) num_query=np.int64(137)
2025-03-09 06:58:57,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:57,566 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:57
2025-03-09 06:58:57,566 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2037.06it/s]
2025-03-09 06:58:57,595 [INFO]: There are 2685 embeddings of dim 49152
2025-03-09 06:58:57,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 06:58:57,595 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:57
2025-03-09 06:58:57,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:57,596 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:58:57,596 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:57,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:57,596 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:57
2025-03-09 06:58:57,596 [INFO]: 554.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:57,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:58:57,596 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:57
2025-03-09 06:58:57,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:57,596 [INFO]: 	Creating the index 03/09/2025, 06:58:57
2025-03-09 06:58:57,596 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:57
2025-03-09 06:58:57,597 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:58:57,597 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:57
2025-03-09 06:58:57,597 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:57,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.60it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.95it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.65it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.06it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.10it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.07it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.18it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.56it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.56it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.58it/s]100%|██████████| 11/11 [00:03<00:00,  1.43it/s]100%|██████████| 11/11 [00:03<00:00,  3.39it/s]
2025-03-09 06:59:00,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:00
2025-03-09 06:59:26,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7999 secs
2025-03-09 06:59:26,649 [INFO]: The best hyperparameters are: efSearch=349
2025-03-09 06:59:26,649 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-09 06:59:40,025 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3763 secs
2025-03-09 06:59:40,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4308 secs
2025-03-09 06:59:40,028 [INFO]: {
2025-03-09 06:59:40,028 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:40,028 [INFO]: 	index_param: efSearch=349
2025-03-09 06:59:40,028 [INFO]: 	index_path: knn.index
2025-03-09 06:59:40,028 [INFO]: 	size in bytes: 528257110
2025-03-09 06:59:40,028 [INFO]: 	avg_search_speed_ms: 11.34027756276475
2025-03-09 06:59:40,028 [INFO]: 	99p_search_speed_ms: 17.525678353849795
2025-03-09 06:59:40,028 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:40,028 [INFO]: 	nb vectors: 2685
2025-03-09 06:59:40,028 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:40,028 [INFO]: 	compression ratio: 0.9993097489970367
2025-03-09 06:59:40,028 [INFO]: }
2025-03-09 06:59:40,028 [INFO]: 	>>> Finished "Creating the index" in 42.4324 secs
2025-03-09 06:59:40,028 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4620 secs
2025-03-09 06:59:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 25499 [episode count 15/20]
[retrieval_preprocessing] for episode 34339 [episode count 16/20], we have num_retrieval=np.int64(2691) num_query=np.int64(131)
2025-03-09 06:59:43,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:43,630 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:43
2025-03-09 06:59:43,630 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-09 06:59:43,660 [INFO]: There are 2691 embeddings of dim 49152
2025-03-09 06:59:43,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 06:59:43,661 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:43
2025-03-09 06:59:43,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:43,661 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:59:43,661 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:43,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:59:43,661 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:43
2025-03-09 06:59:43,661 [INFO]: 555.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:43,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:59:43,662 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:43
2025-03-09 06:59:43,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:43,662 [INFO]: 	Creating the index 03/09/2025, 06:59:43
2025-03-09 06:59:43,662 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:43
2025-03-09 06:59:43,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:59:43,665 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:43
2025-03-09 06:59:43,666 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:59:43,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.70it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.13it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.78it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.22it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.39it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.48it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.53it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.57it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.12it/s]100%|██████████| 11/11 [00:03<00:00,  1.71it/s]100%|██████████| 11/11 [00:03<00:00,  3.50it/s]
2025-03-09 06:59:46,816 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:46
2025-03-09 07:00:17,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8838 secs
2025-03-09 07:00:17,701 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 07:00:17,701 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s]
2025-03-09 07:00:30,355 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6539 secs
2025-03-09 07:00:30,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6910 secs
2025-03-09 07:00:30,357 [INFO]: {
2025-03-09 07:00:30,357 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:30,357 [INFO]: 	index_param: efSearch=295
2025-03-09 07:00:30,357 [INFO]: 	index_path: knn.index
2025-03-09 07:00:30,357 [INFO]: 	size in bytes: 529437550
2025-03-09 07:00:30,357 [INFO]: 	avg_search_speed_ms: 10.921850588018131
2025-03-09 07:00:30,357 [INFO]: 	99p_search_speed_ms: 15.37083355942741
2025-03-09 07:00:30,357 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:30,357 [INFO]: 	nb vectors: 2691
2025-03-09 07:00:30,357 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:30,357 [INFO]: 	compression ratio: 0.9993097920614056
2025-03-09 07:00:30,357 [INFO]: }
2025-03-09 07:00:30,357 [INFO]: 	>>> Finished "Creating the index" in 46.6946 secs
2025-03-09 07:00:30,357 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7263 secs
2025-03-09 07:00:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 34339 [episode count 16/20]
[retrieval_preprocessing] for episode 86313 [episode count 17/20], we have num_retrieval=np.int64(2696) num_query=np.int64(126)
2025-03-09 07:00:32,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:33,239 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:33
2025-03-09 07:00:33,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.11it/s]
2025-03-09 07:00:33,262 [INFO]: There are 2696 embeddings of dim 49152
2025-03-09 07:00:33,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 07:00:33,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:33
2025-03-09 07:00:33,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:33,262 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:00:33,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:33,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:33,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:33
2025-03-09 07:00:33,262 [INFO]: 556.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:33,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:00:33,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:33
2025-03-09 07:00:33,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:33,263 [INFO]: 	Creating the index 03/09/2025, 07:00:33
2025-03-09 07:00:33,263 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:33
2025-03-09 07:00:33,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:00:33,264 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:33
2025-03-09 07:00:33,264 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:00:33,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.58it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.34it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.57it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.22it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.44it/s]100%|██████████| 11/11 [00:02<00:00,  2.72it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]
2025-03-09 07:00:35,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:35
2025-03-09 07:01:05,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8854 secs
2025-03-09 07:01:05,773 [INFO]: The best hyperparameters are: efSearch=300
2025-03-09 07:01:05,773 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-09 07:01:19,465 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6915 secs
2025-03-09 07:01:19,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2028 secs
2025-03-09 07:01:19,467 [INFO]: {
2025-03-09 07:01:19,467 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:19,467 [INFO]: 	index_param: efSearch=300
2025-03-09 07:01:19,467 [INFO]: 	index_path: knn.index
2025-03-09 07:01:19,467 [INFO]: 	size in bytes: 530421250
2025-03-09 07:01:19,467 [INFO]: 	avg_search_speed_ms: 10.181180612836602
2025-03-09 07:01:19,467 [INFO]: 	99p_search_speed_ms: 14.919411956798285
2025-03-09 07:01:19,467 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:19,467 [INFO]: 	nb vectors: 2696
2025-03-09 07:01:19,467 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:19,467 [INFO]: 	compression ratio: 0.9993098278019593
2025-03-09 07:01:19,467 [INFO]: }
2025-03-09 07:01:19,467 [INFO]: 	>>> Finished "Creating the index" in 46.2044 secs
2025-03-09 07:01:19,467 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2281 secs
2025-03-09 07:01:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 86313 [episode count 17/20]
[retrieval_preprocessing] for episode 35500 [episode count 18/20], we have num_retrieval=np.int64(2679) num_query=np.int64(143)
2025-03-09 07:01:21,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:21,759 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:21
2025-03-09 07:01:21,759 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1309.08it/s]
2025-03-09 07:01:21,785 [INFO]: There are 2679 embeddings of dim 49152
2025-03-09 07:01:21,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:01:21,785 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:21,786 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:01:21,786 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:21,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:21,786 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,786 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:21,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:01:21,786 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:21
2025-03-09 07:01:21,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:21,786 [INFO]: 	Creating the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,786 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:21
2025-03-09 07:01:21,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:01:21,787 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,787 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:01:21,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.19it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.26it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.37it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.66it/s]100%|██████████| 11/11 [00:02<00:00,  2.31it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
2025-03-09 07:01:24,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:24
2025-03-09 07:01:52,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6189 secs
2025-03-09 07:01:52,350 [INFO]: The best hyperparameters are: efSearch=331
2025-03-09 07:01:52,350 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-09 07:02:06,095 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7450 secs
2025-03-09 07:02:06,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3102 secs
2025-03-09 07:02:06,097 [INFO]: {
2025-03-09 07:02:06,097 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:06,097 [INFO]: 	index_param: efSearch=331
2025-03-09 07:02:06,098 [INFO]: 	index_path: knn.index
2025-03-09 07:02:06,098 [INFO]: 	size in bytes: 527076670
2025-03-09 07:02:06,098 [INFO]: 	avg_search_speed_ms: 11.016118769956515
2025-03-09 07:02:06,098 [INFO]: 	99p_search_speed_ms: 17.07195771858094
2025-03-09 07:02:06,098 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:06,098 [INFO]: 	nb vectors: 2679
2025-03-09 07:02:06,098 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:06,098 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-09 07:02:06,098 [INFO]: }
2025-03-09 07:02:06,098 [INFO]: 	>>> Finished "Creating the index" in 44.3118 secs
2025-03-09 07:02:06,098 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3382 secs
2025-03-09 07:02:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 35500 [episode count 18/20]
[retrieval_preprocessing] for episode 39599 [episode count 19/20], we have num_retrieval=np.int64(2640) num_query=np.int64(182)
2025-03-09 07:02:09,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:09,537 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:09
2025-03-09 07:02:09,537 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-09 07:02:09,574 [INFO]: There are 2640 embeddings of dim 49152
2025-03-09 07:02:09,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-09 07:02:09,575 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:09
2025-03-09 07:02:09,575 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:09,575 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:02:09,575 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:09,575 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:02:09,575 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:09
2025-03-09 07:02:09,575 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:09,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:02:09,576 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:09
2025-03-09 07:02:09,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:09,576 [INFO]: 	Creating the index 03/09/2025, 07:02:09
2025-03-09 07:02:09,576 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:09
2025-03-09 07:02:09,579 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:02:09,580 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:09
2025-03-09 07:02:09,580 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:02:09,580 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.58it/s] 18%|█▊        | 2/11 [00:00<00:01,  8.17it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.00it/s] 45%|████▌     | 5/11 [00:00<00:00,  6.53it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.69it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.32it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.75it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.43it/s] 91%|█████████ | 10/11 [00:01<00:00,  6.49it/s]100%|██████████| 11/11 [00:03<00:00,  1.42it/s]100%|██████████| 11/11 [00:03<00:00,  3.22it/s]
2025-03-09 07:02:13,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:13
2025-03-09 07:02:40,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9689 secs
2025-03-09 07:02:40,973 [INFO]: The best hyperparameters are: efSearch=326
2025-03-09 07:02:40,973 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-09 07:02:54,209 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2360 secs
2025-03-09 07:02:54,211 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6314 secs
2025-03-09 07:02:54,211 [INFO]: {
2025-03-09 07:02:54,211 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:54,211 [INFO]: 	index_param: efSearch=326
2025-03-09 07:02:54,211 [INFO]: 	index_path: knn.index
2025-03-09 07:02:54,211 [INFO]: 	size in bytes: 519403810
2025-03-09 07:02:54,211 [INFO]: 	avg_search_speed_ms: 10.027002546246889
2025-03-09 07:02:54,211 [INFO]: 	99p_search_speed_ms: 13.501873761415478
2025-03-09 07:02:54,211 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:54,211 [INFO]: 	nb vectors: 2640
2025-03-09 07:02:54,211 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:54,211 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-09 07:02:54,211 [INFO]: }
2025-03-09 07:02:54,211 [INFO]: 	>>> Finished "Creating the index" in 44.6352 secs
2025-03-09 07:02:54,211 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6740 secs
2025-03-09 07:02:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 39599 [episode count 19/20]
2025-03-09 07:02:55: [retrieval_preprocessing] finished for (8911427557, 'bottle') [chosen_id count 0/10]
2025-03-09 07:02:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1058976383, 'drawer') [chosen_id count 1/10]
2025-03-09 07:02:59: [retrieval_preprocessing] we have num_total=5278 embedding_dim=49152
[retrieval_preprocessing] for episode 2055 [episode count 0/20], we have num_retrieval=np.int64(5015) num_query=np.int64(263)
2025-03-09 07:03:00,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:01,485 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:01
2025-03-09 07:03:01,485 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.76it/s]
2025-03-09 07:03:01,513 [INFO]: There are 5015 embeddings of dim 49152
2025-03-09 07:03:01,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:03:01,513 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:01
2025-03-09 07:03:01,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:01,514 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:03:01,514 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:01,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:03:01,514 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:01
2025-03-09 07:03:01,514 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:01,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:03:01,514 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:01
2025-03-09 07:03:01,515 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:01,515 [INFO]: 	Creating the index 03/09/2025, 07:03:01
2025-03-09 07:03:01,515 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:01
2025-03-09 07:03:01,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:03:01,518 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:01
2025-03-09 07:03:01,518 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:03:01,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.84it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.72it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.86it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.37it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.61it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.78it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.87it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.84it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.02it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.16it/s]100%|██████████| 20/20 [00:05<00:00,  3.87it/s]
2025-03-09 07:03:06,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:06
2025-03-09 07:03:51,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0950 secs
2025-03-09 07:03:51,793 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 07:03:51,793 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.20s/it] 50%|█████     | 2/4 [00:02<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.59s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.80s/it]
2025-03-09 07:04:10,547 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7540 secs
2025-03-09 07:04:10,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0329 secs
2025-03-09 07:04:10,551 [INFO]: {
2025-03-09 07:04:10,551 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:10,551 [INFO]: 	index_param: efSearch=200
2025-03-09 07:04:10,551 [INFO]: 	index_path: knn.index
2025-03-09 07:04:10,551 [INFO]: 	size in bytes: 986671330
2025-03-09 07:04:10,551 [INFO]: 	avg_search_speed_ms: 9.399850561530364
2025-03-09 07:04:10,551 [INFO]: 	99p_search_speed_ms: 14.071027734316878
2025-03-09 07:04:10,551 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:10,551 [INFO]: 	nb vectors: 5015
2025-03-09 07:04:10,551 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:10,551 [INFO]: 	compression ratio: 0.9993085742138671
2025-03-09 07:04:10,551 [INFO]: }
2025-03-09 07:04:10,552 [INFO]: 	>>> Finished "Creating the index" in 69.0367 secs
2025-03-09 07:04:10,552 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0665 secs
2025-03-09 07:04:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 2055 [episode count 0/20]
[retrieval_preprocessing] for episode 48651 [episode count 1/20], we have num_retrieval=np.int64(5092) num_query=np.int64(186)
2025-03-09 07:04:14,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:14,780 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:14
2025-03-09 07:04:14,780 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.40it/s]
2025-03-09 07:04:14,806 [INFO]: There are 5092 embeddings of dim 49152
2025-03-09 07:04:14,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:04:14,806 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:14
2025-03-09 07:04:14,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:14,806 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:04:14,806 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:14,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:14,806 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:14
2025-03-09 07:04:14,807 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:14,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:04:14,807 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:14
2025-03-09 07:04:14,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:14,807 [INFO]: 	Creating the index 03/09/2025, 07:04:14
2025-03-09 07:04:14,807 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:14
2025-03-09 07:04:14,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:14,808 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:14
2025-03-09 07:04:14,808 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:04:14,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.12it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.17it/s] 23%|██▎       | 5/22 [00:00<00:01, 12.18it/s] 32%|███▏      | 7/22 [00:00<00:01, 13.21it/s] 41%|████      | 9/22 [00:00<00:00, 13.24it/s] 50%|█████     | 11/22 [00:00<00:00, 12.36it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.90it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.74it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.64it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.59it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.74it/s]100%|██████████| 22/22 [00:05<00:00,  1.71it/s]100%|██████████| 22/22 [00:05<00:00,  3.92it/s]
2025-03-09 07:04:20,423 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:20
2025-03-09 07:05:00,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8448 secs
2025-03-09 07:05:00,268 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:05:00,268 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.44it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-09 07:05:14,393 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1250 secs
2025-03-09 07:05:14,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5853 secs
2025-03-09 07:05:14,393 [INFO]: {
2025-03-09 07:05:14,393 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:14,394 [INFO]: 	index_param: efSearch=225
2025-03-09 07:05:14,394 [INFO]: 	index_path: knn.index
2025-03-09 07:05:14,394 [INFO]: 	size in bytes: 1001820670
2025-03-09 07:05:14,394 [INFO]: 	avg_search_speed_ms: 10.50401760848286
2025-03-09 07:05:14,394 [INFO]: 	99p_search_speed_ms: 19.736300020013005
2025-03-09 07:05:14,394 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:14,394 [INFO]: 	nb vectors: 5092
2025-03-09 07:05:14,394 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:14,394 [INFO]: 	compression ratio: 0.9993085249478831
2025-03-09 07:05:14,394 [INFO]: }
2025-03-09 07:05:14,394 [INFO]: 	>>> Finished "Creating the index" in 59.5866 secs
2025-03-09 07:05:14,394 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6134 secs
2025-03-09 07:05:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 48651 [episode count 1/20]
[retrieval_preprocessing] for episode 57357 [episode count 2/20], we have num_retrieval=np.int64(4909) num_query=np.int64(369)
2025-03-09 07:05:17,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:17,932 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:17
2025-03-09 07:05:17,932 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-09 07:05:17,957 [INFO]: There are 4909 embeddings of dim 49152
2025-03-09 07:05:17,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:05:17,957 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:17
2025-03-09 07:05:17,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:17,957 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:05:17,957 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:17,957 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:05:17,957 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:17
2025-03-09 07:05:17,957 [INFO]: 1013.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:17,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:17,958 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:17
2025-03-09 07:05:17,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:17,958 [INFO]: 	Creating the index 03/09/2025, 07:05:17
2025-03-09 07:05:17,958 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:17
2025-03-09 07:05:17,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:05:17,959 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:17
2025-03-09 07:05:17,959 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:05:17,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.05it/s] 10%|█         | 2/20 [00:00<00:02,  6.85it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.72it/s] 20%|██        | 4/20 [00:00<00:01,  8.23it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.67it/s] 30%|███       | 6/20 [00:00<00:01,  8.81it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.90it/s] 40%|████      | 8/20 [00:00<00:01,  8.98it/s] 50%|█████     | 10/20 [00:01<00:01,  9.74it/s] 60%|██████    | 12/20 [00:01<00:00,  9.99it/s] 70%|███████   | 14/20 [00:01<00:00, 10.15it/s] 80%|████████  | 16/20 [00:01<00:00, 10.34it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.23it/s]100%|██████████| 20/20 [00:05<00:00,  1.69it/s]100%|██████████| 20/20 [00:05<00:00,  3.85it/s]
2025-03-09 07:05:23,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:23
2025-03-09 07:06:07,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1396 secs
2025-03-09 07:06:07,300 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 07:06:07,300 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-09 07:06:30,404 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1034 secs
2025-03-09 07:06:30,407 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4481 secs
2025-03-09 07:06:30,407 [INFO]: {
2025-03-09 07:06:30,407 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:30,407 [INFO]: 	index_param: efSearch=209
2025-03-09 07:06:30,407 [INFO]: 	index_path: knn.index
2025-03-09 07:06:30,407 [INFO]: 	size in bytes: 965816290
2025-03-09 07:06:30,407 [INFO]: 	avg_search_speed_ms: 8.792578536573153
2025-03-09 07:06:30,407 [INFO]: 	99p_search_speed_ms: 14.695015223696828
2025-03-09 07:06:30,407 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:30,407 [INFO]: 	nb vectors: 4909
2025-03-09 07:06:30,407 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:30,407 [INFO]: 	compression ratio: 0.9993087525993168
2025-03-09 07:06:30,407 [INFO]: }
2025-03-09 07:06:30,407 [INFO]: 	>>> Finished "Creating the index" in 72.4494 secs
2025-03-09 07:06:30,407 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4747 secs
2025-03-09 07:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 57357 [episode count 2/20]
[retrieval_preprocessing] for episode 15889 [episode count 3/20], we have num_retrieval=np.int64(4244) num_query=np.int64(1034)
2025-03-09 07:06:35,733 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:36,615 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:36
2025-03-09 07:06:36,615 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2457.12it/s]
2025-03-09 07:06:36,637 [INFO]: There are 4244 embeddings of dim 49152
2025-03-09 07:06:36,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 07:06:36,637 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:36
2025-03-09 07:06:36,638 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:36,638 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:06:36,638 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:36,638 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:36,638 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:36
2025-03-09 07:06:36,638 [INFO]: 875.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:36,638 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:06:36,638 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:36
2025-03-09 07:06:36,638 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:36,638 [INFO]: 	Creating the index 03/09/2025, 07:06:36
2025-03-09 07:06:36,638 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:36
2025-03-09 07:06:36,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:06:36,640 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:36
2025-03-09 07:06:36,640 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:06:36,640 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.58it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.81it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.30it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.66it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.69it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.55it/s] 41%|████      | 7/17 [00:00<00:01,  7.44it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.05it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.23it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.91it/s] 65%|██████▍   | 11/17 [00:01<00:00,  7.72it/s] 71%|███████   | 12/17 [00:01<00:00,  7.57it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.44it/s] 82%|████████▏ | 14/17 [00:01<00:00,  7.34it/s] 88%|████████▊ | 15/17 [00:01<00:00,  7.37it/s] 94%|█████████▍| 16/17 [00:02<00:00,  7.31it/s]100%|██████████| 17/17 [00:05<00:00,  1.07s/it]100%|██████████| 17/17 [00:05<00:00,  3.16it/s]
2025-03-09 07:06:42,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:42
2025-03-09 07:07:31,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5344 secs
2025-03-09 07:07:31,563 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 07:07:31,563 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.23it/s] 50%|█████     | 2/4 [00:00<00:00,  2.51it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.30it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.62it/s]
2025-03-09 07:07:47,504 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9409 secs
2025-03-09 07:07:47,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8684 secs
2025-03-09 07:07:47,508 [INFO]: {
2025-03-09 07:07:47,508 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:47,508 [INFO]: 	index_param: efSearch=276
2025-03-09 07:07:47,508 [INFO]: 	index_path: knn.index
2025-03-09 07:07:47,508 [INFO]: 	size in bytes: 834981610
2025-03-09 07:07:47,508 [INFO]: 	avg_search_speed_ms: 12.968682625495052
2025-03-09 07:07:47,508 [INFO]: 	99p_search_speed_ms: 25.174657558090985
2025-03-09 07:07:47,508 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:47,508 [INFO]: 	nb vectors: 4244
2025-03-09 07:07:47,508 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:47,508 [INFO]: 	compression ratio: 0.9993086578278053
2025-03-09 07:07:47,509 [INFO]: }
2025-03-09 07:07:47,509 [INFO]: 	>>> Finished "Creating the index" in 70.8705 secs
2025-03-09 07:07:47,509 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8938 secs
2025-03-09 07:07:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 15889 [episode count 3/20]
[retrieval_preprocessing] for episode 48147 [episode count 4/20], we have num_retrieval=np.int64(5161) num_query=np.int64(117)
2025-03-09 07:07:59,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:59,963 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:59
2025-03-09 07:07:59,963 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.64it/s]
2025-03-09 07:07:59,989 [INFO]: There are 5161 embeddings of dim 49152
2025-03-09 07:07:59,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:07:59,990 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:59
2025-03-09 07:07:59,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:59,990 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:07:59,990 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:59,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:59,990 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:59
2025-03-09 07:07:59,990 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:59,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:07:59,990 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:59
2025-03-09 07:07:59,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:59,990 [INFO]: 	Creating the index 03/09/2025, 07:07:59
2025-03-09 07:07:59,990 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:59
2025-03-09 07:07:59,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:07:59,991 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:59
2025-03-09 07:07:59,991 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:07:59,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.74it/s]  9%|▉         | 2/22 [00:00<00:03,  6.37it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.19it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.66it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.97it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.04it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.24it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.30it/s] 41%|████      | 9/22 [00:01<00:01,  8.32it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.36it/s] 50%|█████     | 11/22 [00:01<00:01,  8.40it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.52it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.50it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.41it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.28it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.20it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.15it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.98it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.07it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.09s/it]100%|██████████| 22/22 [00:07<00:00,  1.22s/it]100%|██████████| 22/22 [00:07<00:00,  2.80it/s]
2025-03-09 07:08:07,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:07
2025-03-09 07:08:51,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5073 secs
2025-03-09 07:08:51,346 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 07:08:51,346 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-09 07:09:06,037 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6906 secs
2025-03-09 07:09:06,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0458 secs
2025-03-09 07:09:06,037 [INFO]: {
2025-03-09 07:09:06,037 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:06,037 [INFO]: 	index_param: efSearch=160
2025-03-09 07:09:06,037 [INFO]: 	index_path: knn.index
2025-03-09 07:09:06,037 [INFO]: 	size in bytes: 1015396030
2025-03-09 07:09:06,037 [INFO]: 	avg_search_speed_ms: 8.5007533473422
2025-03-09 07:09:06,037 [INFO]: 	99p_search_speed_ms: 12.892648635897785
2025-03-09 07:09:06,037 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:06,037 [INFO]: 	nb vectors: 5161
2025-03-09 07:09:06,037 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:06,037 [INFO]: 	compression ratio: 0.9993085042887158
2025-03-09 07:09:06,037 [INFO]: }
2025-03-09 07:09:06,037 [INFO]: 	>>> Finished "Creating the index" in 66.0472 secs
2025-03-09 07:09:06,037 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0745 secs
2025-03-09 07:09:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 48147 [episode count 4/20]
[retrieval_preprocessing] for episode 57366 [episode count 5/20], we have num_retrieval=np.int64(4992) num_query=np.int64(286)
2025-03-09 07:09:12,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:13,485 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:13
2025-03-09 07:09:13,485 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-09 07:09:13,513 [INFO]: There are 4992 embeddings of dim 49152
2025-03-09 07:09:13,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:09:13,514 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:13
2025-03-09 07:09:13,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:13,514 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:09:13,514 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:13,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:09:13,514 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:13
2025-03-09 07:09:13,514 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:13,515 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:09:13,515 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:13
2025-03-09 07:09:13,515 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:13,515 [INFO]: 	Creating the index 03/09/2025, 07:09:13
2025-03-09 07:09:13,515 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:13
2025-03-09 07:09:13,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:09:13,519 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:13
2025-03-09 07:09:13,519 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:09:13,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  2.87it/s] 10%|█         | 2/20 [00:00<00:08,  2.04it/s] 15%|█▌        | 3/20 [00:01<00:09,  1.75it/s] 20%|██        | 4/20 [00:01<00:07,  2.14it/s] 25%|██▌       | 5/20 [00:02<00:07,  1.90it/s] 30%|███       | 6/20 [00:04<00:16,  1.18s/it] 35%|███▌      | 7/20 [00:06<00:15,  1.21s/it] 40%|████      | 8/20 [00:06<00:10,  1.14it/s] 50%|█████     | 10/20 [00:06<00:05,  1.82it/s] 55%|█████▌    | 11/20 [00:07<00:04,  1.91it/s] 60%|██████    | 12/20 [00:07<00:04,  1.92it/s] 70%|███████   | 14/20 [00:07<00:01,  3.08it/s] 75%|███████▌  | 15/20 [00:08<00:01,  3.16it/s] 80%|████████  | 16/20 [00:08<00:01,  2.98it/s] 85%|████████▌ | 17/20 [00:08<00:00,  3.55it/s] 95%|█████████▌| 19/20 [00:08<00:00,  4.96it/s]100%|██████████| 20/20 [00:12<00:00,  1.01it/s]100%|██████████| 20/20 [00:12<00:00,  1.60it/s]
2025-03-09 07:09:26,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:26
2025-03-09 07:10:05,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1919 secs
2025-03-09 07:10:05,193 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 07:10:05,193 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 07:10:20,987 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7937 secs
2025-03-09 07:10:20,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4717 secs
2025-03-09 07:10:20,991 [INFO]: {
2025-03-09 07:10:20,991 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:20,991 [INFO]: 	index_param: efSearch=184
2025-03-09 07:10:20,991 [INFO]: 	index_path: knn.index
2025-03-09 07:10:20,991 [INFO]: 	size in bytes: 982146250
2025-03-09 07:10:20,991 [INFO]: 	avg_search_speed_ms: 10.973441657588769
2025-03-09 07:10:20,991 [INFO]: 	99p_search_speed_ms: 23.812299384735507
2025-03-09 07:10:20,991 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:20,991 [INFO]: 	nb vectors: 4992
2025-03-09 07:10:20,991 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:20,991 [INFO]: 	compression ratio: 0.9993085408614043
2025-03-09 07:10:20,991 [INFO]: }
2025-03-09 07:10:20,991 [INFO]: 	>>> Finished "Creating the index" in 67.4754 secs
2025-03-09 07:10:20,991 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5056 secs
2025-03-09 07:10:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 57366 [episode count 5/20]
[retrieval_preprocessing] for episode 58392 [episode count 6/20], we have num_retrieval=np.int64(5141) num_query=np.int64(137)
2025-03-09 07:10:24,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:25,671 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:25
2025-03-09 07:10:25,671 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-09 07:10:25,696 [INFO]: There are 5141 embeddings of dim 49152
2025-03-09 07:10:25,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 07:10:25,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:25
2025-03-09 07:10:25,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:25,696 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:10:25,696 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:25,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:25,696 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:25
2025-03-09 07:10:25,696 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:25,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:10:25,696 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:25
2025-03-09 07:10:25,696 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:25,696 [INFO]: 	Creating the index 03/09/2025, 07:10:25
2025-03-09 07:10:25,696 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:25
2025-03-09 07:10:25,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:10:25,697 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:25
2025-03-09 07:10:25,697 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:10:25,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.74it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.21it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.68it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.35it/s] 41%|████      | 9/22 [00:00<00:00, 13.83it/s] 50%|█████     | 11/22 [00:00<00:00, 13.16it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.71it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.42it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.20it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.03it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.50it/s]100%|██████████| 22/22 [00:06<00:00,  1.25it/s]100%|██████████| 22/22 [00:06<00:00,  3.15it/s]
2025-03-09 07:10:32,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:32
2025-03-09 07:11:16,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5903 secs
2025-03-09 07:11:16,271 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 07:11:16,271 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 07:11:31,732 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4605 secs
2025-03-09 07:11:31,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0345 secs
2025-03-09 07:11:31,732 [INFO]: {
2025-03-09 07:11:31,732 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:31,732 [INFO]: 	index_param: efSearch=222
2025-03-09 07:11:31,732 [INFO]: 	index_path: knn.index
2025-03-09 07:11:31,732 [INFO]: 	size in bytes: 1011461170
2025-03-09 07:11:31,732 [INFO]: 	avg_search_speed_ms: 11.754852318786059
2025-03-09 07:11:31,732 [INFO]: 	99p_search_speed_ms: 18.473633099347353
2025-03-09 07:11:31,732 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:31,732 [INFO]: 	nb vectors: 5141
2025-03-09 07:11:31,732 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:31,732 [INFO]: 	compression ratio: 0.9993084835871653
2025-03-09 07:11:31,732 [INFO]: }
2025-03-09 07:11:31,732 [INFO]: 	>>> Finished "Creating the index" in 66.0360 secs
2025-03-09 07:11:31,732 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0611 secs
2025-03-09 07:11:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 58392 [episode count 6/20]
[retrieval_preprocessing] for episode 83483 [episode count 7/20], we have num_retrieval=np.int64(5159) num_query=np.int64(119)
2025-03-09 07:11:34,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:35,449 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:35
2025-03-09 07:11:35,449 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2280.75it/s]
2025-03-09 07:11:35,472 [INFO]: There are 5159 embeddings of dim 49152
2025-03-09 07:11:35,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 07:11:35,473 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:35
2025-03-09 07:11:35,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:35,473 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:11:35,473 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:35,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:11:35,473 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:35
2025-03-09 07:11:35,473 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:35,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:35,473 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:35
2025-03-09 07:11:35,473 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:35,473 [INFO]: 	Creating the index 03/09/2025, 07:11:35
2025-03-09 07:11:35,473 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:35
2025-03-09 07:11:35,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:11:35,474 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:35
2025-03-09 07:11:35,474 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:11:35,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.80it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.46it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.92it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.59it/s] 41%|████      | 9/22 [00:00<00:01, 10.99it/s] 50%|█████     | 11/22 [00:01<00:00, 11.60it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.67it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.23it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.04it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.07it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.45it/s]100%|██████████| 22/22 [00:06<00:00,  1.30it/s]100%|██████████| 22/22 [00:06<00:00,  3.18it/s]
2025-03-09 07:11:42,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:42
2025-03-09 07:12:28,992 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5913 secs
2025-03-09 07:12:28,993 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:12:28,993 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 07:12:44,100 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1072 secs
2025-03-09 07:12:44,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6264 secs
2025-03-09 07:12:44,101 [INFO]: {
2025-03-09 07:12:44,101 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:44,101 [INFO]: 	index_param: efSearch=224
2025-03-09 07:12:44,101 [INFO]: 	index_path: knn.index
2025-03-09 07:12:44,101 [INFO]: 	size in bytes: 1015002550
2025-03-09 07:12:44,101 [INFO]: 	avg_search_speed_ms: 10.39999575845959
2025-03-09 07:12:44,101 [INFO]: 	99p_search_speed_ms: 16.006691167131066
2025-03-09 07:12:44,101 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:44,101 [INFO]: 	nb vectors: 5159
2025-03-09 07:12:44,101 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:44,101 [INFO]: 	compression ratio: 0.999308496318556
2025-03-09 07:12:44,101 [INFO]: }
2025-03-09 07:12:44,101 [INFO]: 	>>> Finished "Creating the index" in 68.6277 secs
2025-03-09 07:12:44,101 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6514 secs
2025-03-09 07:12:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 83483 [episode count 7/20]
[retrieval_preprocessing] for episode 78365 [episode count 8/20], we have num_retrieval=np.int64(5125) num_query=np.int64(153)
2025-03-09 07:12:46,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:47,640 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:47
2025-03-09 07:12:47,640 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-09 07:12:47,668 [INFO]: There are 5125 embeddings of dim 49152
2025-03-09 07:12:47,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:12:47,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:47
2025-03-09 07:12:47,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:47,669 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:12:47,669 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:47,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:47,669 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:47
2025-03-09 07:12:47,669 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:47,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:12:47,669 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:47
2025-03-09 07:12:47,669 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:47,669 [INFO]: 	Creating the index 03/09/2025, 07:12:47
2025-03-09 07:12:47,669 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:47
2025-03-09 07:12:47,670 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:12:47,670 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:47
2025-03-09 07:12:47,670 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:12:47,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.10it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.75it/s] 27%|██▋       | 6/22 [00:00<00:01, 12.94it/s] 36%|███▋      | 8/22 [00:00<00:01, 12.57it/s] 45%|████▌     | 10/22 [00:00<00:00, 12.26it/s] 55%|█████▍    | 12/22 [00:01<00:00, 12.15it/s] 64%|██████▎   | 14/22 [00:01<00:00, 12.00it/s] 73%|███████▎  | 16/22 [00:01<00:00, 11.86it/s] 82%|████████▏ | 18/22 [00:01<00:00, 12.24it/s] 91%|█████████ | 20/22 [00:01<00:00, 12.68it/s]100%|██████████| 22/22 [00:06<00:00,  1.24it/s]100%|██████████| 22/22 [00:06<00:00,  3.34it/s]
2025-03-09 07:12:54,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:54
2025-03-09 07:13:33,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4227 secs
2025-03-09 07:13:33,680 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 07:13:33,680 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-09 07:13:47,114 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4340 secs
2025-03-09 07:13:47,114 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4443 secs
2025-03-09 07:13:47,114 [INFO]: {
2025-03-09 07:13:47,114 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:47,114 [INFO]: 	index_param: efSearch=221
2025-03-09 07:13:47,114 [INFO]: 	index_path: knn.index
2025-03-09 07:13:47,114 [INFO]: 	size in bytes: 1008313330
2025-03-09 07:13:47,114 [INFO]: 	avg_search_speed_ms: 9.983128045003363
2025-03-09 07:13:47,114 [INFO]: 	99p_search_speed_ms: 14.263570667244494
2025-03-09 07:13:47,114 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:47,114 [INFO]: 	nb vectors: 5125
2025-03-09 07:13:47,114 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:47,114 [INFO]: 	compression ratio: 0.9993084193382626
2025-03-09 07:13:47,114 [INFO]: }
2025-03-09 07:13:47,114 [INFO]: 	>>> Finished "Creating the index" in 59.4456 secs
2025-03-09 07:13:47,114 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4744 secs
2025-03-09 07:13:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 78365 [episode count 8/20]
[retrieval_preprocessing] for episode 94237 [episode count 9/20], we have num_retrieval=np.int64(5031) num_query=np.int64(247)
2025-03-09 07:13:49,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:50,424 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:50
2025-03-09 07:13:50,425 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-09 07:13:50,449 [INFO]: There are 5031 embeddings of dim 49152
2025-03-09 07:13:50,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:13:50,449 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:50
2025-03-09 07:13:50,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:50,449 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:13:50,449 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:50,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:50,449 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:50
2025-03-09 07:13:50,449 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:50,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:50,449 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:50
2025-03-09 07:13:50,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:50,449 [INFO]: 	Creating the index 03/09/2025, 07:13:50
2025-03-09 07:13:50,449 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:50
2025-03-09 07:13:50,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:13:50,450 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:50
2025-03-09 07:13:50,451 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:13:50,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.78it/s] 10%|█         | 2/20 [00:00<00:02,  6.43it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.32it/s] 20%|██        | 4/20 [00:00<00:02,  7.74it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.08it/s] 30%|███       | 6/20 [00:00<00:01,  8.24it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.34it/s] 40%|████      | 8/20 [00:01<00:01,  8.37it/s] 50%|█████     | 10/20 [00:01<00:01,  9.86it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.80it/s] 60%|██████    | 12/20 [00:01<00:00,  9.37it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.09it/s] 70%|███████   | 14/20 [00:01<00:00,  8.90it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.59it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.34it/s]100%|██████████| 20/20 [00:05<00:00,  3.57it/s]
2025-03-09 07:13:56,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:56
2025-03-09 07:14:36,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3595 secs
2025-03-09 07:14:36,426 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:14:36,426 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.26it/s]
2025-03-09 07:14:49,692 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2663 secs
2025-03-09 07:14:49,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2446 secs
2025-03-09 07:14:49,695 [INFO]: {
2025-03-09 07:14:49,695 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:49,695 [INFO]: 	index_param: efSearch=248
2025-03-09 07:14:49,695 [INFO]: 	index_path: knn.index
2025-03-09 07:14:49,695 [INFO]: 	size in bytes: 989819290
2025-03-09 07:14:49,695 [INFO]: 	avg_search_speed_ms: 11.352909825082602
2025-03-09 07:14:49,695 [INFO]: 	99p_search_speed_ms: 16.20593569241465
2025-03-09 07:14:49,695 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:49,695 [INFO]: 	nb vectors: 5031
2025-03-09 07:14:49,695 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:49,695 [INFO]: 	compression ratio: 0.9993085182245741
2025-03-09 07:14:49,695 [INFO]: }
2025-03-09 07:14:49,695 [INFO]: 	>>> Finished "Creating the index" in 59.2460 secs
2025-03-09 07:14:49,695 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2709 secs
2025-03-09 07:14:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 94237 [episode count 9/20]
[retrieval_preprocessing] for episode 32298 [episode count 10/20], we have num_retrieval=np.int64(4832) num_query=np.int64(446)
2025-03-09 07:14:54,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:55,118 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:55
2025-03-09 07:14:55,118 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.41it/s]
2025-03-09 07:14:55,145 [INFO]: There are 4832 embeddings of dim 49152
2025-03-09 07:14:55,146 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 07:14:55,146 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:55
2025-03-09 07:14:55,146 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:55,146 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:14:55,146 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:55,146 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:14:55,146 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:55
2025-03-09 07:14:55,147 [INFO]: 997.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:55,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 07:14:55,147 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:55
2025-03-09 07:14:55,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:55,147 [INFO]: 	Creating the index 03/09/2025, 07:14:55
2025-03-09 07:14:55,148 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:55
2025-03-09 07:14:55,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:14:55,151 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:55
2025-03-09 07:14:55,151 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:14:55,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.63it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.24it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.82it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.52it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.25it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.81it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.21it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.43it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.33it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.80it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-09 07:15:00,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:00
2025-03-09 07:15:43,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0795 secs
2025-03-09 07:15:43,475 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 07:15:43,475 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 07:15:58,061 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5861 secs
2025-03-09 07:15:58,064 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9130 secs
2025-03-09 07:15:58,064 [INFO]: {
2025-03-09 07:15:58,064 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:58,064 [INFO]: 	index_param: efSearch=173
2025-03-09 07:15:58,064 [INFO]: 	index_path: knn.index
2025-03-09 07:15:58,064 [INFO]: 	size in bytes: 950667130
2025-03-09 07:15:58,064 [INFO]: 	avg_search_speed_ms: 9.508139314616857
2025-03-09 07:15:58,064 [INFO]: 	99p_search_speed_ms: 15.886272985953838
2025-03-09 07:15:58,064 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:58,064 [INFO]: 	nb vectors: 4832
2025-03-09 07:15:58,064 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:58,064 [INFO]: 	compression ratio: 0.9993086181490255
2025-03-09 07:15:58,064 [INFO]: }
2025-03-09 07:15:58,064 [INFO]: 	>>> Finished "Creating the index" in 62.9167 secs
2025-03-09 07:15:58,064 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9463 secs
2025-03-09 07:15:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 32298 [episode count 10/20]
[retrieval_preprocessing] for episode 87083 [episode count 11/20], we have num_retrieval=np.int64(5129) num_query=np.int64(149)
2025-03-09 07:16:02,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:03,784 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:03
2025-03-09 07:16:03,784 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1884.23it/s]
2025-03-09 07:16:03,811 [INFO]: There are 5129 embeddings of dim 49152
2025-03-09 07:16:03,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:16:03,811 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:03
2025-03-09 07:16:03,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:03,811 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:16:03,811 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:03,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:03,811 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:03
2025-03-09 07:16:03,811 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:03,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:16:03,811 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:03
2025-03-09 07:16:03,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:03,811 [INFO]: 	Creating the index 03/09/2025, 07:16:03
2025-03-09 07:16:03,811 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:03
2025-03-09 07:16:03,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:03,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:03
2025-03-09 07:16:03,812 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:16:03,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.61it/s]  9%|▉         | 2/22 [00:00<00:03,  6.23it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.06it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.60it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.88it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.02it/s] 36%|███▋      | 8/22 [00:00<00:01, 10.23it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.54it/s] 50%|█████     | 11/22 [00:01<00:01,  9.16it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.98it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.81it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.66it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.60it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.51it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.47it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.45it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.46it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.53it/s] 95%|█████████▌| 21/22 [00:05<00:01,  1.12s/it]100%|██████████| 22/22 [00:06<00:00,  1.01s/it]100%|██████████| 22/22 [00:06<00:00,  3.32it/s]
2025-03-09 07:16:10,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:10
2025-03-09 07:16:50,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8031 secs
2025-03-09 07:16:50,240 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:16:50,240 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-09 07:17:06,066 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8255 secs
2025-03-09 07:17:06,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2538 secs
2025-03-09 07:17:06,066 [INFO]: {
2025-03-09 07:17:06,066 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:06,066 [INFO]: 	index_param: efSearch=256
2025-03-09 07:17:06,066 [INFO]: 	index_path: knn.index
2025-03-09 07:17:06,066 [INFO]: 	size in bytes: 1009100290
2025-03-09 07:17:06,066 [INFO]: 	avg_search_speed_ms: 14.136611084430085
2025-03-09 07:17:06,066 [INFO]: 	99p_search_speed_ms: 26.777608999982466
2025-03-09 07:17:06,066 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:06,066 [INFO]: 	nb vectors: 5129
2025-03-09 07:17:06,066 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:06,066 [INFO]: 	compression ratio: 0.9993084354380674
2025-03-09 07:17:06,066 [INFO]: }
2025-03-09 07:17:06,066 [INFO]: 	>>> Finished "Creating the index" in 62.2551 secs
2025-03-09 07:17:06,066 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2828 secs
2025-03-09 07:17:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 87083 [episode count 11/20]
[retrieval_preprocessing] for episode 24626 [episode count 12/20], we have num_retrieval=np.int64(5147) num_query=np.int64(131)
2025-03-09 07:17:10,280 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:11,135 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:11
2025-03-09 07:17:11,135 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.40it/s]
2025-03-09 07:17:11,163 [INFO]: There are 5147 embeddings of dim 49152
2025-03-09 07:17:11,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:17:11,163 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:11
2025-03-09 07:17:11,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:11,163 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:17:11,163 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:11,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:11,164 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:11
2025-03-09 07:17:11,164 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:11,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:17:11,164 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:11
2025-03-09 07:17:11,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:11,164 [INFO]: 	Creating the index 03/09/2025, 07:17:11
2025-03-09 07:17:11,164 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:11
2025-03-09 07:17:11,165 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:17:11,165 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:11
2025-03-09 07:17:11,165 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:17:11,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.93it/s]  9%|▉         | 2/22 [00:00<00:03,  6.44it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.22it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.72it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.96it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.10it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.31it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.33it/s] 41%|████      | 9/22 [00:01<00:01,  8.34it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.35it/s] 50%|█████     | 11/22 [00:01<00:01,  8.33it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.43it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.43it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.45it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.55it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.44it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.55it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.48it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.42it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.39it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.17s/it]100%|██████████| 22/22 [00:07<00:00,  1.18s/it]100%|██████████| 22/22 [00:07<00:00,  3.03it/s]
2025-03-09 07:17:18,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:18
2025-03-09 07:18:02,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7902 secs
2025-03-09 07:18:02,229 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 07:18:02,229 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s]
2025-03-09 07:18:19,140 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9109 secs
2025-03-09 07:18:19,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9751 secs
2025-03-09 07:18:19,140 [INFO]: {
2025-03-09 07:18:19,140 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:19,140 [INFO]: 	index_param: efSearch=241
2025-03-09 07:18:19,140 [INFO]: 	index_path: knn.index
2025-03-09 07:18:19,140 [INFO]: 	size in bytes: 1012641610
2025-03-09 07:18:19,140 [INFO]: 	avg_search_speed_ms: 13.465600694287794
2025-03-09 07:18:19,140 [INFO]: 	99p_search_speed_ms: 27.496064361184896
2025-03-09 07:18:19,140 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:19,140 [INFO]: 	nb vectors: 5147
2025-03-09 07:18:19,140 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:19,140 [INFO]: 	compression ratio: 0.9993085075775229
2025-03-09 07:18:19,141 [INFO]: }
2025-03-09 07:18:19,141 [INFO]: 	>>> Finished "Creating the index" in 67.9767 secs
2025-03-09 07:18:19,141 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0052 secs
2025-03-09 07:18:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 24626 [episode count 12/20]
[retrieval_preprocessing] for episode 88117 [episode count 13/20], we have num_retrieval=np.int64(5141) num_query=np.int64(137)
2025-03-09 07:18:22,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:23,004 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:23
2025-03-09 07:18:23,004 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.05it/s]
2025-03-09 07:18:23,031 [INFO]: There are 5141 embeddings of dim 49152
2025-03-09 07:18:23,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 07:18:23,032 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:23
2025-03-09 07:18:23,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:23,032 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:18:23,032 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:23,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:23,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:23
2025-03-09 07:18:23,032 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:23,032 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:23,032 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:23
2025-03-09 07:18:23,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:23,032 [INFO]: 	Creating the index 03/09/2025, 07:18:23
2025-03-09 07:18:23,032 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:23
2025-03-09 07:18:23,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:18:23,033 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:23
2025-03-09 07:18:23,033 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:18:23,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.18it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.26it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.88it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.54it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.19it/s] 41%|████      | 9/22 [00:01<00:01,  8.92it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.79it/s] 50%|█████     | 11/22 [00:01<00:01,  8.54it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.37it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.03it/s] 73%|███████▎  | 16/22 [00:01<00:00, 10.53it/s] 82%|████████▏ | 18/22 [00:01<00:00, 11.82it/s] 91%|█████████ | 20/22 [00:01<00:00, 12.02it/s]100%|██████████| 22/22 [00:07<00:00,  1.13it/s]100%|██████████| 22/22 [00:07<00:00,  3.13it/s]
2025-03-09 07:18:30,073 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:30
2025-03-09 07:19:19,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8488 secs
2025-03-09 07:19:19,922 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:19:19,922 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-09 07:19:35,232 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3096 secs
2025-03-09 07:19:35,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1996 secs
2025-03-09 07:19:35,233 [INFO]: {
2025-03-09 07:19:35,233 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:35,233 [INFO]: 	index_param: efSearch=189
2025-03-09 07:19:35,233 [INFO]: 	index_path: knn.index
2025-03-09 07:19:35,233 [INFO]: 	size in bytes: 1011461170
2025-03-09 07:19:35,233 [INFO]: 	avg_search_speed_ms: 14.124913852777606
2025-03-09 07:19:35,233 [INFO]: 	99p_search_speed_ms: 24.244574508629725
2025-03-09 07:19:35,233 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:35,233 [INFO]: 	nb vectors: 5141
2025-03-09 07:19:35,233 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:35,233 [INFO]: 	compression ratio: 0.9993084835871653
2025-03-09 07:19:35,233 [INFO]: }
2025-03-09 07:19:35,233 [INFO]: 	>>> Finished "Creating the index" in 72.2010 secs
2025-03-09 07:19:35,233 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2288 secs
2025-03-09 07:19:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 88117 [episode count 13/20]
[retrieval_preprocessing] for episode 20541 [episode count 14/20], we have num_retrieval=np.int64(5093) num_query=np.int64(185)
2025-03-09 07:19:38,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:39,755 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:39
2025-03-09 07:19:39,755 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1870.79it/s]
2025-03-09 07:19:39,783 [INFO]: There are 5093 embeddings of dim 49152
2025-03-09 07:19:39,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:19:39,784 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:39
2025-03-09 07:19:39,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:39,785 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:19:39,785 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:39,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:19:39,785 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:39
2025-03-09 07:19:39,785 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:39,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:19:39,786 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:39
2025-03-09 07:19:39,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:39,786 [INFO]: 	Creating the index 03/09/2025, 07:19:39
2025-03-09 07:19:39,786 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:39
2025-03-09 07:19:39,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 07:19:39,789 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:39
2025-03-09 07:19:39,789 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:19:39,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:05,  4.19it/s]  9%|▉         | 2/22 [00:00<00:03,  5.77it/s] 14%|█▎        | 3/22 [00:00<00:02,  6.43it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.69it/s] 41%|████      | 9/22 [00:00<00:00, 16.62it/s] 55%|█████▍    | 12/22 [00:00<00:00, 20.14it/s] 73%|███████▎  | 16/22 [00:00<00:00, 24.57it/s] 91%|█████████ | 20/22 [00:01<00:00, 28.41it/s]100%|██████████| 22/22 [00:05<00:00,  3.79it/s]
2025-03-09 07:19:45,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:45
2025-03-09 07:20:27,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6231 secs
2025-03-09 07:20:27,225 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 07:20:27,225 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-09 07:20:42,884 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6587 secs
2025-03-09 07:20:42,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0958 secs
2025-03-09 07:20:42,885 [INFO]: {
2025-03-09 07:20:42,885 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:42,885 [INFO]: 	index_param: efSearch=246
2025-03-09 07:20:42,885 [INFO]: 	index_path: knn.index
2025-03-09 07:20:42,885 [INFO]: 	size in bytes: 1002017410
2025-03-09 07:20:42,885 [INFO]: 	avg_search_speed_ms: 13.701237405471709
2025-03-09 07:20:42,885 [INFO]: 	99p_search_speed_ms: 26.300040292553607
2025-03-09 07:20:42,885 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:42,885 [INFO]: 	nb vectors: 5093
2025-03-09 07:20:42,885 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:42,885 [INFO]: 	compression ratio: 0.9993085289805493
2025-03-09 07:20:42,885 [INFO]: }
2025-03-09 07:20:42,885 [INFO]: 	>>> Finished "Creating the index" in 63.0992 secs
2025-03-09 07:20:42,885 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1301 secs
2025-03-09 07:20:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20541 [episode count 14/20]
[retrieval_preprocessing] for episode 38461 [episode count 15/20], we have num_retrieval=np.int64(4916) num_query=np.int64(362)
2025-03-09 07:20:47,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:48,458 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:48
2025-03-09 07:20:48,458 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.38it/s]
2025-03-09 07:20:48,488 [INFO]: There are 4916 embeddings of dim 49152
2025-03-09 07:20:48,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 07:20:48,488 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:48
2025-03-09 07:20:48,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:48,488 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:20:48,488 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:48,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:48,488 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:48
2025-03-09 07:20:48,488 [INFO]: 1014.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:48,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:20:48,488 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:48
2025-03-09 07:20:48,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:48,488 [INFO]: 	Creating the index 03/09/2025, 07:20:48
2025-03-09 07:20:48,488 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:48
2025-03-09 07:20:48,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:20:48,490 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:48
2025-03-09 07:20:48,490 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:20:48,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.11it/s] 10%|█         | 2/20 [00:00<00:02,  6.92it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.95it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.50it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.50it/s] 40%|████      | 8/20 [00:00<00:01,  9.34it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.15it/s] 50%|█████     | 10/20 [00:01<00:01,  9.04it/s] 60%|██████    | 12/20 [00:01<00:00,  9.87it/s] 70%|███████   | 14/20 [00:01<00:00, 10.65it/s] 80%|████████  | 16/20 [00:01<00:00, 11.28it/s] 90%|█████████ | 18/20 [00:01<00:00, 11.55it/s]100%|██████████| 20/20 [00:05<00:00,  1.59it/s]100%|██████████| 20/20 [00:05<00:00,  3.75it/s]
2025-03-09 07:20:53,825 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:53
2025-03-09 07:21:33,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3312 secs
2025-03-09 07:21:33,157 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 07:21:33,157 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-09 07:21:46,778 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6217 secs
2025-03-09 07:21:46,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2930 secs
2025-03-09 07:21:46,783 [INFO]: {
2025-03-09 07:21:46,783 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:46,783 [INFO]: 	index_param: efSearch=196
2025-03-09 07:21:46,783 [INFO]: 	index_path: knn.index
2025-03-09 07:21:46,783 [INFO]: 	size in bytes: 967193470
2025-03-09 07:21:46,783 [INFO]: 	avg_search_speed_ms: 10.452216521757991
2025-03-09 07:21:46,783 [INFO]: 	99p_search_speed_ms: 18.320688484236594
2025-03-09 07:21:46,783 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:46,783 [INFO]: 	nb vectors: 4916
2025-03-09 07:21:46,783 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:46,783 [INFO]: 	compression ratio: 0.9993087815202061
2025-03-09 07:21:46,783 [INFO]: }
2025-03-09 07:21:46,783 [INFO]: 	>>> Finished "Creating the index" in 58.2946 secs
2025-03-09 07:21:46,783 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3248 secs
2025-03-09 07:21:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 38461 [episode count 15/20]
[retrieval_preprocessing] for episode 83007 [episode count 16/20], we have num_retrieval=np.int64(5119) num_query=np.int64(159)
2025-03-09 07:21:51,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:51,962 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:51
2025-03-09 07:21:51,962 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.44it/s]
2025-03-09 07:21:51,985 [INFO]: There are 5119 embeddings of dim 49152
2025-03-09 07:21:51,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 07:21:51,986 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:51
2025-03-09 07:21:51,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:51,986 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:21:51,986 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:51,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:51,986 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:51
2025-03-09 07:21:51,986 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:51,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:51,986 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:51
2025-03-09 07:21:51,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:51,986 [INFO]: 	Creating the index 03/09/2025, 07:21:51
2025-03-09 07:21:51,986 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:51
2025-03-09 07:21:51,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:21:51,987 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:51
2025-03-09 07:21:51,987 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:21:51,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.69it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.50it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.05it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.83it/s] 41%|████      | 9/22 [00:00<00:01, 12.51it/s] 50%|█████     | 11/22 [00:01<00:01, 10.82it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.08it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.63it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.46it/s] 86%|████████▋ | 19/22 [00:01<00:00,  9.67it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.53it/s]100%|██████████| 22/22 [00:06<00:00,  1.46it/s]100%|██████████| 22/22 [00:06<00:00,  3.37it/s]
2025-03-09 07:21:58,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:58
2025-03-09 07:22:39,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7692 secs
2025-03-09 07:22:39,295 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 07:22:39,295 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 07:22:53,432 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1371 secs
2025-03-09 07:22:53,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4452 secs
2025-03-09 07:22:53,432 [INFO]: {
2025-03-09 07:22:53,432 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:53,432 [INFO]: 	index_param: efSearch=181
2025-03-09 07:22:53,433 [INFO]: 	index_path: knn.index
2025-03-09 07:22:53,433 [INFO]: 	size in bytes: 1007132830
2025-03-09 07:22:53,433 [INFO]: 	avg_search_speed_ms: 8.651231437523537
2025-03-09 07:22:53,433 [INFO]: 	99p_search_speed_ms: 12.500577303580942
2025-03-09 07:22:53,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:53,433 [INFO]: 	nb vectors: 5119
2025-03-09 07:22:53,433 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:53,433 [INFO]: 	compression ratio: 0.9993084546752388
2025-03-09 07:22:53,433 [INFO]: }
2025-03-09 07:22:53,433 [INFO]: 	>>> Finished "Creating the index" in 61.4465 secs
2025-03-09 07:22:53,433 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4707 secs
2025-03-09 07:22:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 83007 [episode count 16/20]
[retrieval_preprocessing] for episode 86078 [episode count 17/20], we have num_retrieval=np.int64(4968) num_query=np.int64(310)
2025-03-09 07:22:56,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:57,122 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:57
2025-03-09 07:22:57,122 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1573.85it/s]
2025-03-09 07:22:57,146 [INFO]: There are 4968 embeddings of dim 49152
2025-03-09 07:22:57,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:22:57,147 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:57
2025-03-09 07:22:57,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:57,147 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:22:57,147 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:57,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:57,147 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:57
2025-03-09 07:22:57,147 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:57,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:22:57,147 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:57
2025-03-09 07:22:57,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:57,147 [INFO]: 	Creating the index 03/09/2025, 07:22:57
2025-03-09 07:22:57,147 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:57
2025-03-09 07:22:57,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:22:57,148 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:57
2025-03-09 07:22:57,148 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:22:57,148 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.37it/s] 20%|██        | 4/20 [00:00<00:01, 15.60it/s] 50%|█████     | 10/20 [00:00<00:00, 31.83it/s] 70%|███████   | 14/20 [00:00<00:00, 25.19it/s] 85%|████████▌ | 17/20 [00:00<00:00, 19.18it/s]100%|██████████| 20/20 [00:04<00:00,  2.58it/s]100%|██████████| 20/20 [00:04<00:00,  4.58it/s]
2025-03-09 07:23:01,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:01
2025-03-09 07:23:41,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0512 secs
2025-03-09 07:23:41,568 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:23:41,568 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-09 07:24:05,339 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7714 secs
2025-03-09 07:24:05,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1944 secs
2025-03-09 07:24:05,343 [INFO]: {
2025-03-09 07:24:05,343 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:05,343 [INFO]: 	index_param: efSearch=248
2025-03-09 07:24:05,343 [INFO]: 	index_path: knn.index
2025-03-09 07:24:05,343 [INFO]: 	size in bytes: 977424250
2025-03-09 07:24:05,343 [INFO]: 	avg_search_speed_ms: 12.472298875348898
2025-03-09 07:24:05,343 [INFO]: 	99p_search_speed_ms: 20.2365468046628
2025-03-09 07:24:05,343 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:05,343 [INFO]: 	nb vectors: 4968
2025-03-09 07:24:05,343 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:05,343 [INFO]: 	compression ratio: 0.9993086870926314
2025-03-09 07:24:05,343 [INFO]: }
2025-03-09 07:24:05,343 [INFO]: 	>>> Finished "Creating the index" in 68.1957 secs
2025-03-09 07:24:05,343 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2203 secs
2025-03-09 07:24:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 86078 [episode count 17/20]
[retrieval_preprocessing] for episode 34369 [episode count 18/20], we have num_retrieval=np.int64(5086) num_query=np.int64(192)
2025-03-09 07:24:09,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:10,559 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:10
2025-03-09 07:24:10,559 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2036.07it/s]
2025-03-09 07:24:10,590 [INFO]: There are 5086 embeddings of dim 49152
2025-03-09 07:24:10,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 07:24:10,591 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:10
2025-03-09 07:24:10,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:10,591 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:24:10,591 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:10,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:24:10,591 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:10
2025-03-09 07:24:10,592 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:10,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:24:10,592 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:10
2025-03-09 07:24:10,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:10,592 [INFO]: 	Creating the index 03/09/2025, 07:24:10
2025-03-09 07:24:10,592 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:10
2025-03-09 07:24:10,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:24:10,595 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:10
2025-03-09 07:24:10,596 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:24:10,596 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:00<00:03,  5.85it/s] 14%|█▍        | 3/21 [00:00<00:01, 10.84it/s] 29%|██▊       | 6/21 [00:00<00:01, 12.87it/s] 38%|███▊      | 8/21 [00:00<00:01, 12.17it/s] 48%|████▊     | 10/21 [00:00<00:01, 10.59it/s] 57%|█████▋    | 12/21 [00:01<00:00,  9.82it/s] 67%|██████▋   | 14/21 [00:01<00:00,  9.28it/s] 71%|███████▏  | 15/21 [00:01<00:00,  9.15it/s] 76%|███████▌  | 16/21 [00:01<00:00,  8.92it/s] 81%|████████  | 17/21 [00:01<00:00,  8.83it/s] 86%|████████▌ | 18/21 [00:01<00:00,  8.66it/s] 90%|█████████ | 19/21 [00:01<00:00,  8.54it/s]100%|██████████| 21/21 [00:06<00:00,  1.07it/s]100%|██████████| 21/21 [00:06<00:00,  3.47it/s]
2025-03-09 07:24:16,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:16
2025-03-09 07:24:56,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8370 secs
2025-03-09 07:24:56,487 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 07:24:56,487 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.20it/s] 50%|█████     | 2/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-09 07:25:10,712 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2254 secs
2025-03-09 07:25:10,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1207 secs
2025-03-09 07:25:10,716 [INFO]: {
2025-03-09 07:25:10,716 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:10,716 [INFO]: 	index_param: efSearch=231
2025-03-09 07:25:10,716 [INFO]: 	index_path: knn.index
2025-03-09 07:25:10,716 [INFO]: 	size in bytes: 1000640230
2025-03-09 07:25:10,716 [INFO]: 	avg_search_speed_ms: 12.023373468344708
2025-03-09 07:25:10,716 [INFO]: 	99p_search_speed_ms: 22.951579913496964
2025-03-09 07:25:10,717 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:10,717 [INFO]: 	nb vectors: 5086
2025-03-09 07:25:10,717 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:10,717 [INFO]: 	compression ratio: 0.9993085007185849
2025-03-09 07:25:10,717 [INFO]: }
2025-03-09 07:25:10,717 [INFO]: 	>>> Finished "Creating the index" in 60.1243 secs
2025-03-09 07:25:10,717 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1578 secs
2025-03-09 07:25:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 34369 [episode count 18/20]
[retrieval_preprocessing] for episode 56899 [episode count 19/20], we have num_retrieval=np.int64(4982) num_query=np.int64(296)
2025-03-09 07:25:14,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:15,274 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:15
2025-03-09 07:25:15,274 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.41it/s]
2025-03-09 07:25:15,300 [INFO]: There are 4982 embeddings of dim 49152
2025-03-09 07:25:15,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:25:15,300 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:15
2025-03-09 07:25:15,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:15,300 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:25:15,300 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:15,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:15,300 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:15
2025-03-09 07:25:15,300 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:15,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:15,300 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:15
2025-03-09 07:25:15,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:15,301 [INFO]: 	Creating the index 03/09/2025, 07:25:15
2025-03-09 07:25:15,301 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:15
2025-03-09 07:25:15,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:25:15,302 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:15
2025-03-09 07:25:15,302 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:25:15,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.54it/s] 20%|██        | 4/20 [00:00<00:01, 15.73it/s] 30%|███       | 6/20 [00:00<00:00, 16.92it/s] 40%|████      | 8/20 [00:00<00:00, 17.85it/s] 50%|█████     | 10/20 [00:00<00:00, 17.56it/s] 60%|██████    | 12/20 [00:00<00:00, 16.25it/s] 70%|███████   | 14/20 [00:00<00:00, 14.92it/s] 80%|████████  | 16/20 [00:01<00:00, 13.99it/s] 90%|█████████ | 18/20 [00:01<00:00, 13.99it/s]100%|██████████| 20/20 [00:05<00:00,  1.50it/s]100%|██████████| 20/20 [00:05<00:00,  3.83it/s]
2025-03-09 07:25:20,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:20
2025-03-09 07:25:59,134 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6048 secs
2025-03-09 07:25:59,134 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 07:25:59,134 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-09 07:26:12,921 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7875 secs
2025-03-09 07:26:12,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6235 secs
2025-03-09 07:26:12,925 [INFO]: {
2025-03-09 07:26:12,925 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:12,925 [INFO]: 	index_param: efSearch=229
2025-03-09 07:26:12,925 [INFO]: 	index_path: knn.index
2025-03-09 07:26:12,925 [INFO]: 	size in bytes: 980178670
2025-03-09 07:26:12,925 [INFO]: 	avg_search_speed_ms: 11.169081692319846
2025-03-09 07:26:12,925 [INFO]: 	99p_search_speed_ms: 17.384801793377843
2025-03-09 07:26:12,925 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:12,925 [INFO]: 	nb vectors: 4982
2025-03-09 07:26:12,925 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:12,926 [INFO]: 	compression ratio: 0.9993086831812
2025-03-09 07:26:12,926 [INFO]: }
2025-03-09 07:26:12,926 [INFO]: 	>>> Finished "Creating the index" in 57.6250 secs
2025-03-09 07:26:12,926 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6514 secs
2025-03-09 07:26:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 56899 [episode count 19/20]
2025-03-09 07:26:15: [retrieval_preprocessing] finished for (1058976383, 'drawer') [chosen_id count 1/10]
2025-03-09 07:26:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4045730075, 'lid') [chosen_id count 2/10]
2025-03-09 07:26:17: [retrieval_preprocessing] we have num_total=4472 embedding_dim=49152
[retrieval_preprocessing] for episode 46720 [episode count 0/20], we have num_retrieval=np.int64(4295) num_query=np.int64(177)
2025-03-09 07:26:18,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:19,507 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:19
2025-03-09 07:26:19,507 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2220.38it/s]
2025-03-09 07:26:19,537 [INFO]: There are 4295 embeddings of dim 49152
2025-03-09 07:26:19,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:26:19,537 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:19
2025-03-09 07:26:19,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:19,538 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:26:19,538 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:19,538 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:26:19,538 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:19
2025-03-09 07:26:19,538 [INFO]: 886.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:19,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:26:19,538 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:19
2025-03-09 07:26:19,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:19,539 [INFO]: 	Creating the index 03/09/2025, 07:26:19
2025-03-09 07:26:19,539 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:19
2025-03-09 07:26:19,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:26:19,542 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:19
2025-03-09 07:26:19,542 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:26:19,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.37it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.31it/s] 29%|██▉       | 5/17 [00:00<00:00, 12.39it/s] 41%|████      | 7/17 [00:00<00:00, 12.86it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.28it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.11it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.10it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.73it/s]100%|██████████| 17/17 [00:04<00:00,  1.89it/s]100%|██████████| 17/17 [00:04<00:00,  4.03it/s]
2025-03-09 07:26:23,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:23
2025-03-09 07:27:05,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2365 secs
2025-03-09 07:27:05,013 [INFO]: The best hyperparameters are: efSearch=312
2025-03-09 07:27:05,013 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.29it/s] 50%|█████     | 2/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.71it/s]
2025-03-09 07:27:23,400 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3867 secs
2025-03-09 07:27:23,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8610 secs
2025-03-09 07:27:23,403 [INFO]: {
2025-03-09 07:27:23,403 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:23,403 [INFO]: 	index_param: efSearch=312
2025-03-09 07:27:23,403 [INFO]: 	index_path: knn.index
2025-03-09 07:27:23,403 [INFO]: 	size in bytes: 845015590
2025-03-09 07:27:23,403 [INFO]: 	avg_search_speed_ms: 11.08491807043602
2025-03-09 07:27:23,403 [INFO]: 	99p_search_speed_ms: 16.352230915799737
2025-03-09 07:27:23,403 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:23,403 [INFO]: 	nb vectors: 4295
2025-03-09 07:27:23,403 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:23,403 [INFO]: 	compression ratio: 0.9993086163061204
2025-03-09 07:27:23,403 [INFO]: }
2025-03-09 07:27:23,403 [INFO]: 	>>> Finished "Creating the index" in 63.8646 secs
2025-03-09 07:27:23,403 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8960 secs
2025-03-09 07:27:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 46720 [episode count 0/20]
[retrieval_preprocessing] for episode 72706 [episode count 1/20], we have num_retrieval=np.int64(4289) num_query=np.int64(183)
2025-03-09 07:27:26,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:27,011 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:27
2025-03-09 07:27:27,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-09 07:27:27,036 [INFO]: There are 4289 embeddings of dim 49152
2025-03-09 07:27:27,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:27:27,036 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:27,036 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:27:27,036 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:27,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:27,036 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,036 [INFO]: 885.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:27,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:27,036 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:27
2025-03-09 07:27:27,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:27,036 [INFO]: 	Creating the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,037 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:27
2025-03-09 07:27:27,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:27:27,038 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,038 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:27:27,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.90it/s] 24%|██▎       | 4/17 [00:00<00:01, 12.91it/s] 35%|███▌      | 6/17 [00:00<00:00, 13.34it/s] 47%|████▋     | 8/17 [00:00<00:00, 12.72it/s] 59%|█████▉    | 10/17 [00:00<00:00, 12.29it/s] 71%|███████   | 12/17 [00:00<00:00, 12.83it/s] 82%|████████▏ | 14/17 [00:01<00:00, 14.05it/s] 94%|█████████▍| 16/17 [00:01<00:00, 14.94it/s]100%|██████████| 17/17 [00:04<00:00,  3.94it/s]
2025-03-09 07:27:31,361 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:31
2025-03-09 07:28:07,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5376 secs
2025-03-09 07:28:07,899 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 07:28:07,899 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 07:28:23,789 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8898 secs
2025-03-09 07:28:23,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7560 secs
2025-03-09 07:28:23,794 [INFO]: {
2025-03-09 07:28:23,794 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:23,794 [INFO]: 	index_param: efSearch=255
2025-03-09 07:28:23,794 [INFO]: 	index_path: knn.index
2025-03-09 07:28:23,794 [INFO]: 	size in bytes: 843835030
2025-03-09 07:28:23,794 [INFO]: 	avg_search_speed_ms: 9.564199613097406
2025-03-09 07:28:23,794 [INFO]: 	99p_search_speed_ms: 14.842965570278459
2025-03-09 07:28:23,794 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:23,794 [INFO]: 	nb vectors: 4289
2025-03-09 07:28:23,794 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:23,794 [INFO]: 	compression ratio: 0.9993087298117974
2025-03-09 07:28:23,794 [INFO]: }
2025-03-09 07:28:23,794 [INFO]: 	>>> Finished "Creating the index" in 56.7575 secs
2025-03-09 07:28:23,794 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7824 secs
2025-03-09 07:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 72706 [episode count 1/20]
[retrieval_preprocessing] for episode 7555 [episode count 2/20], we have num_retrieval=np.int64(4170) num_query=np.int64(302)
2025-03-09 07:28:26,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:27,563 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:27
2025-03-09 07:28:27,563 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.37it/s]
2025-03-09 07:28:27,592 [INFO]: There are 4170 embeddings of dim 49152
2025-03-09 07:28:27,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 07:28:27,592 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:27,592 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:28:27,592 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:27,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:28:27,592 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,593 [INFO]: 860.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:27,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:28:27,593 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:27
2025-03-09 07:28:27,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:27,593 [INFO]: 	Creating the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,593 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:27
2025-03-09 07:28:27,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:28:27,596 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,597 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:28:27,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.84it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.38it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.22it/s] 24%|██▎       | 4/17 [00:00<00:01,  6.75it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.29it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.65it/s] 41%|████      | 7/17 [00:00<00:01,  8.14it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.02it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.01it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.04it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.49it/s] 71%|███████   | 12/17 [00:01<00:00,  8.30it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.51it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.97it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.72it/s]100%|██████████| 17/17 [00:05<00:00,  1.00s/it]100%|██████████| 17/17 [00:05<00:00,  3.09it/s]
2025-03-09 07:28:33,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:33
2025-03-09 07:29:11,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4455 secs
2025-03-09 07:29:11,550 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 07:29:11,550 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-09 07:29:24,611 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0611 secs
2025-03-09 07:29:24,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0173 secs
2025-03-09 07:29:24,614 [INFO]: {
2025-03-09 07:29:24,614 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:24,614 [INFO]: 	index_param: efSearch=274
2025-03-09 07:29:24,614 [INFO]: 	index_path: knn.index
2025-03-09 07:29:24,614 [INFO]: 	size in bytes: 820422550
2025-03-09 07:29:24,614 [INFO]: 	avg_search_speed_ms: 9.59482574375121
2025-03-09 07:29:24,614 [INFO]: 	99p_search_speed_ms: 14.29769359529017
2025-03-09 07:29:24,614 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:24,614 [INFO]: 	nb vectors: 4170
2025-03-09 07:29:24,614 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:24,614 [INFO]: 	compression ratio: 0.9993086611283417
2025-03-09 07:29:24,614 [INFO]: }
2025-03-09 07:29:24,614 [INFO]: 	>>> Finished "Creating the index" in 57.0210 secs
2025-03-09 07:29:24,614 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0506 secs
2025-03-09 07:29:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 7555 [episode count 2/20]
[retrieval_preprocessing] for episode 20873 [episode count 3/20], we have num_retrieval=np.int64(4336) num_query=np.int64(136)
2025-03-09 07:29:28,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:29,587 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:29
2025-03-09 07:29:29,588 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2191.38it/s]
2025-03-09 07:29:29,614 [INFO]: There are 4336 embeddings of dim 49152
2025-03-09 07:29:29,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:29:29,614 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:29
2025-03-09 07:29:29,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:29,615 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:29:29,615 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:29,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:29:29,615 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:29
2025-03-09 07:29:29,615 [INFO]: 894.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:29,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:29:29,615 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:29
2025-03-09 07:29:29,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:29,616 [INFO]: 	Creating the index 03/09/2025, 07:29:29
2025-03-09 07:29:29,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:29
2025-03-09 07:29:29,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:29:29,619 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:29
2025-03-09 07:29:29,619 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:29:29,619 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.14it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.33it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.40it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.12it/s] 50%|█████     | 9/18 [00:00<00:00, 11.39it/s] 61%|██████    | 11/18 [00:01<00:00, 11.45it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.77it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.80it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.89it/s]100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
2025-03-09 07:29:33,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:33
2025-03-09 07:30:15,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1071 secs
2025-03-09 07:30:15,076 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:30:15,076 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.83s/it] 50%|█████     | 2/4 [00:02<00:01,  1.16it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.40it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.09it/s]
2025-03-09 07:30:37,325 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2497 secs
2025-03-09 07:30:37,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9082 secs
2025-03-09 07:30:37,527 [INFO]: {
2025-03-09 07:30:37,527 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:37,527 [INFO]: 	index_param: efSearch=250
2025-03-09 07:30:37,527 [INFO]: 	index_path: knn.index
2025-03-09 07:30:37,527 [INFO]: 	size in bytes: 853082110
2025-03-09 07:30:37,528 [INFO]: 	avg_search_speed_ms: 8.919370732537459
2025-03-09 07:30:37,528 [INFO]: 	99p_search_speed_ms: 13.545794340316204
2025-03-09 07:30:37,528 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:37,528 [INFO]: 	nb vectors: 4336
2025-03-09 07:30:37,528 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:37,528 [INFO]: 	compression ratio: 0.9993085987936143
2025-03-09 07:30:37,528 [INFO]: }
2025-03-09 07:30:37,528 [INFO]: 	>>> Finished "Creating the index" in 67.9123 secs
2025-03-09 07:30:37,528 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9403 secs
2025-03-09 07:30:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 20873 [episode count 3/20]
[retrieval_preprocessing] for episode 36234 [episode count 4/20], we have num_retrieval=np.int64(4278) num_query=np.int64(194)
2025-03-09 07:30:40,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:41,865 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:41
2025-03-09 07:30:41,866 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-09 07:30:41,900 [INFO]: There are 4278 embeddings of dim 49152
2025-03-09 07:30:41,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-09 07:30:41,900 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:41
2025-03-09 07:30:41,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:41,900 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:30:41,900 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:41,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:41,900 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:41
2025-03-09 07:30:41,900 [INFO]: 882.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:41,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:41,900 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:41
2025-03-09 07:30:41,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:41,901 [INFO]: 	Creating the index 03/09/2025, 07:30:41
2025-03-09 07:30:41,901 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:41
2025-03-09 07:30:41,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:30:41,901 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:41
2025-03-09 07:30:41,902 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:30:41,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.92it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.31it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.43it/s] 41%|████      | 7/17 [00:00<00:01,  9.73it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.03it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.25it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.20it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.11it/s]100%|██████████| 17/17 [00:04<00:00,  1.74it/s]100%|██████████| 17/17 [00:04<00:00,  3.57it/s]
2025-03-09 07:30:46,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:46
2025-03-09 07:31:40,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5537 secs
2025-03-09 07:31:40,226 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 07:31:40,226 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-09 07:31:57,722 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4965 secs
2025-03-09 07:31:57,725 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8239 secs
2025-03-09 07:31:57,726 [INFO]: {
2025-03-09 07:31:57,726 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:57,726 [INFO]: 	index_param: efSearch=234
2025-03-09 07:31:57,726 [INFO]: 	index_path: knn.index
2025-03-09 07:31:57,726 [INFO]: 	size in bytes: 841670830
2025-03-09 07:31:57,726 [INFO]: 	avg_search_speed_ms: 10.072885042249647
2025-03-09 07:31:57,726 [INFO]: 	99p_search_speed_ms: 19.94549055583779
2025-03-09 07:31:57,726 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:57,726 [INFO]: 	nb vectors: 4278
2025-03-09 07:31:57,726 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:57,726 [INFO]: 	compression ratio: 0.9993087487658329
2025-03-09 07:31:57,726 [INFO]: }
2025-03-09 07:31:57,726 [INFO]: 	>>> Finished "Creating the index" in 75.8252 secs
2025-03-09 07:31:57,726 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8603 secs
2025-03-09 07:31:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 36234 [episode count 4/20]
[retrieval_preprocessing] for episode 72210 [episode count 5/20], we have num_retrieval=np.int64(4288) num_query=np.int64(184)
2025-03-09 07:32:06,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:06,722 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:06
2025-03-09 07:32:06,722 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-09 07:32:06,749 [INFO]: There are 4288 embeddings of dim 49152
2025-03-09 07:32:06,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:32:06,749 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:06
2025-03-09 07:32:06,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:06,749 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:32:06,749 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:06,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:06,749 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:06
2025-03-09 07:32:06,749 [INFO]: 884.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:06,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:32:06,749 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:06
2025-03-09 07:32:06,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:06,749 [INFO]: 	Creating the index 03/09/2025, 07:32:06
2025-03-09 07:32:06,750 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:06
2025-03-09 07:32:06,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:32:06,751 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:06
2025-03-09 07:32:06,751 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:32:06,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.06it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.29it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.72it/s] 41%|████      | 7/17 [00:00<00:00, 12.85it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.94it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.96it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.50it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.10it/s]100%|██████████| 17/17 [00:04<00:00,  1.72it/s]100%|██████████| 17/17 [00:04<00:00,  3.69it/s]
2025-03-09 07:32:11,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:11
2025-03-09 07:32:55,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4658 secs
2025-03-09 07:32:55,830 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:32:55,830 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-09 07:33:08,975 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1448 secs
2025-03-09 07:33:08,978 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2272 secs
2025-03-09 07:33:08,978 [INFO]: {
2025-03-09 07:33:08,978 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:08,978 [INFO]: 	index_param: efSearch=248
2025-03-09 07:33:08,978 [INFO]: 	index_path: knn.index
2025-03-09 07:33:08,978 [INFO]: 	size in bytes: 843638290
2025-03-09 07:33:08,978 [INFO]: 	avg_search_speed_ms: 10.398191955567894
2025-03-09 07:33:08,978 [INFO]: 	99p_search_speed_ms: 17.014661091379818
2025-03-09 07:33:08,978 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:08,978 [INFO]: 	nb vectors: 4288
2025-03-09 07:33:08,978 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:08,978 [INFO]: 	compression ratio: 0.99930872506984
2025-03-09 07:33:08,978 [INFO]: }
2025-03-09 07:33:08,978 [INFO]: 	>>> Finished "Creating the index" in 62.2289 secs
2025-03-09 07:33:08,978 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2565 secs
2025-03-09 07:33:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 72210 [episode count 5/20]
[retrieval_preprocessing] for episode 3475 [episode count 6/20], we have num_retrieval=np.int64(4285) num_query=np.int64(187)
2025-03-09 07:33:18,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:19,212 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:19
2025-03-09 07:33:19,212 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 864.09it/s]
2025-03-09 07:33:19,242 [INFO]: There are 4285 embeddings of dim 49152
2025-03-09 07:33:19,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 07:33:19,243 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:19,243 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:33:19,243 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:19,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:33:19,244 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,244 [INFO]: 884.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:19,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:33:19,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:19
2025-03-09 07:33:19,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:19,244 [INFO]: 	Creating the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,245 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:19
2025-03-09 07:33:19,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:33:19,248 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,248 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:33:19,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.46it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.51it/s] 18%|█▊        | 3/17 [00:03<00:23,  1.68s/it] 24%|██▎       | 4/17 [00:06<00:25,  1.98s/it] 29%|██▉       | 5/17 [00:06<00:17,  1.49s/it] 35%|███▌      | 6/17 [00:07<00:12,  1.16s/it] 41%|████      | 7/17 [00:07<00:09,  1.10it/s] 47%|████▋     | 8/17 [00:08<00:06,  1.44it/s] 53%|█████▎    | 9/17 [00:08<00:04,  1.73it/s] 59%|█████▉    | 10/17 [00:10<00:07,  1.03s/it] 65%|██████▍   | 11/17 [00:11<00:06,  1.10s/it] 71%|███████   | 12/17 [00:12<00:05,  1.06s/it] 82%|████████▏ | 14/17 [00:12<00:01,  1.68it/s] 94%|█████████▍| 16/17 [00:12<00:00,  2.54it/s]100%|██████████| 17/17 [00:15<00:00,  1.07it/s]100%|██████████| 17/17 [00:15<00:00,  1.08it/s]
2025-03-09 07:33:35,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:35
2025-03-09 07:34:18,169 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1484 secs
2025-03-09 07:34:18,169 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 07:34:18,169 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-09 07:34:33,281 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1119 secs
2025-03-09 07:34:33,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0546 secs
2025-03-09 07:34:33,303 [INFO]: {
2025-03-09 07:34:33,303 [INFO]: 	index_key: HNSW15
2025-03-09 07:34:33,303 [INFO]: 	index_param: efSearch=260
2025-03-09 07:34:33,303 [INFO]: 	index_path: knn.index
2025-03-09 07:34:33,303 [INFO]: 	size in bytes: 843048070
2025-03-09 07:34:33,303 [INFO]: 	avg_search_speed_ms: 10.676846663560022
2025-03-09 07:34:33,303 [INFO]: 	99p_search_speed_ms: 17.784788450226188
2025-03-09 07:34:33,303 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:34:33,303 [INFO]: 	nb vectors: 4285
2025-03-09 07:34:33,303 [INFO]: 	vectors dimension: 49152
2025-03-09 07:34:33,303 [INFO]: 	compression ratio: 0.9993087108306885
2025-03-09 07:34:33,303 [INFO]: }
2025-03-09 07:34:33,303 [INFO]: 	>>> Finished "Creating the index" in 74.0585 secs
2025-03-09 07:34:33,303 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0914 secs
2025-03-09 07:34:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:34:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 3475 [episode count 6/20]
[retrieval_preprocessing] for episode 16148 [episode count 7/20], we have num_retrieval=np.int64(4216) num_query=np.int64(256)
2025-03-09 07:34:37,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:37,766 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:37
2025-03-09 07:34:37,766 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1872.46it/s]
2025-03-09 07:34:37,795 [INFO]: There are 4216 embeddings of dim 49152
2025-03-09 07:34:37,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 07:34:37,795 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:37
2025-03-09 07:34:37,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:37,795 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:34:37,795 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:37,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:34:37,795 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:37
2025-03-09 07:34:37,796 [INFO]: 870.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:37,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:34:37,796 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:37
2025-03-09 07:34:37,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:37,796 [INFO]: 	Creating the index 03/09/2025, 07:34:37
2025-03-09 07:34:37,796 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:37
2025-03-09 07:34:37,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:34:37,797 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:37
2025-03-09 07:34:37,797 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:34:37,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.63it/s] 24%|██▎       | 4/17 [00:00<00:00, 13.61it/s] 35%|███▌      | 6/17 [00:00<00:00, 14.43it/s] 47%|████▋     | 8/17 [00:00<00:00, 14.16it/s] 59%|█████▉    | 10/17 [00:00<00:00, 13.33it/s] 71%|███████   | 12/17 [00:00<00:00, 12.79it/s] 82%|████████▏ | 14/17 [00:01<00:00, 13.00it/s] 94%|█████████▍| 16/17 [00:01<00:00, 13.94it/s]100%|██████████| 17/17 [00:04<00:00,  3.87it/s]
2025-03-09 07:34:42,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:42
2025-03-09 07:35:25,131 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9382 secs
2025-03-09 07:35:25,131 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:35:25,131 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.03s/it] 50%|█████     | 2/4 [00:01<00:01,  1.17it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.90it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.51it/s]
2025-03-09 07:35:41,637 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5056 secs
2025-03-09 07:35:41,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8426 secs
2025-03-09 07:35:41,640 [INFO]: {
2025-03-09 07:35:41,640 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:41,640 [INFO]: 	index_param: efSearch=248
2025-03-09 07:35:41,640 [INFO]: 	index_path: knn.index
2025-03-09 07:35:41,640 [INFO]: 	size in bytes: 829472710
2025-03-09 07:35:41,640 [INFO]: 	avg_search_speed_ms: 9.773473951097065
2025-03-09 07:35:41,640 [INFO]: 	99p_search_speed_ms: 16.616033376194526
2025-03-09 07:35:41,640 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:41,640 [INFO]: 	nb vectors: 4216
2025-03-09 07:35:41,640 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:41,640 [INFO]: 	compression ratio: 0.9993087391627387
2025-03-09 07:35:41,640 [INFO]: }
2025-03-09 07:35:41,640 [INFO]: 	>>> Finished "Creating the index" in 63.8441 secs
2025-03-09 07:35:41,640 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8735 secs
2025-03-09 07:35:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 16148 [episode count 7/20]
[retrieval_preprocessing] for episode 14103 [episode count 8/20], we have num_retrieval=np.int64(4188) num_query=np.int64(284)
2025-03-09 07:35:45,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:46,147 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:46
2025-03-09 07:35:46,147 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.78it/s]
2025-03-09 07:35:46,174 [INFO]: There are 4188 embeddings of dim 49152
2025-03-09 07:35:46,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:35:46,174 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:46
2025-03-09 07:35:46,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:46,174 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:35:46,174 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:46,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:46,175 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:46
2025-03-09 07:35:46,175 [INFO]: 864.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:46,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:35:46,175 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:46
2025-03-09 07:35:46,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:46,175 [INFO]: 	Creating the index 03/09/2025, 07:35:46
2025-03-09 07:35:46,175 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:46
2025-03-09 07:35:46,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:35:46,176 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:46
2025-03-09 07:35:46,176 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:35:46,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.50it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.44it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.52it/s] 41%|████      | 7/17 [00:00<00:00, 11.12it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.46it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.66it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.73it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.72it/s]100%|██████████| 17/17 [00:05<00:00,  1.51it/s]100%|██████████| 17/17 [00:05<00:00,  3.28it/s]
2025-03-09 07:35:51,367 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:51
2025-03-09 07:36:35,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9528 secs
2025-03-09 07:36:35,320 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 07:36:35,321 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s]
2025-03-09 07:36:48,047 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7263 secs
2025-03-09 07:36:48,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8743 secs
2025-03-09 07:36:48,050 [INFO]: {
2025-03-09 07:36:48,050 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:48,050 [INFO]: 	index_param: efSearch=258
2025-03-09 07:36:48,050 [INFO]: 	index_path: knn.index
2025-03-09 07:36:48,050 [INFO]: 	size in bytes: 823963870
2025-03-09 07:36:48,050 [INFO]: 	avg_search_speed_ms: 9.506360637227662
2025-03-09 07:36:48,050 [INFO]: 	99p_search_speed_ms: 15.014488056767732
2025-03-09 07:36:48,050 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:48,050 [INFO]: 	nb vectors: 4188
2025-03-09 07:36:48,050 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:48,050 [INFO]: 	compression ratio: 0.9993087488168626
2025-03-09 07:36:48,050 [INFO]: }
2025-03-09 07:36:48,050 [INFO]: 	>>> Finished "Creating the index" in 61.8756 secs
2025-03-09 07:36:48,050 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9031 secs
2025-03-09 07:36:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 14103 [episode count 8/20]
[retrieval_preprocessing] for episode 3479 [episode count 9/20], we have num_retrieval=np.int64(4329) num_query=np.int64(143)
2025-03-09 07:36:52,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:53,256 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:53
2025-03-09 07:36:53,256 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2310.91it/s]
2025-03-09 07:36:53,280 [INFO]: There are 4329 embeddings of dim 49152
2025-03-09 07:36:53,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 07:36:53,280 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:53
2025-03-09 07:36:53,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:53,280 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:36:53,280 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:53,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:36:53,280 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:53
2025-03-09 07:36:53,281 [INFO]: 893.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:53,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:36:53,281 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:53
2025-03-09 07:36:53,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:53,281 [INFO]: 	Creating the index 03/09/2025, 07:36:53
2025-03-09 07:36:53,281 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:53
2025-03-09 07:36:53,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:36:53,282 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:53
2025-03-09 07:36:53,282 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:36:53,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.75it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.63it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.35it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.79it/s] 50%|█████     | 9/18 [00:00<00:00, 12.19it/s] 61%|██████    | 11/18 [00:00<00:00, 14.00it/s] 72%|███████▏  | 13/18 [00:01<00:00,  5.70it/s] 83%|████████▎ | 15/18 [00:01<00:00,  6.91it/s] 94%|█████████▍| 17/18 [00:03<00:00,  3.13it/s]100%|██████████| 18/18 [00:06<00:00,  1.26it/s]100%|██████████| 18/18 [00:06<00:00,  2.95it/s]
2025-03-09 07:36:59,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:59
2025-03-09 07:37:38,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0600 secs
2025-03-09 07:37:38,439 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:37:38,439 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-09 07:37:51,842 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4028 secs
2025-03-09 07:37:51,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5647 secs
2025-03-09 07:37:51,847 [INFO]: {
2025-03-09 07:37:51,847 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:51,847 [INFO]: 	index_param: efSearch=232
2025-03-09 07:37:51,847 [INFO]: 	index_path: knn.index
2025-03-09 07:37:51,847 [INFO]: 	size in bytes: 851704870
2025-03-09 07:37:51,847 [INFO]: 	avg_search_speed_ms: 9.921167483313068
2025-03-09 07:37:51,847 [INFO]: 	99p_search_speed_ms: 16.674941249657415
2025-03-09 07:37:51,847 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:51,847 [INFO]: 	nb vectors: 4329
2025-03-09 07:37:51,847 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:51,847 [INFO]: 	compression ratio: 0.9993086361006718
2025-03-09 07:37:51,847 [INFO]: }
2025-03-09 07:37:51,847 [INFO]: 	>>> Finished "Creating the index" in 58.5663 secs
2025-03-09 07:37:51,847 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5908 secs
2025-03-09 07:37:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 3479 [episode count 9/20]
[retrieval_preprocessing] for episode 23193 [episode count 10/20], we have num_retrieval=np.int64(4241) num_query=np.int64(231)
2025-03-09 07:37:54,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:55,195 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:55
2025-03-09 07:37:55,195 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.54it/s]
2025-03-09 07:37:55,220 [INFO]: There are 4241 embeddings of dim 49152
2025-03-09 07:37:55,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:37:55,221 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:55
2025-03-09 07:37:55,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:55,221 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:37:55,221 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:55,221 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:55,221 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:55
2025-03-09 07:37:55,221 [INFO]: 875.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:55,221 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:37:55,221 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:55
2025-03-09 07:37:55,221 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:55,221 [INFO]: 	Creating the index 03/09/2025, 07:37:55
2025-03-09 07:37:55,221 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:55
2025-03-09 07:37:55,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:37:55,222 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:55
2025-03-09 07:37:55,222 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:37:55,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.71it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.08it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.84it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.01it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.16it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.30it/s] 41%|████      | 7/17 [00:00<00:01,  8.34it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.46it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.44it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.38it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.33it/s] 71%|███████   | 12/17 [00:01<00:00,  8.26it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.40it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.38it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.40it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.40it/s]100%|██████████| 17/17 [00:04<00:00,  1.01it/s]100%|██████████| 17/17 [00:04<00:00,  3.41it/s]
2025-03-09 07:38:00,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:00
2025-03-09 07:38:38,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0261 secs
2025-03-09 07:38:38,240 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 07:38:38,240 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s]
2025-03-09 07:38:51,886 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6457 secs
2025-03-09 07:38:51,889 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6671 secs
2025-03-09 07:38:51,889 [INFO]: {
2025-03-09 07:38:51,889 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:51,890 [INFO]: 	index_param: efSearch=159
2025-03-09 07:38:51,890 [INFO]: 	index_path: knn.index
2025-03-09 07:38:51,890 [INFO]: 	size in bytes: 834391390
2025-03-09 07:38:51,890 [INFO]: 	avg_search_speed_ms: 7.832904766731623
2025-03-09 07:38:51,890 [INFO]: 	99p_search_speed_ms: 13.293468570336703
2025-03-09 07:38:51,890 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:51,890 [INFO]: 	nb vectors: 4241
2025-03-09 07:38:51,890 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:51,890 [INFO]: 	compression ratio: 0.99930864339336
2025-03-09 07:38:51,890 [INFO]: }
2025-03-09 07:38:51,890 [INFO]: 	>>> Finished "Creating the index" in 56.6684 secs
2025-03-09 07:38:51,890 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6947 secs
2025-03-09 07:38:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 23193 [episode count 10/20]
[retrieval_preprocessing] for episode 36890 [episode count 11/20], we have num_retrieval=np.int64(4275) num_query=np.int64(197)
2025-03-09 07:38:55,642 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:56,434 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:56
2025-03-09 07:38:56,434 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2139.95it/s]
2025-03-09 07:38:56,459 [INFO]: There are 4275 embeddings of dim 49152
2025-03-09 07:38:56,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:38:56,460 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:56
2025-03-09 07:38:56,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:56,460 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:38:56,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:56,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:38:56,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:56
2025-03-09 07:38:56,460 [INFO]: 882.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:56,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:38:56,461 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:56
2025-03-09 07:38:56,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:56,461 [INFO]: 	Creating the index 03/09/2025, 07:38:56
2025-03-09 07:38:56,461 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:56
2025-03-09 07:38:56,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:38:56,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:56
2025-03-09 07:38:56,465 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:38:56,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.17it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.89it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.89it/s] 41%|████      | 7/17 [00:00<00:00, 11.15it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.34it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.43it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.50it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.55it/s]100%|██████████| 17/17 [00:04<00:00,  1.86it/s]100%|██████████| 17/17 [00:04<00:00,  3.88it/s]
2025-03-09 07:39:00,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:00
2025-03-09 07:39:41,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3520 secs
2025-03-09 07:39:41,207 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 07:39:41,207 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s]
2025-03-09 07:39:54,516 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3085 secs
2025-03-09 07:39:54,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0545 secs
2025-03-09 07:39:54,519 [INFO]: {
2025-03-09 07:39:54,519 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:54,519 [INFO]: 	index_param: efSearch=254
2025-03-09 07:39:54,519 [INFO]: 	index_path: knn.index
2025-03-09 07:39:54,519 [INFO]: 	size in bytes: 841080610
2025-03-09 07:39:54,519 [INFO]: 	avg_search_speed_ms: 9.317879663139776
2025-03-09 07:39:54,519 [INFO]: 	99p_search_speed_ms: 13.331180848181248
2025-03-09 07:39:54,519 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:54,519 [INFO]: 	nb vectors: 4275
2025-03-09 07:39:54,519 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:54,519 [INFO]: 	compression ratio: 0.9993087345100014
2025-03-09 07:39:54,519 [INFO]: }
2025-03-09 07:39:54,519 [INFO]: 	>>> Finished "Creating the index" in 58.0581 secs
2025-03-09 07:39:54,519 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0857 secs
2025-03-09 07:39:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 36890 [episode count 11/20]
[retrieval_preprocessing] for episode 77083 [episode count 12/20], we have num_retrieval=np.int64(4072) num_query=np.int64(400)
2025-03-09 07:39:57,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:58,376 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:58
2025-03-09 07:39:58,376 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1758.62it/s]
2025-03-09 07:39:58,400 [INFO]: There are 4072 embeddings of dim 49152
2025-03-09 07:39:58,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:39:58,400 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:58
2025-03-09 07:39:58,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:58,400 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:39:58,400 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:58,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:58,401 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:58
2025-03-09 07:39:58,401 [INFO]: 840.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:58,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:39:58,401 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:58
2025-03-09 07:39:58,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:58,401 [INFO]: 	Creating the index 03/09/2025, 07:39:58
2025-03-09 07:39:58,401 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:58
2025-03-09 07:39:58,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:39:58,402 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:58
2025-03-09 07:39:58,402 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:39:58,402 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.31it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.86it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.63it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.98it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.27it/s] 41%|████      | 7/17 [00:00<00:01,  9.14it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.98it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.21it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.44it/s] 71%|███████   | 12/17 [00:01<00:00,  9.24it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.04it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.23it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.01it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.94it/s]100%|██████████| 17/17 [00:04<00:00,  1.19it/s]100%|██████████| 17/17 [00:04<00:00,  3.79it/s]
2025-03-09 07:40:02,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:02
2025-03-09 07:40:45,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1124 secs
2025-03-09 07:40:45,009 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 07:40:45,009 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s]
2025-03-09 07:41:00,553 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5432 secs
2025-03-09 07:41:00,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1536 secs
2025-03-09 07:41:00,556 [INFO]: {
2025-03-09 07:41:00,556 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:00,556 [INFO]: 	index_param: efSearch=261
2025-03-09 07:41:00,556 [INFO]: 	index_path: knn.index
2025-03-09 07:41:00,556 [INFO]: 	size in bytes: 801141670
2025-03-09 07:41:00,556 [INFO]: 	avg_search_speed_ms: 9.911351377786875
2025-03-09 07:41:00,556 [INFO]: 	99p_search_speed_ms: 16.469477359205467
2025-03-09 07:41:00,556 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:00,556 [INFO]: 	nb vectors: 4072
2025-03-09 07:41:00,556 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:00,556 [INFO]: 	compression ratio: 0.9993086191609531
2025-03-09 07:41:00,556 [INFO]: }
2025-03-09 07:41:00,556 [INFO]: 	>>> Finished "Creating the index" in 62.1549 secs
2025-03-09 07:41:00,556 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1796 secs
2025-03-09 07:41:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 77083 [episode count 12/20]
[retrieval_preprocessing] for episode 69917 [episode count 13/20], we have num_retrieval=np.int64(4261) num_query=np.int64(211)
2025-03-09 07:41:07,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:07,748 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:07
2025-03-09 07:41:07,748 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-09 07:41:07,773 [INFO]: There are 4261 embeddings of dim 49152
2025-03-09 07:41:07,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:41:07,774 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:07
2025-03-09 07:41:07,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:07,774 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:41:07,774 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:07,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:07,774 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:07
2025-03-09 07:41:07,774 [INFO]: 879.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:07,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:07,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:07
2025-03-09 07:41:07,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:07,774 [INFO]: 	Creating the index 03/09/2025, 07:41:07
2025-03-09 07:41:07,774 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:07
2025-03-09 07:41:07,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:41:07,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:07
2025-03-09 07:41:07,776 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:41:07,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.79it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.55it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.40it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.66it/s] 41%|████      | 7/17 [00:00<00:01,  9.88it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.59it/s] 53%|█████▎    | 9/17 [00:00<00:00,  9.31it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.20it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.99it/s] 71%|███████   | 12/17 [00:01<00:00,  8.86it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.79it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.71it/s]100%|██████████| 17/17 [00:04<00:00,  1.59it/s]100%|██████████| 17/17 [00:04<00:00,  3.76it/s]
2025-03-09 07:41:12,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:12
2025-03-09 07:41:52,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1239 secs
2025-03-09 07:41:52,430 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 07:41:52,430 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-09 07:42:06,397 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9677 secs
2025-03-09 07:42:06,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6245 secs
2025-03-09 07:42:06,400 [INFO]: {
2025-03-09 07:42:06,400 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:06,400 [INFO]: 	index_param: efSearch=244
2025-03-09 07:42:06,400 [INFO]: 	index_path: knn.index
2025-03-09 07:42:06,400 [INFO]: 	size in bytes: 838326190
2025-03-09 07:42:06,400 [INFO]: 	avg_search_speed_ms: 9.64522963455315
2025-03-09 07:42:06,400 [INFO]: 	99p_search_speed_ms: 16.086802147328854
2025-03-09 07:42:06,400 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:06,400 [INFO]: 	nb vectors: 4261
2025-03-09 07:42:06,400 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:06,400 [INFO]: 	compression ratio: 0.9993087392390783
2025-03-09 07:42:06,400 [INFO]: }
2025-03-09 07:42:06,400 [INFO]: 	>>> Finished "Creating the index" in 58.6261 secs
2025-03-09 07:42:06,400 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6525 secs
2025-03-09 07:42:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 69917 [episode count 13/20]
[retrieval_preprocessing] for episode 50558 [episode count 14/20], we have num_retrieval=np.int64(4274) num_query=np.int64(198)
2025-03-09 07:42:09,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:10,221 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:10
2025-03-09 07:42:10,221 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1828.38it/s]
2025-03-09 07:42:10,253 [INFO]: There are 4274 embeddings of dim 49152
2025-03-09 07:42:10,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 07:42:10,253 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:10
2025-03-09 07:42:10,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:10,253 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:42:10,253 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:10,254 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:42:10,254 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:10
2025-03-09 07:42:10,254 [INFO]: 882.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:10,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:42:10,254 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:10
2025-03-09 07:42:10,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:10,254 [INFO]: 	Creating the index 03/09/2025, 07:42:10
2025-03-09 07:42:10,254 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:10
2025-03-09 07:42:10,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:42:10,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:10
2025-03-09 07:42:10,257 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:42:10,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.66it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.44it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.22it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.66it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.85it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.97it/s] 41%|████      | 7/17 [00:00<00:01,  8.21it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.29it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.30it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.34it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.37it/s] 71%|███████   | 12/17 [00:01<00:00,  8.56it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.59it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.47it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.40it/s] 94%|█████████▍| 16/17 [00:02<00:00,  8.00it/s]100%|██████████| 17/17 [00:05<00:00,  1.01it/s]100%|██████████| 17/17 [00:05<00:00,  3.39it/s]
2025-03-09 07:42:15,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:15
2025-03-09 07:42:55,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2279 secs
2025-03-09 07:42:55,508 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 07:42:55,508 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-09 07:43:10,652 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1444 secs
2025-03-09 07:43:10,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3988 secs
2025-03-09 07:43:10,656 [INFO]: {
2025-03-09 07:43:10,656 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:10,656 [INFO]: 	index_param: efSearch=253
2025-03-09 07:43:10,656 [INFO]: 	index_path: knn.index
2025-03-09 07:43:10,656 [INFO]: 	size in bytes: 840883870
2025-03-09 07:43:10,656 [INFO]: 	avg_search_speed_ms: 10.61859550750409
2025-03-09 07:43:10,656 [INFO]: 	99p_search_speed_ms: 20.237904165405794
2025-03-09 07:43:10,656 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:10,656 [INFO]: 	nb vectors: 4274
2025-03-09 07:43:10,656 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:10,656 [INFO]: 	compression ratio: 0.9993087297536103
2025-03-09 07:43:10,656 [INFO]: }
2025-03-09 07:43:10,656 [INFO]: 	>>> Finished "Creating the index" in 60.4021 secs
2025-03-09 07:43:10,656 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4349 secs
2025-03-09 07:43:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 50558 [episode count 14/20]
[retrieval_preprocessing] for episode 45609 [episode count 15/20], we have num_retrieval=np.int64(4262) num_query=np.int64(210)
2025-03-09 07:43:13,898 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:14,483 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:14
2025-03-09 07:43:14,483 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2165.36it/s]
2025-03-09 07:43:14,510 [INFO]: There are 4262 embeddings of dim 49152
2025-03-09 07:43:14,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:43:14,510 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:14
2025-03-09 07:43:14,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:14,510 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:43:14,510 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:14,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:14,510 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:14
2025-03-09 07:43:14,511 [INFO]: 879.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:14,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:43:14,511 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:14
2025-03-09 07:43:14,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:14,511 [INFO]: 	Creating the index 03/09/2025, 07:43:14
2025-03-09 07:43:14,511 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:14
2025-03-09 07:43:14,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:43:14,512 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:14
2025-03-09 07:43:14,512 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:43:14,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.14it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.48it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.59it/s] 41%|████      | 7/17 [00:00<00:00, 11.27it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.52it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.66it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.86it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.90it/s]100%|██████████| 17/17 [00:04<00:00,  1.73it/s]100%|██████████| 17/17 [00:04<00:00,  3.68it/s]
2025-03-09 07:43:19,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:19
2025-03-09 07:43:57,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0445 secs
2025-03-09 07:43:57,185 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 07:43:57,185 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-09 07:44:13,113 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9281 secs
2025-03-09 07:44:13,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6063 secs
2025-03-09 07:44:13,118 [INFO]: {
2025-03-09 07:44:13,118 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:13,118 [INFO]: 	index_param: efSearch=178
2025-03-09 07:44:13,118 [INFO]: 	index_path: knn.index
2025-03-09 07:44:13,118 [INFO]: 	size in bytes: 838522930
2025-03-09 07:44:13,118 [INFO]: 	avg_search_speed_ms: 8.465419596756645
2025-03-09 07:44:13,118 [INFO]: 	99p_search_speed_ms: 13.352747494354846
2025-03-09 07:44:13,118 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:13,118 [INFO]: 	nb vectors: 4262
2025-03-09 07:44:13,118 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:13,118 [INFO]: 	compression ratio: 0.9993087440077518
2025-03-09 07:44:13,118 [INFO]: }
2025-03-09 07:44:13,118 [INFO]: 	>>> Finished "Creating the index" in 58.6076 secs
2025-03-09 07:44:13,118 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6355 secs
2025-03-09 07:44:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 45609 [episode count 15/20]
[retrieval_preprocessing] for episode 12204 [episode count 16/20], we have num_retrieval=np.int64(4205) num_query=np.int64(267)
2025-03-09 07:44:16,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:16,744 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:16
2025-03-09 07:44:16,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2303.30it/s]
2025-03-09 07:44:16,768 [INFO]: There are 4205 embeddings of dim 49152
2025-03-09 07:44:16,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:44:16,768 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:16
2025-03-09 07:44:16,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:16,768 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:44:16,768 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:16,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:16,768 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:16
2025-03-09 07:44:16,768 [INFO]: 867.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:16,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:44:16,768 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:16
2025-03-09 07:44:16,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:16,768 [INFO]: 	Creating the index 03/09/2025, 07:44:16
2025-03-09 07:44:16,768 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:16
2025-03-09 07:44:16,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:44:16,770 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:16
2025-03-09 07:44:16,770 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:44:16,770 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.80it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.09it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.22it/s] 41%|████      | 7/17 [00:00<00:00, 10.57it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.63it/s] 65%|██████▍   | 11/17 [00:01<00:00, 12.22it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.32it/s] 88%|████████▊ | 15/17 [00:01<00:00, 14.23it/s]100%|██████████| 17/17 [00:04<00:00,  1.93it/s]100%|██████████| 17/17 [00:04<00:00,  4.02it/s]
2025-03-09 07:44:21,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:21
2025-03-09 07:45:03,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5649 secs
2025-03-09 07:45:03,571 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:45:03,571 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s]
2025-03-09 07:45:18,147 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5763 secs
2025-03-09 07:45:18,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3800 secs
2025-03-09 07:45:18,150 [INFO]: {
2025-03-09 07:45:18,150 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:18,150 [INFO]: 	index_param: efSearch=243
2025-03-09 07:45:18,150 [INFO]: 	index_path: knn.index
2025-03-09 07:45:18,150 [INFO]: 	size in bytes: 827308510
2025-03-09 07:45:18,150 [INFO]: 	avg_search_speed_ms: 8.912383257071097
2025-03-09 07:45:18,150 [INFO]: 	99p_search_speed_ms: 14.009062175173302
2025-03-09 07:45:18,150 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:18,150 [INFO]: 	nb vectors: 4205
2025-03-09 07:45:18,150 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:18,150 [INFO]: 	compression ratio: 0.9993087584702833
2025-03-09 07:45:18,150 [INFO]: }
2025-03-09 07:45:18,150 [INFO]: 	>>> Finished "Creating the index" in 61.3816 secs
2025-03-09 07:45:18,150 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4061 secs
2025-03-09 07:45:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 12204 [episode count 16/20]
[retrieval_preprocessing] for episode 34093 [episode count 17/20], we have num_retrieval=np.int64(4261) num_query=np.int64(211)
2025-03-09 07:45:23,205 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:24,129 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:24
2025-03-09 07:45:24,129 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-09 07:45:24,152 [INFO]: There are 4261 embeddings of dim 49152
2025-03-09 07:45:24,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 07:45:24,153 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:24
2025-03-09 07:45:24,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:24,153 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:45:24,153 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:24,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:24,153 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:24
2025-03-09 07:45:24,153 [INFO]: 879.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:24,153 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:45:24,153 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:24
2025-03-09 07:45:24,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:24,153 [INFO]: 	Creating the index 03/09/2025, 07:45:24
2025-03-09 07:45:24,153 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:24
2025-03-09 07:45:24,154 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:45:24,154 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:24
2025-03-09 07:45:24,154 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:45:24,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.06it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.63it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.48it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.99it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.42it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.56it/s] 41%|████      | 7/17 [00:00<00:01,  8.61it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.72it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.71it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.68it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.94it/s] 71%|███████   | 12/17 [00:01<00:00,  8.58it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.41it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.27it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.35it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.35it/s]100%|██████████| 17/17 [00:05<00:00,  1.09s/it]100%|██████████| 17/17 [00:05<00:00,  3.22it/s]
2025-03-09 07:45:29,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:29
2025-03-09 07:46:08,958 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5207 secs
2025-03-09 07:46:08,959 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:46:08,959 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-09 07:46:23,825 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8663 secs
2025-03-09 07:46:23,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6731 secs
2025-03-09 07:46:23,828 [INFO]: {
2025-03-09 07:46:23,828 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:23,828 [INFO]: 	index_param: efSearch=250
2025-03-09 07:46:23,828 [INFO]: 	index_path: knn.index
2025-03-09 07:46:23,828 [INFO]: 	size in bytes: 838326190
2025-03-09 07:46:23,828 [INFO]: 	avg_search_speed_ms: 9.980789040440243
2025-03-09 07:46:23,828 [INFO]: 	99p_search_speed_ms: 17.269072751514614
2025-03-09 07:46:23,828 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:23,828 [INFO]: 	nb vectors: 4261
2025-03-09 07:46:23,828 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:23,828 [INFO]: 	compression ratio: 0.9993087392390783
2025-03-09 07:46:23,828 [INFO]: }
2025-03-09 07:46:23,828 [INFO]: 	>>> Finished "Creating the index" in 59.6745 secs
2025-03-09 07:46:23,828 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6989 secs
2025-03-09 07:46:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 34093 [episode count 17/20]
[retrieval_preprocessing] for episode 92205 [episode count 18/20], we have num_retrieval=np.int64(4231) num_query=np.int64(241)
2025-03-09 07:46:27,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:28,153 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:28
2025-03-09 07:46:28,153 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1944.51it/s]
2025-03-09 07:46:28,178 [INFO]: There are 4231 embeddings of dim 49152
2025-03-09 07:46:28,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 07:46:28,179 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:28
2025-03-09 07:46:28,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:28,179 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:46:28,179 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:28,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:28,179 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:28
2025-03-09 07:46:28,179 [INFO]: 873.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:28,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:28,179 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:28
2025-03-09 07:46:28,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:28,179 [INFO]: 	Creating the index 03/09/2025, 07:46:28
2025-03-09 07:46:28,179 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:28
2025-03-09 07:46:28,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:46:28,180 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:28
2025-03-09 07:46:28,180 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:46:28,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.07it/s] 18%|█▊        | 3/17 [00:00<00:01, 12.62it/s] 29%|██▉       | 5/17 [00:00<00:00, 14.05it/s] 41%|████      | 7/17 [00:00<00:00, 15.15it/s] 53%|█████▎    | 9/17 [00:00<00:00, 15.18it/s] 65%|██████▍   | 11/17 [00:00<00:00, 14.90it/s] 76%|███████▋  | 13/17 [00:00<00:00, 15.30it/s] 88%|████████▊ | 15/17 [00:01<00:00, 15.41it/s]100%|██████████| 17/17 [00:04<00:00,  1.81it/s]100%|██████████| 17/17 [00:04<00:00,  4.01it/s]
2025-03-09 07:46:32,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:32
2025-03-09 07:47:17,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4414 secs
2025-03-09 07:47:17,867 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:47:17,867 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 07:47:35,442 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5751 secs
2025-03-09 07:47:35,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2646 secs
2025-03-09 07:47:35,445 [INFO]: {
2025-03-09 07:47:35,445 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:35,445 [INFO]: 	index_param: efSearch=224
2025-03-09 07:47:35,445 [INFO]: 	index_path: knn.index
2025-03-09 07:47:35,445 [INFO]: 	size in bytes: 832423810
2025-03-09 07:47:35,445 [INFO]: 	avg_search_speed_ms: 9.364694893213638
2025-03-09 07:47:35,445 [INFO]: 	99p_search_speed_ms: 16.989371220115572
2025-03-09 07:47:35,445 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:35,445 [INFO]: 	nb vectors: 4231
2025-03-09 07:47:35,445 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:35,445 [INFO]: 	compression ratio: 0.9993088112172092
2025-03-09 07:47:35,445 [INFO]: }
2025-03-09 07:47:35,445 [INFO]: 	>>> Finished "Creating the index" in 67.2658 secs
2025-03-09 07:47:35,445 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2921 secs
2025-03-09 07:47:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 92205 [episode count 18/20]
[retrieval_preprocessing] for episode 58799 [episode count 19/20], we have num_retrieval=np.int64(4212) num_query=np.int64(260)
2025-03-09 07:47:38,631 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:39,198 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:39
2025-03-09 07:47:39,198 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1699.47it/s]
2025-03-09 07:47:39,222 [INFO]: There are 4212 embeddings of dim 49152
2025-03-09 07:47:39,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:47:39,222 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:39
2025-03-09 07:47:39,222 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:39,222 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:47:39,222 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:39,222 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:47:39,222 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:39
2025-03-09 07:47:39,222 [INFO]: 869.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:39,222 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:47:39,222 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:39
2025-03-09 07:47:39,222 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:39,222 [INFO]: 	Creating the index 03/09/2025, 07:47:39
2025-03-09 07:47:39,223 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:39
2025-03-09 07:47:39,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:47:39,224 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:39
2025-03-09 07:47:39,224 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:47:39,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.88it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.19it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.74it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.03it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.29it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.38it/s] 41%|████      | 7/17 [00:00<00:01,  8.45it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.53it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.53it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.58it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.68it/s] 71%|███████   | 12/17 [00:01<00:00,  8.22it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.85it/s] 82%|████████▏ | 14/17 [00:01<00:00,  7.09it/s] 88%|████████▊ | 15/17 [00:01<00:00,  7.59it/s] 94%|█████████▍| 16/17 [00:02<00:00,  7.79it/s]100%|██████████| 17/17 [00:04<00:00,  1.03it/s]100%|██████████| 17/17 [00:04<00:00,  3.45it/s]
2025-03-09 07:47:44,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:44
2025-03-09 07:48:26,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6996 secs
2025-03-09 07:48:26,861 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:48:26,861 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 07:48:40,718 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8567 secs
2025-03-09 07:48:40,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4965 secs
2025-03-09 07:48:40,721 [INFO]: {
2025-03-09 07:48:40,721 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:40,721 [INFO]: 	index_param: efSearch=216
2025-03-09 07:48:40,721 [INFO]: 	index_path: knn.index
2025-03-09 07:48:40,721 [INFO]: 	size in bytes: 828685690
2025-03-09 07:48:40,721 [INFO]: 	avg_search_speed_ms: 8.85149041248436
2025-03-09 07:48:40,721 [INFO]: 	99p_search_speed_ms: 15.859864058438689
2025-03-09 07:48:40,721 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:40,721 [INFO]: 	nb vectors: 4212
2025-03-09 07:48:40,721 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:40,721 [INFO]: 	compression ratio: 0.999308792215297
2025-03-09 07:48:40,721 [INFO]: }
2025-03-09 07:48:40,721 [INFO]: 	>>> Finished "Creating the index" in 61.4984 secs
2025-03-09 07:48:40,721 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5233 secs
2025-03-09 07:48:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 58799 [episode count 19/20]
2025-03-09 07:48:42: [retrieval_preprocessing] finished for (4045730075, 'lid') [chosen_id count 2/10]
2025-03-09 07:48:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1712293193, 'marker') [chosen_id count 3/10]
2025-03-09 07:48:43: [retrieval_preprocessing] we have num_total=3980 embedding_dim=49152
[retrieval_preprocessing] for episode 58880 [episode count 0/20], we have num_retrieval=np.int64(3767) num_query=np.int64(213)
2025-03-09 07:48:44,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:45,346 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:45
2025-03-09 07:48:45,346 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1836.39it/s]
2025-03-09 07:48:45,370 [INFO]: There are 3767 embeddings of dim 49152
2025-03-09 07:48:45,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:48:45,370 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:45
2025-03-09 07:48:45,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:45,370 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:48:45,370 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:45,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:45,370 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:45
2025-03-09 07:48:45,370 [INFO]: 777.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:45,370 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:48:45,370 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:45
2025-03-09 07:48:45,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:45,370 [INFO]: 	Creating the index 03/09/2025, 07:48:45
2025-03-09 07:48:45,370 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:45
2025-03-09 07:48:45,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:48:45,372 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:45
2025-03-09 07:48:45,372 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:48:45,372 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.23it/s] 20%|██        | 3/15 [00:00<00:01,  9.65it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.81it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.27it/s] 60%|██████    | 9/15 [00:00<00:00, 11.46it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.72it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.45it/s]100%|██████████| 15/15 [00:03<00:00,  2.06it/s]100%|██████████| 15/15 [00:03<00:00,  3.94it/s]
2025-03-09 07:48:49,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:49
2025-03-09 07:49:23,057 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8708 secs
2025-03-09 07:49:23,057 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:49:23,057 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 07:49:38,797 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7398 secs
2025-03-09 07:49:38,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4339 secs
2025-03-09 07:49:38,806 [INFO]: {
2025-03-09 07:49:38,806 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:38,806 [INFO]: 	index_param: efSearch=197
2025-03-09 07:49:38,806 [INFO]: 	index_path: knn.index
2025-03-09 07:49:38,806 [INFO]: 	size in bytes: 741134350
2025-03-09 07:49:38,806 [INFO]: 	avg_search_speed_ms: 11.685748513304915
2025-03-09 07:49:38,806 [INFO]: 	99p_search_speed_ms: 25.261846743524078
2025-03-09 07:49:38,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:38,806 [INFO]: 	nb vectors: 3767
2025-03-09 07:49:38,806 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:38,806 [INFO]: 	compression ratio: 0.9993091481996483
2025-03-09 07:49:38,806 [INFO]: }
2025-03-09 07:49:38,806 [INFO]: 	>>> Finished "Creating the index" in 53.4358 secs
2025-03-09 07:49:38,806 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4602 secs
2025-03-09 07:49:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 58880 [episode count 0/20]
[retrieval_preprocessing] for episode 76803 [episode count 1/20], we have num_retrieval=np.int64(3669) num_query=np.int64(311)
2025-03-09 07:49:42,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:42,922 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:42
2025-03-09 07:49:42,923 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.86it/s]
2025-03-09 07:49:42,953 [INFO]: There are 3669 embeddings of dim 49152
2025-03-09 07:49:42,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 07:49:42,953 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:42
2025-03-09 07:49:42,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:42,954 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:49:42,954 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:42,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:49:42,954 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:42
2025-03-09 07:49:42,954 [INFO]: 757.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:42,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:49:42,954 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:42
2025-03-09 07:49:42,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:42,955 [INFO]: 	Creating the index 03/09/2025, 07:49:42
2025-03-09 07:49:42,955 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:42
2025-03-09 07:49:42,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:49:42,958 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:42
2025-03-09 07:49:42,958 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:49:42,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.62it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.56it/s] 20%|██        | 3/15 [00:00<00:01,  8.18it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.53it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.63it/s] 40%|████      | 6/15 [00:00<00:01,  8.80it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.78it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.70it/s] 60%|██████    | 9/15 [00:01<00:00,  8.64it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.54it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.46it/s] 80%|████████  | 12/15 [00:01<00:00,  8.21it/s] 87%|████████▋ | 13/15 [00:01<00:00,  7.97it/s] 93%|█████████▎| 14/15 [00:01<00:00,  7.84it/s]100%|██████████| 15/15 [00:04<00:00,  1.03it/s]100%|██████████| 15/15 [00:04<00:00,  3.24it/s]
2025-03-09 07:49:47,596 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:47
2025-03-09 07:50:22,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1877 secs
2025-03-09 07:50:22,784 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 07:50:22,784 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s]
2025-03-09 07:50:37,526 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7418 secs
2025-03-09 07:50:37,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5711 secs
2025-03-09 07:50:37,529 [INFO]: {
2025-03-09 07:50:37,529 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:37,529 [INFO]: 	index_param: efSearch=226
2025-03-09 07:50:37,529 [INFO]: 	index_path: knn.index
2025-03-09 07:50:37,529 [INFO]: 	size in bytes: 721853350
2025-03-09 07:50:37,529 [INFO]: 	avg_search_speed_ms: 10.421352469711564
2025-03-09 07:50:37,529 [INFO]: 	99p_search_speed_ms: 15.822180525865399
2025-03-09 07:50:37,529 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:37,529 [INFO]: 	nb vectors: 3669
2025-03-09 07:50:37,529 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:37,530 [INFO]: 	compression ratio: 0.9993092807562645
2025-03-09 07:50:37,530 [INFO]: }
2025-03-09 07:50:37,530 [INFO]: 	>>> Finished "Creating the index" in 54.5749 secs
2025-03-09 07:50:37,530 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6070 secs
2025-03-09 07:50:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 76803 [episode count 1/20]
[retrieval_preprocessing] for episode 67589 [episode count 2/20], we have num_retrieval=np.int64(3803) num_query=np.int64(177)
2025-03-09 07:50:41,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:41,533 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:41
2025-03-09 07:50:41,534 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.05it/s]
2025-03-09 07:50:41,556 [INFO]: There are 3803 embeddings of dim 49152
2025-03-09 07:50:41,557 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 07:50:41,557 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:41
2025-03-09 07:50:41,557 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:41,557 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:50:41,557 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:41,557 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:41,557 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:41
2025-03-09 07:50:41,557 [INFO]: 784.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:41,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:50:41,557 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:41
2025-03-09 07:50:41,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:41,557 [INFO]: 	Creating the index 03/09/2025, 07:50:41
2025-03-09 07:50:41,557 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:41
2025-03-09 07:50:41,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:50:41,558 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:41
2025-03-09 07:50:41,558 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:50:41,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.39it/s] 20%|██        | 3/15 [00:00<00:01, 10.73it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.30it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.46it/s] 60%|██████    | 9/15 [00:00<00:00, 12.61it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.76it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.67it/s]100%|██████████| 15/15 [00:03<00:00,  2.12it/s]100%|██████████| 15/15 [00:03<00:00,  4.09it/s]
2025-03-09 07:50:45,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:45
2025-03-09 07:51:22,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4443 secs
2025-03-09 07:51:22,675 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:51:22,675 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 07:51:42,803 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1281 secs
2025-03-09 07:51:42,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2480 secs
2025-03-09 07:51:42,806 [INFO]: {
2025-03-09 07:51:42,806 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:42,806 [INFO]: 	index_param: efSearch=250
2025-03-09 07:51:42,806 [INFO]: 	index_path: knn.index
2025-03-09 07:51:42,806 [INFO]: 	size in bytes: 748217050
2025-03-09 07:51:42,806 [INFO]: 	avg_search_speed_ms: 9.986763924953866
2025-03-09 07:51:42,806 [INFO]: 	99p_search_speed_ms: 14.304863987490535
2025-03-09 07:51:42,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:42,806 [INFO]: 	nb vectors: 3803
2025-03-09 07:51:42,806 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:42,806 [INFO]: 	compression ratio: 0.9993092565853718
2025-03-09 07:51:42,806 [INFO]: }
2025-03-09 07:51:42,806 [INFO]: 	>>> Finished "Creating the index" in 61.2493 secs
2025-03-09 07:51:42,806 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2728 secs
2025-03-09 07:51:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 67589 [episode count 2/20]
[retrieval_preprocessing] for episode 81926 [episode count 3/20], we have num_retrieval=np.int64(3801) num_query=np.int64(179)
2025-03-09 07:51:46,492 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:47,163 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:47
2025-03-09 07:51:47,164 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.81it/s]
2025-03-09 07:51:47,190 [INFO]: There are 3801 embeddings of dim 49152
2025-03-09 07:51:47,191 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:51:47,191 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:47
2025-03-09 07:51:47,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:47,191 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:51:47,191 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:47,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:47,191 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:47
2025-03-09 07:51:47,191 [INFO]: 784.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:47,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:51:47,191 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:47
2025-03-09 07:51:47,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:47,191 [INFO]: 	Creating the index 03/09/2025, 07:51:47
2025-03-09 07:51:47,191 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:47
2025-03-09 07:51:47,192 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:51:47,193 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:47
2025-03-09 07:51:47,193 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:51:47,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.30it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.47it/s] 20%|██        | 3/15 [00:00<00:01,  7.90it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.31it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.40it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.51it/s] 60%|██████    | 9/15 [00:00<00:00,  9.97it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.23it/s] 80%|████████  | 12/15 [00:01<00:00,  9.12it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.04it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.97it/s]100%|██████████| 15/15 [00:04<00:00,  1.15it/s]100%|██████████| 15/15 [00:04<00:00,  3.30it/s]
2025-03-09 07:51:51,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:51
2025-03-09 07:52:34,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0669 secs
2025-03-09 07:52:34,815 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 07:52:34,815 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s]
2025-03-09 07:52:49,945 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1294 secs
2025-03-09 07:52:49,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7553 secs
2025-03-09 07:52:49,948 [INFO]: {
2025-03-09 07:52:49,948 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:49,948 [INFO]: 	index_param: efSearch=217
2025-03-09 07:52:49,948 [INFO]: 	index_path: knn.index
2025-03-09 07:52:49,948 [INFO]: 	size in bytes: 747823570
2025-03-09 07:52:49,948 [INFO]: 	avg_search_speed_ms: 9.344374977060916
2025-03-09 07:52:49,948 [INFO]: 	99p_search_speed_ms: 16.68921276228502
2025-03-09 07:52:49,948 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:49,948 [INFO]: 	nb vectors: 3801
2025-03-09 07:52:49,948 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:49,948 [INFO]: 	compression ratio: 0.9993092461635035
2025-03-09 07:52:49,948 [INFO]: }
2025-03-09 07:52:49,948 [INFO]: 	>>> Finished "Creating the index" in 62.7569 secs
2025-03-09 07:52:49,948 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7847 secs
2025-03-09 07:52:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 81926 [episode count 3/20]
[retrieval_preprocessing] for episode 60935 [episode count 4/20], we have num_retrieval=np.int64(3695) num_query=np.int64(285)
2025-03-09 07:52:52,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:53,003 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:53
2025-03-09 07:52:53,003 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2016.49it/s]
2025-03-09 07:52:53,030 [INFO]: There are 3695 embeddings of dim 49152
2025-03-09 07:52:53,030 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 07:52:53,030 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,030 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:53,031 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:52:53,031 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:53,031 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:52:53,031 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,031 [INFO]: 762.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:53,031 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:52:53,032 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:53
2025-03-09 07:52:53,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:53,032 [INFO]: 	Creating the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,032 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:53
2025-03-09 07:52:53,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 07:52:53,035 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:53
2025-03-09 07:52:53,035 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:52:53,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.27it/s] 20%|██        | 3/15 [00:00<00:01,  8.91it/s] 40%|████      | 6/15 [00:00<00:00, 15.66it/s] 60%|██████    | 9/15 [00:00<00:00, 15.23it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.65it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.37it/s]100%|██████████| 15/15 [00:03<00:00,  2.17it/s]100%|██████████| 15/15 [00:03<00:00,  4.02it/s]
2025-03-09 07:52:56,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:56
2025-03-09 07:53:33,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6636 secs
2025-03-09 07:53:33,438 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:53:33,438 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-09 07:53:50,065 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6267 secs
2025-03-09 07:53:50,067 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0325 secs
2025-03-09 07:53:50,067 [INFO]: {
2025-03-09 07:53:50,067 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:50,067 [INFO]: 	index_param: efSearch=238
2025-03-09 07:53:50,067 [INFO]: 	index_path: knn.index
2025-03-09 07:53:50,067 [INFO]: 	size in bytes: 726968590
2025-03-09 07:53:50,067 [INFO]: 	avg_search_speed_ms: 9.845308756903107
2025-03-09 07:53:50,067 [INFO]: 	99p_search_speed_ms: 14.530711539555343
2025-03-09 07:53:50,067 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:50,067 [INFO]: 	nb vectors: 3695
2025-03-09 07:53:50,067 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:50,067 [INFO]: 	compression ratio: 0.9993094199571951
2025-03-09 07:53:50,067 [INFO]: }
2025-03-09 07:53:50,067 [INFO]: 	>>> Finished "Creating the index" in 57.0357 secs
2025-03-09 07:53:50,067 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0642 secs
2025-03-09 07:53:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 60935 [episode count 4/20]
[retrieval_preprocessing] for episode 83976 [episode count 5/20], we have num_retrieval=np.int64(3811) num_query=np.int64(169)
2025-03-09 07:53:53,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:54,514 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:54
2025-03-09 07:53:54,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1808.67it/s]
2025-03-09 07:53:54,544 [INFO]: There are 3811 embeddings of dim 49152
2025-03-09 07:53:54,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:53:54,545 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:54
2025-03-09 07:53:54,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:54,545 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:53:54,545 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:54,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:53:54,545 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:54
2025-03-09 07:53:54,545 [INFO]: 786.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:54,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:53:54,546 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:54
2025-03-09 07:53:54,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:54,546 [INFO]: 	Creating the index 03/09/2025, 07:53:54
2025-03-09 07:53:54,546 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:54
2025-03-09 07:53:54,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:53:54,549 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:54
2025-03-09 07:53:54,549 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:53:54,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.01it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.24it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.73it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.18it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.41it/s] 50%|█████     | 8/16 [00:01<00:00,  8.22it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.72it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.79it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.83it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.80it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.87it/s]100%|██████████| 16/16 [00:04<00:00,  1.60it/s]100%|██████████| 16/16 [00:04<00:00,  3.48it/s]
2025-03-09 07:53:59,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:59
2025-03-09 07:54:34,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5983 secs
2025-03-09 07:54:34,756 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 07:54:34,756 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 07:54:49,599 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8425 secs
2025-03-09 07:54:49,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0522 secs
2025-03-09 07:54:49,602 [INFO]: {
2025-03-09 07:54:49,602 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:49,602 [INFO]: 	index_param: efSearch=164
2025-03-09 07:54:49,602 [INFO]: 	index_path: knn.index
2025-03-09 07:54:49,602 [INFO]: 	size in bytes: 749791150
2025-03-09 07:54:49,602 [INFO]: 	avg_search_speed_ms: 8.393388518345747
2025-03-09 07:54:49,602 [INFO]: 	99p_search_speed_ms: 16.807712963782244
2025-03-09 07:54:49,602 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:49,602 [INFO]: 	nb vectors: 3811
2025-03-09 07:54:49,602 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:49,602 [INFO]: 	compression ratio: 0.9993090582624241
2025-03-09 07:54:49,602 [INFO]: }
2025-03-09 07:54:49,602 [INFO]: 	>>> Finished "Creating the index" in 55.0558 secs
2025-03-09 07:54:49,602 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0877 secs
2025-03-09 07:54:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 83976 [episode count 5/20]
[retrieval_preprocessing] for episode 30731 [episode count 6/20], we have num_retrieval=np.int64(3795) num_query=np.int64(185)
2025-03-09 07:54:51,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:52,328 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:52
2025-03-09 07:54:52,328 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.21it/s]
2025-03-09 07:54:52,358 [INFO]: There are 3795 embeddings of dim 49152
2025-03-09 07:54:52,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 07:54:52,358 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:52
2025-03-09 07:54:52,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:52,359 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:54:52,359 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:52,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:54:52,359 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:52
2025-03-09 07:54:52,359 [INFO]: 783.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:52,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:54:52,360 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:52
2025-03-09 07:54:52,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:52,360 [INFO]: 	Creating the index 03/09/2025, 07:54:52
2025-03-09 07:54:52,360 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:52
2025-03-09 07:54:52,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:54:52,363 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:52
2025-03-09 07:54:52,363 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:54:52,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.84it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.17it/s] 20%|██        | 3/15 [00:00<00:01,  6.85it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.18it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.31it/s] 40%|████      | 6/15 [00:00<00:01,  7.46it/s] 47%|████▋     | 7/15 [00:00<00:01,  7.61it/s] 53%|█████▎    | 8/15 [00:01<00:00,  7.80it/s] 60%|██████    | 9/15 [00:01<00:00,  7.93it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.01it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.06it/s] 80%|████████  | 12/15 [00:01<00:00,  8.19it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.16it/s]100%|██████████| 15/15 [00:04<00:00,  1.24it/s]100%|██████████| 15/15 [00:04<00:00,  3.06it/s]
2025-03-09 07:54:57,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:57
2025-03-09 07:55:33,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9630 secs
2025-03-09 07:55:33,234 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 07:55:33,234 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 07:55:48,385 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1511 secs
2025-03-09 07:55:48,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0244 secs
2025-03-09 07:55:48,388 [INFO]: {
2025-03-09 07:55:48,388 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:48,388 [INFO]: 	index_param: efSearch=186
2025-03-09 07:55:48,388 [INFO]: 	index_path: knn.index
2025-03-09 07:55:48,388 [INFO]: 	size in bytes: 746643130
2025-03-09 07:55:48,388 [INFO]: 	avg_search_speed_ms: 8.625983313807609
2025-03-09 07:55:48,388 [INFO]: 	99p_search_speed_ms: 14.45449452847243
2025-03-09 07:55:48,388 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:48,388 [INFO]: 	nb vectors: 3795
2025-03-09 07:55:48,388 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:48,388 [INFO]: 	compression ratio: 0.9993092148319908
2025-03-09 07:55:48,388 [INFO]: }
2025-03-09 07:55:48,388 [INFO]: 	>>> Finished "Creating the index" in 56.0278 secs
2025-03-09 07:55:48,388 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0594 secs
2025-03-09 07:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 30731 [episode count 6/20]
[retrieval_preprocessing] for episode 16396 [episode count 7/20], we have num_retrieval=np.int64(3790) num_query=np.int64(190)
2025-03-09 07:55:51,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:51,810 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:51
2025-03-09 07:55:51,810 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.43it/s]
2025-03-09 07:55:51,834 [INFO]: There are 3790 embeddings of dim 49152
2025-03-09 07:55:51,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:55:51,835 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:51
2025-03-09 07:55:51,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:51,835 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:55:51,835 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:51,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:51,835 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:51
2025-03-09 07:55:51,835 [INFO]: 782.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:51,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:55:51,835 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:51
2025-03-09 07:55:51,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:51,835 [INFO]: 	Creating the index 03/09/2025, 07:55:51
2025-03-09 07:55:51,835 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:51
2025-03-09 07:55:51,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:55:51,836 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:51
2025-03-09 07:55:51,836 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:55:51,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.68it/s] 20%|██        | 3/15 [00:00<00:01,  9.59it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.90it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.40it/s] 60%|██████    | 9/15 [00:00<00:00, 12.05it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.57it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.68it/s]100%|██████████| 15/15 [00:03<00:00,  2.16it/s]100%|██████████| 15/15 [00:03<00:00,  4.10it/s]
2025-03-09 07:55:55,502 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:55
2025-03-09 07:56:33,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8840 secs
2025-03-09 07:56:33,387 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:56:33,387 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.37it/s] 50%|█████     | 2/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 07:56:50,848 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4612 secs
2025-03-09 07:56:50,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0148 secs
2025-03-09 07:56:50,851 [INFO]: {
2025-03-09 07:56:50,851 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:50,851 [INFO]: 	index_param: efSearch=219
2025-03-09 07:56:50,851 [INFO]: 	index_path: knn.index
2025-03-09 07:56:50,851 [INFO]: 	size in bytes: 745659430
2025-03-09 07:56:50,851 [INFO]: 	avg_search_speed_ms: 9.19158385552103
2025-03-09 07:56:50,851 [INFO]: 	99p_search_speed_ms: 17.838178481906606
2025-03-09 07:56:50,851 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:50,851 [INFO]: 	nb vectors: 3790
2025-03-09 07:56:50,851 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:50,851 [INFO]: 	compression ratio: 0.9993091886466184
2025-03-09 07:56:50,851 [INFO]: }
2025-03-09 07:56:50,851 [INFO]: 	>>> Finished "Creating the index" in 59.0163 secs
2025-03-09 07:56:50,851 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0410 secs
2025-03-09 07:56:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 16396 [episode count 7/20]
[retrieval_preprocessing] for episode 50704 [episode count 8/20], we have num_retrieval=np.int64(3790) num_query=np.int64(190)
2025-03-09 07:56:53,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:54,144 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:54
2025-03-09 07:56:54,144 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1743.99it/s]
2025-03-09 07:56:54,168 [INFO]: There are 3790 embeddings of dim 49152
2025-03-09 07:56:54,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 07:56:54,168 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:54
2025-03-09 07:56:54,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:54,168 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:56:54,168 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:54,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:54,169 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:54
2025-03-09 07:56:54,169 [INFO]: 782.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:54,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:56:54,169 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:54
2025-03-09 07:56:54,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:54,169 [INFO]: 	Creating the index 03/09/2025, 07:56:54
2025-03-09 07:56:54,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:54
2025-03-09 07:56:54,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:56:54,170 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:54
2025-03-09 07:56:54,170 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:56:54,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.32it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.03it/s] 20%|██        | 3/15 [00:00<00:01,  7.85it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.43it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.66it/s] 40%|████      | 6/15 [00:00<00:01,  8.71it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.77it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.86it/s] 60%|██████    | 9/15 [00:01<00:00,  9.02it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.03it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.02it/s] 80%|████████  | 12/15 [00:01<00:00,  9.04it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.99it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.99it/s]100%|██████████| 15/15 [00:04<00:00,  1.21it/s]100%|██████████| 15/15 [00:04<00:00,  3.66it/s]
2025-03-09 07:56:58,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:58
2025-03-09 07:57:42,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7715 secs
2025-03-09 07:57:42,049 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:57:42,049 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s]
2025-03-09 07:57:59,605 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5559 secs
2025-03-09 07:57:59,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4379 secs
2025-03-09 07:57:59,608 [INFO]: {
2025-03-09 07:57:59,608 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:59,608 [INFO]: 	index_param: efSearch=205
2025-03-09 07:57:59,608 [INFO]: 	index_path: knn.index
2025-03-09 07:57:59,608 [INFO]: 	size in bytes: 745659430
2025-03-09 07:57:59,608 [INFO]: 	avg_search_speed_ms: 9.218878180758539
2025-03-09 07:57:59,608 [INFO]: 	99p_search_speed_ms: 13.845199793577198
2025-03-09 07:57:59,608 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:59,608 [INFO]: 	nb vectors: 3790
2025-03-09 07:57:59,608 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:59,608 [INFO]: 	compression ratio: 0.9993091886466184
2025-03-09 07:57:59,608 [INFO]: }
2025-03-09 07:57:59,608 [INFO]: 	>>> Finished "Creating the index" in 65.4397 secs
2025-03-09 07:57:59,609 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4642 secs
2025-03-09 07:58:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 50704 [episode count 8/20]
[retrieval_preprocessing] for episode 90643 [episode count 9/20], we have num_retrieval=np.int64(3746) num_query=np.int64(234)
2025-03-09 07:58:02,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:02,617 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:02
2025-03-09 07:58:02,617 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.93it/s]
2025-03-09 07:58:02,645 [INFO]: There are 3746 embeddings of dim 49152
2025-03-09 07:58:02,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:58:02,646 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:02
2025-03-09 07:58:02,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:02,646 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:58:02,646 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:02,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:58:02,646 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:02
2025-03-09 07:58:02,647 [INFO]: 773.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:02,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:58:02,647 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:02
2025-03-09 07:58:02,647 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:02,647 [INFO]: 	Creating the index 03/09/2025, 07:58:02
2025-03-09 07:58:02,648 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:02
2025-03-09 07:58:02,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:58:02,650 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:02
2025-03-09 07:58:02,651 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:58:02,651 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.50it/s] 20%|██        | 3/15 [00:00<00:00, 12.29it/s] 33%|███▎      | 5/15 [00:00<00:00, 13.48it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.39it/s] 60%|██████    | 9/15 [00:00<00:00, 13.36it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.00it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.92it/s]100%|██████████| 15/15 [00:03<00:00,  1.96it/s]100%|██████████| 15/15 [00:03<00:00,  3.88it/s]
2025-03-09 07:58:06,524 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:06
2025-03-09 07:58:41,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4727 secs
2025-03-09 07:58:41,997 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:58:41,997 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.30it/s]
2025-03-09 07:58:57,198 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2002 secs
2025-03-09 07:58:57,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5496 secs
2025-03-09 07:58:57,200 [INFO]: {
2025-03-09 07:58:57,201 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:57,201 [INFO]: 	index_param: efSearch=197
2025-03-09 07:58:57,201 [INFO]: 	index_path: knn.index
2025-03-09 07:58:57,201 [INFO]: 	size in bytes: 737002690
2025-03-09 07:58:57,201 [INFO]: 	avg_search_speed_ms: 9.260611097474962
2025-03-09 07:58:57,201 [INFO]: 	99p_search_speed_ms: 17.834104113280777
2025-03-09 07:58:57,201 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:57,201 [INFO]: 	nb vectors: 3746
2025-03-09 07:58:57,201 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:57,201 [INFO]: 	compression ratio: 0.9993091992649308
2025-03-09 07:58:57,201 [INFO]: }
2025-03-09 07:58:57,201 [INFO]: 	>>> Finished "Creating the index" in 54.5532 secs
2025-03-09 07:58:57,201 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5837 secs
2025-03-09 07:58:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 90643 [episode count 9/20]
[retrieval_preprocessing] for episode 30229 [episode count 10/20], we have num_retrieval=np.int64(3772) num_query=np.int64(208)
2025-03-09 07:58:59,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:00,437 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:00
2025-03-09 07:59:00,437 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.38it/s]
2025-03-09 07:59:00,464 [INFO]: There are 3772 embeddings of dim 49152
2025-03-09 07:59:00,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:59:00,464 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:00
2025-03-09 07:59:00,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:00,465 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:59:00,465 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:00,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:59:00,465 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:00
2025-03-09 07:59:00,465 [INFO]: 778.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:00,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:59:00,466 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:00
2025-03-09 07:59:00,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:00,466 [INFO]: 	Creating the index 03/09/2025, 07:59:00
2025-03-09 07:59:00,466 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:00
2025-03-09 07:59:00,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:59:00,469 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:00
2025-03-09 07:59:00,469 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:59:00,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.49it/s] 20%|██        | 3/15 [00:00<00:01, 10.07it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.17it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.78it/s] 60%|██████    | 9/15 [00:00<00:00, 12.08it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.99it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.25it/s]100%|██████████| 15/15 [00:03<00:00,  2.02it/s]100%|██████████| 15/15 [00:03<00:00,  3.90it/s]
2025-03-09 07:59:04,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:04
2025-03-09 07:59:40,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7524 secs
2025-03-09 07:59:40,076 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:59:40,076 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 08:00:00,134 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0574 secs
2025-03-09 08:00:01,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6591 secs
2025-03-09 08:00:01,129 [INFO]: {
2025-03-09 08:00:01,129 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:01,129 [INFO]: 	index_param: efSearch=189
2025-03-09 08:00:01,129 [INFO]: 	index_path: knn.index
2025-03-09 08:00:01,129 [INFO]: 	size in bytes: 742118050
2025-03-09 08:00:01,129 [INFO]: 	avg_search_speed_ms: 8.478456978592153
2025-03-09 08:00:01,129 [INFO]: 	99p_search_speed_ms: 14.923734362237157
2025-03-09 08:00:01,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:01,129 [INFO]: 	nb vectors: 3772
2025-03-09 08:00:01,129 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:01,129 [INFO]: 	compression ratio: 0.9993091745983
2025-03-09 08:00:01,129 [INFO]: }
2025-03-09 08:00:01,129 [INFO]: 	>>> Finished "Creating the index" in 60.6632 secs
2025-03-09 08:00:01,129 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6919 secs
2025-03-09 08:00:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 30229 [episode count 10/20]
[retrieval_preprocessing] for episode 57365 [episode count 11/20], we have num_retrieval=np.int64(3801) num_query=np.int64(179)
2025-03-09 08:00:03,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:04,402 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:04
2025-03-09 08:00:04,403 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.17it/s]
2025-03-09 08:00:04,429 [INFO]: There are 3801 embeddings of dim 49152
2025-03-09 08:00:04,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:00:04,430 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:04
2025-03-09 08:00:04,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:04,430 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:00:04,430 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:04,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:04,430 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:04
2025-03-09 08:00:04,430 [INFO]: 784.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:04,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:00:04,430 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:04
2025-03-09 08:00:04,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:04,430 [INFO]: 	Creating the index 03/09/2025, 08:00:04
2025-03-09 08:00:04,430 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:04
2025-03-09 08:00:04,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:00:04,431 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:04
2025-03-09 08:00:04,431 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:00:04,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.10it/s] 20%|██        | 3/15 [00:00<00:01,  8.41it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.45it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.08it/s] 60%|██████    | 9/15 [00:00<00:00, 12.60it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.63it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.40it/s]100%|██████████| 15/15 [00:04<00:00,  1.85it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-09 08:00:08,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:08
2025-03-09 08:00:52,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7204 secs
2025-03-09 08:00:52,296 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:00:52,296 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s]
2025-03-09 08:01:08,094 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7977 secs
2025-03-09 08:01:08,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6657 secs
2025-03-09 08:01:08,097 [INFO]: {
2025-03-09 08:01:08,097 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:08,097 [INFO]: 	index_param: efSearch=209
2025-03-09 08:01:08,097 [INFO]: 	index_path: knn.index
2025-03-09 08:01:08,097 [INFO]: 	size in bytes: 747823570
2025-03-09 08:01:08,097 [INFO]: 	avg_search_speed_ms: 9.560203132972863
2025-03-09 08:01:08,097 [INFO]: 	99p_search_speed_ms: 18.00161456922069
2025-03-09 08:01:08,097 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:08,097 [INFO]: 	nb vectors: 3801
2025-03-09 08:01:08,097 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:08,097 [INFO]: 	compression ratio: 0.9993092461635035
2025-03-09 08:01:08,097 [INFO]: }
2025-03-09 08:01:08,097 [INFO]: 	>>> Finished "Creating the index" in 63.6671 secs
2025-03-09 08:01:08,097 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6947 secs
2025-03-09 08:01:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 57365 [episode count 11/20]
[retrieval_preprocessing] for episode 58905 [episode count 12/20], we have num_retrieval=np.int64(3826) num_query=np.int64(154)
2025-03-09 08:01:11,082 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:11,654 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:11
2025-03-09 08:01:11,654 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2212.19it/s]
2025-03-09 08:01:11,680 [INFO]: There are 3826 embeddings of dim 49152
2025-03-09 08:01:11,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:01:11,680 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:11
2025-03-09 08:01:11,680 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:11,680 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:01:11,680 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:11,680 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:11,680 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:11
2025-03-09 08:01:11,680 [INFO]: 789.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:11,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:01:11,680 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:11
2025-03-09 08:01:11,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:11,680 [INFO]: 	Creating the index 03/09/2025, 08:01:11
2025-03-09 08:01:11,680 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:11
2025-03-09 08:01:11,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:01:11,682 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:11
2025-03-09 08:01:11,682 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:01:11,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.51it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.16it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.24it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.84it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.10it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.28it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.19it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.13it/s]100%|██████████| 16/16 [00:04<00:00,  3.90it/s]
2025-03-09 08:01:15,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:15
2025-03-09 08:02:01,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9318 secs
2025-03-09 08:02:01,722 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 08:02:01,722 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-09 08:02:17,827 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1049 secs
2025-03-09 08:02:17,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1481 secs
2025-03-09 08:02:17,830 [INFO]: {
2025-03-09 08:02:17,830 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:17,830 [INFO]: 	index_param: efSearch=168
2025-03-09 08:02:17,830 [INFO]: 	index_path: knn.index
2025-03-09 08:02:17,830 [INFO]: 	size in bytes: 752742310
2025-03-09 08:02:17,830 [INFO]: 	avg_search_speed_ms: 9.700748253077139
2025-03-09 08:02:17,830 [INFO]: 	99p_search_speed_ms: 17.13738886173815
2025-03-09 08:02:17,830 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:17,830 [INFO]: 	nb vectors: 3826
2025-03-09 08:02:17,830 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:17,830 [INFO]: 	compression ratio: 0.9993090570397192
2025-03-09 08:02:17,830 [INFO]: }
2025-03-09 08:02:17,830 [INFO]: 	>>> Finished "Creating the index" in 66.1495 secs
2025-03-09 08:02:17,830 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1764 secs
2025-03-09 08:02:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 58905 [episode count 12/20]
[retrieval_preprocessing] for episode 39964 [episode count 13/20], we have num_retrieval=np.int64(3725) num_query=np.int64(255)
2025-03-09 08:02:20,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:20,696 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:20
2025-03-09 08:02:20,696 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1616.93it/s]
2025-03-09 08:02:20,724 [INFO]: There are 3725 embeddings of dim 49152
2025-03-09 08:02:20,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:02:20,724 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:20
2025-03-09 08:02:20,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:20,724 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:02:20,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:20,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:02:20,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:20
2025-03-09 08:02:20,724 [INFO]: 768.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:20,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:02:20,724 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:20
2025-03-09 08:02:20,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:20,724 [INFO]: 	Creating the index 03/09/2025, 08:02:20
2025-03-09 08:02:20,724 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:20
2025-03-09 08:02:20,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:02:20,726 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:20
2025-03-09 08:02:20,726 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:02:20,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.44it/s] 27%|██▋       | 4/15 [00:00<00:00, 16.42it/s] 53%|█████▎    | 8/15 [00:00<00:00, 21.53it/s] 73%|███████▎  | 11/15 [00:00<00:00, 16.83it/s] 87%|████████▋ | 13/15 [00:00<00:00, 15.05it/s]100%|██████████| 15/15 [00:03<00:00,  2.10it/s]100%|██████████| 15/15 [00:03<00:00,  3.86it/s]
2025-03-09 08:02:24,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:24
2025-03-09 08:03:00,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0035 secs
2025-03-09 08:03:00,625 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 08:03:00,625 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 08:03:19,656 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0306 secs
2025-03-09 08:03:19,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9360 secs
2025-03-09 08:03:19,662 [INFO]: {
2025-03-09 08:03:19,662 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:19,662 [INFO]: 	index_param: efSearch=190
2025-03-09 08:03:19,662 [INFO]: 	index_path: knn.index
2025-03-09 08:03:19,662 [INFO]: 	size in bytes: 732870970
2025-03-09 08:03:19,662 [INFO]: 	avg_search_speed_ms: 10.41738617544373
2025-03-09 08:03:19,662 [INFO]: 	99p_search_speed_ms: 21.482985792681532
2025-03-09 08:03:19,662 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:19,663 [INFO]: 	nb vectors: 3725
2025-03-09 08:03:19,663 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:19,663 [INFO]: 	compression ratio: 0.999309332719237
2025-03-09 08:03:19,663 [INFO]: }
2025-03-09 08:03:19,663 [INFO]: 	>>> Finished "Creating the index" in 58.9383 secs
2025-03-09 08:03:19,663 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9664 secs
2025-03-09 08:03:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 39964 [episode count 13/20]
[retrieval_preprocessing] for episode 45597 [episode count 14/20], we have num_retrieval=np.int64(3816) num_query=np.int64(164)
2025-03-09 08:03:23,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:24,430 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:24
2025-03-09 08:03:24,430 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.76it/s]
2025-03-09 08:03:24,458 [INFO]: There are 3816 embeddings of dim 49152
2025-03-09 08:03:24,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:03:24,458 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:24,458 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:03:24,458 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:24,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:24,458 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,459 [INFO]: 787.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:24,459 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:03:24,459 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:24
2025-03-09 08:03:24,459 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:24,459 [INFO]: 	Creating the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,459 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:24
2025-03-09 08:03:24,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:03:24,460 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,460 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:03:24,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.52it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.10it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.39it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.61it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.86it/s] 50%|█████     | 8/16 [00:00<00:00,  9.30it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.24it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.21it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.00it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.76it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.61it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.50it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.17it/s]100%|██████████| 16/16 [00:05<00:00,  1.27s/it]100%|██████████| 16/16 [00:05<00:00,  2.78it/s]
2025-03-09 08:03:30,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:30
2025-03-09 08:04:06,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7913 secs
2025-03-09 08:04:06,017 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:04:06,017 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-09 08:04:24,169 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1523 secs
2025-03-09 08:04:24,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7118 secs
2025-03-09 08:04:24,172 [INFO]: {
2025-03-09 08:04:24,172 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:24,172 [INFO]: 	index_param: efSearch=236
2025-03-09 08:04:24,172 [INFO]: 	index_path: knn.index
2025-03-09 08:04:24,172 [INFO]: 	size in bytes: 750774850
2025-03-09 08:04:24,172 [INFO]: 	avg_search_speed_ms: 11.559686473048577
2025-03-09 08:04:24,172 [INFO]: 	99p_search_speed_ms: 24.266496244817986
2025-03-09 08:04:24,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:24,172 [INFO]: 	nb vectors: 3816
2025-03-09 08:04:24,172 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:24,172 [INFO]: 	compression ratio: 0.9993090844745266
2025-03-09 08:04:24,172 [INFO]: }
2025-03-09 08:04:24,172 [INFO]: 	>>> Finished "Creating the index" in 59.7135 secs
2025-03-09 08:04:24,172 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7419 secs
2025-03-09 08:04:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 45597 [episode count 14/20]
[retrieval_preprocessing] for episode 87587 [episode count 15/20], we have num_retrieval=np.int64(3773) num_query=np.int64(207)
2025-03-09 08:04:27,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:27,639 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:27
2025-03-09 08:04:27,639 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1587.55it/s]
2025-03-09 08:04:27,664 [INFO]: There are 3773 embeddings of dim 49152
2025-03-09 08:04:27,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:04:27,665 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:27
2025-03-09 08:04:27,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:27,665 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:04:27,665 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:27,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:27,665 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:27
2025-03-09 08:04:27,665 [INFO]: 778.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:27,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:04:27,665 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:27
2025-03-09 08:04:27,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:27,665 [INFO]: 	Creating the index 03/09/2025, 08:04:27
2025-03-09 08:04:27,665 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:27
2025-03-09 08:04:27,666 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:04:27,666 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:27
2025-03-09 08:04:27,666 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:04:27,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.13it/s] 20%|██        | 3/15 [00:00<00:01, 10.01it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.04it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.56it/s] 60%|██████    | 9/15 [00:00<00:00, 11.56it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.35it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.22it/s]100%|██████████| 15/15 [00:04<00:00,  1.61it/s]100%|██████████| 15/15 [00:04<00:00,  3.23it/s]
2025-03-09 08:04:32,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:32
2025-03-09 08:05:09,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7890 secs
2025-03-09 08:05:09,114 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 08:05:09,114 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 08:05:26,779 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6652 secs
2025-03-09 08:05:26,782 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1164 secs
2025-03-09 08:05:26,783 [INFO]: {
2025-03-09 08:05:26,783 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:26,783 [INFO]: 	index_param: efSearch=191
2025-03-09 08:05:26,783 [INFO]: 	index_path: knn.index
2025-03-09 08:05:26,783 [INFO]: 	size in bytes: 742314790
2025-03-09 08:05:26,783 [INFO]: 	avg_search_speed_ms: 8.895272406438986
2025-03-09 08:05:26,783 [INFO]: 	99p_search_speed_ms: 16.945035113021728
2025-03-09 08:05:26,783 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:26,783 [INFO]: 	nb vectors: 3773
2025-03-09 08:05:26,783 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:26,783 [INFO]: 	compression ratio: 0.9993091798696345
2025-03-09 08:05:26,783 [INFO]: }
2025-03-09 08:05:26,783 [INFO]: 	>>> Finished "Creating the index" in 59.1177 secs
2025-03-09 08:05:26,783 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1439 secs
2025-03-09 08:05:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 87587 [episode count 15/20]
[retrieval_preprocessing] for episode 66596 [episode count 16/20], we have num_retrieval=np.int64(3836) num_query=np.int64(144)
2025-03-09 08:05:29,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:29,846 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:29
2025-03-09 08:05:29,846 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1541.46it/s]
2025-03-09 08:05:29,871 [INFO]: There are 3836 embeddings of dim 49152
2025-03-09 08:05:29,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:05:29,871 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:29
2025-03-09 08:05:29,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:29,871 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:05:29,871 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:29,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:29,871 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:29
2025-03-09 08:05:29,872 [INFO]: 791.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:29,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:05:29,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:29
2025-03-09 08:05:29,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:29,872 [INFO]: 	Creating the index 03/09/2025, 08:05:29
2025-03-09 08:05:29,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:29
2025-03-09 08:05:29,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:05:29,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:29
2025-03-09 08:05:29,873 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:05:29,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.67it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.32it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.36it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.81it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.40it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.76it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.99it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.18it/s]100%|██████████| 16/16 [00:04<00:00,  3.63it/s]
2025-03-09 08:05:34,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:34
2025-03-09 08:06:11,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2133 secs
2025-03-09 08:06:11,496 [INFO]: The best hyperparameters are: efSearch=166
2025-03-09 08:06:11,496 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-09 08:06:30,583 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0872 secs
2025-03-09 08:06:30,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1004 secs
2025-03-09 08:06:30,974 [INFO]: {
2025-03-09 08:06:30,974 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:30,974 [INFO]: 	index_param: efSearch=166
2025-03-09 08:06:30,974 [INFO]: 	index_path: knn.index
2025-03-09 08:06:30,974 [INFO]: 	size in bytes: 754709890
2025-03-09 08:06:30,974 [INFO]: 	avg_search_speed_ms: 7.532129581934907
2025-03-09 08:06:30,974 [INFO]: 	99p_search_speed_ms: 13.364190072752535
2025-03-09 08:06:30,974 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:30,975 [INFO]: 	nb vectors: 3836
2025-03-09 08:06:30,975 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:30,975 [INFO]: 	compression ratio: 0.9993088708563234
2025-03-09 08:06:30,975 [INFO]: }
2025-03-09 08:06:30,975 [INFO]: 	>>> Finished "Creating the index" in 61.1028 secs
2025-03-09 08:06:30,975 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1291 secs
2025-03-09 08:06:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 66596 [episode count 16/20]
[retrieval_preprocessing] for episode 25125 [episode count 17/20], we have num_retrieval=np.int64(3824) num_query=np.int64(156)
2025-03-09 08:06:33,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:33,743 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:33
2025-03-09 08:06:33,743 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2273.34it/s]
2025-03-09 08:06:33,767 [INFO]: There are 3824 embeddings of dim 49152
2025-03-09 08:06:33,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 08:06:33,767 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:33,768 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:06:33,768 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:33,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:06:33,768 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,768 [INFO]: 789.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:33,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:06:33,768 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:33
2025-03-09 08:06:33,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:33,769 [INFO]: 	Creating the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,769 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:33
2025-03-09 08:06:33,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:06:33,772 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,772 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:06:33,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.79it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.99it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.08it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.49it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.68it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.72it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.75it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.84it/s]100%|██████████| 16/16 [00:03<00:00,  4.22it/s]
2025-03-09 08:06:37,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:37
2025-03-09 08:07:16,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1318 secs
2025-03-09 08:07:16,700 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 08:07:16,700 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 08:07:36,659 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9596 secs
2025-03-09 08:07:36,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8902 secs
2025-03-09 08:07:36,662 [INFO]: {
2025-03-09 08:07:36,662 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:36,662 [INFO]: 	index_param: efSearch=204
2025-03-09 08:07:36,662 [INFO]: 	index_path: knn.index
2025-03-09 08:07:36,662 [INFO]: 	size in bytes: 752348830
2025-03-09 08:07:36,662 [INFO]: 	avg_search_speed_ms: 9.4613711847047
2025-03-09 08:07:36,662 [INFO]: 	99p_search_speed_ms: 16.935379365459116
2025-03-09 08:07:36,662 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:36,662 [INFO]: 	nb vectors: 3824
2025-03-09 08:07:36,663 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:36,663 [INFO]: 	compression ratio: 0.999309046576174
2025-03-09 08:07:36,663 [INFO]: }
2025-03-09 08:07:36,663 [INFO]: 	>>> Finished "Creating the index" in 62.8939 secs
2025-03-09 08:07:36,663 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9198 secs
2025-03-09 08:07:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25125 [episode count 17/20]
[retrieval_preprocessing] for episode 87076 [episode count 18/20], we have num_retrieval=np.int64(3819) num_query=np.int64(161)
2025-03-09 08:07:38,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:39,593 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:39
2025-03-09 08:07:39,593 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1852.61it/s]
2025-03-09 08:07:39,618 [INFO]: There are 3819 embeddings of dim 49152
2025-03-09 08:07:39,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:07:39,618 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:39
2025-03-09 08:07:39,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:39,619 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:07:39,619 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:39,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:39,619 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:39
2025-03-09 08:07:39,619 [INFO]: 788.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:39,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:07:39,619 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:39
2025-03-09 08:07:39,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:39,619 [INFO]: 	Creating the index 03/09/2025, 08:07:39
2025-03-09 08:07:39,619 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:39
2025-03-09 08:07:39,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:07:39,620 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:39
2025-03-09 08:07:39,620 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:07:39,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.44it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.26it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.09it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.43it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.62it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.87it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.92it/s] 50%|█████     | 8/16 [00:00<00:00,  8.94it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.75it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.84it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.07it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.12it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.14it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.18it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.32it/s]100%|██████████| 16/16 [00:04<00:00,  1.11it/s]100%|██████████| 16/16 [00:04<00:00,  3.59it/s]
2025-03-09 08:07:44,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:44
2025-03-09 08:08:21,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6977 secs
2025-03-09 08:08:21,774 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:08:21,774 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 50%|█████     | 2/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-09 08:08:41,147 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3730 secs
2025-03-09 08:08:41,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5298 secs
2025-03-09 08:08:41,150 [INFO]: {
2025-03-09 08:08:41,150 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:41,150 [INFO]: 	index_param: efSearch=187
2025-03-09 08:08:41,150 [INFO]: 	index_path: knn.index
2025-03-09 08:08:41,150 [INFO]: 	size in bytes: 751365070
2025-03-09 08:08:41,150 [INFO]: 	avg_search_speed_ms: 8.957320982682033
2025-03-09 08:08:41,150 [INFO]: 	99p_search_speed_ms: 16.930188965052366
2025-03-09 08:08:41,150 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:41,150 [INFO]: 	nb vectors: 3819
2025-03-09 08:08:41,150 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:41,150 [INFO]: 	compression ratio: 0.9993091001688433
2025-03-09 08:08:41,150 [INFO]: }
2025-03-09 08:08:41,150 [INFO]: 	>>> Finished "Creating the index" in 61.5314 secs
2025-03-09 08:08:41,150 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5574 secs
2025-03-09 08:08:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 87076 [episode count 18/20]
[retrieval_preprocessing] for episode 88615 [episode count 19/20], we have num_retrieval=np.int64(3761) num_query=np.int64(219)
2025-03-09 08:08:43,468 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:44,993 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:44
2025-03-09 08:08:44,993 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-09 08:08:45,015 [INFO]: There are 3761 embeddings of dim 49152
2025-03-09 08:08:45,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 08:08:45,015 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:45,015 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:08:45,015 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:45,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:45,015 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,015 [INFO]: 776.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:45,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:45,016 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:45
2025-03-09 08:08:45,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:45,016 [INFO]: 	Creating the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,016 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:45
2025-03-09 08:08:45,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:08:45,017 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,017 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:08:45,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.99it/s] 20%|██        | 3/15 [00:00<00:01,  8.45it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.38it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.21it/s] 40%|████      | 6/15 [00:00<00:01,  8.24it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.25it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.39it/s] 60%|██████    | 9/15 [00:01<00:00,  8.26it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.25it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.23it/s] 80%|████████  | 12/15 [00:01<00:00,  8.25it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.32it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.32it/s]100%|██████████| 15/15 [00:05<00:00,  1.32s/it]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]
2025-03-09 08:08:50,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:50
2025-03-09 08:09:25,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6897 secs
2025-03-09 08:09:25,518 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 08:09:25,518 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-09 08:09:44,532 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0141 secs
2025-03-09 08:09:44,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5182 secs
2025-03-09 08:09:44,535 [INFO]: {
2025-03-09 08:09:44,535 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:44,535 [INFO]: 	index_param: efSearch=189
2025-03-09 08:09:44,535 [INFO]: 	index_path: knn.index
2025-03-09 08:09:44,535 [INFO]: 	size in bytes: 739953910
2025-03-09 08:09:44,535 [INFO]: 	avg_search_speed_ms: 8.708856550640773
2025-03-09 08:09:44,535 [INFO]: 	99p_search_speed_ms: 17.806416999083
2025-03-09 08:09:44,535 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:44,535 [INFO]: 	nb vectors: 3761
2025-03-09 08:09:44,535 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:44,535 [INFO]: 	compression ratio: 0.9993091164286165
2025-03-09 08:09:44,535 [INFO]: }
2025-03-09 08:09:44,535 [INFO]: 	>>> Finished "Creating the index" in 59.5195 secs
2025-03-09 08:09:44,535 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5421 secs
2025-03-09 08:09:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 88615 [episode count 19/20]
2025-03-09 08:09:46: [retrieval_preprocessing] finished for (1712293193, 'marker') [chosen_id count 3/10]
2025-03-09 08:09:47: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (65137982, 'block') [chosen_id count 4/10]
2025-03-09 08:09:47: [retrieval_preprocessing] we have num_total=2341 embedding_dim=49152
[retrieval_preprocessing] for episode 29698 [episode count 0/20], we have num_retrieval=np.int64(2214) num_query=np.int64(127)
2025-03-09 08:09:47,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:48,161 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:48
2025-03-09 08:09:48,161 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.79it/s]
2025-03-09 08:09:48,189 [INFO]: There are 2214 embeddings of dim 49152
2025-03-09 08:09:48,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:09:48,190 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:48
2025-03-09 08:09:48,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:48,190 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:09:48,190 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:48,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:09:48,190 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:48
2025-03-09 08:09:48,190 [INFO]: 456.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:48,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:09:48,191 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:48
2025-03-09 08:09:48,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:48,191 [INFO]: 	Creating the index 03/09/2025, 08:09:48
2025-03-09 08:09:48,191 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:48
2025-03-09 08:09:48,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:09:48,195 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:48
2025-03-09 08:09:48,195 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:09:48,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.05it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.62it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.63it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.34it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.67it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.28it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.68it/s]100%|██████████| 9/9 [00:02<00:00,  1.98it/s]100%|██████████| 9/9 [00:02<00:00,  3.50it/s]
2025-03-09 08:09:50,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:50
2025-03-09 08:10:14,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6309 secs
2025-03-09 08:10:14,405 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 08:10:14,405 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 08:10:27,742 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3375 secs
2025-03-09 08:10:27,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5493 secs
2025-03-09 08:10:27,744 [INFO]: {
2025-03-09 08:10:27,744 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:27,744 [INFO]: 	index_param: efSearch=213
2025-03-09 08:10:27,744 [INFO]: 	index_path: knn.index
2025-03-09 08:10:27,744 [INFO]: 	size in bytes: 435591070
2025-03-09 08:10:27,744 [INFO]: 	avg_search_speed_ms: 9.840299669601844
2025-03-09 08:10:27,744 [INFO]: 	99p_search_speed_ms: 14.063737937249245
2025-03-09 08:10:27,744 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:27,744 [INFO]: 	nb vectors: 2214
2025-03-09 08:10:27,744 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:27,744 [INFO]: 	compression ratio: 0.9993090813363094
2025-03-09 08:10:27,744 [INFO]: }
2025-03-09 08:10:27,744 [INFO]: 	>>> Finished "Creating the index" in 39.5529 secs
2025-03-09 08:10:27,744 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5832 secs
2025-03-09 08:10:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 29698 [episode count 0/20]
[retrieval_preprocessing] for episode 61959 [episode count 1/20], we have num_retrieval=np.int64(2231) num_query=np.int64(110)
2025-03-09 08:10:29,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:29,725 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:29
2025-03-09 08:10:29,725 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.46it/s]
2025-03-09 08:10:29,762 [INFO]: There are 2231 embeddings of dim 49152
2025-03-09 08:10:29,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-09 08:10:29,763 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:29,763 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:10:29,763 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:29,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:10:29,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,763 [INFO]: 460.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:29,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:10:29,764 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:29
2025-03-09 08:10:29,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:29,764 [INFO]: 	Creating the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,764 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:29
2025-03-09 08:10:29,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 08:10:29,766 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,766 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:10:29,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.33it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.29it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.49it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.19it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.76it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.07it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.15it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.14it/s]100%|██████████| 9/9 [00:03<00:00,  1.35it/s]100%|██████████| 9/9 [00:03<00:00,  2.84it/s]
2025-03-09 08:10:32,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:32
2025-03-09 08:11:06,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0934 secs
2025-03-09 08:11:06,037 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:11:06,037 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s]
2025-03-09 08:11:19,584 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5466 secs
2025-03-09 08:11:19,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8197 secs
2025-03-09 08:11:19,586 [INFO]: {
2025-03-09 08:11:19,586 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:19,586 [INFO]: 	index_param: efSearch=226
2025-03-09 08:11:19,586 [INFO]: 	index_path: knn.index
2025-03-09 08:11:19,586 [INFO]: 	size in bytes: 438935650
2025-03-09 08:11:19,586 [INFO]: 	avg_search_speed_ms: 10.055779792536892
2025-03-09 08:11:19,586 [INFO]: 	99p_search_speed_ms: 18.074598913080976
2025-03-09 08:11:19,586 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:19,586 [INFO]: 	nb vectors: 2231
2025-03-09 08:11:19,586 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:19,586 [INFO]: 	compression ratio: 0.9993092335972255
2025-03-09 08:11:19,586 [INFO]: }
2025-03-09 08:11:19,586 [INFO]: 	>>> Finished "Creating the index" in 49.8221 secs
2025-03-09 08:11:19,586 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8610 secs
2025-03-09 08:11:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 61959 [episode count 1/20]
[retrieval_preprocessing] for episode 16905 [episode count 2/20], we have num_retrieval=np.int64(2221) num_query=np.int64(120)
2025-03-09 08:11:21,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:21,567 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:21
2025-03-09 08:11:21,567 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 934.14it/s]
2025-03-09 08:11:21,601 [INFO]: There are 2221 embeddings of dim 49152
2025-03-09 08:11:21,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-09 08:11:21,601 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:21
2025-03-09 08:11:21,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:21,602 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:11:21,602 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:21,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:11:21,602 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:21
2025-03-09 08:11:21,602 [INFO]: 458.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:21,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:11:21,602 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:21
2025-03-09 08:11:21,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:21,602 [INFO]: 	Creating the index 03/09/2025, 08:11:21
2025-03-09 08:11:21,603 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:21
2025-03-09 08:11:21,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 08:11:21,605 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:21
2025-03-09 08:11:21,605 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:11:21,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.00it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.87it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.08it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.44it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.27it/s]100%|██████████| 9/9 [00:02<00:00,  2.01it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]
2025-03-09 08:11:24,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:24
2025-03-09 08:11:56,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7053 secs
2025-03-09 08:11:56,845 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:11:56,845 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-09 08:12:12,013 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1676 secs
2025-03-09 08:12:12,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0381 secs
2025-03-09 08:12:12,644 [INFO]: {
2025-03-09 08:12:12,644 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:12,644 [INFO]: 	index_param: efSearch=209
2025-03-09 08:12:12,644 [INFO]: 	index_path: knn.index
2025-03-09 08:12:12,644 [INFO]: 	size in bytes: 436968250
2025-03-09 08:12:12,644 [INFO]: 	avg_search_speed_ms: 9.220372413795802
2025-03-09 08:12:12,644 [INFO]: 	99p_search_speed_ms: 13.068853812292218
2025-03-09 08:12:12,644 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:12,644 [INFO]: 	nb vectors: 2221
2025-03-09 08:12:12,644 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:12,644 [INFO]: 	compression ratio: 0.9993091443142608
2025-03-09 08:12:12,644 [INFO]: }
2025-03-09 08:12:12,644 [INFO]: 	>>> Finished "Creating the index" in 51.0417 secs
2025-03-09 08:12:12,644 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0769 secs
2025-03-09 08:12:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 16905 [episode count 2/20]
[retrieval_preprocessing] for episode 95241 [episode count 3/20], we have num_retrieval=np.int64(2250) num_query=np.int64(91)
2025-03-09 08:12:14,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:14,568 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:14
2025-03-09 08:12:14,568 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 08:12:14,591 [INFO]: There are 2250 embeddings of dim 49152
2025-03-09 08:12:14,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 08:12:14,592 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:14
2025-03-09 08:12:14,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:14,592 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:12:14,592 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:14,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:14,592 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:14
2025-03-09 08:12:14,592 [INFO]: 464.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:14,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:12:14,592 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:14
2025-03-09 08:12:14,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:14,592 [INFO]: 	Creating the index 03/09/2025, 08:12:14
2025-03-09 08:12:14,592 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:14
2025-03-09 08:12:14,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:12:14,593 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:14
2025-03-09 08:12:14,593 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:12:14,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.67it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.07it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.07it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.60it/s]100%|██████████| 9/9 [00:02<00:00,  2.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.99it/s]
2025-03-09 08:12:16,859 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:16
2025-03-09 08:12:45,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1717 secs
2025-03-09 08:12:45,032 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:12:45,032 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-09 08:13:05,858 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8264 secs
2025-03-09 08:13:05,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2669 secs
2025-03-09 08:13:05,860 [INFO]: {
2025-03-09 08:13:05,860 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:05,860 [INFO]: 	index_param: efSearch=226
2025-03-09 08:13:05,860 [INFO]: 	index_path: knn.index
2025-03-09 08:13:05,860 [INFO]: 	size in bytes: 442673710
2025-03-09 08:13:05,860 [INFO]: 	avg_search_speed_ms: 11.309764770963714
2025-03-09 08:13:05,860 [INFO]: 	99p_search_speed_ms: 17.715956768952285
2025-03-09 08:13:05,860 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:05,860 [INFO]: 	nb vectors: 2250
2025-03-09 08:13:05,860 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:05,860 [INFO]: 	compression ratio: 0.9993094010484608
2025-03-09 08:13:05,860 [INFO]: }
2025-03-09 08:13:05,860 [INFO]: 	>>> Finished "Creating the index" in 51.2682 secs
2025-03-09 08:13:05,860 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2925 secs
2025-03-09 08:13:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 95241 [episode count 3/20]
[retrieval_preprocessing] for episode 15891 [episode count 4/20], we have num_retrieval=np.int64(2206) num_query=np.int64(135)
2025-03-09 08:13:07,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:07,582 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:07
2025-03-09 08:13:07,582 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1282.27it/s]
2025-03-09 08:13:07,609 [INFO]: There are 2206 embeddings of dim 49152
2025-03-09 08:13:07,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:13:07,609 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:07
2025-03-09 08:13:07,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:07,610 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:13:07,610 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:07,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:07,610 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:07
2025-03-09 08:13:07,610 [INFO]: 455.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:07,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:07,610 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:07
2025-03-09 08:13:07,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:07,610 [INFO]: 	Creating the index 03/09/2025, 08:13:07
2025-03-09 08:13:07,610 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:07
2025-03-09 08:13:07,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:13:07,611 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:07
2025-03-09 08:13:07,611 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:13:07,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.72it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.68it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.67it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.34it/s]100%|██████████| 9/9 [00:02<00:00,  2.29it/s]100%|██████████| 9/9 [00:02<00:00,  3.30it/s]
2025-03-09 08:13:10,343 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:10
2025-03-09 08:13:40,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3906 secs
2025-03-09 08:13:40,734 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:13:40,734 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-09 08:13:55,672 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9374 secs
2025-03-09 08:13:55,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2572 secs
2025-03-09 08:13:55,869 [INFO]: {
2025-03-09 08:13:55,869 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:55,869 [INFO]: 	index_param: efSearch=218
2025-03-09 08:13:55,869 [INFO]: 	index_path: knn.index
2025-03-09 08:13:55,869 [INFO]: 	size in bytes: 434017150
2025-03-09 08:13:55,869 [INFO]: 	avg_search_speed_ms: 10.776656812783491
2025-03-09 08:13:55,869 [INFO]: 	99p_search_speed_ms: 17.526086927391592
2025-03-09 08:13:55,869 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:55,869 [INFO]: 	nb vectors: 2206
2025-03-09 08:13:55,869 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:55,869 [INFO]: 	compression ratio: 0.9993090088721148
2025-03-09 08:13:55,869 [INFO]: }
2025-03-09 08:13:55,869 [INFO]: 	>>> Finished "Creating the index" in 48.2594 secs
2025-03-09 08:13:55,869 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2875 secs
2025-03-09 08:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 15891 [episode count 4/20]
[retrieval_preprocessing] for episode 45075 [episode count 5/20], we have num_retrieval=np.int64(2182) num_query=np.int64(159)
2025-03-09 08:13:57,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:57,737 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:57
2025-03-09 08:13:57,737 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2428.66it/s]
2025-03-09 08:13:57,765 [INFO]: There are 2182 embeddings of dim 49152
2025-03-09 08:13:57,765 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 08:13:57,765 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,765 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:57,765 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:13:57,765 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:57,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:13:57,765 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,765 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:57,766 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:13:57,766 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:57
2025-03-09 08:13:57,766 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:57,766 [INFO]: 	Creating the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,766 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:57
2025-03-09 08:13:57,768 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 08:13:57,768 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,768 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:13:57,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.47it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.43it/s]100%|██████████| 9/9 [00:02<00:00,  2.27it/s]100%|██████████| 9/9 [00:02<00:00,  3.28it/s]
2025-03-09 08:14:00,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:00
2025-03-09 08:14:27,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2884 secs
2025-03-09 08:14:27,802 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 08:14:27,802 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-09 08:14:43,076 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2742 secs
2025-03-09 08:14:43,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3096 secs
2025-03-09 08:14:43,078 [INFO]: {
2025-03-09 08:14:43,078 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:43,078 [INFO]: 	index_param: efSearch=243
2025-03-09 08:14:43,078 [INFO]: 	index_path: knn.index
2025-03-09 08:14:43,078 [INFO]: 	size in bytes: 429295270
2025-03-09 08:14:43,078 [INFO]: 	avg_search_speed_ms: 12.899189608231667
2025-03-09 08:14:43,078 [INFO]: 	99p_search_speed_ms: 22.801918117329475
2025-03-09 08:14:43,078 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:43,078 [INFO]: 	nb vectors: 2182
2025-03-09 08:14:43,078 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:43,078 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-09 08:14:43,078 [INFO]: }
2025-03-09 08:14:43,078 [INFO]: 	>>> Finished "Creating the index" in 45.3124 secs
2025-03-09 08:14:43,078 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3412 secs
2025-03-09 08:14:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 45075 [episode count 5/20]
[retrieval_preprocessing] for episode 43038 [episode count 6/20], we have num_retrieval=np.int64(2222) num_query=np.int64(119)
2025-03-09 08:14:45,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:45,400 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:45
2025-03-09 08:14:45,400 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.84it/s]
2025-03-09 08:14:45,425 [INFO]: There are 2222 embeddings of dim 49152
2025-03-09 08:14:45,425 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:14:45,425 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:45
2025-03-09 08:14:45,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:45,425 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:14:45,425 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:45,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:45,425 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:45
2025-03-09 08:14:45,425 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:45,426 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:45,426 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:45
2025-03-09 08:14:45,426 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:45,426 [INFO]: 	Creating the index 03/09/2025, 08:14:45
2025-03-09 08:14:45,426 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:45
2025-03-09 08:14:45,427 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:14:45,427 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:45
2025-03-09 08:14:45,427 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:14:45,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.07it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.50it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.04it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.19it/s]100%|██████████| 9/9 [00:02<00:00,  2.11it/s]100%|██████████| 9/9 [00:02<00:00,  3.16it/s]
2025-03-09 08:14:48,280 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:48
2025-03-09 08:15:18,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6263 secs
2025-03-09 08:15:18,907 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:15:18,907 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s]
2025-03-09 08:15:36,811 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9043 secs
2025-03-09 08:15:36,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3863 secs
2025-03-09 08:15:36,813 [INFO]: {
2025-03-09 08:15:36,813 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:36,814 [INFO]: 	index_param: efSearch=255
2025-03-09 08:15:36,814 [INFO]: 	index_path: knn.index
2025-03-09 08:15:36,814 [INFO]: 	size in bytes: 437164990
2025-03-09 08:15:36,814 [INFO]: 	avg_search_speed_ms: 11.596141295369417
2025-03-09 08:15:36,814 [INFO]: 	99p_search_speed_ms: 20.518192602321506
2025-03-09 08:15:36,814 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:36,814 [INFO]: 	nb vectors: 2222
2025-03-09 08:15:36,814 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:36,814 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-09 08:15:36,814 [INFO]: }
2025-03-09 08:15:36,814 [INFO]: 	>>> Finished "Creating the index" in 51.3880 secs
2025-03-09 08:15:36,814 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4139 secs
2025-03-09 08:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 43038 [episode count 6/20]
[retrieval_preprocessing] for episode 26660 [episode count 7/20], we have num_retrieval=np.int64(2222) num_query=np.int64(119)
2025-03-09 08:15:39,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:39,835 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:39
2025-03-09 08:15:39,835 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.78it/s]
2025-03-09 08:15:39,862 [INFO]: There are 2222 embeddings of dim 49152
2025-03-09 08:15:39,863 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:15:39,863 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:39
2025-03-09 08:15:39,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:39,863 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:15:39,863 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:39,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:15:39,863 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:39
2025-03-09 08:15:39,863 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:39,863 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:15:39,863 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:39
2025-03-09 08:15:39,863 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:39,863 [INFO]: 	Creating the index 03/09/2025, 08:15:39
2025-03-09 08:15:39,863 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:39
2025-03-09 08:15:39,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:15:39,865 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:39
2025-03-09 08:15:39,865 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:15:39,865 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.68it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.08it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.65it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.12it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.28it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.35it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.37it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.33it/s]100%|██████████| 9/9 [00:02<00:00,  1.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.32it/s]
2025-03-09 08:15:42,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:42
2025-03-09 08:16:16,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9888 secs
2025-03-09 08:16:16,569 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:16:16,569 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.77it/s] 50%|█████     | 2/4 [00:00<00:00,  4.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s]
2025-03-09 08:16:34,721 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1519 secs
2025-03-09 08:16:34,723 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8582 secs
2025-03-09 08:16:34,723 [INFO]: {
2025-03-09 08:16:34,723 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:34,723 [INFO]: 	index_param: efSearch=203
2025-03-09 08:16:34,723 [INFO]: 	index_path: knn.index
2025-03-09 08:16:34,723 [INFO]: 	size in bytes: 437164990
2025-03-09 08:16:34,723 [INFO]: 	avg_search_speed_ms: 10.613058243864344
2025-03-09 08:16:34,723 [INFO]: 	99p_search_speed_ms: 17.42451130878181
2025-03-09 08:16:34,723 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:34,723 [INFO]: 	nb vectors: 2222
2025-03-09 08:16:34,723 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:34,723 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-09 08:16:34,723 [INFO]: }
2025-03-09 08:16:34,723 [INFO]: 	>>> Finished "Creating the index" in 54.8598 secs
2025-03-09 08:16:34,723 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8883 secs
2025-03-09 08:16:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 26660 [episode count 7/20]
[retrieval_preprocessing] for episode 70186 [episode count 8/20], we have num_retrieval=np.int64(2233) num_query=np.int64(108)
2025-03-09 08:16:36,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:36,704 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:36
2025-03-09 08:16:36,704 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 877.84it/s]
2025-03-09 08:16:36,734 [INFO]: There are 2233 embeddings of dim 49152
2025-03-09 08:16:36,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:16:36,735 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:36
2025-03-09 08:16:36,735 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:36,735 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:16:36,735 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:36,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:16:36,735 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:36
2025-03-09 08:16:36,735 [INFO]: 460.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:36,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:16:36,736 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:36
2025-03-09 08:16:36,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:36,736 [INFO]: 	Creating the index 03/09/2025, 08:16:36
2025-03-09 08:16:36,736 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:36
2025-03-09 08:16:36,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:16:36,739 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:36
2025-03-09 08:16:36,739 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:16:36,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.63it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.93it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.09it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.61it/s]100%|██████████| 9/9 [00:02<00:00,  2.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.66it/s]
2025-03-09 08:16:39,205 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:39
2025-03-09 08:17:07,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5290 secs
2025-03-09 08:17:07,735 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:17:07,735 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-09 08:17:23,697 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9624 secs
2025-03-09 08:17:23,699 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9597 secs
2025-03-09 08:17:23,699 [INFO]: {
2025-03-09 08:17:23,699 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:23,699 [INFO]: 	index_param: efSearch=222
2025-03-09 08:17:23,699 [INFO]: 	index_path: knn.index
2025-03-09 08:17:23,699 [INFO]: 	size in bytes: 439329130
2025-03-09 08:17:23,699 [INFO]: 	avg_search_speed_ms: 11.545852076416919
2025-03-09 08:17:23,699 [INFO]: 	99p_search_speed_ms: 19.17930279858412
2025-03-09 08:17:23,699 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:23,699 [INFO]: 	nb vectors: 2233
2025-03-09 08:17:23,699 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:23,699 [INFO]: 	compression ratio: 0.9993092513578601
2025-03-09 08:17:23,699 [INFO]: }
2025-03-09 08:17:23,699 [INFO]: 	>>> Finished "Creating the index" in 46.9632 secs
2025-03-09 08:17:23,699 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9958 secs
2025-03-09 08:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 70186 [episode count 8/20]
[retrieval_preprocessing] for episode 43051 [episode count 9/20], we have num_retrieval=np.int64(2228) num_query=np.int64(113)
2025-03-09 08:17:25,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:25,373 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:25
2025-03-09 08:17:25,373 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2204.05it/s]
2025-03-09 08:17:25,397 [INFO]: There are 2228 embeddings of dim 49152
2025-03-09 08:17:25,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 08:17:25,397 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:25
2025-03-09 08:17:25,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:25,397 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:17:25,397 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:25,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:25,397 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:25
2025-03-09 08:17:25,397 [INFO]: 459.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:25,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:17:25,397 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:25
2025-03-09 08:17:25,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:25,397 [INFO]: 	Creating the index 03/09/2025, 08:17:25
2025-03-09 08:17:25,398 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:25
2025-03-09 08:17:25,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:17:25,399 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:25
2025-03-09 08:17:25,399 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:17:25,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.46it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.03it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.80it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.17it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.43it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.67it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.72it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.71it/s]100%|██████████| 9/9 [00:02<00:00,  1.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]
2025-03-09 08:17:28,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:28
2025-03-09 08:17:59,153 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0540 secs
2025-03-09 08:17:59,153 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 08:17:59,153 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 08:18:15,431 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2777 secs
2025-03-09 08:18:15,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0340 secs
2025-03-09 08:18:15,433 [INFO]: {
2025-03-09 08:18:15,433 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:15,433 [INFO]: 	index_param: efSearch=252
2025-03-09 08:18:15,433 [INFO]: 	index_path: knn.index
2025-03-09 08:18:15,433 [INFO]: 	size in bytes: 438345430
2025-03-09 08:18:15,433 [INFO]: 	avg_search_speed_ms: 11.500550507321611
2025-03-09 08:18:15,433 [INFO]: 	99p_search_speed_ms: 18.881047116592512
2025-03-09 08:18:15,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:15,433 [INFO]: 	nb vectors: 2228
2025-03-09 08:18:15,433 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:15,433 [INFO]: 	compression ratio: 0.9993092068964881
2025-03-09 08:18:15,433 [INFO]: }
2025-03-09 08:18:15,433 [INFO]: 	>>> Finished "Creating the index" in 50.0354 secs
2025-03-09 08:18:15,433 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0597 secs
2025-03-09 08:18:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 43051 [episode count 9/20]
[retrieval_preprocessing] for episode 567 [episode count 10/20], we have num_retrieval=np.int64(2241) num_query=np.int64(100)
2025-03-09 08:18:17,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:17,762 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:17
2025-03-09 08:18:17,762 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1920.47it/s]
2025-03-09 08:18:17,787 [INFO]: There are 2241 embeddings of dim 49152
2025-03-09 08:18:17,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:18:17,788 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:17
2025-03-09 08:18:17,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:17,788 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:18:17,788 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:17,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:17,788 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:17
2025-03-09 08:18:17,788 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:17,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:18:17,788 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:17
2025-03-09 08:18:17,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:17,788 [INFO]: 	Creating the index 03/09/2025, 08:18:17
2025-03-09 08:18:17,788 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:17
2025-03-09 08:18:17,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:18:17,789 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:17
2025-03-09 08:18:17,789 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:18:17,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.29it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.23it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.64it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.09it/s]100%|██████████| 9/9 [00:02<00:00,  2.91it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-09 08:18:19,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:19
2025-03-09 08:18:51,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6518 secs
2025-03-09 08:18:51,619 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:18:51,619 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 08:19:06,531 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9123 secs
2025-03-09 08:19:06,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0652 secs
2025-03-09 08:19:06,855 [INFO]: {
2025-03-09 08:19:06,855 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:06,855 [INFO]: 	index_param: efSearch=222
2025-03-09 08:19:06,855 [INFO]: 	index_path: knn.index
2025-03-09 08:19:06,855 [INFO]: 	size in bytes: 440903050
2025-03-09 08:19:06,855 [INFO]: 	avg_search_speed_ms: 11.028140609777946
2025-03-09 08:19:06,855 [INFO]: 	99p_search_speed_ms: 21.152501869946715
2025-03-09 08:19:06,855 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:06,855 [INFO]: 	nb vectors: 2241
2025-03-09 08:19:06,855 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:06,855 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-09 08:19:06,855 [INFO]: }
2025-03-09 08:19:06,855 [INFO]: 	>>> Finished "Creating the index" in 49.0674 secs
2025-03-09 08:19:06,856 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0931 secs
2025-03-09 08:19:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 567 [episode count 10/20]
[retrieval_preprocessing] for episode 4665 [episode count 11/20], we have num_retrieval=np.int64(2252) num_query=np.int64(89)
2025-03-09 08:19:08,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:09,134 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:09
2025-03-09 08:19:09,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-09 08:19:09,162 [INFO]: There are 2252 embeddings of dim 49152
2025-03-09 08:19:09,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:19:09,162 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:09
2025-03-09 08:19:09,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:09,162 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:19:09,162 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:09,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:09,162 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:09
2025-03-09 08:19:09,162 [INFO]: 464.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:09,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:19:09,162 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:09
2025-03-09 08:19:09,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:09,162 [INFO]: 	Creating the index 03/09/2025, 08:19:09
2025-03-09 08:19:09,162 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:09
2025-03-09 08:19:09,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:19:09,164 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:09
2025-03-09 08:19:09,164 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:19:09,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.92it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.47it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.01it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.29it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.65it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.75it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.77it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.81it/s]100%|██████████| 9/9 [00:02<00:00,  1.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.44it/s]
2025-03-09 08:19:11,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:11
2025-03-09 08:19:36,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2146 secs
2025-03-09 08:19:36,004 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 08:19:36,004 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-09 08:19:50,096 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0928 secs
2025-03-09 08:19:50,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9348 secs
2025-03-09 08:19:50,099 [INFO]: {
2025-03-09 08:19:50,099 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:50,099 [INFO]: 	index_param: efSearch=264
2025-03-09 08:19:50,099 [INFO]: 	index_path: knn.index
2025-03-09 08:19:50,099 [INFO]: 	size in bytes: 443067190
2025-03-09 08:19:50,099 [INFO]: 	avg_search_speed_ms: 11.33695497127913
2025-03-09 08:19:50,099 [INFO]: 	99p_search_speed_ms: 21.713692075572908
2025-03-09 08:19:50,099 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:50,099 [INFO]: 	nb vectors: 2252
2025-03-09 08:19:50,099 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:50,099 [INFO]: 	compression ratio: 0.9993094185105423
2025-03-09 08:19:50,099 [INFO]: }
2025-03-09 08:19:50,099 [INFO]: 	>>> Finished "Creating the index" in 40.9365 secs
2025-03-09 08:19:50,099 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9649 secs
2025-03-09 08:19:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 4665 [episode count 11/20]
[retrieval_preprocessing] for episode 35386 [episode count 12/20], we have num_retrieval=np.int64(2218) num_query=np.int64(123)
2025-03-09 08:19:51,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:52,184 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:52
2025-03-09 08:19:52,184 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2313.46it/s]
2025-03-09 08:19:52,207 [INFO]: There are 2218 embeddings of dim 49152
2025-03-09 08:19:52,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 08:19:52,208 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:52
2025-03-09 08:19:52,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:52,208 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:19:52,208 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:52,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:52,208 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:52
2025-03-09 08:19:52,208 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:52,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:19:52,208 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:52
2025-03-09 08:19:52,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:52,208 [INFO]: 	Creating the index 03/09/2025, 08:19:52
2025-03-09 08:19:52,208 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:52
2025-03-09 08:19:52,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:19:52,209 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:52
2025-03-09 08:19:52,209 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:19:52,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.69it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.09it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.14it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.68it/s]100%|██████████| 9/9 [00:02<00:00,  2.81it/s]100%|██████████| 9/9 [00:02<00:00,  4.01it/s]
2025-03-09 08:19:54,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:54
2025-03-09 08:20:20,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3388 secs
2025-03-09 08:20:20,798 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 08:20:20,798 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s]
2025-03-09 08:20:37,759 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9610 secs
2025-03-09 08:20:37,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5521 secs
2025-03-09 08:20:37,761 [INFO]: {
2025-03-09 08:20:37,761 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:37,761 [INFO]: 	index_param: efSearch=271
2025-03-09 08:20:37,761 [INFO]: 	index_path: knn.index
2025-03-09 08:20:37,761 [INFO]: 	size in bytes: 436378030
2025-03-09 08:20:37,761 [INFO]: 	avg_search_speed_ms: 11.625920591583519
2025-03-09 08:20:37,761 [INFO]: 	99p_search_speed_ms: 17.870062361471355
2025-03-09 08:20:37,761 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:37,761 [INFO]: 	nb vectors: 2218
2025-03-09 08:20:37,762 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:37,762 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-09 08:20:37,762 [INFO]: }
2025-03-09 08:20:37,762 [INFO]: 	>>> Finished "Creating the index" in 45.5535 secs
2025-03-09 08:20:37,762 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5775 secs
2025-03-09 08:20:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 35386 [episode count 12/20]
[retrieval_preprocessing] for episode 34380 [episode count 13/20], we have num_retrieval=np.int64(2188) num_query=np.int64(153)
2025-03-09 08:20:39,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:40,203 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:40
2025-03-09 08:20:40,203 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-09 08:20:40,236 [INFO]: There are 2188 embeddings of dim 49152
2025-03-09 08:20:40,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-09 08:20:40,237 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:40
2025-03-09 08:20:40,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:40,237 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:20:40,237 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:40,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:20:40,237 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:40
2025-03-09 08:20:40,238 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:40,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:20:40,238 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:40
2025-03-09 08:20:40,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:40,238 [INFO]: 	Creating the index 03/09/2025, 08:20:40
2025-03-09 08:20:40,238 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:40
2025-03-09 08:20:40,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 08:20:40,240 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:40
2025-03-09 08:20:40,241 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:20:40,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.36it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.11it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.16it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.27it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.21it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.25it/s]100%|██████████| 9/9 [00:02<00:00,  1.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.42it/s]
2025-03-09 08:20:42,873 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:42
2025-03-09 08:21:15,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2065 secs
2025-03-09 08:21:15,080 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 08:21:15,080 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 08:21:30,261 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1809 secs
2025-03-09 08:21:30,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0225 secs
2025-03-09 08:21:30,263 [INFO]: {
2025-03-09 08:21:30,263 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:30,263 [INFO]: 	index_param: efSearch=240
2025-03-09 08:21:30,263 [INFO]: 	index_path: knn.index
2025-03-09 08:21:30,263 [INFO]: 	size in bytes: 430475830
2025-03-09 08:21:30,263 [INFO]: 	avg_search_speed_ms: 10.74678363292513
2025-03-09 08:21:30,263 [INFO]: 	99p_search_speed_ms: 18.365754815749877
2025-03-09 08:21:30,263 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:30,263 [INFO]: 	nb vectors: 2188
2025-03-09 08:21:30,263 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:30,263 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-09 08:21:30,263 [INFO]: }
2025-03-09 08:21:30,263 [INFO]: 	>>> Finished "Creating the index" in 50.0254 secs
2025-03-09 08:21:30,263 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0607 secs
2025-03-09 08:21:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 34380 [episode count 13/20]
[retrieval_preprocessing] for episode 14934 [episode count 14/20], we have num_retrieval=np.int64(2229) num_query=np.int64(112)
2025-03-09 08:21:32,317 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:32,932 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:32
2025-03-09 08:21:32,932 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.17it/s]
2025-03-09 08:21:32,957 [INFO]: There are 2229 embeddings of dim 49152
2025-03-09 08:21:32,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:21:32,957 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:32,958 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:21:32,958 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:32,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:32,958 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,958 [INFO]: 460.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:32,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:21:32,958 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:32
2025-03-09 08:21:32,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:32,958 [INFO]: 	Creating the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,958 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:32
2025-03-09 08:21:32,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:21:32,959 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,959 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:21:32,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.26it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.09it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.92it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.46it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.81it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.09it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.00it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.99it/s]100%|██████████| 9/9 [00:02<00:00,  1.46it/s]100%|██████████| 9/9 [00:02<00:00,  3.11it/s]
2025-03-09 08:21:35,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:35
2025-03-09 08:22:06,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6638 secs
2025-03-09 08:22:06,529 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 08:22:06,530 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-09 08:22:21,693 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1631 secs
2025-03-09 08:22:21,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7352 secs
2025-03-09 08:22:21,695 [INFO]: {
2025-03-09 08:22:21,695 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:21,695 [INFO]: 	index_param: efSearch=231
2025-03-09 08:22:21,695 [INFO]: 	index_path: knn.index
2025-03-09 08:22:21,695 [INFO]: 	size in bytes: 438542170
2025-03-09 08:22:21,695 [INFO]: 	avg_search_speed_ms: 9.556542063281366
2025-03-09 08:22:21,695 [INFO]: 	99p_search_speed_ms: 12.983998116105795
2025-03-09 08:22:21,695 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:21,695 [INFO]: 	nb vectors: 2229
2025-03-09 08:22:21,695 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:21,695 [INFO]: 	compression ratio: 0.9993092158047195
2025-03-09 08:22:21,695 [INFO]: }
2025-03-09 08:22:21,695 [INFO]: 	>>> Finished "Creating the index" in 48.7369 secs
2025-03-09 08:22:21,695 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7629 secs
2025-03-09 08:22:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 14934 [episode count 14/20]
[retrieval_preprocessing] for episode 90712 [episode count 15/20], we have num_retrieval=np.int64(2216) num_query=np.int64(125)
2025-03-09 08:22:23,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:23,811 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:23
2025-03-09 08:22:23,811 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1576.81it/s]
2025-03-09 08:22:23,836 [INFO]: There are 2216 embeddings of dim 49152
2025-03-09 08:22:23,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:22:23,836 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,836 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:23,836 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:22:23,836 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:23,836 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:23,836 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,836 [INFO]: 457.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:23,836 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:23,836 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:23
2025-03-09 08:22:23,836 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:23,836 [INFO]: 	Creating the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,836 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:23
2025-03-09 08:22:23,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:22:23,837 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,837 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:22:23,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.81it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.75it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.09it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.83it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.87it/s]
2025-03-09 08:22:26,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:26
2025-03-09 08:23:00,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7086 secs
2025-03-09 08:23:00,877 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 08:23:00,877 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-09 08:23:16,647 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7694 secs
2025-03-09 08:23:16,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8118 secs
2025-03-09 08:23:16,649 [INFO]: {
2025-03-09 08:23:16,650 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:16,650 [INFO]: 	index_param: efSearch=195
2025-03-09 08:23:16,650 [INFO]: 	index_path: knn.index
2025-03-09 08:23:16,650 [INFO]: 	size in bytes: 435984550
2025-03-09 08:23:16,650 [INFO]: 	avg_search_speed_ms: 9.617367437861573
2025-03-09 08:23:16,650 [INFO]: 	99p_search_speed_ms: 16.289861449040455
2025-03-09 08:23:16,650 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:16,650 [INFO]: 	nb vectors: 2216
2025-03-09 08:23:16,650 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:16,650 [INFO]: 	compression ratio: 0.9993090993706084
2025-03-09 08:23:16,650 [INFO]: }
2025-03-09 08:23:16,650 [INFO]: 	>>> Finished "Creating the index" in 52.8135 secs
2025-03-09 08:23:16,650 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8386 secs
2025-03-09 08:23:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 90712 [episode count 15/20]
[retrieval_preprocessing] for episode 18009 [episode count 16/20], we have num_retrieval=np.int64(2228) num_query=np.int64(113)
2025-03-09 08:23:18,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:18,599 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:18
2025-03-09 08:23:18,599 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1555.75it/s]
2025-03-09 08:23:18,624 [INFO]: There are 2228 embeddings of dim 49152
2025-03-09 08:23:18,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:23:18,624 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:18,624 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:23:18,624 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:18,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:18,624 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,624 [INFO]: 459.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:18,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:23:18,624 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:18
2025-03-09 08:23:18,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:18,624 [INFO]: 	Creating the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,624 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:18
2025-03-09 08:23:18,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:23:18,625 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,625 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:23:18,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.51it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.01it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.95it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.26it/s]100%|██████████| 9/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-09 08:23:20,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:20
2025-03-09 08:23:51,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3572 secs
2025-03-09 08:23:51,127 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 08:23:51,127 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 08:24:07,530 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4020 secs
2025-03-09 08:24:07,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9061 secs
2025-03-09 08:24:07,532 [INFO]: {
2025-03-09 08:24:07,532 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:07,532 [INFO]: 	index_param: efSearch=244
2025-03-09 08:24:07,532 [INFO]: 	index_path: knn.index
2025-03-09 08:24:07,532 [INFO]: 	size in bytes: 438345430
2025-03-09 08:24:07,532 [INFO]: 	avg_search_speed_ms: 11.040297576902685
2025-03-09 08:24:07,532 [INFO]: 	99p_search_speed_ms: 18.948512349743428
2025-03-09 08:24:07,532 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:07,532 [INFO]: 	nb vectors: 2228
2025-03-09 08:24:07,532 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:07,532 [INFO]: 	compression ratio: 0.9993092068964881
2025-03-09 08:24:07,532 [INFO]: }
2025-03-09 08:24:07,532 [INFO]: 	>>> Finished "Creating the index" in 48.9074 secs
2025-03-09 08:24:07,532 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9325 secs
2025-03-09 08:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 18009 [episode count 16/20]
[retrieval_preprocessing] for episode 49771 [episode count 17/20], we have num_retrieval=np.int64(2241) num_query=np.int64(100)
2025-03-09 08:24:09,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:09,832 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:09
2025-03-09 08:24:09,832 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2535.85it/s]
2025-03-09 08:24:09,851 [INFO]: There are 2241 embeddings of dim 49152
2025-03-09 08:24:09,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0189 secs
2025-03-09 08:24:09,851 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:09,852 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:24:09,852 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:09,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:24:09,852 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,852 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:09,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:24:09,852 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:09
2025-03-09 08:24:09,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:09,852 [INFO]: 	Creating the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,852 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:09
2025-03-09 08:24:09,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:24:09,853 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,853 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:24:09,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.10it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.14it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.62it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.98it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.80it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.95it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.69it/s]
2025-03-09 08:24:12,301 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:12
2025-03-09 08:24:35,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5355 secs
2025-03-09 08:24:35,837 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 08:24:35,837 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 08:24:53,075 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2386 secs
2025-03-09 08:24:53,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2425 secs
2025-03-09 08:24:53,096 [INFO]: {
2025-03-09 08:24:53,096 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:53,096 [INFO]: 	index_param: efSearch=286
2025-03-09 08:24:53,096 [INFO]: 	index_path: knn.index
2025-03-09 08:24:53,096 [INFO]: 	size in bytes: 440903050
2025-03-09 08:24:53,096 [INFO]: 	avg_search_speed_ms: 10.469130906968077
2025-03-09 08:24:53,096 [INFO]: 	99p_search_speed_ms: 13.334901328198612
2025-03-09 08:24:53,096 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:53,096 [INFO]: 	nb vectors: 2241
2025-03-09 08:24:53,096 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:53,096 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-09 08:24:53,096 [INFO]: }
2025-03-09 08:24:53,096 [INFO]: 	>>> Finished "Creating the index" in 43.2438 secs
2025-03-09 08:24:53,096 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2635 secs
2025-03-09 08:24:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 49771 [episode count 17/20]
[retrieval_preprocessing] for episode 37487 [episode count 18/20], we have num_retrieval=np.int64(2220) num_query=np.int64(121)
2025-03-09 08:24:55,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:55,452 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:55
2025-03-09 08:24:55,452 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2341.88it/s]
2025-03-09 08:24:55,474 [INFO]: There are 2220 embeddings of dim 49152
2025-03-09 08:24:55,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 08:24:55,475 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:55
2025-03-09 08:24:55,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:55,475 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:24:55,475 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:55,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:24:55,476 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:55
2025-03-09 08:24:55,476 [INFO]: 458.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:55,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:24:55,476 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:55
2025-03-09 08:24:55,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:55,476 [INFO]: 	Creating the index 03/09/2025, 08:24:55
2025-03-09 08:24:55,476 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:55
2025-03-09 08:24:55,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:24:55,479 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:55
2025-03-09 08:24:55,479 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:24:55,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.91it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.93it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.42it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.25it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.06it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.08it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.22it/s]100%|██████████| 9/9 [00:02<00:00,  1.82it/s]100%|██████████| 9/9 [00:02<00:00,  3.73it/s]
2025-03-09 08:24:57,900 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:57
2025-03-09 08:25:32,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1699 secs
2025-03-09 08:25:32,071 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:25:32,071 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-09 08:25:46,842 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7716 secs
2025-03-09 08:25:46,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3646 secs
2025-03-09 08:25:46,844 [INFO]: {
2025-03-09 08:25:46,844 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:46,844 [INFO]: 	index_param: efSearch=217
2025-03-09 08:25:46,844 [INFO]: 	index_path: knn.index
2025-03-09 08:25:46,844 [INFO]: 	size in bytes: 436771510
2025-03-09 08:25:46,844 [INFO]: 	avg_search_speed_ms: 10.470399308793676
2025-03-09 08:25:46,844 [INFO]: 	99p_search_speed_ms: 15.84920252207667
2025-03-09 08:25:46,844 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:46,844 [INFO]: 	nb vectors: 2220
2025-03-09 08:25:46,844 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:46,844 [INFO]: 	compression ratio: 0.9993091353417259
2025-03-09 08:25:46,844 [INFO]: }
2025-03-09 08:25:46,844 [INFO]: 	>>> Finished "Creating the index" in 51.3679 secs
2025-03-09 08:25:46,844 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3919 secs
2025-03-09 08:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 37487 [episode count 18/20]
[retrieval_preprocessing] for episode 42096 [episode count 19/20], we have num_retrieval=np.int64(2237) num_query=np.int64(104)
2025-03-09 08:25:47,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:48,100 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:48
2025-03-09 08:25:48,100 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.67it/s]
2025-03-09 08:25:48,128 [INFO]: There are 2237 embeddings of dim 49152
2025-03-09 08:25:48,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 08:25:48,128 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:48
2025-03-09 08:25:48,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:48,128 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:25:48,128 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:48,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:25:48,129 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:48
2025-03-09 08:25:48,129 [INFO]: 461.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:48,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:25:48,129 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:48
2025-03-09 08:25:48,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:48,129 [INFO]: 	Creating the index 03/09/2025, 08:25:48
2025-03-09 08:25:48,129 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:48
2025-03-09 08:25:48,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:25:48,132 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:48
2025-03-09 08:25:48,133 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:25:48,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.56it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.37it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.85it/s]100%|██████████| 9/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.96it/s]
2025-03-09 08:25:50,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:50
2025-03-09 08:26:17,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7758 secs
2025-03-09 08:26:17,190 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 08:26:17,190 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 08:26:33,006 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8158 secs
2025-03-09 08:26:33,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5612 secs
2025-03-09 08:26:33,694 [INFO]: {
2025-03-09 08:26:33,694 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:33,694 [INFO]: 	index_param: efSearch=284
2025-03-09 08:26:33,694 [INFO]: 	index_path: knn.index
2025-03-09 08:26:33,694 [INFO]: 	size in bytes: 440116090
2025-03-09 08:26:33,694 [INFO]: 	avg_search_speed_ms: 11.059452949835613
2025-03-09 08:26:33,694 [INFO]: 	99p_search_speed_ms: 18.23823518585414
2025-03-09 08:26:33,695 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:33,695 [INFO]: 	nb vectors: 2237
2025-03-09 08:26:33,695 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:33,695 [INFO]: 	compression ratio: 0.9993092867838574
2025-03-09 08:26:33,695 [INFO]: }
2025-03-09 08:26:33,695 [INFO]: 	>>> Finished "Creating the index" in 45.5653 secs
2025-03-09 08:26:33,695 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5949 secs
2025-03-09 08:26:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 42096 [episode count 19/20]
2025-03-09 08:26:34: [retrieval_preprocessing] finished for (65137982, 'block') [chosen_id count 4/10]
2025-03-09 08:26:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4329524892, 'cup') [chosen_id count 5/10]
2025-03-09 08:26:36: [retrieval_preprocessing] we have num_total=2327 embedding_dim=49152
[retrieval_preprocessing] for episode 8707 [episode count 0/20], we have num_retrieval=np.int64(2172) num_query=np.int64(155)
2025-03-09 08:26:36,958 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:37,236 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:37
2025-03-09 08:26:37,237 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-09 08:26:37,261 [INFO]: There are 2172 embeddings of dim 49152
2025-03-09 08:26:37,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:26:37,261 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:37
2025-03-09 08:26:37,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:37,261 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:26:37,261 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:37,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:26:37,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:37
2025-03-09 08:26:37,262 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:37,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:26:37,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:37
2025-03-09 08:26:37,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:37,262 [INFO]: 	Creating the index 03/09/2025, 08:26:37
2025-03-09 08:26:37,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:37
2025-03-09 08:26:37,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:26:37,263 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:37
2025-03-09 08:26:37,263 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:26:37,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.13it/s] 67%|██████▋   | 6/9 [00:00<00:00, 27.20it/s]100%|██████████| 9/9 [00:01<00:00,  4.00it/s]100%|██████████| 9/9 [00:01<00:00,  4.86it/s]
2025-03-09 08:26:39,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:39
2025-03-09 08:27:03,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9151 secs
2025-03-09 08:27:03,035 [INFO]: The best hyperparameters are: efSearch=326
2025-03-09 08:27:03,035 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 08:27:17,884 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8493 secs
2025-03-09 08:27:17,886 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6226 secs
2025-03-09 08:27:17,886 [INFO]: {
2025-03-09 08:27:17,886 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:17,886 [INFO]: 	index_param: efSearch=326
2025-03-09 08:27:17,886 [INFO]: 	index_path: knn.index
2025-03-09 08:27:17,886 [INFO]: 	size in bytes: 427327810
2025-03-09 08:27:17,886 [INFO]: 	avg_search_speed_ms: 11.893483762231774
2025-03-09 08:27:17,886 [INFO]: 	99p_search_speed_ms: 20.63571987673642
2025-03-09 08:27:17,886 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:17,886 [INFO]: 	nb vectors: 2172
2025-03-09 08:27:17,886 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:17,886 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-09 08:27:17,886 [INFO]: }
2025-03-09 08:27:17,886 [INFO]: 	>>> Finished "Creating the index" in 40.6240 secs
2025-03-09 08:27:17,886 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6494 secs
2025-03-09 08:27:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 8707 [episode count 0/20]
[retrieval_preprocessing] for episode 90627 [episode count 1/20], we have num_retrieval=np.int64(2221) num_query=np.int64(106)
2025-03-09 08:27:19,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:20,241 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:20
2025-03-09 08:27:20,241 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-09 08:27:20,267 [INFO]: There are 2221 embeddings of dim 49152
2025-03-09 08:27:20,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:27:20,267 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:20
2025-03-09 08:27:20,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:20,267 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:27:20,267 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:20,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:27:20,267 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:20
2025-03-09 08:27:20,267 [INFO]: 458.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:20,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:27:20,267 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:20
2025-03-09 08:27:20,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:20,267 [INFO]: 	Creating the index 03/09/2025, 08:27:20
2025-03-09 08:27:20,267 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:20
2025-03-09 08:27:20,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:27:20,268 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:20
2025-03-09 08:27:20,268 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:27:20,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.43it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.08it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.83it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.15it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.45it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.62it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.74it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.69it/s]100%|██████████| 9/9 [00:02<00:00,  1.52it/s]100%|██████████| 9/9 [00:02<00:00,  3.19it/s]
2025-03-09 08:27:23,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:23
2025-03-09 08:27:51,323 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2261 secs
2025-03-09 08:27:51,324 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 08:27:51,324 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-09 08:28:07,186 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8618 secs
2025-03-09 08:28:07,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9191 secs
2025-03-09 08:28:07,188 [INFO]: {
2025-03-09 08:28:07,188 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:07,188 [INFO]: 	index_param: efSearch=266
2025-03-09 08:28:07,188 [INFO]: 	index_path: knn.index
2025-03-09 08:28:07,188 [INFO]: 	size in bytes: 436968250
2025-03-09 08:28:07,188 [INFO]: 	avg_search_speed_ms: 10.442974480425079
2025-03-09 08:28:07,188 [INFO]: 	99p_search_speed_ms: 16.936778835952275
2025-03-09 08:28:07,188 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:07,188 [INFO]: 	nb vectors: 2221
2025-03-09 08:28:07,188 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:07,188 [INFO]: 	compression ratio: 0.9993091443142608
2025-03-09 08:28:07,188 [INFO]: }
2025-03-09 08:28:07,188 [INFO]: 	>>> Finished "Creating the index" in 46.9204 secs
2025-03-09 08:28:07,188 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9467 secs
2025-03-09 08:28:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 90627 [episode count 1/20]
[retrieval_preprocessing] for episode 72197 [episode count 2/20], we have num_retrieval=np.int64(2222) num_query=np.int64(105)
2025-03-09 08:28:08,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:09,093 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:09
2025-03-09 08:28:09,093 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.99it/s]
2025-03-09 08:28:09,118 [INFO]: There are 2222 embeddings of dim 49152
2025-03-09 08:28:09,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:28:09,118 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:09
2025-03-09 08:28:09,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:09,118 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:28:09,118 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:09,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:09,118 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:09
2025-03-09 08:28:09,118 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:09,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:09,119 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:09
2025-03-09 08:28:09,119 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:09,119 [INFO]: 	Creating the index 03/09/2025, 08:28:09
2025-03-09 08:28:09,119 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:09
2025-03-09 08:28:09,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:28:09,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:09
2025-03-09 08:28:09,120 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:28:09,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.66it/s] 44%|████▍     | 4/9 [00:00<00:00, 16.17it/s] 67%|██████▋   | 6/9 [00:00<00:00, 16.16it/s] 89%|████████▉ | 8/9 [00:00<00:00, 14.63it/s]100%|██████████| 9/9 [00:02<00:00,  4.20it/s]
2025-03-09 08:28:11,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:11
2025-03-09 08:28:36,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2266 secs
2025-03-09 08:28:36,496 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 08:28:36,496 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s]
2025-03-09 08:28:50,821 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3245 secs
2025-03-09 08:28:50,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7024 secs
2025-03-09 08:28:50,822 [INFO]: {
2025-03-09 08:28:50,822 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:50,822 [INFO]: 	index_param: efSearch=282
2025-03-09 08:28:50,822 [INFO]: 	index_path: knn.index
2025-03-09 08:28:50,822 [INFO]: 	size in bytes: 437164990
2025-03-09 08:28:50,822 [INFO]: 	avg_search_speed_ms: 11.305722108680511
2025-03-09 08:28:50,822 [INFO]: 	99p_search_speed_ms: 19.188683736138042
2025-03-09 08:28:50,822 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:50,822 [INFO]: 	nb vectors: 2222
2025-03-09 08:28:50,822 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:50,822 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-09 08:28:50,822 [INFO]: }
2025-03-09 08:28:50,822 [INFO]: 	>>> Finished "Creating the index" in 41.7037 secs
2025-03-09 08:28:50,822 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7296 secs
2025-03-09 08:28:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 72197 [episode count 2/20]
[retrieval_preprocessing] for episode 56842 [episode count 3/20], we have num_retrieval=np.int64(2206) num_query=np.int64(121)
2025-03-09 08:28:52,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:52,542 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:52
2025-03-09 08:28:52,542 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2334.06it/s]
2025-03-09 08:28:52,568 [INFO]: There are 2206 embeddings of dim 49152
2025-03-09 08:28:52,568 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:28:52,568 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:52,568 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:28:52,568 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:52,568 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:52,568 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,568 [INFO]: 455.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:52,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:52,568 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:52
2025-03-09 08:28:52,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:52,569 [INFO]: 	Creating the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,569 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:52
2025-03-09 08:28:52,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:28:52,570 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,570 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:28:52,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.53it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.29it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.91it/s]100%|██████████| 9/9 [00:02<00:00,  3.00it/s]100%|██████████| 9/9 [00:02<00:00,  4.41it/s]
2025-03-09 08:28:54,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:54
2025-03-09 08:29:19,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1135 secs
2025-03-09 08:29:19,732 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 08:29:19,733 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-09 08:29:32,885 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1525 secs
2025-03-09 08:29:33,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.7737 secs
2025-03-09 08:29:33,344 [INFO]: {
2025-03-09 08:29:33,344 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:33,344 [INFO]: 	index_param: efSearch=309
2025-03-09 08:29:33,344 [INFO]: 	index_path: knn.index
2025-03-09 08:29:33,344 [INFO]: 	size in bytes: 434017150
2025-03-09 08:29:33,344 [INFO]: 	avg_search_speed_ms: 10.4853021350945
2025-03-09 08:29:33,344 [INFO]: 	99p_search_speed_ms: 17.840663678944125
2025-03-09 08:29:33,344 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:33,344 [INFO]: 	nb vectors: 2206
2025-03-09 08:29:33,344 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:33,344 [INFO]: 	compression ratio: 0.9993090088721148
2025-03-09 08:29:33,344 [INFO]: }
2025-03-09 08:29:33,344 [INFO]: 	>>> Finished "Creating the index" in 40.7757 secs
2025-03-09 08:29:33,344 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8022 secs
2025-03-09 08:29:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 56842 [episode count 3/20]
[retrieval_preprocessing] for episode 52755 [episode count 4/20], we have num_retrieval=np.int64(2214) num_query=np.int64(113)
2025-03-09 08:29:35,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:35,910 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:35
2025-03-09 08:29:35,910 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.85it/s]
2025-03-09 08:29:35,935 [INFO]: There are 2214 embeddings of dim 49152
2025-03-09 08:29:35,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:29:35,935 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:35
2025-03-09 08:29:35,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:35,935 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:29:35,935 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:35,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:35,935 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:35
2025-03-09 08:29:35,935 [INFO]: 456.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:35,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:29:35,935 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:35
2025-03-09 08:29:35,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:35,936 [INFO]: 	Creating the index 03/09/2025, 08:29:35
2025-03-09 08:29:35,936 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:35
2025-03-09 08:29:35,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:29:35,937 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:35
2025-03-09 08:29:35,937 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:29:35,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.54it/s] 44%|████▍     | 4/9 [00:00<00:00, 14.02it/s] 78%|███████▊  | 7/9 [00:00<00:00, 16.33it/s]100%|██████████| 9/9 [00:02<00:00,  2.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.82it/s]
2025-03-09 08:29:38,301 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:38
2025-03-09 08:30:05,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2795 secs
2025-03-09 08:30:05,582 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 08:30:05,582 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-09 08:30:19,625 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0430 secs
2025-03-09 08:30:19,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6893 secs
2025-03-09 08:30:19,626 [INFO]: {
2025-03-09 08:30:19,627 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:19,627 [INFO]: 	index_param: efSearch=268
2025-03-09 08:30:19,627 [INFO]: 	index_path: knn.index
2025-03-09 08:30:19,627 [INFO]: 	size in bytes: 435591070
2025-03-09 08:30:19,627 [INFO]: 	avg_search_speed_ms: 10.657743454775783
2025-03-09 08:30:19,627 [INFO]: 	99p_search_speed_ms: 17.331707845441997
2025-03-09 08:30:19,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:19,627 [INFO]: 	nb vectors: 2214
2025-03-09 08:30:19,627 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:19,627 [INFO]: 	compression ratio: 0.9993090813363094
2025-03-09 08:30:19,627 [INFO]: }
2025-03-09 08:30:19,627 [INFO]: 	>>> Finished "Creating the index" in 43.6907 secs
2025-03-09 08:30:19,627 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7162 secs
2025-03-09 08:30:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 52755 [episode count 4/20]
[retrieval_preprocessing] for episode 64531 [episode count 5/20], we have num_retrieval=np.int64(2248) num_query=np.int64(79)
2025-03-09 08:30:21,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:21,608 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:21
2025-03-09 08:30:21,608 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.81it/s]
2025-03-09 08:30:21,637 [INFO]: There are 2248 embeddings of dim 49152
2025-03-09 08:30:21,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 08:30:21,637 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:21
2025-03-09 08:30:21,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:21,637 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:30:21,637 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:21,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:21,637 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:21
2025-03-09 08:30:21,637 [INFO]: 463.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:21,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:30:21,637 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:21
2025-03-09 08:30:21,638 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:21,638 [INFO]: 	Creating the index 03/09/2025, 08:30:21
2025-03-09 08:30:21,638 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:21
2025-03-09 08:30:21,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:30:21,639 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:21
2025-03-09 08:30:21,639 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:30:21,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.19it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.24it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.81it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.66it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.39it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.46it/s]100%|██████████| 9/9 [00:02<00:00,  1.84it/s]100%|██████████| 9/9 [00:02<00:00,  3.63it/s]
2025-03-09 08:30:24,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:24
2025-03-09 08:30:49,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8395 secs
2025-03-09 08:30:49,965 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 08:30:49,965 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-09 08:31:06,393 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4279 secs
2025-03-09 08:31:06,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7560 secs
2025-03-09 08:31:06,395 [INFO]: {
2025-03-09 08:31:06,395 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:06,395 [INFO]: 	index_param: efSearch=309
2025-03-09 08:31:06,395 [INFO]: 	index_path: knn.index
2025-03-09 08:31:06,395 [INFO]: 	size in bytes: 442280230
2025-03-09 08:31:06,395 [INFO]: 	avg_search_speed_ms: 11.199327566935228
2025-03-09 08:31:06,395 [INFO]: 	99p_search_speed_ms: 16.72362023033202
2025-03-09 08:31:06,395 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:06,395 [INFO]: 	nb vectors: 2248
2025-03-09 08:31:06,395 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:06,395 [INFO]: 	compression ratio: 0.9993093835553084
2025-03-09 08:31:06,395 [INFO]: }
2025-03-09 08:31:06,395 [INFO]: 	>>> Finished "Creating the index" in 44.7575 secs
2025-03-09 08:31:06,395 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7867 secs
2025-03-09 08:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 64531 [episode count 5/20]
[retrieval_preprocessing] for episode 48152 [episode count 6/20], we have num_retrieval=np.int64(2215) num_query=np.int64(112)
2025-03-09 08:31:07,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:08,303 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:08
2025-03-09 08:31:08,303 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-09 08:31:08,332 [INFO]: There are 2215 embeddings of dim 49152
2025-03-09 08:31:08,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:31:08,333 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:08
2025-03-09 08:31:08,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:08,333 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:31:08,333 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:08,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:31:08,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:08
2025-03-09 08:31:08,333 [INFO]: 457.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:08,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:31:08,334 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:08
2025-03-09 08:31:08,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:08,334 [INFO]: 	Creating the index 03/09/2025, 08:31:08
2025-03-09 08:31:08,334 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:08
2025-03-09 08:31:08,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:31:08,337 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:08
2025-03-09 08:31:08,337 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:31:08,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.54it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.15it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.57it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.84it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.04it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.22it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.35it/s]100%|██████████| 9/9 [00:02<00:00,  1.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]
2025-03-09 08:31:10,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:10
2025-03-09 08:31:37,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7395 secs
2025-03-09 08:31:37,598 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 08:31:37,598 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 08:31:53,871 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2725 secs
2025-03-09 08:31:53,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5354 secs
2025-03-09 08:31:53,873 [INFO]: {
2025-03-09 08:31:53,873 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:53,873 [INFO]: 	index_param: efSearch=295
2025-03-09 08:31:53,873 [INFO]: 	index_path: knn.index
2025-03-09 08:31:53,873 [INFO]: 	size in bytes: 435787810
2025-03-09 08:31:53,873 [INFO]: 	avg_search_speed_ms: 11.891730554454966
2025-03-09 08:31:53,873 [INFO]: 	99p_search_speed_ms: 19.657833466772
2025-03-09 08:31:53,873 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:53,873 [INFO]: 	nb vectors: 2215
2025-03-09 08:31:53,873 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:53,873 [INFO]: 	compression ratio: 0.9993090903575297
2025-03-09 08:31:53,873 [INFO]: }
2025-03-09 08:31:53,873 [INFO]: 	>>> Finished "Creating the index" in 45.5387 secs
2025-03-09 08:31:53,873 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5701 secs
2025-03-09 08:31:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 48152 [episode count 6/20]
[retrieval_preprocessing] for episode 77336 [episode count 7/20], we have num_retrieval=np.int64(2088) num_query=np.int64(239)
2025-03-09 08:31:56,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:56,360 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:56
2025-03-09 08:31:56,360 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.18it/s]
2025-03-09 08:31:56,384 [INFO]: There are 2088 embeddings of dim 49152
2025-03-09 08:31:56,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:31:56,384 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:56
2025-03-09 08:31:56,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:56,384 [INFO]: 		-> Add: 1.1 seconds
2025-03-09 08:31:56,384 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:56,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:56,384 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:56
2025-03-09 08:31:56,384 [INFO]: 430.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:56,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:31:56,384 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:56
2025-03-09 08:31:56,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:56,384 [INFO]: 	Creating the index 03/09/2025, 08:31:56
2025-03-09 08:31:56,384 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:56
2025-03-09 08:31:56,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:31:56,385 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:56
2025-03-09 08:31:56,385 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:31:56,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.72it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.41it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.74it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.99it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.93it/s]100%|██████████| 9/9 [00:02<00:00,  3.20it/s]
2025-03-09 08:31:59,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:59
2025-03-09 08:32:23,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6147 secs
2025-03-09 08:32:23,819 [INFO]: The best hyperparameters are: efSearch=312
2025-03-09 08:32:23,819 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-09 08:32:38,044 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2254 secs
2025-03-09 08:32:38,607 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2215 secs
2025-03-09 08:32:38,607 [INFO]: {
2025-03-09 08:32:38,607 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:38,607 [INFO]: 	index_param: efSearch=312
2025-03-09 08:32:38,607 [INFO]: 	index_path: knn.index
2025-03-09 08:32:38,607 [INFO]: 	size in bytes: 410801350
2025-03-09 08:32:38,607 [INFO]: 	avg_search_speed_ms: 10.773511190695208
2025-03-09 08:32:38,607 [INFO]: 	99p_search_speed_ms: 17.322585862129934
2025-03-09 08:32:38,608 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:38,608 [INFO]: 	nb vectors: 2088
2025-03-09 08:32:38,608 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:38,608 [INFO]: 	compression ratio: 0.9993090431664843
2025-03-09 08:32:38,608 [INFO]: }
2025-03-09 08:32:38,608 [INFO]: 	>>> Finished "Creating the index" in 42.2234 secs
2025-03-09 08:32:38,608 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2473 secs
2025-03-09 08:32:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 77336 [episode count 7/20]
[retrieval_preprocessing] for episode 55324 [episode count 8/20], we have num_retrieval=np.int64(2228) num_query=np.int64(99)
2025-03-09 08:32:41,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:42,043 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:42
2025-03-09 08:32:42,043 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-09 08:32:42,069 [INFO]: There are 2228 embeddings of dim 49152
2025-03-09 08:32:42,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:32:42,069 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:42
2025-03-09 08:32:42,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:42,070 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:32:42,070 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:42,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:32:42,070 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:42
2025-03-09 08:32:42,070 [INFO]: 459.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:42,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:32:42,070 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:42
2025-03-09 08:32:42,070 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:42,070 [INFO]: 	Creating the index 03/09/2025, 08:32:42
2025-03-09 08:32:42,071 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:42
2025-03-09 08:32:42,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:32:42,074 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:42
2025-03-09 08:32:42,074 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:32:42,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.59it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.08it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.62it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.00it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.24it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.56it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.54it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.63it/s]
2025-03-09 08:32:44,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:44
2025-03-09 08:33:08,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9963 secs
2025-03-09 08:33:08,554 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:33:08,554 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s]
2025-03-09 08:33:23,006 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4520 secs
2025-03-09 08:33:23,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9337 secs
2025-03-09 08:33:23,007 [INFO]: {
2025-03-09 08:33:23,008 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:23,008 [INFO]: 	index_param: efSearch=263
2025-03-09 08:33:23,008 [INFO]: 	index_path: knn.index
2025-03-09 08:33:23,008 [INFO]: 	size in bytes: 438345430
2025-03-09 08:33:23,008 [INFO]: 	avg_search_speed_ms: 10.343046433214317
2025-03-09 08:33:23,008 [INFO]: 	99p_search_speed_ms: 17.902333037927754
2025-03-09 08:33:23,008 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:23,008 [INFO]: 	nb vectors: 2228
2025-03-09 08:33:23,008 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:23,008 [INFO]: 	compression ratio: 0.9993092068964881
2025-03-09 08:33:23,008 [INFO]: }
2025-03-09 08:33:23,008 [INFO]: 	>>> Finished "Creating the index" in 40.9371 secs
2025-03-09 08:33:23,008 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9649 secs
2025-03-09 08:33:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 55324 [episode count 8/20]
[retrieval_preprocessing] for episode 87069 [episode count 9/20], we have num_retrieval=np.int64(2242) num_query=np.int64(85)
2025-03-09 08:33:25,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:25,669 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:25
2025-03-09 08:33:25,669 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2232.20it/s]
2025-03-09 08:33:25,691 [INFO]: There are 2242 embeddings of dim 49152
2025-03-09 08:33:25,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 08:33:25,691 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:25
2025-03-09 08:33:25,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:25,691 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:33:25,691 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:25,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:25,691 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:25
2025-03-09 08:33:25,691 [INFO]: 462.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:25,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:33:25,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:25
2025-03-09 08:33:25,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:25,691 [INFO]: 	Creating the index 03/09/2025, 08:33:25
2025-03-09 08:33:25,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:25
2025-03-09 08:33:25,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:33:25,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:25
2025-03-09 08:33:25,692 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:33:25,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.07it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.59it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.33it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.97it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.45it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.53it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.60it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.65it/s]100%|██████████| 9/9 [00:02<00:00,  1.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.39it/s]
2025-03-09 08:33:28,353 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:28
2025-03-09 08:33:59,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8660 secs
2025-03-09 08:33:59,219 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 08:33:59,219 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-09 08:34:12,044 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8249 secs
2025-03-09 08:34:12,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3537 secs
2025-03-09 08:34:12,047 [INFO]: {
2025-03-09 08:34:12,047 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:12,047 [INFO]: 	index_param: efSearch=261
2025-03-09 08:34:12,047 [INFO]: 	index_path: knn.index
2025-03-09 08:34:12,047 [INFO]: 	size in bytes: 441099790
2025-03-09 08:34:12,047 [INFO]: 	avg_search_speed_ms: 10.790434603437685
2025-03-09 08:34:12,047 [INFO]: 	99p_search_speed_ms: 18.15501203760505
2025-03-09 08:34:12,047 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:12,047 [INFO]: 	nb vectors: 2242
2025-03-09 08:34:12,047 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:12,047 [INFO]: 	compression ratio: 0.9993093308885955
2025-03-09 08:34:12,047 [INFO]: }
2025-03-09 08:34:12,047 [INFO]: 	>>> Finished "Creating the index" in 46.3555 secs
2025-03-09 08:34:12,047 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3782 secs
2025-03-09 08:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 87069 [episode count 9/20]
[retrieval_preprocessing] for episode 11305 [episode count 10/20], we have num_retrieval=np.int64(2230) num_query=np.int64(97)
2025-03-09 08:34:13,579 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:13,870 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:13
2025-03-09 08:34:13,870 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.08it/s]
2025-03-09 08:34:13,894 [INFO]: There are 2230 embeddings of dim 49152
2025-03-09 08:34:13,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:34:13,894 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:13,894 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:34:13,894 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:13,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:13,894 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,894 [INFO]: 460.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:13,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:13,894 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:13
2025-03-09 08:34:13,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:13,894 [INFO]: 	Creating the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,894 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:13
2025-03-09 08:34:13,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:34:13,895 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,895 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:34:13,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.02it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.60it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.69it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.21it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.89it/s]
2025-03-09 08:34:16,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:16
2025-03-09 08:34:42,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2228 secs
2025-03-09 08:34:42,438 [INFO]: The best hyperparameters are: efSearch=306
2025-03-09 08:34:42,438 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-09 08:34:58,038 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6001 secs
2025-03-09 08:34:58,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1441 secs
2025-03-09 08:34:58,040 [INFO]: {
2025-03-09 08:34:58,040 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:58,040 [INFO]: 	index_param: efSearch=306
2025-03-09 08:34:58,040 [INFO]: 	index_path: knn.index
2025-03-09 08:34:58,040 [INFO]: 	size in bytes: 438738910
2025-03-09 08:34:58,040 [INFO]: 	avg_search_speed_ms: 11.369643678666431
2025-03-09 08:34:58,040 [INFO]: 	99p_search_speed_ms: 18.563030250370506
2025-03-09 08:34:58,040 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:58,040 [INFO]: 	nb vectors: 2230
2025-03-09 08:34:58,040 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:58,040 [INFO]: 	compression ratio: 0.9993092247049618
2025-03-09 08:34:58,040 [INFO]: }
2025-03-09 08:34:58,040 [INFO]: 	>>> Finished "Creating the index" in 44.1454 secs
2025-03-09 08:34:58,040 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1694 secs
2025-03-09 08:34:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 11305 [episode count 10/20]
[retrieval_preprocessing] for episode 27178 [episode count 11/20], we have num_retrieval=np.int64(2236) num_query=np.int64(91)
2025-03-09 08:34:59,737 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:00,040 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:00
2025-03-09 08:35:00,040 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.55it/s]
2025-03-09 08:35:00,065 [INFO]: There are 2236 embeddings of dim 49152
2025-03-09 08:35:00,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:35:00,065 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:00
2025-03-09 08:35:00,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:00,065 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:35:00,065 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:00,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:35:00,065 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:00
2025-03-09 08:35:00,066 [INFO]: 461.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:00,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:35:00,066 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:00
2025-03-09 08:35:00,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:00,066 [INFO]: 	Creating the index 03/09/2025, 08:35:00
2025-03-09 08:35:00,066 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:00
2025-03-09 08:35:00,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 08:35:00,069 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:00
2025-03-09 08:35:00,069 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:35:00,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.30it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.91it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.13it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.73it/s]100%|██████████| 9/9 [00:02<00:00,  2.83it/s]100%|██████████| 9/9 [00:02<00:00,  4.03it/s]
2025-03-09 08:35:02,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:02
2025-03-09 08:35:28,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6964 secs
2025-03-09 08:35:28,013 [INFO]: The best hyperparameters are: efSearch=317
2025-03-09 08:35:28,013 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-09 08:35:44,113 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1004 secs
2025-03-09 08:35:44,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0463 secs
2025-03-09 08:35:44,115 [INFO]: {
2025-03-09 08:35:44,115 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:44,115 [INFO]: 	index_param: efSearch=317
2025-03-09 08:35:44,115 [INFO]: 	index_path: knn.index
2025-03-09 08:35:44,115 [INFO]: 	size in bytes: 439919350
2025-03-09 08:35:44,115 [INFO]: 	avg_search_speed_ms: 10.074791518646816
2025-03-09 08:35:44,115 [INFO]: 	99p_search_speed_ms: 14.638371700420988
2025-03-09 08:35:44,115 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:44,115 [INFO]: 	nb vectors: 2236
2025-03-09 08:35:44,115 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:44,115 [INFO]: 	compression ratio: 0.9993092779392404
2025-03-09 08:35:44,115 [INFO]: }
2025-03-09 08:35:44,115 [INFO]: 	>>> Finished "Creating the index" in 44.0493 secs
2025-03-09 08:35:44,115 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0757 secs
2025-03-09 08:35:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 27178 [episode count 11/20]
[retrieval_preprocessing] for episode 8241 [episode count 12/20], we have num_retrieval=np.int64(2230) num_query=np.int64(97)
2025-03-09 08:35:46,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:46,324 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:46
2025-03-09 08:35:46,324 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1819.65it/s]
2025-03-09 08:35:46,348 [INFO]: There are 2230 embeddings of dim 49152
2025-03-09 08:35:46,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:35:46,348 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:46
2025-03-09 08:35:46,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:46,348 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:35:46,348 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:46,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:46,348 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:46
2025-03-09 08:35:46,348 [INFO]: 460.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:46,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:35:46,348 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:46
2025-03-09 08:35:46,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:46,348 [INFO]: 	Creating the index 03/09/2025, 08:35:46
2025-03-09 08:35:46,348 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:46
2025-03-09 08:35:46,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:35:46,350 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:46
2025-03-09 08:35:46,350 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:35:46,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.17it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.80it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.97it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.44it/s]100%|██████████| 9/9 [00:02<00:00,  3.16it/s]100%|██████████| 9/9 [00:02<00:00,  4.41it/s]
2025-03-09 08:35:48,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:48
2025-03-09 08:36:13,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8502 secs
2025-03-09 08:36:13,250 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 08:36:13,250 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-09 08:36:30,023 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7732 secs
2025-03-09 08:36:30,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7618 secs
2025-03-09 08:36:30,112 [INFO]: {
2025-03-09 08:36:30,112 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:30,112 [INFO]: 	index_param: efSearch=286
2025-03-09 08:36:30,112 [INFO]: 	index_path: knn.index
2025-03-09 08:36:30,112 [INFO]: 	size in bytes: 438738910
2025-03-09 08:36:30,112 [INFO]: 	avg_search_speed_ms: 11.631469371956015
2025-03-09 08:36:30,112 [INFO]: 	99p_search_speed_ms: 20.768868422601372
2025-03-09 08:36:30,112 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:30,113 [INFO]: 	nb vectors: 2230
2025-03-09 08:36:30,113 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:30,113 [INFO]: 	compression ratio: 0.9993092247049618
2025-03-09 08:36:30,113 [INFO]: }
2025-03-09 08:36:30,113 [INFO]: 	>>> Finished "Creating the index" in 43.7645 secs
2025-03-09 08:36:30,113 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7886 secs
2025-03-09 08:36:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 8241 [episode count 12/20]
[retrieval_preprocessing] for episode 15922 [episode count 13/20], we have num_retrieval=np.int64(2199) num_query=np.int64(128)
2025-03-09 08:36:32,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:32,610 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:32
2025-03-09 08:36:32,610 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-09 08:36:32,635 [INFO]: There are 2199 embeddings of dim 49152
2025-03-09 08:36:32,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 08:36:32,635 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:32
2025-03-09 08:36:32,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:32,635 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:36:32,635 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:32,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:32,635 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:32
2025-03-09 08:36:32,635 [INFO]: 453.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:32,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:32,636 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:32
2025-03-09 08:36:32,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:32,636 [INFO]: 	Creating the index 03/09/2025, 08:36:32
2025-03-09 08:36:32,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:32
2025-03-09 08:36:32,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:36:32,637 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:32
2025-03-09 08:36:32,637 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:36:32,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.28it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.21it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.48it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.97it/s]100%|██████████| 9/9 [00:02<00:00,  2.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.99it/s]
2025-03-09 08:36:34,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:34
2025-03-09 08:37:00,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4741 secs
2025-03-09 08:37:00,371 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 08:37:00,371 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 08:37:17,857 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4860 secs
2025-03-09 08:37:17,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2215 secs
2025-03-09 08:37:17,859 [INFO]: {
2025-03-09 08:37:17,859 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:17,859 [INFO]: 	index_param: efSearch=295
2025-03-09 08:37:17,859 [INFO]: 	index_path: knn.index
2025-03-09 08:37:17,859 [INFO]: 	size in bytes: 432639970
2025-03-09 08:37:17,859 [INFO]: 	avg_search_speed_ms: 10.408051140678118
2025-03-09 08:37:17,859 [INFO]: 	99p_search_speed_ms: 16.849126946181055
2025-03-09 08:37:17,859 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:17,859 [INFO]: 	nb vectors: 2199
2025-03-09 08:37:17,859 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:17,859 [INFO]: 	compression ratio: 0.999308945033442
2025-03-09 08:37:17,859 [INFO]: }
2025-03-09 08:37:17,859 [INFO]: 	>>> Finished "Creating the index" in 45.2230 secs
2025-03-09 08:37:17,859 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2483 secs
2025-03-09 08:37:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 15922 [episode count 13/20]
[retrieval_preprocessing] for episode 28214 [episode count 14/20], we have num_retrieval=np.int64(2211) num_query=np.int64(116)
2025-03-09 08:37:19,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:20,020 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:20
2025-03-09 08:37:20,020 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 813.32it/s]
2025-03-09 08:37:20,049 [INFO]: There are 2211 embeddings of dim 49152
2025-03-09 08:37:20,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 08:37:20,050 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:20,050 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:37:20,050 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:20,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:37:20,051 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,051 [INFO]: 456.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:20,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:37:20,051 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:20
2025-03-09 08:37:20,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:20,052 [INFO]: 	Creating the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,052 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:20
2025-03-09 08:37:20,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:37:20,055 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,055 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:37:20,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.39it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.03it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.64it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.01it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.17it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.13it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.10it/s]100%|██████████| 9/9 [00:02<00:00,  1.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.50it/s]
2025-03-09 08:37:22,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:22
2025-03-09 08:37:52,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1769 secs
2025-03-09 08:37:52,810 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 08:37:52,810 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-09 08:38:11,503 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6924 secs
2025-03-09 08:38:11,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4494 secs
2025-03-09 08:38:11,505 [INFO]: {
2025-03-09 08:38:11,505 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:11,505 [INFO]: 	index_param: efSearch=265
2025-03-09 08:38:11,505 [INFO]: 	index_path: knn.index
2025-03-09 08:38:11,505 [INFO]: 	size in bytes: 435000850
2025-03-09 08:38:11,505 [INFO]: 	avg_search_speed_ms: 9.665438909857457
2025-03-09 08:38:11,505 [INFO]: 	99p_search_speed_ms: 14.825199567712842
2025-03-09 08:38:11,505 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:11,505 [INFO]: 	nb vectors: 2211
2025-03-09 08:38:11,505 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:11,505 [INFO]: 	compression ratio: 0.9993090542236871
2025-03-09 08:38:11,505 [INFO]: }
2025-03-09 08:38:11,505 [INFO]: 	>>> Finished "Creating the index" in 51.4531 secs
2025-03-09 08:38:11,505 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4848 secs
2025-03-09 08:38:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 28214 [episode count 14/20]
[retrieval_preprocessing] for episode 19513 [episode count 15/20], we have num_retrieval=np.int64(2234) num_query=np.int64(93)
2025-03-09 08:38:13,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:13,754 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:13
2025-03-09 08:38:13,755 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1715.46it/s]
2025-03-09 08:38:13,777 [INFO]: There are 2234 embeddings of dim 49152
2025-03-09 08:38:13,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 08:38:13,778 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:13,778 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:38:13,778 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:13,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:13,778 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,778 [INFO]: 461.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:13,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:38:13,778 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:13
2025-03-09 08:38:13,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:13,778 [INFO]: 	Creating the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,778 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:13
2025-03-09 08:38:13,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 08:38:13,779 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,779 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:38:13,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.12it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.46it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.24it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.07it/s]100%|██████████| 9/9 [00:02<00:00,  4.40it/s]
2025-03-09 08:38:15,830 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:15
2025-03-09 08:38:41,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4103 secs
2025-03-09 08:38:41,241 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 08:38:41,241 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-09 08:38:59,705 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4632 secs
2025-03-09 08:38:59,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9271 secs
2025-03-09 08:38:59,706 [INFO]: {
2025-03-09 08:38:59,706 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:59,706 [INFO]: 	index_param: efSearch=269
2025-03-09 08:38:59,706 [INFO]: 	index_path: knn.index
2025-03-09 08:38:59,706 [INFO]: 	size in bytes: 439525870
2025-03-09 08:38:59,706 [INFO]: 	avg_search_speed_ms: 10.551135780246543
2025-03-09 08:38:59,706 [INFO]: 	99p_search_speed_ms: 19.071013955399394
2025-03-09 08:38:59,706 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:59,706 [INFO]: 	nb vectors: 2234
2025-03-09 08:38:59,706 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:59,706 [INFO]: 	compression ratio: 0.9993092602262524
2025-03-09 08:38:59,706 [INFO]: }
2025-03-09 08:38:59,706 [INFO]: 	>>> Finished "Creating the index" in 45.9284 secs
2025-03-09 08:38:59,706 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9519 secs
2025-03-09 08:39:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 19513 [episode count 15/20]
[retrieval_preprocessing] for episode 28219 [episode count 16/20], we have num_retrieval=np.int64(2195) num_query=np.int64(132)
2025-03-09 08:39:01,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:02,003 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:02
2025-03-09 08:39:02,004 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.80it/s]
2025-03-09 08:39:02,028 [INFO]: There are 2195 embeddings of dim 49152
2025-03-09 08:39:02,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:39:02,028 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:02
2025-03-09 08:39:02,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:02,029 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:39:02,029 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:02,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:02,029 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:02
2025-03-09 08:39:02,029 [INFO]: 453.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:02,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:02,029 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:02
2025-03-09 08:39:02,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:02,029 [INFO]: 	Creating the index 03/09/2025, 08:39:02
2025-03-09 08:39:02,029 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:02
2025-03-09 08:39:02,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:39:02,030 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:02
2025-03-09 08:39:02,030 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:39:02,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.91it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.26it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.86it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.44it/s]100%|██████████| 9/9 [00:02<00:00,  2.76it/s]100%|██████████| 9/9 [00:02<00:00,  3.95it/s]
2025-03-09 08:39:04,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:04
2025-03-09 08:39:30,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2484 secs
2025-03-09 08:39:30,562 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 08:39:30,563 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 08:39:48,938 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3750 secs
2025-03-09 08:39:48,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9095 secs
2025-03-09 08:39:48,939 [INFO]: {
2025-03-09 08:39:48,939 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:48,939 [INFO]: 	index_param: efSearch=262
2025-03-09 08:39:48,939 [INFO]: 	index_path: knn.index
2025-03-09 08:39:48,940 [INFO]: 	size in bytes: 431853010
2025-03-09 08:39:48,940 [INFO]: 	avg_search_speed_ms: 9.780570412216706
2025-03-09 08:39:48,940 [INFO]: 	99p_search_speed_ms: 17.593944985419512
2025-03-09 08:39:48,940 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:48,940 [INFO]: 	nb vectors: 2195
2025-03-09 08:39:48,940 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:48,940 [INFO]: 	compression ratio: 0.9993089083713924
2025-03-09 08:39:48,940 [INFO]: }
2025-03-09 08:39:48,940 [INFO]: 	>>> Finished "Creating the index" in 46.9107 secs
2025-03-09 08:39:48,940 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9361 secs
2025-03-09 08:39:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 28219 [episode count 16/20]
[retrieval_preprocessing] for episode 63547 [episode count 17/20], we have num_retrieval=np.int64(2242) num_query=np.int64(85)
2025-03-09 08:39:51,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:51,797 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:51
2025-03-09 08:39:51,797 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.47it/s]
2025-03-09 08:39:51,824 [INFO]: There are 2242 embeddings of dim 49152
2025-03-09 08:39:51,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:39:51,825 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:51
2025-03-09 08:39:51,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:51,825 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:39:51,825 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:51,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:51,825 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:51
2025-03-09 08:39:51,825 [INFO]: 462.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:51,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:39:51,825 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:51
2025-03-09 08:39:51,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:51,825 [INFO]: 	Creating the index 03/09/2025, 08:39:51
2025-03-09 08:39:51,825 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:51
2025-03-09 08:39:51,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:39:51,827 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:51
2025-03-09 08:39:51,827 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:39:51,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.83it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.38it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.30it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.30it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.06it/s]
2025-03-09 08:39:54,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:54
2025-03-09 08:40:19,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0846 secs
2025-03-09 08:40:19,138 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 08:40:19,138 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-09 08:40:37,488 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3499 secs
2025-03-09 08:40:37,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6632 secs
2025-03-09 08:40:37,490 [INFO]: {
2025-03-09 08:40:37,490 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:37,490 [INFO]: 	index_param: efSearch=339
2025-03-09 08:40:37,490 [INFO]: 	index_path: knn.index
2025-03-09 08:40:37,490 [INFO]: 	size in bytes: 441099790
2025-03-09 08:40:37,490 [INFO]: 	avg_search_speed_ms: 11.220057743970477
2025-03-09 08:40:37,490 [INFO]: 	99p_search_speed_ms: 17.95256279874594
2025-03-09 08:40:37,490 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:37,490 [INFO]: 	nb vectors: 2242
2025-03-09 08:40:37,490 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:37,490 [INFO]: 	compression ratio: 0.9993093308885955
2025-03-09 08:40:37,490 [INFO]: }
2025-03-09 08:40:37,490 [INFO]: 	>>> Finished "Creating the index" in 45.6647 secs
2025-03-09 08:40:37,490 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6933 secs
2025-03-09 08:40:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 63547 [episode count 17/20]
[retrieval_preprocessing] for episode 93247 [episode count 18/20], we have num_retrieval=np.int64(2191) num_query=np.int64(136)
2025-03-09 08:40:39,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:39,480 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:39
2025-03-09 08:40:39,480 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1873.29it/s]
2025-03-09 08:40:39,504 [INFO]: There are 2191 embeddings of dim 49152
2025-03-09 08:40:39,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 08:40:39,504 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:39
2025-03-09 08:40:39,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:39,504 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:40:39,504 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:39,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:40:39,504 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:39
2025-03-09 08:40:39,504 [INFO]: 452.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:39,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:40:39,504 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:39
2025-03-09 08:40:39,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:39,504 [INFO]: 	Creating the index 03/09/2025, 08:40:39
2025-03-09 08:40:39,504 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:39
2025-03-09 08:40:39,505 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:40:39,505 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:39
2025-03-09 08:40:39,505 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:40:39,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.36it/s] 33%|███▎      | 3/9 [00:00<00:00, 12.92it/s] 67%|██████▋   | 6/9 [00:00<00:00, 16.31it/s] 89%|████████▉ | 8/9 [00:00<00:00, 13.99it/s]100%|██████████| 9/9 [00:01<00:00,  4.70it/s]
2025-03-09 08:40:41,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:41
2025-03-09 08:41:07,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1853 secs
2025-03-09 08:41:07,609 [INFO]: The best hyperparameters are: efSearch=314
2025-03-09 08:41:07,610 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-09 08:41:24,656 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0458 secs
2025-03-09 08:41:24,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1518 secs
2025-03-09 08:41:24,657 [INFO]: {
2025-03-09 08:41:24,657 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:24,657 [INFO]: 	index_param: efSearch=314
2025-03-09 08:41:24,657 [INFO]: 	index_path: knn.index
2025-03-09 08:41:24,657 [INFO]: 	size in bytes: 431066050
2025-03-09 08:41:24,657 [INFO]: 	avg_search_speed_ms: 11.589557593709952
2025-03-09 08:41:24,657 [INFO]: 	99p_search_speed_ms: 24.15927045047283
2025-03-09 08:41:24,657 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:24,658 [INFO]: 	nb vectors: 2191
2025-03-09 08:41:24,658 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:24,658 [INFO]: 	compression ratio: 0.9993088715754813
2025-03-09 08:41:24,658 [INFO]: }
2025-03-09 08:41:24,658 [INFO]: 	>>> Finished "Creating the index" in 45.1531 secs
2025-03-09 08:41:24,658 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1776 secs
2025-03-09 08:41:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 93247 [episode count 18/20]
[retrieval_preprocessing] for episode 70721 [episode count 19/20], we have num_retrieval=np.int64(2189) num_query=np.int64(138)
2025-03-09 08:41:26,553 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:26,852 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:26
2025-03-09 08:41:26,852 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-09 08:41:26,887 [INFO]: There are 2189 embeddings of dim 49152
2025-03-09 08:41:26,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-09 08:41:26,888 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:26
2025-03-09 08:41:26,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:26,888 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 08:41:26,888 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:26,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:41:26,888 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:26
2025-03-09 08:41:26,888 [INFO]: 451.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:26,888 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:41:26,888 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:26
2025-03-09 08:41:26,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:26,888 [INFO]: 	Creating the index 03/09/2025, 08:41:26
2025-03-09 08:41:26,888 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:26
2025-03-09 08:41:26,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 08:41:26,890 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:26
2025-03-09 08:41:26,890 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:41:26,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.66it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.87it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.04it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.21it/s]100%|██████████| 9/9 [00:02<00:00,  2.81it/s]100%|██████████| 9/9 [00:02<00:00,  4.01it/s]
2025-03-09 08:41:29,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:29
2025-03-09 08:41:56,448 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3077 secs
2025-03-09 08:41:56,448 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 08:41:56,449 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 08:42:15,238 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7897 secs
2025-03-09 08:42:15,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3497 secs
2025-03-09 08:42:15,240 [INFO]: {
2025-03-09 08:42:15,240 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:15,240 [INFO]: 	index_param: efSearch=274
2025-03-09 08:42:15,240 [INFO]: 	index_path: knn.index
2025-03-09 08:42:15,240 [INFO]: 	size in bytes: 430672570
2025-03-09 08:42:15,240 [INFO]: 	avg_search_speed_ms: 10.236917780197494
2025-03-09 08:42:15,240 [INFO]: 	99p_search_speed_ms: 18.271092735230923
2025-03-09 08:42:15,240 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:15,240 [INFO]: 	nb vectors: 2189
2025-03-09 08:42:15,240 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:15,240 [INFO]: 	compression ratio: 0.9993088531270984
2025-03-09 08:42:15,240 [INFO]: }
2025-03-09 08:42:15,240 [INFO]: 	>>> Finished "Creating the index" in 48.3518 secs
2025-03-09 08:42:15,240 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3879 secs
2025-03-09 08:42:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 70721 [episode count 19/20]
2025-03-09 08:42:16: [retrieval_preprocessing] finished for (4329524892, 'cup') [chosen_id count 5/10]
2025-03-09 08:42:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (484659531, 'marker') [chosen_id count 6/10]
2025-03-09 08:42:19: [retrieval_preprocessing] we have num_total=5326 embedding_dim=49152
[retrieval_preprocessing] for episode 81920 [episode count 0/20], we have num_retrieval=np.int64(5071) num_query=np.int64(255)
2025-03-09 08:42:20,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:21,313 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:21
2025-03-09 08:42:21,313 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2234.58it/s]
2025-03-09 08:42:21,338 [INFO]: There are 5071 embeddings of dim 49152
2025-03-09 08:42:21,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:42:21,338 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:21
2025-03-09 08:42:21,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:21,338 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:42:21,338 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:21,338 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:21,338 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:21
2025-03-09 08:42:21,338 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:21,338 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:42:21,338 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:21
2025-03-09 08:42:21,338 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:21,338 [INFO]: 	Creating the index 03/09/2025, 08:42:21
2025-03-09 08:42:21,338 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:21
2025-03-09 08:42:21,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:42:21,339 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:21
2025-03-09 08:42:21,340 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:42:21,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.76it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.04it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.28it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.10it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.91it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.57it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.51it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.12it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.02it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.78it/s]100%|██████████| 20/20 [00:05<00:00,  3.80it/s]
2025-03-09 08:42:26,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:26
2025-03-09 08:43:10,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9970 secs
2025-03-09 08:43:10,608 [INFO]: The best hyperparameters are: efSearch=142
2025-03-09 08:43:10,608 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-09 08:43:29,200 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5912 secs
2025-03-09 08:43:29,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8645 secs
2025-03-09 08:43:29,204 [INFO]: {
2025-03-09 08:43:29,204 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:29,204 [INFO]: 	index_param: efSearch=142
2025-03-09 08:43:29,204 [INFO]: 	index_path: knn.index
2025-03-09 08:43:29,204 [INFO]: 	size in bytes: 997689070
2025-03-09 08:43:29,204 [INFO]: 	avg_search_speed_ms: 6.848556243763497
2025-03-09 08:43:29,204 [INFO]: 	99p_search_speed_ms: 13.627386903390297
2025-03-09 08:43:29,204 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:29,204 [INFO]: 	nb vectors: 5071
2025-03-09 08:43:29,204 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:29,204 [INFO]: 	compression ratio: 0.9993084999918862
2025-03-09 08:43:29,204 [INFO]: }
2025-03-09 08:43:29,204 [INFO]: 	>>> Finished "Creating the index" in 67.8661 secs
2025-03-09 08:43:29,204 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8914 secs
2025-03-09 08:43:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 81920 [episode count 0/20]
[retrieval_preprocessing] for episode 32264 [episode count 1/20], we have num_retrieval=np.int64(5047) num_query=np.int64(279)
2025-03-09 08:43:32,702 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:33,351 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:33
2025-03-09 08:43:33,352 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.69it/s]
2025-03-09 08:43:33,378 [INFO]: There are 5047 embeddings of dim 49152
2025-03-09 08:43:33,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:43:33,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:33
2025-03-09 08:43:33,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:33,378 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:43:33,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:33,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:43:33,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:33
2025-03-09 08:43:33,378 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:33,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:43:33,379 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:33
2025-03-09 08:43:33,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:33,379 [INFO]: 	Creating the index 03/09/2025, 08:43:33
2025-03-09 08:43:33,379 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:33
2025-03-09 08:43:33,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:43:33,380 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:33
2025-03-09 08:43:33,380 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:43:33,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.08it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.50it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.60it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.16it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.30it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.45it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.64it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.59it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.67it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.76it/s]100%|██████████| 20/20 [00:05<00:00,  3.66it/s]
2025-03-09 08:43:38,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:38
2025-03-09 08:44:29,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1804 secs
2025-03-09 08:44:29,033 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 08:44:29,033 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-09 08:44:53,583 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5494 secs
2025-03-09 08:44:53,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.2058 secs
2025-03-09 08:44:53,586 [INFO]: {
2025-03-09 08:44:53,586 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:53,586 [INFO]: 	index_param: efSearch=211
2025-03-09 08:44:53,586 [INFO]: 	index_path: knn.index
2025-03-09 08:44:53,586 [INFO]: 	size in bytes: 992967250
2025-03-09 08:44:53,586 [INFO]: 	avg_search_speed_ms: 9.59763075730043
2025-03-09 08:44:53,586 [INFO]: 	99p_search_speed_ms: 17.390035493299365
2025-03-09 08:44:53,586 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:53,586 [INFO]: 	nb vectors: 5047
2025-03-09 08:44:53,586 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:53,586 [INFO]: 	compression ratio: 0.9993084625902818
2025-03-09 08:44:53,586 [INFO]: }
2025-03-09 08:44:53,586 [INFO]: 	>>> Finished "Creating the index" in 80.2075 secs
2025-03-09 08:44:53,586 [INFO]: >>> Finished "Launching the whole pipeline" in 80.2349 secs
2025-03-09 08:44:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 32264 [episode count 1/20]
[retrieval_preprocessing] for episode 90635 [episode count 2/20], we have num_retrieval=np.int64(5141) num_query=np.int64(185)
2025-03-09 08:44:57,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:57,730 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:57
2025-03-09 08:44:57,730 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1655.86it/s]
2025-03-09 08:44:57,755 [INFO]: There are 5141 embeddings of dim 49152
2025-03-09 08:44:57,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:44:57,755 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,755 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:57,755 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:44:57,755 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:57,755 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:44:57,755 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,755 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:57,755 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:44:57,755 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:57
2025-03-09 08:44:57,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:57,755 [INFO]: 	Creating the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,755 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:57
2025-03-09 08:44:57,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:44:57,757 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,757 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:44:57,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:05,  4.07it/s]  9%|▉         | 2/22 [00:00<00:03,  5.87it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.98it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.50it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.84it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.22it/s] 41%|████      | 9/22 [00:01<00:01,  9.02it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.23it/s] 50%|█████     | 11/22 [00:01<00:01,  9.02it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.19it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.40it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.30it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.18it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.06it/s] 77%|███████▋  | 17/22 [00:01<00:00,  8.91it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.81it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.79it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.68it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.47s/it]100%|██████████| 22/22 [00:07<00:00,  1.28s/it]100%|██████████| 22/22 [00:07<00:00,  2.82it/s]
2025-03-09 08:45:05,556 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:05
2025-03-09 08:45:56,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.5169 secs
2025-03-09 08:45:56,073 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 08:45:56,074 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 08:46:17,347 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2731 secs
2025-03-09 08:46:17,347 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5901 secs
2025-03-09 08:46:17,347 [INFO]: {
2025-03-09 08:46:17,347 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:17,347 [INFO]: 	index_param: efSearch=243
2025-03-09 08:46:17,347 [INFO]: 	index_path: knn.index
2025-03-09 08:46:17,347 [INFO]: 	size in bytes: 1011461170
2025-03-09 08:46:17,347 [INFO]: 	avg_search_speed_ms: 10.586447052401367
2025-03-09 08:46:17,347 [INFO]: 	99p_search_speed_ms: 18.61009032465516
2025-03-09 08:46:17,347 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:17,347 [INFO]: 	nb vectors: 5141
2025-03-09 08:46:17,347 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:17,347 [INFO]: 	compression ratio: 0.9993084835871653
2025-03-09 08:46:17,347 [INFO]: }
2025-03-09 08:46:17,347 [INFO]: 	>>> Finished "Creating the index" in 79.5918 secs
2025-03-09 08:46:17,347 [INFO]: >>> Finished "Launching the whole pipeline" in 79.6174 secs
2025-03-09 08:46:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 90635 [episode count 2/20]
[retrieval_preprocessing] for episode 73749 [episode count 3/20], we have num_retrieval=np.int64(5076) num_query=np.int64(250)
2025-03-09 08:46:21,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:21,824 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:21
2025-03-09 08:46:21,824 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2334.06it/s]
2025-03-09 08:46:21,848 [INFO]: There are 5076 embeddings of dim 49152
2025-03-09 08:46:21,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 08:46:21,848 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:21
2025-03-09 08:46:21,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:21,848 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:46:21,848 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:21,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:21,848 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:21
2025-03-09 08:46:21,848 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:21,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:21,849 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:21
2025-03-09 08:46:21,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:21,849 [INFO]: 	Creating the index 03/09/2025, 08:46:21
2025-03-09 08:46:21,849 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:21
2025-03-09 08:46:21,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:46:21,850 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:21
2025-03-09 08:46:21,850 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:46:21,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.21it/s] 10%|█         | 2/20 [00:00<00:02,  6.93it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.84it/s] 20%|██        | 4/20 [00:00<00:01,  8.21it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.40it/s] 30%|███       | 6/20 [00:00<00:01,  8.49it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.62it/s] 40%|████      | 8/20 [00:00<00:01,  8.82it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.69it/s] 50%|█████     | 10/20 [00:01<00:01,  8.54it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.44it/s] 60%|██████    | 12/20 [00:01<00:00,  8.38it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.31it/s] 70%|███████   | 14/20 [00:01<00:00,  8.43it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.48it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.69it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.43it/s]100%|██████████| 20/20 [00:06<00:00,  3.13it/s]
2025-03-09 08:46:28,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:28
2025-03-09 08:47:16,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4805 secs
2025-03-09 08:47:16,733 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 08:47:16,733 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-09 08:47:41,066 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3335 secs
2025-03-09 08:47:41,070 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2204 secs
2025-03-09 08:47:41,070 [INFO]: {
2025-03-09 08:47:41,070 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:41,070 [INFO]: 	index_param: efSearch=225
2025-03-09 08:47:41,070 [INFO]: 	index_path: knn.index
2025-03-09 08:47:41,070 [INFO]: 	size in bytes: 998672770
2025-03-09 08:47:41,070 [INFO]: 	avg_search_speed_ms: 10.375255734284885
2025-03-09 08:47:41,070 [INFO]: 	99p_search_speed_ms: 19.78558000177145
2025-03-09 08:47:41,070 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:41,070 [INFO]: 	nb vectors: 5076
2025-03-09 08:47:41,070 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:41,070 [INFO]: 	compression ratio: 0.9993085202473279
2025-03-09 08:47:41,070 [INFO]: }
2025-03-09 08:47:41,070 [INFO]: 	>>> Finished "Creating the index" in 79.2218 secs
2025-03-09 08:47:41,070 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2463 secs
2025-03-09 08:47:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 73749 [episode count 3/20]
[retrieval_preprocessing] for episode 19994 [episode count 4/20], we have num_retrieval=np.int64(5095) num_query=np.int64(231)
2025-03-09 08:47:45,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:45,855 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:45
2025-03-09 08:47:45,855 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1899.59it/s]
2025-03-09 08:47:45,880 [INFO]: There are 5095 embeddings of dim 49152
2025-03-09 08:47:45,880 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:47:45,880 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:45
2025-03-09 08:47:45,880 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:45,880 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:47:45,880 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:45,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:45,880 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:45
2025-03-09 08:47:45,880 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:45,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:47:45,880 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:45
2025-03-09 08:47:45,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:45,880 [INFO]: 	Creating the index 03/09/2025, 08:47:45
2025-03-09 08:47:45,880 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:45
2025-03-09 08:47:45,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:47:45,881 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:45
2025-03-09 08:47:45,881 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:47:45,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.62it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.87it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.60it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.68it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.71it/s] 41%|████      | 9/22 [00:00<00:01,  9.86it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.89it/s] 50%|█████     | 11/22 [00:01<00:01,  9.88it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.62it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.90it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.34it/s] 86%|████████▋ | 19/22 [00:01<00:00,  9.95it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.33it/s]100%|██████████| 22/22 [00:06<00:00,  1.38it/s]100%|██████████| 22/22 [00:06<00:00,  3.24it/s]
2025-03-09 08:47:52,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:52
2025-03-09 08:48:38,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7366 secs
2025-03-09 08:48:38,403 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 08:48:38,403 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 08:49:01,210 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8066 secs
2025-03-09 08:49:01,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3292 secs
2025-03-09 08:49:01,210 [INFO]: {
2025-03-09 08:49:01,210 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:01,210 [INFO]: 	index_param: efSearch=256
2025-03-09 08:49:01,210 [INFO]: 	index_path: knn.index
2025-03-09 08:49:01,210 [INFO]: 	size in bytes: 1002410890
2025-03-09 08:49:01,210 [INFO]: 	avg_search_speed_ms: 12.211075668768366
2025-03-09 08:49:01,211 [INFO]: 	99p_search_speed_ms: 20.62015233095735
2025-03-09 08:49:01,211 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:01,211 [INFO]: 	nb vectors: 5095
2025-03-09 08:49:01,211 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:01,211 [INFO]: 	compression ratio: 0.9993085370411329
2025-03-09 08:49:01,211 [INFO]: }
2025-03-09 08:49:01,211 [INFO]: 	>>> Finished "Creating the index" in 75.3304 secs
2025-03-09 08:49:01,211 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3555 secs
2025-03-09 08:49:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 19994 [episode count 4/20]
[retrieval_preprocessing] for episode 30235 [episode count 5/20], we have num_retrieval=np.int64(5024) num_query=np.int64(302)
2025-03-09 08:49:05,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:06,820 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:06
2025-03-09 08:49:06,820 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2377.72it/s]
2025-03-09 08:49:06,848 [INFO]: There are 5024 embeddings of dim 49152
2025-03-09 08:49:06,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:49:06,848 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:06
2025-03-09 08:49:06,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:06,848 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:49:06,848 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:06,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:49:06,848 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:06
2025-03-09 08:49:06,849 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:06,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:49:06,849 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:06
2025-03-09 08:49:06,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:06,849 [INFO]: 	Creating the index 03/09/2025, 08:49:06
2025-03-09 08:49:06,849 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:06
2025-03-09 08:49:06,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 08:49:06,852 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:06
2025-03-09 08:49:06,852 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:49:06,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.52it/s] 10%|█         | 2/20 [00:00<00:02,  7.47it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.25it/s] 20%|██        | 4/20 [00:00<00:01,  8.43it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.48it/s] 30%|███       | 6/20 [00:00<00:01,  8.57it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.79it/s] 40%|████      | 8/20 [00:00<00:01,  8.81it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.78it/s] 50%|█████     | 10/20 [00:01<00:01,  8.83it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.83it/s] 60%|██████    | 12/20 [00:01<00:00,  8.91it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.86it/s] 70%|███████   | 14/20 [00:01<00:00,  8.80it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s] 80%|████████  | 16/20 [00:01<00:00,  8.77it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.81it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.94it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.01it/s]100%|██████████| 20/20 [00:05<00:00,  1.20s/it]100%|██████████| 20/20 [00:05<00:00,  3.36it/s]
2025-03-09 08:49:12,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:12
2025-03-09 08:50:00,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3426 secs
2025-03-09 08:50:00,153 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:50:00,153 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-09 08:50:20,184 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0316 secs
2025-03-09 08:50:20,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3369 secs
2025-03-09 08:50:20,189 [INFO]: {
2025-03-09 08:50:20,189 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:20,189 [INFO]: 	index_param: efSearch=247
2025-03-09 08:50:20,189 [INFO]: 	index_path: knn.index
2025-03-09 08:50:20,189 [INFO]: 	size in bytes: 988442110
2025-03-09 08:50:20,189 [INFO]: 	avg_search_speed_ms: 12.440695978159
2025-03-09 08:50:20,189 [INFO]: 	99p_search_speed_ms: 20.223150488454856
2025-03-09 08:50:20,189 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:20,189 [INFO]: 	nb vectors: 5024
2025-03-09 08:50:20,189 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:20,189 [INFO]: 	compression ratio: 0.9993084895988497
2025-03-09 08:50:20,189 [INFO]: }
2025-03-09 08:50:20,189 [INFO]: 	>>> Finished "Creating the index" in 73.3398 secs
2025-03-09 08:50:20,189 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3685 secs
2025-03-09 08:50:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 30235 [episode count 5/20]
[retrieval_preprocessing] for episode 77342 [episode count 6/20], we have num_retrieval=np.int64(5140) num_query=np.int64(186)
2025-03-09 08:50:25,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:26,764 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:26
2025-03-09 08:50:26,764 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.47it/s]
2025-03-09 08:50:26,793 [INFO]: There are 5140 embeddings of dim 49152
2025-03-09 08:50:26,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:50:26,794 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:26
2025-03-09 08:50:26,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:26,794 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:50:26,795 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:26,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 08:50:26,795 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:26
2025-03-09 08:50:26,795 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:26,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:50:26,796 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:26
2025-03-09 08:50:26,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:26,796 [INFO]: 	Creating the index 03/09/2025, 08:50:26
2025-03-09 08:50:26,797 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:26
2025-03-09 08:50:26,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:50:26,800 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:26
2025-03-09 08:50:26,800 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:50:26,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.33it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.70it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.74it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.26it/s] 41%|████      | 9/22 [00:00<00:01, 10.53it/s] 50%|█████     | 11/22 [00:01<00:01, 10.56it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.94it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.22it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.63it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.95it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.50it/s]100%|██████████| 22/22 [00:06<00:00,  1.38it/s]100%|██████████| 22/22 [00:06<00:00,  3.28it/s]
2025-03-09 08:50:33,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:33
2025-03-09 08:51:21,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9604 secs
2025-03-09 08:51:21,476 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:51:21,476 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-09 08:51:45,801 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3248 secs
2025-03-09 08:51:46,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.9211 secs
2025-03-09 08:51:46,721 [INFO]: {
2025-03-09 08:51:46,722 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:46,722 [INFO]: 	index_param: efSearch=218
2025-03-09 08:51:46,722 [INFO]: 	index_path: knn.index
2025-03-09 08:51:46,722 [INFO]: 	size in bytes: 1011264430
2025-03-09 08:51:46,722 [INFO]: 	avg_search_speed_ms: 10.456524048995153
2025-03-09 08:51:46,723 [INFO]: 	99p_search_speed_ms: 18.749448219314207
2025-03-09 08:51:46,723 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:46,723 [INFO]: 	nb vectors: 5140
2025-03-09 08:51:46,723 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:46,723 [INFO]: 	compression ratio: 0.9993084795833271
2025-03-09 08:51:46,723 [INFO]: }
2025-03-09 08:51:46,723 [INFO]: 	>>> Finished "Creating the index" in 79.9264 secs
2025-03-09 08:51:46,723 [INFO]: >>> Finished "Launching the whole pipeline" in 79.9590 secs
2025-03-09 08:51:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 77342 [episode count 6/20]
[retrieval_preprocessing] for episode 18979 [episode count 7/20], we have num_retrieval=np.int64(5097) num_query=np.int64(229)
2025-03-09 08:51:49,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:50,559 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:50
2025-03-09 08:51:50,559 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1618.17it/s]
2025-03-09 08:51:50,585 [INFO]: There are 5097 embeddings of dim 49152
2025-03-09 08:51:50,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:51:50,585 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:50
2025-03-09 08:51:50,585 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:50,585 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:51:50,585 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:50,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:50,585 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:50
2025-03-09 08:51:50,585 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:50,585 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:51:50,585 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:50
2025-03-09 08:51:50,585 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:50,585 [INFO]: 	Creating the index 03/09/2025, 08:51:50
2025-03-09 08:51:50,585 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:50
2025-03-09 08:51:50,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:51:50,587 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:50
2025-03-09 08:51:50,587 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:51:50,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.50it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.73it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.32it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.01it/s] 41%|████      | 9/22 [00:00<00:01, 12.08it/s] 50%|█████     | 11/22 [00:00<00:00, 12.21it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.26it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.07it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.17it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.32it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.56it/s]100%|██████████| 22/22 [00:06<00:00,  1.57it/s]100%|██████████| 22/22 [00:06<00:00,  3.65it/s]
2025-03-09 08:51:56,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:56
2025-03-09 08:52:38,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7189 secs
2025-03-09 08:52:38,338 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 08:52:38,338 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.27it/s]
2025-03-09 08:53:00,181 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8428 secs
2025-03-09 08:53:00,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5950 secs
2025-03-09 08:53:00,182 [INFO]: {
2025-03-09 08:53:00,182 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:00,182 [INFO]: 	index_param: efSearch=264
2025-03-09 08:53:00,182 [INFO]: 	index_path: knn.index
2025-03-09 08:53:00,182 [INFO]: 	size in bytes: 1002804370
2025-03-09 08:53:00,182 [INFO]: 	avg_search_speed_ms: 13.550443542606342
2025-03-09 08:53:00,182 [INFO]: 	99p_search_speed_ms: 24.91192045621574
2025-03-09 08:53:00,182 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:00,182 [INFO]: 	nb vectors: 5097
2025-03-09 08:53:00,182 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:00,182 [INFO]: 	compression ratio: 0.9993085450953908
2025-03-09 08:53:00,182 [INFO]: }
2025-03-09 08:53:00,182 [INFO]: 	>>> Finished "Creating the index" in 69.5965 secs
2025-03-09 08:53:00,182 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6231 secs
2025-03-09 08:53:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 18979 [episode count 7/20]
[retrieval_preprocessing] for episode 90670 [episode count 8/20], we have num_retrieval=np.int64(5123) num_query=np.int64(203)
2025-03-09 08:53:04,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:05,870 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:05
2025-03-09 08:53:05,870 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.33it/s]
2025-03-09 08:53:05,896 [INFO]: There are 5123 embeddings of dim 49152
2025-03-09 08:53:05,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:53:05,896 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:05
2025-03-09 08:53:05,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:05,896 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:53:05,896 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:05,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:05,896 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:05
2025-03-09 08:53:05,897 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:05,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:53:05,897 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:05
2025-03-09 08:53:05,897 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:05,897 [INFO]: 	Creating the index 03/09/2025, 08:53:05
2025-03-09 08:53:05,897 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:05
2025-03-09 08:53:05,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:53:05,898 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:05
2025-03-09 08:53:05,898 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:53:05,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.34it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.70it/s] 18%|█▊        | 4/22 [00:00<00:01,  9.09it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.78it/s] 36%|███▋      | 8/22 [00:00<00:01, 10.17it/s] 45%|████▌     | 10/22 [00:01<00:01, 10.18it/s] 55%|█████▍    | 12/22 [00:01<00:00, 10.26it/s] 64%|██████▎   | 14/22 [00:01<00:00, 10.41it/s] 73%|███████▎  | 16/22 [00:01<00:00, 10.30it/s] 82%|████████▏ | 18/22 [00:01<00:00, 10.38it/s] 91%|█████████ | 20/22 [00:01<00:00, 10.48it/s]100%|██████████| 22/22 [00:06<00:00,  1.32it/s]100%|██████████| 22/22 [00:06<00:00,  3.38it/s]
2025-03-09 08:53:12,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:12
2025-03-09 08:54:04,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6397 secs
2025-03-09 08:54:04,048 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:54:04,049 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.70it/s] 50%|█████     | 2/4 [00:00<00:00,  4.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.49it/s]
2025-03-09 08:54:21,119 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0702 secs
2025-03-09 08:54:21,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2215 secs
2025-03-09 08:54:21,119 [INFO]: {
2025-03-09 08:54:21,119 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:21,119 [INFO]: 	index_param: efSearch=215
2025-03-09 08:54:21,120 [INFO]: 	index_path: knn.index
2025-03-09 08:54:21,120 [INFO]: 	size in bytes: 1007919850
2025-03-09 08:54:21,120 [INFO]: 	avg_search_speed_ms: 10.551739452634683
2025-03-09 08:54:21,120 [INFO]: 	99p_search_speed_ms: 19.83772224513813
2025-03-09 08:54:21,120 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:21,120 [INFO]: 	nb vectors: 5123
2025-03-09 08:54:21,120 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:21,120 [INFO]: 	compression ratio: 0.9993084112789326
2025-03-09 08:54:21,120 [INFO]: }
2025-03-09 08:54:21,120 [INFO]: 	>>> Finished "Creating the index" in 75.2229 secs
2025-03-09 08:54:21,120 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2497 secs
2025-03-09 08:54:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 90670 [episode count 8/20]
[retrieval_preprocessing] for episode 3637 [episode count 9/20], we have num_retrieval=np.int64(4984) num_query=np.int64(342)
2025-03-09 08:54:24,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:25,231 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:25
2025-03-09 08:54:25,231 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2461.45it/s]
2025-03-09 08:54:25,253 [INFO]: There are 4984 embeddings of dim 49152
2025-03-09 08:54:25,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-09 08:54:25,253 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:25
2025-03-09 08:54:25,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:25,253 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:54:25,253 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:25,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:25,253 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:25
2025-03-09 08:54:25,253 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:25,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:25,254 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:25
2025-03-09 08:54:25,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:25,254 [INFO]: 	Creating the index 03/09/2025, 08:54:25
2025-03-09 08:54:25,254 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:25
2025-03-09 08:54:25,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:54:25,255 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:25
2025-03-09 08:54:25,255 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:54:25,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.41it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.51it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.13it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.78it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.63it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.80it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.82it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.74it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.72it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.14it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-09 08:54:30,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:30
2025-03-09 08:55:19,749 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2557 secs
2025-03-09 08:55:19,749 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 08:55:19,750 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 08:55:40,007 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2576 secs
2025-03-09 08:55:40,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7555 secs
2025-03-09 08:55:40,010 [INFO]: {
2025-03-09 08:55:40,010 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:40,010 [INFO]: 	index_param: efSearch=227
2025-03-09 08:55:40,010 [INFO]: 	index_path: knn.index
2025-03-09 08:55:40,010 [INFO]: 	size in bytes: 980572150
2025-03-09 08:55:40,010 [INFO]: 	avg_search_speed_ms: 11.373456689636132
2025-03-09 08:55:40,010 [INFO]: 	99p_search_speed_ms: 19.159794896841053
2025-03-09 08:55:40,010 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:40,010 [INFO]: 	nb vectors: 4984
2025-03-09 08:55:40,010 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:40,010 [INFO]: 	compression ratio: 0.9993086913594272
2025-03-09 08:55:40,010 [INFO]: }
2025-03-09 08:55:40,010 [INFO]: 	>>> Finished "Creating the index" in 74.7568 secs
2025-03-09 08:55:40,011 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7795 secs
2025-03-09 08:55:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 3637 [episode count 9/20]
[retrieval_preprocessing] for episode 64566 [episode count 10/20], we have num_retrieval=np.int64(5053) num_query=np.int64(273)
2025-03-09 08:55:44,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:45,506 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:45
2025-03-09 08:55:45,506 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-09 08:55:45,531 [INFO]: There are 5053 embeddings of dim 49152
2025-03-09 08:55:45,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:55:45,531 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:45
2025-03-09 08:55:45,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:45,531 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:55:45,531 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:45,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:55:45,531 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:45
2025-03-09 08:55:45,531 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:45,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:55:45,531 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:45
2025-03-09 08:55:45,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:45,532 [INFO]: 	Creating the index 03/09/2025, 08:55:45
2025-03-09 08:55:45,532 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:45
2025-03-09 08:55:45,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:55:45,532 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:45
2025-03-09 08:55:45,533 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:55:45,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.14it/s] 10%|█         | 2/20 [00:00<00:02,  6.82it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.69it/s] 20%|██        | 4/20 [00:00<00:02,  7.99it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.21it/s] 30%|███       | 6/20 [00:00<00:01,  8.38it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.54it/s] 40%|████      | 8/20 [00:00<00:01,  8.60it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.75it/s] 50%|█████     | 10/20 [00:01<00:01,  8.77it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.79it/s] 60%|██████    | 12/20 [00:01<00:00,  8.79it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.75it/s] 70%|███████   | 14/20 [00:01<00:00,  8.91it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.98it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.09it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.73it/s]100%|██████████| 20/20 [00:05<00:00,  3.36it/s]
2025-03-09 08:55:51,503 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:51
2025-03-09 08:56:40,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1731 secs
2025-03-09 08:56:40,677 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:56:40,677 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 08:57:00,332 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6550 secs
2025-03-09 08:57:00,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8031 secs
2025-03-09 08:57:00,336 [INFO]: {
2025-03-09 08:57:00,336 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:00,336 [INFO]: 	index_param: efSearch=222
2025-03-09 08:57:00,336 [INFO]: 	index_path: knn.index
2025-03-09 08:57:00,336 [INFO]: 	size in bytes: 994147750
2025-03-09 08:57:00,336 [INFO]: 	avg_search_speed_ms: 10.820400473274677
2025-03-09 08:57:00,336 [INFO]: 	99p_search_speed_ms: 17.003472521901124
2025-03-09 08:57:00,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:00,336 [INFO]: 	nb vectors: 5053
2025-03-09 08:57:00,336 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:00,336 [INFO]: 	compression ratio: 0.9993084267403914
2025-03-09 08:57:00,336 [INFO]: }
2025-03-09 08:57:00,336 [INFO]: 	>>> Finished "Creating the index" in 74.8043 secs
2025-03-09 08:57:00,336 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8300 secs
2025-03-09 08:57:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 64566 [episode count 10/20]
[retrieval_preprocessing] for episode 71228 [episode count 11/20], we have num_retrieval=np.int64(4697) num_query=np.int64(629)
2025-03-09 08:57:03,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:04,749 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:04
2025-03-09 08:57:04,750 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2014.56it/s]
2025-03-09 08:57:04,775 [INFO]: There are 4697 embeddings of dim 49152
2025-03-09 08:57:04,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:57:04,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:04,775 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 08:57:04,775 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:04,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:04,775 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,775 [INFO]: 969.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:04,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:57:04,775 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:04
2025-03-09 08:57:04,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:04,775 [INFO]: 	Creating the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,775 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:04
2025-03-09 08:57:04,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:57:04,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,776 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:57:04,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.69it/s] 16%|█▌        | 3/19 [00:00<00:01, 10.50it/s] 26%|██▋       | 5/19 [00:00<00:01, 11.66it/s] 37%|███▋      | 7/19 [00:00<00:00, 12.11it/s] 47%|████▋     | 9/19 [00:00<00:00, 12.55it/s] 58%|█████▊    | 11/19 [00:00<00:00, 12.72it/s] 68%|██████▊   | 13/19 [00:01<00:00, 12.79it/s] 79%|███████▉  | 15/19 [00:01<00:00, 12.88it/s] 89%|████████▉ | 17/19 [00:01<00:00, 12.88it/s]100%|██████████| 19/19 [00:04<00:00,  1.86it/s]100%|██████████| 19/19 [00:04<00:00,  4.23it/s]
2025-03-09 08:57:09,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:09
2025-03-09 08:57:52,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3840 secs
2025-03-09 08:57:52,653 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 08:57:52,653 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-09 08:58:16,243 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5892 secs
2025-03-09 08:58:16,246 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4694 secs
2025-03-09 08:58:16,246 [INFO]: {
2025-03-09 08:58:16,246 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:16,246 [INFO]: 	index_param: efSearch=259
2025-03-09 08:58:16,246 [INFO]: 	index_path: knn.index
2025-03-09 08:58:16,246 [INFO]: 	size in bytes: 924106630
2025-03-09 08:58:16,246 [INFO]: 	avg_search_speed_ms: 12.023501455517431
2025-03-09 08:58:16,246 [INFO]: 	99p_search_speed_ms: 23.22186573175711
2025-03-09 08:58:16,246 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:16,246 [INFO]: 	nb vectors: 4697
2025-03-09 08:58:16,246 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:16,246 [INFO]: 	compression ratio: 0.9993086793458024
2025-03-09 08:58:16,246 [INFO]: }
2025-03-09 08:58:16,246 [INFO]: 	>>> Finished "Creating the index" in 71.4710 secs
2025-03-09 08:58:16,246 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4967 secs
2025-03-09 08:58:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 71228 [episode count 11/20]
[retrieval_preprocessing] for episode 26685 [episode count 12/20], we have num_retrieval=np.int64(5109) num_query=np.int64(217)
2025-03-09 08:58:25,349 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:26,199 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:26
2025-03-09 08:58:26,199 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.76it/s]
2025-03-09 08:58:26,231 [INFO]: There are 5109 embeddings of dim 49152
2025-03-09 08:58:26,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 08:58:26,231 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:26
2025-03-09 08:58:26,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:26,232 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:58:26,232 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:26,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:58:26,232 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:26
2025-03-09 08:58:26,232 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:26,232 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:58:26,232 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:26
2025-03-09 08:58:26,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:26,233 [INFO]: 	Creating the index 03/09/2025, 08:58:26
2025-03-09 08:58:26,233 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:26
2025-03-09 08:58:26,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:58:26,236 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:26
2025-03-09 08:58:26,236 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:58:26,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.09it/s]  9%|▉         | 2/22 [00:00<00:02,  6.98it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.09it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.67it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.01it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.16it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.21it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.42it/s] 41%|████      | 9/22 [00:01<00:01,  9.47it/s] 50%|█████     | 11/22 [00:01<00:01, 10.01it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.70it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.57it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.37it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.18it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.04it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.01it/s] 82%|████████▏ | 18/22 [00:01<00:00,  9.11it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.13it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.09it/s] 95%|█████████▌| 21/22 [00:05<00:01,  1.18s/it]100%|██████████| 22/22 [00:06<00:00,  1.06s/it]100%|██████████| 22/22 [00:06<00:00,  3.28it/s]
2025-03-09 08:58:32,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:32
2025-03-09 08:59:18,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6634 secs
2025-03-09 08:59:18,605 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:59:18,605 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 08:59:38,212 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6067 secs
2025-03-09 08:59:38,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9764 secs
2025-03-09 08:59:38,213 [INFO]: {
2025-03-09 08:59:38,213 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:38,213 [INFO]: 	index_param: efSearch=222
2025-03-09 08:59:38,213 [INFO]: 	index_path: knn.index
2025-03-09 08:59:38,213 [INFO]: 	size in bytes: 1005165370
2025-03-09 08:59:38,213 [INFO]: 	avg_search_speed_ms: 9.200154407217195
2025-03-09 08:59:38,213 [INFO]: 	99p_search_speed_ms: 13.17042434588075
2025-03-09 08:59:38,213 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:38,213 [INFO]: 	nb vectors: 5109
2025-03-09 08:59:38,213 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:38,213 [INFO]: 	compression ratio: 0.999308473987718
2025-03-09 08:59:38,213 [INFO]: }
2025-03-09 08:59:38,213 [INFO]: 	>>> Finished "Creating the index" in 71.9803 secs
2025-03-09 08:59:38,213 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0140 secs
2025-03-09 08:59:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 26685 [episode count 12/20]
[retrieval_preprocessing] for episode 85564 [episode count 13/20], we have num_retrieval=np.int64(5114) num_query=np.int64(212)
2025-03-09 08:59:41,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:41,831 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:41
2025-03-09 08:59:41,831 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2387.20it/s]
2025-03-09 08:59:41,855 [INFO]: There are 5114 embeddings of dim 49152
2025-03-09 08:59:41,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 08:59:41,856 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:41
2025-03-09 08:59:41,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:41,856 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:59:41,856 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:41,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:59:41,856 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:41
2025-03-09 08:59:41,856 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:41,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:59:41,856 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:41
2025-03-09 08:59:41,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:41,856 [INFO]: 	Creating the index 03/09/2025, 08:59:41
2025-03-09 08:59:41,856 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:41
2025-03-09 08:59:41,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:59:41,857 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:41
2025-03-09 08:59:41,857 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:59:41,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.93it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.85it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.15it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.89it/s] 41%|████      | 9/22 [00:00<00:01, 12.27it/s] 50%|█████     | 11/22 [00:00<00:00, 12.58it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.61it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.70it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.82it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.85it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.78it/s]100%|██████████| 22/22 [00:05<00:00,  1.73it/s]100%|██████████| 22/22 [00:05<00:00,  3.98it/s]
2025-03-09 08:59:47,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:47
2025-03-09 09:00:29,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3472 secs
2025-03-09 09:00:29,731 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 09:00:29,731 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s]
2025-03-09 09:00:45,860 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1296 secs
2025-03-09 09:00:45,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0036 secs
2025-03-09 09:00:45,861 [INFO]: {
2025-03-09 09:00:45,861 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:45,861 [INFO]: 	index_param: efSearch=212
2025-03-09 09:00:45,861 [INFO]: 	index_path: knn.index
2025-03-09 09:00:45,861 [INFO]: 	size in bytes: 1006149130
2025-03-09 09:00:45,861 [INFO]: 	avg_search_speed_ms: 10.340065828976226
2025-03-09 09:00:45,861 [INFO]: 	99p_search_speed_ms: 16.555346772074703
2025-03-09 09:00:45,861 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:45,861 [INFO]: 	nb vectors: 5114
2025-03-09 09:00:45,861 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:45,861 [INFO]: 	compression ratio: 0.9993084345260032
2025-03-09 09:00:45,861 [INFO]: }
2025-03-09 09:00:45,861 [INFO]: 	>>> Finished "Creating the index" in 64.0050 secs
2025-03-09 09:00:45,861 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0298 secs
2025-03-09 09:00:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 85564 [episode count 13/20]
[retrieval_preprocessing] for episode 3649 [episode count 14/20], we have num_retrieval=np.int64(5094) num_query=np.int64(232)
2025-03-09 09:00:48,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:49,589 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:49
2025-03-09 09:00:49,589 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1562.12it/s]
2025-03-09 09:00:49,614 [INFO]: There are 5094 embeddings of dim 49152
2025-03-09 09:00:49,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 09:00:49,614 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:49
2025-03-09 09:00:49,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:49,614 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:00:49,614 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:49,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:49,614 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:49
2025-03-09 09:00:49,615 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:49,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:00:49,615 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:49
2025-03-09 09:00:49,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:49,615 [INFO]: 	Creating the index 03/09/2025, 09:00:49
2025-03-09 09:00:49,615 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:49
2025-03-09 09:00:49,616 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:00:49,616 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:49
2025-03-09 09:00:49,616 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:00:49,616 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.62it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.54it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.96it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.64it/s] 41%|████      | 9/22 [00:00<00:01, 12.06it/s] 50%|█████     | 11/22 [00:00<00:00, 12.20it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.43it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.45it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.46it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.62it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.72it/s]100%|██████████| 22/22 [00:05<00:00,  1.72it/s]100%|██████████| 22/22 [00:05<00:00,  3.93it/s]
2025-03-09 09:00:55,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:55
2025-03-09 09:01:38,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5422 secs
2025-03-09 09:01:38,764 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 09:01:38,764 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-09 09:01:54,232 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4679 secs
2025-03-09 09:01:54,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6167 secs
2025-03-09 09:01:54,233 [INFO]: {
2025-03-09 09:01:54,233 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:54,233 [INFO]: 	index_param: efSearch=265
2025-03-09 09:01:54,233 [INFO]: 	index_path: knn.index
2025-03-09 09:01:54,233 [INFO]: 	size in bytes: 1002214150
2025-03-09 09:01:54,233 [INFO]: 	avg_search_speed_ms: 12.024742129142396
2025-03-09 09:01:54,233 [INFO]: 	99p_search_speed_ms: 21.170507478527718
2025-03-09 09:01:54,233 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:54,233 [INFO]: 	nb vectors: 5094
2025-03-09 09:01:54,233 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:54,233 [INFO]: 	compression ratio: 0.9993085330116322
2025-03-09 09:01:54,233 [INFO]: }
2025-03-09 09:01:54,233 [INFO]: 	>>> Finished "Creating the index" in 64.6180 secs
2025-03-09 09:01:54,233 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6435 secs
2025-03-09 09:01:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 3649 [episode count 14/20]
[retrieval_preprocessing] for episode 20548 [episode count 15/20], we have num_retrieval=np.int64(5068) num_query=np.int64(258)
2025-03-09 09:01:58,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:58,683 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:58
2025-03-09 09:01:58,683 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2302.03it/s]
2025-03-09 09:01:58,706 [INFO]: There are 5068 embeddings of dim 49152
2025-03-09 09:01:58,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 09:01:58,707 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:58
2025-03-09 09:01:58,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:58,707 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:01:58,707 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:58,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:58,707 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:58
2025-03-09 09:01:58,707 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:58,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:01:58,707 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:58
2025-03-09 09:01:58,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:58,707 [INFO]: 	Creating the index 03/09/2025, 09:01:58
2025-03-09 09:01:58,707 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:58
2025-03-09 09:01:58,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:01:58,708 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:58
2025-03-09 09:01:58,708 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:01:58,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.00it/s] 10%|█         | 2/20 [00:00<00:02,  6.78it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.56it/s] 20%|██        | 4/20 [00:00<00:02,  7.84it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.05it/s] 30%|███       | 6/20 [00:00<00:01,  8.29it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.24it/s] 40%|████      | 8/20 [00:01<00:01,  8.13it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.79it/s] 50%|█████     | 10/20 [00:01<00:01,  7.95it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.18it/s] 60%|██████    | 12/20 [00:01<00:00,  8.21it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.18it/s] 70%|███████   | 14/20 [00:01<00:00,  8.21it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.35it/s] 85%|████████▌ | 17/20 [00:02<00:00,  9.44it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.93it/s]100%|██████████| 20/20 [00:06<00:00,  1.04it/s]100%|██████████| 20/20 [00:06<00:00,  3.21it/s]
2025-03-09 09:02:04,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:04
2025-03-09 09:02:49,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7315 secs
2025-03-09 09:02:49,681 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 09:02:49,682 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 09:03:11,166 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4839 secs
2025-03-09 09:03:11,169 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4604 secs
2025-03-09 09:03:11,169 [INFO]: {
2025-03-09 09:03:11,169 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:11,169 [INFO]: 	index_param: efSearch=182
2025-03-09 09:03:11,169 [INFO]: 	index_path: knn.index
2025-03-09 09:03:11,169 [INFO]: 	size in bytes: 997098850
2025-03-09 09:03:11,169 [INFO]: 	avg_search_speed_ms: 9.342387910697296
2025-03-09 09:03:11,169 [INFO]: 	99p_search_speed_ms: 18.659091768786308
2025-03-09 09:03:11,169 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:11,169 [INFO]: 	nb vectors: 5068
2025-03-09 09:03:11,169 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:11,169 [INFO]: 	compression ratio: 0.9993084878194374
2025-03-09 09:03:11,169 [INFO]: }
2025-03-09 09:03:11,169 [INFO]: 	>>> Finished "Creating the index" in 72.4618 secs
2025-03-09 09:03:11,169 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4862 secs
2025-03-09 09:03:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 20548 [episode count 15/20]
[retrieval_preprocessing] for episode 88143 [episode count 16/20], we have num_retrieval=np.int64(5078) num_query=np.int64(248)
2025-03-09 09:03:14,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:15,259 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:15
2025-03-09 09:03:15,259 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-09 09:03:15,285 [INFO]: There are 5078 embeddings of dim 49152
2025-03-09 09:03:15,285 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:03:15,285 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:15
2025-03-09 09:03:15,285 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:15,285 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:03:15,285 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:15,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:15,286 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:15
2025-03-09 09:03:15,286 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:15,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:03:15,286 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:15
2025-03-09 09:03:15,286 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:15,286 [INFO]: 	Creating the index 03/09/2025, 09:03:15
2025-03-09 09:03:15,286 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:15
2025-03-09 09:03:15,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:03:15,287 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:15
2025-03-09 09:03:15,287 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:03:15,287 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.85it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.33it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.42it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.93it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.17it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.45it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.75it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.90it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.09it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.14it/s]100%|██████████| 20/20 [00:05<00:00,  3.66it/s]
2025-03-09 09:03:20,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:20
2025-03-09 09:04:10,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7468 secs
2025-03-09 09:04:10,515 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 09:04:10,515 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 09:04:27,078 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5631 secs
2025-03-09 09:04:27,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7937 secs
2025-03-09 09:04:27,081 [INFO]: {
2025-03-09 09:04:27,081 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:27,081 [INFO]: 	index_param: efSearch=214
2025-03-09 09:04:27,081 [INFO]: 	index_path: knn.index
2025-03-09 09:04:27,081 [INFO]: 	size in bytes: 999066250
2025-03-09 09:04:27,081 [INFO]: 	avg_search_speed_ms: 10.35081806778715
2025-03-09 09:04:27,081 [INFO]: 	99p_search_speed_ms: 17.600419616792355
2025-03-09 09:04:27,081 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:27,081 [INFO]: 	nb vectors: 5078
2025-03-09 09:04:27,081 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:27,081 [INFO]: 	compression ratio: 0.9993085283383359
2025-03-09 09:04:27,081 [INFO]: }
2025-03-09 09:04:27,081 [INFO]: 	>>> Finished "Creating the index" in 71.7954 secs
2025-03-09 09:04:27,081 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8222 secs
2025-03-09 09:04:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 88143 [episode count 16/20]
[retrieval_preprocessing] for episode 54355 [episode count 17/20], we have num_retrieval=np.int64(5082) num_query=np.int64(244)
2025-03-09 09:04:30,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:30,832 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:30
2025-03-09 09:04:30,832 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1840.41it/s]
2025-03-09 09:04:30,858 [INFO]: There are 5082 embeddings of dim 49152
2025-03-09 09:04:30,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:04:30,858 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:30
2025-03-09 09:04:30,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:30,858 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:04:30,858 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:30,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:30,858 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:30
2025-03-09 09:04:30,858 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:30,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:30,858 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:30
2025-03-09 09:04:30,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:30,858 [INFO]: 	Creating the index 03/09/2025, 09:04:30
2025-03-09 09:04:30,858 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:30
2025-03-09 09:04:30,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:04:30,860 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:30
2025-03-09 09:04:30,860 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:04:30,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:00<00:03,  6.16it/s] 14%|█▍        | 3/21 [00:00<00:01, 10.30it/s] 24%|██▍       | 5/21 [00:00<00:01, 11.85it/s] 33%|███▎      | 7/21 [00:00<00:01, 12.25it/s] 43%|████▎     | 9/21 [00:00<00:00, 12.49it/s] 52%|█████▏    | 11/21 [00:00<00:00, 12.58it/s] 62%|██████▏   | 13/21 [00:01<00:00, 11.13it/s] 71%|███████▏  | 15/21 [00:01<00:00, 11.64it/s] 81%|████████  | 17/21 [00:01<00:00, 12.21it/s] 90%|█████████ | 19/21 [00:01<00:00, 12.74it/s]100%|██████████| 21/21 [00:05<00:00,  1.49it/s]100%|██████████| 21/21 [00:05<00:00,  3.74it/s]
2025-03-09 09:04:36,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:36
2025-03-09 09:05:25,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0221 secs
2025-03-09 09:05:25,505 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 09:05:25,505 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-09 09:05:47,052 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5470 secs
2025-03-09 09:05:47,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1956 secs
2025-03-09 09:05:47,056 [INFO]: {
2025-03-09 09:05:47,056 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:47,056 [INFO]: 	index_param: efSearch=227
2025-03-09 09:05:47,056 [INFO]: 	index_path: knn.index
2025-03-09 09:05:47,056 [INFO]: 	size in bytes: 999853270
2025-03-09 09:05:47,056 [INFO]: 	avg_search_speed_ms: 11.69856474489758
2025-03-09 09:05:47,056 [INFO]: 	99p_search_speed_ms: 22.064147433266044
2025-03-09 09:05:47,056 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:47,056 [INFO]: 	nb vectors: 5082
2025-03-09 09:05:47,056 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:47,056 [INFO]: 	compression ratio: 0.9993084845339356
2025-03-09 09:05:47,056 [INFO]: }
2025-03-09 09:05:47,056 [INFO]: 	>>> Finished "Creating the index" in 76.1972 secs
2025-03-09 09:05:47,056 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2234 secs
2025-03-09 09:05:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 54355 [episode count 17/20]
[retrieval_preprocessing] for episode 80472 [episode count 18/20], we have num_retrieval=np.int64(5061) num_query=np.int64(265)
2025-03-09 09:05:51,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:51,749 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:51
2025-03-09 09:05:51,749 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.78it/s]
2025-03-09 09:05:51,773 [INFO]: There are 5061 embeddings of dim 49152
2025-03-09 09:05:51,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:05:51,773 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:51
2025-03-09 09:05:51,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:51,773 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:05:51,773 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:51,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:05:51,773 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:51
2025-03-09 09:05:51,774 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:51,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:05:51,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:51
2025-03-09 09:05:51,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:51,774 [INFO]: 	Creating the index 03/09/2025, 09:05:51
2025-03-09 09:05:51,774 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:51
2025-03-09 09:05:51,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:05:51,775 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:51
2025-03-09 09:05:51,775 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:05:51,775 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.38it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.43it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.98it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.50it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.93it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.35it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.53it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.76it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.86it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.89it/s]100%|██████████| 20/20 [00:05<00:00,  3.97it/s]
2025-03-09 09:05:56,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:56
2025-03-09 09:06:50,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.9686 secs
2025-03-09 09:06:50,794 [INFO]: The best hyperparameters are: efSearch=151
2025-03-09 09:06:50,794 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 09:07:13,395 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6010 secs
2025-03-09 09:07:13,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6229 secs
2025-03-09 09:07:13,398 [INFO]: {
2025-03-09 09:07:13,398 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:13,398 [INFO]: 	index_param: efSearch=151
2025-03-09 09:07:13,398 [INFO]: 	index_path: knn.index
2025-03-09 09:07:13,398 [INFO]: 	size in bytes: 995721670
2025-03-09 09:07:13,398 [INFO]: 	avg_search_speed_ms: 8.232261663218463
2025-03-09 09:07:13,398 [INFO]: 	99p_search_speed_ms: 21.47741892840707
2025-03-09 09:07:13,398 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:13,398 [INFO]: 	nb vectors: 5061
2025-03-09 09:07:13,398 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:13,398 [INFO]: 	compression ratio: 0.9993084593609377
2025-03-09 09:07:13,398 [INFO]: }
2025-03-09 09:07:13,398 [INFO]: 	>>> Finished "Creating the index" in 81.6244 secs
2025-03-09 09:07:13,398 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6496 secs
2025-03-09 09:07:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 80472 [episode count 18/20]
[retrieval_preprocessing] for episode 31847 [episode count 19/20], we have num_retrieval=np.int64(5040) num_query=np.int64(286)
2025-03-09 09:07:15,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:16,635 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:16
2025-03-09 09:07:16,635 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 935.81it/s]
2025-03-09 09:07:16,674 [INFO]: There are 5040 embeddings of dim 49152
2025-03-09 09:07:16,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0398 secs
2025-03-09 09:07:16,675 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:16
2025-03-09 09:07:16,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:16,675 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:07:16,675 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:16,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:07:16,675 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:16
2025-03-09 09:07:16,675 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:16,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:07:16,675 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:16
2025-03-09 09:07:16,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:16,676 [INFO]: 	Creating the index 03/09/2025, 09:07:16
2025-03-09 09:07:16,676 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:16
2025-03-09 09:07:16,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:07:16,677 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:16
2025-03-09 09:07:16,677 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:07:16,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.87it/s] 30%|███       | 6/20 [00:00<00:00, 30.17it/s] 50%|█████     | 10/20 [00:00<00:00, 31.47it/s] 75%|███████▌  | 15/20 [00:00<00:00, 35.65it/s]100%|██████████| 20/20 [00:04<00:00,  2.69it/s]100%|██████████| 20/20 [00:04<00:00,  4.11it/s]
2025-03-09 09:07:21,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:21
2025-03-09 09:08:13,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1996 secs
2025-03-09 09:08:13,752 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 09:08:13,752 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 09:08:30,512 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7592 secs
2025-03-09 09:08:30,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8383 secs
2025-03-09 09:08:30,516 [INFO]: {
2025-03-09 09:08:30,516 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:30,516 [INFO]: 	index_param: efSearch=164
2025-03-09 09:08:30,516 [INFO]: 	index_path: knn.index
2025-03-09 09:08:30,516 [INFO]: 	size in bytes: 991590070
2025-03-09 09:08:30,516 [INFO]: 	avg_search_speed_ms: 8.268264394199614
2025-03-09 09:08:30,516 [INFO]: 	99p_search_speed_ms: 15.343507162760943
2025-03-09 09:08:30,516 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:30,516 [INFO]: 	nb vectors: 5040
2025-03-09 09:08:30,516 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:30,516 [INFO]: 	compression ratio: 0.999308433978166
2025-03-09 09:08:30,516 [INFO]: }
2025-03-09 09:08:30,516 [INFO]: 	>>> Finished "Creating the index" in 73.8402 secs
2025-03-09 09:08:30,516 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8811 secs
2025-03-09 09:08:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 31847 [episode count 19/20]
2025-03-09 09:08:32: [retrieval_preprocessing] finished for (484659531, 'marker') [chosen_id count 6/10]
2025-03-09 09:08:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (-1, 'marker') [chosen_id count 7/10]
2025-03-09 09:08:33: [retrieval_preprocessing] we have num_total=2983 embedding_dim=49152
[retrieval_preprocessing] for episode 40961 [episode count 0/20], we have num_retrieval=np.int64(2845) num_query=np.int64(138)
2025-03-09 09:08:34,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:34,467 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:34
2025-03-09 09:08:34,467 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.80it/s]
2025-03-09 09:08:34,501 [INFO]: There are 2845 embeddings of dim 49152
2025-03-09 09:08:34,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-09 09:08:34,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:34
2025-03-09 09:08:34,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:34,502 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:08:34,502 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:34,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:08:34,502 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:34
2025-03-09 09:08:34,502 [INFO]: 587.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:34,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:34,502 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:34
2025-03-09 09:08:34,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:34,502 [INFO]: 	Creating the index 03/09/2025, 09:08:34
2025-03-09 09:08:34,502 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:34
2025-03-09 09:08:34,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 09:08:34,504 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:34
2025-03-09 09:08:34,504 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:08:34,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.27it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.86it/s]100%|██████████| 12/12 [00:02<00:00,  5.37it/s]
2025-03-09 09:08:36,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:36
2025-03-09 09:09:07,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4141 secs
2025-03-09 09:09:07,157 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 09:09:07,157 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.27it/s]
2025-03-09 09:09:21,151 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9934 secs
2025-03-09 09:09:21,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6487 secs
2025-03-09 09:09:21,153 [INFO]: {
2025-03-09 09:09:21,153 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:21,153 [INFO]: 	index_param: efSearch=178
2025-03-09 09:09:21,153 [INFO]: 	index_path: knn.index
2025-03-09 09:09:21,153 [INFO]: 	size in bytes: 559736170
2025-03-09 09:09:21,153 [INFO]: 	avg_search_speed_ms: 9.991766587895277
2025-03-09 09:09:21,153 [INFO]: 	99p_search_speed_ms: 14.768227934837341
2025-03-09 09:09:21,153 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:21,153 [INFO]: 	nb vectors: 2845
2025-03-09 09:09:21,153 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:21,153 [INFO]: 	compression ratio: 0.9993096569049665
2025-03-09 09:09:21,153 [INFO]: }
2025-03-09 09:09:21,153 [INFO]: 	>>> Finished "Creating the index" in 46.6509 secs
2025-03-09 09:09:21,153 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6862 secs
2025-03-09 09:09:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 40961 [episode count 0/20]
[retrieval_preprocessing] for episode 92164 [episode count 1/20], we have num_retrieval=np.int64(2818) num_query=np.int64(165)
2025-03-09 09:09:22,999 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:23,457 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:23
2025-03-09 09:09:23,457 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-09 09:09:23,485 [INFO]: There are 2818 embeddings of dim 49152
2025-03-09 09:09:23,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 09:09:23,485 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:23
2025-03-09 09:09:23,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:23,485 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:09:23,485 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:23,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:09:23,485 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:23
2025-03-09 09:09:23,485 [INFO]: 581.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:23,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:23,485 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:23
2025-03-09 09:09:23,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:23,485 [INFO]: 	Creating the index 03/09/2025, 09:09:23
2025-03-09 09:09:23,485 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:23
2025-03-09 09:09:23,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:09:23,487 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:23
2025-03-09 09:09:23,487 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:23,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.36it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.99it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.76it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.19it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.55it/s] 50%|█████     | 6/12 [00:00<00:00,  8.71it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.73it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.80it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.86it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.03it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.00it/s]100%|██████████| 12/12 [00:03<00:00,  1.39it/s]100%|██████████| 12/12 [00:03<00:00,  3.52it/s]
2025-03-09 09:09:26,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:26
2025-03-09 09:09:59,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1105 secs
2025-03-09 09:09:59,016 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:09:59,016 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 09:10:16,108 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0913 secs
2025-03-09 09:10:16,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6230 secs
2025-03-09 09:10:16,110 [INFO]: {
2025-03-09 09:10:16,110 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:16,110 [INFO]: 	index_param: efSearch=243
2025-03-09 09:10:16,110 [INFO]: 	index_path: knn.index
2025-03-09 09:10:16,110 [INFO]: 	size in bytes: 554424010
2025-03-09 09:10:16,110 [INFO]: 	avg_search_speed_ms: 10.215058645225902
2025-03-09 09:10:16,110 [INFO]: 	99p_search_speed_ms: 18.27056601177901
2025-03-09 09:10:16,110 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:16,110 [INFO]: 	nb vectors: 2818
2025-03-09 09:10:16,110 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:16,110 [INFO]: 	compression ratio: 0.9993097954037019
2025-03-09 09:10:16,110 [INFO]: }
2025-03-09 09:10:16,110 [INFO]: 	>>> Finished "Creating the index" in 52.6247 secs
2025-03-09 09:10:16,110 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6533 secs
2025-03-09 09:10:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 92164 [episode count 1/20]
[retrieval_preprocessing] for episode 83975 [episode count 2/20], we have num_retrieval=np.int64(2866) num_query=np.int64(117)
2025-03-09 09:10:19,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:20,241 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:20
2025-03-09 09:10:20,241 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.21it/s]
2025-03-09 09:10:20,270 [INFO]: There are 2866 embeddings of dim 49152
2025-03-09 09:10:20,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 09:10:20,270 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:20
2025-03-09 09:10:20,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:20,270 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:10:20,270 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:20,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:20,270 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:20
2025-03-09 09:10:20,271 [INFO]: 591.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:20,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:20,271 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:20
2025-03-09 09:10:20,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:20,271 [INFO]: 	Creating the index 03/09/2025, 09:10:20
2025-03-09 09:10:20,271 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:20
2025-03-09 09:10:20,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:10:20,272 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:20
2025-03-09 09:10:20,272 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:10:20,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.21it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.64it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.28it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.64it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.93it/s] 50%|█████     | 6/12 [00:00<00:00,  8.25it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.28it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.31it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.33it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.20it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.19it/s]100%|██████████| 12/12 [00:03<00:00,  1.43it/s]100%|██████████| 12/12 [00:03<00:00,  3.51it/s]
2025-03-09 09:10:23,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:23
2025-03-09 09:10:50,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1269 secs
2025-03-09 09:10:50,823 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 09:10:50,823 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s]
2025-03-09 09:11:07,012 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1898 secs
2025-03-09 09:11:07,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9916 secs
2025-03-09 09:11:07,264 [INFO]: {
2025-03-09 09:11:07,264 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:07,264 [INFO]: 	index_param: efSearch=242
2025-03-09 09:11:07,264 [INFO]: 	index_path: knn.index
2025-03-09 09:11:07,265 [INFO]: 	size in bytes: 563867770
2025-03-09 09:11:07,265 [INFO]: 	avg_search_speed_ms: 9.980171595648034
2025-03-09 09:11:07,265 [INFO]: 	99p_search_speed_ms: 13.612374663352966
2025-03-09 09:11:07,265 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:07,265 [INFO]: 	nb vectors: 2866
2025-03-09 09:11:07,265 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:07,265 [INFO]: 	compression ratio: 0.9993096927671535
2025-03-09 09:11:07,265 [INFO]: }
2025-03-09 09:11:07,265 [INFO]: 	>>> Finished "Creating the index" in 46.9941 secs
2025-03-09 09:11:07,265 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0242 secs
2025-03-09 09:11:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 83975 [episode count 2/20]
[retrieval_preprocessing] for episode 30728 [episode count 3/20], we have num_retrieval=np.int64(2839) num_query=np.int64(144)
2025-03-09 09:11:09,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:09,626 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:09
2025-03-09 09:11:09,626 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2411.91it/s]
2025-03-09 09:11:09,648 [INFO]: There are 2839 embeddings of dim 49152
2025-03-09 09:11:09,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 09:11:09,648 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:09,649 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:11:09,649 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:09,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:09,649 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,649 [INFO]: 585.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:09,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:09,649 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:09
2025-03-09 09:11:09,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:09,649 [INFO]: 	Creating the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,649 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:09
2025-03-09 09:11:09,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 09:11:09,650 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,650 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:11:09,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.68it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.75it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.71it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.99it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.18it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.23it/s]100%|██████████| 12/12 [00:02<00:00,  4.34it/s]
2025-03-09 09:11:12,419 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:12
2025-03-09 09:11:42,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9708 secs
2025-03-09 09:11:42,390 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 09:11:42,390 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 09:12:00,060 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6696 secs
2025-03-09 09:12:00,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4126 secs
2025-03-09 09:12:00,062 [INFO]: {
2025-03-09 09:12:00,062 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:00,062 [INFO]: 	index_param: efSearch=233
2025-03-09 09:12:00,062 [INFO]: 	index_path: knn.index
2025-03-09 09:12:00,062 [INFO]: 	size in bytes: 558555730
2025-03-09 09:12:00,062 [INFO]: 	avg_search_speed_ms: 9.294392620897108
2025-03-09 09:12:00,062 [INFO]: 	99p_search_speed_ms: 12.05504493555054
2025-03-09 09:12:00,062 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:00,063 [INFO]: 	nb vectors: 2839
2025-03-09 09:12:00,063 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:00,063 [INFO]: 	compression ratio: 0.9993096158909693
2025-03-09 09:12:00,063 [INFO]: }
2025-03-09 09:12:00,063 [INFO]: 	>>> Finished "Creating the index" in 50.4137 secs
2025-03-09 09:12:00,063 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4364 secs
2025-03-09 09:12:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 30728 [episode count 3/20]
[retrieval_preprocessing] for episode 8202 [episode count 4/20], we have num_retrieval=np.int64(2834) num_query=np.int64(149)
2025-03-09 09:12:02,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:03,019 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:03
2025-03-09 09:12:03,019 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1537.50it/s]
2025-03-09 09:12:03,049 [INFO]: There are 2834 embeddings of dim 49152
2025-03-09 09:12:03,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 09:12:03,050 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:03
2025-03-09 09:12:03,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:03,050 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:12:03,050 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:03,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:12:03,051 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:03
2025-03-09 09:12:03,051 [INFO]: 584.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:03,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:12:03,051 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:03
2025-03-09 09:12:03,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:03,051 [INFO]: 	Creating the index 03/09/2025, 09:12:03
2025-03-09 09:12:03,052 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:03
2025-03-09 09:12:03,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:12:03,055 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:03
2025-03-09 09:12:03,055 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:12:03,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.14it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.47it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.04it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.94it/s] 50%|█████     | 6/12 [00:00<00:00,  8.92it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.49it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.41it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.15it/s]100%|██████████| 12/12 [00:03<00:00,  1.97it/s]100%|██████████| 12/12 [00:03<00:00,  3.99it/s]
2025-03-09 09:12:06,069 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:06
2025-03-09 09:12:39,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0341 secs
2025-03-09 09:12:39,104 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 09:12:39,104 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 09:12:55,575 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4707 secs
2025-03-09 09:12:55,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5229 secs
2025-03-09 09:12:55,578 [INFO]: {
2025-03-09 09:12:55,578 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:55,578 [INFO]: 	index_param: efSearch=167
2025-03-09 09:12:55,578 [INFO]: 	index_path: knn.index
2025-03-09 09:12:55,578 [INFO]: 	size in bytes: 557572030
2025-03-09 09:12:55,578 [INFO]: 	avg_search_speed_ms: 9.4355126219046
2025-03-09 09:12:55,578 [INFO]: 	99p_search_speed_ms: 20.414206278510413
2025-03-09 09:12:55,578 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:55,578 [INFO]: 	nb vectors: 2834
2025-03-09 09:12:55,578 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:55,578 [INFO]: 	compression ratio: 0.9993095815799798
2025-03-09 09:12:55,578 [INFO]: }
2025-03-09 09:12:55,578 [INFO]: 	>>> Finished "Creating the index" in 52.5264 secs
2025-03-09 09:12:55,578 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5586 secs
2025-03-09 09:12:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 8202 [episode count 4/20]
[retrieval_preprocessing] for episode 22538 [episode count 5/20], we have num_retrieval=np.int64(2813) num_query=np.int64(170)
2025-03-09 09:12:58,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:58,693 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:58
2025-03-09 09:12:58,694 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 808.31it/s]
2025-03-09 09:12:58,723 [INFO]: There are 2813 embeddings of dim 49152
2025-03-09 09:12:58,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 09:12:58,724 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:58
2025-03-09 09:12:58,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:58,724 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:12:58,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:58,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:12:58,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:58
2025-03-09 09:12:58,725 [INFO]: 580.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:58,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:12:58,725 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:58
2025-03-09 09:12:58,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:58,725 [INFO]: 	Creating the index 03/09/2025, 09:12:58
2025-03-09 09:12:58,726 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:58
2025-03-09 09:12:58,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:12:58,729 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:58
2025-03-09 09:12:58,729 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:12:58,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.92it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.54it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.31it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.74it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.91it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.03it/s]100%|██████████| 12/12 [00:03<00:00,  3.74it/s]
2025-03-09 09:13:02,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:02
2025-03-09 09:13:32,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5613 secs
2025-03-09 09:13:32,693 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 09:13:32,693 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.71it/s]
2025-03-09 09:13:50,546 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8531 secs
2025-03-09 09:13:50,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8195 secs
2025-03-09 09:13:50,549 [INFO]: {
2025-03-09 09:13:50,549 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:50,549 [INFO]: 	index_param: efSearch=183
2025-03-09 09:13:50,549 [INFO]: 	index_path: knn.index
2025-03-09 09:13:50,549 [INFO]: 	size in bytes: 553440310
2025-03-09 09:13:50,549 [INFO]: 	avg_search_speed_ms: 10.13661734453141
2025-03-09 09:13:50,549 [INFO]: 	99p_search_speed_ms: 23.363048452883945
2025-03-09 09:13:50,549 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:50,549 [INFO]: 	nb vectors: 2813
2025-03-09 09:13:50,549 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:50,549 [INFO]: 	compression ratio: 0.999309761155634
2025-03-09 09:13:50,549 [INFO]: }
2025-03-09 09:13:50,549 [INFO]: 	>>> Finished "Creating the index" in 51.8235 secs
2025-03-09 09:13:50,549 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8554 secs
2025-03-09 09:13:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 22538 [episode count 5/20]
[retrieval_preprocessing] for episode 75787 [episode count 6/20], we have num_retrieval=np.int64(2829) num_query=np.int64(154)
2025-03-09 09:13:52,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:52,646 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:52
2025-03-09 09:13:52,646 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1124.18it/s]
2025-03-09 09:13:52,690 [INFO]: There are 2829 embeddings of dim 49152
2025-03-09 09:13:52,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0433 secs
2025-03-09 09:13:52,690 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:52,690 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:13:52,690 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:52,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:52,690 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,690 [INFO]: 583.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:52,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:13:52,690 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:52
2025-03-09 09:13:52,690 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:52,690 [INFO]: 	Creating the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,690 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:52
2025-03-09 09:13:52,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:13:52,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,692 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:13:52,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.48it/s] 67%|██████▋   | 8/12 [00:00<00:00, 40.38it/s]100%|██████████| 12/12 [00:02<00:00,  3.84it/s]100%|██████████| 12/12 [00:02<00:00,  4.84it/s]
2025-03-09 09:13:55,173 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:55
2025-03-09 09:14:28,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7940 secs
2025-03-09 09:14:28,967 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 09:14:28,967 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.73it/s]
2025-03-09 09:14:46,895 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9274 secs
2025-03-09 09:14:46,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2046 secs
2025-03-09 09:14:46,896 [INFO]: {
2025-03-09 09:14:46,896 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:46,896 [INFO]: 	index_param: efSearch=212
2025-03-09 09:14:46,896 [INFO]: 	index_path: knn.index
2025-03-09 09:14:46,896 [INFO]: 	size in bytes: 556588210
2025-03-09 09:14:46,897 [INFO]: 	avg_search_speed_ms: 9.573080136249082
2025-03-09 09:14:46,897 [INFO]: 	99p_search_speed_ms: 19.19883877038955
2025-03-09 09:14:46,897 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:46,897 [INFO]: 	nb vectors: 2829
2025-03-09 09:14:46,897 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:46,897 [INFO]: 	compression ratio: 0.9993097625980975
2025-03-09 09:14:46,897 [INFO]: }
2025-03-09 09:14:46,897 [INFO]: 	>>> Finished "Creating the index" in 54.2063 secs
2025-03-09 09:14:46,897 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2503 secs
2025-03-09 09:14:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 75787 [episode count 6/20]
[retrieval_preprocessing] for episode 86029 [episode count 7/20], we have num_retrieval=np.int64(2863) num_query=np.int64(120)
2025-03-09 09:14:48,540 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:48,943 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:48
2025-03-09 09:14:48,943 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2182.26it/s]
2025-03-09 09:14:48,970 [INFO]: There are 2863 embeddings of dim 49152
2025-03-09 09:14:48,970 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:14:48,971 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:48
2025-03-09 09:14:48,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:48,971 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:14:48,971 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:48,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:14:48,971 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:48
2025-03-09 09:14:48,971 [INFO]: 590.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:48,971 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:14:48,971 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:48
2025-03-09 09:14:48,971 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:48,971 [INFO]: 	Creating the index 03/09/2025, 09:14:48
2025-03-09 09:14:48,971 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:48
2025-03-09 09:14:48,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:14:48,973 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:48
2025-03-09 09:14:48,973 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:14:48,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.15it/s]100%|██████████| 12/12 [00:02<00:00,  4.71it/s]100%|██████████| 12/12 [00:02<00:00,  5.60it/s]
2025-03-09 09:14:51,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:51
2025-03-09 09:15:19,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6868 secs
2025-03-09 09:15:19,808 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 09:15:19,808 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-09 09:15:38,949 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1407 secs
2025-03-09 09:15:38,951 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9778 secs
2025-03-09 09:15:38,951 [INFO]: {
2025-03-09 09:15:38,951 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:38,951 [INFO]: 	index_param: efSearch=235
2025-03-09 09:15:38,951 [INFO]: 	index_path: knn.index
2025-03-09 09:15:38,951 [INFO]: 	size in bytes: 563277550
2025-03-09 09:15:38,951 [INFO]: 	avg_search_speed_ms: 9.891002345461727
2025-03-09 09:15:38,951 [INFO]: 	99p_search_speed_ms: 17.426491156220415
2025-03-09 09:15:38,951 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:38,951 [INFO]: 	nb vectors: 2863
2025-03-09 09:15:38,951 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:38,951 [INFO]: 	compression ratio: 0.9993096724696378
2025-03-09 09:15:38,951 [INFO]: }
2025-03-09 09:15:38,951 [INFO]: 	>>> Finished "Creating the index" in 49.9797 secs
2025-03-09 09:15:38,951 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0078 secs
2025-03-09 09:15:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 86029 [episode count 7/20]
[retrieval_preprocessing] for episode 92174 [episode count 8/20], we have num_retrieval=np.int64(2857) num_query=np.int64(126)
2025-03-09 09:15:40,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:40,665 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:40
2025-03-09 09:15:40,665 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.98it/s]
2025-03-09 09:15:40,696 [INFO]: There are 2857 embeddings of dim 49152
2025-03-09 09:15:40,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 09:15:40,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:40
2025-03-09 09:15:40,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:40,696 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:15:40,696 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:40,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:15:40,696 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:40
2025-03-09 09:15:40,696 [INFO]: 589.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:40,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:15:40,696 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:40
2025-03-09 09:15:40,696 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:40,696 [INFO]: 	Creating the index 03/09/2025, 09:15:40
2025-03-09 09:15:40,696 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:40
2025-03-09 09:15:40,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:15:40,697 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:40
2025-03-09 09:15:40,697 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:15:40,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.95it/s] 42%|████▏     | 5/12 [00:00<00:00, 27.47it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.02it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-09 09:15:42,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:42
2025-03-09 09:16:13,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8681 secs
2025-03-09 09:16:13,797 [INFO]: The best hyperparameters are: efSearch=170
2025-03-09 09:16:13,797 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 50%|█████     | 2/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-09 09:16:31,445 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6476 secs
2025-03-09 09:16:31,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7490 secs
2025-03-09 09:16:31,446 [INFO]: {
2025-03-09 09:16:31,446 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:31,446 [INFO]: 	index_param: efSearch=170
2025-03-09 09:16:31,447 [INFO]: 	index_path: knn.index
2025-03-09 09:16:31,447 [INFO]: 	size in bytes: 562097050
2025-03-09 09:16:31,447 [INFO]: 	avg_search_speed_ms: 8.603948915638542
2025-03-09 09:16:31,447 [INFO]: 	99p_search_speed_ms: 16.178098535165194
2025-03-09 09:16:31,447 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:31,447 [INFO]: 	nb vectors: 2857
2025-03-09 09:16:31,447 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:31,447 [INFO]: 	compression ratio: 0.9993097384161685
2025-03-09 09:16:31,447 [INFO]: }
2025-03-09 09:16:31,447 [INFO]: 	>>> Finished "Creating the index" in 50.7503 secs
2025-03-09 09:16:31,447 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7815 secs
2025-03-09 09:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 92174 [episode count 8/20]
[retrieval_preprocessing] for episode 51215 [episode count 9/20], we have num_retrieval=np.int64(2784) num_query=np.int64(199)
2025-03-09 09:16:32,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:32,902 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:32
2025-03-09 09:16:32,902 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.60it/s]
2025-03-09 09:16:32,932 [INFO]: There are 2784 embeddings of dim 49152
2025-03-09 09:16:32,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 09:16:32,933 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:32
2025-03-09 09:16:32,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:32,933 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:16:32,933 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:32,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:32,933 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:32
2025-03-09 09:16:32,933 [INFO]: 574.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:32,933 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:16:32,933 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:32
2025-03-09 09:16:32,933 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:32,933 [INFO]: 	Creating the index 03/09/2025, 09:16:32
2025-03-09 09:16:32,933 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:32
2025-03-09 09:16:32,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:16:32,934 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:32
2025-03-09 09:16:32,935 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:16:32,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.25it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.15it/s]100%|██████████| 11/11 [00:02<00:00,  4.13it/s]100%|██████████| 11/11 [00:02<00:00,  4.99it/s]
2025-03-09 09:16:35,142 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:35
2025-03-09 09:17:04,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1861 secs
2025-03-09 09:17:04,329 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:17:04,329 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.13it/s]
2025-03-09 09:17:28,914 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5849 secs
2025-03-09 09:17:28,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9817 secs
2025-03-09 09:17:28,916 [INFO]: {
2025-03-09 09:17:28,916 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:28,916 [INFO]: 	index_param: efSearch=219
2025-03-09 09:17:28,917 [INFO]: 	index_path: knn.index
2025-03-09 09:17:28,917 [INFO]: 	size in bytes: 547734670
2025-03-09 09:17:28,917 [INFO]: 	avg_search_speed_ms: 10.32513375677576
2025-03-09 09:17:28,917 [INFO]: 	99p_search_speed_ms: 17.203884413465858
2025-03-09 09:17:28,917 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:28,917 [INFO]: 	nb vectors: 2784
2025-03-09 09:17:28,917 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:28,917 [INFO]: 	compression ratio: 0.9993098884903524
2025-03-09 09:17:28,917 [INFO]: }
2025-03-09 09:17:28,917 [INFO]: 	>>> Finished "Creating the index" in 55.9834 secs
2025-03-09 09:17:28,917 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0148 secs
2025-03-09 09:17:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 51215 [episode count 9/20]
[retrieval_preprocessing] for episode 32784 [episode count 10/20], we have num_retrieval=np.int64(2857) num_query=np.int64(126)
2025-03-09 09:17:30,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:31,058 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:31
2025-03-09 09:17:31,058 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1813.36it/s]
2025-03-09 09:17:31,088 [INFO]: There are 2857 embeddings of dim 49152
2025-03-09 09:17:31,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:17:31,088 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:31
2025-03-09 09:17:31,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:31,088 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:17:31,088 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:31,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:31,088 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:31
2025-03-09 09:17:31,088 [INFO]: 589.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:31,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:17:31,088 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:31
2025-03-09 09:17:31,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:31,088 [INFO]: 	Creating the index 03/09/2025, 09:17:31
2025-03-09 09:17:31,088 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:31
2025-03-09 09:17:31,089 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:17:31,089 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:31
2025-03-09 09:17:31,089 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:17:31,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.35it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.94it/s]100%|██████████| 12/12 [00:02<00:00,  5.21it/s]
2025-03-09 09:17:33,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:33
2025-03-09 09:18:04,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1118 secs
2025-03-09 09:18:04,509 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:18:04,509 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-09 09:18:21,802 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2933 secs
2025-03-09 09:18:21,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7145 secs
2025-03-09 09:18:21,804 [INFO]: {
2025-03-09 09:18:21,804 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:21,804 [INFO]: 	index_param: efSearch=226
2025-03-09 09:18:21,804 [INFO]: 	index_path: knn.index
2025-03-09 09:18:21,804 [INFO]: 	size in bytes: 562097050
2025-03-09 09:18:21,804 [INFO]: 	avg_search_speed_ms: 10.578345056735452
2025-03-09 09:18:21,804 [INFO]: 	99p_search_speed_ms: 21.311849565245204
2025-03-09 09:18:21,804 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:21,804 [INFO]: 	nb vectors: 2857
2025-03-09 09:18:21,804 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:21,804 [INFO]: 	compression ratio: 0.9993097384161685
2025-03-09 09:18:21,804 [INFO]: }
2025-03-09 09:18:21,804 [INFO]: 	>>> Finished "Creating the index" in 50.7157 secs
2025-03-09 09:18:21,804 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7458 secs
2025-03-09 09:18:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 32784 [episode count 10/20]
[retrieval_preprocessing] for episode 24593 [episode count 11/20], we have num_retrieval=np.int64(2848) num_query=np.int64(135)
2025-03-09 09:18:23,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:23,378 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:23
2025-03-09 09:18:23,378 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-09 09:18:23,403 [INFO]: There are 2848 embeddings of dim 49152
2025-03-09 09:18:23,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:18:23,404 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:23,404 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:18:23,404 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:23,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:18:23,404 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,404 [INFO]: 587.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:23,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:18:23,404 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:23
2025-03-09 09:18:23,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:23,404 [INFO]: 	Creating the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,404 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:23
2025-03-09 09:18:23,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:18:23,405 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,405 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:18:23,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.72it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.31it/s]100%|██████████| 12/12 [00:02<00:00,  5.23it/s]
2025-03-09 09:18:25,703 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:25
2025-03-09 09:19:02,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5066 secs
2025-03-09 09:19:02,210 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 09:19:02,210 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-09 09:19:17,948 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7381 secs
2025-03-09 09:19:17,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5445 secs
2025-03-09 09:19:17,950 [INFO]: {
2025-03-09 09:19:17,950 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:17,950 [INFO]: 	index_param: efSearch=203
2025-03-09 09:19:17,950 [INFO]: 	index_path: knn.index
2025-03-09 09:19:17,950 [INFO]: 	size in bytes: 560326390
2025-03-09 09:19:17,950 [INFO]: 	avg_search_speed_ms: 9.39352742020268
2025-03-09 09:19:17,950 [INFO]: 	99p_search_speed_ms: 19.12152369506652
2025-03-09 09:19:17,950 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:17,950 [INFO]: 	nb vectors: 2848
2025-03-09 09:19:17,950 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:17,950 [INFO]: 	compression ratio: 0.9993096773471619
2025-03-09 09:19:17,950 [INFO]: }
2025-03-09 09:19:17,950 [INFO]: 	>>> Finished "Creating the index" in 54.5461 secs
2025-03-09 09:19:17,950 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5723 secs
2025-03-09 09:19:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 24593 [episode count 11/20]
[retrieval_preprocessing] for episode 24594 [episode count 12/20], we have num_retrieval=np.int64(2878) num_query=np.int64(105)
2025-03-09 09:19:19,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:19,774 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:19
2025-03-09 09:19:19,775 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.94it/s]
2025-03-09 09:19:19,806 [INFO]: There are 2878 embeddings of dim 49152
2025-03-09 09:19:19,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-09 09:19:19,806 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:19,807 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:19:19,807 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:19,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:19:19,807 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,807 [INFO]: 593.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:19,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:19:19,807 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:19
2025-03-09 09:19:19,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:19,807 [INFO]: 	Creating the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,807 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:19
2025-03-09 09:19:19,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:19:19,808 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,808 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:19:19,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.49it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.74it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]100%|██████████| 12/12 [00:02<00:00,  5.25it/s]
2025-03-09 09:19:22,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:22
2025-03-09 09:19:51,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3345 secs
2025-03-09 09:19:51,433 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 09:19:51,433 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-09 09:20:07,161 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7275 secs
2025-03-09 09:20:07,516 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7083 secs
2025-03-09 09:20:07,517 [INFO]: {
2025-03-09 09:20:07,517 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:07,517 [INFO]: 	index_param: efSearch=227
2025-03-09 09:20:07,517 [INFO]: 	index_path: knn.index
2025-03-09 09:20:07,517 [INFO]: 	size in bytes: 566228650
2025-03-09 09:20:07,517 [INFO]: 	avg_search_speed_ms: 11.981661619428925
2025-03-09 09:20:07,517 [INFO]: 	99p_search_speed_ms: 23.4704124368727
2025-03-09 09:20:07,517 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:07,517 [INFO]: 	nb vectors: 2878
2025-03-09 09:20:07,517 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:07,517 [INFO]: 	compression ratio: 0.9993097735340661
2025-03-09 09:20:07,517 [INFO]: }
2025-03-09 09:20:07,517 [INFO]: 	>>> Finished "Creating the index" in 47.7104 secs
2025-03-09 09:20:07,517 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7428 secs
2025-03-09 09:20:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 24594 [episode count 12/20]
[retrieval_preprocessing] for episode 38930 [episode count 13/20], we have num_retrieval=np.int64(2717) num_query=np.int64(266)
2025-03-09 09:20:08,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:09,224 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:09
2025-03-09 09:20:09,224 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.49it/s]
2025-03-09 09:20:09,254 [INFO]: There are 2717 embeddings of dim 49152
2025-03-09 09:20:09,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:20:09,254 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:09
2025-03-09 09:20:09,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:09,254 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:20:09,254 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:09,254 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:09,254 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:09
2025-03-09 09:20:09,254 [INFO]: 560.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:09,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:20:09,254 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:09
2025-03-09 09:20:09,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:09,255 [INFO]: 	Creating the index 03/09/2025, 09:20:09
2025-03-09 09:20:09,255 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:09
2025-03-09 09:20:09,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:20:09,256 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:09
2025-03-09 09:20:09,256 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:20:09,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.33it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.90it/s]100%|██████████| 11/11 [00:02<00:00,  4.31it/s]100%|██████████| 11/11 [00:02<00:00,  4.89it/s]
2025-03-09 09:20:11,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:11
2025-03-09 09:20:41,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1191 secs
2025-03-09 09:20:41,632 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:20:41,632 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.18it/s]
2025-03-09 09:20:55,525 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8926 secs
2025-03-09 09:20:55,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2712 secs
2025-03-09 09:20:55,527 [INFO]: {
2025-03-09 09:20:55,527 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:55,527 [INFO]: 	index_param: efSearch=224
2025-03-09 09:20:55,527 [INFO]: 	index_path: knn.index
2025-03-09 09:20:55,527 [INFO]: 	size in bytes: 534552910
2025-03-09 09:20:55,527 [INFO]: 	avg_search_speed_ms: 9.95459501789095
2025-03-09 09:20:55,527 [INFO]: 	99p_search_speed_ms: 20.9190650098026
2025-03-09 09:20:55,527 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:55,527 [INFO]: 	nb vectors: 2717
2025-03-09 09:20:55,527 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:55,527 [INFO]: 	compression ratio: 0.9993097521440861
2025-03-09 09:20:55,527 [INFO]: }
2025-03-09 09:20:55,527 [INFO]: 	>>> Finished "Creating the index" in 46.2728 secs
2025-03-09 09:20:55,527 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3036 secs
2025-03-09 09:20:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 38930 [episode count 13/20]
[retrieval_preprocessing] for episode 63505 [episode count 14/20], we have num_retrieval=np.int64(2834) num_query=np.int64(149)
2025-03-09 09:20:57,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:58,327 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:58
2025-03-09 09:20:58,327 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1047.53it/s]
2025-03-09 09:20:58,360 [INFO]: There are 2834 embeddings of dim 49152
2025-03-09 09:20:58,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:20:58,360 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:58
2025-03-09 09:20:58,361 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:58,361 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:20:58,361 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:58,361 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:58,361 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:58
2025-03-09 09:20:58,361 [INFO]: 584.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:58,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:20:58,361 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:58
2025-03-09 09:20:58,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:58,361 [INFO]: 	Creating the index 03/09/2025, 09:20:58
2025-03-09 09:20:58,361 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:58
2025-03-09 09:20:58,362 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:20:58,362 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:58
2025-03-09 09:20:58,362 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:20:58,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.83it/s] 67%|██████▋   | 8/12 [00:00<00:00, 40.91it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-09 09:21:00,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:00
2025-03-09 09:21:31,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4642 secs
2025-03-09 09:21:31,056 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 09:21:31,056 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-09 09:21:46,438 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3819 secs
2025-03-09 09:21:46,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0775 secs
2025-03-09 09:21:46,440 [INFO]: {
2025-03-09 09:21:46,440 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:46,440 [INFO]: 	index_param: efSearch=182
2025-03-09 09:21:46,440 [INFO]: 	index_path: knn.index
2025-03-09 09:21:46,440 [INFO]: 	size in bytes: 557572030
2025-03-09 09:21:46,440 [INFO]: 	avg_search_speed_ms: 8.631219690652745
2025-03-09 09:21:46,440 [INFO]: 	99p_search_speed_ms: 18.602721714414677
2025-03-09 09:21:46,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:46,440 [INFO]: 	nb vectors: 2834
2025-03-09 09:21:46,440 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:46,440 [INFO]: 	compression ratio: 0.9993095815799798
2025-03-09 09:21:46,440 [INFO]: }
2025-03-09 09:21:46,440 [INFO]: 	>>> Finished "Creating the index" in 48.0789 secs
2025-03-09 09:21:46,440 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1129 secs
2025-03-09 09:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 63505 [episode count 14/20]
[retrieval_preprocessing] for episode 4117 [episode count 15/20], we have num_retrieval=np.int64(2880) num_query=np.int64(103)
2025-03-09 09:21:47,864 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:48,225 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:48
2025-03-09 09:21:48,225 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1834.78it/s]
2025-03-09 09:21:48,253 [INFO]: There are 2880 embeddings of dim 49152
2025-03-09 09:21:48,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 09:21:48,253 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:48
2025-03-09 09:21:48,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:48,253 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:21:48,253 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:48,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:21:48,253 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:48
2025-03-09 09:21:48,253 [INFO]: 594.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:48,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:21:48,253 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:48
2025-03-09 09:21:48,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:48,253 [INFO]: 	Creating the index 03/09/2025, 09:21:48
2025-03-09 09:21:48,254 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:48
2025-03-09 09:21:48,255 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:21:48,255 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:48
2025-03-09 09:21:48,255 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:21:48,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.05it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.85it/s]100%|██████████| 12/12 [00:02<00:00,  4.31it/s]100%|██████████| 12/12 [00:02<00:00,  5.27it/s]
2025-03-09 09:21:50,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:50
2025-03-09 09:22:22,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9650 secs
2025-03-09 09:22:22,502 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 09:22:22,502 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.69it/s]
2025-03-09 09:22:37,683 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1811 secs
2025-03-09 09:22:37,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4298 secs
2025-03-09 09:22:37,685 [INFO]: {
2025-03-09 09:22:37,685 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:37,685 [INFO]: 	index_param: efSearch=172
2025-03-09 09:22:37,685 [INFO]: 	index_path: knn.index
2025-03-09 09:22:37,685 [INFO]: 	size in bytes: 566622190
2025-03-09 09:22:37,685 [INFO]: 	avg_search_speed_ms: 7.861607255371663
2025-03-09 09:22:37,685 [INFO]: 	99p_search_speed_ms: 16.330453536938855
2025-03-09 09:22:37,685 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:37,685 [INFO]: 	nb vectors: 2880
2025-03-09 09:22:37,685 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:37,685 [INFO]: 	compression ratio: 0.9993096811122063
2025-03-09 09:22:37,685 [INFO]: }
2025-03-09 09:22:37,685 [INFO]: 	>>> Finished "Creating the index" in 49.4317 secs
2025-03-09 09:22:37,685 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4599 secs
2025-03-09 09:22:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 4117 [episode count 15/20]
[retrieval_preprocessing] for episode 49174 [episode count 16/20], we have num_retrieval=np.int64(2859) num_query=np.int64(124)
2025-03-09 09:22:38,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:39,041 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:39
2025-03-09 09:22:39,041 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-09 09:22:39,074 [INFO]: There are 2859 embeddings of dim 49152
2025-03-09 09:22:39,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 09:22:39,075 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:39,075 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:22:39,075 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:39,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:22:39,075 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,075 [INFO]: 590.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:39,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:22:39,075 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:39
2025-03-09 09:22:39,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:39,075 [INFO]: 	Creating the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,075 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:39
2025-03-09 09:22:39,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:22:39,076 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,076 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:22:39,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.36it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.73it/s]100%|██████████| 12/12 [00:02<00:00,  4.43it/s]100%|██████████| 12/12 [00:02<00:00,  5.27it/s]
2025-03-09 09:22:41,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:41
2025-03-09 09:23:09,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6090 secs
2025-03-09 09:23:09,968 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 09:23:09,968 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.29it/s]
2025-03-09 09:23:30,499 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5309 secs
2025-03-09 09:23:30,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4240 secs
2025-03-09 09:23:30,501 [INFO]: {
2025-03-09 09:23:30,501 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:30,501 [INFO]: 	index_param: efSearch=250
2025-03-09 09:23:30,501 [INFO]: 	index_path: knn.index
2025-03-09 09:23:30,501 [INFO]: 	size in bytes: 562490530
2025-03-09 09:23:30,501 [INFO]: 	avg_search_speed_ms: 11.675018631573115
2025-03-09 09:23:30,501 [INFO]: 	99p_search_speed_ms: 25.74374048504978
2025-03-09 09:23:30,501 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:30,501 [INFO]: 	nb vectors: 2859
2025-03-09 09:23:30,501 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:30,501 [INFO]: 	compression ratio: 0.999309751934846
2025-03-09 09:23:30,501 [INFO]: }
2025-03-09 09:23:30,501 [INFO]: 	>>> Finished "Creating the index" in 51.4256 secs
2025-03-09 09:23:30,501 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4594 secs
2025-03-09 09:23:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 49174 [episode count 16/20]
[retrieval_preprocessing] for episode 67601 [episode count 17/20], we have num_retrieval=np.int64(2770) num_query=np.int64(213)
2025-03-09 09:23:32,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:32,485 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:32
2025-03-09 09:23:32,485 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.97it/s]
2025-03-09 09:23:32,510 [INFO]: There are 2770 embeddings of dim 49152
2025-03-09 09:23:32,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:23:32,510 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:32
2025-03-09 09:23:32,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:32,510 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:23:32,510 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:32,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:32,510 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:32
2025-03-09 09:23:32,510 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:32,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:32,511 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:32
2025-03-09 09:23:32,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:32,511 [INFO]: 	Creating the index 03/09/2025, 09:23:32
2025-03-09 09:23:32,511 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:32
2025-03-09 09:23:32,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:23:32,512 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:32
2025-03-09 09:23:32,512 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:23:32,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.54it/s] 73%|███████▎  | 8/11 [00:00<00:00, 35.28it/s]100%|██████████| 11/11 [00:01<00:00,  5.54it/s]
2025-03-09 09:23:34,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:34
2025-03-09 09:24:03,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8053 secs
2025-03-09 09:24:03,306 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 09:24:03,306 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.85it/s]
2025-03-09 09:24:16,170 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8637 secs
2025-03-09 09:24:16,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6601 secs
2025-03-09 09:24:16,172 [INFO]: {
2025-03-09 09:24:16,172 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:16,172 [INFO]: 	index_param: efSearch=228
2025-03-09 09:24:16,172 [INFO]: 	index_path: knn.index
2025-03-09 09:24:16,172 [INFO]: 	size in bytes: 544980310
2025-03-09 09:24:16,172 [INFO]: 	avg_search_speed_ms: 10.271677086168031
2025-03-09 09:24:16,172 [INFO]: 	99p_search_speed_ms: 21.480066012591124
2025-03-09 09:24:16,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:16,172 [INFO]: 	nb vectors: 2770
2025-03-09 09:24:16,172 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:16,172 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-09 09:24:16,172 [INFO]: }
2025-03-09 09:24:16,172 [INFO]: 	>>> Finished "Creating the index" in 43.6616 secs
2025-03-09 09:24:16,172 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6873 secs
2025-03-09 09:24:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 67601 [episode count 17/20]
[retrieval_preprocessing] for episode 73745 [episode count 18/20], we have num_retrieval=np.int64(2823) num_query=np.int64(160)
2025-03-09 09:24:18,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:18,631 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:18
2025-03-09 09:24:18,631 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1927.53it/s]
2025-03-09 09:24:18,664 [INFO]: There are 2823 embeddings of dim 49152
2025-03-09 09:24:18,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 09:24:18,664 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:18,664 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:24:18,664 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:18,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:24:18,664 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,664 [INFO]: 582.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:18,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:24:18,664 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:18
2025-03-09 09:24:18,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:18,664 [INFO]: 	Creating the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,664 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:18
2025-03-09 09:24:18,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:24:18,665 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,665 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:24:18,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.26it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.18it/s]100%|██████████| 12/12 [00:01<00:00,  5.17it/s]100%|██████████| 12/12 [00:01<00:00,  6.06it/s]
2025-03-09 09:24:20,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:20
2025-03-09 09:24:47,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8663 secs
2025-03-09 09:24:47,517 [INFO]: The best hyperparameters are: efSearch=170
2025-03-09 09:24:47,517 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.82it/s]
2025-03-09 09:25:03,811 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2939 secs
2025-03-09 09:25:03,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1474 secs
2025-03-09 09:25:03,813 [INFO]: {
2025-03-09 09:25:03,813 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:03,813 [INFO]: 	index_param: efSearch=170
2025-03-09 09:25:03,813 [INFO]: 	index_path: knn.index
2025-03-09 09:25:03,813 [INFO]: 	size in bytes: 555407710
2025-03-09 09:25:03,813 [INFO]: 	avg_search_speed_ms: 8.251330316168174
2025-03-09 09:25:03,813 [INFO]: 	99p_search_speed_ms: 17.885415370110437
2025-03-09 09:25:03,813 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:03,813 [INFO]: 	nb vectors: 2823
2025-03-09 09:25:03,813 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:03,813 [INFO]: 	compression ratio: 0.9993098295304543
2025-03-09 09:25:03,813 [INFO]: }
2025-03-09 09:25:03,813 [INFO]: 	>>> Finished "Creating the index" in 45.1486 secs
2025-03-09 09:25:03,813 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1819 secs
2025-03-09 09:25:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 73745 [episode count 18/20]
[retrieval_preprocessing] for episode 92179 [episode count 19/20], we have num_retrieval=np.int64(2863) num_query=np.int64(120)
2025-03-09 09:25:05,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:05,646 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:05
2025-03-09 09:25:05,646 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-09 09:25:05,673 [INFO]: There are 2863 embeddings of dim 49152
2025-03-09 09:25:05,673 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:25:05,673 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:05
2025-03-09 09:25:05,673 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:05,673 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:25:05,673 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:05,673 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:05,673 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:05
2025-03-09 09:25:05,673 [INFO]: 590.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:05,673 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:25:05,673 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:05
2025-03-09 09:25:05,673 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:05,673 [INFO]: 	Creating the index 03/09/2025, 09:25:05
2025-03-09 09:25:05,673 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:05
2025-03-09 09:25:05,674 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:25:05,674 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:05
2025-03-09 09:25:05,674 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:25:05,674 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.17it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.90it/s]100%|██████████| 12/12 [00:02<00:00,  4.87it/s]100%|██████████| 12/12 [00:02<00:00,  5.75it/s]
2025-03-09 09:25:07,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:07
2025-03-09 09:25:36,270 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5057 secs
2025-03-09 09:25:36,270 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 09:25:36,270 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.98it/s]
2025-03-09 09:25:55,119 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8489 secs
2025-03-09 09:25:55,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4464 secs
2025-03-09 09:25:55,121 [INFO]: {
2025-03-09 09:25:55,121 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:55,121 [INFO]: 	index_param: efSearch=298
2025-03-09 09:25:55,121 [INFO]: 	index_path: knn.index
2025-03-09 09:25:55,121 [INFO]: 	size in bytes: 563277550
2025-03-09 09:25:55,121 [INFO]: 	avg_search_speed_ms: 12.928915758453579
2025-03-09 09:25:55,121 [INFO]: 	99p_search_speed_ms: 27.85473025171086
2025-03-09 09:25:55,121 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:55,121 [INFO]: 	nb vectors: 2863
2025-03-09 09:25:55,121 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:55,121 [INFO]: 	compression ratio: 0.9993096724696378
2025-03-09 09:25:55,121 [INFO]: }
2025-03-09 09:25:55,121 [INFO]: 	>>> Finished "Creating the index" in 49.4478 secs
2025-03-09 09:25:55,121 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4748 secs
2025-03-09 09:25:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 92179 [episode count 19/20]
2025-03-09 09:25:57: [retrieval_preprocessing] finished for (-1, 'marker') [chosen_id count 7/10]
2025-03-09 09:25:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6078642573, 'marker') [chosen_id count 8/10]
2025-03-09 09:25:58: [retrieval_preprocessing] we have num_total=4259 embedding_dim=49152
[retrieval_preprocessing] for episode 2560 [episode count 0/20], we have num_retrieval=np.int64(4028) num_query=np.int64(231)
2025-03-09 09:25:58,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:59,281 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:59
2025-03-09 09:25:59,281 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1775.74it/s]
2025-03-09 09:25:59,311 [INFO]: There are 4028 embeddings of dim 49152
2025-03-09 09:25:59,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 09:25:59,311 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:59,311 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:25:59,311 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:59,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:59,311 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,312 [INFO]: 831.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:59,312 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:25:59,312 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:59
2025-03-09 09:25:59,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:59,312 [INFO]: 	Creating the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,312 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:59
2025-03-09 09:25:59,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:25:59,313 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,313 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:25:59,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.99it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.76it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.03it/s]100%|██████████| 16/16 [00:03<00:00,  4.27it/s]
2025-03-09 09:26:03,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:03
2025-03-09 09:26:47,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9852 secs
2025-03-09 09:26:47,051 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:26:47,051 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-09 09:27:08,321 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2705 secs
2025-03-09 09:27:08,324 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0106 secs
2025-03-09 09:27:08,324 [INFO]: {
2025-03-09 09:27:08,324 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:08,324 [INFO]: 	index_param: efSearch=262
2025-03-09 09:27:08,324 [INFO]: 	index_path: knn.index
2025-03-09 09:27:08,324 [INFO]: 	size in bytes: 792484990
2025-03-09 09:27:08,324 [INFO]: 	avg_search_speed_ms: 11.365541043183343
2025-03-09 09:27:08,324 [INFO]: 	99p_search_speed_ms: 27.22267998848113
2025-03-09 09:27:08,324 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:08,324 [INFO]: 	nb vectors: 4028
2025-03-09 09:27:08,324 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:08,324 [INFO]: 	compression ratio: 0.9993085471562054
2025-03-09 09:27:08,324 [INFO]: }
2025-03-09 09:27:08,324 [INFO]: 	>>> Finished "Creating the index" in 69.0123 secs
2025-03-09 09:27:08,324 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0434 secs
2025-03-09 09:27:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 2560 [episode count 0/20]
[retrieval_preprocessing] for episode 59265 [episode count 1/20], we have num_retrieval=np.int64(3961) num_query=np.int64(298)
2025-03-09 09:27:10,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:11,454 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:11
2025-03-09 09:27:11,454 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1896.16it/s]
2025-03-09 09:27:11,482 [INFO]: There are 3961 embeddings of dim 49152
2025-03-09 09:27:11,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 09:27:11,482 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:11
2025-03-09 09:27:11,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:11,483 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:27:11,483 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:11,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:11,483 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:11
2025-03-09 09:27:11,483 [INFO]: 817.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:11,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:27:11,483 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:11
2025-03-09 09:27:11,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:11,483 [INFO]: 	Creating the index 03/09/2025, 09:27:11
2025-03-09 09:27:11,483 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:11
2025-03-09 09:27:11,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:27:11,484 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:11
2025-03-09 09:27:11,484 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:27:11,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.36it/s] 31%|███▏      | 5/16 [00:00<00:00, 25.54it/s] 62%|██████▎   | 10/16 [00:00<00:00, 35.85it/s]100%|██████████| 16/16 [00:03<00:00,  3.88it/s]100%|██████████| 16/16 [00:03<00:00,  4.99it/s]
2025-03-09 09:27:14,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:14
2025-03-09 09:27:50,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1766 secs
2025-03-09 09:27:50,871 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 09:27:50,871 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.92it/s]
2025-03-09 09:28:09,730 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8585 secs
2025-03-09 09:28:09,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2479 secs
2025-03-09 09:28:09,732 [INFO]: {
2025-03-09 09:28:09,732 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:09,732 [INFO]: 	index_param: efSearch=145
2025-03-09 09:28:09,732 [INFO]: 	index_path: knn.index
2025-03-09 09:28:09,732 [INFO]: 	size in bytes: 779303170
2025-03-09 09:28:09,732 [INFO]: 	avg_search_speed_ms: 6.037063608992089
2025-03-09 09:28:09,732 [INFO]: 	99p_search_speed_ms: 12.09096197271721
2025-03-09 09:28:09,732 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:09,732 [INFO]: 	nb vectors: 3961
2025-03-09 09:28:09,732 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:09,732 [INFO]: 	compression ratio: 0.9993085078814705
2025-03-09 09:28:09,732 [INFO]: }
2025-03-09 09:28:09,732 [INFO]: 	>>> Finished "Creating the index" in 58.2495 secs
2025-03-09 09:28:09,732 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2784 secs
2025-03-09 09:28:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 59265 [episode count 1/20]
[retrieval_preprocessing] for episode 17414 [episode count 2/20], we have num_retrieval=np.int64(3916) num_query=np.int64(343)
2025-03-09 09:28:11,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:12,341 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:12
2025-03-09 09:28:12,341 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1850.97it/s]
2025-03-09 09:28:12,368 [INFO]: There are 3916 embeddings of dim 49152
2025-03-09 09:28:12,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:28:12,368 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:12
2025-03-09 09:28:12,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:12,369 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:28:12,369 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:12,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:28:12,369 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:12
2025-03-09 09:28:12,369 [INFO]: 808.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:12,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:28:12,369 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:12
2025-03-09 09:28:12,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:12,370 [INFO]: 	Creating the index 03/09/2025, 09:28:12
2025-03-09 09:28:12,370 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:12
2025-03-09 09:28:12,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:28:12,373 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:12
2025-03-09 09:28:12,373 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:28:12,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.74it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.97it/s] 81%|████████▏ | 13/16 [00:00<00:00, 45.99it/s]100%|██████████| 16/16 [00:03<00:00,  4.36it/s]
2025-03-09 09:28:16,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:16
2025-03-09 09:28:50,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1608 secs
2025-03-09 09:28:50,213 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:28:50,213 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-09 09:29:10,373 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1605 secs
2025-03-09 09:29:10,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0021 secs
2025-03-09 09:29:10,375 [INFO]: {
2025-03-09 09:29:10,375 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:10,375 [INFO]: 	index_param: efSearch=219
2025-03-09 09:29:10,375 [INFO]: 	index_path: knn.index
2025-03-09 09:29:10,375 [INFO]: 	size in bytes: 770449570
2025-03-09 09:29:10,375 [INFO]: 	avg_search_speed_ms: 9.681768868874041
2025-03-09 09:29:10,375 [INFO]: 	99p_search_speed_ms: 21.3879183679819
2025-03-09 09:29:10,375 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:10,375 [INFO]: 	nb vectors: 3916
2025-03-09 09:29:10,375 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:10,375 [INFO]: 	compression ratio: 0.9993086607861953
2025-03-09 09:29:10,375 [INFO]: }
2025-03-09 09:29:10,375 [INFO]: 	>>> Finished "Creating the index" in 58.0056 secs
2025-03-09 09:29:10,375 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0345 secs
2025-03-09 09:29:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 17414 [episode count 2/20]
[retrieval_preprocessing] for episode 49800 [episode count 3/20], we have num_retrieval=np.int64(4096) num_query=np.int64(163)
2025-03-09 09:29:12,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:13,719 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:13
2025-03-09 09:29:13,719 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1699.47it/s]
2025-03-09 09:29:13,746 [INFO]: There are 4096 embeddings of dim 49152
2025-03-09 09:29:13,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 09:29:13,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:13
2025-03-09 09:29:13,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:13,747 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:29:13,747 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:13,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:29:13,747 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:13
2025-03-09 09:29:13,748 [INFO]: 845.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:13,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:29:13,748 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:13
2025-03-09 09:29:13,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:13,748 [INFO]: 	Creating the index 03/09/2025, 09:29:13
2025-03-09 09:29:13,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:13
2025-03-09 09:29:13,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:29:13,751 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:13
2025-03-09 09:29:13,751 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:29:13,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 26.28it/s] 59%|█████▉    | 10/17 [00:00<00:00, 46.44it/s]100%|██████████| 17/17 [00:03<00:00,  4.22it/s]100%|██████████| 17/17 [00:03<00:00,  5.21it/s]
2025-03-09 09:29:17,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:17
2025-03-09 09:29:53,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9165 secs
2025-03-09 09:29:53,935 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 09:29:53,935 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-09 09:30:10,405 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4706 secs
2025-03-09 09:30:10,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6563 secs
2025-03-09 09:30:10,408 [INFO]: {
2025-03-09 09:30:10,408 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:10,408 [INFO]: 	index_param: efSearch=198
2025-03-09 09:30:10,408 [INFO]: 	index_path: knn.index
2025-03-09 09:30:10,408 [INFO]: 	size in bytes: 805863490
2025-03-09 09:30:10,408 [INFO]: 	avg_search_speed_ms: 8.874540954552254
2025-03-09 09:30:10,408 [INFO]: 	99p_search_speed_ms: 20.125387432053685
2025-03-09 09:30:10,408 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:10,408 [INFO]: 	nb vectors: 4096
2025-03-09 09:30:10,408 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:10,408 [INFO]: 	compression ratio: 0.9993086645481358
2025-03-09 09:30:10,408 [INFO]: }
2025-03-09 09:30:10,408 [INFO]: 	>>> Finished "Creating the index" in 56.6596 secs
2025-03-09 09:30:10,408 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6889 secs
2025-03-09 09:30:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 49800 [episode count 3/20]
[retrieval_preprocessing] for episode 27914 [episode count 4/20], we have num_retrieval=np.int64(4083) num_query=np.int64(176)
2025-03-09 09:30:12,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:12,576 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:12
2025-03-09 09:30:12,577 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-09 09:30:12,604 [INFO]: There are 4083 embeddings of dim 49152
2025-03-09 09:30:12,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:30:12,605 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:12
2025-03-09 09:30:12,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:12,605 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:30:12,605 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:12,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:12,605 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:12
2025-03-09 09:30:12,605 [INFO]: 842.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:12,605 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:30:12,605 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:12
2025-03-09 09:30:12,605 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:12,605 [INFO]: 	Creating the index 03/09/2025, 09:30:12
2025-03-09 09:30:12,605 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:12
2025-03-09 09:30:12,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:30:12,606 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:12
2025-03-09 09:30:12,606 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:30:12,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 26.01it/s] 53%|█████▎    | 9/17 [00:00<00:00, 41.94it/s] 88%|████████▊ | 15/17 [00:00<00:00, 45.95it/s]100%|██████████| 17/17 [00:03<00:00,  5.10it/s]
2025-03-09 09:30:16,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:16
2025-03-09 09:30:53,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4325 secs
2025-03-09 09:30:53,566 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 09:30:53,566 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.41it/s]
2025-03-09 09:31:08,262 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6968 secs
2025-03-09 09:31:08,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6586 secs
2025-03-09 09:31:08,265 [INFO]: {
2025-03-09 09:31:08,265 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:08,265 [INFO]: 	index_param: efSearch=216
2025-03-09 09:31:08,265 [INFO]: 	index_path: knn.index
2025-03-09 09:31:08,265 [INFO]: 	size in bytes: 803305870
2025-03-09 09:31:08,265 [INFO]: 	avg_search_speed_ms: 8.816724773282859
2025-03-09 09:31:08,265 [INFO]: 	99p_search_speed_ms: 17.808065153658394
2025-03-09 09:31:08,265 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:08,265 [INFO]: 	nb vectors: 4083
2025-03-09 09:31:08,265 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:08,265 [INFO]: 	compression ratio: 0.9993085995998012
2025-03-09 09:31:08,265 [INFO]: }
2025-03-09 09:31:08,265 [INFO]: 	>>> Finished "Creating the index" in 55.6599 secs
2025-03-09 09:31:08,265 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6885 secs
2025-03-09 09:31:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 27914 [episode count 4/20]
[retrieval_preprocessing] for episode 53642 [episode count 5/20], we have num_retrieval=np.int64(4089) num_query=np.int64(170)
2025-03-09 09:31:09,919 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:10,610 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:10
2025-03-09 09:31:10,610 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.73it/s]
2025-03-09 09:31:10,640 [INFO]: There are 4089 embeddings of dim 49152
2025-03-09 09:31:10,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 09:31:10,641 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:10
2025-03-09 09:31:10,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:10,641 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:31:10,641 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:10,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:10,641 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:10
2025-03-09 09:31:10,641 [INFO]: 843.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:10,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:31:10,641 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:10
2025-03-09 09:31:10,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:10,641 [INFO]: 	Creating the index 03/09/2025, 09:31:10
2025-03-09 09:31:10,641 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:10
2025-03-09 09:31:10,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:31:10,642 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:10
2025-03-09 09:31:10,643 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:31:10,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.74it/s] 35%|███▌      | 6/17 [00:00<00:00, 25.50it/s] 65%|██████▍   | 11/17 [00:00<00:00, 32.63it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.16it/s]100%|██████████| 17/17 [00:03<00:00,  5.16it/s]
2025-03-09 09:31:13,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:13
2025-03-09 09:31:49,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0497 secs
2025-03-09 09:31:49,994 [INFO]: The best hyperparameters are: efSearch=107
2025-03-09 09:31:49,994 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-09 09:32:10,259 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2653 secs
2025-03-09 09:32:10,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6191 secs
2025-03-09 09:32:10,262 [INFO]: {
2025-03-09 09:32:10,262 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:10,262 [INFO]: 	index_param: efSearch=107
2025-03-09 09:32:10,262 [INFO]: 	index_path: knn.index
2025-03-09 09:32:10,262 [INFO]: 	size in bytes: 804486310
2025-03-09 09:32:10,262 [INFO]: 	avg_search_speed_ms: 5.556504138196099
2025-03-09 09:32:10,262 [INFO]: 	99p_search_speed_ms: 14.309617890976366
2025-03-09 09:32:10,262 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:10,262 [INFO]: 	nb vectors: 4089
2025-03-09 09:32:10,262 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:10,262 [INFO]: 	compression ratio: 0.9993086296272711
2025-03-09 09:32:10,262 [INFO]: }
2025-03-09 09:32:10,262 [INFO]: 	>>> Finished "Creating the index" in 59.6207 secs
2025-03-09 09:32:10,262 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6518 secs
2025-03-09 09:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 53642 [episode count 5/20]
[retrieval_preprocessing] for episode 62476 [episode count 6/20], we have num_retrieval=np.int64(4109) num_query=np.int64(150)
2025-03-09 09:32:11,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:12,119 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:12
2025-03-09 09:32:12,119 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.16it/s]
2025-03-09 09:32:12,149 [INFO]: There are 4109 embeddings of dim 49152
2025-03-09 09:32:12,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 09:32:12,149 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:12,149 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:32:12,149 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:12,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:12,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,150 [INFO]: 848.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:12,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:12,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:12
2025-03-09 09:32:12,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:12,150 [INFO]: 	Creating the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:12
2025-03-09 09:32:12,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:32:12,151 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,151 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:32:12,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.77it/s] 41%|████      | 7/17 [00:00<00:00, 33.80it/s] 71%|███████   | 12/17 [00:00<00:00, 38.47it/s]100%|██████████| 17/17 [00:03<00:00,  3.44it/s]100%|██████████| 17/17 [00:03<00:00,  4.78it/s]
2025-03-09 09:32:15,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:15
2025-03-09 09:32:53,086 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3765 secs
2025-03-09 09:32:53,086 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 09:32:53,086 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.01it/s]
2025-03-09 09:33:12,962 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8763 secs
2025-03-09 09:33:12,965 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8142 secs
2025-03-09 09:33:12,965 [INFO]: {
2025-03-09 09:33:12,965 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:12,965 [INFO]: 	index_param: efSearch=183
2025-03-09 09:33:12,965 [INFO]: 	index_path: knn.index
2025-03-09 09:33:12,965 [INFO]: 	size in bytes: 808421170
2025-03-09 09:33:12,966 [INFO]: 	avg_search_speed_ms: 7.974702412035298
2025-03-09 09:33:12,966 [INFO]: 	99p_search_speed_ms: 17.955554139334712
2025-03-09 09:33:12,966 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:12,966 [INFO]: 	nb vectors: 4109
2025-03-09 09:33:12,966 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:12,966 [INFO]: 	compression ratio: 0.9993086549180794
2025-03-09 09:33:12,966 [INFO]: }
2025-03-09 09:33:12,966 [INFO]: 	>>> Finished "Creating the index" in 60.8158 secs
2025-03-09 09:33:12,966 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8464 secs
2025-03-09 09:33:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 62476 [episode count 6/20]
[retrieval_preprocessing] for episode 87306 [episode count 7/20], we have num_retrieval=np.int64(3978) num_query=np.int64(281)
2025-03-09 09:33:14,540 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:15,196 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:15
2025-03-09 09:33:15,196 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-09 09:33:15,220 [INFO]: There are 3978 embeddings of dim 49152
2025-03-09 09:33:15,220 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 09:33:15,220 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:15
2025-03-09 09:33:15,220 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:15,220 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:33:15,220 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:15,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:33:15,220 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:15
2025-03-09 09:33:15,220 [INFO]: 821.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:15,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:33:15,220 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:15
2025-03-09 09:33:15,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:15,220 [INFO]: 	Creating the index 03/09/2025, 09:33:15
2025-03-09 09:33:15,220 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:15
2025-03-09 09:33:15,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:33:15,221 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:15
2025-03-09 09:33:15,221 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:33:15,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.46it/s] 38%|███▊      | 6/16 [00:00<00:00, 32.00it/s] 75%|███████▌  | 12/16 [00:00<00:00, 42.36it/s]100%|██████████| 16/16 [00:02<00:00,  5.44it/s]
2025-03-09 09:33:18,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:18
2025-03-09 09:33:53,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7594 secs
2025-03-09 09:33:53,925 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 09:33:53,925 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 09:34:13,498 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5726 secs
2025-03-09 09:34:13,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2787 secs
2025-03-09 09:34:13,500 [INFO]: {
2025-03-09 09:34:13,500 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:13,500 [INFO]: 	index_param: efSearch=173
2025-03-09 09:34:13,500 [INFO]: 	index_path: knn.index
2025-03-09 09:34:13,500 [INFO]: 	size in bytes: 782647810
2025-03-09 09:34:13,500 [INFO]: 	avg_search_speed_ms: 7.288883204480943
2025-03-09 09:34:13,500 [INFO]: 	99p_search_speed_ms: 15.727899251505727
2025-03-09 09:34:13,500 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:13,500 [INFO]: 	nb vectors: 3978
2025-03-09 09:34:13,500 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:13,500 [INFO]: 	compression ratio: 0.999308519115386
2025-03-09 09:34:13,500 [INFO]: }
2025-03-09 09:34:13,500 [INFO]: 	>>> Finished "Creating the index" in 58.2800 secs
2025-03-09 09:34:13,500 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3044 secs
2025-03-09 09:34:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 87306 [episode count 7/20]
[retrieval_preprocessing] for episode 24851 [episode count 8/20], we have num_retrieval=np.int64(4091) num_query=np.int64(168)
2025-03-09 09:34:15,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:15,862 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:15
2025-03-09 09:34:15,862 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2379.07it/s]
2025-03-09 09:34:15,888 [INFO]: There are 4091 embeddings of dim 49152
2025-03-09 09:34:15,888 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:34:15,888 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:15
2025-03-09 09:34:15,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:15,888 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:34:15,888 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:15,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:15,889 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:15
2025-03-09 09:34:15,889 [INFO]: 844.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:15,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:34:15,889 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:15
2025-03-09 09:34:15,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:15,889 [INFO]: 	Creating the index 03/09/2025, 09:34:15
2025-03-09 09:34:15,889 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:15
2025-03-09 09:34:15,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:34:15,890 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:15
2025-03-09 09:34:15,890 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:34:15,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.64it/s] 53%|█████▎    | 9/17 [00:00<00:00, 43.56it/s]100%|██████████| 17/17 [00:03<00:00,  4.26it/s]100%|██████████| 17/17 [00:03<00:00,  5.07it/s]
2025-03-09 09:34:19,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:19
2025-03-09 09:34:55,918 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6708 secs
2025-03-09 09:34:55,919 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 09:34:55,919 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-09 09:35:13,022 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1035 secs
2025-03-09 09:35:14,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1726 secs
2025-03-09 09:35:14,063 [INFO]: {
2025-03-09 09:35:14,063 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:14,063 [INFO]: 	index_param: efSearch=182
2025-03-09 09:35:14,063 [INFO]: 	index_path: knn.index
2025-03-09 09:35:14,063 [INFO]: 	size in bytes: 804879790
2025-03-09 09:35:14,063 [INFO]: 	avg_search_speed_ms: 8.293146239153447
2025-03-09 09:35:14,063 [INFO]: 	99p_search_speed_ms: 23.250261531211443
2025-03-09 09:35:14,063 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:14,063 [INFO]: 	nb vectors: 4091
2025-03-09 09:35:14,063 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:14,063 [INFO]: 	compression ratio: 0.9993086396168551
2025-03-09 09:35:14,063 [INFO]: }
2025-03-09 09:35:14,063 [INFO]: 	>>> Finished "Creating the index" in 58.1747 secs
2025-03-09 09:35:14,064 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2013 secs
2025-03-09 09:35:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 24851 [episode count 8/20]
[retrieval_preprocessing] for episode 28438 [episode count 9/20], we have num_retrieval=np.int64(4025) num_query=np.int64(234)
2025-03-09 09:35:15,724 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:16,370 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:16
2025-03-09 09:35:16,370 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1573.26it/s]
2025-03-09 09:35:16,392 [INFO]: There are 4025 embeddings of dim 49152
2025-03-09 09:35:16,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 09:35:16,392 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:16
2025-03-09 09:35:16,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:16,392 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:35:16,392 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:16,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:35:16,392 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:16
2025-03-09 09:35:16,393 [INFO]: 830.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:16,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:35:16,393 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:16
2025-03-09 09:35:16,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:16,393 [INFO]: 	Creating the index 03/09/2025, 09:35:16
2025-03-09 09:35:16,393 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:16
2025-03-09 09:35:16,394 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:35:16,394 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:16
2025-03-09 09:35:16,394 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:35:16,394 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.06it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.95it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.69it/s]100%|██████████| 16/16 [00:03<00:00,  5.00it/s]
2025-03-09 09:35:19,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:19
2025-03-09 09:35:56,134 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5323 secs
2025-03-09 09:35:56,134 [INFO]: The best hyperparameters are: efSearch=130
2025-03-09 09:35:56,134 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]
2025-03-09 09:36:10,419 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2851 secs
2025-03-09 09:36:10,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0275 secs
2025-03-09 09:36:10,422 [INFO]: {
2025-03-09 09:36:10,422 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:10,422 [INFO]: 	index_param: efSearch=130
2025-03-09 09:36:10,422 [INFO]: 	index_path: knn.index
2025-03-09 09:36:10,422 [INFO]: 	size in bytes: 791894770
2025-03-09 09:36:10,422 [INFO]: 	avg_search_speed_ms: 5.471221357380098
2025-03-09 09:36:10,422 [INFO]: 	99p_search_speed_ms: 10.101425838656723
2025-03-09 09:36:10,422 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:10,422 [INFO]: 	nb vectors: 4025
2025-03-09 09:36:10,422 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:10,422 [INFO]: 	compression ratio: 0.9993085318646567
2025-03-09 09:36:10,422 [INFO]: }
2025-03-09 09:36:10,422 [INFO]: 	>>> Finished "Creating the index" in 54.0291 secs
2025-03-09 09:36:10,422 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0517 secs
2025-03-09 09:36:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 28438 [episode count 9/20]
[retrieval_preprocessing] for episode 80279 [episode count 10/20], we have num_retrieval=np.int64(4052) num_query=np.int64(207)
2025-03-09 09:36:11,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:12,469 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:12
2025-03-09 09:36:12,469 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1850.16it/s]
2025-03-09 09:36:12,499 [INFO]: There are 4052 embeddings of dim 49152
2025-03-09 09:36:12,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 09:36:12,499 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:12
2025-03-09 09:36:12,499 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:12,499 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:36:12,499 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:12,499 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:36:12,499 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:12
2025-03-09 09:36:12,499 [INFO]: 836.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:12,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:36:12,499 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:12
2025-03-09 09:36:12,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:12,500 [INFO]: 	Creating the index 03/09/2025, 09:36:12
2025-03-09 09:36:12,500 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:12
2025-03-09 09:36:12,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:36:12,501 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:12
2025-03-09 09:36:12,501 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:36:12,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.97it/s] 44%|████▍     | 7/16 [00:00<00:00, 37.95it/s] 81%|████████▏ | 13/16 [00:00<00:00, 47.30it/s]100%|██████████| 16/16 [00:03<00:00,  4.91it/s]
2025-03-09 09:36:15,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:15
2025-03-09 09:36:54,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3267 secs
2025-03-09 09:36:54,091 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 09:36:54,092 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 09:37:09,209 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1177 secs
2025-03-09 09:37:09,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7112 secs
2025-03-09 09:37:09,212 [INFO]: {
2025-03-09 09:37:09,212 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:09,212 [INFO]: 	index_param: efSearch=254
2025-03-09 09:37:09,212 [INFO]: 	index_path: knn.index
2025-03-09 09:37:09,212 [INFO]: 	size in bytes: 797206810
2025-03-09 09:37:09,212 [INFO]: 	avg_search_speed_ms: 9.667802802039589
2025-03-09 09:37:09,212 [INFO]: 	99p_search_speed_ms: 16.69449826236814
2025-03-09 09:37:09,212 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:09,212 [INFO]: 	nb vectors: 4052
2025-03-09 09:37:09,212 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:09,212 [INFO]: 	compression ratio: 0.9993085934627176
2025-03-09 09:37:09,212 [INFO]: }
2025-03-09 09:37:09,212 [INFO]: 	>>> Finished "Creating the index" in 56.7127 secs
2025-03-09 09:37:09,212 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7433 secs
2025-03-09 09:37:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 80279 [episode count 10/20]
[retrieval_preprocessing] for episode 19609 [episode count 11/20], we have num_retrieval=np.int64(4092) num_query=np.int64(167)
2025-03-09 09:37:12,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:12,718 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:12
2025-03-09 09:37:12,718 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2132.34it/s]
2025-03-09 09:37:12,743 [INFO]: There are 4092 embeddings of dim 49152
2025-03-09 09:37:12,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:37:12,743 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:12
2025-03-09 09:37:12,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:12,743 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:37:12,743 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:12,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:12,743 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:12
2025-03-09 09:37:12,743 [INFO]: 844.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:12,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:37:12,743 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:12
2025-03-09 09:37:12,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:12,743 [INFO]: 	Creating the index 03/09/2025, 09:37:12
2025-03-09 09:37:12,743 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:12
2025-03-09 09:37:12,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:37:12,744 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:12
2025-03-09 09:37:12,744 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:37:12,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.77it/s] 41%|████      | 7/17 [00:00<00:00, 30.41it/s] 76%|███████▋  | 13/17 [00:00<00:00, 39.54it/s]100%|██████████| 17/17 [00:03<00:00,  4.57it/s]
2025-03-09 09:37:16,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:16
2025-03-09 09:37:54,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5144 secs
2025-03-09 09:37:54,986 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 09:37:54,986 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-09 09:38:15,266 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2795 secs
2025-03-09 09:38:15,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5238 secs
2025-03-09 09:38:15,268 [INFO]: {
2025-03-09 09:38:15,268 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:15,268 [INFO]: 	index_param: efSearch=162
2025-03-09 09:38:15,268 [INFO]: 	index_path: knn.index
2025-03-09 09:38:15,268 [INFO]: 	size in bytes: 805076530
2025-03-09 09:38:15,269 [INFO]: 	avg_search_speed_ms: 6.678580921597446
2025-03-09 09:38:15,269 [INFO]: 	99p_search_speed_ms: 13.270689444616426
2025-03-09 09:38:15,269 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:15,269 [INFO]: 	nb vectors: 4092
2025-03-09 09:38:15,269 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:15,269 [INFO]: 	compression ratio: 0.9993086446079853
2025-03-09 09:38:15,269 [INFO]: }
2025-03-09 09:38:15,269 [INFO]: 	>>> Finished "Creating the index" in 62.5253 secs
2025-03-09 09:38:15,269 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5505 secs
2025-03-09 09:38:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 19609 [episode count 11/20]
[retrieval_preprocessing] for episode 27169 [episode count 12/20], we have num_retrieval=np.int64(4076) num_query=np.int64(183)
2025-03-09 09:38:16,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:17,413 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:17
2025-03-09 09:38:17,413 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 09:38:17,443 [INFO]: There are 4076 embeddings of dim 49152
2025-03-09 09:38:17,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:38:17,443 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:17
2025-03-09 09:38:17,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:17,443 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:38:17,443 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:17,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:38:17,443 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:17
2025-03-09 09:38:17,443 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:17,443 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:38:17,443 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:17
2025-03-09 09:38:17,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:17,443 [INFO]: 	Creating the index 03/09/2025, 09:38:17
2025-03-09 09:38:17,444 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:17
2025-03-09 09:38:17,444 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:38:17,444 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:17
2025-03-09 09:38:17,445 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:38:17,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.71it/s] 41%|████      | 7/17 [00:00<00:00, 33.47it/s] 76%|███████▋  | 13/17 [00:00<00:00, 43.35it/s]100%|██████████| 17/17 [00:03<00:00,  4.77it/s]
2025-03-09 09:38:21,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:21
2025-03-09 09:38:57,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4733 secs
2025-03-09 09:38:57,490 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 09:38:57,490 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-09 09:39:16,342 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8527 secs
2025-03-09 09:39:16,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8999 secs
2025-03-09 09:39:16,345 [INFO]: {
2025-03-09 09:39:16,345 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:16,345 [INFO]: 	index_param: efSearch=169
2025-03-09 09:39:16,345 [INFO]: 	index_path: knn.index
2025-03-09 09:39:16,345 [INFO]: 	size in bytes: 801928630
2025-03-09 09:39:16,345 [INFO]: 	avg_search_speed_ms: 6.6484463329308054
2025-03-09 09:39:16,345 [INFO]: 	99p_search_speed_ms: 12.934270205441868
2025-03-09 09:39:16,345 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:16,345 [INFO]: 	nb vectors: 4076
2025-03-09 09:39:16,345 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:16,345 [INFO]: 	compression ratio: 0.999308639223917
2025-03-09 09:39:16,345 [INFO]: }
2025-03-09 09:39:16,345 [INFO]: 	>>> Finished "Creating the index" in 58.9012 secs
2025-03-09 09:39:16,345 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9320 secs
2025-03-09 09:39:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 27169 [episode count 12/20]
[retrieval_preprocessing] for episode 47526 [episode count 13/20], we have num_retrieval=np.int64(4094) num_query=np.int64(165)
2025-03-09 09:39:17,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:18,216 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:18
2025-03-09 09:39:18,216 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-09 09:39:18,241 [INFO]: There are 4094 embeddings of dim 49152
2025-03-09 09:39:18,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 09:39:18,242 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:18
2025-03-09 09:39:18,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:18,242 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:39:18,242 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:18,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:18,242 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:18
2025-03-09 09:39:18,242 [INFO]: 844.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:18,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:39:18,242 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:18
2025-03-09 09:39:18,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:18,242 [INFO]: 	Creating the index 03/09/2025, 09:39:18
2025-03-09 09:39:18,242 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:18
2025-03-09 09:39:18,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:39:18,244 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:18
2025-03-09 09:39:18,244 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:39:18,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.88it/s] 59%|█████▉    | 10/17 [00:00<00:00, 51.01it/s]100%|██████████| 17/17 [00:02<00:00,  5.45it/s]100%|██████████| 17/17 [00:02<00:00,  6.59it/s]
2025-03-09 09:39:20,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:20
2025-03-09 09:39:55,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0456 secs
2025-03-09 09:39:55,875 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 09:39:55,875 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-09 09:40:11,076 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2006 secs
2025-03-09 09:40:11,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8347 secs
2025-03-09 09:40:11,079 [INFO]: {
2025-03-09 09:40:11,079 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:11,079 [INFO]: 	index_param: efSearch=238
2025-03-09 09:40:11,079 [INFO]: 	index_path: knn.index
2025-03-09 09:40:11,079 [INFO]: 	size in bytes: 805470010
2025-03-09 09:40:11,079 [INFO]: 	avg_search_speed_ms: 8.959230386041185
2025-03-09 09:40:11,079 [INFO]: 	99p_search_speed_ms: 15.9717985196039
2025-03-09 09:40:11,079 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:11,079 [INFO]: 	nb vectors: 4094
2025-03-09 09:40:11,079 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:11,079 [INFO]: 	compression ratio: 0.999308654582931
2025-03-09 09:40:11,079 [INFO]: }
2025-03-09 09:40:11,079 [INFO]: 	>>> Finished "Creating the index" in 52.8367 secs
2025-03-09 09:40:11,079 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8630 secs
2025-03-09 09:40:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 47526 [episode count 13/20]
[retrieval_preprocessing] for episode 48552 [episode count 14/20], we have num_retrieval=np.int64(4054) num_query=np.int64(205)
2025-03-09 09:40:12,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:13,409 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:13
2025-03-09 09:40:13,409 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.02it/s]
2025-03-09 09:40:13,439 [INFO]: There are 4054 embeddings of dim 49152
2025-03-09 09:40:13,440 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 09:40:13,440 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:13
2025-03-09 09:40:13,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:13,440 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:40:13,440 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:13,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:13,440 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:13
2025-03-09 09:40:13,440 [INFO]: 836.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:13,440 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:13,440 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:13
2025-03-09 09:40:13,440 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:13,440 [INFO]: 	Creating the index 03/09/2025, 09:40:13
2025-03-09 09:40:13,440 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:13
2025-03-09 09:40:13,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:40:13,441 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:13
2025-03-09 09:40:13,441 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:40:13,441 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.91it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.85it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.43it/s]100%|██████████| 16/16 [00:03<00:00,  5.07it/s]
2025-03-09 09:40:16,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:16
2025-03-09 09:40:53,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9238 secs
2025-03-09 09:40:53,526 [INFO]: The best hyperparameters are: efSearch=166
2025-03-09 09:40:53,526 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-09 09:41:07,348 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8223 secs
2025-03-09 09:41:07,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9089 secs
2025-03-09 09:41:07,350 [INFO]: {
2025-03-09 09:41:07,350 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:07,350 [INFO]: 	index_param: efSearch=166
2025-03-09 09:41:07,350 [INFO]: 	index_path: knn.index
2025-03-09 09:41:07,350 [INFO]: 	size in bytes: 797600290
2025-03-09 09:41:07,350 [INFO]: 	avg_search_speed_ms: 7.006765220878148
2025-03-09 09:41:07,350 [INFO]: 	99p_search_speed_ms: 11.557456334121525
2025-03-09 09:41:07,350 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:07,350 [INFO]: 	nb vectors: 4054
2025-03-09 09:41:07,350 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:07,350 [INFO]: 	compression ratio: 0.9993086035613151
2025-03-09 09:41:07,350 [INFO]: }
2025-03-09 09:41:07,350 [INFO]: 	>>> Finished "Creating the index" in 53.9103 secs
2025-03-09 09:41:07,350 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9414 secs
2025-03-09 09:41:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 48552 [episode count 14/20]
[retrieval_preprocessing] for episode 86442 [episode count 15/20], we have num_retrieval=np.int64(4050) num_query=np.int64(209)
2025-03-09 09:41:08,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:09,770 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:09
2025-03-09 09:41:09,770 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-09 09:41:09,793 [INFO]: There are 4050 embeddings of dim 49152
2025-03-09 09:41:09,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 09:41:09,793 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:09
2025-03-09 09:41:09,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:09,793 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:41:09,793 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:09,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:41:09,793 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:09
2025-03-09 09:41:09,793 [INFO]: 835.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:09,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:41:09,793 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:09
2025-03-09 09:41:09,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:09,793 [INFO]: 	Creating the index 03/09/2025, 09:41:09
2025-03-09 09:41:09,793 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:09
2025-03-09 09:41:09,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:41:09,794 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:09
2025-03-09 09:41:09,795 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:41:09,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.89it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.43it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.99it/s]100%|██████████| 16/16 [00:03<00:00,  3.76it/s]100%|██████████| 16/16 [00:03<00:00,  5.28it/s]
2025-03-09 09:41:12,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:12
2025-03-09 09:41:48,821 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9935 secs
2025-03-09 09:41:48,821 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 09:41:48,821 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.56it/s]
2025-03-09 09:42:02,591 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7695 secs
2025-03-09 09:42:02,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7986 secs
2025-03-09 09:42:02,593 [INFO]: {
2025-03-09 09:42:02,593 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:02,593 [INFO]: 	index_param: efSearch=242
2025-03-09 09:42:02,593 [INFO]: 	index_path: knn.index
2025-03-09 09:42:02,593 [INFO]: 	size in bytes: 796813330
2025-03-09 09:42:02,593 [INFO]: 	avg_search_speed_ms: 9.714859787338566
2025-03-09 09:42:02,593 [INFO]: 	99p_search_speed_ms: 20.17569336574525
2025-03-09 09:42:02,593 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:02,593 [INFO]: 	nb vectors: 4050
2025-03-09 09:42:02,593 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:02,593 [INFO]: 	compression ratio: 0.9993085833541464
2025-03-09 09:42:02,593 [INFO]: }
2025-03-09 09:42:02,593 [INFO]: 	>>> Finished "Creating the index" in 52.7999 secs
2025-03-09 09:42:02,593 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8232 secs
2025-03-09 09:42:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 86442 [episode count 15/20]
[retrieval_preprocessing] for episode 80429 [episode count 16/20], we have num_retrieval=np.int64(3930) num_query=np.int64(329)
2025-03-09 09:42:04,492 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:04,977 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:04
2025-03-09 09:42:04,977 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-09 09:42:05,003 [INFO]: There are 3930 embeddings of dim 49152
2025-03-09 09:42:05,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:42:05,004 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:05,004 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:42:05,004 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:05,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:05,004 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,004 [INFO]: 811.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:05,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:42:05,004 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:05
2025-03-09 09:42:05,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:05,004 [INFO]: 	Creating the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,004 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:05
2025-03-09 09:42:05,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:42:05,005 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,005 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:42:05,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.93it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.20it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.29it/s]100%|██████████| 16/16 [00:03<00:00,  4.52it/s]
2025-03-09 09:42:08,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:08
2025-03-09 09:42:44,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6406 secs
2025-03-09 09:42:44,186 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 09:42:44,186 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-09 09:43:01,487 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3007 secs
2025-03-09 09:43:01,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4835 secs
2025-03-09 09:43:01,489 [INFO]: {
2025-03-09 09:43:01,489 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:01,489 [INFO]: 	index_param: efSearch=240
2025-03-09 09:43:01,489 [INFO]: 	index_path: knn.index
2025-03-09 09:43:01,489 [INFO]: 	size in bytes: 773204110
2025-03-09 09:43:01,489 [INFO]: 	avg_search_speed_ms: 9.535949134549305
2025-03-09 09:43:01,489 [INFO]: 	99p_search_speed_ms: 19.731004629284143
2025-03-09 09:43:01,489 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:01,489 [INFO]: 	nb vectors: 3930
2025-03-09 09:43:01,489 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:01,489 [INFO]: 	compression ratio: 0.9993085008303952
2025-03-09 09:43:01,489 [INFO]: }
2025-03-09 09:43:01,489 [INFO]: 	>>> Finished "Creating the index" in 56.4848 secs
2025-03-09 09:43:01,489 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5120 secs
2025-03-09 09:43:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 80429 [episode count 16/20]
[retrieval_preprocessing] for episode 45614 [episode count 17/20], we have num_retrieval=np.int64(4077) num_query=np.int64(182)
2025-03-09 09:43:04,548 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:06,383 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:06
2025-03-09 09:43:06,383 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1843.65it/s]
2025-03-09 09:43:06,409 [INFO]: There are 4077 embeddings of dim 49152
2025-03-09 09:43:06,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 09:43:06,410 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:06
2025-03-09 09:43:06,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:06,410 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:43:06,410 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:06,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:43:06,410 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:06
2025-03-09 09:43:06,410 [INFO]: 841.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:06,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:43:06,411 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:06
2025-03-09 09:43:06,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:06,411 [INFO]: 	Creating the index 03/09/2025, 09:43:06
2025-03-09 09:43:06,411 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:06
2025-03-09 09:43:06,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:43:06,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:06
2025-03-09 09:43:06,414 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:43:06,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 26.60it/s] 59%|█████▉    | 10/17 [00:00<00:00, 48.25it/s]100%|██████████| 17/17 [00:02<00:00,  4.96it/s]100%|██████████| 17/17 [00:02<00:00,  6.10it/s]
2025-03-09 09:43:09,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:09
2025-03-09 09:43:43,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6347 secs
2025-03-09 09:43:43,842 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:43:43,842 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.11it/s]
2025-03-09 09:44:09,134 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2914 secs
2025-03-09 09:44:09,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7216 secs
2025-03-09 09:44:09,136 [INFO]: {
2025-03-09 09:44:09,136 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:09,136 [INFO]: 	index_param: efSearch=239
2025-03-09 09:44:09,136 [INFO]: 	index_path: knn.index
2025-03-09 09:44:09,136 [INFO]: 	size in bytes: 802125370
2025-03-09 09:44:09,136 [INFO]: 	avg_search_speed_ms: 9.301897869120504
2025-03-09 09:44:09,136 [INFO]: 	99p_search_speed_ms: 18.65129318088293
2025-03-09 09:44:09,136 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:09,136 [INFO]: 	nb vectors: 4077
2025-03-09 09:44:09,136 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:09,136 [INFO]: 	compression ratio: 0.9993086442335067
2025-03-09 09:44:09,136 [INFO]: }
2025-03-09 09:44:09,136 [INFO]: 	>>> Finished "Creating the index" in 62.7250 secs
2025-03-09 09:44:09,136 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7527 secs
2025-03-09 09:44:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 45614 [episode count 17/20]
[retrieval_preprocessing] for episode 67887 [episode count 18/20], we have num_retrieval=np.int64(4032) num_query=np.int64(227)
2025-03-09 09:44:11,423 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:12,385 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:12
2025-03-09 09:44:12,385 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.20it/s]
2025-03-09 09:44:12,418 [INFO]: There are 4032 embeddings of dim 49152
2025-03-09 09:44:12,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-09 09:44:12,419 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:12
2025-03-09 09:44:12,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:12,419 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:44:12,419 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:12,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:12,419 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:12
2025-03-09 09:44:12,419 [INFO]: 832.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:12,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:44:12,419 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:12
2025-03-09 09:44:12,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:12,419 [INFO]: 	Creating the index 03/09/2025, 09:44:12
2025-03-09 09:44:12,419 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:12
2025-03-09 09:44:12,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:44:12,420 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:12
2025-03-09 09:44:12,420 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:44:12,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.07it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.85it/s] 69%|██████▉   | 11/16 [00:00<00:00, 38.28it/s]100%|██████████| 16/16 [00:03<00:00,  3.66it/s]100%|██████████| 16/16 [00:03<00:00,  4.92it/s]
2025-03-09 09:44:15,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:15
2025-03-09 09:44:52,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0156 secs
2025-03-09 09:44:52,695 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 09:44:52,695 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-09 09:45:08,386 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6907 secs
2025-03-09 09:45:08,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9676 secs
2025-03-09 09:45:08,388 [INFO]: {
2025-03-09 09:45:08,388 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:08,388 [INFO]: 	index_param: efSearch=218
2025-03-09 09:45:08,388 [INFO]: 	index_path: knn.index
2025-03-09 09:45:08,388 [INFO]: 	size in bytes: 793271950
2025-03-09 09:45:08,388 [INFO]: 	avg_search_speed_ms: 8.950651061346782
2025-03-09 09:45:08,388 [INFO]: 	99p_search_speed_ms: 17.81087935902178
2025-03-09 09:45:08,388 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:08,388 [INFO]: 	nb vectors: 4032
2025-03-09 09:45:08,388 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:08,388 [INFO]: 	compression ratio: 0.9993085675095407
2025-03-09 09:45:08,388 [INFO]: }
2025-03-09 09:45:08,388 [INFO]: 	>>> Finished "Creating the index" in 55.9689 secs
2025-03-09 09:45:08,388 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0033 secs
2025-03-09 09:45:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 67887 [episode count 18/20]
[retrieval_preprocessing] for episode 2096 [episode count 19/20], we have num_retrieval=np.int64(4088) num_query=np.int64(171)
2025-03-09 09:45:10,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:10,873 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:10
2025-03-09 09:45:10,873 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2172.09it/s]
2025-03-09 09:45:10,899 [INFO]: There are 4088 embeddings of dim 49152
2025-03-09 09:45:10,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:45:10,899 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:10
2025-03-09 09:45:10,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:10,899 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:45:10,899 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:10,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:10,899 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:10
2025-03-09 09:45:10,899 [INFO]: 843.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:10,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:10,899 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:10
2025-03-09 09:45:10,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:10,899 [INFO]: 	Creating the index 03/09/2025, 09:45:10
2025-03-09 09:45:10,899 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:10
2025-03-09 09:45:10,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:45:10,901 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:10
2025-03-09 09:45:10,901 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:45:10,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.08it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.29it/s] 71%|███████   | 12/17 [00:00<00:00, 39.84it/s]100%|██████████| 17/17 [00:03<00:00,  3.90it/s]100%|██████████| 17/17 [00:03<00:00,  5.24it/s]
2025-03-09 09:45:14,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:14
2025-03-09 09:45:52,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1306 secs
2025-03-09 09:45:52,279 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 09:45:52,279 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.92it/s]
2025-03-09 09:46:13,563 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2833 secs
2025-03-09 09:46:13,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6643 secs
2025-03-09 09:46:13,566 [INFO]: {
2025-03-09 09:46:13,566 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:13,566 [INFO]: 	index_param: efSearch=165
2025-03-09 09:46:13,566 [INFO]: 	index_path: knn.index
2025-03-09 09:46:13,566 [INFO]: 	size in bytes: 804289570
2025-03-09 09:46:13,566 [INFO]: 	avg_search_speed_ms: 6.687099963931186
2025-03-09 09:46:13,566 [INFO]: 	99p_search_speed_ms: 14.180841655470426
2025-03-09 09:46:13,566 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:13,566 [INFO]: 	nb vectors: 4088
2025-03-09 09:46:13,566 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:13,566 [INFO]: 	compression ratio: 0.9993086246288138
2025-03-09 09:46:13,566 [INFO]: }
2025-03-09 09:46:13,566 [INFO]: 	>>> Finished "Creating the index" in 62.6665 secs
2025-03-09 09:46:13,566 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6932 secs
2025-03-09 09:46:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 2096 [episode count 19/20]
2025-03-09 09:46:14: [retrieval_preprocessing] finished for (6078642573, 'marker') [chosen_id count 8/10]
2025-03-09 09:46:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (452818143, 'lid') [chosen_id count 9/10]
2025-03-09 09:46:16: [retrieval_preprocessing] we have num_total=4948 embedding_dim=49152
[retrieval_preprocessing] for episode 52738 [episode count 0/20], we have num_retrieval=np.int64(4795) num_query=np.int64(153)
2025-03-09 09:46:16,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:17,372 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:17
2025-03-09 09:46:17,373 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-09 09:46:17,407 [INFO]: There are 4795 embeddings of dim 49152
2025-03-09 09:46:17,407 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 09:46:17,407 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:17
2025-03-09 09:46:17,407 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:17,407 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:46:17,407 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:17,407 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:17,408 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:17
2025-03-09 09:46:17,408 [INFO]: 989.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:17,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:46:17,408 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:17
2025-03-09 09:46:17,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:17,408 [INFO]: 	Creating the index 03/09/2025, 09:46:17
2025-03-09 09:46:17,408 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:17
2025-03-09 09:46:17,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:46:17,409 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:17
2025-03-09 09:46:17,409 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:46:17,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.65it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.43it/s] 63%|██████▎   | 12/19 [00:00<00:00, 39.37it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.24it/s]100%|██████████| 19/19 [00:03<00:00,  5.27it/s]
2025-03-09 09:46:21,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:21
2025-03-09 09:47:02,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1826 secs
2025-03-09 09:47:02,203 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 09:47:02,203 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-09 09:47:24,164 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9602 secs
2025-03-09 09:47:24,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7567 secs
2025-03-09 09:47:24,166 [INFO]: {
2025-03-09 09:47:24,166 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:24,166 [INFO]: 	index_param: efSearch=222
2025-03-09 09:47:24,166 [INFO]: 	index_path: knn.index
2025-03-09 09:47:24,166 [INFO]: 	size in bytes: 943387510
2025-03-09 09:47:24,166 [INFO]: 	avg_search_speed_ms: 9.401790162240315
2025-03-09 09:47:24,166 [INFO]: 	99p_search_speed_ms: 21.487502246163746
2025-03-09 09:47:24,166 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:24,166 [INFO]: 	nb vectors: 4795
2025-03-09 09:47:24,166 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:24,166 [INFO]: 	compression ratio: 0.9993087146129378
2025-03-09 09:47:24,166 [INFO]: }
2025-03-09 09:47:24,166 [INFO]: 	>>> Finished "Creating the index" in 66.7583 secs
2025-03-09 09:47:24,166 [INFO]: >>> Finished "Launching the whole pipeline" in 66.7937 secs
2025-03-09 09:47:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 52738 [episode count 0/20]
[retrieval_preprocessing] for episode 5637 [episode count 1/20], we have num_retrieval=np.int64(4777) num_query=np.int64(171)
2025-03-09 09:47:25,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:27,298 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:27
2025-03-09 09:47:27,298 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2309.64it/s]
2025-03-09 09:47:27,325 [INFO]: There are 4777 embeddings of dim 49152
2025-03-09 09:47:27,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:47:27,325 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:27,325 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:47:27,325 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:27,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:27,325 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,325 [INFO]: 985.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:27,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:47:27,325 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:27
2025-03-09 09:47:27,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:27,325 [INFO]: 	Creating the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,325 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:27
2025-03-09 09:47:27,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:47:27,326 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,327 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:47:27,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.66it/s] 42%|████▏     | 8/19 [00:00<00:00, 42.08it/s] 74%|███████▎  | 14/19 [00:00<00:00, 49.23it/s]100%|██████████| 19/19 [00:03<00:00,  3.40it/s]100%|██████████| 19/19 [00:03<00:00,  4.84it/s]
2025-03-09 09:47:31,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:31
2025-03-09 09:48:15,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8483 secs
2025-03-09 09:48:15,108 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 09:48:15,108 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.65it/s]
2025-03-09 09:48:31,690 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5819 secs
2025-03-09 09:48:31,693 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3666 secs
2025-03-09 09:48:31,693 [INFO]: {
2025-03-09 09:48:31,693 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:31,693 [INFO]: 	index_param: efSearch=290
2025-03-09 09:48:31,693 [INFO]: 	index_path: knn.index
2025-03-09 09:48:31,693 [INFO]: 	size in bytes: 939846190
2025-03-09 09:48:31,693 [INFO]: 	avg_search_speed_ms: 10.898684934420766
2025-03-09 09:48:31,693 [INFO]: 	99p_search_speed_ms: 17.932595640886575
2025-03-09 09:48:31,693 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:31,693 [INFO]: 	nb vectors: 4777
2025-03-09 09:48:31,693 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:31,693 [INFO]: 	compression ratio: 0.9993086379378736
2025-03-09 09:48:31,693 [INFO]: }
2025-03-09 09:48:31,693 [INFO]: 	>>> Finished "Creating the index" in 64.3681 secs
2025-03-09 09:48:31,694 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3955 secs
2025-03-09 09:48:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 5637 [episode count 1/20]
[retrieval_preprocessing] for episode 24582 [episode count 2/20], we have num_retrieval=np.int64(4620) num_query=np.int64(328)
2025-03-09 09:48:35,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:35,895 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:35
2025-03-09 09:48:35,895 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1616.93it/s]
2025-03-09 09:48:35,928 [INFO]: There are 4620 embeddings of dim 49152
2025-03-09 09:48:35,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 09:48:35,928 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:35
2025-03-09 09:48:35,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:35,928 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:48:35,928 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:35,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:48:35,928 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:35
2025-03-09 09:48:35,928 [INFO]: 953.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:35,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:48:35,929 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:35
2025-03-09 09:48:35,929 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:35,929 [INFO]: 	Creating the index 03/09/2025, 09:48:35
2025-03-09 09:48:35,929 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:35
2025-03-09 09:48:35,930 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:48:35,930 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:35
2025-03-09 09:48:35,930 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:48:35,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.17it/s] 37%|███▋      | 7/19 [00:00<00:00, 36.62it/s] 68%|██████▊   | 13/19 [00:00<00:00, 45.08it/s]100%|██████████| 19/19 [00:03<00:00,  4.03it/s]100%|██████████| 19/19 [00:03<00:00,  5.48it/s]
2025-03-09 09:48:39,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:39
2025-03-09 09:49:18,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3622 secs
2025-03-09 09:49:18,762 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 09:49:18,762 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-09 09:49:34,989 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2268 secs
2025-03-09 09:49:34,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0617 secs
2025-03-09 09:49:34,992 [INFO]: {
2025-03-09 09:49:34,992 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:34,992 [INFO]: 	index_param: efSearch=299
2025-03-09 09:49:34,992 [INFO]: 	index_path: knn.index
2025-03-09 09:49:34,992 [INFO]: 	size in bytes: 908957170
2025-03-09 09:49:34,992 [INFO]: 	avg_search_speed_ms: 11.216675490715161
2025-03-09 09:49:34,992 [INFO]: 	99p_search_speed_ms: 17.710095136426393
2025-03-09 09:49:34,992 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:34,992 [INFO]: 	nb vectors: 4620
2025-03-09 09:49:34,992 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:34,992 [INFO]: 	compression ratio: 0.9993088673253988
2025-03-09 09:49:34,992 [INFO]: }
2025-03-09 09:49:34,992 [INFO]: 	>>> Finished "Creating the index" in 59.0634 secs
2025-03-09 09:49:34,992 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0974 secs
2025-03-09 09:49:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 24582 [episode count 2/20]
[retrieval_preprocessing] for episode 25607 [episode count 3/20], we have num_retrieval=np.int64(4728) num_query=np.int64(220)
2025-03-09 09:49:38,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:39,082 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:39
2025-03-09 09:49:39,082 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2141.04it/s]
2025-03-09 09:49:39,111 [INFO]: There are 4728 embeddings of dim 49152
2025-03-09 09:49:39,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 09:49:39,111 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:39
2025-03-09 09:49:39,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:39,111 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:49:39,111 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:39,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:39,111 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:39
2025-03-09 09:49:39,111 [INFO]: 975.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:39,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:49:39,111 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:39
2025-03-09 09:49:39,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:39,112 [INFO]: 	Creating the index 03/09/2025, 09:49:39
2025-03-09 09:49:39,112 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:39
2025-03-09 09:49:39,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:49:39,113 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:39
2025-03-09 09:49:39,113 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:49:39,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.17it/s] 47%|████▋     | 9/19 [00:00<00:00, 45.09it/s] 79%|███████▉  | 15/19 [00:00<00:00, 50.62it/s]100%|██████████| 19/19 [00:03<00:00,  5.90it/s]
2025-03-09 09:49:42,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:42
2025-03-09 09:50:19,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9298 secs
2025-03-09 09:50:19,268 [INFO]: The best hyperparameters are: efSearch=303
2025-03-09 09:50:19,268 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-09 09:50:41,055 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7875 secs
2025-03-09 09:50:41,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9452 secs
2025-03-09 09:50:41,058 [INFO]: {
2025-03-09 09:50:41,058 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:41,058 [INFO]: 	index_param: efSearch=303
2025-03-09 09:50:41,058 [INFO]: 	index_path: knn.index
2025-03-09 09:50:41,058 [INFO]: 	size in bytes: 930205690
2025-03-09 09:50:41,058 [INFO]: 	avg_search_speed_ms: 11.964672391300656
2025-03-09 09:50:41,058 [INFO]: 	99p_search_speed_ms: 26.886055839713656
2025-03-09 09:50:41,058 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:41,058 [INFO]: 	nb vectors: 4728
2025-03-09 09:50:41,058 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:41,058 [INFO]: 	compression ratio: 0.9993086840825496
2025-03-09 09:50:41,058 [INFO]: }
2025-03-09 09:50:41,058 [INFO]: 	>>> Finished "Creating the index" in 61.9466 secs
2025-03-09 09:50:41,058 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9762 secs
2025-03-09 09:50:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 25607 [episode count 3/20]
[retrieval_preprocessing] for episode 90118 [episode count 4/20], we have num_retrieval=np.int64(4733) num_query=np.int64(215)
2025-03-09 09:50:43,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:44,496 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:44
2025-03-09 09:50:44,496 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.09it/s]
2025-03-09 09:50:44,530 [INFO]: There are 4733 embeddings of dim 49152
2025-03-09 09:50:44,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-09 09:50:44,530 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:44
2025-03-09 09:50:44,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:44,530 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:50:44,530 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:44,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:44,530 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:44
2025-03-09 09:50:44,531 [INFO]: 976.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:44,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:50:44,531 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:44
2025-03-09 09:50:44,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:44,531 [INFO]: 	Creating the index 03/09/2025, 09:50:44
2025-03-09 09:50:44,531 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:44
2025-03-09 09:50:44,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:50:44,532 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:44
2025-03-09 09:50:44,532 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:50:44,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.12it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.36it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.42it/s]100%|██████████| 19/19 [00:03<00:00,  3.76it/s]100%|██████████| 19/19 [00:03<00:00,  5.05it/s]
2025-03-09 09:50:48,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:48
2025-03-09 09:51:28,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2632 secs
2025-03-09 09:51:28,562 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 09:51:28,562 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.52it/s]
2025-03-09 09:51:44,961 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3984 secs
2025-03-09 09:51:44,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4314 secs
2025-03-09 09:51:44,963 [INFO]: {
2025-03-09 09:51:44,963 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:44,963 [INFO]: 	index_param: efSearch=238
2025-03-09 09:51:44,963 [INFO]: 	index_path: knn.index
2025-03-09 09:51:44,963 [INFO]: 	size in bytes: 931189390
2025-03-09 09:51:44,963 [INFO]: 	avg_search_speed_ms: 10.352713187267584
2025-03-09 09:51:44,963 [INFO]: 	99p_search_speed_ms: 24.61050585843623
2025-03-09 09:51:44,963 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:44,963 [INFO]: 	nb vectors: 4733
2025-03-09 09:51:44,963 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:44,963 [INFO]: 	compression ratio: 0.9993087056114331
2025-03-09 09:51:44,963 [INFO]: }
2025-03-09 09:51:44,963 [INFO]: 	>>> Finished "Creating the index" in 60.4327 secs
2025-03-09 09:51:44,963 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4672 secs
2025-03-09 09:51:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 90118 [episode count 4/20]
[retrieval_preprocessing] for episode 19977 [episode count 5/20], we have num_retrieval=np.int64(4596) num_query=np.int64(352)
2025-03-09 09:51:47,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:47,863 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:47
2025-03-09 09:51:47,863 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-09 09:51:47,896 [INFO]: There are 4596 embeddings of dim 49152
2025-03-09 09:51:47,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 09:51:47,896 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:47
2025-03-09 09:51:47,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:47,896 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:51:47,896 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:47,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:47,896 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:47
2025-03-09 09:51:47,896 [INFO]: 948.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:47,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:51:47,896 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:47
2025-03-09 09:51:47,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:47,896 [INFO]: 	Creating the index 03/09/2025, 09:51:47
2025-03-09 09:51:47,896 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:47
2025-03-09 09:51:47,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:51:47,897 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:47
2025-03-09 09:51:47,897 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:51:47,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.93it/s] 37%|███▋      | 7/19 [00:00<00:00, 35.43it/s] 58%|█████▊    | 11/19 [00:00<00:00, 34.21it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.83it/s]100%|██████████| 19/19 [00:03<00:00,  5.49it/s]
2025-03-09 09:51:51,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:51
2025-03-09 09:52:29,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2523 secs
2025-03-09 09:52:29,616 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 09:52:29,616 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.99it/s]
2025-03-09 09:52:47,824 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2080 secs
2025-03-09 09:52:47,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9294 secs
2025-03-09 09:52:47,827 [INFO]: {
2025-03-09 09:52:47,827 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:47,827 [INFO]: 	index_param: efSearch=282
2025-03-09 09:52:47,827 [INFO]: 	index_path: knn.index
2025-03-09 09:52:47,827 [INFO]: 	size in bytes: 904235350
2025-03-09 09:52:47,827 [INFO]: 	avg_search_speed_ms: 12.142762812464815
2025-03-09 09:52:47,827 [INFO]: 	99p_search_speed_ms: 21.608039664570235
2025-03-09 09:52:47,827 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:47,827 [INFO]: 	nb vectors: 4596
2025-03-09 09:52:47,827 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:47,827 [INFO]: 	compression ratio: 0.9993088281717807
2025-03-09 09:52:47,827 [INFO]: }
2025-03-09 09:52:47,827 [INFO]: 	>>> Finished "Creating the index" in 59.9308 secs
2025-03-09 09:52:47,827 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9644 secs
2025-03-09 09:52:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 19977 [episode count 5/20]
[retrieval_preprocessing] for episode 36876 [episode count 6/20], we have num_retrieval=np.int64(4766) num_query=np.int64(182)
2025-03-09 09:52:51,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:52,093 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:52
2025-03-09 09:52:52,093 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1282.66it/s]
2025-03-09 09:52:53,144 [INFO]: There are 4766 embeddings of dim 49152
2025-03-09 09:52:53,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 1.0512 secs
2025-03-09 09:52:53,144 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:53
2025-03-09 09:52:53,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:53,145 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:52:53,145 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:53,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:52:53,145 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:53
2025-03-09 09:52:53,145 [INFO]: 983.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:53,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:52:53,145 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:53
2025-03-09 09:52:53,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:53,145 [INFO]: 	Creating the index 03/09/2025, 09:52:53
2025-03-09 09:52:53,145 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:53
2025-03-09 09:52:53,147 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:52:53,147 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:53
2025-03-09 09:52:53,147 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:52:53,147 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.59it/s] 32%|███▏      | 6/19 [00:00<00:00, 23.46it/s] 53%|█████▎    | 10/19 [00:00<00:00, 29.50it/s] 79%|███████▉  | 15/19 [00:00<00:00, 34.61it/s]100%|██████████| 19/19 [00:04<00:00,  2.92it/s]100%|██████████| 19/19 [00:04<00:00,  4.52it/s]
2025-03-09 09:52:57,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:57
2025-03-09 09:53:36,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1454 secs
2025-03-09 09:53:36,498 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 09:53:36,498 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.91it/s]
2025-03-09 09:53:58,448 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9503 secs
2025-03-09 09:53:58,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3035 secs
2025-03-09 09:53:58,451 [INFO]: {
2025-03-09 09:53:58,451 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:58,451 [INFO]: 	index_param: efSearch=234
2025-03-09 09:53:58,451 [INFO]: 	index_path: knn.index
2025-03-09 09:53:58,451 [INFO]: 	size in bytes: 937682050
2025-03-09 09:53:58,451 [INFO]: 	avg_search_speed_ms: 9.980549811368842
2025-03-09 09:53:58,451 [INFO]: 	99p_search_speed_ms: 22.14991585584358
2025-03-09 09:53:58,451 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:58,451 [INFO]: 	nb vectors: 4766
2025-03-09 09:53:58,451 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:58,451 [INFO]: 	compression ratio: 0.999308590795782
2025-03-09 09:53:58,451 [INFO]: }
2025-03-09 09:53:58,451 [INFO]: 	>>> Finished "Creating the index" in 65.3056 secs
2025-03-09 09:53:58,451 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3578 secs
2025-03-09 09:53:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 36876 [episode count 6/20]
[retrieval_preprocessing] for episode 58897 [episode count 7/20], we have num_retrieval=np.int64(4714) num_query=np.int64(234)
2025-03-09 09:54:00,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:01,319 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:01
2025-03-09 09:54:01,319 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.55it/s]
2025-03-09 09:54:01,351 [INFO]: There are 4714 embeddings of dim 49152
2025-03-09 09:54:01,351 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 09:54:01,351 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:01
2025-03-09 09:54:01,351 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:01,351 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:54:01,351 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:01,351 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:54:01,351 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:01
2025-03-09 09:54:01,351 [INFO]: 972.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:01,352 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:54:01,352 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:01
2025-03-09 09:54:01,352 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:01,352 [INFO]: 	Creating the index 03/09/2025, 09:54:01
2025-03-09 09:54:01,352 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:01
2025-03-09 09:54:01,353 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:54:01,353 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:01
2025-03-09 09:54:01,353 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:54:01,353 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.25it/s] 42%|████▏     | 8/19 [00:00<00:00, 39.58it/s] 74%|███████▎  | 14/19 [00:00<00:00, 47.23it/s]100%|██████████| 19/19 [00:03<00:00,  3.85it/s]100%|██████████| 19/19 [00:03<00:00,  5.44it/s]
2025-03-09 09:54:04,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:04
2025-03-09 09:54:42,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2790 secs
2025-03-09 09:54:42,128 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 09:54:42,128 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-09 09:55:03,347 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2185 secs
2025-03-09 09:55:03,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4608 secs
2025-03-09 09:55:03,814 [INFO]: {
2025-03-09 09:55:03,814 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:03,814 [INFO]: 	index_param: efSearch=258
2025-03-09 09:55:03,814 [INFO]: 	index_path: knn.index
2025-03-09 09:55:03,814 [INFO]: 	size in bytes: 927451330
2025-03-09 09:55:03,814 [INFO]: 	avg_search_speed_ms: 8.826907218408435
2025-03-09 09:55:03,814 [INFO]: 	99p_search_speed_ms: 18.544123638421322
2025-03-09 09:55:03,814 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:03,814 [INFO]: 	nb vectors: 4714
2025-03-09 09:55:03,814 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:03,814 [INFO]: 	compression ratio: 0.9993086235587155
2025-03-09 09:55:03,815 [INFO]: }
2025-03-09 09:55:03,815 [INFO]: 	>>> Finished "Creating the index" in 62.4629 secs
2025-03-09 09:55:03,815 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4953 secs
2025-03-09 09:55:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 58897 [episode count 7/20]
[retrieval_preprocessing] for episode 83473 [episode count 8/20], we have num_retrieval=np.int64(4810) num_query=np.int64(138)
2025-03-09 09:55:06,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:06,881 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:06
2025-03-09 09:55:06,881 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.55it/s]
2025-03-09 09:55:06,918 [INFO]: There are 4810 embeddings of dim 49152
2025-03-09 09:55:06,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-09 09:55:06,918 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:06
2025-03-09 09:55:06,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:06,918 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:55:06,918 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:06,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:06,918 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:06
2025-03-09 09:55:06,919 [INFO]: 992.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:06,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:55:06,919 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:06
2025-03-09 09:55:06,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:06,919 [INFO]: 	Creating the index 03/09/2025, 09:55:06
2025-03-09 09:55:06,919 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:06
2025-03-09 09:55:06,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:55:06,920 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:06
2025-03-09 09:55:06,920 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:55:06,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.47it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.34it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.08it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.02it/s]100%|██████████| 19/19 [00:03<00:00,  5.17it/s]
2025-03-09 09:55:10,596 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:10
2025-03-09 09:55:50,259 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6629 secs
2025-03-09 09:55:50,260 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 09:55:50,260 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.03it/s]
2025-03-09 09:56:13,852 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5917 secs
2025-03-09 09:56:14,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2335 secs
2025-03-09 09:56:14,154 [INFO]: {
2025-03-09 09:56:14,154 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:14,154 [INFO]: 	index_param: efSearch=181
2025-03-09 09:56:14,154 [INFO]: 	index_path: knn.index
2025-03-09 09:56:14,154 [INFO]: 	size in bytes: 946338730
2025-03-09 09:56:14,154 [INFO]: 	avg_search_speed_ms: 7.79705236786403
2025-03-09 09:56:14,154 [INFO]: 	99p_search_speed_ms: 13.813658352009961
2025-03-09 09:56:14,154 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:14,154 [INFO]: 	nb vectors: 4810
2025-03-09 09:56:14,155 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:14,155 [INFO]: 	compression ratio: 0.9993086513536226
2025-03-09 09:56:14,155 [INFO]: }
2025-03-09 09:56:14,155 [INFO]: 	>>> Finished "Creating the index" in 67.2359 secs
2025-03-09 09:56:14,155 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2734 secs
2025-03-09 09:56:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 83473 [episode count 8/20]
[retrieval_preprocessing] for episode 46612 [episode count 9/20], we have num_retrieval=np.int64(4664) num_query=np.int64(284)
2025-03-09 09:56:15,385 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:16,405 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:16
2025-03-09 09:56:16,405 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2177.73it/s]
2025-03-09 09:56:16,439 [INFO]: There are 4664 embeddings of dim 49152
2025-03-09 09:56:16,439 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-09 09:56:16,440 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:16
2025-03-09 09:56:16,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:16,440 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:56:16,440 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:16,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:56:16,440 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:16
2025-03-09 09:56:16,441 [INFO]: 962.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:16,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:56:16,441 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:16
2025-03-09 09:56:16,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:16,442 [INFO]: 	Creating the index 03/09/2025, 09:56:16
2025-03-09 09:56:16,442 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:16
2025-03-09 09:56:16,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:56:16,445 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:16
2025-03-09 09:56:16,445 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:56:16,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.22it/s] 42%|████▏     | 8/19 [00:00<00:00, 42.07it/s] 74%|███████▎  | 14/19 [00:00<00:00, 49.34it/s]100%|██████████| 19/19 [00:03<00:00,  3.89it/s]100%|██████████| 19/19 [00:03<00:00,  5.50it/s]
2025-03-09 09:56:19,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:19
2025-03-09 09:56:59,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6315 secs
2025-03-09 09:56:59,534 [INFO]: The best hyperparameters are: efSearch=303
2025-03-09 09:56:59,534 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.11it/s]
2025-03-09 09:57:19,819 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2849 secs
2025-03-09 09:57:19,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3769 secs
2025-03-09 09:57:19,822 [INFO]: {
2025-03-09 09:57:19,822 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:19,822 [INFO]: 	index_param: efSearch=303
2025-03-09 09:57:19,822 [INFO]: 	index_path: knn.index
2025-03-09 09:57:19,822 [INFO]: 	size in bytes: 917614030
2025-03-09 09:57:19,822 [INFO]: 	avg_search_speed_ms: 12.207917215800656
2025-03-09 09:57:19,822 [INFO]: 	99p_search_speed_ms: 23.30021961592131
2025-03-09 09:57:19,822 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:19,822 [INFO]: 	nb vectors: 4664
2025-03-09 09:57:19,822 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:19,822 [INFO]: 	compression ratio: 0.9993087311448365
2025-03-09 09:57:19,822 [INFO]: }
2025-03-09 09:57:19,822 [INFO]: 	>>> Finished "Creating the index" in 63.3806 secs
2025-03-09 09:57:19,822 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4174 secs
2025-03-09 09:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 46612 [episode count 9/20]
[retrieval_preprocessing] for episode 40981 [episode count 10/20], we have num_retrieval=np.int64(4616) num_query=np.int64(332)
2025-03-09 09:57:23,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:23,878 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:23
2025-03-09 09:57:23,878 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1028.02it/s]
2025-03-09 09:57:23,915 [INFO]: There are 4616 embeddings of dim 49152
2025-03-09 09:57:23,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-09 09:57:23,915 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:23
2025-03-09 09:57:23,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:23,915 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:57:23,915 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:23,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:23,915 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:23
2025-03-09 09:57:23,915 [INFO]: 952.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:23,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:57:23,915 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:23
2025-03-09 09:57:23,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:23,915 [INFO]: 	Creating the index 03/09/2025, 09:57:23
2025-03-09 09:57:23,915 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:23
2025-03-09 09:57:23,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:57:23,917 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:23
2025-03-09 09:57:23,917 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:57:23,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.02it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.30it/s] 74%|███████▎  | 14/19 [00:00<00:00, 47.43it/s]100%|██████████| 19/19 [00:03<00:00,  3.76it/s]100%|██████████| 19/19 [00:03<00:00,  5.31it/s]
2025-03-09 09:57:28,102 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:28
2025-03-09 09:58:09,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0370 secs
2025-03-09 09:58:09,140 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 09:58:09,140 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-09 09:58:24,925 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7847 secs
2025-03-09 09:58:24,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0105 secs
2025-03-09 09:58:24,927 [INFO]: {
2025-03-09 09:58:24,927 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:24,927 [INFO]: 	index_param: efSearch=211
2025-03-09 09:58:24,927 [INFO]: 	index_path: knn.index
2025-03-09 09:58:24,928 [INFO]: 	size in bytes: 908170210
2025-03-09 09:58:24,928 [INFO]: 	avg_search_speed_ms: 9.038925000801548
2025-03-09 09:58:24,928 [INFO]: 	99p_search_speed_ms: 15.34553202800454
2025-03-09 09:58:24,928 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:24,928 [INFO]: 	nb vectors: 4616
2025-03-09 09:58:24,928 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:24,928 [INFO]: 	compression ratio: 0.999308849824528
2025-03-09 09:58:24,928 [INFO]: }
2025-03-09 09:58:24,928 [INFO]: 	>>> Finished "Creating the index" in 61.0122 secs
2025-03-09 09:58:24,928 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0498 secs
2025-03-09 09:58:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 40981 [episode count 10/20]
[retrieval_preprocessing] for episode 85526 [episode count 11/20], we have num_retrieval=np.int64(4434) num_query=np.int64(514)
2025-03-09 09:58:29,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:30,111 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:30
2025-03-09 09:58:30,111 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 994.62it/s]
2025-03-09 09:58:30,141 [INFO]: There are 4434 embeddings of dim 49152
2025-03-09 09:58:30,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 09:58:30,141 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:30
2025-03-09 09:58:30,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:30,141 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:58:30,141 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:30,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:58:30,142 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:30
2025-03-09 09:58:30,142 [INFO]: 915.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:30,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:58:30,142 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:30
2025-03-09 09:58:30,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:30,142 [INFO]: 	Creating the index 03/09/2025, 09:58:30
2025-03-09 09:58:30,142 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:30
2025-03-09 09:58:30,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:58:30,143 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:30
2025-03-09 09:58:30,143 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:58:30,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.01it/s] 11%|█         | 2/18 [00:00<00:02,  6.89it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.75it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.34it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.60it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.75it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.84it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.90it/s] 50%|█████     | 9/18 [00:01<00:00,  9.02it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.99it/s] 61%|██████    | 11/18 [00:01<00:00,  9.03it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.94it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.93it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.01it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.00it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.16it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.22it/s]100%|██████████| 18/18 [00:05<00:00,  1.21s/it]100%|██████████| 18/18 [00:05<00:00,  3.13it/s]
2025-03-09 09:58:35,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:35
2025-03-09 09:59:18,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4448 secs
2025-03-09 09:59:18,339 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 09:59:18,339 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s]
2025-03-09 09:59:36,248 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9083 secs
2025-03-09 09:59:36,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1077 secs
2025-03-09 09:59:36,251 [INFO]: {
2025-03-09 09:59:36,251 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:36,251 [INFO]: 	index_param: efSearch=164
2025-03-09 09:59:36,251 [INFO]: 	index_path: knn.index
2025-03-09 09:59:36,251 [INFO]: 	size in bytes: 872362990
2025-03-09 09:59:36,251 [INFO]: 	avg_search_speed_ms: 7.704566937809572
2025-03-09 09:59:36,251 [INFO]: 	99p_search_speed_ms: 18.05387035943566
2025-03-09 09:59:36,251 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:36,251 [INFO]: 	nb vectors: 4434
2025-03-09 09:59:36,251 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:36,251 [INFO]: 	compression ratio: 0.999308638712424
2025-03-09 09:59:36,251 [INFO]: }
2025-03-09 09:59:36,251 [INFO]: 	>>> Finished "Creating the index" in 66.1096 secs
2025-03-09 09:59:36,251 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1403 secs
2025-03-09 09:59:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 85526 [episode count 11/20]
[retrieval_preprocessing] for episode 44055 [episode count 12/20], we have num_retrieval=np.int64(4770) num_query=np.int64(178)
2025-03-09 09:59:39,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:40,879 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:40
2025-03-09 09:59:40,880 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-09 09:59:40,913 [INFO]: There are 4770 embeddings of dim 49152
2025-03-09 09:59:40,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 09:59:40,913 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:40
2025-03-09 09:59:40,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:40,913 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:59:40,913 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:40,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:59:40,913 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:40
2025-03-09 09:59:40,913 [INFO]: 984.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:40,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:59:40,914 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:40
2025-03-09 09:59:40,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:40,914 [INFO]: 	Creating the index 03/09/2025, 09:59:40
2025-03-09 09:59:40,914 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:40
2025-03-09 09:59:40,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:59:40,915 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:40
2025-03-09 09:59:40,915 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:59:40,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.63it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.86it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.03it/s]100%|██████████| 19/19 [00:03<00:00,  3.68it/s]100%|██████████| 19/19 [00:03<00:00,  4.95it/s]
2025-03-09 09:59:44,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:44
2025-03-09 10:00:24,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7409 secs
2025-03-09 10:00:24,499 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 10:00:24,499 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-09 10:00:46,367 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8682 secs
2025-03-09 10:00:46,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4566 secs
2025-03-09 10:00:46,371 [INFO]: {
2025-03-09 10:00:46,372 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:46,372 [INFO]: 	index_param: efSearch=289
2025-03-09 10:00:46,372 [INFO]: 	index_path: knn.index
2025-03-09 10:00:46,372 [INFO]: 	size in bytes: 938469010
2025-03-09 10:00:46,372 [INFO]: 	avg_search_speed_ms: 12.959836251126516
2025-03-09 10:00:46,372 [INFO]: 	99p_search_speed_ms: 22.825731490738686
2025-03-09 10:00:46,372 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:46,372 [INFO]: 	nb vectors: 4770
2025-03-09 10:00:46,372 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:46,372 [INFO]: 	compression ratio: 0.9993086079635171
2025-03-09 10:00:46,372 [INFO]: }
2025-03-09 10:00:46,372 [INFO]: 	>>> Finished "Creating the index" in 65.4580 secs
2025-03-09 10:00:46,372 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4921 secs
2025-03-09 10:00:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 44055 [episode count 12/20]
[retrieval_preprocessing] for episode 66584 [episode count 13/20], we have num_retrieval=np.int64(4763) num_query=np.int64(185)
2025-03-09 10:00:50,995 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:51,947 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:51
2025-03-09 10:00:51,947 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.27it/s]
2025-03-09 10:00:51,986 [INFO]: There are 4763 embeddings of dim 49152
2025-03-09 10:00:51,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-09 10:00:51,987 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:51
2025-03-09 10:00:51,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:51,987 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 10:00:51,987 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:51,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:00:51,987 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:51
2025-03-09 10:00:51,987 [INFO]: 983.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:51,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:00:51,987 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:51
2025-03-09 10:00:51,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:51,987 [INFO]: 	Creating the index 03/09/2025, 10:00:51
2025-03-09 10:00:51,988 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:51
2025-03-09 10:00:51,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:00:51,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:51
2025-03-09 10:00:51,989 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:00:51,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.89it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.44it/s] 53%|█████▎    | 10/19 [00:00<00:00, 32.74it/s] 79%|███████▉  | 15/19 [00:00<00:00, 38.40it/s]100%|██████████| 19/19 [00:03<00:00,  3.17it/s]100%|██████████| 19/19 [00:03<00:00,  4.86it/s]
2025-03-09 10:00:55,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:55
2025-03-09 10:01:44,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3047 secs
2025-03-09 10:01:44,209 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 10:01:44,209 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.38it/s] 50%|█████     | 2/4 [00:00<00:00,  8.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s]
2025-03-09 10:01:59,637 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4279 secs
2025-03-09 10:01:59,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6511 secs
2025-03-09 10:01:59,640 [INFO]: {
2025-03-09 10:01:59,640 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:59,640 [INFO]: 	index_param: efSearch=238
2025-03-09 10:01:59,640 [INFO]: 	index_path: knn.index
2025-03-09 10:01:59,640 [INFO]: 	size in bytes: 937091830
2025-03-09 10:01:59,640 [INFO]: 	avg_search_speed_ms: 10.847939535421915
2025-03-09 10:01:59,640 [INFO]: 	99p_search_speed_ms: 21.321220092941072
2025-03-09 10:01:59,640 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:59,640 [INFO]: 	nb vectors: 4763
2025-03-09 10:01:59,640 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:59,640 [INFO]: 	compression ratio: 0.999308577901058
2025-03-09 10:01:59,640 [INFO]: }
2025-03-09 10:01:59,640 [INFO]: 	>>> Finished "Creating the index" in 67.6528 secs
2025-03-09 10:01:59,640 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6930 secs
2025-03-09 10:02:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:02:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 66584 [episode count 13/20]
[retrieval_preprocessing] for episode 18459 [episode count 14/20], we have num_retrieval=np.int64(4599) num_query=np.int64(349)
2025-03-09 10:02:01,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:02:02,753 [INFO]: Launching the whole pipeline 03/09/2025, 10:02:02
2025-03-09 10:02:02,753 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:02:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-09 10:02:02,801 [INFO]: There are 4599 embeddings of dim 49152
2025-03-09 10:02:02,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0485 secs
2025-03-09 10:02:02,802 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:02:02
2025-03-09 10:02:02,802 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:02:02,802 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:02:02,802 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:02:02,802 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:02:02,802 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:02:02
2025-03-09 10:02:02,803 [INFO]: 949.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:02:02,803 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:02:02,803 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:02:02
2025-03-09 10:02:02,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:02:02,803 [INFO]: 	Creating the index 03/09/2025, 10:02:02
2025-03-09 10:02:02,804 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:02:02
2025-03-09 10:02:02,807 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 10:02:02,807 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:02:02
2025-03-09 10:02:02,807 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:02:02,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.49it/s] 26%|██▋       | 5/19 [00:00<00:00, 26.91it/s] 53%|█████▎    | 10/19 [00:00<00:00, 34.80it/s] 79%|███████▉  | 15/19 [00:00<00:00, 38.57it/s]100%|██████████| 19/19 [00:04<00:00,  2.78it/s]100%|██████████| 19/19 [00:04<00:00,  4.32it/s]
2025-03-09 10:02:07,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:07
2025-03-09 10:02:55,126 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9099 secs
2025-03-09 10:02:55,126 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 10:02:55,126 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-09 10:03:12,860 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7339 secs
2025-03-09 10:03:12,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0555 secs
2025-03-09 10:03:12,863 [INFO]: {
2025-03-09 10:03:12,863 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:12,863 [INFO]: 	index_param: efSearch=211
2025-03-09 10:03:12,863 [INFO]: 	index_path: knn.index
2025-03-09 10:03:12,863 [INFO]: 	size in bytes: 904825570
2025-03-09 10:03:12,863 [INFO]: 	avg_search_speed_ms: 8.645845490186607
2025-03-09 10:03:12,863 [INFO]: 	99p_search_speed_ms: 16.990785319358118
2025-03-09 10:03:12,863 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:12,863 [INFO]: 	nb vectors: 4599
2025-03-09 10:03:12,863 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:12,863 [INFO]: 	compression ratio: 0.9993088413714922
2025-03-09 10:03:12,863 [INFO]: }
2025-03-09 10:03:12,863 [INFO]: 	>>> Finished "Creating the index" in 70.0597 secs
2025-03-09 10:03:12,863 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1102 secs
2025-03-09 10:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 18459 [episode count 14/20]
[retrieval_preprocessing] for episode 65564 [episode count 15/20], we have num_retrieval=np.int64(4789) num_query=np.int64(159)
2025-03-09 10:03:15,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:16,162 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:16
2025-03-09 10:03:16,162 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-09 10:03:16,198 [INFO]: There are 4789 embeddings of dim 49152
2025-03-09 10:03:16,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 10:03:16,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:16
2025-03-09 10:03:16,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:16,199 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 10:03:16,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:16,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:03:16,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:16
2025-03-09 10:03:16,199 [INFO]: 988.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:16,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:03:16,199 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:16
2025-03-09 10:03:16,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:16,199 [INFO]: 	Creating the index 03/09/2025, 10:03:16
2025-03-09 10:03:16,199 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:16
2025-03-09 10:03:16,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:03:16,200 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:16
2025-03-09 10:03:16,200 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:03:16,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.01it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.01it/s] 74%|███████▎  | 14/19 [00:00<00:00, 46.89it/s]100%|██████████| 19/19 [00:03<00:00,  3.35it/s]100%|██████████| 19/19 [00:03<00:00,  4.77it/s]
2025-03-09 10:03:20,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:20
2025-03-09 10:04:00,655 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4651 secs
2025-03-09 10:04:00,655 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 10:04:00,655 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-09 10:04:20,049 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3938 secs
2025-03-09 10:04:20,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8513 secs
2025-03-09 10:04:20,052 [INFO]: {
2025-03-09 10:04:20,052 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:20,052 [INFO]: 	index_param: efSearch=299
2025-03-09 10:04:20,052 [INFO]: 	index_path: knn.index
2025-03-09 10:04:20,052 [INFO]: 	size in bytes: 942207070
2025-03-09 10:04:20,052 [INFO]: 	avg_search_speed_ms: 10.594038929103606
2025-03-09 10:04:20,052 [INFO]: 	99p_search_speed_ms: 21.101002346258607
2025-03-09 10:04:20,052 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:20,052 [INFO]: 	nb vectors: 4789
2025-03-09 10:04:20,052 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:20,052 [INFO]: 	compression ratio: 0.9993086891186245
2025-03-09 10:04:20,052 [INFO]: }
2025-03-09 10:04:20,052 [INFO]: 	>>> Finished "Creating the index" in 63.8528 secs
2025-03-09 10:04:20,052 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8900 secs
2025-03-09 10:04:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 65564 [episode count 15/20]
[retrieval_preprocessing] for episode 51233 [episode count 16/20], we have num_retrieval=np.int64(4699) num_query=np.int64(249)
2025-03-09 10:04:21,851 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:22,448 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:22
2025-03-09 10:04:22,448 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-09 10:04:22,482 [INFO]: There are 4699 embeddings of dim 49152
2025-03-09 10:04:22,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-09 10:04:22,482 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:22
2025-03-09 10:04:22,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:22,482 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 10:04:22,482 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:22,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:04:22,482 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:22
2025-03-09 10:04:22,483 [INFO]: 969.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:22,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:04:22,483 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:22
2025-03-09 10:04:22,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:22,483 [INFO]: 	Creating the index 03/09/2025, 10:04:22
2025-03-09 10:04:22,483 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:22
2025-03-09 10:04:22,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:04:22,484 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:22
2025-03-09 10:04:22,484 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:04:22,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.30it/s] 37%|███▋      | 7/19 [00:00<00:00, 31.87it/s] 68%|██████▊   | 13/19 [00:00<00:00, 40.49it/s]100%|██████████| 19/19 [00:03<00:00,  4.00it/s]100%|██████████| 19/19 [00:03<00:00,  5.34it/s]
2025-03-09 10:04:26,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:26
2025-03-09 10:05:03,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4241 secs
2025-03-09 10:05:03,468 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 10:05:03,468 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.00it/s]
2025-03-09 10:05:23,330 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8616 secs
2025-03-09 10:05:23,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8481 secs
2025-03-09 10:05:23,332 [INFO]: {
2025-03-09 10:05:23,332 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:23,332 [INFO]: 	index_param: efSearch=266
2025-03-09 10:05:23,332 [INFO]: 	index_path: knn.index
2025-03-09 10:05:23,332 [INFO]: 	size in bytes: 924500110
2025-03-09 10:05:23,332 [INFO]: 	avg_search_speed_ms: 9.796275475165505
2025-03-09 10:05:23,332 [INFO]: 	99p_search_speed_ms: 17.004890087991946
2025-03-09 10:05:23,332 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:23,332 [INFO]: 	nb vectors: 4699
2025-03-09 10:05:23,332 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:23,332 [INFO]: 	compression ratio: 0.9993086880216813
2025-03-09 10:05:23,332 [INFO]: }
2025-03-09 10:05:23,332 [INFO]: 	>>> Finished "Creating the index" in 60.8494 secs
2025-03-09 10:05:23,332 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8841 secs
2025-03-09 10:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 51233 [episode count 16/20]
[retrieval_preprocessing] for episode 67617 [episode count 17/20], we have num_retrieval=np.int64(4770) num_query=np.int64(178)
2025-03-09 10:05:26,364 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:26,954 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:26
2025-03-09 10:05:26,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.71it/s]
2025-03-09 10:05:26,985 [INFO]: There are 4770 embeddings of dim 49152
2025-03-09 10:05:26,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 10:05:26,985 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:26
2025-03-09 10:05:26,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:26,985 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 10:05:26,985 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:26,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:05:26,985 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:26
2025-03-09 10:05:26,986 [INFO]: 984.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:26,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:05:26,986 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:26
2025-03-09 10:05:26,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:26,986 [INFO]: 	Creating the index 03/09/2025, 10:05:26
2025-03-09 10:05:26,986 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:26
2025-03-09 10:05:26,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:05:26,987 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:26
2025-03-09 10:05:26,987 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:05:26,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.64it/s] 37%|███▋      | 7/19 [00:00<00:00, 35.86it/s] 68%|██████▊   | 13/19 [00:00<00:00, 44.44it/s] 95%|█████████▍| 18/19 [00:00<00:00, 45.49it/s]100%|██████████| 19/19 [00:03<00:00,  5.28it/s]
2025-03-09 10:05:30,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:30
2025-03-09 10:06:08,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1361 secs
2025-03-09 10:06:08,725 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 10:06:08,725 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.20it/s]
2025-03-09 10:06:23,180 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4546 secs
2025-03-09 10:06:23,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1954 secs
2025-03-09 10:06:23,182 [INFO]: {
2025-03-09 10:06:23,182 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:23,182 [INFO]: 	index_param: efSearch=301
2025-03-09 10:06:23,182 [INFO]: 	index_path: knn.index
2025-03-09 10:06:23,182 [INFO]: 	size in bytes: 938469010
2025-03-09 10:06:23,182 [INFO]: 	avg_search_speed_ms: 10.682558447558385
2025-03-09 10:06:23,182 [INFO]: 	99p_search_speed_ms: 18.975396046880626
2025-03-09 10:06:23,182 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:23,182 [INFO]: 	nb vectors: 4770
2025-03-09 10:06:23,182 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:23,182 [INFO]: 	compression ratio: 0.9993086079635171
2025-03-09 10:06:23,182 [INFO]: }
2025-03-09 10:06:23,183 [INFO]: 	>>> Finished "Creating the index" in 56.1968 secs
2025-03-09 10:06:23,183 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2289 secs
2025-03-09 10:06:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67617 [episode count 17/20]
[retrieval_preprocessing] for episode 88102 [episode count 18/20], we have num_retrieval=np.int64(4625) num_query=np.int64(323)
2025-03-09 10:06:25,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:26,496 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:26
2025-03-09 10:06:26,496 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-09 10:06:26,532 [INFO]: There are 4625 embeddings of dim 49152
2025-03-09 10:06:26,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 10:06:26,533 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:26
2025-03-09 10:06:26,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:26,533 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:06:26,533 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:26,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:06:26,533 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:26
2025-03-09 10:06:26,533 [INFO]: 954.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:26,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:06:26,533 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:26
2025-03-09 10:06:26,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:26,533 [INFO]: 	Creating the index 03/09/2025, 10:06:26
2025-03-09 10:06:26,533 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:26
2025-03-09 10:06:26,534 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:06:26,534 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:26
2025-03-09 10:06:26,534 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:06:26,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.91it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.87it/s] 53%|█████▎    | 10/19 [00:00<00:00, 30.67it/s] 79%|███████▉  | 15/19 [00:00<00:00, 35.57it/s]100%|██████████| 19/19 [00:03<00:00,  3.40it/s]100%|██████████| 19/19 [00:03<00:00,  5.24it/s]
2025-03-09 10:06:30,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:30
2025-03-09 10:07:08,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2524 secs
2025-03-09 10:07:08,418 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 10:07:08,419 [INFO]: 	Compute fast metrics 03/09/2025, 10:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-09 10:07:23,483 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0642 secs
2025-03-09 10:07:23,485 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9514 secs
2025-03-09 10:07:23,485 [INFO]: {
2025-03-09 10:07:23,485 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:23,486 [INFO]: 	index_param: efSearch=266
2025-03-09 10:07:23,486 [INFO]: 	index_path: knn.index
2025-03-09 10:07:23,486 [INFO]: 	size in bytes: 909940870
2025-03-09 10:07:23,486 [INFO]: 	avg_search_speed_ms: 9.757352323702923
2025-03-09 10:07:23,486 [INFO]: 	99p_search_speed_ms: 15.610743397846818
2025-03-09 10:07:23,486 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:23,486 [INFO]: 	nb vectors: 4625
2025-03-09 10:07:23,486 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:23,486 [INFO]: 	compression ratio: 0.9993088891589187
2025-03-09 10:07:23,486 [INFO]: }
2025-03-09 10:07:23,486 [INFO]: 	>>> Finished "Creating the index" in 56.9527 secs
2025-03-09 10:07:23,486 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9897 secs
2025-03-09 10:07:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 88102 [episode count 18/20]
[retrieval_preprocessing] for episode 58922 [episode count 19/20], we have num_retrieval=np.int64(4744) num_query=np.int64(204)
2025-03-09 10:07:26,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:26,998 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:26
2025-03-09 10:07:26,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-09 10:07:27,032 [INFO]: There are 4744 embeddings of dim 49152
2025-03-09 10:07:27,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-09 10:07:27,032 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:27
2025-03-09 10:07:27,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:27,033 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 10:07:27,033 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:27,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:07:27,033 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:27
2025-03-09 10:07:27,033 [INFO]: 979.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:27,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:07:27,033 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:27
2025-03-09 10:07:27,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:27,034 [INFO]: 	Creating the index 03/09/2025, 10:07:27
2025-03-09 10:07:27,034 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:27
2025-03-09 10:07:27,036 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:07:27,037 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:27
2025-03-09 10:07:27,037 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:07:27,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 26.12it/s] 47%|████▋     | 9/19 [00:00<00:00, 43.78it/s] 79%|███████▉  | 15/19 [00:00<00:00, 49.82it/s]100%|██████████| 19/19 [00:03<00:00,  5.46it/s]
2025-03-09 10:07:30,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:30
2025-03-09 10:08:10,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6568 secs
2025-03-09 10:08:10,181 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 10:08:10,181 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.15it/s]
2025-03-09 10:08:24,030 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8487 secs
2025-03-09 10:08:24,032 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9953 secs
2025-03-09 10:08:24,032 [INFO]: {
2025-03-09 10:08:24,032 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:24,032 [INFO]: 	index_param: efSearch=288
2025-03-09 10:08:24,032 [INFO]: 	index_path: knn.index
2025-03-09 10:08:24,032 [INFO]: 	size in bytes: 933353530
2025-03-09 10:08:24,032 [INFO]: 	avg_search_speed_ms: 9.647817279525611
2025-03-09 10:08:24,032 [INFO]: 	99p_search_speed_ms: 12.750462945550685
2025-03-09 10:08:24,032 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:24,032 [INFO]: 	nb vectors: 4744
2025-03-09 10:08:24,032 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:24,032 [INFO]: 	compression ratio: 0.9993087528152382
2025-03-09 10:08:24,032 [INFO]: }
2025-03-09 10:08:24,032 [INFO]: 	>>> Finished "Creating the index" in 56.9987 secs
2025-03-09 10:08:24,032 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0343 secs
2025-03-09 10:08:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 58922 [episode count 19/20]
2025-03-09 10:08:25: [retrieval_preprocessing] finished for (452818143, 'lid') [chosen_id count 9/10]
2025-03-09 10:08:25: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
