nohup: ignoring input
2025-03-09 06:48:12: got the info dicts: there are 36687 groupings

2025-03-09 06:48:12: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:48:12: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:48:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1477699675, 'mug') [chosen_id count 0/5]
2025-03-09 06:48:17: [retrieval_preprocessing] we have num_total=5422 embedding_dim=49152
[retrieval_preprocessing] for episode 58625 [episode count 0/20], we have num_retrieval=np.int64(5169) num_query=np.int64(253)
2025-03-09 06:48:19,387 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:20,124 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:20
2025-03-09 06:48:20,124 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 729.82it/s]
2025-03-09 06:48:20,162 [INFO]: There are 5169 embeddings of dim 49152
2025-03-09 06:48:20,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-09 06:48:20,162 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:20
2025-03-09 06:48:20,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:20,162 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:48:20,163 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:20,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:48:20,163 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:20
2025-03-09 06:48:20,164 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:20,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0011 secs
2025-03-09 06:48:20,164 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:20
2025-03-09 06:48:20,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:20,164 [INFO]: 	Creating the index 03/09/2025, 06:48:20
2025-03-09 06:48:20,164 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:20
2025-03-09 06:48:20,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 06:48:20,166 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:20
2025-03-09 06:48:20,166 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:48:20,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.41it/s] 14%|█▎        | 3/22 [00:00<00:01, 11.58it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.84it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.69it/s] 41%|████      | 9/22 [00:00<00:01, 12.05it/s] 50%|█████     | 11/22 [00:00<00:00, 12.86it/s] 59%|█████▉    | 13/22 [00:01<00:00, 13.45it/s] 68%|██████▊   | 15/22 [00:01<00:00, 13.23it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.89it/s] 86%|████████▋ | 19/22 [00:01<00:00, 14.80it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.52it/s]100%|██████████| 22/22 [00:06<00:00,  3.43it/s]
2025-03-09 06:48:26,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:26
2025-03-09 06:49:15,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4642 secs
2025-03-09 06:49:15,051 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 06:49:15,051 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-09 06:49:28,536 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4842 secs
2025-03-09 06:49:28,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3703 secs
2025-03-09 06:49:28,537 [INFO]: {
2025-03-09 06:49:28,537 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:28,537 [INFO]: 	index_param: efSearch=164
2025-03-09 06:49:28,537 [INFO]: 	index_path: knn.index
2025-03-09 06:49:28,537 [INFO]: 	size in bytes: 1016970070
2025-03-09 06:49:28,537 [INFO]: 	avg_search_speed_ms: 8.7774682890614
2025-03-09 06:49:28,537 [INFO]: 	99p_search_speed_ms: 16.854286994785042
2025-03-09 06:49:28,537 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:28,537 [INFO]: 	nb vectors: 5169
2025-03-09 06:49:28,537 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:28,537 [INFO]: 	compression ratio: 0.9993084181916976
2025-03-09 06:49:28,537 [INFO]: }
2025-03-09 06:49:28,537 [INFO]: 	>>> Finished "Creating the index" in 68.3727 secs
2025-03-09 06:49:28,537 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4126 secs
2025-03-09 06:49:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 58625 [episode count 0/20]
[retrieval_preprocessing] for episode 80770 [episode count 1/20], we have num_retrieval=np.int64(5153) num_query=np.int64(269)
2025-03-09 06:49:30,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:31,338 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:31
2025-03-09 06:49:31,338 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-09 06:49:31,368 [INFO]: There are 5153 embeddings of dim 49152
2025-03-09 06:49:31,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 06:49:31,369 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:31
2025-03-09 06:49:31,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:31,369 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:49:31,369 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:31,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:31,369 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:31
2025-03-09 06:49:31,369 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:31,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:49:31,369 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:31
2025-03-09 06:49:31,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:31,369 [INFO]: 	Creating the index 03/09/2025, 06:49:31
2025-03-09 06:49:31,369 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:31
2025-03-09 06:49:31,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:49:31,371 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:31
2025-03-09 06:49:31,371 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:49:31,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.45it/s] 23%|██▎       | 5/22 [00:00<00:00, 24.14it/s] 36%|███▋      | 8/22 [00:00<00:00, 22.65it/s] 55%|█████▍    | 12/22 [00:00<00:00, 27.94it/s] 77%|███████▋  | 17/22 [00:00<00:00, 32.69it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.37it/s]100%|██████████| 22/22 [00:06<00:00,  3.66it/s]
2025-03-09 06:49:37,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:37
2025-03-09 06:50:35,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0297 secs
2025-03-09 06:50:35,410 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 06:50:35,410 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-09 06:50:49,453 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0428 secs
2025-03-09 06:50:49,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0824 secs
2025-03-09 06:50:49,453 [INFO]: {
2025-03-09 06:50:49,453 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:49,453 [INFO]: 	index_param: efSearch=211
2025-03-09 06:50:49,453 [INFO]: 	index_path: knn.index
2025-03-09 06:50:49,453 [INFO]: 	size in bytes: 1013822110
2025-03-09 06:50:49,453 [INFO]: 	avg_search_speed_ms: 11.990137730180162
2025-03-09 06:50:49,453 [INFO]: 	99p_search_speed_ms: 26.27260354114694
2025-03-09 06:50:49,453 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:49,453 [INFO]: 	nb vectors: 5153
2025-03-09 06:50:49,453 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:49,453 [INFO]: 	compression ratio: 0.9993084723709567
2025-03-09 06:50:49,453 [INFO]: }
2025-03-09 06:50:49,453 [INFO]: 	>>> Finished "Creating the index" in 78.0840 secs
2025-03-09 06:50:49,453 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1156 secs
2025-03-09 06:50:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 80770 [episode count 1/20]
[retrieval_preprocessing] for episode 80003 [episode count 2/20], we have num_retrieval=np.int64(5077) num_query=np.int64(345)
2025-03-09 06:50:51,919 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:52,781 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:52
2025-03-09 06:50:52,781 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2024.28it/s]
2025-03-09 06:50:52,806 [INFO]: There are 5077 embeddings of dim 49152
2025-03-09 06:50:52,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 06:50:52,806 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:52
2025-03-09 06:50:52,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:52,806 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:50:52,806 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:52,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:50:52,806 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:52
2025-03-09 06:50:52,807 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:52,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:50:52,807 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:52
2025-03-09 06:50:52,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:52,807 [INFO]: 	Creating the index 03/09/2025, 06:50:52
2025-03-09 06:50:52,807 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:52
2025-03-09 06:50:52,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:50:52,808 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:52
2025-03-09 06:50:52,808 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:50:52,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.92it/s] 30%|███       | 6/20 [00:00<00:00, 30.25it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.01it/s] 85%|████████▌ | 17/20 [00:00<00:00, 42.99it/s]100%|██████████| 20/20 [00:04<00:00,  4.54it/s]
2025-03-09 06:50:57,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:57
2025-03-09 06:51:45,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2536 secs
2025-03-09 06:51:45,473 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 06:51:45,473 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.68it/s]
2025-03-09 06:52:00,101 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6280 secs
2025-03-09 06:52:00,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2956 secs
2025-03-09 06:52:00,104 [INFO]: {
2025-03-09 06:52:00,104 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:00,104 [INFO]: 	index_param: efSearch=240
2025-03-09 06:52:00,104 [INFO]: 	index_path: knn.index
2025-03-09 06:52:00,104 [INFO]: 	size in bytes: 998869510
2025-03-09 06:52:00,104 [INFO]: 	avg_search_speed_ms: 10.79686517081753
2025-03-09 06:52:00,104 [INFO]: 	99p_search_speed_ms: 16.160336732864383
2025-03-09 06:52:00,104 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:00,104 [INFO]: 	nb vectors: 5077
2025-03-09 06:52:00,104 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:00,104 [INFO]: 	compression ratio: 0.9993085242936287
2025-03-09 06:52:00,104 [INFO]: }
2025-03-09 06:52:00,104 [INFO]: 	>>> Finished "Creating the index" in 67.2973 secs
2025-03-09 06:52:00,104 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3227 secs
2025-03-09 06:52:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 80003 [episode count 2/20]
[retrieval_preprocessing] for episode 55684 [episode count 3/20], we have num_retrieval=np.int64(5179) num_query=np.int64(243)
2025-03-09 06:52:04,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:04,783 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:04
2025-03-09 06:52:04,783 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1313.59it/s]
2025-03-09 06:52:04,808 [INFO]: There are 5179 embeddings of dim 49152
2025-03-09 06:52:04,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 06:52:04,809 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:04,809 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:52:04,809 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:04,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:04,809 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,809 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:04,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:52:04,809 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:04
2025-03-09 06:52:04,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:04,809 [INFO]: 	Creating the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,809 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:04
2025-03-09 06:52:04,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:52:04,810 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:04
2025-03-09 06:52:04,810 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:52:04,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.51it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.23it/s] 55%|█████▍    | 12/22 [00:00<00:00, 40.89it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.64it/s]100%|██████████| 22/22 [00:05<00:00,  2.38it/s]100%|██████████| 22/22 [00:05<00:00,  3.75it/s]
2025-03-09 06:52:10,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:10
2025-03-09 06:52:59,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0033 secs
2025-03-09 06:52:59,689 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 06:52:59,690 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.44it/s]
2025-03-09 06:53:12,396 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7064 secs
2025-03-09 06:53:12,397 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5862 secs
2025-03-09 06:53:12,397 [INFO]: {
2025-03-09 06:53:12,397 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:12,397 [INFO]: 	index_param: efSearch=219
2025-03-09 06:53:12,397 [INFO]: 	index_path: knn.index
2025-03-09 06:53:12,397 [INFO]: 	size in bytes: 1018937470
2025-03-09 06:53:12,397 [INFO]: 	avg_search_speed_ms: 11.568789247617211
2025-03-09 06:53:12,397 [INFO]: 	99p_search_speed_ms: 29.72934441640973
2025-03-09 06:53:12,397 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:12,397 [INFO]: 	nb vectors: 5179
2025-03-09 06:53:12,397 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:12,397 [INFO]: 	compression ratio: 0.9993084580548403
2025-03-09 06:53:12,397 [INFO]: }
2025-03-09 06:53:12,397 [INFO]: 	>>> Finished "Creating the index" in 67.5876 secs
2025-03-09 06:53:12,397 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6138 secs
2025-03-09 06:53:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 55684 [episode count 3/20]
[retrieval_preprocessing] for episode 94340 [episode count 4/20], we have num_retrieval=np.int64(5144) num_query=np.int64(278)
2025-03-09 06:53:14,733 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:15,481 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:15
2025-03-09 06:53:15,481 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.55it/s]
2025-03-09 06:53:15,517 [INFO]: There are 5144 embeddings of dim 49152
2025-03-09 06:53:15,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-09 06:53:15,517 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:15,518 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:53:15,518 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:15,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:53:15,518 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,518 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:15,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:53:15,518 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:15
2025-03-09 06:53:15,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:15,518 [INFO]: 	Creating the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,518 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:15
2025-03-09 06:53:15,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 06:53:15,520 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,521 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:53:15,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.92it/s] 32%|███▏      | 7/22 [00:00<00:00, 32.41it/s] 59%|█████▉    | 13/22 [00:00<00:00, 40.65it/s] 82%|████████▏ | 18/22 [00:00<00:00, 33.24it/s]100%|██████████| 22/22 [00:05<00:00,  2.37it/s]100%|██████████| 22/22 [00:05<00:00,  3.88it/s]
2025-03-09 06:53:21,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:21
2025-03-09 06:54:14,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.8179 secs
2025-03-09 06:54:14,017 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 06:54:14,017 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-09 06:54:28,165 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1482 secs
2025-03-09 06:54:28,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6454 secs
2025-03-09 06:54:28,166 [INFO]: {
2025-03-09 06:54:28,166 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:28,166 [INFO]: 	index_param: efSearch=179
2025-03-09 06:54:28,166 [INFO]: 	index_path: knn.index
2025-03-09 06:54:28,166 [INFO]: 	size in bytes: 1012051390
2025-03-09 06:54:28,166 [INFO]: 	avg_search_speed_ms: 9.090510361023586
2025-03-09 06:54:28,166 [INFO]: 	99p_search_speed_ms: 18.682451683562245
2025-03-09 06:54:28,166 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:28,166 [INFO]: 	nb vectors: 5144
2025-03-09 06:54:28,166 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:28,166 [INFO]: 	compression ratio: 0.9993084955893395
2025-03-09 06:54:28,166 [INFO]: }
2025-03-09 06:54:28,166 [INFO]: 	>>> Finished "Creating the index" in 72.6480 secs
2025-03-09 06:54:28,166 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6851 secs
2025-03-09 06:54:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 94340 [episode count 4/20]
[retrieval_preprocessing] for episode 66567 [episode count 5/20], we have num_retrieval=np.int64(5199) num_query=np.int64(223)
2025-03-09 06:54:30,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:31,488 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:31
2025-03-09 06:54:31,488 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.85it/s]
2025-03-09 06:54:31,518 [INFO]: There are 5199 embeddings of dim 49152
2025-03-09 06:54:31,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 06:54:31,518 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:31
2025-03-09 06:54:31,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:31,519 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:54:31,519 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:31,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 06:54:31,519 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:31
2025-03-09 06:54:31,519 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:31,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:54:31,520 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:31
2025-03-09 06:54:31,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:31,520 [INFO]: 	Creating the index 03/09/2025, 06:54:31
2025-03-09 06:54:31,520 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:31
2025-03-09 06:54:31,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 06:54:31,524 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:31
2025-03-09 06:54:31,524 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:54:31,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.80it/s] 36%|███▋      | 8/22 [00:00<00:00, 38.65it/s] 64%|██████▎   | 14/22 [00:00<00:00, 46.13it/s] 91%|█████████ | 20/22 [00:00<00:00, 49.23it/s]100%|██████████| 22/22 [00:04<00:00,  4.77it/s]
2025-03-09 06:54:36,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:36
2025-03-09 06:55:21,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3257 secs
2025-03-09 06:55:21,464 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 06:55:21,464 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-09 06:55:34,172 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7083 secs
2025-03-09 06:55:34,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6485 secs
2025-03-09 06:55:34,172 [INFO]: {
2025-03-09 06:55:34,172 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:34,172 [INFO]: 	index_param: efSearch=206
2025-03-09 06:55:34,173 [INFO]: 	index_path: knn.index
2025-03-09 06:55:34,173 [INFO]: 	size in bytes: 1022872450
2025-03-09 06:55:34,173 [INFO]: 	avg_search_speed_ms: 10.227472728245905
2025-03-09 06:55:34,173 [INFO]: 	99p_search_speed_ms: 25.052762778941542
2025-03-09 06:55:34,173 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:34,173 [INFO]: 	nb vectors: 5199
2025-03-09 06:55:34,173 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:34,173 [INFO]: 	compression ratio: 0.999308361467747
2025-03-09 06:55:34,173 [INFO]: }
2025-03-09 06:55:34,173 [INFO]: 	>>> Finished "Creating the index" in 62.6524 secs
2025-03-09 06:55:34,173 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6843 secs
2025-03-09 06:55:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 66567 [episode count 5/20]
[retrieval_preprocessing] for episode 70159 [episode count 6/20], we have num_retrieval=np.int64(5181) num_query=np.int64(241)
2025-03-09 06:55:36,586 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:37,501 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:37
2025-03-09 06:55:37,501 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.32it/s]
2025-03-09 06:55:37,526 [INFO]: There are 5181 embeddings of dim 49152
2025-03-09 06:55:37,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 06:55:37,526 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:37
2025-03-09 06:55:37,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:37,526 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:55:37,526 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:37,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:37,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:37
2025-03-09 06:55:37,527 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:37,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:37,527 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:37
2025-03-09 06:55:37,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:37,527 [INFO]: 	Creating the index 03/09/2025, 06:55:37
2025-03-09 06:55:37,527 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:37
2025-03-09 06:55:37,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:55:37,528 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:37
2025-03-09 06:55:37,528 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:55:37,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.73it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.51it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.39it/s] 82%|████████▏ | 18/22 [00:00<00:00, 44.01it/s]100%|██████████| 22/22 [00:05<00:00,  4.10it/s]
2025-03-09 06:55:42,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:42
2025-03-09 06:56:31,086 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1844 secs
2025-03-09 06:56:31,087 [INFO]: The best hyperparameters are: efSearch=105
2025-03-09 06:56:31,087 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-09 06:56:44,919 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8327 secs
2025-03-09 06:56:44,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3918 secs
2025-03-09 06:56:44,920 [INFO]: {
2025-03-09 06:56:44,920 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:44,920 [INFO]: 	index_param: efSearch=105
2025-03-09 06:56:44,920 [INFO]: 	index_path: knn.index
2025-03-09 06:56:44,920 [INFO]: 	size in bytes: 1019330950
2025-03-09 06:56:44,920 [INFO]: 	avg_search_speed_ms: 6.159259209803002
2025-03-09 06:56:44,920 [INFO]: 	99p_search_speed_ms: 13.492763764224945
2025-03-09 06:56:44,920 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:44,920 [INFO]: 	nb vectors: 5181
2025-03-09 06:56:44,920 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:44,920 [INFO]: 	compression ratio: 0.9993084660090032
2025-03-09 06:56:44,920 [INFO]: }
2025-03-09 06:56:44,920 [INFO]: 	>>> Finished "Creating the index" in 67.3931 secs
2025-03-09 06:56:44,920 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4186 secs
2025-03-09 06:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 70159 [episode count 6/20]
[retrieval_preprocessing] for episode 92304 [episode count 7/20], we have num_retrieval=np.int64(5095) num_query=np.int64(327)
2025-03-09 06:56:46,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:47,481 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:47
2025-03-09 06:56:47,481 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1486.81it/s]
2025-03-09 06:56:47,512 [INFO]: There are 5095 embeddings of dim 49152
2025-03-09 06:56:47,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 06:56:47,512 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:47
2025-03-09 06:56:47,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:47,512 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:56:47,512 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:47,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:47,512 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:47
2025-03-09 06:56:47,512 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:47,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:56:47,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:47
2025-03-09 06:56:47,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:47,513 [INFO]: 	Creating the index 03/09/2025, 06:56:47
2025-03-09 06:56:47,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:47
2025-03-09 06:56:47,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:56:47,514 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:47
2025-03-09 06:56:47,514 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:56:47,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.86it/s] 18%|█▊        | 4/22 [00:00<00:01, 13.89it/s] 36%|███▋      | 8/22 [00:00<00:00, 22.48it/s] 59%|█████▉    | 13/22 [00:00<00:00, 29.59it/s] 82%|████████▏ | 18/22 [00:00<00:00, 35.38it/s]100%|██████████| 22/22 [00:05<00:00,  2.42it/s]100%|██████████| 22/22 [00:05<00:00,  4.03it/s]
2025-03-09 06:56:52,982 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:52
2025-03-09 06:57:41,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2001 secs
2025-03-09 06:57:41,182 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 06:57:41,182 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.96it/s]
2025-03-09 06:57:53,723 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5403 secs
2025-03-09 06:57:53,723 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2092 secs
2025-03-09 06:57:53,723 [INFO]: {
2025-03-09 06:57:53,723 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:53,723 [INFO]: 	index_param: efSearch=222
2025-03-09 06:57:53,723 [INFO]: 	index_path: knn.index
2025-03-09 06:57:53,723 [INFO]: 	size in bytes: 1002410890
2025-03-09 06:57:53,723 [INFO]: 	avg_search_speed_ms: 9.755210360148695
2025-03-09 06:57:53,723 [INFO]: 	99p_search_speed_ms: 14.418846825137734
2025-03-09 06:57:53,723 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:53,723 [INFO]: 	nb vectors: 5095
2025-03-09 06:57:53,723 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:53,723 [INFO]: 	compression ratio: 0.9993085370411329
2025-03-09 06:57:53,723 [INFO]: }
2025-03-09 06:57:53,723 [INFO]: 	>>> Finished "Creating the index" in 66.2106 secs
2025-03-09 06:57:53,723 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2419 secs
2025-03-09 06:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 92304 [episode count 7/20]
[retrieval_preprocessing] for episode 39057 [episode count 8/20], we have num_retrieval=np.int64(5173) num_query=np.int64(249)
2025-03-09 06:57:56,950 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:57,709 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:57
2025-03-09 06:57:57,709 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1957.21it/s]
2025-03-09 06:57:57,732 [INFO]: There are 5173 embeddings of dim 49152
2025-03-09 06:57:57,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 06:57:57,732 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:57
2025-03-09 06:57:57,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:57,732 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:57:57,732 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:57,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:57:57,733 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:57
2025-03-09 06:57:57,733 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:57,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:57,733 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:57
2025-03-09 06:57:57,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:57,733 [INFO]: 	Creating the index 03/09/2025, 06:57:57
2025-03-09 06:57:57,733 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:57
2025-03-09 06:57:57,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:57:57,734 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:57
2025-03-09 06:57:57,734 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:57:57,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.48it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.22it/s] 59%|█████▉    | 13/22 [00:00<00:00, 43.21it/s] 86%|████████▋ | 19/22 [00:00<00:00, 46.79it/s]100%|██████████| 22/22 [00:05<00:00,  4.12it/s]
2025-03-09 06:58:03,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:03
2025-03-09 06:58:51,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0714 secs
2025-03-09 06:58:51,147 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 06:58:51,147 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-09 06:59:05,558 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4103 secs
2025-03-09 06:59:05,558 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8241 secs
2025-03-09 06:59:05,558 [INFO]: {
2025-03-09 06:59:05,558 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:05,558 [INFO]: 	index_param: efSearch=221
2025-03-09 06:59:05,558 [INFO]: 	index_path: knn.index
2025-03-09 06:59:05,558 [INFO]: 	size in bytes: 1017757030
2025-03-09 06:59:05,558 [INFO]: 	avg_search_speed_ms: 9.76461095774539
2025-03-09 06:59:05,558 [INFO]: 	99p_search_speed_ms: 13.635974226053804
2025-03-09 06:59:05,558 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:05,558 [INFO]: 	nb vectors: 5173
2025-03-09 06:59:05,558 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:05,558 [INFO]: 	compression ratio: 0.9993084341554487
2025-03-09 06:59:05,558 [INFO]: }
2025-03-09 06:59:05,558 [INFO]: 	>>> Finished "Creating the index" in 67.8255 secs
2025-03-09 06:59:05,558 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8492 secs
2025-03-09 06:59:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 39057 [episode count 8/20]
[retrieval_preprocessing] for episode 93588 [episode count 9/20], we have num_retrieval=np.int64(4812) num_query=np.int64(610)
2025-03-09 06:59:08,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:09,192 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:09
2025-03-09 06:59:09,192 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.87it/s]
2025-03-09 06:59:09,221 [INFO]: There are 4812 embeddings of dim 49152
2025-03-09 06:59:09,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 06:59:09,221 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:09,221 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 06:59:09,221 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:09,221 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:09,221 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,221 [INFO]: 993.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:09,222 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:59:09,222 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:09
2025-03-09 06:59:09,222 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:09,222 [INFO]: 	Creating the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,222 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:09
2025-03-09 06:59:09,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:59:09,223 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:09
2025-03-09 06:59:09,223 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:59:09,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 38.69it/s] 74%|███████▎  | 14/19 [00:00<00:00, 45.12it/s]100%|██████████| 19/19 [00:04<00:00,  2.96it/s]100%|██████████| 19/19 [00:04<00:00,  4.22it/s]
2025-03-09 06:59:13,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:13
2025-03-09 06:59:58,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6758 secs
2025-03-09 06:59:58,406 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 06:59:58,406 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.47it/s]
2025-03-09 07:00:10,946 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5402 secs
2025-03-09 07:00:10,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7258 secs
2025-03-09 07:00:10,949 [INFO]: {
2025-03-09 07:00:10,949 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:10,949 [INFO]: 	index_param: efSearch=230
2025-03-09 07:00:10,949 [INFO]: 	index_path: knn.index
2025-03-09 07:00:10,949 [INFO]: 	size in bytes: 946732210
2025-03-09 07:00:10,949 [INFO]: 	avg_search_speed_ms: 10.213885280570972
2025-03-09 07:00:10,949 [INFO]: 	99p_search_speed_ms: 13.737185737118127
2025-03-09 07:00:10,949 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:10,949 [INFO]: 	nb vectors: 4812
2025-03-09 07:00:10,949 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:10,949 [INFO]: 	compression ratio: 0.9993086598374
2025-03-09 07:00:10,949 [INFO]: }
2025-03-09 07:00:10,949 [INFO]: 	>>> Finished "Creating the index" in 61.7276 secs
2025-03-09 07:00:10,949 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7573 secs
2025-03-09 07:00:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 93588 [episode count 9/20]
[retrieval_preprocessing] for episode 20249 [episode count 10/20], we have num_retrieval=np.int64(5175) num_query=np.int64(247)
2025-03-09 07:00:18,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:18,658 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:18
2025-03-09 07:00:18,658 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-09 07:00:18,686 [INFO]: There are 5175 embeddings of dim 49152
2025-03-09 07:00:18,686 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:00:18,686 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:18
2025-03-09 07:00:18,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:18,687 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:00:18,687 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:18,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:18,687 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:18
2025-03-09 07:00:18,687 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:18,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:00:18,687 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:18
2025-03-09 07:00:18,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:18,688 [INFO]: 	Creating the index 03/09/2025, 07:00:18
2025-03-09 07:00:18,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:18
2025-03-09 07:00:18,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:00:18,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:18
2025-03-09 07:00:18,689 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:00:18,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.85it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.62it/s] 50%|█████     | 11/22 [00:00<00:00, 39.41it/s] 73%|███████▎  | 16/22 [00:00<00:00, 43.17it/s] 95%|█████████▌| 21/22 [00:05<00:00,  2.65it/s]100%|██████████| 22/22 [00:05<00:00,  3.72it/s]
2025-03-09 07:00:24,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:24
2025-03-09 07:01:12,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4485 secs
2025-03-09 07:01:12,060 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 07:01:12,060 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-09 07:01:24,652 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5917 secs
2025-03-09 07:01:24,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9638 secs
2025-03-09 07:01:24,653 [INFO]: {
2025-03-09 07:01:24,653 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:24,653 [INFO]: 	index_param: efSearch=220
2025-03-09 07:01:24,653 [INFO]: 	index_path: knn.index
2025-03-09 07:01:24,653 [INFO]: 	size in bytes: 1018150510
2025-03-09 07:01:24,653 [INFO]: 	avg_search_speed_ms: 9.669667283907115
2025-03-09 07:01:24,653 [INFO]: 	99p_search_speed_ms: 12.933577457442878
2025-03-09 07:01:24,653 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:24,653 [INFO]: 	nb vectors: 5175
2025-03-09 07:01:24,653 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:24,653 [INFO]: 	compression ratio: 0.99930844212807
2025-03-09 07:01:24,653 [INFO]: }
2025-03-09 07:01:24,653 [INFO]: 	>>> Finished "Creating the index" in 65.9653 secs
2025-03-09 07:01:24,653 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9948 secs
2025-03-09 07:01:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 20249 [episode count 10/20]
[retrieval_preprocessing] for episode 37914 [episode count 11/20], we have num_retrieval=np.int64(5203) num_query=np.int64(219)
2025-03-09 07:01:27,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:27,710 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:27
2025-03-09 07:01:27,710 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-09 07:01:27,740 [INFO]: There are 5203 embeddings of dim 49152
2025-03-09 07:01:27,740 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 07:01:27,740 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:27
2025-03-09 07:01:27,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:27,740 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:01:27,740 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:27,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:27,740 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:27
2025-03-09 07:01:27,741 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:27,741 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:27,741 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:27
2025-03-09 07:01:27,741 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:27,741 [INFO]: 	Creating the index 03/09/2025, 07:01:27
2025-03-09 07:01:27,741 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:27
2025-03-09 07:01:27,743 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:01:27,743 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:27
2025-03-09 07:01:27,743 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:01:27,743 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.52it/s] 23%|██▎       | 5/22 [00:00<00:00, 25.78it/s] 45%|████▌     | 10/22 [00:00<00:00, 35.28it/s] 68%|██████▊   | 15/22 [00:00<00:00, 39.71it/s] 91%|█████████ | 20/22 [00:00<00:00, 42.15it/s]100%|██████████| 22/22 [00:04<00:00,  4.50it/s]
2025-03-09 07:01:32,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:32
2025-03-09 07:02:19,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5930 secs
2025-03-09 07:02:19,229 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 07:02:19,229 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.36it/s]
2025-03-09 07:02:31,722 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4934 secs
2025-03-09 07:02:31,723 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9804 secs
2025-03-09 07:02:31,723 [INFO]: {
2025-03-09 07:02:31,723 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:31,723 [INFO]: 	index_param: efSearch=227
2025-03-09 07:02:31,723 [INFO]: 	index_path: knn.index
2025-03-09 07:02:31,723 [INFO]: 	size in bytes: 1023659470
2025-03-09 07:02:31,723 [INFO]: 	avg_search_speed_ms: 10.437059822338702
2025-03-09 07:02:31,723 [INFO]: 	99p_search_speed_ms: 14.754725035745649
2025-03-09 07:02:31,723 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:31,723 [INFO]: 	nb vectors: 5203
2025-03-09 07:02:31,723 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:31,723 [INFO]: 	compression ratio: 0.999308318810356
2025-03-09 07:02:31,723 [INFO]: }
2025-03-09 07:02:31,723 [INFO]: 	>>> Finished "Creating the index" in 63.9820 secs
2025-03-09 07:02:31,723 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0129 secs
2025-03-09 07:02:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 37914 [episode count 11/20]
[retrieval_preprocessing] for episode 13979 [episode count 12/20], we have num_retrieval=np.int64(5163) num_query=np.int64(259)
2025-03-09 07:02:34,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:35,045 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:35
2025-03-09 07:02:35,045 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.34it/s]
2025-03-09 07:02:35,075 [INFO]: There are 5163 embeddings of dim 49152
2025-03-09 07:02:35,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:02:35,076 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:35
2025-03-09 07:02:35,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:35,077 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:02:35,077 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:35,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 07:02:35,077 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:35
2025-03-09 07:02:35,077 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:35,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:02:35,078 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:35
2025-03-09 07:02:35,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:35,078 [INFO]: 	Creating the index 03/09/2025, 07:02:35
2025-03-09 07:02:35,078 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:35
2025-03-09 07:02:35,081 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:02:35,081 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:35
2025-03-09 07:02:35,081 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:02:35,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.36it/s] 36%|███▋      | 8/22 [00:00<00:00, 40.12it/s] 64%|██████▎   | 14/22 [00:00<00:00, 46.15it/s] 91%|█████████ | 20/22 [00:00<00:00, 49.17it/s]100%|██████████| 22/22 [00:05<00:00,  4.21it/s]
2025-03-09 07:02:40,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:40
2025-03-09 07:03:27,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1301 secs
2025-03-09 07:03:27,445 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:03:27,445 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-09 07:03:40,690 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2447 secs
2025-03-09 07:03:40,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6096 secs
2025-03-09 07:03:40,691 [INFO]: {
2025-03-09 07:03:40,691 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:40,691 [INFO]: 	index_param: efSearch=238
2025-03-09 07:03:40,691 [INFO]: 	index_path: knn.index
2025-03-09 07:03:40,691 [INFO]: 	size in bytes: 1015789570
2025-03-09 07:03:40,691 [INFO]: 	avg_search_speed_ms: 11.001478282814666
2025-03-09 07:03:40,691 [INFO]: 	99p_search_speed_ms: 15.77404748648405
2025-03-09 07:03:40,691 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:40,691 [INFO]: 	nb vectors: 5163
2025-03-09 07:03:40,691 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:40,691 [INFO]: 	compression ratio: 0.9993084532261933
2025-03-09 07:03:40,691 [INFO]: }
2025-03-09 07:03:40,691 [INFO]: 	>>> Finished "Creating the index" in 65.6132 secs
2025-03-09 07:03:40,691 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6462 secs
2025-03-09 07:03:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 13979 [episode count 12/20]
[retrieval_preprocessing] for episode 73625 [episode count 13/20], we have num_retrieval=np.int64(5197) num_query=np.int64(225)
2025-03-09 07:03:43,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:44,369 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:44
2025-03-09 07:03:44,369 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.03it/s]
2025-03-09 07:03:44,398 [INFO]: There are 5197 embeddings of dim 49152
2025-03-09 07:03:44,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 07:03:44,398 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:44
2025-03-09 07:03:44,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:44,398 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:03:44,398 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:44,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:44,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:44
2025-03-09 07:03:44,399 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:44,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:03:44,399 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:44
2025-03-09 07:03:44,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:44,399 [INFO]: 	Creating the index 03/09/2025, 07:03:44
2025-03-09 07:03:44,399 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:44
2025-03-09 07:03:44,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:03:44,400 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:44
2025-03-09 07:03:44,400 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:03:44,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 16.02it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.09it/s] 50%|█████     | 11/22 [00:00<00:00, 34.43it/s] 73%|███████▎  | 16/22 [00:00<00:00, 38.09it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.83it/s]100%|██████████| 22/22 [00:05<00:00,  4.15it/s]
2025-03-09 07:03:49,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:49
2025-03-09 07:04:36,963 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2537 secs
2025-03-09 07:04:36,963 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 07:04:36,963 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 07:04:49,688 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7244 secs
2025-03-09 07:04:49,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2881 secs
2025-03-09 07:04:49,688 [INFO]: {
2025-03-09 07:04:49,688 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:49,688 [INFO]: 	index_param: efSearch=229
2025-03-09 07:04:49,688 [INFO]: 	index_path: knn.index
2025-03-09 07:04:49,688 [INFO]: 	size in bytes: 1022478970
2025-03-09 07:04:49,688 [INFO]: 	avg_search_speed_ms: 9.974347668210582
2025-03-09 07:04:49,688 [INFO]: 	99p_search_speed_ms: 14.22272668685764
2025-03-09 07:04:49,688 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:49,688 [INFO]: 	nb vectors: 5197
2025-03-09 07:04:49,688 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:49,688 [INFO]: 	compression ratio: 0.9993083535009037
2025-03-09 07:04:49,689 [INFO]: }
2025-03-09 07:04:49,689 [INFO]: 	>>> Finished "Creating the index" in 65.2895 secs
2025-03-09 07:04:49,689 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3196 secs
2025-03-09 07:04:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 73625 [episode count 13/20]
[retrieval_preprocessing] for episode 24990 [episode count 14/20], we have num_retrieval=np.int64(5202) num_query=np.int64(220)
2025-03-09 07:04:52,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:53,227 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:53
2025-03-09 07:04:53,227 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.98it/s]
2025-03-09 07:04:53,251 [INFO]: There are 5202 embeddings of dim 49152
2025-03-09 07:04:53,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:04:53,252 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:53
2025-03-09 07:04:53,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:53,252 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:04:53,252 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:53,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:53,252 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:53
2025-03-09 07:04:53,252 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:53,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:53,252 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:53
2025-03-09 07:04:53,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:53,252 [INFO]: 	Creating the index 03/09/2025, 07:04:53
2025-03-09 07:04:53,252 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:53
2025-03-09 07:04:53,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:04:53,253 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:53
2025-03-09 07:04:53,253 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:04:53,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.66it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.20it/s] 50%|█████     | 11/22 [00:00<00:00, 37.53it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.82it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.21it/s]100%|██████████| 22/22 [00:04<00:00,  4.52it/s]
2025-03-09 07:04:58,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:58
2025-03-09 07:05:43,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3402 secs
2025-03-09 07:05:43,463 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 07:05:43,463 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-09 07:05:56,462 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9992 secs
2025-03-09 07:05:56,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2097 secs
2025-03-09 07:05:56,463 [INFO]: {
2025-03-09 07:05:56,463 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:56,463 [INFO]: 	index_param: efSearch=181
2025-03-09 07:05:56,463 [INFO]: 	index_path: knn.index
2025-03-09 07:05:56,463 [INFO]: 	size in bytes: 1023462730
2025-03-09 07:05:56,463 [INFO]: 	avg_search_speed_ms: 8.438857665426935
2025-03-09 07:05:56,463 [INFO]: 	99p_search_speed_ms: 12.588571291416887
2025-03-09 07:05:56,463 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:56,463 [INFO]: 	nb vectors: 5202
2025-03-09 07:05:56,463 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:56,463 [INFO]: 	compression ratio: 0.9993083148225632
2025-03-09 07:05:56,463 [INFO]: }
2025-03-09 07:05:56,463 [INFO]: 	>>> Finished "Creating the index" in 63.2111 secs
2025-03-09 07:05:56,463 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2365 secs
2025-03-09 07:05:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 24990 [episode count 14/20]
[retrieval_preprocessing] for episode 22687 [episode count 15/20], we have num_retrieval=np.int64(5185) num_query=np.int64(237)
2025-03-09 07:05:58,451 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:59,144 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:59
2025-03-09 07:05:59,144 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.86it/s]
2025-03-09 07:05:59,170 [INFO]: There are 5185 embeddings of dim 49152
2025-03-09 07:05:59,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:05:59,170 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:59,170 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:05:59,170 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:59,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:59,170 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,170 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:59,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:59,170 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:59
2025-03-09 07:05:59,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:59,170 [INFO]: 	Creating the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,170 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:59
2025-03-09 07:05:59,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:59,172 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:59
2025-03-09 07:05:59,172 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:05:59,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.77it/s] 27%|██▋       | 6/22 [00:00<00:00, 33.08it/s] 55%|█████▍    | 12/22 [00:00<00:00, 43.13it/s] 82%|████████▏ | 18/22 [00:00<00:00, 49.44it/s]100%|██████████| 22/22 [00:06<00:00,  3.66it/s]
2025-03-09 07:06:05,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:05
2025-03-09 07:06:50,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7120 secs
2025-03-09 07:06:50,899 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:06:50,899 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.28it/s]
2025-03-09 07:07:03,397 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4975 secs
2025-03-09 07:07:03,397 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2258 secs
2025-03-09 07:07:03,397 [INFO]: {
2025-03-09 07:07:03,397 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:03,397 [INFO]: 	index_param: efSearch=219
2025-03-09 07:07:03,397 [INFO]: 	index_path: knn.index
2025-03-09 07:07:03,397 [INFO]: 	size in bytes: 1020118030
2025-03-09 07:07:03,397 [INFO]: 	avg_search_speed_ms: 11.90224988386035
2025-03-09 07:07:03,397 [INFO]: 	99p_search_speed_ms: 22.251890436746184
2025-03-09 07:07:03,397 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:03,397 [INFO]: 	nb vectors: 5185
2025-03-09 07:07:03,398 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:03,398 [INFO]: 	compression ratio: 0.9993083643468198
2025-03-09 07:07:03,398 [INFO]: }
2025-03-09 07:07:03,398 [INFO]: 	>>> Finished "Creating the index" in 64.2271 secs
2025-03-09 07:07:03,398 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2535 secs
2025-03-09 07:07:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 22687 [episode count 15/20]
[retrieval_preprocessing] for episode 55967 [episode count 16/20], we have num_retrieval=np.int64(5229) num_query=np.int64(193)
2025-03-09 07:07:08,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:09,548 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:09
2025-03-09 07:07:09,548 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 927.12it/s]
2025-03-09 07:07:09,579 [INFO]: There are 5229 embeddings of dim 49152
2025-03-09 07:07:09,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 07:07:09,580 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:09
2025-03-09 07:07:09,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:09,580 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:07:09,581 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:09,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:07:09,581 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:09
2025-03-09 07:07:09,581 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:09,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 07:07:09,582 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:09
2025-03-09 07:07:09,582 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:09,582 [INFO]: 	Creating the index 03/09/2025, 07:07:09
2025-03-09 07:07:09,582 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:09
2025-03-09 07:07:09,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 07:07:09,586 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:09
2025-03-09 07:07:09,586 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:07:09,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 18.04it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.07it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.17it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.58it/s]100%|██████████| 22/22 [00:05<00:00,  2.46it/s]100%|██████████| 22/22 [00:05<00:00,  3.94it/s]
2025-03-09 07:07:15,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:15
2025-03-09 07:08:06,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6900 secs
2025-03-09 07:08:06,868 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 07:08:06,869 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.47it/s]
2025-03-09 07:08:20,319 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4507 secs
2025-03-09 07:08:20,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7357 secs
2025-03-09 07:08:20,322 [INFO]: {
2025-03-09 07:08:20,322 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:20,322 [INFO]: 	index_param: efSearch=214
2025-03-09 07:08:20,322 [INFO]: 	index_path: knn.index
2025-03-09 07:08:20,322 [INFO]: 	size in bytes: 1028774830
2025-03-09 07:08:20,322 [INFO]: 	avg_search_speed_ms: 11.354017731068692
2025-03-09 07:08:20,322 [INFO]: 	99p_search_speed_ms: 21.75815203227103
2025-03-09 07:08:20,322 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:20,322 [INFO]: 	nb vectors: 5229
2025-03-09 07:08:20,322 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:20,322 [INFO]: 	compression ratio: 0.99930830539468
2025-03-09 07:08:20,322 [INFO]: }
2025-03-09 07:08:20,322 [INFO]: 	>>> Finished "Creating the index" in 70.7400 secs
2025-03-09 07:08:20,322 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7736 secs
2025-03-09 07:08:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 55967 [episode count 16/20]
[retrieval_preprocessing] for episode 74014 [episode count 17/20], we have num_retrieval=np.int64(5201) num_query=np.int64(221)
2025-03-09 07:08:22,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:22,922 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:22
2025-03-09 07:08:22,922 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.52it/s]
2025-03-09 07:08:22,949 [INFO]: There are 5201 embeddings of dim 49152
2025-03-09 07:08:22,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:08:22,950 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:22
2025-03-09 07:08:22,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:22,950 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:08:22,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:22,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:08:22,950 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:22
2025-03-09 07:08:22,951 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:22,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 07:08:22,951 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:22
2025-03-09 07:08:22,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:22,952 [INFO]: 	Creating the index 03/09/2025, 07:08:22
2025-03-09 07:08:22,952 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:22
2025-03-09 07:08:22,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:08:22,955 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:22
2025-03-09 07:08:22,955 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:08:22,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.35it/s] 36%|███▋      | 8/22 [00:00<00:00, 37.62it/s] 64%|██████▎   | 14/22 [00:00<00:00, 44.28it/s] 91%|█████████ | 20/22 [00:00<00:00, 47.44it/s]100%|██████████| 22/22 [00:04<00:00,  4.42it/s]
2025-03-09 07:08:27,939 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:27
2025-03-09 07:09:21,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1082 secs
2025-03-09 07:09:21,048 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 07:09:21,048 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.58it/s]
2025-03-09 07:09:34,527 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4785 secs
2025-03-09 07:09:34,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5722 secs
2025-03-09 07:09:34,527 [INFO]: {
2025-03-09 07:09:34,527 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:34,527 [INFO]: 	index_param: efSearch=221
2025-03-09 07:09:34,527 [INFO]: 	index_path: knn.index
2025-03-09 07:09:34,527 [INFO]: 	size in bytes: 1023265990
2025-03-09 07:09:34,527 [INFO]: 	avg_search_speed_ms: 9.942987595155287
2025-03-09 07:09:34,527 [INFO]: 	99p_search_speed_ms: 19.544065743684772
2025-03-09 07:09:34,527 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:34,527 [INFO]: 	nb vectors: 5201
2025-03-09 07:09:34,528 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:34,528 [INFO]: 	compression ratio: 0.999308310833237
2025-03-09 07:09:34,528 [INFO]: }
2025-03-09 07:09:34,528 [INFO]: 	>>> Finished "Creating the index" in 71.5761 secs
2025-03-09 07:09:34,528 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6053 secs
2025-03-09 07:09:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 74014 [episode count 17/20]
[retrieval_preprocessing] for episode 25250 [episode count 18/20], we have num_retrieval=np.int64(5176) num_query=np.int64(246)
2025-03-09 07:09:40,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:40,692 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:40
2025-03-09 07:09:40,692 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1614.44it/s]
2025-03-09 07:09:40,721 [INFO]: There are 5176 embeddings of dim 49152
2025-03-09 07:09:40,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 07:09:40,722 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:40
2025-03-09 07:09:40,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:40,722 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:09:40,722 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:40,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:09:40,722 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:40
2025-03-09 07:09:40,722 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:40,723 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:09:40,723 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:40
2025-03-09 07:09:40,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:40,723 [INFO]: 	Creating the index 03/09/2025, 07:09:40
2025-03-09 07:09:40,723 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:40
2025-03-09 07:09:40,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:09:40,726 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:40
2025-03-09 07:09:40,727 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:09:40,727 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.74it/s] 23%|██▎       | 5/22 [00:00<00:00, 23.68it/s] 41%|████      | 9/22 [00:00<00:00, 29.32it/s] 64%|██████▎   | 14/22 [00:00<00:00, 34.24it/s] 86%|████████▋ | 19/22 [00:00<00:00, 39.05it/s]100%|██████████| 22/22 [00:04<00:00,  4.44it/s]
2025-03-09 07:09:45,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:45
2025-03-09 07:10:41,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7638 secs
2025-03-09 07:10:41,472 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 07:10:41,472 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.56it/s]
2025-03-09 07:10:54,657 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1846 secs
2025-03-09 07:10:54,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9308 secs
2025-03-09 07:10:54,657 [INFO]: {
2025-03-09 07:10:54,657 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:54,657 [INFO]: 	index_param: efSearch=204
2025-03-09 07:10:54,657 [INFO]: 	index_path: knn.index
2025-03-09 07:10:54,657 [INFO]: 	size in bytes: 1018347250
2025-03-09 07:10:54,657 [INFO]: 	avg_search_speed_ms: 10.996658194318904
2025-03-09 07:10:54,658 [INFO]: 	99p_search_speed_ms: 24.048081261571493
2025-03-09 07:10:54,658 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:54,658 [INFO]: 	nb vectors: 5176
2025-03-09 07:10:54,658 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:54,658 [INFO]: 	compression ratio: 0.9993084461120704
2025-03-09 07:10:54,658 [INFO]: }
2025-03-09 07:10:54,658 [INFO]: 	>>> Finished "Creating the index" in 73.9345 secs
2025-03-09 07:10:54,658 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9655 secs
2025-03-09 07:10:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 25250 [episode count 18/20]
[retrieval_preprocessing] for episode 38564 [episode count 19/20], we have num_retrieval=np.int64(5105) num_query=np.int64(317)
2025-03-09 07:10:57,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:58,130 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:58
2025-03-09 07:10:58,130 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1856.71it/s]
2025-03-09 07:10:58,159 [INFO]: There are 5105 embeddings of dim 49152
2025-03-09 07:10:58,159 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:10:58,159 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:58
2025-03-09 07:10:58,159 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:58,159 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:10:58,160 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:58,160 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:10:58,160 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:58
2025-03-09 07:10:58,160 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:58,160 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:10:58,160 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:58
2025-03-09 07:10:58,160 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:58,160 [INFO]: 	Creating the index 03/09/2025, 07:10:58
2025-03-09 07:10:58,161 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:58
2025-03-09 07:10:58,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:10:58,164 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:58
2025-03-09 07:10:58,164 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:10:58,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.15it/s] 36%|███▋      | 8/22 [00:00<00:00, 38.66it/s] 64%|██████▎   | 14/22 [00:00<00:00, 45.84it/s] 91%|█████████ | 20/22 [00:00<00:00, 49.27it/s]100%|██████████| 22/22 [00:04<00:00,  4.43it/s]
2025-03-09 07:11:03,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:03
2025-03-09 07:11:53,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9541 secs
2025-03-09 07:11:53,090 [INFO]: The best hyperparameters are: efSearch=163
2025-03-09 07:11:53,090 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.80it/s]
2025-03-09 07:12:10,946 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8563 secs
2025-03-09 07:12:10,946 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7825 secs
2025-03-09 07:12:10,946 [INFO]: {
2025-03-09 07:12:10,946 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:10,946 [INFO]: 	index_param: efSearch=163
2025-03-09 07:12:10,946 [INFO]: 	index_path: knn.index
2025-03-09 07:12:10,946 [INFO]: 	size in bytes: 1004378410
2025-03-09 07:12:10,946 [INFO]: 	avg_search_speed_ms: 8.770894086225319
2025-03-09 07:12:10,946 [INFO]: 	99p_search_speed_ms: 21.234493532683686
2025-03-09 07:12:10,946 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:10,946 [INFO]: 	nb vectors: 5105
2025-03-09 07:12:10,947 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:10,947 [INFO]: 	compression ratio: 0.9993084578550429
2025-03-09 07:12:10,947 [INFO]: }
2025-03-09 07:12:10,947 [INFO]: 	>>> Finished "Creating the index" in 72.7860 secs
2025-03-09 07:12:10,947 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8167 secs
2025-03-09 07:12:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 38564 [episode count 19/20]
2025-03-09 07:12:13: [retrieval_preprocessing] finished for (1477699675, 'mug') [chosen_id count 0/5]
2025-03-09 07:12:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9228483020, 'marker') [chosen_id count 1/5]
2025-03-09 07:12:14: [retrieval_preprocessing] we have num_total=4014 embedding_dim=49152
[retrieval_preprocessing] for episode 79875 [episode count 0/20], we have num_retrieval=np.int64(3808) num_query=np.int64(206)
2025-03-09 07:12:15,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:15,593 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:15
2025-03-09 07:12:15,593 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-09 07:12:15,618 [INFO]: There are 3808 embeddings of dim 49152
2025-03-09 07:12:15,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:12:15,619 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:15
2025-03-09 07:12:15,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:15,619 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:12:15,619 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:15,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:15,619 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:15
2025-03-09 07:12:15,619 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:15,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:12:15,619 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:15
2025-03-09 07:12:15,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:15,619 [INFO]: 	Creating the index 03/09/2025, 07:12:15
2025-03-09 07:12:15,619 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:15
2025-03-09 07:12:15,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:12:15,620 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:15
2025-03-09 07:12:15,620 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:12:15,621 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.62it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.52it/s] 93%|█████████▎| 14/15 [00:00<00:00, 44.10it/s]100%|██████████| 15/15 [00:03<00:00,  4.63it/s]
2025-03-09 07:12:18,864 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:18
2025-03-09 07:13:02,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2648 secs
2025-03-09 07:13:02,129 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:13:02,130 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.95it/s]
2025-03-09 07:13:16,989 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8593 secs
2025-03-09 07:13:16,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3711 secs
2025-03-09 07:13:16,992 [INFO]: {
2025-03-09 07:13:16,992 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:16,992 [INFO]: 	index_param: efSearch=224
2025-03-09 07:13:16,992 [INFO]: 	index_path: knn.index
2025-03-09 07:13:16,992 [INFO]: 	size in bytes: 749200930
2025-03-09 07:13:16,992 [INFO]: 	avg_search_speed_ms: 9.914467831874198
2025-03-09 07:13:16,992 [INFO]: 	99p_search_speed_ms: 17.53148195333778
2025-03-09 07:13:16,993 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:16,993 [INFO]: 	nb vectors: 3808
2025-03-09 07:13:16,993 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:16,993 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-09 07:13:16,993 [INFO]: }
2025-03-09 07:13:16,993 [INFO]: 	>>> Finished "Creating the index" in 61.3733 secs
2025-03-09 07:13:16,993 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3996 secs
2025-03-09 07:13:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 79875 [episode count 0/20]
[retrieval_preprocessing] for episode 75784 [episode count 1/20], we have num_retrieval=np.int64(3862) num_query=np.int64(152)
2025-03-09 07:13:19,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:19,770 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:19
2025-03-09 07:13:19,771 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2076.39it/s]
2025-03-09 07:13:19,797 [INFO]: There are 3862 embeddings of dim 49152
2025-03-09 07:13:19,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:13:19,797 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:19
2025-03-09 07:13:19,797 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:19,797 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:13:19,797 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:19,797 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:19,797 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:19
2025-03-09 07:13:19,797 [INFO]: 797.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:19,797 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:19,797 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:19
2025-03-09 07:13:19,797 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:19,797 [INFO]: 	Creating the index 03/09/2025, 07:13:19
2025-03-09 07:13:19,797 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:19
2025-03-09 07:13:19,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:13:19,799 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:19
2025-03-09 07:13:19,799 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:13:19,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.05it/s] 50%|█████     | 8/16 [00:00<00:00, 37.04it/s] 81%|████████▏ | 13/16 [00:00<00:00, 40.59it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]
2025-03-09 07:13:23,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:23
2025-03-09 07:14:04,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7552 secs
2025-03-09 07:14:04,856 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:14:04,856 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.48it/s]
2025-03-09 07:14:17,160 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3041 secs
2025-03-09 07:14:17,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3645 secs
2025-03-09 07:14:17,163 [INFO]: {
2025-03-09 07:14:17,163 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:17,163 [INFO]: 	index_param: efSearch=219
2025-03-09 07:14:17,163 [INFO]: 	index_path: knn.index
2025-03-09 07:14:17,163 [INFO]: 	size in bytes: 759825250
2025-03-09 07:14:17,163 [INFO]: 	avg_search_speed_ms: 9.458450192281015
2025-03-09 07:14:17,163 [INFO]: 	99p_search_speed_ms: 20.68306640256197
2025-03-09 07:14:17,164 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:17,164 [INFO]: 	nb vectors: 3862
2025-03-09 07:14:17,164 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:17,164 [INFO]: 	compression ratio: 0.9993088489754717
2025-03-09 07:14:17,164 [INFO]: }
2025-03-09 07:14:17,164 [INFO]: 	>>> Finished "Creating the index" in 57.3661 secs
2025-03-09 07:14:17,164 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3930 secs
2025-03-09 07:14:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 75784 [episode count 1/20]
[retrieval_preprocessing] for episode 9744 [episode count 2/20], we have num_retrieval=np.int64(3839) num_query=np.int64(175)
2025-03-09 07:14:18,943 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:19,560 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:19
2025-03-09 07:14:19,560 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.00it/s]
2025-03-09 07:14:19,586 [INFO]: There are 3839 embeddings of dim 49152
2025-03-09 07:14:19,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:14:19,586 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:19
2025-03-09 07:14:19,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:19,586 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:14:19,586 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:19,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:19,586 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:19
2025-03-09 07:14:19,587 [INFO]: 792.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:19,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:14:19,587 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:19
2025-03-09 07:14:19,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:19,587 [INFO]: 	Creating the index 03/09/2025, 07:14:19
2025-03-09 07:14:19,587 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:19
2025-03-09 07:14:19,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:14:19,588 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:19
2025-03-09 07:14:19,588 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:14:19,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.94it/s] 25%|██▌       | 4/16 [00:00<00:00, 17.95it/s] 50%|█████     | 8/16 [00:00<00:00, 26.56it/s] 69%|██████▉   | 11/16 [00:00<00:00, 27.73it/s] 94%|█████████▍| 15/16 [00:00<00:00, 31.46it/s]100%|██████████| 16/16 [00:03<00:00,  4.64it/s]
2025-03-09 07:14:23,044 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:23
2025-03-09 07:15:00,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0933 secs
2025-03-09 07:15:00,138 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 07:15:00,138 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.04it/s]
2025-03-09 07:15:13,880 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7423 secs
2025-03-09 07:15:13,882 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2942 secs
2025-03-09 07:15:13,883 [INFO]: {
2025-03-09 07:15:13,883 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:13,883 [INFO]: 	index_param: efSearch=165
2025-03-09 07:15:13,883 [INFO]: 	index_path: knn.index
2025-03-09 07:15:13,883 [INFO]: 	size in bytes: 755300110
2025-03-09 07:15:13,883 [INFO]: 	avg_search_speed_ms: 8.407409023062723
2025-03-09 07:15:13,883 [INFO]: 	99p_search_speed_ms: 20.071768732741464
2025-03-09 07:15:13,883 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:13,883 [INFO]: 	nb vectors: 3839
2025-03-09 07:15:13,883 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:13,883 [INFO]: 	compression ratio: 0.9993088866358036
2025-03-09 07:15:13,883 [INFO]: }
2025-03-09 07:15:13,883 [INFO]: 	>>> Finished "Creating the index" in 54.2959 secs
2025-03-09 07:15:13,883 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3230 secs
2025-03-09 07:15:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 9744 [episode count 2/20]
[retrieval_preprocessing] for episode 59923 [episode count 3/20], we have num_retrieval=np.int64(3844) num_query=np.int64(170)
2025-03-09 07:15:15,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:15,843 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:15
2025-03-09 07:15:15,843 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.26it/s]
2025-03-09 07:15:15,871 [INFO]: There are 3844 embeddings of dim 49152
2025-03-09 07:15:15,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 07:15:15,871 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:15
2025-03-09 07:15:15,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:15,871 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:15:15,871 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:15,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:15,871 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:15
2025-03-09 07:15:15,872 [INFO]: 793.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:15,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:15:15,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:15
2025-03-09 07:15:15,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:15,872 [INFO]: 	Creating the index 03/09/2025, 07:15:15
2025-03-09 07:15:15,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:15
2025-03-09 07:15:15,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:15:15,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:15
2025-03-09 07:15:15,873 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:15:15,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.83it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.22it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.58it/s]100%|██████████| 16/16 [00:03<00:00,  4.36it/s]
2025-03-09 07:15:19,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:19
2025-03-09 07:16:03,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9043 secs
2025-03-09 07:16:03,454 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 07:16:03,454 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 07:16:16,284 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8294 secs
2025-03-09 07:16:16,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4129 secs
2025-03-09 07:16:16,286 [INFO]: {
2025-03-09 07:16:16,286 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:16,286 [INFO]: 	index_param: efSearch=249
2025-03-09 07:16:16,286 [INFO]: 	index_path: knn.index
2025-03-09 07:16:16,286 [INFO]: 	size in bytes: 756283810
2025-03-09 07:16:16,286 [INFO]: 	avg_search_speed_ms: 10.251020156724959
2025-03-09 07:16:16,286 [INFO]: 	99p_search_speed_ms: 23.63931998843327
2025-03-09 07:16:16,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:16,286 [INFO]: 	nb vectors: 3844
2025-03-09 07:16:16,286 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:16,286 [INFO]: 	compression ratio: 0.9993089128802056
2025-03-09 07:16:16,286 [INFO]: }
2025-03-09 07:16:16,286 [INFO]: 	>>> Finished "Creating the index" in 60.4143 secs
2025-03-09 07:16:16,286 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4431 secs
2025-03-09 07:16:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 59923 [episode count 3/20]
[retrieval_preprocessing] for episode 80915 [episode count 4/20], we have num_retrieval=np.int64(3771) num_query=np.int64(243)
2025-03-09 07:16:18,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:18,681 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:18
2025-03-09 07:16:18,681 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.04it/s]
2025-03-09 07:16:18,705 [INFO]: There are 3771 embeddings of dim 49152
2025-03-09 07:16:18,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:16:18,705 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:18,705 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:16:18,705 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:18,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:18,705 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,706 [INFO]: 778.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:18,706 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:16:18,706 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:18
2025-03-09 07:16:18,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:18,706 [INFO]: 	Creating the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,706 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:18
2025-03-09 07:16:18,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:18,707 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,707 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:16:18,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.49it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.86it/s] 80%|████████  | 12/15 [00:00<00:00, 40.59it/s]100%|██████████| 15/15 [00:03<00:00,  4.54it/s]
2025-03-09 07:16:22,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:22
2025-03-09 07:16:59,584 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5719 secs
2025-03-09 07:16:59,584 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:16:59,585 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-09 07:17:11,839 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2541 secs
2025-03-09 07:17:11,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1339 secs
2025-03-09 07:17:11,841 [INFO]: {
2025-03-09 07:17:11,841 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:11,841 [INFO]: 	index_param: efSearch=208
2025-03-09 07:17:11,841 [INFO]: 	index_path: knn.index
2025-03-09 07:17:11,841 [INFO]: 	size in bytes: 741921310
2025-03-09 07:17:11,841 [INFO]: 	avg_search_speed_ms: 9.059289379629131
2025-03-09 07:17:11,841 [INFO]: 	99p_search_speed_ms: 21.521512246690694
2025-03-09 07:17:11,841 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:11,841 [INFO]: 	nb vectors: 3771
2025-03-09 07:17:11,841 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:11,841 [INFO]: 	compression ratio: 0.99930916932417
2025-03-09 07:17:11,841 [INFO]: }
2025-03-09 07:17:11,841 [INFO]: 	>>> Finished "Creating the index" in 53.1354 secs
2025-03-09 07:17:11,841 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1600 secs
2025-03-09 07:17:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 80915 [episode count 4/20]
[retrieval_preprocessing] for episode 11808 [episode count 5/20], we have num_retrieval=np.int64(3833) num_query=np.int64(181)
2025-03-09 07:17:13,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:14,334 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:14
2025-03-09 07:17:14,335 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1828.38it/s]
2025-03-09 07:17:14,363 [INFO]: There are 3833 embeddings of dim 49152
2025-03-09 07:17:14,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:17:14,363 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:14
2025-03-09 07:17:14,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:14,363 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:17:14,363 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:14,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:14,363 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:14
2025-03-09 07:17:14,364 [INFO]: 791.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:14,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:17:14,364 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:14
2025-03-09 07:17:14,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:14,364 [INFO]: 	Creating the index 03/09/2025, 07:17:14
2025-03-09 07:17:14,364 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:14
2025-03-09 07:17:14,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:17:14,365 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:14
2025-03-09 07:17:14,365 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:17:14,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.63it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.27it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.17it/s]100%|██████████| 16/16 [00:02<00:00,  4.02it/s]100%|██████████| 16/16 [00:02<00:00,  5.34it/s]
2025-03-09 07:17:17,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:17
2025-03-09 07:18:02,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3787 secs
2025-03-09 07:18:02,744 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:18:02,744 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.51it/s]
2025-03-09 07:18:17,787 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0432 secs
2025-03-09 07:18:17,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4244 secs
2025-03-09 07:18:17,789 [INFO]: {
2025-03-09 07:18:17,789 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:17,789 [INFO]: 	index_param: efSearch=238
2025-03-09 07:18:17,789 [INFO]: 	index_path: knn.index
2025-03-09 07:18:17,790 [INFO]: 	size in bytes: 754119610
2025-03-09 07:18:17,790 [INFO]: 	avg_search_speed_ms: 10.546372844081151
2025-03-09 07:18:17,790 [INFO]: 	99p_search_speed_ms: 26.167900327127427
2025-03-09 07:18:17,790 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:17,790 [INFO]: 	nb vectors: 3833
2025-03-09 07:18:17,790 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:17,790 [INFO]: 	compression ratio: 0.999308934560129
2025-03-09 07:18:17,790 [INFO]: }
2025-03-09 07:18:17,790 [INFO]: 	>>> Finished "Creating the index" in 63.4259 secs
2025-03-09 07:18:17,790 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4551 secs
2025-03-09 07:18:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 11808 [episode count 5/20]
[retrieval_preprocessing] for episode 25648 [episode count 6/20], we have num_retrieval=np.int64(3820) num_query=np.int64(194)
2025-03-09 07:18:19,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:20,473 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:20
2025-03-09 07:18:20,473 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2430.07it/s]
2025-03-09 07:18:20,497 [INFO]: There are 3820 embeddings of dim 49152
2025-03-09 07:18:20,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:18:20,497 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:20
2025-03-09 07:18:20,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:20,497 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:18:20,497 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:20,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:20,497 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:20
2025-03-09 07:18:20,497 [INFO]: 788.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:20,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:20,497 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:20
2025-03-09 07:18:20,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:20,498 [INFO]: 	Creating the index 03/09/2025, 07:18:20
2025-03-09 07:18:20,498 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:20
2025-03-09 07:18:20,499 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:20,499 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:20
2025-03-09 07:18:20,499 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:18:20,499 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.99it/s] 50%|█████     | 8/16 [00:00<00:00, 36.66it/s] 88%|████████▊ | 14/16 [00:00<00:00, 43.17it/s]100%|██████████| 16/16 [00:02<00:00,  5.48it/s]
2025-03-09 07:18:23,419 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:23
2025-03-09 07:19:06,074 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6547 secs
2025-03-09 07:19:06,074 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 07:19:06,074 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 07:19:21,767 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6925 secs
2025-03-09 07:19:21,769 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2707 secs
2025-03-09 07:19:21,770 [INFO]: {
2025-03-09 07:19:21,770 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:21,770 [INFO]: 	index_param: efSearch=230
2025-03-09 07:19:21,770 [INFO]: 	index_path: knn.index
2025-03-09 07:19:21,770 [INFO]: 	size in bytes: 751561810
2025-03-09 07:19:21,770 [INFO]: 	avg_search_speed_ms: 10.472676463678713
2025-03-09 07:19:21,770 [INFO]: 	99p_search_speed_ms: 26.501487372443084
2025-03-09 07:19:21,770 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:21,770 [INFO]: 	nb vectors: 3820
2025-03-09 07:19:21,770 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:21,770 [INFO]: 	compression ratio: 0.9993091053948044
2025-03-09 07:19:21,770 [INFO]: }
2025-03-09 07:19:21,770 [INFO]: 	>>> Finished "Creating the index" in 61.2722 secs
2025-03-09 07:19:21,770 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2963 secs
2025-03-09 07:19:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 25648 [episode count 6/20]
[retrieval_preprocessing] for episode 24118 [episode count 7/20], we have num_retrieval=np.int64(3833) num_query=np.int64(181)
2025-03-09 07:19:23,769 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:24,618 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:24
2025-03-09 07:19:24,618 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.08it/s]
2025-03-09 07:19:24,642 [INFO]: There are 3833 embeddings of dim 49152
2025-03-09 07:19:24,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:19:24,643 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:24
2025-03-09 07:19:24,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:24,643 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:19:24,643 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:24,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:24,643 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:24
2025-03-09 07:19:24,643 [INFO]: 791.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:24,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:19:24,643 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:24
2025-03-09 07:19:24,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:24,643 [INFO]: 	Creating the index 03/09/2025, 07:19:24
2025-03-09 07:19:24,643 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:24
2025-03-09 07:19:24,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:19:24,644 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:24
2025-03-09 07:19:24,644 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:19:24,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.43it/s] 38%|███▊      | 6/16 [00:00<00:00, 24.81it/s] 62%|██████▎   | 10/16 [00:00<00:00, 29.03it/s] 94%|█████████▍| 15/16 [00:00<00:00, 34.98it/s]100%|██████████| 16/16 [00:03<00:00,  4.37it/s]
2025-03-09 07:19:28,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:28
2025-03-09 07:20:13,412 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0992 secs
2025-03-09 07:20:13,412 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:20:13,412 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.11it/s]
2025-03-09 07:20:26,389 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9771 secs
2025-03-09 07:20:26,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7470 secs
2025-03-09 07:20:26,391 [INFO]: {
2025-03-09 07:20:26,391 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:26,391 [INFO]: 	index_param: efSearch=225
2025-03-09 07:20:26,391 [INFO]: 	index_path: knn.index
2025-03-09 07:20:26,391 [INFO]: 	size in bytes: 754119610
2025-03-09 07:20:26,391 [INFO]: 	avg_search_speed_ms: 9.451564557195443
2025-03-09 07:20:26,391 [INFO]: 	99p_search_speed_ms: 18.649540317710514
2025-03-09 07:20:26,391 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:26,391 [INFO]: 	nb vectors: 3833
2025-03-09 07:20:26,391 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:26,391 [INFO]: 	compression ratio: 0.999308934560129
2025-03-09 07:20:26,391 [INFO]: }
2025-03-09 07:20:26,392 [INFO]: 	>>> Finished "Creating the index" in 61.7484 secs
2025-03-09 07:20:26,392 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7739 secs
2025-03-09 07:20:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 24118 [episode count 7/20]
[retrieval_preprocessing] for episode 80967 [episode count 8/20], we have num_retrieval=np.int64(3838) num_query=np.int64(176)
2025-03-09 07:20:28,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:28,689 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:28
2025-03-09 07:20:28,689 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1364.45it/s]
2025-03-09 07:20:28,719 [INFO]: There are 3838 embeddings of dim 49152
2025-03-09 07:20:28,719 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 07:20:28,720 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:28
2025-03-09 07:20:28,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:28,720 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:20:28,720 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:28,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:20:28,720 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:28
2025-03-09 07:20:28,720 [INFO]: 792.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:28,721 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:20:28,721 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:28
2025-03-09 07:20:28,721 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:28,721 [INFO]: 	Creating the index 03/09/2025, 07:20:28
2025-03-09 07:20:28,721 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:28
2025-03-09 07:20:28,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:20:28,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:28
2025-03-09 07:20:28,724 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:20:28,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.11it/s] 50%|█████     | 8/16 [00:00<00:00, 39.26it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.42it/s]100%|██████████| 16/16 [00:02<00:00,  5.58it/s]
2025-03-09 07:20:31,599 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:31
2025-03-09 07:21:17,661 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0619 secs
2025-03-09 07:21:17,661 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 07:21:17,661 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.64it/s]
2025-03-09 07:21:30,316 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6550 secs
2025-03-09 07:21:30,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5949 secs
2025-03-09 07:21:30,319 [INFO]: {
2025-03-09 07:21:30,319 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:30,319 [INFO]: 	index_param: efSearch=227
2025-03-09 07:21:30,319 [INFO]: 	index_path: knn.index
2025-03-09 07:21:30,319 [INFO]: 	size in bytes: 755103370
2025-03-09 07:21:30,319 [INFO]: 	avg_search_speed_ms: 9.87214362225794
2025-03-09 07:21:30,319 [INFO]: 	99p_search_speed_ms: 20.7283079251647
2025-03-09 07:21:30,319 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:30,319 [INFO]: 	nb vectors: 3838
2025-03-09 07:21:30,319 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:30,320 [INFO]: 	compression ratio: 0.9993088813787178
2025-03-09 07:21:30,320 [INFO]: }
2025-03-09 07:21:30,320 [INFO]: 	>>> Finished "Creating the index" in 61.5985 secs
2025-03-09 07:21:30,320 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6309 secs
2025-03-09 07:21:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 80967 [episode count 8/20]
[retrieval_preprocessing] for episode 63560 [episode count 9/20], we have num_retrieval=np.int64(3813) num_query=np.int64(201)
2025-03-09 07:21:32,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:33,180 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:33
2025-03-09 07:21:33,180 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-09 07:21:33,217 [INFO]: There are 3813 embeddings of dim 49152
2025-03-09 07:21:33,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-09 07:21:33,218 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:33,218 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:21:33,218 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:33,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:33,218 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,218 [INFO]: 786.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:33,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:21:33,218 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:33
2025-03-09 07:21:33,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:33,218 [INFO]: 	Creating the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,218 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:33
2025-03-09 07:21:33,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:21:33,219 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,219 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:21:33,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.33it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.69it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.81it/s]100%|██████████| 16/16 [00:03<00:00,  5.13it/s]
2025-03-09 07:21:36,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:36
2025-03-09 07:22:15,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3085 secs
2025-03-09 07:22:15,654 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 07:22:15,654 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.27it/s]
2025-03-09 07:22:28,617 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9636 secs
2025-03-09 07:22:28,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4005 secs
2025-03-09 07:22:28,620 [INFO]: {
2025-03-09 07:22:28,620 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:28,620 [INFO]: 	index_param: efSearch=231
2025-03-09 07:22:28,620 [INFO]: 	index_path: knn.index
2025-03-09 07:22:28,620 [INFO]: 	size in bytes: 750184630
2025-03-09 07:22:28,620 [INFO]: 	avg_search_speed_ms: 9.979175008924496
2025-03-09 07:22:28,620 [INFO]: 	99p_search_speed_ms: 20.5369255784899
2025-03-09 07:22:28,620 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:28,620 [INFO]: 	nb vectors: 3813
2025-03-09 07:22:28,620 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:28,620 [INFO]: 	compression ratio: 0.9993090687555142
2025-03-09 07:22:28,620 [INFO]: }
2025-03-09 07:22:28,620 [INFO]: 	>>> Finished "Creating the index" in 55.4020 secs
2025-03-09 07:22:28,620 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4400 secs
2025-03-09 07:22:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 63560 [episode count 9/20]
[retrieval_preprocessing] for episode 82507 [episode count 10/20], we have num_retrieval=np.int64(3643) num_query=np.int64(371)
2025-03-09 07:22:30,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:31,157 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:31
2025-03-09 07:22:31,157 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1257.66it/s]
2025-03-09 07:22:31,182 [INFO]: There are 3643 embeddings of dim 49152
2025-03-09 07:22:31,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:22:31,182 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:31
2025-03-09 07:22:31,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:31,183 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:22:31,183 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:31,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:31,183 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:31
2025-03-09 07:22:31,183 [INFO]: 751.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:31,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:22:31,183 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:31
2025-03-09 07:22:31,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:31,183 [INFO]: 	Creating the index 03/09/2025, 07:22:31
2025-03-09 07:22:31,183 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:31
2025-03-09 07:22:31,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:22:31,184 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:31
2025-03-09 07:22:31,185 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:22:31,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.85it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.27it/s] 80%|████████  | 12/15 [00:00<00:00, 39.22it/s]100%|██████████| 15/15 [00:02<00:00,  5.44it/s]
2025-03-09 07:22:33,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:33
2025-03-09 07:23:15,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3997 secs
2025-03-09 07:23:15,346 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 07:23:15,346 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.83it/s]
2025-03-09 07:23:27,460 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1137 secs
2025-03-09 07:23:27,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2776 secs
2025-03-09 07:23:27,462 [INFO]: {
2025-03-09 07:23:27,462 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:27,462 [INFO]: 	index_param: efSearch=242
2025-03-09 07:23:27,462 [INFO]: 	index_path: knn.index
2025-03-09 07:23:27,462 [INFO]: 	size in bytes: 716738050
2025-03-09 07:23:27,462 [INFO]: 	avg_search_speed_ms: 9.889464180789423
2025-03-09 07:23:27,462 [INFO]: 	99p_search_speed_ms: 17.409200035035603
2025-03-09 07:23:27,462 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:27,462 [INFO]: 	nb vectors: 3643
2025-03-09 07:23:27,462 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:27,462 [INFO]: 	compression ratio: 0.9993092232231845
2025-03-09 07:23:27,462 [INFO]: }
2025-03-09 07:23:27,462 [INFO]: 	>>> Finished "Creating the index" in 56.2793 secs
2025-03-09 07:23:27,462 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3057 secs
2025-03-09 07:23:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 82507 [episode count 10/20]
[retrieval_preprocessing] for episode 7254 [episode count 11/20], we have num_retrieval=np.int64(3783) num_query=np.int64(231)
2025-03-09 07:23:31,117 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:31,640 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:31
2025-03-09 07:23:31,641 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1653.91it/s]
2025-03-09 07:23:31,666 [INFO]: There are 3783 embeddings of dim 49152
2025-03-09 07:23:31,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:23:31,667 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:31
2025-03-09 07:23:31,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:31,667 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:23:31,667 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:31,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:23:31,667 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:31
2025-03-09 07:23:31,667 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:31,667 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:23:31,667 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:31
2025-03-09 07:23:31,667 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:31,667 [INFO]: 	Creating the index 03/09/2025, 07:23:31
2025-03-09 07:23:31,667 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:31
2025-03-09 07:23:31,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:23:31,668 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:31
2025-03-09 07:23:31,668 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:23:31,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.16it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.23it/s] 87%|████████▋ | 13/15 [00:00<00:00, 41.37it/s]100%|██████████| 15/15 [00:03<00:00,  4.78it/s]
2025-03-09 07:23:34,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:34
2025-03-09 07:24:20,850 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0399 secs
2025-03-09 07:24:20,850 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 07:24:20,850 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.02it/s]
2025-03-09 07:24:38,464 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6136 secs
2025-03-09 07:24:38,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7984 secs
2025-03-09 07:24:38,467 [INFO]: {
2025-03-09 07:24:38,467 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:38,467 [INFO]: 	index_param: efSearch=218
2025-03-09 07:24:38,467 [INFO]: 	index_path: knn.index
2025-03-09 07:24:38,467 [INFO]: 	size in bytes: 744282190
2025-03-09 07:24:38,467 [INFO]: 	avg_search_speed_ms: 10.250598761886664
2025-03-09 07:24:38,467 [INFO]: 	99p_search_speed_ms: 20.58844536077231
2025-03-09 07:24:38,467 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:38,467 [INFO]: 	nb vectors: 3783
2025-03-09 07:24:38,467 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:38,467 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-09 07:24:38,467 [INFO]: }
2025-03-09 07:24:38,467 [INFO]: 	>>> Finished "Creating the index" in 66.7999 secs
2025-03-09 07:24:38,467 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8266 secs
2025-03-09 07:24:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 7254 [episode count 11/20]
[retrieval_preprocessing] for episode 52824 [episode count 12/20], we have num_retrieval=np.int64(3841) num_query=np.int64(173)
2025-03-09 07:24:43,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:44,199 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:44
2025-03-09 07:24:44,199 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-09 07:24:44,225 [INFO]: There are 3841 embeddings of dim 49152
2025-03-09 07:24:44,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 07:24:44,225 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:44,225 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:24:44,225 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:44,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:44,225 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,226 [INFO]: 792.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:44,226 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:24:44,226 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:44
2025-03-09 07:24:44,226 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:44,226 [INFO]: 	Creating the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,226 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:44
2025-03-09 07:24:44,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:24:44,227 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,227 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:24:44,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:08,  1.84it/s] 12%|█▎        | 2/16 [00:00<00:05,  2.58it/s] 50%|█████     | 8/16 [00:00<00:00, 12.52it/s] 69%|██████▉   | 11/16 [00:01<00:00, 15.54it/s] 94%|█████████▍| 15/16 [00:01<00:00, 20.03it/s]100%|██████████| 16/16 [00:03<00:00,  4.44it/s]
2025-03-09 07:24:47,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:47
2025-03-09 07:25:32,444 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6080 secs
2025-03-09 07:25:32,445 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:25:32,445 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-09 07:25:47,874 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4292 secs
2025-03-09 07:25:47,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6510 secs
2025-03-09 07:25:47,878 [INFO]: {
2025-03-09 07:25:47,878 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:47,878 [INFO]: 	index_param: efSearch=250
2025-03-09 07:25:47,878 [INFO]: 	index_path: knn.index
2025-03-09 07:25:47,878 [INFO]: 	size in bytes: 755693590
2025-03-09 07:25:47,878 [INFO]: 	avg_search_speed_ms: 11.684803469498233
2025-03-09 07:25:47,878 [INFO]: 	99p_search_speed_ms: 25.72372230933981
2025-03-09 07:25:47,878 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:47,878 [INFO]: 	nb vectors: 3841
2025-03-09 07:25:47,878 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:47,879 [INFO]: 	compression ratio: 0.9993088971417635
2025-03-09 07:25:47,879 [INFO]: }
2025-03-09 07:25:47,879 [INFO]: 	>>> Finished "Creating the index" in 63.6529 secs
2025-03-09 07:25:47,879 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6796 secs
2025-03-09 07:25:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 52824 [episode count 12/20]
[retrieval_preprocessing] for episode 49246 [episode count 13/20], we have num_retrieval=np.int64(3807) num_query=np.int64(207)
2025-03-09 07:25:50,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:51,340 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:51
2025-03-09 07:25:51,340 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 893.17it/s]
2025-03-09 07:25:51,372 [INFO]: There are 3807 embeddings of dim 49152
2025-03-09 07:25:51,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 07:25:51,372 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:51
2025-03-09 07:25:51,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:51,372 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:25:51,372 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:51,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:51,372 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:51
2025-03-09 07:25:51,372 [INFO]: 785.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:51,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:25:51,373 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:51
2025-03-09 07:25:51,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:51,373 [INFO]: 	Creating the index 03/09/2025, 07:25:51
2025-03-09 07:25:51,373 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:51
2025-03-09 07:25:51,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:25:51,374 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:51
2025-03-09 07:25:51,374 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:25:51,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.43it/s] 47%|████▋     | 7/15 [00:00<00:00, 29.58it/s] 80%|████████  | 12/15 [00:00<00:00, 37.29it/s]100%|██████████| 15/15 [00:03<00:00,  4.22it/s]
2025-03-09 07:25:54,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:54
2025-03-09 07:26:33,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9103 secs
2025-03-09 07:26:33,847 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:26:33,847 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-09 07:26:45,874 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0264 secs
2025-03-09 07:26:45,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5018 secs
2025-03-09 07:26:45,876 [INFO]: {
2025-03-09 07:26:45,876 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:45,876 [INFO]: 	index_param: efSearch=238
2025-03-09 07:26:45,876 [INFO]: 	index_path: knn.index
2025-03-09 07:26:45,876 [INFO]: 	size in bytes: 749004130
2025-03-09 07:26:45,876 [INFO]: 	avg_search_speed_ms: 10.56917771686215
2025-03-09 07:26:45,876 [INFO]: 	99p_search_speed_ms: 25.999144488014263
2025-03-09 07:26:45,876 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:45,876 [INFO]: 	nb vectors: 3807
2025-03-09 07:26:45,876 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:45,876 [INFO]: 	compression ratio: 0.9993091172941864
2025-03-09 07:26:45,876 [INFO]: }
2025-03-09 07:26:45,876 [INFO]: 	>>> Finished "Creating the index" in 54.5036 secs
2025-03-09 07:26:45,876 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5361 secs
2025-03-09 07:26:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 49246 [episode count 13/20]
[retrieval_preprocessing] for episode 27743 [episode count 14/20], we have num_retrieval=np.int64(3880) num_query=np.int64(134)
2025-03-09 07:26:48,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:48,814 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:48
2025-03-09 07:26:48,814 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.47it/s]
2025-03-09 07:26:48,840 [INFO]: There are 3880 embeddings of dim 49152
2025-03-09 07:26:48,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:26:48,840 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:48
2025-03-09 07:26:48,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:48,840 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:26:48,840 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:48,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:48,840 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:48
2025-03-09 07:26:48,841 [INFO]: 800.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:48,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:26:48,841 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:48
2025-03-09 07:26:48,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:48,841 [INFO]: 	Creating the index 03/09/2025, 07:26:48
2025-03-09 07:26:48,841 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:48
2025-03-09 07:26:48,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:26:48,842 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:48
2025-03-09 07:26:48,842 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:26:48,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.02it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.00it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.41it/s]100%|██████████| 16/16 [00:03<00:00,  3.40it/s]100%|██████████| 16/16 [00:03<00:00,  4.57it/s]
2025-03-09 07:26:52,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:52
2025-03-09 07:27:36,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0708 secs
2025-03-09 07:27:36,421 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 07:27:36,421 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-09 07:27:48,449 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0279 secs
2025-03-09 07:27:48,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6092 secs
2025-03-09 07:27:48,451 [INFO]: {
2025-03-09 07:27:48,451 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:48,452 [INFO]: 	index_param: efSearch=210
2025-03-09 07:27:48,452 [INFO]: 	index_path: knn.index
2025-03-09 07:27:48,452 [INFO]: 	size in bytes: 763366570
2025-03-09 07:27:48,452 [INFO]: 	avg_search_speed_ms: 8.78369573608394
2025-03-09 07:27:48,452 [INFO]: 	99p_search_speed_ms: 13.97479268722235
2025-03-09 07:27:48,452 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:48,452 [INFO]: 	nb vectors: 3880
2025-03-09 07:27:48,452 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:48,452 [INFO]: 	compression ratio: 0.999308942753414
2025-03-09 07:27:48,452 [INFO]: }
2025-03-09 07:27:48,452 [INFO]: 	>>> Finished "Creating the index" in 59.6108 secs
2025-03-09 07:27:48,452 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6373 secs
2025-03-09 07:27:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 27743 [episode count 14/20]
[retrieval_preprocessing] for episode 65131 [episode count 15/20], we have num_retrieval=np.int64(3774) num_query=np.int64(240)
2025-03-09 07:27:49,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:50,298 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:50
2025-03-09 07:27:50,298 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-09 07:27:50,326 [INFO]: There are 3774 embeddings of dim 49152
2025-03-09 07:27:50,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:27:50,326 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:50
2025-03-09 07:27:50,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:50,326 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:27:50,326 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:50,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:50,327 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:50
2025-03-09 07:27:50,327 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:50,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:50,327 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:50
2025-03-09 07:27:50,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:50,327 [INFO]: 	Creating the index 03/09/2025, 07:27:50
2025-03-09 07:27:50,327 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:50
2025-03-09 07:27:50,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:27:50,328 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:50
2025-03-09 07:27:50,328 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:27:50,328 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.75it/s] 40%|████      | 6/15 [00:00<00:00, 27.37it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.06it/s]100%|██████████| 15/15 [00:03<00:00,  3.50it/s]100%|██████████| 15/15 [00:03<00:00,  4.80it/s]
2025-03-09 07:27:53,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:53
2025-03-09 07:28:32,085 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6297 secs
2025-03-09 07:28:32,086 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 07:28:32,086 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.54it/s]
2025-03-09 07:28:44,232 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1457 secs
2025-03-09 07:28:44,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9059 secs
2025-03-09 07:28:44,234 [INFO]: {
2025-03-09 07:28:44,234 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:44,234 [INFO]: 	index_param: efSearch=155
2025-03-09 07:28:44,234 [INFO]: 	index_path: knn.index
2025-03-09 07:28:44,234 [INFO]: 	size in bytes: 742511530
2025-03-09 07:28:44,234 [INFO]: 	avg_search_speed_ms: 7.609390299994062
2025-03-09 07:28:44,234 [INFO]: 	99p_search_speed_ms: 18.258970603346786
2025-03-09 07:28:44,234 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:44,234 [INFO]: 	nb vectors: 3774
2025-03-09 07:28:44,234 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:44,234 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-09 07:28:44,234 [INFO]: }
2025-03-09 07:28:44,234 [INFO]: 	>>> Finished "Creating the index" in 53.9073 secs
2025-03-09 07:28:44,234 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9358 secs
2025-03-09 07:28:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 65131 [episode count 15/20]
[retrieval_preprocessing] for episode 35948 [episode count 16/20], we have num_retrieval=np.int64(3809) num_query=np.int64(205)
2025-03-09 07:28:46,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:46,634 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:46
2025-03-09 07:28:46,635 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.82it/s]
2025-03-09 07:28:46,663 [INFO]: There are 3809 embeddings of dim 49152
2025-03-09 07:28:46,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:28:46,664 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:46
2025-03-09 07:28:46,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:46,664 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:28:46,664 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:46,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:28:46,664 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:46
2025-03-09 07:28:46,664 [INFO]: 786.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:46,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:28:46,665 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:46
2025-03-09 07:28:46,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:46,665 [INFO]: 	Creating the index 03/09/2025, 07:28:46
2025-03-09 07:28:46,665 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:46
2025-03-09 07:28:46,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:28:46,668 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:46
2025-03-09 07:28:46,669 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:28:46,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 25.46it/s] 60%|██████    | 9/15 [00:00<00:00, 41.75it/s] 93%|█████████▎| 14/15 [00:00<00:00, 43.47it/s]100%|██████████| 15/15 [00:03<00:00,  4.86it/s]
2025-03-09 07:28:49,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:49
2025-03-09 07:29:29,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1397 secs
2025-03-09 07:29:29,903 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 07:29:29,903 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-09 07:29:43,022 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1193 secs
2025-03-09 07:29:43,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3565 secs
2025-03-09 07:29:43,025 [INFO]: {
2025-03-09 07:29:43,025 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:43,025 [INFO]: 	index_param: efSearch=262
2025-03-09 07:29:43,025 [INFO]: 	index_path: knn.index
2025-03-09 07:29:43,025 [INFO]: 	size in bytes: 749397670
2025-03-09 07:29:43,025 [INFO]: 	avg_search_speed_ms: 11.628196608859959
2025-03-09 07:29:43,025 [INFO]: 	99p_search_speed_ms: 19.34319486375896
2025-03-09 07:29:43,025 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:43,025 [INFO]: 	nb vectors: 3809
2025-03-09 07:29:43,025 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:43,025 [INFO]: 	compression ratio: 0.999309047758315
2025-03-09 07:29:43,025 [INFO]: }
2025-03-09 07:29:43,025 [INFO]: 	>>> Finished "Creating the index" in 56.3603 secs
2025-03-09 07:29:43,025 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3909 secs
2025-03-09 07:29:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 35948 [episode count 16/20]
[retrieval_preprocessing] for episode 30835 [episode count 17/20], we have num_retrieval=np.int64(3840) num_query=np.int64(174)
2025-03-09 07:29:45,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:46,627 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:46
2025-03-09 07:29:46,627 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.41it/s]
2025-03-09 07:29:46,667 [INFO]: There are 3840 embeddings of dim 49152
2025-03-09 07:29:46,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-09 07:29:46,667 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:46
2025-03-09 07:29:46,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:46,667 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:29:46,667 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:46,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:29:46,667 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:46
2025-03-09 07:29:46,668 [INFO]: 792.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:46,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:29:46,668 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:46
2025-03-09 07:29:46,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:46,668 [INFO]: 	Creating the index 03/09/2025, 07:29:46
2025-03-09 07:29:46,668 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:46
2025-03-09 07:29:46,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:29:46,669 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:46
2025-03-09 07:29:46,669 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:29:46,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.71it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.76it/s] 69%|██████▉   | 11/16 [00:00<00:00, 33.42it/s]100%|██████████| 16/16 [00:03<00:00,  3.50it/s]100%|██████████| 16/16 [00:03<00:00,  4.68it/s]
2025-03-09 07:29:50,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:50
2025-03-09 07:30:36,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6407 secs
2025-03-09 07:30:36,763 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 07:30:36,763 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.13it/s]
2025-03-09 07:30:51,907 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1446 secs
2025-03-09 07:30:51,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2404 secs
2025-03-09 07:30:51,910 [INFO]: {
2025-03-09 07:30:51,910 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:51,910 [INFO]: 	index_param: efSearch=235
2025-03-09 07:30:51,910 [INFO]: 	index_path: knn.index
2025-03-09 07:30:51,910 [INFO]: 	size in bytes: 755496850
2025-03-09 07:30:51,910 [INFO]: 	avg_search_speed_ms: 11.093515726456836
2025-03-09 07:30:51,910 [INFO]: 	99p_search_speed_ms: 24.477738277055323
2025-03-09 07:30:51,910 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:51,910 [INFO]: 	nb vectors: 3840
2025-03-09 07:30:51,910 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:51,910 [INFO]: 	compression ratio: 0.9993088918901515
2025-03-09 07:30:51,910 [INFO]: }
2025-03-09 07:30:51,910 [INFO]: 	>>> Finished "Creating the index" in 65.2422 secs
2025-03-09 07:30:51,910 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2829 secs
2025-03-09 07:30:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 30835 [episode count 17/20]
[retrieval_preprocessing] for episode 43123 [episode count 18/20], we have num_retrieval=np.int64(3845) num_query=np.int64(169)
2025-03-09 07:30:54,079 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:54,597 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:54
2025-03-09 07:30:54,598 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-09 07:30:54,623 [INFO]: There are 3845 embeddings of dim 49152
2025-03-09 07:30:54,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:30:54,623 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:54
2025-03-09 07:30:54,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:54,623 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:30:54,623 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:54,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:54,624 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:54
2025-03-09 07:30:54,624 [INFO]: 793.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:54,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:30:54,624 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:54
2025-03-09 07:30:54,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:54,624 [INFO]: 	Creating the index 03/09/2025, 07:30:54
2025-03-09 07:30:54,624 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:54
2025-03-09 07:30:54,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:30:54,625 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:54
2025-03-09 07:30:54,625 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:30:54,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.49it/s] 31%|███▏      | 5/16 [00:00<00:00, 23.14it/s] 62%|██████▎   | 10/16 [00:00<00:00, 33.71it/s] 94%|█████████▍| 15/16 [00:00<00:00, 39.25it/s]100%|██████████| 16/16 [00:03<00:00,  5.19it/s]
2025-03-09 07:30:57,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:57
2025-03-09 07:31:43,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4006 secs
2025-03-09 07:31:43,113 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 07:31:43,114 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s]
2025-03-09 07:32:05,326 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2125 secs
2025-03-09 07:32:05,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7034 secs
2025-03-09 07:32:05,329 [INFO]: {
2025-03-09 07:32:05,329 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:05,329 [INFO]: 	index_param: efSearch=237
2025-03-09 07:32:05,329 [INFO]: 	index_path: knn.index
2025-03-09 07:32:05,329 [INFO]: 	size in bytes: 756480550
2025-03-09 07:32:05,329 [INFO]: 	avg_search_speed_ms: 9.846888175720027
2025-03-09 07:32:05,329 [INFO]: 	99p_search_speed_ms: 21.67118999641389
2025-03-09 07:32:05,329 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:05,329 [INFO]: 	nb vectors: 3845
2025-03-09 07:32:05,329 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:05,329 [INFO]: 	compression ratio: 0.9993089181208955
2025-03-09 07:32:05,329 [INFO]: }
2025-03-09 07:32:05,329 [INFO]: 	>>> Finished "Creating the index" in 70.7049 secs
2025-03-09 07:32:05,329 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7312 secs
2025-03-09 07:32:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 43123 [episode count 18/20]
[retrieval_preprocessing] for episode 68234 [episode count 19/20], we have num_retrieval=np.int64(3783) num_query=np.int64(231)
2025-03-09 07:32:07,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:08,246 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:08
2025-03-09 07:32:08,246 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2167.60it/s]
2025-03-09 07:32:08,271 [INFO]: There are 3783 embeddings of dim 49152
2025-03-09 07:32:08,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:32:08,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:08,272 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:32:08,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:08,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:08,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,272 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:08,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:32:08,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:08
2025-03-09 07:32:08,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:08,272 [INFO]: 	Creating the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,272 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:08
2025-03-09 07:32:08,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:32:08,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,273 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:32:08,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.79it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.11it/s] 80%|████████  | 12/15 [00:00<00:00, 37.22it/s]100%|██████████| 15/15 [00:03<00:00,  4.15it/s]
2025-03-09 07:32:11,893 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:11
2025-03-09 07:32:52,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4216 secs
2025-03-09 07:32:52,315 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 07:32:52,315 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.75it/s]
2025-03-09 07:33:04,358 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0428 secs
2025-03-09 07:33:04,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0875 secs
2025-03-09 07:33:04,361 [INFO]: {
2025-03-09 07:33:04,361 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:04,361 [INFO]: 	index_param: efSearch=253
2025-03-09 07:33:04,361 [INFO]: 	index_path: knn.index
2025-03-09 07:33:04,361 [INFO]: 	size in bytes: 744282190
2025-03-09 07:33:04,361 [INFO]: 	avg_search_speed_ms: 10.110133718576797
2025-03-09 07:33:04,361 [INFO]: 	99p_search_speed_ms: 19.01647093705833
2025-03-09 07:33:04,361 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:04,361 [INFO]: 	nb vectors: 3783
2025-03-09 07:33:04,361 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:04,361 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-09 07:33:04,361 [INFO]: }
2025-03-09 07:33:04,361 [INFO]: 	>>> Finished "Creating the index" in 56.0891 secs
2025-03-09 07:33:04,361 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1155 secs
2025-03-09 07:33:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 68234 [episode count 19/20]
2025-03-09 07:33:07: [retrieval_preprocessing] finished for (9228483020, 'marker') [chosen_id count 1/5]
2025-03-09 07:33:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2927338332, 'cloth') [chosen_id count 2/5]
2025-03-09 07:33:09: [retrieval_preprocessing] we have num_total=10501 embedding_dim=49152
[retrieval_preprocessing] for episode 43393 [episode count 0/20], we have num_retrieval=np.int64(9930) num_query=np.int64(571)
2025-03-09 07:33:18,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:19,749 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:19
2025-03-09 07:33:19,749 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-09 07:33:19,775 [INFO]: There are 9930 embeddings of dim 49152
2025-03-09 07:33:19,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 07:33:19,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:19,775 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:33:19,775 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:33:19,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:33:19,776 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,776 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:19,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:33:19,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:19
2025-03-09 07:33:19,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:19,776 [INFO]: 	Creating the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,776 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:19
2025-03-09 07:33:19,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:33:19,778 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:19
2025-03-09 07:33:19,778 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:33:19,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:02<01:31,  2.29s/it]  7%|▋         | 3/41 [00:04<00:52,  1.39s/it] 10%|▉         | 4/41 [00:05<00:49,  1.33s/it] 22%|██▏       | 9/41 [00:05<00:12,  2.51it/s] 27%|██▋       | 11/41 [00:05<00:09,  3.16it/s] 39%|███▉      | 16/41 [00:06<00:04,  6.01it/s] 51%|█████     | 21/41 [00:09<00:08,  2.40it/s] 56%|█████▌    | 23/41 [00:11<00:09,  1.90it/s] 61%|██████    | 25/41 [00:12<00:07,  2.27it/s] 73%|███████▎  | 30/41 [00:12<00:02,  3.86it/s] 85%|████████▌ | 35/41 [00:12<00:01,  5.94it/s] 95%|█████████▌| 39/41 [00:14<00:00,  3.84it/s]100%|██████████| 41/41 [00:18<00:00,  1.59it/s]100%|██████████| 41/41 [00:18<00:00,  2.17it/s]
2025-03-09 07:33:38,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:38
2025-03-09 07:34:53,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.7482 secs
2025-03-09 07:34:53,429 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 07:34:53,429 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.83s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.94it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.53it/s]
2025-03-09 07:35:10,872 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4432 secs
2025-03-09 07:35:10,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.1101 secs
2025-03-09 07:35:10,888 [INFO]: {
2025-03-09 07:35:10,888 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:10,888 [INFO]: 	index_param: efSearch=276
2025-03-09 07:35:10,888 [INFO]: 	index_path: knn.index
2025-03-09 07:35:10,888 [INFO]: 	size in bytes: 1953669010
2025-03-09 07:35:10,888 [INFO]: 	avg_search_speed_ms: 13.87236544722885
2025-03-09 07:35:10,888 [INFO]: 	99p_search_speed_ms: 35.92403098009525
2025-03-09 07:35:10,888 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:10,888 [INFO]: 	nb vectors: 9930
2025-03-09 07:35:10,888 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:10,888 [INFO]: 	compression ratio: 0.9993081888523174
2025-03-09 07:35:10,888 [INFO]: }
2025-03-09 07:35:10,888 [INFO]: 	>>> Finished "Creating the index" in 111.1123 secs
2025-03-09 07:35:10,888 [INFO]: >>> Finished "Launching the whole pipeline" in 111.1395 secs
2025-03-09 07:35:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 43393 [episode count 0/20]
[retrieval_preprocessing] for episode 32514 [episode count 1/20], we have num_retrieval=np.int64(10153) num_query=np.int64(348)
2025-03-09 07:35:19,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:21,834 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:21
2025-03-09 07:35:21,834 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1362.67it/s]
2025-03-09 07:35:21,868 [INFO]: There are 10153 embeddings of dim 49152
2025-03-09 07:35:21,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 07:35:21,869 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:21
2025-03-09 07:35:21,869 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:21,869 [INFO]: 		-> Add: 5.6 seconds
2025-03-09 07:35:21,869 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:35:21,869 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:35:21,869 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:21
2025-03-09 07:35:21,870 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:21,870 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 07:35:21,870 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:21
2025-03-09 07:35:21,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 07:35:21,871 [INFO]: 	Creating the index 03/09/2025, 07:35:21
2025-03-09 07:35:21,871 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:35:21
2025-03-09 07:35:21,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-09 07:35:21,874 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:21
2025-03-09 07:35:21,874 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-09 07:35:21,875 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.84it/s] 15%|█▍        | 6/41 [00:00<00:01, 27.06it/s] 27%|██▋       | 11/41 [00:00<00:00, 33.83it/s] 39%|███▉      | 16/41 [00:00<00:00, 36.81it/s] 49%|████▉     | 20/41 [00:00<00:00, 36.95it/s] 59%|█████▊    | 24/41 [00:08<00:11,  1.50it/s] 73%|███████▎  | 30/41 [00:08<00:04,  2.49it/s] 88%|████████▊ | 36/41 [00:08<00:01,  3.85it/s]100%|██████████| 41/41 [00:16<00:00,  1.54it/s]100%|██████████| 41/41 [00:16<00:00,  2.49it/s]
2025-03-09 07:35:38,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:38
2025-03-09 07:36:55,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.6454 secs
2025-03-09 07:36:55,011 [INFO]: The best hyperparameters are: efSearch=107
2025-03-09 07:36:55,011 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.54it/s]
2025-03-09 07:37:10,937 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9254 secs
2025-03-09 07:37:10,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.0734 secs
2025-03-09 07:37:10,948 [INFO]: {
2025-03-09 07:37:10,948 [INFO]: 	index_key: HNSW32
2025-03-09 07:37:10,948 [INFO]: 	index_param: efSearch=107
2025-03-09 07:37:10,948 [INFO]: 	index_path: knn.index
2025-03-09 07:37:10,948 [INFO]: 	size in bytes: 1998920526
2025-03-09 07:37:10,948 [INFO]: 	avg_search_speed_ms: 10.517474802449627
2025-03-09 07:37:10,948 [INFO]: 	99p_search_speed_ms: 21.91209518583492
2025-03-09 07:37:10,948 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:10,948 [INFO]: 	nb vectors: 10153
2025-03-09 07:37:10,948 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:10,948 [INFO]: 	compression ratio: 0.9986195038951738
2025-03-09 07:37:10,948 [INFO]: }
2025-03-09 07:37:10,948 [INFO]: 	>>> Finished "Creating the index" in 109.0772 secs
2025-03-09 07:37:10,948 [INFO]: >>> Finished "Launching the whole pipeline" in 109.1140 secs
2025-03-09 07:37:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 32514 [episode count 1/20]
[retrieval_preprocessing] for episode 46595 [episode count 2/20], we have num_retrieval=np.int64(9741) num_query=np.int64(760)
2025-03-09 07:37:14,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:15,728 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:15
2025-03-09 07:37:15,728 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1501.72it/s]
2025-03-09 07:37:15,753 [INFO]: There are 9741 embeddings of dim 49152
2025-03-09 07:37:15,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:37:15,754 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:15,754 [INFO]: 		-> Add: 5.4 seconds
2025-03-09 07:37:15,754 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:37:15,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:15,754 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,754 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:15,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:37:15,754 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:15
2025-03-09 07:37:15,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:15,754 [INFO]: 	Creating the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,754 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:15
2025-03-09 07:37:15,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:37:15,755 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,755 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:37:15,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.58it/s] 15%|█▌        | 6/40 [00:00<00:01, 29.91it/s] 28%|██▊       | 11/40 [00:00<00:00, 38.31it/s] 40%|████      | 16/40 [00:00<00:00, 42.50it/s] 52%|█████▎    | 21/40 [00:04<00:05,  3.19it/s] 68%|██████▊   | 27/40 [00:04<00:02,  5.11it/s] 82%|████████▎ | 33/40 [00:04<00:00,  7.61it/s] 98%|█████████▊| 39/40 [00:04<00:00, 10.76it/s]100%|██████████| 40/40 [00:08<00:00,  4.52it/s]
2025-03-09 07:37:24,616 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:24
2025-03-09 07:38:38,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.6196 secs
2025-03-09 07:38:38,237 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 07:38:38,237 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.42it/s]
2025-03-09 07:38:55,819 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5823 secs
2025-03-09 07:38:55,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.0685 secs
2025-03-09 07:38:55,824 [INFO]: {
2025-03-09 07:38:55,824 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:55,824 [INFO]: 	index_param: efSearch=152
2025-03-09 07:38:55,824 [INFO]: 	index_path: knn.index
2025-03-09 07:38:55,824 [INFO]: 	size in bytes: 1916483890
2025-03-09 07:38:55,824 [INFO]: 	avg_search_speed_ms: 9.357394635550142
2025-03-09 07:38:55,824 [INFO]: 	99p_search_speed_ms: 18.128882944583893
2025-03-09 07:38:55,824 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:55,824 [INFO]: 	nb vectors: 9741
2025-03-09 07:38:55,824 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:55,824 [INFO]: 	compression ratio: 0.9993084408343239
2025-03-09 07:38:55,824 [INFO]: }
2025-03-09 07:38:55,824 [INFO]: 	>>> Finished "Creating the index" in 100.0702 secs
2025-03-09 07:38:55,824 [INFO]: >>> Finished "Launching the whole pipeline" in 100.0965 secs
2025-03-09 07:38:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 46595 [episode count 2/20]
[retrieval_preprocessing] for episode 81027 [episode count 3/20], we have num_retrieval=np.int64(10048) num_query=np.int64(453)
2025-03-09 07:39:01,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:03,245 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:03
2025-03-09 07:39:03,245 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1680.41it/s]
2025-03-09 07:39:03,275 [INFO]: There are 10048 embeddings of dim 49152
2025-03-09 07:39:03,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:39:03,275 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:03
2025-03-09 07:39:03,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:03,276 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:39:03,276 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:39:03,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:39:03,276 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:03
2025-03-09 07:39:03,276 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:03,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:39:03,276 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:03
2025-03-09 07:39:03,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 07:39:03,277 [INFO]: 	Creating the index 03/09/2025, 07:39:03
2025-03-09 07:39:03,277 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:39:03
2025-03-09 07:39:03,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-09 07:39:03,280 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:03
2025-03-09 07:39:03,280 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:39:03,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:04,  9.22it/s] 15%|█▍        | 6/41 [00:00<00:01, 31.83it/s] 24%|██▍       | 10/41 [00:00<00:00, 33.80it/s] 39%|███▉      | 16/41 [00:00<00:00, 41.46it/s] 51%|█████     | 21/41 [00:06<00:10,  1.98it/s] 63%|██████▎   | 26/41 [00:06<00:05,  2.99it/s] 78%|███████▊  | 32/41 [00:07<00:01,  4.64it/s] 93%|█████████▎| 38/41 [00:07<00:00,  6.82it/s]100%|██████████| 41/41 [00:14<00:00,  2.88it/s]
2025-03-09 07:39:17,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:17
2025-03-09 07:40:32,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.3388 secs
2025-03-09 07:40:32,873 [INFO]: The best hyperparameters are: efSearch=77
2025-03-09 07:40:32,873 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.52it/s]
2025-03-09 07:40:56,361 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4884 secs
2025-03-09 07:40:56,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.0836 secs
2025-03-09 07:40:56,364 [INFO]: {
2025-03-09 07:40:56,364 [INFO]: 	index_key: HNSW32
2025-03-09 07:40:56,364 [INFO]: 	index_param: efSearch=77
2025-03-09 07:40:56,364 [INFO]: 	index_path: knn.index
2025-03-09 07:40:56,364 [INFO]: 	size in bytes: 1978248034
2025-03-09 07:40:56,364 [INFO]: 	avg_search_speed_ms: 7.9374158071235765
2025-03-09 07:40:56,364 [INFO]: 	99p_search_speed_ms: 16.97340596932924
2025-03-09 07:40:56,364 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:56,364 [INFO]: 	nb vectors: 10048
2025-03-09 07:40:56,364 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:56,364 [INFO]: 	compression ratio: 0.9986195613729598
2025-03-09 07:40:56,364 [INFO]: }
2025-03-09 07:40:56,364 [INFO]: 	>>> Finished "Creating the index" in 113.0873 secs
2025-03-09 07:40:56,364 [INFO]: >>> Finished "Launching the whole pipeline" in 113.1189 secs
2025-03-09 07:40:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 81027 [episode count 3/20]
[retrieval_preprocessing] for episode 32391 [episode count 4/20], we have num_retrieval=np.int64(9907) num_query=np.int64(594)
2025-03-09 07:40:59,296 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:01,078 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:01
2025-03-09 07:41:01,079 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.33it/s]
2025-03-09 07:41:01,108 [INFO]: There are 9907 embeddings of dim 49152
2025-03-09 07:41:01,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:41:01,109 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:01
2025-03-09 07:41:01,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:01,109 [INFO]: 		-> Add: 5.4 seconds
2025-03-09 07:41:01,109 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:41:01,109 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:41:01,109 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:01
2025-03-09 07:41:01,109 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:01,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:41:01,109 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:01
2025-03-09 07:41:01,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:01,110 [INFO]: 	Creating the index 03/09/2025, 07:41:01
2025-03-09 07:41:01,110 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:01
2025-03-09 07:41:01,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:41:01,112 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:01
2025-03-09 07:41:01,112 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:41:01,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:06,  6.15it/s] 15%|█▌        | 6/40 [00:00<00:01, 25.68it/s] 25%|██▌       | 10/40 [00:00<00:00, 30.05it/s] 38%|███▊      | 15/40 [00:00<00:00, 36.80it/s] 50%|█████     | 20/40 [00:00<00:00, 40.86it/s] 62%|██████▎   | 25/40 [00:04<00:04,  3.35it/s] 78%|███████▊  | 31/40 [00:04<00:01,  5.26it/s] 92%|█████████▎| 37/40 [00:04<00:00,  7.73it/s]100%|██████████| 40/40 [00:08<00:00,  4.53it/s]
2025-03-09 07:41:09,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:09
2025-03-09 07:42:15,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.5495 secs
2025-03-09 07:42:15,504 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 07:42:15,504 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.81it/s]
2025-03-09 07:42:31,426 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9217 secs
2025-03-09 07:42:31,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3167 secs
2025-03-09 07:42:31,429 [INFO]: {
2025-03-09 07:42:31,429 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:31,429 [INFO]: 	index_param: efSearch=162
2025-03-09 07:42:31,429 [INFO]: 	index_path: knn.index
2025-03-09 07:42:31,429 [INFO]: 	size in bytes: 1949143810
2025-03-09 07:42:31,429 [INFO]: 	avg_search_speed_ms: 8.768227144365051
2025-03-09 07:42:31,429 [INFO]: 	99p_search_speed_ms: 17.790701116900877
2025-03-09 07:42:31,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:31,429 [INFO]: 	nb vectors: 9907
2025-03-09 07:42:31,429 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:31,429 [INFO]: 	compression ratio: 0.9993082326747352
2025-03-09 07:42:31,429 [INFO]: }
2025-03-09 07:42:31,429 [INFO]: 	>>> Finished "Creating the index" in 90.3195 secs
2025-03-09 07:42:31,429 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3507 secs
2025-03-09 07:42:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 32391 [episode count 4/20]
[retrieval_preprocessing] for episode 26504 [episode count 5/20], we have num_retrieval=np.int64(9915) num_query=np.int64(586)
2025-03-09 07:42:36,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:37,701 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:37
2025-03-09 07:42:37,701 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.41it/s]
2025-03-09 07:42:37,730 [INFO]: There are 9915 embeddings of dim 49152
2025-03-09 07:42:37,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:42:37,731 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:37,731 [INFO]: 		-> Add: 5.4 seconds
2025-03-09 07:42:37,731 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:42:37,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:42:37,732 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,732 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:37,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:42:37,732 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:37
2025-03-09 07:42:37,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:37,733 [INFO]: 	Creating the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,733 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:37
2025-03-09 07:42:37,736 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:42:37,736 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,736 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:42:37,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.38it/s] 15%|█▍        | 6/41 [00:00<00:01, 27.87it/s] 27%|██▋       | 11/41 [00:00<00:00, 35.09it/s] 39%|███▉      | 16/41 [00:00<00:00, 38.28it/s] 49%|████▉     | 20/41 [00:00<00:00, 35.83it/s] 59%|█████▊    | 24/41 [00:04<00:06,  2.69it/s] 73%|███████▎  | 30/41 [00:05<00:02,  4.41it/s] 83%|████████▎ | 34/41 [00:05<00:01,  5.88it/s] 98%|█████████▊| 40/41 [00:05<00:00,  8.84it/s]100%|██████████| 41/41 [00:09<00:00,  4.28it/s]
2025-03-09 07:42:47,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:47
2025-03-09 07:43:51,299 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.9847 secs
2025-03-09 07:43:51,300 [INFO]: The best hyperparameters are: efSearch=114
2025-03-09 07:43:51,300 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.26it/s]
2025-03-09 07:44:08,271 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9708 secs
2025-03-09 07:44:08,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.5376 secs
2025-03-09 07:44:08,274 [INFO]: {
2025-03-09 07:44:08,274 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:08,274 [INFO]: 	index_param: efSearch=114
2025-03-09 07:44:08,274 [INFO]: 	index_path: knn.index
2025-03-09 07:44:08,274 [INFO]: 	size in bytes: 1950717790
2025-03-09 07:44:08,274 [INFO]: 	avg_search_speed_ms: 8.738251280860155
2025-03-09 07:44:08,274 [INFO]: 	99p_search_speed_ms: 17.52722722245377
2025-03-09 07:44:08,274 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:08,274 [INFO]: 	nb vectors: 9915
2025-03-09 07:44:08,274 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:08,274 [INFO]: 	compression ratio: 0.99930821874547
2025-03-09 07:44:08,274 [INFO]: }
2025-03-09 07:44:08,274 [INFO]: 	>>> Finished "Creating the index" in 90.5414 secs
2025-03-09 07:44:08,274 [INFO]: >>> Finished "Launching the whole pipeline" in 90.5733 secs
2025-03-09 07:44:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 26504 [episode count 5/20]
[retrieval_preprocessing] for episode 52360 [episode count 6/20], we have num_retrieval=np.int64(9728) num_query=np.int64(773)
2025-03-09 07:44:13,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:14,516 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:14
2025-03-09 07:44:14,516 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.76it/s]
2025-03-09 07:44:14,546 [INFO]: There are 9728 embeddings of dim 49152
2025-03-09 07:44:14,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 07:44:14,547 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:14
2025-03-09 07:44:14,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:14,547 [INFO]: 		-> Add: 5.3 seconds
2025-03-09 07:44:14,547 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:44:14,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:44:14,547 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:14
2025-03-09 07:44:14,548 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:14,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:44:14,548 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:14
2025-03-09 07:44:14,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:14,548 [INFO]: 	Creating the index 03/09/2025, 07:44:14
2025-03-09 07:44:14,549 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:14
2025-03-09 07:44:14,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:44:14,552 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:14
2025-03-09 07:44:14,552 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:44:14,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.90it/s] 12%|█▎        | 5/40 [00:00<00:01, 24.06it/s] 25%|██▌       | 10/40 [00:00<00:00, 34.06it/s] 38%|███▊      | 15/40 [00:00<00:00, 39.25it/s] 50%|█████     | 20/40 [00:00<00:00, 42.00it/s] 62%|██████▎   | 25/40 [00:04<00:04,  3.37it/s] 78%|███████▊  | 31/40 [00:04<00:01,  5.25it/s] 92%|█████████▎| 37/40 [00:04<00:00,  7.70it/s]100%|██████████| 40/40 [00:09<00:00,  4.43it/s]
2025-03-09 07:44:23,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:23
2025-03-09 07:45:29,527 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9394 secs
2025-03-09 07:45:29,527 [INFO]: The best hyperparameters are: efSearch=141
2025-03-09 07:45:29,527 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-09 07:45:47,548 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0208 secs
2025-03-09 07:45:47,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.9985 secs
2025-03-09 07:45:47,551 [INFO]: {
2025-03-09 07:45:47,551 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:47,551 [INFO]: 	index_param: efSearch=141
2025-03-09 07:45:47,551 [INFO]: 	index_path: knn.index
2025-03-09 07:45:47,551 [INFO]: 	size in bytes: 1913926030
2025-03-09 07:45:47,551 [INFO]: 	avg_search_speed_ms: 8.612302890605743
2025-03-09 07:45:47,551 [INFO]: 	99p_search_speed_ms: 22.58414588868619
2025-03-09 07:45:47,551 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:47,551 [INFO]: 	nb vectors: 9728
2025-03-09 07:45:47,551 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:47,551 [INFO]: 	compression ratio: 0.999308538585475
2025-03-09 07:45:47,551 [INFO]: }
2025-03-09 07:45:47,551 [INFO]: 	>>> Finished "Creating the index" in 93.0024 secs
2025-03-09 07:45:47,551 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0346 secs
2025-03-09 07:45:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 52360 [episode count 6/20]
[retrieval_preprocessing] for episode 57096 [episode count 7/20], we have num_retrieval=np.int64(9820) num_query=np.int64(681)
2025-03-09 07:45:53,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:54,760 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:54
2025-03-09 07:45:54,760 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1766.02it/s]
2025-03-09 07:45:54,791 [INFO]: There are 9820 embeddings of dim 49152
2025-03-09 07:45:54,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:45:54,791 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:54
2025-03-09 07:45:54,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:54,791 [INFO]: 		-> Add: 5.4 seconds
2025-03-09 07:45:54,791 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:45:54,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:54,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:54
2025-03-09 07:45:54,791 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:54,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:45:54,792 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:54
2025-03-09 07:45:54,792 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:54,792 [INFO]: 	Creating the index 03/09/2025, 07:45:54
2025-03-09 07:45:54,792 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:54
2025-03-09 07:45:54,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:45:54,793 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:54
2025-03-09 07:45:54,793 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:45:54,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:06,  6.00it/s] 12%|█▎        | 5/40 [00:00<00:01, 21.02it/s] 25%|██▌       | 10/40 [00:00<00:00, 31.82it/s] 40%|████      | 16/40 [00:00<00:00, 39.22it/s] 52%|█████▎    | 21/40 [00:04<00:05,  3.24it/s] 68%|██████▊   | 27/40 [00:04<00:02,  5.12it/s] 82%|████████▎ | 33/40 [00:04<00:00,  7.61it/s] 98%|█████████▊| 39/40 [00:04<00:00, 10.77it/s]100%|██████████| 40/40 [00:08<00:00,  4.47it/s]
2025-03-09 07:46:03,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:03
2025-03-09 07:47:15,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.6632 secs
2025-03-09 07:47:15,408 [INFO]: The best hyperparameters are: efSearch=146
2025-03-09 07:47:15,408 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-09 07:47:37,554 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1460 secs
2025-03-09 07:47:37,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.7639 secs
2025-03-09 07:47:37,557 [INFO]: {
2025-03-09 07:47:37,557 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:37,557 [INFO]: 	index_param: efSearch=146
2025-03-09 07:47:37,557 [INFO]: 	index_path: knn.index
2025-03-09 07:47:37,557 [INFO]: 	size in bytes: 1932026950
2025-03-09 07:47:37,557 [INFO]: 	avg_search_speed_ms: 8.649227846450911
2025-03-09 07:47:37,557 [INFO]: 	99p_search_speed_ms: 20.839631196577116
2025-03-09 07:47:37,557 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:37,557 [INFO]: 	nb vectors: 9820
2025-03-09 07:47:37,557 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:37,557 [INFO]: 	compression ratio: 0.9993082963982464
2025-03-09 07:47:37,557 [INFO]: }
2025-03-09 07:47:37,557 [INFO]: 	>>> Finished "Creating the index" in 102.7655 secs
2025-03-09 07:47:37,557 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7971 secs
2025-03-09 07:47:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 57096 [episode count 7/20]
[retrieval_preprocessing] for episode 79758 [episode count 8/20], we have num_retrieval=np.int64(10268) num_query=np.int64(233)
2025-03-09 07:47:42,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:44,277 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:44
2025-03-09 07:47:44,277 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-09 07:47:44,304 [INFO]: There are 10268 embeddings of dim 49152
2025-03-09 07:47:44,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:47:44,305 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:44
2025-03-09 07:47:44,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:44,305 [INFO]: 		-> Add: 5.6 seconds
2025-03-09 07:47:44,305 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:47:44,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:47:44,305 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:44
2025-03-09 07:47:44,305 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:44,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:47:44,305 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:44
2025-03-09 07:47:44,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:44,305 [INFO]: 	Creating the index 03/09/2025, 07:47:44
2025-03-09 07:47:44,305 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:47:44
2025-03-09 07:47:44,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 07:47:44,306 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:44
2025-03-09 07:47:44,307 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-09 07:47:44,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.78it/s] 12%|█▏        | 5/43 [00:00<00:01, 23.18it/s] 26%|██▌       | 11/43 [00:00<00:00, 36.30it/s] 40%|███▉      | 17/43 [00:00<00:00, 42.58it/s] 51%|█████     | 22/43 [00:06<00:09,  2.27it/s] 65%|██████▌   | 28/43 [00:06<00:04,  3.59it/s] 74%|███████▍  | 32/43 [00:06<00:02,  4.73it/s] 88%|████████▊ | 38/43 [00:06<00:00,  7.08it/s]100%|██████████| 43/43 [00:15<00:00,  1.53it/s]100%|██████████| 43/43 [00:15<00:00,  2.71it/s]
2025-03-09 07:48:00,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:00
2025-03-09 07:49:15,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.1510 secs
2025-03-09 07:49:15,319 [INFO]: The best hyperparameters are: efSearch=73
2025-03-09 07:49:15,319 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-09 07:49:38,721 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4017 secs
2025-03-09 07:49:38,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.4146 secs
2025-03-09 07:49:38,721 [INFO]: {
2025-03-09 07:49:38,721 [INFO]: 	index_key: HNSW32
2025-03-09 07:49:38,721 [INFO]: 	index_param: efSearch=73
2025-03-09 07:49:38,721 [INFO]: 	index_path: knn.index
2025-03-09 07:49:38,721 [INFO]: 	size in bytes: 2021561650
2025-03-09 07:49:38,721 [INFO]: 	avg_search_speed_ms: 7.8218941789038885
2025-03-09 07:49:38,721 [INFO]: 	99p_search_speed_ms: 20.298146386630833
2025-03-09 07:49:38,721 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:38,721 [INFO]: 	nb vectors: 10268
2025-03-09 07:49:38,721 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:38,721 [INFO]: 	compression ratio: 0.9986195296096956
2025-03-09 07:49:38,721 [INFO]: }
2025-03-09 07:49:38,721 [INFO]: 	>>> Finished "Creating the index" in 114.4162 secs
2025-03-09 07:49:38,721 [INFO]: >>> Finished "Launching the whole pipeline" in 114.4444 secs
2025-03-09 07:49:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 79758 [episode count 8/20]
[retrieval_preprocessing] for episode 76688 [episode count 9/20], we have num_retrieval=np.int64(10013) num_query=np.int64(488)
2025-03-09 07:49:41,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:42,972 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:42
2025-03-09 07:49:42,972 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.49it/s]
2025-03-09 07:49:43,000 [INFO]: There are 10013 embeddings of dim 49152
2025-03-09 07:49:43,001 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:49:43,001 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:43
2025-03-09 07:49:43,001 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:43,001 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:49:43,001 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:49:43,001 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:43,001 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:43
2025-03-09 07:49:43,001 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:43,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:43,001 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:43
2025-03-09 07:49:43,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:43,001 [INFO]: 	Creating the index 03/09/2025, 07:49:43
2025-03-09 07:49:43,001 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:49:43
2025-03-09 07:49:43,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 07:49:43,003 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:43
2025-03-09 07:49:43,003 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:49:43,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  6.98it/s] 15%|█▍        | 6/41 [00:00<00:01, 27.16it/s] 24%|██▍       | 10/41 [00:00<00:00, 31.38it/s] 37%|███▋      | 15/41 [00:00<00:00, 37.17it/s] 49%|████▉     | 20/41 [00:00<00:00, 40.76it/s] 61%|██████    | 25/41 [00:07<00:07,  2.05it/s] 76%|███████▌  | 31/41 [00:07<00:03,  3.26it/s] 90%|█████████ | 37/41 [00:07<00:00,  4.89it/s]100%|██████████| 41/41 [00:14<00:00,  2.85it/s]
2025-03-09 07:49:57,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:57
2025-03-09 07:51:09,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.0800 secs
2025-03-09 07:51:09,476 [INFO]: The best hyperparameters are: efSearch=94
2025-03-09 07:51:09,477 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.42it/s]
2025-03-09 07:51:39,557 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0803 secs
2025-03-09 07:51:39,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.5568 secs
2025-03-09 07:51:39,560 [INFO]: {
2025-03-09 07:51:39,560 [INFO]: 	index_key: HNSW32
2025-03-09 07:51:39,560 [INFO]: 	index_param: efSearch=94
2025-03-09 07:51:39,560 [INFO]: 	index_path: knn.index
2025-03-09 07:51:39,560 [INFO]: 	size in bytes: 1971357246
2025-03-09 07:51:39,560 [INFO]: 	avg_search_speed_ms: 8.793783994057659
2025-03-09 07:51:39,560 [INFO]: 	99p_search_speed_ms: 15.501785951200853
2025-03-09 07:51:39,560 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:39,560 [INFO]: 	nb vectors: 10013
2025-03-09 07:51:39,560 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:39,560 [INFO]: 	compression ratio: 0.9986195591866863
2025-03-09 07:51:39,560 [INFO]: }
2025-03-09 07:51:39,560 [INFO]: 	>>> Finished "Creating the index" in 116.5585 secs
2025-03-09 07:51:39,560 [INFO]: >>> Finished "Launching the whole pipeline" in 116.5879 secs
2025-03-09 07:51:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 76688 [episode count 9/20]
[retrieval_preprocessing] for episode 65425 [episode count 10/20], we have num_retrieval=np.int64(9972) num_query=np.int64(529)
2025-03-09 07:51:43,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:44,952 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:44
2025-03-09 07:51:44,952 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.88it/s]
2025-03-09 07:51:44,990 [INFO]: There are 9972 embeddings of dim 49152
2025-03-09 07:51:44,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-09 07:51:44,990 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:44
2025-03-09 07:51:44,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:44,990 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:51:44,990 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:51:44,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:44,990 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:44
2025-03-09 07:51:44,990 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:44,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:51:44,990 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:44
2025-03-09 07:51:44,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:44,990 [INFO]: 	Creating the index 03/09/2025, 07:51:44
2025-03-09 07:51:44,991 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:44
2025-03-09 07:51:44,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:51:44,992 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:44
2025-03-09 07:51:44,992 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:51:44,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.65it/s] 12%|█▏        | 5/41 [00:00<00:01, 20.95it/s] 24%|██▍       | 10/41 [00:00<00:01, 29.98it/s] 34%|███▍      | 14/41 [00:00<00:00, 30.41it/s] 46%|████▋     | 19/41 [00:00<00:00, 34.21it/s] 56%|█████▌    | 23/41 [00:04<00:06,  2.94it/s] 71%|███████   | 29/41 [00:04<00:02,  4.81it/s] 85%|████████▌ | 35/41 [00:04<00:00,  7.27it/s]100%|██████████| 41/41 [00:09<00:00,  2.78it/s]100%|██████████| 41/41 [00:09<00:00,  4.32it/s]
2025-03-09 07:51:54,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:54
2025-03-09 07:53:03,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.9835 secs
2025-03-09 07:53:03,475 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 07:53:03,475 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-09 07:53:20,850 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3750 secs
2025-03-09 07:53:20,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8609 secs
2025-03-09 07:53:20,853 [INFO]: {
2025-03-09 07:53:20,853 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:20,853 [INFO]: 	index_param: efSearch=162
2025-03-09 07:53:20,853 [INFO]: 	index_path: knn.index
2025-03-09 07:53:20,853 [INFO]: 	size in bytes: 1961932150
2025-03-09 07:53:20,853 [INFO]: 	avg_search_speed_ms: 8.919433788641504
2025-03-09 07:53:20,853 [INFO]: 	99p_search_speed_ms: 17.865316336974487
2025-03-09 07:53:20,853 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:20,853 [INFO]: 	nb vectors: 9972
2025-03-09 07:53:20,853 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:20,853 [INFO]: 	compression ratio: 0.9993082462102474
2025-03-09 07:53:20,853 [INFO]: }
2025-03-09 07:53:20,853 [INFO]: 	>>> Finished "Creating the index" in 95.8627 secs
2025-03-09 07:53:20,853 [INFO]: >>> Finished "Launching the whole pipeline" in 95.9009 secs
2025-03-09 07:53:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65425 [episode count 10/20]
[retrieval_preprocessing] for episode 59540 [episode count 11/20], we have num_retrieval=np.int64(10083) num_query=np.int64(418)
2025-03-09 07:53:25,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:26,577 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:26
2025-03-09 07:53:26,577 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 07:53:26,603 [INFO]: There are 10083 embeddings of dim 49152
2025-03-09 07:53:26,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:53:26,604 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:26
2025-03-09 07:53:26,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:26,604 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:53:26,604 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:53:26,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:53:26,604 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:26
2025-03-09 07:53:26,604 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:26,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:53:26,604 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:26
2025-03-09 07:53:26,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:26,604 [INFO]: 	Creating the index 03/09/2025, 07:53:26
2025-03-09 07:53:26,604 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:53:26
2025-03-09 07:53:26,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 07:53:26,605 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:26
2025-03-09 07:53:26,606 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:53:26,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.56it/s] 17%|█▋        | 7/41 [00:00<00:01, 27.60it/s] 32%|███▏      | 13/41 [00:00<00:00, 37.91it/s] 46%|████▋     | 19/41 [00:00<00:00, 43.55it/s] 59%|█████▊    | 24/41 [00:05<00:06,  2.54it/s] 73%|███████▎  | 30/41 [00:06<00:02,  3.94it/s] 88%|████████▊ | 36/41 [00:06<00:00,  5.81it/s]100%|██████████| 41/41 [00:13<00:00,  1.89it/s]100%|██████████| 41/41 [00:13<00:00,  3.12it/s]
2025-03-09 07:53:39,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:39
2025-03-09 07:54:53,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.8619 secs
2025-03-09 07:54:53,626 [INFO]: The best hyperparameters are: efSearch=96
2025-03-09 07:54:53,626 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-09 07:55:19,915 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2896 secs
2025-03-09 07:55:19,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.3127 secs
2025-03-09 07:55:19,918 [INFO]: {
2025-03-09 07:55:19,918 [INFO]: 	index_key: HNSW32
2025-03-09 07:55:19,918 [INFO]: 	index_param: efSearch=96
2025-03-09 07:55:19,918 [INFO]: 	index_path: knn.index
2025-03-09 07:55:19,918 [INFO]: 	size in bytes: 1985139078
2025-03-09 07:55:19,918 [INFO]: 	avg_search_speed_ms: 9.303592748853356
2025-03-09 07:55:19,918 [INFO]: 	99p_search_speed_ms: 22.001561135984957
2025-03-09 07:55:19,919 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:19,919 [INFO]: 	nb vectors: 10083
2025-03-09 07:55:19,919 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:19,919 [INFO]: 	compression ratio: 0.9986194347638548
2025-03-09 07:55:19,919 [INFO]: }
2025-03-09 07:55:19,919 [INFO]: 	>>> Finished "Creating the index" in 113.3142 secs
2025-03-09 07:55:19,919 [INFO]: >>> Finished "Launching the whole pipeline" in 113.3412 secs
2025-03-09 07:55:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 59540 [episode count 11/20]
[retrieval_preprocessing] for episode 57749 [episode count 12/20], we have num_retrieval=np.int64(9970) num_query=np.int64(531)
2025-03-09 07:55:23,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:25,012 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:25
2025-03-09 07:55:25,013 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.54it/s]
2025-03-09 07:55:25,046 [INFO]: There are 9970 embeddings of dim 49152
2025-03-09 07:55:25,046 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 07:55:25,046 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:25
2025-03-09 07:55:25,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:25,047 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:55:25,047 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:55:25,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:55:25,047 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:25
2025-03-09 07:55:25,047 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:25,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:55:25,047 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:25
2025-03-09 07:55:25,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:25,047 [INFO]: 	Creating the index 03/09/2025, 07:55:25
2025-03-09 07:55:25,048 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:25
2025-03-09 07:55:25,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:55:25,050 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:25
2025-03-09 07:55:25,051 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:55:25,051 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  6.79it/s] 17%|█▋        | 7/41 [00:00<00:01, 30.45it/s] 32%|███▏      | 13/41 [00:00<00:00, 40.34it/s] 46%|████▋     | 19/41 [00:00<00:00, 45.44it/s] 59%|█████▊    | 24/41 [00:04<00:04,  3.67it/s] 73%|███████▎  | 30/41 [00:04<00:01,  5.63it/s] 88%|████████▊ | 36/41 [00:04<00:00,  8.18it/s]100%|██████████| 41/41 [00:09<00:00,  2.55it/s]100%|██████████| 41/41 [00:09<00:00,  4.25it/s]
2025-03-09 07:55:34,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:34
2025-03-09 07:56:42,085 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.3726 secs
2025-03-09 07:56:42,086 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:56:42,086 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-09 07:57:07,937 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8508 secs
2025-03-09 07:57:07,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.8891 secs
2025-03-09 07:57:07,940 [INFO]: {
2025-03-09 07:57:07,940 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:07,940 [INFO]: 	index_param: efSearch=189
2025-03-09 07:57:07,940 [INFO]: 	index_path: knn.index
2025-03-09 07:57:07,940 [INFO]: 	size in bytes: 1961538670
2025-03-09 07:57:07,940 [INFO]: 	avg_search_speed_ms: 10.71708076129421
2025-03-09 07:57:07,940 [INFO]: 	99p_search_speed_ms: 21.045907977968437
2025-03-09 07:57:07,940 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:07,940 [INFO]: 	nb vectors: 9970
2025-03-09 07:57:07,940 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:07,940 [INFO]: 	compression ratio: 0.9993082420343006
2025-03-09 07:57:07,940 [INFO]: }
2025-03-09 07:57:07,940 [INFO]: 	>>> Finished "Creating the index" in 102.8926 secs
2025-03-09 07:57:07,940 [INFO]: >>> Finished "Launching the whole pipeline" in 102.9275 secs
2025-03-09 07:57:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 57749 [episode count 12/20]
[retrieval_preprocessing] for episode 33047 [episode count 13/20], we have num_retrieval=np.int64(10046) num_query=np.int64(455)
2025-03-09 07:57:13,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:14,817 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:14
2025-03-09 07:57:14,817 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.01it/s]
2025-03-09 07:57:14,845 [INFO]: There are 10046 embeddings of dim 49152
2025-03-09 07:57:14,845 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:57:14,845 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:14
2025-03-09 07:57:14,845 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:14,846 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:57:14,846 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:57:14,846 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:14,846 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:14
2025-03-09 07:57:14,846 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:14,846 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:57:14,846 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:14
2025-03-09 07:57:14,846 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:14,846 [INFO]: 	Creating the index 03/09/2025, 07:57:14
2025-03-09 07:57:14,846 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:57:14
2025-03-09 07:57:14,847 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 07:57:14,848 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:14
2025-03-09 07:57:14,848 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:57:14,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.26it/s] 10%|▉         | 4/41 [00:00<00:02, 18.38it/s] 20%|█▉        | 8/41 [00:00<00:01, 26.31it/s] 32%|███▏      | 13/41 [00:00<00:00, 34.18it/s] 44%|████▍     | 18/41 [00:00<00:00, 39.26it/s] 56%|█████▌    | 23/41 [00:06<00:08,  2.13it/s] 63%|██████▎   | 26/41 [00:06<00:05,  2.68it/s] 71%|███████   | 29/41 [00:06<00:03,  3.39it/s] 76%|███████▌  | 31/41 [00:07<00:02,  3.97it/s] 80%|████████  | 33/41 [00:07<00:01,  4.79it/s] 85%|████████▌ | 35/41 [00:07<00:01,  5.59it/s] 90%|█████████ | 37/41 [00:07<00:00,  6.51it/s] 95%|█████████▌| 39/41 [00:07<00:00,  7.43it/s]100%|██████████| 41/41 [00:17<00:00,  1.42s/it]100%|██████████| 41/41 [00:17<00:00,  2.37it/s]
2025-03-09 07:57:32,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:32
2025-03-09 07:58:57,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4068 secs
2025-03-09 07:58:57,592 [INFO]: The best hyperparameters are: efSearch=92
2025-03-09 07:58:57,592 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 07:59:23,606 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0133 secs
2025-03-09 07:59:23,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.7621 secs
2025-03-09 07:59:23,610 [INFO]: {
2025-03-09 07:59:23,610 [INFO]: 	index_key: HNSW32
2025-03-09 07:59:23,610 [INFO]: 	index_param: efSearch=92
2025-03-09 07:59:23,610 [INFO]: 	index_path: knn.index
2025-03-09 07:59:23,610 [INFO]: 	size in bytes: 1977854282
2025-03-09 07:59:23,610 [INFO]: 	avg_search_speed_ms: 10.648745107905853
2025-03-09 07:59:23,610 [INFO]: 	99p_search_speed_ms: 23.744992716237903
2025-03-09 07:59:23,610 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:23,610 [INFO]: 	nb vectors: 10046
2025-03-09 07:59:23,610 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:23,610 [INFO]: 	compression ratio: 0.998619557555454
2025-03-09 07:59:23,610 [INFO]: }
2025-03-09 07:59:23,610 [INFO]: 	>>> Finished "Creating the index" in 128.7641 secs
2025-03-09 07:59:23,610 [INFO]: >>> Finished "Launching the whole pipeline" in 128.7931 secs
2025-03-09 07:59:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 33047 [episode count 13/20]
[retrieval_preprocessing] for episode 37655 [episode count 14/20], we have num_retrieval=np.int64(9943) num_query=np.int64(558)
2025-03-09 07:59:30,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:31,394 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:31
2025-03-09 07:59:31,394 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.62it/s]
2025-03-09 07:59:31,421 [INFO]: There are 9943 embeddings of dim 49152
2025-03-09 07:59:31,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 07:59:31,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:31
2025-03-09 07:59:31,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:31,422 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 07:59:31,422 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:59:31,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:31,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:31
2025-03-09 07:59:31,422 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:31,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:59:31,422 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:31
2025-03-09 07:59:31,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:31,422 [INFO]: 	Creating the index 03/09/2025, 07:59:31
2025-03-09 07:59:31,422 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:31
2025-03-09 07:59:31,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:59:31,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:31
2025-03-09 07:59:31,424 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 07:59:31,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.25it/s]  5%|▍         | 2/41 [00:00<00:09,  3.98it/s] 10%|▉         | 4/41 [00:00<00:04,  7.59it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.95it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.90it/s] 27%|██▋       | 11/41 [00:01<00:03,  8.81it/s] 29%|██▉       | 12/41 [00:01<00:03,  7.98it/s] 34%|███▍      | 14/41 [00:01<00:03,  8.74it/s] 39%|███▉      | 16/41 [00:01<00:02,  9.75it/s] 44%|████▍     | 18/41 [00:02<00:02,  9.69it/s] 49%|████▉     | 20/41 [00:02<00:02,  9.51it/s] 51%|█████     | 21/41 [00:06<00:16,  1.21it/s] 54%|█████▎    | 22/41 [00:06<00:12,  1.48it/s] 61%|██████    | 25/41 [00:06<00:06,  2.66it/s] 68%|██████▊   | 28/41 [00:06<00:03,  4.17it/s] 78%|███████▊  | 32/41 [00:06<00:01,  6.67it/s] 90%|█████████ | 37/41 [00:06<00:00, 10.60it/s]100%|██████████| 41/41 [00:12<00:00,  1.83it/s]100%|██████████| 41/41 [00:12<00:00,  3.24it/s]
2025-03-09 07:59:44,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:44
2025-03-09 08:01:12,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.9692 secs
2025-03-09 08:01:12,059 [INFO]: The best hyperparameters are: efSearch=144
2025-03-09 08:01:12,059 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.14it/s]
2025-03-09 08:01:43,077 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0175 secs
2025-03-09 08:01:43,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.6581 secs
2025-03-09 08:01:43,082 [INFO]: {
2025-03-09 08:01:43,082 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:43,082 [INFO]: 	index_param: efSearch=144
2025-03-09 08:01:43,082 [INFO]: 	index_path: knn.index
2025-03-09 08:01:43,082 [INFO]: 	size in bytes: 1956226630
2025-03-09 08:01:43,082 [INFO]: 	avg_search_speed_ms: 10.855249071091285
2025-03-09 08:01:43,082 [INFO]: 	99p_search_speed_ms: 23.883042111992822
2025-03-09 08:01:43,082 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:43,082 [INFO]: 	nb vectors: 9943
2025-03-09 08:01:43,082 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:43,082 [INFO]: 	compression ratio: 0.9993082161446704
2025-03-09 08:01:43,082 [INFO]: }
2025-03-09 08:01:43,082 [INFO]: 	>>> Finished "Creating the index" in 131.6600 secs
2025-03-09 08:01:43,082 [INFO]: >>> Finished "Launching the whole pipeline" in 131.6882 secs
2025-03-09 08:01:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 37655 [episode count 14/20]
[retrieval_preprocessing] for episode 44697 [episode count 15/20], we have num_retrieval=np.int64(10116) num_query=np.int64(385)
2025-03-09 08:01:51,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:53,502 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:53
2025-03-09 08:01:53,502 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.92it/s]
2025-03-09 08:01:53,530 [INFO]: There are 10116 embeddings of dim 49152
2025-03-09 08:01:53,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:01:53,531 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:53
2025-03-09 08:01:53,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:53,531 [INFO]: 		-> Add: 5.6 seconds
2025-03-09 08:01:53,531 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:01:53,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:53,531 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:53
2025-03-09 08:01:53,531 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:53,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:01:53,531 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:53
2025-03-09 08:01:53,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:53,531 [INFO]: 	Creating the index 03/09/2025, 08:01:53
2025-03-09 08:01:53,531 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:01:53
2025-03-09 08:01:53,533 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 08:01:53,533 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:53
2025-03-09 08:01:53,533 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-09 08:01:53,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.36it/s]  5%|▍         | 2/41 [00:00<00:06,  5.79it/s]  7%|▋         | 3/41 [00:00<00:06,  5.86it/s] 12%|█▏        | 5/41 [00:00<00:04,  8.89it/s] 20%|█▉        | 8/41 [00:00<00:02, 13.52it/s] 24%|██▍       | 10/41 [00:00<00:02, 15.05it/s] 29%|██▉       | 12/41 [00:00<00:01, 15.73it/s] 34%|███▍      | 14/41 [00:01<00:01, 15.94it/s] 39%|███▉      | 16/41 [00:01<00:01, 15.64it/s] 44%|████▍     | 18/41 [00:01<00:01, 15.15it/s] 49%|████▉     | 20/41 [00:01<00:01, 14.08it/s] 54%|█████▎    | 22/41 [00:08<00:19,  1.05s/it] 59%|█████▊    | 24/41 [00:08<00:12,  1.32it/s] 66%|██████▌   | 27/41 [00:08<00:06,  2.08it/s] 71%|███████   | 29/41 [00:08<00:04,  2.66it/s] 76%|███████▌  | 31/41 [00:08<00:02,  3.35it/s] 80%|████████  | 33/41 [00:09<00:01,  4.11it/s] 85%|████████▌ | 35/41 [00:09<00:01,  4.85it/s] 90%|█████████ | 37/41 [00:09<00:00,  5.61it/s] 95%|█████████▌| 39/41 [00:09<00:00,  6.69it/s]100%|██████████| 41/41 [00:18<00:00,  1.38s/it]100%|██████████| 41/41 [00:18<00:00,  2.25it/s]
2025-03-09 08:02:11,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:11
2025-03-09 08:03:37,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.6558 secs
2025-03-09 08:03:37,435 [INFO]: The best hyperparameters are: efSearch=74
2025-03-09 08:03:37,435 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.25it/s]
2025-03-09 08:04:01,126 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6913 secs
2025-03-09 08:04:01,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.5966 secs
2025-03-09 08:04:01,130 [INFO]: {
2025-03-09 08:04:01,130 [INFO]: 	index_key: HNSW32
2025-03-09 08:04:01,130 [INFO]: 	index_param: efSearch=74
2025-03-09 08:04:01,130 [INFO]: 	index_path: knn.index
2025-03-09 08:04:01,130 [INFO]: 	size in bytes: 1991635986
2025-03-09 08:04:01,130 [INFO]: 	avg_search_speed_ms: 7.920137093338292
2025-03-09 08:04:01,130 [INFO]: 	99p_search_speed_ms: 20.04819977562873
2025-03-09 08:04:01,130 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:01,130 [INFO]: 	nb vectors: 10116
2025-03-09 08:04:01,130 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:01,130 [INFO]: 	compression ratio: 0.9986194977298427
2025-03-09 08:04:01,130 [INFO]: }
2025-03-09 08:04:01,130 [INFO]: 	>>> Finished "Creating the index" in 127.5983 secs
2025-03-09 08:04:01,130 [INFO]: >>> Finished "Launching the whole pipeline" in 127.6275 secs
2025-03-09 08:04:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 44697 [episode count 15/20]
[retrieval_preprocessing] for episode 53531 [episode count 16/20], we have num_retrieval=np.int64(10059) num_query=np.int64(442)
2025-03-09 08:04:04,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:05,762 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:05
2025-03-09 08:04:05,762 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-09 08:04:05,791 [INFO]: There are 10059 embeddings of dim 49152
2025-03-09 08:04:05,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:04:05,791 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:05
2025-03-09 08:04:05,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:05,791 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 08:04:05,791 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:04:05,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:05,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:05
2025-03-09 08:04:05,791 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:05,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:04:05,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:05
2025-03-09 08:04:05,792 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:05,792 [INFO]: 	Creating the index 03/09/2025, 08:04:05
2025-03-09 08:04:05,792 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:04:05
2025-03-09 08:04:05,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 08:04:05,793 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:05
2025-03-09 08:04:05,793 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 08:04:05,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  5.79it/s] 12%|█▏        | 5/41 [00:00<00:01, 21.16it/s] 24%|██▍       | 10/41 [00:00<00:00, 32.43it/s] 37%|███▋      | 15/41 [00:00<00:00, 38.65it/s] 51%|█████     | 21/41 [00:06<00:09,  2.08it/s] 59%|█████▊    | 24/41 [00:07<00:06,  2.48it/s] 66%|██████▌   | 27/41 [00:07<00:04,  3.15it/s] 78%|███████▊  | 32/41 [00:07<00:01,  4.86it/s] 90%|█████████ | 37/41 [00:07<00:00,  7.10it/s]100%|██████████| 41/41 [00:15<00:00,  1.48it/s]100%|██████████| 41/41 [00:15<00:00,  2.61it/s]
2025-03-09 08:04:21,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:21
2025-03-09 08:05:39,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.8079 secs
2025-03-09 08:05:39,342 [INFO]: The best hyperparameters are: efSearch=66
2025-03-09 08:05:39,342 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.86it/s]
2025-03-09 08:06:00,282 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9388 secs
2025-03-09 08:06:00,285 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.4925 secs
2025-03-09 08:06:00,286 [INFO]: {
2025-03-09 08:06:00,286 [INFO]: 	index_key: HNSW32
2025-03-09 08:06:00,286 [INFO]: 	index_param: efSearch=66
2025-03-09 08:06:00,286 [INFO]: 	index_path: knn.index
2025-03-09 08:06:00,286 [INFO]: 	size in bytes: 1980413670
2025-03-09 08:06:00,286 [INFO]: 	avg_search_speed_ms: 7.943665316939425
2025-03-09 08:06:00,286 [INFO]: 	99p_search_speed_ms: 19.111572108231492
2025-03-09 08:06:00,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:00,286 [INFO]: 	nb vectors: 10059
2025-03-09 08:06:00,286 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:00,286 [INFO]: 	compression ratio: 0.9986195823421073
2025-03-09 08:06:00,286 [INFO]: }
2025-03-09 08:06:00,286 [INFO]: 	>>> Finished "Creating the index" in 114.4943 secs
2025-03-09 08:06:00,286 [INFO]: >>> Finished "Launching the whole pipeline" in 114.5241 secs
2025-03-09 08:06:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 53531 [episode count 16/20]
[retrieval_preprocessing] for episode 5534 [episode count 17/20], we have num_retrieval=np.int64(10156) num_query=np.int64(345)
2025-03-09 08:06:04,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:05,647 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:05
2025-03-09 08:06:05,647 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1063.73it/s]
2025-03-09 08:06:06,002 [INFO]: There are 10156 embeddings of dim 49152
2025-03-09 08:06:06,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3556 secs
2025-03-09 08:06:06,003 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:06
2025-03-09 08:06:06,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:06,004 [INFO]: 		-> Add: 5.6 seconds
2025-03-09 08:06:06,004 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:06:06,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:06:06,004 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:06
2025-03-09 08:06:06,004 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:06,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:06:06,004 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:06
2025-03-09 08:06:06,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:06:06,005 [INFO]: 	Creating the index 03/09/2025, 08:06:06
2025-03-09 08:06:06,005 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:06:06
2025-03-09 08:06:06,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-09 08:06:06,008 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:06
2025-03-09 08:06:06,008 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-09 08:06:06,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.48it/s] 12%|█▏        | 5/41 [00:00<00:01, 22.49it/s] 24%|██▍       | 10/41 [00:00<00:00, 33.00it/s] 37%|███▋      | 15/41 [00:00<00:00, 38.60it/s] 49%|████▉     | 20/41 [00:00<00:00, 38.37it/s] 59%|█████▊    | 24/41 [00:06<00:08,  2.04it/s] 73%|███████▎  | 30/41 [00:06<00:03,  3.32it/s] 88%|████████▊ | 36/41 [00:06<00:00,  5.04it/s]100%|██████████| 41/41 [00:14<00:00,  1.69it/s]100%|██████████| 41/41 [00:14<00:00,  2.85it/s]
2025-03-09 08:06:20,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:20
2025-03-09 08:07:38,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0405 secs
2025-03-09 08:07:38,429 [INFO]: The best hyperparameters are: efSearch=87
2025-03-09 08:07:38,429 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.09it/s]
2025-03-09 08:08:06,405 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9764 secs
2025-03-09 08:08:06,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.4001 secs
2025-03-09 08:08:06,409 [INFO]: {
2025-03-09 08:08:06,409 [INFO]: 	index_key: HNSW32
2025-03-09 08:08:06,409 [INFO]: 	index_param: efSearch=87
2025-03-09 08:08:06,409 [INFO]: 	index_path: knn.index
2025-03-09 08:08:06,409 [INFO]: 	size in bytes: 1999511154
2025-03-09 08:08:06,409 [INFO]: 	avg_search_speed_ms: 8.489233069082308
2025-03-09 08:08:06,409 [INFO]: 	99p_search_speed_ms: 19.32751114713028
2025-03-09 08:08:06,409 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:06,409 [INFO]: 	nb vectors: 10156
2025-03-09 08:08:06,409 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:06,409 [INFO]: 	compression ratio: 0.9986195095763892
2025-03-09 08:08:06,409 [INFO]: }
2025-03-09 08:08:06,409 [INFO]: 	>>> Finished "Creating the index" in 120.4039 secs
2025-03-09 08:08:06,409 [INFO]: >>> Finished "Launching the whole pipeline" in 120.7616 secs
2025-03-09 08:08:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 5534 [episode count 17/20]
[retrieval_preprocessing] for episode 45215 [episode count 18/20], we have num_retrieval=np.int64(9964) num_query=np.int64(537)
2025-03-09 08:08:09,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:10,978 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:10
2025-03-09 08:08:10,979 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.40it/s]
2025-03-09 08:08:11,009 [INFO]: There are 9964 embeddings of dim 49152
2025-03-09 08:08:11,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:08:11,009 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:11
2025-03-09 08:08:11,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:11,009 [INFO]: 		-> Add: 5.5 seconds
2025-03-09 08:08:11,009 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:08:11,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:11,009 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:11
2025-03-09 08:08:11,010 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:11,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:08:11,010 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:11
2025-03-09 08:08:11,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:11,010 [INFO]: 	Creating the index 03/09/2025, 08:08:11
2025-03-09 08:08:11,010 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:11
2025-03-09 08:08:11,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:08:11,011 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:11
2025-03-09 08:08:11,011 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 08:08:11,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.60it/s] 12%|█▏        | 5/41 [00:00<00:01, 21.77it/s] 24%|██▍       | 10/41 [00:00<00:01, 30.99it/s] 34%|███▍      | 14/41 [00:00<00:00, 31.93it/s] 46%|████▋     | 19/41 [00:00<00:00, 35.77it/s] 56%|█████▌    | 23/41 [00:04<00:06,  2.81it/s] 71%|███████   | 29/41 [00:04<00:02,  4.60it/s] 83%|████████▎ | 34/41 [00:04<00:01,  6.52it/s] 95%|█████████▌| 39/41 [00:05<00:00,  8.96it/s]100%|██████████| 41/41 [00:09<00:00,  4.27it/s]
2025-03-09 08:08:20,616 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:20
2025-03-09 08:09:30,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.4526 secs
2025-03-09 08:09:30,069 [INFO]: The best hyperparameters are: efSearch=151
2025-03-09 08:09:30,069 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-09 08:09:56,619 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5501 secs
2025-03-09 08:09:56,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.6110 secs
2025-03-09 08:09:56,622 [INFO]: {
2025-03-09 08:09:56,622 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:56,622 [INFO]: 	index_param: efSearch=151
2025-03-09 08:09:56,622 [INFO]: 	index_path: knn.index
2025-03-09 08:09:56,622 [INFO]: 	size in bytes: 1960358230
2025-03-09 08:09:56,622 [INFO]: 	avg_search_speed_ms: 8.78343201807395
2025-03-09 08:09:56,622 [INFO]: 	99p_search_speed_ms: 18.676534825935946
2025-03-09 08:09:56,622 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:56,622 [INFO]: 	nb vectors: 9964
2025-03-09 08:09:56,622 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:56,622 [INFO]: 	compression ratio: 0.9993082294964017
2025-03-09 08:09:56,622 [INFO]: }
2025-03-09 08:09:56,622 [INFO]: 	>>> Finished "Creating the index" in 105.6126 secs
2025-03-09 08:09:56,622 [INFO]: >>> Finished "Launching the whole pipeline" in 105.6438 secs
2025-03-09 08:09:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 45215 [episode count 18/20]
[retrieval_preprocessing] for episode 63651 [episode count 19/20], we have num_retrieval=np.int64(9687) num_query=np.int64(814)
2025-03-09 08:10:00,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:02,501 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:02
2025-03-09 08:10:02,502 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1970.08it/s]
2025-03-09 08:10:02,530 [INFO]: There are 9687 embeddings of dim 49152
2025-03-09 08:10:02,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:10:02,530 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:02
2025-03-09 08:10:02,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:02,530 [INFO]: 		-> Add: 5.3 seconds
2025-03-09 08:10:02,530 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:10:02,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:02,531 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:02
2025-03-09 08:10:02,531 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:02,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:10:02,531 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:02
2025-03-09 08:10:02,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:02,531 [INFO]: 	Creating the index 03/09/2025, 08:10:02
2025-03-09 08:10:02,531 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:02
2025-03-09 08:10:02,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:10:02,532 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:02
2025-03-09 08:10:02,532 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-09 08:10:02,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.27it/s] 12%|█▎        | 5/40 [00:00<00:01, 22.58it/s] 25%|██▌       | 10/40 [00:00<00:00, 31.15it/s] 35%|███▌      | 14/40 [00:00<00:00, 31.44it/s] 48%|████▊     | 19/40 [00:00<00:00, 34.84it/s] 57%|█████▊    | 23/40 [00:04<00:06,  2.68it/s] 70%|███████   | 28/40 [00:05<00:02,  4.09it/s] 82%|████████▎ | 33/40 [00:05<00:01,  5.96it/s] 95%|█████████▌| 38/40 [00:05<00:00,  8.35it/s]100%|██████████| 40/40 [00:09<00:00,  4.04it/s]
2025-03-09 08:10:12,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:12
2025-03-09 08:11:23,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.4468 secs
2025-03-09 08:11:23,053 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 08:11:23,053 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 08:11:43,469 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4158 secs
2025-03-09 08:11:43,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.9400 secs
2025-03-09 08:11:43,472 [INFO]: {
2025-03-09 08:11:43,472 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:43,472 [INFO]: 	index_param: efSearch=174
2025-03-09 08:11:43,472 [INFO]: 	index_path: knn.index
2025-03-09 08:11:43,472 [INFO]: 	size in bytes: 1905859630
2025-03-09 08:11:43,472 [INFO]: 	avg_search_speed_ms: 11.281496496858514
2025-03-09 08:11:43,472 [INFO]: 	99p_search_speed_ms: 25.219396650791168
2025-03-09 08:11:43,473 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:43,473 [INFO]: 	nb vectors: 9687
2025-03-09 08:11:43,473 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:43,473 [INFO]: 	compression ratio: 0.9993084831751224
2025-03-09 08:11:43,473 [INFO]: }
2025-03-09 08:11:43,473 [INFO]: 	>>> Finished "Creating the index" in 100.9415 secs
2025-03-09 08:11:43,473 [INFO]: >>> Finished "Launching the whole pipeline" in 100.9710 secs
2025-03-09 08:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 63651 [episode count 19/20]
2025-03-09 08:11:49: [retrieval_preprocessing] finished for (2927338332, 'cloth') [chosen_id count 2/5]
2025-03-09 08:11:50: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (52817038, 'block') [chosen_id count 3/5]
2025-03-09 08:11:50: [retrieval_preprocessing] we have num_total=1592 embedding_dim=49152
[retrieval_preprocessing] for episode 19201 [episode count 0/20], we have num_retrieval=np.int64(1509) num_query=np.int64(83)
2025-03-09 08:11:50,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:51,215 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:51
2025-03-09 08:11:51,215 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.71it/s]
2025-03-09 08:11:51,244 [INFO]: There are 1509 embeddings of dim 49152
2025-03-09 08:11:51,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 08:11:51,244 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:51
2025-03-09 08:11:51,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:51,244 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:11:51,244 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:51,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:51,244 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:51
2025-03-09 08:11:51,244 [INFO]: 311.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:51,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:11:51,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:51
2025-03-09 08:11:51,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:51,245 [INFO]: 	Creating the index 03/09/2025, 08:11:51
2025-03-09 08:11:51,245 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:51
2025-03-09 08:11:51,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:11:51,246 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:51
2025-03-09 08:11:51,246 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:11:51,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.09it/s]100%|██████████| 6/6 [00:01<00:00,  4.46it/s]100%|██████████| 6/6 [00:01<00:00,  4.82it/s]
2025-03-09 08:11:52,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:52
2025-03-09 08:12:11,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.9669 secs
2025-03-09 08:12:11,461 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 08:12:11,461 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.84it/s]
2025-03-09 08:12:23,660 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1987 secs
2025-03-09 08:12:23,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4149 secs
2025-03-09 08:12:23,661 [INFO]: {
2025-03-09 08:12:23,661 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:23,661 [INFO]: 	index_param: efSearch=288
2025-03-09 08:12:23,661 [INFO]: 	index_path: knn.index
2025-03-09 08:12:23,661 [INFO]: 	size in bytes: 296886670
2025-03-09 08:12:23,661 [INFO]: 	avg_search_speed_ms: 9.324170335283624
2025-03-09 08:12:23,661 [INFO]: 	99p_search_speed_ms: 12.622611830011007
2025-03-09 08:12:23,661 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:23,661 [INFO]: 	nb vectors: 1509
2025-03-09 08:12:23,661 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:23,661 [INFO]: 	compression ratio: 0.9993088339062175
2025-03-09 08:12:23,661 [INFO]: }
2025-03-09 08:12:23,661 [INFO]: 	>>> Finished "Creating the index" in 32.4165 secs
2025-03-09 08:12:23,661 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4463 secs
2025-03-09 08:12:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 19201 [episode count 0/20]
[retrieval_preprocessing] for episode 71298 [episode count 1/20], we have num_retrieval=np.int64(1525) num_query=np.int64(67)
2025-03-09 08:12:26,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:26,278 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:26
2025-03-09 08:12:26,278 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1856.71it/s]
2025-03-09 08:12:26,300 [INFO]: There are 1525 embeddings of dim 49152
2025-03-09 08:12:26,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 08:12:26,301 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:26
2025-03-09 08:12:26,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:26,301 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:12:26,301 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:26,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:26,301 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:26
2025-03-09 08:12:26,301 [INFO]: 314.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:26,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:12:26,301 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:26
2025-03-09 08:12:26,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:26,301 [INFO]: 	Creating the index 03/09/2025, 08:12:26
2025-03-09 08:12:26,301 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:26
2025-03-09 08:12:26,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:12:26,302 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:26
2025-03-09 08:12:26,302 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:12:26,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.61it/s]100%|██████████| 7/7 [00:01<00:00,  5.32it/s]100%|██████████| 7/7 [00:01<00:00,  5.65it/s]
2025-03-09 08:12:27,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:27
2025-03-09 08:12:46,234 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.6886 secs
2025-03-09 08:12:46,234 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 08:12:46,234 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.83it/s]
2025-03-09 08:13:03,493 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2590 secs
2025-03-09 08:13:03,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1918 secs
2025-03-09 08:13:03,494 [INFO]: {
2025-03-09 08:13:03,494 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:03,494 [INFO]: 	index_param: efSearch=284
2025-03-09 08:13:03,494 [INFO]: 	index_path: knn.index
2025-03-09 08:13:03,494 [INFO]: 	size in bytes: 300034570
2025-03-09 08:13:03,494 [INFO]: 	avg_search_speed_ms: 9.656782184941443
2025-03-09 08:13:03,494 [INFO]: 	99p_search_speed_ms: 14.431412215344634
2025-03-09 08:13:03,494 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:03,494 [INFO]: 	nb vectors: 1525
2025-03-09 08:13:03,494 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:03,494 [INFO]: 	compression ratio: 0.9993088463106101
2025-03-09 08:13:03,494 [INFO]: }
2025-03-09 08:13:03,494 [INFO]: 	>>> Finished "Creating the index" in 37.1932 secs
2025-03-09 08:13:03,494 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2164 secs
2025-03-09 08:13:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 71298 [episode count 1/20]
[retrieval_preprocessing] for episode 27139 [episode count 2/20], we have num_retrieval=np.int64(1509) num_query=np.int64(83)
2025-03-09 08:13:04,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:04,802 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:04
2025-03-09 08:13:04,802 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-09 08:13:04,828 [INFO]: There are 1509 embeddings of dim 49152
2025-03-09 08:13:04,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:13:04,828 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:04
2025-03-09 08:13:04,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:04,828 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:13:04,828 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:04,828 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:04,828 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:04
2025-03-09 08:13:04,829 [INFO]: 311.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:04,829 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:04,829 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:04
2025-03-09 08:13:04,829 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:04,829 [INFO]: 	Creating the index 03/09/2025, 08:13:04
2025-03-09 08:13:04,829 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:04
2025-03-09 08:13:04,830 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:13:04,830 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:04
2025-03-09 08:13:04,830 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:13:04,830 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.81it/s]100%|██████████| 6/6 [00:01<00:00,  4.32it/s]100%|██████████| 6/6 [00:01<00:00,  4.68it/s]
2025-03-09 08:13:06,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:06
2025-03-09 08:13:29,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7373 secs
2025-03-09 08:13:29,008 [INFO]: The best hyperparameters are: efSearch=251
2025-03-09 08:13:29,008 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.39it/s]
2025-03-09 08:13:41,047 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0393 secs
2025-03-09 08:13:41,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.2188 secs
2025-03-09 08:13:41,049 [INFO]: {
2025-03-09 08:13:41,049 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:41,049 [INFO]: 	index_param: efSearch=251
2025-03-09 08:13:41,049 [INFO]: 	index_path: knn.index
2025-03-09 08:13:41,049 [INFO]: 	size in bytes: 296886670
2025-03-09 08:13:41,049 [INFO]: 	avg_search_speed_ms: 9.719627485560766
2025-03-09 08:13:41,049 [INFO]: 	99p_search_speed_ms: 20.075976690277457
2025-03-09 08:13:41,049 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:41,049 [INFO]: 	nb vectors: 1509
2025-03-09 08:13:41,049 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:41,049 [INFO]: 	compression ratio: 0.9993088339062175
2025-03-09 08:13:41,049 [INFO]: }
2025-03-09 08:13:41,049 [INFO]: 	>>> Finished "Creating the index" in 36.2202 secs
2025-03-09 08:13:41,049 [INFO]: >>> Finished "Launching the whole pipeline" in 36.2471 secs
2025-03-09 08:13:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27139 [episode count 2/20]
[retrieval_preprocessing] for episode 75395 [episode count 3/20], we have num_retrieval=np.int64(1500) num_query=np.int64(92)
2025-03-09 08:13:42,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:42,341 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:42
2025-03-09 08:13:42,341 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1822.82it/s]
2025-03-09 08:13:42,364 [INFO]: There are 1500 embeddings of dim 49152
2025-03-09 08:13:42,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 08:13:42,364 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:42
2025-03-09 08:13:42,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:42,364 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:13:42,364 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:42,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:42,364 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:42
2025-03-09 08:13:42,364 [INFO]: 309.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:42,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:42,365 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:42
2025-03-09 08:13:42,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:42,365 [INFO]: 	Creating the index 03/09/2025, 08:13:42
2025-03-09 08:13:42,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:42
2025-03-09 08:13:42,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:13:42,366 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:42
2025-03-09 08:13:42,366 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:13:42,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.49it/s]100%|██████████| 6/6 [00:01<00:00,  4.76it/s]100%|██████████| 6/6 [00:01<00:00,  5.14it/s]
2025-03-09 08:13:43,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:43
2025-03-09 08:14:01,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.3858 secs
2025-03-09 08:14:01,923 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 08:14:01,923 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.15it/s]
2025-03-09 08:14:16,626 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7031 secs
2025-03-09 08:14:16,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.2619 secs
2025-03-09 08:14:16,628 [INFO]: {
2025-03-09 08:14:16,628 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:16,628 [INFO]: 	index_param: efSearch=296
2025-03-09 08:14:16,628 [INFO]: 	index_path: knn.index
2025-03-09 08:14:16,628 [INFO]: 	size in bytes: 295116010
2025-03-09 08:14:16,628 [INFO]: 	avg_search_speed_ms: 10.19928411122081
2025-03-09 08:14:16,628 [INFO]: 	99p_search_speed_ms: 20.99951012060051
2025-03-09 08:14:16,628 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:16,628 [INFO]: 	nb vectors: 1500
2025-03-09 08:14:16,628 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:16,628 [INFO]: 	compression ratio: 0.999308712529693
2025-03-09 08:14:16,628 [INFO]: }
2025-03-09 08:14:16,628 [INFO]: 	>>> Finished "Creating the index" in 34.2633 secs
2025-03-09 08:14:16,628 [INFO]: >>> Finished "Launching the whole pipeline" in 34.2868 secs
2025-03-09 08:14:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 75395 [episode count 3/20]
[retrieval_preprocessing] for episode 10502 [episode count 4/20], we have num_retrieval=np.int64(1514) num_query=np.int64(78)
2025-03-09 08:14:17,574 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:17,768 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:17
2025-03-09 08:14:17,768 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2197.12it/s]
2025-03-09 08:14:17,792 [INFO]: There are 1514 embeddings of dim 49152
2025-03-09 08:14:17,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:14:17,792 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:17
2025-03-09 08:14:17,792 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:17,792 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:14:17,792 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:17,792 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:17,792 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:17
2025-03-09 08:14:17,793 [INFO]: 312.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:17,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:14:17,793 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:17
2025-03-09 08:14:17,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:17,793 [INFO]: 	Creating the index 03/09/2025, 08:14:17
2025-03-09 08:14:17,793 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:17
2025-03-09 08:14:17,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:14:17,794 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:17
2025-03-09 08:14:17,794 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:14:17,794 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.68it/s]100%|██████████| 6/6 [00:01<00:00,  4.00it/s]100%|██████████| 6/6 [00:01<00:00,  4.34it/s]
2025-03-09 08:14:19,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:19
2025-03-09 08:14:41,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5029 secs
2025-03-09 08:14:41,683 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:14:41,683 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.91it/s]
2025-03-09 08:14:55,769 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0858 secs
2025-03-09 08:14:55,770 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.9762 secs
2025-03-09 08:14:55,770 [INFO]: {
2025-03-09 08:14:55,770 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:55,770 [INFO]: 	index_param: efSearch=257
2025-03-09 08:14:55,770 [INFO]: 	index_path: knn.index
2025-03-09 08:14:55,770 [INFO]: 	size in bytes: 297870370
2025-03-09 08:14:55,770 [INFO]: 	avg_search_speed_ms: 10.312826389725291
2025-03-09 08:14:55,770 [INFO]: 	99p_search_speed_ms: 20.273298046085984
2025-03-09 08:14:55,770 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:55,770 [INFO]: 	nb vectors: 1514
2025-03-09 08:14:55,770 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:55,770 [INFO]: 	compression ratio: 0.9993089007140925
2025-03-09 08:14:55,770 [INFO]: }
2025-03-09 08:14:55,770 [INFO]: 	>>> Finished "Creating the index" in 37.9776 secs
2025-03-09 08:14:55,770 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0023 secs
2025-03-09 08:14:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 10502 [episode count 4/20]
[retrieval_preprocessing] for episode 69258 [episode count 5/20], we have num_retrieval=np.int64(1512) num_query=np.int64(80)
2025-03-09 08:14:56,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:56,678 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:56
2025-03-09 08:14:56,678 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1345.19it/s]
2025-03-09 08:14:56,706 [INFO]: There are 1512 embeddings of dim 49152
2025-03-09 08:14:56,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 08:14:56,706 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:56
2025-03-09 08:14:56,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:56,707 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:14:56,707 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:56,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:56,707 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:56
2025-03-09 08:14:56,707 [INFO]: 312.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:56,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:14:56,707 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:56
2025-03-09 08:14:56,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:56,707 [INFO]: 	Creating the index 03/09/2025, 08:14:56
2025-03-09 08:14:56,707 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:56
2025-03-09 08:14:56,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:14:56,708 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:56
2025-03-09 08:14:56,708 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:14:56,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.03it/s] 83%|████████▎ | 5/6 [00:00<00:00, 26.42it/s]100%|██████████| 6/6 [00:01<00:00,  4.21it/s]
2025-03-09 08:14:58,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:58
2025-03-09 08:15:19,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.9136 secs
2025-03-09 08:15:19,051 [INFO]: The best hyperparameters are: efSearch=313
2025-03-09 08:15:19,051 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.61it/s]
2025-03-09 08:15:34,362 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3107 secs
2025-03-09 08:15:34,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6555 secs
2025-03-09 08:15:34,364 [INFO]: {
2025-03-09 08:15:34,364 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:34,364 [INFO]: 	index_param: efSearch=313
2025-03-09 08:15:34,364 [INFO]: 	index_path: knn.index
2025-03-09 08:15:34,364 [INFO]: 	size in bytes: 297476890
2025-03-09 08:15:34,364 [INFO]: 	avg_search_speed_ms: 10.240438827499366
2025-03-09 08:15:34,364 [INFO]: 	99p_search_speed_ms: 14.14821393787861
2025-03-09 08:15:34,364 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:34,364 [INFO]: 	nb vectors: 1512
2025-03-09 08:15:34,364 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:34,364 [INFO]: 	compression ratio: 0.9993088740439635
2025-03-09 08:15:34,364 [INFO]: }
2025-03-09 08:15:34,364 [INFO]: 	>>> Finished "Creating the index" in 37.6572 secs
2025-03-09 08:15:34,364 [INFO]: >>> Finished "Launching the whole pipeline" in 37.6859 secs
2025-03-09 08:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 69258 [episode count 5/20]
[retrieval_preprocessing] for episode 78348 [episode count 6/20], we have num_retrieval=np.int64(1494) num_query=np.int64(98)
2025-03-09 08:15:35,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:36,235 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:36
2025-03-09 08:15:36,235 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.63it/s]
2025-03-09 08:15:36,266 [INFO]: There are 1494 embeddings of dim 49152
2025-03-09 08:15:36,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 08:15:36,266 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:36
2025-03-09 08:15:36,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:36,266 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:15:36,266 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:36,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:36,267 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:36
2025-03-09 08:15:36,267 [INFO]: 308.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:36,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:15:36,267 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:36
2025-03-09 08:15:36,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:36,267 [INFO]: 	Creating the index 03/09/2025, 08:15:36
2025-03-09 08:15:36,267 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:36
2025-03-09 08:15:36,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:15:36,268 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:36
2025-03-09 08:15:36,268 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:15:36,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  5.24it/s] 33%|███▎      | 2/6 [00:00<00:00,  6.77it/s] 50%|█████     | 3/6 [00:00<00:00,  7.47it/s] 67%|██████▋   | 4/6 [00:00<00:00,  7.86it/s]100%|██████████| 6/6 [00:01<00:00,  2.78it/s]100%|██████████| 6/6 [00:01<00:00,  3.58it/s]
2025-03-09 08:15:37,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:37
2025-03-09 08:15:55,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 17.5286 secs
2025-03-09 08:15:55,482 [INFO]: The best hyperparameters are: efSearch=347
2025-03-09 08:15:55,482 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.26it/s]
2025-03-09 08:16:10,234 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7516 secs
2025-03-09 08:16:10,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.9667 secs
2025-03-09 08:16:10,235 [INFO]: {
2025-03-09 08:16:10,235 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:10,235 [INFO]: 	index_param: efSearch=347
2025-03-09 08:16:10,235 [INFO]: 	index_path: knn.index
2025-03-09 08:16:10,235 [INFO]: 	size in bytes: 293935570
2025-03-09 08:16:10,235 [INFO]: 	avg_search_speed_ms: 11.079492644589406
2025-03-09 08:16:10,235 [INFO]: 	99p_search_speed_ms: 18.725613262504343
2025-03-09 08:16:10,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:10,236 [INFO]: 	nb vectors: 1494
2025-03-09 08:16:10,236 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:10,236 [INFO]: 	compression ratio: 0.9993086307996001
2025-03-09 08:16:10,236 [INFO]: }
2025-03-09 08:16:10,236 [INFO]: 	>>> Finished "Creating the index" in 33.9685 secs
2025-03-09 08:16:10,236 [INFO]: >>> Finished "Launching the whole pipeline" in 34.0008 secs
2025-03-09 08:16:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 78348 [episode count 6/20]
[retrieval_preprocessing] for episode 10638 [episode count 7/20], we have num_retrieval=np.int64(1513) num_query=np.int64(79)
2025-03-09 08:16:11,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:12,214 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:12
2025-03-09 08:16:12,214 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.69it/s]
2025-03-09 08:16:12,240 [INFO]: There are 1513 embeddings of dim 49152
2025-03-09 08:16:12,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:16:12,240 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:12
2025-03-09 08:16:12,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:12,240 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:16:12,241 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:12,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:12,241 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:12
2025-03-09 08:16:12,241 [INFO]: 312.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:12,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:16:12,241 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:12
2025-03-09 08:16:12,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:12,241 [INFO]: 	Creating the index 03/09/2025, 08:16:12
2025-03-09 08:16:12,241 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:12
2025-03-09 08:16:12,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:16:12,242 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:12
2025-03-09 08:16:12,242 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:16:12,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.59it/s] 83%|████████▎ | 5/6 [00:00<00:00, 24.62it/s]100%|██████████| 6/6 [00:01<00:00,  4.67it/s]
2025-03-09 08:16:13,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:13
2025-03-09 08:16:37,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4605 secs
2025-03-09 08:16:37,991 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 08:16:37,991 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.71it/s]
2025-03-09 08:16:52,143 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1524 secs
2025-03-09 08:16:52,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.9026 secs
2025-03-09 08:16:52,145 [INFO]: {
2025-03-09 08:16:52,145 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:52,145 [INFO]: 	index_param: efSearch=249
2025-03-09 08:16:52,145 [INFO]: 	index_path: knn.index
2025-03-09 08:16:52,145 [INFO]: 	size in bytes: 297673630
2025-03-09 08:16:52,145 [INFO]: 	avg_search_speed_ms: 9.736834633043498
2025-03-09 08:16:52,145 [INFO]: 	99p_search_speed_ms: 21.657874328084297
2025-03-09 08:16:52,145 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:52,145 [INFO]: 	nb vectors: 1513
2025-03-09 08:16:52,145 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:52,145 [INFO]: 	compression ratio: 0.9993088873878415
2025-03-09 08:16:52,145 [INFO]: }
2025-03-09 08:16:52,145 [INFO]: 	>>> Finished "Creating the index" in 39.9039 secs
2025-03-09 08:16:52,145 [INFO]: >>> Finished "Launching the whole pipeline" in 39.9306 secs
2025-03-09 08:16:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 10638 [episode count 7/20]
[retrieval_preprocessing] for episode 45071 [episode count 8/20], we have num_retrieval=np.int64(1520) num_query=np.int64(72)
2025-03-09 08:16:52,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:52,926 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:52
2025-03-09 08:16:52,926 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1735.33it/s]
2025-03-09 08:16:52,948 [INFO]: There are 1520 embeddings of dim 49152
2025-03-09 08:16:52,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 08:16:52,948 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:52
2025-03-09 08:16:52,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:52,948 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:16:52,948 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:52,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:52,948 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:52
2025-03-09 08:16:52,949 [INFO]: 313.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:52,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:16:52,949 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:52
2025-03-09 08:16:52,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:52,949 [INFO]: 	Creating the index 03/09/2025, 08:16:52
2025-03-09 08:16:52,949 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:52
2025-03-09 08:16:52,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:16:52,950 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:52
2025-03-09 08:16:52,950 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:16:52,950 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.46it/s]100%|██████████| 6/6 [00:01<00:00,  4.84it/s]100%|██████████| 6/6 [00:01<00:00,  5.21it/s]
2025-03-09 08:16:54,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:54
2025-03-09 08:17:14,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4705 secs
2025-03-09 08:17:14,575 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 08:17:14,575 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.77it/s]
2025-03-09 08:17:27,733 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1583 secs
2025-03-09 08:17:27,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.7849 secs
2025-03-09 08:17:27,735 [INFO]: {
2025-03-09 08:17:27,735 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:27,735 [INFO]: 	index_param: efSearch=286
2025-03-09 08:17:27,735 [INFO]: 	index_path: knn.index
2025-03-09 08:17:27,735 [INFO]: 	size in bytes: 299050870
2025-03-09 08:17:27,735 [INFO]: 	avg_search_speed_ms: 10.688474241138683
2025-03-09 08:17:27,735 [INFO]: 	99p_search_speed_ms: 22.802708111703385
2025-03-09 08:17:27,735 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:27,735 [INFO]: 	nb vectors: 1520
2025-03-09 08:17:27,735 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:27,735 [INFO]: 	compression ratio: 0.9993087798072615
2025-03-09 08:17:27,735 [INFO]: }
2025-03-09 08:17:27,735 [INFO]: 	>>> Finished "Creating the index" in 34.7861 secs
2025-03-09 08:17:27,735 [INFO]: >>> Finished "Launching the whole pipeline" in 34.8092 secs
2025-03-09 08:17:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 45071 [episode count 8/20]
[retrieval_preprocessing] for episode 43028 [episode count 9/20], we have num_retrieval=np.int64(1522) num_query=np.int64(70)
2025-03-09 08:17:28,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:28,682 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:28
2025-03-09 08:17:28,683 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1715.46it/s]
2025-03-09 08:17:28,707 [INFO]: There are 1522 embeddings of dim 49152
2025-03-09 08:17:28,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:17:28,707 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:28
2025-03-09 08:17:28,708 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:28,708 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:17:28,708 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:28,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:28,708 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:28
2025-03-09 08:17:28,708 [INFO]: 314.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:28,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:17:28,708 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:28
2025-03-09 08:17:28,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:28,708 [INFO]: 	Creating the index 03/09/2025, 08:17:28
2025-03-09 08:17:28,708 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:28
2025-03-09 08:17:28,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:17:28,709 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:28
2025-03-09 08:17:28,709 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:17:28,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  7.65it/s]100%|██████████| 6/6 [00:01<00:00,  4.81it/s]100%|██████████| 6/6 [00:01<00:00,  4.90it/s]
2025-03-09 08:17:29,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:29
2025-03-09 08:17:54,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7180 secs
2025-03-09 08:17:54,656 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:17:54,656 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-09 08:18:06,863 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2069 secs
2025-03-09 08:18:06,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.1557 secs
2025-03-09 08:18:06,865 [INFO]: {
2025-03-09 08:18:06,865 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:06,865 [INFO]: 	index_param: efSearch=223
2025-03-09 08:18:06,865 [INFO]: 	index_path: knn.index
2025-03-09 08:18:06,865 [INFO]: 	size in bytes: 299444350
2025-03-09 08:18:06,865 [INFO]: 	avg_search_speed_ms: 9.493995720126152
2025-03-09 08:18:06,865 [INFO]: 	99p_search_speed_ms: 21.643771352246407
2025-03-09 08:18:06,865 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:06,865 [INFO]: 	nb vectors: 1522
2025-03-09 08:18:06,865 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:06,865 [INFO]: 	compression ratio: 0.9993088064610336
2025-03-09 08:18:06,865 [INFO]: }
2025-03-09 08:18:06,865 [INFO]: 	>>> Finished "Creating the index" in 38.1571 secs
2025-03-09 08:18:06,865 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1825 secs
2025-03-09 08:18:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 43028 [episode count 9/20]
[retrieval_preprocessing] for episode 29845 [episode count 10/20], we have num_retrieval=np.int64(1485) num_query=np.int64(107)
2025-03-09 08:18:07,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:07,738 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:07
2025-03-09 08:18:07,738 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.07it/s]
2025-03-09 08:18:07,760 [INFO]: There are 1485 embeddings of dim 49152
2025-03-09 08:18:07,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 08:18:07,761 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:07
2025-03-09 08:18:07,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:07,761 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:18:07,761 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:07,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:07,761 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:07
2025-03-09 08:18:07,761 [INFO]: 306.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:07,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:18:07,761 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:07
2025-03-09 08:18:07,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:07,761 [INFO]: 	Creating the index 03/09/2025, 08:18:07
2025-03-09 08:18:07,761 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:07
2025-03-09 08:18:07,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:18:07,762 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:07
2025-03-09 08:18:07,762 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:18:07,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.45it/s]100%|██████████| 6/6 [00:01<00:00,  4.39it/s]100%|██████████| 6/6 [00:01<00:00,  4.50it/s]
2025-03-09 08:18:09,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:09
2025-03-09 08:18:31,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3589 secs
2025-03-09 08:18:31,460 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:18:31,460 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.72it/s]
2025-03-09 08:18:43,604 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1432 secs
2025-03-09 08:18:43,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.8431 secs
2025-03-09 08:18:43,605 [INFO]: {
2025-03-09 08:18:43,605 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:43,605 [INFO]: 	index_param: efSearch=263
2025-03-09 08:18:43,605 [INFO]: 	index_path: knn.index
2025-03-09 08:18:43,605 [INFO]: 	size in bytes: 292164910
2025-03-09 08:18:43,605 [INFO]: 	avg_search_speed_ms: 9.400894302792524
2025-03-09 08:18:43,605 [INFO]: 	99p_search_speed_ms: 17.57508995477108
2025-03-09 08:18:43,605 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:43,605 [INFO]: 	nb vectors: 1485
2025-03-09 08:18:43,605 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:43,605 [INFO]: 	compression ratio: 0.9993085069661514
2025-03-09 08:18:43,605 [INFO]: }
2025-03-09 08:18:43,606 [INFO]: 	>>> Finished "Creating the index" in 35.8444 secs
2025-03-09 08:18:43,606 [INFO]: >>> Finished "Launching the whole pipeline" in 35.8677 secs
2025-03-09 08:18:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 29845 [episode count 10/20]
[retrieval_preprocessing] for episode 82840 [episode count 11/20], we have num_retrieval=np.int64(1523) num_query=np.int64(69)
2025-03-09 08:18:44,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:44,973 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:44
2025-03-09 08:18:44,973 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.18it/s]
2025-03-09 08:18:44,999 [INFO]: There are 1523 embeddings of dim 49152
2025-03-09 08:18:44,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:18:44,999 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:44
2025-03-09 08:18:44,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:44,999 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:18:44,999 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:44,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:44,999 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:44
2025-03-09 08:18:44,999 [INFO]: 314.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:44,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:18:44,999 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:44
2025-03-09 08:18:44,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:44,999 [INFO]: 	Creating the index 03/09/2025, 08:18:44
2025-03-09 08:18:44,999 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:44
2025-03-09 08:18:45,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:18:45,001 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:45
2025-03-09 08:18:45,001 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:18:45,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.33it/s] 83%|████████▎ | 5/6 [00:00<00:00, 26.17it/s]100%|██████████| 6/6 [00:01<00:00,  4.62it/s]
2025-03-09 08:18:46,303 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:46
2025-03-09 08:19:06,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2418 secs
2025-03-09 08:19:06,546 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 08:19:06,546 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-09 08:19:20,578 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0322 secs
2025-03-09 08:19:20,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5793 secs
2025-03-09 08:19:20,580 [INFO]: {
2025-03-09 08:19:20,580 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:20,580 [INFO]: 	index_param: efSearch=234
2025-03-09 08:19:20,580 [INFO]: 	index_path: knn.index
2025-03-09 08:19:20,580 [INFO]: 	size in bytes: 299641090
2025-03-09 08:19:20,580 [INFO]: 	avg_search_speed_ms: 8.606019141128456
2025-03-09 08:19:20,580 [INFO]: 	99p_search_speed_ms: 12.044557712506549
2025-03-09 08:19:20,580 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:20,580 [INFO]: 	nb vectors: 1523
2025-03-09 08:19:20,580 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:20,580 [INFO]: 	compression ratio: 0.9993088197616689
2025-03-09 08:19:20,580 [INFO]: }
2025-03-09 08:19:20,580 [INFO]: 	>>> Finished "Creating the index" in 35.5808 secs
2025-03-09 08:19:20,580 [INFO]: >>> Finished "Launching the whole pipeline" in 35.6072 secs
2025-03-09 08:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 82840 [episode count 11/20]
[retrieval_preprocessing] for episode 17307 [episode count 12/20], we have num_retrieval=np.int64(1521) num_query=np.int64(71)
2025-03-09 08:19:21,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:21,353 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:21
2025-03-09 08:19:21,353 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.62it/s]
2025-03-09 08:19:21,380 [INFO]: There are 1521 embeddings of dim 49152
2025-03-09 08:19:21,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:19:21,380 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:21
2025-03-09 08:19:21,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:21,380 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:19:21,380 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:21,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:21,380 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:21
2025-03-09 08:19:21,380 [INFO]: 313.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:21,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:19:21,380 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:21
2025-03-09 08:19:21,381 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:21,381 [INFO]: 	Creating the index 03/09/2025, 08:19:21
2025-03-09 08:19:21,381 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:21
2025-03-09 08:19:21,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:19:21,382 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:21
2025-03-09 08:19:21,382 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:19:21,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.13it/s]100%|██████████| 6/6 [00:01<00:00,  4.33it/s]100%|██████████| 6/6 [00:01<00:00,  4.69it/s]
2025-03-09 08:19:22,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:22
2025-03-09 08:19:42,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2384 secs
2025-03-09 08:19:42,902 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 08:19:42,902 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.49it/s]
2025-03-09 08:19:58,201 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2992 secs
2025-03-09 08:19:58,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8207 secs
2025-03-09 08:19:58,203 [INFO]: {
2025-03-09 08:19:58,203 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:58,203 [INFO]: 	index_param: efSearch=258
2025-03-09 08:19:58,203 [INFO]: 	index_path: knn.index
2025-03-09 08:19:58,203 [INFO]: 	size in bytes: 299247610
2025-03-09 08:19:58,203 [INFO]: 	avg_search_speed_ms: 10.513265073430635
2025-03-09 08:19:58,203 [INFO]: 	99p_search_speed_ms: 18.44500843435526
2025-03-09 08:19:58,203 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:58,203 [INFO]: 	nb vectors: 1521
2025-03-09 08:19:58,203 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:58,203 [INFO]: 	compression ratio: 0.9993087931429093
2025-03-09 08:19:58,203 [INFO]: }
2025-03-09 08:19:58,203 [INFO]: 	>>> Finished "Creating the index" in 36.8222 secs
2025-03-09 08:19:58,203 [INFO]: >>> Finished "Launching the whole pipeline" in 36.8495 secs
2025-03-09 08:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 17307 [episode count 12/20]
[retrieval_preprocessing] for episode 23964 [episode count 13/20], we have num_retrieval=np.int64(1513) num_query=np.int64(79)
2025-03-09 08:19:58,904 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:59,103 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:59
2025-03-09 08:19:59,103 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2200.58it/s]
2025-03-09 08:19:59,126 [INFO]: There are 1513 embeddings of dim 49152
2025-03-09 08:19:59,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 08:19:59,126 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:59
2025-03-09 08:19:59,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:59,126 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:19:59,126 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:59,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:59,126 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:59
2025-03-09 08:19:59,126 [INFO]: 312.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:59,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:19:59,126 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:59
2025-03-09 08:19:59,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:59,126 [INFO]: 	Creating the index 03/09/2025, 08:19:59
2025-03-09 08:19:59,126 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:59
2025-03-09 08:19:59,127 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:19:59,127 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:59
2025-03-09 08:19:59,127 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:19:59,127 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.04it/s]100%|██████████| 6/6 [00:01<00:00,  3.69it/s]100%|██████████| 6/6 [00:01<00:00,  4.01it/s]
2025-03-09 08:20:00,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:00
2025-03-09 08:20:21,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.5232 secs
2025-03-09 08:20:21,151 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 08:20:21,151 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.09it/s]
2025-03-09 08:20:35,940 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7891 secs
2025-03-09 08:20:35,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8141 secs
2025-03-09 08:20:35,942 [INFO]: {
2025-03-09 08:20:35,942 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:35,942 [INFO]: 	index_param: efSearch=294
2025-03-09 08:20:35,942 [INFO]: 	index_path: knn.index
2025-03-09 08:20:35,942 [INFO]: 	size in bytes: 297673630
2025-03-09 08:20:35,942 [INFO]: 	avg_search_speed_ms: 10.772843102837308
2025-03-09 08:20:35,942 [INFO]: 	99p_search_speed_ms: 27.149096773937348
2025-03-09 08:20:35,942 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:35,942 [INFO]: 	nb vectors: 1513
2025-03-09 08:20:35,942 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:35,942 [INFO]: 	compression ratio: 0.9993088873878415
2025-03-09 08:20:35,942 [INFO]: }
2025-03-09 08:20:35,942 [INFO]: 	>>> Finished "Creating the index" in 36.8154 secs
2025-03-09 08:20:35,942 [INFO]: >>> Finished "Launching the whole pipeline" in 36.8387 secs
2025-03-09 08:20:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 23964 [episode count 13/20]
[retrieval_preprocessing] for episode 64028 [episode count 14/20], we have num_retrieval=np.int64(1515) num_query=np.int64(77)
2025-03-09 08:20:36,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:36,845 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:36
2025-03-09 08:20:36,845 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1758.62it/s]
2025-03-09 08:20:36,872 [INFO]: There are 1515 embeddings of dim 49152
2025-03-09 08:20:36,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:20:36,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:36,873 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:20:36,873 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:36,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:20:36,873 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,873 [INFO]: 312.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:36,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:20:36,873 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:36
2025-03-09 08:20:36,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:36,874 [INFO]: 	Creating the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,874 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:36
2025-03-09 08:20:36,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:20:36,877 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,877 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:20:36,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.66it/s]100%|██████████| 6/6 [00:01<00:00,  4.11it/s]100%|██████████| 6/6 [00:01<00:00,  4.45it/s]
2025-03-09 08:20:38,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:38
2025-03-09 08:20:57,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7483 secs
2025-03-09 08:20:57,979 [INFO]: The best hyperparameters are: efSearch=277
2025-03-09 08:20:57,979 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.63it/s]
2025-03-09 08:21:12,342 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3624 secs
2025-03-09 08:21:12,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.4658 secs
2025-03-09 08:21:12,343 [INFO]: {
2025-03-09 08:21:12,343 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:12,343 [INFO]: 	index_param: efSearch=277
2025-03-09 08:21:12,343 [INFO]: 	index_path: knn.index
2025-03-09 08:21:12,343 [INFO]: 	size in bytes: 298067170
2025-03-09 08:21:12,343 [INFO]: 	avg_search_speed_ms: 10.207806429493107
2025-03-09 08:21:12,343 [INFO]: 	99p_search_speed_ms: 19.194111337419603
2025-03-09 08:21:12,343 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:12,343 [INFO]: 	nb vectors: 1515
2025-03-09 08:21:12,343 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:12,343 [INFO]: 	compression ratio: 0.9993087128649559
2025-03-09 08:21:12,343 [INFO]: }
2025-03-09 08:21:12,343 [INFO]: 	>>> Finished "Creating the index" in 35.4693 secs
2025-03-09 08:21:12,343 [INFO]: >>> Finished "Launching the whole pipeline" in 35.4977 secs
2025-03-09 08:21:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 64028 [episode count 14/20]
[retrieval_preprocessing] for episode 27934 [episode count 15/20], we have num_retrieval=np.int64(1506) num_query=np.int64(86)
2025-03-09 08:21:14,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:14,372 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:14
2025-03-09 08:21:14,372 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2692.11it/s]
2025-03-09 08:21:14,393 [INFO]: There are 1506 embeddings of dim 49152
2025-03-09 08:21:14,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-09 08:21:14,393 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:14
2025-03-09 08:21:14,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:14,393 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:21:14,393 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:14,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:14,393 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:14
2025-03-09 08:21:14,394 [INFO]: 310.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:14,394 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:21:14,394 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:14
2025-03-09 08:21:14,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:14,394 [INFO]: 	Creating the index 03/09/2025, 08:21:14
2025-03-09 08:21:14,394 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:14
2025-03-09 08:21:14,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:21:14,395 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:14
2025-03-09 08:21:14,395 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:21:14,395 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.80it/s]100%|██████████| 6/6 [00:01<00:00,  4.86it/s]100%|██████████| 6/6 [00:01<00:00,  5.24it/s]
2025-03-09 08:21:15,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:15
2025-03-09 08:21:36,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0739 secs
2025-03-09 08:21:36,618 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 08:21:36,618 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.96it/s]
2025-03-09 08:21:48,394 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7760 secs
2025-03-09 08:21:48,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.0006 secs
2025-03-09 08:21:48,396 [INFO]: {
2025-03-09 08:21:48,396 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:48,396 [INFO]: 	index_param: efSearch=258
2025-03-09 08:21:48,396 [INFO]: 	index_path: knn.index
2025-03-09 08:21:48,396 [INFO]: 	size in bytes: 296296450
2025-03-09 08:21:48,396 [INFO]: 	avg_search_speed_ms: 9.6499752871329
2025-03-09 08:21:48,396 [INFO]: 	99p_search_speed_ms: 19.64145101374016
2025-03-09 08:21:48,396 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:48,396 [INFO]: 	nb vectors: 1506
2025-03-09 08:21:48,396 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:48,396 [INFO]: 	compression ratio: 0.9993087936085633
2025-03-09 08:21:48,396 [INFO]: }
2025-03-09 08:21:48,396 [INFO]: 	>>> Finished "Creating the index" in 34.0020 secs
2025-03-09 08:21:48,396 [INFO]: >>> Finished "Launching the whole pipeline" in 34.0240 secs
2025-03-09 08:21:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 27934 [episode count 15/20]
[retrieval_preprocessing] for episode 82977 [episode count 16/20], we have num_retrieval=np.int64(1517) num_query=np.int64(75)
2025-03-09 08:21:49,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:49,308 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:49
2025-03-09 08:21:49,308 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-09 08:21:49,334 [INFO]: There are 1517 embeddings of dim 49152
2025-03-09 08:21:49,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:21:49,334 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:49
2025-03-09 08:21:49,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:49,335 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:21:49,335 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:49,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:21:49,335 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:49
2025-03-09 08:21:49,335 [INFO]: 313.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:49,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:21:49,336 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:49
2025-03-09 08:21:49,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:49,336 [INFO]: 	Creating the index 03/09/2025, 08:21:49
2025-03-09 08:21:49,336 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:49
2025-03-09 08:21:49,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:21:49,339 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:49
2025-03-09 08:21:49,340 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:21:49,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 14.43it/s]100%|██████████| 6/6 [00:01<00:00,  4.16it/s]100%|██████████| 6/6 [00:01<00:00,  4.48it/s]
2025-03-09 08:21:50,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:50
2025-03-09 08:22:13,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.4710 secs
2025-03-09 08:22:13,157 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 08:22:13,157 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.78it/s]
2025-03-09 08:22:27,311 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1536 secs
2025-03-09 08:22:27,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.9727 secs
2025-03-09 08:22:27,312 [INFO]: {
2025-03-09 08:22:27,312 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:27,312 [INFO]: 	index_param: efSearch=261
2025-03-09 08:22:27,312 [INFO]: 	index_path: knn.index
2025-03-09 08:22:27,312 [INFO]: 	size in bytes: 298460650
2025-03-09 08:22:27,312 [INFO]: 	avg_search_speed_ms: 10.16036048484257
2025-03-09 08:22:27,312 [INFO]: 	99p_search_speed_ms: 23.48602863959967
2025-03-09 08:22:27,312 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:27,312 [INFO]: 	nb vectors: 1517
2025-03-09 08:22:27,312 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:27,312 [INFO]: 	compression ratio: 0.9993087396948308
2025-03-09 08:22:27,312 [INFO]: }
2025-03-09 08:22:27,312 [INFO]: 	>>> Finished "Creating the index" in 37.9765 secs
2025-03-09 08:22:27,313 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0048 secs
2025-03-09 08:22:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 82977 [episode count 16/20]
[retrieval_preprocessing] for episode 48675 [episode count 17/20], we have num_retrieval=np.int64(1502) num_query=np.int64(90)
2025-03-09 08:22:28,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:28,537 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:28
2025-03-09 08:22:28,537 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2288.22it/s]
2025-03-09 08:22:28,561 [INFO]: There are 1502 embeddings of dim 49152
2025-03-09 08:22:28,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:22:28,562 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:28
2025-03-09 08:22:28,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:28,562 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:22:28,562 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:28,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:22:28,563 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:28
2025-03-09 08:22:28,563 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:28,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:22:28,563 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:28
2025-03-09 08:22:28,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:28,563 [INFO]: 	Creating the index 03/09/2025, 08:22:28
2025-03-09 08:22:28,564 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:28
2025-03-09 08:22:28,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:22:28,566 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:28
2025-03-09 08:22:28,567 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:22:28,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 25.65it/s]100%|██████████| 6/6 [00:01<00:00,  3.90it/s]100%|██████████| 6/6 [00:01<00:00,  4.46it/s]
2025-03-09 08:22:29,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:29
2025-03-09 08:22:50,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2977 secs
2025-03-09 08:22:50,216 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 08:22:50,216 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.20it/s]
2025-03-09 08:23:06,033 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8175 secs
2025-03-09 08:23:06,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.4685 secs
2025-03-09 08:23:06,035 [INFO]: {
2025-03-09 08:23:06,035 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:06,035 [INFO]: 	index_param: efSearch=270
2025-03-09 08:23:06,035 [INFO]: 	index_path: knn.index
2025-03-09 08:23:06,035 [INFO]: 	size in bytes: 295509490
2025-03-09 08:23:06,035 [INFO]: 	avg_search_speed_ms: 12.082679692941497
2025-03-09 08:23:06,035 [INFO]: 	99p_search_speed_ms: 25.298429052345455
2025-03-09 08:23:06,035 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:06,035 [INFO]: 	nb vectors: 1502
2025-03-09 08:23:06,035 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:06,035 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-09 08:23:06,035 [INFO]: }
2025-03-09 08:23:06,035 [INFO]: 	>>> Finished "Creating the index" in 37.4718 secs
2025-03-09 08:23:06,035 [INFO]: >>> Finished "Launching the whole pipeline" in 37.4985 secs
2025-03-09 08:23:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 48675 [episode count 17/20]
[retrieval_preprocessing] for episode 75176 [episode count 18/20], we have num_retrieval=np.int64(1529) num_query=np.int64(63)
2025-03-09 08:23:07,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:07,466 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:07
2025-03-09 08:23:07,466 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.14it/s]
2025-03-09 08:23:07,490 [INFO]: There are 1529 embeddings of dim 49152
2025-03-09 08:23:07,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:23:07,491 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:07
2025-03-09 08:23:07,491 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:07,491 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:23:07,491 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:07,491 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:07,491 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:07
2025-03-09 08:23:07,491 [INFO]: 315.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:07,491 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:23:07,491 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:07
2025-03-09 08:23:07,491 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:07,491 [INFO]: 	Creating the index 03/09/2025, 08:23:07
2025-03-09 08:23:07,491 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:07
2025-03-09 08:23:07,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:23:07,492 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:07
2025-03-09 08:23:07,493 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:23:07,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.26it/s] 86%|████████▌ | 6/7 [00:00<00:00, 29.52it/s]100%|██████████| 7/7 [00:01<00:00,  4.40it/s]
2025-03-09 08:23:09,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:09
2025-03-09 08:23:34,094 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0043 secs
2025-03-09 08:23:34,094 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 08:23:34,094 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.95it/s]
2025-03-09 08:23:47,941 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8468 secs
2025-03-09 08:23:47,942 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4498 secs
2025-03-09 08:23:47,942 [INFO]: {
2025-03-09 08:23:47,942 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:47,942 [INFO]: 	index_param: efSearch=260
2025-03-09 08:23:47,943 [INFO]: 	index_path: knn.index
2025-03-09 08:23:47,943 [INFO]: 	size in bytes: 300821590
2025-03-09 08:23:47,943 [INFO]: 	avg_search_speed_ms: 10.986989603510924
2025-03-09 08:23:47,943 [INFO]: 	99p_search_speed_ms: 27.149877988267686
2025-03-09 08:23:47,943 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:47,943 [INFO]: 	nb vectors: 1529
2025-03-09 08:23:47,943 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:47,943 [INFO]: 	compression ratio: 0.9993086998842071
2025-03-09 08:23:47,943 [INFO]: }
2025-03-09 08:23:47,943 [INFO]: 	>>> Finished "Creating the index" in 40.4512 secs
2025-03-09 08:23:47,943 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4766 secs
2025-03-09 08:23:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 75176 [episode count 18/20]
[retrieval_preprocessing] for episode 58537 [episode count 19/20], we have num_retrieval=np.int64(1519) num_query=np.int64(73)
2025-03-09 08:23:48,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:49,079 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:49
2025-03-09 08:23:49,079 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1076.84it/s]
2025-03-09 08:23:49,105 [INFO]: There are 1519 embeddings of dim 49152
2025-03-09 08:23:49,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:23:49,105 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:49
2025-03-09 08:23:49,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:49,105 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:23:49,105 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:49,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:49,105 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:49
2025-03-09 08:23:49,105 [INFO]: 313.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:49,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:23:49,105 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:49
2025-03-09 08:23:49,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:49,105 [INFO]: 	Creating the index 03/09/2025, 08:23:49
2025-03-09 08:23:49,105 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:49
2025-03-09 08:23:49,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:23:49,107 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:49
2025-03-09 08:23:49,107 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:23:49,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.77it/s]100%|██████████| 6/6 [00:01<00:00,  3.97it/s]100%|██████████| 6/6 [00:01<00:00,  4.31it/s]
2025-03-09 08:23:50,503 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:50
2025-03-09 08:24:12,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5134 secs
2025-03-09 08:24:12,017 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 08:24:12,017 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-09 08:24:26,988 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9705 secs
2025-03-09 08:24:26,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8821 secs
2025-03-09 08:24:26,989 [INFO]: {
2025-03-09 08:24:26,989 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:26,989 [INFO]: 	index_param: efSearch=230
2025-03-09 08:24:26,989 [INFO]: 	index_path: knn.index
2025-03-09 08:24:26,989 [INFO]: 	size in bytes: 298854130
2025-03-09 08:24:26,989 [INFO]: 	avg_search_speed_ms: 10.655634137191853
2025-03-09 08:24:26,989 [INFO]: 	99p_search_speed_ms: 21.957564186304808
2025-03-09 08:24:26,989 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:26,989 [INFO]: 	nb vectors: 1519
2025-03-09 08:24:26,989 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:26,989 [INFO]: 	compression ratio: 0.9993087664540556
2025-03-09 08:24:26,989 [INFO]: }
2025-03-09 08:24:26,989 [INFO]: 	>>> Finished "Creating the index" in 37.8838 secs
2025-03-09 08:24:26,989 [INFO]: >>> Finished "Launching the whole pipeline" in 37.9105 secs
2025-03-09 08:24:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 58537 [episode count 19/20]
2025-03-09 08:24:27: [retrieval_preprocessing] finished for (52817038, 'block') [chosen_id count 3/5]
2025-03-09 08:24:29: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8815207926, 'block') [chosen_id count 4/5]
2025-03-09 08:24:29: [retrieval_preprocessing] we have num_total=3091 embedding_dim=49152
[retrieval_preprocessing] for episode 40704 [episode count 0/20], we have num_retrieval=np.int64(2958) num_query=np.int64(133)
2025-03-09 08:24:29,348 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:29,773 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:29
2025-03-09 08:24:29,773 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.93it/s]
2025-03-09 08:24:29,803 [INFO]: There are 2958 embeddings of dim 49152
2025-03-09 08:24:29,803 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 08:24:29,804 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:29
2025-03-09 08:24:29,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:29,804 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:24:29,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:29,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:24:29,804 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:29
2025-03-09 08:24:29,805 [INFO]: 610.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:29,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:24:29,805 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:29
2025-03-09 08:24:29,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:29,805 [INFO]: 	Creating the index 03/09/2025, 08:24:29
2025-03-09 08:24:29,806 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:29
2025-03-09 08:24:29,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:24:29,809 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:29
2025-03-09 08:24:29,809 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:24:29,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.62it/s] 75%|███████▌  | 9/12 [00:00<00:00, 41.15it/s]100%|██████████| 12/12 [00:02<00:00,  4.85it/s]
2025-03-09 08:24:32,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:32
2025-03-09 08:25:05,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1888 secs
2025-03-09 08:25:05,478 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:25:05,478 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.62it/s]
2025-03-09 08:25:25,660 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1820 secs
2025-03-09 08:25:25,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8530 secs
2025-03-09 08:25:25,662 [INFO]: {
2025-03-09 08:25:25,662 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:25,662 [INFO]: 	index_param: efSearch=215
2025-03-09 08:25:25,662 [INFO]: 	index_path: knn.index
2025-03-09 08:25:25,662 [INFO]: 	size in bytes: 581968210
2025-03-09 08:25:25,662 [INFO]: 	avg_search_speed_ms: 9.320307386308242
2025-03-09 08:25:25,662 [INFO]: 	99p_search_speed_ms: 13.786058966070414
2025-03-09 08:25:25,662 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:25,662 [INFO]: 	nb vectors: 2958
2025-03-09 08:25:25,662 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:25,662 [INFO]: 	compression ratio: 0.999309677069818
2025-03-09 08:25:25,662 [INFO]: }
2025-03-09 08:25:25,662 [INFO]: 	>>> Finished "Creating the index" in 55.8568 secs
2025-03-09 08:25:25,662 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8894 secs
2025-03-09 08:25:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 40704 [episode count 0/20]
[retrieval_preprocessing] for episode 85632 [episode count 1/20], we have num_retrieval=np.int64(2949) num_query=np.int64(142)
2025-03-09 08:25:27,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:27,510 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:27
2025-03-09 08:25:27,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1801.68it/s]
2025-03-09 08:25:27,535 [INFO]: There are 2949 embeddings of dim 49152
2025-03-09 08:25:27,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:25:27,535 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:27
2025-03-09 08:25:27,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:27,535 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:25:27,536 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:27,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:25:27,536 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:27
2025-03-09 08:25:27,536 [INFO]: 608.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:27,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:27,536 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:27
2025-03-09 08:25:27,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:27,536 [INFO]: 	Creating the index 03/09/2025, 08:25:27
2025-03-09 08:25:27,536 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:27
2025-03-09 08:25:27,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:25:27,537 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:27
2025-03-09 08:25:27,537 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:25:27,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.47it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.06it/s]100%|██████████| 12/12 [00:02<00:00,  3.54it/s]100%|██████████| 12/12 [00:02<00:00,  4.21it/s]
2025-03-09 08:25:30,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:30
2025-03-09 08:26:13,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5672 secs
2025-03-09 08:26:13,959 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:26:13,959 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.28it/s]
2025-03-09 08:26:30,496 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5364 secs
2025-03-09 08:26:30,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9605 secs
2025-03-09 08:26:30,498 [INFO]: {
2025-03-09 08:26:30,498 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:30,498 [INFO]: 	index_param: efSearch=200
2025-03-09 08:26:30,498 [INFO]: 	index_path: knn.index
2025-03-09 08:26:30,498 [INFO]: 	size in bytes: 580197430
2025-03-09 08:26:30,498 [INFO]: 	avg_search_speed_ms: 8.766961804330741
2025-03-09 08:26:30,498 [INFO]: 	99p_search_speed_ms: 13.101825211197136
2025-03-09 08:26:30,498 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:30,498 [INFO]: 	nb vectors: 2949
2025-03-09 08:26:30,498 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:30,498 [INFO]: 	compression ratio: 0.9993098245885026
2025-03-09 08:26:30,498 [INFO]: }
2025-03-09 08:26:30,498 [INFO]: 	>>> Finished "Creating the index" in 62.9619 secs
2025-03-09 08:26:30,498 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9880 secs
2025-03-09 08:26:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 85632 [episode count 1/20]
[retrieval_preprocessing] for episode 92936 [episode count 2/20], we have num_retrieval=np.int64(2945) num_query=np.int64(146)
2025-03-09 08:26:31,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:32,187 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:32
2025-03-09 08:26:32,187 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.57it/s]
2025-03-09 08:26:32,212 [INFO]: There are 2945 embeddings of dim 49152
2025-03-09 08:26:32,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:26:32,212 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:32
2025-03-09 08:26:32,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:32,212 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:26:32,212 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:32,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:26:32,212 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:32
2025-03-09 08:26:32,213 [INFO]: 607.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:32,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:26:32,213 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:32
2025-03-09 08:26:32,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:32,213 [INFO]: 	Creating the index 03/09/2025, 08:26:32
2025-03-09 08:26:32,213 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:32
2025-03-09 08:26:32,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:26:32,214 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:32
2025-03-09 08:26:32,214 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:26:32,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.27it/s] 67%|██████▋   | 8/12 [00:00<00:00, 40.17it/s]100%|██████████| 12/12 [00:02<00:00,  5.33it/s]
2025-03-09 08:26:34,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:34
2025-03-09 08:27:26,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8108 secs
2025-03-09 08:27:26,280 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 08:27:26,280 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-09 08:27:42,810 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5296 secs
2025-03-09 08:27:42,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5981 secs
2025-03-09 08:27:42,812 [INFO]: {
2025-03-09 08:27:42,812 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:42,812 [INFO]: 	index_param: efSearch=145
2025-03-09 08:27:42,812 [INFO]: 	index_path: knn.index
2025-03-09 08:27:42,813 [INFO]: 	size in bytes: 579410470
2025-03-09 08:27:42,813 [INFO]: 	avg_search_speed_ms: 8.311595821928107
2025-03-09 08:27:42,813 [INFO]: 	99p_search_speed_ms: 19.69434359110893
2025-03-09 08:27:42,813 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:42,813 [INFO]: 	nb vectors: 2945
2025-03-09 08:27:42,813 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:42,813 [INFO]: 	compression ratio: 0.9993097984577324
2025-03-09 08:27:42,813 [INFO]: }
2025-03-09 08:27:42,813 [INFO]: 	>>> Finished "Creating the index" in 70.5999 secs
2025-03-09 08:27:42,813 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6255 secs
2025-03-09 08:27:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 92936 [episode count 2/20]
[retrieval_preprocessing] for episode 26123 [episode count 3/20], we have num_retrieval=np.int64(2943) num_query=np.int64(148)
2025-03-09 08:27:44,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:44,760 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:44
2025-03-09 08:27:44,761 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.04it/s]
2025-03-09 08:27:44,798 [INFO]: There are 2943 embeddings of dim 49152
2025-03-09 08:27:44,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-09 08:27:44,798 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:44
2025-03-09 08:27:44,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:44,799 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:27:44,799 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:44,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:27:44,799 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:44
2025-03-09 08:27:44,799 [INFO]: 607.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:44,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:27:44,799 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:44
2025-03-09 08:27:44,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:44,799 [INFO]: 	Creating the index 03/09/2025, 08:27:44
2025-03-09 08:27:44,800 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:44
2025-03-09 08:27:44,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 08:27:44,802 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:44
2025-03-09 08:27:44,802 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:27:44,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.14it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.61it/s]100%|██████████| 12/12 [00:02<00:00,  3.90it/s]100%|██████████| 12/12 [00:02<00:00,  4.64it/s]
2025-03-09 08:27:47,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:47
2025-03-09 08:28:28,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0590 secs
2025-03-09 08:28:28,452 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:28:28,452 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 08:28:42,422 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9698 secs
2025-03-09 08:28:42,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6215 secs
2025-03-09 08:28:42,424 [INFO]: {
2025-03-09 08:28:42,424 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:42,424 [INFO]: 	index_param: efSearch=220
2025-03-09 08:28:42,424 [INFO]: 	index_path: knn.index
2025-03-09 08:28:42,424 [INFO]: 	size in bytes: 579016990
2025-03-09 08:28:42,424 [INFO]: 	avg_search_speed_ms: 9.605250040187315
2025-03-09 08:28:42,424 [INFO]: 	99p_search_speed_ms: 21.16351807489985
2025-03-09 08:28:42,424 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:42,424 [INFO]: 	nb vectors: 2943
2025-03-09 08:28:42,424 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:42,424 [INFO]: 	compression ratio: 0.9993097853657109
2025-03-09 08:28:42,424 [INFO]: }
2025-03-09 08:28:42,424 [INFO]: 	>>> Finished "Creating the index" in 57.6247 secs
2025-03-09 08:28:42,424 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6637 secs
2025-03-09 08:28:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 26123 [episode count 3/20]
[retrieval_preprocessing] for episode 56333 [episode count 4/20], we have num_retrieval=np.int64(2926) num_query=np.int64(165)
2025-03-09 08:28:43,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:44,405 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:44
2025-03-09 08:28:44,405 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.61it/s]
2025-03-09 08:28:44,431 [INFO]: There are 2926 embeddings of dim 49152
2025-03-09 08:28:44,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:28:44,431 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:44
2025-03-09 08:28:44,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:44,432 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:28:44,432 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:44,432 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:44,432 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:44
2025-03-09 08:28:44,432 [INFO]: 603.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:44,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:44,432 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:44
2025-03-09 08:28:44,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:44,432 [INFO]: 	Creating the index 03/09/2025, 08:28:44
2025-03-09 08:28:44,432 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:44
2025-03-09 08:28:44,433 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:28:44,433 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:44
2025-03-09 08:28:44,433 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:28:44,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.08it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.12it/s]100%|██████████| 12/12 [00:02<00:00,  3.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.52it/s]
2025-03-09 08:28:47,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:47
2025-03-09 08:29:30,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2327 secs
2025-03-09 08:29:30,322 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:29:30,322 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-09 08:29:46,437 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1151 secs
2025-03-09 08:29:46,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0074 secs
2025-03-09 08:29:46,441 [INFO]: {
2025-03-09 08:29:46,441 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:46,441 [INFO]: 	index_param: efSearch=218
2025-03-09 08:29:46,441 [INFO]: 	index_path: knn.index
2025-03-09 08:29:46,441 [INFO]: 	size in bytes: 575672290
2025-03-09 08:29:46,441 [INFO]: 	avg_search_speed_ms: 11.362699227703905
2025-03-09 08:29:46,441 [INFO]: 	99p_search_speed_ms: 24.97129989555107
2025-03-09 08:29:46,441 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:46,441 [INFO]: 	nb vectors: 2926
2025-03-09 08:29:46,441 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:46,441 [INFO]: 	compression ratio: 0.9993098816689614
2025-03-09 08:29:46,441 [INFO]: }
2025-03-09 08:29:46,441 [INFO]: 	>>> Finished "Creating the index" in 62.0095 secs
2025-03-09 08:29:46,441 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0360 secs
2025-03-09 08:29:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 56333 [episode count 4/20]
[retrieval_preprocessing] for episode 68750 [episode count 5/20], we have num_retrieval=np.int64(2972) num_query=np.int64(119)
2025-03-09 08:29:48,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:49,089 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:49
2025-03-09 08:29:49,089 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.08it/s]
2025-03-09 08:29:49,117 [INFO]: There are 2972 embeddings of dim 49152
2025-03-09 08:29:49,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 08:29:49,118 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:49
2025-03-09 08:29:49,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:49,118 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:29:49,118 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:49,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:49,118 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:49
2025-03-09 08:29:49,118 [INFO]: 613.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:49,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:29:49,118 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:49
2025-03-09 08:29:49,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:49,118 [INFO]: 	Creating the index 03/09/2025, 08:29:49
2025-03-09 08:29:49,118 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:49
2025-03-09 08:29:49,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:29:49,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:49
2025-03-09 08:29:49,120 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:29:49,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.54it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.44it/s]100%|██████████| 12/12 [00:02<00:00,  3.80it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]
2025-03-09 08:29:51,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:51
2025-03-09 08:30:32,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7265 secs
2025-03-09 08:30:32,501 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:30:32,501 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.73it/s]
2025-03-09 08:30:48,222 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7209 secs
2025-03-09 08:30:48,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1045 secs
2025-03-09 08:30:48,224 [INFO]: {
2025-03-09 08:30:48,224 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:48,224 [INFO]: 	index_param: efSearch=187
2025-03-09 08:30:48,224 [INFO]: 	index_path: knn.index
2025-03-09 08:30:48,224 [INFO]: 	size in bytes: 584722690
2025-03-09 08:30:48,224 [INFO]: 	avg_search_speed_ms: 9.40093737077213
2025-03-09 08:30:48,224 [INFO]: 	99p_search_speed_ms: 19.746291190385808
2025-03-09 08:30:48,224 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:48,225 [INFO]: 	nb vectors: 2972
2025-03-09 08:30:48,225 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:48,225 [INFO]: 	compression ratio: 0.9993095633076938
2025-03-09 08:30:48,225 [INFO]: }
2025-03-09 08:30:48,225 [INFO]: 	>>> Finished "Creating the index" in 59.1062 secs
2025-03-09 08:30:48,225 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1357 secs
2025-03-09 08:30:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 68750 [episode count 5/20]
[retrieval_preprocessing] for episode 57743 [episode count 6/20], we have num_retrieval=np.int64(2982) num_query=np.int64(109)
2025-03-09 08:30:49,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:49,828 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:49
2025-03-09 08:30:49,828 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.42it/s]
2025-03-09 08:30:49,858 [INFO]: There are 2982 embeddings of dim 49152
2025-03-09 08:30:49,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 08:30:49,858 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:49
2025-03-09 08:30:49,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:49,858 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:30:49,858 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:49,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:49,858 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:49
2025-03-09 08:30:49,858 [INFO]: 615.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:49,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:30:49,858 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:49
2025-03-09 08:30:49,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:49,858 [INFO]: 	Creating the index 03/09/2025, 08:30:49
2025-03-09 08:30:49,859 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:49
2025-03-09 08:30:49,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:30:49,860 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:49
2025-03-09 08:30:49,860 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:30:49,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.82it/s] 67%|██████▋   | 8/12 [00:00<00:00, 36.93it/s]100%|██████████| 12/12 [00:02<00:00,  3.99it/s]100%|██████████| 12/12 [00:02<00:00,  5.01it/s]
2025-03-09 08:30:52,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:52
2025-03-09 08:31:23,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1370 secs
2025-03-09 08:31:23,399 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:31:23,400 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-09 08:31:38,870 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4698 secs
2025-03-09 08:31:38,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0115 secs
2025-03-09 08:31:38,872 [INFO]: {
2025-03-09 08:31:38,872 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:38,872 [INFO]: 	index_param: efSearch=236
2025-03-09 08:31:38,872 [INFO]: 	index_path: knn.index
2025-03-09 08:31:38,872 [INFO]: 	size in bytes: 586690090
2025-03-09 08:31:38,872 [INFO]: 	avg_search_speed_ms: 10.587488056687766
2025-03-09 08:31:38,872 [INFO]: 	99p_search_speed_ms: 23.79605907015502
2025-03-09 08:31:38,872 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:38,872 [INFO]: 	nb vectors: 2982
2025-03-09 08:31:38,872 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:38,872 [INFO]: 	compression ratio: 0.9993096287002223
2025-03-09 08:31:38,872 [INFO]: }
2025-03-09 08:31:38,872 [INFO]: 	>>> Finished "Creating the index" in 49.0132 secs
2025-03-09 08:31:38,872 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0436 secs
2025-03-09 08:31:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 57743 [episode count 6/20]
[retrieval_preprocessing] for episode 48530 [episode count 7/20], we have num_retrieval=np.int64(2936) num_query=np.int64(155)
2025-03-09 08:31:40,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:40,501 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:40
2025-03-09 08:31:40,501 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.28it/s]
2025-03-09 08:31:40,527 [INFO]: There are 2936 embeddings of dim 49152
2025-03-09 08:31:40,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:31:40,528 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:40
2025-03-09 08:31:40,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:40,528 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:31:40,528 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:40,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:31:40,528 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:40
2025-03-09 08:31:40,528 [INFO]: 605.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:40,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:31:40,529 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:40
2025-03-09 08:31:40,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:40,529 [INFO]: 	Creating the index 03/09/2025, 08:31:40
2025-03-09 08:31:40,529 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:40
2025-03-09 08:31:40,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:31:40,532 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:40
2025-03-09 08:31:40,532 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:31:40,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.31it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.26it/s]100%|██████████| 12/12 [00:02<00:00,  5.05it/s]
2025-03-09 08:31:42,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:42
2025-03-09 08:32:25,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4573 secs
2025-03-09 08:32:25,374 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:32:25,374 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-09 08:32:39,495 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1209 secs
2025-03-09 08:32:39,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9644 secs
2025-03-09 08:32:39,497 [INFO]: {
2025-03-09 08:32:39,497 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:39,497 [INFO]: 	index_param: efSearch=210
2025-03-09 08:32:39,497 [INFO]: 	index_path: knn.index
2025-03-09 08:32:39,497 [INFO]: 	size in bytes: 577639810
2025-03-09 08:32:39,497 [INFO]: 	avg_search_speed_ms: 11.185873326141246
2025-03-09 08:32:39,497 [INFO]: 	99p_search_speed_ms: 25.108994657639297
2025-03-09 08:32:39,497 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:39,497 [INFO]: 	nb vectors: 2936
2025-03-09 08:32:39,497 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:39,497 [INFO]: 	compression ratio: 0.9993097394031758
2025-03-09 08:32:39,497 [INFO]: }
2025-03-09 08:32:39,497 [INFO]: 	>>> Finished "Creating the index" in 58.9678 secs
2025-03-09 08:32:39,497 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9954 secs
2025-03-09 08:32:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 48530 [episode count 7/20]
[retrieval_preprocessing] for episode 69652 [episode count 8/20], we have num_retrieval=np.int64(2954) num_query=np.int64(137)
2025-03-09 08:32:41,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:41,408 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:41
2025-03-09 08:32:41,408 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1748.36it/s]
2025-03-09 08:32:41,431 [INFO]: There are 2954 embeddings of dim 49152
2025-03-09 08:32:41,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 08:32:41,431 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:41
2025-03-09 08:32:41,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:41,431 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:32:41,431 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:41,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:41,431 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:41
2025-03-09 08:32:41,431 [INFO]: 609.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:41,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:32:41,431 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:41
2025-03-09 08:32:41,431 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:41,431 [INFO]: 	Creating the index 03/09/2025, 08:32:41
2025-03-09 08:32:41,431 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:41
2025-03-09 08:32:41,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:32:41,432 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:41
2025-03-09 08:32:41,432 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:32:41,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.61it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.27it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]100%|██████████| 12/12 [00:02<00:00,  5.06it/s]
2025-03-09 08:32:43,808 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:43
2025-03-09 08:33:18,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7164 secs
2025-03-09 08:33:18,525 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:33:18,526 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.37it/s]
2025-03-09 08:33:33,351 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8249 secs
2025-03-09 08:33:33,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1849 secs
2025-03-09 08:33:33,618 [INFO]: {
2025-03-09 08:33:33,618 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:33,618 [INFO]: 	index_param: efSearch=220
2025-03-09 08:33:33,618 [INFO]: 	index_path: knn.index
2025-03-09 08:33:33,618 [INFO]: 	size in bytes: 581181250
2025-03-09 08:33:33,618 [INFO]: 	avg_search_speed_ms: 9.888689990777507
2025-03-09 08:33:33,618 [INFO]: 	99p_search_speed_ms: 22.13797823060303
2025-03-09 08:33:33,618 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:33,618 [INFO]: 	nb vectors: 2954
2025-03-09 08:33:33,618 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:33,618 [INFO]: 	compression ratio: 0.9993096508189141
2025-03-09 08:33:33,618 [INFO]: }
2025-03-09 08:33:33,618 [INFO]: 	>>> Finished "Creating the index" in 52.1870 secs
2025-03-09 08:33:33,618 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2105 secs
2025-03-09 08:33:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 69652 [episode count 8/20]
[retrieval_preprocessing] for episode 90005 [episode count 9/20], we have num_retrieval=np.int64(2906) num_query=np.int64(185)
2025-03-09 08:33:34,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:35,270 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:35
2025-03-09 08:33:35,271 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 938.53it/s]
2025-03-09 08:33:35,296 [INFO]: There are 2906 embeddings of dim 49152
2025-03-09 08:33:35,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:33:35,297 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:35
2025-03-09 08:33:35,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:35,297 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:33:35,297 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:35,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:35,297 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:35
2025-03-09 08:33:35,297 [INFO]: 599.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:35,297 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:33:35,297 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:35
2025-03-09 08:33:35,297 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:35,297 [INFO]: 	Creating the index 03/09/2025, 08:33:35
2025-03-09 08:33:35,297 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:35
2025-03-09 08:33:35,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:33:35,298 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:35
2025-03-09 08:33:35,298 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:33:35,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.78it/s] 50%|█████     | 6/12 [00:00<00:00, 28.98it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.16it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-09 08:33:37,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:37
2025-03-09 08:34:23,975 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1439 secs
2025-03-09 08:34:23,975 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:34:23,975 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.25it/s]
2025-03-09 08:34:40,872 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8965 secs
2025-03-09 08:34:40,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5757 secs
2025-03-09 08:34:40,874 [INFO]: {
2025-03-09 08:34:40,874 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:40,874 [INFO]: 	index_param: efSearch=203
2025-03-09 08:34:40,874 [INFO]: 	index_path: knn.index
2025-03-09 08:34:40,874 [INFO]: 	size in bytes: 571737430
2025-03-09 08:34:40,874 [INFO]: 	avg_search_speed_ms: 8.627649973410987
2025-03-09 08:34:40,874 [INFO]: 	99p_search_speed_ms: 17.379798186011698
2025-03-09 08:34:40,874 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:40,874 [INFO]: 	nb vectors: 2906
2025-03-09 08:34:40,874 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:40,874 [INFO]: 	compression ratio: 0.9993098545253544
2025-03-09 08:34:40,874 [INFO]: }
2025-03-09 08:34:40,874 [INFO]: 	>>> Finished "Creating the index" in 65.5771 secs
2025-03-09 08:34:40,874 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6038 secs
2025-03-09 08:34:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 90005 [episode count 9/20]
[retrieval_preprocessing] for episode 71064 [episode count 10/20], we have num_retrieval=np.int64(2935) num_query=np.int64(156)
2025-03-09 08:34:42,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:42,917 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:42
2025-03-09 08:34:42,917 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.71it/s]
2025-03-09 08:34:42,942 [INFO]: There are 2935 embeddings of dim 49152
2025-03-09 08:34:42,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:34:42,942 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:42
2025-03-09 08:34:42,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:42,942 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:34:42,942 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:42,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:42,943 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:42
2025-03-09 08:34:42,943 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:42,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:42,943 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:42
2025-03-09 08:34:42,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:42,943 [INFO]: 	Creating the index 03/09/2025, 08:34:42
2025-03-09 08:34:42,943 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:42
2025-03-09 08:34:42,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:34:42,944 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:42
2025-03-09 08:34:42,944 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:34:42,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.08it/s] 50%|█████     | 6/12 [00:00<00:00, 28.95it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.49it/s]100%|██████████| 12/12 [00:02<00:00,  4.94it/s]
2025-03-09 08:34:45,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:45
2025-03-09 08:35:25,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5792 secs
2025-03-09 08:35:25,958 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 08:35:25,958 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.22it/s]
2025-03-09 08:35:41,706 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7482 secs
2025-03-09 08:35:41,707 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7634 secs
2025-03-09 08:35:41,708 [INFO]: {
2025-03-09 08:35:41,708 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:41,708 [INFO]: 	index_param: efSearch=197
2025-03-09 08:35:41,708 [INFO]: 	index_path: knn.index
2025-03-09 08:35:41,708 [INFO]: 	size in bytes: 577443070
2025-03-09 08:35:41,708 [INFO]: 	avg_search_speed_ms: 8.537871937882267
2025-03-09 08:35:41,708 [INFO]: 	99p_search_speed_ms: 12.313241022638975
2025-03-09 08:35:41,708 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:41,708 [INFO]: 	nb vectors: 2935
2025-03-09 08:35:41,708 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:41,708 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-09 08:35:41,708 [INFO]: }
2025-03-09 08:35:41,708 [INFO]: 	>>> Finished "Creating the index" in 58.7649 secs
2025-03-09 08:35:41,708 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7908 secs
2025-03-09 08:35:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 71064 [episode count 10/20]
[retrieval_preprocessing] for episode 42521 [episode count 11/20], we have num_retrieval=np.int64(2947) num_query=np.int64(144)
2025-03-09 08:35:42,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:43,287 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:43
2025-03-09 08:35:43,287 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-09 08:35:43,313 [INFO]: There are 2947 embeddings of dim 49152
2025-03-09 08:35:43,314 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 08:35:43,314 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:43
2025-03-09 08:35:43,314 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:43,314 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:35:43,314 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:43,314 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:35:43,314 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:43
2025-03-09 08:35:43,315 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:43,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:35:43,315 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:43
2025-03-09 08:35:43,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:43,315 [INFO]: 	Creating the index 03/09/2025, 08:35:43
2025-03-09 08:35:43,315 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:43
2025-03-09 08:35:43,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:35:43,318 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:43
2025-03-09 08:35:43,319 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:35:43,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.39it/s] 75%|███████▌  | 9/12 [00:00<00:00, 41.60it/s]100%|██████████| 12/12 [00:02<00:00,  5.49it/s]
2025-03-09 08:35:45,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:45
2025-03-09 08:36:16,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9288 secs
2025-03-09 08:36:16,437 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:36:16,437 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.66it/s]
2025-03-09 08:36:35,776 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3382 secs
2025-03-09 08:36:35,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4588 secs
2025-03-09 08:36:35,777 [INFO]: {
2025-03-09 08:36:35,777 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:35,777 [INFO]: 	index_param: efSearch=263
2025-03-09 08:36:35,777 [INFO]: 	index_path: knn.index
2025-03-09 08:36:35,777 [INFO]: 	size in bytes: 579803950
2025-03-09 08:36:35,778 [INFO]: 	avg_search_speed_ms: 12.794864648605323
2025-03-09 08:36:35,778 [INFO]: 	99p_search_speed_ms: 31.407699726987595
2025-03-09 08:36:35,778 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:35,778 [INFO]: 	nb vectors: 2947
2025-03-09 08:36:35,778 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:35,778 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-09 08:36:35,778 [INFO]: }
2025-03-09 08:36:35,778 [INFO]: 	>>> Finished "Creating the index" in 52.4623 secs
2025-03-09 08:36:35,778 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4904 secs
2025-03-09 08:36:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 42521 [episode count 11/20]
[retrieval_preprocessing] for episode 58010 [episode count 12/20], we have num_retrieval=np.int64(2933) num_query=np.int64(158)
2025-03-09 08:36:37,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:37,861 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:37
2025-03-09 08:36:37,861 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-09 08:36:37,886 [INFO]: There are 2933 embeddings of dim 49152
2025-03-09 08:36:37,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:36:37,886 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:37,886 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:36:37,886 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:37,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:37,886 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,886 [INFO]: 605.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:37,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:36:37,886 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:37
2025-03-09 08:36:37,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:37,886 [INFO]: 	Creating the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,887 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:37
2025-03-09 08:36:37,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:36:37,888 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,888 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:36:37,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.69it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.22it/s]100%|██████████| 12/12 [00:02<00:00,  3.54it/s]100%|██████████| 12/12 [00:02<00:00,  4.22it/s]
2025-03-09 08:36:40,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:40
2025-03-09 08:37:23,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5711 secs
2025-03-09 08:37:23,309 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 08:37:23,309 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.56it/s]
2025-03-09 08:37:35,888 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5788 secs
2025-03-09 08:37:35,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0023 secs
2025-03-09 08:37:35,890 [INFO]: {
2025-03-09 08:37:35,890 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:35,890 [INFO]: 	index_param: efSearch=182
2025-03-09 08:37:35,890 [INFO]: 	index_path: knn.index
2025-03-09 08:37:35,890 [INFO]: 	size in bytes: 577049590
2025-03-09 08:37:35,890 [INFO]: 	avg_search_speed_ms: 9.309917543121584
2025-03-09 08:37:35,890 [INFO]: 	99p_search_speed_ms: 23.300421724561602
2025-03-09 08:37:35,890 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:35,890 [INFO]: 	nb vectors: 2933
2025-03-09 08:37:35,890 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:35,890 [INFO]: 	compression ratio: 0.9993097196377871
2025-03-09 08:37:35,890 [INFO]: }
2025-03-09 08:37:35,890 [INFO]: 	>>> Finished "Creating the index" in 58.0038 secs
2025-03-09 08:37:35,890 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0289 secs
2025-03-09 08:37:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 58010 [episode count 12/20]
[retrieval_preprocessing] for episode 34206 [episode count 13/20], we have num_retrieval=np.int64(2784) num_query=np.int64(307)
2025-03-09 08:37:37,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:37,627 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:37
2025-03-09 08:37:37,627 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1569.72it/s]
2025-03-09 08:37:37,652 [INFO]: There are 2784 embeddings of dim 49152
2025-03-09 08:37:37,652 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:37:37,653 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:37,653 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:37:37,653 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:37,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:37,653 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,653 [INFO]: 574.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:37,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:37:37,653 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:37
2025-03-09 08:37:37,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:37,653 [INFO]: 	Creating the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,653 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:37
2025-03-09 08:37:37,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:37:37,654 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,654 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:37:37,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.85it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.02it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.75it/s]
2025-03-09 08:37:39,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:39
2025-03-09 08:38:17,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9566 secs
2025-03-09 08:38:17,930 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 08:38:17,930 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.25it/s]
2025-03-09 08:38:33,302 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3716 secs
2025-03-09 08:38:33,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6495 secs
2025-03-09 08:38:33,304 [INFO]: {
2025-03-09 08:38:33,304 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:33,304 [INFO]: 	index_param: efSearch=262
2025-03-09 08:38:33,304 [INFO]: 	index_path: knn.index
2025-03-09 08:38:33,304 [INFO]: 	size in bytes: 547734670
2025-03-09 08:38:33,304 [INFO]: 	avg_search_speed_ms: 11.330515875334463
2025-03-09 08:38:33,304 [INFO]: 	99p_search_speed_ms: 17.146888882853087
2025-03-09 08:38:33,304 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:33,304 [INFO]: 	nb vectors: 2784
2025-03-09 08:38:33,304 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:33,304 [INFO]: 	compression ratio: 0.9993098884903524
2025-03-09 08:38:33,304 [INFO]: }
2025-03-09 08:38:33,304 [INFO]: 	>>> Finished "Creating the index" in 55.6511 secs
2025-03-09 08:38:33,304 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6769 secs
2025-03-09 08:38:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 34206 [episode count 13/20]
[retrieval_preprocessing] for episode 48035 [episode count 14/20], we have num_retrieval=np.int64(2962) num_query=np.int64(129)
2025-03-09 08:38:36,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:37,165 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:37
2025-03-09 08:38:37,165 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-09 08:38:37,195 [INFO]: There are 2962 embeddings of dim 49152
2025-03-09 08:38:37,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 08:38:37,195 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:37
2025-03-09 08:38:37,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:37,195 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:38:37,195 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:37,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:37,195 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:37
2025-03-09 08:38:37,195 [INFO]: 611.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:37,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:38:37,196 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:37
2025-03-09 08:38:37,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:37,196 [INFO]: 	Creating the index 03/09/2025, 08:38:37
2025-03-09 08:38:37,196 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:37
2025-03-09 08:38:37,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:38:37,197 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:37
2025-03-09 08:38:37,197 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:38:37,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.45it/s] 50%|█████     | 6/12 [00:00<00:00, 31.10it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.35it/s]100%|██████████| 12/12 [00:02<00:00,  5.46it/s]
2025-03-09 08:38:39,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:39
2025-03-09 08:39:18,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7493 secs
2025-03-09 08:39:18,151 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:39:18,151 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-09 08:39:33,386 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2349 secs
2025-03-09 08:39:33,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2814 secs
2025-03-09 08:39:33,479 [INFO]: {
2025-03-09 08:39:33,479 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:33,479 [INFO]: 	index_param: efSearch=217
2025-03-09 08:39:33,479 [INFO]: 	index_path: knn.index
2025-03-09 08:39:33,479 [INFO]: 	size in bytes: 582755230
2025-03-09 08:39:33,479 [INFO]: 	avg_search_speed_ms: 9.602981492172704
2025-03-09 08:39:33,479 [INFO]: 	99p_search_speed_ms: 13.792067160829896
2025-03-09 08:39:33,479 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:33,479 [INFO]: 	nb vectors: 2962
2025-03-09 08:39:33,479 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:33,480 [INFO]: 	compression ratio: 0.9993096003617162
2025-03-09 08:39:33,480 [INFO]: }
2025-03-09 08:39:33,480 [INFO]: 	>>> Finished "Creating the index" in 56.2839 secs
2025-03-09 08:39:33,480 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3147 secs
2025-03-09 08:39:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 48035 [episode count 14/20]
[retrieval_preprocessing] for episode 80677 [episode count 15/20], we have num_retrieval=np.int64(2967) num_query=np.int64(124)
2025-03-09 08:39:34,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:35,014 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:35
2025-03-09 08:39:35,014 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-09 08:39:35,039 [INFO]: There are 2967 embeddings of dim 49152
2025-03-09 08:39:35,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 08:39:35,040 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:35
2025-03-09 08:39:35,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:35,040 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:39:35,040 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:35,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:35,040 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:35
2025-03-09 08:39:35,040 [INFO]: 612.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:35,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:39:35,040 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:35
2025-03-09 08:39:35,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:35,040 [INFO]: 	Creating the index 03/09/2025, 08:39:35
2025-03-09 08:39:35,040 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:35
2025-03-09 08:39:35,041 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:39:35,041 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:35
2025-03-09 08:39:35,041 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:39:35,042 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.43it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]100%|██████████| 12/12 [00:02<00:00,  5.37it/s]
2025-03-09 08:39:37,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:37
2025-03-09 08:40:15,117 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8387 secs
2025-03-09 08:40:15,118 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:40:15,118 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.76it/s]
2025-03-09 08:40:33,968 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8503 secs
2025-03-09 08:40:33,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9281 secs
2025-03-09 08:40:33,970 [INFO]: {
2025-03-09 08:40:33,970 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:33,970 [INFO]: 	index_param: efSearch=238
2025-03-09 08:40:33,970 [INFO]: 	index_path: knn.index
2025-03-09 08:40:33,970 [INFO]: 	size in bytes: 583738930
2025-03-09 08:40:33,970 [INFO]: 	avg_search_speed_ms: 9.741611637496105
2025-03-09 08:40:33,970 [INFO]: 	99p_search_speed_ms: 13.864957680925729
2025-03-09 08:40:33,970 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:33,970 [INFO]: 	nb vectors: 2967
2025-03-09 08:40:33,970 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:33,970 [INFO]: 	compression ratio: 0.9993096331608379
2025-03-09 08:40:33,970 [INFO]: }
2025-03-09 08:40:33,970 [INFO]: 	>>> Finished "Creating the index" in 58.9296 secs
2025-03-09 08:40:33,970 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9560 secs
2025-03-09 08:40:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 80677 [episode count 15/20]
[retrieval_preprocessing] for episode 90410 [episode count 16/20], we have num_retrieval=np.int64(2960) num_query=np.int64(131)
2025-03-09 08:40:35,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:36,220 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:36
2025-03-09 08:40:36,220 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2624.72it/s]
2025-03-09 08:40:36,240 [INFO]: There are 2960 embeddings of dim 49152
2025-03-09 08:40:36,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0196 secs
2025-03-09 08:40:36,240 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:36
2025-03-09 08:40:36,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:36,240 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:40:36,240 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:36,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:40:36,240 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:36
2025-03-09 08:40:36,240 [INFO]: 610.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:36,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:40:36,240 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:36
2025-03-09 08:40:36,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:36,240 [INFO]: 	Creating the index 03/09/2025, 08:40:36
2025-03-09 08:40:36,240 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:36
2025-03-09 08:40:36,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:40:36,241 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:36
2025-03-09 08:40:36,241 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:40:36,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.39it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.33it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]100%|██████████| 12/12 [00:02<00:00,  5.61it/s]
2025-03-09 08:40:38,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:38
2025-03-09 08:41:16,191 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8076 secs
2025-03-09 08:41:16,191 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:41:16,191 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-09 08:41:32,305 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1144 secs
2025-03-09 08:41:32,308 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0665 secs
2025-03-09 08:41:32,308 [INFO]: {
2025-03-09 08:41:32,308 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:32,308 [INFO]: 	index_param: efSearch=223
2025-03-09 08:41:32,308 [INFO]: 	index_path: knn.index
2025-03-09 08:41:32,308 [INFO]: 	size in bytes: 582361750
2025-03-09 08:41:32,308 [INFO]: 	avg_search_speed_ms: 10.647337792807834
2025-03-09 08:41:32,308 [INFO]: 	99p_search_speed_ms: 23.21363070746884
2025-03-09 08:41:32,308 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:32,308 [INFO]: 	nb vectors: 2960
2025-03-09 08:41:32,308 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:32,308 [INFO]: 	compression ratio: 0.9993095872110419
2025-03-09 08:41:32,308 [INFO]: }
2025-03-09 08:41:32,308 [INFO]: 	>>> Finished "Creating the index" in 56.0679 secs
2025-03-09 08:41:32,308 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0880 secs
2025-03-09 08:41:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 90410 [episode count 16/20]
[retrieval_preprocessing] for episode 71803 [episode count 17/20], we have num_retrieval=np.int64(2932) num_query=np.int64(159)
2025-03-09 08:41:33,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:34,152 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:34
2025-03-09 08:41:34,152 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1812.58it/s]
2025-03-09 08:41:34,178 [INFO]: There are 2932 embeddings of dim 49152
2025-03-09 08:41:34,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:41:34,179 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:34,179 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:41:34,179 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:34,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:34,179 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,179 [INFO]: 605.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:34,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:41:34,179 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:34
2025-03-09 08:41:34,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:34,179 [INFO]: 	Creating the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,179 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:34
2025-03-09 08:41:34,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:41:34,180 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,180 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:41:34,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.86it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.87it/s]100%|██████████| 12/12 [00:02<00:00,  3.71it/s]100%|██████████| 12/12 [00:02<00:00,  4.67it/s]
2025-03-09 08:41:36,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:36
2025-03-09 08:42:22,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0997 secs
2025-03-09 08:42:22,854 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 08:42:22,854 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-09 08:42:40,955 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1002 secs
2025-03-09 08:42:40,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7770 secs
2025-03-09 08:42:40,957 [INFO]: {
2025-03-09 08:42:40,958 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:40,958 [INFO]: 	index_param: efSearch=162
2025-03-09 08:42:40,958 [INFO]: 	index_path: knn.index
2025-03-09 08:42:40,958 [INFO]: 	size in bytes: 576852790
2025-03-09 08:42:40,958 [INFO]: 	avg_search_speed_ms: 10.55682127028625
2025-03-09 08:42:40,958 [INFO]: 	99p_search_speed_ms: 21.995389149524257
2025-03-09 08:42:40,958 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:40,958 [INFO]: 	nb vectors: 2932
2025-03-09 08:42:40,958 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:40,958 [INFO]: 	compression ratio: 0.9993098169812094
2025-03-09 08:42:40,958 [INFO]: }
2025-03-09 08:42:40,958 [INFO]: 	>>> Finished "Creating the index" in 66.7787 secs
2025-03-09 08:42:40,958 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8060 secs
2025-03-09 08:42:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 71803 [episode count 17/20]
[retrieval_preprocessing] for episode 65708 [episode count 18/20], we have num_retrieval=np.int64(2931) num_query=np.int64(160)
2025-03-09 08:42:42,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:44,135 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:44
2025-03-09 08:42:44,135 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.83it/s]
2025-03-09 08:42:44,164 [INFO]: There are 2931 embeddings of dim 49152
2025-03-09 08:42:44,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 08:42:44,164 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:44
2025-03-09 08:42:44,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:44,164 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:42:44,164 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:44,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:44,165 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:44
2025-03-09 08:42:44,165 [INFO]: 604.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:44,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:42:44,165 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:44
2025-03-09 08:42:44,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:44,165 [INFO]: 	Creating the index 03/09/2025, 08:42:44
2025-03-09 08:42:44,165 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:44
2025-03-09 08:42:44,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:42:44,166 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:44
2025-03-09 08:42:44,166 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:42:44,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.41it/s] 50%|█████     | 6/12 [00:00<00:00, 32.24it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.30it/s]100%|██████████| 12/12 [00:02<00:00,  5.05it/s]
2025-03-09 08:42:46,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:46
2025-03-09 08:43:24,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8472 secs
2025-03-09 08:43:24,395 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:43:24,396 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-09 08:43:39,428 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0325 secs
2025-03-09 08:43:39,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2641 secs
2025-03-09 08:43:39,431 [INFO]: {
2025-03-09 08:43:39,431 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:39,431 [INFO]: 	index_param: efSearch=237
2025-03-09 08:43:39,431 [INFO]: 	index_path: knn.index
2025-03-09 08:43:39,431 [INFO]: 	size in bytes: 576656050
2025-03-09 08:43:39,431 [INFO]: 	avg_search_speed_ms: 11.404946213322633
2025-03-09 08:43:39,431 [INFO]: 	99p_search_speed_ms: 25.545849800109867
2025-03-09 08:43:39,431 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:39,431 [INFO]: 	nb vectors: 2931
2025-03-09 08:43:39,431 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:39,431 [INFO]: 	compression ratio: 0.9993098104147178
2025-03-09 08:43:39,431 [INFO]: }
2025-03-09 08:43:39,431 [INFO]: 	>>> Finished "Creating the index" in 55.2659 secs
2025-03-09 08:43:39,431 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2961 secs
2025-03-09 08:43:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 65708 [episode count 18/20]
[retrieval_preprocessing] for episode 81837 [episode count 19/20], we have num_retrieval=np.int64(2907) num_query=np.int64(184)
2025-03-09 08:43:41,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:42,117 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:42
2025-03-09 08:43:42,117 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.06it/s]
2025-03-09 08:43:42,147 [INFO]: There are 2907 embeddings of dim 49152
2025-03-09 08:43:42,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 08:43:42,147 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:42
2025-03-09 08:43:42,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:42,148 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:43:42,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:42,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:43:42,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:42
2025-03-09 08:43:42,148 [INFO]: 599.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:42,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:43:42,149 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:42
2025-03-09 08:43:42,149 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:42,149 [INFO]: 	Creating the index 03/09/2025, 08:43:42
2025-03-09 08:43:42,149 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:42
2025-03-09 08:43:42,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:43:42,152 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:42
2025-03-09 08:43:42,152 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:43:42,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.20it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.85it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]100%|██████████| 12/12 [00:02<00:00,  5.13it/s]
2025-03-09 08:43:45,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:45
2025-03-09 08:44:18,950 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5729 secs
2025-03-09 08:44:18,951 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 08:44:18,951 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.25it/s]
2025-03-09 08:44:34,221 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2694 secs
2025-03-09 08:44:34,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2786 secs
2025-03-09 08:44:34,431 [INFO]: {
2025-03-09 08:44:34,431 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:34,431 [INFO]: 	index_param: efSearch=244
2025-03-09 08:44:34,431 [INFO]: 	index_path: knn.index
2025-03-09 08:44:34,431 [INFO]: 	size in bytes: 571934170
2025-03-09 08:44:34,431 [INFO]: 	avg_search_speed_ms: 10.260769344675236
2025-03-09 08:44:34,431 [INFO]: 	99p_search_speed_ms: 20.89187078177929
2025-03-09 08:44:34,431 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:34,431 [INFO]: 	nb vectors: 2907
2025-03-09 08:44:34,431 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:34,431 [INFO]: 	compression ratio: 0.999309861133144
2025-03-09 08:44:34,432 [INFO]: }
2025-03-09 08:44:34,432 [INFO]: 	>>> Finished "Creating the index" in 52.2828 secs
2025-03-09 08:44:34,432 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3149 secs
2025-03-09 08:44:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 81837 [episode count 19/20]
2025-03-09 08:44:36: [retrieval_preprocessing] finished for (8815207926, 'block') [chosen_id count 4/5]
2025-03-09 08:44:36: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
